!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e="undefined"!=typeof globalThis?globalThis:e||self).tdocs=n()}(this,(function(){"use strict";var e=function(){return(e=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)};function n(e,n){var t={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&n.indexOf(o)<0&&(t[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)n.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(t[o[i]]=e[o[i]])}return t}function t(e,n,t,o){return new(t||(t=Promise))((function(i,r){function s(e){try{a(o.next(e))}catch(e){r(e)}}function c(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(s,c)}a((o=o.apply(e,n||[])).next())}))}function o(e,n){var t,o,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(r){return function(c){return function(r){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,o=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=n.call(e,s)}catch(e){r=[6,e],o=0}finally{t=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,c])}}}function i(e,n,t){if(t||2===arguments.length)for(var o,i=0,r=n.length;i<r;i++)!o&&i in n||(o||(o=Array.prototype.slice.call(n,0,i)),o[i]=n[i]);return e.concat(o||Array.prototype.slice.call(n))}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},c={exports:{}},a={exports:{}};!function(e,n){var t="__lodash_hash_undefined__",o=9007199254740991,i="[object Arguments]",r="[object Boolean]",c="[object Date]",a="[object Function]",u="[object GeneratorFunction]",l="[object Map]",f="[object Number]",d="[object Object]",p="[object Promise]",v="[object RegExp]",w="[object Set]",h="[object String]",g="[object Symbol]",m="[object WeakMap]",b="[object ArrayBuffer]",y="[object DataView]",k="[object Float32Array]",C="[object Float64Array]",W="[object Int8Array]",_="[object Int16Array]",x="[object Int32Array]",A="[object Uint8Array]",P="[object Uint8ClampedArray]",S="[object Uint16Array]",O="[object Uint32Array]",I=/\w*$/,T=/^\[object .+?Constructor\]$/,D=/^(?:0|[1-9]\d*)$/,j={};j[i]=j["[object Array]"]=j[b]=j[y]=j[r]=j[c]=j[k]=j[C]=j[W]=j[_]=j[x]=j[l]=j[f]=j[d]=j[v]=j[w]=j[h]=j[g]=j[A]=j[P]=j[S]=j[O]=!0,j["[object Error]"]=j[a]=j[m]=!1;var M="object"==typeof s&&s&&s.Object===Object&&s,U="object"==typeof self&&self&&self.Object===Object&&self,E=M||U||Function("return this")(),N=n&&!n.nodeType&&n,B=N&&e&&!e.nodeType&&e,L=B&&B.exports===N;function F(e,n){return e.set(n[0],n[1]),e}function Q(e,n){return e.add(n),e}function q(e,n,t,o){var i=-1,r=e?e.length:0;for(o&&r&&(t=e[++i]);++i<r;)t=n(t,e[i],i,e);return t}function R(e){var n=!1;if(null!=e&&"function"!=typeof e.toString)try{n=!!(e+"")}catch(e){}return n}function V(e){var n=-1,t=Array(e.size);return e.forEach((function(e,o){t[++n]=[o,e]})),t}function J(e,n){return function(t){return e(n(t))}}function G(e){var n=-1,t=Array(e.size);return e.forEach((function(e){t[++n]=e})),t}var X,$=Array.prototype,z=Function.prototype,K=Object.prototype,H=E["__core-js_shared__"],Y=(X=/[^.]+$/.exec(H&&H.keys&&H.keys.IE_PROTO||""))?"Symbol(src)_1."+X:"",Z=z.toString,ee=K.hasOwnProperty,ne=K.toString,te=RegExp("^"+Z.call(ee).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),oe=L?E.Buffer:void 0,ie=E.Symbol,re=E.Uint8Array,se=J(Object.getPrototypeOf,Object),ce=Object.create,ae=K.propertyIsEnumerable,ue=$.splice,le=Object.getOwnPropertySymbols,fe=oe?oe.isBuffer:void 0,de=J(Object.keys,Object),pe=Be(E,"DataView"),ve=Be(E,"Map"),we=Be(E,"Promise"),he=Be(E,"Set"),ge=Be(E,"WeakMap"),me=Be(Object,"create"),be=Re(pe),ye=Re(ve),ke=Re(we),Ce=Re(he),We=Re(ge),_e=ie?ie.prototype:void 0,xe=_e?_e.valueOf:void 0;function Ae(e){var n=-1,t=e?e.length:0;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function Pe(e){var n=-1,t=e?e.length:0;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function Se(e){var n=-1,t=e?e.length:0;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function Oe(e){this.__data__=new Pe(e)}function Ie(e,n){var t=Je(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&Ge(e)}(e)&&ee.call(e,"callee")&&(!ae.call(e,"callee")||ne.call(e)==i)}(e)?function(e,n){for(var t=-1,o=Array(e);++t<e;)o[t]=n(t);return o}(e.length,String):[],o=t.length,r=!!o;for(var s in e)!n&&!ee.call(e,s)||r&&("length"==s||Qe(s,o))||t.push(s);return t}function Te(e,n,t){var o=e[n];ee.call(e,n)&&Ve(o,t)&&(void 0!==t||n in e)||(e[n]=t)}function De(e,n){for(var t=e.length;t--;)if(Ve(e[t][0],n))return t;return-1}function je(e,n,t,o,s,p,m){var T;if(o&&(T=p?o(e,s,p,m):o(e)),void 0!==T)return T;if(!ze(e))return e;var D=Je(e);if(D){if(T=function(e){var n=e.length,t=e.constructor(n);n&&"string"==typeof e[0]&&ee.call(e,"index")&&(t.index=e.index,t.input=e.input);return t}(e),!n)return function(e,n){var t=-1,o=e.length;n||(n=Array(o));for(;++t<o;)n[t]=e[t];return n}(e,T)}else{var M=Fe(e),U=M==a||M==u;if(Xe(e))return function(e,n){if(n)return e.slice();var t=new e.constructor(e.length);return e.copy(t),t}(e,n);if(M==d||M==i||U&&!p){if(R(e))return p?e:{};if(T=function(e){return"function"!=typeof e.constructor||qe(e)?{}:(n=se(e),ze(n)?ce(n):{});var n}(U?{}:e),!n)return function(e,n){return Ee(e,Le(e),n)}(e,function(e,n){return e&&Ee(n,Ke(n),e)}(T,e))}else{if(!j[M])return p?e:{};T=function(e,n,t,o){var i=e.constructor;switch(n){case b:return Ue(e);case r:case c:return new i(+e);case y:return function(e,n){var t=n?Ue(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.byteLength)}(e,o);case k:case C:case W:case _:case x:case A:case P:case S:case O:return function(e,n){var t=n?Ue(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)}(e,o);case l:return function(e,n,t){return q(n?t(V(e),!0):V(e),F,new e.constructor)}(e,o,t);case f:case h:return new i(e);case v:return function(e){var n=new e.constructor(e.source,I.exec(e));return n.lastIndex=e.lastIndex,n}(e);case w:return function(e,n,t){return q(n?t(G(e),!0):G(e),Q,new e.constructor)}(e,o,t);case g:return s=e,xe?Object(xe.call(s)):{}}var s}(e,M,je,n)}}m||(m=new Oe);var E=m.get(e);if(E)return E;if(m.set(e,T),!D)var N=t?function(e){return function(e,n,t){var o=n(e);return Je(e)?o:function(e,n){for(var t=-1,o=n.length,i=e.length;++t<o;)e[i+t]=n[t];return e}(o,t(e))}(e,Ke,Le)}(e):Ke(e);return function(e,n){for(var t=-1,o=e?e.length:0;++t<o&&!1!==n(e[t],t,e););}(N||e,(function(i,r){N&&(i=e[r=i]),Te(T,r,je(i,n,t,o,r,e,m))})),T}function Me(e){return!(!ze(e)||(n=e,Y&&Y in n))&&($e(e)||R(e)?te:T).test(Re(e));var n}function Ue(e){var n=new e.constructor(e.byteLength);return new re(n).set(new re(e)),n}function Ee(e,n,t,o){t||(t={});for(var i=-1,r=n.length;++i<r;){var s=n[i],c=o?o(t[s],e[s],s,t,e):void 0;Te(t,s,void 0===c?e[s]:c)}return t}function Ne(e,n){var t,o,i=e.__data__;return("string"==(o=typeof(t=n))||"number"==o||"symbol"==o||"boolean"==o?"__proto__"!==t:null===t)?i["string"==typeof n?"string":"hash"]:i.map}function Be(e,n){var t=function(e,n){return null==e?void 0:e[n]}(e,n);return Me(t)?t:void 0}Ae.prototype.clear=function(){this.__data__=me?me(null):{}},Ae.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},Ae.prototype.get=function(e){var n=this.__data__;if(me){var o=n[e];return o===t?void 0:o}return ee.call(n,e)?n[e]:void 0},Ae.prototype.has=function(e){var n=this.__data__;return me?void 0!==n[e]:ee.call(n,e)},Ae.prototype.set=function(e,n){return this.__data__[e]=me&&void 0===n?t:n,this},Pe.prototype.clear=function(){this.__data__=[]},Pe.prototype.delete=function(e){var n=this.__data__,t=De(n,e);return!(t<0)&&(t==n.length-1?n.pop():ue.call(n,t,1),!0)},Pe.prototype.get=function(e){var n=this.__data__,t=De(n,e);return t<0?void 0:n[t][1]},Pe.prototype.has=function(e){return De(this.__data__,e)>-1},Pe.prototype.set=function(e,n){var t=this.__data__,o=De(t,e);return o<0?t.push([e,n]):t[o][1]=n,this},Se.prototype.clear=function(){this.__data__={hash:new Ae,map:new(ve||Pe),string:new Ae}},Se.prototype.delete=function(e){return Ne(this,e).delete(e)},Se.prototype.get=function(e){return Ne(this,e).get(e)},Se.prototype.has=function(e){return Ne(this,e).has(e)},Se.prototype.set=function(e,n){return Ne(this,e).set(e,n),this},Oe.prototype.clear=function(){this.__data__=new Pe},Oe.prototype.delete=function(e){return this.__data__.delete(e)},Oe.prototype.get=function(e){return this.__data__.get(e)},Oe.prototype.has=function(e){return this.__data__.has(e)},Oe.prototype.set=function(e,n){var t=this.__data__;if(t instanceof Pe){var o=t.__data__;if(!ve||o.length<199)return o.push([e,n]),this;t=this.__data__=new Se(o)}return t.set(e,n),this};var Le=le?J(le,Object):function(){return[]},Fe=function(e){return ne.call(e)};function Qe(e,n){return!!(n=null==n?o:n)&&("number"==typeof e||D.test(e))&&e>-1&&e%1==0&&e<n}function qe(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||K)}function Re(e){if(null!=e){try{return Z.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Ve(e,n){return e===n||e!=e&&n!=n}(pe&&Fe(new pe(new ArrayBuffer(1)))!=y||ve&&Fe(new ve)!=l||we&&Fe(we.resolve())!=p||he&&Fe(new he)!=w||ge&&Fe(new ge)!=m)&&(Fe=function(e){var n=ne.call(e),t=n==d?e.constructor:void 0,o=t?Re(t):void 0;if(o)switch(o){case be:return y;case ye:return l;case ke:return p;case Ce:return w;case We:return m}return n});var Je=Array.isArray;function Ge(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=o}(e.length)&&!$e(e)}var Xe=fe||function(){return!1};function $e(e){var n=ze(e)?ne.call(e):"";return n==a||n==u}function ze(e){var n=typeof e;return!!e&&("object"==n||"function"==n)}function Ke(e){return Ge(e)?Ie(e):function(e){if(!qe(e))return de(e);var n=[];for(var t in Object(e))ee.call(e,t)&&"constructor"!=t&&n.push(t);return n}(e)}e.exports=function(e){return je(e,!0,!0)}}(a,a.exports),a.exports.default;var u={exports:{}};!function(e){var n="__lodash_hash_undefined__",t="[object Function]",o="[object GeneratorFunction]",i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/,c=/^\./,a=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,u=/\\(\\)?/g,l=/^\[object .+?Constructor\]$/,f="object"==typeof s&&s&&s.Object===Object&&s,d="object"==typeof self&&self&&self.Object===Object&&self,p=f||d||Function("return this")();var v,w=Array.prototype,h=Function.prototype,g=Object.prototype,m=p["__core-js_shared__"],b=(v=/[^.]+$/.exec(m&&m.keys&&m.keys.IE_PROTO||""))?"Symbol(src)_1."+v:"",y=h.toString,k=g.hasOwnProperty,C=g.toString,W=RegExp("^"+y.call(k).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),_=p.Symbol,x=w.splice,A=N(p,"Map"),P=N(Object,"create"),S=_?_.prototype:void 0,O=S?S.toString:void 0;function I(e){var n=-1,t=e?e.length:0;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function T(e){var n=-1,t=e?e.length:0;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function D(e){var n=-1,t=e?e.length:0;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function j(e,n){for(var t,o,i=e.length;i--;)if((t=e[i][0])===(o=n)||t!=t&&o!=o)return i;return-1}function M(e,n){for(var t,o=0,s=(n=function(e,n){if(Q(e))return!1;var t=typeof e;if("number"==t||"symbol"==t||"boolean"==t||null==e||R(e))return!0;return r.test(e)||!i.test(e)||null!=n&&e in Object(n)}(n,e)?[n]:Q(t=n)?t:B(t)).length;null!=e&&o<s;)e=e[L(n[o++])];return o&&o==s?e:void 0}function U(e){return!(!q(e)||(n=e,b&&b in n))&&(function(e){var n=q(e)?C.call(e):"";return n==t||n==o}(e)||function(e){var n=!1;if(null!=e&&"function"!=typeof e.toString)try{n=!!(e+"")}catch(e){}return n}(e)?W:l).test(function(e){if(null!=e){try{return y.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var n}function E(e,n){var t,o,i=e.__data__;return("string"==(o=typeof(t=n))||"number"==o||"symbol"==o||"boolean"==o?"__proto__"!==t:null===t)?i["string"==typeof n?"string":"hash"]:i.map}function N(e,n){var t=function(e,n){return null==e?void 0:e[n]}(e,n);return U(t)?t:void 0}I.prototype.clear=function(){this.__data__=P?P(null):{}},I.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},I.prototype.get=function(e){var t=this.__data__;if(P){var o=t[e];return o===n?void 0:o}return k.call(t,e)?t[e]:void 0},I.prototype.has=function(e){var n=this.__data__;return P?void 0!==n[e]:k.call(n,e)},I.prototype.set=function(e,t){return this.__data__[e]=P&&void 0===t?n:t,this},T.prototype.clear=function(){this.__data__=[]},T.prototype.delete=function(e){var n=this.__data__,t=j(n,e);return!(t<0)&&(t==n.length-1?n.pop():x.call(n,t,1),!0)},T.prototype.get=function(e){var n=this.__data__,t=j(n,e);return t<0?void 0:n[t][1]},T.prototype.has=function(e){return j(this.__data__,e)>-1},T.prototype.set=function(e,n){var t=this.__data__,o=j(t,e);return o<0?t.push([e,n]):t[o][1]=n,this},D.prototype.clear=function(){this.__data__={hash:new I,map:new(A||T),string:new I}},D.prototype.delete=function(e){return E(this,e).delete(e)},D.prototype.get=function(e){return E(this,e).get(e)},D.prototype.has=function(e){return E(this,e).has(e)},D.prototype.set=function(e,n){return E(this,e).set(e,n),this};var B=F((function(e){var n;e=null==(n=e)?"":function(e){if("string"==typeof e)return e;if(R(e))return O?O.call(e):"";var n=e+"";return"0"==n&&1/e==-1/0?"-0":n}(n);var t=[];return c.test(e)&&t.push(""),e.replace(a,(function(e,n,o,i){t.push(o?i.replace(u,"$1"):n||e)})),t}));function L(e){if("string"==typeof e||R(e))return e;var n=e+"";return"0"==n&&1/e==-1/0?"-0":n}function F(e,n){if("function"!=typeof e||n&&"function"!=typeof n)throw new TypeError("Expected a function");var t=function(){var o=arguments,i=n?n.apply(this,o):o[0],r=t.cache;if(r.has(i))return r.get(i);var s=e.apply(this,o);return t.cache=r.set(i,s),s};return t.cache=new(F.Cache||D),t}F.Cache=D;var Q=Array.isArray;function q(e){var n=typeof e;return!!e&&("object"==n||"function"==n)}function R(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==C.call(e)}e.exports=function(e,n,t){var o=null==e?void 0:M(e,n);return void 0===o?t:o}}(u),u.exports.default;var l={exports:{}};!function(e,n){var t=9007199254740991,o="[object Map]",i="[object Promise]",r="[object Set]",c="[object WeakMap]",a="[object DataView]",u=/^\[object .+?Constructor\]$/,l="object"==typeof s&&s&&s.Object===Object&&s,f="object"==typeof self&&self&&self.Object===Object&&self,d=l||f||Function("return this")(),p=n&&!n.nodeType&&n,v=p&&e&&!e.nodeType&&e,w=v&&v.exports===p;var h,g,m,b=Function.prototype,y=Object.prototype,k=d["__core-js_shared__"],C=(h=/[^.]+$/.exec(k&&k.keys&&k.keys.IE_PROTO||""))?"Symbol(src)_1."+h:"",W=b.toString,_=y.hasOwnProperty,x=y.toString,A=RegExp("^"+W.call(_).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),P=w?d.Buffer:void 0,S=y.propertyIsEnumerable,O=P?P.isBuffer:void 0,I=(g=Object.keys,m=Object,function(e){return g(m(e))}),T=R(d,"DataView"),D=R(d,"Map"),j=R(d,"Promise"),M=R(d,"Set"),U=R(d,"WeakMap"),E=!S.call({valueOf:1},"valueOf"),N=J(T),B=J(D),L=J(j),F=J(M),Q=J(U);function q(e){return!(!H(e)||function(e){return!!C&&C in e}(e))&&(K(e)||function(e){var n=!1;if(null!=e&&"function"!=typeof e.toString)try{n=!!(e+"")}catch(e){}return n}(e)?A:u).test(J(e))}function R(e,n){var t=function(e,n){return null==e?void 0:e[n]}(e,n);return q(t)?t:void 0}var V=function(e){return x.call(e)};function J(e){if(null!=e){try{return W.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function G(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&$(e)}(e)&&_.call(e,"callee")&&(!S.call(e,"callee")||"[object Arguments]"==x.call(e))}(T&&V(new T(new ArrayBuffer(1)))!=a||D&&V(new D)!=o||j&&V(j.resolve())!=i||M&&V(new M)!=r||U&&V(new U)!=c)&&(V=function(e){var n=x.call(e),t="[object Object]"==n?e.constructor:void 0,s=t?J(t):void 0;if(s)switch(s){case N:return a;case B:return o;case L:return i;case F:return r;case Q:return c}return n});var X=Array.isArray;function $(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=t}(e.length)&&!K(e)}var z=O||function(){return!1};function K(e){var n=H(e)?x.call(e):"";return"[object Function]"==n||"[object GeneratorFunction]"==n}function H(e){var n=typeof e;return!!e&&("object"==n||"function"==n)}e.exports=function(e){if($(e)&&(X(e)||"string"==typeof e||"function"==typeof e.splice||z(e)||G(e)))return!e.length;var n=V(e);if(n==o||n==r)return!e.size;if(E||function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||y)}(e))return!I(e).length;for(var t in e)if(_.call(e,t))return!1;return!0}}(l,l.exports),l.exports.default;var f={exports:{}};!function(e,n){var t="__lodash_hash_undefined__",o=9007199254740991,i="[object Arguments]",r="[object Function]",c="[object Object]",a=/^\[object .+?Constructor\]$/,u=/^(?:0|[1-9]\d*)$/,l={};l["[object Float32Array]"]=l["[object Float64Array]"]=l["[object Int8Array]"]=l["[object Int16Array]"]=l["[object Int32Array]"]=l["[object Uint8Array]"]=l["[object Uint8ClampedArray]"]=l["[object Uint16Array]"]=l["[object Uint32Array]"]=!0,l[i]=l["[object Array]"]=l["[object ArrayBuffer]"]=l["[object Boolean]"]=l["[object DataView]"]=l["[object Date]"]=l["[object Error]"]=l[r]=l["[object Map]"]=l["[object Number]"]=l[c]=l["[object RegExp]"]=l["[object Set]"]=l["[object String]"]=l["[object WeakMap]"]=!1;var f="object"==typeof s&&s&&s.Object===Object&&s,d="object"==typeof self&&self&&self.Object===Object&&self,p=f||d||Function("return this")(),v=n&&!n.nodeType&&n,w=v&&e&&!e.nodeType&&e,h=w&&w.exports===v,g=h&&f.process,m=function(){try{var e=w&&w.require&&w.require("util").types;return e||g&&g.binding&&g.binding("util")}catch(e){}}(),b=m&&m.isTypedArray;function y(e,n,t){switch(t.length){case 0:return e.call(n);case 1:return e.call(n,t[0]);case 2:return e.call(n,t[0],t[1]);case 3:return e.call(n,t[0],t[1],t[2])}return e.apply(n,t)}var k,C,W,_=Array.prototype,x=Function.prototype,A=Object.prototype,P=p["__core-js_shared__"],S=x.toString,O=A.hasOwnProperty,I=(k=/[^.]+$/.exec(P&&P.keys&&P.keys.IE_PROTO||""))?"Symbol(src)_1."+k:"",T=A.toString,D=S.call(Object),j=RegExp("^"+S.call(O).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),M=h?p.Buffer:void 0,U=p.Symbol,E=p.Uint8Array,N=M?M.allocUnsafe:void 0,B=(C=Object.getPrototypeOf,W=Object,function(e){return C(W(e))}),L=Object.create,F=A.propertyIsEnumerable,Q=_.splice,q=U?U.toStringTag:void 0,R=function(){try{var e=ve(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),V=M?M.isBuffer:void 0,J=Math.max,G=Date.now,X=ve(p,"Map"),$=ve(Object,"create"),z=function(){function e(){}return function(n){if(!Ae(n))return{};if(L)return L(n);e.prototype=n;var t=new e;return e.prototype=void 0,t}}();function K(e){var n=-1,t=null==e?0:e.length;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function H(e){var n=-1,t=null==e?0:e.length;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function Y(e){var n=-1,t=null==e?0:e.length;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function Z(e){var n=this.__data__=new H(e);this.size=n.size}function ee(e,n){var t=ke(e),o=!t&&ye(e),i=!t&&!o&&We(e),r=!t&&!o&&!i&&Se(e),s=t||o||i||r,c=s?function(e,n){for(var t=-1,o=Array(e);++t<e;)o[t]=n(t);return o}(e.length,String):[],a=c.length;for(var u in e)!n&&!O.call(e,u)||s&&("length"==u||i&&("offset"==u||"parent"==u)||r&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||we(u,a))||c.push(u);return c}function ne(e,n,t){(void 0!==t&&!be(e[n],t)||void 0===t&&!(n in e))&&ie(e,n,t)}function te(e,n,t){var o=e[n];O.call(e,n)&&be(o,t)&&(void 0!==t||n in e)||ie(e,n,t)}function oe(e,n){for(var t=e.length;t--;)if(be(e[t][0],n))return t;return-1}function ie(e,n,t){"__proto__"==n&&R?R(e,n,{configurable:!0,enumerable:!0,value:t,writable:!0}):e[n]=t}K.prototype.clear=function(){this.__data__=$?$(null):{},this.size=0},K.prototype.delete=function(e){var n=this.has(e)&&delete this.__data__[e];return this.size-=n?1:0,n},K.prototype.get=function(e){var n=this.__data__;if($){var o=n[e];return o===t?void 0:o}return O.call(n,e)?n[e]:void 0},K.prototype.has=function(e){var n=this.__data__;return $?void 0!==n[e]:O.call(n,e)},K.prototype.set=function(e,n){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=$&&void 0===n?t:n,this},H.prototype.clear=function(){this.__data__=[],this.size=0},H.prototype.delete=function(e){var n=this.__data__,t=oe(n,e);return!(t<0)&&(t==n.length-1?n.pop():Q.call(n,t,1),--this.size,!0)},H.prototype.get=function(e){var n=this.__data__,t=oe(n,e);return t<0?void 0:n[t][1]},H.prototype.has=function(e){return oe(this.__data__,e)>-1},H.prototype.set=function(e,n){var t=this.__data__,o=oe(t,e);return o<0?(++this.size,t.push([e,n])):t[o][1]=n,this},Y.prototype.clear=function(){this.size=0,this.__data__={hash:new K,map:new(X||H),string:new K}},Y.prototype.delete=function(e){var n=pe(this,e).delete(e);return this.size-=n?1:0,n},Y.prototype.get=function(e){return pe(this,e).get(e)},Y.prototype.has=function(e){return pe(this,e).has(e)},Y.prototype.set=function(e,n){var t=pe(this,e),o=t.size;return t.set(e,n),this.size+=t.size==o?0:1,this},Z.prototype.clear=function(){this.__data__=new H,this.size=0},Z.prototype.delete=function(e){var n=this.__data__,t=n.delete(e);return this.size=n.size,t},Z.prototype.get=function(e){return this.__data__.get(e)},Z.prototype.has=function(e){return this.__data__.has(e)},Z.prototype.set=function(e,n){var t=this.__data__;if(t instanceof H){var o=t.__data__;if(!X||o.length<199)return o.push([e,n]),this.size=++t.size,this;t=this.__data__=new Y(o)}return t.set(e,n),this.size=t.size,this};var re,se=function(e,n,t){for(var o=-1,i=Object(e),r=t(e),s=r.length;s--;){var c=r[re?s:++o];if(!1===n(i[c],c,i))break}return e};function ce(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":q&&q in Object(e)?function(e){var n=O.call(e,q),t=e[q];try{e[q]=void 0;var o=!0}catch(e){}var i=T.call(e);o&&(n?e[q]=t:delete e[q]);return i}(e):function(e){return T.call(e)}(e)}function ae(e){return Pe(e)&&ce(e)==i}function ue(e){return!(!Ae(e)||function(e){return!!I&&I in e}(e))&&(_e(e)?j:a).test(function(e){if(null!=e){try{return S.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}function le(e){if(!Ae(e))return function(e){var n=[];if(null!=e)for(var t in Object(e))n.push(t);return n}(e);var n=he(e),t=[];for(var o in e)("constructor"!=o||!n&&O.call(e,o))&&t.push(o);return t}function fe(e,n,t,o,i){e!==n&&se(n,(function(r,s){if(i||(i=new Z),Ae(r))!function(e,n,t,o,i,r,s){var a=ge(e,t),u=ge(n,t),l=s.get(u);if(l)return void ne(e,t,l);var f=r?r(a,u,t+"",e,n,s):void 0,d=void 0===f;if(d){var p=ke(u),v=!p&&We(u),w=!p&&!v&&Se(u);f=u,p||v||w?ke(a)?f=a:Pe(y=a)&&Ce(y)?f=function(e,n){var t=-1,o=e.length;n||(n=Array(o));for(;++t<o;)n[t]=e[t];return n}(a):v?(d=!1,f=function(e,n){if(n)return e.slice();var t=e.length,o=N?N(t):new e.constructor(t);return e.copy(o),o}(u,!0)):w?(d=!1,h=u,g=!0?(m=h.buffer,b=new m.constructor(m.byteLength),new E(b).set(new E(m)),b):h.buffer,f=new h.constructor(g,h.byteOffset,h.length)):f=[]:function(e){if(!Pe(e)||ce(e)!=c)return!1;var n=B(e);if(null===n)return!0;var t=O.call(n,"constructor")&&n.constructor;return"function"==typeof t&&t instanceof t&&S.call(t)==D}(u)||ye(u)?(f=a,ye(a)?f=function(e){return function(e,n,t,o){var i=!t;t||(t={});var r=-1,s=n.length;for(;++r<s;){var c=n[r],a=o?o(t[c],e[c],c,t,e):void 0;void 0===a&&(a=e[c]),i?ie(t,c,a):te(t,c,a)}return t}(e,Oe(e))}(a):Ae(a)&&!_e(a)||(f=function(e){return"function"!=typeof e.constructor||he(e)?{}:z(B(e))}(u))):d=!1}var h,g,m,b;var y;d&&(s.set(u,f),i(f,u,o,r,s),s.delete(u));ne(e,t,f)}(e,n,s,t,fe,o,i);else{var a=o?o(ge(e,s),r,s+"",e,n,i):void 0;void 0===a&&(a=r),ne(e,s,a)}}),Oe)}function de(e,n){return me(function(e,n,t){return n=J(void 0===n?e.length-1:n,0),function(){for(var o=arguments,i=-1,r=J(o.length-n,0),s=Array(r);++i<r;)s[i]=o[n+i];i=-1;for(var c=Array(n+1);++i<n;)c[i]=o[i];return c[n]=t(s),y(e,this,c)}}(e,n,De),e+"")}function pe(e,n){var t,o,i=e.__data__;return("string"==(o=typeof(t=n))||"number"==o||"symbol"==o||"boolean"==o?"__proto__"!==t:null===t)?i["string"==typeof n?"string":"hash"]:i.map}function ve(e,n){var t=function(e,n){return null==e?void 0:e[n]}(e,n);return ue(t)?t:void 0}function we(e,n){var t=typeof e;return!!(n=null==n?o:n)&&("number"==t||"symbol"!=t&&u.test(e))&&e>-1&&e%1==0&&e<n}function he(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||A)}function ge(e,n){if(("constructor"!==n||"function"!=typeof e[n])&&"__proto__"!=n)return e[n]}var me=function(e){var n=0,t=0;return function(){var o=G(),i=16-(o-t);if(t=o,i>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(void 0,arguments)}}(R?function(e,n){return R(e,"toString",{configurable:!0,enumerable:!1,value:(t=n,function(){return t}),writable:!0});var t}:De);function be(e,n){return e===n||e!=e&&n!=n}var ye=ae(function(){return arguments}())?ae:function(e){return Pe(e)&&O.call(e,"callee")&&!F.call(e,"callee")},ke=Array.isArray;function Ce(e){return null!=e&&xe(e.length)&&!_e(e)}var We=V||function(){return!1};function _e(e){if(!Ae(e))return!1;var n=ce(e);return n==r||"[object GeneratorFunction]"==n||"[object AsyncFunction]"==n||"[object Proxy]"==n}function xe(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=o}function Ae(e){var n=typeof e;return null!=e&&("object"==n||"function"==n)}function Pe(e){return null!=e&&"object"==typeof e}var Se=b?function(e){return function(n){return e(n)}}(b):function(e){return Pe(e)&&xe(e.length)&&!!l[ce(e)]};function Oe(e){return Ce(e)?ee(e,!0):le(e)}var Ie,Te=(Ie=function(e,n,t){fe(e,n,t)},de((function(e,n){var t=-1,o=n.length,i=o>1?n[o-1]:void 0,r=o>2?n[2]:void 0;for(i=Ie.length>3&&"function"==typeof i?(o--,i):void 0,r&&function(e,n,t){if(!Ae(t))return!1;var o=typeof n;return!!("number"==o?Ce(t)&&we(n,t.length):"string"==o&&n in t)&&be(t[n],e)}(n[0],n[1],r)&&(i=o<3?void 0:i,o=1),e=Object(e);++t<o;){var s=n[t];s&&Ie(e,s,t,i)}return e})));function De(e){return e}e.exports=Te}(f,f.exports),f.exports.default,function(e){e.exports=function(e){var n={};function t(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(o,i,function(n){return e[n]}.bind(null,i));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s="./index.ts")}({"../node_modules/webpack/buildin/global.js":
/*!*************************************************!*\
      !*** ../node_modules/webpack/buildin/global.js ***!
      \*************************************************/
/*! no static exports found */function(e,n){var t=function(){return this}();try{t=t||new Function("return this")()}catch(e){"object"==typeof window&&(t=window)}e.exports=t},"./config-constants.ts":
/*!*****************************!*\
      !*** ./config-constants.ts ***!
      \*****************************/
/*! no static exports found */function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.ConfigItem=void 0;var o=(i.getKey=function(e){if(""===this.configName)throw new Error("子类未重命名configName!");return this.configName+"."+e},i.configName="",i);function i(){}n.ConfigItem=o},"./config-manager.ts":
/*!***************************!*\
      !*** ./config-manager.ts ***!
      \***************************/
/*! no static exports found */function(e,n,t){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.DocsConfig=void 0;var i=o(t(/*! lodash.merge */"lodash.merge")),r=o(t(/*! lodash.get */"lodash.get")),s=o(t(/*! lodash.isempty */"lodash.isempty")),c=o(t(/*! lodash.clonedeep */"lodash.clonedeep")),a=t(/*! ./utils */"./utils.ts"),u=(l.prototype.bind=function(e){i.default(this.cache,e)},l.prototype.get=function(e){return r.default(this.cache,e)},l.prototype.clear=function(){this.cache={}},l.prototype.getAll=function(){return this.cache},l);function l(){this.cache={}}function f(){this.cache=new u,this.init()}f.getInstance=function(){return this.instance||(this.instance=new f),this.instance},f.prototype.bind=function(e){s.default(e)||this.cache.bind(e)},f.prototype.clear=function(){this.cache.clear()},f.prototype.getConfig=function(e){return"object"==typeof(e=this.cache.get(e))?c.default(e):e},f.prototype.getAllConfig=function(){var e=null!==(e=this.cache.getAll())&&void 0!==e?e:{};return c.default(e)},f.prototype.saveToSessionStorage=function(e){var n;try{if(window&&window.sessionStorage){var t=null!==(n=null!=e?e:this.cache.getAll())&&void 0!==n?n:{};return window.sessionStorage.setItem("configCache",JSON.stringify(t)),!0}}catch(e){console.error(e)}return!1},f.prototype.loadFromSessionStorage=function(){try{if(!window||!window.sessionStorage)throw new Error("browser is not support sessionStorage");var e=window.sessionStorage.getItem("configCache");if(e)return this.bind(JSON.parse(e)),!0}catch(e){console.error(e)}return!1},f.prototype.init=function(){var e;"undefined"!=typeof window&&("object"==typeof(e=window.AppConfig)?(e=e[a.getURLQuery("mode")]||e.normal,e=i.default(e,null==e?void 0:e.custom),this.bind(e),this.saveToSessionStorage()):console.error("加载 AppConfig 配置出错"))},t=f,n.DocsConfig=t},"./index.ts":
/*!******************!*\
      !*** ./index.ts ***!
      \******************/
/*! no static exports found */function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.ConfigItem=void 0;var o=t(/*! ./config-manager */"./config-manager.ts"),i=t(/*! ./config-constants */"./config-constants.ts");Object.defineProperty(n,"ConfigItem",{enumerable:!0,get:function(){return i.ConfigItem}}),n.default=o.DocsConfig},"./utils.ts":
/*!******************!*\
      !*** ./utils.ts ***!
      \******************/
/*! no static exports found */function(e,n,t){(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.getURLQuery=void 0,n.getURLQuery=function(n,t){var o=null,i=(t?"?"+(t.split("?")[1]||""):null===(i=e.location)||void 0===i?void 0:i.search)||"";return(o=i?i.match(new RegExp("(\\?|&)"+n+"=([^&]*)(&|$)")):o)?decodeURIComponent(o[2]):""}}).call(this,t(/*! ./../node_modules/webpack/buildin/global.js */"../node_modules/webpack/buildin/global.js"))},"lodash.clonedeep":
/*!***********************************!*\
      !*** external "lodash.clonedeep" ***!
      \***********************************/
/*! no static exports found */function(e,n){e.exports=a.exports},"lodash.get":
/*!*****************************!*\
      !*** external "lodash.get" ***!
      \*****************************/
/*! no static exports found */function(e,n){e.exports=u.exports},"lodash.isempty":
/*!*********************************!*\
      !*** external "lodash.isempty" ***!
      \*********************************/
/*! no static exports found */function(e,n){e.exports=l.exports},"lodash.merge":
/*!*******************************!*\
      !*** external "lodash.merge" ***!
      \*******************************/
/*! no static exports found */function(e,n){e.exports=f.exports}})}(c);var d=c.exports.default.getInstance().getConfig('npm["@tencent/tdocs-jsapi"]'),p=function(){return window.location.host},v=(null==d?void 0:d.TOC_HOST)||"docs.qq.com",w=(null==d?void 0:d.TOB_HOST)||"doc.weixin.qq.com",h=(null==d?void 0:d.TOB_COOKIE_DOMAIN)||".doc.weixin.qq.com",g=Object.values((null==d?void 0:d.COOKIE_DOMAINS)||[".weixin.qq.com","weixin.qq.com",".doc.weixin.qq.com","doc.weixin.qq.com"]),m=(null==d?void 0:d.QQJSSDK)||"https://docs.idqqimg.com/tim/docs/sheets/static/js/lib/docs.qqapi.v1.js",b=(null==d?void 0:d.WXJSSDK)||"https://res.wx.qq.com/open/js/jweixin-1.6.0.js",y=(null==d?void 0:d.WW_MOBILE_JSSDK)||"https://res.wx.qq.com/d/tdocs-bridge/v0.0.28/TenOfficeJSBridge.js",k=(null==d?void 0:d.WW_PC_JSSDK)||"https://res.wx.qq.com/d/tdocs-bridge/v0.0.28/wwapp.js",C=(null==d?void 0:d.WW_MOBILE_JSSDK_OLD)||"https://res.wx.qq.com/d/tdocs-bridge/v0.0.30/QMailBridge.js",W=(null==d?void 0:d.WW_PC_JSSDK_OLD)||"https://res.wx.qq.com/d/tdocs-bridge/v0.0.30/WxDriveAdapter.js",_=(null==d?void 0:d.WW_WEMEET_JS_SDK)||"https://res.wx.qq.com/d/tdocs-bridge/v0.0.29/wemeet-js-sdk-1.0.40.js",x=new RegExp((null==d?void 0:d.WEDRIVE_LINK_REGEXP)||"^http(s):\\/\\/drive\\.weixin\\.qq\\.com"),A=new RegExp((null==d?void 0:d.PRIVATE_WEDRIVE_LINK_REGEXP)||"^http(s):\\/\\/drive\\.weixin\\.qq\\.com\\/s\\?"),P=new RegExp((null==d?void 0:d.WEDOC_FORM_LINK_REGEXP)||"^http(s):\\/\\/doc\\.weixin\\.qq\\.com\\/form"),S=new RegExp((null==d?void 0:d.TOC_ORIGIN_REGEXP)||"^https?:\\/\\/docs\\.qq\\.com(\\/|$)"),O=new RegExp((null==d?void 0:d.TOB_ORIGIN_REGEXP)||"^https?:\\/\\/doc\\.weixin\\.qq\\.com(\\/|$)"),I=new RegExp((null==d?void 0:d.APP_WORK_WEIXIN_ADMIN_URL_REGEXP)||"^https?:\\/\\/app\\.work\\.weixin\\.qq\\.com\\/wework_admin"),T=(null==d?void 0:d.TOC_SUPPORT_URL)||"https://support.qq.com/products/28096/",D=(null==d?void 0:d.TOB_SUPPORT_URL)||"https://support.qq.com/products/111603/",j=function(){function e(){}return e.isServerSide=function(){return"undefined"==typeof window},e.getUserAgent=function(){return this.isServerSide()?"":navigator.userAgent},e.getLowerCaseUserAgent=function(){return this.getUserAgent().toLowerCase()},e.isMobile=function(){return/(mobile)/i.test(this.getUserAgent())||/(android)/i.test(this.getUserAgent())},e.isEnterpriseEnv=function(){return p()===w},e.isAndroid=function(){return/(android)/i.test(this.getUserAgent())},e.isIOS=function(){return/(iphone|ipad|ipod)/i.test(this.getUserAgent())},e.isIPad=function(){return/(ipad)/i.test(this.getUserAgent())},e.isAPad=function(){return!/(mobile)/i.test(this.getUserAgent())&&/android/i.test(this.getUserAgent())&&/TencentDocs/i.test(this.getUserAgent())},e.isMac=function(){return!this.isMobile()&&/Mac OS X/i.test(this.getUserAgent())},e.isWindows=function(){return!this.isServerSide()&&/win/i.test(navigator.platform.toLowerCase())},e.isLinux=function(){return!this.isServerSide()&&navigator.platform.includes("Linux")},e.isIE=function(){return/msie/i.test(this.getUserAgent())&&!this.isOpera()||/trident/i.test(this.getUserAgent())},e.isIE9=function(){return!!this.isIE()&&"MSIE9.0"===navigator.appVersion.split(";")[1].replace(/[ ]/g,"")},e.isIE10=function(){return!!this.isIE()&&"MSIE10.0"===navigator.appVersion.split(";")[1].replace(/[ ]/g,"")},e.isIE11=function(){return!window.ActiveXObject&&"ActiveXObject"in window},e.isEdge=function(){return/edge/i.test(this.getUserAgent())},e.isChrome=function(){return/chrome/i.test(this.getUserAgent())},e.isIOSChrome=function(){return/CriOS/i.test(this.getUserAgent())},e.getChromeVersion=function(){var e=this.getUserAgent().match(/Chrom(e|ium)\/([0-9]+)\./);return e?parseInt(e[2],10):0},e.isFireFox=function(){return/firefox/i.test(this.getUserAgent())},e.isOpera=function(){return/opera/i.test(this.getUserAgent())},e.isSafari=function(){return/safari/i.test(this.getUserAgent())},e.isQBFamily=function(){return/QQBrowser/i.test(this.getUserAgent())},e.isMQB=function(){return/MQB/i.test(this.getUserAgent())},e.isMQBFamily=function(){return/MQQBrowser/i.test(this.getUserAgent())},e.isPCQQBrowser=function(){return this.isQBFamily()&&!this.isMobile()&&!/QBCore/i.test(this.getUserAgent())},e.isMobileQQBrowser=function(){return this.isMobile()&&this.isMQBFamily()&&!/TBS/i.test(this.getUserAgent())},e.isQQBrowser=function(){return this.isMobile()?this.isMobileQQBrowser():this.isPCQQBrowser()},e.isWindowStore=function(){return/MSAppHost/i.test(this.getUserAgent())},e.isTimQQ=function(){return/(QQ)/i.test(this.getUserAgent())&&!this.isTencentDocsApp()&&!this.isWeWork()&&!this.isWXh5()&&!this.isQQBrowser()},e.isTim=function(){return/TIM/i.test(this.getUserAgent())},e.isQQ=function(){return this.isTimQQ()&&!this.isTim()},e.isWeMeetApp=function(){return/(tencent_wemeet)/i.test(this.getUserAgent())&&(this.isIOS()||this.isAndroid())},e.isTencentDocsApp=function(){return/TencentDocs/i.test(this.getUserAgent())},e.isTencentDocsIPadApp=function(){return this.isIPad()&&this.isTencentDocsApp()},e.isTencentDocsPhoneApp=function(){return!this.isIPad()&&!this.isAPad()&&this.isTencentDocsApp()},e.getTencentDocsAppVersion=function(){var e="";if(this.isTencentDocsApp()){var n=null;this.isAndroid()?n=this.getUserAgent().match(/TencentDocs\/(\S*).tencentdocs/):this.isIOS()&&(n=this.getUserAgent().match(/TencentDocs\/(\S*)/)),n&&(e=n[1])}return e},e.getQQBrowserVersion=function(){var e="",n=this.getUserAgent().match(/MQQBrowser\/(\S*)/);return n&&(e=n[1]),e},e.checkTencentDocAppVersionSupportFunction=function(e){var n=this.getTencentDocsAppVersion();return this.compareVersion(n,e)>=0},e.checkTencentDocAppVersionLowerSupportFunction=function(e){var n=this.getTencentDocsAppVersion();return this.compareVersion(n,e)<0},e.isTencentDocsPC=function(){return/TxDocsPC/i.test(this.getUserAgent())},e.isTencentDocsDesktopApp=function(){return/TDAppDesktop/i.test(this.getUserAgent())},e.checkAppVersionSupportFunction=function(e){var n=this.getUserAgent().match(/MQQBrowser\/(\S*)/);return!!n&&n[1]>=e},e.getTencentDocsDesktopAppVersion=function(){var e="";if(this.isTencentDocsDesktopApp()){var n=this.getUserAgent().match(/TDAppDesktop\/(\S*)/);n&&(e=n[1])}return e},e.supportNativeToolbar=function(){var e;if(this.isTencentDocsApp()&&!location.href.includes("/aio/")){var n=null===(e=this.getUserAgent().match(/TencentDocs\/(\S*).tencentdocs/))||void 0===e?void 0:e[1];if(this.isAndroid()&&"string"==typeof n&&n>="2.1.5"||(this.isIOS()||this.isIPad())&&this.checkTencentDocAppVersionSupportFunction("2.1.5"))return!0}return!1},e.isPortrait=function(){var e=window.orientation;return 0===e||180===e},e.measureSafeMargin=function(){var e=this.isPortrait().toString();if(!this._margins[e]){this._innerSpan||(this._innerSpan=document.createElement("span")),this._innerSpan.id="safeAreaMarginSpan";var n=["top","bottom"].map((function(e){return"padding-"+e+": constant(safe-area-inset-"+e+"); padding-"+e+": env(safe-area-inset-"+e+");"})).join("");this._innerSpan.style.cssText="position: absolute; top: -50000px; white-space:nowrap; overflow: hidden; "+n,document.body.appendChild(this._innerSpan);var t=window.getComputedStyle(this._innerSpan);this._margins[e]={top:parseInt(t.paddingTop||"0",10)||0,bottom:parseInt(t.paddingBottom||"0",10)||0}}return this._margins[e]},e.isIphoneX=function(){var e=/iphone/gi.test(this.getUserAgent())&&window.devicePixelRatio&&3===window.devicePixelRatio&&(812===window.screen.width&&375===window.screen.height||375===window.screen.width&&812===window.screen.height),n=/iphone/gi.test(this.getUserAgent())&&window.devicePixelRatio&&3===window.devicePixelRatio&&(414===window.screen.width&&896===window.screen.height||896===window.screen.width&&414===window.screen.height),t=/iphone/gi.test(this.getUserAgent())&&window.devicePixelRatio&&2===window.devicePixelRatio&&(414===window.screen.width&&896===window.screen.height||896===window.screen.width&&414===window.screen.height);return e||n||t},e.clearSafeMargin=function(){var e=document.getElementById("safeAreaMarginSpan");e?e.remove():this._innerSpan&&this._innerSpan.remove()},e.getStylePanelHeight=function(){var e=258;if(this.isIOS())if(this.isPortrait()){var n=this.measureSafeMargin().bottom;e+=!this.isIphoneX()||0!==n||this.isWXh5()||this.isQQMiniProgram()?n:32}else e=window.innerHeight/2;else this.isPortrait()||(e=window.innerHeight/2);return e},e.getDocUniqueUrl=function(){var e=window.location.pathname.split("/");return e[e.length-1]||"doc"},e.setStylePanelClick=function(e){this.stylePanelButtonClicked=e},e.isStylePanelClick=function(){return this.stylePanelButtonClicked},e.isQQHD=function(){return/IPadQQ/i.test(this.getUserAgent())},e.isWXFamily=function(){return/MicroMessenger/i.test(this.getUserAgent())},e.isWXorQQMiniProgram=function(){return this.isWXMiniProgram()||this.isQQMiniProgram()},e.isWXMiniProgram=function(){return this.isWXFamily()&&this.isMiniProgram()},e.isQQMiniProgram=function(){return/QQ\/|TIM/i.test(this.getUserAgent())&&this.isMiniProgram()},e.isWeWork=function(){return/(wxwork)/i.test(this.getUserAgent())},e.isWeWorkMacOrWin=function(){return!this.isMobile()&&this.isWeWork()&&/(Windows)|(Macintosh)/i.test(this.getUserAgent())},e.isWeWorkWin=function(){return!this.isMobile()&&this.isWeWork()&&/(Windows)/i.test(this.getUserAgent())},e.isWeWorkLinux=function(){return!this.isMobile()&&this.isWeWork()&&/(Linux)/i.test(this.getUserAgent())},e.isWXh5=function(){return this.isWXFamily()&&!this.isWeWork()&&!this.isWXMiniProgram()},e.isAndroidPad=function(){return!/(mobile)/i.test(this.getUserAgent())&&/(android)/i.test(this.getUserAgent())},e.getBrowser=function(){var e=navigator.userAgent,n=/(msie\s|trident.*rv:)([\w.]+)/,t=/(edge)\/([\w.]+)/,o=/(firefox)\/([\w.]+)/,i=/(opera).+version\/([\w.]+)/,r=/(chrome)\/([\w.]+)/,s=/version\/([\w.]+).*(safari)/,c="other",a="0",u="other",l=e.toLowerCase(),f=navigator.vendor;try{var d=function(e){var c=n.exec(e);return null!==c?{browser:"ie",version:c[2]||"0"}:null!==(c=t.exec(e))?{browser:"edge",version:c[2]||"0"}:null!==(c=r.exec(e))&&/Google/.test(f)?{browser:c[1]||"",version:c[2]||"0"}:null!==(c=s.exec(e))&&/Apple Computer/.test(f)?{browser:c[2]||"",version:c[1]||"0"}:null!==(c=o.exec(e))||null!==(c=i.exec(e))?{browser:c[1]||"",version:c[2]||"0"}:{browser:"other",version:"0"}}(l);d.browser&&(c=d.browser,a=d.version,u=/qqbrowser/.test(l)?"qq":/se/.test(l)&&/metasr/.test(l)?"sougou":/360se/.test(l)?"360":/ucweb/.test(l)?"uc":/2345explorer/.test(l)?"2345":/lbbrowser/.test(l)?"liebao":/maxthon/.test(l)?"maxthon":c)}catch(e){console.error(" getBrowser error: "+e)}return u+"_"+c+"_"+a},e.compareVersion=function(e,n){var t=e.split("."),o=n.split("."),i=parseInt(t[0],10)-parseInt(o[0],10);return 0===i&&e!==n?this.compareVersion(t.splice(1).join("."),o.splice(1).join(".")):i},e.isMiniProgram=function(){var e=window;return/miniprogram|miniapp(?!enable)/i.test(this.getUserAgent())||void 0!==e.__wxjs_environment&&"miniprogram"===e.__wxjs_environment},e._margins={},e.stylePanelButtonClicked=!1,e}(),M={exports:{}};!function(e,n){"undefined"!=typeof window&&window,e.exports=function(e){var n={};function t(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(o,i,function(n){return e[n]}.bind(null,i));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=74)}([function(e,n){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)},function(e,n,t){e.exports=!t(3)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,n,t){var o=t(5);e.exports=function(e){if(!o(e))throw TypeError(e+" is not an object!");return e}},function(e,n){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,n,t){var o=t(18)("wks"),i=t(17),r=t(0).Symbol,s="function"==typeof r;(e.exports=function(e){return o[e]||(o[e]=s&&r[e]||(s?r:i)("Symbol."+e))}).store=o},function(e,n){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,n,t){var o=t(0),i=t(15),r=t(11),s=t(12),c=t(19),a=function(e,n,t){var u,l,f,d,p=e&a.F,v=e&a.G,w=e&a.S,h=e&a.P,g=e&a.B,m=v?o:w?o[n]||(o[n]={}):(o[n]||{}).prototype,b=v?i:i[n]||(i[n]={}),y=b.prototype||(b.prototype={});for(u in v&&(t=n),t)f=((l=!p&&m&&void 0!==m[u])?m:t)[u],d=g&&l?c(f,o):h&&"function"==typeof f?c(Function.call,f):f,m&&s(m,u,f,e&a.U),b[u]!=f&&r(b,u,d),h&&y[u]!=f&&(y[u]=f)};o.core=i,a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,e.exports=a},function(e,n,t){var o=t(2),i=t(25),r=t(16),s=Object.defineProperty;n.f=t(1)?Object.defineProperty:function(e,n,t){if(o(e),n=r(n,!0),o(t),i)try{return s(e,n,t)}catch(e){}if("get"in t||"set"in t)throw TypeError("Accessors not supported!");return"value"in t&&(e[n]=t.value),e}},function(e,n){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,n,t){var o=t(14),i=Math.min;e.exports=function(e){return e>0?i(o(e),9007199254740991):0}},function(e,n){var t={}.toString;e.exports=function(e){return t.call(e).slice(8,-1)}},function(e,n,t){var o=t(7),i=t(27);e.exports=t(1)?function(e,n,t){return o.f(e,n,i(1,t))}:function(e,n,t){return e[n]=t,e}},function(e,n,t){var o=t(0),i=t(11),r=t(13),s=t(17)("src"),c=t(46),a=(""+c).split("toString");t(15).inspectSource=function(e){return c.call(e)},(e.exports=function(e,n,t,c){var u="function"==typeof t;u&&(r(t,"name")||i(t,"name",n)),e[n]!==t&&(u&&(r(t,s)||i(t,s,e[n]?""+e[n]:a.join(String(n)))),e===o?e[n]=t:c?e[n]?e[n]=t:i(e,n,t):(delete e[n],i(e,n,t)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[s]||c.call(this)}))},function(e,n){var t={}.hasOwnProperty;e.exports=function(e,n){return t.call(e,n)}},function(e,n){var t=Math.ceil,o=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?o:t)(e)}},function(e,n){var t=e.exports={version:"2.6.11"};"number"==typeof __e&&(__e=t)},function(e,n,t){var o=t(5);e.exports=function(e,n){if(!o(e))return e;var t,i;if(n&&"function"==typeof(t=e.toString)&&!o(i=t.call(e)))return i;if("function"==typeof(t=e.valueOf)&&!o(i=t.call(e)))return i;if(!n&&"function"==typeof(t=e.toString)&&!o(i=t.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,n){var t=0,o=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++t+o).toString(36))}},function(e,n,t){var o=t(15),i=t(0),r=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,n){return r[e]||(r[e]=void 0!==n?n:{})})("versions",[]).push({version:o.version,mode:t(47)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,n,t){var o=t(28);e.exports=function(e,n,t){if(o(e),void 0===n)return e;switch(t){case 1:return function(t){return e.call(n,t)};case 2:return function(t,o){return e.call(n,t,o)};case 3:return function(t,o,i){return e.call(n,t,o,i)}}return function(){return e.apply(n,arguments)}}},function(e,n,t){var o=t(8);e.exports=function(e){return Object(o(e))}},function(e,n,t){var o=t(32),i=t(8);e.exports=function(e){return o(i(e))}},function(e,n){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,n,t){var o,i,r=t(41),s=RegExp.prototype.exec,c=String.prototype.replace,a=s,u=(o=/a/,i=/b*/g,s.call(o,"a"),s.call(i,"a"),0!==o.lastIndex||0!==i.lastIndex),l=void 0!==/()??/.exec("")[1];(u||l)&&(a=function(e){var n,t,o,i,a=this;return l&&(t=new RegExp("^"+a.source+"$(?!\\s)",r.call(a))),u&&(n=a.lastIndex),o=s.call(a,e),u&&o&&(a.lastIndex=a.global?o.index+o[0].length:n),l&&o&&o.length>1&&c.call(o[0],t,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(o[i]=void 0)})),o}),e.exports=a},function(e,n){function t(n){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=t=function(e){return typeof e}:e.exports=t=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(n)}e.exports=t},function(e,n,t){e.exports=!t(1)&&!t(3)((function(){return 7!=Object.defineProperty(t(26)("div"),"a",{get:function(){return 7}}).a}))},function(e,n,t){var o=t(5),i=t(0).document,r=o(i)&&o(i.createElement);e.exports=function(e){return r?i.createElement(e):{}}},function(e,n){e.exports=function(e,n){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:n}}},function(e,n){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,n,t){var o=t(14),i=Math.max,r=Math.min;e.exports=function(e,n){return(e=o(e))<0?i(e+n,0):r(e,n)}},function(e,n,t){var o=t(4)("unscopables"),i=Array.prototype;null==i[o]&&t(11)(i,o,{}),e.exports=function(e){i[o][e]=!0}},function(e,n,t){var o=t(19),i=t(32),r=t(20),s=t(9),c=t(51);e.exports=function(e,n){var t=1==e,a=2==e,u=3==e,l=4==e,f=6==e,d=5==e||f,p=n||c;return function(n,c,v){for(var w,h,g=r(n),m=i(g),b=o(c,v,3),y=s(m.length),k=0,C=t?p(n,y):a?p(n,0):void 0;y>k;k++)if((d||k in m)&&(h=b(w=m[k],k,g),e))if(t)C[k]=h;else if(h)switch(e){case 3:return!0;case 5:return w;case 6:return k;case 2:C.push(w)}else if(l)return!1;return f?-1:u||l?l:C}}},function(e,n,t){var o=t(10);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==o(e)?e.split(""):Object(e)}},function(e,n,t){var o=t(5),i=t(55).set;e.exports=function(e,n,t){var r,s=n.constructor;return s!==t&&"function"==typeof s&&(r=s.prototype)!==t.prototype&&o(r)&&i&&i(e,r),e}},function(e,n,t){var o=t(56),i=t(27),r=t(21),s=t(16),c=t(13),a=t(25),u=Object.getOwnPropertyDescriptor;n.f=t(1)?u:function(e,n){if(e=r(e),n=s(n,!0),a)try{return u(e,n)}catch(e){}if(c(e,n))return i(!o.f.call(e,n),e[n])}},function(e,n,t){var o=t(36),i=t(22).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(e){return o(e,i)}},function(e,n,t){var o=t(13),i=t(21),r=t(57)(!1),s=t(37)("IE_PROTO");e.exports=function(e,n){var t,c=i(e),a=0,u=[];for(t in c)t!=s&&o(c,t)&&u.push(t);for(;n.length>a;)o(c,t=n[a++])&&(~r(u,t)||u.push(t));return u}},function(e,n,t){var o=t(18)("keys"),i=t(17);e.exports=function(e){return o[e]||(o[e]=i(e))}},function(e,n,t){var o=t(5),i=t(10),r=t(4)("match");e.exports=function(e){var n;return o(e)&&(void 0!==(n=e[r])?!!n:"RegExp"==i(e))}},function(e,n,t){var o=t(66)(!0);e.exports=function(e,n,t){return n+(t?o(e,n).length:1)}},function(e,n,t){var o=t(67),i=RegExp.prototype.exec;e.exports=function(e,n){var t=e.exec;if("function"==typeof t){var r=t.call(e,n);if("object"!=typeof r)throw new TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==o(e))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(e,n)}},function(e,n,t){var o=t(2);e.exports=function(){var e=o(this),n="";return e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.unicode&&(n+="u"),e.sticky&&(n+="y"),n}},function(e,n,t){t(68);var o=t(12),i=t(11),r=t(3),s=t(8),c=t(4),a=t(23),u=c("species"),l=!r((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),f=function(){var e=/(?:)/,n=e.exec;e.exec=function(){return n.apply(this,arguments)};var t="ab".split(e);return 2===t.length&&"a"===t[0]&&"b"===t[1]}();e.exports=function(e,n,t){var d=c(e),p=!r((function(){var n={};return n[d]=function(){return 7},7!=""[e](n)})),v=p?!r((function(){var n=!1,t=/a/;return t.exec=function(){return n=!0,null},"split"===e&&(t.constructor={},t.constructor[u]=function(){return t}),t[d](""),!n})):void 0;if(!p||!v||"replace"===e&&!l||"split"===e&&!f){var w=/./[d],h=t(s,d,""[e],(function(e,n,t,o,i){return n.exec===a?p&&!i?{done:!0,value:w.call(n,t,o)}:{done:!0,value:e.call(t,n,o)}:{done:!1}})),g=h[0],m=h[1];o(String.prototype,e,g),i(RegExp.prototype,d,2==n?function(e,n){return m.call(e,this,n)}:function(e){return m.call(e,this)})}}},function(e,n){e.exports=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}},function(e,n){function t(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}e.exports=function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}},function(e,n,t){var o=t(6);o(o.S+o.F*!t(1),"Object",{defineProperty:t(7).f})},function(e,n,t){e.exports=t(18)("native-function-to-string",Function.toString)},function(e,n){e.exports=!1},function(e,n,t){var o=t(6);o(o.P,"Array",{fill:t(49)}),t(30)("fill")},function(e,n,t){var o=t(20),i=t(29),r=t(9);e.exports=function(e){for(var n=o(this),t=r(n.length),s=arguments.length,c=i(s>1?arguments[1]:void 0,t),a=s>2?arguments[2]:void 0,u=void 0===a?t:i(a,t);u>c;)n[c++]=e;return n}},function(e,n,t){var o=t(6),i=t(31)(5),r=!0;"find"in[]&&Array(1).find((function(){r=!1})),o(o.P+o.F*r,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),t(30)("find")},function(e,n,t){var o=t(52);e.exports=function(e,n){return new(o(e))(n)}},function(e,n,t){var o=t(5),i=t(53),r=t(4)("species");e.exports=function(e){var n;return i(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!i(n.prototype)||(n=void 0),o(n)&&null===(n=n[r])&&(n=void 0)),void 0===n?Array:n}},function(e,n,t){var o=t(10);e.exports=Array.isArray||function(e){return"Array"==o(e)}},function(e,n,t){var o=t(0),i=t(13),r=t(10),s=t(33),c=t(16),a=t(3),u=t(35).f,l=t(34).f,f=t(7).f,d=t(58).trim,p=o.Number,v=p,w=p.prototype,h="Number"==r(t(60)(w)),g="trim"in String.prototype,m=function(e){var n=c(e,!1);if("string"==typeof n&&n.length>2){var t,o,i,r=(n=g?n.trim():d(n,3)).charCodeAt(0);if(43===r||45===r){if(88===(t=n.charCodeAt(2))||120===t)return NaN}else if(48===r){switch(n.charCodeAt(1)){case 66:case 98:o=2,i=49;break;case 79:case 111:o=8,i=55;break;default:return+n}for(var s,a=n.slice(2),u=0,l=a.length;u<l;u++)if((s=a.charCodeAt(u))<48||s>i)return NaN;return parseInt(a,o)}}return+n};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(e){var n=arguments.length<1?0:e,t=this;return t instanceof p&&(h?a((function(){w.valueOf.call(t)})):"Number"!=r(t))?s(new v(m(n)),t,p):m(n)};for(var b,y=t(1)?u(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),k=0;y.length>k;k++)i(v,b=y[k])&&!i(p,b)&&f(p,b,l(v,b));p.prototype=w,w.constructor=p,t(12)(o,"Number",p)}},function(e,n,t){var o=t(5),i=t(2),r=function(e,n){if(i(e),!o(n)&&null!==n)throw TypeError(n+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,n,o){try{(o=t(19)(Function.call,t(34).f(Object.prototype,"__proto__").set,2))(e,[]),n=!(e instanceof Array)}catch(e){n=!0}return function(e,t){return r(e,t),n?e.__proto__=t:o(e,t),e}}({},!1):void 0),check:r}},function(e,n){n.f={}.propertyIsEnumerable},function(e,n,t){var o=t(21),i=t(9),r=t(29);e.exports=function(e){return function(n,t,s){var c,a=o(n),u=i(a.length),l=r(s,u);if(e&&t!=t){for(;u>l;)if((c=a[l++])!=c)return!0}else for(;u>l;l++)if((e||l in a)&&a[l]===t)return e||l||0;return!e&&-1}}},function(e,n,t){var o=t(6),i=t(8),r=t(3),s=t(59),c="["+s+"]",a=RegExp("^"+c+c+"*"),u=RegExp(c+c+"*$"),l=function(e,n,t){var i={},c=r((function(){return!!s[e]()||"​"!="​"[e]()})),a=i[e]=c?n(f):s[e];t&&(i[t]=a),o(o.P+o.F*c,"String",i)},f=l.trim=function(e,n){return e=String(i(e)),1&n&&(e=e.replace(a,"")),2&n&&(e=e.replace(u,"")),e};e.exports=l},function(e,n){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,n,t){var o=t(2),i=t(61),r=t(22),s=t(37)("IE_PROTO"),c=function(){},a=function(){var e,n=t(26)("iframe"),o=r.length;for(n.style.display="none",t(63).appendChild(n),n.src="javascript:",(e=n.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),a=e.F;o--;)delete a.prototype[r[o]];return a()};e.exports=Object.create||function(e,n){var t;return null!==e?(c.prototype=o(e),t=new c,c.prototype=null,t[s]=e):t=a(),void 0===n?t:i(t,n)}},function(e,n,t){var o=t(7),i=t(2),r=t(62);e.exports=t(1)?Object.defineProperties:function(e,n){i(e);for(var t,s=r(n),c=s.length,a=0;c>a;)o.f(e,t=s[a++],n[t]);return e}},function(e,n,t){var o=t(36),i=t(22);e.exports=Object.keys||function(e){return o(e,i)}},function(e,n,t){var o=t(0).document;e.exports=o&&o.documentElement},function(e,n,t){var o=t(38),i=t(2),r=t(65),s=t(39),c=t(9),a=t(40),u=t(23),l=t(3),f=Math.min,d=[].push,p="length",v=!l((function(){}));t(42)("split",2,(function(e,n,t,l){var w;return w="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[p]||2!="ab".split(/(?:ab)*/)[p]||4!=".".split(/(.?)(.?)/)[p]||".".split(/()()/)[p]>1||"".split(/.?/)[p]?function(e,n){var i=String(this);if(void 0===e&&0===n)return[];if(!o(e))return t.call(i,e,n);for(var r,s,c,a=[],l=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),f=0,v=void 0===n?4294967295:n>>>0,w=new RegExp(e.source,l+"g");(r=u.call(w,i))&&!((s=w.lastIndex)>f&&(a.push(i.slice(f,r.index)),r[p]>1&&r.index<i[p]&&d.apply(a,r.slice(1)),c=r[0][p],f=s,a[p]>=v));)w.lastIndex===r.index&&w.lastIndex++;return f===i[p]?!c&&w.test("")||a.push(""):a.push(i.slice(f)),a[p]>v?a.slice(0,v):a}:"0".split(void 0,0)[p]?function(e,n){return void 0===e&&0===n?[]:t.call(this,e,n)}:t,[function(t,o){var i=e(this),r=null==t?void 0:t[n];return void 0!==r?r.call(t,i,o):w.call(String(i),t,o)},function(e,n){var o=l(w,e,this,n,w!==t);if(o.done)return o.value;var u=i(e),d=String(this),p=r(u,RegExp),h=u.unicode,g=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(v?"y":"g"),m=new p(v?u:"^(?:"+u.source+")",g),b=void 0===n?4294967295:n>>>0;if(0===b)return[];if(0===d.length)return null===a(m,d)?[d]:[];for(var y=0,k=0,C=[];k<d.length;){m.lastIndex=v?k:0;var W,_=a(m,v?d:d.slice(k));if(null===_||(W=f(c(m.lastIndex+(v?0:k)),d.length))===y)k=s(d,k,h);else{if(C.push(d.slice(y,k)),C.length===b)return C;for(var x=1;x<=_.length-1;x++)if(C.push(_[x]),C.length===b)return C;k=y=W}}return C.push(d.slice(y)),C}]}))},function(e,n,t){var o=t(2),i=t(28),r=t(4)("species");e.exports=function(e,n){var t,s=o(e).constructor;return void 0===s||null==(t=o(s)[r])?n:i(t)}},function(e,n,t){var o=t(14),i=t(8);e.exports=function(e){return function(n,t){var r,s,c=String(i(n)),a=o(t),u=c.length;return a<0||a>=u?e?"":void 0:(r=c.charCodeAt(a))<55296||r>56319||a+1===u||(s=c.charCodeAt(a+1))<56320||s>57343?e?c.charAt(a):r:e?c.slice(a,a+2):s-56320+(r-55296<<10)+65536}}},function(e,n,t){var o=t(10),i=t(4)("toStringTag"),r="Arguments"==o(function(){return arguments}());e.exports=function(e){var n,t,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(t=function(e,n){try{return e[n]}catch(e){}}(n=Object(e),i))?t:r?o(n):"Object"==(s=o(n))&&"function"==typeof n.callee?"Arguments":s}},function(e,n,t){var o=t(23);t(6)({target:"RegExp",proto:!0,forced:o!==/./.exec},{exec:o})},function(e,n,t){var o=t(6),i=t(31)(1);o(o.P+o.F*!t(70)([].map,!0),"Array",{map:function(e){return i(this,e,arguments[1])}})},function(e,n,t){var o=t(3);e.exports=function(e,n){return!!e&&o((function(){n?e.call(null,(function(){}),1):e.call(null)}))}},function(e,n,t){var o=t(2),i=t(20),r=t(9),s=t(14),c=t(39),a=t(40),u=Math.max,l=Math.min,f=Math.floor,d=/\$([$&`']|\d\d?|<[^>]*>)/g,p=/\$([$&`']|\d\d?)/g;t(42)("replace",2,(function(e,n,t,v){return[function(o,i){var r=e(this),s=null==o?void 0:o[n];return void 0!==s?s.call(o,r,i):t.call(String(r),o,i)},function(e,n){var i=v(t,e,this,n);if(i.done)return i.value;var f=o(e),d=String(this),p="function"==typeof n;p||(n=String(n));var h=f.global;if(h){var g=f.unicode;f.lastIndex=0}for(var m=[];;){var b=a(f,d);if(null===b)break;if(m.push(b),!h)break;""===String(b[0])&&(f.lastIndex=c(d,r(f.lastIndex),g))}for(var y,k="",C=0,W=0;W<m.length;W++){b=m[W];for(var _=String(b[0]),x=u(l(s(b.index),d.length),0),A=[],P=1;P<b.length;P++)A.push(void 0===(y=b[P])?y:String(y));var S=b.groups;if(p){var O=[_].concat(A,x,d);void 0!==S&&O.push(S);var I=String(n.apply(void 0,O))}else I=w(_,d,x,A,S,n);x>=C&&(k+=d.slice(C,x)+I,C=x+_.length)}return k+d.slice(C)}];function w(e,n,o,r,s,c){var a=o+e.length,u=r.length,l=p;return void 0!==s&&(s=i(s),l=d),t.call(c,l,(function(t,i){var c;switch(i.charAt(0)){case"$":return"$";case"&":return e;case"`":return n.slice(0,o);case"'":return n.slice(a);case"<":c=s[i.slice(1,-1)];break;default:var l=+i;if(0===l)return t;if(l>u){var d=f(l/10);return 0===d?t:d<=u?void 0===r[d-1]?i.charAt(1):r[d-1]+i.charAt(1):t}c=r[l-1]}return void 0===c?"":c}))}}))},function(e,n,t){var o=t(0),i=t(33),r=t(7).f,s=t(35).f,c=t(38),a=t(41),u=o.RegExp,l=u,f=u.prototype,d=/a/g,p=/a/g,v=new u(d)!==d;if(t(1)&&(!v||t(3)((function(){return p[t(4)("match")]=!1,u(d)!=d||u(p)==p||"/a/i"!=u(d,"i")})))){u=function(e,n){var t=this instanceof u,o=c(e),r=void 0===n;return!t&&o&&e.constructor===u&&r?e:i(v?new l(o&&!r?e.source:e,n):l((o=e instanceof u)?e.source:e,o&&r?a.call(e):n),t?this:f,u)};for(var w=function(e){e in u||r(u,e,{configurable:!0,get:function(){return l[e]},set:function(n){l[e]=n}})},h=s(l),g=0;h.length>g;)w(h[g++]);f.constructor=u,u.prototype=f,t(12)(o,"RegExp",u)}t(73)("RegExp")},function(e,n,t){var o=t(0),i=t(7),r=t(1),s=t(4)("species");e.exports=function(e){var n=o[e];r&&n&&!n[s]&&i.f(n,s,{configurable:!0,get:function(){return this}})}},function(e,n,t){t.r(n),t.d(n,"UserAgent",(function(){return v})),t.d(n,"getVersionFromUA",(function(){return p})),t.d(n,"compareVersion",(function(){return d}));var o=t(24),i=t.n(o),r=(t(45),t(43)),s=t.n(r),c=t(44),a=t.n(c),u=(t(48),t(50),t(54),t(64),t(69),t(71),t(72),/\d+([._]\d+)*/);function l(e){var n,t=u.exec(e);return null!==(n=null==t?void 0:t[0].replace(/_/g,"."))&&void 0!==n?n:null}function f(e){var n=l(e);return(null==n?void 0:n.split(".").map(Number))||[]}function d(e,n){return t=f(e),o=f(n),(i=Array(Math.max(t.length,o.length)).fill(0).map((function(e,n){return(t[n]||0)-(o[n]||0)})).find((function(e){return 0!==e}))||0)<0?-1:i>0?1:0;var t,o,i}function p(e,n){var t;try{t=new RegExp("\\b".concat(e,"\\W+\\d+([\\._]\\d+)*"),"i")}catch(e){return null}var o=t.exec(n);return o?l(o[0].substring(e.length)):null}var v=function(){function e(n){var t=this;s()(this,e),this.userAgent="",this.getAndroidVersion=function(){return t.isAndroid?p("Android",t.userAgent):null},this.isAndroidVersionAboveOrEqual=function(e){return d(t.getAndroidVersion()||"",e)>=0},this.getIOSVersion=function(){return t.isIOS?p("OS",t.userAgent):null},this.isIOSVersionAboveOrEqual=function(e){return d(t.getIOSVersion()||"",e)>=0},this.getPCQQBrowserVersion=function(){return t.isPCQQBrowser?p("QQBrowser",t.userAgent):null},this.isPCQQBrowserVersionAboveOrEqual=function(e){return d(t.getPCQQBrowserVersion()||"",e)>=0},this.getMobileQQBrowserVersion=function(){return t.isMobileQQBrowser?p("MQQBrowser",t.userAgent):null},this.isMobileQQBrowserVersionAboveOrEqual=function(e){return d(t.getMobileQQBrowserVersion()||"",e)>=0},this.getChromeVersion=function(){return p("Chrome",t.userAgent)},this.isChromeVersionAboveOrEqual=function(e){return d(t.getChromeVersion()||"",e)>=0},this.getWeChatVersion=function(){return t.isWeChat||t.isWxMiniProgram?p("MicroMessenger",t.userAgent):null},this.isWeChatVersionAboveOrEqual=function(e){return d(t.getWeChatVersion()||"",e)>=0},this.getWxDriveVersion=function(){return t.isWxDrive?p("WXDrive",t.userAgent):null},this.isWxDriveVersionAboveOrEqual=function(e){return d(t.getWxDriveVersion()||"",e)>=0},this.getWxWorkVersion=function(){return t.isWxWork?p("wxwork",t.userAgent):null},this.isWxWorkVersionAboveOrEqual=function(e){return d(t.getWxWorkVersion()||"",e)>=0},this.getQQVersion=function(){return t.isQQ||t.isQQMiniProgram?p("QQ",t.userAgent):null},this.isQQVersionAboveOrEqual=function(e){return d(t.getQQVersion()||"",e)>=0},this.getTimVersion=function(){return t.isTim?p("TIM",t.userAgent):null},this.isTimVersionAboveOrEqual=function(e){return d(t.getTimVersion()||"",e)>=0},this.getTencentDocsAppVersion=function(){return p("TencentDocs",t.userAgent)},this.isTencentDocsAppVersionAboveOrEqual=function(e){return d(t.getTencentDocsAppVersion()||"",e)>=0},this.getPCTencentDocsClientVersion=function(){return p("TxDocsPC",t.userAgent)},this.isPCTencentDocsClientVersionAboveOrEqual=function(e){return d(t.getPCTencentDocsClientVersion()||"",e)>=0},this.getElectronTencentDocsClientVersion=function(){return p("TDAppDesktop",t.userAgent)},this.isElectronTencentDocsClientVersionAboveOrEqual=function(e){return d(t.getElectronTencentDocsClientVersion()||"",e)>=0},void 0===n&&(n="undefined"!=typeof navigator?navigator.userAgent:""),Object.defineProperty(this,"userAgent",{value:n,writable:!1})}return a()(e,[{key:"isMobile",get:function(){return/(mobile)/i.test(this.userAgent)||this.isAndroidPad}},{key:"isMobilePhone",get:function(){return/(mobile)/i.test(this.userAgent)&&!this.isIPad}},{key:"isIPhone",get:function(){return/(iphone)/i.test(this.userAgent)}},{key:"isIPad",get:function(){return/(ipad)/i.test(this.userAgent)}},{key:"isAndroidPhone",get:function(){return/(mobile)/i.test(this.userAgent)&&this.isAndroid}},{key:"isAndroidPad",get:function(){return!/(mobile)/i.test(this.userAgent)&&this.isAndroid}},{key:"isPC",get:function(){return!this.isMobile}},{key:"isMac",get:function(){return!this.isMobile&&/Mac OS X/i.test(this.userAgent)}},{key:"isIPadEmulatedMac",get:function(){return this.isMac&&navigator.maxTouchPoints>1}},{key:"isAndroid",get:function(){return/android|adr/i.test(this.userAgent)}},{key:"isIOS",get:function(){return/(iphone|ipad|ipod)/i.test(this.userAgent)}},{key:"isWindows",get:function(){return/(win64|wow64|win32|wow32|windows nt)/i.test(this.userAgent)}},{key:"isWindowsUWP",get:function(){return/MSAppHost/i.test(this.userAgent)}},{key:"isLinux",get:function(){return/linux/i.test(this.userAgent)&&!this.isAndroid}},{key:"isLinuxKylin",get:function(){return/linux-kylin/i.test(this.userAgent)}},{key:"isLinuxUOS",get:function(){return/linux-uos/i.test(this.userAgent)}},{key:"isPCQQBrowser",get:function(){return!this.isMobile&&/QQBrowser/i.test(this.userAgent)&&!/QBCore/i.test(this.userAgent)}},{key:"isMobileQQBrowser",get:function(){return this.isMobile&&/MQQBrowser/i.test(this.userAgent)&&!this.isTimOrQQ&&!this.isWeChat&&!this.isWxWork&&!this.isTencentDocsApp&&!this.isWeiYunApp&&!this.isMiniProgram}},{key:"isQQBrowser",get:function(){return this.isMobile?this.isMobileQQBrowser:this.isPCQQBrowser}},{key:"isChrome",get:function(){return/(Chrome|CriOS)\/\S+( Mobile\S*)? Safari\/\S+$/i.test(this.userAgent)}},{key:"isSafari",get:function(){return/Version\/\S+( Mobile\S*)? Safari\/\S+$/i.test(this.userAgent)}},{key:"isIE",get:function(){return/MSIE/i.test(this.userAgent)&&!/opera/i.test(this.userAgent)||/Trident/i.test(this.userAgent)}},{key:"isOldEdge",get:function(){return/Edge/i.test(this.userAgent)}},{key:"isChromiumEdge",get:function(){return/Edg\//i.test(this.userAgent)}},{key:"isFirefox",get:function(){return/(Firefox|Focus|FxiOS)\//i.test(this.userAgent)}},{key:"isWeChat",get:function(){return/MicroMessenger/i.test(this.userAgent)&&!this.isWxWork&&!this.isWxMiniProgram}},{key:"isWxWork",get:function(){return/(wxwork)/i.test(this.userAgent)}},{key:"isWxDrive",get:function(){return/WXDrive/i.test(this.userAgent)}},{key:"isQQ",get:function(){return/QQ\//i.test(this.userAgent)&&!this.isTencentDocsApp&&!this.isQQMiniProgram&&!this.isTim}},{key:"isQQForGooglePlay",get:function(){return/QQ\//i.test(this.userAgent)&&/_GM/i.test(this.userAgent)}},{key:"isTim",get:function(){return/TIM/i.test(this.userAgent)}},{key:"isPCTim",get:function(){return/QBCore/i.test(this.userAgent)&&/TIM2.0/i.test(this.userAgent)}},{key:"isTimOrQQ",get:function(){return this.isTim||this.isQQ}},{key:"isTimOrQQFamily",get:function(){return this.isTim||/QQ/i.test(this.userAgent)}},{key:"isMiniProgram",get:function(){return/miniprogram|miniapp(?!enable)/i.test(this.userAgent)||"undefined"!=typeof __wxjs_environment&&"miniprogram"===__wxjs_environment}},{key:"isWxMiniProgram",get:function(){return/MicroMessenger/i.test(this.userAgent)&&this.isMiniProgram}},{key:"isQQMiniProgram",get:function(){return/QQ\/|TIM/i.test(this.userAgent)&&this.isMiniProgram}},{key:"isWxNativeMiniProgram",get:function(){return!this.isQQNativeMiniProgram&&"object"===("undefined"==typeof wx?"undefined":i()(wx))&&"function"==typeof wx.canIUse&&!0===wx.canIUse("request")}},{key:"isQQNativeMiniProgram",get:function(){return"object"===("undefined"==typeof qq?"undefined":i()(qq))&&"function"==typeof qq.canIUse&&!0===qq.canIUse("request")}},{key:"isNativeMiniProgram",get:function(){return this.isWxNativeMiniProgram||this.isQQNativeMiniProgram}},{key:"isTencentDocsApp",get:function(){return/TencentDocs/i.test(this.userAgent)}},{key:"isPCTencentDocsClient",get:function(){return/TxDocsPC/i.test(this.userAgent)}},{key:"isPCTencentDocsApp",get:function(){return this.isPCTencentDocsClient}},{key:"isElectronTencentDocsClient",get:function(){return/TDAppDesktop/i.test(this.userAgent)}},{key:"isWeiYunApp",get:function(){return/weiyun/i.test(this.userAgent)}},{key:"isSouGou",get:function(){return/SE 2\.X MetaSr 1\.0/i.test(this.userAgent)}},{key:"isTencentMeeting",get:function(){return/tencent_wemeet/i.test(this.userAgent)}}]),e}();n.default=new v}])}(M);var U,E,N,B,L,F,Q,q,R,V=M.exports.default;!function(e){e.IsQQ="IsQQ",e.isQQMiniProgram="isQQMiniProgram",e.isTencentDocsApp="isTencentDocsApp",e.isElectronTencentDocsClient="isElectronTencentDocsClient",e.isWXh5="isWXh5",e.isWeWork="isWeWork",e.isWeWorkApp="isWeWorkApp",e.isTencentMeeting="isTencentMeeting",e.UNKNOW="UNKNOW"}(U||(U={})),function(e){e.Android="android",e.IOS="ios",e.Windows="windows",e.Mac="mac",e.Linux="linux"}(E||(E={})),function(e){e[e.Direct=0]="Direct",e[e.Detail=1]="Detail",e[e.Browser=2]="Browser"}(N||(N={})),function(e){e[e.show=0]="show",e[e.hide=1]="hide",e[e.disable=2]="disable"}(B||(B={})),function(e){e.image="image",e.text="text",e.collaborator="collaborator",e.offline="offline",e.separator="separator"}(L||(L={})),function(e){e[e.left=0]="left",e[e.right=1]="right",e[e.middle=2]="middle"}(F||(F={})),function(e){e.share="0",e.more="1",e.starOff="2",e.starOn="3",e.back="4",e.undo="5",e.redo="6",e.expand="7",e.edit="8",e.play="9",e.toolbarTick="10",e.eye="11",e.addCollaborator="12",e.collaborator="13",e.notification="14",e.discussion="16"}(Q||(Q={})),function(e){e[e.normal=0]="normal",e[e.red=1]="red"}(q||(q={})),function(e){e[e.Back=0]="Back",e[e.Eye=1]="Eye",e[e.Share=2]="Share",e[e.More=3]="More",e[e.Undo=4]="Undo",e[e.Redo=5]="Redo",e[e.AddCollaborator=6]="AddCollaborator",e[e.Collaborator=7]="Collaborator",e[e.Notification=8]="Notification",e[e.Discussion=11]="Discussion"}(R||(R={}));var J,G=function(){function e(){this.platform=Y()}return e.getInstance=function(){return this.instance||(this.instance=new this)},e.prototype.invokeNative=function(n,t){switch(void 0===t&&(t=e.defaultInvokeParams),this.platform){case E.Android:this.invokeAndroid(n,t);break;case E.Mac:case E.IOS:this.invokeMacOrIOS(n,t);break;case E.Windows:this.invokeWindows(n,t);break;case E.Linux:this.invokeLinux(n,t);break;default:console.error("未知的平台")}},e.prototype.invokeAndroid=function(e,n){var t,o,i=JSON.stringify(n);K?"function"==typeof(null===(t=window.JSCallJavaMgr)||void 0===t?void 0:t.postMessage)?window.JSCallJavaMgr.postMessage(i):console.warn("Not In WeMeet Controller App"):(null===(o=window.JSCallJavaMgr)||void 0===o?void 0:o[e])?window.JSCallJavaMgr[e](i):console.warn("Not In ANDROID WeMeet App")},e.prototype.invokeMacOrIOS=function(e,n){var t,o=null===(t=window.webkit)||void 0===t?void 0:t.messageHandlers,i=o&&o[e];(null==i?void 0:i.postMessage)?i.postMessage(JSON.stringify(n)):console.warn("Not In WeMeet App")},e.prototype.invokeWindows=function(e,n){var t,o=null===(t=window.external)||void 0===t?void 0:t.nativeCall,i=n.module,r=n.method,s=n.param,c=n.callback,a=n.callId;o?o(e,[i,r,s,c,a],(function(){})):console.warn("Not In WeMeet App")},e.prototype.invokeLinux=function(e,n){var t,o=null===(t=window.QtWeb)||void 0===t?void 0:t.JsCall,i=n.module,r=n.method,s=n.param,c=n.callback,a=n.callId;o?o(e,[i,r,s,c,a],(function(){})):console.warn("Not In WeMeet App")},e.defaultInvokeParams={module:"",method:"",param:{},callback:"",callId:""},e}(),X="undefined"==typeof window;function $(e){return t(this,void 0,void 0,(function(){var n;return o(this,(function(t){switch(t.label){case 0:if(!J)throw new Error("请先加载sdk");return[4,J];case 1:return t.sent(),(n={})[U.isWeWork]=te()?window.qmailBridge:ee()?window.wwapp:{},n[U.IsQQ]=window.mqq,n[U.isQQMiniProgram]=window.mqq,n[U.isTencentDocsApp]=window.mqq,n[U.isElectronTencentDocsClient]=window.mqq,n[U.isWXh5]={},n[U.isWeWorkApp]=oe()?window.TenOfficeJSBridge:ie()?window.qmailBridge:window.WeixinJSBridge,n[U.isTencentMeeting]=G.getInstance(),n[U.UNKNOW]={},[2,n[e]]}}))}))}var z=j.getUserAgent().includes("app/tencent_wemeet"),K=j.getUserAgent().includes("app/tencent_wemeet_controller");function H(){var e=U.UNKNOW;return z?e=U.isTencentMeeting:j.isQQ()||j.isQQMiniProgram()||j.isTencentDocsApp()?e=U.isTencentDocsApp:V.isElectronTencentDocsClient?e=U.isElectronTencentDocsClient:j.isWXh5()?e=U.isWXh5:j.isWeWork()&&(e=j.isWeWorkMacOrWin()||re()&&j.isWeWorkLinux()?U.isWeWork:U.isWeWorkApp),e}function Y(){return j.isAndroid()?E.Android:j.isIOS()?E.IOS:j.isWindows()?E.Windows:j.isMac()?E.Mac:j.isLinux()?E.Linux:void 0}function Z(){var e=j.getLowerCaseUserAgent().match(/wxwork\/([0-9.]*)/);return e?e[1]:""}function ee(){if(re())return j.compareVersion(se(),"2.6.15")>=0;if(j.isMobile())return oe();if(te())return!1;var e=j.compareVersion(Z(),"3.1.18")>=0;return!(e&&p()===v&&j.isMac()&&!/WeComCEF/i.test(j.getUserAgent()))&&e}function ne(){return/embeddisk/.test(j.getLowerCaseUserAgent())||j.isMac()&&j.compareVersion(Z(),"4.1.0")>=0}function te(){return!re()&&/WXDrive/i.test(j.getLowerCaseUserAgent())}function oe(){var e,n;return/wdocs/i.test(j.getLowerCaseUserAgent())||j.isIOS()&&!!(null===(n=null===(e=window.webkit)||void 0===e?void 0:e.messageHandlers)||void 0===n?void 0:n.TenOfficeJSBridge)||j.isAndroid()&&!!window.TenOfficeJSBridgeAndroid}function ie(){return!j.isServerSide()&&!window.WeixinJSBridge}function re(){return/wxworklocal/i.test(j.getLowerCaseUserAgent())}function se(){var e=j.getLowerCaseUserAgent().match(/wxworklocal\/([0-9.]*)/);return e?e[1]:""}function ce(e,n){var i={};return Object.keys(e).forEach((function(s){var c=s,a=e[c];i[c]=function(e,n,i){var s=this;return function(c){return void 0===c&&(c={}),t(s,void 0,Promise,(function(){var s,a=this;return o(this,(function(u){switch(u.label){case 0:return[4,$(e)];case 1:if(!(s=u.sent()))throw new Error("当前环境无jssdk，"+e);return[2,new Promise((function(u,l){return t(a,void 0,void 0,(function(){var t,a,f;return o(this,(function(o){c||(c={}),t=null==c?void 0:c.success,c.success=function(n){null==t||t(n),u(n),he({module:"tdocs_jsapi",opername:"tdocs_jsapi_sdk",action:"invoke_func_success",ver8:i,ver9:le()||location.pathname,ver10:e}),console.warn("tdocs call "+i+" success!, res => "+JSON.stringify(n))},a=null==c?void 0:c.fail,c.fail=function(n){var t,o;null==a||a(n),l(n),"log"!==i&&(null===(o=null===(t=window.tdocs)||void 0===t?void 0:t.log)||void 0===o||o.call(t,{level:"error",message:"tdocs call "+i+" failed! res => "+JSON.stringify(n)})),he({module:"tdocs_jsapi",opername:"tdocs_jsapi_sdk",action:"invoke_func_fail",ver8:i,ver9:le()||location.pathname,ver10:e}),console.error("tdocs call "+i+" fail!, res => "+JSON.stringify(n))};try{f=n(s,c),!(d=f)||"object"!==r(d)&&"function"!=typeof d||"function"!=typeof d.then||f.then(c.success).catch(c.fail)}catch(e){c.fail(e)}var d;return[2]}))}))}))]}}))}))}}(n,a,c)})),i}function ae(n){var t,o=n.buttons,i=((t={})[Q.back]=R.Back,t[Q.eye]=R.Eye,t[Q.addCollaborator]=R.AddCollaborator,t[Q.collaborator]=R.Collaborator,t[Q.share]=R.Share,t[Q.more]=R.More,t[Q.undo]=R.Undo,t[Q.redo]=R.Redo,t);j.compareVersion(Z(),"4.0.6")>=0&&(i[Q.notification]=R.Notification),j.compareVersion(Z(),"4.0.20")>=0&&(i[Q.discussion]=R.Discussion);var r={0:F.left,1:F.middle,2:F.right},s=[];return o.forEach((function(e){var n,t,o;if(e.type===L.collaborator){var c={id:e.id,type:L.image,icon:Q.collaborator===e.url?i[Q.collaborator]:R.Eye,position:r[e.position],state:e.state,onclick:e.onclick,canClickWhenDisabled:!!e.canClickWhenDisabled,badge:""};(null===(n=e.collaborators)||void 0===n?void 0:n.length)&&(null===(t=e.collaborators)||void 0===t?void 0:t.length)>1&&(c.badge=String(e.collaborators.length)),e.badge&&(c.badge=e.badge),s.push(c)}else if(function(e){return e.type===L.image}(e)){var a=i[e.url];if(void 0===a)return;s.push({id:e.id,type:e.type,icon:a,position:r[e.position],state:e.state,onclick:e.onclick,canClickWhenDisabled:!!e.canClickWhenDisabled,badge:e.badge,badgeStyle:e.badgeStyle})}else s.push({id:e.id,type:e.type,text:null===(o=e)||void 0===o?void 0:o.text,position:r[e.position],state:e.state,onclick:e.onclick,canClickWhenDisabled:!!e.canClickWhenDisabled,badge:e.badge,badgeStyle:e.badgeStyle})})),e(e({},n),{buttons:s})}function ue(e,n){var t=Object.keys(e).map((function(n){return"wwapp_"+n+"="+encodeURIComponent(e[n])})).join("&");fetch("/cgi/gateway/consume_cst?from_tdocs_jsapi=1&"+t).then((function(e){return e.json()})).then((function(e){var t,o;return 0===(null==e?void 0:e.retcode)?null===(t=null==n?void 0:n.success)||void 0===t?void 0:t.call(n,e):null===(o=null==n?void 0:n.fail)||void 0===o?void 0:o.call(n,e)})).catch((function(e){var t;return null===(t=null==n?void 0:n.fail)||void 0===t?void 0:t.call(n,e)}))}function le(e){void 0===e&&(e=location.href);var n=new URL(e),t=n.searchParams.get("docid");if(t)return t;var o=n.searchParams.get("form_id")||n.searchParams.get("formId");if(o)return o;var i=/^\/(doc|sheet|forms|slide|flowchart|mind|blankpage|smartsheet|form\/page)\/(.+)\/?/.exec(n.pathname);return i?i[2]:""}function fe(){return/^\/(doc|sheet|forms|slide|flowchart|mind|mall|blankpage|smartsheet|scenario|form\/page|home)\/(.+)\/?/.exec(location.pathname)}function de(e){console.warn("------设置新的cookie-------",e),document.cookie=encodeURIComponent(e.key)+"="+encodeURIComponent(e.value)+(e.expires?"; expires="+e.expires:"")+(e.domain?"; domain="+e.domain:"")+"; path="+(e.path||"/")+(e.secure?"; secure":"")}function pe(n){de(e(e({},n),{value:"",expires:"Thu, 01 Jan 1970 00:00:00 GMT"}))}function ve(e){var n=new RegExp("(?:^|;+|\\s+)"+e+"=([^;]*)"),t=null;return window.document&&(t=window.document.cookie.match(n)),t?decodeURIComponent(t[1]):""}function we(e){e=""+e;return"[TDOCS]["+(new Date).toLocaleString()+"]["+(le()||location.pathname)+"]["+(window.__globalReleaseVersion||"")+"] "+e.replace(/(http:\/\/|https:\/\/)?(doc.weixin.qq.com|docs.qq.com)/gi,"TDOC_HOSTNAME")}function he(e){var n,t;try{null===(t=null===(n=window.tencentDocReport)||void 0===n?void 0:n.tdw)||void 0===t||t.call(n,e)}catch(e){}}function ge(e){var n=null;return function(t){return n||(n=e(t).then((function(e){return n=null,e})).catch((function(e){throw n=null,e}))),n}}var me=function(e,t){if(oe()){var o=t.success,i=t.fail,r=n(t,["success","fail"]);return e.invoke({func:"readSystemClipboard",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))}e.readFromPasteBoard().then((function(e){var n;null===(n=t.success)||void 0===n||n.call(t,{html:(null==e?void 0:e.html)||"",plain:(null==e?void 0:e.value)||""})})).catch(t.fail)},be=function(e,t){if(oe()){var o=t.success,i=t.fail,r=n(t,["success","fail"]);return e.invoke({func:"writeSystemClipboard",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))}e.writeToPasteBoard({html:t.html||"",value:t.plain||""}).then(t.success).catch(t.fail)};function ye(e,t,o,i){var r=o.success,s=o.fail,c=n(o,["success","fail"]);console.log(e,"params",c),t.invoke({func:e,params:c,namespace:i}).then((function(n){0===n.code?null==r||r(n.data):(console.log(e,"返回code不为0",n.msg),null==s||s(n.msg,n.code))})).catch((function(e){console.log("调用失败"),null==s||s(e)}))}function ke(e,n,t,o){var i=We(t);return console.log(e,"params",i),new Promise((function(t,r){n.invoke({func:e,params:i,namespace:o}).then((function(n){0===n.code?t(n.data):(console.log(e,"返回code不为0",n.msg),r(n))})).catch((function(e){console.log("调用失败",e),r(e)}))}))}function Ce(e,n){return new Promise((function(t){var o;null===(o=window.WeixinJSBridge)||void 0===o||o.invoke(e,We(n),t)}))}function We(e){var t=e||{};return t.success,t.fail,n(t,["success","fail"])}var _e=function(e,n){ye("isWeDriveEnabled",e,n)},xe=function(e,n){ye("chooseWeDriveFile",e,n)},Ae=function(e,n){ye("chooseTencentOfficeFile",e,n)},Pe=function(e,t){if(console.log(e,t),!oe())return e.discuss(We(t));var o=t.success,i=t.fail,r=n(t,["success","fail"]);return e.invoke({func:"discuss",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))},Se=function(e,n){if(!oe())return e.forwardToConversion(We(n));ye("shareDoc",e,n)},Oe=function(e,n){ye("fileDownload",e,n)},Ie=function(e,n){console.log("开始调用企业微信接口111"),ye("openCamera",e,n)},Te=function(e,n){var t;null===(t=null==n?void 0:n.success)||void 0===t||t.call(n,Z())},De=function(e,n){var t;null===(t=null==n?void 0:n.success)||void 0===t||t.call(n,j.compareVersion(Z(),(null==n?void 0:n.version)||""))},je=function(e,n){var t;null===(t=null==n?void 0:n.success)||void 0===t||t.call(n,ee())},Me=function(e,i){return t(void 0,void 0,Promise,(function(){var t,r,s;return o(this,(function(o){return console.log(e,i),oe()?(t=i.success,r=i.fail,s=n(i,["success","fail"]),[2,e.invoke({func:"onUnload",params:s}).then((function(e){0===e.code?(t||Promise.resolve)(e.data):(r||Promise.reject)(e.msg)}))]):[2,e.onUnload(We(i))]}))}))},Ue=function(e,n){return t(void 0,void 0,Promise,(function(){return o(this,(function(t){switch(t.label){case 0:return console.log("addEventListener 开始监听"),[4,$(U.isWeWorkApp)];case 1:return t.sent().addEventListener(e,n),[2]}}))}))},Ee=function(e,n){return t(void 0,void 0,Promise,(function(){var t;return o(this,(function(o){switch(o.label){case 0:return[4,$(U.isWeWorkApp)];case 1:return t=o.sent(),console.log("removeEventListener",e),t.removeEventListener(e,n),[2]}}))}))};function Ne(e,n){return void 0!==e?e:!!n&&!!ve("wedoc_openid")&&fe()&&(j.isMobile()||j.isMac()?j.compareVersion(Z(),"4.0.10")>=0:j.compareVersion(Z(),"4.0.6")>=0)?1:void 0}function Be(e,n){var t=Object.keys(e).map((function(n){return"wwapp_"+n+"="+encodeURIComponent(e[n])})).join("&");fetch("/disklogin/login?from_tdocs_jsapi=1&product=2&from=2&f=json&"+t).then((function(e){return e.json()})).then((function(e){var t,o,i;return 0===(null===(t=null==e?void 0:e.head)||void 0===t?void 0:t.ret)?null===(o=null==n?void 0:n.success)||void 0===o?void 0:o.call(n,e):null===(i=null==n?void 0:n.fail)||void 0===i?void 0:i.call(n,e)})).catch((function(e){var t;return null===(t=null==n?void 0:n.fail)||void 0===t?void 0:t.call(n,e)}))}function Le(e){return!!e&&!!(""+e).match(/^\d+$/)}function Fe(e){return!!e&&!(""+e).match(/^\d+$/)&&!(""+e).match(/@/)}function Qe(e){return""+e=="4294967304"}var qe=function(n,i){return t(void 0,void 0,void 0,(function(){var t,r,s,c,a,u,l,f;return o(this,(function(o){switch(o.label){case 0:return t=Ne(i.useOpenid,i.canUseOpenid||!!(null===(u=i.selectedUserOpenIds)||void 0===u?void 0:u.length)||!!(null===(l=i.selectedOpenIds)||void 0===l?void 0:l.length)),oe()?[3,3]:ie()?[2,n.selectPerson(We(i))]:[3,1];case 1:return r=i.selectedVid||i.selectedUserIds,s=i.selectedOpenIds||i.selectedUserOpenIds,[4,Ce("wwapp.selectContacts",e(e({docid:le()},i),{useOpenid:t,selectedVid:t?void 0:r&&r.filter((function(e){return Le(e)})),selectedOpenIds:t?s||r&&r.filter((function(e){return Fe(e)})):void 0}))];case 2:return c=o.sent(),(null===(f=null==c?void 0:c.selectedContacts)||void 0===f?void 0:f.length)?t?[2,{persons:c.selectedContacts.map((function(n){return e(e({},n),{vid:n.openid})}))}]:[2,{persons:c.selectedContacts}]:[2,Promise.reject(c)];case 3:return t?[4,ke("selectPerson",n,e(e({docid:le()},i),{useOpenid:t,selectedUserOpenIds:i.selectedUserOpenIds||i.selectedUserIds&&i.selectedUserIds.filter((function(e){return Fe(e)})),selectedUserIds:void 0}))]:[2,ke("selectPerson",n,e(e({},i),{selectedUserIds:i.selectedUserIds&&i.selectedUserIds.filter((function(e){return Le(e)}))}))];case 4:return a=o.sent(),[2,e(e({},a),{persons:a.persons&&a.persons.map((function(n){return e(e({},n),{vid:n.openid})}))})]}}))}))},Re=function(n,i){return t(void 0,void 0,void 0,(function(){var t;return o(this,(function(o){return t=i.openid||i.useOpenid||!Le(i.vid)?1:void 0,Qe(i.openid||i.vid)||t&&j.compareVersion(Z(),"4.0.10")<0?[2,Promise.resolve({})]:t&&!Fe(i.openid||i.vid)?[2,Promise.reject({err_msg:(i.openid||i.vid)+" is not openid"})]:oe()?t?[2,ke("viewProfile",n,e(e({docid:le()},i),{useOpenid:t,openid:i.openid||i.vid,vid:void 0}))]:[2,ke("viewProfile",n,i)]:ie()?[2,n.viewProfile(We(i))]:t?[2,Ce("wwapp.openContactProfile",e(e({docid:le()},i),{useOpenid:t,openid:i.openid||i.vid,vid:void 0}))]:[2,Ce("wwapp.openContactProfile",e(e({},i),{vid:j.isIOS()?Number(i.vid):i.vid}))]}))}))},Ve=function(e,t){if(!oe())return e.updateAuthority(We(t));var o=t.success,i=t.fail,r=n(t,["success","fail"]);return e.invoke({func:"updateAuthority",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))},Je=function(n,t){var o,i,r=Ne(t.useOpenid,!!(null===(o=t.online_users_detail)||void 0===o?void 0:o.find((function(e){return Fe(e.openid)}))));ye("showCollaboratorPanel",n,e(e({docid:le()},t),{useOpenid:r,online_users_detail:null===(i=t.online_users_detail)||void 0===i?void 0:i.filter((function(e){return r?Fe(e.openid):Le(e.uin)}))}))},Ge=function(n,t){var o,i,r=Ne(t.useOpenid,!!(null===(o=t.online_users_detail)||void 0===o?void 0:o.find((function(e){return Fe(e.openid)}))));ye("updateOnlineUserList",n,e(e({docid:le()},t),{useOpenid:r,online_users_detail:null===(i=t.online_users_detail)||void 0===i?void 0:i.filter((function(e){return r?Fe(e.openid):Le(e.uin)}))}))},Xe=function(e,n){ye("updateAuth",e,n)},$e=function(e,n){console.log("开始调用 initToolbarConfig"),ye("initToolbarConfig",e,n)},ze=function(e,n){console.log("开始调用 setToolbarConfig"),ye("updateToolbarConfig",e,n)},Ke=function(e,n){console.log("开始调用 showNativeToolbar"),ye("setNativeToolbarShow",e,n)},He=function(e,n){console.log("开始调用 updatePanelConfig"),ye("updateStylePanelConfig",e,n)},Ye=function(e,n){console.log("开始调用 showNativePanel"),ye("setNativePanelShow",e,n)},Ze=function(e,n){if(console.info("----setActionButtons1-------"),pn){var t=ae(n);t=gn(e,t,!1),console.info("----setActionButtons2-------"),console.info(t),console.info(JSON.stringify(t)),dn(),fn(e,t),ye("setTitlebarIcons",e,t)}else!function(e,n){vn(e,{success:function(t){console.error("123123"),t?(pn=t,Ze(e,n)):(console.error("getCustomTopbarButtonConfigAndSetButtons",t),pn={custom:!1,text:""},Ze(e,n))},fail:function(t){console.error("getCustomTopbarButtonConfigAndSetButtons",t),pn={custom:!1,text:""},Ze(e,n)}})}(e,n)},en=function(e,n){console.info("-----showMenuActions------"),console.info(n),function(e,n){console.error(JSON.stringify(n.actions)),0===Object.keys(an).length&&function(e){if(ln)return;e.addEventListener("onMenuActionClick",(function(e){var n;console.error("点击回调",e),console.error(an),null===(n=an[e.name])||void 0===n||n.call(an,e)})),ln=!0}(e);n.actions.forEach((function(e){e.forEach((function(e){e.onclick&&(an[e.name]=e.onclick)}))}))}(e,n),ye("showMenuActions",e,n)},nn=function(e,n){console.info("-----showBottomActionSheet------"),console.info(n),function(e,n){console.error(JSON.stringify(n.actions)),0===Object.keys(un).length&&function(e){e.addEventListener("onBottomActionSheetClick",(function(e){var n;console.error("点击回调",e),console.error(un),null===(n=un[e.id])||void 0===n||n.call(un,e)}))}(e);n.actions.forEach((function(e){e.onclick&&(un[e.id]=e.onclick)}))}(e,n),ye("showBottomActionSheet",e,n)},tn=function(e,n){var t=ae(n);t=gn(e,t,!0),console.info("-----updateActionButtons log------"),console.info(t),console.info(JSON.stringify(t)),fn(e,t),ye("updateTitlebarIcons",e,t)},on=function(e,n){if(!oe())return e.setTitle(We(n));ye("setWebviewNaviTitle",e,n)},rn=function(e,n){console.error("showOnlineUserList, options-------------",n),ye("showOnlineUserList",e,n)},sn={},cn=null,an={},un={},ln=!1;function fn(e,n){console.error("--addEventListenerByActionButtonConfig---"),n.buttons.forEach((function(e){e.onclick&&(sn[e.id]=e.onclick)})),function(e){cn||(cn=function(e){var n;console.error("点击回调",e),null===(n=sn[e.id])||void 0===n||n.call(sn,e)},console.error(cn),console.error("init titlebarIconClick"),e.addEventListener("titlebarIconClick",cn))}(e)}var dn=function(){sn={}},pn=null,vn=function(n,t){console.info("--------------getCustomTopbarButton"),ye("getCustomTopbarButton",n,e(e({},t),{success:function(e){var n;console.error("345345"),pn=e,null===(n=null==t?void 0:t.success)||void 0===n||n.call(t,e)}}))},wn=function(e,n){ye("onCustomTopbarButtonClick",e,n)},hn=[];function gn(n,t,o){if(!(null==pn?void 0:pn.custom))return t;o?t.buttons.forEach((function(n){var t=hn.findIndex((function(e){return e.id===n.id}));-1!==t?hn[t]=e(e({},hn[t]),n):hn.push(n)})):hn=i([],t.buttons);var r=i([],hn),s=hn.find((function(e){return e.icon===R.More&&2===e.position&&e.state===B.show}));return s&&(r=r.map((function(n){return 2===n.position?e(e({},n),{state:B.hide}):n}))),r.push({id:"__send__",type:L.text,text:pn.text||"发送",position:2,state:s?B.show:B.hide,onclick:function(){return wn(n,{})}}),e(e({},t),{buttons:r})}var mn,bn=function(){var e;sn={},an={},un={},cn=null,null===(e=null===window||void 0===window?void 0:window.TenOfficeJSBridge)||void 0===e||e.__callbackMap.clear()},yn=function(e,n){var t,o=re()?A.test(n.url):x.test(n.url),i=P.test(n.url);(null==n?void 0:n.url)&&(o||i)&&(n.target=3),oe()?ye("openDocLink",e,n):ie()?e.openDocLink(We(n)).then(n.success).catch(n.fail):null===(t=window.WeixinJSBridge)||void 0===t||t.invoke("wwapp.openUrl",We(n),n.success)},kn=function(e,n){ye("popBack",e,n)},Cn=function(e,n){var t;console.log(e),oe()?ye("previewImage",e,n):ie()?e.previewImage(We(n)).then(n.success).catch(n.fail):null===(t=window.WeixinJSBridge)||void 0===t||t.invoke("wwapp.previewImages",{imageUrls:n.images,curIndex:n.currentIndex,editable:!1},n.success)},Wn=function(e,n){console.log("开始调用callWxWorkAppApi"),ye("savePublicImg",e,n)},_n=function(e,n){if(console.log("开始调用chooseimage"),!oe())return e.chooseImage(We(n));ye("multipleImagePicker",e,n)},xn=function(e,n){var t;oe()?ye("previewFiles",e,n):null===(t=window.WeixinJSBridge)||void 0===t||t.invoke("wwapp.doc.previewFiles",We(n),n.success)},An=function(e,t){if(!oe())return e.showNativeToast(We(t));var o=t.success,i=t.fail,r=n(t,["success","fail"]);return e.invoke({func:"showNativeToast",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))},Pn=function(e,t){if(!oe())return e.notifyCommentActionToNative(We(t));var o=t.success,i=t.fail,r=n(t,["success","fail"]);return e.invoke({func:"notifyCommentActionToNative",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))},Sn=function(e,n){oe()?ye("notifyEmojiCommentToNative",e,n):e.notifyEmojiCommentToNative(We(n)).then(n.success).catch(n.fail)},On=function(e,t){if(!oe())return e.allCommentPanelCountUpdated(We(t));var o=t.success,i=t.fail,r=n(t,["success","fail"]);return e.invoke({func:"allCommentPanelCountUpdated",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))},In=function(e,t){if(!oe())return e.showNativeAllCommentPanel(We(t));var o=t.success,i=t.fail,r=n(t,["success","fail"]);return e.invoke({func:"showNativeAllCommentPanel",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))},Tn=function(e,t){if(!oe())return e.launchCommentInput(We(t));var o=t.success,i=t.fail,r=n(t,["success","fail"]);return e.invoke({func:"launchCommentInput",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))},Dn=function(e,t){if(!oe())return e.showEmojiActionPanel(We(t));var o=t.success,i=t.fail,r=n(t,["success","fail"]);return e.invoke({func:"showEmojiActionPanel",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))},jn=function(e,n){ye("showNativeSingleCommentPanel",e,n)},Mn=function(e,n){ye("hideNativeSingleCommentPanel",e,n)},Un=function(e,n){ye("notifyDocChange",e,n)},En=function(e,n){ye("updateMessageQuoteStatus",e,n)},Nn=function(e,n){ye("clearDocUnread",e,n)},Bn=function(n,t){var o,i,r=Ne(t.useOpenid,!!(null===(o=t.online_users_detail)||void 0===o?void 0:o.find((function(e){return Fe(e.openid)}))));ye("showDiscussion",n,e(e({docid:le()},t),{useOpenid:r,online_users_detail:null===(i=t.online_users_detail)||void 0===i?void 0:i.filter((function(e){return r?Fe(e.openid):Le(e.uin)}))}))},Ln=function(e,n){ye("hideDiscussion",e,n)},Fn=function(e,n){ye("updateDiscussion",e,n)},Qn=function(e,n){ye("queryLatestUnreadMsg",e,n)},qn=function(e,n){ye("queryConversationUnread",e,n)},Rn=function(e,n){ye("insertWxworkGroupChat",e,n)},Vn=function(e,n){ye("isInWxworkGroupChat",e,n)},Jn=function(e,n){ye("joinWxworkGroupChat",e,n)},Gn=function(e,n){ye("enterWxworkGroupChat",e,n)},Xn=function(e,n){ye("createWxworkNameCardSelf",e,n)},$n=function(e,n){ye("enterWxworkNameCard",e,n)},zn=function(e,n){ye("canChatWithWxworkNameCard",e,n)},Kn=function(e,n){ye("createWxworkCalender",e,n)},Hn=function(e,n){ye("selectWxworkCalenderList",e,n)},Yn=function(e,n){ye("viewDetailWxworkCalender",e,n)},Zn=function(e,n){ye("queryWxworkCalenderInfo",e,n)},et=function(e,n){ye("joinWxworkCalender",e,n)},nt=function(e,n){ye("createTransferedChatMessageInfo",e,n)},tt=function(e,n){ye("openChatMessageDetail",e,n)},ot=function(e,n){ye("insertApp",e,n)},it=function(e,n){ye("openMiniProgram",e,n)},rt=function(e,t){if(!oe())return e.vibration(We(t));var o=t.success,i=t.fail,r=n(t,["success","fail"]);return e.invoke({func:"vibration",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))},st=function(e,n){ye("vibrateDevice",e,n)},ct=function(n,t){var o=Ne(t.useOpenid,t.canUseOpenid);oe()?ye("getAppCookies",n,e(e({docid:le(),useOpenid:o},t),{success:function(e){var n;e&&o&&e.wedoc_openid&&!e.openid&&(e.openid=e.wedoc_openid),null===(n=t.success)||void 0===n||n.call(t,e)}})):(window.WeixinJSBridge?Promise.resolve(window.WeixinJSBridge):new Promise((function(e){document.addEventListener("WeixinJSBridgeReady",(function(){e(window.WeixinJSBridge)}))}))).then((function(n){return null==n?void 0:n.invoke("wwapp.exchangeST",e(e({docid:le()},t),{useOpenid:o}),(function(e){var n,o,i,r;(null===(o=null===(n=null==e?void 0:e.err_msg)||void 0===n?void 0:n.includes)||void 0===o?void 0:o.call(n,"ok"))?null===(i=null==t?void 0:t.success)||void 0===i||i.call(t,e):null===(r=null==t?void 0:t.fail)||void 0===r||r.call(t,e)}))}))},at=function(n,t){var o,i;if(console.warn("----------客户端开始续票--------"),i=["uid","uid_key","wedrive_sid","wedrive_skey","wedrive_ticket","wedrive_uin","tdoc_sid","tdoc_skey","tdoc_vid","wedoc_sid","wedoc_skey","wedoc_ticket","tdoc_uid"],g.forEach((function(e){i.forEach((function(n){pe({key:n,domain:e===p()?"":e,path:"/"})}))})),oe()||!ie()||(n.docLogin().then((function(){return ue({},t)})).catch(t.fail),!(null===(o=n.hasReceivedMsgFromNative)||void 0===o?void 0:o.call(n)))){console.warn("----------开始续票--------");var r=oe()&&!1!==t.isAutoSetLoginState,s=Ne(t.useOpenid,!0);ct(n,e(e({docid:le(),useOpenid:s,canUseOpenid:!0},t),{isAutoSetLoginState:r,success:function(n){console.warn("----------跟客户端交互成功--------",n),r?setTimeout((function(){var e;if(!ve("wedrive_ticket")&&!ve("wedoc_ticket")){console.warn("----------客户端种票失败--------");var o={cst:!0,deviceid:!0,vid:!0,openid:!0},i=h;console.warn("----------前端自己种票了--------"),Object.keys(n).forEach((function(e){o[e]||de({key:e,value:n[e],domain:i,path:"/"})}))}null===(e=t.success)||void 0===e||e.call(t,n)}),150):Be(e({cst:n.cst,deviceid:n.deviceid},s&&n.openid?{openid:n.openid}:{vid:n.vid}),t)}}))}},ut=function(n,t){var o=we(t.message||""),i=t.level||"info";if(!oe())return n.localLog(We(e(e({},t),{level:i,message:o})));ye("log",n,e(e({},t),{level:i,message:o}))},lt=function(e,n){ye("emitEvent",e,n,"magicbox")},ft=function(e,n){ye("clientMutexLock",e,n,"docx")},dt=function(e,n){ye("mapDocumentVersion",e,n,"docx")},pt=function(e,n){ye("removeDocumentVersion",e,n,"docx")},vt=function(e,t){var o=t.success,i=t.fail,r=n(t,["success","fail"]);e.invoke({func:"getOfflineLocalConfig",params:r,namespace:"docx"}).then((function(e){null==o||o(e)})).catch((function(e){console.log("调用失败"),null==i||i(e)}))},wt=function(e,n){ye("isOfflineBidAvailable",e,n,"docx")},ht=function(e,n){ye("notifyNative",e,n,"docx")},gt=function(e,n){ye("manualSaveDocData",e,n,"docx")},mt=function(e,n){ye("preloadJsReady",e,n,"docx")},bt=function(e,n){var t=n.urls,o=n.success,i=n.fail,r="documentUrlReplace";e.invoke({func:r,params:t,namespace:"docx"}).then((function(e){0===e.code?null==o||o(e.data):(console.log(r,"返回code不为0",e.msg),null==i||i(e.msg))})).catch((function(e){console.log("调用失败"),null==i||i(e)}))},yt=function(e,n){ye("firstLoadFinished",e,n,"docx")},kt=function(e,n){ye("requestFocus",e,n)};!function(e){e.NotGroup="0",e.Group="1"}(mn||(mn={}));var Ct;!function(e){e[e.Read=0]="Read",e[e.Write=1]="Write",e[e.Statistic=2]="Statistic"}(Ct||(Ct={}));var Wt={didPublishWorkLog:function(e,n){ye("didPublishWorkLog",e,n)},openTencentOfficeFromTemplate:function(e,n){ye("wwapp.tdoc.openTencentOfficeFromTemplate",e,n)},openWorklogTemplate:function(e,t){!function(e,t,o,i){var r=o.success,s=o.fail,c=n(o,["success","fail"]);console.log(e,"params",c),j.isIOS()?t.invoke(e,c,r):t.invoke({func:e,params:c,namespace:i}).then((function(n){0===n.code?null==r||r(n.data):(console.log(e,"返回code不为0",n.msg),null==s||s(n.msg,n.code))})).catch((function(e){console.log("调用失败"),null==s||s(e)}))}("wwapp.doc.worklog.openWorklogTemplate",e,t)},journalSelectGroupChat:function(e,n){ye("selectGroupChat",e,n)},shareCustomCard:function(e,n){ye("shareCustomCard",e,n)},journalStatisticsShowPersonPicker:function(e,n){ye("journalStatisticShowPersonPicker",e,n)},journalStatisticsShowDatePicker:function(e,n){ye("journalStatisticShowDatePicker",e,n)},journalJumpToStat:function(e,n){ye("jumpToStat",e,n)},journalJumpToManagement:function(e,n){ye("jumpToManagement",e,n)},journalSendToGroupChat:function(e,n){ye("journalSendToGroupChat",e,n)},openDocOrNormalOrJournal:function(e,n){ye("openDocOrNormalOrEditWorklog",e,n)},sendTemplateInviteCard:function(e,n){ye("sendTemplateInviteCard",e,n)},selectCorpGroupContact:function(e,n){ye("selectCorpGroupContact",e,n)},getWecomSetting:function(e,n){ye("getWecomSetting",e,n)},selectCorpGroupContactNative:function(e,n){ye("selectCorpGroupContactNative",e,n)},notifyJournalSubmitted:function(e,n){ye("notifyJournalSubmitted",e,n)}},_t={previewFile:function(e,n){ye("previewFile",e,n)}},xt=function(e,n){var t;oe()?ye("wwapp.tdoc.getTemplateSegmentName",e,n):null===(t=window.WeixinJSBridge)||void 0===t||t.invoke("wwapp.tdoc.getTemplateSegmentName",We(n),n.success)},At=function(e,n){var t;oe()?ye("wwapp.tdoc.getMobileTemplateFromPage",e,n):null===(t=window.WeixinJSBridge)||void 0===t||t.invoke("wwapp.tdoc.getMobileTemplateFromPage",We(n),n.success)},Pt=j.compareVersion(Z(),"3.1.20")>=0,St=j.compareVersion(Z(),"3.1.23")>=0,Ot=j.compareVersion(Z(),"4.0.0")>=0,It=j.compareVersion(Z(),"4.0.2")>=0,Tt=j.compareVersion(Z(),"4.0.6")>=0,Dt=j.compareVersion(Z(),"4.0.8")>=0,jt=j.compareVersion(Z(),"4.0.16")>=0,Mt=j.compareVersion(Z(),"4.0.18")>=0,Ut=j.compareVersion(Z(),"4.0.20")>=0,Et=e(e(e(e(e(e(e(e(e(e(e(e({clean:bn,isWeDriveEnabled:_e,chooseWeDriveFile:xe,chooseTencentOfficeFile:Ae,getClipboardData:me,setClipboardData:be,fileDownload:Oe,getAppVersion:Te,compare:De,isNewWwapp:je,openCamera:Ie,quoteToDiscuss:Pe,forwardToConversion:Se,showNativePanel:Ye,updatePanelConfig:He,initToolbarConfig:$e,showNativeToolbar:Ke,updateToolbarConfig:ze,setTitle:on,showOnlineUserList:rn,getCustomTopbarButtonConfig:vn,onCustomTopbarButtonClick:wn,viewProfile:Re,onUnload:Me,selectPerson:qe,openUrl:yn,popBack:kn,saveImage:Wn,previewImage:Cn,chooseImage:_n,setActionButtons:Ze,showMenuActions:en,showBottomActionSheet:nn,updateActionButtons:tn,showNativeToast:An,notifyCommentActionToNative:Pn,notifyEmojiCommentToNative:Sn,allCommentPanelCountUpdated:On,showNativeAllCommentPanel:In,launchCommentInput:Tn,showEmojiActionPanel:Dn,vibration:rt,updateAuthority:Ve,getLoginCst:ct,docLogin:at,log:ut,sendMagicBoxMsg:lt,getClientMutexLock:ft,mapDocumentVersion:dt,removeDocumentVersion:pt,getOfflineLocalConfig:vt,isOfflineBidAvailable:wt,preloadJsReady:mt,manualSaveDocData:gt,notifyNative:ht,firstLoadFinished:yt,documentUrlReplace:bt,requestFocus:kt},Pt?{insertWxworkGroupChat:Rn,isInWxworkGroupChat:Vn,joinWxworkGroupChat:Jn,enterWxworkGroupChat:Gn,createWxworkNameCardSelf:Xn,enterWxworkNameCard:$n,canChatWithWxworkNameCard:zn,joinWxworkCalender:et,queryWxworkCalenderInfo:Zn,createWxworkCalender:Kn,selectWxworkCalenderList:Hn,viewDetailWxworkCalender:Yn,openChatMessageDetail:tt,createTransferedChatMessageInfo:nt,clearDocUnread:Nn,showDiscussion:Bn,hideDiscussion:Ln,updateDiscussion:Fn,showCollaboratorPanel:Je}:{}),St?{showNativeSingleCommentPanel:jn,hideNativeSingleCommentPanel:Mn,updateOnlineUserList:Ge,notifyDocChange:Un,updateMessageQuoteStatus:En}:{}),Ot?{insertApp:ot,openMiniProgram:it}:{}),It?{updateAuth:Xe}:{}),It&&j.isIOS()?{vibrateDevice:st}:{}),Tt?{queryLatestUnreadMsg:Qn,queryConversationUnread:qn,clientDatabaseRequest:function(e,n){var t=n.success;n.success=function(e){(null==e?void 0:e.result)&&(null==t||t(e)),null==t||t({result:e})},ye("clientDatabaseRequest",e,n,"docx")}}:{}),Dt&&j.isIOS()?{setBounces:function(e,n){ye("setBounces",e,n)}}:{}),Dt?{waitForClientLoadingClosed:function(e,n){var t,o=new Promise((function(e){t=setTimeout((function(){e(void 0),console.log("waitForClientLoadingClosed 超时了")}),n.timeout)})),i=new Promise((function(n){e.addEventListener("loadingClosed",(function o(){n(void 0),clearTimeout(t),console.log("waitForClientLoadingClosed 客户端回调蒙层消失"),e.removeEventListener("loadingClosed",o)}))}));return Promise.race([o,i])}}:{}),jt?e(e({},Wt),{selectGroupChat:function(e,n){return ke("selectGroupChat",e,n)},startGroupChat:function(e,n){ye("startGroupChat",e,n)}}):{}),Mt?e({showTitlebarMask:function(n,t){n.removeEventListener("onUserClickedTitlebarMask"),t.onClickMask&&n.addEventListener("onUserClickedTitlebarMask",t.onClickMask),ye("showTitlebarMask",n,e(e({},t),{onClickMask:void 0}))},showDocSharePanel:function(e,n){ye("showDocSharePanel",e,n)}},_t):{}),Ut?{previewFiles:xn,getTemplateSegmentName:xt}:{}),Ut&&j.isIOS()?{getMobileTemplateFromPage:At}:{}),Nt={clean:bn,getClipboardData:me,setClipboardData:be,getAppVersion:Te,compare:De,isNewWwapp:je,quoteToDiscuss:Pe,forwardToConversion:Se,setTitle:on,viewProfile:Re,onUnload:Me,selectPerson:qe,openUrl:yn,previewImage:Cn,showNativeToast:An,notifyCommentActionToNative:Pn,notifyEmojiCommentToNative:Sn,allCommentPanelCountUpdated:On,showNativeAllCommentPanel:In,launchCommentInput:Tn,showEmojiActionPanel:Dn,vibration:rt,updateAuthority:Ve,docLogin:at,log:ut},Bt=e(e({getAppVersion:Te,compare:De,isNewWwapp:je,viewProfile:Re,openUrl:yn,previewImage:Cn,getLoginCst:ct,docLogin:at},Ut?{previewFiles:xn,getTemplateSegmentName:xt}:{}),Ut&&j.isIOS()?{getMobileTemplateFromPage:At}:{}),Lt=ce(oe()?Et:ie()?Nt:Bt,U.isWeWorkApp);Lt.docLogin&&(Lt.docLogin=ge(Lt.docLogin));var Ft=e(e(e({},Lt),{isWedocWebview:oe}),oe()?{addEventListener:Ue,removeEventListener:Ee,removeIconButtonClickEvent:dn,callbackMap:sn,deleteCookie:pe}:{});function Qt(e){var t=e||{},o=t.success,i=t.fail,r=t.cancel;return{data:n(t,["success","fail","cancel"]),success:o,fail:i,cancel:r}}function qt(e){var t=e||{};return t.success,t.fail,n(t,["success","fail"])}function Rt(e,n,t){return n.invoke(e,{data:qt(t)})}function Vt(e,n,t,o){var i;void 0===o&&(o=3),(null===(i=window.qmailBridge)||void 0===i?void 0:i[e])?n(window.qmailBridge):o>0?setTimeout((function(){return Vt(e,n,t,o-1)}),1e3):t()}H()===U.isWeWorkApp&&!oe()&&ie()&&document.addEventListener("WeixinJSBridgeReady",(function(){var e,n,t=window.tdocs||{};Object.keys(Nt).forEach((function(e){delete t[e]}));var o=ce(Bt,U.isWeWorkApp);o.docLogin&&(o.docLogin=ge(o.docLogin)),Object.keys(o).forEach((function(e){t[e]=o[e]})),null===(n=null===(e=window.qmailBridge)||void 0===e?void 0:e.destroy)||void 0===n||n.call(e),console.warn("tdocs jsapi switch to wxwork normal webview")}));var Jt=function(e,n){te()?e.readFromPasteBoard((function(e){var t;null===(t=n.success)||void 0===t||t.call(n,{plain:e.value||"",html:e.html||""})}),n.fail):e.invoke("wwapp.wedoc.readFromPasteBoard",Qt(n))},Gt=function(e,n){te()?e.writeToPasteBoard({html:n.html||"",value:n.plain||""},n.success,n.fail):e.invoke("wwapp.wedoc.writeToPasteBoard",Qt(n))},Xt=function(e,n){var t;te()?null===(t=n.success)||void 0===t||t.call(n,e.readFileListFromClipBoard()):e.invoke("wwapp.wedoc.readFileListFromClipBoard",Qt(n))},$t=function(e,n){te()?e.readAsDataURL(n.path).then((function(e){var t,o;e?null===(t=n.success)||void 0===t||t.call(n,{base64:e}):null===(o=n.fail)||void 0===o||o.call(n)})).catch((function(e){var t;null===(t=n.fail)||void 0===t||t.call(n,e)})):e.invoke("wwapp.wedoc.readAsDataURL",Qt(n))},zt=function(e,n){te()?e.copyNativeImageByPath(n.path).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.copyNativeImageByPath",Qt(n))},Kt=function(e,n){e.invoke("wwapp.wedoc.requestFullscreen",Qt(n))},Ht=function(e,n){e.invoke("wwapp.wedoc.exitFullscreen",Qt(n))},Yt=function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.wework_isFullscreen",e),[2]}}))}))},Zt=function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.wework_isFullscreen",e),[2]}}))}))},eo=function(e,n){te()?e.add2Drive().then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.add2Drive",Qt(n))},no=function(n,t){te()?n.selectFromWxDrive(e(e({},qt(t)),{confirmHandler:function(e){var n,o,i=(null==e?void 0:e.length)?e[0]:null;i?null===(o=t.success)||void 0===o||o.call(t,{err_code:0,err_msg:"pickWeDriveWindow:ok",fileid:i.doc_id||i.id,filename:i.name,filetype:i.doc_id?1:0,spaceid:i.topId||i.rootId,url:i.doc_url}):null===(n=t.fail)||void 0===n||n.call(t)}})):n.invoke("wwapp.wedoc.selectFromWxDrive",Qt(t))},to=function(e,t){var o;if(te())return e.jumpToDrive({id:t.file_id,parentId:t.folder_id,topId:t.space_id}),void(null===(o=t.success)||void 0===o||o.call(t));if(ne()){var i=t||{},r=i.success,s=i.fail,c=n(i,["success","fail"]),a={data:{event:"jumpToDrive",param:JSON.stringify({file:c})},success:r,fail:s,cancel:s};e.invoke("wwapp.wedoc.wedriveUniversalEvent",a)}else e.invoke("wwapp.wedoc.jumpToDrive",Qt(t))},oo=function(n,t){if(ne()){var o=JSON.stringify(t.param);t=e(e({},t),{param:o}),n.invoke("wwapp.wedoc.wedriveUniversalEvent",Qt(t))}},io=function(e,n){te()?e.request("mainService.appIpcRequest","wework/getPartyListOrUserListForWXDrive",qt(n),{timeout:2e3}).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.getPartyListOrUserList",Qt(n))},ro=function(e,n){te()?e.request("mainService.appIpcRequest","wework/getSubDepartmentsForWXDrive",qt(n)).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.getSubDepartments",Qt(n))},so=j.compareVersion(Z(),"4.0.18")>=0,co=new Map,ao=!1;function uo(e){var n;console.log("----QuoteToDiscuss onclick----",e),(null==e?void 0:e.id)&&(null===(n=co.get(e.id))||void 0===n||n())}var lo=function(n,t){if(te())n.discuss(qt(t)).then(t.success).catch(t.fail);else{var o=window.isTimelineMode?{hideDiscussWindow:!0}:{};co.clear(),so&&t.extraButtons&&function(e,n){null==n||n.forEach((function(e){var n=e.id,t=e.onClick;n&&t&&co.set(n,t)})),console.log("----QuoteToDiscuss Click Action Init----",null==n?void 0:n.length,ao),ao||(e.on("wwapp.wedoc.onClickSharePanel",uo),ao=!0)}(n,t.extraButtons),n.invoke("wwapp.wedoc.discuss",Qt(e(e({},o),t)))}},fo=function(e,n){te()?e.startConversation(qt(n)).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.startConversation",Qt(n))},po=function(e,n){te()?e.forwardFormsToWXWork(n.forms||[]).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.forwardFormsToWXWork",Qt(n))},vo=function(e,n){te()?e.forwardToConversion(n.convId||"").then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.forwardToConversion",Qt(n))},wo=function(e,n){te()?e.request("mainService.appIpcRequest","wework/notifyPush",qt(n),{needCallback:!1}).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.notifyPush",Qt(n))},ho=function(e,n){te()?e.request("mainService.appIpcRequest","wework/showDiscussWindow",qt(n),{needCallback:!1}).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.showDiscussWindow",Qt(n))},go=function(e,n){te()?e.request("mainService.appIpcRequest","wework/hideOneDiscussWindow",qt(n),{needCallback:!1}).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.hideOneDiscussWindow",Qt(n))},mo=function(e,n){te()?e.request("mainService.appIpcRequest","wework/destroyDiscussWindow",qt(n),{needCallback:!1}).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.destroyDiscussWindow",Qt(n))};function bo(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return te()?(window.wedocs_preloadIPCRenderer.on("wework_completeComment",e),[2]):[4,$(U.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.wework_completeComment",e),[2]}}))}))}function yo(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return te()?(window.wedocs_preloadIPCRenderer.removeListener("wework_completeComment",e),[2]):[4,$(U.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.wework_completeComment",e),[2]}}))}))}function ko(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return te()?(window.wedocs_preloadIPCRenderer.on("wework_unreadCountChange",e),[2]):[4,$(U.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.wework_unreadCountChange",e),[2]}}))}))}function Co(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return te()?(window.wedocs_preloadIPCRenderer.removeListener("wework_unreadCountChange",e),[2]):[4,$(U.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.wework_unreadCountChange",e),[2]}}))}))}function Wo(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return te()?(window.wedocs_preloadIPCRenderer.on("wework_closeDiscussWindow",e),[2]):[4,$(U.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.wework_closeDiscussWindow",e),[2]}}))}))}function _o(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return te()?(window.wedocs_preloadIPCRenderer.removeListener("wework_closeDiscussWindow",e),[2]):[4,$(U.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.wework_closeDiscussWindow",e),[2]}}))}))}var xo=function(e,n){var t;null===(t=null==n?void 0:n.success)||void 0===t||t.call(n,Z())},Ao=function(e,n){var t;null===(t=null==n?void 0:n.success)||void 0===t||t.call(n,j.compareVersion(Z(),(null==n?void 0:n.version)||""))},Po=function(e,n){var t;null===(t=null==n?void 0:n.success)||void 0===t||t.call(n,ee())},So=function(n,i){return t(void 0,void 0,void 0,(function(){return o(this,(function(t){if(Qe((i=function(n){if("number"!=typeof n.positionX||"number"!=typeof n.positionY)return n;if(!window.parent||window.parent===window)return n;try{var t=window.parent.document.querySelectorAll("iframe"),o=Array.from(t).find((function(e){return e.contentWindow===window})),i=null==o?void 0:o.getBoundingClientRect();return i?e(e({},n),{positionX:n.positionX+i.left,positionY:n.positionY+i.top}):n}catch(e){return console.error(e),n}}(i)).openid||i.vid))return[2,Promise.resolve({})];if(te())return[2,n.viewProfile(null==i?void 0:i.vid)];if(i.openid||i.useOpenid||!Le(i.vid)){if(j.isMac()&&j.compareVersion(Z(),"4.0.10")<0)return[2,Promise.resolve({})];if(!Fe(i.openid||i.vid))return[2,Promise.reject({err_msg:(i.openid||i.vid)+" is not openid"})];i=e(e({docid:le()},i),{openid:i.openid||i.vid,vid:void 0,useOpenid:1})}return[2,Rt("wwapp.wedoc.viewProfile",n,i)]}))}))};var Oo=function(n,i){return t(void 0,void 0,void 0,(function(){var t,r,s,c;return o(this,(function(o){switch(o.label){case 0:return te()?[2,n.selectContacts(qt(i))]:(t=Ne(i.useOpenid,i.canUseOpenid||!!(null===(s=i.selectedContactOpenIds)||void 0===s?void 0:s.length)||!!(null===(c=i.disabledUserOpenIds)||void 0===c?void 0:c.length)))?[4,Rt("wwapp.wedoc.selectContacts",n,e(e({docid:le(),docId:le()},i),{useOpenid:t,selectedContacts:void 0,disabledUserIds:void 0,selectedContactOpenIds:i.selectedContactOpenIds||i.selectedUserIds&&i.selectedUserIds.filter((function(e){return Fe(e)})),disabledUserOpenIds:i.disabledUserOpenIds||i.disabledUserIds&&i.disabledUserIds.filter((function(e){return Fe(e)}))}))]:[2,Rt("wwapp.wedoc.selectContacts",n,e(e({docid:le()},i),{selectedContacts:i.selectedContacts&&i.selectedContacts.filter((function(e){return Le(e)})),disabledUserIds:i.disabledUserIds&&i.disabledUserIds.filter((function(e){return Le(e)}))}))];case 1:return r=o.sent(),[2,e(e({},r),{selectedContacts:r.selectedContacts&&r.selectedContacts.map((function(n){return e(e({},n),{vid:n.openid,id:n.openid})})),applyExternalVidList:r.applyExternalVidList&&r.applyExternalVidList.map((function(n){return e(e({},n),{vid:n.openid,id:n.openid})})),applyWxList:r.applyWxList&&r.applyWxList.map((function(n){return e(e({},n),{vid:n.openid,id:n.openid})})),selectedOtherContacts:r.selectedOtherContacts&&r.selectedOtherContacts.map((function(n){return e(e({},n),{vid:n.openid,id:n.openid})}))})]}}))}))},Io=function(n,i){if(te())Vt("getRecentContacts",(function(e){e.getRecentContacts().then(null==i?void 0:i.success).catch(null==i?void 0:i.fail)}),(function(){var e;null===(e=i.fail)||void 0===e||e.call(i)}));else{var r=Ne(i.useOpenid,i.canUseOpenid);r?Rt("wwapp.wedoc.getRecentContacts",n,e(e({docid:le()},i),{useOpenid:r})).then((function(n){return t(void 0,void 0,void 0,(function(){var t;return o(this,(function(o){return null===(t=i.success)||void 0===t||t.call(i,e(e({},n),{persons:n.persons&&n.persons.map((function(n){return e(e({},n),{vid:n.openid})}))})),[2]}))}))})).catch(i.fail):n.invoke("wwapp.wedoc.getRecentContacts",Qt(i))}},To=function(n,i){if(te())n.searchContacts(qt(i)).then(null==i?void 0:i.success).catch(null==i?void 0:i.fail);else{var r=Ne(i.useOpenid,i.canUseOpenid);r?Rt("wwapp.wedoc.searchContacts",n,e(e({docid:le()},i),{useOpenid:r})).then((function(n){return t(void 0,void 0,void 0,(function(){var t;return o(this,(function(o){return null===(t=i.success)||void 0===t||t.call(i,e(e({},n),{persons:n.persons&&n.persons.map((function(n){return e(e({},n),{vid:n.openid})}))})),[2]}))}))})).catch(i.fail):n.invoke("wwapp.wedoc.searchContacts",Qt(i))}},Do=function(e,n){n.target!==N.Browser&&(S.test(n.url)||O.test(n.url))?n.target===N.Direct?location.href=n.url:No(e,n):jo(e,n)},jo=function(e,n){te()?e.openFileInBrowser(n.url).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.openFileInBrowser",Qt(n))},Mo=function(e,n){e.invoke("wwapp.wedoc.openInWxworkBrowser",Qt(n))},Uo=function(e,t){if(te())e.openFileInWedrive(t.fileId,t.url).then(t.success).catch(t.fail);else if(ne()){var o=t||{},i=o.success,r=o.fail,s=n(o,["success","fail"]),c={data:{event:"openFileInWedrive",param:JSON.stringify(s)},success:i,fail:r,cancel:r};e.invoke("wwapp.wedoc.wedriveUniversalEvent",c)}else e.invoke("wwapp.wedoc.openFileInWedrive",Qt(t))},Eo=function(e,n){var t;te()?null===(t=n.success)||void 0===t||t.call(n,e.closeWindow()):e.invoke("wwapp.wedoc.closeWindow",Qt(n))},No=function(e,n){S.test(n.url)||O.test(n.url)||I.test(n.url)?te()?e.request("mainProcessModule.WeDocsSchemaProtocolController.openwedocs",{url:n.url,id:le(n.url),is_silent:n.is_silent||!1},{needCallback:!1}).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.openInTab",Qt(n)):jo(e,n)},Bo=function(e,n){e.invoke("wwapp.wedoc.openWecomSearch",Qt(n))},Lo=function(e,n){te()?e.openWedocsMainWindow(!1,!1,{}).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.openAndJumpToMainPage",Qt(n))};function Fo(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return te()?(window.wedocs_preloadIPCRenderer.on("focusWedocsWindow",e),[2]):[4,$(U.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.focusWedocsWindow",e),[2]}}))}))}function Qo(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return te()?(window.wedocs_preloadIPCRenderer.removeListener("focusWedocsWindow",e),[2]):[4,$(U.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.focusWedocsWindow",e),[2]}}))}))}function qo(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return te()?(window.wedocs_preloadIPCRenderer.on("blurWedocsWindow",e),[2]):[4,$(U.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.blurWedocsWindow",e),[2]}}))}))}function Ro(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return te()?(window.wedocs_preloadIPCRenderer.removeListener("blurWedocsWindow",e),[2]):[4,$(U.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.blurWedocsWindow",e),[2]}}))}))}var Vo=function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return te()?(window.wedocs_preloadIPCRenderer.on("url_change",(function(n,t){return e(t)})),[2]):[4,$(U.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.urlChange",e),[2]}}))}))},Jo=function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return te()?(window.wedocs_preloadIPCRenderer.removeListener("url_change",(function(n,t){return e(t)})),[2]):[4,$(U.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.urlChange",e),[2]}}))}))},Go=function(e,n){var t;if(te()){var o=location.search.replace(/^\?/,"").split("&").reduce((function(e,n){var t=n.split("=");return t[0]&&(e[t[0]]=t[1]),e}),{});null===(t=n.success)||void 0===t||t.call(n,o)}else e.invoke("wwapp.wedoc.getWindowUrlParams",Qt(n))},Xo=function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.clickDocTab",e),[2]}}))}))},$o=function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.clickDocTab",e),[2]}}))}))},zo=function(n,t){var o;if(te())null===(o=t.success)||void 0===o||o.call(t,n.openSupportPage());else if(p()===v)jo(n,e(e({},t),{url:T}));else{var i=D;fetch("/diskmng/contactus?func=2").then((function(e){return e.json()})).then((function(o){var r;jo(n,e(e({},t),{url:(null===(r=null==o?void 0:o.body)||void 0===r?void 0:r.feedback_url)||i}))})).catch((function(o){console.error("fetch feedback url error",o),jo(n,e(e({},t),{url:i}))}))}},Ko=function(n,t){var o=Ne(t.useOpenid,t.canUseOpenid);n.invoke("wwapp.wedoc.getLoginCst",Qt(e({docid:le(),useOpenid:o},t)))},Ho=function(n,t){if(te())n.docLogin((function(){return ue({},t)}),t.fail);else{var o=Ne(t.useOpenid,!0);n.invoke("wwapp.wedoc.getLoginCst",Qt(e(e({docid:le(),useOpenid:o,canUseOpenid:!0},t),{success:function(n){Be(e({cst:n.cst,deviceid:n.deviceid},o&&n.openid?{openid:n.openid}:{vid:n.vid}),t)}})))}},Yo=function(n,t){var o=we(t.msg||t.message||""),i=t.level||"info";te()?n.localLog(o).then(t.success).catch(t.fail):n.invoke("wwapp.wedoc.localLog",Qt(e(e({},t),{msg:o,level:i})))},Zo=function(e,n){e.invoke("wwapp.wedoc.insertWxworkGroupChat",Qt(n))},ei=function(e,n){e.invoke("wwapp.wedoc.isInWxworkGroupChat",Qt(n))},ni=function(e,n){e.invoke("wwapp.wedoc.joinWxworkGroupChat",Qt(n))},ti=function(e,n){e.invoke("wwapp.wedoc.enterWxworkGroupChat",Qt(n))},oi=function(e,n){e.invoke("wwapp.wedoc.createWxworkNameCardSelf",Qt(n))},ii=function(e,n){e.invoke("wwapp.wedoc.enterWxworkNameCard",Qt(n))},ri=function(e,n){e.invoke("wwapp.wedoc.canChatWithWxworkNameCard",Qt(n))},si=function(e,n){e.invoke("wwapp.wedoc.createWxworkCalender",Qt(n))},ci=function(e,n){e.invoke("wwapp.wedoc.selectWxworkCalenderList",Qt(n))},ai=function(e,n){e.invoke("wwapp.wedoc.viewDetailWxworkCalender",Qt(n))},ui=function(e,n){e.invoke("wwapp.wedoc.queryWxworkCalenderInfo",Qt(n))},li=function(e,n){e.invoke("wwapp.wedoc.joinWxworkCalender",Qt(n))},fi=function(e,n){e.invoke("wwapp.wedoc.createTransferedChatMessageInfo",Qt(n))},di=function(e,n){e.invoke("wwapp.wedoc.openChatMessageDetail",Qt(n))};var pi=function(e,n){e.invoke("wwapp.wedoc.getConversationList",Qt(n))},vi=function(e,n){e.invoke("wwapp.wedoc.getConversationsDetail",Qt(n))},wi=function(e,n){e.invoke("wwapp.wedoc.getNoticeCount",Qt(n))},hi=function(e,n){e.invoke("wwapp.wedoc.monitorDocConv",Qt(n))},gi=function(e,n){e.invoke("wwapp.wedoc.markAsRead",Qt(n))},mi=function(e,n){e.invoke("wwapp.wedoc.setConvTop",Qt(n))},bi=function(e,n){e.invoke("wwapp.wedoc.removeConv",Qt(n))};function yi(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.conversationChange",e),[2]}}))}))}function ki(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.conversationChange",e),[2]}}))}))}var Ci=function(e,n){e.invoke("wwapp.wedoc.setNoticeType",Qt(n))},Wi=function(e,n){e.invoke("wwapp.wedoc.getTotalUnreadCount",Qt(n))},_i=function(e,n){e.invoke("wwapp.wedoc.timelineInited",Qt(n))},xi=function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.openDocInTimeline",e),[2]}}))}))},Ai=function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.openDocInTimeline",e),[2]}}))}))},Pi=function(e,n){e.invoke("wwapp.wedoc.shareToWeixin",Qt(n))},Si=function(e,n){e.invoke("wwapp.wedoc.isInstalledWeixinApp",Qt(n))},Oi=function(e,n){e.invoke("wwapp.wedoc.queryDepartmentNames",Qt(n))};var Ii;!function(e){e.NotGroup="0",e.Group="1"}(Ii||(Ii={}));var Ti=function(e,n){e.invoke("wwapp.selectCorpGroupContact",Qt(n))},Di=j.compareVersion(Z(),"3.1.20")>=0,ji=j.compareVersion(Z(),"3.1.23")>=0,Mi=j.compareVersion(Z(),"4.0.0")>=0,Ui=j.compareVersion(Z(),"4.0.2")>=0,Ei=j.compareVersion(Z(),"4.0.6")>=0,Ni=j.compareVersion(Z(),"4.0.8")>=0,Bi=j.compareVersion(Z(),"4.0.12")>=0,Li=j.compareVersion(Z(),"4.0.16")>=0,Fi=j.compareVersion(Z(),"4.0.18")>=0,Qi=j.compareVersion(Z(),"4.0.20")>=0,qi=j.compareVersion(Z(),"4.1.0")>=0,Ri=e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e({getClipboardData:Jt,setClipboardData:Gt,readAsDataURL:$t,readFileListFromClipBoard:Xt,copyNativeImage:zt,getAppVersion:xo,compare:Ao,isNewWwapp:Po,quoteToDiscuss:lo,startConversation:fo,forwardFormsToWXWork:po,forwardToConversion:vo,notifyPush:wo,showDiscussWindow:ho,hideOneDiscussWindow:go,destroyDiscussWindow:mo,requestFullscreen:Kt,exitFullscreen:Ht,addToDrive:eo,selectFromWxDrive:no,jumpToDrive:to,wedriveUniversalEvent:oo,getPartyListOrUserList:io,getSubDepartments:ro,openSupportPage:zo,selectContacts:Oo,viewProfile:So,getRecentContacts:Io,searchContacts:To,openUrl:Do,openInBrowser:jo,openInTab:No,openAndJumpToMainPage:Lo,openFileInWedrive:Uo,closeWindow:Eo,getWindowUrlParams:Go,docLogin:Ho,getLoginCst:Ko,log:Yo,boardSelectContacts:function(e,n){e.invoke("wwapp.blackboard.selectContacts",Qt(n))},showRobotProfile:function(e,n){e.invoke("wwapp.blackboard.showRobotProfile",Qt(n))},addRobot:function(e,n){e.invoke("wwapp.blackboard.addRobot",Qt(n))},forwardBlackboard:function(e,n){e.invoke("wwapp.blackboard.forwardBlackboard",Qt(n))},jumpToConversation:function(e,n){e.invoke("wwapp.blackboard.jumpToConversation",Qt(n))},monitorBlackboard:function(e,n){e.invoke("wwapp.blackboard.monitorBlackboard",Qt(n))},getWeWorkFontConfig:function(e,n){e.invoke("wwapp.blackboard.getWeWorkFontConfig",Qt(n))},showForwardDialogForBlackboard:function(e,n){e.invoke("wwapp.blackboard.showForwardDialogForBlackboard",Qt(n))},getUserCountForWXDrive:function(e,n){e.invoke("wwapp.blackboard.getUserCountForWXDrive",Qt(n))},readFileCardFromClipboard:function(e,n){e.invoke("wwapp.blackboard.readFileCardFromClipboard",Qt(n))},selectContactsForWXDrive:function(e,n){e.invoke("wwapp.blackboard.selectContactsForWXDrive",Qt(n))}},Di?{insertWxworkGroupChat:Zo,isInWxworkGroupChat:ei,joinWxworkGroupChat:ni,enterWxworkGroupChat:ti,createWxworkNameCardSelf:oi,enterWxworkNameCard:ii,canChatWithWxworkNameCard:ri,joinWxworkCalender:li,queryWxworkCalenderInfo:ui,createWxworkCalender:si,selectWxworkCalenderList:ci,viewDetailWxworkCalender:ai,openChatMessageDetail:di,createTransferedChatMessageInfo:fi,getConversationList:pi,getConversationsDetail:vi,getNoticeCount:wi,monitorDocConv:hi,markAsRead:gi,setConvTop:mi,removeConv:bi,setNoticeType:Ci,getTotalUnreadCount:Wi}:{}),j.isMac()?{}:{openWecomSearch:Bo}),ji&&j.isWindows()?{timelineInited:_i}:{}),Mi?{queryDepartmentNames:Oi,insertApp:function(e,n){e.invoke("wwapp.wedoc.insertApp",Qt(n))},openMiniProgram:function(e,n){e.invoke("wwapp.wedoc.openMiniProgram",Qt(n))},shareToWeixin:Pi,isInstalledWeixinApp:Si}:{}),Mi&&!j.isMac()?{openInWxworkBrowser:Mo}:{}),Ui&&j.isMac()?{isDarkMode:function(e,n){e.invoke("isDarkMode",Qt(n))},toggleMainPage:function(e,n){e.invoke("wwapp.wedoc.toggleMainPage",Qt(n))}}:{}),Ei?{queryLatestUnreadMsg:function(e,n){e.invoke("wwapp.wedoc.queryLatestUnreadMsg",Qt(n))}}:{}),Ei&&j.isMac()?{getDisplayFontSize:function(e,n){e.invoke("wwapp.wedoc.getDisplayFontSize",Qt(n))}}:{}),Ni?{getRedPointMsgList:function(e,n){e.invoke("wwapp.wedoc.getRedPointMsgList",Qt(n))}}:{}),Bi&&j.isWindows()?{checkIsCurrentUser:function(n,t){var o;n.invoke("wwapp.wedoc.checkIsCurrentUser",Qt(e(e({},t),{useOpenid:null!==(o=t.useOpenid)&&void 0!==o?o:Le(t.userId)?void 0:1})))},getLastClickDocTabTime:function(e,n){e.invoke("wwapp.wedoc.getLastClickDocTabTime",Qt(n))},getCurrentProcessMemory:function(e,n){e.invoke("wwapp.wedoc.getCurrentProcessMemory",Qt(n))}}:{}),Bi?{startMeeting:function(e,n){e.invoke("wwapp.wedoc.startMeeting",Qt(n))},startGroupChat:function(e,n){e.invoke("wwapp.wedoc.startGroupChat",Qt(n))},finishLoad:function(e,n){e.invoke("wwapp.wedoc.finishLoad",Qt(n))}}:{}),Li?e(e({openContactProfile:function(e,n){e.invoke("wwapp.openContactProfile",Qt(n))},openDefaultBrowser:function(e,n){e.invoke("wwapp.openDefaultBrowser",Qt(n))},openEnterpriseContact:function(e,n){e.invoke("wwapp.openEnterpriseContact",Qt(n))},downloadFile:function(e,n){e.invoke("wwapp.downloadFile",Qt(n))},uploadFile:function(e,n){e.invoke("wwapp.uploadFile",Qt(n))},setBlackBoardNavigationItem:function(e,n){e.invoke("wwapp.setBlackBoardNavigationItem",Qt(n))},getAppInfo:function(e,n){e.invoke("wwapp.getAppInfo",Qt(n))},disableWebviewBounce:function(e,n){e.invoke("wwapp.disableWebviewBounce",Qt(n))},openLocation:function(e,n){e.invoke("wwapp.openLocation",Qt(n))},selectLocation:function(e,n){e.invoke("wwapp.selectLocation",Qt(n))},showAlert:function(e,n){e.invoke("wwapp.showAlert",Qt(n))},previewImages:function(e,n){e.invoke("wwapp.previewImages",Qt(n))},previewFile:function(e,n){e.invoke("wwapp.previewFile",Qt(n))},readLocalCache:function(e,n){e.invoke("wwapp.readLocalCache",Qt(n))},selectHomeSchoolNode:function(e,n){e.invoke("wwapp.selectHomeSchoolNode",Qt(n))},showListDialog:function(e,n){e.invoke("wwapp.showListDialog",Qt(n))},selectGroupChat:function(e,n){e.invoke("wwapp.selectGroupChat",Qt(n))},notifyWebViewFinish:function(e,n){e.invoke("wwapp.journal.notifyWebViewFinish",Qt(n))},shareToConversation:function(e,n){e.invoke("wwapp.journal.shareToConversation",Qt(n))},didSubmitedJournalTemplate:function(e,n){e.invoke("wwapp.journal.didSubmitedJournalTemplate",Qt(n))},onPageStatusChanged:function(e,n){e.invoke("wwapp.journal.onPageStatusChanged",Qt(n))},jumpToJournalSetting:function(e,n){e.invoke("wwapp.journal.jumpToJournalSetting",Qt(n))},didPublishWorkLog:function(e,n){e.invoke("wwapp.journal.didPublishWorkLog",Qt(n))},getWorknoteChatData:function(e,n){e.invoke("wwapp.journal.getWorknoteChatData",Qt(n))},selectWorknoteTime:function(e,n){e.invoke("wwapp.journal.selectWorknoteTime",Qt(n))}},j.isWindows()?{selectCorpGroupContact:Ti}:{}),{sendTemplateInviteCard:function(e,n){e.invoke("wwapp.journal.sendTemplateInviteCard",Qt(n))},sendTemplateInviteCard4WeworkJournal:function(e,n){e.invoke("sendTemplateInviteCard",Qt(n))},getWecomSetting:function(e,n){e.invoke("wwapp.wedoc.getWecomSetting",Qt(n))},openNativeJournal:function(e,n){e.invoke("wwapp.wedoc.openNativeJournal",Qt(n))},getLanguageSettings:function(e,n){e.invoke("wwapp.wedoc.getLanguageSettings",Qt(n))}}):{}),Fi?{selectCorpGroupContact:Ti,getUserInfo:function(e,n){e.invoke("wwapp.wedoc.getUserInfo",Qt(n))},timelineInited:_i,getMessageList:function(e,n){e.invoke("wwapp.wedoc.getMessageList",Qt(n))},getReadedAnchor:function(e,n){e.invoke("wwapp.wedoc.getReadedAnchor",Qt(n))},markConvAsRead:function(e,n){e.invoke("wwapp.wedoc.markConvAsRead",Qt(n))},removeMessage:function(e,n){e.invoke("wwapp.wedoc.removeMessage",Qt(n))},removeAllMessage:function(e,n){e.invoke("wwapp.wedoc.removeAllMessage",Qt(n))},openWorkUrl:function(e,n){e.invoke("wwapp.wedoc.openWorkUrl",Qt(n))}}:{}),Fi&&j.isWindows()?{getVisibilityState:function(e,n){e.invoke("wwapp.wedoc.getVisibilityState",Qt(n))}}:{}),Qi?{isMailInTab:function(e,n){e.invoke("wwapp.wedoc.isMailInTab",Qt(n))},openMailWritePage:function(e,n){e.invoke("wwapp.wedoc.openMailWritePage",Qt(n))}}:{}),qi?{checkIsDocBrowser:function(e,n){j.isMac()?Promise.resolve().then((function(){var e;return null===(e=n.success)||void 0===e?void 0:e.call(n,{isDocBrowser:/WeComCEF/i.test(j.getUserAgent())})})):e.invoke("wwapp.wedoc.checkIsDocBrowser",Qt(n))}}:{}),Vi={getClipboardData:Jt,setClipboardData:Gt,readAsDataURL:$t,readFileListFromClipBoard:Xt,copyNativeImage:zt,getAppVersion:xo,compare:Ao,isNewWwapp:Po,quoteToDiscuss:lo,startConversation:fo,forwardFormsToWXWork:po,forwardToConversion:vo,notifyPush:wo,showDiscussWindow:ho,hideOneDiscussWindow:go,destroyDiscussWindow:mo,addToDrive:eo,selectFromWxDrive:no,jumpToDrive:to,getPartyListOrUserList:io,getSubDepartments:ro,openSupportPage:zo,selectContacts:Oo,viewProfile:So,getRecentContacts:Io,searchContacts:To,openUrl:Do,openInBrowser:jo,openInTab:No,openAndJumpToMainPage:Lo,openFileInWedrive:Uo,closeWindow:Eo,getWindowUrlParams:Go,docLogin:Ho,log:Yo},Ji={getAppVersion:xo,compare:Ao,isNewWwapp:Po},Gi=ce(te()?Vi:ee()?Ri:Ji,U.isWeWork);Gi.docLogin&&(Gi.docLogin=ge(Gi.docLogin)),H()===U.isWeWork&&j.isWindows()&&ee()&&p()===v&&setTimeout((function(){var e,n;null===(n=null===(e=window.tdocs)||void 0===e?void 0:e.checkIsDocBrowser)||void 0===n||n.call(e).then((function(e){e.isDocBrowser||Object.keys(Ri).forEach((function(e){var n,t;(null===(n=window.tdocs)||void 0===n?void 0:n[e])&&!Ji[e]&&(null===(t=window.tdocs)||void 0===t||delete t[e])}))}))}),0);var Xi=e(e(e(e(e(e(e(e(e(e({},Gi),te()?{onCompleteComment:bo,onUnreadCountChange:ko,onCloseDiscussWindow:Wo,onBlurWedocsWindow:qo,onFocusWedocsWindow:Fo,onUrlChange:Vo,offCompleteComment:yo,offUnreadCountChange:Co,offCloseDiscussWindow:_o,offBlurWedocsWindow:Ro,offFocusWedocsWindow:Qo,offUrlChange:Jo}:{}),ee()?{onUpdateWeWorkFontConfig:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().on("wwapp.blackboard.updateWeWorkFontConfig",e),[2]}}))}))},onBoardOpenPage:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().on("wwapp.blackboard.boardOpenPage",e),[2]}}))}))},onFocusBoardWindow:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().on("wwapp.blackboard.focusBoardWindow",e),[2]}}))}))},onBlurBoardWindow:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().on("wwapp.blackboard.blurBoardWindow",e),[2]}}))}))},offBlurBoardWindow:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().off("wwapp.blackboard.blurBoardWindow",e),[2]}}))}))},offBoardOpenPage:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().off("wwapp.blackboard.boardOpenPage",e),[2]}}))}))},offFocusBoardWindow:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().off("wwapp.blackboard.focusBoardWindow",e),[2]}}))}))},offUpdateWeWorkFontConfig:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().off("wwapp.blackboard.updateWeWorkFontConfig",e),[2]}}))}))},onCompleteComment:bo,onFullscreenChange:Yt,onUnreadCountChange:ko,onCloseDiscussWindow:Wo,onBlurWedocsWindow:qo,onFocusWedocsWindow:Fo,onUrlChange:Vo,offCompleteComment:yo,offFullscreenChange:Zt,offUnreadCountChange:Co,offCloseDiscussWindow:_o,offBlurWedocsWindow:Ro,offFocusWedocsWindow:Qo,offUrlChange:Jo}:{}),Di?{onConversationChange:yi,offConversationChange:ki}:{}),ji?{onClickDocTab:Xo,offClickDocTab:$o,onOpenDocInTimeline:xi,offOpenDocInTimeline:Ai}:{}),Ui&&j.isMac()?{onDarkModeChange:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.darkModeChange",e),[2]}}))}))},offDarkModeChange:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.darkModeChange",e),[2]}}))}))}}:{}),Ei&&j.isMac()?{onFontSizeDidChange:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.fontSizeDidChange",e),[2]}}))}))},offFontSizeDidChange:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.fontSizeDidChange",e),[2]}}))}))}}:{}),Ni&&j.isMac()?{onMainPageFloatingChange:function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.mainPageFloatingChange",e),[2]}}))}))},offMainPageFloatingChange:function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.mainPageFloatingChange",e),[2]}}))}))}}:{}),Fi?{onSearchDocInTimeline:function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.searchDocInTimeline",e),[2]}}))}))},offSearchDocInTimeline:function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.searchDocInTimeline",e),[2]}}))}))},onMessageChange:function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.messageChange",e),[2]}}))}))},offMessageChange:function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.messageChange",e),[2]}}))}))}}:{}),Fi&&j.isWindows()?{onVisibilityChange:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.visibilityChange",e),[2]}}))}))},offVisibilityChange:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,$(U.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.visibilityChange",e),[2]}}))}))}}:{}),$i=j.compareVersion(se(),"2.6.15")>=0,zi=e(e({getClipboardData:Jt,setClipboardData:Gt,readAsDataURL:$t,readFileListFromClipBoard:Xt,copyNativeImage:zt,getAppVersion:xo,compare:Ao,isNewWwapp:Po,quoteToDiscuss:lo,startConversation:fo,forwardFormsToWXWork:po,forwardToConversion:vo,notifyPush:wo,showDiscussWindow:ho,hideOneDiscussWindow:go,destroyDiscussWindow:mo,requestFullscreen:Kt,exitFullscreen:Ht,addToDrive:eo,selectFromWxDrive:no,jumpToDrive:to,wedriveUniversalEvent:oo,getPartyListOrUserList:io,getSubDepartments:ro,selectContacts:Oo,viewProfile:So,getRecentContacts:Io,searchContacts:To,openUrl:Do,openInBrowser:jo,openInTab:No,openAndJumpToMainPage:Lo,openFileInWedrive:Uo,closeWindow:Eo,getWindowUrlParams:Go,docLogin:Ho,getLoginCst:Ko,log:Yo,insertWxworkGroupChat:Zo,isInWxworkGroupChat:ei,joinWxworkGroupChat:ni,enterWxworkGroupChat:ti,createWxworkNameCardSelf:oi,enterWxworkNameCard:ii,canChatWithWxworkNameCard:ri,joinWxworkCalender:li,queryWxworkCalenderInfo:ui,createWxworkCalender:si,selectWxworkCalenderList:ci,viewDetailWxworkCalender:ai,openChatMessageDetail:di,createTransferedChatMessageInfo:fi,getConversationList:pi,getConversationsDetail:vi,getNoticeCount:wi,monitorDocConv:hi,markAsRead:gi,setConvTop:mi,removeConv:bi,setNoticeType:Ci,getTotalUnreadCount:Wi},j.isMac()?{}:{openWecomSearch:Bo}),{timelineInited:_i,queryDepartmentNames:Oi,shareToWeixin:Pi,isInstalledWeixinApp:Si,openInWxworkBrowser:Mo}),Ki=ce($i?zi:{getAppVersion:xo,compare:Ao,isNewWwapp:Po},U.isWeWork),Hi=e(e({},Ki),{onCompleteComment:bo,onFullscreenChange:Yt,onUnreadCountChange:ko,onCloseDiscussWindow:Wo,onBlurWedocsWindow:qo,onFocusWedocsWindow:Fo,onUrlChange:Vo,offCompleteComment:yo,offFullscreenChange:Zt,offUnreadCountChange:Co,offCloseDiscussWindow:_o,offBlurWedocsWindow:Ro,offFocusWedocsWindow:Qo,offUrlChange:Jo,onConversationChange:yi,offConversationChange:ki,onClickDocTab:Xo,offClickDocTab:$o,onOpenDocInTimeline:xi,offOpenDocInTimeline:Ai});j.compareVersion(Z(),"3.1.20"),j.compareVersion(Z(),"3.1.23"),j.compareVersion(Z(),"4.0.0"),j.compareVersion(Z(),"4.0.2"),j.compareVersion(Z(),"4.0.6");var Yi={clean:bn,isWeDriveEnabled:_e,chooseWeDriveFile:xe,chooseTencentOfficeFile:Ae,getClipboardData:me,setClipboardData:be,fileDownload:Oe,getAppVersion:Te,compare:De,isNewWwapp:je,openCamera:Ie,quoteToDiscuss:Pe,forwardToConversion:Se,showNativePanel:Ye,updatePanelConfig:He,initToolbarConfig:$e,showNativeToolbar:Ke,updateToolbarConfig:ze,setTitle:on,showOnlineUserList:rn,getCustomTopbarButtonConfig:vn,onCustomTopbarButtonClick:wn,viewProfile:Re,onUnload:Me,selectPerson:qe,openUrl:yn,popBack:kn,saveImage:Wn,previewImage:Cn,chooseImage:_n,setActionButtons:Ze,showMenuActions:en,showBottomActionSheet:nn,updateActionButtons:tn,showNativeToast:An,notifyCommentActionToNative:Pn,notifyEmojiCommentToNative:Sn,allCommentPanelCountUpdated:On,showNativeAllCommentPanel:In,launchCommentInput:Tn,showEmojiActionPanel:Dn,vibration:rt,updateAuthority:Ve,getLoginCst:ct,docLogin:at,log:ut,sendMagicBoxMsg:lt,getClientMutexLock:ft,mapDocumentVersion:dt,removeDocumentVersion:pt,getOfflineLocalConfig:vt,isOfflineBidAvailable:wt,preloadJsReady:mt,manualSaveDocData:gt,notifyNative:ht,firstLoadFinished:yt,documentUrlReplace:bt,requestFocus:kt,insertWxworkGroupChat:Rn,isInWxworkGroupChat:Vn,joinWxworkGroupChat:Jn,enterWxworkGroupChat:Gn,createWxworkNameCardSelf:Xn,enterWxworkNameCard:$n,canChatWithWxworkNameCard:zn,joinWxworkCalender:et,queryWxworkCalenderInfo:Zn,createWxworkCalender:Kn,selectWxworkCalenderList:Hn,viewDetailWxworkCalender:Yn,openChatMessageDetail:tt,createTransferedChatMessageInfo:nt,clearDocUnread:Nn,showDiscussion:Bn,hideDiscussion:Ln,updateDiscussion:Fn,showCollaboratorPanel:Je,showNativeSingleCommentPanel:jn,hideNativeSingleCommentPanel:Mn,updateOnlineUserList:Ge,notifyDocChange:Un,updateMessageQuoteStatus:En,insertApp:ot,openMiniProgram:it,updateAuth:Xe,vibrateDevice:st,queryLatestUnreadMsg:Qn,queryConversationUnread:qn},Zi={clean:bn,getClipboardData:me,setClipboardData:be,getAppVersion:Te,compare:De,isNewWwapp:je,quoteToDiscuss:Pe,forwardToConversion:Se,setTitle:on,viewProfile:Re,onUnload:Me,selectPerson:qe,openUrl:yn,previewImage:Cn,showNativeToast:An,notifyCommentActionToNative:Pn,notifyEmojiCommentToNative:Sn,allCommentPanelCountUpdated:On,showNativeAllCommentPanel:In,launchCommentInput:Tn,showEmojiActionPanel:Dn,vibration:rt,updateAuthority:Ve,docLogin:at,log:ut},er={getAppVersion:Te,compare:De,isNewWwapp:je,viewProfile:Re,openUrl:yn,previewImage:Cn,getLoginCst:ct,docLogin:at},nr=ce(oe()?Yi:ie()?Zi:er,U.isWeWorkApp),tr=e(e(e({},nr),{isWedocWebview:oe}),oe()?{addEventListener:Ue,removeEventListener:Ee,removeIconButtonClickEvent:dn,callbackMap:sn,deleteCookie:pe}:{});H()===U.isWeWorkApp&&!oe()&&ie()&&document.addEventListener("WeixinJSBridgeReady",(function(){var e,n;Object.keys(tr).forEach((function(e){var n;er[e]||(null===(n=window.tdocs)||void 0===n?void 0:n[e])===tr[e]&&delete window.tdocs[e]})),null===(n=null===(e=window.qmailBridge)||void 0===e?void 0:e.destroy)||void 0===n||n.call(e),console.warn("no jsapi support for this wxwork mobile version")}));var or=function(e,n){e.invoke("docx","getNativeScreenSize",{},(function(e){var t;null===(t=n.success)||void 0===t||t.call(n,e)}))},ir=new Map;function rr(n,t){var o=e({},t);if("function"==typeof t.onclick){var i=ir.get(t.id);i&&i.func===t.onclick?o.onclick=i.callbackId:(o.onclick=n.callback(t.onclick),ir.set(t.id,{callbackId:o.onclick,func:t.onclick}))}return o}function sr(e,n){return n.map((function(n){return rr(e,n)}))}var cr,ar="undefined"==typeof window?{log:null}:window,ur=function(){function e(){}return e.debug=function(){for(var n,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];try{ar.log?(n=ar.log).debug.apply(n,t):console.debug.apply(console,t)}catch(n){e.error("日志发生错误","debug",t)}},e.log=function(){for(var n,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];try{ar.log?(n=ar.log).info.apply(n,t):console.log.apply(console,t)}catch(n){e.error("日志发生错误","log",t)}},e.warn=function(){for(var n,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];try{ar.log?(n=ar.log).warn.apply(n,t):console.warn.apply(console,t)}catch(n){e.error("日志发生错误","warn",t)}},e.error=function(){for(var e,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];try{ar.log?(e=ar.log).error.apply(e,n):console.error.apply(console,n)}catch(e){console.error("日志发生错误","error",n)}},e.time=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];var o={time:Date.now(),options:n};this.sTimeLableMap.set(e,o)},e.timeEnd=function(n){var t=Date.now(),o=e.sTimeLableMap.get(n);if(void 0!==o){var r=t-o.time,s="";o.options&&3===o.options.length&&"clientDatabaseRequest"===o.options[1]&&(s=o.options[2]),e.log.apply(e,i(["label: "+n+": "+r+"ms."],o.options||[])),e.speedReport(r,s),this.sTimeLableMap.delete(n)}},e.speedReport=function(e,n){n&&ar.dbjsApiSpeedReport&&ar.dbjsApiSpeedReport(e,n)},e.sTimeLableMap=new Map,e}(),lr=function(){function e(){this.currentSeqId=0,this.reqCallbacks=new Map}return Object.defineProperty(e.prototype,"canUseNativeAndroid",{get:function(){var e;return(null===(e=window.mqq)||void 0===e?void 0:e.android)&&window._mqqWebViewJSInterface&&window._mqqWebViewJSInterface.invoke},enumerable:!1,configurable:!0}),e.prototype.JSApiCallback=function(e){var n=this.reqCallbacks.get(e.callbackId);if(n){var t=n.callback,o=n.command,i=n.startTime;t&&(ur.debug("callback invokeNative-"+e.callbackId+"-"+o+"-"+(Date.now()-i)+"ms",this.canUseNativeAndroid,"response="+JSON.stringify(e)),t(e))}else ur.warn("callback invokeNative-"+e.callbackId+" reqCallback not found")},e.prototype.createReqSeq=function(){return this.currentSeqId++},e.prototype.invokeNative=function(e,n,t,o){var i=this.createReqSeq(),r=t.command;this.reqCallbacks.set(i,{callback:o,command:r,startTime:Date.now()}),ur.debug("start call invokeNative-"+i+"-"+r,e,n,r,this.canUseNativeAndroid,"request="+JSON.stringify(t)),t.callbackId=i,this.canUseNativeAndroid?this.invokeNativeAndroid(e,n,t):window.mqq&&window.mqq.invoke(e,n,t)},e.prototype.invokeNativeAndroid=function(e,n,t){var o="jsbridge://"+encodeURIComponent(e)+"/"+encodeURIComponent(n);t&&(o+="?p="+encodeURIComponent(JSON.stringify(t))),window._mqqWebViewJSInterface.invoke(o)},e.prototype.defaultOfflineCodeVersion=function(e,n){ur.debug("defaultOfflineCodeVersion-"+e),window.mqq&&window.mqq.invoke("docx","defaultOfflineCodeVersion",{type:e},(function(t){ur.debug("defaultOfflineCodeVersion-"+e),n&&n(t)}))},e}();j.isServerSide()?cr=null:window.jsApi?cr=window.jsApi:((cr=new lr).invokeNative=cr.invokeNative.bind(cr),cr.invokeNativeAndroid=cr.invokeNativeAndroid.bind(cr),window.jsApi=cr,window.JSApiCallback||(window.JSApiCallback=cr.JSApiCallback.bind(cr)));var fr=cr;function dr(e,t,o,i){void 0===i&&(i="docx");var r=o.success;o.fail;var s=n(o,["success","fail"]);e.invoke(i,t,s,r)}var pr=ce({getClipboardData:function(e,n){e.invoke("docx","readSystemClipboard",{},(function(e){var t;null===(t=null==n?void 0:n.success)||void 0===t||t.call(n,e)}))},setClipboardData:function(e,t){var o=t||{},i=o.success;o.fail;var r=n(o,["success","fail"]);e.invoke("docx","writeSystemClipboard",r,(function(e){null==i||i(e)}))},getAppVersion:function(e,n){var t;null===(t=n.success)||void 0===t||t.call(n,e.clientVersion)},updateAuthority:function(e,n){e.invoke("QQApi","updatePermission",{},n.success)},setWxWorkLogin:function(e,t){var o=t.success;t.fail;var i=n(t,["success","fail"]);e.invoke("docx","setWxWorkLogin",i,o)},compare:function(e,n){var t;null===(t=n.success)||void 0===t||t.call(n,j.compareVersion(e.clientVersion,n.version||""))},copyNativeImage:function(e,n){var t=n||{},o=t.x,i=t.y;e.invoke("docx","copyNativeImageByPosition",{x:o,y:i})},openCamera:function(e,n){e.invoke("docx","openCamera",{},(function(e){var t;e.url&&(null===(t=null==n?void 0:n.success)||void 0===t||t.call(n,e))}))},checkCameraPermission:function(e,n){e.invoke("docx","cameraCheckPermission",{},(function(){var e;null===(e=null==n?void 0:n.success)||void 0===e||e.call(n,{})}))},getScreenSize:function(e,n){or(e,n)},getDeviceId:function(e,n){},setTitle:function(e,n){null==e||e.invoke("ui","setWebviewNaviTitle",{title:n.title})},showNativeHeader:function(e){e.invoke("titlebar","setState",{state:1})},hideNativeHeader:function(e){e.invoke("titlebar","setState",{state:0})},openUrl:function(e,n){e.ui.openUrl({url:n.url,target:N.Detail,style:1})},openInBrowser:function(e,n){e.publicAccount.openInExternalBrowser(n.url)},jumpNativeList:function(e,n){e.invoke("QQApi","jumpNativeList",n,n.callback)},saveImage:function(t,o){var i=o.success;o.fail;var r=n(o,["success","fail"]);Y()===E.Android?null==fr||fr.invokeNative("ui","savePublicImg",r,(function(n){null==i||i(e({data:n.result},n))})):t.invoke("ui","savePublicImg",r,i)},chooseImage:function(e,n){console.log(e,n),e.invoke("docx","multipleImagePicker",{max_count:n.max_count},(function(e){var t,o;0===e.retcode?null===(t=n.success)||void 0===t||t.call(n,e):null===(o=n.fail)||void 0===o||o.call(n,"",e.retcode)}))},showDialog:function(e,n){e.invoke("titlebar","showDialogById",rr(e,{id:n.id,event:n.event,msg:n.msg,btnText:n.btnText,onclick:n.onClick}))},setActionButtons:function(e,n){var t=sr(e,n.buttons);e.invoke("titlebar","setActionButtons",{buttons:t})},updateActionButtons:function(e,n){var t=sr(e,n.buttons);e.invoke("titlebar","updateActionButtonsById",{buttons:t})},popBack:function(e){e.invoke("ui","popBack")},setTitleButtons:function(e,t){t.success,t.fail;var o=n(t,["success","fail"]);e.ui.setTitleButtons(o)},fileDownload:function(e,n){e.invoke("docx","fileDownload",n.url)},getZoomState:function(e,n){e.invoke("QQApi","getZoomState",{},n.success)},setZoomState:function(e,t){var o=t.success;t.fail;var i=n(t,["success","fail"]);e.invoke("QQApi","setZoomState",i,o)},logoutAccount:function(e,n){e.invoke("docx","logoutAccount",(function(){var e;null===(e=n.success)||void 0===e||e.call(n)}))},updateUndoRedoState:function(e,n){e.invoke("docx","updateUndoRedoState",{isUndoAvailable:n.isUndoAvailable,isRedoAvailable:n.isRedoAvailable},(function(){var e;null===(e=n.success)||void 0===e||e.call(n)}))},sendMagicBoxMsg:function(t,o){var i=o.success;o.fail;var r=n(o,["success","fail"]);t.invoke("magicbox","emitEvent",e({},r),i)},getClientMutexLock:function(e,t){var o=t.success;t.fail;var i=n(t,["success","fail"]);null==fr||fr.invokeNative("docx","clientMutexLock",i,(function(e){null==o||o(e)}))},mapDocumentVersion:function(e,n){dr(e,"mapDocumentVersion",n)},removeDocumentVersion:function(e,n){dr(e,"removeDocumentVersion",n)},isOfflineBidAvailable:function(e,n){dr(e,"isOfflineBidAvailable",n)},getOfflineLocalConfig:function(e,n){dr(e,"getOfflineLocalConfig",n)},preloadJsReady:function(e,t){var o=t.success;t.fail;var i=n(t,["success","fail"]);null==fr||fr.invokeNative("docx","preloadJsReady",i,(function(e){null==o||o(e)}))},manualSaveDocData:function(e,n){dr(e,"manualSaveDocData",n)},notifyNative:function(e,n){dr(e,"notifyNative",n)},firstLoadFinished:function(e,t){var o=t.success;t.fail;var i=n(t,["success","fail"]);e.invoke("docx","firstLoadFinished",i,o)},updateNativeList:function(e,n){e.invoke("QQApi","updateNativeList",{target:n.target},n.success)},requestFocus:function(e,t){var o=t.success;t.fail;var i=n(t,["success","fail"]);e.invoke("docx","requestFocus",i,o)},clientDatabaseRequest:function(e,t){var o=t.success;t.fail;var i=n(t,["success","fail"]);null==fr||fr.invokeNative("docx","clientDatabaseRequest",i,(function(e){null==o||o(e)}))}},U.isTencentDocsApp),vr=e({},pr);function wr(t,o,i){var r=Date.now().toString(36)+Math.random().toString(36).substring(2),s=function(e){return"__MEETING_SDK_CALLBACK_"+e}(r),c=i.success,a=i.fail,u=n(i,["success","fail"]),l=e(e({},o),{callId:r,callback:s,param:u});window[s]=function(e){if(delete window[s],"string"==typeof e)try{e=JSON.parse(e)}catch(e){}1===(null==e?void 0:e.code)?null==c||c(e.data||{}):null==a||a(e)},t.invokeNative("JSCallNative",l)}var hr,gr=j.compareVersion((hr=j.getLowerCaseUserAgent().match(/app_version\/([0-9.]*)/))?hr[1]:"","3.13.0.0")>=0,mr=ce(e({closeLoading:function(e,n){wr(e,{module:"CommonPlugin",method:"HideLoading"},n)},docLogin:function(e,n){(function(){return t(this,void 0,Promise,(function(){return o(this,(function(e){return[2,window.wemeet.wework.getCurDocAuthData({pageType:1})]}))}))})().then((function(e){var t,o,i,r,s=e.authCode,c=e.meetingId,a=e.openId,u=e.docCode;s&&c&&a&&u?(o={code:s,meeting_id:c,openid:a,doc_code:u},i=n,r=Object.keys(o).map((function(e){return e+"="+encodeURIComponent(o[e])})).join("&"),fetch("/disklogin/login?from_tdocs_jsapi=1&product=2&from=33&f=json&"+r).then((function(e){return e.json()})).then((function(e){var n,t,o;return 0===(null===(n=null==e?void 0:e.head)||void 0===n?void 0:n.ret)?null===(t=null==i?void 0:i.success)||void 0===t?void 0:t.call(i,e):null===(o=null==i?void 0:i.fail)||void 0===o?void 0:o.call(i,e)})).catch((function(e){var n;return null===(n=null==i?void 0:i.fail)||void 0===n?void 0:n.call(i,e)}))):null===(t=n.fail)||void 0===t||t.call(n,{err_msg:"need meeting_id、openid、authCode、docCode",authCode:s,meetingId:c,openId:a,docCode:u})})).catch((function(e){var t;null===(t=n.fail)||void 0===t||t.call(n,e)}))},setDocTitle:function(e,n){wr(e,{module:"DocSharePlugin",method:"SetDocTitle"},n)}},gr?{enableRecordRect:function(e,n){wr(e,{module:"WebAppSharePlugin",method:"EnableRecordRect"},n)}}:{}),U.isTencentMeeting);return function(){var e,n=H(),t=Y();!function(e){if(!X)if(document.getElementById("tdocsJSScript"))J=Promise.resolve();else{var n=document.createElement("script");switch(n.id="tdocsJSScript",n.crossOrigin="anonymous",e){case U.IsQQ:case U.isQQMiniProgram:case U.isTencentDocsApp:n.src=m;break;case U.isElectronTencentDocsClient:return void(J=Promise.resolve());case U.isWXh5:n.src=b;break;case U.isWeWork:if(re())n.src=k;else if(te()){if(!fe())return void(J=Promise.resolve());n.src=W}else{if(!ee())return console.error("no jsapi support for this wxwork version"),void(J=Promise.resolve());n.src=k}break;case U.isWeWorkApp:if(oe())n.src=y;else{if(!ie())return console.error("no jsapi support for this wxwork mobile version"),void(J=Promise.resolve());if(!fe())return void(J=Promise.resolve());n.src=C}break;case U.isTencentMeeting:window.tencentMeetingSDK=G.getInstance(),n.src=_}if("loading"===document.readyState){try{document.write(n.outerHTML)}catch(e){console.error("document.write error",e)}if(document.getElementById("tdocsJSScript"))return void(J=Promise.resolve())}J=new Promise((function(e,t){n.onload=function(){console.error("--------资源加载成功"),e()},n.onerror=function(){console.error("--------资源加载失败"),t()},null!==document.head?document.head.appendChild(n):document.body.appendChild(n)}))}}(n);var o=((e={})[U.isWeWork]=re()?Hi:Xi,e[U.isWeWorkApp]=re()?tr:Ft,e[U.isTencentDocsApp]=vr,e[U.isElectronTencentDocsClient]=vr,e[U.isQQMiniProgram]=vr,e[U.IsQQ]=vr,e[U.isWXh5]={},e[U.isTencentMeeting]=mr,e[U.UNKNOW]={},e)[n];return Object.assign({environmentType:n,platform:t,version:"1.31.6"},o)}()}));
