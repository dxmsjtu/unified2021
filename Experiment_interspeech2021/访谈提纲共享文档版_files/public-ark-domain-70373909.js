"object"==typeof globalThis&&(globalThis.jsExecStartTimeStamp=Date.now()),(self.webpackChunkuni=self.webpackChunkuni||[]).push([[8487],{2626:function(t,e,n){var r,i,o;n.d(e,{FW:function(){return o},Lq:function(){return i},zM:function(){return r}}),function(t){t.C_DOMAIN="C_DOMAIN",t.B_DOMAIN="B_DOMAIN"}(r||(r={})),function(t){t.WECHAT="wx",t.WEWORK="ww",t.QQ="qq"}(i||(i={})),function(t){t[t.WEWORK=2]="WEWORK",t[t.WECHAT=1]="WECHAT"}(o||(o={}))},57753:function(t,e,n){n.d(e,{K:function(){return s}});var r=n(85556),i=n(44225),o=n(5448),a=n(86753),s=function(t){function e(e){var n=t.call(this)||this;return n.wedocOpenId="",n.wedriveUin="",n.corpId="",n.corpName="",n.englishName="",n.loginType=o.Q.UNKNOWN,n.nowUserIndex="",n.openId="",n.tinyId=a.Dr,n.uidSource=o.Q.UNKNOWN,n.uin="",n.userId="",n.userName="",n.userPic="",n.settings={language:"",toolbarMode:""},e?e.tinyId?(n.jsonObj2Class(e),n):(n.jsonObj2Class((0,r.__assign)((0,r.__assign)({},e),{tinyId:a.Dr})),n):n}return(0,r.__extends)(e,t),e}(i.K)},34139:function(t,e,n){var r;n.d(e,{g:function(){return r}}),function(t){t.BINDING="BINDING",t.UNBIND="UNBIND"}(r||(r={}))},6750:function(t,e,n){n.d(e,{B:function(){return s}});var r=n(85556),i=n(44225),o=n(5448),a=n(34139),s=function(t){function e(e){var n=t.call(this)||this;if(n.type=a.g.UNBIND,n.userName="",n.userPic="",n.accountType=o.Q.UNKNOWN,e){n.loginType=e.loginType;var r=n.handleBindUserInfo(e);n.jsonObj2Class(r)}return n}return(0,r.__extends)(e,t),e.prototype.handleBindUserInfo=function(t){var e=t.wxAvatar,n=t.wxNick,r=t.qqAvatar,i=t.qqNick;return t.wxOpenid&&this.loginType!==o.Q.WX?{type:a.g.BINDING,userName:n,userPic:e,accountType:o.Q.WX}:r&&this.loginType!==o.Q.QQ?{type:a.g.BINDING,userName:i,userPic:r,accountType:o.Q.QQ}:{type:a.g.UNBIND,userName:"",userPic:"",accountType:o.Q.UNKNOWN}},e}(i.K)},60877:function(t,e,n){n.d(e,{Z:function(){return i}});var r=n(85556),i=function(t){function e(e){var n=t.call(this)||this;return n.avatar="",n.nick="",n.introduction="",n.type=0,n.principal="",n.credential="",n.isOfficialAccount=!1,e&&(n.setOfficialAccountStatus(e),n.jsonObj2Class(e)),n}return(0,r.__extends)(e,t),e.prototype.setOfficialAccountStatus=function(t){this.isOfficialAccount=!!t.credential},e}(n(44225).K)},86753:function(t,e,n){n.d(e,{gz:function(){return i.g},vA:function(){return o.vA},RM:function(){return o.RM},T0:function(){return o.T0},gq:function(){return o.gq},pN:function(){return o.pN},Dr:function(){return a},qu:function(){return o.qu},n6:function(){return r}});var r,i=n(34139),o=n(77058);!function(t){t[t.UNAUTHED=0]="UNAUTHED",t[t.ENTERPRISE=1]="ENTERPRISE",t[t.ENTERPRISE_MEDIA=2]="ENTERPRISE_MEDIA",t[t.GOVERNMENT=3]="GOVERNMENT",t[t.NON_PROFIT_ORGANIZATION=4]="NON_PROFIT_ORGANIZATION",t[t.PRIVATE_NON_ENTERPRISE=5]="PRIVATE_NON_ENTERPRISE",t[t.FOR_PROFIT_ORGANIZATION=6]="FOR_PROFIT_ORGANIZATION",t[t.SOCIAL_GROUPS=8]="SOCIAL_GROUPS",t[t.BUSINESS_MEDIA=9]="BUSINESS_MEDIA",t[t.BUSINESS_UNIT=11]="BUSINESS_UNIT",t[t.INDIVIDUAL_INDUSTRIAL_AND_COMMERCIAL_HOUSEHOLDS=12]="INDIVIDUAL_INDUSTRIAL_AND_COMMERCIAL_HOUSEHOLDS",t[t.OVERSEAS_COMPANIES=13]="OVERSEAS_COMPANIES"}(r||(r={}));var a="100000000000000000"},77058:function(t,e,n){var r,i,o,a,s,c;n.d(e,{RM:function(){return c},T0:function(){return s},gq:function(){return i},pN:function(){return r},qu:function(){return o},vA:function(){return a}}),function(t){t[t.NOT_YET=1]="NOT_YET",t[t.USING=2]="USING",t[t.EXPIRED=3]="EXPIRED"}(r||(r={})),function(t){t[t.NO_STATUS=0]="NO_STATUS",t[t.CLOSE=1]="CLOSE",t[t.OPEN=2]="OPEN",t[t.EXPIRED=3]="EXPIRED"}(i||(i={})),function(t){t.NORMAL="NORMAL",t.SUPER="SUPER",t.NONE="NONE",t.EXPIRED="EXPIRED"}(o||(o={})),function(t){t[t.INVALID_CORP_VIP_LEVEL=0]="INVALID_CORP_VIP_LEVEL",t[t.CORP_VIP_LEVEL_BASIC=1]="CORP_VIP_LEVEL_BASIC",t[t.CORP_VIP_LEVEL_PRO=2]="CORP_VIP_LEVEL_PRO"}(a||(a={})),function(t){t[t.NONE=1]="NONE",t[t.NORMAL=2]="NORMAL",t[t.SUPER=3]="SUPER"}(s||(s={})),function(t){t[t.NONE=0]="NONE",t[t.AUTO_RENEWAL=1]="AUTO_RENEWAL",t[t.CLOSED=2]="CLOSED"}(c||(c={}))},94796:function(t,e,n){n.d(e,{UV:function(){return o},a5:function(){return i},eP:function(){return a},sY:function(){return c},sv:function(){return s}});var r=n(13775),i=("".concat(r.d0,"account-list"),"/session/api/multiacc/account_list"),o="".concat(r.d0,"logout"),a="".concat(r.Hf,"/disklogin/session_list"),s="".concat(r.Hf,"/sdc/getusermarkname"),c="/session/api/multiacc/change-sig"},95005:function(t,e,n){n.d(e,{A:function(){return c},Ab:function(){return p},DE:function(){return u},Fc:function(){return f},KH:function(){return _},NO:function(){return a},Nv:function(){return i},TF:function(){return l},V3:function(){return d},mV:function(){return o},sk:function(){return s}});var r=n(13775),i="".concat(r.Hf,"/session/logout"),o="".concat(r.HL,"user_unbind"),a="".concat(r.HL,"user_bind"),s="".concat(r.Hf,"/v2/cgi-bin/online_docs/polling"),c="".concat(r.Hf,"/cgi-bin/online_docs/wxqrcode"),u=("".concat(r.bd,"/session/logout"),"".concat(r.bd,"/disklogin/logout")),d="".concat(r.RP,"/session/logout"),_="".concat(r.HL,"user_info"),p="".concat(r.HL,"bind/permission/uid"),f="".concat(r.HL,"bind/permission/uin"),l="".concat(r.Hf,"/v2/user/wechat/auth/switch")},25732:function(t,e,n){n.d(e,{P:function(){return _}});var r=n(85556),i=n(16740),o=n(11268),a=n(33661),s=n(5448),c=n(46163),u=n(73154),d=n(95005),_=function(){function t(t){this.networkRequestService=t}return t.prototype.logout=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(e){return t=(0,u.At)(d.Nv,{xrsf:"".concat((0,c.w$)(c.$W.xsrf))}),[2,this.networkRequestService.instance.get(t)]}))}))},t.prototype.wecomLogoutForBDomain=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e=(0,u.At)(d.DE,{xrsf:"".concat((0,c.w$)(c.$W.xsrf)),sid:t}),[2,this.networkRequestService.instance.get(e)]}))}))},t.prototype.wecomLogoutForCDomain=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e=(0,u.At)(d.V3,{xrsf:"".concat((0,c.w$)(c.$W.xsrf)),vid:t}),[2,this.networkRequestService.instance.get(e)]}))}))},t.prototype.unbindUserInfo=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e=(0,a.bk)({type:t,xsrf:(0,c.w$)(c.$W.xsrf)}),[2,this.networkRequestService.instance.post(d.mV,e)]}))}))},t.prototype.bindUserInfo=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(e){return t=(0,a.bk)({bindType:s.Q.QQ,p_luin:(0,c.ej)("p_luin"),p_uin:(0,c.ej)("p_uin"),p_skey:(0,c.ej)("p_skey"),p_lskey:(0,c.ej)("p_lskey"),xsrf:(0,c.w$)(c.$W.xsrf)}),[2,this.networkRequestService.instance.post(d.NO,t)]}))}))},t.prototype.CurrentLoginAccountBindInfo=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return[2,this.networkRequestService.instance.get(d.Ab)]}))}))},t.prototype.BindingAccountInfo=function(t){return void 0===t&&(t=!1),(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,r.__generator)(this,(function(i){return e=(0,r.__assign)({},t?{uflag:"qqsig"}:null),n=(0,u.At)(d.Fc,e),[2,this.networkRequestService.instance.get(n)]}))}))},t.prototype.getBindWxQrCode=function(t){var e="".concat(d.A,"?xsrf=").concat((0,c.w$)(c.$W.xsrf),"&page=").concat(encodeURIComponent("pages/bindwx/bindwx"),"&ac=bind&ts=").concat(Date.now(),"&u=").concat(t,"&checkKey=1");return this.networkRequestService.instance.get(e)},t.prototype.getBindProcess=function(t){var e="".concat(d.sk,"?CheckKey=").concat(t);return this.networkRequestService.instance.post(e)},t.prototype.getPersonalUserInfo=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,r.__generator)(this,(function(n){return t=(0,c.w$)(c.$W.xsrf),e="".concat(d.KH,"?xsrf=").concat(t,"&get_vip_info=1"),[2,this.networkRequestService.instance.get(e)]}))}))},t.prototype.getCertificationGrey=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return[2,this.networkRequestService.instance.get(d.TF)]}))}))},(0,r.__decorate)([(0,i.Hh)(),(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"logout",null),(0,r.__decorate)([(0,i.Hh)(),(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"wecomLogoutForBDomain",null),(0,r.__decorate)([(0,i.Hh)(),(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"wecomLogoutForCDomain",null),(0,r.__decorate)([(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Number]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"unbindUserInfo",null),(0,r.__decorate)([(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"bindUserInfo",null),(0,r.__decorate)([(0,i.Hh)(),(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"CurrentLoginAccountBindInfo",null),(0,r.__decorate)([(0,i.Hh)(),(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"BindingAccountInfo",null),(0,r.__decorate)([(0,i.Hh)(),(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"getBindWxQrCode",null),(0,r.__decorate)([(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"getBindProcess",null),(0,r.__decorate)([(0,i.Hh)(),(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"getPersonalUserInfo",null),(0,r.__decorate)([(0,i.Hh)(),(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"getCertificationGrey",null),t=(0,r.__decorate)([(0,r.__param)(0,o._),(0,r.__metadata)("design:paramtypes",[Object])],t)}()},68318:function(t,e,n){n.d(e,{Z:function(){return h}});var r=n(85556),i=n(16740),o=n(11268),a=n(33661),s=n(46163),c=n(88694),u=n(73154),d=n(64261),_=n(13775),p="".concat(_.HL,"user_info"),f="".concat(_.Hf,"/api/userinfo/set"),l="".concat(_.Hf,"/doc/info"),h=function(){function t(t){this.networkRequestService=t}return t.prototype.getPersonalUserInfo=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,r.__generator)(this,(function(n){return t=(0,s.w$)(s.$W.xsrf),e="".concat(p,"?xsrf=").concat(t,"&get_vip_info=1"),[2,this.networkRequestService.instance.get(e)]}))}))},t.prototype.updatePersonalNicknameAndAvatar=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n,i;return(0,r.__generator)(this,(function(r){return e=t.nick,n=t.avatar,i=(0,a.bk)({nick:e,avatar:n}),[2,this.networkRequestService.instance.post(f,i)]}))}))},t.prototype.getEnterpriseUserInfo=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,d.wdocsUserCenter.getUserInfo()];case 1:return t=e.sent(),[2,(0,c.MO)(t)]}}))}))},t.prototype.getEnterpriseDocInfo=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,r.__generator)(this,(function(i){return this.enterpriseDocInfoPromise&&!t||(e=(0,u.At)(l,{xrsf:"".concat((0,s.w$)(s.$W.xsrf)),func:4}),n=this.networkRequestService.instance.get(e).then((function(t){return(0,r.__assign)((0,r.__assign)({},t),{data:(0,r.__assign)((0,r.__assign)({},t.data),{retcode:t.data.head.ret,msg:t.data.head.msg})})})),this.enterpriseDocInfoPromise=n),[2,this.enterpriseDocInfoPromise]}))}))},(0,r.__decorate)([(0,i.Hh)(),(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"getPersonalUserInfo",null),(0,r.__decorate)([(0,i.Hh)(),(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"updatePersonalNicknameAndAvatar",null),(0,r.__decorate)([(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Boolean]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"getEnterpriseDocInfo",null),t=(0,r.__decorate)([(0,r.__param)(0,o._),(0,r.__metadata)("design:paramtypes",[Object])],t)}()},11288:function(t,e,n){n.d(e,{b:function(){return r}});var r=(0,n(66624).yh)("IAccountDomainService")},15846:function(t,e,n){n.d(e,{D:function(){return W}});var r=n(85556),i=n(86753),o=n(11268),a=n(99181),s=n(16740),c=n(46163),u=n(94796),d=function(){function t(t){this.networkRequestService=t}return t.prototype.getAccountList=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return n="".concat(u.a5,"?xrsf=").concat((0,c.w$)(c.$W.xsrf)),t?[4,this.networkRequestService.instance.get(n,{params:{padID:t}})]:[3,2];case 1:case 3:case 5:return[2,r.sent()];case 2:return e?[4,this.networkRequestService.instance.get(n,{params:{folderID:e}})]:[3,4];case 4:return[4,this.networkRequestService.instance.get(n)]}}))}))},t.prototype.delAccountForList=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e="".concat(u.UV,"?xrsf=").concat((0,c.w$)(c.$W.xsrf),"&u=").concat(t),[2,this.networkRequestService.instance.get(e)]}))}))},t.prototype.changeSign=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e="".concat(u.sY,"?xrsf=").concat((0,c.w$)(c.$W.xsrf),"&u=").concat(t),[2,this.networkRequestService.instance.get(e)]}))}))},(0,r.__decorate)([(0,s.Hh)(),(0,s.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String,String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"getAccountList",null),(0,r.__decorate)([(0,s.Hh)(),(0,s.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"delAccountForList",null),(0,r.__decorate)([(0,s.Hh)(),(0,s.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"changeSign",null),t=(0,r.__decorate)([(0,r.__param)(0,o._),(0,r.__metadata)("design:paramtypes",[Object])],t)}(),_=n(94404),p=function(t){function e(e,n){var r=t.call(this,n)||this;return r.networkRequestService=e,r.accountListRepository=new d(e),r.accountList=[],r}return(0,r.__extends)(e,t),e.prototype.changeSign=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.accountListRepository.changeSign(t)];case 1:return[2,0===(null==(e=n.sent().resData)?void 0:e.retcode)]}}))}))},e.prototype.getAccountList=function(t,e){var n,i;return(0,r.__awaiter)(this,void 0,void 0,(function(){var o;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.accountListRepository.getAccountList(t,e)];case 1:return o=r.sent().resData,this.accountList=(null===(i=null===(n=null==o?void 0:o.data)||void 0===n?void 0:n.result)||void 0===i?void 0:i.accounts)?o.data.result.accounts:[],[2,this.accountList]}}))}))},e.prototype.delAccountForList=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.accountListRepository.delAccountForList(t)];case 1:return e=n.sent().resData,this.updateListAfterDel(t),[2,0===(null==e?void 0:e.retcode)]}}))}))},e.prototype.updateListAfterDel=function(t){this.accountList=this.accountList.filter((function(e){return e.userIndex!==t}))},e=(0,r.__decorate)([(0,r.__param)(0,o._),(0,r.__metadata)("design:paramtypes",[Object,String])],e)}(_.J),f=p,l=n(33661),h=n(13775),g="".concat(h.Hf,"/online_docs_cgi/pwd/add"),v="".concat(h.Hf,"/online_docs_cgi/pwd/del"),m="".concat(h.Hf,"/online_docs_cgi/pwd/verify"),y="".concat(h.Hf,"/online_docs_cgi/pwd/reset"),w="".concat(h.Hf,"/online_docs_cgi/pwd/verify_code_get"),I="".concat(h.Hf,"/online_docs_cgi/pwd/verify_code_check"),b="".concat(h.Hf,"/online_docs_cgi/pwd/question_check"),S="".concat(h.Hf,"/online_docs_cgi/pwd/question_get"),A="".concat(h.Hf,"/online_docs_cgi/pwd/tips_get"),C="".concat(h.Hf,"/online_docs_cgi/pwd/token_verify"),E=("".concat(h.Hf,"/online_docs_cgi/pwd/tips_report"),function(){function t(t){this.networkRequestService=t}return t.prototype.pwdAdd=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e=(0,l.bk)((0,r.__assign)({xsrf:(0,c.w$)(c.$W.xsrf)},t)),[2,this.networkRequestService.instance.post(g,e)]}))}))},t.prototype.pwdDel=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e=(0,l.bk)((0,r.__assign)({xsrf:(0,c.w$)(c.$W.xsrf)},this.changeParam(t))),[2,this.networkRequestService.instance.post(v,e)]}))}))},t.prototype.pwdVerify=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e=(0,l.bk)((0,r.__assign)({xsrf:(0,c.w$)(c.$W.xsrf)},t)),[2,this.networkRequestService.instance.post(m,e)]}))}))},t.prototype.pwdReset=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e=(0,l.bk)((0,r.__assign)({xsrf:(0,c.w$)(c.$W.xsrf)},this.changeParam(t))),[2,this.networkRequestService.instance.post(y,e)]}))}))},t.prototype.pwdVerifyCodeGet=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e=(0,l.bk)((0,r.__assign)({xsrf:(0,c.w$)(c.$W.xsrf)},t)),[2,this.networkRequestService.instance.post(w,e)]}))}))},t.prototype.pwdVerifyCodeCheck=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e=(0,l.bk)((0,r.__assign)({xsrf:(0,c.w$)(c.$W.xsrf)},t)),[2,this.networkRequestService.instance.post(I,e)]}))}))},t.prototype.pwdQuestionCheck=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e=(0,l.bk)((0,r.__assign)({xsrf:(0,c.w$)(c.$W.xsrf)},this.changeParam(t))),[2,this.networkRequestService.instance.post(b,e)]}))}))},t.prototype.pwdQuestionGet=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(e){return t=(0,l.bk)({xsrf:(0,c.w$)(c.$W.xsrf)}),[2,this.networkRequestService.instance.post(S,t)]}))}))},t.prototype.pwdTipsGet=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(e){return t=(0,l.bk)({xsrf:(0,c.w$)(c.$W.xsrf)}),[2,this.networkRequestService.instance.post(A,t)]}))}))},t.prototype.pwdTokenVerify=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,this.networkRequestService.instance.post(C,(0,r.__assign)({xsrf:(0,c.w$)(c.$W.xsrf)},t))]}))}))},t.prototype.changeParam=function(t){return t.question_info?(0,r.__assign)((0,r.__assign)({},t),{question_info:JSON.stringify(t.question_info)}):t},(0,r.__decorate)([(0,s.Hh)(),(0,s.bj)(),(0,s.w1)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"pwdAdd",null),(0,r.__decorate)([(0,s.Hh)(),(0,s.bj)(),(0,s.w1)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"pwdDel",null),(0,r.__decorate)([(0,s.Hh)(),(0,s.bj)(),(0,s.w1)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"pwdVerify",null),(0,r.__decorate)([(0,s.Hh)(),(0,s.bj)(),(0,s.w1)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"pwdReset",null),(0,r.__decorate)([(0,s.Hh)(),(0,s.bj)(),(0,s.w1)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"pwdVerifyCodeGet",null),(0,r.__decorate)([(0,s.Hh)(),(0,s.bj)(),(0,s.w1)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"pwdVerifyCodeCheck",null),(0,r.__decorate)([(0,s.Hh)(),(0,s.bj)(),(0,s.w1)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"pwdQuestionCheck",null),(0,r.__decorate)([(0,s.Hh)(),(0,s.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"pwdQuestionGet",null),(0,r.__decorate)([(0,s.Hh)(),(0,s.bj)(),(0,s.w1)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"pwdTipsGet",null),(0,r.__decorate)([(0,s.Hh)(),(0,s.bj)(),(0,s.w1)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"pwdTokenVerify",null),t=(0,r.__decorate)([(0,r.__param)(0,o._),(0,r.__metadata)("design:paramtypes",[Object])],t)}()),R=function(t){function e(e,n){var r=t.call(this,n)||this;return r.networkRequestService=e,r.phone="",r.isHasPassword=!1,r.pwdQuestionList=[],r.passwordRepository=new E(r.networkRequestService),r}return(0,r.__extends)(e,t),e.prototype.updatePwdTips=function(){var t,e,n;return(0,r.__awaiter)(this,void 0,void 0,(function(){var i;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.passwordRepository.pwdTipsGet()];case 1:return i=r.sent().resData,this.isHasPassword=!!(null===(t=null==i?void 0:i.data)||void 0===t?void 0:t.hasPwd),this.phone=null!==(n=null===(e=null==i?void 0:i.data)||void 0===e?void 0:e.pwdPhoneNum)&&void 0!==n?n:"",[2]}}))}))},e.prototype.updatePwdQuestionList=function(){var t,e;return(0,r.__awaiter)(this,void 0,void 0,(function(){var n;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.passwordRepository.pwdQuestionGet()];case 1:return n=r.sent().resData,this.pwdQuestionList=null!==(e=null===(t=null==n?void 0:n.data)||void 0===t?void 0:t.questionInfo)&&void 0!==e?e:[],[2]}}))}))},e=(0,r.__decorate)([(0,r.__param)(0,o._),(0,r.__metadata)("design:paramtypes",[Object,String])],e)}(_.J),M=n(6750),O=n(60877),D=n(44225),k=n(77058),L=function(t){function e(e){var n=t.call(this)||this;if(n.type=k.qu.NONE,n.beginTime=0,n.endTime=0,n.vip={status:0,beginTime:0,endTime:0,renewalStatus:0},n.svip={status:0,beginTime:0,endTime:0,renewalStatus:0},n.vvip={status:0,beginTime:0,endTime:0},n.customInfo={avatarFrame:"",badgeUrl:"",corpVipLevel:k.vA.INVALID_CORP_VIP_LEVEL},n.cursor={},n.cursorId="",n.alwayShowCursor=!1,!e)return n;var r=n.handleVipInfoFromNet(e);return n.jsonObj2Class(r),n}return(0,r.__extends)(e,t),e.prototype.updateVipUserInfo=function(t){var e=this.handleVipInfoFromNet(t);this.jsonObj2Class(e)},e.prototype.updateEnterpriseVipUserInfo=function(t){if(t){var e=this.handleVipCustomInfoFromNet(t);this.jsonObj2Class({customInfo:e})}},e.prototype.handleVipInfoFromNet=function(t){var e,n=k.qu.NONE,r=k.gq.CLOSE,i=t.result.all,o=i.info,a=i.vip,s=i.superVip,c=i.decorationConfig,u=0,d=0;return s.endTime&&(u=1e3*parseInt(s.endTime,10)),a.endTime&&(d=1e3*parseInt(a.endTime,10)),o.vipLevel===k.T0.SUPER?(n=k.qu.SUPER,r=k.gq.OPEN):o.vipLevel===k.T0.NORMAL&&(n=k.qu.NORMAL,r=k.gq.OPEN),o.expiredStatus&&(n=k.qu.EXPIRED,r=k.gq.EXPIRED),{vip:{status:r,beginTime:0,endTime:d},svip:{status:s.status,beginTime:0,endTime:u},vvip:this.vvip,type:n,beginTime:0,endTime:0,renewal:o.renewalStatus,customInfo:{avatarFrame:o.avatarFrameUrl,badgeUrl:o.badgeUrl,corpVipLevel:o.corpVipLevel},cursor:this.parseCursor(o.cursor),cursorId:o.cursorId,alwayShowCursor:(null===(e=null==c?void 0:c.cursor)||void 0===e?void 0:e.alwaysShowSelfCursor)||!1}},e.prototype.parseCursor=function(t){var e={};try{e=JSON.parse(t)}catch(t){e={}}return e},e.prototype.handleVipCustomInfoFromNet=function(t){var e={};try{e=JSON.parse(t)}catch(t){e={}}var n=e.avatar_frame_url,r=void 0===n?"":n,i=e.badge_url,o=void 0===i?"":i,a=e.corp_vip_level;return{avatarFrame:r,badgeUrl:o,corpVipLevel:void 0===a?k.vA.INVALID_CORP_VIP_LEVEL:a}},e}(D.K),P=n(25732),T=n(25882),x=n(5448),F=n(47300),N=n(57753),j=function(t){function e(e,n,r){var i=t.call(this,n)||this;return i.networkRequestService=e,i.userInfo=new N.K,i.vipInfo=new L,i.bindUserInfo=new M.B,i.officialInfo=new O.Z,i.userInfo=new N.K(r),i.accountListEntity=new f(e,n),i.passwordEntity=new R(e,n),i.accountRepository=new P.P(e),i}return(0,r.__extends)(e,t),e.prototype.completionUserInfo=function(t){t.wechatOfficialAccount&&(this.officialInfo=new O.Z(t.wechatOfficialAccount)),this.bindUserInfo=new M.B(t)},e.prototype.completionVipInfo=function(t){this.vipInfo.updateVipUserInfo(t)},e.prototype.updateNowUserIndex=function(t){t&&(window.nowUserIndex=t)},e.prototype.currentLoginAccountBindInfo=function(){var t;return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.accountRepository.CurrentLoginAccountBindInfo()];case 1:return e=r.sent(),(n=null===(t=e.resData)||void 0===t?void 0:t.data)?[2,n]:[2,{allowBind:!1,allowUnbind:!1,nextAllowBindTime:0,nextAllowUnbindTime:0,autoRenewal:!1}]}}))}))},e.prototype.bindingQQInfo=function(){var t,e;return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,i,o,a,s,c;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return n=this.userInfo.loginType,i=![x.Q.QQ,x.Q.WX].includes(n),[4,this.accountRepository.CurrentLoginAccountBindInfo()];case 1:return o=r.sent(),[4,this.accountRepository.BindingAccountInfo(i)];case 2:return a=r.sent(),s=null===(t=o.resData)||void 0===t?void 0:t.data,c=null===(e=a.resData)||void 0===e?void 0:e.data,s&&c?[2,{isCanBind:s.allowBind&&c.allowBind,nextBindTime:(0,F.Z)([s.nextAllowBindTime,c.nextAllowBindTime]),qqNickName:c.nick,qqAvatar:c.avatar}]:[2,{isCanBind:!1,nextBindTime:0,qqAvatar:"",qqNickName:""}]}}))}))},e=(0,r.__decorate)([(0,r.__param)(0,o._),(0,r.__metadata)("design:paramtypes",[Object,String,Object])],e)}(T.Z),U=n(68318),q="".concat(h.Hf,"/api/vipcenter/info/all"),H="".concat(h.Hf,"/api/personalize/show/tips"),B=function(){function t(t){this.networkRequestService=t}return t.prototype.getPersonalVipInfo=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(e){return t=(0,l.bk)({xsrf:(0,c.w$)(c.$W.xsrf)}),[2,this.networkRequestService.instance.post(q,t)]}))}))},t.prototype.getPersonalTipsShow=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e=(0,l.bk)((0,r.__assign)((0,r.__assign)({},t),{xsrf:(0,c.w$)(c.$W.xsrf)})),[2,this.networkRequestService.instance.post(H,e)]}))}))},(0,r.__decorate)([(0,s.Hh)(),(0,s.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"getPersonalVipInfo",null),(0,r.__decorate)([(0,s.Hh)(),(0,s.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"getPersonalTipsShow",null),t=(0,r.__decorate)([(0,r.__param)(0,o._),(0,r.__metadata)("design:paramtypes",[Object])],t)}(),W=function(){function t(t){this.networkRequestService=t,this.userInfoRepository=new U.Z(this.networkRequestService),this.vipInfoRepository=new B(this.networkRequestService)}return t.prototype.init=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return[2]}))}))},t.prototype.createPersonalEnvAccountAggregateByUserInfoCgi=function(t,e){var n=this.changeFetchDataToBaseDate(t,e);return this.accountAggregate=new j(this.networkRequestService,n.tinyId,n),this.accountAggregate.completionUserInfo(t),!0},t.prototype.createPersonalEnvAccountAggregateByBasicClientVars=function(t){return t?(this.accountAggregate=new j(this.networkRequestService,t.tinyId||i.Dr,t),!0):(this.accountAggregate=new j(this.networkRequestService,i.Dr),!1)},t.prototype.updatePersonalEnvAccountAggregate=function(t){var e,n,i;return(0,r.__awaiter)(this,void 0,void 0,(function(){var o;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return this.updateUserIndex(t),o=null===(i=null===(n=null===(e=this.accountAggregate)||void 0===e?void 0:e.userInfo)||void 0===n?void 0:n.settings)||void 0===i?void 0:i.language,[4,this.createPersonalEnvAccountAggregateForFetch(t,o)];case 1:return[2,r.sent()]}}))}))},t.prototype.completionUserInfo=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.userInfoRepository.getPersonalUserInfo()];case 1:return 0===(null==(t=e.sent().resData)?void 0:t.retcode)?(this.accountAggregate.completionUserInfo(t.data),[2,!0]):[2,!1]}}))}))},t.prototype.updatePersonalNicknameAndAvatar=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.userInfoRepository.updatePersonalNicknameAndAvatar(t)];case 1:return 0===(null==(e=n.sent().resData)?void 0:e.retcode)?[2,!0]:[2,!1]}}))}))},t.prototype.getUserVipInfo=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.vipInfoRepository.getPersonalVipInfo()];case 1:return 0===(null==(t=e.sent().resData)?void 0:t.retcode)?(this.accountAggregate.completionVipInfo(t.data),[2,!0]):[2,!1]}}))}))},t.prototype.getTipsStatus=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.vipInfoRepository.getPersonalTipsShow(t)];case 1:return 0===(null==(e=n.sent().resData)?void 0:e.retcode)?[2,e.data.result.isShow]:[2,!1]}}))}))},t.prototype.createPersonalEnvAccountAggregateForFetch=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,i;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.userInfoRepository.getPersonalUserInfo()];case 1:return 0===(null==(n=r.sent().resData)?void 0:n.retcode)?(i=this.changeFetchDataToBaseDate(n.data,t,e),this.accountAggregate=new j(this.networkRequestService,n.data.tinyid,i),this.accountAggregate.completionUserInfo(n.data),[2,!0]):[2,!1]}}))}))},t.prototype.changeFetchDataToBaseDate=function(t,e,n){var r=t.corpId,i=t.tinyid,o=t.corpName,a=t.englishName,s=t.loginType,c=t.wxOpenid,u=t.uin,d=t.uidSource,_=t.userId,p=t.avatar,f=t.nick;return{corpId:r,corpName:o,englishName:a,loginType:s,uin:u,uidSource:d,userId:null!=_?_:"p.".concat(i),nowUserIndex:null!=e?e:"",tinyId:i,openId:c,userName:f,userPic:p,settings:{language:null!=n?n:"",toolbarMode:""}}},t.prototype.updateUserIndex=function(t){this.accountAggregate.updateNowUserIndex(t)},(0,r.__decorate)([(0,a.u)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"init",null),t=(0,r.__decorate)([(0,r.__param)(0,o._),(0,r.__metadata)("design:paramtypes",[Object])],t)}()},19814:function(t,e,n){n.d(e,{b:function(){return r}});var r=(0,n(66624).yh)("IEnterpriseAccountDomainService")},91081:function(t,e,n){n.d(e,{f:function(){return P}});var r,i=n(85556),o=n(11268),a=n(5448),s=n(99181),c=n(28703),u=n(6750),d=n(60877),_=n(25732),p=n(25882),f=n(2626),l=n(16740),h=n(46163),g=n(73154),v=n(95005),m=n(94796),y=((r={})[f.FW.WECHAT]=f.Lq.WECHAT,r[f.FW.WEWORK]=f.Lq.WEWORK,r),w=function(){return!!(0,h.ej)("wedoc_sid")},I=function(t){var e,n=w()?void 0:t.sid,r=void 0,o=void 0,a=void 0;return e=t.type===f.FW.WECHAT||w()?t.uid:t.uin,w()&&(r=t.sid,o=t.openid,a=e),(0,i.__assign)((0,i.__assign)({},t),{corpName:t.corp_name,uid:e,uType:y[t.type],nick:t.name,nickName:t.nick_name,wedriveUin:e,fromDomain:f.zM.B_DOMAIN,cookie:{wedriveSid:n,wedocSid:r,wedocOpenid:o,tdocUid:a,uType:y[t.type],uid:"",uidKey:"",userIndex:"",SID:"",isMultiLogin:!0}})},b=function(){function t(t){this.networkRequestService=t}return t.prototype.getEnterpriseAccountList=function(){var t;return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n,r,o,a;return(0,i.__generator)(this,(function(s){switch(s.label){case 0:return e=(0,g.At)(m.eP,{xrsf:"".concat((0,h.w$)(h.$W.xsrf)),get_acct:"true"}),[4,this.networkRequestService.instance.get(e)];case 1:return n=s.sent(),r=function(t){void 0===t&&(t="{}");var e=t.replace(/"uin":(\d+)/g,'"uin":"$1"').replace(/"uid":(\d+)/g,'"uid":"$1"');return JSON.parse(e)}(null===(t=n.request)||void 0===t?void 0:t.responseText),o=r.body,a=r.head,[2,(0,i.__assign)((0,i.__assign)({},n),{data:{data:(u=o.session,d=(0,c.Z)(),u.map((function(t){return t.type!==f.FW.WECHAT||t.uid||(t.uid=d[t.uin]),t})).filter((function(t){return t.uid}))).map(I),retcode:a.ret,msg:a.msg}})]}var u,d}))}))},t.prototype.getUserMarkNameListByUids=function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return e=(0,g.At)(m.sv,{xrsf:"".concat((0,h.w$)(h.$W.xsrf)),uids:"[".concat(t.join(","),"]")}),[4,this.networkRequestService.instance.get(e)];case 1:return n=r.sent(),[2,(0,i.__assign)((0,i.__assign)({},n),{data:{data:n.data.result.rsp,retcode:n.data.retcode,msg:n.data.msg}})]}}))}))},t.prototype.delEnterpriseAccountForList=function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(n){return e=(0,g.At)(v.DE,{xrsf:"".concat((0,h.w$)(h.$W.xsrf)),sid:t}),[2,this.networkRequestService.instance.get(e)]}))}))},(0,i.__decorate)([(0,l.Hh)(),(0,l.bj)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[]),(0,i.__metadata)("design:returntype",Promise)],t.prototype,"getEnterpriseAccountList",null),(0,i.__decorate)([(0,l.Hh)(),(0,l.bj)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[Array]),(0,i.__metadata)("design:returntype",Promise)],t.prototype,"getUserMarkNameListByUids",null),(0,i.__decorate)([(0,l.Hh)(),(0,l.bj)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[String]),(0,i.__metadata)("design:returntype",Promise)],t.prototype,"delEnterpriseAccountForList",null),t=(0,i.__decorate)([(0,i.__param)(0,o._),(0,i.__metadata)("design:paramtypes",[Object])],t)}(),S=b,A=function(t){function e(e,n){var r=t.call(this,n)||this;return r.networkRequestService=e,r.enterpriseAccountListRepository=new S(e),r.enterpriseAccountList=[],r}return(0,i.__extends)(e,t),e.prototype.getEnterpiseAccountList=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t;return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.enterpriseAccountListRepository.getEnterpriseAccountList()];case 1:return t=e.sent().resData,this.enterpriseAccountList=(null==t?void 0:t.data.data)?t.data.data:[],[2,this.enterpriseAccountList]}}))}))},e.prototype.getUserMarkNameListByUids=function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.enterpriseAccountListRepository.getUserMarkNameListByUids(t)];case 1:return e=n.sent().resData,this.userMarkNameList=(null==e?void 0:e.data.data)?e.data.data:[],[2,this.userMarkNameList]}}))}))},e.prototype.delEnterpriseAccountForList=function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.enterpriseAccountListRepository.delEnterpriseAccountForList(t)];case 1:return e.sent(),this.updateEntrepriseAccountListAfterDel(t),[2,!0]}}))}))},e.prototype.updateEntrepriseAccountListAfterDel=function(t){this.enterpriseAccountList=this.enterpriseAccountList.filter((function(e){return e.cookie.wedocSid!==t&&e.cookie.wedriveSid!==t}))},e=(0,i.__decorate)([(0,i.__param)(0,o._),(0,i.__metadata)("design:paramtypes",[Object,String])],e)}(n(94404).J),C=A,E=n(57753),R=n(44225),M=n(77058),O=function(t){function e(e){var n=t.call(this)||this;if(n.type=M.qu.NONE,n.beginTime=0,n.endTime=0,n.vvip={status:0,beginTime:0,endTime:0},n.customInfo={avatarFrame:"",badgeUrl:"",corpVipLevel:M.vA.INVALID_CORP_VIP_LEVEL},!e)return n;var r=n.createEmptyVip();return n.jsonObj2Class(r),n}return(0,i.__extends)(e,t),e.prototype.updateVipUserInfo=function(t){if(t){var e=this.handleVipCustomInfoFromNet(t);this.jsonObj2Class({customInfo:e})}},e.prototype.createEmptyVip=function(){return{type:M.qu.NONE,beginTime:0,endTime:0}},e.prototype.handleVipCustomInfoFromNet=function(t){var e={};try{e=JSON.parse(t)}catch(t){e={}}var n=e.avatar_frame_url,r=void 0===n?"":n,i=e.badge_url,o=void 0===i?"":i,a=e.corp_vip_level;return{avatarFrame:r,badgeUrl:o,corpVipLevel:void 0===a?M.vA.INVALID_CORP_VIP_LEVEL:a}},e}(R.K),D=function(t){function e(e,n,r){var i=t.call(this,n)||this;return i.networkRequestService=e,i.vipInfo=new O,i.bindUserInfo=new u.B,i.officialInfo=new d.Z,i.enterpriseAccountListEntity=new C(e,n),i.userInfo=new E.K(r),i.accountRepository=new _.P(e),i}return(0,i.__extends)(e,t),e.prototype.completionUserInfo=function(t){t.vipInfo&&(this.vipInfo=new O),t.vip&&this.vipInfo.updateVipUserInfo(t.vip),t.wechatOfficialAccount&&(this.officialInfo=new d.Z(t.wechatOfficialAccount)),this.bindUserInfo=new u.B(t)},e=(0,i.__decorate)([(0,i.__param)(0,o._),(0,i.__metadata)("design:paramtypes",[Object,String,Object])],e)}(p.Z),k=n(86753),L=n(68318),P=function(){function t(t){var e=this;this.networkRequestService=t,this.updateBLocalStoragePersionTinyid=function(t){return(0,i.__awaiter)(e,void 0,void 0,(function(){var e,n,r;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return t.loginType===a.Q.WX&&t.tinyid?[4,this.accountAggregate.enterpriseAccountListEntity.getUserMarkNameListByUids([t.tinyid])]:[3,2];case 1:e=i.sent(),(n=null===(r=e[0])||void 0===r?void 0:r.wedriveUin)&&(0,c.r)({wedriveUin:n,tinyid:t.tinyid}),i.label=2;case 2:return[2]}}))}))},this.userInfoRepository=new L.Z(this.networkRequestService)}return t.prototype.init=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){return[2]}))}))},t.prototype.createEnterpriseEnvAccountAggregateByBasicClientVars=function(t){return t?(this.accountAggregate=new D(this.networkRequestService,t.tinyId||k.Dr,this.changeBasicClientVarsToBaseData(t)),!0):(this.accountAggregate=new D(this.networkRequestService,k.Dr),!1)},t.prototype.completionUserInfo=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t;return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.userInfoRepository.getEnterpriseUserInfo()];case 1:return(t=e.sent())?(this.accountAggregate.completionUserInfo(t),[2,!0]):[2,!1]}}))}))},t.prototype.createEnterpriseEnvAccountAggregateByUserInfoCgi=function(t,e){var n=this.changeFetchDataToBaseData(t,e);this.accountAggregate=new D(this.networkRequestService,n.tinyId,n)},t.prototype.changeBasicClientVarsToBaseData=function(t){return(0,i.__assign)({},t)},t.prototype.changeFetchDataToBaseData=function(t,e,n){this.updateBLocalStoragePersionTinyid(t);var r=t.corpId,i=t.tinyid,o=t.corpName,s=t.englishName,c=t.loginType,u=t.wxOpenid,d=t.uin,_=t.uidSource,p=t.userId,f=t.avatar,l={corpId:r,corpName:o,englishName:s,loginType:c,uin:d,uidSource:_,userId:p,tinyId:i,openId:u,userName:t.nick,userPic:f,wedriveUin:"",nowUserIndex:"",settings:{language:null!=n?n:"",toolbarMode:""}};return e.body.login_type===a.R.WECHAT?l.wedriveUin=e.body.account.s_vid:e.body.login_type===a.R.WEWORK&&(l.wedocOpenId=e.body.account.openid,l.wedriveUin=e.body.account.s_uid),l},(0,i.__decorate)([(0,s.u)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[]),(0,i.__metadata)("design:returntype",Promise)],t.prototype,"init",null),t=(0,i.__decorate)([(0,i.__param)(0,o._),(0,i.__metadata)("design:paramtypes",[Object])],t)}()},94951:function(t,e,n){n.d(e,{C:function(){return r}});var r=(0,n(66624).yh)("ILoginDomainService")},92579:function(t,e,n){n.d(e,{g:function(){return C}});var r=n(85556),i=n(25153),o=n(16740),a=n(11268),s=n(46163),c=n(73154),u=n(13775),d="".concat(u.Hf,"/v2/cgi-bin/online_docs/polling"),_="".concat(u.d0,"polling/key/create"),p="".concat(u.Hf,"/cgi-bin/online_docs/wxqrcode"),f=("".concat(u.HL,"user_info"),"".concat(u.Hf,"/api/user/qq/login")),l="".concat(u.d0,"work_weixin/login"),h="x-u",g="userIndex",v=function(){function t(t){this.networkRequestService=t}return t.prototype.pollingKeyCreate=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e="".concat(_,"?ac=").concat(t),[2,this.networkRequestService.instance.post(e,{xsrf:(0,s.w$)(s.$W.xsrf)})]}))}))},t.prototype.getWeChatLogInQRCodeURI=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,r.__generator)(this,(function(n){return t={ac:"login",ts:Date.now(),page:encodeURIComponent("pages/landingpage/landingpage"),checkKey:"1",xsrf:"".concat((0,s.w$)(s.$W.xsrf))},e=(0,c.At)(p,t),[2,this.networkRequestService.instance.get(e)]}))}))},t.prototype.updateWeChatLoginQRCodeStatus=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,r.__generator)(this,(function(r){return e={CheckKey:t,u:"login"},n=(0,c.At)(d,e),[2,this.networkRequestService.instance.post(n)]}))}))},t.prototype.updateEnterpriseWeChatLoginQRCodeStatus=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,r.__generator)(this,(function(r){return e={CheckKey:t},n=(0,c.At)(d,e),[2,this.networkRequestService.instance.post(n)]}))}))},t.prototype.checkQQLogin=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(e){return t="".concat(f,"?u=login"),[2,this.networkRequestService.instance.post(t,{xsrf:(0,s.w$)(s.$W.xsrf)})]}))}))},t.prototype.weworkLogin=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(e){return t="".concat(l,"?u=login"),[2,this.networkRequestService.instance.post(t,{xsrf:(0,s.w$)(s.$W.xsrf)})]}))}))},(0,r.__decorate)([(0,o.Hh)(),(0,o.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"pollingKeyCreate",null),(0,r.__decorate)([(0,o.Hh)(),(0,o.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"getWeChatLogInQRCodeURI",null),(0,r.__decorate)([(0,o.Hh)(),(0,o.bj)(),(0,o.GT)(h,g),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"updateWeChatLoginQRCodeStatus",null),(0,r.__decorate)([(0,o.Hh)(),(0,o.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"updateEnterpriseWeChatLoginQRCodeStatus",null),(0,r.__decorate)([(0,o.Hh)(),(0,o.bj)(),(0,o.GT)(h,g),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"checkQQLogin",null),(0,r.__decorate)([(0,o.Hh)(),(0,o.bj)(),(0,o.GT)(h,g),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"weworkLogin",null),t=(0,r.__decorate)([(0,r.__param)(0,a._),(0,r.__metadata)("design:paramtypes",[Object])],t)}(),m=v,y=n(25882),w=n(31072),I=n(28301),b=function(t){function e(e,n){var r=t.call(this,n)||this;return r.networkRequestService=e,r.loginRepository=new m(e),r}return(0,r.__extends)(e,t),e.prototype.reloadMiniProgramForDesktop=function(){var t,e;null===(e=null===(t=null===window||void 0===window?void 0:window.wx)||void 0===t?void 0:t.miniProgram)||void 0===e||e.reLaunch({url:"/pages/list/list?reason=pskey_error"})},e.prototype.loginDocsInMiniProgram=function(t){var e,n,r,i="/pages/detail/detail?reason=pskey_error&url=".concat(encodeURIComponent(t));(0,w.getQuery)("rtkey")&&(i+="&scene=".concat((0,w.getQuery)("rtkey"))),null===(r=null===(n=null===(e=window.wx)||void 0===e?void 0:e.miniProgram)||void 0===n?void 0:n.reLaunch)||void 0===r||r.call(n,{url:i})},e.prototype.loginDocsInWework=function(t){if(i.gH===i.Cs){var e="".concat(i.i4,"?url=").concat(encodeURIComponent(t)),n="".concat(i.zC,"?appid=ww20388f7040b655b7&redirect_uri=").concat(encodeURIComponent(e),"&response_type=code&scope=snsapi_userinfo&state=weworklogin#wechat_redirect");location.replace(n)}},e.prototype.jumpToLoginInWechatWebview=function(t){(0,I.tencentDocOpenUrlForAll)({url:"".concat(i.Sc,"?url=").concat(encodeURIComponent(t),"&wxonly=1"),replace:!0})},e.prototype.jumpToLoginInWeworkWebview=function(t){var e="".concat(i.zC,"?appid=ww20388f7040b655b7&redirect_uri=").concat(encodeURIComponent(t),"&response_type=code&scope=snsapi_userinfo&state=weworklogin#wechat_redirect");(0,I.tencentDocOpenUrlForAll)({url:e,replace:!0})},e.prototype.jumpToLoginInCommonView=function(t){(0,I.tencentDocOpenUrlForAll)({url:"".concat(i.kC,"?jump_url=").concat(encodeURIComponent(t)),replace:!0})},e.prototype.timOrQQH5Login=function(){window.mqq?window.mqq.invoke("data","updateLoginInfo",{key:"pskey"},(function(){location.reload()})):n.g.location.reload()},e=(0,r.__decorate)([(0,r.__param)(0,a._),(0,r.__metadata)("design:paramtypes",[Object,String])],e)}(y.Z),S=b,A=n(99181),C=function(){function t(t){this.networkRequestService=t}return t.prototype.createLoginAggregate=function(t){this.loginAggregate=new S(this.networkRequestService,t)},t.prototype.init=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return[2]}))}))},(0,r.__decorate)([(0,A.u)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"init",null),t=(0,r.__decorate)([(0,r.__param)(0,a._),(0,r.__metadata)("design:paramtypes",[Object])],t)}()},23911:function(t,e,n){n.d(e,{B:function(){return r}});var r=(0,n(66624).yh)("IAtMessageDomainService")},34049:function(t,e,n){n.d(e,{M:function(){return A}});var r=n(85556),i=n(13775),o="".concat(i.jo,"mention/mention_add"),a="".concat(i.jo,"mention/mention_del"),s="".concat(i.jo,"mention/get_doc_mention_list"),c="".concat(i.jo,"mention/get_my_mention_list"),u="".concat(i.jo,"mention/mention_read_report"),d=n(11268),_=n(33661),p=n(56795),f=n(46163),l=function(){function t(t,e){this.docMetaDomainService=t,this.networkRequestService=e}return t.prototype.getDocMentionList=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return t=(0,_.bk)({globalPadId:this.globalPadId,xsrf:(0,f.w$)(f.$W.xsrf)}),e="".concat(s),[4,this.networkRequestService.instance.post(e,t)];case 1:return[2,n.sent()]}}))}))},t.prototype.getMyMentionList=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return t=(0,_.bk)({globalPadId:this.globalPadId,xsrf:(0,f.w$)(f.$W.xsrf)}),e="".concat(c),[4,this.networkRequestService.instance.post(e,t)];case 1:return[2,n.sent()]}}))}))},t.prototype.deleteMention=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return e=(0,_.bk)({globalPadId:this.globalPadId,mentions:JSON.stringify(t),xsrf:(0,f.w$)(f.$W.xsrf)}),n="".concat(a),[4,this.networkRequestService.instance.post(n,e)];case 1:return[2,r.sent()]}}))}))},t.prototype.addMention=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,i;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return n=(0,_.bk)({globalPadId:this.globalPadId,mentions:JSON.stringify(t),vfwebqq:e,xsrf:(0,f.w$)(f.$W.xsrf)}),i="".concat(o),[4,this.networkRequestService.instance.post(i,n)];case 1:return[2,r.sent()]}}))}))},t.prototype.mentionReadReport=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return e=(0,_.bk)({globalPadId:this.globalPadId,mentions:JSON.stringify(t),xsrf:(0,f.w$)(f.$W.xsrf)}),n="".concat(u),[4,this.networkRequestService.instance.post(n,e)];case 1:return[2,r.sent()]}}))}))},Object.defineProperty(t.prototype,"globalPadId",{get:function(){var t=this.docMetaDomainService.docMetaEntity.padInfo.padId,e=this.docMetaDomainService.docMetaEntity.padInfo.domainId;return(0,_.B8)(e,t)},enumerable:!1,configurable:!0}),t=(0,r.__decorate)([(0,r.__param)(0,p.v),(0,r.__param)(1,d._),(0,r.__metadata)("design:paramtypes",[Object,Object])],t)}(),h=n(44225),g=function(t){function e(e){var n=t.call(this)||this;return n.anchorId="",n.mentionId="",n.mentionType=0,n.notify=0,n.read=!1,n.targetId="",n.sender={},n.mentionedUser={},n.jsonObj2Class(e),n}return(0,r.__extends)(e,t),e}(h.K),v=function(t){function e(e){var n=t.call(this)||this;return n.anchorId="",n.mentionId="",n.mentionType=0,n.notify=0,n.targetId="",n.read=!1,n.mentionFrom={},n.mentionTo={},n.jsonObj2Class(e),n}return(0,r.__extends)(e,t),e}(h.K),m=n(25882),y=n(16740),w=n(36023),I="mentions",b=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.docMetaDomainService=n,i.networkRequestService=r,i.atMeUserList=[],i.atUserList=[],i.onAtUserListUpdatedEmitter=new w.Emitter,i.onAtMeUserListUpdatedEmitter=new w.Emitter,i.onAtUserListUpdated=i.onAtUserListUpdatedEmitter.event,i.onAtMeUserListUpdated=i.onAtMeUserListUpdatedEmitter.event,i.atMessageRepository=new l(n,r),i}return(0,r.__extends)(e,t),e.prototype.getDocMentionList=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.atMessageRepository.getDocMentionList()];case 1:return[2,t.sent()]}}))}))},e.prototype.getMyMentionList=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.atMessageRepository.getMyMentionList()];case 1:return[2,t.sent()]}}))}))},e.prototype.addMention=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return e=(0,_.CY)(),[4,this.atMessageRepository.addMention(t,e)];case 1:return[2,n.sent()]}}))}))},e.prototype.deleteMention=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.atMessageRepository.deleteMention(t)];case 1:return[2,e.sent()]}}))}))},e.prototype.clearMentionMarks=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.atMessageRepository.mentionReadReport(t)];case 1:return[2,e.sent()]}}))}))},(0,r.__decorate)([(0,y.EL)(g.prototype.constructor,"atUserList","result",I),(0,y.Hh)(),(0,y.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],e.prototype,"getDocMentionList",null),(0,r.__decorate)([(0,y.FY)(v.prototype.constructor,"atMeUserList",I),(0,y.Hh)(),(0,y.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],e.prototype,"getMyMentionList",null),(0,r.__decorate)([(0,y.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Array]),(0,r.__metadata)("design:returntype",Promise)],e.prototype,"addMention",null),(0,r.__decorate)([(0,y.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Array]),(0,r.__metadata)("design:returntype",Promise)],e.prototype,"deleteMention",null),(0,r.__decorate)([(0,y.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Array]),(0,r.__metadata)("design:returntype",Promise)],e.prototype,"clearMentionMarks",null),e=(0,r.__decorate)([(0,r.__param)(1,p.v),(0,r.__param)(2,d._),(0,r.__metadata)("design:paramtypes",[String,Object,Object])],e)}(m.Z),S=n(99181),A=function(){function t(t,e){this.docMetaDomainService=t,this.networkRequest=e,this.atMessageAggregate=new b("mainAtMessageAggregate",t,e)}return t.prototype.init=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.docMetaDomainService.init(t)];case 1:return e.sent(),[2]}}))}))},(0,r.__decorate)([(0,S.u)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"init",null),t=(0,r.__decorate)([(0,r.__param)(0,p.v),(0,r.__param)(1,d._),(0,r.__metadata)("design:paramtypes",[Object,Object])],t)}()},39870:function(t,e,n){var r,i,o;n.d(e,{e0:function(){return o},sX:function(){return i},ul:function(){return r}}),function(t){t[t.DEFAULT=0]="DEFAULT",t[t.SHOW=1]="SHOW",t[t.HIDE=2]="HIDE"}(r||(r={})),function(t){t[t.SELF=0]="SELF",t[t.COOPERATION=1]="COOPERATION",t[t.VIEWABLE=2]="VIEWABLE",t[t.EDITABLE=3]="EDITABLE"}(i||(i={})),function(t){t[t.deny=0]="deny",t[t.whitelist=1]="whitelist",t[t.allOnlyRead=2]="allOnlyRead",t[t.allOnlyWrite=3]="allOnlyWrite",t[t.allOnlyExecute=4]="allOnlyExecute",t[t.invalidPolicy=999]="invalidPolicy"}(o||(o={}))},75332:function(t,e,n){var r;n.d(e,{V:function(){return r}}),function(t){t[t.noPrivilege=0]="noPrivilege",t[t.reader=1]="reader",t[t.editor=2]="editor",t[t.filler=3]="filler",t[t.executor=4]="executor",t[t.externUser=10]="externUser",t[t.administrator=1024]="administrator",t[t.owner=2048]="owner"}(r||(r={}))},4094:function(t,e,n){n.d(e,{i:function(){return r}});var r=(0,n(66624).yh)("IAuthDomainService")},66215:function(t,e,n){n.d(e,{n:function(){return x}});var r=n(85556),i=n(39870),o=n(75332),a=n(13775),s="".concat(a.Hf,"/dop-api/drive/data/get"),c="".concat(a.HL,"auth_info/get"),u="".concat(a.HL,"auth_info/set"),d="".concat(a.HL,"auth_exp/get"),_="".concat(a.HL,"auth_exp/set"),p="".concat(a.HL,"auth_getconf"),f="".concat(a.Hf,"/v2/privilege/corpshare/docownerget"),l="".concat(a.Hf,"/v2/privilege/corpshare/docownerset"),h="".concat(a.Hf,"/v2/privilege/set_user"),g=n(11268),v=n(33661),m=n(56795),y=n(46163),w=n(73154),I=function(){function t(t,e){this.docMetaDomainService=t,this.networkRequestService=e}return t.prototype.fetchAuthInfoData=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return e={id:t,xsrf:"".concat((0,y.w$)(y.$W.xsrf))},n=(0,w.At)(s,e),[4,this.networkRequestService.instance.get(n)];case 1:return[2,r.sent()]}}))}))},t.prototype.fetchAuthInfo=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return t={localPadId:this.docMetaDomainService.docMetaEntity.padInfo.padId,domain:this.docMetaDomainService.docMetaEntity.padInfo.domainId,type:1,ver:2,xsrf:"".concat((0,y.w$)(y.$W.xsrf))},e=(0,w.At)(c,t),[4,this.networkRequestService.instance.post(e)];case 1:return[2,n.sent()]}}))}))},t.prototype.changeAuthInfo=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n,i,o,a,s;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return e=t.corpId,n=t.data,i=t.message,o=t.dataType,a={localPadId:this.docMetaDomainService.docMetaEntity.padInfo.padId,domain:this.docMetaDomainService.docMetaEntity.padInfo.domainId,corp_id:(0,v.Pc)(e),data:(0,v.Pc)(n),message:(0,v.Pc)(i),dataType:(0,v.fQ)(o),type:1,ver:2,xsrf:"".concat((0,y.w$)(y.$W.xsrf))},s=(0,w.At)(u,a),[4,this.networkRequestService.instance.post(s)];case 1:return[2,r.sent()]}}))}))},t.prototype.fetchAuthExpTime=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return t={domainId:this.docMetaDomainService.docMetaEntity.padInfo.domainId,localPadId:this.docMetaDomainService.docMetaEntity.padInfo.padId,xsrf:"".concat((0,y.w$)(y.$W.xsrf)),type:1,ver:2},e=(0,w.At)(d,t),[4,this.networkRequestService.instance.get(e)];case 1:return[2,n.sent()]}}))}))},t.prototype.changeAuthExpTime=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return e=(0,v.bk)({domainId:this.docMetaDomainService.docMetaEntity.padInfo.domainId,localPadId:this.docMetaDomainService.docMetaEntity.padInfo.padId,setTime:parseInt(t,10),xsrf:"".concat((0,y.w$)(y.$W.xsrf))}),n={contentType:"application/x-www-form-urlencoded"},[4,this.networkRequestService.instance.post(_,e,n)];case 1:return[2,r.sent()]}}))}))},t.prototype.fetchFolderAuth=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return e={folderId:t,type:1,ver:2,xsrf:"".concat((0,y.w$)(y.$W.xsrf))},n=(0,w.At)(c,e),[4,this.networkRequestService.instance.post(n)];case 1:return[2,r.sent()]}}))}))},t.prototype.changeFolderAuth=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n,i,o,a,s,c;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return e=t.folderId,n=t.corpId,i=t.message,o=t.data,a=t.clear,s={folderId:e,corp_id:(0,v.Pc)(n),data:(0,v.Pc)(o),message:(0,v.Pc)(i),clear:(0,v.fQ)(a),type:1,ver:2,xsrf:"".concat((0,y.w$)(y.$W.xsrf))},c=(0,w.At)(u,s),[4,this.networkRequestService.instance.post(c)];case 1:return[2,r.sent()]}}))}))},t.prototype.fetchAuthConfig=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return t={domainId:this.docMetaDomainService.docMetaEntity.padInfo.domainId,localPadId:this.docMetaDomainService.docMetaEntity.padInfo.padId,xsrf:"".concat((0,y.w$)(y.$W.xsrf))},e=(0,w.At)(p,t),[4,this.networkRequestService.instance.post(e)];case 1:return[2,n.sent()]}}))}))},t=(0,r.__decorate)([(0,r.__param)(0,m.v),(0,r.__param)(1,g._),(0,r.__metadata)("design:paramtypes",[Object,Object])],t)}(),b=n(44225),S=function(t){function e(e){var n=t.call(this)||this;return n.expTime=0,n.remainTime=0,n.setTime=0,n.startTime=0,n.jsonObj2Class(e),n}return(0,r.__extends)(e,t),e}(b.K),A=n(16740),C=n(36023),E=function(t){function e(e){var n=t.call(this)||this;return n.readerCanComment=!1,n.viewForbidCopyPrint=!1,n.writerCanComment=!1,n.jsonObj2Class(e),n}return(0,r.__extends)(e,t),e}(b.K),R=function(t){function e(e){var n=t.call(this)||this;return n.canAbout=!1,n.canAddUser=!1,n.canAnnotate=!1,n.canComment=!1,n.canCopy=!1,n.canCopyDoc=!1,n.canEdit=!1,n.canEditTitle=!1,n.canHistory=!1,n.canLinkExp=!1,n.canPrint=!1,n.canRead=!1,n.canSearch=!1,n.canShare=!1,n.canFeedback=!1,n.canSpitSlot=!1,n.canTranslate=!1,n.canViewImage=!1,n.canWatermark=!1,n.isPrivilegeExpired=!1,n.canApplyEdit=!1,n.jsonObj2Class(e),n}return(0,r.__extends)(e,t),e}(b.K),M=function(){function t(t,e){this.docMetaDomainService=t,this.networkRequestService=e,this.selfRole=o.V.noPrivilege,this.isOwner=!1,this.selfDocPrivilege=new R({}),this.selfDocAdvancedPrivilege=new E({}),this.documentPrivilege=i.e0.deny,this.memberList=[],this.onAuthChangedEmitter=new C.Emitter,this.onAuthExpTimeChangedEmitter=new C.Emitter,this.onSelfPrivilegeChangedEmitter=new C.Emitter,this.authRepository=new I(t,e),this.onAuthChanged=this.onAuthChangedEmitter.event,this.onAuthExpTimeChanged=this.onAuthExpTimeChangedEmitter.event,this.onSelfPrivilegeChanged=this.onSelfPrivilegeChangedEmitter.event}return t.prototype.fetchAuthExpTime=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.authRepository.fetchAuthExpTime()];case 1:return[2,t.sent()]}}))}))},t.prototype.changeAuthExpTime=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.authRepository.changeAuthExpTime(t)];case 1:return[2,e.sent()]}}))}))},t.prototype.fetchAuthInfo=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.authRepository.fetchAuthInfo()];case 1:return[2,t.sent()]}}))}))},t.prototype.changeAuthInfo=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.authRepository.changeAuthInfo(t)];case 1:return[2,e.sent()]}}))}))},t.prototype.fetchAuthInfoData=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.authRepository.fetchAuthInfoData(t)];case 1:return[2,e.sent()]}}))}))},t.prototype.fetchFolderAuth=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.authRepository.fetchFolderAuth(t)];case 1:return[2,e.sent()]}}))}))},t.prototype.changeFolderAuth=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.authRepository.changeFolderAuth(t)];case 1:return[2,e.sent()]}}))}))},t.prototype.fetchAuthConfig=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.authRepository.fetchAuthConfig()];case 1:return[2,t.sent()]}}))}))},t.prototype.onReceiveMessageFromServer=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.notifyRightChange(t)];case 1:return n.sent(),this.checkSelfPrivilege(e),[2]}}))}))},t.prototype.handleForDifferentActions=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return e=t.seq,1!==t.action?[3,4]:t?void 0!==(n=t)[e]?[3,2]:[4,this.handleAuthChange()]:[3,3];case 1:return r.sent(),[3,3];case 2:delete n[e],r.label=3;case 3:return[3,7];case 4:return 2!==t.action?[3,5]:[3,7];case 5:return[4,this.handleExpInfoChange(t)];case 6:r.sent(),r.label=7;case 7:return[2]}}))}))},t.prototype.handleAuthChange=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return this.isOwner?[4,this.fetchAuthInfo()]:[2];case 1:return 0===(t=n.sent()).resData.cgicode&&0===t.resData.retcode&&(e=t.resData.data,this.documentPrivilege=e.policy,this.memberList=e.memberList,this.onAuthChangedEmitter.fire({newDocumentPrivilege:this.documentPrivilege})),[2]}}))}))},t.prototype.handleExpInfoChange=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,r.__generator)(this,(function(r){return this.checkExpTimeParams(t)&&(e=t.exptime-t.starttime)&&e>0&&(n=new S({expTime:t.exptime,remainTime:e,setTime:e,startTime:t.starttime}),this.onAuthExpTimeChangedEmitter.fire({newExpTime:n})),[2]}))}))},t.prototype.checkExpTimeParams=function(t){return"undefined"!==t.exptime&&"undefined"!==t.settime&&"undefined"!==t.starttime},t.prototype.checkSelfPrivilege=function(t){var e=this;t.sendMessage({cmd:"GET_PRIVILEGE",taskId:void 0,data:JSON.stringify({}),onsend:function(t,n,r,i){if(e.checkGetPrivilegeResult(i)){var o=i.response.onpost.privilege_attribute;e.checkDocPrivilegeChange(o)&&(e.selfDocPrivilege.canEdit=o.can_edit,e.selfDocPrivilege.canRead=o.can_read,e.selfDocPrivilege.canComment=o.can_comment,e.selfDocPrivilege.canCopy=o.can_copy,e.onSelfPrivilegeChangedEmitter.fire({newSelfPrivilege:e.selfDocPrivilege}))}},onError:function(){}})},t.prototype.checkGetPrivilegeResult=function(t){var e,n;return 0===t.errCode&&0===(null===(n=null===(e=t.response)||void 0===e?void 0:e.onpost)||void 0===n?void 0:n.result)},t.prototype.checkDocPrivilegeChange=function(t){return this.selfDocPrivilege.canEdit!==t.can_edit||this.selfDocPrivilege.canRead!==t.can_read||this.selfDocPrivilege.canComment!==t.can_comment||this.selfDocPrivilege.canCopy!==t.can_copy},t.prototype.notifyRightChange=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return!t||""!==t.payload&&null!==t.payload?[3,2]:[4,this.handleAuthChange()];case 1:case 3:return n.sent(),[2];case 2:return null===(e=(0,v.KV)(decodeURIComponent(t.payload),decodeURIComponent(t.payload)))?[2]:[4,this.handleForDifferentActions(e)]}}))}))},(0,r.__decorate)([(0,A.Hh)(),(0,A.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"fetchAuthExpTime",null),(0,r.__decorate)([(0,A.Hh)(),(0,A.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"changeAuthExpTime",null),(0,r.__decorate)([(0,A.Hh)(),(0,A.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"fetchAuthInfo",null),(0,r.__decorate)([(0,A.Hh)(),(0,A.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"changeAuthInfo",null),(0,r.__decorate)([(0,A.Hh)(),(0,A.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"fetchAuthInfoData",null),(0,r.__decorate)([(0,A.Hh)(),(0,A.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"fetchFolderAuth",null),(0,r.__decorate)([(0,A.Hh)(),(0,A.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"changeFolderAuth",null),(0,r.__decorate)([(0,A.Hh)(),(0,A.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"fetchAuthConfig",null),t=(0,r.__decorate)([(0,r.__param)(0,m.v),(0,r.__param)(1,g._),(0,r.__metadata)("design:paramtypes",[Object,Object])],t)}(),O=function(){function t(t,e){this.docMetaDomainService=t,this.networkRequestService=e}return t.prototype.setUserAuth=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n,i;return(0,r.__generator)(this,(function(o){switch(o.label){case 0:return e=(0,y.w$)(y.$W.xsrf)||"",n=(0,r.__assign)({xsrf:e},t),i=(0,w.At)(h,{xsrf:e}),[4,this.networkRequestService.instance.post(i,n)];case 1:return[2,o.sent()]}}))}))},t=(0,r.__decorate)([(0,r.__param)(0,m.v),(0,r.__param)(1,g._),(0,r.__metadata)("design:paramtypes",[Object,Object])],t)}(),D=function(){function t(t,e){this.docMetaDomainService=t,this.networkRequestService=e,this.collabAuthRepository=new O(t,e)}return t.prototype.setCollabUserAuth=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.collabAuthRepository.setUserAuth(t)];case 1:return[2,e.sent()]}}))}))},(0,r.__decorate)([(0,A.Hh)(),(0,A.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"setCollabUserAuth",null),t=(0,r.__decorate)([(0,r.__param)(0,m.v),(0,r.__param)(1,g._),(0,r.__metadata)("design:paramtypes",[Object,Object])],t)}(),k=function(){function t(t,e){this.docMetaDomainService=t,this.networkRequestService=e}return t.prototype.changeCorpShareAuthInfo=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n,i,o,a,s;return(0,r.__generator)(this,(function(c){switch(c.label){case 0:return e=t.uid,n=t.corpId,i=t.isOpen,o=t.canExternalApply,a=t.docCorpSharePolicy,s={user_info:{uid:e,corp_id:n},doc_id:this.docMetaDomainService.docMetaEntity.padInfo.padId,is_open:i,can_external_apply:o,uint32_policy:Math.round(Number(a||2)),xsrf:(0,y.w$)(y.$W.xsrf)},[4,this.networkRequestService.instance.post(l,(0,r.__assign)({},s))];case 1:return[2,c.sent()]}}))}))},t.prototype.fetchCorpShareAuthInfo=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n;return(0,r.__generator)(this,(function(i){switch(i.label){case 0:return n={user_info:{uid:t,corp_id:e},doc_id:this.docMetaDomainService.docMetaEntity.padInfo.padId,xsrf:(0,y.w$)(y.$W.xsrf)},[4,this.networkRequestService.instance.post(f,(0,r.__assign)({},n))];case 1:return[2,i.sent()]}}))}))},t=(0,r.__decorate)([(0,r.__param)(0,m.v),(0,r.__param)(1,g._),(0,r.__metadata)("design:paramtypes",[Object,Object])],t)}(),L=function(){function t(t,e){this.docMetaDomainService=t,this.networkRequestService=e,this.corpShareAuthRepository=new k(t,e)}return t.prototype.fetchCorpShareAuthInfo=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.corpShareAuthRepository.fetchCorpShareAuthInfo(t,e)];case 1:return[2,n.sent()]}}))}))},t.prototype.changeCorpShareAuthInfo=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.corpShareAuthRepository.changeCorpShareAuthInfo(t)];case 1:return[2,e.sent()]}}))}))},(0,r.__decorate)([(0,A.Hh)(),(0,A.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String,String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"fetchCorpShareAuthInfo",null),(0,r.__decorate)([(0,A.Hh)(),(0,A.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"changeCorpShareAuthInfo",null),t=(0,r.__decorate)([(0,r.__param)(0,m.v),(0,r.__param)(1,g._),(0,r.__metadata)("design:paramtypes",[Object,Object])],t)}(),P=function(){function t(t,e){this.docMetaDomainService=t,this.networkRequestService=e,this.authInfoEntity=new M(t,e),this.corpShareAuthInfoEntity=new L(t,e),this.collabAuthInfoEntity=new D(t,e)}return t=(0,r.__decorate)([(0,r.__param)(0,m.v),(0,r.__param)(1,g._),(0,r.__metadata)("design:paramtypes",[Object,Object])],t)}(),T=n(99181),x=function(){function t(t,e){this.docMetaDomainService=t,this.networkRequestService=e,this.isInitedByBasicClientVars=!1,this.authAggregate=new P(t,e),window.basicClientVars&&this.initWithBasicClientVars(window.basicClientVars)}return t.prototype.updateWithClientVars=function(t){if(!this.isInitedByBasicClientVars){var e=function(t){var e={};if(t.privilegeAttribute){var n=t.privilegeAttribute,r=n.can_about,i=n.can_annotate,o=n.can_add_user,a=n.can_comment,s=n.can_copy,c=n.can_copy_doc,u=n.can_edit,d=n.can_edit_title,_=n.can_history,p=n.can_link_exp,f=n.can_print,l=n.can_read,h=n.can_search,g=n.can_share,v=n.can_spit_slot;e={canAbout:r,canAddUser:o,canAnnotate:i,canComment:a,canCopy:s,canCopyDoc:c,canEdit:u,canEditTitle:d,canHistory:_,canLinkExp:p,canPrint:f,canRead:l,canSearch:h,canShare:g,canSpitSlot:v,canFeedback:v,canTranslate:n.can_translate,canViewImage:n.can_view_image,canWatermark:n.can_watermark,canApplyEdit:!!t.privilegeAttribute.can_apply_edit}}return e}(t);this.authAggregate.authInfoEntity.selfDocPrivilege=new R(e),this.authAggregate.authInfoEntity.isOwner=t.isOwner,this.authAggregate.authInfoEntity.selfRole=t.rightFlag,this.authAggregate.authInfoEntity.documentPrivilege=t.policy,this.authAggregate.authInfoEntity.selfDocAdvancedPrivilege=new E({readerCanComment:t.advPolicy.reader_can_comment,viewForbidCopyPrint:t.advPolicy.view_forbid_copy_print,writerCanComment:t.advPolicy.writer_can_comment})}},t.prototype.init=function(t){var e,n,i;return(0,r.__awaiter)(this,void 0,void 0,(function(){var o,a,s,c,u;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return o=t.docId,[4,this.authAggregate.authInfoEntity.fetchAuthInfoData(o)];case 1:return a=r.sent().resData,s=null==a?void 0:a.data.data,c=s.privilegeAttribute,u=s.advPolicy,this.authAggregate.authInfoEntity.isOwner=null!==(e=s.isOwner)&&void 0!==e&&e,this.authAggregate.authInfoEntity.selfRole=null!==(n=s.rightFlag)&&void 0!==n?n:0,this.authAggregate.authInfoEntity.documentPrivilege=null!==(i=s.policy)&&void 0!==i?i:0,this.authAggregate.authInfoEntity.selfDocPrivilege=new R({canAbout:null==c?void 0:c.canAbout,canAddUser:null==c?void 0:c.canAddUser,canAnnotate:null==c?void 0:c.canAnnotate,canComment:null==c?void 0:c.canComment,canCopy:null==c?void 0:c.canCopy,canCopyDoc:null==c?void 0:c.canCopyDoc,canEdit:null==c?void 0:c.canEdit,canEditTitle:null==c?void 0:c.canEditTitle,canHistory:null==c?void 0:c.canHistory,canLinkExp:null==c?void 0:c.canLinkExp,canPrint:null==c?void 0:c.canPrint,canRead:null==c?void 0:c.canRead,canSearch:null==c?void 0:c.canSearch,canShare:null==c?void 0:c.canShare,canSpitSlot:null==c?void 0:c.canSpitSlot,canFeedback:null==c?void 0:c.canSpitSlot,canTranslate:null==c?void 0:c.canTranslate,canViewImage:null==c?void 0:c.canViewImage,canWatermark:null==c?void 0:c.canWatermark,isPrivilegeExpired:!!s.privilegeExpire}),this.authAggregate.authInfoEntity.selfDocAdvancedPrivilege=new E({readerCanComment:null==u?void 0:u.reader_can_comment,viewForbidCopyPrint:null==u?void 0:u.view_forbid_copy_print,writerCanComment:null==u?void 0:u.writer_can_comment}),[2]}}))}))},t.prototype.initWithBasicClientVars=function(t){var e,n,r,i,o,a,s,c,u,d,_,p,f,l,h,g,v=function(t){var e;return(null===(e=t.authInfo)||void 0===e?void 0:e.attribute)?{canAbout:t.authInfo.attribute.canAbout,canAddUser:t.authInfo.attribute.canAddUser,canAnnotate:t.authInfo.attribute.canAnnotate,canComment:t.authInfo.attribute.canComment,canCopy:t.authInfo.attribute.canCopy,canCopyDoc:t.authInfo.attribute.canCopyDoc,canEdit:t.authInfo.attribute.canEdit,canEditTitle:t.authInfo.attribute.canEditTitle,canHistory:t.authInfo.attribute.canHistory,canLinkExp:t.authInfo.attribute.canLinkExp,canPrint:t.authInfo.attribute.canPrint,canRead:t.authInfo.attribute.canRead,canSearch:t.authInfo.attribute.canSearch,canShare:t.authInfo.attribute.canShare,canSpitSlot:t.authInfo.attribute.canSpitSlot,canFeedback:t.authInfo.attribute.canSpitSlot,canTranslate:t.authInfo.attribute.canTranslate,canViewImage:t.authInfo.attribute.canViewImage,canWatermark:t.authInfo.attribute.canWatermark,isPrivilegeExpired:t.authInfo.privilegeExpire,canApplyEdit:t.authInfo.attribute.canApplyEdit}:{}}(t);this.authAggregate.authInfoEntity.isOwner=null!==(n=null===(e=t.docInfo)||void 0===e?void 0:e.isOwner)&&void 0!==n&&n,this.authAggregate.authInfoEntity.selfRole=null!==(i=null===(r=t.authInfo)||void 0===r?void 0:r.privilegeFlag)&&void 0!==i?i:0,this.authAggregate.authInfoEntity.documentPrivilege=null!==(s=null===(a=null===(o=t.authInfo)||void 0===o?void 0:o.privilegeInfo)||void 0===a?void 0:a.uint32Policy)&&void 0!==s?s:0,this.authAggregate.authInfoEntity.selfDocPrivilege=new R(v),this.authAggregate.authInfoEntity.selfDocAdvancedPrivilege=new E({readerCanComment:null===(d=null===(u=null===(c=t.authInfo)||void 0===c?void 0:c.privilegeInfo)||void 0===u?void 0:u.advPolicy)||void 0===d?void 0:d.readerCanComment,viewForbidCopyPrint:null===(f=null===(p=null===(_=t.authInfo)||void 0===_?void 0:_.privilegeInfo)||void 0===p?void 0:p.advPolicy)||void 0===f?void 0:f.viewForbidCopyPrint,writerCanComment:null===(g=null===(h=null===(l=t.authInfo)||void 0===l?void 0:l.privilegeInfo)||void 0===h?void 0:h.advPolicy)||void 0===g?void 0:g.writerCanComment}),this.isInitedByBasicClientVars=!0},(0,r.__decorate)([(0,T.u)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"init",null),(0,r.__decorate)([(0,A.aU)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"initWithBasicClientVars",null),t=(0,r.__decorate)([(0,r.__param)(0,m.v),(0,r.__param)(1,g._),(0,r.__metadata)("design:paramtypes",[Object,Object])],t)}()},51145:function(t,e,n){n.d(e,{HX:function(){return o},fq:function(){return a},jF:function(){return i}});var r=n(88694);function i(t){return t.retcode||t.code||0}function o(t){return t.msg||t.message||t.retmsg||""}function a(t,e){var n;void 0===e&&(e=!0);var a=t.error,s=t.data;if(a)return{error:a,resData:null};var c={data:e&&s?(0,r.MO)(s):s,retcode:i(s),msg:o(s),cgicode:null!==(n=s.cgicode)&&void 0!==n?n:0};return delete s.msg,delete s.message,delete s.retcode,delete s.code,delete s.cgicode,delete s.ret,{resData:c}}},92978:function(t,e,n){n.d(e,{S:function(){return i}});var r=n(85556),i=function(t){function e(e){var n=t.call(this)||this;return n.vipLevel=1,n.avatarFrameUrl="",n.renewalStatus=0,n.jsonObj2Class(e),n}return(0,r.__extends)(e,t),e}(n(44225).K)},13775:function(t,e,n){n.d(e,{HL:function(){return a},Hf:function(){return o},RP:function(){return f},aP:function(){return _},bd:function(){return p},d0:function(){return s},jo:function(){return c},rW:function(){return u},yQ:function(){return d}});var r=n(25153),i=n(31072),o="//".concat((0,i.getHost)()),a="".concat(o,"/cgi-bin/online_docs/"),s="".concat(o,"/cgi-bin/api/"),c="".concat(o,"/cgi-go/"),u="".concat(o,"/v2/"),d="".concat(o,"/v3/"),_="".concat(o,"/cgi-go/"),p="//".concat(r.qe),f="//".concat(r.Cs)},20585:function(t,e,n){var r,i,o,a,s,c,u,d;n.d(e,{Cl:function(){return c},Cy:function(){return s},Dl:function(){return u},nN:function(){return r},pZ:function(){return o},rg:function(){return a},uv:function(){return i},v2:function(){return d}}),function(t){t[t.COLLECT=0]="COLLECT",t[t.CANCEL=1]="CANCEL"}(r||(r={})),function(t){t[t.BLANK=1]="BLANK",t[t.TEMPLATE=2]="TEMPLATE",t[t.COPY=4]="COPY"}(i||(i={})),function(t){t[t.DOC=0]="DOC",t[t.EXCEL=1]="EXCEL",t[t.PPT=2]="PPT",t[t.FORM=3]="FORM"}(o||(o={})),function(t){t[t.NONE=0]="NONE",t[t.HUMTRANS=1]="HUMTRANS"}(a||(a={})),function(t){t[t.NONE=0]="NONE",t[t.DEFAULT=5]="DEFAULT"}(s||(s={})),function(t){t[t.MOBILE=0]="MOBILE",t[t.PC=1]="PC"}(c||(c={})),function(t){t[t.Inactive=1]="Inactive",t[t.NormalVip=2]="NormalVip",t[t.SuperVip=3]="SuperVip"}(u||(u={})),function(t){t[t.Inactive=0]="Inactive",t[t.Active=1]="Active",t[t.CloseAfterActive=2]="CloseAfterActive"}(d||(d={}))},25882:function(t,e,n){n.d(e,{Z:function(){return i}});var r=n(85556),i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.aggregateVersion=0,e.aggregateIsDeleted=!1,e}return(0,r.__extends)(e,t),e.prototype.version=function(){return this.aggregateVersion},e.prototype.isDeleted=function(){return this.aggregateIsDeleted},e}(n(94404).J)},44184:function(t,e,n){n.d(e,{V:function(){return o}});var r=n(33661),i=n(54464),o=function(){function t(){}return t.prototype.jsonObj2Class=function(e,n){var i=this;e?Object.keys(e).forEach((function(o){var a=o;n||(a=(0,r.rI)(o)),Object.prototype.hasOwnProperty.call(i,a)&&(i[a]instanceof t?i[a].jsonObj2Class(e[o]):i[a]=e[o])})):t.logger.debug("params erroro: jsonObj2Class")},t.prototype.class2JsonObj=function(e){var n=this,i={};return Object.keys(this).forEach((function(o){if("id"!==o){var a=o;e||(a=(0,r.IM)(o)),n[o]instanceof t&&(i[a]=n[o].class2JsonObj(e)),i[a]=n[o]}})),i},t.logger=new i.Yd("DDBase").use("console"),t}()},94404:function(t,e,n){n.d(e,{J:function(){return i}});var r=n(85556),i=function(t){function e(e){var n=t.call(this)||this;return n.id=e,n}return(0,r.__extends)(e,t),e.prototype.initWithJsonObj=function(t){this.jsonObj2Class(t)},e.prototype.jsonObj=function(){return this.class2JsonObj()},e.prototype.getIdentity=function(){return this.id},e.prototype.equals=function(t){return null!==t&&(this===t||this.getIdentity()===t.getIdentity())},e}(n(44184).V)},44225:function(t,e,n){n.d(e,{K:function(){return i}});var r=n(85556),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,r.__extends)(e,t),e.prototype.jsonObj=function(){return this.class2JsonObj()},e.prototype.equals=function(t){var n,i,o=Object.keys(this);try{for(var a=(0,r.__values)(o),s=a.next();!s.done;s=a.next()){var c=s.value;if(this[c]instanceof e){if(!this[c].equals(t[c]))return!1}else if(this[c]!==t[c])return!1}}catch(t){n={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return!0},e.prototype.clone=function(){var t=Reflect.getPrototypeOf(this);return Reflect.construct(t.constructor,[this.jsonObj()])},e}(n(44184).V)},16740:function(t,e,n){n.d(e,{BX:function(){return l},CK:function(){return b},EL:function(){return m},FY:function(){return v},GT:function(){return p},Hh:function(){return y},LD:function(){return I},Vo:function(){return _},aU:function(){return S},bj:function(){return d},rx:function(){return h},sv:function(){return g},w1:function(){return w}});var r=n(85556),i=n(44225),o=n(88694),a=n(54464),s=n(51145),c=n(33661),u=new a.Yd("domain").use("console");function d(){return function(t,e,n){var i=n.value;n.value=function(){for(var n,o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];return(0,r.__awaiter)(this,void 0,void 0,(function(){var a,c,d;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,i.apply(this,o)];case 1:return a=r.sent().data,c={data:a,retcode:(0,s.jF)(a),msg:(0,s.HX)(a),cgicode:null!==(n=a.cgicode)&&void 0!==n?n:0},delete a.msg,delete a.message,delete a.retmsg,delete a.retcode,delete a.code,delete a.cgicode,delete a.ret,[2,{resData:c}];case 2:return d=r.sent(),u.error("".concat(t.constructor.name,"|").concat(e,"|").concat(d)),[2,{error:d,resData:{}}];case 3:return[2]}}))}))}}}function _(){return function(t,e,n){var i=n.value;n.value=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return(0,r.__awaiter)(this,void 0,void 0,(function(){var o;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,i.apply(this,n)];case 1:return[2,{data:r.sent().data}];case 2:return o=r.sent(),u.error("".concat(t.constructor.name,"|").concat(e,"|").concat(o)),[2,{error:o,data:{}}];case 3:return[2]}}))}))}}}function p(t,e){return function(n,i,o){u.debug("praseHeaderKey2DataHandler|".concat(n.constructor.name,"|").concat(i,"|").concat(t));var a=o.value;o.value=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return(0,r.__awaiter)(this,void 0,void 0,(function(){var i,o,s;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,a.apply(this,n)];case 1:return i=r.sent(),o=i.data,s=i.headers,o&&s&&s[t]&&(o[e]=s[t]),[2,i]}}))}))}}}function f(t,e){return t.prototype instanceof i.K?Reflect.construct(t,[e]):Reflect.construct(t,["mainEntity"]).initWithJsonObj(e)}function l(t,e){return function(n,i,o){u.debug("fireEvent|".concat(n.constructor.name,"|").concat(i));var a=o.value;o.value=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return(0,r.__awaiter)(this,void 0,void 0,(function(){var i,o;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,a.apply(this,n)];case 1:return(i=r.sent()).resData&&(0,c.zk)(i.resData)&&((o={})[e]=this[e],this[t].fire(o)),[2,i]}}))}))}}}function h(){return function(t,e,n){u.debug("changeSuperVipData|".concat(t.constructor.name,"|").concat(e));var i=n.value;n.value=function(){for(var t,e,n,o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];return(0,r.__awaiter)(this,void 0,void 0,(function(){var a,s,c;return(0,r.__generator)(this,(function(u){switch(u.label){case 0:return[4,i.apply(this,o)];case 1:return(a=u.sent()).error?[2,a]:((s=null!==(n=null===(e=null===(t=a.resData)||void 0===t?void 0:t.data)||void 0===e?void 0:e.vip_info)&&void 0!==n?n:{}).super_vip=null==s?void 0:s.super,(c=(0,r.__assign)({},a.resData)).data.vip_info=s,[2,{resData:c}])}}))}))}}}function g(t,e){return function(n,o,a){u.debug("parseObjectData|".concat(n.constructor.name,"|").concat(o));var s=a.value;a.value=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return(0,r.__awaiter)(this,void 0,void 0,(function(){var o;return(0,r.__generator)(this,(function(a){switch(a.label){case 0:return[4,s.apply(this,n)];case 1:return(o=a.sent()).error?[2,o]:(this.aggregateVersion=this.aggregateVersion+1,t.prototype instanceof i.K?this[e]=f(t,o.resData.data):this[e].initWithJsonObj(o.resData.data),[2,{resData:(0,r.__assign)((0,r.__assign)({},o.resData),{data:this[e]})}])}}))}))}}}function v(t,e,n){return function(i,o,a){u.debug("parseArrayData|".concat(i.constructor.name,"|").concat(o));var s=a.value;a.value=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return(0,r.__awaiter)(this,void 0,void 0,(function(){var o,a=this;return(0,r.__generator)(this,(function(c){switch(c.label){case 0:return[4,s.apply(this,i)];case 1:return(o=c.sent()).error?[2,o]:(this.aggregateVersion=this.aggregateVersion+1,(o.resData.data[n]||[]).forEach((function(n){a[e].push(f(t,n))})),[2,{resData:(0,r.__assign)((0,r.__assign)({},o.resData),{data:this[e]})}])}}))}))}}}function m(t,e,n,i){return function(o,a,s){u.debug("parseArrayDataInObject|".concat(o.constructor.name,"|").concat(a));var c=s.value;s.value=function(){for(var o,a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return(0,r.__awaiter)(this,void 0,void 0,(function(){var s,u,d=this;return(0,r.__generator)(this,(function(_){switch(_.label){case 0:return[4,c.apply(this,a)];case 1:return(s=_.sent()).error?[2,s]:(this.aggregateVersion=this.aggregateVersion+1,null==(u=(null===(o=s.resData.data[n])||void 0===o?void 0:o[i])||[])||u.forEach((function(n){d[e].push(f(t,n))})),[2,{resData:(0,r.__assign)((0,r.__assign)({},s.resData),{data:this[e]})}])}}))}))}}}function y(){return function(t,e,n){u.debug("dataFieldNamingHandler|".concat(t.constructor.name,"|").concat(e));var i=n.value;n.value=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return(0,r.__awaiter)(this,void 0,void 0,(function(){var n;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,i.apply(this,e)];case 1:return n=r.sent(),(null===(t=n.resData)||void 0===t?void 0:t.data)&&(n.resData.data=(0,o.MO)(n.resData.data)),[2,n]}}))}))}}}function w(){return function(t,e,n){u.debug("paramsFieldNamingHandler|".concat(t.constructor.name,"|").concat(e));var i=n.value;n.value=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return t.length?[3,2]:[4,i.apply(this,[])];case 1:case 3:return[2,n.sent()];case 2:return e=[(0,o.P1)(t[0])],[4,i.apply(this,e)]}}))}))}}}function I(){return function(t,e,n){u.debug("parseResBody|".concat(t.constructor.name,"|").concat(e));var i=n.value;n.value=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return[4,i.apply(this,t)];case 1:return(e=n.sent()).error?[2,e]:[2,{resData:(0,r.__assign)((0,r.__assign)({},e.resData),{data:(0,r.__assign)({},e.resData.data.body)})}]}}))}))}}}function b(t){return function(e,n,i){u.debug("parseResBody|".concat(e.constructor.name,"|").concat(n));var o=i.value;i.value=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return(0,r.__awaiter)(this,void 0,void 0,(function(){var n;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,o.apply(this,e)];case 1:return(n=r.sent()).error||this[t](e),[2,n]}}))}))}}}function S(t){return function(e,n,r){u.debug("parseResBody|".concat(e.constructor.name,"|").concat(n));var i=r.value;return r.value=function(){for(var r,o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];try{r=i.apply(this,o)}catch(i){u.error("tryCatchHandler caught error from ".concat(e.constructor.name,"|").concat(n,". Error detail: ").concat(i)),r=t}return r||void 0},r}}u.level="OFF"},11268:function(t,e,n){n.d(e,{_:function(){return r}});var r=(0,n(66624).yh)("INetworkRequestService")},76642:function(t,e,n){n.d(e,{L:function(){return i}});var r=n(90304),i=function(){this.instance=r.networkRequest}},33661:function(t,e,n){n.d(e,{B8:function(){return h},CY:function(){return _},DN:function(){return d},IM:function(){return i},KV:function(){return v},Pc:function(){return s},Qj:function(){return g},bk:function(){return p},fQ:function(){return c},kI:function(){return l},pT:function(){return f},rI:function(){return o},s4:function(){return u},zk:function(){return a}});var r=n(46163);function i(t){return t.length<1?t:(t[0].toLowerCase()+t.substr(1)).replace(/([A-Z])/g,(function(t){return"_".concat(t.toLowerCase())}))}function o(t){for(var e=t.split("_"),n="",r=0;r<e.length;r++){var i=e[r];i.length>0&&(n+=0===r?i:i="".concat(i[0].toUpperCase()).concat(i.substring(1)))}return n}function a(t){return!!t&&0===t.retcode&&0===t.cgicode}function s(t){return t||""}function c(t){return t||0}function u(){return(0,r.ej)("p_lskey")}function d(){return(0,r.ej)("p_skey")}function _(){return(0,r.ej)("vfwebqq")||""}function p(t){var e=new FormData;return Object.keys(t).forEach((function(n){e.set(n,t[n])})),e}function f(t){var e=new FormData;return Object.keys(t).forEach((function(n){void 0!==t[n]&&e.set(n,t[n])})),e}function l(t){var e=new URLSearchParams;return Object.keys(t).forEach((function(n){void 0!==t[n]&&e.set(n,t[n])})),e}function h(t,e){return["0",""].includes(t)?e:"".concat(t,"$").concat(e)}var g=function(){return(0,r.ej)("TOK")};function v(t,e){void 0===e&&(e=void 0);try{return JSON.parse(t)}catch(t){return e}}},48715:function(t,e,n){n.d(e,{e:function(){return r}});var r=(0,n(66624).yh)("IDomainUpdater")},95439:function(t,e,n){n.d(e,{d:function(){return u}});var r=n(85556),i=n(4094),o=function(){function t(){}return t.getLevel1MapInfo=function(t,e,n){return{domainId:t.docMetaEntity.padInfo.domainId,padId:t.docMetaEntity.padInfo.padId,type:t.docMetaEntity.padInfo.type,padType:t.docMetaEntity.padInfo.padType,shareLink:t.docMetaEntity.padInfo.shareLink,docStatus:t.docMetaEntity.padInfo.docStatus,globalPadId:t.docMetaEntity.padInfo.globalPadId,lastModifyUser:t.docMetaEntity.padInfo.lastModifyUser,lastModifyTime:t.docMetaEntity.padInfo.lastModifyTime,metaCreateTime:t.docMetaEntity.createInfo.metaCreateTime,creatorId:t.docMetaEntity.createInfo.creatorId,creatorNick:t.docMetaEntity.createInfo.creatorNick,creatorDomain:t.docMetaEntity.createInfo.creatorDomain,isCreator:t.docMetaEntity.createInfo.isCreator,ownerId:t.docMetaEntity.ownerInfo.ownerId,ownerNick:t.docMetaEntity.ownerInfo.ownerNick,ownerAppid:t.docMetaEntity.ownerInfo.ownerAppid,officialAuthInfo:t.docMetaEntity.ownerInfo.officialAuthInfo,padTitle:t.docMetaEntity.titleInfo.title,title:t.docMetaEntity.titleInfo.title,isUserChangeTitle:t.docMetaEntity.titleInfo.isUserChangeTitle,rightFlag:e.authAggregate.authInfoEntity.selfRole,isOwner:e.authAggregate.authInfoEntity.isOwner,tinyid:n.userInfoAggregate.userInfo.tinyid,userName:n.userInfoAggregate.userInfo.nick,userPic:n.userInfoAggregate.userInfo.avatar,userType:n.userInfoAggregate.userInfo.loginType,userId:n.userInfoAggregate.userInfo.uid,uin:n.userInfoAggregate.userInfo.uin}},t.getLevel2PrivilegeMapInfo=function(t){var e=t.authAggregate.authInfoEntity.selfDocPrivilege;return{can_copy:e.canCopy,can_print:e.canPrint,can_history:e.canHistory,can_read:e.canRead,can_edit_title:e.canEditTitle,can_search:e.canSearch,can_add_user:e.canAddUser,can_view_image:e.canViewImage,can_edit:e.canEdit,can_share:e.canShare,can_comment:e.canComment,can_about:e.canAbout,can_spit_slot:e.canSpitSlot,can_watermark:e.canWatermark,can_translate:e.canTranslate,can_link_exp:e.canLinkExp,can_copy_doc:e.canCopyDoc}},t.getLevel2AdvPolicyMapInfo=function(t){var e=t.authAggregate.authInfoEntity.selfDocAdvancedPrivilege;return{reader_can_comment:e.readerCanComment,view_forbid_copy_print:e.viewForbidCopyPrint,writer_can_comment:e.writerCanComment}},t}(),a=function(){function t(){}return t.createClientVarsToDomainProxy=function(e,n,r,i){t.createLevel2PrivilegeProxy(n,i),t.createLevel2AdvPolicyProxy(n,i),t.createLevel1Proxy(e,n,r,i)},t.getProxyHandler=function(t){return{get:function(e,n){return Object.keys(t).includes(n)?t[n]:e[n]},set:function(e,n,r){return Object.keys(t).includes(n)?t[n]=r:e[n]=r,!0}}},t.createLevel1Proxy=function(e,r,i,a){var s=a,c=o.getLevel1MapInfo(e,r,i),u=t.getProxyHandler(c);n.g.clientVars=new Proxy(s,u)},t.createLevel2PrivilegeProxy=function(e,n){var r=n,i=o.getLevel2AdvPolicyMapInfo(e),a=t.getProxyHandler(i);r.privilegeAttribute=new Proxy(n.privilegeAttribute||{},a)},t.createLevel2AdvPolicyProxy=function(e,n){var r=n,i=o.getLevel2AdvPolicyMapInfo(e),a=t.getProxyHandler(i);r.advPolicy=new Proxy(r.advPolicy,a)},t}(),s=n(56795),c=n(11297),u=function(){function t(t,e,n){this.docMetaDomainService=t,this.authDomainService=e,this.userInfoDomainService=n}return t.prototype.updateDomainWithClientVars=function(t,e){void 0===e&&(e=!1),this.docMetaDomainService.updateWithClientVars(t),this.authDomainService.updateWithClientVars(t),this.userInfoDomainService.updateWithClientVars(t),e&&a.createClientVarsToDomainProxy(this.docMetaDomainService,this.authDomainService,this.userInfoDomainService,t)},t.prototype.updateDomainWithRequests=function(t){this.docMetaDomainService.init(t),this.authDomainService.init(t),this.userInfoDomainService.init(t)},t=(0,r.__decorate)([(0,r.__param)(0,s.v),(0,r.__param)(1,i.i),(0,r.__param)(2,c.m),(0,r.__metadata)("design:paramtypes",[Object,Object,Object])],t)}()},79895:function(t,e,n){n.d(e,{U:function(){return r}});var r=(0,n(66624).yh)("ICollaborateDomainService")},42286:function(t,e,n){n.d(e,{u:function(){return S}});var r=n(85556),i=n(25882),o=n(16740),a=n(33661);function s(t){return t.includes(".")?t.split(".")[1]:t}function c(t){return!!t&&!!t.startsWith("p.")}var u=n(13775),d="".concat(u.Hf,"/sdc/getusermarkname"),_=n(56795),p=n(90304),f=n(23742),l=function(){function t(t){this.docMetaDomain=t}return t.prototype.getUserMarkName=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,i,o;return(0,r.__generator)(this,(function(s){return n=this.getFormattedUidsString(t),i=(0,r.__assign)((0,r.__assign)({},e),{localPadId:this.docMetaDomain.docMetaEntity.padInfo.padId,domainId:this.docMetaDomain.docMetaEntity.padInfo.domainId,uids:n}),o={xsrf:(0,a.Qj)()},[2,p.networkRequest.post(d,i,{params:o})]}))}))},t.prototype.getFormattedUidsString=function(t){return(0,f.isArray)(t)?"[".concat(t.toString(),"]"):"[".concat(t,"]")},t=(0,r.__decorate)([(0,r.__param)(0,_.v),(0,r.__metadata)("design:paramtypes",[Object])],t)}(),h=n(92978),g=n(44225),v=n(49790),m=function(t){function e(e){var n=t.call(this)||this;return n.userType=1,n.vipInfo=new h.S({}),n.sessionType=0,n.uuid="",n.status="",n.colorId="",n.corpName="",n.userPic="",n.markName="",n.uin="",n.userId="",n.uidSource=v.ACCOUNT_TYPE.UNKNOWN,n.jsonObj2Class(e),n}return(0,r.__extends)(e,t),e}(g.K),y=n(11297),w=n(36023),I=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.docMetaDomain=n,i.userInfoDomain=r,i.collaborateList=[],i.currentMemCount=0,i.collabAllInfoList=[],i.throttleInterval=0,i.maxCollabListLengthLimit=999,i.collabRecordList=[],i.collaboratesCacheMap=new Map,i.onCollabAllInfoListUpdatedEmitter=new w.Emitter,i.onUserComeInEmitter=new w.Emitter,i.onUserLeaveEmitter=new w.Emitter,i.onCommercializeMessageEmitter=new w.Emitter,i.needRequestUserIds=new Set,i.onCollabAllInfoListUpdated=i.onCollabAllInfoListUpdatedEmitter.event,i.onUserComeIn=i.onUserComeInEmitter.event,i.onUserLeave=i.onUserLeaveEmitter.event,i.onCommercializeMessage=i.onCommercializeMessageEmitter.event,i.collaborateRepository=new l(n),i}return(0,r.__extends)(e,t),e.prototype.handleUserComeIn=function(t){var e,n=this;null===(e=t.notices)||void 0===e||e.forEach((function(t){n.appendNoticeTo(t)})),this.currentMemCount=this.collaborateList.length,this.onUserComeInEmitter.fire(t),this.processUserEnter(t)},e.prototype.handleUserLeave=function(t){var e,n=this;null===(e=t.notices)||void 0===e||e.forEach((function(t){n.collaborateList=n.collaborateList.filter((function(e){return e.userId!==t.userId}))})),this.currentMemCount=this.collaborateList.length,this.onUserLeaveEmitter.fire(t),this.processUserLeave(t)},e.prototype.getUserMarkName=function(t,e,n){var i,o;return void 0===e&&(e=!1),(0,r.__awaiter)(this,void 0,void 0,(function(){var a,s,u,d,_,p,f;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return e?[4,this.collaborateRepository.getUserMarkName(t,n)]:[3,2];case 1:return a=r.sent(),this.setUserMarkItemToCache(a),[2,a];case 2:return s=this.getUserMarkItemFromCache(t),u=s.unCachedUserIds,d=s.cachedResults,0===u.length?[2,{data:{cgicode:0,retcode:0,result:{rsp:d}},status:200,statusText:""}]:c(this.userInfoDomain.userInfoAggregate.userInfo.userId)?[4,this.collaborateRepository.getUserMarkName(u,n)]:[2,{data:{cgicode:0,retcode:0,result:{rsp:[]}},status:200,statusText:""}];case 3:return _=r.sent(),this.setUserMarkItemToCache(_),(null===(o=null===(i=null==_?void 0:_.data)||void 0===i?void 0:i.result)||void 0===o?void 0:o.rsp)&&(p=_.data.result.rsp,f=void 0===p?[]:p,_.data.result.rsp=f.concat(d)),[2,_]}}))}))},e.prototype.handleCommerIcilizeMessage=function(t){this.onCommercializeMessageEmitter.fire(t)},Object.defineProperty(e.prototype,"maxCollabListLimit",{get:function(){return this.maxCollabListLengthLimit?this.maxCollabListLengthLimit:1/0},enumerable:!1,configurable:!0}),e.prototype.appendNoticeTo=function(t){this.collaborateList.find((function(e){return e.userId===t.userId}))||this.collaborateList.push(t)},e.prototype.createCollaborateItemObject=function(t,e){var n;return(0,r.__assign)((0,r.__assign)((0,r.__assign)({},t),t.userId?null:{userId:null!==(n=t.reqUid)&&void 0!==n?n:""}),{userType:e?1:2})},e.prototype.fillVipInfoWithRecordInfo=function(t,e){if(e)return t;var n=this.collabRecordList.find((function(e){return e.userId===t.userId}));return n?(0,r.__assign)((0,r.__assign)({},t),{vipInfo:null==n?void 0:n.vipInfo}):t},e.prototype.checkAdd2CollaborateList=function(t,e){var n=this.createCollaborateItemObject(t,e);n=this.fillVipInfoWithRecordInfo(n,e),!this.collabAllInfoList.find((function(t){return t.userId===n.userId}))&&this.collabAllInfoList.length<this.maxCollabListLimit&&this.collabAllInfoList.push(new m(n))},e.prototype.processUserEnter=function(t){var e=this,n=!1;null==t||t.notices.forEach((function(t){var i=s(t.userId),o={uid:i,userId:i,sessionType:t.sessionType,uuid:t.uuId,vipInfo:(0,a.KV)(t.vipInfo,{})};if(e.collabRecordList.push(o),!c(e.userInfoDomain.userInfoAggregate.userInfo.userId))return e.checkAdd2CollaborateList(o,!0),void(n=!0);if(!e.collabAllInfoList.find((function(t){return t.userId===i}))){if(!c(t.userId))return e.checkAdd2CollaborateList(o,!0),void(n=!0);if(e.collaboratesCacheMap.has(i)){var u=e.collaboratesCacheMap.get(i),d=(0,a.KV)(t.vipInfo,{}),_=(0,r.__assign)((0,r.__assign)({},u),{vipInfo:d});return e.checkAdd2CollaborateList(_,!1),void(n=!0)}e.needRequestUserIds.add(i)}})),n&&this.onCollabAllInfoListUpdatedEmitter.fire({collabAllInfoList:this.collabAllInfoList}),c(this.userInfoDomain.userInfoAggregate.userInfo.userId)&&this.throttleGetUserMarkname()},e.prototype.throttleGetUserMarkname=function(){var t=this;if(!this.throttleTimer){this.innerGetUserMarkName();var e=this.throttleInterval||6e4;this.throttleTimer=setInterval((function(){t.innerGetUserMarkName()}),e)}},e.prototype.processUserLeave=function(t){var e=this;null==t||t.notices.forEach((function(t){var n=s(t.userId);e.popFormCollabRecordList(n),e.collabRecordList.filter((function(t){return t.userId===n})).length>0||(e.collabAllInfoList=e.collabAllInfoList.filter((function(t){return t.userId!==n})),c(t.userId)&&e.needRequestUserIds.delete(n))})),this.onCollabAllInfoListUpdatedEmitter.fire({collabAllInfoList:this.collabAllInfoList})},e.prototype.innerGetUserMarkName=function(){var t;return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,i,o,a=this;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:if(0===this.needRequestUserIds.size)return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),n=Array.from(this.needRequestUserIds).join(","),[4,this.collaborateRepository.getUserMarkName(n)];case 2:if(i=r.sent(),0===(null===(t=null==i?void 0:i.data)||void 0===t?void 0:t.retcode)){if(!(o=i.data.result.rsp))return[2];o.forEach((function(t){a.needRequestUserIds.has(t.reqUid)&&(a.needRequestUserIds.delete(t.reqUid),a.checkAdd2CollaborateList(t,!1)),a.collaboratesCacheMap.set(t.reqUid,t)})),this.onCollabAllInfoListUpdatedEmitter.fire({collabAllInfoList:this.collabAllInfoList})}return[3,4];case 3:return r.sent(),e.logger.error("handleUserComeIn request error"),[3,4];case 4:return[2]}}))}))},e.prototype.popFormCollabRecordList=function(t){for(var e=0;e<this.collabRecordList.length;e++)if(this.collabRecordList[e].userId===t)return void this.collabRecordList.splice(e,1)},e.prototype.setUserMarkItemToCache=function(t){var e,n,r,i,o=this;0===(null===(e=null==t?void 0:t.data)||void 0===e?void 0:e.retcode)&&(null!==(i=null===(r=null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.result)||void 0===r?void 0:r.rsp)&&void 0!==i?i:[]).forEach((function(t){(null==t?void 0:t.reqUid)&&o.collaboratesCacheMap.set(t.reqUid,t)}))},e.prototype.getSingleUserMarkItemFromCache=function(t){var e=this.collaboratesCacheMap.get(t);return e?{unCachedUserIds:[],cachedResults:[e]}:{unCachedUserIds:[t],cachedResults:[]}},e.prototype.getUserMarkItemFromCache=function(t){var e=this,n=[],r=[];return((0,f.isArray)(t)?t:[t]).forEach((function(t){var i=e.getSingleUserMarkItemFromCache(t),o=i.cachedResults,a=i.unCachedUserIds;n=n.concat(a),r=r.concat(o)})),{unCachedUserIds:n,cachedResults:r}},(0,r.__decorate)([(0,o.Hh)(),(0,o.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object,Object,Object]),(0,r.__metadata)("design:returntype",Promise)],e.prototype,"getUserMarkName",null),e=(0,r.__decorate)([(0,r.__param)(1,_.v),(0,r.__param)(2,y.m),(0,r.__metadata)("design:paramtypes",[String,Object,Object])],e)}(i.Z),b=n(99181),S=function(){function t(t,e){this.docMetaDomainService=t,this.userInfoDomainService=e,this.collaborateAggregate=new I("mainUserInfoAggregate",this.docMetaDomainService,this.userInfoDomainService)}return t.prototype.init=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.docMetaDomainService.init(t)];case 1:return e.sent(),[2]}}))}))},(0,r.__decorate)([(0,b.u)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"init",null),t=(0,r.__decorate)([(0,r.__param)(0,_.v),(0,r.__param)(1,y.m),(0,r.__metadata)("design:paramtypes",[Object,Object])],t)}()},25153:function(t,e,n){n.d(e,{$8:function(){return p},Cs:function(){return s},LC:function(){return l},Sc:function(){return o},gH:function(){return i},gN:function(){return h},i4:function(){return u},kC:function(){return a},l8:function(){return _},n0:function(){return g},qe:function(){return c},rH:function(){return f},zC:function(){return d}});var r=n(89057).L.getConfig('npm["@tencent/ark-domain"]'),i=window.location.host,o=(null==r?void 0:r.WECHAT_WEBVIEW_LOGIN)||"https://docs.qq.com/scenario/h5auth.html",a=(null==r?void 0:r.LOGIN_PAGE_URL)||"https://docs.qq.com/login.html",s=(null==r?void 0:r.TOC_HOST)||"docs.qq.com",c=(null==r?void 0:r.TOB_HOST)||"doc.weixin.qq.com",u=(null==r?void 0:r.DOCS_WW_LOGIN)||"https://docs.qq.com/scenario/ww-login.html",d=(null==r?void 0:r.OPEN_WEIXIN_AUTHORIZE)||"https://open.weixin.qq.com/connect/oauth2/authorize",_=(null==r?void 0:r.TOB_TARGET_ORIGIN)||"https://doc.weixin.qq.com",p=(null==r?void 0:r.TOB_IFRAME_URL_ACCOUNT_LIST)||"https://doc.weixin.qq.com/tim/docs/components/IfameManageAccountListToC.html",f=(null==r?void 0:r.TOB_IFRAME_URL_SET_COOKIE)||"https://doc.weixin.qq.com/scenario/iframe-to-b-set-cookie.html",l=(null==r?void 0:r.TOC_TARGET_ORIGIN)||"https://docs.qq.com",h=(null==r?void 0:r.TOC_IFRAME_URL_ACCOUNT_LIST)||"https://docs.qq.com/components/feature/IframeToManageAccountList.html",g=(null==r?void 0:r.TOC_IFRAME_URL_SET_COOKIE)||"https://docs.qq.com/scenario/iframe-to-c-set-cookie.html"},75378:function(t,e,n){n.d(e,{G:function(){return r}});var r=(0,n(66624).yh)("IFileDomainService")},65592:function(t,e,n){n.d(e,{v:function(){return y}});var r=n(85556),i=n(16740),o=n(76642),a=n(11268),s=n(33661),c=n(13775),u="".concat(c.HL,"doc_collect"),d="".concat(c.HL,"doc_getcollect"),_="".concat(c.HL,"createdoc_new"),p="".concat(c.HL,"doc_recover"),f="".concat(c.HL,"doc_humtrans"),l="".concat(c.jo,"can/move"),h=n(46163),g=n(73154),v=function(){function t(t){this.networkRequestService=t}return t.prototype.collect=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e=(0,s.bk)((0,r.__assign)((0,r.__assign)({},t),{xsrf:(0,h.w$)(h.$W.xsrf)})),[2,this.networkRequestService.instance.post(u,e)]}))}))},t.prototype.getDocCollect=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,r.__generator)(this,(function(i){return e=(0,r.__assign)((0,r.__assign)({},t),{xsrf:"".concat((0,h.w$)(h.$W.xsrf))}),n=(0,g.At)(d,e),[2,this.networkRequestService.instance.get(n)]}))}))},t.prototype.createDoc=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e=(0,s.bk)((0,r.__assign)((0,r.__assign)({},t),{xsrf:(0,h.w$)(h.$W.xsrf)})),[2,this.networkRequestService.instance.post(_,e)]}))}))},t.prototype.recover=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e=(0,s.bk)((0,r.__assign)((0,r.__assign)({},t),{xsrf:(0,h.w$)(h.$W.xsrf)})),[2,this.networkRequestService.instance.post(p,e)]}))}))},t.prototype.docHumtrans=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e=(0,s.bk)((0,r.__assign)((0,r.__assign)({},t),{xsrf:(0,h.w$)(h.$W.xsrf)})),[2,this.networkRequestService.instance.post(f,e)]}))}))},t.prototype.canMove=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,r.__generator)(this,(function(i){return e=(0,r.__assign)((0,r.__assign)({},t),{xsrf:"".concat((0,h.w$)(h.$W.xsrf))}),n=(0,g.At)(l,e),[2,this.networkRequestService.instance.get(n)]}))}))},t=(0,r.__decorate)([(0,r.__param)(0,a._),(0,r.__metadata)("design:paramtypes",[Object])],t)}(),m=n(99181),y=function(){function t(){this.fileRepository=new v(new o.L)}return t.prototype.init=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return[2]}))}))},t.prototype.collect=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,this.fileRepository.collect(t)]}))}))},t.prototype.getDocCollect=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,this.fileRepository.getDocCollect(t)]}))}))},t.prototype.createDoc=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,this.fileRepository.createDoc(t)]}))}))},t.prototype.recover=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,this.fileRepository.recover(t)]}))}))},t.prototype.docHumtrans=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,this.fileRepository.docHumtrans(t)]}))}))},t.prototype.canMove=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,this.fileRepository.canMove(t)]}))}))},(0,r.__decorate)([(0,m.u)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"init",null),(0,r.__decorate)([(0,i.Hh)(),(0,i.bj)(),(0,i.w1)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"collect",null),(0,r.__decorate)([(0,i.Hh)(),(0,i.bj)(),(0,i.w1)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"getDocCollect",null),(0,r.__decorate)([(0,i.Hh)(),(0,i.bj)(),(0,i.w1)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"createDoc",null),(0,r.__decorate)([(0,i.Hh)(),(0,i.bj)(),(0,i.w1)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"recover",null),(0,r.__decorate)([(0,i.Hh)(),(0,i.bj)(),(0,i.w1)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"docHumtrans",null),(0,r.__decorate)([(0,i.Hh)(),(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"canMove",null),t}()},60914:function(t,e,n){n.d(e,{r:function(){return r}});var r=(0,n(66624).yh)("IFolderDomainService")},56753:function(t,e,n){n.d(e,{i:function(){return h}});var r=n(85556),i=n(16740),o=n(76642),a=n(11268),s=n(33661),c=n(13775),u="".concat(c.HL,"folder_list"),d="".concat(c.HL,"folder_new"),_="".concat(c.HL,"doc_addmy"),p=n(46163),f=function(){function t(t){this.networkRequestService=t}return t.prototype.folderList=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e=(0,s.bk)((0,r.__assign)((0,r.__assign)({},t),{xsrf:(0,p.w$)(p.$W.xsrf)})),[2,this.networkRequestService.instance.post(u,e)]}))}))},t.prototype.newFolder=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e=(0,s.bk)((0,r.__assign)((0,r.__assign)({},t),{xsrf:(0,p.w$)(p.$W.xsrf)})),[2,this.networkRequestService.instance.post(d,e)]}))}))},t.prototype.addToMyFolder=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e=(0,s.bk)((0,r.__assign)((0,r.__assign)({},t),{xsrf:(0,p.w$)(p.$W.xsrf)})),[2,this.networkRequestService.instance.post(_,e)]}))}))},t=(0,r.__decorate)([(0,r.__param)(0,a._),(0,r.__metadata)("design:paramtypes",[Object])],t)}(),l=n(99181),h=function(){function t(){this.folderRepository=new f(new o.L)}return t.prototype.init=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return[2]}))}))},t.prototype.folderList=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,this.folderRepository.folderList(t)]}))}))},t.prototype.newFolder=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,this.folderRepository.newFolder(t)]}))}))},t.prototype.addToMyFolder=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,this.folderRepository.addToMyFolder(t)]}))}))},(0,r.__decorate)([(0,l.u)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"init",null),(0,r.__decorate)([(0,i.Hh)(),(0,i.bj)(),(0,i.w1)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"folderList",null),(0,r.__decorate)([(0,i.Hh)(),(0,i.bj)(),(0,i.w1)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"newFolder",null),(0,r.__decorate)([(0,i.Hh)(),(0,i.bj)(),(0,i.w1)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"addToMyFolder",null),t}()},86622:function(t,e,n){n.d(e,{y:function(){return r}});var r=(0,n(66624).yh)("ITemplateDomainService")},12272:function(t,e,n){n.d(e,{Y:function(){return h}});var r=n(85556),i=n(16740),o=n(76642),a=n(11268),s=n(33661),c=n(46163),u=n(13775),d="".concat(u.Hf,"/cgi-bin/template/mytemplate_add"),_="".concat(u.Hf,"/cgi-bin/template/template_detail"),p="".concat(u.Hf,"/ep/api/settipflag"),f=function(){function t(t){this.networkRequestService=t}return t.prototype.addToMyTemplate=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e=(0,s.bk)((0,r.__assign)((0,r.__assign)({},t),{xsrf:(0,c.w$)(c.$W.xsrf)})),[2,this.networkRequestService.instance.post(d,e)]}))}))},t.prototype.templateDetail=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e=(0,s.bk)((0,r.__assign)((0,r.__assign)({},t),{template_type:3,xsrf:(0,c.w$)(c.$W.xsrf)})),[2,this.networkRequestService.instance.post(_,e)]}))}))},t.prototype.setTipFlag=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e=(0,s.bk)({globalPadId:t,type:37,flag:1,xsrf:(0,c.w$)(c.$W.xsrf)}),[2,this.networkRequestService.instance.post(p,e)]}))}))},t=(0,r.__decorate)([(0,r.__param)(0,a._),(0,r.__metadata)("design:paramtypes",[Object])],t)}(),l=n(99181),h=function(){function t(){this.templateRepository=new f(new o.L)}return t.prototype.init=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return[2]}))}))},t.prototype.addToMyTemplate=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,this.templateRepository.addToMyTemplate(t)]}))}))},t.prototype.templateDetail=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,this.templateRepository.templateDetail(t)]}))}))},t.prototype.setTipFlag=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,this.templateRepository.setTipFlag(t)]}))}))},(0,r.__decorate)([(0,l.u)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"init",null),(0,r.__decorate)([(0,i.Hh)(),(0,i.bj)(),(0,i.w1)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"addToMyTemplate",null),(0,r.__decorate)([(0,i.Hh)(),(0,i.bj)(),(0,i.w1)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"templateDetail",null),(0,r.__decorate)([(0,i.Hh)(),(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"setTipFlag",null),t}()},56795:function(t,e,n){n.d(e,{v:function(){return r}});var r=(0,n(66624).yh)("IDocMetaDomainService")},37595:function(t,e,n){n.d(e,{L:function(){return F}});var r=n(85556),i=n(16740),o=n(51145),a=n(92978),s=n(94404),c=n(33661),u=n(90304),d=n(46163),_=n(73154),p=n(13775),f="".concat(p.Hf,"/cgi-bin/online_docs/doc_changetitle"),l="".concat(p.Hf,"/cgi-bin/online_docs/doc_collect"),h="".concat(p.Hf,"/cgi-bin/online_docs/doc_info"),g="".concat(p.Hf,"/dop-api/drive/data/get"),v="".concat(p.Hf,"/cgi/gateway/preload"),m=function(){function t(){}return t.prototype.updateTitle=function(t,e,n,i){return(0,r.__awaiter)(this,void 0,void 0,(function(){var o,a;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return o={pad_id:i,domain_id:n,xsrf:"".concat((0,d.w$)(d.$W.xsrf)),version:2,auto_change:e?1:0,title:encodeURIComponent(t)},a=(0,_.At)(f,o),[4,u.networkRequest.post(a)];case 1:return[2,r.sent()]}}))}))},t.prototype.fetchCollectedState=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,i;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return n={domain_id:t,pad_id:e,xsrf:"".concat((0,d.w$)(d.$W.xsrf)),t:(new Date).getTime()},i=(0,_.At)(l,n),[4,u.networkRequest.get(i)];case 1:return[2,r.sent()]}}))}))},t.prototype.changeCollectedState=function(t,e,n){return(0,r.__awaiter)(this,void 0,void 0,(function(){var i;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return i={domain_id:t,pad_id:e,is_cancel:n?0:1,xsrf:"".concat((0,d.w$)(d.$W.xsrf))},[4,u.networkRequest.post(l,i)];case 1:return[2,r.sent()]}}))}))},t.prototype.fetchDocInfo=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,i;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return n={domainId:t,localPadId:e,xsrf:"".concat((0,d.w$)(d.$W.xsrf))},i=(0,_.At)(h,n),[4,u.networkRequest.get(i)];case 1:return[2,r.sent()]}}))}))},t.prototype.fetchDocMetaInfoData=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return e={id:t,xsrf:"".concat((0,d.w$)(d.$W.xsrf))},n=(0,_.At)(g,e),[4,u.networkRequest.get(n)];case 1:return[2,r.sent()]}}))}))},t.prototype.updateOfficialAuthInfo=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,i;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return n={id:t,type:e,command:1,xsrf:"".concat((0,d.w$)(d.$W.xsrf))},i=(0,_.At)(v,n),[4,u.networkRequest.get(i)];case 1:return[2,r.sent()]}}))}))},t.prototype.getOwnerVipInfo=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return n={file_id:t,get_all:e},[4,u.networkRequest.post("/api/personalize/owner/viplevel",n)];case 1:return[2,r.sent()]}}))}))},(0,r.__decorate)([(0,i.Vo)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String,Boolean]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"getOwnerVipInfo",null),t}(),y=n(44225),w=function(t){function e(e){var n=t.call(this)||this;return n.ownerId="",n.ownerAppid="",n.ownerNick="",n.ownerAvatar="",n.officialAuthInfo={avatar:"",credential:"",introduction:"",nick:"",principal:""},n.vipLevel=1,n.vipInfo=new a.S({}),n.jsonObj2Class(e),n}return(0,r.__extends)(e,t),e}(y.K),I=function(t){function e(e){var n=t.call(this)||this;return n.docStatus=0,n.domainId="",n.padId="",n.padType="",n.type=0,n.shareLink="",n.lastModifyTime=0,n.lastModifyUser="",n.relative=[],n.jsonObj2Class(e),n}return(0,r.__extends)(e,t),Object.defineProperty(e.prototype,"globalPadId",{get:function(){return(0,c.B8)(this.domainId,this.padId)},enumerable:!1,configurable:!0}),e}(y.K),b=function(t){function e(e){var n=t.call(this)||this;return n.title="",n.isUserChangeTitle=!1,n.jsonObj2Class(e),n}return(0,r.__extends)(e,t),e}(y.K),S=n(36023),A=function(t){function e(e){var n=t.call(this)||this;return n.creatorId="",n.createTime=0,n.creatorNick="",n.creatorDomain="",n.isCreator=!1,n.creatorCorpId="",n.creatorCorpName="",n.jsonObj2Class(e),n}return(0,r.__extends)(e,t),e}(y.K),C=n(4646),E=function(t){function e(e){var n=t.call(this)||this;return n.isCreator=!1,n.isAdmin=!1,n.isOwner=!1,n.isViewer=!1,n.jsonObj2Class(e),n}return(0,r.__extends)(e,t),e}(y.K),R=12e3,M=12e3,O=function(t){function e(e){var n=t.call(this,e)||this;return n.createInfo=new A({}),n.padInfo=new I({}),n.ownerInfo=new w({}),n.userAuthInfo=new E({}),n.titleInfo=new b({}),n.hostFileInfo=null,n.onTitleDidChangeEmitter=new S.Emitter,n.onhandleNoticeDeletedEmitter=new S.Emitter,n.onDocStatusChangedEmitter=new S.Emitter,n.onOfficialAuthInfoChangeEmitter=new S.Emitter,n.docMetaRepository=new m,n.onTitleDidChange=n.onTitleDidChangeEmitter.event,n.onhandleNoticeDeleted=n.onhandleNoticeDeletedEmitter.event,n.onDocStatusChanged=n.onDocStatusChangedEmitter.event,n.onOfficialAuthInfoChange=n.onOfficialAuthInfoChangeEmitter.event,n}return(0,r.__extends)(e,t),e.prototype.updateTitle=function(t,e){var n,i,o;return(0,r.__awaiter)(this,void 0,void 0,(function(){var a,s;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return a=(null===(n=this.hostFileInfo)||void 0===n?void 0:n.fileMeta.fileId)||(null===(i=this.padInfo)||void 0===i?void 0:i.padId),[4,this.docMetaRepository.updateTitle(t,e,null===(o=this.padInfo)||void 0===o?void 0:o.domainId,a)];case 1:return s=r.sent(),parseInt(s.data.retcode,10)!==R&&parseInt(s.data.cgicode,10)!==M&&this.titleInfo&&(this.titleInfo.title=t,this.onTitleDidChangeEmitter.fire({newTitle:t})),[2,s]}}))}))},e.prototype.handleNoticeDeleted=function(){this.padInfo.docStatus=C.d.docStatusDelete,this.onhandleNoticeDeletedEmitter.fire(void 0)},e.prototype.handleNoticeTitleChanged=function(t){this.titleInfo.title=t,this.onTitleDidChangeEmitter.fire({newTitle:t})},e.prototype.updateOfficialAuthInfo=function(t){var e;return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,i;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.docMetaRepository.updateOfficialAuthInfo(t,null===(e=this.padInfo)||void 0===e?void 0:e.padType)];case 1:return n=r.sent(),i=n.data.data.clientVars.docInfo.ownerInfo.officialAuthInfo,this.ownerInfo.officialAuthInfo=i,this.onOfficialAuthInfoChangeEmitter.fire({officialAuthInfo:i}),[2,n]}}))}))},e.prototype.changeDocStatus=function(t){this.padInfo.docStatus=t,t===C.d.docStatusDelete&&this.onhandleNoticeDeletedEmitter.fire(void 0),this.onDocStatusChangedEmitter.fire(void 0)},e.prototype.fetchCollectedState=function(){var t,e;return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.docMetaRepository.fetchCollectedState(null===(t=this.padInfo)||void 0===t?void 0:t.domainId,null===(e=this.padInfo)||void 0===e?void 0:e.padId)];case 1:return[2,n.sent()]}}))}))},e.prototype.changeCollectedState=function(t){var e,n;return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.docMetaRepository.changeCollectedState(null===(e=this.padInfo)||void 0===e?void 0:e.domainId,null===(n=this.padInfo)||void 0===n?void 0:n.padId,t)];case 1:return[2,r.sent()]}}))}))},e.prototype.fetchDocMetaInfoData=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.docMetaRepository.fetchDocMetaInfoData(t)];case 1:return[2,e.sent()]}}))}))},e.prototype.getOwnerVipInfo=function(t,e){return void 0===e&&(e=!1),(0,r.__awaiter)(this,void 0,void 0,(function(){var n,i,s,u,d,_;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.docMetaRepository.getOwnerVipInfo(t,e)];case 1:return n=r.sent(),(i=(0,o.fq)(n,!0)).resData&&(s=i.resData.data.result||{},u=s.vipLevel,d=s.vipInfo,_=(0,c.KV)(d,{}),this.ownerInfo.vipLevel=u,this.ownerInfo.vipInfo=new a.S(_)),[2,i]}}))}))},(0,r.__decorate)([(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String,Boolean]),(0,r.__metadata)("design:returntype",Promise)],e.prototype,"updateTitle",null),(0,r.__decorate)([(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],e.prototype,"updateOfficialAuthInfo",null),(0,r.__decorate)([(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],e.prototype,"fetchCollectedState",null),(0,r.__decorate)([(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Boolean]),(0,r.__metadata)("design:returntype",Promise)],e.prototype,"changeCollectedState",null),(0,r.__decorate)([(0,i.Hh)(),(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],e.prototype,"fetchDocMetaInfoData",null),e}(s.J),D=n(37801),k=new(n(54464).Yd)("DocHostFileInfo").use("console");function L(t){var e,n;return(0,r.__awaiter)(this,void 0,void 0,(function(){var i;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,(new D.R).fetchFileInfo(t)];case 1:return i=r.sent(),[2,null===(n=null===(e=null==i?void 0:i.resData)||void 0===e?void 0:e.data)||void 0===n?void 0:n.result]}}))}))}var P=function(t){function e(e){var n=t.call(this)||this;return n.mimeType="",n.fileMeta={ext:"",fileId:""},n.mimeType=e.mimeType,n.fileMeta=e.fileMeta,n}return(0,r.__extends)(e,t),e.initFromDocId=function(t){var n;return(0,r.__awaiter)(this,void 0,void 0,(function(){var i;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,L(t)];case 1:return i=r.sent(),(null===(n=null==i?void 0:i.hostFileInfo)||void 0===n?void 0:n.ext)?[2,new e({mimeType:i.mimeType,fileMeta:i.hostFileInfo})]:(k.info(" hostFileInfo"),[2,null])}}))}))},e}(y.K),T=n(99181),x=function(t){function e(e){var n=t.call(this)||this;return n.background={},n.mode=0,n.titleColor={},n.isExpire=!1,n.jsonObj2Class(e),n}return(0,r.__extends)(e,t),e}(y.K),F=function(){function t(){this.hasInitializedByBasicClientVars=!1,this.docMetaEntity=new O("MainDocMetaEntity"),(null===window||void 0===window?void 0:window.basicClientVars)&&this.initWithBasicClientVars(window.basicClientVars)}return t.prototype.updateWithClientVars=function(t){this.hasInitializedByBasicClientVars||(this.docMetaEntity.createInfo=new A((0,r.__assign)((0,r.__assign)({},t),{createTime:t.metaCreateTime})),this.docMetaEntity.ownerInfo=new w(t),this.docMetaEntity.padInfo=new I(t),this.docMetaEntity.titleInfo=new b(t),this.docMetaEntity.userAuthInfo=new E(t))},t.prototype.init=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n,i,o;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return e=t.docId,[4,this.docMetaEntity.fetchDocMetaInfoData(e)];case 1:return n=r.sent().resData,i=null==n?void 0:n.data.data,this.docMetaEntity.createInfo=new A({isCreator:i.isCreator,creatorDomain:i.domainId,creatorId:i.creatorId,creatorCorpId:i.creatorCorpId,creatorCorpName:i.creatorCorpName}),this.docMetaEntity.padInfo=new I({domainId:i.domainId,padId:i.localPadId,padType:i.padType,relative:i.relative||[],docStatus:i.docStatus}),this.docMetaEntity.titleInfo=new b({title:i.title,isUserChangeTitle:i.isUserChangeTitle}),this.docMetaEntity.userAuthInfo=new E({isCreator:i.isCreator,isOwner:i.isOwner,isAdmin:i.isAdmin}),o=this.docMetaEntity,[4,P.initFromDocId(e)];case 2:return o.hostFileInfo=r.sent(),[2]}}))}))},t.prototype.initWithBasicClientVars=function(t){this.updateCreateInfoByBasicClientVars(t),this.updateOwnerAndAuthInfoByBasicClientVars(t),this.updatePadInfoByBasicClientVars(t),this.updateTitleInfoByBasicClientVars(t),this.updateCollaborationInfoByBasicClientVars(t),this.updatePersonalizeInfoByBasicClientVars(t),this.updateHostFileInfoByBasicClientVars(t),this.hasInitializedByBasicClientVars=!0},t.prototype.updatePersonalizeInfoByBasicClientVars=function(t){var e;this.docMetaEntity.personalizeInfo=new x(null===(e=t.docInfo)||void 0===e?void 0:e.personalizeInfo)},t.prototype.updateCollaborationInfoByBasicClientVars=function(t){var e;this.docMetaEntity.collaborationFlag=null===(e=t.docInfo)||void 0===e?void 0:e.collaborationFlag},t.prototype.updateCreateInfoByBasicClientVars=function(t){var e,n,r,i,o,a,s,c,u,d,_,p,f;this.docMetaEntity.createInfo=new A({isCreator:null===(e=t.docInfo)||void 0===e?void 0:e.isCreator,creatorDomain:null===(r=null===(n=t.docInfo)||void 0===n?void 0:n.padInfo)||void 0===r?void 0:r.domainId,creatorNick:null===(o=null===(i=t.docInfo)||void 0===i?void 0:i.createInfo)||void 0===o?void 0:o.creatorNick,createTime:null===(s=null===(a=t.docInfo)||void 0===a?void 0:a.createInfo)||void 0===s?void 0:s.createTime,creatorId:null===(u=null===(c=t.docInfo)||void 0===c?void 0:c.createInfo)||void 0===u?void 0:u.creatorId,creatorCorpId:null===(_=null===(d=t.docInfo)||void 0===d?void 0:d.createInfo)||void 0===_?void 0:_.creatorCorpId,creatorCorpName:null===(f=null===(p=t.docInfo)||void 0===p?void 0:p.createInfo)||void 0===f?void 0:f.creatorCorpName})},t.prototype.updateOwnerAndAuthInfoByBasicClientVars=function(t){var e,n,r,i,o;this.docMetaEntity.ownerInfo=new w(null===(e=t.docInfo)||void 0===e?void 0:e.ownerInfo),this.docMetaEntity.userAuthInfo=new E({isCreator:null===(n=t.docInfo)||void 0===n?void 0:n.isCreator,isOwner:null===(r=t.docInfo)||void 0===r?void 0:r.isOwner,isAdmin:null===(i=t.docInfo)||void 0===i?void 0:i.isAdmin,isViewer:1===(null===(o=t.authInfo)||void 0===o?void 0:o.privilegeFlag)})},t.prototype.updatePadInfoByBasicClientVars=function(t){var e,n,r,i,o,a,s,c,u,d,_,p;this.docMetaEntity.padInfo=new I({domainId:null===(n=null===(e=t.docInfo)||void 0===e?void 0:e.padInfo)||void 0===n?void 0:n.domainId,padId:null===(i=null===(r=t.docInfo)||void 0===r?void 0:r.padInfo)||void 0===i?void 0:i.padId,padType:null===(a=null===(o=t.docInfo)||void 0===o?void 0:o.padInfo)||void 0===a?void 0:a.padType,relative:null===(c=null===(s=t.docInfo)||void 0===s?void 0:s.padInfo)||void 0===c?void 0:c.relative,docStatus:null===(u=t.docInfo)||void 0===u?void 0:u.docStatus,shareLink:null===(d=t.docInfo)||void 0===d?void 0:d.shareLink,lastModifyTime:null===(_=t.docInfo)||void 0===_?void 0:_.lastModifyTime,lastModifyUser:null===(p=t.docInfo)||void 0===p?void 0:p.lastModifyUser})},t.prototype.updateTitleInfoByBasicClientVars=function(t){var e,n,r;this.docMetaEntity.titleInfo=new b({title:null===(n=null===(e=t.docInfo)||void 0===e?void 0:e.padInfo)||void 0===n?void 0:n.padTitle,isUserChangeTitle:null===(r=t.docInfo)||void 0===r?void 0:r.isUserChangeTitle})},t.prototype.updateHostFileInfoByBasicClientVars=function(t){var e,n;(null===(e=null==t?void 0:t.docInfo)||void 0===e?void 0:e.hostFileInfo)&&(this.docMetaEntity.hostFileInfo=new P(null===(n=null==t?void 0:t.docInfo)||void 0===n?void 0:n.hostFileInfo))},(0,r.__decorate)([(0,T.u)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"init",null),(0,r.__decorate)([(0,i.aU)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"initWithBasicClientVars",null),t}()},4646:function(t,e,n){var r;n.d(e,{d:function(){return r}}),function(t){t[t.docStatusNormal=0]="docStatusNormal",t[t.docStatusDelete=1]="docStatusDelete",t[t.docStatusTrash=2]="docStatusTrash",t[t.docStatusHidden=3]="docStatusHidden",t[t.docStatusTrans=4]="docStatusTrans",t[t.docStatusImport=5]="docStatusImport",t[t.docStatusChecking=6]="docStatusChecking",t[t.docStatusForbidden=7]="docStatusForbidden",t[t.docStatusImportFailed=8]="docStatusImportFailed",t[t.docStatusCopy=9]="docStatusCopy",t[t.docStatusCopyFailed=10]="docStatusCopyFailed",t[t.docStatusPrepare=11]="docStatusPrepare",t[t.docStatusHiddenUntilModify=12]="docStatusHiddenUntilModify",t[t.docStatusFileUploading=13]="docStatusFileUploading"}(r||(r={}))},8144:function(t,e,n){var r,i;n.d(e,{B:function(){return i},D:function(){return r}}),function(t){t[t.NORMAL=0]="NORMAL",t[t.SECURITY_STRIKED=1]="SECURITY_STRIKED",t[t.APPROVED=2]="APPROVED"}(r||(r={})),function(t){t.DOC="drive-doc",t.SHEET="drive-sheet",t.TEXT="drive-text",t.SLIDE="drive-slide",t.PDF="drive-pdf",t.UNKNOWN="drive-unknown"}(i||(i={}))},25465:function(t,e,n){n.d(e,{HK:function(){return o},SS:function(){return r},dz:function(){return s},t3:function(){return c},uu:function(){return i},vB:function(){return a}});var r="/v2/drive/file/desc",i="/v2/drive/fileInfo",o="/v2/drive/docsPreviewURL",a="/v2/drive/preview/query",s="/v2/drive/downloadURL",c="/v2/file/clone"},37801:function(t,e,n){n.d(e,{R:function(){return d}});var r=n(85556),i=n(16740),o=n(90304),a=n(46163),s=n(49098),c=n.n(s),u=n(25465),d=function(){function t(){}return t.prototype.fetchFileInfo=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,i,s;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return n={xsrf:(0,a.w$)(a.$W.xsrf)},i=c().stringify(n),s={file_id:t,add_recent:e},[4,o.networkRequest.post("".concat(u.uu,"?").concat(i),s)];case 1:return[2,r.sent()]}}))}))},t.prototype.fetchPreviewInfo=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n,i,s,d,_,p,f,l,h,g,v,m,y;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return e=t.fileId,n=t.addBrowseRecord,i=void 0===n||n,s=t.previewAttribute,d=s.srcType,_=s.dstType,p=s.page,f=s.sheet,l=s.showComment,h=s.quality,g=s.scale,v={xsrf:(0,a.w$)(a.$W.xsrf)},m=c().stringify(v),y={file_id:e,add_browse_record:i,preview_attr:{page:p,sheet:f,quality:h,scale:g,src_type:d,ddst_type:_,show_comment:l}},[4,o.networkRequest.post("".concat(u.HK,"?").concat(m),y)];case 1:return[2,r.sent()]}}))}))},t.prototype.fetchPreviewQuery=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n,i,s,d;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return e=t.fileId,n=t.shouldRetry,i={xsrf:(0,a.w$)(a.$W.xsrf)},s=c().stringify(i),d={file_id:e},n&&(d.should_retry=!0),[4,o.networkRequest.post("".concat(u.vB,"?").concat(s),d)];case 1:return[2,r.sent()]}}))}))},t.prototype.fetchDownloadInfo=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n,i;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return e={xsrf:(0,a.w$)(a.$W.xsrf)},n=c().stringify(e),i={file_id:t},[4,o.networkRequest.post("".concat(u.dz,"?").concat(n),i)];case 1:return[2,r.sent()]}}))}))},t.prototype.fetchCopyInfo=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n,i;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return e={xsrf:(0,a.w$)(a.$W.xsrf)},n=c().stringify(e),i={file_id:t},[4,o.networkRequest.post("".concat(u.t3,"?").concat(n),i)];case 1:return[2,r.sent()]}}))}))},(0,r.__decorate)([(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String,Boolean]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"fetchFileInfo",null),(0,r.__decorate)([(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"fetchPreviewInfo",null),(0,r.__decorate)([(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"fetchDownloadInfo",null),(0,r.__decorate)([(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"fetchCopyInfo",null),t}()},34479:function(t,e,n){n.d(e,{h:function(){return I}});var r,i=n(85556),o=n(99181),a=function(){function t(t){this.fileDescRepo=t}return t.prototype.init=function(t){Object.assign(this,t)},t.prototype.fetchFileDesc=function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return[2,this.fileDescRepo.fetchFileDesc(t)]}))}))},t.prototype.getFormattedFileSize=function(){var t=this.accurateSize;if(0===Number(t))return"0 B";var e=Math.floor(Math.log(t)/Math.log(1024));return"".concat(parseFloat((t/Math.pow(1024,e)).toPrecision(3))," ").concat(["B","KB","MB","GB","TB","PB","EB","ZB","YB"][e])},t}(),s=n(8144),c=((r={})[s.B.DOC]=/doc|dot|wps|wpt|docx|dotx|docm|dotm/,r[s.B.SHEET]=/xls|xlt|xlsx|xltx|csv|xlsb|xlsm|xltm|et|ett|ets/,r[s.B.TEXT]=/lrc|c|cpp|h|asm|s|java|asp|bat|bas|prg|cmd|rtf|txt|log|xml|htm|html/,r[s.B.SLIDE]=/pptx|ppt|pot|potx|pps|ppsx|dps|dpt|pptm|potm|ppsm/,r),u=/(doc|docx|xls|xlsx|txt|csv|ppt|pptx)$/i,d=function(){function t(t){this.fileMetaRepo=t}return t.prototype.init=function(t){Object.assign(this,t)},t.prototype.fetchFileInfo=function(t,e){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(n){return[2,this.fileMetaRepo.fetchFileInfo(t,e)]}))}))},t.prototype.fetchPreviewInfo=function(t){return void 0===t&&(t={}),(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return[2,this.fileMetaRepo.fetchPreviewInfo({fileId:this.fileId,addBrowseRecord:(null==t?void 0:t.addBrowseRecord)||!1,previewAttribute:(0,i.__assign)({srcType:this.ext},t.previewAttribute)})]}))}))},t.prototype.fetchPreviewQuery=function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return[2,this.fileMetaRepo.fetchPreviewQuery({fileId:this.fileId,shouldRetry:t})]}))}))},t.prototype.fetchDownloadInfo=function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return[2,this.fileMetaRepo.fetchDownloadInfo(t)]}))}))},t.prototype.fetchCopyInfo=function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return[2,this.fileMetaRepo.fetchCopyInfo(t)]}))}))},t.prototype.getDrivePadType=function(){var t,e,n=this.ext,r=Object.keys(c);try{for(var o=(0,i.__values)(r),a=o.next();!a.done;a=o.next()){var u=a.value;if(c[u].test(n))return u}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return s.B.DOC},t.prototype.canBeConvertedToOnlineDocs=function(){var t=this.ext;return u.test(t)},t.prototype.isSecurityStriked=function(){return this.auditStatus===s.D.SECURITY_STRIKED},t.prototype.getFormattedFileSize=function(){var t=this.size;if(0===Number(t))return"0 B";var e=Math.floor(Math.log(t)/Math.log(1024));return"".concat(parseFloat((t/Math.pow(1024,e)).toPrecision(3))," ").concat(["B","KB","MB","GB","TB","PB","EB","ZB","YB"][e])},t}(),_=n(16740),p=n(33661),f=n(90304),l=n(49098),h=n.n(l),g=n(25465),v=function(){function t(){}return t.prototype.fetchFileDesc=function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return e={xsrf:(0,p.Qj)()},n=h().stringify(e),[4,f.networkRequest.post("".concat(g.SS,"?").concat(n),{file_id:t})];case 1:return[2,r.sent()]}}))}))},(0,i.__decorate)([(0,_.bj)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[String]),(0,i.__metadata)("design:returntype",Promise)],t.prototype,"fetchFileDesc",null),t}(),m=n(37801),y=n(46163),w=function(){function t(){}return t.prototype.postImportFile=function(e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return n=(0,p.pT)({folder_id:e.folderId,operation_id:e.operationId,cos_file_key:e.cosFileKey,drive_file_id:e.driveFileId,password:e.password,appid:e.appid,filename:e.filename,verify_token:e.verifyToken,async:e.async,platform:e.platform,preview:e.preview,delete_drive_file:e.deleteDriveFile,bind_scene:e.bindScene,scene_type:e.sceneType,scene_id:e.sceneId,scene_file_id:e.sceneFileId,appSource:e.appSource,createSource:e.createSource}),r="".concat(t.cgiPaths.IMPORT_FILE,"?xsrf=").concat((0,y.w$)(y.$W.xsrf)),[4,f.networkRequest.post(r,n)];case 1:return[2,i.sent()]}}))}))},t.prototype.queryImportProgress=function(e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return n=(0,p.kI)(e),r="".concat(t.cgiPaths.QUERY_IMPORT_PROGRESS,"?xsrf=").concat((0,y.w$)(y.$W.xsrf)),[4,f.networkRequest.post(r,n)];case 1:return[2,i.sent()]}}))}))},t.cgiPaths={IMPORT_FILE:"/v1/import/file",QUERY_IMPORT_PROGRESS:"/v1/import/queryImportProgress"},(0,i.__decorate)([(0,_.bj)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[Object]),(0,i.__metadata)("design:returntype",Promise)],t.prototype,"postImportFile",null),t}(),I=function(){function t(){this.fileDescRepo=new v,this.fileMetaRepo=new m.R,this.fileOperationRepo=new w,this.fileDescEntity=new a(this.fileDescRepo),this.fileMetaEntity=new d(this.fileMetaRepo)}return t.prototype.init=function(t){var e,n;return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,o,a,s;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.fileMetaEntity.fetchFileInfo(t.docId,t.addRecent)];case 1:if(r=i.sent(),!(null===(e=r.resData)||void 0===e?void 0:e.data.result.fileMeta.fileId))throw new Error("get file id error.");return[4,this.fileDescEntity.fetchFileDesc(r.resData.data.result.fileMeta.fileId)];case 2:if(o=i.sent(),!(null===(n=o.resData)||void 0===n?void 0:n.data.size))throw new Error("get file size error.");return a=r.resData.data.result.fileMeta,s=o.resData.data.size,this.fileMetaEntity.init(a),this.fileDescEntity.init({accurateSize:s}),[2]}}))}))},(0,i.__decorate)([(0,o.u)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[Object]),(0,i.__metadata)("design:returntype",Promise)],t.prototype,"init",null),t}()},1382:function(t,e,n){n.d(e,{U:function(){return r}});var r=(0,n(66624).yh)("IFileInfoDomainService")},91952:function(t,e,n){n.r(e),n.d(e,{ACCOUNT_TYPE:function(){return _.Q},AUTH_ROLE:function(){return S.V},AccountDomainService:function(){return f.D},AtMessageDomainService:function(){return X.M},AuditStatus:function(){return nt.D},AuthDomainService:function(){return A.n},BASE_CGICODE:function(){return r},BASE_URL_API:function(){return o.d0},BASE_URL_CGI_GO:function(){return o.jo},BASE_URL_ONLINE_DOCS:function(){return o.HL},BASE_URL_SDC:function(){return o.aP},BASE_URL_V2:function(){return o.rW},BASE_URL_V3:function(){return o.yQ},BIND_TYPE:function(){return y.gz},CAN_EXTERNAL_APPLY:function(){return a},COLLECT_CANCEL_FLAG:function(){return c.nN},COMMENT_BOX_STATUS:function(){return I.ul},CORP_POLICY:function(){return s},CREATE_DOC_TYPE:function(){return c.pZ},CREATE_HUMTRANS_FALG:function(){return c.rg},CREATE_SOURCE_TYPE:function(){return c.uv},CollaborateDomainService:function(){return V.u},CorpVipLevel:function(){return y.vA},DOCS_HOST:function(){return o.RP},DOCUMENT_PRIVILEGE:function(){return I.e0},DOC_HOST:function(){return o.Hf},DOC_STATUS:function(){return x.d},DocMetaDomainService:function(){return k.L},DomainUpdater:function(){return B.d},DrivePadType:function(){return nt.B},ERenewalStatus:function(){return c.v2},EUserRenewalStatus:function(){return y.RM},EUserVipType:function(){return y.T0},EVipLevel:function(){return c.Dl},EVipStatus:function(){return y.gq},EnterpriseAccountDomainService:function(){return g.f},EnterpriseLikeDomainService:function(){return it.G},FOLDER_LIST_TYPE:function(){return c.Cy},FileDomainService:function(){return C.v},FileInfoDomainService:function(){return tt.h},FolderDomainService:function(){return R.i},FromDomin:function(){return m.zM},GET_RECOMMEND_FLAG:function(){return c.Cl},IAccountDomainService:function(){return p.b},IAtMessageDomainService:function(){return Z.B},IAuthDomainService:function(){return w.i},ICollaborateDomainService:function(){return $.U},ICollaborationFlag:function(){return b},IDocMetaDomainService:function(){return L.v},IDomainUpdater:function(){return W.e},IEnterpriseAccountDomainService:function(){return v.b},IFileDomainService:function(){return E.G},IFileInfoDomainService:function(){return et.U},IFolderDomainService:function(){return M.r},ILikeDomainService:function(){return ot.d},ILoginDomainService:function(){return l.C},ILogoutMessageType:function(){return K.p},IMessageDomainService:function(){return Q.x},INetworkRequestService:function(){return u._},INotificationDomainService:function(){return N.Y},INotifyScopeDomainService:function(){return z.Y},IShareDomainService:function(){return H.j},ITemplateDomainService:function(){return D.y},IUserInfoDomainService:function(){return U.m},IVipSuperStatus:function(){return y.pN},LOGINTYPE:function(){return _.R},LikeDomainService:function(){return rt.W},LoginDomainService:function(){return h.g},MessageDomainService:function(){return G.i},NOT_LOGIN_TINYID:function(){return y.Dr},NetworkRequestService:function(){return d.L},NotificationDomainService:function(){return F.e},NotifyScopeDomainService:function(){return Y.l},NotifyType:function(){return T},NotifyTypeFunc:function(){return P},POLICY:function(){return I.sX},PreviewQueryCodes:function(){return J},RETCODE:function(){return i},ShareDomainService:function(){return q.d},TemplateDomainService:function(){return O.Y},UType:function(){return m.Lq},UserInfoDomainService:function(){return j.$},UserType:function(){return m.FW},VipType:function(){return y.qu},WECOM_DOC_HOST:function(){return o.bd},officialType:function(){return y.n6}});var r,i,o=n(13775);!function(t){t[t.SUCCESS=0]="SUCCESS"}(r||(r={})),function(t){t[t.SUCCESS=0]="SUCCESS",t[t.NO_PERMISSION=10003]="NO_PERMISSION"}(i||(i={}));var a,s,c=n(20585),u=n(11268),d=n(76642),_=n(5448),p=n(11288),f=n(15846),l=n(94951),h=n(92579),g=n(91081),v=n(19814),m=n(2626),y=n(86753),w=n(4094),I=n(39870);!function(t){t[t.INVALID_NUM=0]="INVALID_NUM",t[t.CAN_APPLY=1]="CAN_APPLY",t[t.CANT_APPLY=2]="CANT_APPLY"}(a||(a={})),function(t){t[t.DENY=0]="DENY",t[t.WHITELIST=1]="WHITELIST",t[t.ALL_ONLY_READ=2]="ALL_ONLY_READ",t[t.ALL_ONLY_WRITE=3]="ALL_ONLY_WRITE",t[t.ALL_ONLY_EXECUTE=4]="ALL_ONLY_EXECUTE"}(s||(s={}));var b,S=n(75332),A=n(66215),C=n(65592),E=n(75378),R=n(56753),M=n(60914),O=n(12272),D=n(86622),k=n(37595),L=n(56795);!function(t){t[t.NOT_IN_COLLABORATION=0]="NOT_IN_COLLABORATION",t[t.IN_COLLABORATION=1]="IN_COLLABORATION"}(b||(b={}));var P,T,x=n(4646),F=n(38062),N=n(25101),j=n(65282),U=n(11297),q=n(4910),H=n(74805),B=n(95439),W=n(48715),V=n(42286),$=n(79895),G=n(26501),Q=n(27863),K=n(55303),Y=n(66165),z=n(41471);!function(t){t[t.set=1]="set",t[t.get=2]="get"}(P||(P={})),function(t){t[t.none=0]="none",t[t.allNotify=1]="allNotify",t[t.relatedToMe=2]="relatedToMe"}(T||(T={}));var J,X=n(34049),Z=n(23911),tt=n(34479),et=n(1382),nt=n(8144);!function(t){t[t.SUCCESS=0]="SUCCESS",t[t.NOT_FINISH=12973]="NOT_FINISH",t[t.ERROR=12974]="ERROR"}(J||(J={}));var rt=n(49712),it=n(43949),ot=n(58373)},43949:function(t,e,n){n.d(e,{G:function(){return s}});var r=n(85556),i=n(56795),o=n(11297),a=n(99181),s=function(){function t(t,e){this.docMetaDomain=t,this.userInfoDomain=e}return t.prototype.init=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return console.log("EnterpriseLikeDomainService ~ init ~ do nothing",t),[2]}))}))},(0,r.__decorate)([(0,a.u)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"init",null),t=(0,r.__decorate)([(0,r.__param)(0,i.v),(0,r.__param)(1,o.m),(0,r.__metadata)("design:paramtypes",[Object,Object])],t)}()},49712:function(t,e,n){n.d(e,{W:function(){return R}});var r,i,o,a,s,c,u=n(85556),d=n(11288),_=n(56795),p=n(11297),f=n(49790),l=n(99181),h=n(31072),g=n(36023),v=n(90304),m=n(46163),y=n(75789),w=n(86667);!function(t){t.NO_VIP_USER="novip_user",t.VIP_USER="vip_user",t.SUPER_VIP_USER="svip_user"}(r||(r={})),function(t){t.OPERATION_NAME="doc_vip_like",t.MODULE="switch"}(i||(i={})),function(t){t.ON="on",t.OFF="off"}(o||(o={})),function(t){t.PC_TITLEBAR="pc_titlebar",t.MOBILE_TITLEBAR="mobile_titlebar"}(a||(a={})),function(t){t.DOC_VIP_LIKE_SWITCH_ON="doc_vip_like-switch-on",t.DOC_VIP_LIKE_SWITCH_OFF="doc_vip_like-switch-off"}(s||(s={})),function(t){t[t.VIP_OFF=1]="VIP_OFF",t[t.VIP_ON=2]="VIP_ON"}(c||(c={}));var I=new w.UserAgent,b=function(t){return"".concat(t).concat(~t.indexOf("?")?"&":"?","xsrf=").concat((0,m.w$)(m.$W.xsrf))},S=function(){function t(t,e,n){this.docMetaDomain=t,this.userInfoDomainService=e,this.accountDomainService=n}return t.prototype.like=function(t,e){return(0,u.__awaiter)(this,void 0,void 0,(function(){var n;return(0,u.__generator)(this,(function(r){return n={file_id:t,icon_id:e},[2,v.networkRequest.post(b("/cgi-bin/like/like"),n)]}))}))},t.prototype.getLikeIconList=function(t){return(0,u.__awaiter)(this,void 0,void 0,(function(){var e;return(0,u.__generator)(this,(function(n){return e={offset:0,limit:100},t&&(e={offset:0,limit:100,file_id:t}),[2,v.networkRequest.post(b("/cgi-bin/like/icon/list"),e)]}))}))},t.prototype.setLikeEnable=function(t,e){return(0,u.__awaiter)(this,void 0,void 0,(function(){var n,d,_,p,f;return(0,u.__generator)(this,(function(u){return n=this.accountDomainService.accountAggregate.vipInfo,d=n.vip,_=n.svip,p=_.status===c.VIP_ON?r.SUPER_VIP_USER:r.VIP_USER,(0,y.H)({opername:i.OPERATION_NAME,module:i.MODULE,action:e?o.ON:o.OFF,eventcode:e?s.DOC_VIP_LIKE_SWITCH_ON:s.DOC_VIP_LIKE_SWITCH_OFF,ver5:d.status===c.VIP_ON?p:r.NO_VIP_USER,ver8:I.isPC?a.PC_TITLEBAR:a.MOBILE_TITLEBAR}),f={enable:e,file_id:t},[2,v.networkRequest.post(b("/cgi-bin/like/enable/set"),f)]}))}))},t.prototype.isBanned=function(t){return(0,u.__awaiter)(this,void 0,void 0,(function(){var e;return(0,u.__generator)(this,(function(n){return e={file_id:t},[2,v.networkRequest.post(b("/cgi-bin/like/disabled"),e)]}))}))},t.prototype.getLikeRecordCount=function(t){return(0,u.__awaiter)(this,void 0,void 0,(function(){var e;return(0,u.__generator)(this,(function(n){return e={file_id:t},[2,v.networkRequest.post(b("/cgi-bin/like/record/count"),e)]}))}))},t.prototype.getLikeRecordList=function(t,e,n){return(0,u.__awaiter)(this,void 0,void 0,(function(){var r;return(0,u.__generator)(this,(function(i){return r={file_id:t,start_record_id:e,limit:n,is_desc:!0},[2,v.networkRequest.post(b("/cgi-bin/like/record/list"),r)]}))}))},t=(0,u.__decorate)([(0,u.__param)(0,_.v),(0,u.__param)(1,p.m),(0,u.__param)(2,d.b),(0,u.__metadata)("design:paramtypes",[Object,Object,Object])],t)}(),A=function(){function t(){}return t.prototype.getUserMarkName=function(t,e){return(0,u.__awaiter)(this,void 0,void 0,(function(){return(0,u.__generator)(this,(function(n){return[2,v.networkRequest.post("/sdc/getusermarkname",{domainId:"300000000",localPadId:t,uids:"[".concat(e.join(","),"]"),xsrf:(0,m.ej)("TOK")||""})]}))}))},t}(),C=function(){function t(){}return t.prototype.getOwnerVipLevel=function(t){return(0,u.__awaiter)(this,void 0,void 0,(function(){return(0,u.__generator)(this,(function(e){return[2,v.networkRequest.post("/api/personalize/owner/viplevel",{file_id:t})]}))}))},t}(),E=function(){function t(t,e,n){this.docMetaDomain=t,this.userInfoDomain=e,this.accountDomainService=n,this.cacheUserMark={},this.likeRepo=new S(t,e,n),this.userMarkRepo=new A,this.ownerVipRepo=new C,this.onLikeDataChangedEmitter=new g.Emitter,this.onLikeDataChangedEvent=this.onLikeDataChangedEmitter.event}return t.prototype.init=function(t){this.fileId=t.fileId,this.ownerId=t.ownerId,this.tinyId=t.tinyId},t.prototype.initWithBasicClientVars=function(t){var e,n,r,i,o,a,s;this.fileId=null!==(r=null===(n=null===(e=t.docInfo)||void 0===e?void 0:e.padInfo)||void 0===n?void 0:n.padId)&&void 0!==r?r:"",this.ownerId=null!==(a=null===(o=null===(i=t.docInfo)||void 0===i?void 0:i.ownerInfo)||void 0===o?void 0:o.ownerId)&&void 0!==a?a:"",this.tinyId=null!==(s=t.userInfo.tinyId)&&void 0!==s?s:""},Object.defineProperty(t.prototype,"onLikeDataChanged",{get:function(){return this.onLikeDataChangedEvent},enumerable:!1,configurable:!0}),t.prototype.like=function(t){return(0,u.__awaiter)(this,void 0,void 0,(function(){return(0,u.__generator)(this,(function(e){return[2,this.likeRepo.like(this.fileId,t)]}))}))},t.prototype.getLikeIconList=function(t){return(0,u.__awaiter)(this,void 0,void 0,(function(){return(0,u.__generator)(this,(function(e){return[2,this.likeRepo.getLikeIconList(t)]}))}))},t.prototype.getLikeRecordCount=function(){return(0,u.__awaiter)(this,void 0,void 0,(function(){return(0,u.__generator)(this,(function(t){return[2,this.likeRepo.getLikeRecordCount(this.fileId)]}))}))},t.prototype.getLikeRecordList=function(t,e){return void 0===t&&(t=-1),void 0===e&&(e=50),(0,u.__awaiter)(this,void 0,void 0,(function(){return(0,u.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.likeRepo.getLikeRecordList(this.fileId,t,e)];case 1:return[2,n.sent()]}}))}))},t.prototype.handleRealTimeLikeMessage=function(t){return(0,u.__awaiter)(this,void 0,void 0,(function(){var e=this;return(0,u.__generator)(this,(function(n){return t.forEach((function(t){return(0,u.__awaiter)(e,void 0,void 0,(function(){var e,n,r,i,o,a,s,c,d;return(0,u.__generator)(this,(function(_){switch(_.label){case 0:return e=t.body.notice,n=e.type,r=e.payload,"like"!==n?[2,console.error("unknown like domain ws message type:",n)]:(i=JSON.parse(r.like_record),o=null!==(s=i.liker_uid)&&void 0!==s?s:"",[4,this.getUserMarkName([o])]);case 1:return a=_.sent(),this.onLikeDataChangedEmitter.fire({newCount:r.count,newRecord:(0,u.__assign)((0,u.__assign)({},i),{liker_avatar:null===(c=a[o])||void 0===c?void 0:c.userPic,liker_nick:null===(d=a[o])||void 0===d?void 0:d.markName})}),[2]}}))}))})),[2]}))}))},t.prototype.setLikeEnable=function(t){var e;return(0,u.__awaiter)(this,void 0,void 0,(function(){var n;return(0,u.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.likeRepo.setLikeEnable(this.fileId,t)];case 1:if(n=r.sent(),0!==(null===(e=n.data)||void 0===e?void 0:e.retcode))throw Error("/cgi-bin/like/enable/set Request failed");return[2,n.data.result]}}))}))},t.prototype.isLikeEnable=function(t){return(0,u.__awaiter)(this,void 0,void 0,(function(){return(0,u.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.isBannedByFile()];case 1:return e.sent()?[2,!1]:this.isInOwnerIdTailHash(t)?[2,!0]:[2,this.isVipDoc()]}}))}))},t.prototype.isBannedByFile=function(){var t,e;return(0,u.__awaiter)(this,void 0,void 0,(function(){var n;return(0,u.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.likeRepo.isBanned(this.fileId)];case 1:return n=r.sent(),[2,null!==(e=null===(t=n.data.result)||void 0===t?void 0:t.is_disabled)&&void 0!==e&&e];case 2:return r.sent(),[2,!0];case 3:return[2]}}))}))},t.prototype.isVipDoc=function(){var t,e;return(0,u.__awaiter)(this,void 0,void 0,(function(){var n;return(0,u.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.ownerVipRepo.getOwnerVipLevel(this.fileId)];case 1:return n=r.sent(),(null===(t=n.data.result)||void 0===t?void 0:t.vip_level)?[2,(null===(e=n.data.result)||void 0===e?void 0:e.vip_level)>1]:[3,3];case 2:return r.sent(),[3,3];case 3:return[2,!1]}}))}))},t.prototype.isInOwnerIdTailHash=function(t){return!(!t||!this.ownerId)&&parseInt(this.ownerId.slice(-2),10)%100<t},t.prototype.getUserMarkName=function(t){var e,n;return(0,u.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a=this;return(0,u.__generator)(this,(function(s){switch(s.label){case 0:return r={},i=[],t.forEach((function(t){a.cacheUserMark[t]?r[t]=a.cacheUserMark[t]:i.push(t)})),i.length?[4,this.userMarkRepo.getUserMarkName(this.fileId,i)]:[3,2];case 1:o=s.sent(),null===(n=null===(e=o.data.result)||void 0===e?void 0:e.rsp)||void 0===n||n.forEach((function(t){a.cacheUserMark[t.reqUid]=t,r[t.reqUid]=t})),s.label=2;case 2:return[2,r]}}))}))},t=(0,u.__decorate)([(0,u.__param)(0,_.v),(0,u.__param)(1,p.m),(0,u.__param)(2,d.b),(0,u.__metadata)("design:paramtypes",[Object,Object,Object])],t)}(),R=function(){function t(t,e,n){var r;if(this.docMetaDomain=t,this.userInfoDomain=e,this.accountDomainService=n,this.likeEntity=new E(t,e,n),window.basicClientVars)this.likeEntity.initWithBasicClientVars(window.basicClientVars);else{var i=(0,u.__read)(null!==(r=location.pathname.split("/"))&&void 0!==r?r:[],3),o=i[1],a=i[2];if(void 0!==f.DOCUMENT_TYPE_MAP[o]&&a){var s={docId:a,u:(0,h.getQuery)("u")};this.init(s)}}}return t.prototype.init=function(t){return(0,u.__awaiter)(this,void 0,void 0,(function(){return(0,u.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([this.docMetaDomain.init(t),this.userInfoDomain.init(t)])];case 1:return e.sent(),this.likeEntity.init({fileId:this.docMetaDomain.docMetaEntity.padInfo.padId,ownerId:this.docMetaDomain.docMetaEntity.ownerInfo.ownerId,tinyId:this.userInfoDomain.userInfoAggregate.userInfo.tinyid}),[2]}}))}))},(0,u.__decorate)([(0,l.u)(),(0,u.__metadata)("design:type",Function),(0,u.__metadata)("design:paramtypes",[Object]),(0,u.__metadata)("design:returntype",Promise)],t.prototype,"init",null),t=(0,u.__decorate)([(0,u.__param)(0,_.v),(0,u.__param)(1,p.m),(0,u.__param)(2,d.b),(0,u.__metadata)("design:paramtypes",[Object,Object,Object])],t)}()},58373:function(t,e,n){n.d(e,{d:function(){return r}});var r=(0,n(66624).yh)("ILikeDomainService")},55303:function(t,e,n){var r;n.d(e,{p:function(){return r}}),function(t){t.LOGOUT="logout",t.SWITCH="switch",t.LOGIN="login"}(r||(r={}))},27863:function(t,e,n){n.d(e,{x:function(){return r}});var r=(0,n(66624).yh)("IMessageDomainService")},26501:function(t,e,n){n.d(e,{i:function(){return tt}});var r,i=n(85556),o=n(99181),a=n(25153),s=n(36023);!function(t){t.ON="ON",t.OFF="OFF"}(r||(r={}));var c,u=function(){function t(t){this.emitter=new s.Emitter,this.listenersArray=[],this.messageCheckFn=t}return t.prototype.connect=function(){this.connectState!==r.ON&&(this.connectState=r.ON,this.initEmitterEvent(),window.addEventListener("message",this.messageCallback.bind(this)))},t.prototype.setIframeDom=function(t,e){this.iframeDom=t,this.targetOrigin=e},t.prototype.send=function(t){var e;this.iframeDom&&(null===(e=this.iframeDom.contentWindow)||void 0===e||e.postMessage(t,"*"))},t.prototype.receive=function(t){this.listenersArray.includes(t)||this.listenersArray.push(t)},t.prototype.dispose=function(){window.removeEventListener("message",this.messageCallback),this.connectState=r.OFF,this.listenersArray=[]},t.prototype.messageCallback=function(t){var e=!0;this.messageCheckFn&&(e=this.messageCheckFn(t)),e&&this.emitter.fire(t)},t.prototype.initEmitterEvent=function(){var t=this;this.emitter.event((function(e){t.listenersArray.forEach((function(t){"function"==typeof t&&t(e)}))}))},t}(),d=a.l8,_="ALREADY_IFRAME_GET_ACCOUNT_LIST_FROM_B",p="GET_ACCOUNT_LIST_FROM_B",f="DELETE_ACCOUNT_LIST_FROM_B",l="SUCCESS_GET_ACCOUNT_LIST_FROM_B",h="SUCCESS_DELETE_ACCOUNT_LIST_FROM_B",g=a.$8,v="iframe-to-manage-account-list",m=function(){function t(){this.getAccountMessage=new u(this.getAccountMessageCheckFn),this.iframeMountMessage=new u(this.getIframeMountMessageCheckFn),this.deleteAccountMessage=new u(this.getDeleteAccountMessageCheckFn)}return t.prototype.connect=function(){this.getAccountMessage.connect(),this.iframeMountMessage.connect(),this.deleteAccountMessage.connect()},t.prototype.dispose=function(){this.getAccountMessage.dispose(),this.iframeMountMessage.dispose(),this.deleteAccountMessage.dispose()},t.prototype.createGetAccountListIframe=function(t){var e=this;this.getAccountListIframeDom=this.createMessageIframe((function(n,r){r?(e.getAccountMessage.setIframeDom(n,d),e.deleteAccountMessage.setIframeDom(n,d)):null==t||t()}))},t.prototype.sendAccountListMessage=function(){this.getAccountMessage.send({eventFromCDomain:p})},t.prototype.sendDeleteAccountMessage=function(t){this.deleteAccountMessage.send({eventFromCDomain:f,cookie:t})},t.prototype.getAccountListMessage=function(t){this.getAccountMessage.receive(t)},t.prototype.getIframeMountMessage=function(t){this.iframeMountMessage.receive(t)},t.prototype.getDeleteAccountMessage=function(t){this.deleteAccountMessage.receive(t)},t.prototype.createMessageIframe=function(t){if(document.getElementById(v))return t(document.getElementById(v),!1),document.getElementById(v);var e=document.createElement("iframe");return e.src=g,e.id=v,e.style.visibility="hidden",e.style.width="0px",e.style.height="0px",document.body.appendChild(e),t(e,!0),e},t.prototype.getAccountMessageCheckFn=function(t){var e=t.data;return t.origin===d&&e.eventFromBDomain===l},t.prototype.getIframeMountMessageCheckFn=function(t){var e=t.data;return t.origin===d&&e.eventFromBDomain===_},t.prototype.getDeleteAccountMessageCheckFn=function(t){var e=t.data;return t.origin===d&&e.eventFromBDomain===h},t}(),y="IFRAME_ALREADY",w="GET_LOGINED_ACCOUNT",I="WILL_CHANGE_LOGINED_ACCOUNT",b="DELETE_LOGINED_ACCOUNT",S=a.LC,A=a.gN,C="iframe-to-manage-account-list",E=function(){function t(){this.getAccountMessage=new u(this.getAccountMessageCheckFn),this.iframeMountMessage=new u(this.getIframeMountMessageCheckFn),this.deleteAccountMessage=new u(this.getDeleteAccountMessageCheckFn)}return t.prototype.connect=function(){this.getAccountMessage.connect(),this.iframeMountMessage.connect(),this.deleteAccountMessage.connect()},t.prototype.dispose=function(){this.getAccountMessage.dispose(),this.iframeMountMessage.dispose(),this.deleteAccountMessage.dispose()},t.prototype.createGetAccountListIframe=function(t){var e=this;this.createMessageIframe((function(n,r){r?(e.getAccountMessage.setIframeDom(n,S),e.deleteAccountMessage.setIframeDom(n,S)):null==t||t()}))},t.prototype.sendAccountListMessage=function(){this.getAccountMessage.send({event:w})},t.prototype.sendDeleteAccountMessage=function(t){this.deleteAccountMessage.send({event:b,uid:t})},t.prototype.getAccountListMessage=function(t){this.getAccountMessage.receive(t)},t.prototype.getDeleteAccountMessage=function(t){this.deleteAccountMessage.receive(t)},t.prototype.getIframeMountMessage=function(t){this.iframeMountMessage.receive(t)},t.prototype.getAccountMessageCheckFn=function(t){return t.data.event===I},t.prototype.getIframeMountMessageCheckFn=function(t){return t.data.event===y},t.prototype.getDeleteAccountMessageCheckFn=function(t){return t.data.event===I},t.prototype.createMessageIframe=function(t){if(document.getElementById(C))return t(document.getElementById(C),!1),document.getElementById(C);var e=document.createElement("iframe");return e.src=A,e.id=C,e.style.visibility="hidden",e.style.width="0px",e.style.height="0px",document.body.appendChild(e),t(e,!0),e},t}(),R="ALREADY_JUMP_B_IFRAME",M="B_PAGE_SET_COOKIE",O="SUCCESS_SET_COOKIE",D=a.l8,k=a.rH,L="iframe-to-b-set-cookie",P=function(){function t(){this.iframeMountMessage=new u(this.getIframeMountMessageCheckFn),this.switchAccountMessage=new u(this.getSwitchAccountMessageCheckFn)}return t.prototype.connect=function(){this.iframeMountMessage.connect(),this.switchAccountMessage.connect()},t.prototype.dispose=function(){this.iframeMountMessage.dispose(),this.switchAccountMessage.dispose()},t.prototype.createSwitchEnterpriseAccount=function(t){var e=this;this.switchAccountDom=this.createMessageIframe((function(n,r){r?e.switchAccountMessage.setIframeDom(n,D):null==t||t()}))},t.prototype.getIframeMountMessage=function(t){this.iframeMountMessage.receive(t)},t.prototype.getSwitchAccountMessage=function(t){this.switchAccountMessage.receive(t)},t.prototype.sendSwitchAccountMessage=function(t){this.switchAccountMessage.send({event:M,cookie:t,fromDomain:"B_DOMAIN"})},t.prototype.createMessageIframe=function(t){document.getElementById(L)&&t(document.getElementById(L),!1);var e=document.createElement("iframe");return e.src=k,e.id=L,e.style.visibility="hidden",e.style.width="0px",e.style.height="0px",document.body.appendChild(e),t(e,!0),e},t.prototype.getIframeMountMessageCheckFn=function(t){var e=t.data;return t.origin===D&&e.event===R},t.prototype.getSwitchAccountMessageCheckFn=function(t){var e=t.data;return t.origin===D&&e.event===O},t}(),T="ALREADY_JUMP_C_IFRAME",x="C_PAGE_SET_COOKIE",F="SUCCESS_SET_COOKIE",N="EXPIRED_COOKIE",j=[a.LC],U=a.LC,q=a.n0,H="iframe-to-c-set-cookie",B=function(){function t(){this.iframeMountMessage=new u(this.getIframeMountMessageCheckFn),this.switchAccountMessage=new u(this.getSwitchAccountMessageCheckFn)}return t.prototype.connect=function(){this.iframeMountMessage.connect(),this.switchAccountMessage.connect()},t.prototype.dispose=function(){this.iframeMountMessage.dispose(),this.switchAccountMessage.dispose()},t.prototype.createSwitchEnterpriseAccount=function(t){var e=this;this.createMessageIframe((function(n,r){r?e.switchAccountMessage.setIframeDom(n,U):null==t||t()}))},t.prototype.getIframeMountMessage=function(t){this.iframeMountMessage.receive(t)},t.prototype.sendSwitchAccountMessage=function(t){this.switchAccountMessage.send({event:x,cookie:t,fromDomain:"C_DOMAIN"})},t.prototype.getSwitchAccountMessage=function(t){this.switchAccountMessage.receive(t)},t.prototype.createMessageIframe=function(t){document.getElementById(H)&&t(document.getElementById(H),!1);var e=document.createElement("iframe");return e.src=q,e.id=H,e.style.visibility="hidden",e.style.width="0px",e.style.height="0px",document.body.appendChild(e),t(e,!0),e},t.prototype.getIframeMountMessageCheckFn=function(t){var e=t.data,n=t.origin;return j.indexOf(n)>-1&&e.event===T},t.prototype.getSwitchAccountMessageCheckFn=function(t){var e=t.data,n=t.origin;return j.indexOf(n)>-1&&(e.event===F||e.event===N)},t}();!function(t){t.ON="ON",t.OFF="OFF"}(c||(c={}));var W,V=function(){function t(t,e){this.emitter=new s.Emitter,this.listenersArray=[],window.BroadcastChannel&&(this.channel=new window.BroadcastChannel(t)),this.messageCheckFn=e}return t.prototype.connect=function(){var t=this;this.connectState!==c.ON&&(this.connectState=c.ON,this.emitter.event((function(e){t.listenersArray.forEach((function(t){"function"==typeof t&&t(e)}))})),this.channel.onmessage=this.messageCallback.bind(this))},t.prototype.send=function(t){var e;null===(e=this.channel)||void 0===e||e.postMessage(t)},t.prototype.receive=function(t){this.listenersArray.includes(t)||this.listenersArray.push(t)},t.prototype.dispose=function(){var t;null===(t=this.channel)||void 0===t||t.close()},t.prototype.messageCallback=function(t){var e=!0;this.messageCheckFn&&(e=this.messageCheckFn(t)),e&&this.emitter.fire(t)},t}(),$=n(55303),G=function(){function t(){this.logoutMessage=new V("docMessageCenterChannel",this.logoutMessageCheckFn),this.key="".concat(Math.floor(1e9*Math.random()),"_").concat(+new Date)}return t.prototype.connect=function(){this.logoutMessage.connect()},t.prototype.getLogoutMessage=function(t){this.logoutMessage.receive(t)},t.prototype.sendLogoutMessage=function(t){this.logoutMessage.send({key:this.key,type:$.p.LOGOUT,userIndex:t})},t.prototype.logoutMessageCheckFn=function(t){return t.data.key!==this.key},t}();!function(t){t.QFYF_SUCCESS="login qfyf success",t.QQ_LOGIN_SUCCESS="login qq success",t.QQ_BING_SUCCESS="bind qq success"}(W||(W={}));var Q=a.Cs,K=function(){function t(){this.getQQLoginMessage=new u(this.getQQLoginMessageCheckFn),this.getQQLoginIframeMessage=new u(this.getIframeMountCheckFn)}return t.prototype.connect=function(){this.getQQLoginMessage.connect(),this.getQQLoginIframeMessage.connect()},t.prototype.dispose=function(){this.getQQLoginMessage.dispose(),this.getQQLoginIframeMessage.dispose()},t.prototype.getQQLoginSuccessMessage=function(t){this.getQQLoginMessage.receive(t)},t.prototype.getQQIframeMessage=function(t){this.getQQLoginIframeMessage.receive(t)},t.prototype.createQQLoginIframe=function(t,e){var n=document.createElement("iframe");return n.src=e,n.frameBorder="0",n.scrolling="auto",n.width="100%",n.height="100%",n.id="login_frame",n.name="login_frame",t.appendChild(n),n},t.prototype.getIframeMountCheckFn=function(t){var e=t.data,n=t.origin;try{var r=JSON.parse(e);return!(!n.indexOf("xui.ptlogin2.qq.com")||"resize"!==r.action)}catch(t){return!1}},t.prototype.getQQLoginMessageCheckFn=function(t){var e=t.data;return!(!t.origin.indexOf(Q)||e!==W.QQ_LOGIN_SUCCESS)},t}(),Y=function(){this.qqLoginMessage=new K},z=a.Cs,J=a.qe,X=function(){function t(){this.envType="person",this.getWeworkLoginMessage=new u(this.getWeworkLoginMessageCheckFn)}return t.prototype.connect=function(t){t&&(this.envType=t),this.getWeworkLoginMessage.connect()},t.prototype.dispose=function(){this.getWeworkLoginMessage.dispose()},t.prototype.getWeworkLoginSuccessMessage=function(t){this.getWeworkLoginMessage.receive(t)},t.prototype.createWeworkLoginIframe=function(t,e){var n=document.createElement("iframe");return n.src=e,n.frameBorder="0",n.scrolling="auto",n.width="100%",n.height="100%",n.id="login_frame",n.name="login_frame",t.appendChild(n),n},t.prototype.getWeworkLoginMessageCheckFn=function(t){var e=t.data,n=t.origin,r="person"===this.envType?z:J;return!!(n.indexOf(r)&&"string"==typeof e&&e.indexOf("login wework success")>-1)},t}(),Z=function(){this.weworkLoginMessage=new X},tt=function(){function t(){this.getEnterpriseAccountListMessage=new m,this.switchEnterpriseAccountMessage=new P,this.getPersonAccountListMessage=new E,this.switchPersonAccountMessage=new B,this.qqMessage=new Y,this.weworkMessage=new Z,this.logoutMessage=new G}return t.prototype.init=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){return[2]}))}))},(0,i.__decorate)([(0,o.u)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[]),(0,i.__metadata)("design:returntype",Promise)],t.prototype,"init",null),t}()},25101:function(t,e,n){n.d(e,{Y:function(){return r}});var r=(0,n(66624).yh)("INotificationDomainService")},38062:function(t,e,n){n.d(e,{e:function(){return k}});var r=n(85556),i=n(11268),o=n(56795),a=n(25882),s=n(16740),c=n(94404),u=n(44225),d=function(t){function e(e){var n=t.call(this)||this;return n.dataType=0,n.domainId="",n.localPadId="",n.padTitle="",n.padType="",n.padUrl="",n.page="",n.jsonObj2Class(e),n}return(0,r.__extends)(e,t),e}(u.K),_=function(t){function e(e){var n=t.call(this)||this;return n.avatar="",n.nick="",n.uid="",n.jsonObj2Class(e),n}return(0,r.__extends)(e,t),e}(u.K),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.notifyUserInfo=new _({}),e.notifyPadInfo=new d({}),e.aRightFlag=0,e.bRightFlag=0,e.nRightFlag=0,e.rightFlag=0,e.denyCount=0,e.flag=0,e.id="",e.op="",e.pass=0,e.sendDate=0,e.subject="",e.type=0,e}return(0,r.__extends)(e,t),e.prototype.initWithJsonObj=function(t){t?(this.aRightFlag=t.aRightFlag,this.bRightFlag=t.bRightFlag,this.nRightFlag=t.nRightFlag,this.rightFlag=t.rightFlag,this.denyCount=t.denyCount,this.flag=t.flag,this.pass=t.pass,this.sendDate=t.send_date,this.type=t.type,this.id=t.id,this.op=t.op,this.subject=t.subject,this.notifyPadInfo=new d(t),this.notifyUserInfo=new _(t)):e.logger.debug("params erroro: initWithJsonObj")},e}(c.J),f=n(13775),l="".concat(f.HL,"notify_getnum"),h="".concat(f.HL,"notify_list"),g="".concat(f.HL,"auth_set"),v="".concat(f.HL,"auth_apply/check"),m="".concat(f.HL,"notify_delete"),y="".concat(f.HL,"transowner_accept"),w="".concat(f.HL,"transowner_reject"),I=n(90304),b=n(46163),S=n(73154),A=function(){function t(t){this.networkRequestService=t}return t.prototype.notifyGetNum=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,r.__generator)(this,(function(n){return t={xsrf:"".concat((0,b.w$)(b.$W.xsrf))},e=(0,S.At)(l,t),[2,I.networkRequest.get(e)]}))}))},t.prototype.notifyList=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,r.__generator)(this,(function(r){return t?(e=(0,S.At)(h,{xsrf:"".concat((0,b.w$)(b.$W.xsrf)),start:t}),[2,I.networkRequest.get(e)]):(n=(0,S.At)(h,{xsrf:"".concat((0,b.w$)(b.$W.xsrf))}),[2,I.networkRequest.get(n)])}))}))},t.prototype.currentDocNotifyList=function(t,e,n){return(0,r.__awaiter)(this,void 0,void 0,(function(){var i,o;return(0,r.__generator)(this,(function(r){return n?(o={xsrf:"".concat((0,b.w$)(b.$W.xsrf)),domainId:t,localPadId:e,start:n},i=(0,S.At)(h,o)):(o={xsrf:"".concat((0,b.w$)(b.$W.xsrf)),domainId:t,localPadId:e},i=(0,S.At)(h,o)),[2,I.networkRequest.get(i)]}))}))},t.prototype.authSet=function(t,e,n,i){return(0,r.__awaiter)(this,void 0,void 0,(function(){var o,a;return(0,r.__generator)(this,(function(r){return o={xsrf:(0,b.w$)(b.$W.xsrf),domainId:t,localPadId:e,notifyId:n,setInfo:i},a="".concat(g),[2,I.networkRequest.post(a,o)]}))}))},t.prototype.authApplyCheck=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,i;return(0,r.__generator)(this,(function(r){return n={xsrf:"".concat((0,b.w$)(b.$W.xsrf)),domainId:t,localPadId:e},i=(0,S.At)(v,n),[2,I.networkRequest.get(i)]}))}))},t.prototype.notifyDelete=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,r.__generator)(this,(function(r){return e={id:t,xsrf:"".concat((0,b.w$)(b.$W.xsrf))},n=(0,S.At)(m,e),[2,I.networkRequest.get(n)]}))}))},t.prototype.transownerAccept=function(t,e,n,i){return(0,r.__awaiter)(this,void 0,void 0,(function(){var o,a;return(0,r.__generator)(this,(function(r){return o={xsrf:(0,b.w$)(b.$W.xsrf),domainId:t,localPadId:e,notifyId:n,setInfo:i},a="".concat(y),[2,I.networkRequest.post(a,o)]}))}))},t.prototype.transownerReject=function(t,e,n,i){return(0,r.__awaiter)(this,void 0,void 0,(function(){var o,a;return(0,r.__generator)(this,(function(r){return o={xsrf:(0,b.w$)(b.$W.xsrf),domainId:t,localPadId:e,notifyId:n,setInfo:i},a="".concat(w),[2,I.networkRequest.post(a,o)]}))}))},t=(0,r.__decorate)([(0,r.__param)(0,i._),(0,r.__metadata)("design:paramtypes",[Object])],t)}(),C=n(36023),E=function(t){function e(e){var n=t.call(this)||this;return n.unreadSumCount=0,n.hasPolicyNotify=0,n.jsonObj2Class(e),n}return(0,r.__extends)(e,t),e}(u.K),R="unreadInfo",M="list",O=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.docMetaDomainService=n,i.networkRequest=r,i.unreadInfo=new E({}),i.notifysAll=[],i.notifysCurrent=[],i.mOnNotifyUnreadInfoDidUpdated=new C.Emitter,i.onNotifyUnreadInfoDidUpdated=i.mOnNotifyUnreadInfoDidUpdated.event,i.notificationRepository=new A(r),i}return(0,r.__extends)(e,t),e.prototype.notifyGetNum=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return[2,this.notificationRepository.notifyGetNum()]}))}))},e.prototype.notifyList=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return t||(this.notifysAll=[]),[2,this.notificationRepository.notifyList(t)]}))}))},e.prototype.currentDocNotifyList=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return t||(this.notifysCurrent=[]),[2,this.notificationRepository.currentDocNotifyList(this.docMetaDomainService.docMetaEntity.padInfo.domainId,this.docMetaDomainService.docMetaEntity.padInfo.padId,t)]}))}))},e.prototype.authSet=function(t,e,n,i){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(r){return[2,this.notificationRepository.authSet(t,e,n,i)]}))}))},e.prototype.authApplyCheck=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(n){return[2,this.notificationRepository.authApplyCheck(t,e)]}))}))},e.prototype.notifyDelete=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,this.notificationRepository.notifyDelete(t)]}))}))},e.prototype.transownerAccept=function(t,e,n,i){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(r){return[2,this.notificationRepository.transownerAccept(t,e,n,i)]}))}))},e.prototype.transownerReject=function(t,e,n,i){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(r){return[2,this.notificationRepository.transownerReject(t,e,n,i)]}))}))},e.prototype.clearUnreadInfo=function(){this.unreadInfo=new E({}),this.mOnNotifyUnreadInfoDidUpdated.fire({unreadInfo:this.unreadInfo})},(0,r.__decorate)([(0,s.BX)("mOnNotifyUnreadInfoDidUpdated",R),(0,s.sv)(E.prototype.constructor,R),(0,s.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],e.prototype,"notifyGetNum",null),(0,r.__decorate)([(0,s.FY)(p.prototype.constructor,"notifysAll",M),(0,s.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],e.prototype,"notifyList",null),(0,r.__decorate)([(0,s.FY)(p.prototype.constructor,"notifysCurrent",M),(0,s.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],e.prototype,"currentDocNotifyList",null),(0,r.__decorate)([(0,s.Hh)(),(0,s.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String,String,String,Object]),(0,r.__metadata)("design:returntype",Promise)],e.prototype,"authSet",null),(0,r.__decorate)([(0,s.Hh)(),(0,s.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String,String]),(0,r.__metadata)("design:returntype",Promise)],e.prototype,"authApplyCheck",null),(0,r.__decorate)([(0,s.Hh)(),(0,s.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],e.prototype,"notifyDelete",null),(0,r.__decorate)([(0,s.Hh)(),(0,s.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String,String,String,Object]),(0,r.__metadata)("design:returntype",Promise)],e.prototype,"transownerAccept",null),(0,r.__decorate)([(0,s.Hh)(),(0,s.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String,String,String,Object]),(0,r.__metadata)("design:returntype",Promise)],e.prototype,"transownerReject",null),e=(0,r.__decorate)([(0,r.__param)(1,o.v),(0,r.__param)(2,i._),(0,r.__metadata)("design:paramtypes",[String,Object,Object])],e)}(a.Z),D=n(99181),k=function(){function t(t,e){this.docMetaDomainService=t,this.networkRequest=e,this.notificationAggregate=new O("mainUserInfoAggregate",t,e)}return t.prototype.init=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.docMetaDomainService.init(t)];case 1:return e.sent(),[2]}}))}))},(0,r.__decorate)([(0,D.u)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"init",null),t=(0,r.__decorate)([(0,r.__param)(0,o.v),(0,r.__param)(1,i._),(0,r.__metadata)("design:paramtypes",[Object,Object])],t)}()},41471:function(t,e,n){n.d(e,{Y:function(){return r}});var r=(0,n(66624).yh)("INotifyScopeDomainService")},66165:function(t,e,n){n.d(e,{l:function(){return m}});var r=n(85556),i=n(25882),o=n(16740),a=n(33661),s=n(13775),c="".concat(s.Hf,"/wedoc/notifyscope"),u="".concat(s.Hf,"/wedoc/editnotify"),d=n(90304),_=function(){function t(){}return t.prototype.getNotifyType=function(t){var e=(0,a.bk)((0,r.__assign)({},t));return d.networkRequest.post(c,e)},t.prototype.setNotifyType=function(t){var e=(0,a.bk)((0,r.__assign)({},t));return d.networkRequest.post(c,e)},t.prototype.editnotify=function(t){var e=(0,a.bk)((0,r.__assign)({},t));return d.networkRequest.post(u,e)},t}(),p=function(t){function e(e){var n=t.call(this)||this;return n.notifyType=0,n.jsonObj2Class(e),n}return(0,r.__extends)(e,t),e}(n(44225).K),f=n(36023),l="mOnNotifyInfoDidUpdated",h="notifyInfo",g=function(t){function e(e){var n=t.call(this,e)||this;return n.mOnNotifyInfoDidUpdated=new f.Emitter,n.notifyScopeRepository=new _,n.onNotifyInfoDidUpdated=n.mOnNotifyInfoDidUpdated.event,n}return(0,r.__extends)(e,t),e.prototype.getNotifyType=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,this.notifyScopeRepository.getNotifyType(t)]}))}))},e.prototype.setNotifyType=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,this.notifyScopeRepository.setNotifyType(t)]}))}))},e.prototype.editnotify=function(t){return this.notifyScopeRepository.editnotify(t)},e.prototype.setNotifyTypeWithParams=function(t){!t||t.length<1||(this.notifyInfo=new p({notifyType:t[0].notifyType}))},(0,r.__decorate)([(0,o.BX)(l,h),(0,o.sv)(p.prototype.constructor,h),(0,o.Hh)(),(0,o.LD)(),(0,o.bj)(),(0,o.w1)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],e.prototype,"getNotifyType",null),(0,r.__decorate)([(0,o.BX)(l,h),(0,o.CK)("setNotifyTypeWithParams"),(0,o.LD)(),(0,o.bj)(),(0,o.w1)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],e.prototype,"setNotifyType",null),(0,r.__decorate)([(0,o.Hh)(),(0,o.LD)(),(0,o.bj)(),(0,o.w1)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],e.prototype,"editnotify",null),e}(i.Z),v=n(99181),m=function(){function t(){this.notifyScopeAggregate=new g("mainINotifyScope")}return t.prototype.init=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return[2]}))}))},(0,r.__decorate)([(0,v.u)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"init",null),t}()},74805:function(t,e,n){n.d(e,{j:function(){return r}});var r=(0,n(66624).yh)("IShareDomainService")},4910:function(t,e,n){n.d(e,{d:function(){return nt}});var r=n(85556),i=n(11268),o=n(56795),a=n(16740),s=n(13775),c="".concat(s.HL,"user_recent"),u="".concat(s.HL,"auth_sendmsg"),d="".concat(s.Hf,"/cgi-go/common-notify/view"),_="".concat(s.HL,"browser_list"),p="".concat(s.Hf,"/v2/privilege/wxsharelink/save"),f="".concat(s.Hf,"/v2/privilege/wxsharelink/get"),l="".concat(s.Hf,"/v2/privilege/wxsharelink/recall"),h="".concat(s.HL,"wxqrcode"),g="".concat(s.HL,"qq_import/setTips"),v="".concat(s.Hf,"/cgi-bin/online_docs/share_doc"),m="".concat(s.HL,"auth_info/update"),y="".concat(s.Hf,"/sdc/friends"),w="".concat(s.Hf,"/sdc/gmembers"),I="".concat(s.Hf,"/sdc/dmembers"),b="".concat(s.Hf,"/v2/group/getinfo"),S="".concat(s.Hf,"/v2/sdc/friendchat"),A="".concat(s.Hf,"/v2/util/qq/auth/check"),C="".concat(s.Hf,"/enterprise/v1/cig/departments"),E="".concat(s.Hf,"/enterprise/v1/cig/search-user"),R="".concat(s.HL,"group_list"),M="".concat(s.HL,"group_members"),O="".concat(s.HL,"group_modify"),D="".concat(s.HL,"group_deletemember"),k="".concat(s.HL,"group_remove"),L="".concat(s.HL,"group_addmember"),P="".concat(s.HL,"group_create"),T="".concat(s.HL,"group_info"),x="".concat(s.HL,"group_quit"),F="".concat(s.HL,"group_checker"),N="".concat(s.HL,"group_addkey"),j="".concat(s.HL,"group_activate"),U=function(){function t(t,e){this.docMetaDomainService=t,this.networkRequestService=e}return t.prototype.fetchGroupList=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n;return(0,r.__generator)(this,(function(i){return n={start:t,limit:e,t:(new Date).getTime()},[2,this.networkRequestService.instance.post(R,(0,r.__assign)({},n))]}))}))},t.prototype.fetchGroupMembers=function(t,e,n){return(0,r.__awaiter)(this,void 0,void 0,(function(){var i;return(0,r.__generator)(this,(function(o){return i={group_id:t,start:e,limit:n,t:(new Date).getTime()},[2,this.networkRequestService.instance.post(M,(0,r.__assign)({},i))]}))}))},t.prototype.modifyGroup=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n;return(0,r.__generator)(this,(function(i){return n={group_id:t,group_name:e},[2,this.networkRequestService.instance.post(O,(0,r.__assign)({},n))]}))}))},t.prototype.deleteGroupMember=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n;return(0,r.__generator)(this,(function(i){return n={group_id:t,mem_list:[e]},[2,this.networkRequestService.instance.post(D,(0,r.__assign)({},n))]}))}))},t.prototype.removeGroup=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e={group_id:t},[2,this.networkRequestService.instance.post(k,(0,r.__assign)({},e))]}))}))},t.prototype.addGroupMember=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n;return(0,r.__generator)(this,(function(i){return n={group_id:t,mem_list:JSON.stringify(e)},[2,this.networkRequestService.instance.post(L,(0,r.__assign)({},n))]}))}))},t.prototype.createGroup=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n;return(0,r.__generator)(this,(function(i){return n={group_name:t,is_temp:e},[2,this.networkRequestService.instance.post(P,(0,r.__assign)({},n))]}))}))},t.prototype.fetchGroupInfo=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e={group_id:t,get_key:!1},[2,this.networkRequestService.instance.post(T,(0,r.__assign)({},e))]}))}))},t.prototype.quitGroup=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e={group_id:t},[2,this.networkRequestService.instance.post(x,(0,r.__assign)({},e))]}))}))},t.prototype.checkCreateGroup=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(e){return t={},[2,this.networkRequestService.instance.post(F,(0,r.__assign)({},t))]}))}))},t.prototype.addKeyToGroup=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n;return(0,r.__generator)(this,(function(i){return n={group_id:t,share_key:e},[2,this.networkRequestService.instance.post(N,(0,r.__assign)({},n))]}))}))},t.prototype.activateGroup=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e={group_id:t},[2,this.networkRequestService.instance.post(j,(0,r.__assign)({},e))]}))}))},t=(0,r.__decorate)([(0,r.__param)(0,o.v),(0,r.__param)(1,i._),(0,r.__metadata)("design:paramtypes",[Object,Object])],t)}(),q=function(){function t(t,e){this.docMetaDomainService=t,this.networkRequest=e,this.groupShareRepository=new U(t,e)}return t.prototype.fetchGroupList=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(n){return[2,this.groupShareRepository.fetchGroupList(t,e)]}))}))},t.prototype.fetchGroupMembers=function(t,e,n){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(r){return[2,this.groupShareRepository.fetchGroupMembers(t,e,n)]}))}))},t.prototype.modifyGroup=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(n){return[2,this.groupShareRepository.modifyGroup(t,e)]}))}))},t.prototype.deleteGroupMember=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(n){return[2,this.groupShareRepository.deleteGroupMember(t,e)]}))}))},t.prototype.removeGroup=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,this.groupShareRepository.removeGroup(t)]}))}))},t.prototype.addGroupMember=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(n){return[2,this.groupShareRepository.addGroupMember(t,e)]}))}))},t.prototype.createGroup=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(n){return[2,this.groupShareRepository.createGroup(t,e)]}))}))},t.prototype.fetchGroupInfo=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,this.groupShareRepository.fetchGroupInfo(t)]}))}))},t.prototype.quitGroup=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,this.groupShareRepository.quitGroup(t)]}))}))},t.prototype.checkCreateGroup=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return[2,this.groupShareRepository.checkCreateGroup()]}))}))},t.prototype.addKeyToGroup=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(n){return[2,this.groupShareRepository.addKeyToGroup(t,e)]}))}))},t.prototype.activateGroup=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,this.groupShareRepository.activateGroup(t)]}))}))},(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Number,Number]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"fetchGroupList",null),(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String,Number,Number]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"fetchGroupMembers",null),(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String,String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"modifyGroup",null),(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String,String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"deleteGroupMember",null),(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"removeGroup",null),(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String,Array]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"addGroupMember",null),(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String,Boolean]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"createGroup",null),(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"fetchGroupInfo",null),(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"quitGroup",null),(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"checkCreateGroup",null),(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String,String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"addKeyToGroup",null),(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"activateGroup",null),t=(0,r.__decorate)([(0,r.__param)(0,o.v),(0,r.__param)(1,i._),(0,r.__metadata)("design:paramtypes",[Object,Object])],t)}(),H=n(46163),B=n(73154),W=function(){function t(t,e){this.docMetaDomainService=t,this.networkRequestService=e}return t.prototype.fetchOrganizationalStructureList=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,i;return(0,r.__generator)(this,(function(r){return n={deptID:e,corpID:t,t:(new Date).getTime(),xsrf:"".concat((0,H.w$)(H.$W.xsrf))},i=(0,B.At)(C,n),[2,this.networkRequestService.instance.get(i)]}))}))},t.prototype.searchQFYFUser=function(t,e,n){return(0,r.__awaiter)(this,void 0,void 0,(function(){var i,o;return(0,r.__generator)(this,(function(r){return i={corpid:t,pos:n,num:20,word:e,xsrf:"".concat((0,H.w$)(H.$W.xsrf)),t:(new Date).getTime()},o=(0,B.At)(E,i),[2,this.networkRequestService.instance.get(o)]}))}))},t=(0,r.__decorate)([(0,r.__param)(0,o.v),(0,r.__param)(1,i._),(0,r.__metadata)("design:paramtypes",[Object,Object])],t)}(),V=function(){function t(t,e){this.docMetaDomainService=t,this.networkRequest=e,this.qfyfShareRepository=new W(t,e)}return t.prototype.fetchOrganizationalStructureList=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(n){return[2,this.qfyfShareRepository.fetchOrganizationalStructureList(t,e)]}))}))},t.prototype.searchQFYFUser=function(t,e,n){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(r){return[2,this.qfyfShareRepository.searchQFYFUser(t,e,n)]}))}))},(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String,String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"fetchOrganizationalStructureList",null),(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String,String,String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"searchQFYFUser",null),t=(0,r.__decorate)([(0,r.__param)(0,o.v),(0,r.__param)(1,i._),(0,r.__metadata)("design:paramtypes",[Object,Object])],t)}(),$=n(33661),G=n(11297),Q=function(){function t(t,e,n){this.docMetaDomainService=t,this.networkRequestService=e,this.userInfoDomainService=n}return t.prototype.checkIfCanShare=function(t){return void 0===t&&(t=!1),(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n,i,o;return(0,r.__generator)(this,(function(a){return e=(0,$.bk)({padId:this.docMetaDomainService.docMetaEntity.padInfo.padId,xsrf:(0,H.w$)(H.$W.xsrf)}),n={contentType:"application/x-www-form-urlencoded"},i=(0,r.__assign)({},t?{uflag:"qqsig"}:null),o=(0,B.At)(m,i),[2,this.networkRequestService.instance.post(o,e,n)]}))}))},t.prototype.setTipsAfterImport=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n,i,o;return(0,r.__generator)(this,(function(a){return e=t.fileMd5,n=t.guestUid,i=t.guestUidType,o={file_md5:e,guest_uid:n,guest_uid_type:i,tips_showed_fl:1},[2,this.networkRequestService.instance.post(g,(0,r.__assign)({},o))]}))}))},t.prototype.shareToQQOrTIM=function(t,e){return void 0===e&&(e=!1),(0,r.__awaiter)(this,void 0,void 0,(function(){var n,i,o,a;return(0,r.__generator)(this,(function(s){return n=(0,$.bk)({padid:this.docMetaDomainService.docMetaEntity.padInfo.padId,domainid:this.docMetaDomainService.docMetaEntity.padInfo.domainId,uins:JSON.stringify(t),xsrf:(0,H.w$)(H.$W.xsrf)}),i={contentType:"application/x-www-form-urlencoded"},o=(0,r.__assign)({},e?{uflag:"qqsig"}:null),a=(0,B.At)(v,o),[2,this.networkRequestService.instance.post(a,n,i)]}))}))},t.prototype.fetchFriendsInfo=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,r.__generator)(this,(function(n){return t={t:(new Date).getTime(),xsrf:"".concat((0,H.w$)(H.$W.xsrf))},e=(0,B.At)(y,t),[2,this.networkRequestService.instance.get(e)]}))}))},t.prototype.fetchGroupMember=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,r.__generator)(this,(function(r){return e={dstuin:t,t:(new Date).getTime(),xsrf:"".concat((0,H.w$)(H.$W.xsrf))},n=(0,B.At)(w,e),[2,this.networkRequestService.instance.get(n)]}))}))},t.prototype.fetchDiscussGroupMember=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,r.__generator)(this,(function(r){return e={dstuin:t,t:(new Date).getTime(),xsrf:"".concat((0,H.w$)(H.$W.xsrf))},n=(0,B.At)(I,e),[2,this.networkRequestService.instance.get(n)]}))}))},t.prototype.checkSkeyAuth=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(e){return t={uin:this.userInfoDomainService.userInfoAggregate.userInfo.uin,p_lskey:(0,$.s4)()||"",p_skey:(0,$.DN)()||""},[2,this.networkRequestService.instance.post(A,(0,r.__assign)({},t))]}))}))},t.prototype.fetchGroupInfo=function(t){var e={groupCode:t,xsrf:"".concat((0,H.w$)(H.$W.xsrf))};return this.networkRequestService.instance.post(b,(0,r.__assign)({},e))},t.prototype.fetchFriendInfo=function(t){var e={uin:"".concat(t),xsrf:"".concat((0,H.w$)(H.$W.xsrf))};return this.networkRequestService.instance.post(S,(0,r.__assign)({},e))},t=(0,r.__decorate)([(0,r.__param)(0,o.v),(0,r.__param)(1,i._),(0,r.__param)(2,G.m),(0,r.__metadata)("design:paramtypes",[Object,Object,Object])],t)}(),K=n(5448),Y=function(){function t(t,e,n){this.docMetaDomainService=t,this.networkRequest=e,this.userInfoDomainService=n,this.qqShareRepository=new Q(t,e,n)}return t.prototype.checkIfCanShare=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,r.__generator)(this,(function(n){return t=this.userInfoDomainService.userInfoAggregate.userInfo.loginType,e=![K.Q.QQ,K.Q.WX].includes(t),[2,this.qqShareRepository.checkIfCanShare(e)]}))}))},t.prototype.setTipsAfterImport=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,this.qqShareRepository.setTipsAfterImport(t)]}))}))},t.prototype.shareToQQOrTIM=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,r.__generator)(this,(function(r){return e=this.userInfoDomainService.userInfoAggregate.userInfo.loginType,n=![K.Q.QQ,K.Q.WX].includes(e),[2,this.qqShareRepository.shareToQQOrTIM(t,n)]}))}))},t.prototype.fetchFriendsInfo=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return[2,this.qqShareRepository.fetchFriendsInfo()]}))}))},t.prototype.fetchGroupMember=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,this.qqShareRepository.fetchGroupMember(t)]}))}))},t.prototype.fetchDiscussGroupMember=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,this.qqShareRepository.fetchDiscussGroupMember(t)]}))}))},t.prototype.checkSkeyAuth=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return[2,this.qqShareRepository.checkSkeyAuth()]}))}))},t.prototype.fetchGroupInfo=function(t){return this.qqShareRepository.fetchGroupInfo(t)},t.prototype.fetchFriendInfo=function(t){return this.qqShareRepository.fetchFriendInfo(t)},(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"checkIfCanShare",null),(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"setTipsAfterImport",null),(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Array]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"shareToQQOrTIM",null),(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"fetchFriendsInfo",null),(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"fetchGroupMember",null),(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"fetchDiscussGroupMember",null),(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"checkSkeyAuth",null),(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"fetchGroupInfo",null),(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"fetchFriendInfo",null),t=(0,r.__decorate)([(0,r.__param)(0,o.v),(0,r.__param)(1,i._),(0,r.__param)(2,G.m),(0,r.__metadata)("design:paramtypes",[Object,Object,Object])],t)}(),z=function(){function t(t,e){this.docMetaDomainService=t,this.networkRequestService=e}return t.prototype.fetchRecentUserInfo=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,r.__generator)(this,(function(n){return t={padId:this.docMetaDomainService.docMetaEntity.padInfo.padId,domain:this.docMetaDomainService.docMetaEntity.padInfo.domainId,xsrf:"".concat((0,H.w$)(H.$W.xsrf))},e=(0,B.At)(c,t),[2,this.networkRequestService.instance.post(e)]}))}))},t.prototype.sendDocToMember=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n;return(0,r.__generator)(this,(function(i){return n={padId:this.docMetaDomainService.docMetaEntity.padInfo.padId,domainId:this.docMetaDomainService.docMetaEntity.padInfo.domainId,addmemlist:JSON.stringify(t),corpid:(0,$.Pc)(e),xsrf:(0,H.w$)(H.$W.xsrf)},[2,this.networkRequestService.instance.post(u,(0,r.__assign)({},n))]}))}))},t.prototype.exportToPC=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(e){return t={padId:this.docMetaDomainService.docMetaEntity.padInfo.padId,xsrf:(0,H.w$)(H.$W.xsrf)},[2,this.networkRequestService.instance.post(d,(0,r.__assign)({},t))]}))}))},t.prototype.fetchBrowserList=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,i;return(0,r.__generator)(this,(function(r){return n={domain_id:this.docMetaDomainService.docMetaEntity.padInfo.domainId,pad_id:this.docMetaDomainService.docMetaEntity.padInfo.padId,start:t,limit:e,xsrf:"".concat((0,H.w$)(H.$W.xsrf)),t:(new Date).getTime()},i=(0,B.At)(_,n),[2,this.networkRequestService.instance.get(i)]}))}))},t=(0,r.__decorate)([(0,r.__param)(0,o.v),(0,r.__param)(1,i._),(0,r.__metadata)("design:paramtypes",[Object,Object])],t)}(),J=function(){function t(t,e){this.docMetaDomainService=t,this.networkRequest=e,this.shareRepository=new z(t,e)}return t.prototype.sendDocToMember=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(n){return[2,this.shareRepository.sendDocToMember(t,e)]}))}))},t.prototype.fetchRecentUserInfo=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return[2,this.shareRepository.fetchRecentUserInfo()]}))}))},t.prototype.exportToPC=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return[2,this.shareRepository.exportToPC()]}))}))},t.prototype.fetchBrowserList=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(n){return[2,this.shareRepository.fetchBrowserList(t,e)]}))}))},(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Array,String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"sendDocToMember",null),(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"fetchRecentUserInfo",null),(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"exportToPC",null),(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Number,Number]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"fetchBrowserList",null),t=(0,r.__decorate)([(0,r.__param)(0,o.v),(0,r.__param)(1,i._),(0,r.__metadata)("design:paramtypes",[Object,Object])],t)}(),X=function(){function t(t,e){this.docMetaDomainService=t,this.networkRequestService=e}return t.prototype.addWxShareLinkCount=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e={doc_id:this.docMetaDomainService.docMetaEntity.padInfo.padId,token:t},[2,this.networkRequestService.instance.post(p,(0,r.__assign)({},e))]}))}))},t.prototype.fetchWxShareLinkCount=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(e){return t={doc_id:this.docMetaDomainService.docMetaEntity.padInfo.padId},[2,this.networkRequestService.instance.post(f,(0,r.__assign)({},t))]}))}))},t.prototype.wxShare=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n,i,o;return(0,r.__generator)(this,(function(a){return e=t.groupId,n=t.shareLink,i=t.policy,o={groupId:(0,$.Pc)(e),domainId:this.docMetaDomainService.docMetaEntity.padInfo.domainId,padId:this.docMetaDomainService.docMetaEntity.padInfo.padId,page:"h5",right_flag:2,type:1,param:encodeURIComponent(n),ac:"share",policy:i,xsrf:(0,H.w$)(H.$W.xsrf)},[2,this.networkRequestService.instance.post(h,(0,r.__assign)({},o))]}))}))},t.prototype.stopWxShare=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(e){return t={doc_id:this.docMetaDomainService.docMetaEntity.padInfo.padId},[2,this.networkRequestService.instance.post(l,(0,r.__assign)({},t))]}))}))},t=(0,r.__decorate)([(0,r.__param)(0,o.v),(0,r.__param)(1,i._),(0,r.__metadata)("design:paramtypes",[Object,Object])],t)}(),Z=function(){function t(t,e){this.docMetaDomainService=t,this.networkRequest=e,this.weChatShareRepository=new X(t,e)}return t.prototype.fetchWxShareLinkCount=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return[2,this.weChatShareRepository.fetchWxShareLinkCount()]}))}))},t.prototype.stopWxShare=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return[2,this.weChatShareRepository.stopWxShare()]}))}))},t.prototype.addWxShareLinkCount=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,this.weChatShareRepository.addWxShareLinkCount(t)]}))}))},t.prototype.wxShare=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,this.weChatShareRepository.wxShare(t)]}))}))},(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"fetchWxShareLinkCount",null),(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"stopWxShare",null),(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"addWxShareLinkCount",null),(0,r.__decorate)([(0,a.Hh)(),(0,a.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"wxShare",null),t=(0,r.__decorate)([(0,r.__param)(0,o.v),(0,r.__param)(1,i._),(0,r.__metadata)("design:paramtypes",[Object,Object])],t)}(),tt=function(){function t(t,e,n){this.docMetaDomainService=t,this.networkRequestService=e,this.userInfoDomainService=n,this.shareEntity=new J(t,e),this.groupShareEntity=new q(t,e),this.qqShareEntity=new Y(t,e,n),this.weChatShareEntity=new Z(t,e),this.qfyfShareEntity=new V(t,e)}return t=(0,r.__decorate)([(0,r.__param)(0,o.v),(0,r.__param)(1,i._),(0,r.__param)(2,G.m),(0,r.__metadata)("design:paramtypes",[Object,Object,Object])],t)}(),et=n(99181),nt=function(){function t(t,e,n){this.docMetaDomainService=t,this.networkRequest=e,this.userInfoDomainService=n,this.shareAggregate=new tt(t,e,n)}return t.prototype.init=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([this.docMetaDomainService.init(t),this.userInfoDomainService.init(t)])];case 1:return e.sent(),[2]}}))}))},(0,r.__decorate)([(0,et.u)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"init",null),t=(0,r.__decorate)([(0,r.__param)(0,o.v),(0,r.__param)(1,i._),(0,r.__param)(2,G.m),(0,r.__metadata)("design:paramtypes",[Object,Object,Object])],t)}()},11297:function(t,e,n){n.d(e,{m:function(){return r}});var r=(0,n(66624).yh)("IUserInfoDomainService")},65282:function(t,e,n){n.d(e,{$:function(){return S}});var r=n(85556),i=n(16740),o=n(25882),a=n(94404),s=function(t){function e(e){var n=t.call(this)||this;return n.beginTime=0,n.endTime=0,n.isVip=!1,n.oldVip=!1,n.vipLevel=0,n.user={},n.recycleLimit={},n.collaborateLimit={},n.expansion={},n.superVip={},e.super_vip=e.super,n.jsonObj2Class(e),n}return(0,r.__extends)(e,t),e}(n(44225).K),c=n(5448),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.avatar="",e.qqAvatar="",e.wxAvatar="",e.nick="",e.qqNick="",e.wxNick="",e.corpId="",e.corpName="",e.domain="",e.domainId="",e.dbEmail="",e.email="",e.tinyid="",e.toid="",e.userId="",e.uid="",e.wxOpenid="",e.uidSource=0,e.uin="",e.login=!1,e.loginTime=0,e.loginType=c.Q.UNKNOWN,e.xu="",e.vipInfo=new s({}),e.vip="",e}return(0,r.__extends)(e,t),e}(a.J),d=n(13775),_="".concat(d.HL,"user_info"),p="".concat(d.HL,"vip_all"),f="".concat(d.HL,"user_flag"),l="".concat(d.HL,"user_info/check"),h=n(90304),g=n(46163),v=n(73154),m=function(){function t(){}return t.prototype.getUserInfo=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,i;return(0,r.__generator)(this,(function(o){return n={get_vip_info:t},e&&(n=(0,r.__assign)((0,r.__assign)({},n),{u:e})),i=(0,v.At)(_,n),[2,h.networkRequest.post(i,{xsrf:(0,g.w$)(g.$W.xsrf)})]}))}))},t.prototype.getVipInfo=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(e){return t=(0,v.At)(p,{xsrf:"".concat((0,g.w$)(g.$W.xsrf))}),[2,h.networkRequest.post(t)]}))}))},t.prototype.getUserFlag=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){return e=(0,v.At)(f,{xsrf:"".concat((0,g.w$)(g.$W.xsrf)),type:t}),[2,h.networkRequest.post(e)]}))}))},t.prototype.userInfoCheck=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(e){return t=(0,v.At)(l,{xsrf:"".concat((0,g.w$)(g.$W.xsrf))}),[2,h.networkRequest.post(t)]}))}))},t}(),y=n(36023),w="userInfo",I=function(t){function e(e){var n=t.call(this,e)||this;return n.userInfo=new u("mainUserInfo"),n.mOnUserInfoDidUpdated=new y.Emitter,n.userInfoRepository=new m,n.onUserInfoDidUpdated=n.mOnUserInfoDidUpdated.event,n}return(0,r.__extends)(e,t),e.prototype.fetchUserInfo=function(t,e){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(n){return[2,this.userInfoRepository.getUserInfo(t,e)]}))}))},e.prototype.fetchVipInfo=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return this.vipInfo=[],[2,this.userInfoRepository.getVipInfo()]}))}))},e.prototype.fetchUserFlag=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,this.userInfoRepository.getUserFlag(t)]}))}))},e.prototype.userInfoCheck=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return[2,this.userInfoRepository.userInfoCheck()]}))}))},(0,r.__decorate)([(0,i.BX)("mOnUserInfoDidUpdated",w),(0,i.sv)(u.prototype.constructor,w),(0,i.rx)(),(0,i.bj)(),(0,i.GT)("x-u","xu"),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Number,String]),(0,r.__metadata)("design:returntype",Promise)],e.prototype,"fetchUserInfo",null),(0,r.__decorate)([(0,i.FY)(s.prototype.constructor,"vipInfo","vip_info"),(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],e.prototype,"fetchVipInfo",null),(0,r.__decorate)([(0,i.Hh)(),(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Number]),(0,r.__metadata)("design:returntype",Promise)],e.prototype,"fetchUserFlag",null),(0,r.__decorate)([(0,i.Hh)(),(0,i.bj)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],e.prototype,"userInfoCheck",null),e}(o.Z),b=n(99181),S=function(){function t(){this.userInfoAggregate=new I("mainUserInfoAggregate"),this.isInitedByBasicClientVars=!1,window.basicClientVars&&this.initWithBasicClientVars(window.basicClientVars)}return t.prototype.init=function(t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n,i;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return e=t.u,[4,this.userInfoAggregate.fetchUserInfo(1,e)];case 1:return n=r.sent().resData,(i=null==n?void 0:n.data)?(this.userInfoAggregate.userInfo.initWithJsonObj({avatar:i.userPic,nick:i.nick,corpId:i.corpId,corpName:i.corpName,domain:i.domain,domainId:i.domainId,loginType:i.loginType,login:i.login,uin:i.uin,uidSource:i.uidSource,wxOpenid:i.wxOpenid,tinyid:i.tinyid,userId:""===i.userId?"p.".concat(i.tinyid):i.userId}),[2]):[2]}}))}))},t.prototype.updateWithClientVars=function(t){this.isInitedByBasicClientVars||this.userInfoAggregate.userInfo.initWithJsonObj({avatar:t.userPic,tinyid:t.tinyid,nick:t.userName,loginType:t.userType,userId:t.userId,uin:t.uin})},t.prototype.initWithBasicClientVars=function(t){this.userInfoAggregate.userInfo.initWithJsonObj({corpId:t.userInfo.corpId,corpName:t.userInfo.corpName,loginType:t.userInfo.loginType,login:!!t.userInfo.tinyId,uin:t.userInfo.uin,uidSource:t.userInfo.uidSource,wxOpenid:t.userInfo.openId,tinyid:t.userInfo.tinyId,userId:t.userInfo.userId,avatar:t.userInfo.userPic,nick:t.userInfo.userName}),this.isInitedByBasicClientVars=!0},(0,r.__decorate)([(0,b.u)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"init",null),(0,r.__decorate)([(0,i.aU)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"initWithBasicClientVars",null),t}()}}]),"object"==typeof globalThis&&(globalThis.jsExecEndTimeStamp=Date.now(),globalThis.cachedPerformanceEntries||(globalThis.cachedPerformanceEntries=[]),globalThis.cachedPerformanceEntries.push({name:"jsExec: js/public-ark-domain-70373909.js",entryType:"jsExec",startTime:globalThis.jsExecStartTimeStamp,endTime:globalThis.jsExecEndTimeStamp}));
//# sourceMappingURL=public-ark-domain-70373909.js.map