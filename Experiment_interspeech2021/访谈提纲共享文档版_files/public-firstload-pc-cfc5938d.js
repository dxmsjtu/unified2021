/*! For license information please see public-firstload-pc-cfc5938d.js.LICENSE.txt */
"object"==typeof globalThis&&(globalThis.jsExecStartTimeStamp=Date.now()),(self.webpackChunkuni=self.webpackChunkuni||[]).push([[6521],{8884:function(e,t,n){n.r(t),n.d(t,{ReactComponent:function(){return d}});var r,o,i,a,s,c,l=n(87363);function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(this,arguments)}function d(e){return l.createElement("svg",u({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=l.createElement("path",{d:"M4.5 4.344c0-.863.7-1.563 1.563-1.563h13.125c.863 0 1.562.7 1.562 1.563v15.312c0 .863-.7 1.563-1.562 1.563H6.063c-.863 0-1.563-.7-1.563-1.563V4.344z",fill:"#fff"})),o||(o=l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.188 3.719H6.063a.625.625 0 00-.625.625v15.312c0 .345.28.625.625.625h13.125c.345 0 .625-.28.625-.625V4.344a.625.625 0 00-.625-.625zM6.063 2.78c-.863 0-1.563.7-1.563 1.563v15.312c0 .863.7 1.563 1.563 1.563h13.125c.863 0 1.562-.7 1.562-1.563V4.344c0-.863-.7-1.563-1.562-1.563H6.063z",fill:"#FF6A6A",fillOpacity:.64})),i||(i=l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.25 7.934h-4.375v2.5h4.375v-2.5zm0 3.75h-4.375v.781h4.375v-.781zm-4.375 2.031h4.375v.781h-4.375v-.781zm4.375 2.031h-4.375v.781h4.375v-.78z",fill:"#FD6161",fillOpacity:.3})),a||(a=l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.25 6.531c0-.345.28-.625.625-.625h10c.346 0 .625.28.625.625V17.47c0 .345-.28.625-.625.625h-10a.625.625 0 01-.625-.625V6.53z",fill:"url(#application-pdf_svg__paint0_linear_2281_840)",fillOpacity:.96})),s||(s=l.createElement("g",{filter:"url(#application-pdf_svg__filter0_d_2281_840)"},l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.112 7.692h-.81a.268.268 0 00-.266.234c-.115 2.949-1.038 4.937-3.15 7.146-.059.062-.128.25-.005.394l.123.143c.11.127.244.283.403.471.122.144.311.09.386.04 2.063-1.39 4.643-2.022 6.564-1.861a.277.277 0 00.293-.23l.072-.352c.032-.162.059-.294.083-.402.044-.195-.113-.354-.2-.388-1.592-.631-3.07-2.85-3.212-4.919-.006-.092-.052-.276-.28-.276zM7.625 13.75c.535-.852.942-1.729 1.232-2.67l.06-.204.087.162c.411.75.927 1.433 1.509 1.994-.869.115-1.772.328-2.665.638l-.223.08z",fill:"#fff"}))),c||(c=l.createElement("defs",null,l.createElement("linearGradient",{id:"application-pdf_svg__paint0_linear_2281_840",x1:6.579,y1:1.489,x2:-3.188,y2:12.767,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#FF7272"}),l.createElement("stop",{offset:1,stopColor:"#FF4747"})),l.createElement("filter",{id:"application-pdf_svg__filter0_d_2281_840",x:4.534,y:7.134,width:9.674,height:10.155,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},l.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),l.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),l.createElement("feOffset",{dx:.558,dy:.279}),l.createElement("feGaussianBlur",{stdDeviation:.418}),l.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0"}),l.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2281_840"}),l.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2281_840",result:"shape"})))))}t.default="data:image/svg+xml,%3csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e %3cpath d='M4.50043 4.34375C4.50043 3.48081 5.19998 2.78125 6.06293 2.78125H19.1879C20.0509 2.78125 20.7504 3.48081 20.7504 4.34375V19.6562C20.7504 20.5192 20.0509 21.2188 19.1879 21.2188H6.06293C5.19998 21.2188 4.50043 20.5192 4.50043 19.6562V4.34375Z' fill='white'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M19.1879 3.71875H6.06293C5.71775 3.71875 5.43793 3.99857 5.43793 4.34375V19.6562C5.43793 20.0014 5.71775 20.2812 6.06293 20.2812H19.1879C19.5331 20.2812 19.8129 20.0014 19.8129 19.6562V4.34375C19.8129 3.99857 19.5331 3.71875 19.1879 3.71875ZM6.06293 2.78125C5.19998 2.78125 4.50043 3.48081 4.50043 4.34375V19.6562C4.50043 20.5192 5.19998 21.2188 6.06293 21.2188H19.1879C20.0509 21.2188 20.7504 20.5192 20.7504 19.6562V4.34375C20.7504 3.48081 20.0509 2.78125 19.1879 2.78125H6.06293Z' fill='%23FF6A6A' fill-opacity='0.64'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M18.2504 7.93384H13.8754V10.4338H18.2504V7.93384ZM18.2504 11.6838H13.8754V12.465H18.2504V11.6838ZM13.8754 13.715H18.2504V14.4963H13.8754V13.715ZM18.2504 15.7463H13.8754V16.5275H18.2504V15.7463Z' fill='%23FD6161' fill-opacity='0.3'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M3.25043 6.53125C3.25043 6.18607 3.53025 5.90625 3.87543 5.90625H13.8754C14.2206 5.90625 14.5004 6.18607 14.5004 6.53125V17.4688C14.5004 17.8139 14.2206 18.0938 13.8754 18.0938H3.87543C3.53025 18.0938 3.25043 17.8139 3.25043 17.4688V6.53125Z' fill='url(%23paint0_linear_2281_840)' fill-opacity='0.96'/%3e %3cg filter='url(%23filter0_d_2281_840)'%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M9.11236 7.69238H8.30169C8.12374 7.69238 8.03883 7.84864 8.03581 7.92578C7.92061 10.875 6.99834 12.8625 4.8867 15.0718C4.82707 15.1342 4.75831 15.322 4.8814 15.4658C4.91785 15.5084 4.95877 15.556 5.00404 15.6085C5.11352 15.7357 5.24842 15.8924 5.40691 16.0802C5.52862 16.2244 5.71841 16.1705 5.79255 16.1206C7.85617 14.7298 10.4356 14.0976 12.3574 14.2589C12.44 14.2658 12.61 14.2259 12.6505 14.0293C12.6774 13.8986 12.7009 13.7818 12.7218 13.6774C12.7543 13.5155 12.7809 13.3833 12.8053 13.2746C12.8492 13.0797 12.6922 12.9209 12.6058 12.8867C11.013 12.256 9.53492 10.0373 9.39318 7.96811C9.38686 7.87585 9.34095 7.69238 9.11236 7.69238ZM7.62537 13.7488C8.16032 12.897 8.56694 12.0201 8.85708 11.0783L8.91747 10.8754L9.00402 11.0371C9.41539 11.7869 9.93055 12.4705 10.5127 13.0312C9.64404 13.1456 8.74126 13.3586 7.84836 13.6692L7.62537 13.7488Z' fill='white'/%3e %3c/g%3e %3cdefs%3e %3cfilter id='filter0_d_2281_840' x='4.53392' y='7.13443' width='9.67385' height='10.1548' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'%3e %3cfeFlood flood-opacity='0' result='BackgroundImageFix'/%3e %3cfeColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0' result='hardAlpha'/%3e %3cfeOffset dx='0.557949' dy='0.278974'/%3e %3cfeGaussianBlur stdDeviation='0.418462'/%3e %3cfeColorMatrix type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0'/%3e %3cfeBlend mode='normal' in2='BackgroundImageFix' result='effect1_dropShadow_2281_840'/%3e %3cfeBlend mode='normal' in='SourceGraphic' in2='effect1_dropShadow_2281_840' result='shape'/%3e %3c/filter%3e %3clinearGradient id='paint0_linear_2281_840' x1='6.57905' y1='1.48938' x2='-3.18843' y2='12.7669' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%23FF7272'/%3e %3cstop offset='1' stop-color='%23FF4747'/%3e %3c/linearGradient%3e %3c/defs%3e %3c/svg%3e"},45665:function(e,t,n){n.r(t),n.d(t,{ReactComponent:function(){return d}});var r,o,i,a,s,c,l=n(87363);function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(this,arguments)}function d(e){return l.createElement("svg",u({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=l.createElement("path",{d:"M4.5 4.344c0-.863.7-1.563 1.563-1.563h13.125c.862 0 1.562.7 1.562 1.563v15.312c0 .863-.7 1.563-1.563 1.563H6.063c-.862 0-1.562-.7-1.562-1.563V4.344z",fill:"#fff"})),o||(o=l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.188 3.719H6.063a.625.625 0 00-.625.625v15.312c0 .345.28.625.625.625h13.125c.345 0 .625-.28.625-.625V4.344a.625.625 0 00-.625-.625zM6.063 2.78c-.863 0-1.563.7-1.563 1.563v15.312c0 .863.7 1.563 1.563 1.563h13.125c.862 0 1.562-.7 1.562-1.563V4.344c0-.863-.7-1.563-1.563-1.563H6.063z",fill:"#00AA5B",fillOpacity:.64})),i||(i=l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.406 8.25h-2.5v1.154h2.5V8.25zm0 2.308h-2.5v1.153h2.5v-1.153zm-2.5 2.307h2.5v1.154h-2.5v-1.154zm2.5 2.308h-2.5v1.154h2.5v-1.154zM15.281 8.25h-2.187v1.154h2.187V8.25zm0 2.308h-2.187v1.153h2.187v-1.153zm-2.187 2.307h2.187v1.154h-2.187v-1.154zm2.187 2.308h-2.187v1.154h2.187v-1.154z",fill:"#00AA5B",fillOpacity:.3})),a||(a=l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.25 6.531c0-.345.28-.625.625-.625h10c.345 0 .625.28.625.625V17.47c0 .345-.28.625-.625.625h-10a.625.625 0 01-.625-.625V6.53z",fill:"url(#application-vnd_ms-excel_svg__paint0_linear_2520_53023)"})),s||(s=l.createElement("g",{filter:"url(#application-vnd_ms-excel_svg__filter0_d_2520_53023)"},l.createElement("path",{d:"M5.438 15.495l2.825-3.924-.009 1.302L5.539 9.03H7.6l1.735 2.503-.877.009 1.708-2.512h1.977L9.427 12.8v-1.293l2.862 3.99h-2.105L8.42 12.862h.84l-1.736 2.632H5.437z",fill:"#fff"}))),c||(c=l.createElement("defs",null,l.createElement("linearGradient",{id:"application-vnd_ms-excel_svg__paint0_linear_2520_53023",x1:6.717,y1:1.363,x2:-2.527,y2:12.433,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#01D184"}),l.createElement("stop",{offset:1,stopColor:"#00AA5B"})),l.createElement("filter",{id:"application-vnd_ms-excel_svg__filter0_d_2520_53023",x:5.159,y:8.473,width:8.526,height:8.138,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},l.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),l.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),l.createElement("feOffset",{dx:.558,dy:.279}),l.createElement("feGaussianBlur",{stdDeviation:.418}),l.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0"}),l.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2520_53023"}),l.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2520_53023",result:"shape"})))))}t.default="data:image/svg+xml,%3csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e %3cpath d='M4.5 4.34375C4.5 3.48081 5.19956 2.78125 6.0625 2.78125H19.1875C20.0504 2.78125 20.75 3.48081 20.75 4.34375V19.6562C20.75 20.5192 20.0504 21.2188 19.1875 21.2188H6.0625C5.19956 21.2188 4.5 20.5192 4.5 19.6562V4.34375Z' fill='white'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M19.1875 3.71875H6.0625C5.71732 3.71875 5.4375 3.99857 5.4375 4.34375V19.6562C5.4375 20.0014 5.71732 20.2812 6.0625 20.2812H19.1875C19.5327 20.2812 19.8125 20.0014 19.8125 19.6562V4.34375C19.8125 3.99857 19.5327 3.71875 19.1875 3.71875ZM6.0625 2.78125C5.19956 2.78125 4.5 3.48081 4.5 4.34375V19.6562C4.5 20.5192 5.19956 21.2188 6.0625 21.2188H19.1875C20.0504 21.2188 20.75 20.5192 20.75 19.6562V4.34375C20.75 3.48081 20.0504 2.78125 19.1875 2.78125H6.0625Z' fill='%2300AA5B' fill-opacity='0.64'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M18.4062 8.25H15.9062V9.40385H18.4062V8.25ZM18.4062 10.5577H15.9062V11.7115H18.4062V10.5577ZM15.9062 12.8654H18.4062V14.0192H15.9062V12.8654ZM18.4062 15.1731H15.9062V16.3269H18.4062V15.1731Z' fill='%2300AA5B' fill-opacity='0.3'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M15.2812 8.25H13.0938V9.40385H15.2812V8.25ZM15.2812 10.5577H13.0938V11.7115H15.2812V10.5577ZM13.0938 12.8654H15.2812V14.0192H13.0938V12.8654ZM15.2812 15.1731H13.0938V16.3269H15.2812V15.1731Z' fill='%2300AA5B' fill-opacity='0.3'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M3.25 6.53125C3.25 6.18607 3.52982 5.90625 3.875 5.90625H13.875C14.2202 5.90625 14.5 6.18607 14.5 6.53125V17.4688C14.5 17.8139 14.2202 18.0938 13.875 18.0938H3.875C3.52982 18.0938 3.25 17.8139 3.25 17.4688V6.53125Z' fill='url(%23paint0_linear_2520_53023)'/%3e %3cg filter='url(%23filter0_d_2520_53023)'%3e %3cpath d='M5.4375 15.4953L8.26322 11.5707L8.25398 12.8728L5.53908 9.03125H7.59834L9.33441 11.5338L8.45714 11.543L10.1655 9.03125H12.1417L9.42675 12.7989V11.5061L12.2894 15.4953H10.184L8.4202 12.8635H9.26053L7.52447 15.4953H5.4375Z' fill='white'/%3e %3c/g%3e %3cdefs%3e %3cfilter id='filter0_d_2520_53023' x='5.15853' y='8.4733' width='8.52577' height='8.13796' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'%3e %3cfeFlood flood-opacity='0' result='BackgroundImageFix'/%3e %3cfeColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0' result='hardAlpha'/%3e %3cfeOffset dx='0.557949' dy='0.278974'/%3e %3cfeGaussianBlur stdDeviation='0.418462'/%3e %3cfeColorMatrix type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0'/%3e %3cfeBlend mode='normal' in2='BackgroundImageFix' result='effect1_dropShadow_2520_53023'/%3e %3cfeBlend mode='normal' in='SourceGraphic' in2='effect1_dropShadow_2520_53023' result='shape'/%3e %3c/filter%3e %3clinearGradient id='paint0_linear_2520_53023' x1='6.71703' y1='1.36349' x2='-2.52735' y2='12.4326' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%2301D184'/%3e %3cstop offset='1' stop-color='%2300AA5B'/%3e %3c/linearGradient%3e %3c/defs%3e %3c/svg%3e"},37561:function(e,t,n){n.r(t),n.d(t,{ReactComponent:function(){return d}});var r,o,i,a,s,c,l=n(87363);function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(this,arguments)}function d(e){return l.createElement("svg",u({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=l.createElement("path",{d:"M4.5 4.344c0-.863.7-1.563 1.563-1.563h13.125c.862 0 1.562.7 1.562 1.563v15.312c0 .863-.7 1.563-1.563 1.563H6.063c-.862 0-1.562-.7-1.562-1.563V4.344z",fill:"#fff"})),o||(o=l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.188 3.719H6.063a.625.625 0 00-.625.625v15.312c0 .345.28.625.625.625h13.125c.345 0 .625-.28.625-.625V4.344a.625.625 0 00-.625-.625zM6.063 2.78c-.863 0-1.563.7-1.563 1.563v15.312c0 .863.7 1.563 1.563 1.563h13.125c.862 0 1.562-.7 1.562-1.563V4.344c0-.863-.7-1.563-1.563-1.563H6.063z",fill:"#FA762D",fillOpacity:.64})),i||(i=l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.867 11.687a3.4 3.4 0 00-3.393-3.406v3.406h3.393zm-4.064.688V8.97a3.4 3.4 0 00-3.393 3.406 3.4 3.4 0 003.393 3.406 3.4 3.4 0 003.393-3.406h-3.393z",fill:"#FA762D",fillOpacity:.3})),a||(a=l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.25 6.531c0-.345.28-.625.625-.625h10c.345 0 .625.28.625.625V17.47c0 .345-.28.625-.625.625h-10a.625.625 0 01-.625-.625V6.53z",fill:"url(#application-vnd_ms-powerpoint_svg__paint0_linear_2520_53024)"})),s||(s=l.createElement("g",{filter:"url(#application-vnd_ms-powerpoint_svg__filter0_d_2520_53024)"},l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.75 8.313v7.367h1.776v-2.195h1.298c.626 0 1.17-.1 1.631-.303h.001c.46-.21.82-.51 1.072-.9.254-.39.38-.851.38-1.378 0-.533-.126-.998-.38-1.389a2.395 2.395 0 00-1.072-.89c-.461-.21-1.006-.313-1.632-.313H5.75zm1.685 6.982H5.84V8.403v6.892h1.595zm1.389-1.9H7.435h1.389zm-1.389-1.3h1.3c.492 0 .86-.105 1.103-.315.243-.21.364-.502.364-.876 0-.381-.121-.676-.364-.886-.243-.21-.61-.316-1.103-.316h-1.3 1.3c.492 0 .86.105 1.103.316.243.21.364.505.364.886 0 .374-.121.666-.364.876-.243.21-.61.315-1.103.315h-1.3V9.702m1.3 2.303h-1.21V9.793h1.21c.482 0 .824.103 1.044.293.22.19.333.458.333.818 0 .352-.114.618-.333.808-.22.19-.562.293-1.044.293z",fill:"#fff"}))),c||(c=l.createElement("defs",null,l.createElement("linearGradient",{id:"application-vnd_ms-powerpoint_svg__paint0_linear_2520_53024",x1:4.172,y1:2.617,x2:-2.719,y2:15.474,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#FF8246"}),l.createElement("stop",{offset:1,stopColor:"#FF5E2F"})),l.createElement("filter",{id:"application-vnd_ms-powerpoint_svg__filter0_d_2520_53024",x:5.471,y:7.755,width:7.831,height:9.041,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},l.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),l.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),l.createElement("feOffset",{dx:.558,dy:.279}),l.createElement("feGaussianBlur",{stdDeviation:.418}),l.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0"}),l.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2520_53024"}),l.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2520_53024",result:"shape"})))))}t.default="data:image/svg+xml,%3csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e %3cpath d='M4.5 4.34375C4.5 3.48081 5.19956 2.78125 6.0625 2.78125H19.1875C20.0504 2.78125 20.75 3.48081 20.75 4.34375V19.6562C20.75 20.5192 20.0504 21.2188 19.1875 21.2188H6.0625C5.19956 21.2188 4.5 20.5192 4.5 19.6562V4.34375Z' fill='white'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M19.1875 3.71875H6.0625C5.71732 3.71875 5.4375 3.99857 5.4375 4.34375V19.6562C5.4375 20.0014 5.71732 20.2812 6.0625 20.2812H19.1875C19.5327 20.2812 19.8125 20.0014 19.8125 19.6562V4.34375C19.8125 3.99857 19.5327 3.71875 19.1875 3.71875ZM6.0625 2.78125C5.19956 2.78125 4.5 3.48081 4.5 4.34375V19.6562C4.5 20.5192 5.19956 21.2188 6.0625 21.2188H19.1875C20.0504 21.2188 20.75 20.5192 20.75 19.6562V4.34375C20.75 3.48081 20.0504 2.78125 19.1875 2.78125H6.0625Z' fill='%23FA762D' fill-opacity='0.64'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M18.8669 11.6873C18.8669 9.80619 17.3479 8.28128 15.474 8.28128V11.6873H18.8669ZM14.8034 12.3753V8.96934C12.9295 8.96934 11.4104 10.4942 11.4104 12.3753C11.4104 14.2564 12.9295 15.7813 14.8034 15.7813C16.6773 15.7813 18.1964 14.2564 18.1964 12.3753H14.8034Z' fill='%23FA762D' fill-opacity='0.3'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M3.25 6.53125C3.25 6.18607 3.52982 5.90625 3.875 5.90625H13.875C14.2202 5.90625 14.5 6.18607 14.5 6.53125V17.4688C14.5 17.8139 14.2202 18.0938 13.875 18.0938H3.875C3.52982 18.0938 3.25 17.8139 3.25 17.4688V6.53125Z' fill='url(%23paint0_linear_2520_53024)'/%3e %3cg filter='url(%23filter0_d_2520_53024)'%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M5.75 8.3125V15.6797H7.52559V13.485H8.82364C9.45001 13.485 9.99471 13.3851 10.4552 13.182L10.4562 13.1815C10.9165 12.9716 11.2751 12.672 11.5283 12.2821C11.782 11.8912 11.9071 11.4305 11.9071 10.9037C11.9071 10.3706 11.7821 9.9065 11.5283 9.51546C11.275 9.12535 10.9163 8.82895 10.4557 8.62563C9.99503 8.41575 9.45013 8.3125 8.82364 8.3125H5.75ZM7.43533 15.295H5.84033V8.40276H5.84026V15.2951H7.43533V15.295ZM8.82364 13.3948H7.43541V13.3947H8.82372C9.1045 13.3947 9.36762 13.3744 9.61306 13.3336C9.3676 13.3744 9.10446 13.3948 8.82364 13.3948ZM7.43541 12.0951H8.73503C9.22733 12.0951 9.59492 11.99 9.83779 11.78C10.0807 11.5699 10.2021 11.2778 10.2021 10.9037C10.2021 10.523 10.0807 10.2276 9.83779 10.0175C9.59492 9.80747 9.22733 9.70245 8.73503 9.70245H7.43541V9.70243H8.7351C9.22741 9.70243 9.595 9.80746 9.83787 10.0175C10.0807 10.2276 10.2022 10.5229 10.2022 10.9037C10.2022 11.2778 10.0807 11.5699 9.83787 11.78C9.595 11.99 9.22741 12.095 8.7351 12.095H7.43541V9.70245M8.73503 12.0048H7.52559V9.79271H8.73503C9.21674 9.79271 9.55908 9.8958 9.77875 10.0858C9.99808 10.2755 10.1118 10.5438 10.1118 10.9037C10.1118 11.2564 9.99845 11.5217 9.77875 11.7117C9.55908 11.9017 9.21674 12.0048 8.73503 12.0048Z' fill='white'/%3e %3c/g%3e %3cdefs%3e %3cfilter id='filter0_d_2520_53024' x='5.47103' y='7.75455' width='7.83095' height='9.04103' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'%3e %3cfeFlood flood-opacity='0' result='BackgroundImageFix'/%3e %3cfeColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0' result='hardAlpha'/%3e %3cfeOffset dx='0.557949' dy='0.278974'/%3e %3cfeGaussianBlur stdDeviation='0.418462'/%3e %3cfeColorMatrix type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0'/%3e %3cfeBlend mode='normal' in2='BackgroundImageFix' result='effect1_dropShadow_2520_53024'/%3e %3cfeBlend mode='normal' in='SourceGraphic' in2='effect1_dropShadow_2520_53024' result='shape'/%3e %3c/filter%3e %3clinearGradient id='paint0_linear_2520_53024' x1='4.17156' y1='2.61748' x2='-2.71888' y2='15.4736' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%23FF8246'/%3e %3cstop offset='1' stop-color='%23FF5E2F'/%3e %3c/linearGradient%3e %3c/defs%3e %3c/svg%3e"},22787:function(e,t,n){n.r(t),n.d(t,{ReactComponent:function(){return d}});var r,o,i,a,s,c,l=n(87363);function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(this,arguments)}function d(e){return l.createElement("svg",u({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=l.createElement("path",{d:"M4.5 4.344c0-.863.7-1.563 1.563-1.563h13.125c.862 0 1.562.7 1.562 1.563v15.312c0 .863-.7 1.563-1.563 1.563H6.063c-.862 0-1.562-.7-1.562-1.563V4.344z",fill:"#fff"})),o||(o=l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.188 3.719H6.063a.625.625 0 00-.625.625v15.312c0 .345.28.625.625.625h13.125c.345 0 .625-.28.625-.625V4.344a.625.625 0 00-.625-.625zM6.063 2.78c-.863 0-1.563.7-1.563 1.563v15.312c0 .863.7 1.563 1.563 1.563h13.125c.862 0 1.562-.7 1.562-1.563V4.344c0-.863-.7-1.563-1.563-1.563H6.063z",fill:"#3A7DFF",fillOpacity:.64})),i||(i=l.createElement("path",{fill:"#3A7DFF",fillOpacity:.3,d:"M11.063 8.094h7.188v.938h-7.188zM11.063 10.594h7.188v.938h-7.188zM11.063 13.094h7.188v.938h-7.188zM11.063 15.594h7.188v.938h-7.188z"})),a||(a=l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.25 6.531c0-.345.28-.625.625-.625h10c.345 0 .625.28.625.625V17.47c0 .345-.28.625-.625.625h-10a.625.625 0 01-.625-.625V6.53z",fill:"url(#application-vnd_ms-word_svg__paint0_linear_2520_53022)"})),s||(s=l.createElement("g",{filter:"url(#application-vnd_ms-word_svg__filter0_d_2520_53022)"},l.createElement("path",{d:"M6.163 14.787L4.5 9.617h1.494l1.4 4.476h-.755L8.11 9.618h1.333l1.391 4.475h-.725l1.443-4.475h1.384l-1.662 5.169H9.722l-1.186-3.803h.417l-1.238 3.803H6.163z",fill:"#fff"}))),c||(c=l.createElement("defs",null,l.createElement("linearGradient",{id:"application-vnd_ms-word_svg__paint0_linear_2520_53022",x1:14.959,y1:1.938,x2:2.831,y2:18.477,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#34A4FF"}),l.createElement("stop",{offset:.999,stopColor:"#1E6FFF"})),l.createElement("filter",{id:"application-vnd_ms-word_svg__filter0_d_2520_53022",x:4.221,y:9.06,width:10.111,height:6.843,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},l.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),l.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),l.createElement("feOffset",{dx:.558,dy:.279}),l.createElement("feGaussianBlur",{stdDeviation:.418}),l.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0"}),l.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2520_53022"}),l.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2520_53022",result:"shape"})))))}t.default="data:image/svg+xml,%3csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e %3cpath d='M4.5 4.34375C4.5 3.48081 5.19956 2.78125 6.0625 2.78125H19.1875C20.0504 2.78125 20.75 3.48081 20.75 4.34375V19.6562C20.75 20.5192 20.0504 21.2188 19.1875 21.2188H6.0625C5.19956 21.2188 4.5 20.5192 4.5 19.6562V4.34375Z' fill='white'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M19.1875 3.71875H6.0625C5.71732 3.71875 5.4375 3.99857 5.4375 4.34375V19.6562C5.4375 20.0014 5.71732 20.2812 6.0625 20.2812H19.1875C19.5327 20.2812 19.8125 20.0014 19.8125 19.6562V4.34375C19.8125 3.99857 19.5327 3.71875 19.1875 3.71875ZM6.0625 2.78125C5.19956 2.78125 4.5 3.48081 4.5 4.34375V19.6562C4.5 20.5192 5.19956 21.2188 6.0625 21.2188H19.1875C20.0504 21.2188 20.75 20.5192 20.75 19.6562V4.34375C20.75 3.48081 20.0504 2.78125 19.1875 2.78125H6.0625Z' fill='%233A7DFF' fill-opacity='0.64'/%3e %3crect x='11.0625' y='8.09375' width='7.1875' height='0.9375' fill='%233A7DFF' fill-opacity='0.3'/%3e %3crect x='11.0625' y='10.5938' width='7.1875' height='0.9375' fill='%233A7DFF' fill-opacity='0.3'/%3e %3crect x='11.0625' y='13.0938' width='7.1875' height='0.9375' fill='%233A7DFF' fill-opacity='0.3'/%3e %3crect x='11.0625' y='15.5938' width='7.1875' height='0.9375' fill='%233A7DFF' fill-opacity='0.3'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M3.25 6.53125C3.25 6.18607 3.52982 5.90625 3.875 5.90625H13.875C14.2202 5.90625 14.5 6.18607 14.5 6.53125V17.4688C14.5 17.8139 14.2202 18.0938 13.875 18.0938H3.875C3.52982 18.0938 3.25 17.8139 3.25 17.4688V6.53125Z' fill='url(%23paint0_linear_2520_53022)'/%3e %3cg filter='url(%23filter0_d_2520_53022)'%3e %3cpath d='M6.1626 14.787L4.5 9.6178H5.99414L7.39307 14.0929H6.63867L8.11084 9.6178H9.44385L10.8354 14.0929H10.1104L11.5532 9.6178H12.9375L11.2749 14.787H9.72217L8.53564 10.984H8.95312L7.71533 14.787H6.1626Z' fill='white'/%3e %3c/g%3e %3cdefs%3e %3cfilter id='filter0_d_2520_53022' x='4.22103' y='9.05985' width='10.1113' height='6.84304' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'%3e %3cfeFlood flood-opacity='0' result='BackgroundImageFix'/%3e %3cfeColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0' result='hardAlpha'/%3e %3cfeOffset dx='0.557949' dy='0.278974'/%3e %3cfeGaussianBlur stdDeviation='0.418462'/%3e %3cfeColorMatrix type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0'/%3e %3cfeBlend mode='normal' in2='BackgroundImageFix' result='effect1_dropShadow_2520_53022'/%3e %3cfeBlend mode='normal' in='SourceGraphic' in2='effect1_dropShadow_2520_53022' result='shape'/%3e %3c/filter%3e %3clinearGradient id='paint0_linear_2520_53022' x1='14.9588' y1='1.93752' x2='2.83106' y2='18.4769' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%2334A4FF'/%3e %3cstop offset='0.999235' stop-color='%231E6FFF'/%3e %3c/linearGradient%3e %3c/defs%3e %3c/svg%3e"},12780:function(e,t,n){n.r(t),n.d(t,{ReactComponent:function(){return u}});var r,o,i,a,s,c=n(87363);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}function u(e){return c.createElement("svg",l({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=c.createElement("path",{d:"M19.188 20.75H4.813c-.605 0-1.094-.49-1.094-1.094V4.344c0-.604.49-1.094 1.094-1.094h14.375c.604 0 1.093.49 1.093 1.094V19.656c0 .604-.49 1.094-1.093 1.094z",fill:"url(#application-vnd_tdocs-addon-image_236b7f64e91e40b584f2aae0517ee1ed_svg__paint0_linear_3365_57176)",stroke:"#CBCDD1",strokeWidth:.938})),o||(o=c.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.502 10.844L9.369 8.495c.21-.42.493-.81.849-1.17C11.09 6.44 12.145 6 13.382 6c1.236 0 2.29.441 3.163 1.324.868.878 1.302 1.937 1.302 3.177 0 1.239-.434 2.298-1.302 3.176-.872.883-1.927 1.324-3.163 1.324V12.42c.516 0 .957-.186 1.323-.556.371-.376.557-.83.557-1.363 0-.534-.186-.988-.557-1.363a1.793 1.793 0 00-1.323-.557c-.516 0-.957.186-1.324.557-.37.375-.556.83-.556 1.363v.343z",fill:"url(#application-vnd_tdocs-addon-image_236b7f64e91e40b584f2aae0517ee1ed_svg__paint1_linear_3365_57176)"})),i||(i=c.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.916 12.698V18h.197c1.32 0 2.39-1.068 2.39-2.386v-.708a4.226 4.226 0 01-1.045-.675c-.638-.543-1.152-1.054-1.542-1.533z",fill:"url(#application-vnd_tdocs-addon-image_236b7f64e91e40b584f2aae0517ee1ed_svg__paint2_linear_3365_57176)"})),a||(a=c.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.444 8.639L6 9.042l3.633 3.994.566.624.02.02c.872.882 1.927 1.324 3.163 1.324 1.237 0 2.291-.442 3.164-1.325.868-.878 1.302-1.937 1.302-3.176h-2.586c0 .533-.186.988-.557 1.363-.366.37-.807.556-1.323.556a1.79 1.79 0 01-1.306-.539l-1.735-1.912-.002.002-1.09-1.2a1.988 1.988 0 00-2.805-.134z",fill:"url(#application-vnd_tdocs-addon-image_236b7f64e91e40b584f2aae0517ee1ed_svg__paint3_linear_3365_57176)"})),s||(s=c.createElement("defs",null,c.createElement("linearGradient",{id:"application-vnd_tdocs-addon-image_236b7f64e91e40b584f2aae0517ee1ed_svg__paint0_linear_3365_57176",x1:12,y1:2.938,x2:12,y2:21.375,gradientUnits:"userSpaceOnUse"},c.createElement("stop",{stopColor:"#F5F5F5"}),c.createElement("stop",{offset:1,stopColor:"#EEE"})),c.createElement("linearGradient",{id:"application-vnd_tdocs-addon-image_236b7f64e91e40b584f2aae0517ee1ed_svg__paint1_linear_3365_57176",x1:15.352,y1:10.284,x2:12.106,y2:13.442,gradientUnits:"userSpaceOnUse"},c.createElement("stop",{offset:.108,stopColor:"#FF68CF"}),c.createElement("stop",{offset:.323,stopColor:"#EA61E6"}),c.createElement("stop",{offset:.572,stopColor:"#CC51FF"}),c.createElement("stop",{offset:1,stopColor:"#7936FF"})),c.createElement("linearGradient",{id:"application-vnd_tdocs-addon-image_236b7f64e91e40b584f2aae0517ee1ed_svg__paint2_linear_3365_57176",x1:10.209,y1:12.179,x2:10.209,y2:18.331,gradientUnits:"userSpaceOnUse"},c.createElement("stop",{offset:.092,stopColor:"#7C2FFF"}),c.createElement("stop",{offset:.996,stopColor:"#33C9FF"})),c.createElement("linearGradient",{id:"application-vnd_tdocs-addon-image_236b7f64e91e40b584f2aae0517ee1ed_svg__paint3_linear_3365_57176",x1:14.06,y1:11.053,x2:6.963,y2:8.124,gradientUnits:"userSpaceOnUse"},c.createElement("stop",{offset:.05,stopColor:"#FF68CF"}),c.createElement("stop",{offset:.995,stopColor:"#FF9059"})))))}t.default="data:image/svg+xml,%3csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e %3cpath d='M19.1875 20.75H4.8125C4.20844 20.75 3.71875 20.2603 3.71875 19.6562V4.34375C3.71875 3.73969 4.20844 3.25 4.8125 3.25H19.1875C19.7916 3.25 20.2812 3.73969 20.2812 4.34375V6.6224V19.6562C20.2812 20.2603 19.7916 20.75 19.1875 20.75Z' fill='url(%23paint0_linear_3365_57176)' stroke='%23CBCDD1' stroke-width='0.9375'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M11.5016 10.8435L9.36914 8.49544C9.5791 8.07467 9.86202 7.68427 10.2179 7.32424C11.0905 6.44141 12.1451 6 13.3817 6C14.6182 6 15.6727 6.44141 16.5453 7.32424C17.4133 8.20233 17.8473 9.2611 17.8473 10.5006C17.8473 11.74 17.4133 12.7989 16.5453 13.6769C15.6727 14.5598 14.6182 15.0011 13.3817 15.0011V12.4196C13.8975 12.4196 14.3386 12.2343 14.7049 11.8636C15.0761 11.4882 15.2616 11.0338 15.2616 10.5006C15.2616 9.9673 15.0761 9.51295 14.7049 9.13752C14.3386 8.76684 13.8975 8.58149 13.3817 8.58149C12.8658 8.58149 12.4247 8.76684 12.0583 9.13752C11.6872 9.51296 11.5016 9.96732 11.5016 10.5006V10.8435Z' fill='url(%23paint1_linear_3365_57176)'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M8.9165 12.6982V18H9.11258C10.4323 18 11.5022 16.9318 11.5022 15.6142V14.9062C11.1643 14.7603 10.8162 14.5352 10.4581 14.2307C9.81997 13.6881 9.30611 13.1773 8.9165 12.6982Z' fill='url(%23paint2_linear_3365_57176)'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M6.44446 8.63873L6 9.04165L9.63252 13.0356L10.1989 13.6598L10.2183 13.6794C11.091 14.5622 12.1456 15.0036 13.3821 15.0036C14.6186 15.0036 15.6732 14.5622 16.5458 13.6794C17.4137 12.8013 17.8477 11.7425 17.8477 10.503H15.262C15.262 11.0363 15.0765 11.4907 14.7053 11.8661C14.339 12.2368 13.8979 12.4222 13.3821 12.4222C12.8743 12.4222 12.439 12.2426 12.076 11.8834L10.3408 9.97118L10.3393 9.97256L9.24891 8.7737C8.51183 7.96326 7.25621 7.90283 6.44446 8.63873Z' fill='url(%23paint3_linear_3365_57176)'/%3e %3cdefs%3e %3clinearGradient id='paint0_linear_3365_57176' x1='12' y1='2.9375' x2='12' y2='21.375' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%23F5F5F5'/%3e %3cstop offset='1' stop-color='%23EEEEEE'/%3e %3c/linearGradient%3e %3clinearGradient id='paint1_linear_3365_57176' x1='15.3521' y1='10.2842' x2='12.1062' y2='13.4424' gradientUnits='userSpaceOnUse'%3e %3cstop offset='0.107589' stop-color='%23FF68CF'/%3e %3cstop offset='0.322614' stop-color='%23EA61E6'/%3e %3cstop offset='0.571583' stop-color='%23CC51FF'/%3e %3cstop offset='1' stop-color='%237936FF'/%3e %3c/linearGradient%3e %3clinearGradient id='paint2_linear_3365_57176' x1='10.2094' y1='12.1791' x2='10.2094' y2='18.3307' gradientUnits='userSpaceOnUse'%3e %3cstop offset='0.091849' stop-color='%237C2FFF'/%3e %3cstop offset='0.99609' stop-color='%2333C9FF'/%3e %3c/linearGradient%3e %3clinearGradient id='paint3_linear_3365_57176' x1='14.0597' y1='11.0532' x2='6.96276' y2='8.12402' gradientUnits='userSpaceOnUse'%3e %3cstop offset='0.05016' stop-color='%23FF68CF'/%3e %3cstop offset='0.994774' stop-color='%23FF9059'/%3e %3c/linearGradient%3e %3c/defs%3e %3c/svg%3e"},71579:function(e,t,n){n.r(t),n.d(t,{ReactComponent:function(){return c}});var r,o,i,a=n(87363);function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s.apply(this,arguments)}function c(e){return a.createElement("svg",s({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=a.createElement("path",{d:"M3.719 4.344c0-.604.49-1.094 1.094-1.094h14.375c.604 0 1.093.49 1.093 1.094V19.656c0 .604-.49 1.094-1.093 1.094H4.813c-.605 0-1.094-.49-1.094-1.094V4.344z",fill:"url(#application-vnd_tdocs-addon-image_9e2c26161b684629a9bf29e52efa6c60_svg__paint0_linear_2525_51749)",stroke:"#CBCDD1",strokeWidth:.938})),o||(o=a.createElement("g",{clipPath:"url(#application-vnd_tdocs-addon-image_9e2c26161b684629a9bf29e52efa6c60_svg__clip0_2525_51749)",fillRule:"evenodd",clipRule:"evenodd"},a.createElement("path",{d:"M13.8 13.344l-3.495-2.672-3.413 5.33a.828.828 0 00.744 1.192l8.73-.002c.74 0 1.11-.893.586-1.414l-3.151-2.434z",fill:"#00DFB0"}),a.createElement("path",{d:"M16.384 6.806H7.691c-.738 0-1.108.891-.587 1.413l6.705 5.125 3.31-5.326a.828.828 0 00-.735-1.212z",fill:"#6668FF"}))),i||(i=a.createElement("defs",null,a.createElement("linearGradient",{id:"application-vnd_tdocs-addon-image_9e2c26161b684629a9bf29e52efa6c60_svg__paint0_linear_2525_51749",x1:12,y1:2.938,x2:12,y2:21.375,gradientUnits:"userSpaceOnUse"},a.createElement("stop",{stopColor:"#F5F5F5"}),a.createElement("stop",{offset:1,stopColor:"#EEE"})),a.createElement("clipPath",{id:"application-vnd_tdocs-addon-image_9e2c26161b684629a9bf29e52efa6c60_svg__clip0_2525_51749"},a.createElement("path",{fill:"#fff",transform:"translate(6.5 6.5)",d:"M0 0h11v11H0z"})))))}t.default="data:image/svg+xml,%3csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e %3cpath d='M3.71875 4.34375C3.71875 3.73969 4.20844 3.25 4.8125 3.25H19.1875C19.7916 3.25 20.2812 3.73969 20.2812 4.34375V6.6224V19.6562C20.2812 20.2603 19.7916 20.75 19.1875 20.75H4.8125C4.20844 20.75 3.71875 20.2603 3.71875 19.6562V4.34375Z' fill='url(%23paint0_linear_2525_51749)' stroke='%23CBCDD1' stroke-width='0.9375'/%3e %3cg clip-path='url(%23clip0_2525_51749)'%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M13.8007 13.3443V13.3447L10.3047 10.6722L6.8916 16.0013C6.62098 16.5515 7.02233 17.1944 7.63643 17.1944L16.3666 17.1915C17.1056 17.1915 17.4752 16.2993 16.9523 15.7778L13.8007 13.3443Z' fill='%2300DFB0'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M16.3845 6.80566H7.69139C6.95282 6.80566 6.5827 7.69704 7.10436 8.21856L13.809 13.3444L17.1193 8.01785C17.4086 7.4664 17.0081 6.80566 16.3845 6.80566Z' fill='%236668FF'/%3e %3c/g%3e %3cdefs%3e %3clinearGradient id='paint0_linear_2525_51749' x1='12' y1='2.9375' x2='12' y2='21.375' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%23F5F5F5'/%3e %3cstop offset='1' stop-color='%23EEEEEE'/%3e %3c/linearGradient%3e %3cclipPath id='clip0_2525_51749'%3e %3crect width='11' height='11' fill='white' transform='translate(6.5 6.5)'/%3e %3c/clipPath%3e %3c/defs%3e %3c/svg%3e"},49691:function(e,t,n){n.r(t),n.d(t,{ReactComponent:function(){return l}});var r,o,i,a,s=n(87363);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}function l(e){return s.createElement("svg",c({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=s.createElement("path",{d:"M19.188 20.75H4.813c-.605 0-1.094-.49-1.094-1.094V4.344c0-.604.49-1.094 1.094-1.094h14.375c.604 0 1.093.49 1.093 1.094V19.656c0 .604-.49 1.094-1.093 1.094z",fill:"url(#application-vnd_tdocs-addon-image_e3e96c1968114db986a9229003965853_svg__paint0_linear_3412_57191)",stroke:"#CBCDD1",strokeWidth:.938})),o||(o=s.createElement("path",{d:"M10.363 12.313c.078-.123.17-.24.278-.35.389-.398.859-.598 1.409-.598s1.02.2 1.409.598c.39.4.584.88.584 1.444H16.7c0-1.316-.454-2.438-1.362-3.369-.908-.93-2.004-1.395-3.288-1.395-.604 0-1.166.103-1.687.308v3.362z",fill:"url(#application-vnd_tdocs-addon-image_e3e96c1968114db986a9229003965853_svg__paint1_linear_3412_57191)"})),i||(i=s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.043 13.398c0 .56-.195 1.037-.584 1.432-.39.396-.859.593-1.41.593-.55 0-1.02-.197-1.408-.593a1.968 1.968 0 01-.584-1.432v-4.84A2.657 2.657 0 007.4 5.9v7.498c0 1.305.454 2.419 1.362 3.342.908.923 2.004 1.384 3.288 1.384 1.284 0 2.38-.461 3.288-1.384.908-.923 1.362-2.037 1.362-3.342v-.072h-2.657v.072z",fill:"url(#application-vnd_tdocs-addon-image_e3e96c1968114db986a9229003965853_svg__paint2_linear_3412_57191)"})),a||(a=s.createElement("defs",null,s.createElement("linearGradient",{id:"application-vnd_tdocs-addon-image_e3e96c1968114db986a9229003965853_svg__paint0_linear_3412_57191",x1:12,y1:2.938,x2:12,y2:21.375,gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#F5F5F5"}),s.createElement("stop",{offset:1,stopColor:"#EEE"})),s.createElement("linearGradient",{id:"application-vnd_tdocs-addon-image_e3e96c1968114db986a9229003965853_svg__paint1_linear_3412_57191",x1:14.439,y1:8.643,x2:10.363,y2:8.643,gradientUnits:"userSpaceOnUse"},s.createElement("stop",{offset:.05,stopColor:"#FF68CF"}),s.createElement("stop",{offset:.995,stopColor:"#FF9059"})),s.createElement("linearGradient",{id:"application-vnd_tdocs-addon-image_e3e96c1968114db986a9229003965853_svg__paint2_linear_3412_57191",x1:13.689,y1:13.576,x2:7.4,y2:5.9,gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#FF68CF"}),s.createElement("stop",{offset:.484,stopColor:"#7B2FFF"}),s.createElement("stop",{offset:1,stopColor:"#00CFFF"})))))}t.default="data:image/svg+xml,%3csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e %3cpath d='M19.1875 20.75H4.8125C4.20844 20.75 3.71875 20.2603 3.71875 19.6562V4.34375C3.71875 3.73969 4.20844 3.25 4.8125 3.25H19.1875C19.7916 3.25 20.2812 3.73969 20.2812 4.34375V6.6224V19.6562C20.2812 20.2603 19.7916 20.75 19.1875 20.75Z' fill='url(%23paint0_linear_3412_57191)' stroke='%23CBCDD1' stroke-width='0.9375'/%3e %3cpath d='M10.3628 12.3126C10.4406 12.1899 10.5332 12.0735 10.6407 11.9634C11.0298 11.5646 11.4996 11.3653 12.0499 11.3653C12.6002 11.3653 13.0699 11.5646 13.459 11.9634C13.8482 12.3621 14.0427 12.8434 14.0427 13.4072H16.6999C16.6999 12.0915 16.2459 10.9685 15.3379 10.0382C14.43 9.10788 13.334 8.6427 12.0499 8.6427C11.4459 8.6427 10.8836 8.74562 10.3628 8.95143V12.3126Z' fill='url(%23paint1_linear_3412_57191)'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M14.0427 13.3977C14.0427 13.9571 13.8482 14.4345 13.4591 14.83C13.0699 15.2256 12.6002 15.4234 12.0499 15.4234C11.4996 15.4234 11.0298 15.2256 10.6407 14.83C10.2516 14.4345 10.0571 13.9571 10.0571 13.3977L10.0573 8.55715C10.0573 7.08967 8.86779 5.90002 7.40031 5.90002L7.3999 13.3977C7.40001 14.7027 7.85398 15.817 8.76184 16.7399C9.66983 17.6628 10.7659 18.1242 12.0499 18.1242C13.334 18.1242 14.43 17.6628 15.338 16.7399C16.2459 15.8169 16.6999 14.7029 16.6999 13.3977V13.3258H14.0427V13.3977Z' fill='url(%23paint2_linear_3412_57191)'/%3e %3cdefs%3e %3clinearGradient id='paint0_linear_3412_57191' x1='12' y1='2.9375' x2='12' y2='21.375' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%23F5F5F5'/%3e %3cstop offset='1' stop-color='%23EEEEEE'/%3e %3c/linearGradient%3e %3clinearGradient id='paint1_linear_3412_57191' x1='14.4394' y1='8.64271' x2='10.3628' y2='8.64271' gradientUnits='userSpaceOnUse'%3e %3cstop offset='0.05016' stop-color='%23FF68CF'/%3e %3cstop offset='0.994774' stop-color='%23FF9059'/%3e %3c/linearGradient%3e %3clinearGradient id='paint2_linear_3412_57191' x1='13.6886' y1='13.5758' x2='7.39991' y2='5.90003' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%23FF68CF'/%3e %3cstop offset='0.483568' stop-color='%237B2FFF'/%3e %3cstop offset='1' stop-color='%2300CFFF'/%3e %3c/linearGradient%3e %3c/defs%3e %3c/svg%3e"},36938:function(e,t,n){n.r(t),n.d(t,{ReactComponent:function(){return u}});var r,o,i,a,s,c=n(87363);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}function u(e){return c.createElement("svg",l({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=c.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.25 4.987a.8.8 0 01.8-.8h6.507c.188 0 .37.07.51.198l2.183 1.99h-10V4.987z",fill:"url(#application-vnd_tdocs-apps_collaboration-space_svg__paint0_linear_2519_51711)"})),o||(o=c.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.25 6.375h16.433c.59 0 1.067.478 1.067 1.067v10.991c0 .59-.478 1.067-1.067 1.067H4.317c-.59 0-1.067-.478-1.067-1.067V6.375z",fill:"url(#application-vnd_tdocs-apps_collaboration-space_svg__paint1_linear_2519_51711)"})),i||(i=c.createElement("g",{filter:"url(#application-vnd_tdocs-apps_collaboration-space_svg__filter0_d_2519_51711)"},c.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.105 13.996c.383.182.615.538.607.91v1.04h-6.4v-1.04c-.008-.372.225-.728.608-.91l2.034-1.012-.002-.088a.493.493 0 00-.196-.39 1.118 1.118 0 01-.461-.883l-.009-.658c-.008-.629.521-1.144 1.181-1.152h.053c.66-.008 1.202.495 1.21 1.124l.009.657c.004.37-.178.7-.463.911a.492.492 0 00-.197.404l.002.08 2.024 1.007z",fill:"#ECFCFF"}))),a||(a=c.createElement("g",{filter:"url(#application-vnd_tdocs-apps_collaboration-space_svg__filter1_d_2519_51711)"},c.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.187 14.792c.01-.456-.274-.892-.741-1.114l-1.037-.516.357-.178-.002-.088a.493.493 0 00-.196-.39 1.118 1.118 0 01-.46-.883l-.01-.658c-.008-.629.522-1.144 1.182-1.152h.052c.66-.008 1.202.495 1.21 1.124l.01.657c.004.37-.178.7-.463.911a.492.492 0 00-.197.404l.001.08 2.024 1.007c.383.182.616.538.608.91v1.04h-2.338v-1.154z",fill:"#ECFCFF",fillOpacity:.8}))),s||(s=c.createElement("defs",null,c.createElement("linearGradient",{id:"application-vnd_tdocs-apps_collaboration-space_svg__paint0_linear_2519_51711",x1:5.283,y1:4.188,x2:5.283,y2:6.442,gradientUnits:"userSpaceOnUse"},c.createElement("stop",{stopColor:"#2DA5EB"}),c.createElement("stop",{offset:1,stopColor:"#2198EB"})),c.createElement("linearGradient",{id:"application-vnd_tdocs-apps_collaboration-space_svg__paint1_linear_2519_51711",x1:11.462,y1:-.188,x2:-.931,y2:17.353,gradientUnits:"userSpaceOnUse"},c.createElement("stop",{stopColor:"#4DD1FF"}),c.createElement("stop",{offset:1,stopColor:"#3CBFFF"})),c.createElement("filter",{id:"application-vnd_tdocs-apps_collaboration-space_svg__filter0_d_2519_51711",x:7.046,y:9.279,width:8,height:7.733,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},c.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),c.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),c.createElement("feOffset",{dx:.533,dy:.267}),c.createElement("feGaussianBlur",{stdDeviation:.4}),c.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0"}),c.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2519_51711"}),c.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2519_51711",result:"shape"})),c.createElement("filter",{id:"application-vnd_tdocs-apps_collaboration-space_svg__filter1_d_2519_51711",x:11.832,y:9.279,width:6.027,height:7.733,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},c.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),c.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),c.createElement("feOffset",{dx:.533,dy:.267}),c.createElement("feGaussianBlur",{stdDeviation:.4}),c.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0"}),c.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2519_51711"}),c.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2519_51711",result:"shape"})))))}t.default="data:image/svg+xml,%3csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M3.25 4.9875C3.25 4.54567 3.60817 4.1875 4.05 4.1875H10.5569C10.7455 4.1875 10.9273 4.25792 11.0666 4.38497L13.25 6.375H3.25V4.9875Z' fill='url(%23paint0_linear_2519_51711)'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M3.25 6.375H19.6833C20.2724 6.375 20.75 6.85256 20.75 7.44167V18.4333C20.75 19.0224 20.2724 19.5 19.6833 19.5H4.31667C3.72756 19.5 3.25 19.0224 3.25 18.4333V6.375Z' fill='url(%23paint1_linear_2519_51711)'/%3e %3cg filter='url(%23filter0_d_2519_51711)'%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M13.1048 13.996C13.4876 14.1776 13.7203 14.5341 13.7123 14.9066V15.9458H7.31274V14.9066C7.30386 14.5341 7.53743 14.1776 7.9202 13.996L9.95374 12.9843L9.95205 12.8964C9.95027 12.7452 9.881 12.5983 9.75578 12.5054C9.47959 12.3001 9.29931 11.9817 9.29487 11.6227L9.28599 10.9647C9.27799 10.3363 9.80729 9.82103 10.4671 9.81343L10.5195 9.81258C11.1803 9.80498 11.722 10.3084 11.73 10.9368L11.7389 11.594C11.7433 11.9639 11.5613 12.2942 11.2762 12.5054C11.1465 12.6008 11.0773 12.7528 11.079 12.9091L11.0807 12.989L13.1048 13.996Z' fill='%23ECFCFF'/%3e %3c/g%3e %3cg filter='url(%23filter1_d_2519_51711)'%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M14.1873 14.7917C14.197 14.3362 13.913 13.9003 13.4458 13.6782L12.4095 13.1618L12.7662 12.9843L12.7645 12.8964C12.7628 12.7452 12.6935 12.5983 12.5683 12.5054C12.2921 12.3001 12.1118 11.9817 12.1074 11.6227L12.0985 10.9647C12.0905 10.3363 12.6198 9.82103 13.2796 9.81343L13.332 9.81258C13.9928 9.80498 14.5345 10.3084 14.5425 10.9368L14.5514 11.594C14.5558 11.9639 14.3738 12.2942 14.0887 12.5054C13.959 12.6008 13.8897 12.7528 13.8915 12.9091L13.8932 12.989L15.9173 13.996C16.3001 14.1776 16.5328 14.5341 16.5248 14.9066V15.9458H14.1873V14.7917Z' fill='%23ECFCFF' fill-opacity='0.8'/%3e %3c/g%3e %3cdefs%3e %3cfilter id='filter0_d_2519_51711' x='7.04583' y='9.27917' width='8.00002' height='7.7333' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'%3e %3cfeFlood flood-opacity='0' result='BackgroundImageFix'/%3e %3cfeColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0' result='hardAlpha'/%3e %3cfeOffset dx='0.533333' dy='0.266667'/%3e %3cfeGaussianBlur stdDeviation='0.4'/%3e %3cfeColorMatrix type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0'/%3e %3cfeBlend mode='normal' in2='BackgroundImageFix' result='effect1_dropShadow_2519_51711'/%3e %3cfeBlend mode='normal' in='SourceGraphic' in2='effect1_dropShadow_2519_51711' result='shape'/%3e %3c/filter%3e %3cfilter id='filter1_d_2519_51711' x='11.8317' y='9.27917' width='6.02664' height='7.7333' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'%3e %3cfeFlood flood-opacity='0' result='BackgroundImageFix'/%3e %3cfeColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0' result='hardAlpha'/%3e %3cfeOffset dx='0.533333' dy='0.266667'/%3e %3cfeGaussianBlur stdDeviation='0.4'/%3e %3cfeColorMatrix type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0'/%3e %3cfeBlend mode='normal' in2='BackgroundImageFix' result='effect1_dropShadow_2519_51711'/%3e %3cfeBlend mode='normal' in='SourceGraphic' in2='effect1_dropShadow_2519_51711' result='shape'/%3e %3c/filter%3e %3clinearGradient id='paint0_linear_2519_51711' x1='5.28321' y1='4.1875' x2='5.28321' y2='6.44182' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%232DA5EB'/%3e %3cstop offset='1' stop-color='%232198EB'/%3e %3c/linearGradient%3e %3clinearGradient id='paint1_linear_2519_51711' x1='11.4618' y1='-0.1875' x2='-0.931299' y2='17.353' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%234DD1FF'/%3e %3cstop offset='1' stop-color='%233CBFFF'/%3e %3c/linearGradient%3e %3c/defs%3e %3c/svg%3e"},61385:function(e,t,n){n.r(t),n.d(t,{ReactComponent:function(){return c}});var r,o,i,a=n(87363);function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s.apply(this,arguments)}function c(e){return a.createElement("svg",s({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=a.createElement("path",{d:"M3.25 4.344c0-.863.7-1.563 1.563-1.563h14.375c.862 0 1.562.7 1.562 1.563v15.312c0 .863-.7 1.563-1.563 1.563H4.813c-.862 0-1.562-.7-1.562-1.563V4.344z",fill:"#fff"})),o||(o=a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.188 3.719H4.813a.625.625 0 00-.625.625v15.312c0 .345.28.625.625.625h14.375c.345 0 .625-.28.625-.625V4.344a.625.625 0 00-.625-.625zM4.813 2.78c-.863 0-1.563.7-1.563 1.563v15.312c0 .863.7 1.563 1.563 1.563h14.375c.862 0 1.562-.7 1.562-1.563V4.344c0-.863-.7-1.563-1.563-1.563H4.813z",fill:"#81868F",fillOpacity:.64})),i||(i=a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.188 6.063h5.554v4.698h4.446v6.802a.375.375 0 01-.375.375H7.188a.375.375 0 01-.375-.375V6.438c0-.208.168-.375.375-.375zm9.992 3.834a.375.375 0 00-.105-.195l-3.444-3.36v3.555h3.55z",fill:"#81868F"})))}t.default="data:image/svg+xml,%3csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e %3cpath d='M3.25 4.34375C3.25 3.48081 3.94956 2.78125 4.8125 2.78125H19.1875C20.0504 2.78125 20.75 3.48081 20.75 4.34375V19.6562C20.75 20.5192 20.0504 21.2188 19.1875 21.2188H4.8125C3.94956 21.2188 3.25 20.5192 3.25 19.6562V4.34375Z' fill='white'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M19.1875 3.71875H4.8125C4.46732 3.71875 4.1875 3.99857 4.1875 4.34375V19.6562C4.1875 20.0014 4.46732 20.2812 4.8125 20.2812H19.1875C19.5327 20.2812 19.8125 20.0014 19.8125 19.6562V4.34375C19.8125 3.99857 19.5327 3.71875 19.1875 3.71875ZM4.8125 2.78125C3.94956 2.78125 3.25 3.48081 3.25 4.34375V19.6562C3.25 20.5192 3.94956 21.2188 4.8125 21.2188H19.1875C20.0504 21.2188 20.75 20.5192 20.75 19.6562V4.34375C20.75 3.48081 20.0504 2.78125 19.1875 2.78125H4.8125Z' fill='%2381868F' fill-opacity='0.64'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M7.18799 6.0625H12.7419V9.89719V10.6706V10.7608H17.1877V17.5625C17.1877 17.7696 17.0199 17.9375 16.8127 17.9375H7.18799C6.98088 17.9375 6.81299 17.7696 6.81299 17.5625V6.4375C6.81299 6.23039 6.98088 6.0625 7.18799 6.0625ZM17.1805 9.89719C17.1658 9.82353 17.1292 9.75538 17.0747 9.70214L13.6311 6.34152V9.89719H17.1805Z' fill='%2381868F'/%3e %3c/svg%3e"},33781:function(e,t,n){n.r(t),n.d(t,{ReactComponent:function(){return u}});var r,o,i,a,s,c=n(87363);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}function u(e){return c.createElement("svg",l({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=c.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.688 8.387c0-.593.475-1.075 1.06-1.075h11.94c.587 0 1.062.482 1.062 1.075v11.288c0 .594-.475 1.075-1.061 1.075H7.749a1.068 1.068 0 01-1.061-1.075V8.387z",fill:"url(#application-vnd_tdocs-apps_doc_svg__paint0_linear_2519_51698)"})),o||(o=c.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.813 3.25c-.69 0-1.25.56-1.25 1.25v15c0 .69.56 1.25 1.25 1.25h15v-.011a1.094 1.094 0 01-1.239-1.239h-.011v-15c0-.69-.56-1.25-1.25-1.25h-12.5z",fill:"url(#application-vnd_tdocs-apps_doc_svg__paint1_linear_2519_51698)"})),i||(i=c.createElement("g",{filter:"url(#application-vnd_tdocs-apps_doc_svg__filter0_d_2519_51698)"},c.createElement("path",{fill:"#B3D9FF",d:"M6.688 15.906h8.75v1.719h-8.75z"}))),a||(a=c.createElement("g",{filter:"url(#application-vnd_tdocs-apps_doc_svg__filter1_d_2519_51698)"},c.createElement("path",{fill:"#D3F3FF",d:"M6.688 12.938h8.75v1.719h-8.75z"}))),s||(s=c.createElement("defs",null,c.createElement("linearGradient",{id:"application-vnd_tdocs-apps_doc_svg__paint0_linear_2519_51698",x1:20.75,y1:10.214,x2:18.447,y2:10.214,gradientUnits:"userSpaceOnUse"},c.createElement("stop",{stopColor:"#1E6FFF"}),c.createElement("stop",{offset:1,stopColor:"#144DEB"})),c.createElement("linearGradient",{id:"application-vnd_tdocs-apps_doc_svg__paint1_linear_2519_51698",x1:19.146,y1:-2.449,x2:1.211,y2:19.232,gradientUnits:"userSpaceOnUse"},c.createElement("stop",{stopColor:"#34A4FF"}),c.createElement("stop",{offset:.999,stopColor:"#1E6FFF"})),c.createElement("filter",{id:"application-vnd_tdocs-apps_doc_svg__filter0_d_2519_51698",x:6.421,y:15.373,width:10.35,height:3.319,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},c.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),c.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),c.createElement("feOffset",{dx:.533,dy:.267}),c.createElement("feGaussianBlur",{stdDeviation:.4}),c.createElement("feColorMatrix",{values:"0 0 0 0 0.0901961 0 0 0 0 0.360784 0 0 0 0 0.921569 0 0 0 0.8 0"}),c.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2519_51698"}),c.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2519_51698",result:"shape"})),c.createElement("filter",{id:"application-vnd_tdocs-apps_doc_svg__filter1_d_2519_51698",x:6.421,y:12.404,width:10.35,height:3.319,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},c.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),c.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),c.createElement("feOffset",{dx:.533,dy:.267}),c.createElement("feGaussianBlur",{stdDeviation:.4}),c.createElement("feColorMatrix",{values:"0 0 0 0 0.0901961 0 0 0 0 0.360784 0 0 0 0 0.921569 0 0 0 0.8 0"}),c.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2519_51698"}),c.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2519_51698",result:"shape"})))))}t.default="data:image/svg+xml,%3csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M6.6875 8.3875C6.6875 7.79379 7.16267 7.3125 7.74882 7.3125H19.6887C20.2748 7.3125 20.75 7.79379 20.75 8.3875V19.675C20.75 20.2687 20.2748 20.75 19.6887 20.75H7.74882C7.16267 20.75 6.6875 20.2687 6.6875 19.675V8.3875Z' fill='url(%23paint0_linear_2519_51698)'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M4.8125 3.25C4.12214 3.25 3.5625 3.80964 3.5625 4.5V19.5C3.5625 20.1904 4.12214 20.75 4.8125 20.75H18.5625H19.6562H19.8125V20.7389C19.7615 20.7462 19.7093 20.75 19.6562 20.75C19.0522 20.75 18.5625 20.2603 18.5625 19.6562C18.5625 19.6032 18.5663 19.551 18.5736 19.5H18.5625V4.5C18.5625 3.80964 18.0029 3.25 17.3125 3.25H4.8125Z' fill='url(%23paint1_linear_2519_51698)'/%3e %3cg filter='url(%23filter0_d_2519_51698)'%3e %3crect x='6.6875' y='15.9062' width='8.74998' height='1.71875' fill='%23B3D9FF'/%3e %3c/g%3e %3cg filter='url(%23filter1_d_2519_51698)'%3e %3crect x='6.68762' y='12.9375' width='8.74998' height='1.71875' fill='%23D3F3FF'/%3e %3c/g%3e %3cdefs%3e %3cfilter id='filter0_d_2519_51698' x='6.42083' y='15.3729' width='10.35' height='3.31875' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'%3e %3cfeFlood flood-opacity='0' result='BackgroundImageFix'/%3e %3cfeColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0' result='hardAlpha'/%3e %3cfeOffset dx='0.533333' dy='0.266667'/%3e %3cfeGaussianBlur stdDeviation='0.4'/%3e %3cfeColorMatrix type='matrix' values='0 0 0 0 0.0901961 0 0 0 0 0.360784 0 0 0 0 0.921569 0 0 0 0.8 0'/%3e %3cfeBlend mode='normal' in2='BackgroundImageFix' result='effect1_dropShadow_2519_51698'/%3e %3cfeBlend mode='normal' in='SourceGraphic' in2='effect1_dropShadow_2519_51698' result='shape'/%3e %3c/filter%3e %3cfilter id='filter1_d_2519_51698' x='6.42096' y='12.4042' width='10.35' height='3.31875' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'%3e %3cfeFlood flood-opacity='0' result='BackgroundImageFix'/%3e %3cfeColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0' result='hardAlpha'/%3e %3cfeOffset dx='0.533333' dy='0.266667'/%3e %3cfeGaussianBlur stdDeviation='0.4'/%3e %3cfeColorMatrix type='matrix' values='0 0 0 0 0.0901961 0 0 0 0 0.360784 0 0 0 0 0.921569 0 0 0 0.8 0'/%3e %3cfeBlend mode='normal' in2='BackgroundImageFix' result='effect1_dropShadow_2519_51698'/%3e %3cfeBlend mode='normal' in='SourceGraphic' in2='effect1_dropShadow_2519_51698' result='shape'/%3e %3c/filter%3e %3clinearGradient id='paint0_linear_2519_51698' x1='20.75' y1='10.214' x2='18.4467' y2='10.214' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%231E6FFF'/%3e %3cstop offset='1' stop-color='%23144DEB'/%3e %3c/linearGradient%3e %3clinearGradient id='paint1_linear_2519_51698' x1='19.1464' y1='-2.44868' x2='1.21081' y2='19.2317' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%2334A4FF'/%3e %3cstop offset='0.999235' stop-color='%231E6FFF'/%3e %3c/linearGradient%3e %3c/defs%3e %3c/svg%3e"},94312:function(e,t,n){n.r(t),n.d(t,{ReactComponent:function(){return d}});var r,o,i,a,s,c,l=n(87363);function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(this,arguments)}function d(e){return l.createElement("svg",u({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=l.createElement("g",{filter:"url(#application-vnd_tdocs-apps_flowchart_svg__filter0_i_2519_51607)"},l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.688 8.387c0-.593.475-1.075 1.06-1.075h11.94c.587 0 1.062.482 1.062 1.075v11.288c0 .594-.475 1.075-1.061 1.075H7.749a1.068 1.068 0 01-1.061-1.075V8.387z",fill:"url(#application-vnd_tdocs-apps_flowchart_svg__paint0_linear_2519_51607)"}))),o||(o=l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.813 3.25c-.69 0-1.25.56-1.25 1.25v15c0 .69.56 1.25 1.25 1.25h15v-.011a1.094 1.094 0 01-1.239-1.239h-.011v-15c0-.69-.56-1.25-1.25-1.25h-12.5z",fill:"url(#application-vnd_tdocs-apps_flowchart_svg__paint1_linear_2519_51607)"})),i||(i=l.createElement("g",{filter:"url(#application-vnd_tdocs-apps_flowchart_svg__filter1_d_2519_51607)"},l.createElement("path",{d:"M13.91 10.479v1.332H9.638a.764.764 0 00-.761.765c0 .413.325.75.732.766h2.876c1.152 0 2.085.94 2.085 2.098a2.092 2.092 0 01-2.043 2.098H8.216v-1.332h4.27c.42 0 .761-.343.761-.766a.764.764 0 00-.732-.765H9.64a2.092 2.092 0 01-2.086-2.099c0-1.144.912-2.075 2.044-2.097H13.909z",fill:"#D2DDFF"}))),a||(a=l.createElement("g",{filter:"url(#application-vnd_tdocs-apps_flowchart_svg__filter2_d_2519_51607)"},l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.645 9.813l1.324 1.332-1.324 1.331-1.324-1.332 1.324-1.332z",fill:"#F1F4FF"}))),s||(s=l.createElement("g",{filter:"url(#application-vnd_tdocs-apps_flowchart_svg__filter3_d_2519_51607)"},l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.156 15.94v1.998h1.986V15.94H7.156z",fill:"#F1F4FF"}))),c||(c=l.createElement("defs",null,l.createElement("filter",{id:"application-vnd_tdocs-apps_flowchart_svg__filter0_i_2519_51607",x:6.688,y:7.313,width:14.863,height:13.438,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},l.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),l.createElement("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),l.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),l.createElement("feOffset",{dx:.8}),l.createElement("feGaussianBlur",{stdDeviation:.4}),l.createElement("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:-1,k3:1}),l.createElement("feColorMatrix",{values:"0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.24 0"}),l.createElement("feBlend",{in2:"shape",result:"effect1_innerShadow_2519_51607"})),l.createElement("filter",{id:"application-vnd_tdocs-apps_flowchart_svg__filter1_d_2519_51607",x:7.287,y:9.945,width:8.618,height:8.659,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},l.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),l.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),l.createElement("feOffset",{dx:.533,dy:.267}),l.createElement("feGaussianBlur",{stdDeviation:.4}),l.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0.14902 0 0 0 0 0.521569 0 0 0 0.36 0"}),l.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2519_51607"}),l.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2519_51607",result:"shape"})),l.createElement("filter",{id:"application-vnd_tdocs-apps_flowchart_svg__filter2_d_2519_51607",x:12.321,y:9.813,width:4.248,height:4.264,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},l.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),l.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),l.createElement("feOffset",{dx:.8,dy:.8}),l.createElement("feGaussianBlur",{stdDeviation:.4}),l.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0.190543 0 0 0 0 0.606346 0 0 0 0.254398 0"}),l.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2519_51607"}),l.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2519_51607",result:"shape"})),l.createElement("filter",{id:"application-vnd_tdocs-apps_flowchart_svg__filter3_d_2519_51607",x:7.156,y:15.94,width:3.586,height:3.598,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},l.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),l.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),l.createElement("feOffset",{dx:.8,dy:.8}),l.createElement("feGaussianBlur",{stdDeviation:.4}),l.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0.190543 0 0 0 0 0.606346 0 0 0 0.254398 0"}),l.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2519_51607"}),l.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2519_51607",result:"shape"})),l.createElement("linearGradient",{id:"application-vnd_tdocs-apps_flowchart_svg__paint0_linear_2519_51607",x1:21.786,y1:12.193,x2:17.937,y2:12.193,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#3E53EB"}),l.createElement("stop",{offset:1,stopColor:"#2E3BEB"})),l.createElement("linearGradient",{id:"application-vnd_tdocs-apps_flowchart_svg__paint1_linear_2519_51607",x1:7.157,y1:-2.658,x2:-5.022,y2:15.418,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#7693FF"}),l.createElement("stop",{offset:1,stopColor:"#546DFF"})))))}t.default="//docs.gtimg.com/doc/img/application-vnd.tdocs-apps.flowchart-e2f14c02.svg"},65678:function(e,t,n){n.r(t),n.d(t,{ReactComponent:function(){return c}});var r,o,i,a=n(87363);function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s.apply(this,arguments)}function c(e){return a.createElement("svg",s({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.25 4.987a.8.8 0 01.8-.8h6.507c.188 0 .37.07.51.198l2.183 1.99h-10V4.987z",fill:"url(#application-vnd_tdocs-apps_folder_svg__paint0_linear_2519_51727)"})),o||(o=a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.25 6.375h16.433c.59 0 1.067.478 1.067 1.067v10.991c0 .59-.478 1.067-1.067 1.067H4.317c-.59 0-1.067-.478-1.067-1.067V6.375z",fill:"url(#application-vnd_tdocs-apps_folder_svg__paint1_linear_2519_51727)"})),i||(i=a.createElement("defs",null,a.createElement("linearGradient",{id:"application-vnd_tdocs-apps_folder_svg__paint0_linear_2519_51727",x1:5.283,y1:4.188,x2:5.283,y2:6.442,gradientUnits:"userSpaceOnUse"},a.createElement("stop",{stopColor:"#2DA5EB"}),a.createElement("stop",{offset:1,stopColor:"#2198EB"})),a.createElement("linearGradient",{id:"application-vnd_tdocs-apps_folder_svg__paint1_linear_2519_51727",x1:11.462,y1:-.188,x2:-.931,y2:17.353,gradientUnits:"userSpaceOnUse"},a.createElement("stop",{stopColor:"#4DD1FF"}),a.createElement("stop",{offset:1,stopColor:"#3CBFFF"})))))}t.default="data:image/svg+xml,%3csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M3.25 4.9875C3.25 4.54567 3.60817 4.1875 4.05 4.1875H10.5569C10.7455 4.1875 10.9273 4.25792 11.0666 4.38497L13.25 6.375H3.25V4.9875Z' fill='url(%23paint0_linear_2519_51727)'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M3.25 6.375H19.6833C20.2724 6.375 20.75 6.85256 20.75 7.44167V18.4333C20.75 19.0224 20.2724 19.5 19.6833 19.5H4.31667C3.72756 19.5 3.25 19.0224 3.25 18.4333V6.375Z' fill='url(%23paint1_linear_2519_51727)'/%3e %3cdefs%3e %3clinearGradient id='paint0_linear_2519_51727' x1='5.28321' y1='4.1875' x2='5.28321' y2='6.44182' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%232DA5EB'/%3e %3cstop offset='1' stop-color='%232198EB'/%3e %3c/linearGradient%3e %3clinearGradient id='paint1_linear_2519_51727' x1='11.4618' y1='-0.1875' x2='-0.931299' y2='17.353' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%234DD1FF'/%3e %3cstop offset='1' stop-color='%233CBFFF'/%3e %3c/linearGradient%3e %3c/defs%3e %3c/svg%3e"},63134:function(e,t,n){n.r(t),n.d(t,{ReactComponent:function(){return l}});var r,o,i,a,s=n(87363);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}function l(e){return s.createElement("svg",c({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.688 8.387c0-.593.475-1.075 1.06-1.075h11.94c.587 0 1.062.482 1.062 1.075v11.288c0 .594-.475 1.075-1.061 1.075H7.749a1.068 1.068 0 01-1.061-1.075V8.387z",fill:"url(#application-vnd_tdocs-apps_form_svg__paint0_linear_2519_51664)"})),o||(o=s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.813 3.25c-.69 0-1.25.56-1.25 1.25v15c0 .69.56 1.25 1.25 1.25h15v-.011a1.094 1.094 0 01-1.239-1.239h-.011v-15c0-.69-.56-1.25-1.25-1.25h-12.5z",fill:"url(#application-vnd_tdocs-apps_form_svg__paint1_linear_2519_51664)"})),i||(i=s.createElement("g",{filter:"url(#application-vnd_tdocs-apps_form_svg__filter0_d_2519_51664)"},s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.709 15.598l-.016.015 1.236 1.23 5.352-5.331-1.235-1.23-4.125 4.109-1.865-1.856-1.212 1.207 1.865 1.856z",fill:"#FFFBE0"}))),a||(a=s.createElement("defs",null,s.createElement("linearGradient",{id:"application-vnd_tdocs-apps_form_svg__paint0_linear_2519_51664",x1:20.731,y1:11.559,x2:18.03,y2:11.559,gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#EB9000"}),s.createElement("stop",{offset:1,stopColor:"#EB7E00"})),s.createElement("linearGradient",{id:"application-vnd_tdocs-apps_form_svg__paint1_linear_2519_51664",x1:7.159,y1:-3.003,x2:-5.614,y2:13.503,gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#FFCD00"}),s.createElement("stop",{offset:.999,stopColor:"#FFAB00"})),s.createElement("filter",{id:"application-vnd_tdocs-apps_form_svg__filter0_d_2519_51664",x:6.622,y:9.837,width:9.771,height:7.896,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),s.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),s.createElement("feOffset",{dx:.444,dy:.222}),s.createElement("feGaussianBlur",{stdDeviation:.333}),s.createElement("feColorMatrix",{values:"0 0 0 0 0.510162 0 0 0 0 0.263303 0 0 0 0 0 0 0 0 0.207359 0"}),s.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2519_51664"}),s.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2519_51664",result:"shape"})))))}t.default="data:image/svg+xml,%3csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M6.6875 8.3875C6.6875 7.79379 7.16267 7.3125 7.74882 7.3125H19.6887C20.2748 7.3125 20.75 7.79379 20.75 8.3875V19.675C20.75 20.2687 20.2748 20.75 19.6887 20.75H7.74882C7.16267 20.75 6.6875 20.2687 6.6875 19.675V8.3875Z' fill='url(%23paint0_linear_2519_51664)'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M4.8125 3.25C4.12214 3.25 3.5625 3.80964 3.5625 4.5V19.5C3.5625 20.1904 4.12214 20.75 4.8125 20.75H18.5625H19.6562H19.8125V20.7389C19.7615 20.7462 19.7093 20.75 19.6562 20.75C19.0522 20.75 18.5625 20.2603 18.5625 19.6562C18.5625 19.6032 18.5663 19.551 18.5736 19.5H18.5625V4.5C18.5625 3.80964 18.0029 3.25 17.3125 3.25H4.8125Z' fill='url(%23paint1_linear_2519_51664)'/%3e %3cg filter='url(%23filter0_d_2519_51664)'%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M8.70882 15.5979L8.69334 15.6133L9.92857 16.8438L15.2812 11.5117L14.046 10.2812L9.92058 14.3908L8.0561 12.5353L6.84375 13.7418L8.70882 15.5979Z' fill='%23FFFBE0'/%3e %3c/g%3e %3cdefs%3e %3cfilter id='filter0_d_2519_51664' x='6.62153' y='9.83681' width='9.77083' height='7.89583' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'%3e %3cfeFlood flood-opacity='0' result='BackgroundImageFix'/%3e %3cfeColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0' result='hardAlpha'/%3e %3cfeOffset dx='0.444444' dy='0.222222'/%3e %3cfeGaussianBlur stdDeviation='0.333333'/%3e %3cfeColorMatrix type='matrix' values='0 0 0 0 0.510162 0 0 0 0 0.263303 0 0 0 0 0 0 0 0 0.207359 0'/%3e %3cfeBlend mode='normal' in2='BackgroundImageFix' result='effect1_dropShadow_2519_51664'/%3e %3cfeBlend mode='normal' in='SourceGraphic' in2='effect1_dropShadow_2519_51664' result='shape'/%3e %3c/filter%3e %3clinearGradient id='paint0_linear_2519_51664' x1='20.7311' y1='11.5591' x2='18.0296' y2='11.5591' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%23EB9000'/%3e %3cstop offset='1' stop-color='%23EB7E00'/%3e %3c/linearGradient%3e %3clinearGradient id='paint1_linear_2519_51664' x1='7.15915' y1='-3.00326' x2='-5.61447' y2='13.5029' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%23FFCD00'/%3e %3cstop offset='0.999314' stop-color='%23FFAB00'/%3e %3c/linearGradient%3e %3c/defs%3e %3c/svg%3e"},42914:function(e,t,n){n.r(t),n.d(t,{ReactComponent:function(){return p}});var r,o,i,a,s,c,l,u=n(87363);function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d.apply(this,arguments)}function p(e){return u.createElement("svg",d({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=u.createElement("g",{filter:"url(#application-vnd_tdocs-apps_mind_svg__filter0_i_2519_51653)"},u.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.688 8.387c0-.593.475-1.075 1.06-1.075h11.94c.587 0 1.062.482 1.062 1.075v11.288c0 .594-.475 1.075-1.061 1.075H7.749a1.068 1.068 0 01-1.061-1.075V8.387z",fill:"url(#application-vnd_tdocs-apps_mind_svg__paint0_linear_2519_51653)"}))),o||(o=u.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.813 3.25c-.69 0-1.25.56-1.25 1.25v15c0 .69.56 1.25 1.25 1.25h15v-.011a1.094 1.094 0 01-1.239-1.239h-.011v-15c0-.69-.56-1.25-1.25-1.25h-12.5z",fill:"url(#application-vnd_tdocs-apps_mind_svg__paint1_linear_2519_51653)"})),i||(i=u.createElement("g",{filter:"url(#application-vnd_tdocs-apps_mind_svg__filter1_d_2519_51653)"},u.createElement("path",{d:"M14.344 10.594v1.262h-3.007c-1.156 0-2.092.904-2.092 2.019 0 1.102.914 1.998 2.05 2.019h3.049v1.262h-3.007c-1.878 0-3.4-1.469-3.4-3.281 0-1.794 1.492-3.252 3.343-3.28l.057-.001h3.007z",fill:"#E5D7FF"}))),a||(a=u.createElement("g",{filter:"url(#application-vnd_tdocs-apps_mind_svg__filter2_d_2519_51653)"},u.createElement("rect",{x:6.688,y:12.156,width:3.438,height:3.438,rx:1.719,fill:"#fff"}))),s||(s=u.createElement("g",{filter:"url(#application-vnd_tdocs-apps_mind_svg__filter3_d_2519_51653)"},u.createElement("circle",{cx:14.344,cy:11.219,fill:"#fff",r:1.094}))),c||(c=u.createElement("g",{filter:"url(#application-vnd_tdocs-apps_mind_svg__filter4_d_2519_51653)"},u.createElement("circle",{cx:14.344,cy:16.531,r:1.094,fill:"#fff"}))),l||(l=u.createElement("defs",null,u.createElement("filter",{id:"application-vnd_tdocs-apps_mind_svg__filter0_i_2519_51653",x:6.688,y:7.313,width:14.729,height:13.438,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},u.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),u.createElement("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),u.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),u.createElement("feOffset",{dx:.667}),u.createElement("feGaussianBlur",{stdDeviation:.333}),u.createElement("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:-1,k3:1}),u.createElement("feColorMatrix",{values:"0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.24 0"}),u.createElement("feBlend",{in2:"shape",result:"effect1_innerShadow_2519_51653"})),u.createElement("filter",{id:"application-vnd_tdocs-apps_mind_svg__filter1_d_2519_51653",x:7.715,y:10.149,width:7.74,height:7.896,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},u.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),u.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),u.createElement("feOffset",{dx:.444,dy:.222}),u.createElement("feGaussianBlur",{stdDeviation:.333}),u.createElement("feColorMatrix",{values:"0 0 0 0 0.537255 0 0 0 0 0.329412 0 0 0 0 0.729412 0 0 0 0.68 0"}),u.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2519_51653"}),u.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2519_51653",result:"shape"})),u.createElement("filter",{id:"application-vnd_tdocs-apps_mind_svg__filter2_d_2519_51653",x:6.688,y:12.156,width:4.771,height:4.771,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},u.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),u.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),u.createElement("feOffset",{dx:.667,dy:.667}),u.createElement("feGaussianBlur",{stdDeviation:.333}),u.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.12276 0"}),u.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2519_51653"}),u.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2519_51653",result:"shape"})),u.createElement("filter",{id:"application-vnd_tdocs-apps_mind_svg__filter3_d_2519_51653",x:13.028,y:9.68,width:3.521,height:3.521,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},u.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),u.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),u.createElement("feOffset",{dx:.444,dy:.222}),u.createElement("feGaussianBlur",{stdDeviation:.333}),u.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.12276 0"}),u.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2519_51653"}),u.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2519_51653",result:"shape"})),u.createElement("filter",{id:"application-vnd_tdocs-apps_mind_svg__filter4_d_2519_51653",x:13.028,y:14.993,width:3.521,height:3.521,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},u.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),u.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),u.createElement("feOffset",{dx:.444,dy:.222}),u.createElement("feGaussianBlur",{stdDeviation:.333}),u.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.12276 0"}),u.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2519_51653"}),u.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2519_51653",result:"shape"})),u.createElement("linearGradient",{id:"application-vnd_tdocs-apps_mind_svg__paint0_linear_2519_51653",x1:20.75,y1:12.662,x2:17.885,y2:12.662,gradientUnits:"userSpaceOnUse"},u.createElement("stop",{offset:.001,stopColor:"#A55BF5"}),u.createElement("stop",{offset:1,stopColor:"#833FDF"})),u.createElement("linearGradient",{id:"application-vnd_tdocs-apps_mind_svg__paint1_linear_2519_51653",x1:7.115,y1:-.348,x2:-.46,y2:16.756,gradientUnits:"userSpaceOnUse"},u.createElement("stop",{stopColor:"#C87FFA"}),u.createElement("stop",{offset:1,stopColor:"#A55BF5"})))))}t.default="//docs.gtimg.com/doc/img/application-vnd.tdocs-apps.mind-af23572b.svg"},33824:function(e,t,n){n.r(t),n.d(t,{ReactComponent:function(){return u}});var r,o,i,a,s,c=n(87363);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}function u(e){return c.createElement("svg",l({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=c.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.688 8.387c0-.593.475-1.075 1.06-1.075h11.94c.587 0 1.062.482 1.062 1.075v11.288c0 .594-.475 1.075-1.061 1.075H7.749a1.068 1.068 0 01-1.061-1.075V8.387z",fill:"url(#application-vnd_tdocs-apps_rec_svg__paint0_linear_2519_51637)"})),o||(o=c.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.813 3.25c-.69 0-1.25.56-1.25 1.25v15c0 .69.56 1.25 1.25 1.25h15v-.011a1.094 1.094 0 01-1.239-1.239h-.011v-15c0-.69-.56-1.25-1.25-1.25h-12.5z",fill:"url(#application-vnd_tdocs-apps_rec_svg__paint1_linear_2519_51637)"})),i||(i=c.createElement("g",{filter:"url(#application-vnd_tdocs-apps_rec_svg__filter0_d_2519_51637)"},c.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.063 16.156c-1.289 0-2.45-.772-3-1.968l-1.22.536.026.055a4.671 4.671 0 003.534 2.637v.834h1.319v-.834c1.552-.225 2.89-1.237 3.56-2.689l-1.22-.537-.024.051c-.56 1.166-1.705 1.915-2.975 1.915z",fill:"#B3D9FF"}))),a||(a=c.createElement("g",{filter:"url(#application-vnd_tdocs-apps_rec_svg__filter1_d_2519_51637)"},c.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.063 8.563c-1.381 0-2.5 1.124-2.5 2.511v1.851a2.506 2.506 0 002.5 2.512c1.38 0 2.5-1.124 2.5-2.511v-1.851a2.506 2.506 0 00-2.5-2.512zm0 1.322c.654 0 1.184.532 1.184 1.19v1.85c0 .658-.53 1.19-1.184 1.19a1.187 1.187 0 01-1.185-1.19v-1.85c0-.658.53-1.19 1.185-1.19z",fill:"#D3F3FF"}))),s||(s=c.createElement("defs",null,c.createElement("linearGradient",{id:"application-vnd_tdocs-apps_rec_svg__paint0_linear_2519_51637",x1:20.75,y1:10.214,x2:18.447,y2:10.214,gradientUnits:"userSpaceOnUse"},c.createElement("stop",{stopColor:"#1E6FFF"}),c.createElement("stop",{offset:1,stopColor:"#144DEB"})),c.createElement("linearGradient",{id:"application-vnd_tdocs-apps_rec_svg__paint1_linear_2519_51637",x1:19.146,y1:-2.449,x2:1.211,y2:19.232,gradientUnits:"userSpaceOnUse"},c.createElement("stop",{stopColor:"#34A4FF"}),c.createElement("stop",{offset:.999,stopColor:"#1E6FFF"})),c.createElement("filter",{id:"application-vnd_tdocs-apps_rec_svg__filter0_d_2519_51637",x:6.577,y:13.654,width:10.037,height:5.662,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},c.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),c.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),c.createElement("feOffset",{dx:.533,dy:.267}),c.createElement("feGaussianBlur",{stdDeviation:.4}),c.createElement("feColorMatrix",{values:"0 0 0 0 0.0901961 0 0 0 0 0.360784 0 0 0 0 0.921569 0 0 0 0.8 0"}),c.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2519_51637"}),c.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2519_51637",result:"shape"})),c.createElement("filter",{id:"application-vnd_tdocs-apps_rec_svg__filter1_d_2519_51637",x:8.296,y:8.029,width:6.6,height:8.475,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},c.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),c.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),c.createElement("feOffset",{dx:.533,dy:.267}),c.createElement("feGaussianBlur",{stdDeviation:.4}),c.createElement("feColorMatrix",{values:"0 0 0 0 0.0901961 0 0 0 0 0.360784 0 0 0 0 0.921569 0 0 0 0.8 0"}),c.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2519_51637"}),c.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2519_51637",result:"shape"})))))}t.default="data:image/svg+xml,%3csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M6.6875 8.3875C6.6875 7.79379 7.16267 7.3125 7.74882 7.3125H19.6887C20.2748 7.3125 20.75 7.79379 20.75 8.3875V19.675C20.75 20.2687 20.2748 20.75 19.6887 20.75H7.74882C7.16267 20.75 6.6875 20.2687 6.6875 19.675V8.3875Z' fill='url(%23paint0_linear_2519_51637)'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M4.8125 3.25C4.12214 3.25 3.5625 3.80964 3.5625 4.5V19.5C3.5625 20.1904 4.12214 20.75 4.8125 20.75H18.5625H19.6562H19.8125V20.7389C19.7615 20.7462 19.7093 20.75 19.6562 20.75C19.0522 20.75 18.5625 20.2603 18.5625 19.6562C18.5625 19.6032 18.5663 19.551 18.5736 19.5H18.5625V4.5C18.5625 3.80964 18.0029 3.25 17.3125 3.25H4.8125Z' fill='url(%23paint1_linear_2519_51637)'/%3e %3cg filter='url(%23filter0_d_2519_51637)'%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M11.0631 16.156C9.77407 16.156 8.61313 15.3837 8.06275 14.1875L6.84375 14.7243L6.86945 14.7792C7.54609 16.2026 8.86976 17.1931 10.4033 17.4161V18.25H11.7217V17.4163C13.2744 17.1909 14.6122 16.1789 15.2812 14.7271L14.0626 14.1896L14.0383 14.2413C13.4781 15.4069 12.3328 16.156 11.0631 16.156Z' fill='%23B3D9FF'/%3e %3c/g%3e %3cg filter='url(%23filter1_d_2519_51637)'%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M11.0625 8.5625C9.68179 8.5625 8.5625 9.68717 8.5625 11.0745V12.9255C8.5625 14.3128 9.68179 15.4375 11.0625 15.4375C12.4432 15.4375 13.5625 14.3128 13.5625 12.9255V11.0745C13.5625 9.68717 12.4432 8.5625 11.0625 8.5625ZM11.0626 9.8846C11.7166 9.8846 12.2468 10.4173 12.2468 11.0745V12.9255C12.2468 13.5826 11.7166 14.1154 11.0626 14.1154C10.4085 14.1154 9.87834 13.5826 9.87834 12.9255V11.0745C9.87834 10.4173 10.4085 9.8846 11.0626 9.8846Z' fill='%23D3F3FF'/%3e %3c/g%3e %3cdefs%3e %3cfilter id='filter0_d_2519_51637' x='6.57708' y='13.6542' width='10.0375' height='5.6625' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'%3e %3cfeFlood flood-opacity='0' result='BackgroundImageFix'/%3e %3cfeColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0' result='hardAlpha'/%3e %3cfeOffset dx='0.533333' dy='0.266667'/%3e %3cfeGaussianBlur stdDeviation='0.4'/%3e %3cfeColorMatrix type='matrix' values='0 0 0 0 0.0901961 0 0 0 0 0.360784 0 0 0 0 0.921569 0 0 0 0.8 0'/%3e %3cfeBlend mode='normal' in2='BackgroundImageFix' result='effect1_dropShadow_2519_51637'/%3e %3cfeBlend mode='normal' in='SourceGraphic' in2='effect1_dropShadow_2519_51637' result='shape'/%3e %3c/filter%3e %3cfilter id='filter1_d_2519_51637' x='8.29583' y='8.02917' width='6.6' height='8.475' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'%3e %3cfeFlood flood-opacity='0' result='BackgroundImageFix'/%3e %3cfeColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0' result='hardAlpha'/%3e %3cfeOffset dx='0.533333' dy='0.266667'/%3e %3cfeGaussianBlur stdDeviation='0.4'/%3e %3cfeColorMatrix type='matrix' values='0 0 0 0 0.0901961 0 0 0 0 0.360784 0 0 0 0 0.921569 0 0 0 0.8 0'/%3e %3cfeBlend mode='normal' in2='BackgroundImageFix' result='effect1_dropShadow_2519_51637'/%3e %3cfeBlend mode='normal' in='SourceGraphic' in2='effect1_dropShadow_2519_51637' result='shape'/%3e %3c/filter%3e %3clinearGradient id='paint0_linear_2519_51637' x1='20.75' y1='10.214' x2='18.4467' y2='10.214' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%231E6FFF'/%3e %3cstop offset='1' stop-color='%23144DEB'/%3e %3c/linearGradient%3e %3clinearGradient id='paint1_linear_2519_51637' x1='19.1464' y1='-2.44868' x2='1.21081' y2='19.2317' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%2334A4FF'/%3e %3cstop offset='0.999235' stop-color='%231E6FFF'/%3e %3c/linearGradient%3e %3c/defs%3e %3c/svg%3e"},40194:function(e,t,n){n.r(t),n.d(t,{ReactComponent:function(){return l}});var r,o,i,a,s=n(87363);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}function l(e){return s.createElement("svg",c({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.25 4.987a.8.8 0 01.8-.8h6.507c.188 0 .37.07.51.198l2.183 1.99h-10V4.987z",fill:"url(#application-vnd_tdocs-apps_share-folder_svg__paint0_linear_2527_52092)"})),o||(o=s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.25 6.375h16.433c.59 0 1.067.478 1.067 1.067v10.991c0 .59-.478 1.067-1.067 1.067H4.317c-.59 0-1.067-.478-1.067-1.067V6.375z",fill:"url(#application-vnd_tdocs-apps_share-folder_svg__paint1_linear_2527_52092)"})),i||(i=s.createElement("g",{filter:"url(#application-vnd_tdocs-apps_share-folder_svg__filter0_d_2527_52092)"},s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.667 13.996c.383.182.616.538.608.91v1.04h-6.4v-1.04c-.009-.372.225-.728.608-.91l2.033-1.012-.001-.088a.493.493 0 00-.197-.39 1.118 1.118 0 01-.46-.883l-.01-.658c-.008-.629.522-1.144 1.182-1.152h.052c.66-.008 1.202.495 1.21 1.124l.01.657c.004.37-.178.7-.463.911a.492.492 0 00-.197.404l.001.08 2.024 1.007z",fill:"#ECFCFF"}))),a||(a=s.createElement("defs",null,s.createElement("linearGradient",{id:"application-vnd_tdocs-apps_share-folder_svg__paint0_linear_2527_52092",x1:5.283,y1:4.188,x2:5.283,y2:6.442,gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#2DA5EB"}),s.createElement("stop",{offset:1,stopColor:"#2198EB"})),s.createElement("linearGradient",{id:"application-vnd_tdocs-apps_share-folder_svg__paint1_linear_2527_52092",x1:11.462,y1:-.188,x2:-.931,y2:17.353,gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#4DD1FF"}),s.createElement("stop",{offset:1,stopColor:"#3CBFFF"})),s.createElement("filter",{id:"application-vnd_tdocs-apps_share-folder_svg__filter0_d_2527_52092",x:8.608,y:9.279,width:8,height:7.733,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),s.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),s.createElement("feOffset",{dx:.533,dy:.267}),s.createElement("feGaussianBlur",{stdDeviation:.4}),s.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0"}),s.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2527_52092"}),s.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2527_52092",result:"shape"})))))}t.default="data:image/svg+xml,%3csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M3.25 4.9875C3.25 4.54567 3.60817 4.1875 4.05 4.1875H10.5569C10.7455 4.1875 10.9273 4.25792 11.0666 4.38497L13.25 6.375H3.25V4.9875Z' fill='url(%23paint0_linear_2527_52092)'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M3.25 6.375H19.6833C20.2724 6.375 20.75 6.85256 20.75 7.44167V18.4333C20.75 19.0224 20.2724 19.5 19.6833 19.5H4.31667C3.72756 19.5 3.25 19.0224 3.25 18.4333V6.375Z' fill='url(%23paint1_linear_2527_52092)'/%3e %3cg filter='url(%23filter0_d_2527_52092)'%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M14.6673 13.996C15.0501 14.1776 15.2828 14.5341 15.2748 14.9066V15.9458H8.87524V14.9066C8.86636 14.5341 9.09993 14.1776 9.4827 13.996L11.5162 12.9843L11.5146 12.8964C11.5128 12.7452 11.4435 12.5983 11.3183 12.5054C11.0421 12.3001 10.8618 11.9817 10.8574 11.6227L10.8485 10.9647C10.8405 10.3363 11.3698 9.82103 12.0296 9.81343L12.082 9.81258C12.7428 9.80498 13.2845 10.3084 13.2925 10.9368L13.3014 11.594C13.3058 11.9639 13.1238 12.2942 12.8387 12.5054C12.709 12.6008 12.6398 12.7528 12.6415 12.9091L12.6432 12.989L14.6673 13.996Z' fill='%23ECFCFF'/%3e %3c/g%3e %3cdefs%3e %3cfilter id='filter0_d_2527_52092' x='8.60833' y='9.27917' width='7.9999' height='7.7333' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'%3e %3cfeFlood flood-opacity='0' result='BackgroundImageFix'/%3e %3cfeColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0' result='hardAlpha'/%3e %3cfeOffset dx='0.533333' dy='0.266667'/%3e %3cfeGaussianBlur stdDeviation='0.4'/%3e %3cfeColorMatrix type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0'/%3e %3cfeBlend mode='normal' in2='BackgroundImageFix' result='effect1_dropShadow_2527_52092'/%3e %3cfeBlend mode='normal' in='SourceGraphic' in2='effect1_dropShadow_2527_52092' result='shape'/%3e %3c/filter%3e %3clinearGradient id='paint0_linear_2527_52092' x1='5.28321' y1='4.1875' x2='5.28321' y2='6.44182' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%232DA5EB'/%3e %3cstop offset='1' stop-color='%232198EB'/%3e %3c/linearGradient%3e %3clinearGradient id='paint1_linear_2527_52092' x1='11.4618' y1='-0.1875' x2='-0.931299' y2='17.353' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%234DD1FF'/%3e %3cstop offset='1' stop-color='%233CBFFF'/%3e %3c/linearGradient%3e %3c/defs%3e %3c/svg%3e"},19317:function(e,t,n){n.r(t),n.d(t,{ReactComponent:function(){return p}});var r,o,i,a,s,c,l,u=n(87363);function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d.apply(this,arguments)}function p(e){return u.createElement("svg",d({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=u.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.688 8.387c0-.593.475-1.075 1.06-1.075h11.94c.587 0 1.062.482 1.062 1.075v11.288c0 .594-.475 1.075-1.061 1.075H7.749a1.068 1.068 0 01-1.061-1.075V8.387z",fill:"url(#application-vnd_tdocs-apps_sheet_svg__paint0_linear_2519_51687)"})),o||(o=u.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.813 3.25c-.69 0-1.25.56-1.25 1.25v15c0 .69.56 1.25 1.25 1.25h15v-.011a1.094 1.094 0 01-1.239-1.239h-.011v-15c0-.69-.56-1.25-1.25-1.25h-12.5z",fill:"url(#application-vnd_tdocs-apps_sheet_svg__paint1_linear_2519_51687)"})),i||(i=u.createElement("g",{filter:"url(#application-vnd_tdocs-apps_sheet_svg__filter0_d_2519_51687)"},u.createElement("path",{fill:"#A3F0D4",d:"M11.688 15.906h4.375v1.719h-4.375z"}))),a||(a=u.createElement("g",{filter:"url(#application-vnd_tdocs-apps_sheet_svg__filter1_d_2519_51687)"},u.createElement("path",{fill:"#A3F0D4",d:"M6.063 15.906h4.375v1.719H6.063z"}))),s||(s=u.createElement("g",{filter:"url(#application-vnd_tdocs-apps_sheet_svg__filter2_d_2519_51687)"},u.createElement("path",{fill:"#E0FBF1",d:"M11.688 12.938h4.375v1.719h-4.375z"}))),c||(c=u.createElement("g",{filter:"url(#application-vnd_tdocs-apps_sheet_svg__filter3_d_2519_51687)"},u.createElement("path",{fill:"#E0FBF1",d:"M6.063 12.938h4.375v1.719H6.063z"}))),l||(l=u.createElement("defs",null,u.createElement("filter",{id:"application-vnd_tdocs-apps_sheet_svg__filter0_d_2519_51687",x:11.421,y:15.373,width:5.975,height:3.319,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},u.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),u.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),u.createElement("feOffset",{dx:.533,dy:.267}),u.createElement("feGaussianBlur",{stdDeviation:.4}),u.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0"}),u.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2519_51687"}),u.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2519_51687",result:"shape"})),u.createElement("filter",{id:"application-vnd_tdocs-apps_sheet_svg__filter1_d_2519_51687",x:5.796,y:15.373,width:5.975,height:3.319,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},u.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),u.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),u.createElement("feOffset",{dx:.533,dy:.267}),u.createElement("feGaussianBlur",{stdDeviation:.4}),u.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0"}),u.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2519_51687"}),u.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2519_51687",result:"shape"})),u.createElement("filter",{id:"application-vnd_tdocs-apps_sheet_svg__filter2_d_2519_51687",x:11.421,y:12.404,width:5.975,height:3.319,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},u.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),u.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),u.createElement("feOffset",{dx:.533,dy:.267}),u.createElement("feGaussianBlur",{stdDeviation:.4}),u.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0"}),u.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2519_51687"}),u.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2519_51687",result:"shape"})),u.createElement("filter",{id:"application-vnd_tdocs-apps_sheet_svg__filter3_d_2519_51687",x:5.796,y:12.404,width:5.975,height:3.319,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},u.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),u.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),u.createElement("feOffset",{dx:.533,dy:.267}),u.createElement("feGaussianBlur",{stdDeviation:.4}),u.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0"}),u.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2519_51687"}),u.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2519_51687",result:"shape"})),u.createElement("linearGradient",{id:"application-vnd_tdocs-apps_sheet_svg__paint0_linear_2519_51687",x1:20.75,y1:11.889,x2:17.523,y2:11.889,gradientUnits:"userSpaceOnUse"},u.createElement("stop",{stopColor:"#008F4B"}),u.createElement("stop",{offset:1,stopColor:"#00833C"})),u.createElement("linearGradient",{id:"application-vnd_tdocs-apps_sheet_svg__paint1_linear_2519_51687",x1:8.57,y1:-3.273,x2:-4.689,y2:12.698,gradientUnits:"userSpaceOnUse"},u.createElement("stop",{stopColor:"#00D689"}),u.createElement("stop",{offset:1,stopColor:"#00AA5B"})))))}t.default="//docs.gtimg.com/doc/img/application-vnd.tdocs-apps.sheet-e1965210.svg"},1611:function(e,t,n){n.r(t),n.d(t,{ReactComponent:function(){return u}});var r,o,i,a,s,c=n(87363);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}function u(e){return c.createElement("svg",l({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=c.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.688 8.387c0-.593.475-1.075 1.06-1.075h11.94c.587 0 1.062.482 1.062 1.075v11.288c0 .594-.475 1.075-1.061 1.075H7.749a1.068 1.068 0 01-1.061-1.075V8.387z",fill:"url(#application-vnd_tdocs-apps_slide_svg__paint0_linear_2519_51673)"})),o||(o=c.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.813 3.25c-.69 0-1.25.56-1.25 1.25v15c0 .69.56 1.25 1.25 1.25h15v-.011a1.094 1.094 0 01-1.239-1.239h-.011v-15c0-.69-.56-1.25-1.25-1.25h-12.5z",fill:"url(#application-vnd_tdocs-apps_slide_svg__paint1_linear_2519_51673)"})),i||(i=c.createElement("g",{filter:"url(#application-vnd_tdocs-apps_slide_svg__filter0_d_2519_51673)"},c.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15.44 13.89v-.015-.014.028zm-.002.141a4.376 4.376 0 01-4.374 4.219 4.376 4.376 0 01-.156-8.747v4.528h4.53z",fill:"#FFD7BF"}))),a||(a=c.createElement("g",{filter:"url(#application-vnd_tdocs-apps_slide_svg__filter1_d_2519_51673)"},c.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15.37 13.094a4.38 4.38 0 00-3.524-3.524v3.524h3.525z",fill:"#fff"}))),s||(s=c.createElement("defs",null,c.createElement("linearGradient",{id:"application-vnd_tdocs-apps_slide_svg__paint0_linear_2519_51673",x1:20.75,y1:11.481,x2:18.375,y2:11.481,gradientUnits:"userSpaceOnUse"},c.createElement("stop",{stopColor:"#EB4825"}),c.createElement("stop",{offset:1,stopColor:"#EB3319"})),c.createElement("linearGradient",{id:"application-vnd_tdocs-apps_slide_svg__paint1_linear_2519_51673",x1:4.894,y1:-1.472,x2:-4.968,y2:17.036,gradientUnits:"userSpaceOnUse"},c.createElement("stop",{stopColor:"#FF8246"}),c.createElement("stop",{offset:1,stopColor:"#FF5E2F"})),c.createElement("filter",{id:"application-vnd_tdocs-apps_slide_svg__filter0_d_2519_51673",x:6.421,y:8.969,width:10.353,height:10.347,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},c.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),c.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),c.createElement("feOffset",{dx:.533,dy:.267}),c.createElement("feGaussianBlur",{stdDeviation:.4}),c.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0"}),c.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2519_51673"}),c.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2519_51673",result:"shape"})),c.createElement("filter",{id:"application-vnd_tdocs-apps_slide_svg__filter1_d_2519_51673",x:11.579,y:9.036,width:5.125,height:5.124,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},c.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),c.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),c.createElement("feOffset",{dx:.533,dy:.267}),c.createElement("feGaussianBlur",{stdDeviation:.4}),c.createElement("feColorMatrix",{values:"0 0 0 0 0.457456 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0"}),c.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2519_51673"}),c.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2519_51673",result:"shape"})))))}t.default="data:image/svg+xml,%3csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M6.6875 8.3875C6.6875 7.79379 7.16267 7.3125 7.74882 7.3125H19.6887C20.2748 7.3125 20.75 7.79379 20.75 8.3875V19.675C20.75 20.2687 20.2748 20.75 19.6887 20.75H7.74882C7.16267 20.75 6.6875 20.2687 6.6875 19.675V8.3875Z' fill='url(%23paint0_linear_2519_51673)'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M4.8125 3.25C4.12214 3.25 3.5625 3.80964 3.5625 4.5V19.5C3.5625 20.1904 4.12214 20.75 4.8125 20.75H18.5625H19.6562H19.8125V20.7389C19.7615 20.7462 19.7093 20.75 19.6562 20.75C19.0522 20.75 18.5625 20.2603 18.5625 19.6562C18.5625 19.6032 18.5663 19.551 18.5736 19.5H18.5625V4.5C18.5625 3.80964 18.0029 3.25 17.3125 3.25H4.8125Z' fill='url(%23paint1_linear_2519_51673)'/%3e %3cg filter='url(%23filter0_d_2519_51673)'%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M15.4402 13.8892C15.4402 13.8845 15.4402 13.8797 15.4402 13.8749C15.4402 13.8702 15.4402 13.8654 15.4402 13.8606V13.8892ZM15.4375 14.0312C15.3552 16.3751 13.4286 18.2499 11.0639 18.2499C8.64687 18.2499 6.6875 16.2912 6.6875 13.8749C6.6875 11.511 8.56295 9.58497 10.9075 9.50269V14.0312H15.4375Z' fill='%23FFD7BF'/%3e %3c/g%3e %3cg filter='url(%23filter1_d_2519_51673)'%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M15.3708 13.0938C15.048 11.3038 13.636 9.89225 11.8455 9.56958V13.0938H15.3708Z' fill='white'/%3e %3c/g%3e %3cdefs%3e %3cfilter id='filter0_d_2519_51673' x='6.42083' y='8.96935' width='10.3527' height='10.3473' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'%3e %3cfeFlood flood-opacity='0' result='BackgroundImageFix'/%3e %3cfeColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0' result='hardAlpha'/%3e %3cfeOffset dx='0.533333' dy='0.266667'/%3e %3cfeGaussianBlur stdDeviation='0.4'/%3e %3cfeColorMatrix type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0'/%3e %3cfeBlend mode='normal' in2='BackgroundImageFix' result='effect1_dropShadow_2519_51673'/%3e %3cfeBlend mode='normal' in='SourceGraphic' in2='effect1_dropShadow_2519_51673' result='shape'/%3e %3c/filter%3e %3cfilter id='filter1_d_2519_51673' x='11.5788' y='9.03625' width='5.12527' height='5.12417' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'%3e %3cfeFlood flood-opacity='0' result='BackgroundImageFix'/%3e %3cfeColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0' result='hardAlpha'/%3e %3cfeOffset dx='0.533333' dy='0.266667'/%3e %3cfeGaussianBlur stdDeviation='0.4'/%3e %3cfeColorMatrix type='matrix' values='0 0 0 0 0.457456 0 0 0 0 0 0 0 0 0 0 0 0 0 0.16 0'/%3e %3cfeBlend mode='normal' in2='BackgroundImageFix' result='effect1_dropShadow_2519_51673'/%3e %3cfeBlend mode='normal' in='SourceGraphic' in2='effect1_dropShadow_2519_51673' result='shape'/%3e %3c/filter%3e %3clinearGradient id='paint0_linear_2519_51673' x1='20.75' y1='11.4806' x2='18.3746' y2='11.4806' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%23EB4825'/%3e %3cstop offset='1' stop-color='%23EB3319'/%3e %3c/linearGradient%3e %3clinearGradient id='paint1_linear_2519_51673' x1='4.89364' y1='-1.47234' x2='-4.96774' y2='17.0364' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%23FF8246'/%3e %3cstop offset='1' stop-color='%23FF5E2F'/%3e %3c/linearGradient%3e %3c/defs%3e %3c/svg%3e"},67146:function(e,t,n){n.r(t),n.d(t,{ReactComponent:function(){return u}});var r,o,i,a,s,c=n(87363);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}function u(e){return c.createElement("svg",l({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=c.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.688 8.387c0-.593.475-1.075 1.06-1.075h11.94c.587 0 1.062.482 1.062 1.075v11.288c0 .594-.475 1.075-1.061 1.075H7.749a1.068 1.068 0 01-1.061-1.075V8.387z",fill:"url(#application-vnd_tdocs-apps_smartcanvas_svg__paint0_linear_2572_52172)"})),o||(o=c.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.813 3.25c-.69 0-1.25.56-1.25 1.25v15c0 .69.56 1.25 1.25 1.25h15v-.011a1.094 1.094 0 01-1.239-1.239h-.011v-15c0-.69-.56-1.25-1.25-1.25h-12.5z",fill:"url(#application-vnd_tdocs-apps_smartcanvas_svg__paint1_linear_2572_52172)"})),i||(i=c.createElement("g",{filter:"url(#application-vnd_tdocs-apps_smartcanvas_svg__filter0_d_2572_52172)",fill:"#ECFCFF"},c.createElement("path",{d:"M6.688 9.813H8.25v8.124H6.687V9.813zM8.25 9.813h1.563v1.556H8.25V9.813zM8.25 16.38h1.563v1.558H8.25V16.38z"}))),a||(a=c.createElement("g",{filter:"url(#application-vnd_tdocs-apps_smartcanvas_svg__filter1_d_2572_52172)",fill:"#CAEFFB"},c.createElement("path",{d:"M15.438 9.813h-1.563v8.124h1.563V9.813zM13.875 9.813h-1.563v1.556h1.563V9.813zM13.875 16.38h-1.563v1.558h1.563V16.38z"}))),s||(s=c.createElement("defs",null,c.createElement("linearGradient",{id:"application-vnd_tdocs-apps_smartcanvas_svg__paint0_linear_2572_52172",x1:9.547,y1:7.313,x2:9.547,y2:21.16,gradientUnits:"userSpaceOnUse"},c.createElement("stop",{stopColor:"#2DA5EB"}),c.createElement("stop",{offset:1,stopColor:"#2198EB"})),c.createElement("linearGradient",{id:"application-vnd_tdocs-apps_smartcanvas_svg__paint1_linear_2572_52172",x1:11.188,y1:-5.5,x2:-6.342,y2:11.778,gradientUnits:"userSpaceOnUse"},c.createElement("stop",{stopColor:"#4DD1FF"}),c.createElement("stop",{offset:1,stopColor:"#3CBFFF"})),c.createElement("filter",{id:"application-vnd_tdocs-apps_smartcanvas_svg__filter0_d_2572_52172",x:5.834,y:8.106,width:8.245,height:13.245,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},c.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),c.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),c.createElement("feOffset",{dx:1.707,dy:.853}),c.createElement("feGaussianBlur",{stdDeviation:1.28}),c.createElement("feColorMatrix",{values:"0 0 0 0 0.0901961 0 0 0 0 0.622274 0 0 0 0 0.921569 0 0 0 0.8 0"}),c.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2572_52172"}),c.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2572_52172",result:"shape"})),c.createElement("filter",{id:"application-vnd_tdocs-apps_smartcanvas_svg__filter1_d_2572_52172",x:11.459,y:8.106,width:8.245,height:13.245,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},c.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),c.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),c.createElement("feOffset",{dx:1.707,dy:.853}),c.createElement("feGaussianBlur",{stdDeviation:1.28}),c.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0"}),c.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2572_52172"}),c.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2572_52172",result:"shape"})))))}t.default="data:image/svg+xml,%3csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M6.6875 8.3875C6.6875 7.79379 7.16267 7.3125 7.74882 7.3125H19.6887C20.2748 7.3125 20.75 7.79379 20.75 8.3875V19.675C20.75 20.2687 20.2748 20.75 19.6887 20.75H7.74882C7.16267 20.75 6.6875 20.2687 6.6875 19.675V8.3875Z' fill='url(%23paint0_linear_2572_52172)'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M4.8125 3.25C4.12214 3.25 3.5625 3.80964 3.5625 4.5V19.5C3.5625 20.1904 4.12214 20.75 4.8125 20.75H18.5625H19.6562H19.8125V20.7389C19.7615 20.7462 19.7093 20.75 19.6562 20.75C19.0522 20.75 18.5625 20.2603 18.5625 19.6562C18.5625 19.6032 18.5663 19.551 18.5736 19.5H18.5625V4.5C18.5625 3.80964 18.0029 3.25 17.3125 3.25H4.8125Z' fill='url(%23paint1_linear_2572_52172)'/%3e %3cg filter='url(%23filter0_d_2572_52172)'%3e %3cpath d='M6.6875 9.8125H8.25V17.9375H6.6875V9.8125Z' fill='%23ECFCFF'/%3e %3cpath d='M8.25 9.8125H9.8125V11.3691H8.25V9.8125Z' fill='%23ECFCFF'/%3e %3cpath d='M8.25 16.3809H9.8125V17.9375L8.25 17.9375V16.3809Z' fill='%23ECFCFF'/%3e %3c/g%3e %3cg filter='url(%23filter1_d_2572_52172)'%3e %3cpath d='M15.4375 9.8125H13.875V17.9375H15.4375V9.8125Z' fill='%23CAEFFB'/%3e %3cpath d='M13.875 9.8125H12.3125V11.3691H13.875V9.8125Z' fill='%23CAEFFB'/%3e %3cpath d='M13.875 16.3809H12.3125V17.9375L13.875 17.9375V16.3809Z' fill='%23CAEFFB'/%3e %3c/g%3e %3cdefs%3e %3cfilter id='filter0_d_2572_52172' x='5.83417' y='8.10583' width='8.245' height='13.245' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'%3e %3cfeFlood flood-opacity='0' result='BackgroundImageFix'/%3e %3cfeColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0' result='hardAlpha'/%3e %3cfeOffset dx='1.70667' dy='0.853333'/%3e %3cfeGaussianBlur stdDeviation='1.28'/%3e %3cfeColorMatrix type='matrix' values='0 0 0 0 0.0901961 0 0 0 0 0.622274 0 0 0 0 0.921569 0 0 0 0.8 0'/%3e %3cfeBlend mode='normal' in2='BackgroundImageFix' result='effect1_dropShadow_2572_52172'/%3e %3cfeBlend mode='normal' in='SourceGraphic' in2='effect1_dropShadow_2572_52172' result='shape'/%3e %3c/filter%3e %3cfilter id='filter1_d_2572_52172' x='11.4592' y='8.10583' width='8.245' height='13.245' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'%3e %3cfeFlood flood-opacity='0' result='BackgroundImageFix'/%3e %3cfeColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0' result='hardAlpha'/%3e %3cfeOffset dx='1.70667' dy='0.853333'/%3e %3cfeGaussianBlur stdDeviation='1.28'/%3e %3cfeColorMatrix type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0'/%3e %3cfeBlend mode='normal' in2='BackgroundImageFix' result='effect1_dropShadow_2572_52172'/%3e %3cfeBlend mode='normal' in='SourceGraphic' in2='effect1_dropShadow_2572_52172' result='shape'/%3e %3c/filter%3e %3clinearGradient id='paint0_linear_2572_52172' x1='9.5467' y1='7.3125' x2='9.5467' y2='21.1605' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%232DA5EB'/%3e %3cstop offset='1' stop-color='%232198EB'/%3e %3c/linearGradient%3e %3clinearGradient id='paint1_linear_2572_52172' x1='11.1878' y1='-5.5' x2='-6.3416' y2='11.7784' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%234DD1FF'/%3e %3cstop offset='1' stop-color='%233CBFFF'/%3e %3c/linearGradient%3e %3c/defs%3e %3c/svg%3e"},27614:function(e,t,n){n.r(t),n.d(t,{ReactComponent:function(){return l}});var r,o,i,a,s=n(87363);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}function l(e){return s.createElement("svg",c({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=s.createElement("path",{d:"M3.25 4.344c0-.863.7-1.563 1.563-1.563h14.375c.862 0 1.562.7 1.562 1.563v15.312c0 .863-.7 1.563-1.563 1.563H4.813c-.862 0-1.562-.7-1.562-1.563V4.344z",fill:"#fff"})),o||(o=s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.188 3.719H4.813a.625.625 0 00-.625.625v15.312c0 .345.28.625.625.625h14.375c.345 0 .625-.28.625-.625V4.344a.625.625 0 00-.625-.625zM4.813 2.78c-.863 0-1.563.7-1.563 1.563v15.312c0 .863.7 1.563 1.563 1.563h14.375c.862 0 1.562-.7 1.562-1.563V4.344c0-.863-.7-1.563-1.563-1.563H4.813z",fill:"#00AA5B",fillOpacity:.64})),i||(i=s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.02 7.31c0-.04.03-.072.068-.076l8.983-.934a.077.077 0 01.085.076v1.022l.001.001s.002 0 .002.002v5.855c0 .002.002.004.004.004s.004 0 .004.003v2.786a.077.077 0 01-.057.075l-3.435.91a.077.077 0 01-.097-.075v-2.691c0-.035.024-.066.058-.075l1.507-.399a.077.077 0 00.058-.074V8.589a.077.077 0 00-.086-.077l-5.07.563a.077.077 0 00-.068.076v4.739c0 .002.002.003.005.003.002 0 .004.001.004.003v2.787a.077.077 0 01-.057.074l-3.435.91a.077.077 0 01-.097-.075v-2.691c0-.035.023-.065.057-.074l1.508-.4a.077.077 0 00.057-.074V7.31z",fill:"url(#audio_svg__paint0_linear_2520_53030)"})),a||(a=s.createElement("defs",null,s.createElement("linearGradient",{id:"audio_svg__paint0_linear_2520_53030",x1:16.655,y1:7.247,x2:7.752,y2:17.899,gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#0BB465"}),s.createElement("stop",{offset:.51,stopColor:"#00AA5B"})))))}t.default="data:image/svg+xml,%3csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e %3cpath d='M3.25 4.34375C3.25 3.48081 3.94956 2.78125 4.8125 2.78125H19.1875C20.0504 2.78125 20.75 3.48081 20.75 4.34375V19.6562C20.75 20.5192 20.0504 21.2188 19.1875 21.2188H4.8125C3.94956 21.2188 3.25 20.5192 3.25 19.6562V4.34375Z' fill='white'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M19.1875 3.71875H4.8125C4.46732 3.71875 4.1875 3.99857 4.1875 4.34375V19.6562C4.1875 20.0014 4.46732 20.2812 4.8125 20.2812H19.1875C19.5327 20.2812 19.8125 20.0014 19.8125 19.6562V4.34375C19.8125 3.99857 19.5327 3.71875 19.1875 3.71875ZM4.8125 2.78125C3.94956 2.78125 3.25 3.48081 3.25 4.34375V19.6562C3.25 20.5192 3.94956 21.2188 4.8125 21.2188H19.1875C20.0504 21.2188 20.75 20.5192 20.75 19.6562V4.34375C20.75 3.48081 20.0504 2.78125 19.1875 2.78125H4.8125Z' fill='%2300AA5B' fill-opacity='0.64'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M8.01929 7.31033C8.01929 7.27093 8.04906 7.23789 8.08825 7.23382L17.071 6.29967C17.1163 6.29495 17.1558 6.33055 17.1558 6.37619V7.3979C17.1558 7.39865 17.1564 7.39925 17.1572 7.39925V7.39925C17.1579 7.39925 17.1585 7.39985 17.1585 7.40059V13.2562C17.1585 13.2585 17.1607 13.2602 17.163 13.2596V13.2596C17.1652 13.2591 17.1674 13.2608 17.1674 13.2631V16.0495C17.1674 16.0844 17.1439 16.1149 17.1102 16.1238L13.675 17.0332C13.6262 17.0461 13.5784 17.0093 13.5784 16.9588V14.2677C13.5784 14.2328 13.6019 14.2023 13.6356 14.1934L15.1434 13.7942C15.1772 13.7853 15.2007 13.7548 15.2007 13.7199V8.58886C15.2007 8.54301 15.1608 8.50735 15.1153 8.5124L10.0456 9.07484C10.0066 9.07916 9.97712 9.11209 9.97712 9.15129V13.8895C9.97712 13.8918 9.97932 13.8935 9.98158 13.8929V13.8929C9.98383 13.8923 9.98604 13.894 9.98604 13.8964V16.6827C9.98604 16.7176 9.96254 16.7482 9.9288 16.7571L6.49358 17.6664C6.44478 17.6794 6.39697 17.6426 6.39697 17.5921V14.901C6.39697 14.8661 6.42047 14.8356 6.45421 14.8267L7.96205 14.4275C7.99579 14.4186 8.01929 14.3881 8.01929 14.3532V9.29963V8.03249V7.31033Z' fill='url(%23paint0_linear_2520_53030)'/%3e %3cdefs%3e %3clinearGradient id='paint0_linear_2520_53030' x1='16.6546' y1='7.24668' x2='7.7521' y2='17.8991' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%230BB465'/%3e %3cstop offset='0.510417' stop-color='%2300AA5B'/%3e %3c/linearGradient%3e %3c/defs%3e %3c/svg%3e"},13713:function(e,t,n){n.r(t),n.d(t,{ReactComponent:function(){return c}});var r,o,i,a=n(87363);function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s.apply(this,arguments)}function c(e){return a.createElement("svg",s({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=a.createElement("path",{d:"M3.25 4.344c0-.863.7-1.563 1.563-1.563h14.375c.862 0 1.562.7 1.562 1.563v15.312c0 .863-.7 1.563-1.563 1.563H4.813c-.862 0-1.562-.7-1.562-1.563V4.344z",fill:"#fff"})),o||(o=a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.188 3.719H4.813a.625.625 0 00-.625.625v15.312c0 .345.28.625.625.625h14.375c.345 0 .625-.28.625-.625V4.344a.625.625 0 00-.625-.625zM4.813 2.78c-.863 0-1.563.7-1.563 1.563v15.312c0 .863.7 1.563 1.563 1.563h14.375c.862 0 1.562-.7 1.562-1.563V4.344c0-.863-.7-1.563-1.563-1.563H4.813z",fill:"#81868F",fillOpacity:.64})),i||(i=a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.336 8.094L5.85 11.407a.8.8 0 000 1.171l3.487 3.314 1.233-1.172-2.87-2.727 2.87-2.728-1.233-1.171zm5.328 0l3.487 3.313a.8.8 0 010 1.171l-3.487 3.314-1.233-1.172 2.87-2.727-2.87-2.728 1.233-1.171z",fill:"#81868F"})))}t.default="data:image/svg+xml,%3csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e %3cpath d='M3.25 4.34375C3.25 3.48081 3.94956 2.78125 4.8125 2.78125H19.1875C20.0504 2.78125 20.75 3.48081 20.75 4.34375V19.6562C20.75 20.5192 20.0504 21.2188 19.1875 21.2188H4.8125C3.94956 21.2188 3.25 20.5192 3.25 19.6562V4.34375Z' fill='white'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M19.1875 3.71875H4.8125C4.46732 3.71875 4.1875 3.99857 4.1875 4.34375V19.6562C4.1875 20.0014 4.46732 20.2812 4.8125 20.2812H19.1875C19.5327 20.2812 19.8125 20.0014 19.8125 19.6562V4.34375C19.8125 3.99857 19.5327 3.71875 19.1875 3.71875ZM4.8125 2.78125C3.94956 2.78125 3.25 3.48081 3.25 4.34375V19.6562C3.25 20.5192 3.94956 21.2188 4.8125 21.2188H19.1875C20.0504 21.2188 20.75 20.5192 20.75 19.6562V4.34375C20.75 3.48081 20.0504 2.78125 19.1875 2.78125H4.8125Z' fill='%2381868F' fill-opacity='0.64'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M9.33643 8.09375L5.84923 11.407C5.50878 11.7305 5.50878 12.2549 5.84923 12.5784L9.33643 15.8916L10.5693 14.7202L7.6986 11.9927L10.5693 9.26516L9.33643 8.09375ZM14.6636 8.09375L18.1508 11.407C18.4912 11.7305 18.4912 12.2549 18.1508 12.5784L14.6636 15.8916L13.4307 14.7202L16.3014 11.9927L13.4307 9.26516L14.6636 8.09375Z' fill='%2381868F'/%3e %3c/svg%3e"},9235:function(e,t,n){n.r(t),n.d(t,{ReactComponent:function(){return l}});var r,o,i,a,s=n(87363);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}function l(e){return s.createElement("svg",c({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=s.createElement("path",{d:"M3.25 4.344c0-.863.7-1.563 1.563-1.563h14.375c.862 0 1.562.7 1.562 1.563v15.312c0 .863-.7 1.563-1.563 1.563H4.813c-.862 0-1.562-.7-1.562-1.563V4.344z",fill:"#fff"})),o||(o=s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.188 3.719H4.813a.625.625 0 00-.625.625v15.312c0 .345.28.625.625.625h14.375c.345 0 .625-.28.625-.625V4.344a.625.625 0 00-.625-.625zM4.813 2.78c-.863 0-1.563.7-1.563 1.563v15.312c0 .863.7 1.563 1.563 1.563h14.375c.862 0 1.562-.7 1.562-1.563V4.344c0-.863-.7-1.563-1.563-1.563H4.813z",fill:"#4B8DFF",fillOpacity:.64})),i||(i=s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.865 8.957c.82 0 1.484-.648 1.484-1.447 0-.8-.665-1.447-1.484-1.447-.82 0-1.485.647-1.485 1.447s.665 1.447 1.485 1.447zm.254 2.72c.06-.09.19-.095.255-.01l1.76 2.318a.156.156 0 00.252-.005l2.547-3.66a.156.156 0 01.26.005l4.194 6.686a.156.156 0 01-.132.239H5.75a.156.156 0 01-.13-.242l3.499-5.331z",fill:"url(#image_svg__paint0_linear_2520_53028)"})),a||(a=s.createElement("defs",null,s.createElement("linearGradient",{id:"image_svg__paint0_linear_2520_53028",x1:8.995,y1:8.794,x2:8.684,y2:17.227,gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#5F9AFF"}),s.createElement("stop",{offset:.901,stopColor:"#4B8DFF"})))))}t.default="data:image/svg+xml,%3csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e %3cpath d='M3.25 4.34375C3.25 3.48081 3.94956 2.78125 4.8125 2.78125H19.1875C20.0504 2.78125 20.75 3.48081 20.75 4.34375V19.6562C20.75 20.5192 20.0504 21.2188 19.1875 21.2188H4.8125C3.94956 21.2188 3.25 20.5192 3.25 19.6562V4.34375Z' fill='white'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M19.1875 3.71875H4.8125C4.46732 3.71875 4.1875 3.99857 4.1875 4.34375V19.6562C4.1875 20.0014 4.46732 20.2812 4.8125 20.2812H19.1875C19.5327 20.2812 19.8125 20.0014 19.8125 19.6562V4.34375C19.8125 3.99857 19.5327 3.71875 19.1875 3.71875ZM4.8125 2.78125C3.94956 2.78125 3.25 3.48081 3.25 4.34375V19.6562C3.25 20.5192 3.94956 21.2188 4.8125 21.2188H19.1875C20.0504 21.2188 20.75 20.5192 20.75 19.6562V4.34375C20.75 3.48081 20.0504 2.78125 19.1875 2.78125H4.8125Z' fill='%234B8DFF' fill-opacity='0.64'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M8.8647 8.95703C9.6845 8.95703 10.3491 8.30907 10.3491 7.50977C10.3491 6.71046 9.6845 6.0625 8.8647 6.0625C8.0449 6.0625 7.38033 6.71046 7.38033 7.50977C7.38033 8.30907 8.0449 8.95703 8.8647 8.95703ZM9.11888 11.6765C9.17808 11.5864 9.30869 11.5819 9.37393 11.6678L11.1337 13.985C11.1979 14.0695 11.3258 14.0668 11.3864 13.9797L13.9329 10.3191C13.9968 10.2271 14.134 10.2304 14.1935 10.3253L18.3871 17.0107C18.4523 17.1148 18.3775 17.25 18.2547 17.25H5.74971C5.62542 17.25 5.55088 17.1119 5.61909 17.008L9.11888 11.6765Z' fill='url(%23paint0_linear_2520_53028)'/%3e %3cdefs%3e %3clinearGradient id='paint0_linear_2520_53028' x1='8.99547' y1='8.79429' x2='8.68441' y2='17.2274' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%235F9AFF'/%3e %3cstop offset='0.901042' stop-color='%234B8DFF'/%3e %3c/linearGradient%3e %3c/defs%3e %3c/svg%3e"},42944:function(e,t,n){n.r(t),n.d(t,{ReactComponent:function(){return c}});var r,o,i,a=n(87363);function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s.apply(this,arguments)}function c(e){return a.createElement("svg",s({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=a.createElement("path",{d:"M3.25 4.344c0-.863.7-1.563 1.563-1.563h14.375c.862 0 1.562.7 1.562 1.563v15.312c0 .863-.7 1.563-1.563 1.563H4.813c-.862 0-1.562-.7-1.562-1.563V4.344z",fill:"#fff"})),o||(o=a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.188 3.719H4.813a.625.625 0 00-.625.625v15.312c0 .345.28.625.625.625h14.375c.345 0 .625-.28.625-.625V4.344a.625.625 0 00-.625-.625zM4.813 2.78c-.863 0-1.563.7-1.563 1.563v15.312c0 .863.7 1.563 1.563 1.563h14.375c.862 0 1.562-.7 1.562-1.563V4.344c0-.863-.7-1.563-1.563-1.563H4.813z",fill:"#81868F",fillOpacity:.64})),i||(i=a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 7h10v1.875H7V7zm0 4.063h10v1.874H7v-1.874zm10 4.062H7V17h10v-1.875z",fill:"#81868F"})))}t.default="data:image/svg+xml,%3csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e %3cpath d='M3.25 4.34375C3.25 3.48081 3.94956 2.78125 4.8125 2.78125H19.1875C20.0504 2.78125 20.75 3.48081 20.75 4.34375V19.6562C20.75 20.5192 20.0504 21.2188 19.1875 21.2188H4.8125C3.94956 21.2188 3.25 20.5192 3.25 19.6562V4.34375Z' fill='white'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M19.1875 3.71875H4.8125C4.46732 3.71875 4.1875 3.99857 4.1875 4.34375V19.6562C4.1875 20.0014 4.46732 20.2812 4.8125 20.2812H19.1875C19.5327 20.2812 19.8125 20.0014 19.8125 19.6562V4.34375C19.8125 3.99857 19.5327 3.71875 19.1875 3.71875ZM4.8125 2.78125C3.94956 2.78125 3.25 3.48081 3.25 4.34375V19.6562C3.25 20.5192 3.94956 21.2188 4.8125 21.2188H19.1875C20.0504 21.2188 20.75 20.5192 20.75 19.6562V4.34375C20.75 3.48081 20.0504 2.78125 19.1875 2.78125H4.8125Z' fill='%2381868F' fill-opacity='0.64'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M7 7H16.9999V8.875H7V7ZM7 11.0625H16.9999V12.9375H7V11.0625ZM16.9999 15.125H7V17H16.9999V15.125Z' fill='%2381868F'/%3e %3c/svg%3e"},69546:function(e,t,n){n.r(t),n.d(t,{ReactComponent:function(){return l}});var r,o,i,a,s=n(87363);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}function l(e){return s.createElement("svg",c({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=s.createElement("path",{d:"M3.25 4.344c0-.863.7-1.563 1.563-1.563h14.375c.862 0 1.562.7 1.562 1.563v15.312c0 .863-.7 1.563-1.563 1.563H4.813c-.862 0-1.562-.7-1.562-1.563V4.344z",fill:"#fff"})),o||(o=s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.188 3.719H4.813a.625.625 0 00-.625.625v15.312c0 .345.28.625.625.625h14.375c.345 0 .625-.28.625-.625V4.344a.625.625 0 00-.625-.625zM4.813 2.78c-.863 0-1.563.7-1.563 1.563v15.312c0 .863.7 1.563 1.563 1.563h14.375c.862 0 1.562-.7 1.562-1.563V4.344c0-.863-.7-1.563-1.563-1.563H4.813z",fill:"#6F7DE8",fillOpacity:.64})),i||(i=s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.937 6.823c0-.125.14-.199.243-.13l7.687 5.125a.156.156 0 010 .26L9.18 17.203a.156.156 0 01-.243-.13V6.823z",fill:"url(#video_svg__paint0_linear_2520_53029)"})),a||(a=s.createElement("defs",null,s.createElement("linearGradient",{id:"video_svg__paint0_linear_2520_53029",x1:16.508,y1:6.531,x2:7.035,y2:16.173,gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#8896FF",stopOpacity:.99}),s.createElement("stop",{offset:.766,stopColor:"#6F7DE8"})))))}t.default="data:image/svg+xml,%3csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e %3cpath d='M3.25 4.34375C3.25 3.48081 3.94956 2.78125 4.8125 2.78125H19.1875C20.0504 2.78125 20.75 3.48081 20.75 4.34375V19.6562C20.75 20.5192 20.0504 21.2188 19.1875 21.2188H4.8125C3.94956 21.2188 3.25 20.5192 3.25 19.6562V4.34375Z' fill='white'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M19.1875 3.71875H4.8125C4.46732 3.71875 4.1875 3.99857 4.1875 4.34375V19.6562C4.1875 20.0014 4.46732 20.2812 4.8125 20.2812H19.1875C19.5327 20.2812 19.8125 20.0014 19.8125 19.6562V4.34375C19.8125 3.99857 19.5327 3.71875 19.1875 3.71875ZM4.8125 2.78125C3.94956 2.78125 3.25 3.48081 3.25 4.34375V19.6562C3.25 20.5192 3.94956 21.2188 4.8125 21.2188H19.1875C20.0504 21.2188 20.75 20.5192 20.75 19.6562V4.34375C20.75 3.48081 20.0504 2.78125 19.1875 2.78125H4.8125Z' fill='%236F7DE8' fill-opacity='0.64'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M8.93726 6.82321C8.93726 6.69841 9.07634 6.62397 9.18018 6.6932L16.8672 11.8179C16.96 11.8798 16.96 12.0161 16.8672 12.0779L9.18018 17.2026C9.07634 17.2719 8.93726 17.1974 8.93726 17.0726L8.93726 6.82321Z' fill='url(%23paint0_linear_2520_53029)'/%3e %3cdefs%3e %3clinearGradient id='paint0_linear_2520_53029' x1='16.5083' y1='6.53125' x2='7.035' y2='16.1726' gradientUnits='userSpaceOnUse'%3e %3cstop stop-color='%238896FF' stop-opacity='0.99'/%3e %3cstop offset='0.765625' stop-color='%236F7DE8'/%3e %3c/linearGradient%3e %3c/defs%3e %3c/svg%3e"},85007:function(e){e.exports={"en-US":{accessibility:{welcome:"Thank you for using {{productName}}. You can press control and ~ to disable the accessibility feature.","modal-text":"{{onOkContent}}. You can press control and ~ to enable or disable the accessibility feature."},"add-fast-access":{"add-fast-access":"Add to quick access","cancel-fast-access":"Cancel quick access",added:"Added to Quick Access",removed:"Removed from Quick Access",limited:"The number of files in Quick Access has reached the limit. Remove some first.",failed:"Operation failed. Try again later."},"add-to-wedrive":{"add-to-wedrive":"Add to WeDrive","view-in-wedrive":"View Location",wedrive:"Wedrive",added:"Added","add-to-directories":"Add to other Directories",directory:"Directory","add-wedrive-shortcut":"Add Shortcut To...","move-to-wedrive":"Move To..."},addon:{addons:"Add-ons","unofficial-plugins":"Add-ons","plugin-activated":"Activated","third-party-plugins":"Third-party add-ons","manage-addons":"Manage add-ons","get-addons":"Get add-ons","go-to-computer-client-or-browser":"Please go to the desktop client or browser to use","recommend-addon":"Recommended","installed-addon":"Added","no-use-addon":"No add-ons","same-addon":"Same style","flow-chart":"Flow chart","permission-denied-tips":"The document administrator has restricted the viewers' permissions. Unable to use add-on."},"app-guide":{"brand-text":"Collaboration/Remote Office/Information Collection"},attachment:{doc:"Document",file:"File","wedrive-file":"WeDrive","local-file":"Local Files","select-wedrive":"Select WeDrive Files","select-online":"Select Online Files","select-search-file":"Select or Search Files","select-search-doc":"Select or Search Docs","search-result":"Searching Result","delete-attachemnt":"Delete File","download-attachemnt":"Download File","switch-mode":"Switch Mode","description-text":"Support local file insertion for easy sharing.","over-wedrive-capacity":"Insufficient capacity"},audio:{encoding:"Encoding..."},card:{"calendar-event":"Calendar","select-from-list":"Select From Exist","new-calendar-event":"New Calendar Event","change-layout":"Change Layout",card:"Card","chat-history":"Chat History","group-business-card":"Group BizCard","untitled-group-chat":"Untitled group chat","personal-business-card":"Personal BizCard","add-personal-business-card-notification-message":"{{user}} has inserted your personal business card into {{document}} for easy contact.","event-deleted":"Event deleted","group-chat-history":"{{group}} chat history","join-group":"Join Group",app:"Application",weapp:"MiniProgram","meeting-event":"Meeting","select-meeting-from-list":"Select meeting from list","new-meeting-event":"New meeting"},color:{"font-color":"Text color"},comment:{"sync-to-group":"Sync to group: {{group}}",comments:"Comment","archive-comments":"Archive Comments",like:"Like","empty-ent-range-tip":"Please box to select the range to be marked with words","empty-range-tip":"Please box to select the range of comments to be marked","audit-add-fail":"Unable to Add comment. Check your network or try again later.","audit-edit-fail":"Unable to Edit comment. Check your network or try again later.","":"Comment failed"},"core-edit":{"error-code-with-date":"Error code: {{errCode}}  {{date}}","no-clipboard-permission":"Clipboard permission is not enabled","no-copy-permission":"Permission settings don't allow copying content","use-shortcut-key-without-permission":"Please use the shortcut key {{ctrl}}+V to paste. The right-click menu does not have browser clipboard permissions, you need to open it and try again. Go to the Help Center to see how to set it up.","right-click-paste-instructions":"Right-click Menu Paste Not Working Instructions",copying:"Copying in progress, please wait","image-compress":"The image is too large and has been compressed. If you need the original image, please use the image download feature","image-unable-copy":"The image is too large to copy. Please use the image download feature"},data:{recovering:"Data is recovering now. Please wait a moment."},"doc-link":{"failed-to-load-preview-image":"Failed to load preview image",retry:"Retry",loading:"Loading","file-has-been-deleted":"File has been deleted","open-in-new-window":"Open in new window","no-viewing-permission":"No viewing permission"},"e-signature":{"click-to-sign":"Click to Sign","e-signature-message-without-contract":"The signature may be denied legal effect and may be copied.","e-signature-message-full":"This signature has no legal effect, you can use E-Sign Service if necessary.","e-signature-message-left":"This signature has no legal effect, you can use ","e-signature-message-middle":"E-Sign Service","e-signature-message-right":" if necessary."},"edit-tips":{edit:"Edit now","touch-tips":"Double tap to edit","security-risk":"Fail to process this request because of security risks of your account"},"field-code":{"fixed-read-addon-iframe":"[Third Party Content]","fixed-read-sheet-iframe":"[Spreadsheets]"},field:{"cancel-link":"Cancel Link",delete:"Delete",refresh:"Refresh","full-screen":"Full Screen","display-mode":"Display Mode","modify-link":"Modify Link","copy-link":"Copy Link","open-link":"Open Link","jump-to-source-page":"Go to the source page",preview:"Preview",card:"Card","icon-text-link":"Icon + Text Link","text-link":"Text Link","demo-insert":"Domain DEMO test"},"fieldcode-page":{menu:"Header/Footer/Page No."},"file-base":{cloning:"Generating copy...","cloning-patient":"Generating copy... Please wait.","clone-title":"Copy-{{- title}}","import-empty-error":"Import failed. You cannot import empty files.","import-size-error":"Import failed. File size exceeds {{fileSizeLimit}} MB.","import-exts-error":"Import failed. Only files in the format of {{exts}} are supported.","delete-doc-tips":"After deletion, document members will not be able to open the document.","delete-doc":"Delete Document",delete:"Delete",deleting:"Deleting...","delete-success":"Deleted","delete-fail":"Deletion failed","import-doc-success-tip":"Saved to Tencent Docs, and Edits will be saved online",view:"View",confused:"Redacted "},"file-export":{"local-docx":"Local Word File (.docx)",export:"Export","export-hina-fail":"Export failed","export-failed":"Export failed.","export-failed-tips":"Export failed, please try again later. If this problem persist, please click feedback below to contact us.","":"Out of sync","":"Synchronize a single article","":"Synchronize all article","":"Sync to Tencent document list","":"Quickly manage after synchronization","":"Forward"},"file-mobile":{creator:"Owner: {{creator}}",version:"Version: {{- version}}","save-as-template":"Save as Template","log-report":"Log Reporting","text-history":"Recent Text","help-and-feedback":"Help & Feedback"},"file-pc":{privacy:"Privacy","privacy-policy":"Privacy Policy","third-information-checklist":"Third-Party Data Sharing","third-authorization-management":"Third-party app authorization management","personal-information-checklist":"Personal Info Collection"},font:{"change-size":"Font Size"},fonts:{"cannot-clone":"Cannot generate copy","buy-vip-to-clone":"become a VIP to generate copy of document with VIP fonts","buy-vip":"buy VIP"},image:{"mask-tips":"Width: {{width}} &nbsp;&nbsp;Height: {{height}}","camera-fail":"Failed to open camera, please try again later.","camera-no-permission":"No camera permission. Please allow it in system configuration.","restore-image":"Restore to original",restore:"Restore","extract-text":"Extract image text"},"keymap-list":{editing:"Editing","insert-page-break":"Insert Page Break","insert-ordered-list":"Ordered List","insert-unordered-list":"Unordered List","increase-font-size":"Increase Font Size","decrease-font-size":"Decrease Font Size",navigation:"Navigation",view:"View",selection:"Selection","move-left-char":"Move Left","move-right-char":"Move Right","move-up":"Move Up","move-down":"Move Down","move-left-word":"Move to Previous Word","move-right-word":"Move to Next Word","move-to-line-start":"Move to Line Start","move-to-line-end":"Move to Line End","move-to-prev-page":"Move to Previous Page","move-to-next-page":"Move to Next Page","table-horizon-scroll":"Table Horizon Scroll","horizon-scroll":"Horizon Scroll","select-left-char":"Select to Left","select-right-char":"Select to Right","select-up":"Select to Previous Line","select-down":"Select to Next Line","select-to-line-start":"Select to Line Start","select-to-line-end":"Select to Line End","select-to-left-word":"Select to Previous Word","select-to-right-word":"Select to Next Word","select-to-para-start":"Select to Paragraph Start","select-to-para-end":"Select to Paragraph End","markdown-h1":"Heading 1","markdown-h2":"Heading 2","markdown-h3":"Heading 3","markdown-h4":"Heading 4","markdown-h5":"Heading 5","markdown-h6":"Heading 6","insert-code-block":"Codeblock","insert-todo":"Todo","insert-todo-done":"Done","insert-splitline":"Splitline","insert-quote":"Quote","insert-highlight-block":"Highlight block",text:"text","insert-bold":"Bold","insert-italic":"Italic","insert-underline":"Underline","insert-strike-through":"Strike through",zoom:"Zoom In/Out","zoom-restore":"Zoom Restore","open-keymap-list":"Open/Close Keymap List",wheel:"Wheel",space:"Space","paragraph-style":"Paragraph Style","text-style":"Text Style","apply-normal-style":"Apply the Normal Style","apply-h1-style":"Apply the Heading 1 Style","apply-h2-style":"Apply the Heading 2 Style","apply-h3-style":"Apply the Heading 3 Style","apply-h4-style":"Apply the Heading 4 Style","apply-h5-style":"Apply the Heading 5 Style","apply-h6-style":"Apply the Heading 6 Style","apply-big-title-style":"Apply the Title Style","apply-little-title-style":"Apply the SubTitle Style","add-comment":"Insert comments","show-comments":"Show comments","add-ent-comment":"Insert comments","show-ent-comments":"Show comments"},legacy:{"":"External members added. Unable to set as admins. Modify and try again.","":"You have been removed from the members","":"Please check the documentation","":"Link obtained. Only document members can access this document.","":"Link obtained. Externals with a link can edit the document.","":"Link obtained. Externals with a link can view the document.","":"Link obtained. Specified members and externals can access the document.","":"Link obtained. Anyone can access the document.","":"Link obtained. Only specified members can access the document.","":"Link obtained. Company members with a link can edit the document.","":"Link obtained. Company members with a link can view the document.","":"Adding failed. Admin has restricted addition of members.","":"Adding failed, Admin has prohibited adding externals","":".","":"Click to refresh","":"Complaint","":"Your permission for this document has changed","":". Cannot view.","{{currentPrivilege}}":"Your permission for this document has changed. {{currentPrivilege}}.","":"Can edit","":"Can view","":"Cannot view","":"Can comment","":"Cannot comment","":"Can comment","":"Cannot comment","":"Can copy","":"Currently the first","":"Currently the last one","":"Cannot copy","{{text}}":". {{text}}.","":"Text","":"Image saved successfully.","":"Failed to save the image.","Chrome":"Image download is not supported in your browser. Try Chrome browser.","{{minValue}}{{maxValue}}":"{{minValue}} to {{maxValue}}.","":"Invalid value.","":"Microsoft YaHei","":"Song","":"HeiTi","":"This is an enterprise document, is it added to Tencent document","":"The addition is successful, and the enterprise documents will be added by default in the future","":"FangSong","":"confirm","":"KaiTi","":"DFKai","":"STFangSong","":"STKaiTi","":"STSong","":"NSimSun","":"Microsoft JhengHei","":"PMingLiU","":"Hiragino Sans GB","":"PingFang","":"Initial","":"Small Initial","":"Size 1","":"Small 1","":"Size 2","":"Small 2","":"Size 3","":"Small 3","":"Size 4","":"Small 4","":"Size 5","":"Small 5","":"Title","":"Subtitle"," 1":"Heading 1"," 2":"Heading 2"," 3":"Heading 3"," 4":"Heading 4"," 5":"Heading 5"," 6":"Heading 6","":"Note","":"Network exception. Edits will be synced upon network recovery.","":"In offline viewing, the latest content of the document will be synchronized when the network is restored.","":"Network exception. Entered offline editing mode. Updates will be synced upon network recovery.","":"Syncing offline edits...","":"No result.","Cmd+V":"Failed to paste the image. Copy the original image and press Cmd+V, or import the document.","Ctrl+V":"Failed to paste the image. Copy the original image and press Ctrl+V, or import the document.","":"The end-of-text character cannot be deleted.","":"The section break at the end of text cannot be deleted.","":"Untitled Doc","":"There are many people editing or viewing, so you can only view them.","":"File status updated. Refresh and try again.","":"File updates not saved. Are you sure you want to close?","":"Offline editing is not available, please check the network and refresh when the network is restored","":"Editing offline, the content has been saved locally, and synced to the cloud when the network is unblocked","":"Unable to save edits.","":"System Message","":"Sync with server completed. Please refresh.","":"Reload","":"The document is opened by multiple tabs at the same time, please close other tabs and refresh","":"Syncing offline data... Please wait.","":"Creation failed. Try again later.","":"Exit","":"Start editing","snapshot":"Failed to obtain snapshot.","":"Failed to obtain data. Database uninitialized.","":"Failed to save data. Database uninitialized.","":"Failed to save data.","":"Failed to delete data. Database uninitialized.","":"Server timed out. Refresh and try again.","":"Server timed out. Refresh and try again.","":"Server timed out. Refresh and try again.","":"Document editing status changed. Click to refresh.","":"Unable to save edits.","":"There are data updates in the document, please click refresh.","":"Server exception. Unable to save edits.","":"Your permissions have changed. Click to refresh.","":"Maximum number of viewers reached.","":"Disable Screen Reading","":"Enable Screen Reading","":"Accessibility Settings","":"Disable screen reader support?","EnterEsc":"Disable screen reader support in Accessibility Settings? Press Enter to confirm and Esc to cancel.","":"Accessibility mode exited.","":"Enable screen reader support to allow a screen reader to read the text and editing operations for people with disabilities.","EnterEsc":"Enable screen reader support in Accessibility Settings to allow a screen reader to read the text and editing operations for people with disabilities. Press Enter to confirm and Esc to cancel.","":"Screen reader support enabled for this document.","":"Thank you for using Tencent Docs.","":"Failed to obtain the plug-in list.","LaTeX":"LaTeX Formula","":"Countdown","":"Tencent Meeting","":"Third-party Content","":"Cloudcad","":"Mind map","":"Plug-in Pop-up","":"Loading...","":"Create Signature","":"Text Link","+":"Icon + Text Link","":"Card Preview","":"Third-party add-ons","":"Card","":"Back to Doc","":"Unable to print the content.","":"Link copied.","{{action}}":"Unable to {{action}} in Mini Program.","":"play","":"view","":"Copy the link","":"and open it in a browser.","":"Unable to play in Mini Program.","":"View it in a browser.","":"Full screen is not supported in this browser.","":"Go to the source page","":"Open Link","":"Modify Link","":"Display Mode","":"Full Screen","":"Refresh","":"Delete","":"Cancel Link","":"Edit Link","":"Link Style","":"Text to Display","":"Enter text","":"Paste or enter link","":"The selection spans multiple paragraphs. Unable to edit.","":"Link","":"Enter the webpage link.","":"Enter a valid link.","":"OK","":"Cancel","":"Text","":"Incorrect link. Please check.","":"Print","":"Create and Publish with Tencent Docs","":"I also want to use.","":"Recording...","":"Recording... Tap to stop.","":"Recording...","":"Insert Recording","":"Record","":"Recording failed. Try again later.","":"Recording permission disabled.","":"Recording device not found.","":"Recording is not supported in this browser.","":"Failed to load the encoder. Check your network.",", ":"Failed to upload the recording. Check your network.","":"Failed to play. Try again later.","":"Failed to play. Check your network.","":"Unable to play this resource.","":"Failed to obtain the audio link.","":"Unknown error","":"Stop Playing","":"Failed to upload the recording. Auto retry later.","?":"Recording in progress. Confirm to leave?","":"Recording in progress. Confirm to leave?","":"Recording in progress. Unable to play.","":"Voice input in progress. Unable to play.","":"Code Block","```+":"``` + space","":"Search Language","":"Wrap","":"Copy","":"All edits will be automatically saved to the cloud.","":"Saved automatically.","":"Recently saved","{{modifiedBy}}{{updateTime}}":"Last modified by {{modifiedBy}} at {{updateTime}}","":"Editing offline","":"All changes will be automatically saved to the cloud.","":"Just now","{{diffMinutes}}":"{{diffMinutes}} minute(s) ago","{{diffHours}}":"{{diffHours}} hour(s) ago","{{diffDays}}":"{{diffDays}} day(s) ago","yyyyMM":"MM:yyyy","MMdd":"MM:dd","":"Comment deleted.","{{op}}":"Document permission has changed. Failed to {{op}} comment.","{{op}}":"Unable to {{op}} comment. Check your network or try again later.","":"Edit","":"Add","":"Delete Comment","":"Deleted comment cannot be recovered. Delete it?","1000":"Comment cannot exceed 1000 characters.","1000":"Comment exceeds 1000 characters. Unable to save.","1000":"Comment cannot exceed 1000 characters.","":"Add Comments","":"Comment","":"Show Comments","":"Add Comments","":"Delete all comments to this content?","":"Delete Comments","@":"Add comment or @mention others","{{foldCount}}":"Collapsed {{foldCount}} comment(s)","":"Comments","":"Embed comments in the text","":"Comment deleted.","{{op}}":"Document permission has changed. Failed to {{op}} comment.","{{op}}":"Unable to {{op}} comment. Check your network or try again later.","":"Delete Comment","":"Delete it?","@":"The information of the current document @ has been deleted","":"Wechat","":"Department","":"Member","1000":"Comment cannot exceed 1000 characters.","1000":"Comment exceeds 1000 characters. Unable to save.","":"Got It","1000":"Comment cannot exceed 1000 characters.","":"Add Comments","":"floating layer display","":"side display","":"Comment","":"Embed in Text","":"Show Comments","":"Add comment or @mention others","":"Previous","":"Next","":"Archive comments","":"View news","":"Delete all comments to this content?","":"Delete Comments","@":"Add comment or @mention others","{{foldCount}}":"Collapsed {{foldCount}} comment(s)","":"Comments","":"Reply to comments","":"Embed comments in the text","":'Content copied to clipboard. Copy it to a local file for backup and click "Fix".',"":'Content copied to clipboard. Copy it to a local file or export it for backup and click "Fix".',"":'Edit permission revoked. Unable to upload. Content copied to clipboard. Copy it to a local file for backup and click "Refresh".',"":'Edit permission revoked. Unable to upload. Content copied to clipboard. Copy it to a local file or export it for backup and click "Refresh".',"":'File deleted by the creator. Unable to upload. Content copied to clipboard. Copy it to a local file for backup and click "Refresh".',"":'File deleted by the creator. Unable to upload. Content copied to clipboard. Copy it to a local file or export it for backup and click "Refresh".',"":"Contact Us","":"Export Document","":"Export was successful","":"Export local document successfully","":"Export download task successfully","":"Fix","":"Solutions","":"Local cache will be cleared during fixing. Please backup to a local file before fixing.","":"Start","":"Note","":"Feedback","":"Learn More","":"Cut","":"Paste","":"All","":"Undo","":"Redo","":"Select"," {{ctrl}}+V ":"Pasting with {{ctrl}}+V only","Chrome":"Some formatting may be lost during copy & paste. It is recommended to use Chrome or download Tencent Docs.","":"Download Now","":"Text copied.","":"Learn More","SafariSafari":"Copy and paste of rich text not supported for this Safari version. Upgrade Safari or download Tencent Docs.","":"Download","":"The document administrator has restricted the viewers' permissions. Unable to copy.","":"Too many edits for this operation. Unable to apply. Delete some and try again.","":"Back","":"Done","":"Update Domain","{{pageCount}}":"Total pages: {{pageCount}}","{{pageResult}}":"Page {{pageResult}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"hundred","":"thousand","":"","":"hundred million","":"trillion","":"","":"","":"Minus","yyyyMMdd":"MM/dd/yyyy","":"Tencent Docs","":"Insert Page Number","":"Current Location","":"In the Header","":"In the Footer","":"Page Number Format"," 1 ":"Page number starts from 1."," 0 ":"Page number starts from 0.","":"Failed to generate copy. Try again later.","100KB":"File is larger than 100 KB. Unable to save as template.","":"Maximum template count reached. Unable to save as template.","":"No permission to access documents. Unable to save as template.","":"Network exception. Unable to save as template.","":"Request failed. Try again later.","":"Export as","Word":"Export as Word","Word":"Export as Word","PDF":"Convert to Online PDF","":"Export failed. Try again later.","Worddocx":"Export as Local Word File (.docx)","docx":"Save .docx Files to the Cloud","docx":"Save the exported .docx files to the cloud to view them anytime","":"Download to Local Device","":"Download after exporting it as a local file","PDF":"Export as PDF","PDF":"Export as PDF","":"Exporting... Please wait.","":"Feedback","":"Exporting","":"Doc Info","":"Generate Copy","":"Send To {{user}}","":"Send to PC","":"Help & Feedback","":"Report","":"Restricted Document Appeal","":"Save as My Template","":"Save as","":"Me"," {{allWordCount}} ":"{{allWordCount}} chars","":"Read only","":"Operation failed.","":"Local Shortcut","":"Help Center","":"Feature Description","":"Community Convention","":"Doc Version: {{ver}}","":"Infringement Guidelines","":"Doc Permissions","":"Advanced Permissions","":"Transfer Doc Ownership","":"New","":"Online Doc","":"Online Sheet","":"Online PPT","":"Online Form","":"New Folder","":"More Types","":"Online Mind Map","":"Online Flowchart","":"Create from Template","":"Import Local File","":"Rename","":"Permission Settings","":"Saved to WeChat folder.","":"Saved to Tencent Docs.","":"View Now","":"Format","":"Intelligent Tools","":"Text Format","":"Superscript","":"Subscript","":"Character Spacing","":"Font","":"Font Size","":"Default Font","":"Expanded","":"Condensed","{{value}}":"{{value}} pound(s)","":"Standard","":"Character Spacing:","":"Character Scaling","":"Character Scaling:","":"Format painter. Double-click to apply to multiple places.","(Esc)":"Exit Format Painter (Esc)","":"Normal Mode","":"Full Screen Mode","":"Follow Official Account","":"Insert Default Prompt","":"Add Default Prompt","":"Image","":"Image Cropping","":"Image Restoration","":"Image Download","":"Sign Again","":"Crop","":"Rotate","":"View Original Image","":"Extract Text","":"Insert Image","":"Album","":"Camera","":"The signature may be denied legal effect and may be copied.","":"Failed to obtain the signature. Refresh and try again.","":"Non-image files cannot be uploaded by dragging.","":"No permission to access the album. Enable the permission in System Settings.","":"Image upload failed. Try again.","":"Edit Formula","":"Read-Only Attribute","":"Zoom","LaTeX":"Failed to get the LaTeX formula plug-in. Refresh and try again."," ":"File name:","":"Replace Text","":"Delete link:","":"1/2/3/4/5/6/7/8/9/10","":"Auto-numbered List","":"None","":"I.","":"II.","()":"-1","()":"-2","":"Location","":"No Network","":"Login expired","":"Log in again","":"Account info changed","":"Cancel Cache","":"Cache the document","":"Document cached successfully","":"Cache for the document disabled","":"The number of cached documents has reached the limit. Disable cache for other documents and try again.","":"Document is too large. Unable to cache it.","":"Caching failed. Try again later.","":"Failed to disable cache. Try again later.","Markdown":"The pasted content conforms to the Markdown syntax. Are you sure you want to convert the style?","":"Convert Now","":"Converting...","":"Too much content to be converted. Copy and paste partial content and try again.","":"Pasted content has changed. Conversion failed. Copy and paste the content again before another attempt.","":"View only","":"Apply for edit permission","":"Click here to view all files.","":"View only","":"File name synced automatically.","":"Rename","":"Log in to edit","":"Move To","":"Add To","":"Tap to enter","":"Restart app to get camera permission","":"Accurate extraction in process. Please wait...","":"Unable to obtain image","":"Extract text","":"Insert","":"Select the range for recognition.","":"Start Extraction","":"Extracting text","":"Stop Extraction","":"Insert into Document","":"Insert Original Image","":"Camera permission disabled.","":"Enable camera permission in System Settings","":"Inserted","":"Extraction paused","":"Network error","":"Recognition failed. Try again later.","":"Unable to read photos","":"This document has forbidden this operation","":"No text or image found. Unable to recognize. Fetch the image again.","":"Network exception. The documents will be synced when the network is available.","":"Details","":"When offline, you can edit recent documents or create new documents. The edits will be synced to the cloud when you are online. You can also cache the documents locally.","":"No network connection. Edited content has been saved locally and will be synced to the cloud after the network is available.","":"Outline","":"The document being loaded is too large. Try again after the loading is completed.","":'Apply "Title" style',"":'to generate "Outline"',"":"Title is empty","":"Show Outline","":'Apply "Title" style to generate "Outline"',"":"There is no directory for the current document","":"How to create a directory?","":"Exit Paging Mode","":"Enter Paging Mode"," {{page}}  -  {{pageCount}} ":"Page {{page}} of {{pageCount}}","":"Paging Mode","":"Page Break","":"Section Break Next Page","":"Section Break Continuous","":"Section Break Even Page","":"Section Break Odd Page","":"Breaks","":"Unavailable in non-paging mode","":"No page break can be added in non-paging mode.","":"No section break can be added in non-paging mode.","":"Unable to insert more page numbers","":"Enable Paging Mode","":"Unavailable if multiple dividers selected","":"Configure Shading","":"White","":"Beige","":"Porcelain white watercolor paper","":"Plain color watercolor paper","":"Dot pattern","":"Grid pattern","":"Page Shading","":"Align Left","":"Center","":"Align Right","":"Justify","":"Distribute","":"Indent Left","":"char","":"cm","":"Indent Right","":"Line Height","":"Multiple","":"Exactly","":"At Least","":"Value","":"Before","":"After","":"Sample Text","":"Previous Paragraph","":"Next Paragraph","":"Preview","":"pt","":"Lines","":"Auto","":"Indents and Spacing","":"Snap to grid","":"Auto adjust space between Asian text and Latin text, numbers","":"Apply","":"Special","":"(None)","":"First line","":"Hanging","":"Presentation","":"Thank you for using Remote Presentation.","":"View on mobile and PC simultaneously to make voice discussion more efficient","":"Invite Friends","":"Invite Friends","":"Start Remote Presentation","":"Disable Invitation","":"Allow viewers to browse the entire document","":"Local Playback","":"Wait for viewers to join","":"Play","":"Failed to fetch information. Refresh and start Remote Presentation again.","":"Refresh Now","":"Copied success","":"Copied fail","":"Link copied","cmd+C":"Failed to copy the link. Press cmd+C to copy the link.","Ctrl+C":"Failed to copy the link. Press Ctrl+C to copy the link.","":"Loading. Please wait.","":"No","":"Yes","":"Document not yet loaded. Try again later.","":"Ready for printing. Please wait.","":"Release As Webpage","":"Share links","":"Add member","":"Forward","":"Forward To WeChat","":"Transfer Ownership","":"Released","":"Failed to generate webpage","":"Failed to sync to webpage","":"Failed to disable webpage","":"Disable Webpage","?":"Are you sure you want to disable the webpage?","":"Generate QR Code","":"Webpage URL","":"Document content was updated. Are you sure you want to sync it to webpage?","":"Sync","":"Generate a new webpage link that everyone can read.","":"The toolbar is not displayed on the webpage. Readers cannot apply for the permission to view and edit the original document.","":"Copy URL","":"Link copied.","":"Don't show this again.","":"Generate Webpage","":"Released as webpage","":"Share the webpage with friends","":"View browsing history","":"Browsing History","":"View only. To edit the document, send a request to the creator","":"You can only view this document. To edit the document, please request editing permission","":"or generate a copy for editing.","":"Edit doc","":"View only. Log in to edit it.","":"Log in now","":"Log in","":"The document is view-only.","":"The document is view-only. Click to request the edit permission","":"or generate a copy.","":"Request submitted. Waiting for approval of creator.","":"Permission request rejected. View only.","":"View only. Log in for more permissions.","":"View only","":"View only.","":"Files in Recycle Bin cannot be edited. Restore it first.","":"Restore","":"File restoring failed. Try again.","":"View revision history","":"Hide detailed records","":"Expand detailed records","{{version}}":"Version {{version}}","()":"(Current)","{{time}} ":"on {{time}}","{{versionContent}}":"the content of {{versionContent}}","":"Updated","":"Restored","{{count}}":"({{count}} in total) modified the document.","":"Revision history","":"History","":"Version","":"Are you sure you want to restore the document to this version?","":"Restored","":"Recovery failed. Try again later.","PPT":"PPT","Word":"Word","Excel":"Excel","TXT":"TXT","PDF":"PDF","":"Document","":"Create a Document","":"Generate a","":"Copy","":"Export a Document","":"to Local","":"Generate an Image","":"Save this document as a template","":"Print this document","":"Copy Full Text","":"Create a document by importing one","":"Create a document from a template","":"Create a document from a form","":"Version History is empty.","":"Find and replace","":"Find","":"Find and replace","":"Replace","":"Enter the text to find","":"Previous","":"Next","":"Find to replace","":"Replace with","":"Replace All","":"Enter the text to replace with","":"Replacements","{{count}}":"A total of {{count}} replacement(s) made.","":"Insert Headers","":"Insert Footers","":"Layout","":"Page settings cannot be changed without a page layout.","":"Custom","{{boundValue}}cm":"The sum of left and right margins shall be less than {{boundValue}} cm.","{{boundValue}}cm":"The sum of top and bottom margins shall be less than {{boundValue}} cm.","":"Orientation","":"Landscape","":"Portrait","":"Paper Size","":"Paper Size","":"Height","":"Width","":"Margins","":"Left","":"Right","":"Up","":"Bottom","{{position}}":"Editing of {{position}} will start soon. Click OK to continue.","":"Header","":"Footer","":"Header Divider","":"Keep Source Format","":"Match Target Format","":"Text Only","":"Converting... Please wait.","":"Conversion failed. Try again.","":"Invite others to collaborate","":"Viewable by Everyone","":"Editable by Everyone","":"No friends are invited yet","{{count}}":"etc. ({{count}} in total)","{{name}}":"Collaborate with {{name}}","":"Share","":"Error while loading doc validity.","":"Network error. Failed to load doc validity.","":"Access link expired. Unable to access.","":"Modify the validity","":"Document expired. Unable to access.","":"Refresh","":"Permission","":"Log in for more permissions.","":"Submitted. Waiting for approval.","":"Failed","\\n":"View only. Send a request to the creator \\nfor more permissions.","":"Shared. Your friend has joined the collaborator list.","":'Shared. The document has been changed from "Private" to "Specified Users Can Collaborate".',"":'Changed from "Private" to "Visible to Everyone".',"":'Changed from "Private" to "Editable to Everyone".',"":"Invitation sent to WeChat contacts. Please wait.","":"Document link expired","":"Document cannot be accessed by others."," {{timestr}}":"Created at {{timestr}}","-":"Tencent Docs - Online Docs","":"Unable to open document","24":"Request rejected. Try again after 24 hours.","":"E-signature","":"The document exceeds the length limit. Delete some and try again.","":"The document exceeds the length limit. Delete some or switch to SD, then try again.","":"Tap and hold the QR code to save it as my document.","":"Scan the QR code to save it as my document.","":"None","":"Tight","":"Loose","":"Generate Image","":"Generate Image"," (.png)":"Image (.png)","":"Image Watermark","":"Save to Mobile","":"Click for large picture, then press and hold to save","":"Allow others to scan the QR code to save it as their document.","":"Members can add custom watermarks to prevent unauthorized use of images.","":"Activate","":"Click to enter custom watermark text",", ":"Too much content in the document. Please wait.","":"Discard Watermark","":"Become a member to save images with watermarks","":"According to the Platform Operation Guidelines, membership activation is not available in Mini Program.","":"According to the Platform Operation Guidelines, membership activation is not available for this version.","":"Failed to generate image. Try again later.","":"Become a member to customize watermarks.",", ":"Generating... Please wait.","":"Image saved to album.","":"Unable to save the image.","":"Image generated successfully. Tap and hold the image to save or share it.","":"The page width is too narrow. Unable to generate an image.","":"Watermark Settings","":"Custom Watermark Text","":"Enter Watermark Text","":"Members can add custom watermarks.","":"Save Image","":"Saving... Please wait.","":"Failed to save. Try again later.","":"Edit permission is required to generate images.","XXXXXXXX":"MM/DD/YYYY","":"Did you mean","":"Check for typos.","":"Ignore","":"Ignore all","":"Disable Spell Check","":"Spell Check","":"No more attempts for spell check.","10":"Non-members can only use spell check for 10 times. Become a member to use it for unlimited times.","":"Become a Member","":"Normal","":"Normal Double","":"Normal Triple","2":"Normal 2","3":"Normal 3","4":"Normal 4","5":"Normal 5","":"Dash Line","":"Dotted Line","":"Expanded Dotted Line","":"Wave Line","2":"Wave Line 2","3":"Wave Line 3","":"Double Wave Line","V ":"V-shape Shading Line","X ":"X-shape Shading Line","slash ":"/-shape Shading Line","":"Divider Color","":"Divider Size","":"Divider Style","":"Divider","":"Divider Format","":"Divider","":"All Borders","":"Inside Borders","":"Inside Horizontal Border","":"Inside Vertical Border","":"Outside Borders","":"Left Border","":"Top Border","":"Right Border","":"Bottom Border","":"No Border","":"Border Color","":"Top","":"Bottom","":"Table","":"Table Format","":"Borders","":"Fill Color","":"Merge Cells","":"Align Horizontally","":"Align Vertically","":"Insert Row or Column","":"Insert Above","":"Insert Below","":"Insert Left","":"Insert Right","":"Delete Row or Column","":"Delete Entire Row","":"Delete Entire Column","":"Split Cell","":"Distribute Cells","":"Auto Adjust","":"Adaptive Page Width","":"Distribute Rows","":"Distribute Columns","":"Delete Table","":"Table alignment","":"Left","":"Center","":"Right","":"Table Left","":"Table Center","":"Table Right","":"Table Style","":"(","":")","":"Insert Table","":"Border","":"Row","":"Column","":"Row","":"Column","{{rowsCount}}":"{{rowsCount}} rows","{{colsCount}}":"{{colsCount}} cols","{{rows}}X{{columns}} ":"{{rows}}X{{columns}} Table","":"Custom","{{insertRowCount}}":"Insert {{insertRowCount}} rows above","{{insertRowCount}}":"Insert {{insertRowCount}} rows below","{{insertColCount}}":"Insert {{insertColCount}} columns to the left","{{insertColCount}}":"Insert {{insertColCount}} columns to the right","":"Abnormal table content.","":"Recover","":"Failed to recover the table. Contact us for help.","":"Recovered successfully.","{{num}}":"Enter a multiple or factor of {{num}}.","{{num}}":"The maximum number of row splits is {{num}}.","{{num}}":"The maximum number of column splits is {{num}}","":"About Template","":"Recent Text","":"Show All","":"View All"," {{time}}":"Today {{time}}","":"No text","":"Copied to clipboard. Create a new doc to paste content","":"Recent unsaved content","":"Document name updated.","{{LENGTH}}":"Document name cannot exceed {{LENGTH}} characters.","":"Enter the document name.","":"Back to Home","":"File","":"Edit","":"Hide","":"Show All","":"Translation","":"Exit","":"Translation is not supported for this language.","":"Translation failed. Try again later.","":"Translate again","{{title}} - ":"{{title}} - Translation","":"Creating translation document...","":"Failed to create new translation document. Close the page and try again.","":"Translating... Try again later.","":"Generate a new document","{count}":"Non-members can translate {count} time for free trial","":"Translate","":"Members enjoy unlimited translations","":"Free times have been used up, join the membership to enjoy unlimited translations","{{snackbarText}}{{count}}":"The document has been modified by {{snackbarText}}, etc. ({{count}} in total).","{{snackbarText}}{{nickname}}":"{{snackbarText}}{{nickname}}","":"Tap & talk to convert speech to text","":"Tap & talk","\\u00A0\\u00A0":"Recognizing speech\\u00A0\\u00A0","\\u00A0":"Recognizing speech\\u00A0","":"Recognizing speech","":"Recording... Please keep talking.","":"Recording paused. Tap to continue.","":"Recording ended.","":"Release to start. Do not hold.","":"Network error. Unable to record.","":"Allow mic access and try again.","":"Mic is being used by another app.","":"Something went wrong. Try again later.","":"Set Watermark","{{scale}}%":"Zoom: {{scale}}%","100%":"Min.: 100%","300%":"Max.: 300%","{{shortcutCtrl}}+0  100%":"{{shortcutCtrl}}+0 to zoom to 100%","":"Zoom","":"Add and Notify Participants","":"Enter the title.","":"Enter the text.","":"The file type is not supported.","ie10M":"Insert an image less than 10 MB in IE.","20M":"Insert an image less than 20 MB.","":"Image cannot be empty.","":"Edit on a larger screen.","":"Edit in portrait mode for better experience.","Chrome":"It is recommended to use the latest version of Chrome for better experience.","":"No result found.","":"Tencent Video","":"Bilibili","QQ":"QQ Music","":"Evernote","":"MockingBot","":"Mockplus","":"Via","":"Network exception. Refresh and try again.","":"Too many attempts. Try again later.","":"Server exception. Refresh and try again.","":"Login expired. Click to refresh.","":"Document status updated.","":"The content cannot be edited due to violation.","":"Account info changed. Click to refresh.","":"Document editing status changed. Click to refresh.","":"Server exception. Unable to save edits.","":"Your permissions have changed.","":"Too many edits for this operation. Unable to save.","":"Data will not be synced due to document recovery, copy has been saved for you.","":"Bold","":"Bold","":"Italic","":"Italic","":"Underline","":"Strikethrough","":"Font Color","":"Highlight","":"Format Painter","":"Clear Formatting","":"Heading Style","":"Set headings to create an outline","":"Insert Link","":"Renumber","":"Continue Numbering","":"To-Dos","":"To-Dos","":"Unordered List","":"Ordered List","":"Line Spacing","":"Indents and Spacing Options","":"Paragraph Settings","":"Indent","":"Paragraph Format","":"Align","":"Increase indent","":"Decrease indent","":"Para","":"Untitled Sheet","":"Untitled Slide","":"Untitled Mind Map","":"Untitled Flowchart",Markdown:"Markdown","":"Local file","":"Modify Countdown","":"Log in","":"Quote","":"Set as Title","@":"@","":"Reminder","":"Daily Report","":"Style","":"Never","":"Everyday","":"Weekdays","":"Every week","":"Every 2 weeks","":"Every month","":"On time"," 5 ":"5 minutes before"," 15 ":"15 minutes before"," 1 ":"1 hour before"," 1 ":"1 day before","@":"@Others","":"Activities","":"Remind","":"Reminded","":"Subscribe to Notifications","":"Subscribe to all notifications of the document","":"Only accept notifications related to me","@":"Content is editedSomeone @meNew comment","@":"Someone @meparticipating comments have new replies","":"Add to Favorites","":"Exit document member","":"Cancel collection","":"Manage Permission","":"Save as Template","":"Get Link for Sharing","":"Paste Text Only","":"To paste text only, please enable clipboard permission.","":"Open in the browser","":"Add to mail","":"Demo","":"Add document members","":"Comment archived","":"Deleted","":"Collaboration","":"Activities","":" is viewing","{{peoples}}{{count}}":"{{peoples}}, etc. ({{count}} members)","{{count}}":"{{count}} members"," {{count}} ":"A maximum of {{count}} externals can be added to the document. Please remove some externals first."," {{count}} ":"A maximum of {{count}} external editors is allowed for the document. Please remove some users' edit permissions first.","":"External","":"Enterprise","":"Not yet","":"Failed to generate copy","":"Minimalistic toolbar","":"Classic toolbar","":"Hide toolbar","":"Show Toolbar","":"Personal","":"Increase font size","":"Decrease font size","":"Add-ons","":"Highlight block","":"Backgroud Color","":"Clear","":"Shortcuts","":"Exit document","":"Exit the document","":"After exiting, other members in the document will not be notified, and will no longer receive messages from this document","":"Size Setting","":"Clarity","":"Renew membership","":"Members enjoy custom watermarks and the privilege of outputting high-definition pictures","":"Open member to enjoy custom watermark and output high-definition picture privilege.","":"Open member to enjoy custom watermark","":"and output high-definition picture privilege.","":"Unable to save picture","":"Image saved successfully","":"SD","":"HD","":"HD (recommended)","":"Clarity effect comparison","":"Enter custom watermark text","":"Watermark","":"Watermark text","":"Watermark size","":"Filling method","":"Center","":"Tile","":"Not available without authorization","":"Print prohibited","":"Large","":"Small","":"Renew now","":"All Tencent documents","":"Confidential do not spread","":"Applicable screen","":"Suitable for printing","":"Check out the sharpness effect comparison"," {{members}} ":"Too many participants in the document. Unable to select {{members}}."," {{members}}, ?":"You're going to select {{members}}.","":"Meeting members have permissions to view the documents. The permissions will automatically expire after the presentation","":"Follow Speaker","":"Can not open link during presentation.","":"Presentation Abort","":"You have no permission for the document, presentation shutdown.","":"The speaker have no permission for the document, presentation shutdown.","":"Operation not supported during presentation","":"The content is too long, please delete and regenerate","":"Failed to generate image, please exit and reopen the document","":"Watermark content has security risk","":"Modify watermark","":"show certification","":"Official verification information shown for this file.","":"Official verification information hidden for this file.","":"Show official verification info fail","":"No access to share","":"Content cannot be shared.","":"Non-document-members need to apply for joining","":"Only externals can join with the Allow Edit permission by default","":"Only externals can join with the View Only permission by default","":"Anyone can join","":"Externals and specified company members can join","":"Only company members can join with the Allow Edit permission by default","":"Only company members can join with the View Only permission by default","":"Only specified company members can join","":"Get Link","":"Links Share","":"Only can join upon approval of the admin","{{content}}":"The current location does not support pasting {{content}}","":"Pasting is not supported for some data"," {{sectIdx}} ":"Section {{sectIdx}}","":"First Page","":"Even Page","":"Odd Page","":"Link to Previous","":"Same as Previous","":"Page Number Settings","":"Header Settings","":"Footer Settings","":"Delete Header","":"Delete Footer","":"Delete Page Number","":"Different First Page","":"Different Odd & Even Pages","{{position}}{{position}}":"Are you sure you want to delete this {{position}} and link it to the previous section {{position}}?","{{position}}":"Are you sure you want to delete the current {{position}} content?","":"Page Number Position","":"Page numbering","":"Continue from previous section","":"Start at","":"Left","":"Center","":"Right","":"Double Page Inside","":"Double Page Outside","":'Admin turned on "Prohibit preview-only members from copying content"',"":"Your current permissions do not support viewing revision history","":"Your current permissions do not support the use of editing functions"," {{maxSelectMemberCount}} ":"Limit exceeded. A maximum of {{maxSelectMemberCount}} members can be selected every time.","":"Will send notifications to added members. Continue?","":"Your current permissions do not support copying content","":"Limited","":"Import document","":"Import local files","":"Version upgrade reminder","":"This function is not supported at the moment, please use it after upgrading WeChat Enterprise","":"Go to upgrade","":"The Scroll View will not Show Header footer Or Floating Drawings","":"Select paragraphs to set title","":"Select paragraphs to set style","":"Select paragraphs to delete","":"Select paragraphs to cut","":"Select paragraphs to copy","":"Please use this function in Enterprise WeChat","...":"Loading...","":"The meeting was canceled by the initiator","":"Unavailable, meeting has been disabled by the administrator","":"Unavailable, calender has been disabled by the administrator","":"The meeting has been deleted by the initiator","":"Schedule has been deleted","":"Account error. Unable to use Meeting","":"The event has expired","":"The number of participants in the event has reached the limit","":"This event has been deleted by the creator","":"The event creator has restricted joining","":"Unable to join. The number of participants has reached the limit","":"The meeting is in progress and cannot be modified","":"Operation failed. Try again later.","":"Saving failed","":"Password is required to join the meeting. Update your WeCom version","":"This meeting is a webinar. Unable to add members","":"Incorrect password","":"The meeting is in progress. Join the meeting and then invite","":"Forward","":"Task List","PDF":"Convert document to PDF","PDFWord":"Convert PDF to Word","PDFExcel":"Convert PDF to Excel","PDFPPT":"Convert PDF to PPT","PDF":"PDF conversion","":"No exportable permissions, please contact the document owner","":"Format Conversion"},like:{"disable-like":"Disable Animated Like for the file","enable-like":"Enable Animated Like for the file","toggle-like":"Animated Like","setting-failed":"Set failed. Try again.","setting-success":"Set successfully."},"local-edit":{retry:"retry","enter-password":"Please enter the password","enter-file-password":"Enter file password","password-is-required":"This is a secret file, password is required","incorrect-password":"The password is incorrect, please re-enter","use-now":"use-now","need-upload-content":"This function requires data to be uploaded for processing. it won't stored on the server after use. ","please-connect-network":"This function is not available offline, please try again after connecting to the Internet","open-error-unknown":"Failed to open the document","open-error-busy":"The document is being used by other applications and cannot be opened temporarily","open-error-not-entity":"Failed to open the document, please check whether the document storage path has changed","open-error-permittion":"No permission to read the document, open failed","open-error-converter-install":"The program initialization failed, please restart the application and try again","save-error-unknown":"failed to save","save-error-busy":"The document is being used by other applications, please close other applications first, or save the document","save-error-not-entity":"The save path does not exist, please choose a new save location","save-error-permittion":"There is no permission to save the document, please try again or save the document as","save-error-converter-install":"Failed to save the document, please try again","import-unknown-docs":"Document opening failed","save-path-not-exit":"Failed to save the document, please check whether the document storage path has changed","cannot-open":"can't open","cannot-save":"can't save","show-item-in-folder":"Open file location","view-origin-file":"view original file","compatibility-issues":"This file has some compatibility issues, a copy of the original file has been generated for you",check:"check","need-login":"Log in to edit files if you are not logged in, you can only view files","error-tips":"document conversion error ({{code}})",save:"save","transfer-to-multi":"Collaborative editing","upload-to-drive":"Upload to the cloud","share-local-file":"Sharing and Sending","mobile-password-error":"The password is incorrect, please re-enter","image-upload-error":"Image upload failed. Please try again","image-download-error":"Image saving failed. Please try again","file-read-error":"Document opening failed. Please try again","not-implemented":"Document saving failed. Please try again or save the document as a new file","export-file-error":"Document export failed","export-cancel":"Export task has been cancelled. Please try again","open-fail":"Export task has been cancelled. Please try again.",readonly:"View only"},markdown:{"description-text":"Supports input in basic Markdown format"},mention:{"doc-members":"Members","from-contacts":"From Contacts","no-contacts-found":"No contacts found",mention:"Mention","mention-n-persons":"@Mention {{count}} person(s)","select-doc-member":"Select document member"},outline:{cube:"Outline"},"page-shade":{"page-background":"Watermark/Shading",shading:"Shading"},"paged-view":{edit:"Editing will close the paged view.",name:"Paged View"},paste:{"paste-toast-prefix":"Copy content contains unsupported data"},personalize:{settings:"Personality Settings",background:"Background","settings-description":""},presentation:{"waiting-persons":"{{remoteMemberCount}} viewer are waiting.","waiting-persons_plural":"{{remoteMemberCount}} viewers are waiting.","local-presentation":"Local Presentation","present-with-tencent-meeting":"Present with Tencent Meeting","remote-presentation":"Remote Presentation","tencent-meeting-tooltip-title":"Use Tencent Metting to present this documents","tencent-meeting-tooltip-desc":"You can directly cast this document to screen to improve the efficiency of collaboration with one click"},print:{"permission-not-allow":"The document creator has restricted the viewers' permissions. Unable to print.","miniprogram-not-allow":"Printing is not supported in Mini Programs","print-service-error":"The browser print service failed to load, please refresh and try again"},publish:{scan:"Scan QR Code with WeChat/QQ"},report:{"":"","":"","":"","":"","":"","{{name}}":"{{name}}","{{name}}":"{{name}}","":"tomorrow ","":"next week ","":"next month ","":"You have filled the report","":"you can fill again","":"","":"transfer to hint","":"delete hint","":"You can customize the hint.","":"Make selection and transfer word to hint. You can also longtap and delete the hint.","":"Make selection and right click to transfer word to hint. You can also right click and delete the hint."},resume:{sidebar:{title:"Resume Assistant",content:"Having trouble with your resume? Try the Resume Assistant.",desc:["Content refinement, one-stop formatting and beautification, massive reference cases to help you create a high-scoring resume"],button:"Use Now",cancel:"Don't remind me again",loading:"Loading"},"cancel-dialog":{title:"Reminder",content:"You can find Resume Assistant in the Toolbox on the homepage."},toast:{"import-file-oversize":"The file is too large","import-failed":"Failed to load. Please try again later","cancel-reminder":"You can use it next time in 'Addon-Resume Assistant'","action-more":"Learn more"},menu:{title:"Resume Assistant",description:"Intelligently polish content, one-stop typesetting beautification, massive reference cases, help you make high-scoring resumes!"},mobile:{message:"Use Resume Assistant to create a high-scoring resume with just one click",action:"Open"}},revision:{too_many_online_visit:"Unable to view the revision record due to the large number of visitors"},search:{"prompt-clear-all":'Are you sure you want to delete all {{searchCount}} "{{searchTarget}}" in this document?',"prompt-replace-all":'Are you sure you want to replace all {{searchCount}} "{{searchTarget}}" in this document with "{{value}}"?'},share:{"policy-private":"View/edit only by me","policy-limited":"View/edit only by specified users","policy-read":"Everyone can view the document via the link","policy-edit":"Everyone can edit the document via the link","editable-persons":"{{count}} member can edit it:","editable-persons_plural":"{{count}} members can edit it:","can-only-view":"You can only view this document.","only-supported-app":"This capability is only supported in the APP.","go-now":"Go now"},"snap-screen":{payment:"Go to the Tencent Docs for web/app to purchase a membership.","file-name":"{{productName}} screenshot.png"},snippet:{"task-main-text":"\nTask 1\n\n\n\n\nTask 2\n\n\n\n\n","task-main-attribs":"*0*1*2*3+1*3*4+6*5*6*7*1*8*2*3*4+1*9*a*1*b*2*c*3+1*9*a*1*b*2*d*3+1*9*a*1*b*2*e*3+1*9*2*3+1*3*4+6*5*6*7*1*8*2*3*4+1*9*a*1*b*2*c*3+1*9*a*1*b*2*d*3+1*9*a*1*b*2*e*3+1*9*2*3+1","task-insert-mention-hint":"Enter mention@ and invite relevant personnel to complete the task together.","task-insert-doc-hint":"Insert docTencent Docs to quickly insert related documents.","work-daily-main-text":"\nToday's WorkTomorrow's Plan\n\n\n\n\n\nWork Summary\n\n\n\n","work-daily-main-attribs":"*0*1*2*3*4*5*6*7*8+1*9*a*b*c*d*e*f+1*7*9*g+1*7*9*h+1*7*i*j*k+c*l*2*3*m*n*7*o*9*p*q*r*s*t*h+1*7*9*h+1*7*i*j*k+f*l*2*3*m*n*7*o*9*p*q*r*s*t*h+1*7*9*g+2*7*9*h+1*0*2*3*u*v*7*o+1*2*3*w*u*x*v*y*7*z+1*2*3*w*u*x*v*10*7*z+1*0*2*3*u*v*7*z*9*q*r*s*t*h+1*7*9*h+1*11*2*3*12*u*v*7*o*9+1*2*3*12*13*u*14*v*y*7*o*9+1*2*3*12*13*u*14*v*10*7*o*9+1*11*2*3*12*u*v*7*o*9*q*r*s*t*h+1*7*9*g+2*7*9*h+1*7*i*j*15+c*l*2*3*m*n*7*15*9*16*q*r*s*t*17*18*h+1*7*9*h+1*2*3*7*o*9*16*q*r*s*t*19*1a*h+1*7*9*g+2*7*9*h+1*2*3*1b*7*o+1*2*3*7*o+2*2*3*7*o*9*q*r*s*t*17*18*h+1*7*9*h+1*2*3*7*o*9*q*r*s*t*19*1a*h+1*7*9*g+1*9*a*b*c*d*e*f+1*11*u*v*7+1","work-daily-insert-mention-hint":"Describe today's work and mention@related colleagues","work-daily-insert-doc-hint":"Or insert docTencent Docs","work-daily-summary-hint":"Today, I completed","work-report-main-text":"\nThis Week's Work\n\n\nCore Project I\n\n\n\n\nCore Project II\n\n\n\n\n\n\n\nNext Week's Work Plan\n\n\n","work-report-main-attribs":"*0+h*1*2*0+1*3*4*0+1*3*0+1*0*5+e*1*6*7*8*9*a*0*5+1*1*3*b*8*c*a*d*0+1*1*3*b*8*c*a*e*0+1*1*3*b*8*c*a*f*0+1*g*h*i*j*k*l*m*0*n+1*0*5+f*1*6*7*8*9*a*0*5+1*1*3*o*8*p*a*q*0+2*1*3*o*8*p*a*f*0+1*g*h*i*j*k*l*m*0*n+1*1*6*7*8*9*a*f*0*5+1*g*h*i*j*k*l*m*0*n+2*0+l*1*2*0+1*1*3*r*0+1*s*8*a*0+1","work-report-done-summary-hint":"Add Work Summary","work-report-insert-mention-hint":"John Doe: completed XX, progress XX. Enter mention@ to invite the colleague for confirmation.","work-report-progress-hint":"John Doe: completed XX, progress XX.","work-report-next-summary-hint":"Describe next week's work or projects","meeting-record-main-text":"\nParticipants: Tom | Nick | Harry\nMeeting Time: MM/DD/YYYY\n\nMeeting Discussions\nTopic 1Topic 2\nConclusion\n\n","meeting-record-main-attribs":"*0*1*2+1*2+10*0*1*2+1*2+o*0*1*2+1*3*4*5*6*7*8*9*2*a+1*2*b+j*0*c*2*b+1*d*e*f*g*h*i*j*k+1*2*d*l+1*2*d*m+1*2*n*o*p+7*3*4*5*6*q*r*1*9*2*d*s*t*u*v*w*x*y*m+1*2*d*l+2*2*d*m+1*3*4*5*6*q*r*1*9*z*2*d*t*u*v*w*m+1*2*d*l+2*2*d*m+1*5*6*q*r*9*z*2*a*d*t*u*v*w*m+1*2*d*l+2*2*d*m+1*5*6*q*r*9*10*2*a*d*t*u*v*w*m+1*2*d*l+2*2*d*m+1*2*n*o*p+7*5*6*q*r*9*2*d*11*t*u*v*w*x*y*m+1*2*d*l+2*2*d*m+1*3*4*5*6*q*r*1*9*z*2*d*t*u*v*w*m+1*2*d*l+2*2*d*m+1*5*6*q*r*9*z*2*a*d*t*u*v*w*m+1*2*d*l+2*2*d*m+1*5*6*q*r*9*10*2*a*d*t*u*v*w*m+1*2*d*l+1*d*e*f*g*h*i*j*k+1*3*4*5*6*7*8*9*2*a+1*2*b+a*0*c*2*b+1*d*12*f*g*13*i*j*k+1*2*d*l+1*2*d*m+1*3*4*5*6*q*r*1*9*14*2*d*t*u*v*w*m+1*2*d*l+2*2*d*m+1*5*6*q*r*9*15*2*a*d*t*u*v*w*m+1*2*d*l+2*2*d*m+1*5*6*q*r*9*10*2*a*d*t*u*v*w*m+1*2*d*l+1*d*12*f*g*13*i*j*k+1*3*4*5*6*7*8*9*2+1","meeting-record-insert-mention-hint":"mention@related colleagues: Describe viewpoints and key content","meeting-record-conclusion-hint-1":"Conclusion 1: enter mention@ to invite related colleagues.","meeting-record-conclusion-hint-2":"Conclusion 2: enter mention@ to invite related colleagues.","menu-insert-snippet":"Snippets","menu-task-list":"Task List","menu-work-daily":"Daily Report","menu-work-report":"Work Report","menu-conference-record":"Meeting Minutes","description-task-list":"Record tasks and manage progress.","description-work-daily":"Collect daily summaries to make every little step count.","description-work-report":"Sort out and document tasks for report.","description-conference-record":"Record opinions and sync information."},spellcheck:{"menu-text":"Spell Check","description-text":"Quickly identify typos in words"},splitline:{"no-divider":"No divider"},table:{"merge-cell":"Merge"},title:{"forbidden-chars":'Document name cannot contain: \\, /, :, *, ?, ", <, >, and |',"forbidden-chars-mobile":'Characters  \\ / : * ? " < > | cannot be synced to document name.',"forbidden-chars-pc":'Title contains the following characters \\ / : * ? " < > | Unable to sync to document name.',"un-highlight-doc-name":"Un-highlight document name","highlight-doc-name":"Highlight document name","highlighted-by-creator":"Document name is highlighted by creator"},titlebar:{"insert-tips":"Image/Table, etc."},"to-top":{"add-fast-access":"Top document","cancel-fast-access":"Cancel Top document",added:"This document has been placed on top",rremoved:"This document has been removed from the top",limited:"The top document has reached the upper limit. Please remove the top document before adding",failed:"Operation failed. Try again later."},translate:{auto:"Automatic",zh:"Chinese",en:"English",ja:"Japanese",ko:"Korean",fr:"French",es:"Spanish",de:"German","menu-text":"Translation","description-text":"Fast translation of text content into multiple languages"},ui:{"more-text":"More","more-tooltip":"More Features","no-color-text":"No color","custom-color-text":"Custom","recent-colors-text":"Recently Used","default-color":"Default","toolbar.style":"Style","toolbar-toggle":"Toolbar Display Options","unofficial-addons":"Addon",orientation:"Orientation/Size",loading:"Loading..."},"update-notice":{"guide-to-pc":"{{snackbarText}}. You can view revision history by visiting {{host}} on PC."},wordcount:{"statusbar-count":"{{- wordcount}} word","statusbar-count_plural":"{{- wordcount}} words","statusbar-count-no-punctuation":"{{- wordcount}} word (no punctuations)","statusbar-count-no-punctuation_plural":"{{- wordcount}} words (no punctuations)","statusbar-characters":"{{- wordcount}} character","statusbar-characters_plural":"{{- wordcount}} characters","statusbar-characters-no-spaces":"{{- wordcount}} character (no spaces)","statusbar-characters-no-spaces_plural":"{{- wordcount}} characters (no spaces)","statusbar-text_plural":"{{- wordcount}} words",count:"Words","count-characters":"Characters","count-no-punctuation":"Words (no punctuations)","count-characters-no-punctuation":"Number of characters (not counting punctuation)","count-info":"Statistics","count-characters-no-spaces":"Characters (no spaces)","word-count":"Word count"},"wrap-text":{"wrap-text":"Wrap text style","image-wrapping-style":"Image wrapping style","in-line-with-text":"In line with text",square:"Square","table-square":"Square","top-and-bottom":"Top and bottom","behind-text":"Behind text","in-front-of-text":"In front of text","move-object-with-text":"Move with text","lock-anchor":"Fix position on page"}},"zh-CN":{accessibility:{welcome:"{{productName}} control  ~ ","modal-text":"{{onOkContent}}  control  ~ "},"add-fast-access":{"add-fast-access":"","cancel-fast-access":"",added:"",removed:"",limited:"",failed:""},"add-to-wedrive":{"add-to-wedrive":"","view-in-wedrive":"",wedrive:"",added:"","add-to-directories":"",directory:"","add-wedrive-shortcut":"...","move-to-wedrive":"..."},addon:{addons:"","unofficial-plugins":"","plugin-activated":"","third-party-plugins":"","manage-addons":"","get-addons":"","go-to-computer-client-or-browser":"","recommend-addon":"","installed-addon":"","no-use-addon":"","same-addon":"","flow-chart":"","permission-denied-tips":""},"app-guide":{"brand-text":" /  / "},attachment:{doc:"",file:"","wedrive-file":"","local-file":"","select-wedrive":"","select-online":"","select-search-file":"","select-search-doc":"","search-result":"","delete-attachemnt":"","download-attachemnt":"","switch-mode":"","description-text":"","over-wedrive-capacity":""},audio:{encoding:"..."},card:{"calendar-event":"","select-from-list":"","new-calendar-event":"","change-layout":"",card:"","chat-history":"","group-business-card":"","untitled-group-chat":"","personal-business-card":"","add-personal-business-card-notification-message":"{{user}}{{document}}","event-deleted":"","group-chat-history":"{{group}}","join-group":"",app:"",weapp:"","meeting-event":"","select-meeting-from-list":"","new-meeting-event":""},color:{"font-color":""},comment:{"sync-to-group":": {{group}}",comments:"","archive-comments":"",like:"","empty-range-tip":"","empty-ent-range-tip":"","audit-add-fail":"","audit-edit-fail":"","":""},"core-edit":{"error-code-with-date":":{{errCode}}  {{date}}","no-clipboard-permission":"","no-copy-permission":"","use-shortcut-key-without-permission":" {{ctrl}}+V ","right-click-paste-instructions":"",copying:"","image-compress":"","image-unable-copy":""},data:{recovering:""},"doc-link":{"failed-to-load-preview-image":"",retry:"",loading:"","file-has-been-deleted":"","open-in-new-window":"","no-viewing-permission":""},"e-signature":{"click-to-sign":"","e-signature-message-without-contract":"","e-signature-message-full":"","e-signature-message-left":"","e-signature-message-middle":"","e-signature-message-right":""},"edit-tips":{"touch-tips":"",edit:"","security-risk":""},"field-code":{"fixed-read-addon-iframe":"[]","fixed-read-sheet-iframe":"[]"},field:{"cancel-link":"",delete:"",refresh:"","full-screen":"","display-mode":"","modify-link":"","copy-link":"","open-link":"","jump-to-source-page":"",preview:"",card:"","icon-text-link":"+","text-link":"","demo-insert":"DEMO"},"fieldcode-page":{menu:"/"},"file-base":{cloning:"...","cloning-patient":"","clone-title":"-{{- title}}","import-empty-error":"","import-size-error":"{{fileSizeLimit}}MB","import-exts-error":" {{exts}} ","delete-doc-tips":"","delete-doc":"",delete:"",deleting:"...","delete-success":"","delete-fail":"","import-doc-success-tip":"",view:"",confused:""},"file-export":{"local-zip":"Word","local-docx":"Word(.docx)",export:"","export-failed":"","export-failed-tips":"","":"","":"","":"","":"","":"","export-hina-fail":"","":""},"file-mobile":{creator:": {{creator}}",version:": {{- version}}","save-as-template":"","log-report":"","text-history":"","help-and-feedback":""},"file-pc":{privacy:"","privacy-policy":"","third-information-checklist":"","third-authorization-management":"","personal-information-checklist":""},font:{"change-size":"/"},fonts:{"cannot-clone":"","buy-vip-to-clone":"","buy-vip":""},image:{"mask-tips":":{{width}} &nbsp;&nbsp;:{{height}}","camera-fail":"","camera-no-permission":"","restore-image":"",restore:"","extract-text":""},"keymap-list":{editing:"","insert-page-break":"","insert-ordered-list":"","insert-unordered-list":"","increase-font-size":"","decrease-font-size":"",navigation:"",view:"",selection:"","move-left-char":"","move-right-char":"","move-up":"","move-down":"","move-left-word":"","move-right-word":"","move-to-line-start":"","move-to-line-end":"","move-to-prev-page":"","move-to-next-page":"","table-horizon-scroll":"","horizon-scroll":"","select-left-char":"","select-right-char":"","select-up":"","select-down":"","select-to-line-start":"","select-to-line-end":"","select-to-left-word":"","select-to-right-word":"","select-to-para-start":"","select-to-para-end":"","markdown-h1":"","markdown-h2":"","markdown-h3":"","markdown-h4":"","markdown-h5":"","markdown-h6":"","insert-code-block":"","insert-todo":"","insert-todo-done":"","insert-splitline":"","insert-quote":"","insert-highlight-block":"",text:"","insert-bold":"","insert-italic":"","insert-underline":"","insert-strike-through":"",zoom:"/","zoom-restore":"100%","open-keymap-list":"/",wheel:"",space:"","paragraph-style":"","text-style":"","apply-normal-style":'""',"apply-h1-style":'" 1"',"apply-h2-style":'" 2"',"apply-h3-style":'" 3"',"apply-h4-style":'" 4"',"apply-h5-style":'" 5"',"apply-h6-style":'" 6"',"apply-big-title-style":'""',"apply-little-title-style":'""',"add-comment":"","show-comments":"","add-ent-comment":"","show-ent-comments":""},legacy:{"":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{currentPrivilege}}":"{{currentPrivilege}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{text}}":"{{text}}","":"","":"","":"","Chrome":"Chrome","{{minValue}}{{maxValue}}":"{{minValue}}{{maxValue}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""," 1":" 1"," 2":" 2"," 3":" 3"," 4":" 4"," 5":" 5"," 6":" 6","":"","":"","":"","":"","":"","":"","Cmd+V":"Cmd+V","Ctrl+V":"Ctrl+V","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","snapshot":"snapshot","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","EnterEsc":"EnterEsc","":"","":"","EnterEsc":"EnterEsc","":"","":"","":"","LaTeX":"LaTeX","":"","":"","":"","":"","":"","":"","QQ":"QQ","":"","":"","":"","":"","":"","":"...","":"","":"","+":"+","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{action}}":"{{action}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",", ":", ","":"","":"","":"","":"","":"","":"","":"","?":"?","":"","":"","":"","":"","```+":"```+","":"","":"","":"","":"","":"","":"","{{modifiedBy}}{{updateTime}}":"{{modifiedBy}}{{updateTime}}","":"","":"","":"","{{diffMinutes}}":"{{diffMinutes}}","{{diffHours}}":"{{diffHours}}","{{diffDays}}":"{{diffDays}}","yyyyMM":"yyyyMM","MMdd":"MMdd","":"","{{op}}":"{{op}}","{{op}}":"{{op}}","":"","":"","1000":"1000","1000":"1000","1000":"1000","":"","":"","":"","":"","":"","":"","@":"@","{{foldCount}}":"{{foldCount}}","":"","":"","":"","{{op}}":"{{op}}","{{op}}":"{{op}}","":"","":"","":"","":"","@":"@","":"","":"","":"","1000":"1000","1000":"1000","":"","1000":"1000","":"","":"","":"","":"","":"","":"","":"","":"","":"","@":"@","":"","":"","":"","":"","":"","{{foldCount}}":"{{foldCount}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""," {{ctrl}}+V ":" {{ctrl}}+V ","Chrome":"Chrome","":"","":"","":"","SafariSafari":"SafariSafari","":"","":"","":"","":"","":"","":"","{{pageCount}}":"{{pageCount}}","{{pageResult}}":"{{pageResult}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","yyyyMMdd":"yyyyMMdd","":"","":"","":"","":"","":"","":""," 1 ":" 1 "," 0 ":" 0 ","":"","100KB":"100KB","":"","":"","":"","":"","":"","":"","Word":"Word","Word":"Word","PDF":"PDF","":"","Worddocx":"Word.docx","Word":"Word","PDF":"PDF","PDF":"PDF","docx":".docx","docx":".docx","":"","":"","":"","":"","":"","":"","":"","":"{{user}}","":"","":"","":"","":"","":"","":"","":""," {{allWordCount}} ":" {{allWordCount}} ","":"","":"","":"","":"","":"","":"","":": {{ver}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{value}}":"{{value}}","":"","":"","":"","(Esc)":"(Esc)","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","LaTeX":"LaTeX"," ":" ","":"","":"","":"","":"","":"","":"","":"","()":"()","()":"()","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","Markdown":"Markdown","":"","":"...","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""," {{page}}  -  {{pageCount}} ":" {{page}}  /  {{pageCount}} ","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","cmd+C":"cmd+C","Ctrl+C":"Ctrl+C","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","?":"?","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{version}}":"{{version}}","()":"()","{{time}} ":"{{time}} ","{{versionContent}}":"{{versionContent}}","":"","":"","{{count}}":"{{count}}","":"","":"","":"","":"","":"","":"","PPT":"PPT","Word":"Word","Excel":"Excel","TXT":"TXT","PDF":"PDF","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{count}}":"{{count}}","":"","":"","":"","":"","":"","{{boundValue}}cm":"{{boundValue}}cm","{{boundValue}}cm":"{{boundValue}}cm","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{position}}":"{{position}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{count}}":"{{count}}","{{name}}":"{{name}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","\\n":"\\n","":"","":"","":"","":"","":"","":"","":""," {{timestr}}":" {{timestr}}","-":"-","":"","24":"24","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""," (.png)":" (.png)","":"","":"","":"","":"","":"","":"","":"",", ":", ","":"","":"","":"","":"","":"","":"",", ":", ","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","XXXXXXXX":"XXXXXXXX","":"","":"","":"","":"","":"","":"","":"","10":"10","":"","":"","2":"2","3":"3","4":"4","5":"5","":"","":"","":"","":"","2":"2","3":"3","":"","V ":"V ","X ":"X ","slash ":"/ ","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{rowsCount}}":"{{rowsCount}}","{{colsCount}}":"{{colsCount}}","{{rows}}X{{columns}} ":"{{rows}}X{{columns}} ","":"","{{insertRowCount}}":"{{insertRowCount}}","{{insertRowCount}}":"{{insertRowCount}}","{{insertColCount}}":"{{insertColCount}}","{{insertColCount}}":"{{insertColCount}}","":"","":"","":"","":"","{{num}}":"{{num}}","{{num}}":"{{num}}","{{num}}":"{{num}}","":"","":"","":"","":""," {{time}}":" {{time}}","":"","":"","":"","":"","{{LENGTH}}":"{{LENGTH}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{title}} - ":"{{title}} - ","":"","":"","":"","":"","{{snackbarText}}{{count}}":"{{snackbarText}}{{count}}","{{snackbarText}}{{nickname}}":"{{snackbarText}}{{nickname}}","":"","":"","\\u00A0\\u00A0":"\\u00A0\\u00A0","\\u00A0":"\\u00A0","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{scale}}%":"{{scale}}%","100%":"100%","300%":"300%","{{shortcutCtrl}}+0  100%":"{{shortcutCtrl}}+0  100%","":"","":"","":"","":"","":"","ie10M":"ie10M","20M":"20M","":"","":"","":"","Chrome":"Chrome","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",Markdown:"Markdown","":"","":"","":"","":"","@":"@","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""," 5 ":"5"," 15 ":"15"," 1 ":"1"," 1 ":"1","@":"@","":"","":"","":"","@":"@","@":"@","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{peoples}}{{count}}":"{{peoples}}{{count}}","{{count}}":"{{count}}","remind-short":"","reminded-short":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""," {{members}} ":" {{members}} "," {{members}}, ?":" {{members}}, ?","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":".","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{content}}":"{{content}}","":""," {{sectIdx}} ":" {{sectIdx}} ","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{position}}{{position}}":"{{position}}{{position}}","{{position}}":"{{position}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""," {{maxSelectMemberCount}} ":" {{maxSelectMemberCount}} ","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","...":"...","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","PDF":"PDF","PDFWord":"PDFWord","PDFExcel":"PDFExcel","PDFPPT":"PDFPPT","PDF":"PDF","":"","":""},like:{"setting-failed":"","setting-success":"","enable-like":"","disable-like":"","toggle-like":""},"local-edit":{retry:"","enter-password":"","enter-file-password":"","password-is-required":"","incorrect-password":"","use-now":"","need-upload-content":"","please-connect-network":"","open-error-unknown":"","open-error-busy":"","open-error-not-entity":"","open-error-permittion":"","open-error-converter-install":"","save-error-unknown":"","save-error-busy":"","save-error-not-entity":"","save-error-permittion":"","save-error-converter-install":"","import-unknown-docs":"","save-path-not-exit":"","cannot-open":"","cannot-save":"","show-item-in-folder":"","view-origin-file":"","compatibility-issues":"",check:"","need-login":"","error-tips":" ({{code}})",save:"","transfer-to-multi":"","upload-to-drive":"","share-local-file":"","mobile-password-error":"","image-upload-error":"","image-download-error":"","file-read-error":"","not-implemented":"","export-file-error":"","export-cancel":"","open-fail":"",readonly:""},markdown:{"description-text":" Markdown "},mention:{"doc-members":"","from-contacts":"","no-contacts-found":"",mention:"","mention-n-persons":"{{count}}","select-doc-member":""},outline:{cube:""},"page-shade":{"page-background":"/",shading:""},"paged-view":{edit:"",name:""},paste:{"paste-toast-prefix":""},personalize:{settings:"",background:"","settings-description":""},presentation:{"waiting-persons":"{{remoteMemberCount}}","local-presentation":"","present-with-tencent-meeting":"","tencent-meeting-tooltip-title":"","tencent-meeting-tooltip-desc":"","remote-presentation":"","waiting-persons_plural":"{{remoteMemberCount}}"},print:{"permission-not-allow":"","miniprogram-not-allow":"","print-service-error":""},publish:{scan:" / QQ"},report:{"":"","":"","":"","":"","":"","{{name}}":"{{name}}","{{name}}":"{{name}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},resume:{sidebar:{title:"",content:"",desc:["",""],button:"",cancel:"",loading:""},"cancel-dialog":{title:"",content:""},toast:{"import-file-oversize":"","import-failed":"","cancel-reminder":"-","action-more":""},menu:{title:"",description:""},mobile:{message:"",action:""}},revision:{too_many_online_visit:""},search:{"prompt-replace-all":"{{searchCount}}{{searchTarget}}{{value}}","prompt-clear-all":"{{searchCount}}{{searchTarget}}"},share:{"policy-private":"/","policy-limited":"/","policy-read":"","policy-edit":"","editable-persons":"{{count}}: ","editable-persons_plural":"{{count}}: ","can-only-view":"","only-supported-app":"APP","go-now":""},"snap-screen":{payment:"/APP","file-name":"{{productName}}.png"},snippet:{"task-main-text":"\n\n\n\n\n\n\n\n\n\n\n","task-main-attribs":"*0*1*2*3+1*3*4+3*5*6*7*1*8*2*3*4+1*9*a*1*b*2*c*3+1*9*a*1*b*2*d*3+1*9*a*1*b*2*e*3+1*9*2*3+1*3*4+3*5*6*7*1*8*2*3*4+1*9*a*1*b*2*c*3+1*9*a*1*b*2*d*3+1*9*a*1*b*2*e*3+1*9*2*3+1","task-insert-mention-hint":"mention@","task-insert-doc-hint":"doc","work-daily-main-text":"\n\n\n\n\n\n\n\n\n\n\n","work-daily-main-attribs":"*0*1*2*3*4*5*6*7*8+1*9*a*b*c*d*e*f+1*7*9*g+1*7*9*h+1*7*i*j*k+4*l*2*3*m*n*7*o*9*p*q*r*s*t*h+1*7*9*h+1*7*i*j*k+4*l*2*3*m*n*7*o*9*p*q*r*s*t*h+1*7*9*g+2*7*9*h+1*0*2*3*u*v*7*o+1*2*3*w*u*x*v*y*7*z+1*2*3*w*u*x*v*10*7*z+1*0*2*3*u*v*7*z*9*q*r*s*t*h+1*7*9*h+1*11*2*3*12*u*v*7*o*9+1*2*3*12*13*u*14*v*y*7*o*9+1*2*3*12*13*u*14*v*10*7*o*9+1*11*2*3*12*u*v*7*o*9*q*r*s*t*h+1*7*9*g+2*7*9*h+1*7*i*j*15+4*l*2*3*m*n*7*15*9*16*q*r*s*t*17*18*h+1*7*9*h+1*2*3*7*o*9*16*q*r*s*t*19*1a*h+1*7*9*g+2*7*9*h+1*2*3*1b*7*o+1*2*3*7*o+2*2*3*7*o*9*q*r*s*t*17*18*h+1*7*9*h+1*2*3*7*o*9*q*r*s*t*19*1a*h+1*7*9*g+1*9*a*b*c*d*e*f+1*11*u*v*7+1","work-daily-insert-mention-hint":"mention@","work-daily-insert-doc-hint":"doc","work-daily-summary-hint":"","work-report-main-text":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","work-report-main-attribs":"*0+7*1*2*0+1*3*4*0+1*3*0+1*0*5+5*1*6*7*8*9*a*0*5+1*1*3*b*8*c*a*d*0+1*1*3*b*8*c*a*e*0+1*1*3*b*8*c*a*f*0+1*g*h*i*j*k*l*m*0*n+1*0*5+5*1*6*7*8*9*a*0*5+1*1*3*o*8*p*a*q*0+2*1*3*o*8*p*a*f*0+1*g*h*i*j*k*l*m*0*n+1*1*6*7*8*9*a*f*0*5+1*g*h*i*j*k*l*m*0*n+2*0+6*1*2*0+1*1*3*r*0+1*s*8*a*0+1","work-report-done-summary-hint":"","work-report-insert-mention-hint":"XXXXmention@","work-report-progress-hint":" XXXX","work-report-next-summary-hint":"","meeting-record-main-text":"\n |  | \nXXXXXXXX\n\n\n\n\n\n","meeting-record-main-attribs":"*0*1*2+1*2+l*0*1*2+1*2+g*0*1*2+1*3*4*5*6*7*8*9*2*a+1*2*b+4*0*c*2*b+1*d*e*f*g*h*i*j*k+1*2*d*l+1*2*d*m+1*2*n*o*p+7*3*4*5*6*q*r*1*9*2*d*s*t*u*v*w*x*y*m+1*2*d*l+2*2*d*m+1*3*4*5*6*q*r*1*9*z*2*d*t*u*v*w*m+1*2*d*l+2*2*d*m+1*5*6*q*r*9*z*2*a*d*t*u*v*w*m+1*2*d*l+2*2*d*m+1*5*6*q*r*9*10*2*a*d*t*u*v*w*m+1*2*d*l+2*2*d*m+1*2*n*o*p+7*5*6*q*r*9*2*d*11*t*u*v*w*x*y*m+1*2*d*l+2*2*d*m+1*3*4*5*6*q*r*1*9*z*2*d*t*u*v*w*m+1*2*d*l+2*2*d*m+1*5*6*q*r*9*z*2*a*d*t*u*v*w*m+1*2*d*l+2*2*d*m+1*5*6*q*r*9*10*2*a*d*t*u*v*w*m+1*2*d*l+1*d*e*f*g*h*i*j*k+1*3*4*5*6*7*8*9*2*a+1*2*b+4*0*c*2*b+1*d*12*f*g*13*i*j*k+1*2*d*l+1*2*d*m+1*3*4*5*6*q*r*1*9*14*2*d*t*u*v*w*m+1*2*d*l+2*2*d*m+1*5*6*q*r*9*15*2*a*d*t*u*v*w*m+1*2*d*l+2*2*d*m+1*5*6*q*r*9*10*2*a*d*t*u*v*w*m+1*2*d*l+1*d*12*f*g*13*i*j*k+1*3*4*5*6*7*8*9*2+1","meeting-record-insert-mention-hint":"mention@","meeting-record-conclusion-hint-1":"..., mention@","meeting-record-conclusion-hint-2":"..., mention@","menu-insert-snippet":"","menu-task-list":"","menu-work-daily":"","menu-work-report":"","menu-conference-record":"","description-task-list":"","description-work-daily":"","description-work-report":"","description-conference-record":""},spellcheck:{"menu-text":"","description-text":""},splitline:{"no-divider":""},table:{"merge-cell":""},title:{"forbidden-chars":'\\ / : * ?  " < > |',"forbidden-chars-pc":'  \\ / : * ? " < > |  ',"forbidden-chars-mobile":'  \\ / : * ? " < > |  ',"un-highlight-doc-name":"","highlight-doc-name":"","highlighted-by-creator":""},titlebar:{"insert-tips":"/"},"to-top":{"add-fast-access":"","cancel-fast-access":"",added:"",removed:"",limited:"",failed:""},translate:{auto:"",zh:"",en:"",ja:"",ko:"",fr:"",es:"",de:"","menu-text":"","description-text":""},ui:{"more-text":"","more-tooltip":"","no-color-text":"","custom-color-text":"","recent-colors-text":"","toolbar.style":"","unofficial-addons":"","toolbar-toggle":"",orientation:"//",confirm:"",loading:"","default-color":""},"update-notice":{"guide-to-pc":"{{snackbarText}}PC{{host}}"},wordcount:{"statusbar-count":"{{- wordcount}} ","statusbar-count_plural":"{{- wordcount}} ","statusbar-count-no-punctuation":"{{- wordcount}}  () ","statusbar-count-no-punctuation_plural":"{{- wordcount}}  () ","statusbar-characters":"{{- wordcount}} ","statusbar-characters_plural":"{{- wordcount}} ","statusbar-characters-no-spaces":"{{- wordcount}}  ()","statusbar-characters-no-spaces_plural":"{{- wordcount}}  ()","statusbar-text_plural":"{{- wordcount}} ","count-no-punctuation":" () ",count:"","count-characters":"","count-characters-no-punctuation":" () ","count-info":"","word-count":"","count-characters-no-spaces":" ()"},"wrap-text":{"wrap-text":"","image-wrapping-style":"","in-line-with-text":"",square:"","table-square":"","top-and-bottom":"","behind-text":"","in-front-of-text":"","move-object-with-text":"","lock-anchor":""}},"zh-HK":{accessibility:{welcome:"{{productName}} control  ~ ","modal-text":"{{onOkContent}} control  ~ "},"add-fast-access":{"add-fast-access":"","cancel-fast-access":"",added:"",removed:"",limited:"",failed:""},"add-to-wedrive":{"add-to-wedrive":"","view-in-wedrive":"",wedrive:"",added:"","add-to-directories":"",directory:"","add-wedrive-shortcut":"...","move-to-wedrive":"..."},addon:{addons:"","unofficial-plugins":"","plugin-activated":"","third-party-plugins":"","manage-addons":"","get-addons":"","go-to-computer-client-or-browser":"","recommend-addon":"","installed-addon":"","no-use-addon":"","same-addon":"","flow-chart":"","permission-denied-tips":""},"app-guide":{"brand-text":" /  / "},attachment:{doc:"",file:"","wedrive-file":"","local-file":"","select-wedrive":"","select-online":"","select-search-file":"","select-search-doc":"","search-result":"","delete-attachemnt":"","download-attachemnt":"","switch-mode":"","description-text":"","over-wedrive-capacity":""},audio:{encoding:"..."},card:{"calendar-event":"","select-from-list":"","new-calendar-event":"","change-layout":"",card:"","chat-history":"","group-business-card":"","untitled-group-chat":"","personal-business-card":"","add-personal-business-card-notification-message":"{{user}}{{document}}","event-deleted":"","group-chat-history":"{{group}}","join-group":"",app:"",weapp:"","meeting-event":"","select-meeting-from-list":"","new-meeting-event":""},color:{"font-color":""},comment:{"sync-to-group":": ",comments:"","archive-comments":"",like:"","empty-range-tip":"","empty-ent-range-tip":"","audit-add-fail":"","audit-edit-fail":"","":""},"core-edit":{"error-code-with-date":":{{errCode}}  {{date}}","no-clipboard-permission":"","no-copy-permission":"","use-shortcut-key-without-permission":" {{ctrl}}+V ","right-click-paste-instructions":"",copying:"","image-compress":"","image-unable-copy":""},data:{recovering:""},"doc-link":{"failed-to-load-preview-image":"",retry:"",loading:"","file-has-been-deleted":"","open-in-new-window":"","no-viewing-permission":""},"e-signature":{"click-to-sign":"","e-signature-message-without-contract":"","e-signature-message-full":"","e-signature-message-left":"","e-signature-message-middle":"","e-signature-message-right":""},"edit-tips":{"touch-tips":"",edit:"","security-risk":""},"field-code":{"fixed-read-addon-iframe":"[]","fixed-read-sheet-iframe":"[]"},field:{"cancel-link":"",delete:"",refresh:"","full-screen":"","display-mode":"","modify-link":"","copy-link":"","open-link":"","jump-to-source-page":"",preview:"",card:"","icon-text-link":"+","text-link":"","demo-insert":"DEMO"},"fieldcode-page":{menu:"/"},"file-base":{"clone-title":"-{{- title}}","import-empty-error":"","import-exts-error":" {{exts}} ","import-size-error":"{{fileSizeLimit}}MB",cloning:"...","cloning-patient":"","delete-doc-tips":"","delete-doc":"",delete:"",deleting:"...","delete-success":"","delete-fail":"","import-doc-success-tip":"",view:"",confused:""},"file-export":{"local-docx":"Word(.docx)",export:"","export-failed":"","export-failed-tips":"","":"","":"","":"","":"","":"","export-hina-fail":"","":""},"file-mobile":{creator:": {{creator}}",version:": {{- version}}","save-as-template":"","log-report":"","text-history":"","help-and-feedback":""},"file-pc":{privacy:"","privacy-policy":"","third-information-checklist":"","third-authorization-management":"","personal-information-checklist":""},font:{"change-size":"/"},fonts:{"cannot-clone":"","buy-vip-to-clone":"","buy-vip":""},image:{"mask-tips":"Width: {{width}} &nbsp;&nbsp;Height: {{height}}","camera-fail":"","camera-no-permission":"","restore-image":"",restore:"","extract-text":""},"keymap-list":{editing:"","insert-page-break":"","insert-ordered-list":"","insert-unordered-list":"","increase-font-size":"","decrease-font-size":"",navigation:"",view:"",selection:"","move-left-char":"","move-right-char":"","move-up":"","move-down":"","move-left-word":"","move-right-word":"","move-to-line-start":"","move-to-line-end":"","move-to-prev-page":"","move-to-next-page":"","table-horizon-scroll":"","horizon-scroll":"","select-left-char":"","select-right-char":"","select-up":"","select-down":"","select-to-line-start":"","select-to-line-end":"","select-to-left-word":"","select-to-right-word":"","select-to-para-start":"","select-to-para-end":"","markdown-h1":"","markdown-h2":"","markdown-h3":"","markdown-h4":"","markdown-h5":"","markdown-h6":"","insert-code-block":"","insert-todo":"","insert-todo-done":"","insert-splitline":"","insert-quote":"","insert-highlight-block":"",text:"","insert-bold":"","insert-italic":"","insert-underline":"","insert-strike-through":"",zoom:"/","zoom-restore":"100%","open-keymap-list":"/",wheel:"",space:"","paragraph-style":"","text-style":"","apply-normal-style":'""',"apply-h1-style":'" 1"',"apply-h2-style":'" 2"',"apply-h3-style":'" 3"',"apply-h4-style":'" 4"',"apply-h5-style":'" 5"',"apply-h6-style":'" 6"',"apply-big-title-style":'""',"apply-little-title-style":'""',"add-comment":"","show-comments":"","add-ent-comment":"","show-ent-comments":""},legacy:{"":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""," {{page}}  -  {{pageCount}} ":" {{page}}  /  {{pageCount}} ","":"","()":"()","()":"()","()":"()","slash ":"/ ","Excel":"Excel","LaTeX":"LaTeX","":"","":"","LaTeX":"LaTeX","":"","MMdd":"MMdd","PDF":"PDF","":"","":"","PPT":"PPT","TXT":"TXT","V ":"V ","Word":"Word","X ":"X ","XXXXXXXX":"XXXXXXXX","```+":"``` ","ie10M":"ie10M","yyyyMM":"yyyyMM","yyyyMMdd":"yyyyMMdd","{{diffDays}}":"{{diffDays}}","{{diffHours}}":"{{diffHours}}","{{diffMinutes}}":"{{diffMinutes}}","{{rows}}X{{columns}} ":"{{rows}}X{{columns}} ","{{shortcutCtrl}}+0  100%":"{{shortcutCtrl}} 0  100%","{{snackbarText}}{{nickname}}":"{{snackbarText}}{{nickname}}","{{snackbarText}}{{count}}":"{{snackbarText}}{{count}}","{{time}} ":"{{time}} ","{{title}} - ":"{{title}} - ","{{value}}":"{{value}}","{{versionContent}}":"{{versionContent}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{boundValue}}cm":"{{boundValue}}cm","{{insertRowCount}}":"{{insertRowCount}}","":"","{{modifiedBy}}{{updateTime}}":"{{modifiedBy}}{{updateTime}}","":"","":"","":"","{{insertRowCount}}":"{{insertRowCount}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{name}}":"{{name}}","":"","":"","":"","Chrome":"Chrome","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""," {{ctrl}}+V ":" {{ctrl}} V "," {{time}}":" {{time}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","\\n":"\\n","":"","":"","{{currentPrivilege}}":"{{currentPrivilege}}","":"","":"","":"","":"","":"","":", ","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""," {{allWordCount}} ":" {{allWordCount}} ","{{count}}":"{{count}}","":"","":"","":"","":"","":"","":"...","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""," {{timestr}}":" {{timestr}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":": {{ver}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{position}}":"{{position}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"{{user}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{insertColCount}}":"{{insertColCount}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","+":" ","":"","":"","":"","":"","":"","":"","":"","":"","Cmd+V":"Cmd V","Ctrl+V":"Ctrl V","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","Chrome":"Chrome","":"","":"","Ctrl+C":"Ctrl C","cmd+C":"cmd C","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","Word":"Word","Word":"Word","Worddocx":"Word.docx","Word":"Word","PDF":"PDF","PDF":"PDF","":"","":"","":"","docx":".docx","docx":".docx","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{action}}":"{{action}}","":"","":"","":"","":"","":"","":"","":"","{{boundValue}}cm":"{{boundValue}}cm","":"","{{insertColCount}}":"{{insertColCount}}","":"WeChat","":"","":"","":"","":"","":"","":"","":"","":"","{{foldCount}}":"{{foldCount}}","{{foldCount}}":"{{foldCount}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"WeChat","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","SafariSafari":"SafariSafari","":"","":"","":"","":"","@":"@","":"","":"","":"","":"","":"","":"","":"","":"","":"",", ":", ","":"","":"","":"","1000":"1000","1000":"1000","":"","":"","{{pageCount}}":"{{pageCount}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{op}}":"{{op}}","1000":"1000","1000":"1000","":"","":"","":"","{{op}}":"{{op}}","1000":"1000","1000":"1000","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","100KB":"100KB","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",", ":", ","":"","":"","{{LENGTH}}":"{{LENGTH}}"," ":" ","":"","":"","":"","":"","":"","":"","":"","":"","{{op}}":"{{op}}","{{op}}":"{{op}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","EnterEsc":"EnterEsc","EnterEsc":"EnterEsc","":"","":"","":"","":"","":"","":"","":"","":"","2":"2","3":"3","4":"4","5":"5","":"","":"","":"","":"","":"","{count}":"{count}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","300%":"300%","{{num}}":"{{num}}","{{num}}":"{{num}}","100%":"100%","":"","":"","":"","{{minValue}}{{maxValue}}":"{{minValue}}{{maxValue}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""," 1":" 1"," 2":" 2"," 3":" 3"," 4":" 4"," 5":" 5"," 6":" 6","":"","":"","":"","":"","":"","Chrome":"Chrome","Markdown":"Markdown","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","?":"?","":"","":"","":"","":"","":"",", ":", ","":"","":"","":"","\\u00A0":"\\u00A0","\\u00A0\\u00A0":"\\u00A0\\u00A0","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","2":"2","3":"3","":"","":"","":"","":"","":"","":"","":"","@":"@","":"","@":"@","@":"@","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""," (.png)":" (.png)","":"","":"","":"","":"","":"","":"","24":"24","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","?":"?","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{pageResult}}":"{{pageResult}}","{{version}}":"{{version}}","":"","":"","":"","{{count}}":"{{count}}","{{count}}":"{{count}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{scale}}%":"{{scale}}%","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","-":"-","":"","":"","":"","":"","":"","":"","snapshot":"snapshot","":"","":"","":"","{{rowsCount}}":"{{rowsCount}}","{{colsCount}}":"{{colsCount}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{num}}":"{{num}}","":"","":"","":"","":"","":"","20M":"20M","":"","":"","":"","":"","":"","PDF":"PDF","":"...","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","(Esc)":"(Esc)","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","10":"10","":"","":"","":"","":"","":"","":"","":""," 0 ":" 0 "," 1 ":" 1 ","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{text}}":"{{text}}","":"","QQ":"QQ","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",Markdown:"Markdown","":"","":"","":"","":"","@":"@","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""," 5 ":"5"," 15 ":"15"," 1 ":"1"," 1 ":"1","@":"@","":"","":"","":"","@":"@","@":"@","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""," {{count}} ":" {{count}} "," {{count}} ":" {{count}} ","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{peoples}}{{count}}":"{{peoples}}{{count}}","{{count}}":"{{count}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""," {{members}} ":" {{members}}"," {{members}}, ?":" {{members}}, ?","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":".","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{content}}":"{{content}}","":""," {{sectIdx}} ":" {{sectIdx}} ","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{position}}{{position}}":"{{position}}{{position}}","{{position}}":"{{position}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""," {{maxSelectMemberCount}} ":" {{maxSelectMemberCount}} ","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","...":"...","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","PDF":"PDF","PDFWord":"PDFWord","PDFExcel":"PDFExcel","PDFPPT":"PDFPPT","PDF":"PDF","":"","":""},like:{"setting-failed":"","setting-success":"","enable-like":"","disable-like":"","toggle-like":""},"local-edit":{retry:"","enter-password":"","enter-file-password":"","password-is-required":"","incorrect-password":"","use-now":"","need-upload-content":"","please-connect-network":"","open-error-unknown":"","open-error-busy":"","open-error-not-entity":"","open-error-permittion":"","open-error-converter-install":"","save-error-unknown":"","save-error-busy":"","save-error-not-entity":"","save-error-permittion":"","save-error-converter-install":"","import-unknown-docs":"","save-path-not-exit":"","cannot-open":"","cannot-save":"","show-item-in-folder":"","view-origin-file":"","compatibility-issues":"",check:"","need-login":"","error-tips":" ({{code}})",save:"","transfer-to-multi":"","upload-to-drive":"","share-local-file":"","mobile-password-error":"","image-upload-error":"","image-download-error":"","file-read-error":"","not-implemented":"","export-file-error":"","export-cancel":"","open-fail":"",readonly:""},markdown:{"description-text":" Markdown "},mention:{"doc-members":"","from-contacts":"","no-contacts-found":"",mention:"","mention-n-persons":"{{count}}","select-doc-member":""},outline:{cube:""},"page-shade":{"page-background":"/",shading:""},"paged-view":{edit:"",name:""},paste:{"paste-toast-prefix":""},personalize:{settings:"",background:"","settings-description":""},presentation:{"waiting-persons":"{{remoteMemberCount}}","waiting-persons_plural":"{{remoteMemberCount}}","local-presentation":"","present-with-tencent-meeting":"","remote-presentation":"","tencent-meeting-tooltip-title":"","tencent-meeting-tooltip-desc":""},print:{"permission-not-allow":"","miniprogram-not-allow":"","print-service-error":""},publish:{scan:"WeChat / QQ"},report:{"":"","":"","":"","":"","":"","{{name}}":"{{name}}","{{name}}":"{{name}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":" ","":""},resume:{sidebar:{title:"",content:"",desc:["",""],button:"",cancel:"",loading:""},"cancel-dialog":{title:"",content:""},toast:{"import-file-oversize":"","import-failed":"","cancel-reminder":"-","action-more":""},menu:{title:"",description:""},mobile:{message:"",action:""}},revision:{too_many_online_visit:""},search:{"prompt-replace-all":"{{searchCount}}{{searchTarget}}{{value}}","prompt-clear-all":"{{searchCount}}{{searchTarget}}"},share:{"policy-limited":"/","policy-private":"/","editable-persons":"{{count}}: ","policy-read":"","policy-edit":"","editable-persons_plural":"{{count}}:","can-only-view":"","only-supported-app":"APP","go-now":""},"snap-screen":{"file-name":"{{productName}}.png",payment:"/APP"},snippet:{"work-daily-main-text":"\n\n\n\n\n\n\n\n\n\n\n","work-daily-main-attribs":"*0*1*2*3*4*5*6*7*8+1*9*a*b*c*d*e*f+1*7*9*g+1*7*9*h+1*7*i*j*k+4*l*2*3*m*n*7*o*9*p*q*r*s*t*h+1*7*9*h+1*7*i*j*k+4*l*2*3*m*n*7*o*9*p*q*r*s*t*h+1*7*9*g+2*7*9*h+1*0*2*3*u*v*7*o+1*2*3*w*u*x*v*y*7*z+1*2*3*w*u*x*v*10*7*z+1*0*2*3*u*v*7*z*9*q*r*s*t*h+1*7*9*h+1*11*2*3*12*u*v*7*o*9+1*2*3*12*13*u*14*v*y*7*o*9+1*2*3*12*13*u*14*v*10*7*o*9+1*11*2*3*12*u*v*7*o*9*q*r*s*t*h+1*7*9*g+2*7*9*h+1*7*i*j*15+4*l*2*3*m*n*7*15*9*16*q*r*s*t*17*18*h+1*7*9*h+1*2*3*7*o*9*16*q*r*s*t*19*1a*h+1*7*9*g+2*7*9*h+1*2*3*1b*7*o+1*2*3*7*o+2*2*3*7*o*9*q*r*s*t*17*18*h+1*7*9*h+1*2*3*7*o*9*q*r*s*t*19*1a*h+1*7*9*g+1*9*a*b*c*d*e*f+1*11*u*v*7+1","task-main-text":"\n\n\n\n\n\n\n\n\n\n\n","meeting-record-main-text":"\n |  | \nXXXXXXXX\n\n\n\n\n\n","meeting-record-main-attribs":"*0*1*2+1*2+l*0*1*2+1*2+g*0*1*2+1*3*4*5*6*7*8*9*2*a+1*2*b+4*0*c*2*b+1*d*e*f*g*h*i*j*k+1*2*d*l+1*2*d*m+1*2*n*o*p+7*3*4*5*6*q*r*1*9*2*d*s*t*u*v*w*x*y*m+1*2*d*l+2*2*d*m+1*3*4*5*6*q*r*1*9*z*2*d*t*u*v*w*m+1*2*d*l+2*2*d*m+1*5*6*q*r*9*z*2*a*d*t*u*v*w*m+1*2*d*l+2*2*d*m+1*5*6*q*r*9*10*2*a*d*t*u*v*w*m+1*2*d*l+2*2*d*m+1*2*n*o*p+7*5*6*q*r*9*2*d*11*t*u*v*w*x*y*m+1*2*d*l+2*2*d*m+1*3*4*5*6*q*r*1*9*z*2*d*t*u*v*w*m+1*2*d*l+2*2*d*m+1*5*6*q*r*9*z*2*a*d*t*u*v*w*m+1*2*d*l+2*2*d*m+1*5*6*q*r*9*10*2*a*d*t*u*v*w*m+1*2*d*l+1*d*e*f*g*h*i*j*k+1*3*4*5*6*7*8*9*2*a+1*2*b+4*0*c*2*b+1*d*12*f*g*13*i*j*k+1*2*d*l+1*2*d*m+1*3*4*5*6*q*r*1*9*14*2*d*t*u*v*w*m+1*2*d*l+2*2*d*m+1*5*6*q*r*9*15*2*a*d*t*u*v*w*m+1*2*d*l+2*2*d*m+1*5*6*q*r*9*10*2*a*d*t*u*v*w*m+1*2*d*l+1*d*12*f*g*13*i*j*k+1*3*4*5*6*7*8*9*2+1","work-report-main-text":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","work-report-main-attribs":"*0+7*1*2*0+1*3*4*0+1*3*0+1*0*5+5*1*6*7*8*9*a*0*5+1*1*3*b*8*c*a*d*0+1*1*3*b*8*c*a*e*0+1*1*3*b*8*c*a*f*0+1*g*h*i*j*k*l*m*0*n+1*0*5+5*1*6*7*8*9*a*0*5+1*1*3*o*8*p*a*q*0+2*1*3*o*8*p*a*f*0+1*g*h*i*j*k*l*m*0*n+1*1*6*7*8*9*a*f*0*5+1*g*h*i*j*k*l*m*0*n+2*0+6*1*2*0+1*1*3*r*0+1*s*8*a*0+1","meeting-record-insert-mention-hint":"mention@","work-daily-insert-doc-hint":"doc","work-daily-summary-hint":"","work-report-next-summary-hint":"","task-insert-doc-hint":"doc","work-report-progress-hint":" XXXX","work-report-insert-mention-hint":"XXXXmention@","work-report-done-summary-hint":"","meeting-record-conclusion-hint-1":", mention@","meeting-record-conclusion-hint-2":", mention@","task-insert-mention-hint":"mention@","work-daily-insert-mention-hint":"mention@","task-main-attribs":"*0*1*2*3+1*3*4+3*5*6*7*1*8*2*3*4+1*9*a*1*b*2*c*3+1*9*a*1*b*2*d*3+1*9*a*1*b*2*e*3+1*9*2*3+1*3*4+3*5*6*7*1*8*2*3*4+1*9*a*1*b*2*c*3+1*9*a*1*b*2*d*3+1*9*a*1*b*2*e*3+1*9*2*3+1","menu-insert-snippet":"","menu-task-list":"","menu-work-daily":"","menu-work-report":"","menu-conference-record":"","description-task-list":"","description-work-daily":"","description-work-report":"","description-conference-record":""},spellcheck:{"menu-text":"","description-text":""},splitline:{"no-divider":""},table:{"merge-cell":""},title:{"forbidden-chars":'\\ / : * ? " < > |',"forbidden-chars-mobile":'  \\ / : * ? " < > | ',"forbidden-chars-pc":'  \\ / : * ? " < > |  ',"un-highlight-doc-name":"","highlight-doc-name":"","highlighted-by-creator":""},titlebar:{"insert-tips":"/"},"to-top":{"add-fast-access":"","cancel-fast-access":"",added:"",removed:"",limited:"",failed:""},translate:{auto:"",zh:"",en:"",ja:"",ko:"",fr:"",es:"",de:"","menu-text":"","description-text":""},ui:{"more-text":"","more-tooltip":"","no-color-text":"","custom-color-text":"","recent-colors-text":"","toolbar.style":"","unofficial-addons":"","toolbar-toggle":"",orientation:"//",loading:"","default-color":""},"update-notice":{"guide-to-pc":"{{snackbarText}}PC{{host}}"},wordcount:{"statusbar-count":"{{- wordcount}} ","statusbar-count_plural":"{{- wordcount}} ","statusbar-count-no-punctuation":"{{- wordcount}} ()","statusbar-count-no-punctuation_plural":"{{- wordcount}} ()","statusbar-characters":"{{- wordcount}} ","statusbar-characters_plural":"{{- wordcount}} ","statusbar-characters-no-spaces":"{{- wordcount}}  ()","statusbar-characters-no-spaces_plural":"{{- wordcount}}  ()","statusbar-text_plural":"{{- wordcount}} ",count:"","count-characters":"","count-no-punctuation":" () ","count-characters-no-punctuation":" () ","count-info":"","count-characters-no-spaces":" ()","word-count":""},"wrap-text":{"wrap-text":"","image-wrapping-style":"","in-line-with-text":"",square:"","table-square":"","top-and-bottom":"","behind-text":"","in-front-of-text":"","move-object-with-text":"","lock-anchor":""}}}},60952:function(e,t,n){n.d(t,{ud:function(){return l},wA:function(){return o}});var r,o,i=n(85556),a=n(30479),s=n(73557);!function(e){e[e.Presentation=0]="Presentation",e[e.ImageViewPc=1]="ImageViewPc",e[e.EntPreviewPc=2]="EntPreviewPc",e[e.ImageViewMobile=3]="ImageViewMobile",e[e.EntPreviewViewMobile=4]="EntPreviewViewMobile",e[e.PrismLib=5]="PrismLib",e[e.highlightLib=6]="highlightLib",e[e.ExportPDFLib=7]="ExportPDFLib",e[e.DocsConfigLib=8]="DocsConfigLib",e[e.PcFileSelectorLib=9]="PcFileSelectorLib",e[e.MobileFileSelectorLib=10]="MobileFileSelectorLib",e[e.Wemeet=11]="Wemeet",e[e.VoiceInputPanel=12]="VoiceInputPanel",e[e.LameJs=13]="LameJs",e[e.TranslateLanguageBar=14]="TranslateLanguageBar",e[e.TranslateAdapter=15]="TranslateAdapter",e[e.LinkTips=16]="LinkTips",e[e.SearchDialog=17]="SearchDialog",e[e.SearchDialogMobile=18]="SearchDialogMobile",e[e.UploaderLogicBeta=19]="UploaderLogicBeta",e[e.MeetingRemoteReplayButton=20]="MeetingRemoteReplayButton",e[e.MobileMenuMoveFile=21]="MobileMenuMoveFile",e[e.SaveTemplate=22]="SaveTemplate",e[e.FontList=23]="FontList",e[e.Watermark=24]="Watermark",e[e.FollowUpPanel=25]="FollowUpPanel"}(o||(o={}));var c=((r={})[o.EntPreviewPc]=function(){return n.e(2765).then(n.bind(n,92714))},r[o.PrismLib]=function(){return n.e(6128).then(n.t.bind(n,31637,23))},r[o.highlightLib]=function(){return n.e(9605).then(n.bind(n,62666))},r[o.ExportPDFLib]=function(){return n.e(9343).then(n.t.bind(n,67713,23))},r[o.DocsConfigLib]=function(){return Promise.resolve().then(n.bind(n,5593))},r[o.Wemeet]=function(){return n.e(3790).then(n.t.bind(n,29991,23))},r[o.UploaderLogicBeta]=function(){return n.e(2424).then(n.t.bind(n,75164,23))},r[o.SaveTemplate]=function(){return n.e(5236).then(n.t.bind(n,46143,23))},r[o.FontList]=function(){return Promise.all([n.e(6580),n.e(9451)]).then(n.t.bind(n,16580,23))},r[o.Watermark]=function(){return n.e(5203).then(n.t.bind(n,25106,23))},r[o.FollowUpPanel]=function(){return n.e(8075).then(n.t.bind(n,14594,23))},r[o.Presentation]=function(){return Promise.all([n.e(8382),n.e(3790),n.e(98),n.e(5218),n.e(8624),n.e(9702),n.e(9539),n.e(7849)]).then(n.bind(n,75457))},r[o.ImageViewPc]=function(){return n.e(5249).then(n.bind(n,99167))},r[o.TranslateLanguageBar]=function(){return n.e(8948).then(n.bind(n,68547))},r[o.TranslateAdapter]=function(){return Promise.all([n.e(8382),n.e(98),n.e(5218),n.e(8624),n.e(2359)]).then(n.bind(n,85626))},r[o.SearchDialog]=function(){return n.e(7960).then(n.bind(n,5085))},r[o.PcFileSelectorLib]=function(){return n.e(9797).then(n.t.bind(n,8779,23))},r),l=function(){function e(){}return e.importAll=function(e,t){var n=this;return void 0===t&&(t={}),new Promise((function(r,o){Promise.all(e.map((function(e){return e()}))).then((function(e){var t=e.reduce((function(e,t){return(0,i.__assign)((0,i.__assign)({},e),t)}));r(t)}),(function(i){var c=t.name||"";setTimeout((function(){if(t.retryOnline&&!s.network.isOnline){a.Logger.info("DynamicImport| Module ".concat(c," load paused, retry after online."));var l=function(){s.network.isOnline&&(a.Logger.info("DynamicImport| Module ".concat(c," load resume.")),n.importAll(e,{log:t.log}).then(r,o)),s.network.remove(l)};s.network.changeEnd(l)}else t.log&&a.Logger.error("DynamicImport| Module ".concat(c," load failed")),o(i)}),100)}))}))},e.get=function(e,t){void 0===t&&(t={});var n=c[e];if(!n)throw new Error("DynamicImport|Module ".concat(o[e]," not exist"));return this.importAll([n],(0,i.__assign)((0,i.__assign)({},t),{name:o[e],log:!0}))},e.getAll=function(e,t){void 0===t&&(t={});var n=e.map((function(e){var t=c[e];if(!t)throw new Error("DynamicImport|Module ".concat(o[e]," load failed"));return t}));return this.importAll(n,(0,i.__assign)((0,i.__assign)({},t),{name:e.map((function(e){return o[e]})).join(", "),log:!0}))},e}()},44166:function(e,t,n){var r,o,i;n.d(t,{DL:function(){return r},Yi:function(){return s},dw:function(){return o},iJ:function(){return a}}),function(e){e.NEW="new",e.LOCAL="local",e.DELETED="deleted",e.NORMAL="normal"}(r||(r={})),function(e){e.FROM_LOCAL="from-local",e.FROM_SERVER="from-server",e.FROM_LOCAL_EDIT="from-local-edit"}(o||(o={})),function(e){e[e.SRC_TYPE_NORMAL=0]="SRC_TYPE_NORMAL",e[e.SRC_TYPE_IMPORT=1]="SRC_TYPE_IMPORT",e[e.SRC_TYPE_TERM_PREVIRW=2]="SRC_TYPE_TERM_PREVIRW",e[e.SRC_TYPE_PC_PREVIRW=3]="SRC_TYPE_PC_PREVIRW",e[e.SRC_TYPE_OCR=4]="SRC_TYPE_OCR",e[e.SRC_TYPE_COPY=5]="SRC_TYPE_COPY",e[e.SRC_TYPE_OFFICIAL_TEMPLATE=6]="SRC_TYPE_OFFICIAL_TEMPLATE",e[e.SRC_TYPE_USER_TEMPLATE=7]="SRC_TYPE_USER_TEMPLATE",e[e.SRC_TYPE_OFFLINE=8]="SRC_TYPE_OFFLINE",e[e.SRC_TYPE_TRANSLATE=9]="SRC_TYPE_TRANSLATE"}(i||(i={}));var a={accountPrivs:{},advPolicy:{},cdn:"",clientIp:"",collab_client_vars:{apid:{},apool:{numToAttrib:{},nextNum:1},bad:-1,client:{sid:"",upid:"",sig:"",tid:-1},dirty:-1,dver:"2.0.0",globalPadId:"",gray:-1,header:[],isChunked:!1,initialAttributedText:{text:"",attribs:""},padId:"",padSubId:"",padType:"",pollingAttemptNumber:-1,pos:-1,pver:-1,rev:-1,ver:-1,websocket:!1,websocketReopenCount:-1,wmode:""},colorPalette:[],creatorDomain:"",creatorId:"",disableFB:!1,docStatus:-1,domainId:"",dropboxConnected:!1,encrypted:"",envi:null,friendUserIds:[],globalPadId:"",initialOptions:{},initialRevisionList:[],initialTitle:"",invitedGroupInfos:[],invitedUserInfos:[],isCreator:!0,isDesktopApp:!1,isEmbed:!1,isIPad:!1,isIPhone:!1,isLogin:!1,isMac:!1,isMobile:!1,isMobileApp:!1,isNewProject:!1,isOpendocxfromTim:!1,isOverConNum:!1,isOverUpdateConNum:!1,isOwner:!1,isPadAdmin:!1,isProPad:!1,isPublicPad:!1,isTIM:!1,isTimDomain:!1,isTimOnline:!1,isUserChangeTitle:-1,localPadId:"",newOpenSvc:-1,ownerAppid:"",ownerId:"",originalUrl:"",padId:"",pub:-1,padStatus:r.NORMAL,padTitle:"",padType:"",pagingFlag:"",personalizeInfo:{background:{id:"",transparency:0},mode:0},policy:-1,privilegeAttribute:{can_about:0,can_add_user:0,can_apply_edit:1,can_comment:0,can_copy:0,can_copy_doc:0,can_edit:0,can_edit_title:0,can_history:0,can_link_exp:0,can_print:0,can_read:1,can_search:0,can_share:0,can_spit_slot:0,can_translate:0,can_view_image:0,can_watermark:0,is_auth:0},privilegeExpire:-1,proTitle:"",rightFlag:-1,shortLink:"",shouldGetFbLoginStatus:!1,siteName:"",title:"",titleIsReadOnly:!1,uin:"",useFbChat:!1,userColor:-1,userDomain:"",userId:"",userInfo:{},userIsGuest:!1,userLink:"",userName:"",userPic:"",userType:"",xsrf:"",metaCreateTime:15489504e5,lastModifyTime:15489504e5,lastModifyUser:"",ownerVipInfo:{vip_level:1}};function s(){return window.clientVars?window.clientVars:a}},54472:function(e,t,n){n.d(t,{x:function(){return r}});var r=new(function(){function e(){this.needInitOffline=!0,this.needInitCollabCenter=!0}return e.prototype.getIsNeedInitOffline=function(){return this.needInitOffline},e.prototype.setNeedInitOffline=function(e){this.needInitOffline=e},e.prototype.getIsNeedInitCollabCenter=function(){return this.needInitCollabCenter},e.prototype.setNeedInitCollabCenter=function(e){this.needInitCollabCenter=e},e}())},24689:function(e,t,n){n.d(t,{K:function(){return r},u:function(){return a}});var r,o=n(87418),i=n(44166);!function(e){e[e.none=0]="none",e[e.category=1]="category",e[e.iframe=2]="iframe"}(r||(r={}));var a=function(){function e(e){this.secretId=e,this.quickLookShowTime=0,this.quickLookType=o.Ag.DEFAULT,this.replaceUrlTime=0,this.docRendered=!1,this.docRenderFailed=!1}return e.getInstance=function(t){var n=e.instanceMap.get(t);return n||(n=new e(t),e.instanceMap.set(t,n)),n},Object.defineProperty(e.prototype,"containerEnv",{get:function(){var e;try{if(null===(e=window.top)||void 0===e?void 0:e.globalBoxEnv)return r.iframe;if(this.replaceUrlTime>0)return r.category}catch(e){return r.none}return r.none},enumerable:!1,configurable:!0}),e.prototype.setClientVars=function(e){this.clientVars=e},e.prototype.getClientVars=function(){return this.clientVars||i.iJ},e.prototype.onDestroy=function(){e.instanceMap.delete(this.secretId)},e.instanceMap=new Map,e.replaceCount=0,e}()},47307:function(e,t,n){n.d(t,{U:function(){return o}});var r=n(85556),o=function(e){var t="";try{t=(0,r.__read)(e.split("."),1)[0]}catch(e){return!1}return!!(t&&Number(t)<3)}},39445:function(e,t,n){function r(e,t){void 0===t&&(t="");var n=window.location.search,r=t||n,o=new RegExp("(^|&)".concat(e,"=([^&]*)(&|$)"),"i"),i=r.substr(1).match(o);return null!==i?unescape(i[2]):null}function o(){var e=r("docid")||window.location.pathname.split("/").pop();return e||(e=""),e}function i(e){var t=new URL(e);return r("docid",t.search)||t.pathname.split("/").pop()||""}function a(e){var t=o();return function(e){return requestAnimationFrame((function(){requestAnimationFrame(e)}))}((function(n){t===o()&&e(n)}))}n.d(t,{Zh:function(){return i},hM:function(){return a},pb:function(){return o}})},12036:function(e,t,n){n.d(t,{M:function(){return r}});var r=new(function(){function e(){}return e.prototype.getUrlParameter=function(e,t){var n,r,o,i=t||window.location.search.substring(1);if(i)for(n=i.split("&"),r=0;r<n.length;r++)if((o=n[r].split("="))[0]===e)return o[1];return null},e.prototype.getUidParam=function(e){var t=this.getUrlParameter("uid"),n=this.getUrlParameter("uid_key"),r=t?"uid=".concat(t,"&uid_key=").concat(n):"";return r?e.indexOf("?")>=0?"".concat(e,"&").concat(r):"".concat(e,"?").concat(r):e},e.prototype.getEnvironmentId=function(){if(void 0!==this._environmentId)return this._environmentId;var e="";if(document.cookie){var t=document.cookie.match(/\bdev_route_id\b=(\d+)\b/i);t&&(e=t[1])}return this._environmentId=e,e},e.prototype.getFd=function(){if(void 0!==this._fd)return this._fd;var e="";if(document.cookie){var t=document.cookie.match(/\bfd\b=([A-z_\\-]+)\b/i);t&&(e=t[1])}return this._fd=e,e},e.prototype.getRoomRouteIp=function(){if(void 0!==this._roomRouteIp)return this._roomRouteIp;var e="";if(document.cookie){var t=document.cookie.match(/\broomrouteip\b=([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}:\d+:[0-9A-z]+)\b/i);t&&(e=t[1])}return this._roomRouteIp=e,e},e.prototype.getEnvName=function(){if(void 0!==this._envName)return this._envName;var e="";if(document.cookie){var t=document.cookie.match(/\benv_name\b=([A-z_\\-]+)\b/i);t&&(e=t[1])}return this._envName=e,e},e.prototype.isDevEvn=function(){if(void 0!==this._isDevEvn)return this._isDevEvn;var e=!1;return this.getEnvName()&&(e=!0),this._isDevEvn=e,e},e.prototype.isGrayEvn=function(){return window.__globalReleaseVersion&&window.__globalReleaseVersion.startsWith("gray")},e.prototype.getCookie=function(e){var t,n=new RegExp("(?:^|;+|\\s+)".concat(e,"=([^;]*)"));return window.document&&(t=window.document.cookie.match(n)),(t?t[1]:"")||null},e}())},51014:function(e,t,n){n.d(t,{Tf:function(){return s},Zg:function(){return r},ac:function(){return a}});var r,o=n(85556),i=n(30479);!function(e){e.ServerMessage="ServerMessage",e.PrivilegeChanged="PrivilegeChanged"}(r||(r={}));var a=function(e){function t(t){var n=e.call(this,r.ServerMessage)||this;return n.msg=t,n}return(0,o.__extends)(t,e),t}(i.Notification),s=function(e){function t(t,n){var o=e.call(this,r.PrivilegeChanged)||this;return o.privilege=t,o.diff=n,o}return(0,o.__extends)(t,e),t}(i.Notification)},54541:function(e,t,n){n.d(t,{iz:function(){return v},YV:function(){return p},Ev:function(){return r}});var r,o=n(85556),i=n(3139),a=n(81346),s=n(42035),c=n(87782),l=n(22595),u=new Map([[l.C.Attachment,100],[l.C.BasicFormat,90],[l.C.TextFrame,82],[l.C.Codeblock,81],[l.C.Hyperlink,50],[l.C.Font,35],[l.C.FormatPainter,91],[l.C.Image,93],[l.C.List,85],[l.C.Paragraph,84],[l.C.Presentation,1],[l.C.ReadonlyTips,77],[l.C.RepeatLast,101],[l.C.Search,43],[l.C.Section,44],[l.C.Splitline,96],[l.C.Table,62],[l.C.Title,49],[l.C.TitleDefaultAdd,63]].map((function(e){return[Symbol.for("feature:".concat(e[0])),e[1]]}))),d=n(30479);!function(e){e[e.Mobile=0]="Mobile",e[e.Pc=1]="Pc",e[e.Pad=2]="Pad"}(r||(r={}));var p,h="LIFECYCLE_STAGE_EVENT";!function(e){e.Level1="Level1",e.Level2="Level2",e.Level3="Level3",e.Level4="Level4",e.Publish="Publish"}(p||(p={}));var f=[r.Pc,r.Mobile,r.Pad],g={mobile:r.Mobile,pc:r.Pc,pad:r.Pad},v=function(){function e(){}var t;return e.On=function(t){var n=t.key,r=t.stages,o=t.platforms,i=void 0===o?f:o,a=t.load,s=void 0===a||a;if(s&&i.includes(e.platform)){var c=this.getPreferredStage(r);if(c)return e.createLoader(n,c,"boolean"!=typeof s?s:void 0)}},e.loadLifecycleFeature=function(e,t,n){this.eventEmitter.emit(h,{stage:e,platform:t,done:n})},e.mountLifecycleFeature=function(e){var t;return(0,o.__awaiter)(this,void 0,void 0,(function(){var n,r,s,l;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return n=null!==(t=this.featureLoaderMap.get(e))&&void 0!==t?t:[],[4,Promise.all(n.map((function(e){return e.loaded})))];case 1:return o.sent(),r=i.Am.get(a.U),s=n.map((function(e){return e.key})).sort((function(e,t){var n,r;return(null!==(n=u.get(e))&&void 0!==n?n:0)-(null!==(r=u.get(t))&&void 0!==r?r:0)})),l=s.map((function(e){return new Promise((function(t){var n=setTimeout((function(){return o(!0)}),2e3),o=function(o){var a;void 0===o&&(o=!1);try{clearTimeout(n);var s=i.Am.get(e);if(o&&d.Logger.info("[MountFeature] scheduler timeout, mount by timer: ".concat(o,",feature:").concat(null===(a=null==s?void 0:s.toString)||void 0===a?void 0:a.call(s))),!s)return void t();var c=i.ll.get(s);r.buildFeature(c)}catch(e){d.Logger.error(e)}t()};c.scheduler.scheduleTask(o,{priority:c.Priority.normal})}))})),[4,Promise.all(l)];case 2:return[2,o.sent()]}}))}))},e.getPreferredStage=function(t){return t.find((function(t){if(e.isPublish){if(t===p.Publish)return t}else if(t!==p.Publish)return t}))},e.createLoader=function(t,n,r){var i=this;return function(a){return(0,o.__awaiter)(i,void 0,void 0,(function(){var i,s=this;return(0,o.__generator)(this,(function(c){switch(c.label){case 0:return(i=r)?[4,r]:[3,2];case 1:i=!c.sent(),c.label=2;case 2:return i||this.eventEmitter.listen(h,(function(r){return(0,o.__awaiter)(s,void 0,void 0,(function(){var i,s,c;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return r.platform!==e.platform||r.stage!==n?[3,2]:(i=a(),(s=null!==(c=this.featureLoaderMap.get(n))&&void 0!==c?c:[]).push({key:t,loaded:i}),this.featureLoaderMap.set(n,s),[4,i]);case 1:o.sent(),Promise.all(s.map((function(e){return e.loaded}))).then(r.done),o.label=2;case 2:return[2]}}))}))})),[2]}}))}))}},e.platform=g[window.ejsEntry],e.isPublish=window.isPublishedURL,e.featureLoaderMap=new Map,(0,o.__decorate)([(0,i.tB)(),(0,o.__metadata)("design:type","function"==typeof(t=void 0!==s.v&&s.v)?t:Object)],e,"eventEmitter",void 0),e}()},14740:function(e,t,n){n.d(t,{$t:function(){return i}});var r=n(85556),o=n(915),i=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.ZP.t.apply(o.ZP,(0,r.__spreadArray)([],(0,r.__read)(e),!1))};window.$t=i},15857:function(e,t,n){n.d(t,{ap:function(){return r},qO:function(){return C}});var r,o=n(85556),i=n(2613),a=n(48295),s=n(44166),c=n(51014),l=n(52739),u=n(3139),d=n(22703),p=n(42035),h=n(27613),f=n(30479),g=n(147),v=n(14740),y=n(50263),m=n(82173),b=n(85464);!function(e){e.ON_PERMISSION_CHANGE="onPermissionChange"}(r||(r={}));var _=function(e){function t(t){var n=e.call(this,r.ON_PERMISSION_CHANGE)||this;return n.permissionCtrl=t,n}return(0,o.__extends)(t,e),t}(f.Notification),C=function(){function e(t){var n=t.privilegeAttribute,r=void 0===n?{}:n,u=t.isCreator,d=void 0!==u&&u,p=this;this.isPlayer=!1,this.docInfo={ownerName:"...",docType:0,createTime:0},this.disableEditSet=new Set,this.privilege=e.DEFAULT_PERMISSION,this.onPrivilegeUpdate=function(e){var t=e.privilege,n=e.diff;if(f.Logger.info("newPrivilege: ".concat(JSON.stringify(t),", diff: ").concat(JSON.stringify(n))),!(0,s.Yi)().isLogin){var r=["can_read","can_copy"];t=Object.keys(t).reduce((function(e,n){return r.includes(n)&&(e[n]=t[n]),e}),{}),n=n.filter((function(e){return r.includes(e)}))}if(0!==n.length){n.includes("can_comment")&&p.eventEmitter.emit("$onCommentPrivilegeChange",1===t.can_comment),p.setPrivilege(t);var i={action:(0,v.$t)(""),onClickAction:function(){window.multiAccountUtil.reload(!0)}},c=p.getDiffText(n),u=!p.canRead;if(u){c=(0,v.$t)("");var d=p.contextService.context.collabCenterAdapter;d&&d.disconnect("PERMISSION_CHANGED",m.p.CollabRoomShutDownNotOpen),g.F.getInstance().deleteCurrentSnapshotData()}p.snackbar&&p.snackbar.close(),p.snackbar=l.default.show((0,o.__assign)({message:(0,v.$t)("{{currentPrivilege}}",{currentPrivilege:c}),autoClose:!u,closable:!u},u?i:{})),p.eventEmitter.emit(a.zW.PERMISSION_CHANGE,{canRead:p.canRead,canEdit:p.canEdit})}},this.privilege=Object.assign({},e.DEFAULT_PERMISSION),this.isCreator=d,this.setPrivilege(r||{}),this.isPlayer="player"===(0,f.getUrlParameter)("show"),this.isPlayer||y.A.isMeetingEnv()||i.GlobalContext.on(c.Zg.PrivilegeChanged,this.onPrivilegeUpdate)}var t,n,r;return e.createInstance=function(t){return this.instance?this.instance.onReset(t):this.instance=new e(t||{}),this.instance},e.prototype.onReset=function(t){return this.isCreator=t.isCreator||!1,this.setPrivilege(Object.assign({},e.DEFAULT_PERMISSION,t.privilegeAttribute)),i.GlobalContext.removeCallBack(c.Zg.PrivilegeChanged,this.onPrivilegeUpdate),i.GlobalContext.on(c.Zg.PrivilegeChanged,this.onPrivilegeUpdate),!0},e.getInstance=function(){return this.instance||this.createInstance({})},e.prototype.getDiffText=function(e){var t=this,n=e.map((function(e){switch(e){case"can_edit":return t.isEditable?(0,v.$t)(""):(0,v.$t)("");case"can_read":return(0,v.$t)("");case"can_comment":return t.eventEmitter.emit("$onCommentPrivilegeChange",t.canComment),t.canComment?(0,v.$t)(""):(0,v.$t)("");case"can_copy":return t.canCopy?(0,v.$t)(""):(0,v.$t)("");default:return""}})).filter((function(e){return!!e})).join("");return n?(0,v.$t)("{{text}}",{text:n}):n},e.prototype.setPrivilege=function(e){var t=this,n=this.isEditable,r=this.canCopy,o=!1;Object.keys(this.privilege).forEach((function(n){var r=f.StringUtil.camelToSnake(n),i=void 0!==e[r]?e[r]:e[n];void 0!==i&&(o=!0,t.privilege[n]=!!i)})),n!==this.isEditable&&(o=!0,this.eventEmitter.emit("$editableChanged",this.isEditable)),r!==this.canCopy&&this.eventEmitter.emit("$copyableChanged",this.canCopy),o&&(i.GlobalContext.fire(new _(this)),u.Am.emit("$afterPermissionChanged",this),this.toolbarService.setEditable(this.isEditable),this.toolbarService.update())},e.prototype.setDocInfo=function(e){this.docInfo=e},e.prototype.enableEditForKey=function(e){this.disableEditSet.delete(e),0===this.disableEditSet.size&&(this.eventEmitter.emit("$editableChanged",this.isEditable),this.toolbarService.setEditable(this.isEditable),this.toolbarService.$forceUpdate(),i.GlobalContext.fire(new _(this)))},e.prototype.disableEditForKey=function(e){var t=this.disableEditSet.size;this.disableEditSet.add(e),0===t&&(this.eventEmitter.emit("$editableChanged",this.isEditable),this.toolbarService.setEditable(this.isEditable),this.toolbarService.$forceUpdate(),i.GlobalContext.fire(new _(this)))},Object.defineProperty(e.prototype,"ownerName",{get:function(){return this.docInfo.ownerName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docType",{get:function(){return this.docInfo.docType},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"createTime",{get:function(){return this.docInfo.createTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isAddedMy",{get:function(){return this.docInfo.isAddedMy},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canAbout",{get:function(){return this.privilege.canAbout},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canAddUser",{get:function(){return this.privilege.canAddUser},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canComment",{get:function(){return!b.W.isApiDoc&&this.privilege.canComment},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canExport",{get:function(){return this.privilege.canExport},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canCopy",{get:function(){var e,t;return Boolean(this.privilege.canCopy)||Boolean(window.isPublishedURL&&1!==(null===(t=null===(e=window.clientVars)||void 0===e?void 0:e.advPolicy)||void 0===t?void 0:t.view_forbid_copy_print))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canCopyDoc",{get:function(){return this.privilege.canCopyDoc},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ownerUidSource",{get:function(){return this.docInfo.ownerUidSource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canEdit",{get:function(){return!this.isPublish&&!this.isOcrPreview&&this.privilege.canEdit},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canEditTitle",{get:function(){return!this.isPublish&&!this.isOcrPreview&&this.privilege.canEditTitle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canHistory",{get:function(){return this.privilege.canHistory},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canLinkExp",{get:function(){return this.privilege.canLinkExp},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canPrint",{get:function(){return this.privilege.canPrint},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canRead",{get:function(){return this.privilege.canRead||this.isPublish||this.isPlayer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canSearch",{get:function(){return this.privilege.canSearch||this.isPublish},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canShare",{get:function(){return this.privilege.canShare},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canSpitSlot",{get:function(){return this.privilege.canSpitSlot},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canTranslate",{get:function(){return this.privilege.canTranslate},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canViewImage",{get:function(){return this.privilege.canViewImage||this.isPublish},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canWatermark",{get:function(){return this.privilege.canWatermark},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isAuth",{get:function(){return this.privilege.isAuth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isBlocked",{get:function(){return this.privilege.isBlocked},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canApplyEdit",{get:function(){var e=this.privilege.canApplyEdit;return!this.isEditable&&e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isShutdown",{get:function(){return this.privilege.isShutdown},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPreview",{get:function(){return!!(0,f.getUrlParameter)("inToastPreview")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDrivePreview",{get:function(){return!!(0,f.getUrlParameter)("inToastPreview")&&"drive"===(0,f.getUrlParameter)("from")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDiffView",{get:function(){return!(!(0,f.getUrlParameter)("begin_rev")||!(0,f.getUrlParameter)("end_rev"))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isOcrPreview",{get:function(){return!!(0,f.getUrlParameter)("ocr")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isReadingMode",{get:function(){return"reading"===(0,f.getUrlParameter)("mode")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isEditable",{get:function(){return!this.isChunkLoadReadonly&&this.isEditableCompute},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isEditableCompute",{get:function(){var e=(0,s.Yi)().isOverConNum||!1;return this.canEdit&&(this.isCreator||!e)&&!this.isPreview&&!this.isReadingMode&&!this.isShutdown&&!this.isBlocked&&0===this.disableEditSet.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isChunkLoadReadonly",{get:function(){var e,t,n,r=this.contextService.context.editor;return null===(n=null===(t=null===(e=null==r?void 0:r.state)||void 0===e?void 0:e.dataEngine)||void 0===t?void 0:t.getIsChunkLoadReadonly)||void 0===n?void 0:n.call(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCopyable",{get:function(){return this.isEditable||this.canCopy},enumerable:!1,configurable:!0}),e.DEFAULT_PERMISSION={canAbout:!1,canExport:!1,canAddUser:!1,canApplyEdit:!0,canComment:!1,canCopy:!1,canCopyDoc:!1,canEdit:!1,canEditTitle:!1,canHistory:!1,canLinkExp:!1,canPrint:!1,canRead:!1,canSearch:!1,canShare:!1,canSpitSlot:!1,canTranslate:!1,canViewImage:!1,canWatermark:!1,isAuth:!1,isBlocked:!1,isShutdown:!1},(0,o.__decorate)([(0,u.tB)(),(0,o.__metadata)("design:type","function"==typeof(t=void 0!==d.O&&d.O)?t:Object)],e.prototype,"toolbarService",void 0),(0,o.__decorate)([(0,u.tB)(),(0,o.__metadata)("design:type","function"==typeof(n=void 0!==p.v&&p.v)?n:Object)],e.prototype,"eventEmitter",void 0),(0,o.__decorate)([(0,u.tB)(),(0,o.__metadata)("design:type","function"==typeof(r=void 0!==h.O&&h.O)?r:Object)],e.prototype,"contextService",void 0),e}()},45155:function(e,t,n){var r;n.d(t,{C5:function(){return h},F4:function(){return m},Ks:function(){return p},PO:function(){return c},Yr:function(){return f},dt:function(){return r},eP:function(){return u},gu:function(){return g},k8:function(){return s},lF:function(){return y},p_:function(){return b},pz:function(){return o},tf:function(){return a},u2:function(){return i},xb:function(){return d},ym:function(){return v},zg:function(){return l}}),function(e){e.SELECTION_CHANGE="selection_change",e.SCROLL="scroll",e.HOST_UPDATE="hostUpdate",e.IMAGE="image",e.COMMENT="comment"}(r||(r={}));var o,i,a,s,c,l="image_quit_follow";!function(e){e[e.HIGHER=180]="HIGHER",e[e.LOWER=0]="LOWER"}(o||(o={})),function(e){e.UPDATE="update",e.CLOSE="close"}(i||(i={})),function(e){e.UPDATE="update",e.CLOSE="close",e.ENTER_INLINE="enterInline",e.LEAVE_INLINE="leaveInline"}(a||(a={})),function(e){e.INLINE="inline",e.EXTERNAL="external"}(s||(s={})),function(e){e.ALL="all",e.HOST="host",e.AUDIENCE="audience"}(c||(c={}));var u="wemeet_status",d="image_follow",p="comment_follow",h="comment_quit_follow",f="CommentFollowServiceInited",g="CommentContainerMounted";function v(e){return e.type===r.SELECTION_CHANGE}function y(e){return e.type===r.SCROLL}function m(e){return e.type===r.IMAGE}function b(e){return e.type===r.COMMENT}},77873:function(e,t,n){n.d(t,{B:function(){return l}});var r=n(85556),o=n(30479),i=n(28301),a=n(21856),s=n(35776),c=n(14740),l=function(){function e(){}return e.gotoTucaoWithLoginState=function(e){var t=document.createElement("form");t.id="form",t.name="form",t.style.display="none",t.setAttribute("target",o.PlatformUtil.isTencentDocsPC()||o.PlatformUtil.isWXMiniProgram()||o.PlatformUtil.isWXFamily()?"_self":"_blank"),document.body.appendChild(t),Object.keys(e).forEach((function(n){if(Object.hasOwnProperty.call(e,n)){var r=document.createElement("input");r.type="text",r.name=n,r.value=e[n],t.appendChild(r)}})),t.method="POST",t.action=a.X.getInstance().getConfig("links.feedback"),t.submit(),document.body.removeChild(t)},e.getReportId=function(e){var t,n;return(0,r.__awaiter)(this,void 0,void 0,(function(){var o,i,a,l,u,d,p;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),o=!1,i=Number(new Date),a=i-18e5,l=s.default,u=l.show({tip:(0,c.$t)("...")}),d=setTimeout((function(){o=!0,u.close(),e()}),5e3),[4,null===(n=null===(t=window.log)||void 0===t?void 0:t.report)||void 0===n?void 0:n.call(t,"TUCAO_WORD",{startTs:a,endTs:i,pid:1})];case 1:return p=r.sent(),o||(u.close(),clearTimeout(d)),[2,{isOpen:o,reportId:p}];case 2:return r.sent(),[2,{isOpen:!1,reportId:void 0}];case 3:return[2]}}))}))},e.getClientInfo=function(e){var t=e.userName,n=e.userPic,r=e.userId||"";r?r.startsWith("p")&&(r=r.replace(/p./,"")):r=e.uin;var o=" ";return void 0!==e.collab_client_vars.pver&&(o="".concat(o," pver/").concat(e.collab_client_vars.pver)),void 0!==e.collab_client_vars.gray&&(o="".concat(o," gray/").concat(e.collab_client_vars.gray)),{openid:r,nickname:t,avatar:n,clientInfo:window.navigator.userAgent+o}},e.showSupportPageJump=function(e){this.gotoTucaoWithLoginState(e)},e.showSupportPage=function(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,o,i,a;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return n=this.getClientInfo(e),[3,2];case 1:return o=r.sent(),i=o.isOpen,a=o.reportId,i?[2]:(n.customInfo=encodeURIComponent(JSON.stringify({id:e.padId,vid:n.openid,reportId:a})),[3,3]);case 2:n.customInfo=encodeURIComponent("".concat(window.location.href,"  errCode/").concat(t)),r.label=3;case 3:return this.showSupportPageJump(n),[2]}}))}))},e.jumpToHelpUrl=function(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,n,o,a,s,c,l,u,d,p,h;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return t=encodeURIComponent(window.navigator.userAgent),n=this.getClientInfo(window.clientVars),o=encodeURIComponent(n.nickname),a=encodeURIComponent(n.avatar),s=encodeURIComponent(n.openid),c=encodeURIComponent(window.location.href),[3,2];case 1:if(l=r.sent(),u=l.isOpen,d=l.reportId,u)return[2];c=encodeURIComponent(JSON.stringify({id:window.clientVars.padId,reportId:d})),r.label=2;case 2:return p="clientInfo=".concat(t,"&customInfo=").concat(c),h="".concat(e,"?nickname=").concat(o,"&avatar=").concat(a,"&openid=").concat(s,"&").concat(p),(0,i.tencentDocOpenUrlForAll)({url:h}),[2]}}))}))},e.jumpToCaoUrl=function(e){var t=encodeURIComponent(window.navigator.userAgent),n=encodeURIComponent(window.location.href),r=a.X.getInstance().getConfig("custom.links.tucao"),i="clientInfo=".concat(t,"&customInfo=").concat(n);if(e){var s=this.getClientInfo(e),c=encodeURIComponent(s.nickname),l=encodeURIComponent(s.avatar),u=encodeURIComponent(s.openid);(0,o.openLink)("".concat(r,"?nickname=").concat(c,"&avatar=").concat(l,"&openid=").concat(u,"&").concat(i))}else(0,o.openLink)("".concat(r,"?").concat(i))},e}()},21856:function(e,t,n){n.d(t,{X:function(){return c}});var r=n(5593),o=n(30479),i={MINIMAL_CONFIG:{common:{toolbar:!1,statusbar:!1,titlebar_mobile:{share:!1,login:!1,collect:!1}},custom:{feature:{share_mobile:!1,mobile_precise_preview:!1,fullscreen:!1}}},NORMAL_CONFIG:{common:{toolbar:!1,statusbar:!1,titlebar:{share:!1,saveState:!1,readonly:!1,move:!1,moreMenu:!1,login:!1,fileMenu:!1,collect:!1,collaborators:!1,back:!1,account:!1},titlebar_mobile:!1,menu:{clone:!1,accessibility:!1,print:!1,publish:!1,"export-as":!1,"save-as-template":!1,"help-and-feedback":!1,"help-center":!1,"move-to":!1,"snap-screen":!1,"copy-link":!0,"doc-version":!1,"ipad-auth":!1,"auth-apply":!1,"view-history":!0,"file-info-panel-mobile":!1}},custom:{feature:{share_mobile:!1,mobile_precise_preview:!1,fullscreen:!1,readonly_tips:!1,edit_follow:!1,outline:{autoShow:!1},comment:{autoShow:!1},scroll_position:!1},widget:{"help-center":!1},overlay:{selection_follow:!1}}},PLAYER_CONFIG:{}},a={MINIMAL_CONFIG:{common:{toolbar:!1,titlebar_mobile:{share:!1,login:!1,collect:!1}},custom:{feature:{share_mobile:!1,mobile_precise_preview:!1,fullscreen:!1}}},NORMAL_CONFIG:{common:{toolbar:!1,titlebar:{share:!1,saveState:!1,readonly:!1,move:!1,moreMenu:!1,login:!1,fileMenu:!1,collect:!1,collaborators:!1,back:!1,account:!1},titlebar_mobile:!1,menu:{clone:!1,accessibility:!1,print:!1,publish:!1,"export-as":!1,"save-as-template":!1,"help-and-feedback":!1,"help-center":!1,"move-to":!1,"snap-screen":!1,"copy-link":!0,"doc-version":!1,"ipad-auth":!1,"auth-apply":!1,"view-history":!0,"file-info-panel-mobile":!1}},custom:{feature:{share_mobile:!1,mobile_precise_preview:!1,fullscreen:!1,readonly_tips:!1,edit_follow:!1,outline:{autoShow:!1},comment:{autoShow:!1},scroll_position:!1},widget:{"help-center":!1},overlay:{selection_follow:!1}}},PLAYER_CONFIG:{}},s={MINIMAL_CONFIG:{common:{toolbar:!1,titlebar_mobile:{share:!1,login:!1,collect:!1}},custom:{feature:{share_mobile:!1,mobile_precise_preview:!1,fullscreen:!1}}},NORMAL_CONFIG:{common:{toolbar:!1,titlebar:{share:!1,saveState:!1,readonly:!1,move:!1,moreMenu:!1,login:!1,fileMenu:!1,collect:!1,collaborators:!1,back:!1,account:!1},titlebar_mobile:!1},custom:{feature:{share_mobile:!1,mobile_precise_preview:!1,fullscreen:!1,readonly_tips:!1,edit_follow:!1,outline:{autoShow:!1},comment:{autoShow:!1},scroll_position:!1},widget:{"help-center":!1},overlay:{selection_follow:!1}}},PLAYER_CONFIG:{}},c=function(){function e(){}return e.getInstance=function(){var t;if(e.instance)return e.instance;if(e.instance=r.default.getInstance(),"meeting_wework"===(null===(t=document.cookie.match(new RegExp("(^| )open_theme_id=([^;]*)(;|$)")))||void 0===t?void 0:t[2])){var n="NORMAL_CONFIG";switch("player"===(0,o.getUrlParameter)("show")&&(n="PLAYER_CONFIG"),((0,o.getUrlParameter)("minimal")||"reading"===(0,o.getUrlParameter)("mode"))&&(n="MINIMAL_CONFIG"),e.instance.getConfig("platform")){case"pc":e.instance.bind(i[n]);break;case"pad":e.instance.bind(a[n]);break;case"mobile":e.instance.bind(s[n])}}return e.instance},e}()},38429:function(e,t,n){n.d(t,{YT:function(){return c},ZM:function(){return i},cm:function(){return s},kE:function(){return a}});var r=n(30479),o="desktop_local",i=(0,r.getUrlParameter)("client")===o&&r.PlatformUtil.isTencentDocsDesktopApp(),a=(0,r.getUrlParameter)("client")===o&&!1,s=i||a,c=!(0,r.getUrlParameter)("localFilePath")},16285:function(e,t,n){var r;n.d(t,{a:function(){return r}}),function(e){e.LocalEditSaveAs="local_edit_save_as",e.LocalEditDocumentSaved="local_edit_document_saved"}(r||(r={}))},99925:function(e,t,n){n.d(t,{j:function(){return i},w:function(){return r}});var r,o=n(85556);!function(e){e.Collab="CollabCenter",e.Offline="Offline",e.Launch="Launch"}(r||(r={}));var i=function(){function e(){}return e.info=function(){for(var e,t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];null===(t=null===(e=window.log)||void 0===e?void 0:e.info)||void 0===t||t.call.apply(t,(0,o.__spreadArray)([e],(0,o.__read)(n),!1))},e.warn=function(){for(var e,t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];null===(t=null===(e=window.log)||void 0===e?void 0:e.warn)||void 0===t||t.call.apply(t,(0,o.__spreadArray)([e],(0,o.__read)(n),!1))},e.error=function(){for(var e,t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];null===(t=null===(e=window.log)||void 0===e?void 0:e.error)||void 0===t||t.call.apply(t,(0,o.__spreadArray)([e],(0,o.__read)(n),!1))},e.report=function(e,t){var n,r;void 0===t&&(t=5);var o=Date.now(),i=o-60*t*1e3;null===(r=null===(n=window.log)||void 0===n?void 0:n.report)||void 0===r||r.call(n,e,{query:{startTs:i,endTs:o}})},e}()},48273:function(e,t,n){n.d(t,{Dl:function(){return s},Z$:function(){return l},fp:function(){return c}});var r,o,i=n(30479),a=n(22494);!function(e){e[e.NORMAL_ONLINE=1]="NORMAL_ONLINE",e[e.PRELOAD_ONLINE=2]="PRELOAD_ONLINE",e[e.NORMAL_DATABASE=3]="NORMAL_DATABASE",e[e.PRELOAD_DATABASE=4]="PRELOAD_DATABASE",e[e.NORMAL_ONLINE_PREGET_DB=5]="NORMAL_ONLINE_PREGET_DB",e[e.PRELOAD_ONLINE_PREGET_DB=6]="PRELOAD_ONLINE_PREGET_DB",e[e.NORMAL_DATABASE_PREGET_DB=7]="NORMAL_DATABASE_PREGET_DB",e[e.PRELOAD_DATABASE_PREGET_DB=8]="PRELOAD_DATABASE_PREGET_DB"}(o||(o={}));var s=((r={})[o.NORMAL_ONLINE]="++DB",r[o.PRELOAD_ONLINE]="++DB",r[o.NORMAL_DATABASE]="++DB",r[o.PRELOAD_DATABASE]="++DB",r[o.NORMAL_ONLINE_PREGET_DB]="++DB",r[o.PRELOAD_ONLINE_PREGET_DB]="++DB",r[o.NORMAL_DATABASE_PREGET_DB]="++DB",r[o.PRELOAD_DATABASE_PREGET_DB]="++DB",r),c=function(){var e=window.openUrlFrom||"normal",t=window.clientvarsDataFrom||"online",n=void 0;if(a.Y.preGetDBDataSuccess)switch(!0){case"normal"===e&&"online"===t:n=o.NORMAL_ONLINE_PREGET_DB;break;case"preload"===e&&"online"===t:n=o.PRELOAD_ONLINE_PREGET_DB;break;case"normal"===e&&"database"===t:n=o.NORMAL_DATABASE_PREGET_DB;break;case"preload"===e&&"database"===t:n=o.PRELOAD_DATABASE_PREGET_DB}else switch(!0){case"normal"===e&&"online"===t:n=o.NORMAL_ONLINE;break;case"preload"===e&&"online"===t:n=o.PRELOAD_ONLINE;break;case"normal"===e&&"database"===t:n=o.NORMAL_DATABASE;break;case"preload"===e&&"database"===t:n=o.PRELOAD_DATABASE}var r=(0,i.getUrlParameter)("preloadWebviewCount");return{openMode:n,openModeName:n?"".concat(s[n],"+").concat(window.__isOfflinePkg?"":""):void 0,preloadWebviewCount:r?Number(r):1}},l=function(e){if(i.Logger.info("DEBUG",e),"1"===localStorage.getItem("show_dev_tags")){var t="showDevTags",n=document.getElementById(t);if(n)n.innerText=e;else{var r=document.createElement("div");r.id=t,r.style.position="fixed",r.style.right="0px",r.style.top="0px",r.style.fontSize="bold",r.innerText=e,r.style.color="red",r.style.zIndex="10000",r.style.fontSize="19px",r.style.pointerEvents="none",r.style.textAlign="right",document.body.appendChild(r)}}}},76343:function(e,t,n){n.d(t,{v:function(){return i}});var r=n(2613),o=n(13980),i={validUrlRe:new RegExp("^(?:https?|sftp|ftps?|ssh|ircs?|file|gopher|telnet|nntp|worldwind|chrome|chrome-extension|svn|git|mms|smb|afp|nfs|(x-)?man|gopher|txmt)://|^mailto:|^xmpp:|^sips?:|^tel:|^sms:|^news:|^bitcoin:|^magnet:|^urn:|^geo:|^/","i"),escapeHtml:function(e){var t=/[&<>'"]/g;return t.MAP||(t.MAP={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"}),e.replace(t,(function(e){return t.MAP[e]}))},getLength:function(e){for(var t=0,n=0;n<e.length;n++)t+=e.charCodeAt(n)<=255?1:2;return t},splitString:function(e,t){var n="",r=0;if(i.getLength(e)<=t)n=e;else for(var o=0;o<e.length;o++){var a=e.charAt(o);if((r+=e.charCodeAt(o)<=255?1:2)>t){n+="...";break}n+=a}return n},getIsMobile:function(){return-1!==navigator.userAgent.toLowerCase().indexOf("iphone")||-1!==navigator.userAgent.toLowerCase().indexOf("ipad")||-1!==navigator.userAgent.toLowerCase().indexOf("android")||-1!==navigator.userAgent.toLowerCase().indexOf("ipod")},getQuery:function(e){var t="",n=window.location.search;return n&&(t=n.match(new RegExp("(\\?|&)".concat(e,"=([^&]*)(#|&|$)")))),t?decodeURIComponent(t[2]):""},getEnvParam:function(e){return void 0===e&&(e=""),"".concat(e,"route_ip=").concat(i.getQuery("route_ip"),"&room_route_ip=").concat(i.getQuery("room_route_ip"))},addFromParam:function(e,t){var n=e;return n.indexOf("route_ip")>=0&&t.indexOf("route_ip")>=0||(n.indexOf("?")>=0?n+="&".concat(t):n+="?".concat(t)),n},getBkn:function(){var e=(0,r.getCookie)("skey"),t=5381;if(e){for(var n=0,o=e.length;o>n;++n)t+=(t<<5)+e.charAt(n).charCodeAt(0);return 2147483647&t}},updateQueryStringParameter:function(e,t){var n=e;return t&&Object.keys(t).forEach((function(e){var r=t[e],o=new RegExp("([?&])".concat(e,"=.*?(&|$)"),"i"),i=-1!==n.indexOf("?")?"&":"?";n=n.match(o)?n.replace(o,"$1".concat(e,"=").concat(r,"$2")):"".concat(n+i+e,"=").concat(r)})),n},checkIfAccountSwitched:function(e){var t=window.clientVars,n=t.userInfo;return!(t.isLogin&&!n)&&(n&&(n.uin||n.toid||n.userId)?!!(0,r.hasLoginCookie)()&&this.compareUid(t,e):(0,r.hasLoginCookie)())},compareUid:function(e,t){var n,i=e.userInfo,a=e.userType,s=(0,o.loginType)(),c=e&&e.uidKey,l=(0,r.getCookie)("uid_key"),u=null!==(n=i.tinyId)&&void 0!==n?n:null,d=(0,o.getUid)();if(u&&d){if(u!==d)return!0;if(a&&s){if(a!==s)return!0;if("reLoginForPskeyError"===t&&c&&l&&c!==l)return!0}}else console.error("core-doc(".concat(t,") check oUid = ").concat(u,", nUid = ").concat(d));return!1}}},28223:function(e,t,n){n.d(t,{_:function(){return i},w:function(){return r}});var r,o=n(30479);!function(e){e.OPEN_OTHER="-1",e.OPEN_NATIVE="0",e.CREATE="1",e.CREATE_LOCAL_NATIVE="2",e.CREATE_ONLINE_NATIVE="3",e.CREATE_ONLINE_OTHER="4"}(r||(r={}));var i=function(){function e(){this.parse=!1}return e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},Object.defineProperty(e.prototype,"createMode",{get:function(){return this.isPreCreate?"":this.isNewEmptyDoc?"":void 0},enumerable:!1,configurable:!0}),e.prototype.recordAndStripPerformanceValueFromUrl=function(e,t){return void 0===t&&(t=!1),o.Logger.info("recordAndStripPerformanceValueFromUrl",e,t),t||!this.parse?(this.parse=!0,this.parseNativeParamsFromUrl(e)):e},e.prototype.parseNativeParamsFromUrl=function(e){try{this.localCreate=!!(0,o.getParameterFromUrl)(e,"new"),this.templateId=(0,o.getParameterFromUrl)(e,"templateId")||void 0,this.createTS=(0,o.getParameterFromUrl)(e,"createTS")||void 0,this.csid=(0,o.getParameterFromUrl)(e,"csid")||void 0,this.clickStart=(0,o.getParameterFromUrl)(e,"clickStart")||void 0,this.clientSideRenderEnd=(0,o.getParameterFromUrl)(e,"clientSideRenderEnd")||void 0,this.isNewEmptyDoc="1"===(0,o.getParameterFromUrl)(e,"newEmptyDoc"),this.isPreCreate="1"===(0,o.getParameterFromUrl)(e,"is_precreate");var t=e;return t=(0,o.removeURLParameter)(t,"templateId"),t=(0,o.removeURLParameter)(t,"createTS"),t=(0,o.removeURLParameter)(t,"csid"),t=(0,o.removeURLParameter)(t,"clickStart"),t=(0,o.removeURLParameter)(t,"clientSideRenderEnd"),t=(0,o.removeURLParameter)(t,"newEmptyDoc")}catch(t){return o.Logger.error("stripPerformanceValueFromUrl for ".concat(e)),e}},e.prototype.getOpenWebType=function(){return this.localCreate?r.CREATE_LOCAL_NATIVE:this.createTS?this.csid?r.CREATE_ONLINE_NATIVE:r.CREATE_ONLINE_OTHER:this.csid?r.OPEN_NATIVE:r.OPEN_OTHER},e}()},22828:function(e,t,n){n.d(t,{t:function(){return r}});var r=function(){function e(){}return e.isMobile=function(){return/(mobile)/i.test(window.navigator.userAgent)},e.isMac=function(){return!e.isMobile()&&/Mac OS X/i.test(window.navigator.userAgent)},e.isAndroid=function(){return/android|adr/i.test(window.navigator.userAgent)},e.isIOS=function(){return/(iphone|ipad|ipod)/i.test(window.navigator.userAgent)},e.isWindowStore=function(){return/MSAppHost/i.test(window.navigator.userAgent)},e.isIPad=function(){return/(ipad)/i.test(window.navigator.userAgent)},e.isIPhone=function(){return/(iphone)/i.test(window.navigator.userAgent)},e.isMiniProgram=function(){return/(miniProgram)/i.test(window.navigator.userAgent)},e.isWedrive=function(){return/WeDrive/i.test(window.navigator.userAgent)},e}()},22494:function(e,t,n){n.d(t,{Y:function(){return a},r:function(){return s}});var r=n(14740),o=!1,i=!1,a={dbHasResult:!1,dbClientVarsCost:-1,clientVarsFrom:"",onlineClientVarsCost:-1,waitForClientVars:-1,get preGetDBDataSuccess(){return o},set preGetDBDataSuccess(e){i||(i=!0,o=e)},openMode:(0,r.$t)(""),editableCost:-1},s={keyPathReady:!1,onlineAndDBReady:!1}},70794:function(e,t,n){function r(e,t){var n=e.split("?");if(n.length>=2){for(var r="".concat(encodeURIComponent(t),"="),o=n[1].split(/[&;]/g),i=o.length;i>0;)-1!==o[i-=1].lastIndexOf(r,0)&&o.splice(i,1);return n[0]+(o.length>0?"?".concat(o.join("&")):"")}return e}function o(e){var t,n,r,o=window.location.search.substring(1);if(o)for(t=o.split("&"),n=0;n<t.length;n++)if((r=t[n].split("="))[0]===e)return r[1];return null}function i(e){var t=document.createElement("textarea");t.readOnly=!0,t.style.zIndex="0",t.style.opacity="0",t.style.top="-9999px",t.style.left="-9999px",t.style.position="fixed",document.body.appendChild(t),t.value=e,t.select(),document.execCommand("copy"),document.body.removeChild(t)}n.d(t,{Iv:function(){return i},re:function(){return o},rg:function(){return r}})},26676:function(e,t,n){n.d(t,{Gb:function(){return i},cD:function(){return c},k8:function(){return a},mS:function(){return h},mZ:function(){return l},qA:function(){return s},tD:function(){return u}});var r=n(85556),o=n(14366);function i(e,t){return t?e+t.slice(0,5):e}function a(e){var t=document.cookie.match(new RegExp("(^| )".concat(e,"=([^;]*)(;|$)")));return t?decodeURIComponent(t[2]):""}function s(e,t){var n=window.history;try{t?n.replaceState(null,"",e):n.pushState(null,"",window.multiAccountUtil.getMultiUrl(e))}catch(n){window.location[t?"replace":"assign"](e)}}function c(){if(!document.getElementsByClassName("melo-paragraph").length)return 0;var e=document.getElementsByClassName("melo-paragraph")[0],t=getComputedStyle(e).width;return Math.round(Number(t.replace("px","")))}function l(e){for(var t=e;t;){if(t.className&&t.className.indexOf("melo-paragraph")>=0){var n=getComputedStyle(t).width;return Math.round(Number(n.replace("px","")))}t=t.parentNode}return 0}function u(e,t){if(void 0===t&&(t=5),!(e instanceof Element))return"";for(var n=[],r=[];e&&e.nodeType===Node.ELEMENT_NODE&&!(n.length>=t);){var o=e.nodeName.toLowerCase(),i=e.textContent||e.value;if(i&&(i=i.length>10?i.substr(0,10):i,r.unshift(i)),e.id){o+="#".concat(e.id),n.unshift(o);break}o+=e.className?".".concat(e.className):"",e=e.parentNode,n.unshift(o)}return JSON.stringify({pathText:r.join(" > "),paht:n.join(" > ")})}n(2613),window.__pushState=s;var d=function(e){if(!e)return!1;if(window.BigInt)return BigInt(e)>>BigInt(48)===BigInt(20);console.error("BigInt is not supported");var t=e.substring(0,6);return 16===e.length&&("562949"===t||"562950"===t)},p=function(e){return new Promise((function(t){var n,r,i=function(){return t(new Map)},a=e.filter((function(e){return d(String(e))}));if(console.log("getAppInfos canUseIds",a),!a.length)return i();o.Z.post("/webdisk/member_info",(n={func:4,appid:a},r=[],Object.keys(n).map((function(e){var t=n[e];t instanceof Array?t.forEach((function(t){r.push("".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t)))})):void 0!==t&&r.push("".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t)))})),r.join("&"))).then((function(e){var n,r;if(0!==(null===(r=null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.head)||void 0===r?void 0:r.ret))return console.error("get webdisk/member_info failed but we fallback to make it user friendly.",e),i();var o=new Map;e.data.body.app_info.forEach((function(e){o.set(e.appid,{icon:e.icon_doc,name:e.name})})),t(o)})).catch((function(e){return console.error("get webdisk/member_info error but we fallback to make it user friendly.",e),i()}))}))},h=function(e){var t=e.creatorId,n=e.creatorIcon,o=e.creatorNick,i=e.source;return(0,r.__awaiter)(void 0,void 0,void 0,(function(){var e,a,s,c;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return d(t)?o&&n?[3,2]:(e=Number(t),[4,p([e])]):[2,{}];case 1:a=r.sent(),o=(null===(s=a.get(e))||void 0===s?void 0:s.name)||o,n=(null===(c=a.get(e))||void 0===c?void 0:c.icon)||n,r.label=2;case 2:return console.log("convertToAppCreatorDocLink from ".concat(i),{creatorId:t,creatorNick:o,creatorIcon:n}),[2,{fileFavicon:n,fileCreatorNick:o}]}}))}))}},50263:function(e,t,n){n.d(t,{A:function(){return I}});var r,o,i,a,s,c=n(85556),l=n(2613),u=n(76343),d=n(13980),p=n(60952),h=n(30479),f=n(21856),g=n(14366),v=n(679),y=n(45155);!function(e){e.PRODUCTION="production",e.PRERELEASE="prerelease",e.TEST="test"}(s||(s={}));var m,b=((r={})[s.PRODUCTION]="meeting_release",r[s.PRERELEASE]="meeting_test",r[s.TEST]="meeting_test",r),_=((o={})[s.PRODUCTION]=f.X.getInstance().getConfig("custom.links.meetingLaunchProduction"),o[s.PRERELEASE]=f.X.getInstance().getConfig("custom.links.meetingLaunchPreRelease"),o[s.TEST]=f.X.getInstance().getConfig("custom.links.meetingLaunchTest"),o),C=((i={})[s.PRODUCTION]="16272901304",i[s.PRERELEASE]="16310196082",i[s.TEST]="16282553643",i),S=((a={})[s.PRODUCTION]="1400115281",a[s.PRERELEASE]="1400212767",a[s.TEST]="200008554",a),w=(m=(0,l.getCookie)("fd")||"",/^$|^release/.test(m)?s.PRODUCTION:/^prerelease/.test(m)?s.PRERELEASE:s.TEST),E=b[w],x=_[w],T=C[w],R=S[w],I=function(){function e(){}var t;return e.getCurrMeetingInfo=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return[4,p.ud.get(p.wA.Wemeet,{retryOnline:!0})];case 1:return[4,e.sent().data.getCurrMeetingInfo()];case 2:return[2,e.sent()]}}))}))},t=e,e.role=v.tZ.UNKNOWN,e.initialized=!1,e.openType=y.k8.EXTERNAL,e.getOpenType=function(){return e.openType},e.setOpenType=function(t){e.openType=t},e.isTencentMeeting=function(){return"tencent_meeting"===(0,l.getCookie)("open_theme_id")},e.isTencentMeetingInWework=function(){return/meeting_wework/i.test(navigator.userAgent)||"meeting_wework"===(0,l.getCookie)("open_theme_id")},e.isMeetingEnv=function(){return e.isTencentMeetingInWework()||e.isTencentMeeting()},e.isSpeaker=function(){return"speaker"===u.v.getQuery("login")||e.role===v.tZ.HOST},e.isPresentation=function(){return"meeting"===u.v.getQuery("mode")},e.shouldPresentationByWemeet=function(){return["wx"].includes((0,d.getUtype)())},e.redirectToWemeet=function(){var e;l.ReportHelper.tdwReport({opername:"doc_meet_web",module:"doc_to_meet",action:"begin_presentation_clk",file_type:"doc"});var t=null===(e=window.clientVars)||void 0===e?void 0:e.globalPadId;if(t){var n=encodeURIComponent(JSON.stringify({action:"jump",file_id:t})),r="".concat(x),o="/oauth/v2/direct/authorize?client_id=".concat(E,"&response_type=code&redirect_uri=").concat(encodeURIComponent(r),"&state=").concat(n),i=(0,d.getNowUserId)();i&&(o=o.concat("&u=".concat(i))),window.open(o)}},e.agentMeetingConfig=function(){return(0,c.__awaiter)(void 0,void 0,Promise,(function(){var n,r,o;return(0,c.__generator)(t,(function(t){switch(t.label){case 0:return e.initialized?[2]:[4,p.ud.get(p.wA.Wemeet,{retryOnline:!0})];case 1:return[4,(n=t.sent()).permission.checkJsApiConfig().catch((function(e){throw h.Logger.error("".concat(null==e?void 0:e.message)),new Error("".concat(null==e?void 0:e.message))}))];case 2:return t.sent().configState===n.JsApiConfigState.DONE?(e.initialized=!0,[2]):[4,n.permission.requestAgentAuthCode({sdkId:T}).catch((function(e){throw h.Logger.error("".concat(null==e?void 0:e.message)),new Error("".concat(null==e?void 0:e.message))}))];case 3:return r=t.sent().authCode,[4,(i={code:r,url:window.location.href},(0,c.__awaiter)(void 0,void 0,void 0,(function(){var e;return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return[4,g.Z.get("/cooperation/v1/meeting/jssdk-sign",{params:i})];case 1:if(0!==(e=t.sent().data).ret)throw new Error(e.msg);return[2,e]}}))}))).catch((function(e){throw h.Logger.error(" sdk ".concat(e.message)),new Error(" sdk ".concat(e.message))}))];case 4:return o=t.sent().data,[4,n.permission.agentConfig((0,c.__assign)({corpId:R,sdkId:T},o)).catch((function(e){throw h.Logger.error("agentConfig ".concat(e.message)),new Error("agentConfig ".concat(e.message))}))];case 5:return t.sent(),e.initialized=!0,[2]}var i}))}))},e.reportForMeeting=function(){var e=u.v.getQuery("meet_from");switch(e){case"new":case"insert":case"select":l.ReportHelper.tdwReport({opername:"doc_meet_web",module:"share_in_meet",action:"begin_presentation",file_type:"doc",ver10:e});break;case"web_select":l.ReportHelper.tdwReport({opername:"doc_meet_web",module:"doc_to_meet",action:"begin_presentation_set",file_type:"doc"})}},e.closeLoadingInEdit=function(){return(0,c.__awaiter)(void 0,void 0,void 0,(function(){var n,r;return(0,c.__generator)(t,(function(t){switch(t.label){case 0:return(null===(n=window.tdocs)||void 0===n?void 0:n.closeLoading)?(null===(r=window.tdocs)||void 0===r||r.closeLoading(),[2]):e.isPresentation()||!e.isMeetingEnv()?[3,2]:[4,p.ud.get(p.wA.Wemeet,{retryOnline:!0})];case 1:t.sent().ui.closeLoading(),t.label=2;case 2:return[2]}}))}))},e.closeLoadingInPresentation=function(){return(0,c.__awaiter)(void 0,void 0,void 0,(function(){var n,r;return(0,c.__generator)(t,(function(t){switch(t.label){case 0:return(null===(n=window.tdocs)||void 0===n?void 0:n.closeLoading)?(null===(r=window.tdocs)||void 0===r||r.closeLoading(),[2]):e.isMeetingEnv()?[4,p.ud.get(p.wA.Wemeet,{retryOnline:!0})]:[3,2];case 1:t.sent().ui.closeLoading(),t.label=2;case 2:return[2]}}))}))},e.setDocEditStateInMobileTencentMeeting=function(e){return(0,c.__awaiter)(void 0,void 0,void 0,(function(){return(0,c.__generator)(t,(function(t){switch(t.label){case 0:case 4:return[2];case 1:return t.trys.push([1,3,,4]),[4,p.ud.get(p.wA.Wemeet,{retryOnline:!0})];case 2:return t.sent().appShare.setDocEditState({state:e}),[3,4];case 3:return t.sent(),h.Logger.error("tencentMeeting SDK - appShare.setDocEditState error"),[3,4]}}))}))},e.setDocViewDirectionInTencentMeeting=function(){return(0,c.__awaiter)(void 0,void 0,void 0,(function(){var e,n,r;return(0,c.__generator)(t,(function(t){switch(t.label){case 0:case 4:return[2];case 1:return t.trys.push([1,3,,4]),[4,p.ud.get(p.wA.Wemeet,{retryOnline:!0})];case 2:return e=t.sent(),n=e.appShare,r=e.DocViewDirectionType,n.setDocViewDirection({direction:r.PORTRAIT}),[3,4];case 3:return t.sent(),h.Logger.error("tencentMeeting SDK - appShare.setDocViewDirection error"),[3,4]}}))}))},e}()},19762:function(e,t,n){function r(e){var t=new RegExp("(?:^|;+|\\s+)".concat(e,"=([^;]*)")),n=document.cookie.match(t);return(n?n[1]:"")||null}function o(){return r("TOK")||""}n.d(t,{e:function(){return r},f:function(){return o}})},33931:function(e,t,n){n.d(t,{By:function(){return a},Or:function(){return u},Re:function(){return l},Uq:function(){return c},eT:function(){return s},ny:function(){return i}});var r=n(85556),o=n(2613);function i(e,t,n){var i=e,a=t.changeset;return a&&a.forEach((function(e,t,n){var a;a=(0,r.__read)(o.Changeset.followDouble(e.mutations,i),2),n[t].mutations=a[0],i=a[1]})),i}function a(e){return e.reduce((function(e,t){return e.push.apply(e,(0,r.__spreadArray)([],(0,r.__read)(t.mutations),!1)),e}),[])}function s(e){return JSON.stringify(e.map((function(e){var t=e.mutations.map((function(e){return e.serialize()}));return{type:e.type,mutations:t}})))}function c(e){var t=JSON.parse(e);return(Array.isArray(t)?t:t.commands).map((function(e){var t=o.Changeset.deserialize(e.mutations,o.MutationWrapperDeserialize);return{type:e.type,mutations:t}}))}function l(e){var t=0;return e.forEach((function(e){e.mutations.forEach((function(e){e.type===o.MutationType.insert&&(t+=e.getMutation().text.length)}))})),t}var u=function(e){return c(s(e))}},95507:function(e,t,n){n.d(t,{E:function(){return f}});var r=n(85556),o=n(2613),i=n(30479),a=n(41290),s=n(63184),c=n(97891),l=n(82173),u=n(52739),d=n(14740),p=n(15857),h=(0,i.throttle)((function(){u.default.show({message:(0,d.$t)(""),duration:3e3,autoClose:!0,id:"largeDocumentScrollToBottomSnackBarId"})}),5e3),f=function(){function e(e){var t,n,a=this;this.gapMutations=[],this.retryFetchChunkCount=2,this.firstCount=2,this.defaultCount=10,this.maxRequestCount=2,this.chunkTotalLength=0,this.gcpChunkEnd=0,this.revisionVersion=0,this.waitRequestQueue=[],this.requestingQueue=[],this.currentChunk=0,this.slowStart=0,this.slowStartMax=20,this.retrySliceCount={},this.layoutRunning=!1,this.userChangeQuene=[],this.docLength=0,this.isLoadEdit=!1,this.isPause=!1,this.isFinished=!1,this.offlineMutationsFollow=[],this.setFinishCb=function(e){a.collabCenterAdapter=e},this.debounce=function(e,t,n){var r;return void 0===n&&(n=!0),function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];n&&(a.isPause=!0,a.slowStartClear()),r&&clearTimeout(r),r=setTimeout((function(){return e.apply(o)}),t)}},this.finishInput=this.debounce((function(){a.isPause=!1,a.layoutRunning=!1,a.moveFoward()}),2e3),this.forceLayout=this.debounce((function(){a.isFinished||(i.Logger.info("[] index: ".concat(a.currentChunk,", : ").concat(a.chunkTotalLength)),i.Logger.info("[]Unused[".concat(a.currentChunk,"]: ").concat(a.hasContentUnused(a.currentChunk),", Run: ").concat(a.layoutRunning)),a.isPause=!1,a.layoutRunning=!1,a.moveFoward())}),5e3,!1),this.applyChunk=function(e){if(Array.isArray(e)&&0!==e.length){a.layoutRunning=!0;var t=a.getMinMaxGCPByMutations(e),n=t.minGCP,r=t.maxGCP-n;a.editor.state.deltaApplyController.forceUpdateDirtyRange(new o.GCPRange(Math.max(n-1,0),r));var i=s.QD.mutations2Delta(e.concat(a.offlineMutationsFollow));i.globalOpts.isInputDoc=!0,a.editor.state.applyDelta(i)}else a.moveFoward()},this.retryRequestingQueue=function(e){var t,n;try{for(var o=(0,r.__values)(a.requestingQueue),s=o.next();!s.done;s=o.next()){var c=s.value;(!e||e&&c.index<=e&&e<c.index+c.count)&&(i.Logger.info("[] retryRequestingQueue, requestItem: ".concat(JSON.stringify(c))),a.processFetchChunk(c.index,c.count))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},this.onlineChange=function(){i.Logger.info("[] online, requestingQueue: ".concat(JSON.stringify(a.requestingQueue))),a.retryRequestingQueue()},this.loggerFisrtEnd=function(e){var t=1500;i.Logger.info(e),e.length>4500?(i.Logger.info(e.slice(-3e3,-1500)),i.Logger.info(e.slice(-1500))):e.length>t&&i.Logger.info(e.slice(-1500))},this.onLoadingDBClick=function(e){"dblclick"===e.event.type&&h()},this.onScrollToBottom=function(){var e,t,n,r=null===(e=a.editor.scrollHandler)||void 0===e?void 0:e.getClientHeight();(null===(t=a.editor.scrollHandler)||void 0===t?void 0:t.getScrollTop())+r>=(null===(n=a.editor.scrollHandler)||void 0===n?void 0:n.getScrollHeight())-10&&h()},this.editor=e.editor,this.clientVars=e.clientVars,this.csManager=e.csManager,this.isLoadEdit=!!(0,i.getUrlParameter)("isLoadEdit");var c=null===(n=null===(t=this.clientVars)||void 0===t?void 0:t.initialAttributedText)||void 0===n?void 0:n.text;if(!c||Array.isArray(c)&&0===c.length){var l="chunkCenter constructor error, firstData null";return i.Logger.error(l),void o.ReportHelper.captureException(o.MonitorName.FITST_CHUNK_LOAD_ERROR,{},l)}this.currentChunkData=c[0],this.currentChunkData.gap_chunk&&(this.gapMutations=this.getMutationsByChunkItemData(this.currentChunkData.gap_chunk)),this.chunkTotalLength=this.currentChunkData.total,this.revisionVersion=this.currentChunkData.revision_version||0,this.chunkVersion=this.currentChunkData.chunk_version,this.editorInitPromise(),globalThis.layoutTotalTime=0}return e.prototype.editorInitPromise=function(){var t=this;e.fetchChunkPromise=new Promise((function(e){t.initEvents(e)}))},e.prototype.loadDocumentData=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return(0,r.__generator)(this,(function(r){try{return this.chunkStartTime=Date.now(),this.handleSlicedChunks(this.currentChunkData),e=this.currentChunkData.chunks.length,t=this.getGroupMutationsByFollow(this.currentChunk,e,!0),this.docLength=t[0].getMutation().text.length,this.initWaitRequestQueue(),this.loadDocData(),this.layoutRunning=!0,(n=new s.QD({mutations:t})).dataEngine.setGCPChunkEnd(this.gcpChunkEnd),[2,n]}catch(e){o.ReportHelper.captureException(o.MonitorName.FITST_CHUNK_LOAD_ERROR,{},e)}return[2]}))}))},e.prototype.getCacheSlicedChunks=function(){return e.cacheSlicedChunks},e.prototype.getIndexSlicedChunks=function(t){return e.cacheSlicedChunks[t]},e.prototype.selectIndexSlicedChunks=function(e){var t=this.getIndexSlicedChunks(e);this.editor.service.getSelection().setRange(Number(t.gcpStart),Number(t.gcpEnd))},e.prototype.handleSlicedChunks=function(e){var t=this;e.chunks.forEach((function(e){t.setCacheSlicedChunk(e)}))},e.prototype.setCacheSlicedChunk=function(t){if(!e.cacheSlicedChunks[t.index]){var n=this.getMutationsByChunkItemData(t);e.cacheSlicedChunks[t.index]={mutations:n,gcpStart:t.gcp_start,gcpEnd:t.gcp_end,used:!1}}},e.prototype.getMutationWrapper=function(e){var t=o.Changeset.deserialize(e,o.MutationWrapperDeserialize);return Array.isArray(t)?t:[t]},e.prototype.getMutationsByChunkItemData=function(e){var t=JSON.parse(e.command_json_str);return this.getMutationWrapper(t.mutations)},e.prototype.getGroupMutations=function(t,n){for(var r,o=[],a=t;a<n;a++)(r=e.cacheSlicedChunks[a])?(o=o.concat(r.mutations),r.used=!0):i.Logger.error("[]error: getGroupMutations undefined, index: ".concat(a));return o},e.prototype.setDataEngineChunkEnd=function(e){this.editor.state.dataEngine.setGCPChunkEnd(e)},e.prototype.setIsChunkLoadReadonly=function(e){this.editor.state.dataEngine.setIsChunkLoadReadonly(e)},e.prototype.hasContentUnused=function(t){return e.cacheSlicedChunks[t]&&!e.cacheSlicedChunks[t].used},e.prototype.getOfflineMutations=function(){var e,t=[];return null===(e=this.userChangeQuene)||void 0===e||e.forEach((function(e){var n=e.changeset;null==n||n.forEach((function(e){t.push.apply(t,(0,r.__spreadArray)([],(0,r.__read)(e.mutations),!1))}))})),t},e.prototype.slowStartAdd=function(){this.slowStart<this.slowStartMax&&(this.slowStart+=1)},e.prototype.slowStartClear=function(){this.slowStart=0},e.prototype.getUnusedCount=function(e,t){for(var n=0,r=e;r<e+t&&this.hasContentUnused(r);r++)n+=1;return n},e.prototype.getShouldMoveCount=function(e){return Math.floor(e/4)+1},e.prototype.getMinMaxGCPByMutations=function(e,t){var n,i,a,s,c,l=0,u=1/0;try{for(var d=(0,r.__values)(e),p=d.next();!p.done;p=d.next()){var h=p.value;s=null==(c=null==h?void 0:h.getMutation())?void 0:c.beginIndex,a=null==c?void 0:c.endIndex,t&&!h.options.inChunkRange||h.type===o.MutationType.modify&&("number"==typeof a&&a>l&&a>=0&&(l=a),"number"==typeof s&&s<u&&s>=0&&(u=s))}}catch(e){n={error:e}}finally{try{p&&!p.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}return{minGCP:u,maxGCP:l}},e.prototype.getChunkEndByMutation=function(t,n,r){var o=0,i=r.length>0;return i||(o=Number(e.cacheSlicedChunks[n-1].gcpEnd||0)),(i||0===o)&&(o=this.getChunkEndByFollow(t,r)),n===this.chunkTotalLength&&(o=-1),o},e.prototype.getChunkEndByFollow=function(e,t){return t.forEach((function(t){var n=null==t?void 0:t.getMutation(),r=null==n?void 0:n.beginIndex,i=null==n?void 0:n.endIndex;if(t.type===o.MutationType.insert&&void 0!==r){var a=((null==n?void 0:n.text)||"").length;r<=e&&(e+=a)}t.type===o.MutationType.delete&&void 0!==r&&void 0!==i&&(a=i-r,e>=i?e-=a:r<=e&&e<i&&(e=r))})),e},e.prototype.getGroupMutationsByFollow=function(t,n,i){var a,s,c,l=this;void 0===i&&(i=!0);var u,d=this.getGroupMutations(t,n);0===t&&this.gapMutations.length&&(d[0].options.baseLen=(null===(c=null===(s=d[0].getMutation())||void 0===s?void 0:s.text)||void 0===c?void 0:c.length)||0,u=d.shift()),this.currentChunk=n,this.userChangeQuene=this.csManager.store.getChanges();var p=this.getOfflineMutations();this.gapMutations.length&&this.isLoadEdit&&(p=this.gapMutations.concat(p));var h=p.length>0,f=Number(e.cacheSlicedChunks[n-1].gcpEnd||0);return this.offlineMutationsFollow=[],i&&h&&(a=(0,r.__read)(o.Changeset.followDouble(p,d),2),p=a[0],d=a[1],p.forEach((function(e,t){var n;if(e.type===o.MutationType.modify){var i=p.slice(t).filter((function(e){return e.type===o.MutationType.insert||e.type===o.MutationType.delete})),a=o.Changeset.followSingle([e],i,!1);a.length>0&&(n=l.offlineMutationsFollow).push.apply(n,(0,r.__spreadArray)([],(0,r.__read)(a),!1))}}))),d=this.editor.state.meetsServerMutation(d,!1),this.gcpChunkEnd=this.getChunkEndByMutation(f,n,p),this.setIsChunkLoadReadonly(!this.isLoadEdit&&this.gcpChunkEnd>0),this.editor.state.dataEngine.getIsChunkLoadReadonly()&&!1!==this.editor.isEditable()&&this.editor.setEditable(!1),0===t&&this.gapMutations.length&&(this.isLoadEdit&&(d=this.gapMutations.concat(d)),d.unshift(u)),n!==this.chunkTotalLength||this.isLoadEdit||(d=d.concat(this.gapMutations)),d},e.prototype.moveFoward=function(){if(!this.isFinished&&!this.layoutRunning){this.slowStartAdd();var e=this.getShouldMoveCount(this.slowStart),t=this.getUnusedCount(this.currentChunk,e);if(i.Logger.info("[]Run: ".concat(this.layoutRunning,", unusedCount: ").concat(t,", shouldMoveCount: ").concat(e,", ")+"Unused[".concat(this.currentChunk,"]: ").concat(this.hasContentUnused(this.currentChunk),", : ").concat(this.chunkTotalLength)),t){var n=this.currentChunk+t,r=this.getGroupMutationsByFollow(this.currentChunk,n);this.setDataEngineChunkEnd(this.gcpChunkEnd),this.applyChunk(r)}else this.slowStartClear(),this.retryRequestingQueue(this.currentChunk),i.Logger.info("[]moveFoward fail, shouldMoveCount: ".concat(e,", unusedCount: ").concat(t)),i.Logger.info("[]Unused[".concat(this.currentChunk,"]: ").concat(this.hasContentUnused(this.currentChunk),", Run: ").concat(this.layoutRunning))}},e.prototype.requestingQueueSplice=function(e,t){var n=-1;this.requestingQueue.forEach((function(r,o){r.index===e&&r.count===t&&(n=o)})),n>=0&&this.requestingQueue.splice(n,1)},e.prototype.fetchOpenDoc=function(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n=this;return(0,r.__generator)(this,(function(r){return[2,new Promise((function(r,o){var a=new URL(window.location.href).searchParams;a.delete("uid"),a.delete("uid_key");var s=a.toString(),c="/dop-api/get/doc?".concat(s,"&padId=").concat(n.clientVars.globalPadId)+"&start_index=".concat(e,"&count=").concat(t,"&revision_version=").concat(n.revisionVersion);$.get(c,{},(function(n,a){if("success"===a&&0===n.retcode){var s=n.data;r({retcode:0,data:s})}else i.Logger.error("[] ".concat(e,",count:").concat(t,",, fail data: ").concat(JSON.stringify(n))),o({retcode:n&&n.retcode||-1,data:n})})).catch((function(t){o({retcode:-1,data:void 0}),i.Logger.error("[] ".concat(e,"catch, error: ").concat(JSON.stringify(t)))}))}))]}))}))},e.prototype.processFetchChunk=function(e,t){var n=this;this.fetchOpenDoc(e,t).then((function(r){o.ReportHelper.monitor007Status(o.MonitorName.CHUNK_REQUEST_SUCESS_RATE,o.Status007.SUCCESS),n.requestingQueueSplice(e,t),n.loadDocData(),i.Logger.info("[]".concat(e,",  ").concat(t,"")),r.data.chunk_version!==n.chunkVersion&&(i.Logger.error("[] new chunkVer:".concat(r.data.chunk_version,", old chunkVer: ").concat(n.chunkVersion)),window.location.reload()),n.handleSlicedChunks(r.data),e===n.currentChunk&&n.moveFoward()})).catch((function(r){if(200706===r.retcode)throw n.destroy(),new Error("doc is completed deleted");o.ReportHelper.monitor007Status(o.MonitorName.CHUNK_REQUEST_SUCESS_RATE,o.Status007.FAIL,JSON.stringify(r)),i.Logger.error("[] processFetchChunk catch, ".concat(e,",count:").concat(t,",, error: ").concat(JSON.stringify(r))),void 0===n.retrySliceCount[e]&&(n.retrySliceCount[e]=n.retryFetchChunkCount),n.retrySliceCount[e]=n.retrySliceCount[e]-1,n.retrySliceCount[e]>=0?(i.Logger.error("[] processFetchChunk retryCount: ".concat(n.retrySliceCount[e])),setTimeout((function(e,t){n.processFetchChunk(e,t)}),2e3,e,t)):(u.default.show({message:(0,d.$t)(""),duration:5e3,type:"error"}),o.ReportHelper.captureException(o.MonitorName.OTHER_CHUNK_LOAD_ERROR,{extra:{detail:n.currentChunk}},r),o.ReportHelper.monitor007Status(o.MonitorName.OTHER_CHUNK_LOAD_ERROR,o.Status007.FAIL,void 0,{errorCode:l.p.CollabRoomGetChunkFail}))}))},e.prototype.loadDocData=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(t){for(;this.waitRequestQueue.length>0&&this.requestingQueue.length<this.maxRequestCount;){if(!(e=this.waitRequestQueue.shift()))return[2];this.requestingQueue.push(e),this.processFetchChunk(e.index,e.count)}return[2]}))}))},e.prototype.initWaitRequestQueue=function(){for(var e=this.firstCount;e<this.chunkTotalLength;)this.waitRequestQueue.push({index:e,count:this.defaultCount}),e+=this.defaultCount},e.prototype.logCacheSlicedChunks=function(){var t={};Object.keys(e.cacheSlicedChunks).forEach((function(n){var r=e.cacheSlicedChunks[n];t[n]={gcpStart:r.gcpStart,gcpEnd:r.gcpEnd,used:r.used}})),this.loggerFisrtEnd("[chunk]cacheSlicedChunks Logger: ".concat(JSON.stringify(t)))},e.prototype.initEvents=function(e){var t,n=this;this.editor&&(this.editor.on(o.LayoutNotification.LayoutEachChunkFinished,(function(){n.isFinished||(n.layoutRunning=!1,n.currentChunk===n.chunkTotalLength&&(n.chunkEndTime=Date.now(),o.ReportHelper.monitor007Status(o.MonitorName.CHUNK_ALL_LOAD_SUCESS,o.Status007.SUCCESS),o.ReportHelper.monitor007Value(o.MonitorName.CHUNK_USE_TIME,n.chunkEndTime-n.chunkStartTime),i.Logger.info("[]!"),n.logCacheSlicedChunks(),n.isFinished=!0,n.editor.fire(new c.m,!1),e(n.editor.generateDocumentKeyFrame()),n.collabCenterAdapter.resume(a.PauseOrResumeType.ALL),p.qO.getInstance().canEdit&&n.editor.setEditable(!0),n.destroy()),n.isPause||n.moveFoward())}),this),this.editor.on(o.HiddenEditorNotificationType.ON_INPUT,this.finishInput,this),this.editor.on(o.LayoutNotification.LayoutChanged,this.forceLayout,this),null===(t=this.editor.scrollHandler)||void 0===t||t.addScrollListener(this.onScrollToBottom),this.isLoadEdit||this.editor.on(o.RenderNotificationTypes.PAGE_MOUSE_EVENT,this.onLoadingDBClick,this),window.addEventListener("online",this.onlineChange))},e.prototype.removeEvents=function(){var e;this.editor&&(this.editor.removeListener(o.LayoutNotification.LayoutEachChunkFinished,this),this.editor.removeListener(o.HiddenEditorNotificationType.ON_INPUT,this),this.editor.removeListener(o.LayoutNotification.LayoutChanged,this),null===(e=this.editor.scrollHandler)||void 0===e||e.removeScrollListener(this.onScrollToBottom),this.editor.removeListener(o.RenderNotificationTypes.PAGE_MOUSE_EVENT,this),window.removeEventListener("online",this.onlineChange))},e.prototype.destroy=function(){this.waitRequestQueue=[],this.requestingQueue=[],this.currentChunk=0,this.retrySliceCount={},e.cacheSlicedChunks={},this.removeEvents()},e.cacheSlicedChunks={},e}()},97891:function(e,t,n){n.d(t,{J:function(){return r},m:function(){return a}});var r,o=n(85556),i=n(30479);!function(e){e.CHUNK_CENTER_FINISH="chunk_center_finish"}(r||(r={}));var a=function(e){function t(){return e.call(this,r.CHUNK_CENTER_FINISH)||this}return(0,o.__extends)(t,e),t}(i.Notification)},17908:function(e,t,n){n.d(t,{F:function(){return c},d:function(){return l}});var r=function(){function e(){}return e.get=function(e){var t=document.cookie.match(new RegExp("(^| )".concat(e,"=([^;]*)(;|$)")));return t?decodeURIComponent(t[2]):""},e.set=function(e,t,n,r,o){var i=new Date;i.setTime(i.getTime()+(o?36e5*o:2592e6)),document.cookie="".concat(e,"=").concat(t,"; ")+"expires=".concat(i.toUTCString(),"; path=").concat(r||"/","; ").concat(n?"domain=".concat(n,";"):"")},e.del=function(e,t,n){document.cookie="".concat(e,"=; expires=Mon, 26 Jul 1997 05:00:00 GMT; path=").concat(n||"/","; ").concat(t?"domain=".concat(t,";"):"")},e.uin=function(){var t=e.get("uin");return t?parseInt(t.substring(1,t.length),10):null},e}(),o=n(22828),i=n(81814),a=(n(30479),n(13980)),s=n(14740),c='{"commands":[{"type":"DocKeyframe","mutations":[{"ty":"is","bi":0,"s":"\\r\\r\\u000f\\u001e\\u001e\\u001e\\u001e\\u001e\\u001e\\u001e","bl":0},{"ty":"mp","bi":0,"ei":1,"pr":{"run":{"author":"p.144115210468732521","isPlaceholder":true}},"mt":"run","bl":10,"mm":"insert"},{"ty":"mp","bi":1,"ei":2,"pr":{"run":{"author":"p.144115210468732521","isPlaceholder":true}},"mt":"run","bl":10,"mm":"insert"},{"ty":"mp","bi":2,"ei":3,"pr":{"run":{"isPlaceholder":true}},"mt":"run","bl":10,"mm":"insert"},{"ty":"mp","bi":3,"ei":4,"pr":{"run":{"isPlaceholder":true}},"mt":"run","bl":10,"mm":"insert"},{"ty":"mp","bi":4,"ei":5,"pr":{"run":{"isPlaceholder":true}},"mt":"run","bl":10,"mm":"insert"},{"ty":"mp","bi":5,"ei":6,"pr":{"run":{"isPlaceholder":true}},"mt":"run","bl":10,"mm":"insert"},{"ty":"mp","bi":6,"ei":7,"pr":{"run":{"isPlaceholder":true}},"mt":"run","bl":10,"mm":"insert"},{"ty":"mp","bi":7,"ei":8,"pr":{"run":{"isPlaceholder":true}},"mt":"run","bl":10,"mm":"insert"},{"ty":"mp","bi":8,"ei":9,"pr":{"run":{"isPlaceholder":true}},"mt":"run","bl":10,"mm":"insert"},{"ty":"mp","bi":9,"ei":10,"pr":{"run":{"isPlaceholder":true}},"mt":"run","bl":10,"mm":"insert"},{"ty":"mp","bi":0,"ei":1,"pr":{"paragraph":{"pStyle":{"val":"rdbvau"},"snapToGrid":{"val":false},"jc":{"val":"STJcWml_left"},"rPr":{}}},"mt":"paragraph","bl":10},{"ty":"mp","bi":1,"ei":2,"pr":{"paragraph":{"snapToGrid":{"val":false},"spacing":{"line":312,"lineRule":"STLineSpacingRule_auto"},"rPr":{}}},"mt":"paragraph","bl":10},{"ty":"mp","bi":2,"ei":3,"pr":{"paragraph":{"isPlaceholder":true}},"mt":"paragraph","bl":10},{"ty":"mp","bi":3,"ei":4,"pr":{"paragraph":{"isPlaceholder":true}},"mt":"paragraph","bl":10},{"ty":"mp","bi":4,"ei":5,"pr":{"paragraph":{"isPlaceholder":true}},"mt":"paragraph","bl":10},{"ty":"mp","bi":5,"ei":6,"pr":{"paragraph":{"isPlaceholder":true}},"mt":"paragraph","bl":10},{"ty":"mp","bi":6,"ei":7,"pr":{"paragraph":{"isPlaceholder":true}},"mt":"paragraph","bl":10},{"ty":"mp","bi":7,"ei":8,"pr":{"paragraph":{"isPlaceholder":true}},"mt":"paragraph","bl":10},{"ty":"mp","bi":8,"ei":9,"pr":{"paragraph":{"isPlaceholder":true}},"mt":"paragraph","bl":10},{"ty":"mp","bi":9,"ei":10,"pr":{"paragraph":{"isPlaceholder":true}},"mt":"paragraph","bl":10},{"ty":"mp","bi":2,"ei":3,"pr":{"section":{"pgSz":{"w":11905,"h":16838},"pgMar":{"top":1361,"right":1417,"bottom":1361,"left":1417}}},"mt":"section","bl":10},{"ty":"mp","bi":3,"ei":4,"pr":{"story":{"storyType":"STStoryType_mainDocument"}},"mt":"story","bl":10},{"ty":"mp","bi":4,"ei":5,"pr":{"story":{"storyType":"STStoryType_headerContent"}},"mt":"story","bl":10},{"ty":"mp","bi":5,"ei":6,"pr":{"story":{"storyType":"STStoryType_footerContent"}},"mt":"story","bl":10},{"ty":"mp","bi":6,"ei":7,"pr":{"story":{"storyType":"STStoryType_footnoteContent"}},"mt":"story","bl":10},{"ty":"mp","bi":7,"ei":8,"pr":{"story":{"storyType":"STStoryType_endnoteContent"}},"mt":"story","bl":10},{"ty":"mp","bi":8,"ei":9,"pr":{"story":{"storyType":"STStoryType_commentContent"}},"mt":"story","bl":10},{"ty":"mp","bi":9,"ei":10,"pr":{"story":{"storyType":"STStoryType_textboxContent"}},"mt":"story","bl":10},{"ty":"ms","pr":{"numbering":{"abstractNum":{"ao0dk5":{"lvl":{"0":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"lvlJc":{"val":"STJcWml_left"},"pPr":{"ind":{"left":336,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":0},"1":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"lvlJc":{"val":"STJcWml_left"},"pPr":{"ind":{"left":776,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":1},"2":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"lvlJc":{"val":"STJcWml_left"},"pPr":{"ind":{"left":1216,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":2},"3":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"pPr":{"ind":{"left":1656,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":3},"4":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"pPr":{"ind":{"left":2096,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":4},"5":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"pPr":{"ind":{"left":2536,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":5},"6":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"pPr":{"ind":{"left":2976,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":6},"7":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"pPr":{"ind":{"left":3416,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":7}},"lvl_dict_op":{"opType":"Update"},"abstractNumId":"ao0dk5"},"41oo53":{"lvl":{"0":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_task"},"lvlText":{"val":""},"lvlJc":{"val":"STJcWml_left"},"pPr":{"ind":{"left":336,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":0}},"lvl_dict_op":{"opType":"Update"},"abstractNumId":"41oo53"},"kjngt5":{"lvl":{"0":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_task"},"lvlText":{"val":""},"lvlJc":{"val":"STJcWml_left"},"pPr":{"ind":{"left":336,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":0}},"lvl_dict_op":{"opType":"Update"},"abstractNumId":"kjngt5"},"2ehlck":{"lvl":{"0":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_task"},"lvlText":{"val":""},"lvlJc":{"val":"STJcWml_left"},"pPr":{"ind":{"left":336,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":0}},"lvl_dict_op":{"opType":"Update"},"abstractNumId":"2ehlck"},"wpigkh":{"lvl":{"0":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_task"},"lvlText":{"val":""},"lvlJc":{"val":"STJcWml_left"},"pPr":{"ind":{"left":336,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":0}},"lvl_dict_op":{"opType":"Update"},"abstractNumId":"wpigkh"},"49r3ke":{"lvl":{"0":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"lvlJc":{"val":"STJcWml_left"},"pPr":{"ind":{"left":336,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":0},"1":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"lvlJc":{"val":"STJcWml_left"},"pPr":{"ind":{"left":776,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":1},"2":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"lvlJc":{"val":"STJcWml_left"},"pPr":{"ind":{"left":1216,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":2},"3":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"pPr":{"ind":{"left":1656,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":3},"4":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"pPr":{"ind":{"left":2096,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":4},"5":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"pPr":{"ind":{"left":2536,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":5},"6":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"pPr":{"ind":{"left":2976,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":6},"7":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"pPr":{"ind":{"left":3416,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":7}},"lvl_dict_op":{"opType":"Update"},"abstractNumId":"49r3ke"}},"num":{"lscyt4":{"abstractNumId":{"val":"41oo53"},"numId":"lscyt4"},"xcqw22":{"abstractNumId":{"val":"wpigkh"},"numId":"xcqw22"},"rlopo3":{"abstractNumId":{"val":"kjngt5"},"numId":"rlopo3"},"31jv57":{"abstractNumId":{"val":"49r3ke"},"numId":"31jv57"},"zs1ng4":{"abstractNumId":{"val":"2ehlck"},"numId":"zs1ng4"},"pa8x7x":{"abstractNumId":{"val":"ao0dk5"},"numId":"pa8x7x"}}}},"mt":"numbering","bl":10},{"ty":"ms","pr":{"background":{}},"mt":"background","bl":10},{"ty":"ms","pr":{"themes":{}},"mt":"themes","bl":10},{"ty":"ms","pr":{"fonts":{}},"mt":"fonts","bl":10},{"ty":"ms","pr":{"styles":{"docDefaults":{"rPrDefault":{"rPr":{"color":{"val":"333333"},"kern":{"val":20},"sz":{"val":220},"szCs":{"val":220}}},"pPrDefault":{"pPr":{"snapToGrid":{"val":false},"spacing":{"before":60,"after":60,"line":312,"lineRule":"STLineSpacingRule_auto"}}}},"style":{"gtv8xu":{"name":{"val":"melo-codeblock-Base-theme-para"},"basedOn":{"val":"ablt93"},"next":{"val":""},"pPr":{"spacing":{"before":0,"after":0,"line":360,"lineRule":"STLineSpacingRule_auto"}},"rPr":{"rFonts":{"ascii":"Monaco","hAnsi":"Monaco","eastAsia":"Monaco","cs":"Monaco"},"color":{"val":"000000"},"sz":{"val":210}},"type":"STStyleType_paragraph","styleId":"gtv8xu"},"x2bstg":{"name":{"val":"Table Grid"},"basedOn":{"val":"f2xm7p"},"next":{"val":""},"uiPriority":{"val":39},"tblPr":{"tblBorders":{"top":{"val":"STBorder_single","color":"CBCDD1","sz":6,"space":0},"left":{"val":"STBorder_single","color":"CBCDD1","sz":6,"space":0},"bottom":{"val":"STBorder_single","color":"CBCDD1","sz":6,"space":0},"right":{"val":"STBorder_single","color":"CBCDD1","sz":6,"space":0},"insideH":{"val":"STBorder_single","color":"CBCDD1","sz":6,"space":0},"insideV":{"val":"STBorder_single","color":"CBCDD1","sz":6,"space":0}}},"tcPr":{"vAlign":{"val":"STVerticalJc_center"}},"type":"STStyleType_table","styleId":"x2bstg"},"rdbvau":{"name":{"val":"Title"},"basedOn":{"val":"ablt93"},"next":{"val":"ablt93"},"uiPriority":{"val":9},"qFormat":{"val":true},"pPr":{"keepNext":{"val":true},"keepLines":{"val":true},"spacing":{"before":0,"after":0,"line":408,"lineRule":"STLineSpacingRule_auto"},"jc":{"val":"STJcWml_center"},"outlineLvl":{"val":0}},"rPr":{"b":{"val":true},"bCs":{"val":true},"color":{"val":"1A1A1A"},"sz":{"val":480},"szCs":{"val":480}},"type":"STStyleType_paragraph","styleId":"rdbvau"},"4omzjh":{"name":{"val":"Hyperlink"},"basedOn":{"val":"cy8bde"},"next":{"val":""},"uiPriority":{"val":99},"unhideWhenUsed":{"val":true},"rPr":{"color":{"val":"1E6FFF","themeColor":"STThemeColor_hyperlink"},"u":{"val":"STUnderline_single"}},"type":"STStyleType_character","styleId":"4omzjh"},"f2xm7p":{"name":{"val":"Normal Table"},"basedOn":{"val":""},"next":{"val":""},"uiPriority":{"val":99},"semiHidden":{"val":true},"unhideWhenUsed":{"val":true},"tblPr":{"tblInd":{"w":0,"type":"STTblWidth_dxa"},"tblCellMar":{"top":{"w":0,"type":"STTblWidth_dxa"},"left":{"w":108,"type":"STTblWidth_dxa"},"bottom":{"w":0,"type":"STTblWidth_dxa"},"right":{"w":108,"type":"STTblWidth_dxa"}}},"type":"STStyleType_table","styleId":"f2xm7p","defaultKeyword":true},"z2xbei":{"name":{"val":"heading 1"},"basedOn":{"val":"ablt93"},"next":{"val":"ablt93"},"uiPriority":{"val":9},"qFormat":{"val":true},"pPr":{"keepNext":{"val":true},"keepLines":{"val":true},"spacing":{"before":0,"after":0,"line":408,"lineRule":"STLineSpacingRule_auto"},"outlineLvl":{"val":0}},"rPr":{"b":{"val":true},"bCs":{"val":true},"color":{"val":"1A1A1A"},"sz":{"val":360},"szCs":{"val":360}},"type":"STStyleType_paragraph","styleId":"z2xbei"},"cy8bde":{"name":{"val":"Default Paragraph Font"},"basedOn":{"val":""},"next":{"val":""},"uiPriority":{"val":1},"semiHidden":{"val":true},"unhideWhenUsed":{"val":true},"type":"STStyleType_character","styleId":"cy8bde","defaultKeyword":true},"ablt93":{"name":{"val":"Normal"},"pPr":{"widowControl":{"val":false},"jc":{"val":"STJcWml_left"}},"type":"STStyleType_paragraph","styleId":"ablt93","defaultKeyword":true},"3lkwia":{"name":{"val":"melo-codeblock-Base-theme-char"},"basedOn":{"val":""},"next":{"val":""},"rPr":{"rFonts":{"ascii":"Monaco","hAnsi":"Monaco","eastAsia":"Monaco","cs":"Monaco"},"color":{"val":"000000"},"sz":{"val":210}},"type":"STStyleType_character","styleId":"3lkwia"}}}},"mt":"styles","bl":10},{"ty":"ms","pr":{"settings":{}},"mt":"settings","bl":10},{"ty":"ms","pr":{"webSettings":{}},"mt":"webSettings","bl":10}]}]}';function l(e){var t,n,l=e.secretId,u=e.globalPadId,d=e.dver,p=e.title,h=(0,a.getUid)(),f=null!==(n=null!==(t=u.split("$")[1])&&void 0!==t?t:u)&&void 0!==n?n:"";return{accountPrivs:{},advPolicy:{},cdn:"",clientIp:"",collab_client_vars:{apid:{},apool:{numToAttrib:{},nextNum:1},bad:-1,client:{upid:l,sig:"",tid:-1,sid:""},dirty:-1,dver:d,globalPadId:u,gray:-1,header:[],isChunked:!1,initialAttributedText:{wbMutationMsg:"",text:c,attribs:""},padId:f,padSubId:"BB08J2",padType:"doc",pollingAttemptNumber:-1,pos:1,pver:2,rev:0,ver:2147483647,websocket:!1,websocketReopenCount:-1,wmode:"wb"},colorPalette:[],creatorDomain:"300000000",creatorId:"",disableFB:!1,docStatus:-1,domainId:"300000000",dropboxConnected:!1,encrypted:"",envi:null,friendUserIds:[],globalPadId:u,initialOptions:{},initialRevisionList:[],initialTitle:"",invitedGroupInfos:[],invitedUserInfos:[],isCreator:!0,isDesktopApp:!1,isEmbed:!1,isIPad:o.t.isIPad(),isIPhone:!1,isLocalDoc:!0,isLogin:!0,isMac:!1,isMobile:o.t.isMobile(),isMobileApp:!1,isNewProject:!1,isOpendocxfromTim:!1,isOverConNum:!1,isOwner:!0,isPadAdmin:!1,isProPad:!1,isPublicPad:!1,isTIM:!1,isTimDomain:!1,isTimOnline:!1,isUserChangeTitle:p?1:-1,localPadId:f,newOpenSvc:-1,ownerAppid:"",ownerId:"",padId:f,originalUrl:"",padTitle:p||(0,s.$t)(""),padType:"doc",padStatus:i.DL.LOCAL,pagingFlag:"",policy:0,personalizeInfo:{background:{id:"",transparency:0},mode:0},privilegeAttribute:{can_about:1,can_add_user:1,can_apply_edit:1,can_comment:1,can_copy:1,can_copy_doc:1,can_edit:1,can_edit_title:1,can_history:1,can_link_exp:1,can_print:1,can_read:1,can_search:1,can_share:1,can_spit_slot:1,can_translate:1,can_view_image:1,can_watermark:1,is_auth:1,can_export:1},privilegeExpire:-1,proTitle:"",rightFlag:4294967295,shortLink:"",shouldGetFbLoginStatus:!1,siteName:"",titleIsReadOnly:!1,uin:r.get("uin"),useFbChat:!1,userColor:-1,userDomain:"",userId:"p.".concat(h),userInfo:{},userIsGuest:!1,userLink:"",userName:"",userPic:"",userType:"",xsrf:"",metaCreateTime:15489504e5,lastModifyTime:15489504e5,lastModifyUser:""}}},48069:function(e,t,n){n.d(t,{GB:function(){return r},YG:function(){return u},eH:function(){return l},f$:function(){return d},iH:function(){return c},vr:function(){return s}});var r,o,i=n(38429),a=n(82132);function s(e){i.kE&&(e===r.show&&a.r.getInstance().isLocalFileChange||window.mqq.invoke("docx","updateLocalFileBottomBarState",{state:e}))}function c(e){window.tdocs.setActionButtons({buttons:e})}function l(){window.mqq.invoke("docx","requestFocus",{})}function u(e,t){window.mqq.invoke("nav","notifyOpenLocalFileResult",{errorCode:e?o.Success:o.Fail,errorMsg:t})}function d(e){window.mqq.invoke("docx","loginToOpenUrl",{file:e,close:!0})}!function(e){e[e.show=0]="show",e[e.hide=1]="hide"}(r||(r={})),function(e){e[e.Success=0]="Success",e[e.Fail=1]="Fail"}(o||(o={}))},82132:function(e,t,n){n.d(t,{r:function(){return b}});var r=n(85556),o=n(9419),i=n(82959),a=n(38429),s=n(39445),c=n(17908),l=n(19105),u=n(30479),d={can_about:1,can_add_user:0,can_comment:1,can_apply_edit:0,can_copy:1,can_copy_doc:0,can_edit:0,can_edit_title:0,can_history:0,can_link_exp:0,can_print:1,can_read:1,can_search:1,can_share:1,can_spit_slot:1,can_translate:1,can_view_image:1,can_watermark:0,is_auth:0,can_export:0},p="3.0.0",h=n(54472),f=n(3474),g=n(2613),v=n(31218),y=n(3139),m=n(42035),b=function(){function e(){this.isTriggerFileSave=!1,this.isLocalFileChange=!1,this.isInSaving=!1,this.initEvent()}var t;return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.initLocalEdit=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return a.kE?this.localEditService=i.v.getInstance():this.localEditService=o.K.getInstance(),this.localEditService.init(),this.initModuleConfig(),[4,this.initEditChannel()];case 1:return e.sent(),[2]}}))}))},e.prototype.saveDoc=function(e,t,n){return(0,r.__awaiter)(this,void 0,Promise,(function(){var o=this;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return this.isLocalFileChange||this.eventEmitter.emit("$editorStateChange",v.EditorState.STATE_VIEW),this.isInSaving||!this.isLocalFileChange&&t===f.V4.Save?[2]:(this.isInSaving=!0,[4,this.localEditService.saveDoc(e,{onJSONSaved:function(){var e;u.Logger.info("saveDoc onJSONSaved"),null===(e=n.onJSONSaved)||void 0===e||e.call(n)},onDocumentSaved:function(){var e;o.isTriggerFileSave=!0,o.isInSaving=!1,o.syncLocalEditStatus(!1),null===(e=n.onDocumentSaved)||void 0===e||e.call(n)},onCancel:function(){var e;u.Logger.info("saveDoc onCancel"),o.isInSaving=!1,null===(e=n.onCancel)||void 0===e||e.call(n)},onConverterError:function(){var e;u.Logger.info("saveDoc onConverterError"),o.isInSaving=!1,null===(e=n.onConverterError)||void 0===e||e.call(n)},onDesktopError:function(){var e;u.Logger.info("saveDoc onDesktopError"),o.isInSaving=!1,null===(e=n.onDesktopError)||void 0===e||e.call(n)}},t)]);case 1:return r.sent(),[2]}}))}))},e.prototype.getLocalClientVars=function(){var e=this;return Promise.resolve().then((function(){return a.YT?'[{"commands":[{"type":"DocKeyframe","mutations":[{"ty":"is","bi":0,"s":"\\r\\r\\u000f\\u001e\\u001e\\u001e\\u001e\\u001e\\u001e\\u001e","bl":0},{"ty":"mp","bi":0,"ei":1,"pr":{"run":{"author":"p.144115210468732521","isPlaceholder":true}},"mt":"run","bl":10},{"ty":"mp","bi":1,"ei":2,"pr":{"run":{"author":"p.144115210468732521","isPlaceholder":true}},"mt":"run","bl":10},{"ty":"mp","bi":2,"ei":3,"pr":{"run":{"isPlaceholder":true}},"mt":"run","bl":10},{"ty":"mp","bi":3,"ei":4,"pr":{"run":{"isPlaceholder":true}},"mt":"run","bl":10},{"ty":"mp","bi":4,"ei":5,"pr":{"run":{"isPlaceholder":true}},"mt":"run","bl":10},{"ty":"mp","bi":5,"ei":6,"pr":{"run":{"isPlaceholder":true}},"mt":"run","bl":10},{"ty":"mp","bi":6,"ei":7,"pr":{"run":{"isPlaceholder":true}},"mt":"run","bl":10},{"ty":"mp","bi":7,"ei":8,"pr":{"run":{"isPlaceholder":true}},"mt":"run","bl":10},{"ty":"mp","bi":8,"ei":9,"pr":{"run":{"isPlaceholder":true}},"mt":"run","bl":10},{"ty":"mp","bi":9,"ei":10,"pr":{"run":{"isPlaceholder":true}},"mt":"run","bl":10},{"ty":"mp","bi":0,"ei":1,"pr":{"paragraph":{"pStyle":{"val":"rdbvau"},"snapToGrid":{"val":false},"jc":{"val":"STJcWml_left"},"rPr":{}}},"mt":"paragraph","bl":10},{"ty":"mp","bi":1,"ei":2,"pr":{"paragraph":{"snapToGrid":{"val":false},"spacing":{"line":312,"lineRule":"STLineSpacingRule_auto"},"rPr":{}}},"mt":"paragraph","bl":10},{"ty":"mp","bi":2,"ei":3,"pr":{"paragraph":{"isPlaceholder":true}},"mt":"paragraph","bl":10},{"ty":"mp","bi":3,"ei":4,"pr":{"paragraph":{"isPlaceholder":true}},"mt":"paragraph","bl":10},{"ty":"mp","bi":4,"ei":5,"pr":{"paragraph":{"isPlaceholder":true}},"mt":"paragraph","bl":10},{"ty":"mp","bi":5,"ei":6,"pr":{"paragraph":{"isPlaceholder":true}},"mt":"paragraph","bl":10},{"ty":"mp","bi":6,"ei":7,"pr":{"paragraph":{"isPlaceholder":true}},"mt":"paragraph","bl":10},{"ty":"mp","bi":7,"ei":8,"pr":{"paragraph":{"isPlaceholder":true}},"mt":"paragraph","bl":10},{"ty":"mp","bi":8,"ei":9,"pr":{"paragraph":{"isPlaceholder":true}},"mt":"paragraph","bl":10},{"ty":"mp","bi":9,"ei":10,"pr":{"paragraph":{"isPlaceholder":true}},"mt":"paragraph","bl":10},{"ty":"mp","bi":2,"ei":3,"pr":{"section":{"pgSz":{"w":11905,"h":16838},"pgMar":{"top":1361,"right":1417,"bottom":1361,"left":1417}}},"mt":"section","bl":10},{"ty":"mp","bi":3,"ei":4,"pr":{"story":{"storyType":"STStoryType_mainDocument"}},"mt":"story","bl":10},{"ty":"mp","bi":4,"ei":5,"pr":{"story":{"storyType":"STStoryType_headerContent"}},"mt":"story","bl":10},{"ty":"mp","bi":5,"ei":6,"pr":{"story":{"storyType":"STStoryType_footerContent"}},"mt":"story","bl":10},{"ty":"mp","bi":6,"ei":7,"pr":{"story":{"storyType":"STStoryType_footnoteContent"}},"mt":"story","bl":10},{"ty":"mp","bi":7,"ei":8,"pr":{"story":{"storyType":"STStoryType_endnoteContent"}},"mt":"story","bl":10},{"ty":"mp","bi":8,"ei":9,"pr":{"story":{"storyType":"STStoryType_commentContent"}},"mt":"story","bl":10},{"ty":"mp","bi":9,"ei":10,"pr":{"story":{"storyType":"STStoryType_textboxContent"}},"mt":"story","bl":10},{"ty":"ms","pr":{"numbering":{"abstractNum":{"49r3ke":{"lvl":{"0":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"lvlJc":{"val":"STJcWml_left"},"pPr":{"ind":{"left":336,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":0},"1":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"lvlJc":{"val":"STJcWml_left"},"pPr":{"ind":{"left":776,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":1},"2":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"lvlJc":{"val":"STJcWml_left"},"pPr":{"ind":{"left":1216,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":2},"3":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"pPr":{"ind":{"left":1656,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":3},"4":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"pPr":{"ind":{"left":2096,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":4},"5":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"pPr":{"ind":{"left":2536,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":5},"6":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"pPr":{"ind":{"left":2976,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":6},"7":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"pPr":{"ind":{"left":3416,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":7}},"lvl_dict_op":{"opType":"Update"},"abstractNumId":"49r3ke"},"41oo53":{"lvl":{"0":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_task"},"lvlText":{"val":""},"lvlJc":{"val":"STJcWml_left"},"pPr":{"ind":{"left":336,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":0}},"lvl_dict_op":{"opType":"Update"},"abstractNumId":"41oo53"},"ao0dk5":{"lvl":{"0":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"lvlJc":{"val":"STJcWml_left"},"pPr":{"ind":{"left":336,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":0},"1":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"lvlJc":{"val":"STJcWml_left"},"pPr":{"ind":{"left":776,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":1},"2":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"lvlJc":{"val":"STJcWml_left"},"pPr":{"ind":{"left":1216,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":2},"3":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"pPr":{"ind":{"left":1656,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":3},"4":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"pPr":{"ind":{"left":2096,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":4},"5":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"pPr":{"ind":{"left":2536,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":5},"6":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"pPr":{"ind":{"left":2976,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":6},"7":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"pPr":{"ind":{"left":3416,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":7}},"lvl_dict_op":{"opType":"Update"},"abstractNumId":"ao0dk5"},"wpigkh":{"lvl":{"0":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_task"},"lvlText":{"val":""},"lvlJc":{"val":"STJcWml_left"},"pPr":{"ind":{"left":336,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":0}},"lvl_dict_op":{"opType":"Update"},"abstractNumId":"wpigkh"},"kjngt5":{"lvl":{"0":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_task"},"lvlText":{"val":""},"lvlJc":{"val":"STJcWml_left"},"pPr":{"ind":{"left":336,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":0}},"lvl_dict_op":{"opType":"Update"},"abstractNumId":"kjngt5"},"2ehlck":{"lvl":{"0":{"start":{"val":1},"numFmt":{"val":"STNumberFormat_task"},"lvlText":{"val":""},"lvlJc":{"val":"STJcWml_left"},"pPr":{"ind":{"left":336,"hanging":336}},"rPr":{"rFonts":{"hint":"STHint_default","ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}},"ilvl":0}},"lvl_dict_op":{"opType":"Update"},"abstractNumId":"2ehlck"}},"num":{"zs1ng4":{"abstractNumId":{"val":"2ehlck"},"numId":"zs1ng4"},"pa8x7x":{"abstractNumId":{"val":"ao0dk5"},"numId":"pa8x7x"},"rlopo3":{"abstractNumId":{"val":"kjngt5"},"numId":"rlopo3"},"31jv57":{"abstractNumId":{"val":"49r3ke"},"numId":"31jv57"},"xcqw22":{"abstractNumId":{"val":"wpigkh"},"numId":"xcqw22"},"lscyt4":{"abstractNumId":{"val":"41oo53"},"numId":"lscyt4"}}}},"mt":"numbering","bl":10},{"ty":"ms","pr":{"background":{}},"mt":"background","bl":10},{"ty":"ms","pr":{"themes":{}},"mt":"themes","bl":10},{"ty":"ms","pr":{"fonts":{}},"mt":"fonts","bl":10},{"ty":"ms","pr":{"styles":{"docDefaults":{"rPrDefault":{"rPr":{"color":{"val":"333333"},"kern":{"val":20},"sz":{"val":220},"szCs":{"val":220}}},"pPrDefault":{"pPr":{"snapToGrid":{"val":false},"spacing":{"before":60,"after":60,"line":312,"lineRule":"STLineSpacingRule_auto"}}}},"style":{"f2xm7p":{"name":{"val":"Normal Table"},"basedOn":{"val":""},"next":{"val":""},"uiPriority":{"val":99},"semiHidden":{"val":true},"unhideWhenUsed":{"val":true},"tblPr":{"tblInd":{"w":0,"type":"STTblWidth_dxa"},"tblCellMar":{"top":{"w":0,"type":"STTblWidth_dxa"},"left":{"w":108,"type":"STTblWidth_dxa"},"bottom":{"w":0,"type":"STTblWidth_dxa"},"right":{"w":108,"type":"STTblWidth_dxa"}}},"type":"STStyleType_table","styleId":"f2xm7p","defaultKeyword":true},"rdbvau":{"name":{"val":"Title"},"basedOn":{"val":"ablt93"},"next":{"val":"ablt93"},"uiPriority":{"val":9},"qFormat":{"val":true},"pPr":{"keepNext":{"val":true},"keepLines":{"val":true},"spacing":{"before":0,"after":0,"line":408,"lineRule":"STLineSpacingRule_auto"},"jc":{"val":"STJcWml_center"},"outlineLvl":{"val":0}},"rPr":{"b":{"val":true},"bCs":{"val":true},"color":{"val":"1A1A1A"},"sz":{"val":480},"szCs":{"val":480}},"type":"STStyleType_paragraph","styleId":"rdbvau"},"4omzjh":{"name":{"val":"Hyperlink"},"basedOn":{"val":"cy8bde"},"next":{"val":""},"uiPriority":{"val":99},"unhideWhenUsed":{"val":true},"rPr":{"color":{"val":"1E6FFF","themeColor":"STThemeColor_hyperlink"},"u":{"val":"STUnderline_single"}},"type":"STStyleType_character","styleId":"4omzjh"},"x2bstg":{"name":{"val":"Table Grid"},"basedOn":{"val":"f2xm7p"},"next":{"val":""},"uiPriority":{"val":39},"tblPr":{"tblBorders":{"top":{"val":"STBorder_single","color":"CBCDD1","sz":6,"space":0},"left":{"val":"STBorder_single","color":"CBCDD1","sz":6,"space":0},"bottom":{"val":"STBorder_single","color":"CBCDD1","sz":6,"space":0},"right":{"val":"STBorder_single","color":"CBCDD1","sz":6,"space":0},"insideH":{"val":"STBorder_single","color":"CBCDD1","sz":6,"space":0},"insideV":{"val":"STBorder_single","color":"CBCDD1","sz":6,"space":0}}},"tcPr":{"vAlign":{"val":"STVerticalJc_center"}},"type":"STStyleType_table","styleId":"x2bstg"},"cy8bde":{"name":{"val":"Default Paragraph Font"},"basedOn":{"val":""},"next":{"val":""},"uiPriority":{"val":1},"semiHidden":{"val":true},"unhideWhenUsed":{"val":true},"type":"STStyleType_character","styleId":"cy8bde","defaultKeyword":true},"gtv8xu":{"name":{"val":"melo-codeblock-Base-theme-para"},"basedOn":{"val":"ablt93"},"next":{"val":""},"pPr":{"spacing":{"before":0,"after":0,"line":360,"lineRule":"STLineSpacingRule_auto"}},"rPr":{"rFonts":{"ascii":"Monaco","hAnsi":"Monaco","eastAsia":"Monaco","cs":"Monaco"},"color":{"val":"000000"},"sz":{"val":210}},"type":"STStyleType_paragraph","styleId":"gtv8xu"},"z2xbei":{"name":{"val":"heading 1"},"basedOn":{"val":"ablt93"},"next":{"val":"ablt93"},"uiPriority":{"val":9},"qFormat":{"val":true},"pPr":{"keepNext":{"val":true},"keepLines":{"val":true},"spacing":{"before":0,"after":0,"line":408,"lineRule":"STLineSpacingRule_auto"},"outlineLvl":{"val":0}},"rPr":{"b":{"val":true},"bCs":{"val":true},"color":{"val":"1A1A1A"},"sz":{"val":360},"szCs":{"val":360}},"type":"STStyleType_paragraph","styleId":"z2xbei"},"3lkwia":{"name":{"val":"melo-codeblock-Base-theme-char"},"basedOn":{"val":""},"next":{"val":""},"rPr":{"rFonts":{"ascii":"Monaco","hAnsi":"Monaco","eastAsia":"Monaco","cs":"Monaco"},"color":{"val":"000000"},"sz":{"val":210}},"type":"STStyleType_character","styleId":"3lkwia"},"ablt93":{"name":{"val":"Normal"},"pPr":{"widowControl":{"val":false},"jc":{"val":"STJcWml_left"}},"type":"STStyleType_paragraph","styleId":"ablt93","defaultKeyword":true}}}},"mt":"styles","bl":10},{"ty":"ms","pr":{"settings":{}},"mt":"settings","bl":10},{"ty":"ms","pr":{"webSettings":{}},"mt":"webSettings","bl":10}]}]}]':e.loadDoc()})).then((function(e){var t=a.kE?function(e){var t=(0,c.d)({globalPadId:(0,u.getUrlParameter)("globalPadId")||"",secretId:(0,s.pb)(),dver:p,title:(0,l.Jj)()}),n=(0,l.z)();if(null==n?void 0:n.login){var r=n.uin,o=n.uid,i=n.avatar,a=n.nick,d=n.login_type;t.uin="".concat(r),t.userId=o?"p.".concat(o):"",t.userPic=i,t.userName=a,(0,l.zb)(n,{utype:1===d?"qq":"wx"})}else t.isLogin=!1;return t.collab_client_vars.initialAttributedText.text=e,t}(e):function(e){var t,n,r,o,i,a=(0,c.d)({globalPadId:(0,u.getUrlParameter)("globalPadId")||"",secretId:(0,s.pb)(),dver:p,title:(0,l.Jj)()});if((null===(n=null===(t=window.basicClientVars)||void 0===t?void 0:t.userInfo)||void 0===n?void 0:n.tinyId)||(a.isLogin=!1,a.privilegeAttribute=d),a.collab_client_vars.initialAttributedText.text=e,null===(r=window.desktopInfo)||void 0===r?void 0:r.onlineUserInfo){var h=window.desktopInfo.onlineUserInfo,f=h.uin,g=h.uid;a.uin="".concat(f),a.userId=g?"p.".concat(g):"",a.userInfo=(0,l.zb)(null===(o=window.desktopInfo)||void 0===o?void 0:o.onlineUserInfo,null===(i=window.desktopInfo)||void 0===i?void 0:i.account)}return a}(e);return t}))},e.prototype.syncLocalEditStatus=function(e){this.isLocalFileChange=e,this.localEditService.syncLocalEditStatus(e)},e.prototype.loadDoc=function(){return(0,r.__awaiter)(this,void 0,Promise,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.localEditService.loadLocalDoc({onData:function(){u.Logger.info("onData")}})];case 1:return[2,e.sent()]}}))}))},e.prototype.initEditChannel=function(){return(0,r.__awaiter)(this,void 0,Promise,(function(){var e=this;return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.localEditService.initEditChannelAndTitle({onSaveDoc:function(t,n){var r=window.pad.editor.generateDocumentKeyFrame();e.saveDoc(r,t,null!=n?n:{})}})];case 1:return t.sent(),[2]}}))}))},e.prototype.initModuleConfig=function(){h.x.setNeedInitOffline(!1),h.x.setNeedInitCollabCenter(!1)},e.prototype.initEvent=function(){var e=this;window.document.addEventListener(g.RenderNotificationTypes.FIRST_RENDER,(function(){var t;null===(t=e.localEditService)||void 0===t||t.reportFinishDisplay()}))},(0,r.__decorate)([(0,y.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==m.v&&m.v)?t:Object)],e.prototype,"eventEmitter",void 0),e}()},82959:function(e,t,n){n.d(t,{v:function(){return ae}});var r,o=n(85556),i=n(24282),a=n(3474);!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.Form=2]="Form",e[e.Slide=4]="Slide",e[e.PDF=6]="PDF"}(r||(r={}));var s=n(30479),c=n(19105),l=n(29382),u=n(14740),d=n(89890),p=n(85235),h=n(14366),f=n(49098),g=n.n(f);const v="localServerChanged";class y{constructor(){this.localServerPromise=Promise.resolve(""),this.initLocalServer(),document.addEventListener(v,(()=>this.initLocalServer()))}get(e,t={},n={}){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.getAPIPath(e);return h.Z.get(r,Object.assign({params:t,paramsSerializer:e=>g().stringify(e)},n)).then((e=>e.data))}))}getFile(e,t={}){return(0,o.__awaiter)(this,void 0,void 0,(function*(){let n=yield this.get(e,t,{responseType:"arraybuffer"});try{const e=new TextDecoder("utf-8");return n=JSON.parse(e.decode(new Uint8Array(n))),n}catch(e){return{code:0,data:n}}}))}post(e,t,n,r){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const o=yield this.getAPIPath(e);return(0,h.Z)(o,{headers:r||{"Content-Type":"application/json; charset=UTF-8"},method:"POST",data:t,params:n}).then((e=>e.data))}))}initLocalServer(){var e;if(!(null===(e=window.mqq)||void 0===e?void 0:e.invoke))throw new Error("window.mqq is not exist");this.localServerPromise=new Promise((e=>{window.mqq.invoke("docx","getLocalServer",{},(t=>{e(t.data)}))}))}getAPIPath(e){var t;return(0,o.__awaiter)(this,void 0,void 0,(function*(){return`${/(iphone|ipad|ipod)/i.test(null===(t=null===window||void 0===window?void 0:window.navigator)||void 0===t?void 0:t.userAgent)?"https":"http"}://${yield this.localServerPromise}${e}`}))}}class m{constructor(e){this.fire=()=>{},this.token=m.createToken(),this.transport=e,m.channels.set(this.token,this)}static createToken(){return this.token+=1,this.token}static get(e){return this.channels.get(e)}subscribe(e,t){if(this.isClosed())throw new Error("channel is closed");this.transport.subscribe(this.token,e,t)}publish(e,...t){if(this.isClosed())throw new Error("channel is closed");this.transport.publish({token:this.token,eventName:e,args:t})}close(){m.channels.delete(this.token),this.transport.unsubscribe(this.token)}isClosed(){return!m.channels.has(this.token)}}m.token=0,m.channels=new Map;var b=m;const _="/local-edit/fileStat",C="/local-edit/loadFile",S="/local-edit/saveFile";var w=class{constructor(e){this.version=1,this.apis=["stat"],this.channels=["save","load"],this.supportedExtnames=["pdf"],this.stat=e=>(0,o.__awaiter)(this,void 0,void 0,(function*(){const{filePath:t}=e;if(!this.checkIfExtnameSupported(t))return{err:{type:a.Qg.NotSupported,message:` ${this.supportedExtnames.join("/")} `},data:null};try{const{code:t,message:n,data:r}=yield this.localServer.get(_,e);return 0!==t?{err:{type:a.Qg.StatError,message:`code: ${t}, message: ${n}`},data:null}:{err:null,data:r}}catch(e){return{err:{type:a.Qg.StatError,message:e.message},data:null}}})),this.localServer=new y,this.transport=e}load(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const{filePath:t,size:n}=e,r=new b(this.transport);if(!this.checkIfExtnameSupported(t))throw new Error(` ${this.supportedExtnames.join("/")} `);return r.subscribe(a.GM.Next,((e,i)=>(0,o.__awaiter)(this,void 0,void 0,(function*(){const o=Math.min(n-e,i);try{const n=yield this.localServer.getFile(C,{filePath:t,offset:e,length:o});if(0!==n.code)throw new Error(`api fail code: ${n.code}`);r.publish(a.GM.Chunk,e,o,n.data)}catch(e){r.publish(a.GM.Error,e.message)}})))),r.subscribe(a.GM.End,(()=>{r.close()})),Promise.resolve(r)}))}save(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=new b(this.transport);return this.saveFile(t,e),Promise.resolve(t)}))}showItemInFolder(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){throw new Error("Method not implemented.")}))}saveFile(e,t){return(0,o.__awaiter)(this,void 0,void 0,(function*(){try{const{newPath:n,newTitle:r}=yield this.localServer.post(S,t);e.publish(a.SH.Saved,n,r)}catch(t){e.publish(a.SH.Error,JSON.stringify(t))}}))}checkIfExtnameSupported(e){const t=e.split(".").pop();return!!t&&this.supportedExtnames.includes(t)}};const E="/local-edit/loadDocx",x="/local-edit/saveDocx",T="/local-edit/report",R="/local-edit/chunkImport";var I=class{constructor(e){this.version=1,this.apis=["report"],this.channels=["load","save","edit"],this.report=(e,t)=>(0,o.__awaiter)(this,void 0,void 0,(function*(){this.localServer.post(T,Object.assign(Object.assign({},e),{action:t}))})),this.fetchBackups=e=>{throw new Error("Method not implemented.")},this.fetchVersionMap=e=>{throw new Error("Method not implemented.")},this.removeVersion=(e,t)=>{throw new Error("Method not implemented.")},this.startChunkLoad=(e,t,n)=>(0,o.__awaiter)(this,void 0,void 0,(function*(){let r=0,i=0,s=!1;const c=t.chunkSize||1;try{const{code:l,data:u,total:d,message:p}=yield this.chunkImport(Object.assign(Object.assign({},t),{chunkIndex:i,chunkSize:1}));if(r=d,i+=1,s=i+c>=r,!n&&(l===a.iP.kPasswordRequired||l===a.iP.kInvalidPassword))return void e.subscribe(a.DB.ContinueWithPassword,(n=>{this.startChunkLoad(e,Object.assign(Object.assign({},t),{password:n}),!0)}));e.subscribe(a.DB.NextChunkData,(()=>(0,o.__awaiter)(this,void 0,void 0,(function*(){if(i>=r)return;const{code:n,message:o,data:l}=yield this.chunkImport(Object.assign(Object.assign({},t),{chunkIndex:i,chunkSize:c,isFinish:s?1:0}));if(0!==n)throw{code:n,message:o};e.publish(a.DB.ChunkData,l,i,s),i+=1,s=i+c>=r})))),0===l?e.publish(a.DB.Data,u):e.publish(a.DB.MobileError,l,p)}catch(t){e.publish(a.DB.MobileError,(null==t?void 0:t.code)||a.iP.ErrorUnknown,(null==t?void 0:t.message)||String(t))}})),this.localServer=new y,this.transport=e}load(e){const t=new b(this.transport);return e.enableChunkImport?this.startChunkLoad(t,e):this.startLoad(t,e),Promise.resolve(t)}save(e,t){const n=new b(this.transport);return this.startSave(n,e,t),Promise.resolve(n)}edit(e){const t=new b(this.transport);return t.subscribe(a.SZ.ContentModified,((e,t)=>{var n,r;null===(r=(n=window.mqq).invoke)||void 0===r||r.call(n,"docx","localEditStatus",{isModified:e,title:t})})),Promise.resolve(t)}startLoad(e,t,n){return(0,o.__awaiter)(this,void 0,void 0,(function*(){try{const{code:r,data:o,message:i}=yield this.localServer.get(E,t);if(0===r)return void e.publish(a.DB.Data,o);n||r!==a.iP.kPasswordRequired&&r!==a.iP.kInvalidPassword||e.subscribe(a.DB.ContinueWithPassword,(n=>{this.startLoad(e,Object.assign(Object.assign({},t),{password:n}),!0)})),e.publish(a.DB.MobileError,r,i)}catch(t){e.publish(a.DB.MobileError,a.iP.ErrorUnknown,String(t))}}))}chunkImport(e,t=0){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.localServer.get(R,e);return(null==n?void 0:n.code)===a.iP.kSlideChunkPageEmptyError&&t<10?(t+=1,yield new Promise((e=>setTimeout(e,500))),this.chunkImport(e,t)):n}))}startSave(e,t,n){return(0,o.__awaiter)(this,void 0,void 0,(function*(){try{const{convertDir:r,newPath:o,newTitle:i,newGlobalPadId:s,code:c,message:l}=yield this.localServer.post(x,Object.assign(Object.assign({},t),{saveType:n}));0===c?(e.publish(a.J_.JSONSaved,r),e.publish(a.J_.DocumentSaved,o,i,s)):e.publish(a.J_.MobileError,c,l)}catch(t){e.publish(a.J_.MobileError,a.U9.ErrorUnknown,String(t))}}))}};const P="/local-edit/uploadImage",O="/local-edit/downloadImage";var k,D=class{constructor(e){this.version=1,this.channels=["uploadImage","downloadImage"],this.localServer=new y,this.transport=e}uploadImage(e){const t=new b(this.transport);return this.startUploadImage(t,e),Promise.resolve(t)}downloadImage(e){const t=new b(this.transport);return this.startDownloadImage(t,e),Promise.resolve(t)}isMediaURI(e){throw new Error("Method not implemented.")}getLocationFromMediaURI(e){throw new Error("Method not implemented.")}getFileURLFromMediaURI(e){throw new Error("Method not implemented.")}startUploadImage(e,t){return(0,o.__awaiter)(this,void 0,void 0,(function*(){try{const{code:n,message:r,data:o}=yield this.localServer.post(P,t.data,t.params,{"Content-Type":"multipart/form-data"});n&&0!==n?e.publish(a.xn.MediaError,n,r):e.publish(a.xn.UploadImageData,o)}catch(t){e.publish(a.xn.MediaError,a.lG.ErrorUnknown,String(t))}}))}startDownloadImage(e,t){return(0,o.__awaiter)(this,void 0,void 0,(function*(){try{const{code:n,message:r,data:o}=yield this.localServer.get(O,t);n&&0!==n?e.publish(a.xn.MediaError,n,r):e.publish(a.xn.DownloadImageData,o)}catch(t){e.publish(a.xn.MediaError,a.lG.ErrorUnknown,String(t))}}))}},M=n(13861),A=class{constructor(){this.eventEmitterMap=new Map,this.publish=e=>{const{token:t,eventName:n,args:r}=e;this.getEventEmitter(t).emit(String(n),...r)},this.subscribe=(e,t,n)=>{this.getEventEmitter(e).on(t,n)},this.unsubscribe=e=>{this.eventEmitterMap.has(e)&&(this.getEventEmitter(e).events={},this.eventEmitterMap.delete(e))}}getEventEmitter(e){return this.eventEmitterMap.has(e)||this.eventEmitterMap.set(e,(0,M.i)()),this.eventEmitterMap.get(e)}};class L{constructor(){this.transport=new A,this.services=new Map}static get transport(){return this.instance.transport}static register({services:e,onRegisterError:t}={}){Object.entries(null!=e?e:{}).forEach((([e,n])=>{try{L.instance.registerService(e,n)}catch(n){if(!t)throw n;null==t||t(e,n)}}))}static getService(e){const t=this.instance.services.get(e);if(!t)throw new Error(`Service "${e}" not found`);return t}registerService(e,t){if(this.services.has(e))throw new Error(`Service "${e}" is already registered`);if(!Number.isInteger(t.version)&&t.version<=0)throw new Error(`Service ${e}: version ${t.version} is not an integer greater than 0`);this.services.set(e,t)}}k=L,L.instance=new k;var N=L;function B(){Reflect.set(window,p.LH,{loadProtocol:e=>{const t=N.getService(e);return{protocol:{apis:t.apis||[],channels:t.channels||[],version:t.version},broker:t}},transport:N.transport})}var F=n(19762),U=function(){function e(){this.client=i.KU.create({media:(0,i.b$)()},!0)}return e.prototype.uploadImage=function(e,t){return(0,o.__awaiter)(this,void 0,void 0,(function(){var n;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.client.media.uploadImage(e)];case 1:return(n=r.sent()).subscribe(a.xn.UploadImageData,(function(e){t.onSuccess(e)})),n.subscribe(a.xn.MediaError,(function(e,n){t.onFail(e,n)})),[2]}}))}))},e.prototype.downloadImage=function(e,t){return(0,o.__awaiter)(this,void 0,void 0,(function(){var n;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.client.media.downloadImage(e)];case 1:return(n=r.sent()).subscribe(a.xn.DownloadImageData,(function(e){t.onSuccess(e)})),n.subscribe(a.xn.MediaError,(function(e,n){t.onFail(e,n)})),[2]}}))}))},e.prototype.handleUploadImage=function(e,t){var n=t.imageBlob,r=t.successCallback,o=t.errorCallback,i=new FormData;return i.append("file",n),this.uploadImage({data:i,params:{name:(null==n?void 0:n.name)||"",lastModified:(null==n?void 0:n.lastModified)||0,globalPadId:(0,l.V5)().globalPadId,localFilePath:(0,l.V5)().localFilePath}},{onSuccess:function(t){null==r||r(e,t.url,n.type)},onFail:function(t,n){null==o||o(e,t,n||"")}}),e},e.prototype.handleDownloadImage=function(e,t,n){return(0,o.__awaiter)(this,void 0,Promise,(function(){var r;return(0,o.__generator)(this,(function(o){return r={onSuccess:function(e){n.successCallback(t,e.url,"",e.width,e.height)},onFail:function(r,o){n.failCallback(t,e,r+(o||""))}},this.downloadImage({globalPadId:(0,l.V5)().globalPadId,url:e,xsrf:(0,F.f)(),localFilePath:(0,l.V5)().localFilePath},r),[2]}))}))},e}(),H=n(87363),j=n.n(H),G=n(61533),V=n.n(G),W=n(67921),z=n.n(W),K=n(83529),q=n.n(K),Y=function(e){function t(t){var n=e.call(this,t)||this;return n.onPasswordChange=function(e){n.setState({password:e,errorMsg:""})},n.handleConfirm=function(){n.props.onConfirm(n.state.password)},n.state={password:"",errorMsg:""},n}return(0,o.__extends)(t,e),t.prototype.setPassword=function(e){this.setState({password:e})},t.prototype.render=function(){return j().createElement("div",{className:"mobile-password-container"},j().createElement("div",{className:"mobile-password-doc-title"},(0,u.$t)("local-edit:enter-file-password")),j().createElement(q().Password,{showClear:!0,showToggle:!1,className:"mobile-password-input-container",inputClassName:"mobile-password-input ".concat(this.state.errorMsg?"error-input":""),placeholder:(0,u.$t)("local-edit:enter-password"),onChange:this.onPasswordChange,value:this.state.password}),j().createElement("div",{className:"password-error-msg"},this.state.errorMsg),j().createElement(z(),{size:"large",type:"primary",className:"mobile-password-confirm",onClick:this.handleConfirm,disabled:!this.state.password},(0,u.$t)("")))},t}(H.Component),Q=function(){function e(){var e=this;this.mounted=!1,this.initContainer=function(){var t=document.createElement("div");t.className="local-edit-password-mobile-modal",document.body.appendChild(t),e.container=t},this.mount=function(){V().render(j().createElement(Y,{ref:function(t){e.passwordContentElement=t},onConfirm:function(t){var n;null===(n=e.onConfirm)||void 0===n||n.call(e,t)}}),e.container)}}var t;return e.prototype.show=function(e,t){var n;this.mounted||(this.mounted=!0,this.initContainer(),this.mount()),this.onConfirm=e,t&&(null===(n=this.passwordContentElement)||void 0===n||n.setState({errorMsg:t}))},e.prototype.hide=function(){this.mounted=!1,V().unmountComponentAtNode(this.container)},t=e,e.getInstance=function(){return t.passwordModal||(t.passwordModal=new e),t.passwordModal},e}();function Z(e,t){Q.getInstance().show(t.onConfirm,e.errorMsg)}var X=n(3139),J=n(42035),$=n(31218),ee=n(48069),te=n(38913),ne=[{id:te.y1.BACK,type:te.tx.IMAGE,url:te.MY.navigation_back,position:te.K9.LEFT,state:te.H_.SHOW},{id:te.y1.TITLE,type:te.tx.TEXT,position:te.K9.MIDDLE,state:te.H_.SHOW},{id:te.y1.MENU,type:te.tx.IMAGE,url:te.MY.navigation_more,position:te.K9.RIGHT,state:te.H_.HIDE}],re=n(66138),oe=n(97967),ie="[MobileLocalEditService]",ae=function(){function e(){var e=this;this.client=i.KU.create({docx:(0,i.b$)()},!0),this.localTitleChangeCallback=[],this.localImageHandleService=new U,this.initEditChannelAndTitle=function(){return(0,o.__awaiter)(e,void 0,void 0,(function(){var e;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return e=this,[4,this.client.docx.edit((0,l.V5)())];case 1:return e.editChannel=t.sent(),this.updateLocalEditTitle(),[2]}}))}))},this.syncLocalEditStatus=function(t){!1===t&&e.eventEmitter.emit("$editorStateChange",$.EditorState.STATE_VIEW),e.editChannel.publish(a.SZ.ContentModified,t)},this.updateLocalEditInfo=function(t,n){var r=new URL(location.href);void 0!==t&&r.searchParams.set("localFilePath",t),void 0!==n&&r.searchParams.set("title",n),location.href!==r.href&&(history.pushState(null,"",r.href),e.updateLocalEditTitle())},this.reportMobilePerformace=function(t,n,r){var o=(0,l.V5)(),i=o.globalPadId,a=o.csid;(0,oe.cU)(e.client.docx,i,a,t,n,r)},this.handleMobileOpenError=function(t,n){(0,ee.YG)(!1,t+n),t!==a.iP.kPasswordRequired?t!==a.iP.kInvalidPassword?(s.Logger.info(ie,"[handleMobileOpenError]",t,n),(0,re.UJ)(t,n)):e.handleInvalidPassword():e.handlePassWordRequired()},this.handleMobileExportError=function(e,t){s.Logger.info(ie,"[handleMobileExportError]",e,t),(0,re.VG)(e,t)},this.handleOnData=function(){Q.passwordModal&&Q.getInstance().hide(),(0,ee.vr)(ee.GB.show)}}var t;return e.getInstance=function(){return this.instance||(B(),N.register({services:{file:new w(N.transport),docx:new I(N.transport),media:new D(N.transport)},onRegisterError:(e,t)=>{console.error("[Mega Mobile]",`Service "${e}" is failed to register:`,JSON.stringify(t.stack))}}),this.instance=new e),this.instance},e.prototype.init=function(){this.initLocalEditBasicClientVarAndTitle()},e.prototype.addTitleChangeCallback=function(e){this.localTitleChangeCallback.push(e)},e.prototype.loadLocalDoc=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){var t,n=this;return(0,o.__generator)(this,(function(i){switch(i.label){case 0:return t=this,[4,this.client.docx.load((0,o.__assign)((0,o.__assign)({},(0,l.V5)()),{docType:r.Word})).catch((function(e){throw s.Logger.error(ie,"[load:fatal-error]",e.stack),e}))];case 1:return t.loadChannel=i.sent(),[2,new Promise((function(t){n.loadChannel.subscribe(a.DB.Data,(function(r){var o;n.handleOnData(),null===(o=e.onData)||void 0===o||o.call(e,r),t(r),(0,oe.Jh)(n.client.docx,(0,l.V5)().globalPadId),(0,ee.YG)(!0,"")})),n.loadChannel.subscribe(a.DB.Abort,(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];s.Logger.error.apply(s.Logger,(0,o.__spreadArray)([""],(0,o.__read)(e),!1))})),n.loadChannel.subscribe(a.DB.MobileError,n.handleMobileOpenError)}))]}}))}))},e.prototype.closeLocalEditTab=function(){this.editChannel.publish(a.SZ.CloseTab)},e.prototype.saveDoc=function(e,t,n){return(0,o.__awaiter)(this,void 0,Promise,(function(){var i,c,u,d,p,h=this;return(0,o.__generator)(this,(function(f){switch(f.label){case 0:return i="".concat((new Date).valueOf()),(0,oe.Jx)(this.client.docx,(0,l.V5)().globalPadId,i),c=(0,l.N7)(n),u=c.localEditInfo,d=c.filteredSaveType,p=this,[4,this.client.docx.save((0,o.__assign)((0,o.__assign)({},u),{data:e,traceKey:i,docType:r.Word}),d)];case 1:return p.saveChannel=f.sent(),this.saveChannel.subscribe(a.J_.JSONSaved,(function(){var e;null===(e=t.onJSONSaved)||void 0===e||e.call(t)})),this.saveChannel.subscribe(a.J_.DocumentSaved,(function(e,n){var r;h.updateLocalEditInfo(e,n),null===(r=t.onDocumentSaved)||void 0===r||r.call(t)})),this.saveChannel.subscribe(a.J_.MobileError,(function(e,n){var r;s.Logger.info(ie,"[save:mobile-error]",e,n),h.handleMobileExportError(e,n),null===(r=t.onConverterError)||void 0===r||r.call(t)})),[2]}}))}))},e.prototype.localLogin=function(){(0,ee.f$)((0,l.V5)().localFilePath)},e.prototype.reportFinishDisplay=function(){(0,oe.tu)(this.client.docx,(0,l.V5)().globalPadId)},e.prototype.handleUploadImage=function(e,t){return this.localImageHandleService.handleUploadImage(t,e)},e.prototype.handleDownloadImage=function(e,t,n){return this.localImageHandleService.handleDownloadImage(e,t,n)},e.prototype.initLocalEditBasicClientVarAndTitle=function(){(0,d.z)(),window.basicClientVars=(0,c.HD)()},e.prototype.fireTitleChangeEvent=function(e){this.localTitleChangeCallback.forEach((function(t){t(e)}))},e.prototype.handlePassWordRequired=function(){var e=this;(0,ee.vr)(ee.GB.hide),(0,ee.iH)(ne),Z({},{onConfirm:function(t){e.loadChannel.publish(a.DB.ContinueWithPassword,t)}})},e.prototype.handleInvalidPassword=function(){var e=this;Z({errorMsg:(0,u.$t)("local-edit:mobile-password-error")},{onConfirm:function(t){e.loadChannel.publish(a.DB.ContinueWithPassword,t)}})},e.prototype.updateLocalEditTitle=function(){var e=(0,l.V5)().title;this.editChannel.publish(a.SZ.UpdateTitle,e),document.title=(0,l.HV)(),this.fireTitleChangeEvent(e)},(0,o.__decorate)([(0,X.tB)(),(0,o.__metadata)("design:type","function"==typeof(t=void 0!==J.v&&J.v)?t:Object)],e.prototype,"eventEmitter",void 0),e}()},9419:function(e,t,n){n.d(t,{K:function(){return _}});var r=n(85556),o=n(24282),i=n(3474),a=n(30479),s=n(19105),c=n(29382),l=n(14740),u=n(75906),d=n(87363),p=n.n(d),h="",f=function(e){var t=(0,r.__read)((0,d.useState)(""),2),n=t[0],o=t[1];return p().createElement(p().Fragment,null,p().createElement("div",{className:"password-doc-title"},(0,l.$t)("local-edit:password-is-required")),p().createElement("input",{type:"password",placeholder:(0,l.$t)("local-edit:enter-password"),className:"input-password",onChange:function(e){var t=e.target.value;o(t),h=t},value:n}),e.errorMsg&&p().createElement("div",{className:"password-error-msg"},e.errorMsg))};function g(e,t){u.Modal.confirm({title:(0,l.$t)("local-edit:enter-file-password"),content:p().createElement(f,{errorMsg:e.errorMsg}),okText:(0,l.$t)(""),cancelText:(0,l.$t)(""),className:"local-edit-password-confirm",onOk:function(){t.onOk(h)},onCancel:function(){var e;null===(e=t.onCancel)||void 0===e||e.call(t)}})}var v=n(89890),y=n(97967),m=n(66138),b=n(16285),_=function(){function e(){var e=this;this.client=o.KU.create({file:(0,o.b$)(),docx:(0,o.b$)()}),this.localTitleChangeCallback=[],this.initEditChannelAndTitle=function(t){return(0,r.__awaiter)(e,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return e=this,[4,this.client.docx.edit((0,c.vT)())];case 1:return e.editChannel=n.sent(),this.editChannel.subscribe(i.SZ.Save,(function(e){var n=e.saveType;t.onSaveDoc(n)})),this.updateLocalEditTitle(),[2]}}))}))},this.syncLocalEditStatus=function(t){e.editChannel.publish(i.SZ.ContentModified,t)},this.reportFinishDisplay=function(){(0,y.tu)(e.client.docx,(0,c.vT)().globalPadId)},this.handleOpenConverterError=function(t,n){t!==i.t6.kPasswordRequired?t!==i.t6.kInvalidPassword?(0,m.UE)(t,n,m.C8.open):e.handleInvalidPassword():e.handlePassWordRequired()},this.handleOpenDesktopError=function(e,t){(0,m.ws)(e,t,m.C8.open)},this.handleSaveConverterError=function(e,t){(0,m.UE)(e,t,m.C8.save)},this.handleSaveDesktopError=function(e,t){(0,m.ws)(e,t,m.C8.save)},this.handleDocumentSaved=function(t,n){var r=new URL(location.href);void 0!==t&&r.searchParams.set("localFilePath",t),void 0!==n&&r.searchParams.set("title",n),location.href!==r.href&&(history.pushState(null,"",r.href),e.updateLocalEditTitle())}}return e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},e.prototype.init=function(){this.initLocalEditBasicClientVarAndTitle()},e.prototype.addTitleChangeCallback=function(e){this.localTitleChangeCallback.push(e)},e.prototype.loadLocalDoc=function(e){return(0,r.__awaiter)(this,void 0,Promise,(function(){var t,n=this;return(0,r.__generator)(this,(function(o){switch(o.label){case 0:return t=this,[4,this.client.docx.load((0,c.vT)())];case 1:return t.loadChannel=o.sent(),[2,new Promise((function(t){n.loadChannel.subscribe(i.DB.Data,(function(r){var o;null===(o=e.onData)||void 0===o||o.call(e,r),t(r),(0,y.Jh)(n.client.docx,(0,c.vT)().globalPadId),n.getBackupFiles()})),n.loadChannel.subscribe(i.DB.Abort,(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];a.Logger.error.apply(a.Logger,(0,r.__spreadArray)([""],(0,r.__read)(e),!1))})),n.loadChannel.subscribe(i.DB.ConverterError,n.handleOpenConverterError),n.loadChannel.subscribe(i.DB.DesktopError,n.handleOpenDesktopError)}))]}}))}))},e.prototype.closeLocalEditTab=function(){this.editChannel.publish(i.SZ.CloseTab)},e.prototype.saveDoc=function(e,t,n){return(0,r.__awaiter)(this,void 0,Promise,(function(){var o,a,s,l,u,d=this;return(0,r.__generator)(this,(function(p){switch(p.label){case 0:return o="".concat((new Date).valueOf()),(0,y.Jx)(this.client.docx,(0,c.vT)().globalPadId,o),a=(0,c.N7)(n),s=a.localEditInfo,l=a.filteredSaveType,u=this,[4,this.client.docx.save((0,r.__assign)((0,r.__assign)({},s),{data:e,traceKey:o}),l)];case 1:return u.saveChannel=p.sent(),this.saveChannel.subscribe(i.J_.JSONSaved,(function(){var e;null===(e=t.onJSONSaved)||void 0===e||e.call(t)})),this.saveChannel.subscribe(i.J_.DocumentSaved,(function(e,n){var r;d.handleDocumentSaved(e,n),document.dispatchEvent(new CustomEvent(b.a.LocalEditDocumentSaved)),null===(r=t.onDocumentSaved)||void 0===r||r.call(t)})),this.saveChannel.subscribe(i.J_.Cancel,(function(){var e;null===(e=t.onCancel)||void 0===e||e.call(t)})),this.saveChannel.subscribe(i.J_.ConverterError,(function(e,n){var r;d.handleSaveConverterError(e,n),null===(r=t.onConverterError)||void 0===r||r.call(t)})),this.saveChannel.subscribe(i.J_.DesktopError,(function(e,n){var r;d.handleSaveDesktopError(e,n),null===(r=t.onDesktopError)||void 0===r||r.call(t)})),[2]}}))}))},e.prototype.localLogin=function(){window.mqq.invoke("docx","loginToOpenUrl",{file:(0,c.vT)().localFilePath,close:!0})},e.prototype.initLocalEditBasicClientVarAndTitle=function(){(0,v.z)(),window.basicClientVars=(0,s.HD)()},e.prototype.fireTitleChangeEvent=function(e){this.localTitleChangeCallback.forEach((function(t){t(e)}))},e.prototype.handlePassWordRequired=function(){var e=this;g({},{onOk:function(t){e.loadChannel.publish(i.DB.ContinueWithPassword,t)}})},e.prototype.handleInvalidPassword=function(){var e=this;g({errorMsg:(0,l.$t)("local-edit:incorrect-password")},{onOk:function(t){e.loadChannel.publish(i.DB.ContinueWithPassword,t)}})},e.prototype.updateLocalEditTitle=function(){var e=(0,c.vT)().title;this.editChannel.publish(i.SZ.UpdateTitle,e),document.title=(0,c.HV)(),this.fireTitleChangeEvent(e)},e.prototype.getBackupFiles=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,t;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return e=(0,c.vT)().localFilePath,[4,this.client.docx.fetchBackups(e)];case 1:return t=n.sent().backups,this.backups=t,[2]}}))}))},e.prototype.showBackupFile=function(){var e=this.backups;if(e&&e.length>0){var t=e.sort((function(e,t){return e.modifiedTimeMs-t.modifiedTimeMs}));this.client.file.showItemInFolder(t[0].path).catch((function(e){a.Logger.error(e)}))}},e.prototype.getBackUp=function(){return this.backups},e}()},66138:function(e,t,n){n.d(t,{C8:function(){return y},UE:function(){return T},ws:function(){return x},VG:function(){return I},UJ:function(){return P}});var r,o=n(30479),i=n(14740),a=n(52739),s=n(3474),c=n(75906),l=n(2613),u=n(16285);function d(){document.dispatchEvent(new CustomEvent(u.a.LocalEditSaveAs))}!function(e){e[e.open=0]="open",e[e.save=1]="save"}(r||(r={}));var p,h=function(){o.Logger.info("I know")},f=[{codes:[s.Xz.ErrorUnknown],tips:function(e){return e===r.open?(0,i.$t)("local-edit:open-error-unknown"):(0,i.$t)("local-edit:save-error-unknown")},handleText:function(){return(0,i.$t)("")},handleFunc:h},{codes:[s.Xz.ErrorBusy],tips:function(e){return e===r.open?(0,i.$t)("local-edit:open-error-busy"):(0,i.$t)("local-edit:save-error-busy")},handleText:function(e){return e===r.open?(0,i.$t)(""):(0,i.$t)("")},handleFunc:function(e){if(e===r.open)return h();d()}},{codes:[s.Xz.ErrorNotEntity],tips:function(e){return e===r.open?(0,i.$t)("local-edit:open-error-not-entity"):(0,i.$t)("local-edit:save-error-not-entity")},handleText:function(e){return e===r.open?(0,i.$t)(""):(0,i.$t)("")},handleFunc:function(e){if(e===r.open)return h();d()}},{codes:[s.Xz.ErrorPermittion],tips:function(e){return e===r.open?(0,i.$t)("local-edit:open-error-permittion"):(0,i.$t)("local-edit:save-error-permittion")},handleText:function(e){return e===r.open?(0,i.$t)(""):(0,i.$t)("")},handleFunc:function(e){if(e===r.open)return h();d()}},{codes:[s.Xz.ErrorConverterInstall],tips:function(e){return e===r.open?(0,i.$t)("local-edit:open-error-converter-install"):(0,i.$t)("local-edit:save-error-converter-install")},handleText:function(e){return e===r.open?(0,i.$t)(""):(0,i.$t)("local-edit:retry")},handleFunc:function(e){if(e===r.open)return h();window.location.reload()}}],g=n(77873);function v(){g.B.jumpToCaoUrl()}!function(e){e[e.open=0]="open",e[e.save=1]="save"}(p||(p={}));var y,m,b=function(){o.Logger.info("I know")},_=[{codes:[s.t6.kUnknownDocsType],tips:function(e){return e===p.open?(0,i.$t)("local-edit:import-unknown-docs"):(0,i.$t)("local-edit:save-error-unknown")},handleText:function(){return(0,i.$t)("")},handleFunc:v},{codes:[s.t6.kFileNotExist],tips:function(e){return e===p.save?(0,i.$t)("local-edit:open-error-not-entity"):(0,i.$t)("local-edit:save-path-not-exit")},handleText:function(e){return e===p.save?(0,i.$t)(""):(0,i.$t)("")},handleFunc:function(e){if(e===p.save)return b();document.dispatchEvent(new CustomEvent(u.a.LocalEditSaveAs))}},{codes:[s.t6.kInvalidFilesystem,s.t6.kFilesystemEmitError,s.t6.kTreewalkerEmitError,s.t6.kInvalidRefResolver,s.t6.kInvalidPackageContext,s.t6.kInvalidPartContext,s.t6.kInvalidPackageDescriptor,s.t6.kInvalidPartDescriptor,s.t6.kInvalidPackageStrategy,s.t6.kInvalidPartStrategy,s.t6.kInvalidAssetPart,s.t6.kInvalidEncryptionContext,s.t6.kInvalidImportConfig,s.t6.kInvalidNamespaceWhenSeekSectpr,s.t6.kImportCancel,s.t6.kNotSupported,s.t6.kInvalidImportCache],tips:function(e){return e===p.open?(0,i.$t)("local-edit:import-unknown-docs"):(0,i.$t)("local-edit:save-error-unknown")},handleText:function(e){return e===p.save?(0,i.$t)(""):(0,i.$t)("")},handleFunc:function(e){if(e===p.save)return b();v()}}],C=[{codes:[s.rP.kUnknownDocsType,s.rP.kInvalidFileHandle,s.rP.kRequiredVisitor,s.rP.kInvalidPartStrategy,s.rP.kEmptyDataContent,s.rP.kLostPartVisitor,s.rP.kExportPBToXFailed,s.rP.kEmbedFontFileNotExist,s.rP.kEmbedFontOriginFileOpenError,s.rP.kEmbedFontDstFileOpenError,s.rP.kInvalidOOXMLNode,s.rP.kEncryptFileFailed,s.rP.kInvalidSheetModel,s.rP.kInvalidWorksheetId,s.rP.kInvalidWorksheetChartData,s.rP.kInvalidPivotTable,s.rP.kInvalidPivotCacheDefinitions,s.rP.kInvalidPivotCacheRecords,s.rP.kInvalidSheetPivotTable,s.rP.kInvalidSheetSharedStringCache,s.rP.kInvalidSheetFrozenProperty,s.rP.kInvalidSheetChart,s.rP.kInvalidSheetComment,s.rP.kAllWorksheetAreHidden,s.rP.kInvalidSlideModel,s.rP.kEmptySlideViewPr,s.rP.kEmptyTableStyleList,s.rP.kEmptyPresPros,s.rP.kInvalidSlideId,s.rP.kInvalidSlideMasterId,s.rP.kInvalidNotesSlideId,s.rP.kNotesMasterNotFound,s.rP.kInvalidSlideSection,s.rP.kSlideTableNotFound],tips:function(){return(0,i.$t)("local-edit:export-file-error")},handleText:function(){return(0,i.$t)("")},handleFunc:v},{codes:[s.rP.kExportCancel],tips:function(){return(0,i.$t)("local-edit:export-cancel")},handleText:(0,i.$t)("local-edit:retry"),handleFunc:function(){window.location.reload()}}],S=a.default,w=c.Modal;function E(e,t,n,r,o,a){var s=e===y.open?(0,i.$t)("local-edit:cannot-open"):(0,i.$t)("local-edit:cannot-save"),c="".concat(t(e)," (").concat(o).concat(a,")"),l=n(e);w.confirm({title:s,content:c,okText:l,onOk:function(){r(e)}})}function x(e,t,n){var r;o.Logger.error("DesktopError:".concat(e,",").concat(t)),null===(r=l.ReportHelper.zzsHandler)||void 0===r||r.zzsStatus({attributeId:n===y.open?l.MonitorName.LOCAL_EDIT_OPEN_FAIL:l.MonitorName.LOCAL_EDIT_SAVE_FAIL,status:l.Status007.SUCCESS,errorCode:e,otherDimensions:[t]});var a=f.find((function(t){return-1!==t.codes.indexOf(e)}));a?E(n,a.tips,a.handleText,a.handleFunc,m.desktopErr,e):S.show({message:(0,i.$t)("local-edit:error-tips",{code:e}),type:"error"})}function T(e,t,n){var r;o.Logger.error("ConvertError:".concat(e,",").concat(t)),null===(r=l.ReportHelper.zzsHandler)||void 0===r||r.zzsStatus({attributeId:n===y.open?l.MonitorName.LOCAL_EDIT_OPEN_FAIL:l.MonitorName.LOCAL_EDIT_SAVE_FAIL,status:l.Status007.SUCCESS,errorCode:e,otherDimensions:[t]});var a=(s.t6[e]?_:C).find((function(t){return-1!==t.codes.indexOf(e)}));a?E(n,a.tips,a.handleText,a.handleFunc,m.convertErr,e):S.show({message:(0,i.$t)("local-edit:error-tips",{code:e}),type:"error"})}function R(e,t,n){x(e,t,n)}function I(e,t){s.CV[e]?R(e,t,y.save):T(e,t,y.save)}function P(e,t){s.CV[e]?R(e,t,y.open):T(e,t,y.open)}!function(e){e[e.open=0]="open",e[e.save=1]="save"}(y||(y={})),function(e){e.desktopErr="D",e.convertErr="C"}(m||(m={}))},19105:function(e,t,n){n.d(t,{HD:function(){return l},Jj:function(){return s},z:function(){return a},zb:function(){return c}});var r=n(30479),o=(0,n(14740).$t)(""),i=/\.[\w]+$/g;function a(){var e,t,n=null!==(e=window.mobileInfo)&&void 0!==e?e:null===(t=window.top)||void 0===t?void 0:t.mobileInfo;if(!n)try{n=JSON.parse(decodeURIComponent((0,r.getUrlParameter)("userInfo")||"")),window.mobileInfo=n}catch(e){return}return n}function s(){var e;return decodeURIComponent((0,r.getUrlParameter)("title")||o)+((null===(e=((0,r.getUrlParameter)("localFilePath")||"").match(i))||void 0===e?void 0:e[0])||".docx")}function c(e,t){var n=e.corp_id,r=e.corp_name,o=e.english_name,i=e.login_type,a=e.tinyid,s=e.uin,c=e.uid_source,l=e.uid,u=e.nick,d=e.avatar;return{corpId:n,corpName:r,englishName:o,loginType:i,openId:"",tinyId:a,uin:s,uidSource:c,userId:l?"p.".concat(l):"",userName:u,userPic:d,userType:t.utype||"",nowUserIndex:"",settings:{language:t.language||"zh-CN",toolbarMode:""}}}function l(){if(window.URL&&"searchParams"in window.URL.prototype){var e={userInfo:{corpId:"",corpName:"",englishName:"",loginType:1,openId:"",tinyId:"",uin:"",uidSource:2,userId:"",userName:"",userPic:"",userType:"",nowUserIndex:"",settings:{language:"zh-CN",toolbarMode:""}},docInfo:{padInfo:{domainId:"300000000",padId:"WmQFYwofPDMf",padTitle:new URL(window.location.href).searchParams.get("title")||"",padType:"doc",relative:[]},createInfo:{createTime:Date.now(),creatorId:"",creatorNick:"",creatorCorpId:"",creatorCorpName:""},ownerInfo:{ownerId:"",ownerNick:"",ownerAvatar:"",ownerCorpId:"",ownerCorpName:""},shareLink:"",docStatus:12,isAdmin:!0,isOwner:!0,isCreator:!0,isUserChangeTitle:!1,dirty:2,personalizeInfo:{background:{id:"",transparency:0},mode:-1,titleColor:{color:"",isVip:!1},isExpire:!1}},authInfo:{attribute:{canAbout:!0,canAddUser:!1,canComment:!0,canCopy:!1,canCopyDoc:!1,canEdit:!1,canEditTitle:!1,canHistory:!1,canLinkExp:!1,canPrint:!0,canRead:!0,canSearch:!0,canShare:!1,canSpitSlot:!0,canTranslate:!0,canViewImage:!0,canWatermark:!1,canExport:!0},privilegeFlag:2048,privilegeExpire:!1,privilegeInfo:{uint32Policy:0,advPolicy:{viewForbidCopyPrint:!0,readerCanComment:!0,writerCanComment:!1}}}},t={attribute:{canAbout:!0,canAddUser:!0,canComment:!0,canCopy:!0,canCopyDoc:!0,canEdit:!0,canEditTitle:!0,canHistory:!0,canLinkExp:!0,canPrint:!0,canRead:!0,canSearch:!0,canShare:!0,canSpitSlot:!0,canTranslate:!0,canViewImage:!0,canWatermark:!0,canExport:!0},privilegeExpire:!1,privilegeFlag:2048,privilegeInfo:{uint32Policy:0,advPolicy:{viewForbidCopyPrint:!1,readerCanComment:!0,writerCanComment:!0}}};if(window.desktopInfo){var n=window.desktopInfo||{},r=n.onlineUserInfo,o=n.account;r&&o&&(e.userInfo=c(r,o),e.authInfo=t)}var i=a();return i&&(e.userInfo=c(i,{utype:1===i.login_type?"qq":"wx"}),e.authInfo=t),e}}},29382:function(e,t,n){n.d(t,{HV:function(){return c},N7:function(){return l},V5:function(){return a},vT:function(){return i}});var r=n(3474),o=n(38429);function i(){var e=new URL(location.href).searchParams;return{localFilePath:e.get("localFilePath")||"",globalPadId:e.get("globalPadId")||"",docType:Number(e.get("docType")||""),title:e.get("title")||""}}function a(){var e=new URL(location.href).searchParams;return{localFilePath:e.get("localFilePath")||"",globalPadId:e.get("globalPadId")||"",docType:Number(e.get("docType")||""),title:e.get("title")||"",csid:e.get("csid")||""}}function s(){var e=new URL(location.href).searchParams.get("localFilePath")||"";return/.doc$/.test(e)}function c(){var e=new URL(location.href).searchParams;return"".concat(e.get("title"),".").concat(s()?"doc":"docx")}function l(e){var t=i();if(o.YT&&(t.title=function(){var e,t,n=null===(t=null===(e=window.pad)||void 0===e?void 0:e.editor)||void 0===t?void 0:t.service.getDocument().getFirstParaRange();if(n){var r=window.pad.editor.getRefText(n);return r.substring(0,r.length-1)}return i().title}()),s()){var n=[r.V4.Save,r.V4.Rename].includes(e)?r.V4.SaveAs:e;return n!==r.V4.AutoSave&&(t.localFilePath+="x"),{localEditInfo:t,filteredSaveType:n}}return{localEditInfo:t,filteredSaveType:e}}},97967:function(e,t,n){n.d(t,{Jh:function(){return i},Jx:function(){return a},cU:function(){return s},tu:function(){return o}});var r=n(3474);function o(e,t){e.report({globalPadId:t,type:"load",isEnd:!0},r.Cz.FINISH_DISPLAY)}function i(e,t){e.report({globalPadId:t,type:"load"},r.Cz.FINISH_LOAD)}function a(e,t,n){e.report({globalPadId:t,type:"save",traceKey:n,isStart:!0},r.Cz.BEGIN_DUMP)}function s(e,t,n,o,i,a){var s;e.report({globalPadId:t,type:"load",isStart:!0,csid:n,perfermanceMap:(s={},s[r.Lb.CAN_VIEW]=o,s[r.Lb.CAN_INTERACT]=i,s[r.Lb.CAN_EDIT]=a,s)},r.Cz.MOBILE_PERFERMANCE)}},89890:function(e,t,n){n.d(t,{z:function(){return o}});var r=n(21856);function o(){var e=document.querySelectorAll("link[rel~=shortcut]"),t=r.X.getInstance().getConfig("custom.links.localEditFavicon");e.forEach((function(e){e.href=t}))}},82173:function(e,t,n){var r;n.d(t,{p:function(){return r}}),function(e){e[e.CollabRoomJQUERYREWRITEERROR=72001]="CollabRoomJQUERYREWRITEERROR",e[e.CollabRoomDefaultErrCode=72005]="CollabRoomDefaultErrCode",e[e.CollabRoomCommittingTimeOut=72008]="CollabRoomCommittingTimeOut",e[e.CollabRoomGetMisschangFail=72009]="CollabRoomGetMisschangFail",e[e.CollabRoomCHANGESETERRORAPPLYOFFLINE=72010]="CollabRoomCHANGESETERRORAPPLYOFFLINE",e[e.CollabRoomGetMisschangAndFollowError=72011]="CollabRoomGetMisschangAndFollowError",e[e.CollabRoomSwitchAccout=72012]="CollabRoomSwitchAccout",e[e.CollabRoomDelta2CS=72101]="CollabRoomDelta2CS",e[e.CollabRoomVerify=72102]="CollabRoomVerify",e[e.CollabRoomVerifyModel=72103]="CollabRoomVerifyModel",e[e.CollabRoomApplyOnline=72104]="CollabRoomApplyOnline",e[e.CollabRoomDataBaseChange=72105]="CollabRoomDataBaseChange",e[e.CollabRoomCommitCSFailByCGI=72106]="CollabRoomCommitCSFailByCGI",e[e.CollabRoomCommitCheckTimeOut=72110]="CollabRoomCommitCheckTimeOut",e[e.CollabRoomLocalVersionBiggerThanServerVersion=72111]="CollabRoomLocalVersionBiggerThanServerVersion",e[e.PAYLOADTOOLARGE=72112]="PAYLOADTOOLARGE",e[e.CollabRoomGetChunkFail=72113]="CollabRoomGetChunkFail",e[e.CollabRoomChangsetErrorEasysync=72999]="CollabRoomChangsetErrorEasysync",e[e.CollabRoomShutDownNotOpen=79999]="CollabRoomShutDownNotOpen"}(r||(r={}))},89407:function(e,t,n){n.d(t,{C:function(){return s}});var r=n(85556),o=n(81814),i=n(79329),a=n(13980);function s(e,t){return(0,r.__awaiter)(this,void 0,Promise,(function(){var n,s,c;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return n=(0,a.getUid)(),s=[o.Nt.MISS_CHANGE,o.Nt.ACCEPTED,o.Nt.NEW_CHANGE],c=o.he.newInstance().addCondition("globalPadId",o.E1.ONLY,e).addCondition("type",o.E1.IN,s).addCondition("uid",o.E1.ONLY,n),void 0!==t&&c.addCondition("version",o.E1.UPPER_BOUND,{upper:t,open:!1}),[4,i.Wo.getDataBase().delete(o.me.DOCUMENT_DATA,c)];case 1:return[2,r.sent()]}}))}))}},79329:function(e,t,n){n.d(t,{Wo:function(){return f},nN:function(){return r},q7:function(){return o}});var r,o,i=n(85556),a=n(49790),s=n(81814),c=n(99925),l=n(44166),u=n(13980),d=n(37769),p=n(3139);n(30479),function(e){e[e.set=1]="set",e[e.update=2]="update",e[e.delete=3]="delete",e[e.get=4]="get",e[e.getAll=5]="getAll"}(r||(r={})),function(e){e[e.InitUnlaunch=0]="InitUnlaunch",e[e.Initing=1]="Initing",e[e.InitException=2]="InitException",e[e.InitFinish=3]="InitFinish",e[e.InitTimeout=4]="InitTimeout"}(o||(o={}));var h=function(){function e(){var e=this;this.DBstatus=o.InitUnlaunch,this.mergedToBaseUserChanges=[],this.isSupportClientDBSync=function(){return!!/\swdocs_clientdb/.test(navigator.userAgent.toLowerCase())},this.onBeforeunload=function(){return e.disConnectDBAndReleaseLock()},this.onDestroy=function(){e.onReset(),e.disConnectDBAndReleaseLock(),c.j.info(c.w.Offline,"WordOnlineDocument destroy db lock, time: ".concat((new Date).toString()))},this.onReset=function(){window.removeEventListener("beforeunload",e.onBeforeunload)},this.dataManager=new s.Sg({businessType:s.Gk.WORD,user:new s.ao({uid:(0,u.getUid)(),uin:(0,s.ej)("uin")}),isSupportClientDB:void 0}),window.addEventListener("beforeunload",this.onBeforeunload),document.addEventListener("BeforeReplaceUrlNotification",this.onReset),document.addEventListener("DestroyDocumentNotification",this.onDestroy),window.onbeforeclosetab=this.disConnectDBAndReleaseLock.bind(this)}return e.prototype.$onReset=function(){this.onReset()},e.prototype.disConnectDBAndReleaseLock=function(){this.getDataBase().disConnect()},e.prototype.pushMergedToBaseUserChange=function(e){var t;(t=this.mergedToBaseUserChanges).push.apply(t,(0,i.__spreadArray)([],(0,i.__read)(e),!1))},e.prototype.isMergedToBase=function(e){return!!this.mergedToBaseUserChanges.find((function(t){return t.commitId===e}))},e.prototype.getMergedBaseDocChange=function(){return this.mergedToBaseUserChanges.map((function(e){var t;return{version:e.baseRev,changeset:e.changeset,subId:e.subId,createTimestamp:null!==(t=e.createTimestamp)&&void 0!==t?t:+new Date,taskId:e.commitId,type:a.DOCUMENT_DATA_TYPE.queue}}))},e.prototype.dataManageInit=function(){var e=this;this.DBStatusPromise=new Promise((function(t){var n=+new Date;e.DBstatus=o.Initing,e.dataManager.init().then((function(r){r.error?(c.j.error(c.w.Offline,"IndexDB init fail. reason: ".concat(r.error)),e.DBstatus=o.InitException):e.DBstatus=o.InitFinish,t(e.DBstatus),c.j.info(c.w.Offline,"IndexDB init cost ".concat(+new Date-n," status:").concat(e.DBstatus===o.InitFinish?"success":e.DBstatus))}))}))},e.prototype.getDataBase=function(){return this.dataManager.getDatabase()},e.prototype.getHelper=function(){return this.dataManager.getHelper()},e.prototype.handleDataFromIndexDB=function(e){var t;return(0,i.__awaiter)(this,void 0,Promise,(function(){var n,o;return(0,i.__generator)(this,(function(i){if(n=new s.x4(void 0,void 0),o="",!e.type||!e.tableName)return o="oprate or tableName is undefine.",c.j.info(c.w.Offline,"".concat(o)),n.error=new s.GU(o),[2,n];if((0,s.Tf)()&&(e.type===r.set||e.type===r.update||e.type===r.delete)&&!(null===(t=window.App.offlineEditAdapter)||void 0===t?void 0:t.isLocked()))return o="has not mutexLock, can not write indexDB ",c.j.info(c.w.Offline,"".concat(o)),n.error=new s.GU(o),[2,n];switch(e.type){case r.set:return[2,this.getDataBase().set(e.tableName,e.data)];case r.update:return[2,this.getDataBase().update(e.tableName,e.data)];case r.delete:if(e.where)return[2,this.getDataBase().delete(e.tableName,e.where)];break;case r.get:if(e.where)return[2,this.getDataBase().get(e.tableName,e.where)]}return[2,n]}))}))},e.prototype.handleOfflineTitleChange=function(e,t){return(0,i.__awaiter)(this,void 0,Promise,(function(){var n,o,a,l,d;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:if(!e||!t)return[2,!1];n=(0,u.getUid)()||t.userInfo.userId||"",o=s.he.newInstance().addCondition("uid",s.E1.ONLY,n).addCondition("globalPadId",s.E1.ONLY,t.globalPadId),i.label=1;case 1:return i.trys.push([1,4,,5]),[4,this.handleDataFromIndexDB({type:r.get,tableName:s.me.PAD_INFO,where:o})];case 2:return(a=i.sent()).error?(c.j.error(c.w.Offline,"PadInfo not found where id = ".concat(t.globalPadId)),[2,!1]):((l=a.data).title=e,l.lastModifyTime=Date.now(),o=s.he.newInstance().addCondition("uid",s.E1.ONLY,n).addCondition("globalPadId",s.E1.ONLY,t.globalPadId),[4,this.getDataBase().updateField(s.me.PAD_INFO,o,{title:e,lastModifyTime:Date.now()})]);case 3:return i.sent(),[3,5];case 4:return d=i.sent(),c.j.info(c.w.Offline,"update title to padinfo table failed: ".concat(d)),[2,!1];case 5:return[2,!0]}}))}))},e.prototype.updateClientVars=function(e){return(0,i.__awaiter)(this,void 0,Promise,(function(){var t,n;return(0,i.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),t=this.getHelper().clientVars2OfflineData(e.globalPadId,e),[4,this.handleDataFromIndexDB({type:r.update,tableName:s.me.DOCUMENT_DATA,data:t})];case 1:return o.sent(),[3,3];case 2:return n=o.sent(),c.j.error(c.w.Offline,"updateClientVarsInNative fail: ".concat(n)),[2,!1];case 3:return[2,!0]}}))}))},e.prototype.isDeletedDoc=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,t,n,r,o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return e=(0,u.getUid)(),t=(0,l.Yi)(),n="".concat(e).concat(t.domainId,"$").concat(t.padId),r=s.he.newInstance().addCondition("key",s.E1.ONLY,n),[4,this.dataManager.database.get(s.me.PAD_INFO,r)];case 1:return(o=i.sent())&&o.data&&o.data.isDelete?[2,!!o.data.isDelete]:(o.error&&c.j.info(c.w.Offline,"check isDeletedDoc fail, by:".concat(o.error)),[2,!1])}}))}))},e.prototype.recoverDocUpdateClientVars=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o,a,l;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return n=s.he.newInstance().addCondition("uid",s.E1.ONLY,e).addCondition("globalPadId",s.E1.ONLY,t.globalPadId).addCondition("type",s.E1.ONLY,s.Nt.INIT),[4,this.dataManager.database.get(s.me.DOCUMENT_DATA,n)];case 1:return(r=i.sent())&&r.data?((o=r.data.data).docStatus=0,a=this.dataManager.getHelper().clientVars2OfflineData(o.globalPadId,o),[4,this.dataManager.database.update(s.me.DOCUMENT_DATA,a)]):[3,3];case 2:(l=i.sent()).error&&c.j.error(c.w.Offline,"recoverDocUpdateClientVars fail, by:".concat(l.error)),i.label=3;case 3:return[2]}}))}))},e.prototype.recoverDocUpdatePadInfo=function(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,o,a;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return r="".concat(t).concat(n.domainId,"$").concat(n.padId),o=s.he.newInstance().addCondition("key",s.E1.ONLY,r),[4,this.dataManager.database.updateField(s.me.PAD_INFO,o,{folder:e,isDelete:!1,isMydoc:!0,isMyCreated:!0})];case 1:return(a=i.sent()).error&&c.j.error(c.w.Offline,"recoverDocUpdatePadinfo fail, by:".concat(a.error)),[2]}}))}))},e.prototype.recoverDoc=function(e){var t=(0,u.getUid)(),n=(0,l.Yi)();this.recoverDocUpdateClientVars(t,n),this.recoverDocUpdatePadInfo(e,t,n)},e=(0,i.__decorate)([(0,d.t)(),(0,i.__metadata)("design:paramtypes",[])],e)}(),f=(window.offlineDataHelperInstance||(window.offlineDataHelperInstance=new h,window.offlineDataHelperInstance.dataManageInit(),p.Am.factory(h,window.offlineDataHelperInstance)),window.offlineDataHelperInstance)},28379:function(e,t,n){n.d(t,{Ev:function(){return u},Lf:function(){return c},XQ:function(){return l},cG:function(){return p},g6:function(){return d}});var r=n(81814),o=n(22828),i=n(26676),a=n(14740),s=n(13980),c="D0000000000000000",l="A00000000000",u="300000000$A00000000000";function d(){return window.location.pathname.split("/").pop()===c}function p(){return{accountPrivs:{},advPolicy:{},cdn:"",clientIp:"",collab_client_vars:{apid:{},apool:{numToAttrib:{0:["flowid","BB08J2"],1:["flowid","LSTTMP"],2:["story-type","list-template"]},nextNum:3},bad:-1,client:{upid:c,sid:"",sig:"",tid:0},dirty:-1,dver:window.App.GlobalConfig.globalCodeVersion,globalPadId:u,gray:-1,header:[],isChunked:!1,initialAttributedText:{text:"%0A%0F%03%02%0A%03%0A",attribs:"+2*0+1*1*2+1+1*1*2+1+1"},padId:l,padSubId:"BB08J2",padType:"doc",pollingAttemptNumber:-1,pos:1,pver:2,rev:0,ver:2147483647,websocket:!1,websocketReopenCount:-1,wmode:"wb"},colorPalette:[],creatorDomain:"300000000",creatorId:"",disableFB:!1,docStatus:-1,domainId:"300000000",dropboxConnected:!1,encrypted:"",envi:null,friendUserIds:[],globalPadId:u,initialOptions:{},initialRevisionList:[],initialTitle:"",invitedGroupInfos:[],invitedUserInfos:[],isCreator:!0,isDesktopApp:!1,isEmbed:!1,isIPad:o.t.isIPad(),isIPhone:o.t.isIPhone(),isLogin:!0,isMac:o.t.isMac(),isMobile:o.t.isMobile(),isMobileApp:!1,isNewProject:!1,isOpendocxfromTim:!1,isOverConNum:!1,isOwner:!0,isPadAdmin:!1,isProPad:!1,isPublicPad:!1,isTIM:!1,isTimDomain:!1,isTimOnline:!1,isUserChangeTitle:-1,localPadId:l,newOpenSvc:-1,ownerAppid:"",ownerId:"",originalUrl:"",padId:l,padStatus:r.DL.LOCAL,padTitle:(0,a.$t)(""),padType:"doc",pagingFlag:"",personalizeInfo:{background:{id:"",transparency:0},mode:0},policy:-1,privilegeAttribute:{can_about:1,can_add_user:0,can_apply_edit:1,can_comment:0,can_copy:1,can_copy_doc:1,can_edit:0,can_edit_title:0,can_history:0,can_link_exp:0,can_print:1,can_read:1,can_search:1,can_share:1,can_spit_slot:1,can_translate:1,can_view_image:1,can_watermark:0,is_auth:0},privilegeExpire:-1,proTitle:"",rightFlag:4294967295,shortLink:"",shouldGetFbLoginStatus:!1,siteName:"",titleIsReadOnly:!1,uin:(0,i.k8)("uin"),useFbChat:!1,userColor:-1,userDomain:"",userId:(0,s.getUid)(),userInfo:{},userIsGuest:!1,userLink:"",userName:"",userPic:"",userType:"",xsrf:"",metaCreateTime:15489504e5,lastModifyTime:15489504e5,lastModifyUser:""}}},54267:function(e,t,n){n.d(t,{W:function(){return d},w:function(){return p}});var r=n(85556),o=n(81814),i=n(13980),a=n(70794),s=n(99925),c=n(79329),l=n(89407);function u(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,a;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return n=(0,i.getUid)(),a=(new o.he).addCondition("globalPadId",o.E1.ONLY,e).addCondition("uid",o.E1.ONLY,n),[4,c.Wo.getDataBase().updateField(o.me.PAD_INFO,a,t)];case 1:return[2,r.sent()]}}))}))}function d(e){return!!e&&e.collab_client_vars.initialAttributedText.text.length>524288}function p(e,t){return(0,r.__awaiter)(this,void 0,Promise,(function(){var n,i,p,h;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return!window.App.GlobalConfig.IsSupportStore||(0,a.re)("prerender")||d(e)?[2,!1]:e?[4,c.Wo.DBStatusPromise]:[3,6];case 1:return r.sent()!==c.q7.InitFinish?[3,6]:[4,(0,l.C)(e.globalPadId,e.collab_client_vars.rev)];case 2:return(n=r.sent()).error&&s.j.error(s.w.Offline,"deleteServerResult error: ".concat(JSON.stringify(n.error))),t&&(e.collab_client_vars.initialAttributedText.text=t),i=c.Wo.getHelper().clientVars2OfflineData(e.globalPadId,e),s.j.info(s.w.Offline,"saveClientVarsToDataBase success, rev ".concat(e.collab_client_vars.rev)),[4,c.Wo.getDataBase().update(o.me.DOCUMENT_DATA,i)];case 3:return(p=r.sent()).error?(s.j.error(s.w.Offline,"updateClientVars error: ".concat(JSON.stringify(p.error))),[3,6]):[3,4];case 4:return s.j.info(s.w.Offline,"clientVars DB"),[4,u(e.globalPadId,{isOfflineCache:!0})];case 5:(h=r.sent()).error&&s.j.error(s.w.Offline,"updatePadInfo error:".concat(JSON.stringify(h.error))),r.label=6;case 6:return[2,!0]}}))}))}},90815:function(e,t,n){n.d(t,{K:function(){return i}}),n(30479);var r=n(39445),o=n(50263),i=function(){function e(){}return e.hideFirsScreenLoading=function(e){var t=this;void 0===e&&(e=!1),window.fisrtScreenLoading&&window.fisrtScreenLoading.hide();var n=function(){var e,n;null===(n=null===(e=window.tdocs)||void 0===e?void 0:e.firstLoadFinished)||void 0===n||n.call(e),o.A.isMeetingEnv()&&o.A.closeLoadingInEdit(),t.isWeworkTimeline()&&window.parent.postMessage({name:"firstLoadFinished",data:{docUrl:location.href,from:"page"}},"*")};e?n():(0,r.hM)(n)},e.isWeworkTimeline=function(){return!1},e}()},72473:function(e,t,n){n.d(t,{t:function(){return r}});var r=function(){function e(){}return e.now=function(){var e;return(null===(e=window.performance)||void 0===e?void 0:e.timing)&&window.performance.now?performance.timing.navigationStart+window.performance.now():Date.now()},e.mark=function(t){this.cache.set(t,e.now())},e.getMark=function(e){return this.cache.get(e)},e.measure=function(t,n){var r=this.cache.get(t),o=n?this.cache.get(n):e.now();return r&&o?o-r:0},e.clearMarks=function(){this.cache.clear()},e.cache=new Map,e}()},82751:function(e,t,n){n.d(t,{j:function(){return r},p:function(){return i}});var r,o=n(35026);!function(e){e[e.ALL=0]="ALL",e[e.Titlebar=1]="Titlebar",e[e.Toolbar=2]="Toolbar"}(r||(r={}));var i=function(){function e(){}return e.show=function(){var e;o.RH.isMobile()?(e=document.getElementById("mobile-preload-header"))&&(e.style.opacity="1",e.style.display="block"):(this.tryToClearHeaderTimerId(),(e=document.getElementById("pc-preload-header"))&&(e.style.opacity="1",e.style.display="block"))},e.hide=function(t){if(o.RH.isMobile()){var n=document.getElementById("mobile-preload-header");n&&(n.style.display="none")}else{if(t===r.ALL){var i=document.getElementById("pc-preload-header");if(i){var a=o.RH.isEnterpriseEnv(),s=o.RH.isEnterpriseEnv()?700:300;!a&&(i.style.opacity="0"),this.tryToClearHeaderTimerId(),e.hidePreloadHeaderId=window.setTimeout((function(){a&&(i.style.opacity="0"),i.remove()}),s)}}t===r.Titlebar&&e.hidePreloadTitlebar(),t===r.Toolbar&&e.hidePreloadToolbar()}},e.setupToolbarStyle=function(){var e=document.getElementById("workbench-toolbar"),t=document.getElementById("workbench_toolbar_ssr");if(e&&t){var n=t.getBoundingClientRect().height;n&&(e.style.height="".concat(n,"px"))}},e.hidePreloadTitlebar=function(){var e=document.getElementById("workbench_titlebar_ssr"),t=document.getElementById("header_legacy_titlebar_ssr");(t||e)&&(this.tryToClearHeaderTimerId(),null==t||t.remove(),null==e||e.remove())},e.hidePreloadToolbar=function(){var e=document.getElementById("workbench_toolbar_ssr"),t=document.getElementById("header_legacy_toolbar_ssr");(e||t)&&(this.tryToClearHeaderTimerId(),null==e||e.remove(),null==t||t.remove())},e.tryToClearHeaderTimerId=function(){e.hidePreloadHeaderId&&(window.clearTimeout(e.hidePreloadHeaderId),e.hidePreloadHeaderId=void 0)},e.hideStatusbar=function(){var e=document.getElementById("pc-preload-statusbar");null==e||e.remove()},e}()},37084:function(e,t,n){n.d(t,{L:function(){return y}});var r=n(85556),o=n(39445),i=n(24689),a=n(87418),s=n(90815),c=n(88655),l=n(30479),u=n(82751),d=n(35026),p=function(){function e(e){this.snapshotContainerId="placeholder-ssr-dom",this.snapshotId="snap-shot-page",this.isPublish=void 0!==e?e:window.isPublishedURL}return e.prototype.showSnapShot=function(e){this.hideSnapshot(),(0,l.supportNativeTitleBar)("doc")||u.p.show();var t=document.getElementById(this.snapshotContainerId);if(t){var n=e.data;if(t.insertAdjacentHTML("afterbegin",n),d.RH.isMobile()){var r=t.getElementsByClassName("surface")[0];r&&r.insertAdjacentHTML("afterbegin",this.getPageSetting())}return this.hideFirsScreenLoading(),window.setTimeout((function(){var e=document.getElementById("content-container");e&&(e.style.opacity="1")})),!0}return!1},e.prototype.hideFirsScreenLoading=function(){window.fisrtScreenLoading&&window.fisrtScreenLoading.hide(),requestAnimationFrame((function(){requestAnimationFrame((function(){var e,t;null===(t=null===(e=window.tdocs)||void 0===e?void 0:e.firstLoadFinished)||void 0===t||t.call(e)}))}))},e.prototype.hideSnapshot=function(){var e=document.getElementById(this.snapshotId);e&&e.remove()},e.prototype.getPageSetting=function(){if(d.RH.isMobile()){var e={},t={width:document.documentElement.clientWidth||0,height:document.documentElement.clientHeight||0},n="";if(d.RH.isAPad()||!d.RH.isMobile()||d.RH.isIPad()){if(d.RH.isMobile()&&d.RH.isIPad()||d.RH.isAPad()&&d.RH.isTencentDocsApp()&&d.RH.checkTencentDocAppVersionSupportFunction("2.1.9")){var r=void 0,o={width:640,horizontalMargin:t.width>820?(t.width-700)/2:60},i={width:320,horizontalMargin:20};r=t.width>=o.width?o.horizontalMargin:t.width>=i.width?i.horizontalMargin:16,e.pageHeight=t.height,e.pageWidth=t.width-0-2*r,e.marginTop=68,e.marginBottom=148,e.marginLeft=19,e.marginRight=19}}else e.pageHeight=t.height,e.pageWidth=t.width-0,e.marginTop=d.RH.isWework()?32:76,e.marginBottom=48,e.marginLeft=19,e.marginRight=19;return n||(n="<style scoped> .melo-page-view { min-height: ".concat(e.pageHeight-e.marginTop-e.marginBottom,"px !important; width: ").concat(e.pageWidth-e.marginLeft-e.marginRight,"px !important; padding: ").concat(e.marginTop,"px ").concat(e.marginRight,"px ").concat(e.marginBottom,"px ").concat(e.marginLeft,"px !important; } </style>")),n}return""},e}(),h="QuickLook",f=function(e){function t(t,n){var r=e.call(this,n)||this;return r.secretId=t,r}return(0,r.__extends)(t,e),t.prototype.doQuickLook=function(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return e?[2,this.showSnapShot(e)]:[4,c.b.getInstance().getSnapshotData(this.secretId,this.isPublish)];case 1:return(t=n.sent())?[2,this.showSnapShot(t)]:(d.n4.warn(h,"snapshot"),[2,!1])}}))}))},t.prototype.hideFirsScreenLoading=function(){s.K.hideFirsScreenLoading()},t.prototype.showSnapShot=function(t){if(i.u.getInstance(this.secretId).docRendered||i.u.getInstance(this.secretId).docRenderFailed)return!1;var n=e.prototype.showSnapShot.call(this,t);return n&&(i.u.getInstance(this.secretId).quickLookType=t.type),n},t}(p),g=n(72473),v=n(20700),y=function(){function e(){this.init(window.location.href)}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.init=function(e){this.secretId=(0,o.Zh)(e),this.isPublish=window.isThisPublishedURL(e),this.quickLook=new f(this.secretId,this.isPublish)},e.prototype.start=function(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,n;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return g.t.mark(a.Fu.SnapshotShowStart),t=!0,i.u.getInstance(this.secretId).quickLookShowTime=0,i.u.getInstance(this.secretId).docRendered=!1,i.u.getInstance(this.secretId).docRenderFailed=!1,[4,this.quickLook.doQuickLook(e)];case 1:return(t=r.sent())&&(g.t.mark(a.Fu.SnapshotShowEnd),n=g.t.now(),i.u.getInstance(this.secretId).quickLookShowTime=n,d.n4.info(h,"Timing| quickLookShowTime:".concat(n," cost:").concat(n-v.f.getStartTime()," result ").concat(t))),[2]}}))}))},e.prototype.onReset=function(e,t,n){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return this.hide(!1),this.init(t),[4,this.start(n)];case 1:return e.sent(),[2]}}))}))},e.prototype.hide=function(e){if(void 0===e&&(e=!0),e){var t=document.getElementById("editor-mask");t&&(t.style.visibility="hidden",d.n4.info(h,"hideEditorMask",(new Date).toString()))}this.quickLook.hideSnapshot()},e}();window.QuickLookController=y},88655:function(e,t,n){n.d(t,{b:function(){return f}});var r,o=n(85556),i=n(44057),a=n.n(i),s=n(26914),c=n(35026),l=n(72473),u=n(87418),d=n(13980),p=["docs_word_snapshot_db","docs_word_quicklook_db","docs_word_quicklook_db_lite"],h="QuickLookDB";!function(e){e.QUICK_LOOK_WORD="QuickLookWord"}(r||(r={}));var f=function(){function e(){this.uid=a().get("uin")||(0,d.getUid)()}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.getSnapShotBodyKey=function(e,t){return t?"snapshot-iframe-".concat(e,"-").concat(this.uid,"-pub"):"snapshot-iframe-".concat(e,"-").concat(this.uid)},e.prototype.deleteOldDB=function(){var e=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;e&&e.deleteDatabase&&p.forEach((function(t){e.deleteDatabase(t)}))},e.prototype.initDataBase=function(){return(0,o.__awaiter)(this,void 0,void 0,(function(){var e,t;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return this.database?[2,!0]:(this.deleteOldDB(),l.t.mark(u.Fu.SnapshotInitDataBaseStart),[4,(e=new s.ZP("docs_word_quicklook_db_shell",[{tableName:r.QUICK_LOOK_WORD,keyName:"key"}],this.isSupportClientDB()?s.XT.ClientDB:s.XT.IndexDB,1)).init()]);case 1:return(t=n.sent()).error?(c.n4.error(h,"db",t.error),[2,!1]):(l.t.mark(u.Fu.SnapshotInitDataBaseEnd),this.database=e.database,[2,!0])}}))}))},e.prototype.isSupportClientDB=function(){var e=navigator.userAgent.match(/_tdocFlag\/(\d+)/);return!(!e||!e[1])&&2&parseInt(e[1],10)},e.prototype.getSnapshotData=function(e,t){return(0,o.__awaiter)(this,void 0,Promise,(function(){var n,i,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return[4,this.initDataBase()];case 1:return o.sent(),this.database?(l.t.mark(u.Fu.SnapshotGetStart),n=this.getSnapShotBodyKey(e,t),i=s.he.newInstance().addCondition("key",s.E1.ONLY,n),[4,this.database.get(r.QUICK_LOOK_WORD,i)]):(c.n4.error(h,""),[2,void 0]);case 2:return(a=o.sent()).error?(c.n4.warn(h,"no such snapshot body",n),[2,void 0]):(l.t.mark(u.Fu.SnapshotGetEnd),[2,{data:a.data.data,time:a.data.time,type:a.data.type||u.Ag.DEFAULT}])}}))}))},e.prototype.saveSnapshotData=function(e,t,n){return(0,o.__awaiter)(this,void 0,void 0,(function(){var i,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return[4,this.initDataBase()];case 1:return o.sent(),this.database?(l.t.mark(u.Fu.SnapshotSaveStart),i=this.getSnapShotBodyKey(e,t),[4,this.database.update(r.QUICK_LOOK_WORD,{key:i,data:n.data,time:n.time||+new Date,type:n.type})]):(c.n4.error(h,""),[2,!1]);case 2:return(a=o.sent()).error||!a.data?(c.n4.error(h,""),[2,!1]):(l.t.mark(u.Fu.SnapshotSaveEnd),[2,!0])}}))}))},e.prototype.deleteSnapshotData=function(e,t){return(0,o.__awaiter)(this,void 0,void 0,(function(){var n,i;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return[4,this.initDataBase()];case 1:return o.sent(),this.database?(n=this.getSnapShotBodyKey(e,t),i=s.he.newInstance().addCondition("key",s.E1.ONLY,n),[4,this.database.delete(r.QUICK_LOOK_WORD,i)]):(c.n4.error(h,""),[2,!1]);case 2:return[2,!o.sent().error]}}))}))},e}()},87418:function(e,t,n){var r,o,i;n.d(t,{Ag:function(){return r},Fu:function(){return o},w0:function(){return i}}),function(e){e[e.DEFAULT=0]="DEFAULT",e[e.EDIT=1]="EDIT",e[e.SSR=2]="SSR",e[e.CSR=3]="CSR",e[e.CSR_NATIVE=4]="CSR_NATIVE"}(r||(r={})),function(e){e.SnapshotShowStart="SnapshotShowStart",e.SnapshotShowEnd="SnapshotShowEnd",e.SnapshotShowRenderEnd="SnapshotShowRenderEnd",e.SnapshotInitDataBaseStart="SnapshotInitDataBaseStart",e.SnapshotInitDataBaseEnd="SnapshotInitDataBaseEnd",e.SnapshotGetStart="SnapshotGetStart",e.SnapshotGetEnd="SnapshotGetEnd",e.SnapshotSaveStart="SnapshotSaveStart",e.SnapshotSaveEnd="SnapshotSaveEnd",e.SnapshotGenerateStart="SnapshotGenerateStart",e.SnapshotGenerateEnd="SnapshotGenerateEnd"}(o||(o={})),function(e){e.SnapshotShowCost="SnapshotShowCost",e.SnapshotShowRenderCost="SnapshotShowRenderCost",e.SnapshotInitDataBaseCost="SnapshotInitDataBaseCost",e.SnapshotGetCost="SnapshotGetCost",e.SnapshotSaveCost="SnapshotSaveCost",e.SnapshotGenerateCost="SnapshotGenerateCost"}(i||(i={}))},147:function(e,t,n){n.d(t,{F:function(){return c}});var r=n(85556),o=n(30479),i=(n(28223),n(39445)),a=n(78232),s=n(88655),c=function(){function e(){this.templateMap=new Map}return e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},e.prototype.getHtmlTemplate=function(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,o;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return t&&(n=this.templateMap.get(t))?[2,n]:[4,this.handleHtmlTemplate(e)];case 1:return(o=r.sent())?(t&&this.templateMap.set(t,o),[2,o]):[2,void 0]}}))}))},e.prototype.handleHtmlTemplate=function(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getHtmlTemplateFromServer(e)];case 1:return[2,(t=n.sent())?t.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,""):void 0]}}))}))},e.prototype.getHtmlTemplateFromServer=function(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return[2,new Promise((function(t){$.ajax({type:"GET",url:e,timeout:3e4,cache:!0,xhrFields:{withCredentials:!0},success:function(e){t(e)},error:function(){t(void 0)}})}))]}))}))},e.prototype.generateNativeSnapshot=function(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,n,o,i;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return t=e.url,n=e.dver,o=e.data,[4,this.getHtmlTemplate(t,n)];case 1:return!(i=r.sent())||i.search('<div id="placeholder-ssr-dom"></div>')<0?[2,void 0]:[2,i.replace('<div id="placeholder-ssr-dom"></div>','<div id="placeholder-ssr-dom">'.concat(o,"</div>"))]}}))}))},e.prototype.handleNativeSnapshot=function(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,r.__generator)(this,(function(o){switch(o.label){case 0:return[3,2];case 1:return(n=o.sent())?(a.M.generateNativeSnapshot((0,r.__assign)((0,r.__assign)({url:e,snapshot:t},n),{type:"html"})),[2,!0]):[2,!1];case 2:return[2,!1]}}))}))},e.prototype.handleSnapshotResult=function(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,a,c,l,u,d;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return n=e.type,a=e.url,c=e.data,l=(0,i.Zh)(a),[4,this.handleNativeSnapshot(e,t)];case 1:return u=r.sent(),o.Logger.log("SnapshotHelper","generateNativeSnapshot result:",u),d=window.isThisPublishedURL(a),[4,s.b.getInstance().saveSnapshotData(l,d,{type:n,data:c,time:+new Date})];case 2:return[2,r.sent()]}}))}))},e.prototype.deleteCurrentSnapshotData=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,t;return(0,r.__generator)(this,(function(n){return e=(0,i.pb)(),t=window.isPublishedURL,[2,this.deleteSnapshotData(window.location.href,e,t)]}))}))},e.prototype.deleteSnapshotData=function(e,t,n){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,s.b.getInstance().deleteSnapshotData(t,n)];case 1:return[2,e.sent()]}}))}))},e.prototype.getNativeSnapshotCost=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return[3,2];case 1:return[2,(e=t.sent())&&e.data&&e.data.detail_page_show_snapshot||-1];case 2:return[2,-1]}}))}))},e}()},20700:function(e,t,n){n.d(t,{f:function(){return c}});var r=n(72473),o=n(87418),i=n(24689),a=n(39445),s=n(44166),c=function(){function e(){}return e.getStartTime=function(){var e=i.u.getInstance((0,a.pb)()).replaceUrlTime;if(e>0)return e;var t=window.performance.timing?window.performance.timing.navigationStart:0;return 1===(0,s.Yi)().collab_client_vars.isMeloUp&&"number"==typeof(0,s.Yi)().collab_client_vars.meloUpCost&&(t+=(0,s.Yi)().collab_client_vars.meloUpCost||0),t},e.getSingleStepCost=function(e){switch(e){case o.w0.SnapshotShowCost:return r.t.measure(o.Fu.SnapshotShowStart,o.Fu.SnapshotShowEnd);case o.w0.SnapshotShowRenderCost:return r.t.measure(o.Fu.SnapshotShowEnd,o.Fu.SnapshotShowRenderEnd);case o.w0.SnapshotInitDataBaseCost:return r.t.measure(o.Fu.SnapshotInitDataBaseStart,o.Fu.SnapshotInitDataBaseEnd);case o.w0.SnapshotGetCost:return r.t.measure(o.Fu.SnapshotGetStart,o.Fu.SnapshotGetEnd);case o.w0.SnapshotSaveCost:return r.t.measure(o.Fu.SnapshotSaveStart,o.Fu.SnapshotSaveEnd);case o.w0.SnapshotGenerateCost:return r.t.measure(o.Fu.SnapshotGenerateStart,o.Fu.SnapshotGenerateEnd);default:return}},e.getStepCostFromStart=function(e){var t=r.t.getMark(e);if(t)return t-this.getStartTime()},e.getAllPerformanceCost=function(){var e=this,t={};return Object.values(o.Fu).forEach((function(n){var r=e.getStepCostFromStart(n);r&&(t[n]=r)})),Object.values(o.w0).forEach((function(n){var r=e.getSingleStepCost(n);r&&(t[n]=r)})),t},e}()},35026:function(e,t,n){n.d(t,{RH:function(){return o},n4:function(){return i}});var r=n(85556),o=function(){function e(){}return e.isMobile=function(){return/(mobile)/i.test(navigator.userAgent)||/(android)/i.test(navigator.userAgent)},e.isAndroid=function(){return/(android)/i.test(navigator.userAgent)},e.isIOS=function(){return/(iphone|ipad|ipod)/i.test(navigator.userAgent)},e.isIPad=function(){return/(ipad)/i.test(navigator.userAgent)},e.isAPad=function(){return!/(mobile)/i.test(navigator.userAgent)&&/android/i.test(navigator.userAgent)&&/TencentDocs/i.test(navigator.userAgent)},e.isTencentDocsApp=function(){return/TencentDocs/i.test(navigator.userAgent)},e.checkTencentDocAppVersionSupportFunction=function(e){return(0,r.__read)(window.navigator.userAgent.match(/TencentDocs\/(\S*)/),2)[1]>=e},e.isWework=function(){return/(wxwork)/i.test(navigator.userAgent)},e.isEnterpriseEnv=function(){return"doc.weixin.qq.com"===window.location.hostname},e}(),i={info:function(){for(var e,t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];null===(t=null===(e=window.log)||void 0===e?void 0:e.info)||void 0===t||t.call.apply(t,(0,r.__spreadArray)([e],(0,r.__read)(n),!1))},warn:function(){for(var e,t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];null===(t=null===(e=window.log)||void 0===e?void 0:e.warn)||void 0===t||t.call.apply(t,(0,r.__spreadArray)([e],(0,r.__read)(n),!1))},error:function(){for(var e,t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];null===(t=null===(e=window.log)||void 0===e?void 0:e.error)||void 0===t||t.call.apply(t,(0,r.__spreadArray)([e],(0,r.__read)(n),!1))}};!function(){function e(){}e.getUrlParameter=function(e){return this.getUrlParameterFromSearch(window.location.search,e)},e.getUrlParameterFromUrl=function(e,t){var n=new URL(e);return this.getUrlParameterFromSearch(n.search,t)},e.getUrlParameterFromSearch=function(e,t){var n=new RegExp("(^|&)".concat(t,"=([^&]*)(&|$)"),"i"),r=e.substr(1).match(n);return null!==r?unescape(r[2]):null}}()},85464:function(e,t,n){n.d(t,{W:function(){return c},v:function(){return l}});var r=n(30479),o=n(32158),i=n(64261),a=n(12036),s=n(38429),c={get isWeworkEnv(){return!1},get collabShowMode(){return c.isWeworkEnv?"eyes":""},get isEntAccount(){var e,t,n,r,o,i;return!window.clientVars&&!window.basicClientVars||!!(null===(t=null===(e=window.clientVars)||void 0===e?void 0:e.userInfo)||void 0===t?void 0:t.corpId)||!!(null===(r=null===(n=window.clientVars)||void 0===n?void 0:n.userInfo)||void 0===r?void 0:r.corp_id)||!!(null===(i=null===(o=null===window||void 0===window?void 0:window.basicClientVars)||void 0===o?void 0:o.userInfo)||void 0===i?void 0:i.corpId)},get isEntAccountViewToCDoc(){return c.isEntAccount&&!0},get isCVisitBAccount(){var e,t,n,r;return(null===(t=null===(e=window.clientVars)||void 0===e?void 0:e.userInfo)||void 0===t?void 0:t.corpId)||null===(r=null===(n=window.basicClientVars)||void 0===n?void 0:n.userInfo)||void 0===r||r.corpId,!1},get hasBasicClientVars(){return!!window.basicClientVars},get showAccount(){return!r.PlatformUtil.isWeWorkMacOrWin()||!c.isEntAccount},get isTdocsEnv(){var e;return!!(null===(e=window.tdocs)||void 0===e?void 0:e.openUrl)},get isEntAccountInTdocs(){return this.isEntAccountViewToCDoc&&this.isTdocsEnv},get isHideCollab(){return window.isHideCollab},get isWeWortkDiscussionDoc(){return!1},get isWeWortkEmbeddedDiscussionDoc(){return this.isWeWortkDiscussionDoc&&/isConversationEmbedded=1/.test(window.location.search)},get isApiDoc(){return!1},get isRedBookEnt(){var e;return"1970324973013456"===(null===(e=window.clientVars)||void 0===e?void 0:e.userInfo.corpId)&&!1},get isTencentEnt(){var e;return"1970325010981265"===(null===(e=window.clientVars)||void 0===e?void 0:e.userInfo.corpId)&&!1},get isFreegoEnv(){return a.M.getCookie("free_go_id")&&a.M.getCookie("free_go_proxy")&&!1},get isTencentFreegoEnv(){return this.isFreegoEnv&&this.isTencentEnt},get isTestEnt(){var e;return"1970324967519346"===(null===(e=window.clientVars)||void 0===e?void 0:e.userInfo.corpId)&&!1},get isBDTestEnt(){var e;return"1970325072144186"===(null===(e=window.clientVars)||void 0===e?void 0:e.userInfo.corpId)&&!1},get creatorNick(){return(0,o.qV)()},get creatorId(){var e=(0,o.mV)();if(e){var t=(i.wdocsUserCenter.get(e)||{}).vid;return void 0===t?"":t}return""},get isLocalEdit(){return s.cm}},l=c},679:function(e,t,n){n.d(t,{Cb:function(){return p},LU:function(){return u},NI:function(){return r},fm:function(){return l},s2:function(){return d},tZ:function(){return o}});var r,o,i=n(23336),a=n.n(i),s=n(30479),c=(n(2613),n(21856)),l="wemeetSuspendInfo",u="isInWemeetFollowStatus";function d(e){return void 0===e&&(e={}),new Promise((function(t,n){a().ajax({url:c.X.getInstance().getConfig("custom.links.meetingPresentInfo"),data:e,type:"GET",contentType:"application/json; charset=utf-8",success:function(e){if(0===e.retcode)try{var o=void 0,i=e.result,a=JSON.parse(i),c=a.editPos,l=a.hostInfo;c&&(o=JSON.parse(c));var u={hostInfo:l,wemeetInfo:o};e.result=i,t(u)}catch(e){s.Logger.error("presentInfo parse fail",e)}else n(r.DATA_ERROR)},error:function(){n(r.NET_ERROR)}})}))}function p(e){return void 0===e&&(e={}),new Promise((function(t,n){a().ajax({url:c.X.getInstance().getConfig("custom.links.meetingPresentInfo"),data:JSON.stringify(e),type:"POST",contentType:"application/json; charset=utf-8",success:function(e){0!==e.retcode&&n(e),t(e)},error:function(e){n(e)}})}))}!function(e){e.NET_ERROR="net_error",e.DATA_ERROR="data_error"}(r||(r={})),function(e){e.HOST="HOST",e.AUDIENCE="AUDIENCE",e.UNKNOWN="UKNOWN"}(o||(o={}))},31218:function(e,t,n){n.r(t),n.d(t,{EditorState:function(){return r},IEditorStateFeature:function(){return c}});var r,o=n(85556),i=n(3139),a=n(22595),s=n(54541);!function(e){e.STATE_INPUT="state_input",e.STATE_EDIT="state_edit",e.STATE_VIEW="state_view",e.STATE_KEEP="state_keep",e.STATE_MOBILE_BLOCK="state_mobile_block"}(r||(r={}));var c=Symbol.for("feature:".concat(a.C.EditorState));i.Ln.merge(c,{useFactory:function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(8174).then(n.bind(n,63674))];case 1:return[2,e.sent().EditorStateHandler]}}))}))},on:s.iz.On({stages:[s.YV.Level2],key:c,platforms:[s.Ev.Mobile,s.Ev.Pad]})})},25458:function(e,t,n){var r;n.d(t,{K:function(){return r},w:function(){return o}}),function(e){e[e.CanMove=22]="CanMove",e[e.DocDelete=23]="DocDelete",e[e.CanReadComment=36]="CanReadComment",e[e.ObjAuthInfo=100]="ObjAuthInfo",e[e.CanModifyAuthSelfInvited=104]="CanModifyAuthSelfInvited",e[e.CanModifyAuthAny=103]="CanModifyAuthAny",e[e.CanModifyAuthInternal=106]="CanModifyAuthInternal",e[e.CanModifyAuthExternal=107]="CanModifyAuthExternal",e[e.DocSaveAsLink=154]="DocSaveAsLink",e[e.CanMoveDoc=22]="CanMoveDoc",e[e.CanForward=33]="CanForward",e[e.CanShareByLink=27]="CanShareByLink",e[e.CanShareToExternal=115]="CanShareToExternal"}(r||(r={}));var o=function(e,t){return!!e&&-1!==e.indexOf(t)}},22595:function(e,t,n){var r;n.d(t,{C:function(){return r}}),function(e){e.Accessibility="accessibility",e.AdMobile="ad_mobile",e.AddFastAccess="add_fast_access",e.AddCooperator="add_cooperator",e.AddToWedrive="add_to_wedrive",e.Addon="addon",e.AddonHina="addon_hina",e.AddonIframe="addon_iframe",e.AddonNew="addon_new",e.AddonMobileIframe="addon_mobile_iframe",e.AddonPaste="addon_paste",e.AddonScene="addon_scene",e.AirPrint="air_print",e.AppGuide="app_guide",e.AppGuidePc="app_guide_pc",e.CollabStatusTobWebMobile="collab_status_tob_web_mobile",e.Attachment="attachment",e.AttachmentReadonly="attachment_readonly",e.AttachmentRender="attachment_render",e.Audio="audio",e.AtRecordScroll="at_record_scroll",e.Background="background",e.BasicFormat="basic_format",e.Bookmark="bookmark",e.BottomBarMobile="bottom_bar_mobile",e.BottomBar="bottom_bar",e.Certification="certification",e.CertificationMobile="certification_mobile",e.DiscussionEnt="discussion_ent",e.DiscussionEntMobile="discussion_ent_mobile",e.Codeblock="codeblock",e.CollabCaret="collab_caret",e.CollabStatus="collab_status",e.CollabStatusEnt="collab_status_ent",e.CollabStatusMobile="collab_status_mobile",e.CollabStatusEntMobile="collab_status_ent_mobile",e.CollectPc="collect_pc",e.Color="color",e.Column="column",e.CommentCore="comment_core",e.CommentEnt="comment_ent",e.CommentEntMobile="comment_ent_mobile",e.CommentEntPc="comment_ent_pc",e.CommentMobile="comment_mobile",e.CommentPc="comment_pc",e.ContextToolbar="context_toolbar",e.ContextmenuMobile="contextmenu_mobile",e.CopySharelink="copy_sharelink",e.CopyPasteProcessor="copy_paste_processor",e.CoreEdit="core_edit",e.DiffView="diff_view",e.DiffViewMobile="diff_view_mobile",e.DocPreview="doc_preview",e.DocViewMobile="doc_view_mobile",e.DoclinkPaste="doclink_paste",e.CollaboratorDetailMobile="collaborator_detail_mobile",e.EditFollow="edit_follow",e.EditTipsMobile="edit_tips_mobile",e.EditorState="editor_state",e.ExternalTag="external_tag",e.Fanbook="fanbook",e.FastEdit="fast_edit",e.Field="field",e.FieldDate="field_date",e.FieldPageRef="field_page_ref",e.FieldRender="field_render",e.Hyperlink="hyperlink",e.FieldcodeDate="fieldcode_date",e.FieldcodeDateMobile="fieldcode_date_mobile",e.FieldcodeDocLink="fieldcode_doc_link",e.FieldcodeMention="fieldcode_mention",e.FieldcodePage="fieldcode_page",e.FieldocdeHyperlink="fieldocde_hyperlink",e.FieldcodeWeixinMention="fieldcode_weixin_mention",e.FileBase="file_base",e.FileExport="file_export",e.HelpAndFeedBack="help_and_feedback",e.HelpEditFunction="headerbar_edit_fun",e.SyncTencentList="sync_tencent_list",e.TobRecentInputText="tob_recent_input_text",e.FileInfoPanelMobile="file_info_panel_mobile",e.SyncTencentListMobile="sync_tencent_list_mobile",e.FileInfoPanelPc="file_info_panel_pc",e.FileMobile="file_mobile",e.FilePc="file_pc",e.FileWechat="file_wechat",e.FloatToolbar="float_toolbar",e.Font="font",e.FormatPainter="format_painter",e.Fullscreen="fullscreen",e.Heading="heading",e.HelpCenter="help_center",e.HelpCenterMobile="help_center_mobile",e.Hint="hint",e.HomeMobile="home_mobile",e.Image="image",e.ImageMobile="image_mobile",e.ImagePc="image_pc",e.ImageReadonly="image_readonly",e.IpadAppKeyboard="ipad_app_keyboard",e.KeymapList="keymap_list",e.Latex="latex",e.LightBlock="light_block",e.Like="like",e.LikeMobile="like_mobile",e.Link="link",e.List="list",e.ListReadonly="list_readonly",e.Location="location",e.Login="login",e.ManualOffline="manual_offline",e.Markdown="markdown",e.MiniList="mini_list",e.MiniListEnt="mini_list_ent",e.MobileAutoScroll="mobile_auto_scroll",e.MobileBlock="mobile_block",e.MobileBlockBottomBar="mobile_block_bottom_bar",e.MobileBlockHeader="mobile_block_header",e.MobileGesture="mobile_gesture",e.MobileHeader="mobile_header",e.MobileNativeHeader="mobile_native_header",e.MobileEnterpriseHeader="mobile_enterprise_native_header",e.MobileMoreMenu="mobile_more_menu",e.MobilePagedView="moblie_paged_view",e.MobileTips="mobile_tips",e.MobileView="mobile_view",e.MoveTo="move_to",e.MoveToMobile="move_to_mobile",e.TitlebarMoveFile="titlebar_move_file",e.TitlebarCollect="titlebar_collect",e.CollectMobile="collect_mobile",e.QuicklyVisitMobile="quickly_visit_mobile",e.SubscribeNoticeMobile="subscribe_notice_mobile",e.NewpadInputTips="newpad_input_tips",e.Ocr="ocr",e.OcrPc="ocr_pc",e.OcrPreview="ocr_preview",e.OfflineEdit="offline_edit",e.OfflineStatus="offline_status",e.OpenAPI="open_api",e.Outline="outline",e.OutlineMobile="outline_mobile",e.Page="page",e.PageShade="page_shade",e.PageWeb="page_web",e.Paragraph="paragraph",e.ParagraphDragMobile="paragraph_drag_mobile",e.ParagraphShortcutMenu="paragraph_shortcut_menu",e.PerformanceReport="performance_report",e.PermissionRange="permission_range",e.Presentation="presentation",e.PresentationPlayer="presentation_player",e.Print="print",e.Publish="publish",e.Quote="quote",e.QuoteBase="quote_base",e.ReadRecord="read_record",e.TobReadonlyTips="tob_readonly_tips",e.ReadonlyTips="readonly_tips",e.RecoverDoc="recover_doc",e.RepeatLast="repeat_last",e.ResizeAdapt="resize_adapt",e.RevisionRecord="revision_record",e.ScrollPosition="scroll_position",e.ScrollbarHiddenMobile="scrollbar_hidden_mobile",e.Search="search",e.Section="section",e.SelectivePaste="selective_paste",e.Share="share",e.ShareMobile="share_mobile",e.ShareMobileWeb="share_mobile_web",e.Signature="signature",e.SnapScreenBase="snap_screen_base",e.SnapScreenMobile="snap_screen_mobile",e.SnapScreenPc="snap_screen_pc",e.Snippet="snippet",e.Spellcheck="spellcheck",e.Splitline="splitline",e.StarMobile="star_mobile",e.StatusTips="status_tips",e.Subscribe="subscribe",e.SubscriptionNotification="subscription_notification",e.SubscriptionNotificationMenu="subscription_notification_menu",e.SwitchCertification="switch_certification",e.SwitchCertificationMobile="switch_certification_mobile",e.Toc="toc",e.Table="table",e.TableShortcutMenu="table_shortcut_menu",e.TdocsAutoFocus="tdocs_auto_focus",e.TemplateInfo="template_info",e.TextDragMobile="text_drag_mobile",e.TextDragPc="text_drag_pc",e.TemplateList="template_list",e.TextFlow="text_flow",e.TextFrame="text_frame",e.Title="title",e.TitleColor="title_color",e.TitleDefaultAdd="title_default_add",e.TitleMobile="title_mobile",e.Titlebar="titlebar",e.TitlebarEnterprise="titlebar_enterprise",e.TitlebarFold="titlebar_fold",e.TitlebarMobile="titlebar_mobile",e.Toggle="toggle",e.Toolbar="toolbar",e.Translate="translate",e.UnreadNotify="unread_notify",e.UpdateNotice="update_notice",e.UserAvatar="user_avatar",e.Vip="vip",e.VisibilityChangeMobile="visibility_change_mobile",e.VoiceInput="voice_input",e.Watermark="watermark",e.WordCount="word_count",e.WxworkQuote="wxwork_quote",e.ZoomBase="zoom_base",e.ZoomMelo="zoom_melo",e.ZoomMobile="zoom_mobile",e.ZoomPc="zoom_pc",e.TdocsFollowLineButtons="tdocs_follow_line_buttons",e.TdocsTdocsDeferredRender="tdocs_tdocs_deferred_render",e.TdocsTdocsRender="tdocs_tdocs_render",e.ListQwxTodo="list_qwx_todo",e.ListQwxtodoRender="list_qwx_todo_render",e.WxworkFollowLineButtons="wxwork_follow_line_buttons",e.WedocsProcesson="wedocs_processon",e.WedocsDiscuss="discuss",e.WxworkGroupChat="wxwork_group_chat",e.WxworkGroupContactCard="wxwork_group_contact_card",e.WxworkMemberContactCard="wxwork_member_contact_card",e.WxworkCalender="wxwork_calender",e.WxworkMeeting="wxwork_meeting",e.WxworkApp="wxwork_app",e.WxworkHint="wxwork_hint",e.TemplateRecommendation="template_recommendation",e.GuideToWework="guide_to_wework",e.WedriveAttachment="WedriveAttachment",e.LandspaceState="LandspaceState",e.AutoNewline="auto_newline",e.Comment="comment",e.WxworkRevisionRecord="wxwork_revision_record",e.ZoomWxwork="zoom_wxwork",e.WxworkHelpAndFeedback="wxwork_help_and_feedback",e.LocalFileSave="local_file_save",e.LocalEditMobile="local_edit_mobile",e.MobileLocalEditHeader="mobile_local_edit_header",e.ApiDocEnt="apidoc_ent",e.ApiDocEntMobile="apidoc_ent_mobile",e.FileInfoEntPc="fileinfo_in_menu_ent",e.WxworkColdStartButton="wxwork_cold_start_button",e.EmbeddedObject="embedded_object",e.PreloadPreviewImage="preload_preivew_image",e.ResumeGuide="resume_guide",e.ResumeGuideMobile="resume_guide_mobile",e.PdfTransform="pdf_transform"}(r||(r={}))},55946:function(e,t,n){n.d(t,{BM:function(){return c},gj:function(){return l},j5:function(){return s}});var r=n(85556),o=n(73695),i=n(30479),a=n(44166);function s(){var e;return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return(null===(e=null===window||void 0===window?void 0:window.discussionExt)||void 0===e?void 0:e.hasInit)?[3,2]:[4,new Promise((function(e){var t;null===(t=window.waitDiscussionCallbacks)||void 0===t||t.push(e)}))];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}n(25458);var c=function(e){var t=(0,a.Yi)().padId,n=(0,i.getUrlParameter)("scode")||"",s=(0,r.__assign)({scode:n,docid:t,type:o.i4.kTopicWedocWord},e),c=[];return Object.keys(s).map((function(e){var t=s[e];t instanceof Array?t.forEach((function(t){c.push("".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t)))})):void 0!==t&&c.push("".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t)))})),c.join("&")};function l(){return!0}},78232:function(e,t,n){n.d(t,{M:function(){return o}});var r=n(85556),o=function(){function e(){}return e.getNativeScreenSize=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,Promise.race([new Promise((function(e){window.mqq&&window.mqq.invoke("docx","getNativeScreenSize",{},(function(t){(null==t?void 0:t.data)?e(t.data):e(void 0)}))})),this.waitTimeout(void 0)])]}))}))},e.generateNativeSnapshot=function(e){window.mqq&&window.mqq.invoke("docx","generateNativeSnapshot",e)},e.deleteNativeSnapshot=function(e){window.mqq&&window.mqq.invoke("docx","deleteNativeSnapshot",e)},e.getMetric=function(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return[2,Promise.race([new Promise((function(t){window.mqq&&window.mqq.invoke("docx","getMetric",e,(function(e){(null==e?void 0:e.data)?t(e):t(void 0)}))})),this.waitTimeout(void 0,3e3)])]}))}))},e.waitTimeout=function(e,t){return void 0===t&&(t=15e3),(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(n){return[2,new Promise((function(n){window.setTimeout((function(){n(e)}),t)}))]}))}))},e}()},28372:function(e,t,n){n.d(t,{V:function(){return s}});var r=n(85556),o=n(3139),i=n(30479),a=n(64009),s=function(){function e(){}var t;return e.setBlankpageData=function(e,t){var n,r=3===e&&t&&t.data&&t.data.errcode?t.data:{};if(localStorage.setItem("blankPageData",JSON.stringify(r)),"player"!==(0,i.getUrlParameter)("show"))this.discussionService.hide(),this.hideNativeButtonsBeforeJump(),window.DocJumpBlankPage=!0,location.replace(window.multiAccountUtil.getMultiUrl(location.href.replace("/doc/","/blankpage/")));else{var o="tdocs".concat(JSON.stringify({msgType:"PlayerStateChange",msgData:JSON.stringify({playerAction:7})}));null===(n=null===window||void 0===window?void 0:window.parent)||void 0===n||n.postMessage(o,"*")}},e.hideNativeButtonsBeforeJump=function(){(0,i.supportNativeTitleBar)("doc")},(0,r.__decorate)([(0,o.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==a.Z&&a.Z)?t:Object)],e,"discussionService",void 0),e}()},64009:function(e,t,n){var r=n(85556),o=n(37769),i=function(){function e(){var e=this;this.waitForReady=function(){return e.waitForReadyPromise||(e.waitForReadyPromise=new Promise((function(e){var t;(null===(t=null===window||void 0===window?void 0:window.discussionExt)||void 0===t?void 0:t.hasInit)?e(!0):window.addEventListener("onDiscussionInit",(function(){return e(!0)}))}))),e.waitForReadyPromise}}return e.prototype.hide=function(){var e,t,n,r;null===(t=null===(e=null===window||void 0===window?void 0:window.discussionExt)||void 0===e?void 0:e.toggleBottomBar)||void 0===t||t.call(e,!1),null===(r=null===(n=null===window||void 0===window?void 0:window.discussionExt)||void 0===n?void 0:n.changeTab)||void 0===r||r.call(n,"none")},e=(0,r.__decorate)([(0,o.t)()],e)}();t.Z=i},38913:function(e,t,n){n.d(t,{$V:function(){return k},C3:function(){return A},EG:function(){return x},Ff:function(){return D},G3:function(){return E},GP:function(){return b},H_:function(){return l},K9:function(){return a},MY:function(){return _},N6:function(){return w},Ne:function(){return T},Rw:function(){return N},Sk:function(){return m},eU:function(){return M},hJ:function(){return L},jm:function(){return I},mX:function(){return s},mh:function(){return o},tx:function(){return c},vK:function(){return O},vp:function(){return P},y1:function(){return S}});var r,o,i,a,s,c,l,u=n(85556),d=n(30479),p=n(2613),h=n(86667),f=n.n(h),g=n(14366),v=n(44166),y=n(76343),m=!1;90===window.orientation||window.orientation,function(e){e[e.FOLD=0]="FOLD",e[e.EXPAND=1]="EXPAND"}(o||(o={})),function(e){e[e.kUser=1]="kUser",e[e.kParty=2]="kParty",e[e.kExternalVid=3]="kExternalVid",e[e.kWeChatXid=4]="kWeChatXid",e[e.kUinForWx=5]="kUinForWx",e[e.kMailUin=6]="kMailUin",e[e.kTxDocOpenGroup=7]="kTxDocOpenGroup",e[e.kTxDocTinyId=8]="kTxDocTinyId"}(i||(i={})),function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.MIDDLE=2]="MIDDLE",e[e.NONE=-1]="NONE"}(a||(a={})),function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.MIDDLE=2]="MIDDLE",e[e.NONE=-1]="NONE"}(s||(s={})),function(e){e.TEXT="text",e.IMAGE="image",e.COLLABORATOR="collaborator",e.ADD_COLLABORATOR="image",e.NOTIFICATION="image",e.NEW_COLLABORATOR="collaborator",e.OFFLINE="offline",e.SEPARATOR="separator"}(c||(c={})),function(e){e[e.SHOW=0]="SHOW",e[e.HIDE=1]="HIDE",e[e.DISABLE=2]="DISABLE",e[e.NONE=-1]="NONE"}(l||(l={}));var b,_={navigation_share:"0",navigation_more:"1",navigation_star:"2",icon_thirdary_star:"3",navigation_back:"4",navigation_collaborator:"11",navigation_auth:"15",done:"10",toolbar_undo:"5",toolbar_redo:"6",navigation_expand:"7",navigation_close:"16"};!function(e){e.BACK="back",e.COLLABORATOR="collaborator",e.NEW_COLLABORATOR="new_collaborator",e.ADD_COLLABORATOR="add_new_collaborator",e.NOTIFICATION="notification",e.TITLE="title",e.SHARE="share",e.MORE="more",e.DONE="done",e.UNDO="undo",e.REDO="redo",e.DISCUSSION="discussion"}(b||(b={}));var C,S,w={navigation_share:"0",navigation_more:"1",navigation_collaborator:"11",navigation_new_collaborator:"13",navigation_add_collaborator:"12",navigation_auth:"15",navigation_notification:"14",navigation_back:"4",navigation_discussion:"16",toolbar_undo:"5",toolbar_redo:"6"};!function(e){e[e.ONLY_VIEW=1]="ONLY_VIEW",e[e.CAN_EDIT=2]="CAN_EDIT",e[e.NONE=255]="NONE"}(C||(C={})),function(e){e.BACK="back",e.DONE="done",e.EXPAND="expand",e.TITLE="title",e.COLLABORATOR="collaborator",e.SEPARATOR="separator",e.OFFLINE="offline",e.UNDO="undo",e.REDO="redo",e.STAR="star",e.SHARE="share",e.MENU="menu",e.AUTH="auth",e.SAVE_LOCAL_FILE="saveLocalFile",e.EXIT="exit"}(S||(S={}));var E,x,T,R=((r={}).BROWSER_LIST="".concat("/","cgi-bin/online_docs/browser_list"),r);!function(e){e.NORMAL="normal",e.INPUT="input",e.LOCAL_EDIT_INPUT="localEditInput"}(E||(E={})),function(e){e.SHOW="show",e.HIDE="hide"}(x||(x={})),function(e){e.IN="in",e.OUT="out"}(T||(T={}));var I,P=function(){return!f().isTencentDocsApp||f().isTencentDocsAppVersionAboveOrEqual("2.16.9")},O=function(){var e=window.location.href.split("?")[0].split("/");return e[e.length-1]},k=function(e){return new Promise((function(t){var n=R.BROWSER_LIST,r=y.v.addFromParam(n,y.v.getEnvParam()),o=e.domainId,i=e.padId;$.ajax({url:r,data:{domain_id:o,pad_id:i,start:0,limit:0,xsrf:(0,p.getXsrf)(),t:(new Date).getTime()},success:function(e){e&&0===e.retcode&&t(e.total),t(0)},error:function(){t(0)}})}))},D=function(){return new Promise((function(e){window.mqq&&window.mqq.invoke&&window.mqq.invoke("docx","getTitleBarState",{},(function(t){var n=JSON.parse(t);e({zoomState:n.zoomState,backState:n.backState})}))}))},M=function(){return(0,u.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,r,o,i,a,s;return(0,u.__generator)(this,(function(c){switch(c.label){case 0:e=0,t=(0,v.Yi)(),n=t.padId,r=t.uin,c.label=1;case 1:return c.trys.push([1,3,,4]),l={docid:n,scode:(0,d.getUrlParameter)("scode")||"",vid:r,func:6},u=[],Object.keys(l).map((function(e){var t=l[e];t instanceof Array?t.forEach((function(t){u.push("".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t)))})):void 0!==t&&u.push("".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t)))})),o=u.join("&"),[4,g.Z.post("/wedoc/doc_member_mgr",o)];case 2:if(i=c.sent().data,0!==(null===(s=i.head)||void 0===s?void 0:s.ret))throw new Error("request /wedoc/doc_member_mgr fail, params: ".concat(o));return e=i.body.member_count||0,[3,4];case 3:return a=c.sent(),console.error(a),[3,4];case 4:return[2,e]}var l,u}))}))},A=(d.PlatformUtil.isTencentDocsPhoneApp(),!1),L=!1,N="VID_TYPE_WEWORK";!function(e){e.DISABLED="DISABLED",e.NORMAL="NORMAL",e.HIGHLIGHT="HIGHLIGHT"}(I||(I={}))},98337:function(e,t,n){n.d(t,{Q:function(){return y}});var r,o=n(85556),i=n(2613),a=n(30479),s=n(14366),c=n(13980),l=n(81814),u=n(26914),d=n(24689),p=n(90815),h=n(28379),f=n(28223),g=n(55946);!function(e){e[e.DISABLE=0]="DISABLE",e[e.BEFORE_INIT=1]="BEFORE_INIT",e[e.INIT=2]="INIT",e[e.BEFORE_OPEN=3]="BEFORE_OPEN",e[e.OPEN=4]="OPEN"}(r||(r={}));var v=window,y=function(){function e(){var e=this;this.stage=r.DISABLE,this.uuid=a.StringUtil.generateRandomId(),this.tag="[PreloadService ".concat(this.uuid,"]"),this.init=function(){return(0,o.__awaiter)(e,void 0,void 0,(function(){var e,t,n,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return(0,h.g6)()?this.stage>=r.BEFORE_INIT?(i.LocalLogger.error(this.tag,""),[2,Promise.resolve(!1)]):(i.LocalLogger.info(this.tag,""),this.stage=r.INIT,[4,this.waitForMagicBoxEvent()]):(i.LocalLogger.info(this.tag,""),[2,Promise.resolve(!1)]);case 1:e=o.sent().detail,t=e.option,n=e.openTime,o.label=2;case 2:return o.trys.push([2,4,,5]),i.LocalLogger.info(this.tag,"on_magic_box_event",e),[4,this.handleOpenDoc(t,n)];case 3:return o.sent(),[2,Promise.resolve(!0)];case 4:return a=o.sent(),i.LocalLogger.error(a),this.fallbackOpenDocFailed("error",t.url),[2,Promise.resolve(!1)];case 5:return[2]}}))}))},this.onFirstRender=function(){e.disabled||e.loadingTimeout&&(clearTimeout(e.loadingTimeout),window.fisrtScreenLoading.hide())},this.onFeatureLoaded=function(){e.disabled||i.LocalLogger.info(e.tag,"")},this.onDverUpdate=function(t){var n,r,o=e.url||location.href;if(null===(r=null===(n=window.tdocs)||void 0===n?void 0:n.mapDocumentVersion)||void 0===r||r.call(n,{dver:t,url:o}),"3.0.0"!==t){var a="dver_not_match";e.report({action:a,ver1:t}),i.LocalLogger.error(e.tag,a,t),e.disabled?location.href=o:e.fallbackOpenDocFailed(a,o)}},this.handleOpenDoc=function(t,n){return(0,o.__awaiter)(e,void 0,void 0,(function(){var e,a,c,l,u,h,y,m,b,_;return(0,o.__generator)(this,(function(o){return e=t.url,this.url=e,a=Date.now(),(c=this.getSecretIdByUrl(e))?(this.stage=r.BEFORE_OPEN,this.sendToNative("host://tdocs/container/docsReady",{}),window.openUrlFrom="preload",null===(u=window.generateEditableWhenCreateState)||void 0===u||u.call(window,e),l=f._.getInstance().recordAndStripPerformanceValueFromUrl(e,!0),window.history.replaceState({},"",l),null===(y=null===(h=null===window||void 0===window?void 0:window.aegis)||void 0===h?void 0:h.setConfig)||void 0===y||y.call(h,{ext3:c}),d.u.getInstance(c).replaceUrlTime=n,window.__isOfflinePkg&&p.K.hideFirsScreenLoading(),this.preloadDBData(c),null===(m=null==v?void 0:v.refreshClientVarsPromise)||void 0===m||m.call(v,!0),null===(_=null===(b=null===window||void 0===window?void 0:window.discussionExt)||void 0===b?void 0:b.reInit)||void 0===_||_.call(b,e),this.stage=r.OPEN,this.report({action:"open_time_cost",ver1:"".concat(Date.now()-a)}),i.LocalLogger.info(this.tag,":".concat(JSON.stringify(t))),window.dispatchEvent(new CustomEvent("restartWhiteScreen")),this.loadingTimeout=setTimeout((function(){var e,t;null===(e=null===window||void 0===window?void 0:window.fisrtScreenLoading)||void 0===e||e.setZIndex(1e3),null===(t=null===window||void 0===window?void 0:window.fisrtScreenLoading)||void 0===t||t.show()}),1e3),window.preloadCollabCountPromise=new Promise((function(e){return s.Z.post("/wedoc/doc_member_mgr",(0,g.BM)({func:6,docid:c})).then((function(e){var t,n;return v.preloadCollabCount=(null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.body)||void 0===n?void 0:n.member_count)||0})).finally((function(){return e(!0)}))})),[2]):[2,this.fallbackOpenDocFailed("docId_is_invalid",e)]}))}))},this.fallbackOpenDocFailed=function(t,n){i.LocalLogger.error(e.tag,":".concat(t," url:").concat(n)),e.report({action:"open_doc_failed",ver1:t}),e.sendToNative("host://tdocs/container/docsFailed",{url:n})},this.report=function(t,n){var r=(0,a.getUrlParameter)("preloadWebviewCount"),s=(0,o.__assign)({opername:"quality_doc_melo",module:"preload",ver6:e.stage,ver7:window.__isOfflinePkg?"true":"false",ver12:r?Number(r):1},t);i.ReportHelper.tdwReport(s,(0,o.__assign)({showLog:!0},n||{}))},this.sendToNative=function(e,t,n){var r,o;return null===(o=null===(r=null===window||void 0===window?void 0:window.tdocs)||void 0===r?void 0:r.sendMagicBoxMsg)||void 0===o?void 0:o.call(r,{schema:e,option:t,success:n})},this.waitForMagicBoxEvent=function(){return new Promise((function(e){(null==v?void 0:v.__latestMagicBoxEvent)?e(v.__latestMagicBoxEvent):window.addEventListener("forwardMagicBoxEvent",(function(){return e(v.__latestMagicBoxEvent)}))}))},this.getSecretIdByUrl=function(t){try{return t.match(new RegExp("^https?://doc\\.weixin\\.qq\\.com/doc/([^=&\\?]*).*"))[1]}catch(n){return i.LocalLogger.error(e.tag,"getSecretIdByUrl url:".concat(t),n),null}},this.preloadDBData=function(t){return(0,o.__awaiter)(e,void 0,void 0,(function(){var e,n;return(0,o.__generator)(this,(function(r){try{if(!(null===(n=window.tdocs)||void 0===n?void 0:n.clientDatabaseRequest))return[2,new u.x4(new Error("clientDatabaseRequest"))];i.LocalLogger.info(this.tag,"DB"),e=(0,c.getUid)(),window.clientVarsDBJSAPIPromise=new Promise((function(n){var r=u.he.newInstance().addCondition("uid",u.E1.ONLY,e).addCondition("secretId",u.E1.ONLY,t).addCondition("type",u.E1.IN,[l.Nt.INIT,l.Nt.ACCEPTED,l.Nt.MISS_CHANGE,l.Nt.NEW_CHANGE]);n(window.tdocs.clientDatabaseRequest({command:"getAll",dbName:l.H4,tableName:l.me.DOCUMENT_DATA,where:r}))}))}catch(e){l.Zb.error("preloadDBData Error",e)}return[2]}))}))}}return Object.defineProperty(e,"instance",{get:function(){return e.preloadService||(e.preloadService=new e),e.preloadService},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{get:function(){return this.stage===r.DISABLE},enumerable:!1,configurable:!0}),e}()},22730:function(e,t,n){n.d(t,{h:function(){return a}});var r=n(85556),o=n(39760),i=n(16841),a=function(){function e(){}return e.serialize=function(e){return Array.isArray(e)?e.map((function(e){return e.serialize()})):[e.serialize()]},e.deserialize=function(e,t){return void 0===t&&(t=o.F),e?Array.isArray(e)?e.map((function(e){return t.deserialize(e)})):t.deserialize(e):[]},e.stringify=function(t){return JSON.stringify(e.serialize(t))},e.parse=function(t,n){return void 0===n&&(n=o.F),e.deserialize(JSON.parse(t),n)},e.followSingle=function(e,t,n){return void 0===n&&(n=!0),this.follow(e,t,n,!1)},e.followDouble=function(e,t){return this.follow(e,t,!0,!0)},e.compose=function(e){if(!e.length)return[];for(var t=[e[0]],n=e[0],r=1;r<e.length;r++)(n=n.compose(e[r]))?t[t.length-1]=n:(t.push(e[r]),n=e[r]);return e.length!==t.length?t:(0,i.rY)(e)},e.follow=function(e,t,n,o){var a,s;void 0===n&&(n=!0),void 0===o&&(o=!0);var c=t.slice(0),l=[];try{for(var u=(0,r.__values)(e),d=u.next();!d.done;d=u.next()){for(var p=d.value,h=0;h<c.length;h++){var f=c[h],g=p.transform(f,n);c[h]=f.transform(p,!n),p=g}l.push(p)}}catch(e){a={error:e}}finally{try{d&&!d.done&&(s=u.return)&&s.call(u)}finally{if(a)throw a.error}}return o?[(0,i.rY)(l),(0,i.rY)(c)]:(0,i.rY)(l)},e}()},55360:function(e,t,n){n.d(t,{j:function(){return l}});var r=n(85556),o=n(62814),i=n(19758),a=n(16841),s=n(18853),c=n(94038),l=function(e){function t(t){var n=e.call(this)||this;return n.type=o.x.delete,n.beginIndex=t.beginIndex,n.endIndex=t.endIndex,n}return(0,r.__extends)(t,e),t.prototype.serialize=function(){return{ty:this.type,bi:this.beginIndex,ei:this.endIndex}},t.prototype.transformWithInsertMutation=function(e){return new t({beginIndex:(0,a.BH)(this.beginIndex,e.beginIndex,e.text.length),endIndex:(0,a.BH)(this.endIndex-1,e.beginIndex,e.text.length)+1})},t.prototype.transformWithModifyMutation=function(){return this},t.prototype.transformWithDeleteMutation=function(e){var n=e.endIndex-e.beginIndex,r=this.beginIndex,o=this.endIndex;if(this.beginIndex>=e.beginIndex){if(r=Math.max(e.beginIndex,this.beginIndex-n),(o=this.endIndex-n)<=r)return new i.q}else this.endIndex>=e.beginIndex&&(o=Math.max(e.beginIndex,this.endIndex-n));return new t({beginIndex:r,endIndex:o})},t.prototype.composeWithInsertMutation=function(){return null},t.prototype.composeWithDeleteMutation=function(e){return e.beginIndex===this.beginIndex?new t({beginIndex:this.beginIndex,endIndex:this.endIndex+e.endIndex-e.beginIndex}):e.beginIndex<this.beginIndex&&e.endIndex>=this.beginIndex?new t({beginIndex:e.beginIndex,endIndex:this.endIndex-this.beginIndex+e.endIndex}):null},t.prototype.composeWithModifyMutation=function(){return null},t.prototype.composeWithSettingMutation=function(){return null},t.prototype.transformGcpRangeWithMutation=function(e){var t=this.endIndex-this.beginIndex,n=e.begin(),r=e.end();if(e.gcpBegin>=this.beginIndex){if(n=Math.max(this.beginIndex,e.gcpBegin-t),(r=e.end()-t)<n)return c.IC.emptyRange()}else e.end()>=this.beginIndex&&(r=Math.max(this.beginIndex,e.end()-t));return new c.IC(n,r-n)},t}(s.I)},58122:function(e,t,n){n.d(t,{U:function(){return i}});var r=n(85556),o=n(62814),i=function(e){function t(t){var n=e.call(this)||this;return n.type=o.x.deleteRange,n.id=t.id,n.rangeType=t.rangeType,n}return(0,r.__extends)(t,e),t.prototype.serialize=function(){return{ty:this.type,rt:this.rangeType,id:this.id}},t.prototype.transformWithInsertMutation=function(e){return this},t.prototype.transformWithDeleteMutation=function(e){return this},t.prototype.transformWithModifyMutation=function(){return this},t.prototype.transformWithSettingMutation=function(){return this},t.prototype.composeWithInsertMutation=function(){return null},t.prototype.composeWithDeleteMutation=function(){return null},t.prototype.transformGcpRangeWithMutation=function(e){return e},t}(n(18853).I)},39760:function(e,t,n){n.d(t,{F:function(){return d}});var r=n(70402),o=n(55360),i=n(25756),a=n(18586),s=n(62814),c=n(19758),l=n(10405),u=n(58122),d=function(){function e(){}return e.deserialize=function(e){switch(e.ty){case s.x.insert:return new r.Q({beginIndex:Number(e.bi),text:e.s});case s.x.delete:return new o.j({beginIndex:Number(e.bi),endIndex:Number(e.ei)});case s.x.modify:return new i.O({beginIndex:Number(e.bi),endIndex:Number(e.ei),modifyType:e.mt,property:e.pr,modifyMode:e.mm});case s.x.setting:return new a.L({settingType:e.mt,property:e.pr});case s.x.insertRange:return new l.T({id:e.id,rangeType:e.rt,beginIndex:e.bi,endIndex:e.ei,property:e.pr});case s.x.deleteRange:return new u.U({id:e.id,rangeType:e.rt});default:return new c.q}},e}()},19758:function(e,t,n){n.d(t,{q:function(){return i}});var r=n(85556),o=n(62814),i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=o.x.empty,t}return(0,r.__extends)(t,e),t.prototype.transformWithInsertMutation=function(){return this},t.prototype.transformWithDeleteMutation=function(){return this},t.prototype.transformWithModifyMutation=function(){return this},t.prototype.transformWithSettingMutation=function(){return this},t.prototype.transformWithDeleteRangeMutation=function(){return this},t.prototype.transformWithInsertRangeMutation=function(){return this},t.prototype.composeWithInsertMutation=function(e){return e},t.prototype.composeWithDeleteMutation=function(e){return e},t.prototype.composeWithModifyMutation=function(e){return e},t.prototype.composeWithSettingMutation=function(e){return e},t.prototype.composeWithInsertRangeMutation=function(e){return e},t.prototype.composeWithDeleteRangeMutation=function(e){return e},t.prototype.transformGcpRangeWithMutation=function(e){return e},t}(n(18853).I)},62814:function(e,t,n){var r;n.d(t,{x:function(){return r}}),function(e){e.insert="is",e.delete="ds",e.modify="mp",e.setting="ms",e.insertRange="ir",e.deleteRange="dr",e.empty="empty",e.mlti="mlti"}(r||(r={}))},64282:function(e,t,n){n.d(t,{hV:function(){return r.h},jn:function(){return a.j},UR:function(){return l.U},Qr:function(){return i.Q},TF:function(){return u.T},OJ:function(){return s.O},Fe:function(){return o.F},x1:function(){return d.x},Lq:function(){return c.L}});var r=n(22730),o=n(39760),i=n(70402),a=n(55360),s=n(25756),c=n(18586),l=n(58122),u=n(10405),d=(function(){function e(e){this.type=e.type,this.decoratedMutation=e}e.prototype.serialize=function(){return this.decoratedMutation.serialize()},e.prototype.toJSON=function(){return this.decoratedMutation.serialize()},e.prototype.transform=function(t,n){return this.decoratedMutation.transform(t instanceof e?t.decoratedMutation:t,n)},e.prototype.compose=function(t){return this.decoratedMutation.compose(t instanceof e?t.decoratedMutation:t)},e.prototype.transformGcpRange=function(e,t){return this.decoratedMutation.transformGcpRange(e,t)}}(),n(62814));n(74478)},70402:function(e,t,n){n.d(t,{Q:function(){return u}});var r=n(85556),o=n(62814),i=n(55360),a=n(19758),s=n(16841),c=n(18853),l=n(94038),u=function(e){function t(t){var n=e.call(this)||this;return n.type=o.x.insert,n.beginIndex=t.beginIndex,n.text=t.text,n}return(0,r.__extends)(t,e),t.prototype.serialize=function(){return{ty:this.type,bi:this.beginIndex,s:this.text}},t.prototype.transformWithInsertMutation=function(e,n){return this.beginIndex===e.beginIndex&&n?this:new t({beginIndex:(0,s.BH)(this.beginIndex,e.beginIndex,e.text.length),text:this.text})},t.prototype.transformWithModifyMutation=function(){return this},t.prototype.transformWithDeleteMutation=function(e){return e.beginIndex<this.beginIndex&&e.endIndex>this.beginIndex?new a.q:new t({beginIndex:(0,s.BH)(this.beginIndex,e.beginIndex+1,-(e.endIndex-e.beginIndex)),text:this.text})},t.prototype.composeWithInsertMutation=function(e){var n=this.beginIndex,r=this.beginIndex+this.text.length-1,o=e.beginIndex;if(o>r+1||o<n)return null;var i=o-n;return new t({beginIndex:this.beginIndex,text:this.text.slice(0,i)+e.text+this.text.slice(i)})},t.prototype.composeWithDeleteMutation=function(e){var n=this.beginIndex,r=this.beginIndex+this.text.length,o=e.beginIndex,s=e.endIndex;if(o<=n&&s>=r){var c=s-(r-n);return c<=o?new a.q:new i.j({beginIndex:o,endIndex:c})}return n<=o&&r>=s?new t({beginIndex:this.beginIndex,text:this.text.slice(0,o-n)+this.text.slice(s-n)}):null},t.prototype.transformGcpRangeWithMutation=function(e,t){if(this.beginIndex===e.begin()&&t)return e;var n=(0,s.BH)(e.begin(),this.beginIndex,this.text.length);return new l.IC(n,e.length())},t}(c.I)},10405:function(e,t,n){n.d(t,{T:function(){return a}});var r=n(85556),o=n(62814),i=n(19758),a=function(e){function t(t){var n=e.call(this)||this;return n.type=o.x.insertRange,n.id=t.id,n.rangeType=t.rangeType,n.beginIndex=t.beginIndex,n.endIndex=t.endIndex,n.property=t.property,n}return(0,r.__extends)(t,e),t.prototype.serialize=function(){return{ty:this.type,bi:this.beginIndex,ei:this.endIndex,id:this.id,rt:this.rangeType,pr:this.property}},t.prototype.transformWithInsertMutation=function(e){return e.beginIndex<=this.beginIndex?new t({beginIndex:this.beginIndex+e.text.length,endIndex:this.endIndex+e.text.length,id:this.id,rangeType:this.rangeType,property:this.property}):e.beginIndex>this.beginIndex&&e.beginIndex<this.endIndex?new t({beginIndex:this.beginIndex,endIndex:this.endIndex+e.text.length,id:this.id,rangeType:this.rangeType,property:this.property}):this},t.prototype.transformWithDeleteMutation=function(e){var n=e.endIndex-e.beginIndex,r=this.beginIndex,o=this.endIndex;if(this.beginIndex>=e.beginIndex){if(r=Math.max(e.beginIndex,this.beginIndex-n),(o=this.endIndex-n)<=r)return new i.q}else this.endIndex>=e.beginIndex&&(o=Math.max(e.beginIndex,this.endIndex-n));return new t({id:this.id,beginIndex:r,endIndex:o,rangeType:this.rangeType,property:this.property})},t.prototype.transformWithModifyMutation=function(){return this},t.prototype.transformWithSettingMutation=function(){return this},t.prototype.composeWithInsertMutation=function(){return null},t.prototype.composeWithDeleteMutation=function(){return null},t.prototype.transformGcpRangeWithMutation=function(e){return e},t}(n(18853).I)},74478:function(e,t,n){n.d(t,{G:function(){return s}});var r=n(85556),o=n(18853),i=n(62814),a=n(22730),s=function(e){function t(t){var n=e.call(this)||this;return n.type=i.x.mlti,n.content=[],n.content=t.content,n}return(0,r.__extends)(t,e),t.prototype.transformWithInsertMutation=function(e,n){return new t({content:a.h.followSingle(this.content,[e],n)})},t.prototype.transformWithModifyMutation=function(e,n){return new t({content:a.h.followSingle(this.content,[e],n)})},t.prototype.transformWithDeleteMutation=function(e,n){return new t({content:a.h.followSingle(this.content,[e],n)})},t.prototype.composeWithInsertMutation=function(){return null},t.prototype.composeWithDeleteMutation=function(){return null},t.prototype.transformGcpRangeWithMutation=function(e){return e},t}(o.I)},25756:function(e,t,n){n.d(t,{O:function(){return l}});var r=n(85556),o=n(62814),i=n(18853),a=n(19758),s=n(16841),c=n(74478),l=function(e){function t(t){var n=e.call(this)||this;return n.type=o.x.modify,n.beginIndex=t.beginIndex,n.endIndex=t.endIndex,n.modifyMode=t.modifyMode,n.modifyType=t.modifyType,n.property=t.property,n}return(0,r.__extends)(t,e),t.prototype.serialize=function(){return{ty:this.type,bi:this.beginIndex,ei:this.endIndex,mt:this.modifyType,pr:this.property,mm:this.modifyMode}},t.prototype.transformWithInsertMutation=function(e){var n=e.text.length;return this.beginIndex>=e.beginIndex?(this.beginIndex+=n,this.endIndex+=n):this.endIndex>e.beginIndex&&(this.endIndex+=n),new t({beginIndex:this.beginIndex,endIndex:this.endIndex,modifyMode:this.modifyMode,modifyType:this.modifyType,property:this.property})},t.prototype.transformWithModifyMutation=function(e,n){var r,o=this.property[this.modifyType];if(this.modifyType===e.modifyType&&this.beginIndex<e.endIndex&&this.endIndex>e.beginIndex&&(o=(0,s.q4)(this.property[this.modifyType],e.property[this.modifyType],n),!n)){var i=(0,s.A6)({beginIndex:this.beginIndex,endIndex:this.endIndex},{beginIndex:e.beginIndex,endIndex:e.endIndex});return this.genModifyMutationForCollab(i,this,o)}return new t({beginIndex:this.beginIndex,endIndex:this.endIndex,modifyMode:this.modifyMode,modifyType:this.modifyType,property:(r={},r[this.modifyType]=o,r)})},t.prototype.transformWithDeleteMutation=function(e){var n=e.endIndex-e.beginIndex;if(this.beginIndex>=e.beginIndex){if(this.beginIndex=Math.max(e.beginIndex,this.beginIndex-n),this.endIndex=this.endIndex-n,this.endIndex<=this.beginIndex)return new a.q}else this.endIndex>=e.beginIndex&&(this.endIndex=Math.max(e.beginIndex,this.endIndex-n));return new t({beginIndex:this.beginIndex,endIndex:this.endIndex,modifyMode:this.modifyMode,modifyType:this.modifyType,property:this.property})},t.prototype.composeWithInsertMutation=function(){return null},t.prototype.composeWithDeleteMutation=function(){return null},t.prototype.genModifyMutationForCollab=function(e,n,r){var o,i=this,a=e.cross,s=e.ranges,l=[];return a&&l.push(new t({beginIndex:a.beginIndex,endIndex:a.endIndex,modifyMode:this.modifyMode,modifyType:this.modifyType,property:(o={},o[this.modifyType]=r,o)})),s.length&&s.forEach((function(e){l.push(new t({beginIndex:e.beginIndex,endIndex:e.endIndex,modifyMode:i.modifyMode,modifyType:i.modifyType,property:n.property}))})),1===l.length?l[0]:new c.G({content:l})},t.prototype.transformGcpRangeWithMutation=function(e){return e},t}(i.I)},18853:function(e,t,n){n.d(t,{I:function(){return o}});var r=n(62814),o=function(){function e(){this.type=r.x.empty}return e.prototype.serialize=function(){return{ty:this.type}},e.prototype.toJSON=function(){return this.serialize()},e.prototype.transform=function(e,t){switch(e.type){case r.x.insert:return this.transformWithInsertMutation(e,t);case r.x.delete:return this.transformWithDeleteMutation(e,t);case r.x.modify:return this.transformWithModifyMutation(e,t);case r.x.setting:return this.transformWithSettingMutation(e,t);case r.x.insertRange:return this.transformWithInsertRangeMutation(e,t);case r.x.deleteRange:return this.transformWithDeleteRangeMutation(e,t);case r.x.mlti:return this.transformWithMltiMutation(e,t);default:return this}},e.prototype.compose=function(e){switch(e.type){case r.x.insert:return this.composeWithInsertMutation(e);case r.x.delete:return this.composeWithDeleteMutation(e);case r.x.modify:return this.composeWithModifyMutation(e);case r.x.setting:return this.composeWithSettingMutation(e);case r.x.insertRange:return this.composeWithInsertRangeMutation(e);case r.x.deleteRange:return this.composeWithDeleteRangeMutation(e);default:return this}},e.prototype.transformGcpRange=function(e,t){switch(this.type){case r.x.insert:case r.x.delete:return this.transformGcpRangeWithMutation(e,t);default:return e}},e.prototype.transformWithMltiMutation=function(e,t){if(0===e.content.length)return this;for(var n=this.transform(e.content[0],t),r=1;r<e.content.length;r++)n=n.transform(e.content[r],t);return n},e.prototype.transformWithSettingMutation=function(e,t){return this},e.prototype.transformWithDeleteRangeMutation=function(e,t){return this},e.prototype.transformWithInsertRangeMutation=function(e,t){return this},e.prototype.composeWithModifyMutation=function(e){return null},e.prototype.composeWithSettingMutation=function(e){return null},e.prototype.composeWithInsertRangeMutation=function(e){return null},e.prototype.composeWithDeleteRangeMutation=function(e){return null},e}()},18586:function(e,t,n){n.d(t,{L:function(){return a}});var r=n(85556),o=n(62814),i=n(16841),a=function(e){function t(t){var n=e.call(this)||this;return n.type=o.x.setting,n.settingType=t.settingType,n.property=t.property,n}return(0,r.__extends)(t,e),t.prototype.serialize=function(){return{ty:this.type,mt:this.settingType,pr:this.property}},t.prototype.transformWithInsertMutation=function(){return this},t.prototype.transformWithDeleteMutation=function(){return this},t.prototype.transformWithModifyMutation=function(){return this},t.prototype.transformWithSettingMutation=function(e,t){var n=this.property;return this.settingType===e.settingType&&(n=(0,i.q4)(this.property[this.settingType],e.property[this.settingType],t),this.property[this.settingType]=n),this},t.prototype.composeWithInsertMutation=function(){return null},t.prototype.composeWithDeleteMutation=function(){return null},t.prototype.transformGcpRangeWithMutation=function(e){return e},t}(n(18853).I)},16841:function(e,t,n){n.d(t,{q4:function(){return S},A6:function(){return x},rY:function(){return w},BH:function(){return d}});var r,o,i,a=n(85556),s=n(62814),c="_list_op",l="_i",u="_dict_op";function d(e,t,n){return e>=t?e+n:e}function p(e){if(null===e)return r.null;var t=typeof e;return t===r.object&&Array.isArray(e)?r.array:t}function h(e,t,n){var r,o,i,a,s,c,u,d,p,h,f,g;return e.endsWith(l)?(u=t[g=(f=e).slice(0,-l.length)],d=t[f],p=n[g],h=n[f]):(f="".concat(g=e).concat(l),u=t[g],d=t[f],p=n[g],h=n[f]),void 0!==u?void 0!==h?((r={})[f]=h,r):void 0!==p?((o={})[g]=p,o):((i={})[g]=u,i):void 0!==d?void 0!==h?((a={})[f]=h,a):void 0!==p?((s={})[g]=p,s):((c={})[f]=d,c):{}}function f(e){var t,n,r=e.key;return e.key.endsWith(u)?((t={})[r]=e.propertyMap,t[r.slice(0,-u.length)]=e.property,t):((n={})[r]=e.property,n["".concat(r).concat(u)]=e.propertyMap,n)}function g(e,t,n){switch(t.opType){case o.Set:return function(e,t,n){switch(null==e?void 0:e.opType){case o.Set:return n?e:t;case o.Modify:case o.Insert:case o.Delete:return null;default:throw new Error("Illegal Transform Type")}}(e,t,n);case o.Insert:return function(e,t,n){var r=e.opIndex,i=t.opIndex;switch(null==e?void 0:e.opType){case o.Set:return e;case o.Insert:if(r===i&&n)return e;case o.Delete:case o.Modify:return(0,a.__assign)((0,a.__assign)({},e),{opIndex:d(r,i,1)});default:throw new Error("Illegal Transform Type")}}(e,t,n);case o.Delete:return function(e,t,n){var r=null==e?void 0:e.opIndex,i=t.opIndex;switch(e.opType){case o.Set:return e;case o.Insert:return r&&i<r?(0,a.__assign)((0,a.__assign)({},e),{opIndex:r-1}):e;case o.Delete:case o.Modify:return r?r===i?null:(0,a.__assign)((0,a.__assign)({},e),{opIndex:d(r,i,-1)}):e;default:throw new Error("Illegal Transform Type")}}(e,t);case o.Modify:return function(e,t,n){return e.opType!==o.Modify||e.opIndex!==t.opIndex?e:p(e.opValue[0])===r.object&&p(t.opValue[0])===r.object?S(e.opValue[0],t.opValue[0],n):n?e:t}(e,t,n);default:throw new Error("Illegal Transform Type")}}function v(e,t,n){switch(t.propertyMap.opType){case i.Set:return function(e,t,n){switch(e.propertyMap.opType){case i.Set:return f(n?e:t);case i.Delete:case i.Update:return null;default:throw new Error("Illegal Transform Type")}}(e,t,n);case i.Delete:return function(e,t,n){switch(e.propertyMap.opType){case i.Set:return f(e);case i.Delete:return e.propertyMap.opKey===t.propertyMap.opKey?null:f(e);case i.Update:var r=t.propertyMap.opKey;return r&&e.property&&Object.keys(e.property).includes(r)&&delete e.property[r],f(e);default:throw new Error("Illegal Transform Type")}}(e,t);case i.Update:return function(e,t,n){switch(e.propertyMap.opType){case i.Set:case i.Delete:return f(e);default:throw new Error("Illegal Transform Type")}}(e);default:throw new Error("Illegal Transform Type")}}function y(e,t){if(e.endsWith(c)){var n=e.slice(0,-c.length);return Array.isArray(t[n])}return!1}function m(e,t){if(e.endsWith(u)){var n=e.slice(0,-u.length);return Array.isArray(t[n])}return!1}function b(e,t){return!!Array.isArray(t[e])&&void 0!==t["".concat(e).concat(c)]}function _(e,t){if(!e.endsWith(u)){var n="".concat(e).concat(u);return{key:e,property:t[e],propertyMap:t[n]}}return{key:e,property:t[e.slice(0,-u.length)],propertyMap:t[e]}}function C(e,t){return e in t&&void 0===t[e]}function S(e,t,n){return e.toJSON&&(e=e.toJSON()),t.toJSON&&(t=t.toJSON()),Object.entries(e).reduce((function(o,s){var l,u,d,p,f,w=(0,a.__read)(s,2),E=w[0],x=w[1];if(C(E,t)||C(E,e))return(0,a.__assign)((0,a.__assign)({},o),((l={})[E]=x,l));if(!(E in t))return n?(0,a.__assign)((0,a.__assign)({},o),((u={})[E]=x,u)):(0,a.__assign)((0,a.__assign)({},o),h(E,e,t));if(b(E,e)&&b(E,t))return o;if(y(E,e)&&y(E,t)){var T=g((0,a.__assign)((0,a.__assign)({},x),{opValue:e[E.slice(0,-c.length)]}),(0,a.__assign)((0,a.__assign)({},t[E]),{opValue:t[E.slice(0,-c.length)]}),n);return T?function(e){return e.opType&&e.opValue}(T)?(0,a.__assign)((0,a.__assign)({},o),((p={})[E]={opType:null==T?void 0:T.opType,opIndex:null==T?void 0:T.opIndex},p[E.slice(0,-c.length)]=null==T?void 0:T.opValue,p)):(0,a.__assign)((0,a.__assign)({},o),((d={})[E]=x,d[E.slice(0,-c.length)]=[T],d)):o}var R=_(E,e),I=_(E,t);if(m(E,e)&&m(E,t))return o;if(function(e,t){var n,r;return((null===(n=e.propertyMap)||void 0===n?void 0:n.opType)!==i.Update||(null===(r=t.propertyMap)||void 0===r?void 0:r.opType)!==i.Update)&&e.propertyMap&&t.propertyMap}(R,I)){var P=v(R,I,n);return P?(0,a.__assign)((0,a.__assign)({},o),P):o}return typeof x!==r.object||null===t[E]||Array.isArray(t[E])?(0,a.__assign)((0,a.__assign)({},o),function(e,t,n,r,o,i){var s={};return e?s[t]=n:void 0!==r&&(s=(0,a.__assign)((0,a.__assign)({},s),h(t,o,i))),s}(n,E,x,t[E],e,t)):(0,a.__assign)((0,a.__assign)({},o),((f={})[E]=S(x,t[E],n),f))}),{})}function w(e){var t=function(e){return e.filter((function(e){return e.type!==s.x.empty}))}(e),n=[];return t.forEach((function(e){e.type===s.x.mlti?n=n.concat(w(e.content)):n.push(e)})),n}function E(e,t){e.endIndex<=e.beginIndex||t.push(e)}function x(e,t){var n=[],r=[];return e.beginIndex<=t.beginIndex?(E({beginIndex:e.beginIndex,endIndex:t.beginIndex},n),t.endIndex<=e.endIndex?(E({beginIndex:t.beginIndex,endIndex:t.endIndex},r),E({beginIndex:t.endIndex,endIndex:e.endIndex},n)):E({beginIndex:t.beginIndex,endIndex:e.endIndex},r)):(t.endIndex>=e.endIndex&&E({beginIndex:e.beginIndex,endIndex:e.endIndex},r),E({beginIndex:e.beginIndex,endIndex:t.endIndex},r),E({beginIndex:t.endIndex,endIndex:e.endIndex},n)),{cross:r[0],ranges:n}}!function(e){e.null="null",e.array="array",e.object="object"}(r||(r={})),function(e){e.Set="Set",e.Modify="Modify",e.Insert="Insert",e.Delete="Delete"}(o||(o={})),function(e){e.Set="Set",e.Update="Update",e.Delete="Delete"}(i||(i={}))},48020:function(e,t,n){n.d(t,{y:function(){return r}});var r=(0,n(46708).yh)("copy")},25374:function(e,t,n){n.d(t,{w:function(){return i}});var r=0,o={};function i(e){if(o[e])return o[e];var t="l".concat(r);return r+=1,o[e]=t,t}},39498:function(e,t,n){n.d(t,{v:function(){return i},x:function(){return o}});var r=n(46708),o=function(){return{html:"",plain:"",refText:""}},i=(0,r.yh)("copyParserManager")},11443:function(e,t,n){n.d(t,{A:function(){return r}});var r=(0,n(46708).yh)("cut")},18412:function(e,t,n){n.d(t,{M:function(){return r}});var r=(0,n(46708).yh)("paste")},54721:function(e,t,n){n.d(t,{FM:function(){return c},Ze:function(){return r},Zr:function(){return o},cm:function(){return a},kd:function(){return i}});var r,o,i,a,s=n(46708);!function(e){e[e.Doc=0]="Doc",e[e.Cell=1]="Cell",e[e.Table=2]="Table",e[e.SubStory=3]="SubStory",e[e.Codeblock=4]="Codeblock",e[e.LightBlock=5]="LightBlock",e[e.HeaderFooter=6]="HeaderFooter"}(r||(r={})),function(e){e[e.Text=0]="Text",e[e.Table=1]="Table",e[e.Mix=2]="Mix"}(o||(o={})),function(e){e[e.low=0]="low",e[e.normal=1]="normal",e[e.high=2]="high"}(i||(i={})),function(e){e[e.Low=0]="Low",e[e.Normal=1]="Normal",e[e.High=2]="High"}(a||(a={}));var c=(0,s.yh)("pasteProcessorManager")},34155:function(e,t,n){n.d(t,{Cv:function(){return u},JS:function(){return s},VN:function(){return d},k$:function(){return c},rx:function(){return l},uM:function(){return p}});var r,o,i,a=n(82487),s={solid:a.EJ9.thick,dotted:a.EJ9.dotted,dashed:a.EJ9.dashed,double:a.EJ9.double,inset:a.EJ9.inset,outset:a.EJ9.outset,ridge:a.EJ9.threeDEmboss,groove:a.EJ9.threeDEngrave},c=((r={})[a.EJ9.thick]="solid",r[a.EJ9.dotted]="dotted",r[a.EJ9.dashSmallGap]="dashed",r[a.EJ9.dashed]="dashed",r[a.EJ9.dotDash]="dashed",r[a.EJ9.dotDotDash]="dashed",r[a.EJ9.double]="double",r[a.EJ9.triple]="double",r[a.EJ9.thinThickSmallGap]="double",r[a.EJ9.thickThinSmallGap]="double",r[a.EJ9.thinThickThinSmallGap]="double",r[a.EJ9.wave]="solid",r[a.EJ9.doubleWave]="double",r[a.EJ9.threeDEmboss]="ridge",r[a.EJ9.threeDEngrave]="groove",r),l=((o={})[a.EJ9.thick]="solid",o[a.EJ9.dotted]="dotted",o[a.EJ9.dashSmallGap]="dashed",o[a.EJ9.dashed]="dashed",o[a.EJ9.dotDash]="dot-dash",o[a.EJ9.dotDotDash]="dot-dot-dash",o[a.EJ9.double]="double",o[a.EJ9.triple]="triple",o[a.EJ9.thinThickSmallGap]="thin-thick-small-gap",o[a.EJ9.thickThinSmallGap]="thick-thin-small-gap",o[a.EJ9.thinThickThinSmallGap]="thin-thick-thin-small-gap",o[a.EJ9.wave]="wave",o[a.EJ9.doubleWave]="double-wave",o[a.EJ9.threeDEmboss]="three-d-emboss",o[a.EJ9.threeDEngrave]="three-d-engrave",o),u=((i={})[a.EJ9.single]="normal",i[a.EJ9.thick]="normal",i[a.EJ9.dotted]="dotted",i[a.EJ9.dashed]="dashed",i[a.EJ9.dotDash]="dashed",i[a.EJ9.dotDotDash]="dashed",i[a.EJ9.dotted]="space-dotted",i[a.EJ9.wave]="wavy",i[a.EJ9.doubleWave]="wavy-double",i),d={normal:a.EJ9.thick,"normal-bold-2":a.EJ9.thick,"normal-bold-3":a.EJ9.thick,"normal-bold-8":a.EJ9.thick,"normal-bold-12":a.EJ9.thick,dashed:a.EJ9.dashed,dotted:a.EJ9.dotted,"space-dotted":a.EJ9.dotted,wavy:a.EJ9.wave,"wavy-bold-2":a.EJ9.wave,"wavy-bold-4":a.EJ9.wave,"wavy-double":a.EJ9.doubleWave,"shading-v":a.EJ9.thick,"shading-slash":a.EJ9.thick},p={normal:8,"normal-bold-2":16,"normal-bold-3":24,"normal-bold-8":64,"normal-bold-12":96,dashed:8,dotted:8,"space-dotted":8,wavy:8,"wavy-bold-2":16,"wavy-bold-4":32,"wavy-double":8,"shading-v":8,"shading-slash":8}},4180:function(e,t,n){n.d(t,{H:function(){return v},U:function(){return y}});var r=n(85556),o=n(87468),i=n(30479),a=n(48020),s=n(11443),c=n(18412),l=n(54721),u=n(39498),d=n(46708),p=n(37508),h=n(36084),f=n(67855),g=n(51036),v=(0,d.yh)("clipboardManager"),y=function(){function e(e){this.context=e,this.customClipboard=new o.tQ,e.factory.set(o.vb,this.customClipboard),this.customClipboard.clipboardOptionSetting(this.context)}var t,n,d,v,y;return e.prototype.attach=function(){this.copyInterface&&this.copyInterface.attach(),this.cutInterface&&this.cutInterface.attach(),this.pasteInterface&&this.pasteInterface.attach()},e.prototype.detach=function(){this.copyInterface&&this.copyInterface.detach(),this.cutInterface&&this.cutInterface.detach(),this.pasteInterface&&this.pasteInterface.detach()},e.prototype.copy=function(e){this.context.isCopyable()&&(this.copyInterface?(i.Logger.info("copy by menu"),this.copyInterface.copy(e)):i.Logger.warn("clipboard|copy not loaded"))},e.prototype.mobileBlockMultiCopy=function(e,t){void 0===t&&(t={clipboardType:p.Y.Copy}),this.context.isCopyable()&&(this.copyInterface?this.copyInterface.mobileBlockMultiCopy(e,t):i.Logger.warn("clipboard|copy not loaded"))},e.prototype.cut=function(e){this.context.isEditable()&&this.checkPermissionRange()&&(this.cutInterface?this.cutInterface.cut(e):i.Logger.warn("clipboard|cut not loaded"))},e.prototype.paste=function(){this.context.isEditable()&&this.checkPermissionRange()&&(this.pasteInterface?this.pasteInterface.paste():i.Logger.warn("clipboard|paste not loaded"))},e.prototype.pasteSilent=function(e){var t=this;this.context.isEditable()&&(this.pasteInterface?(0,h.readInClipBoard)().then((function(n){var r,o=n.html,a=n.plain;i.Logger.info("pasteSilent:".concat(e,", plain: ").concat(a));var s=n.blob;s&&(""===o||g.l.isOutImageHtml(o)||g.l.isPasteNativeImageToWeb(o))?g.l.insertImageByPaste([s],t.context):(0===o.length&&0===a.length&&(o=(r=t.customClipboard.getData()).html,a=r.plain),e?t.pasteInterface.doPastePlainText(a):t.pasteInterface.doPaste(o,a,""))})):i.Logger.warn("clipboard|paste not loaded"))},e.prototype.pasteTemplate=function(e){this.context.isEditable()&&(this.pasteInterface?this.pasteInterface.pasteInnerData(e):i.Logger.warn("clipboard|paste not loaded"))},e.prototype.pasteFromClipboard=function(e,t){this.context.isEditable()&&this.pasteInterface&&this.pasteInterface.doPaste(e,t,"")},e.prototype.writeToClipboard=function(e){this.customClipboard.setData("",e,""),this.customClipboard.writeToSysytemClipboard()},e.prototype.isCustomClipboardEmpty=function(){return this.customClipboard.isEmpty()},e.prototype.addCopyModelParser=function(e,t){this.copyParserMgr&&this.copyParserMgr.addCopyModelParser(e,t)},e.prototype.addCopyContainerParser=function(e,t){this.copyParserMgr&&this.copyParserMgr.addCopyContainerParser(e,t)},e.prototype.addPasteNodeProcessor=function(e,t){void 0===t&&(t=l.kd.normal),this.pasteProcessorMgr&&this.pasteProcessorMgr.addPasteNodeProcessor(e,t)},e.prototype.addPasteDstProcessor=function(e,t){this.pasteProcessorMgr&&this.pasteProcessorMgr.addPasteDstProcessor(e,t)},e.prototype.addPasteDeltaProcessor=function(e,t){void 0===t&&(t=l.cm.Normal),this.pasteProcessorMgr&&this.pasteProcessorMgr.addPasteDeltaProcessor(e,t)},e.prototype.storeSelectionInnerData=function(e,t,n){var r,o;if(void 0===t&&(t=!1),e)return null===(o=null===(r=this.copyInterface)||void 0===r?void 0:r.generateHtml)||void 0===o?void 0:o.call(r,e,t,n)},e.prototype.pasteSelectionInnerData=function(e){var t,n;null===(n=null===(t=this.pasteInterface)||void 0===t?void 0:t.pasteCustomInnerData)||void 0===n||n.call(t,null!=e?e:{})},e.prototype.setPasteTypeToCut=function(){this.customClipboard.setPasteType(p.Y.Cut)},e.prototype.canReadPlainSilent=function(){return(0,h.canReadPlainSilent)()},e.prototype.isNeedPermission=function(){return(0,h.isNeedClipboardPermission)()},e.prototype.checkPermissionRange=function(){return this.context.service.getPermissionRange().checkPermissionRange()?(this.context.fire(new f.fl(!0),!1),!0):(this.context.fire(new f.fl(!1),!1),!1)},(0,r.__decorate)([a.y,(0,r.__metadata)("design:type","function"==typeof(t=void 0!==a.y&&a.y)?t:Object)],e.prototype,"copyInterface",void 0),(0,r.__decorate)([u.v,(0,r.__metadata)("design:type","function"==typeof(n=void 0!==u.v&&u.v)?n:Object)],e.prototype,"copyParserMgr",void 0),(0,r.__decorate)([s.A,(0,r.__metadata)("design:type","function"==typeof(d=void 0!==s.A&&s.A)?d:Object)],e.prototype,"cutInterface",void 0),(0,r.__decorate)([c.M,(0,r.__metadata)("design:type","function"==typeof(v=void 0!==c.M&&c.M)?v:Object)],e.prototype,"pasteInterface",void 0),(0,r.__decorate)([l.FM,(0,r.__metadata)("design:type","function"==typeof(y=void 0!==l.FM&&l.FM)?y:Object)],e.prototype,"pasteProcessorMgr",void 0),e}()},51036:function(e,t,n){n.d(t,{l:function(){return a}});var r=n(82487),o=n(66907),i=n(46708),a=function(){function e(){}return e.onlyHasImgElement=function(e){return""===e.body.innerText.trim()&&!!e.querySelector("img")},e.isOutImageHtml=function(e){var t=(new DOMParser).parseFromString(e,"text/html");return this.onlyHasImgElement(t)&&-1===e.indexOf("tdoc-data-src")},e.isPasteNativeImageToWeb=function(e){var t=(new DOMParser).parseFromString(e,"text/html"),n=this.onlyHasImgElement(t),r=t.querySelector("[tdoc-data-src]");return!(!r||i.$w.getAttr(r,o.INNER_DATA_TYPE)!==o.InnerDataType.LocalData)&&(n&&!(0,o.isLocalEdit)())},e.getPasteDstType=function(e,t){var n,i;return(null===(n=e.getTableSelectionArea())||void 0===n?void 0:n.isInnerTable())?o.PasteDstType.Table:(null===(i=e.getTableSelectionArea())||void 0===i?void 0:i.isInnerCell(t))?o.PasteDstType.Cell:e.storyType()!==r.AHI.mainDocument?e.storyType()===r.AHI.textboxContent?e.isSelectionAtCodeblock()?o.PasteDstType.Codeblock:o.PasteDstType.LightBlock:e.storyType()===r.AHI.headerContent||e.storyType()===r.AHI.footerContent?o.PasteDstType.HeaderFooter:o.PasteDstType.SubStory:o.PasteDstType.Doc},e.insertImageByPaste=function(t,n){n.run("insert_image",t,(function(){var t={hasBlob:!0,pasteDstType:e.getPasteDstType(n.service.getSelection())};n.fire(new o.ClipboardNotification(o.ClipboardNotificationType.ON_PASTE,t))}))},e}()},37508:function(e,t,n){var r;n.d(t,{Y:function(){return r}}),function(e){e.Copy="copy",e.Cut="cut",e.Paste="paste"}(r||(r={}))},67855:function(e,t,n){n.d(t,{Y3:function(){return a},fl:function(){return s},pd:function(){return r}});var r,o=n(85556),i=n(30479);!function(e){e.ON_BEFORE_ACTION="on_before_action",e.ON_COPY="on_copy",e.ON_CUT="on_cut",e.ON_PASTE="on_paste"}(r||(r={}));var a=function(e){function t(t,n){var r=e.call(this,t)||this;return r.pasteData=n,r}return(0,o.__extends)(t,e),t}(i.Notification),s=function(e){function t(t){var n=e.call(this,r.ON_BEFORE_ACTION)||this;return n.hasPermission=t,n}return(0,o.__extends)(t,e),t}(i.Notification)},4708:function(e,t,n){function r(){return"desktop_local"===(new URL(window.location.href).searchParams.get("client")||"")}var o;n.d(t,{$0:function(){return r},Em:function(){return a},Qg:function(){return i},ji:function(){return o}}),function(e){e.LocalData="localData",e.WebData="webData"}(o||(o={}));var i="inner_data_type";function a(){return r()?o.LocalData:o.WebData}},87468:function(e,t,n){n.d(t,{n0:function(){return s},tQ:function(){return l},vb:function(){return c}});var r=n(46708),o=n(66907),i=n(30479),a=n(67855),s="3.0.0",c=(0,r.yh)("customClipboard"),l=function(){function e(){this.html="",this.plain="",this.innerData="",this.selectionInnerData={html:"",plain:"",innerData:""},this.pasteType=o.ClipboardType.Copy}return e.prototype.setData=function(e,t,n){void 0===e&&(e=""),void 0===t&&(t=""),void 0===n&&(n=""),this.html=e,this.plain=t,this.innerData=n},e.prototype.getData=function(){return{html:this.html,plain:this.plain,innerData:this.innerData}},e.prototype.setPasteType=function(e){this.pasteType=e,i.Logger.info("set paste type: ".concat(e))},e.prototype.getPasteType=function(){return this.pasteType},e.prototype.isEmpty=function(){return 0===this.plain.length&&0===this.html.length&&0===this.innerData.length},e.prototype.setSelectionInnerData=function(e){this.selectionInnerData=e},e.prototype.getSelectionInnerData=function(){return this.selectionInnerData?this.selectionInnerData:null},e.prototype.isCopyByInternal=function(e,t){void 0===t&&(t="");var n=this,r=n.plain,o=n.html,a=n.innerData,s=r.replace(/\r\n?/g,"\n")===e.replace(/\r\n?/g,"\n");return i.Logger.info("isCopyByInternal isSamePlain: ".concat(s)),r&&o&&a&&!t&&s?o:(this.setData(),"")},e.prototype.writeToSysytemClipboard=function(){var e=document.createElement("textarea");e.readOnly=!0,e.style.zIndex="0",e.style.opacity="0",e.style.top="-9999px",e.style.left="-9999px",e.style.position="fixed",document.body.appendChild(e),e.value=this.plain;var t=document.createRange();t.selectNode(e);var n=window.getSelection();n&&n.addRange(t),e.select(),document.execCommand("SelectAll"),document.execCommand("copy"),document.body.removeChild(e),i.Logger.info("writeToSystemClipboard: ".concat(this.plain))},e.prototype.clipboardOptionSetting=function(e){var t=this;e.on(a.pd.ON_COPY,(function(e){var n,r=(null!==(n=e.pasteData)&&void 0!==n?n:{isCut:!1}).isCut,i=void 0!==r&&r;t.setPasteType(i?o.ClipboardType.Cut:o.ClipboardType.Copy)})),e.on(a.pd.ON_CUT,(function(){t.setPasteType(o.ClipboardType.Cut)}))},e}()},47823:function(e,t,n){n.d(t,{n:function(){return o}});var r=n(30479);function o(){return new Promise((function(e,t){if(void 0!==window.browser&&window.browser.file)return e();var n=document.createElement("script");n.src="https://jsapi.qq.com/get?api=file.*",n.async=!0,n.type="text/javascript",n.onload=function(){r.Logger.info("qb-jssdk-loaded"),e()},n.onerror=function(e){r.Logger.info("qb-jssdk-loaded failed",e),t(e)},document.body.appendChild(n)}))}},66907:function(e,t,n){n.d(t,{BeforeClipboardActionNotification:function(){return u.fl},ClipboardManager:function(){return p.U},ClipboardNotification:function(){return u.Y3},ClipboardNotificationType:function(){return u.pd},ClipboardType:function(){return c.Y},ClipboardUtils:function(){return g.l},CopyInterface:function(){return o.y},CustomClipboard:function(){return l.tQ},CutInterface:function(){return i.A},DATA_VERSION:function(){return l.n0},IClipboardManager:function(){return p.H},ICopyParserManager:function(){return r.v},ICustomClipboard:function(){return l.vb},INNER_DATA_TYPE:function(){return y.Qg},IPasteProcessorManager:function(){return s.FM},InnerDataType:function(){return y.ji},PasteDeltaProcessorPriority:function(){return s.cm},PasteDstType:function(){return s.Ze},PasteInterface:function(){return a.M},PasteNodeProcessorPriority:function(){return s.kd},PasteSrcType:function(){return s.Zr},borderHtmlTypeMap:function(){return f.JS},borderV2SizeMap:function(){return f.uM},borerV2V3Map:function(){return f.VN},borerV3V2Map:function(){return f.Cv},getDataType:function(){return y.Em},htmlBorderTypeMap:function(){return f.k$},isLocalEdit:function(){return y.$0},loadQQBrowserJSSDK:function(){return d.n},makeEmptyCopyData:function(){return r.x},ooxmlBorderType2MsoBorderTypeMap:function(){return f.rx},transformListIdToMsoId:function(){return v.w}});var r=n(39498),o=n(48020),i=n(11443),a=n(18412),s=n(54721),c=n(37508),l=n(87468),u=n(67855),d=n(47823),p=n(4180),h=n(36084);n.o(h,"Changeset")&&n.d(t,{Changeset:function(){return h.Changeset}}),n.o(h,"ClipboardNotificationData")&&n.d(t,{ClipboardNotificationData:function(){return h.ClipboardNotificationData}}),n.o(h,"ClipboardUtils")&&n.d(t,{ClipboardUtils:function(){return h.ClipboardUtils}}),n.o(h,"INNER_DATA_TYPE")&&n.d(t,{INNER_DATA_TYPE:function(){return h.INNER_DATA_TYPE}}),n.o(h,"ISelectionInnerData")&&n.d(t,{ISelectionInnerData:function(){return h.ISelectionInnerData}}),n.o(h,"InnerDataType")&&n.d(t,{InnerDataType:function(){return h.InnerDataType}}),n.o(h,"InsertMutation")&&n.d(t,{InsertMutation:function(){return h.InsertMutation}}),n.o(h,"ModifyMutation")&&n.d(t,{ModifyMutation:function(){return h.ModifyMutation}}),n.o(h,"MutationType")&&n.d(t,{MutationType:function(){return h.MutationType}}),n.o(h,"borderHtmlTypeMap")&&n.d(t,{borderHtmlTypeMap:function(){return h.borderHtmlTypeMap}}),n.o(h,"borderV2SizeMap")&&n.d(t,{borderV2SizeMap:function(){return h.borderV2SizeMap}}),n.o(h,"borerV2V3Map")&&n.d(t,{borerV2V3Map:function(){return h.borerV2V3Map}}),n.o(h,"borerV3V2Map")&&n.d(t,{borerV3V2Map:function(){return h.borerV3V2Map}}),n.o(h,"getDataType")&&n.d(t,{getDataType:function(){return h.getDataType}}),n.o(h,"htmlBorderTypeMap")&&n.d(t,{htmlBorderTypeMap:function(){return h.htmlBorderTypeMap}}),n.o(h,"isLocalEdit")&&n.d(t,{isLocalEdit:function(){return h.isLocalEdit}}),n.o(h,"isSupportWXRTF")&&n.d(t,{isSupportWXRTF:function(){return h.isSupportWXRTF}}),n.o(h,"isSupportWeDriveMini")&&n.d(t,{isSupportWeDriveMini:function(){return h.isSupportWeDriveMini}}),n.o(h,"ooxmlBorderType2MsoBorderTypeMap")&&n.d(t,{ooxmlBorderType2MsoBorderTypeMap:function(){return h.ooxmlBorderType2MsoBorderTypeMap}}),n.o(h,"readWXRTFClipboard")&&n.d(t,{readWXRTFClipboard:function(){return h.readWXRTFClipboard}}),n.o(h,"readWeDriveMiniClipboard")&&n.d(t,{readWeDriveMiniClipboard:function(){return h.readWeDriveMiniClipboard}}),n.o(h,"readWeworkClipboard")&&n.d(t,{readWeworkClipboard:function(){return h.readWeworkClipboard}}),n.o(h,"tdocsCopyPaste")&&n.d(t,{tdocsCopyPaste:function(){return h.tdocsCopyPaste}}),n.o(h,"transformListIdToMsoId")&&n.d(t,{transformListIdToMsoId:function(){return h.transformListIdToMsoId}}),n.o(h,"writeWXRTFClipboard")&&n.d(t,{writeWXRTFClipboard:function(){return h.writeWXRTFClipboard}}),n.o(h,"writeWeworkClipboard")&&n.d(t,{writeWeworkClipboard:function(){return h.writeWeworkClipboard}});var f=n(34155),g=n(51036),v=n(25374),y=n(4708)},61251:function(e,t,n){n.d(t,{ks:function(){return we},bK:function(){return ve},dn:function(){return fe},Hn:function(){return ge},uO:function(){return A.u},zI:function(){return r},dZ:function(){return V},U6:function(){return x},Ey:function(){return Q},fV:function(){return J},Dk:function(){return W},lc:function(){return Te},To:function(){return Re},qH:function(){return Be},MJ:function(){return Ie},Sy:function(){return Pe},Se:function(){return De},Qw:function(){return S},Zi:function(){return ke},QZ:function(){return H},rl:function(){return j},bJ:function(){return Me},iW:function(){return Ae},yb:function(){return Ue},fp:function(){return Le},fo:function(){return Oe},vH:function(){return w},S$:function(){return T},mu:function(){return Ne},wr:function(){return te},Gt:function(){return X},Ln:function(){return Z},zO:function(){return _},$z:function(){return z},gy:function(){return E},$K:function(){return Y},Zl:function(){return q},Rz:function(){return me},Xj:function(){return U},Rr:function(){return F},Aj:function(){return K},GT:function(){return R},TD:function(){return Se},Sd:function(){return l},sy:function(){return u},GJ:function(){return G},og:function(){return c},Wl:function(){return be},Zk:function(){return re},CC:function(){return ue},GP:function(){return ne},iA:function(){return ee},nL:function(){return oe},Qj:function(){return $},oX:function(){return ce},un:function(){return he},V6:function(){return le},PO:function(){return se},vW:function(){return He},bH:function(){return M},Wh:function(){return O},xl:function(){return Fe},Lg:function(){return Ee},qg:function(){return _e},DY:function(){return N},ns:function(){return C},EQ:function(){return f},k8:function(){return h},Jj:function(){return p},X5:function(){return g},yG:function(){return P},LC:function(){return B},TP:function(){return ae},Nl:function(){return pe},nn:function(){return ye},U1:function(){return de},rG:function(){return xe},$o:function(){return L.$o},o2:function(){return L.o2},e_:function(){return L.e_},gL:function(){return L.gL},Kg:function(){return L.Kg},E0:function(){return L.E0},oN:function(){return L.ks},i1:function(){return L.i1},yv:function(){return L.yv},Pq:function(){return L.Pq},tq:function(){return L.tq},Hg:function(){return L.Hg},eJ:function(){return L.eJ},_g:function(){return L._g},vv:function(){return L.vv},Cx:function(){return L.Cx},zd:function(){return L.zd},AY:function(){return L.AY},De:function(){return L.De},Gz:function(){return L.Gz},qM:function(){return L.qM},AO:function(){return L.AO},fX:function(){return L.fX},pm:function(){return L.pm},Dy:function(){return L.Dy},tR:function(){return L.tR},Av:function(){return L.Av},Oi:function(){return L.Oi},o7:function(){return L.o7},w5:function(){return L.w5},n6:function(){return L.n6},wS:function(){return L.wS},dc:function(){return L.dc},Eb:function(){return L.Eb},UB:function(){return L.UB},FG:function(){return L.FG},cu:function(){return L.cu},t$:function(){return L.t$},Le:function(){return L.Le},Jt:function(){return L.Jt},Wf:function(){return L.Wf},YP:function(){return L.YP},hE:function(){return L.hE},$5:function(){return L.$5},UO:function(){return L.UO},sJ:function(){return L.sJ},yR:function(){return L.yR},NF:function(){return L.NF},k4:function(){return L.k4},tJ:function(){return L.tJ},yB:function(){return L.yB},rM:function(){return L.rM}});var r,o=n(85556),i=n(31518),a=n(46708),s=n(82487);!function(e){e[e.ApplyDelta=0]="ApplyDelta",e[e.Collab=1]="Collab",e[e.Layout=2]="Layout",e[e.Reflow=3]="Reflow",e[e.Render=4]="Render",e[e.Overlay=5]="Overlay",e[e.COUNT=6]="COUNT"}(r||(r={}));var c,l,u,d,p,h,f,g,v,y,m,b,_,C,S=(0,a.yh)("editor"),w=(function(e){function t(){var t=e.call(this)||this;return t.docEnv=s.K1I,t.root=null,t.perfManager={lastTime:0,editTimes:0,costTime:new Float32Array(r.COUNT),recentEditInfoList:[],increEditTimes:function(){},resetEditTimes:function(){},getPerfInfo:function(){return{}},addRecentEditInfo:function(){return[]}},t.service=t.empty(),t.surface=t.empty(),t.view=t.empty(),t.modelWrapperMgr=t.empty(),t.statisticInfo=t.empty(),t.constraintSpace=void 0,t.wordCount=i.hn,t.perfInfo=t.empty(),t.zoom=1,t.isPagedView=!1,t.setPermissionRangeMode=function(){},t.usePermissionRangeMode=function(){return!1},t.emptyContent=function(){},t.setContent=function(){},t.setDataEngine=function(){},t.applyDelta=function(){},t.setRangeTo=function(){},t.applyMutations=function(e,t){},t.isEditable=function(){return t.docEnv.editable},t.isCopyable=function(){return t.docEnv.copyable},t.updateDocEnv=function(e){t.docEnv=e},t.setLayoutType=function(e){t.docEnv.layoutType=e},t.setEditable=function(e){t.docEnv.editable=e},t.setCopyable=function(e){t.docEnv.copyable=e},t.isCaret=function(){return!1},t.setNewDocumentCallback=function(e){t.newDocumentCallback=e},t.isCompositing=function(){return!1},t.attachEditor=function(e){t.root=e},t.detach=function(){t.root&&t.root.remove()},t.getDocumentBox=function(){return t.empty()},t.getViewRangeFromGcpRange=function(){return t.empty()},t.getDrawingStream=function(){},t.getTableStream=function(){},t.getShadingProperty=function(){return t.empty()},t.factory.set(S,t),t}(0,o.__extends)(t,e),t.prototype.getFontService=function(){return this.empty()},t.prototype.isInBlockState=function(){return this.docEnv.isBlock},t.prototype.setWebLayoutPageWidth=function(){},t.prototype.createGcpManager=function(){},t.prototype.createRangeManager=function(){},t.prototype.empty=function(){return{}},t.prototype.getRangeFromIndex=function(){return new s.ICE(0,0)},t.prototype.getIndexFromRange=function(){return{first:0,last:0}},t.prototype.getLayoutError=function(){return null}}(i._y),(0,a.yh)("service"));!function(e){e.Headline="heading",e.BulletList="bulletList",e.TaskList="taskList",e.Codeblock="codeblock",e.Horizontal="horizontal",e.Italic="italic",e.Emphasis="emphasis",e.ItalicAndEmphasis="italicAndEmphasis",e.Underline="underline",e.Strike="strike",e.UnderlineAndStrike="underlineAndStrike",e.Quote="quote",e.HighlightBlock="highlightBlock"}(c||(c={})),function(e){e[e.Prev=0]="Prev",e[e.Next=1]="Next"}(l||(l={})),function(e){e[e.absolute=0]="absolute",e[e.relative=1]="relative",e[e.auto=2]="auto"}(u||(u={})),function(e){e.FitToParent="fitToParent"}(d||(d={})),function(e){e[e.Undefined=9999999]="Undefined",e[e.Toggle=9999998]="Toggle"}(p||(p={})),function(e){e[e.CollapseEnd=0]="CollapseEnd",e[e.CollapseStart=1]="CollapseStart"}(h||(h={})),function(e){e[e.ColumnBreak=8]="ColumnBreak",e[e.LineBreak=6]="LineBreak",e[e.LineBreakClearLeft=9]="LineBreakClearLeft",e[e.LineBreakClearRight=10]="LineBreakClearRight",e[e.PageBreak=7]="PageBreak",e[e.SectionBreakContinuous=3]="SectionBreakContinuous",e[e.SectionBreakEvenPage=4]="SectionBreakEvenPage",e[e.SectionBreakNextPage=2]="SectionBreakNextPage",e[e.SectionBreakOddPage=5]="SectionBreakOddPage",e[e.TextWrappingBreak=11]="TextWrappingBreak"}(f||(f={})),function(e){e.fieldEmpty="",e.fieldDate="DATE",e.fieldTime="TIME",e.fieldAuthor="AUTHOR",e.fieldNumWords="NUMWORDS",e.fieldPage="PAGE",e.fieldSectionPages="SECTIONPAGES",e.fieldSequence="SEQ",e.fieldTOC="TOC",e.fieldTOCEntry="TC",e.fieldPageRef="PAGEREF",e.fieldRef="REF",e.fieldHyperlink="HYPERLINK",e.fieldEmbed="EMBED",e.fieldNumPages="NUMPAGES",e.fieldIncludePicture="INCLUDEPICTURE",e.fieldMergeField="MERGEFIELD",e.fieldNext="Next",e.fieldFormula="EQ",e.fieldDocVariable="DOCVARIABLE",e.fieldFormTextInput="FORMTEXT",e.fieldFormCheckBox="FORMCHECKBOX",e.fieldFormDropDown="FORMDROPDOWN",e.fieldAddin="ADDIN",e.fieldExpression="=",e.fieldNoteRef="NOTEREF",e.fieldStyleRef="STYLEREF",e.fieldMacroButton="MACROBUTTON",e.fieldSaveDate="SAVEDATE",e.fieldPrintDate="PRINTDATE",e.fieldDocProperty="DOCPROPERTY",e.fieldIncludeText="INCLUDETEXT",e.fieldIndexEntry="XE",e.fieldIndex="INDEX",e.fieldAutoNum="AUTONUM",e.fieldListNum="LISTNUM",e.fieldShape="SHAPE",e.fieldIf="IF",e.fieldFileName="FILENAME"}(g||(g={})),function(e){e[e.StoryBreak=0]="StoryBreak",e[e.SectBreak=1]="SectBreak",e[e.PageBreak=2]="PageBreak",e[e.ParaBreak=3]="ParaBreak",e[e.TableRowBreak=4]="TableRowBreak",e[e.TableRowStart=5]="TableRowStart",e[e.TableCellBreak=6]="TableCellBreak",e[e.TableCellStart=7]="TableCellStart",e[e.TableStartBreak=8]="TableStartBreak",e[e.TableEndBreak=9]="TableEndBreak",e[e.FieldChar=10]="FieldChar",e[e.DefaultContainer=11]="DefaultContainer",e[e.DefaultPlugin=12]="DefaultPlugin",e[e.DefaultDrawing=13]="DefaultDrawing",e[e.Image=14]="Image",e[e.Splitline=15]="Splitline",e[e.Textframe=16]="Textframe",e[e.Codeblock=17]="Codeblock",e[e.EmbedComment=18]="EmbedComment",e[e.Comment=19]="Comment",e[e.Text=20]="Text"}(v||(v={})),function(e){e[e.DELETE=0]="DELETE",e[e.INSERT=1]="INSERT",e[e.MODIFY=2]="MODIFY",e[e.CLEAR=3]="CLEAR"}(y||(y={})),function(e){e[e.Contain=0]="Contain",e[e.Join=1]="Join"}(m||(m={})),function(e){e.logicalRange="logicalRange",e.realRange="realRange"}(b||(b={})),function(e){e[e.KEYBOARD_UP=1]="KEYBOARD_UP",e[e.KEYBOARD_DOWN=0]="KEYBOARD_DOWN"}(_||(_={})),function(e){e[e.VIEW=0]="VIEW",e[e.EDIT=1]="EDIT"}(C||(C={}));var E,x,T=(0,a.yh)("surface");!function(e){e.Inline="inline",e.Block="block",e.InlineBlock="inline-block",e.None="none"}(E||(E={})),function(e){e[e.Inline=0]="Inline",e[e.Block=1]="Block"}(x||(x={}));var R,I,P,O=function(){function e(e){this.top=e.top,this.left=e.left,this.bottom=e.bottom,this.right=e.right}return e.prototype.reset=function(e){this.top=e,this.left=e,this.bottom=e,this.right=e},e.prototype.transform=function(t){return new e({top:t(this.top),left:t(this.bottom),bottom:t(this.bottom),right:t(this.right)})},e.getNone=function(t){return new e({top:t,left:t,bottom:t,right:t})},e}(),k=function(){function e(e){this.width=e.width}return e.prototype.reset=function(){this.width.reset(0)},Object.defineProperty(e,"none",{get:function(){return new e({width:O.getNone(0)})},enumerable:!1,configurable:!0}),e}(),D=n(30479),M=function(e){function t(t){var n=e.call(this)||this;return n.margin=t.margin,n.padding=t.padding,n.border=t.border,n}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"left",{get:function(){return this.margin.left+this.border.width.left+this.padding.left},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.margin.right+this.border.width.right+this.padding.right},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.margin.top+this.border.width.top+this.padding.top},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.margin.bottom+this.border.width.bottom+this.padding.bottom},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.left+this.right},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.top+this.bottom},enumerable:!1,configurable:!0}),t.prototype.recycle=function(){this.margin.reset(0),this.padding.reset(0),this.border.reset(),t.sPool.recycle(this)},t.obtain=function(){return t.sPool.obtain()||t.none},Object.defineProperty(t,"none",{get:function(){return new t({margin:O.getNone(0),padding:O.getNone(0),border:k.none})},enumerable:!1,configurable:!0}),t.sPool=new D.ObjectPool(5),t}(D.PoolNode),A=n(76384),L=n(86538);!function(e){e[e.Field=0]="Field",e[e.Text=1]="Text"}(R||(R={})),function(e){e[e.Default=0]="Default",e[e.Mention=1]="Mention"}(I||(I={})),function(e){e[e.Normal=0]="Normal",e[e.LineBreak=1]="LineBreak",e[e.Separator=2]="Separator",e[e.FieldChar=3]="FieldChar",e[e.TablePlaceHolder=4]="TablePlaceHolder",e[e.Tabstop=5]="Tabstop"}(P||(P={}));var N,B=function(){function e(){}return e.getTypeByText=function(e){if(1!==e.length)return P.Normal;var t=e.charCodeAt(0);return(0,s.jUV)(t)?P.LineBreak:(0,s.CLV)(t)?P.Separator:(0,s.wR4)(t)?P.Tabstop:t===s.ghV.FieldBegin||t===s.ghV.FieldSeparate||t===s.ghV.FieldEnd?P.FieldChar:t===s.ghV.TableStart||t===s.ghV.TableEnd?P.TablePlaceHolder:P.Normal},e}();!function(e){e[e.Rectangle=0]="Rectangle",e[e.Polygon=1]="Polygon",e[e.BezierCurve=2]="BezierCurve"}(N||(N={}));var F,U,H=(0,a.yh)("layoutController"),j=Symbol("ILayoutController");!function(e){e.LayoutChanged="layoutChanged",e.LayoutFinished="layoutFinished",e.LayoutEachChunkFinished="layoutEachChunkFinished",e.ForceReflow="forceReflow",e.LayoutTypeChanged="layoutTypeChanged"}(F||(F={})),function(e){e[e.Full=0]="Full",e[e.Lite=1]="Lite"}(U||(U={}));var G,V,W,z=function(e){function t(t,n,r){void 0===t&&(t=U.Full);var o=e.call(this,F.LayoutChanged)||this;return o.mode=t,o.isReflow=n,o.currentLastGCP=r,o}return(0,o.__extends)(t,e),t}(D.Notification),K=function(e){function t(t){var n=e.call(this,F.LayoutTypeChanged)||this;return n.layoutType=t,n}return(0,o.__extends)(t,e),t}(D.Notification),q=function(e){function t(t,n){void 0===t&&(t=U.Full);var r=e.call(this,F.LayoutFinished)||this;return r.mode=t,r.isReflow=n,r}return(0,o.__extends)(t,e),t}(D.Notification),Y=function(e){function t(t){void 0===t&&(t=U.Full);var n=e.call(this,F.LayoutEachChunkFinished)||this;return n.mode=t,n}return(0,o.__extends)(t,e),t}(D.Notification),Q=function(e){function t(t,n){var r=e.call(this,F.ForceReflow)||this;return r.modelDirtyRange=t,r.allDirty=n,r}return(0,o.__extends)(t,e),t}(D.Notification);!function(e){e[e.Outer=0]="Outer",e[e.Inner=1]="Inner",e[e.Both=2]="Both"}(G||(G={})),function(e){e[e.LeafContainer=0]="LeafContainer"}(V||(V={})),function(e){e.ON_INPUT="on_input",e.ON_COMPOSITION_START="on_composition_start",e.ON_COMPOSITION_END="on_composition_end",e.ON_POS_UPDATE="on_pos_update"}(W||(W={}));var Z,X,J=function(e){function t(t,n){var r=e.call(this,t)||this;return r.data=n,r}return(0,o.__extends)(t,e),t}(D.Notification);!function(e){e.MOBILE_KEYBOARD_SHOW="mobileKeyboardShow",e.MOBILE_KEYBOARD_HIDE="mobileKeyboardHide",e.MOBILE_KEYBOARD_REFRESH_POSITION="mobileKeyboardRefreshPosition"}(Z||(Z={})),function(e){e[e.EDITOR=0]="EDITOR",e[e.VIEWPORT_RESIZE=1]="VIEWPORT_RESIZE",e[e.STYLE_PANEL_SHOW=2]="STYLE_PANEL_SHOW",e[e.OTHER=3]="OTHER"}(X||(X={}));var $,ee,te=function(e){function t(t,n){var r=e.call(this,t)||this;return r.from=n,r}return(0,o.__extends)(t,e),t}(D.Notification);!function(e){e.ON_DRAG="on_selection_drag"}($||($={})),function(e){e[e.START_DRAG=0]="START_DRAG",e[e.END_DRAG=1]="END_DRAG"}(ee||(ee={}));var ne,re,oe=function(e){function t(t,n){var r=e.call(this,$.ON_DRAG)||this;return r.event=t,r.dragAction=n,r}return(0,o.__extends)(t,e),t}(D.Notification);!function(e){e.ON_DRAG="on_caret_drag"}(ne||(ne={})),function(e){e[e.START_DRAG=0]="START_DRAG",e[e.END_DRAG=1]="END_DRAG"}(re||(re={}));var ie,ae,se,ce,le,ue=function(e){function t(t){var n=e.call(this,ne.ON_DRAG)||this;return n.dragAction=t,n}return(0,o.__extends)(t,e),t}(D.Notification);!function(e){e.MOBILE_PANEL_SHOW="mobilePanelShow",e.MOBILE_PANEL_HIDE="mobilePanelHide"}(ie||(ie={})),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,o.__extends)(t,e)}(D.Notification),function(e){e.MOBILE_TOOLBAR_SHOW="mobileToolbarShow",e.MOBILE_TOOLBAR_HIDE="mobileToolbarHide"}(ae||(ae={})),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,o.__extends)(t,e)}(D.Notification),function(e){e[e.NONE=0]="NONE",e[e.DOWN=1]="DOWN",e[e.MOVE=2]="MOVE",e[e.UP=3]="UP",e[e.CONTEXTMENU=4]="CONTEXTMENU"}(se||(se={})),function(e){e.NONE="none",e.DRAG="drag",e.CLICK="click",e.DOUBLE_CLICK="double_click",e.TRIPLE_CLICK="triple_click",e.LONG_CLICK="long_click"}(ce||(ce={})),function(e){e.MOUSE_EVENT="mouse_event"}(le||(le={}));var de,pe,he=function(e){function t(t,n,r){var o=e.call(this,le.MOUSE_EVENT)||this;return o.event=t,o.mouseAction=n,o.hitPoint=r,o}return(0,o.__extends)(t,e),t}(D.Notification);!function(e){e.TOUCH_EVENT="touch_event"}(de||(de={})),function(e){e[e.NONE=0]="NONE",e[e.TOUCH=1]="TOUCH",e[e.DOUBLE_TOUCH=2]="DOUBLE_TOUCH",e[e.TRIPLE_TOUCH=3]="TRIPLE_TOUCH",e[e.LONG_TOUCH=4]="LONG_TOUCH"}(pe||(pe={}));var fe,ge,ve,ye=function(e){function t(t,n,r,o){var i=e.call(this,de.TOUCH_EVENT)||this;return i.event=t,i.touchAction=n,i.hitPoint=r,i.viewRange=o,i}return(0,o.__extends)(t,e),t}(D.Notification);!function(e){e.A11yContentChange="accessibilityContentChange"}(fe||(fe={})),function(e){e.A11ySwitch="accessibilityIsSupported"}(ge||(ge={})),function(e){e.NONE="none",e.ERROR="error",e.INTRODUCTION="introduction",e.INSERT="insert",e.DELETE="delete",e.MODIFY="modify",e.SELECTED="selected",e.PARAGRAPH="paragraph",e.SLIGHT_MOVE="slightMove",e.LINE="line"}(ve||(ve={}));var me,be,_e,Ce,Se,we=function(e){function t(t){var n=e.call(this,fe.A11yContentChange)||this;return n.data=t,n}return(0,o.__extends)(t,e),t}(D.Notification);!function(e){e[e.MainStory=0]="MainStory",e[e.Page=1]="Page",e[e.HeaderFooter=2]="HeaderFooter",e[e.Body=3]="Body",e[e.Section=4]="Section",e[e.Columns=5]="Columns",e[e.RichTextArea=6]="RichTextArea",e[e.Paragraph=7]="Paragraph",e[e.Line=8]="Line",e[e.TextGroup=9]="TextGroup",e[e.Text=10]="Text",e[e.Table=11]="Table",e[e.TableRow=12]="TableRow",e[e.TableCell=13]="TableCell",e[e.Image=14]="Image",e[e.LeafContainer=15]="LeafContainer",e[e.FieldContainer=16]="FieldContainer",e[e.EmbeddedObject=17]="EmbeddedObject",e[e.List=18]="List",e[e.TextFrame=19]="TextFrame",e[e.FieldCode=20]="FieldCode",e[e.Footnote=21]="Footnote",e[e.Endnote=22]="Endnote",e[e.Empty=23]="Empty"}(me||(me={})),function(e){e[e.Hidden=0]="Hidden",e[e.Placeholder=1]="Placeholder",e[e.Secondary=2]="Secondary"}(be||(be={})),function(e){e[e.Scroller=0]="Scroller",e[e.FocusOn=1]="FocusOn",e[e.EditorInfo=2]="EditorInfo",e[e.TaskActive=3]="TaskActive",e[e.ParagraphShortcutMenu=4]="ParagraphShortcutMenu",e[e.TextFrameActive=5]="TextFrameActive",e[e.ImageCache=6]="ImageCache"}(_e||(_e={})),function(e){e.TEXT_EDIT="text_edit",e.SHAPE_EDIT="shape_edit"}(Ce||(Ce={})),function(e){e.none="none",e.single="single",e.thick="thick",e.double="double",e.triple="triple",e.dotted="dotted",e.dashed="dashed",e.dotDash="dotDash",e.dotDotDash="dotDotDash",e.wave="wave",e.doubleWave="doubleWave",e.dashSmallGap="dashSmallGap",e.thinThickSmallGap="thinThickSmallGap",e.thickThinSmallGap="thickThinSmallGap",e.thinThickThinSmallGap="thinThickThinSmallGap",e.thinThickMediumGap="thinThickMediumGap",e.thickThinMediumGap="thickThinMediumGap",e.thinThickThinMediumGap="thinThickThinMediumGap",e.thinThickLargeGap="thinThickLargeGap",e.thickThinLargeGap="thickThinLargeGap",e.thinThickThinLargeGap="thinThickThinLargeGap",e.inset="inset",e.outset="outset",e.dashDotStroked="dashDotStroked",e.threeDEmboss="threeDEmboss",e.threeDEngrave="threeDEngrave"}(Se||(Se={}));var Ee,xe={x:0,y:0,width:0,height:0};!function(e){e[e.Canvas=0]="Canvas",e[e.Svg=1]="Svg"}(Ee||(Ee={}));var Te=Symbol("IAnchorView"),Re=Symbol("IBitmapView"),Ie=Symbol("IComponentView"),Pe=Symbol("IContainerView"),Oe=Symbol("IScrollContainerView"),ke=Symbol("IGraphicsView"),De=Symbol("IDrawingView"),Me=Symbol("ILineView"),Ae=Symbol("IOverlayView"),Le=Symbol("IRoundRectView"),Ne=Symbol("ITextView"),Be=Symbol("IBlockParagraphContext"),Fe=150,Ue=Symbol("IRenderDocument"),He=function(){function e(e){this.style=e.style,this.color=e.color,this.lineSz=e.lineSz}return e.prototype.reset=function(){this.style.reset(s.EJ9.none),this.color.reset(""),this.lineSz.reset(0)},Object.defineProperty(e,"none",{get:function(){return new e({style:O.getNone(s.EJ9.none),color:O.getNone(""),lineSz:O.getNone(0)})},enumerable:!1,configurable:!0}),e}()},76384:function(e,t,n){var r;n.d(t,{u:function(){return r}}),function(e){e[e.Document=0]="Document",e[e.Page=1]="Page",e[e.Body=2]="Body",e[e.HeaderFooter=3]="HeaderFooter",e[e.Section=4]="Section",e[e.Columns=5]="Columns",e[e.RichTextArea=6]="RichTextArea",e[e.Paragraph=7]="Paragraph",e[e.Line=8]="Line",e[e.SubLine=9]="SubLine",e[e.Field=10]="Field",e[e.Table=11]="Table",e[e.TableRow=12]="TableRow",e[e.TableCell=13]="TableCell",e[e.Text=14]="Text",e[e.Image=15]="Image",e[e.LeafContainer=16]="LeafContainer",e[e.FieldContainer=17]="FieldContainer",e[e.EmbeddedObject=18]="EmbeddedObject",e[e.TextFrame=19]="TextFrame",e[e.Footnote=20]="Footnote",e[e.Endnote=21]="Endnote",e[e.Empty=22]="Empty",e[e.DocumentLite=23]="DocumentLite",e[e.SectionLite=24]="SectionLite",e[e.ParagraphLite=25]="ParagraphLite",e[e.FieldCodeLite=26]="FieldCodeLite",e[e.TextLineLite=27]="TextLineLite",e[e.TableLite=28]="TableLite",e[e.TableRowLite=29]="TableRowLite",e[e.TableCellLite=30]="TableCellLite",e[e.TextLite=31]="TextLite",e[e.ContainerLite=32]="ContainerLite",e[e.TextFrameLite=33]="TextFrameLite",e[e.EmptyLite=34]="EmptyLite"}(r||(r={}))},86538:function(e,t,n){n.d(t,{$5:function(){return A},$o:function(){return i},AO:function(){return z},AY:function(){return f},Av:function(){return B},Cx:function(){return N},De:function(){return h},Dy:function(){return a},E0:function(){return H},Eb:function(){return s},FG:function(){return F},Gz:function(){return ne},Hg:function(){return Y},Jt:function(){return _},Kg:function(){return $},Le:function(){return j},NF:function(){return S},Oi:function(){return R},Pq:function(){return T},UB:function(){return J},UO:function(){return Z},Wf:function(){return c},YP:function(){return D},_g:function(){return x},cu:function(){return y},dc:function(){return G},eJ:function(){return P},e_:function(){return W},fX:function(){return l},gL:function(){return u},hE:function(){return Q},i1:function(){return K},k4:function(){return V},ks:function(){return k},n6:function(){return d},o2:function(){return p},o7:function(){return b},pm:function(){return U},qM:function(){return I},rM:function(){return q},sJ:function(){return M},t$:function(){return v},tJ:function(){return C},tR:function(){return ee},tq:function(){return w},vv:function(){return L},w5:function(){return X},wS:function(){return m},yB:function(){return te},yR:function(){return O},yv:function(){return E},zd:function(){return g}});var r=n(82487),o=n(76384);function i(e){return e.constructor.kind}function a(e){return!!e&&[o.u.Text,o.u.Empty,o.u.LeafContainer,o.u.Image,o.u.FieldContainer].includes(i(e))}function s(e){return!!e&&[o.u.Document,o.u.Body,o.u.Page,o.u.Columns,o.u.RichTextArea,o.u.HeaderFooter,o.u.Section,o.u.Paragraph,o.u.Table,o.u.TableRow,o.u.TableCell,o.u.Line,o.u.Field,o.u.TextFrame,o.u.SubLine,o.u.Endnote].includes(i(e))}function c(e){return!!e&&[o.u.HeaderFooter,o.u.TextFrame].includes(i(e))}function l(e){return!!e&&(a(e)||s(e))}function u(e){return!!e&&i(e)===o.u.Document}function d(e){return!!e&&i(e)===o.u.Page}function p(e){return!!e&&i(e)===o.u.Body}function h(e){return!!e&&i(e)===o.u.HeaderFooter}function f(e){return h(e)&&e.storyType===r.AHI.headerContent}function g(e){return h(e)&&e.storyType===r.AHI.footerContent}function v(e){return!!e&&i(e)===o.u.Section}function y(e){return!!e&&i(e)===o.u.RichTextArea}function m(e){return!!e&&i(e)===o.u.Paragraph}function b(e){return!!e&&i(e)===o.u.Line}function _(e){return!!e&&i(e)===o.u.SubLine}function C(e){return!!e&&i(e)===o.u.TextFrame}function S(e){return!!e&&i(e)===o.u.Text}function w(e){return!!e&&i(e)===o.u.Field}function E(e){return S(e)&&e.text===r.IfD.FieldBegin}function x(e){return S(e)&&e.text===r.IfD.FieldEnd}function T(e){return E(e)||x(e)}function R(e){return!!e&&[o.u.Image,o.u.FieldContainer,o.u.LeafContainer,o.u.EmbeddedObject].includes(i(e))}function I(e){return!!e&&i(e)===o.u.Image}function P(e){return!!e&&i(e)===o.u.FieldContainer}function O(e){return S(e)&&(0,r.wR4)(e.text.charCodeAt(0))}function k(e){return!!e&&i(e)===o.u.EmbeddedObject}function D(e){return!!e&&i(e)===o.u.Table}function M(e){return!!e&&i(e)===o.u.TableRow}function A(e){return!!e&&i(e)===o.u.TableCell}function L(e){return!!e&&!!e.floatingSpace}function N(e){return!!e&&!!e.constraintSpace}function B(e){return!!e&&[o.u.TextLite,o.u.ContainerLite,o.u.TextFrameLite].includes(e.kind)}function F(e){return!!e&&[o.u.DocumentLite,o.u.SectionLite,o.u.ParagraphLite,o.u.FieldCodeLite,o.u.TableLite,o.u.TableRowLite,o.u.TableCellLite].includes(e.kind)}function U(e){return!!e&&(B(e)||F(e))}function H(e){return!!e&&e.kind===o.u.DocumentLite}function j(e){return!!e&&e.kind===o.u.SectionLite}function G(e){return!!e&&e.kind===o.u.ParagraphLite}function V(e){return!!e&&e.kind===o.u.TextLite}function W(e){return!!e&&e.kind===o.u.ContainerLite}function z(e){var t;return W(e)&&(null===(t=e.property)||void 0===t?void 0:t.drawingType)===r.HgR.Picture&&""!==e.property.drawing.graphic.graphicData.pic.blipFill.blip.embed}function K(e){var t;return W(e)&&(null===(t=e.property)||void 0===t?void 0:t.drawingType)===r.HgR.EmbeddedObject}function q(e){return!!e&&e.kind===o.u.TextFrameLite}function Y(e){return!!e&&e.kind===o.u.FieldCodeLite}function Q(e){return!!e&&e.kind===o.u.TableLite}function Z(e){return!!e&&e.kind===o.u.TableCellLite}function X(e){return!!e&&V(e)&&e.property&&e.property.isPlaceholder&&e.text===r.IfD.LineBreak}function J(e){return s(e)||F(e)}function $(e){return u(e)||H(e)}function ee(e){return a(e)||B(e)}function te(e){return C(e)||q(e)}function ne(e){var t=e;return void 0!==t&&void 0!==t.firstChild&&void 0!==t.lastChild&&void 0!==t.children&&void 0!==t.getChildByPoint}},31518:function(e,t,n){n.d(t,{NG:function(){return st},bq:function(){return lt},nl:function(){return et},wI:function(){return S},Gh:function(){return Ue},Tj:function(){return Q},zc:function(){return $},_y:function(){return s},aj:function(){return Je},$C:function(){return it},hn:function(){return bt},Me:function(){return Ge},vc:function(){return ut},ki:function(){return dt},Ow:function(){return pt},Fm:function(){return ht},ZX:function(){return ct},LA:function(){return nt},ZP:function(){return rt},uE:function(){return _e},C1:function(){return Le},rX:function(){return vt},BQ:function(){return Ze},IS:function(){return ft},wq:function(){return Xe},Pj:function(){return j},kn:function(){return c},h1:function(){return f},j4:function(){return tt},IZ:function(){return q},I:function(){return ye},Fx:function(){return $e},A6:function(){return ze},p2:function(){return We},BB:function(){return Ye},Eo:function(){return gt},I3:function(){return qe},XT:function(){return be},Zw:function(){return he},l:function(){return ot},gt:function(){return ce},c3:function(){return Ie},iO:function(){return ie},a3:function(){return at},Zl:function(){return W},Ks:function(){return z},jb:function(){return K},vn:function(){return pe},di:function(){return ae},vW:function(){return X},iN:function(){return v},h9:function(){return y},Bz:function(){return ke},NC:function(){return le},C8:function(){return r},Yy:function(){return ue},bg:function(){return w},hF:function(){return Ve},at:function(){return Fe},z2:function(){return Qe},xG:function(){return Ke},z$:function(){return re},iW:function(){return V},gg:function(){return mt},Xr:function(){return Ot},Td:function(){return Ct},Gb:function(){return Dt},S3:function(){return wt},ol:function(){return Rt},_j:function(){return Tt},te:function(){return F},Tz:function(){return k},Md:function(){return B},VO:function(){return A},oH:function(){return L},Z1:function(){return N},gA:function(){return D},j_:function(){return M},Ao:function(){return Ne}});var r,o=n(85556),i=n(30479),a=n(46708),s=function(){function e(){this.notificationCenter=new i.NotificationCenter,this.plugins={},this.uuid=i.StringUtil.generateRandomId(),this.factory=new a.yB}return e.prototype.on=function(e,t,n,r){this.notificationCenter.on(e,t,n,r)},e.prototype.fire=function(e,t){void 0===t&&(t=!0),this.notificationCenter.fire(e,t)},e.prototype.removeCallBack=function(e,t){this.notificationCenter.removeCallBack(e,t)},e.prototype.removeListener=function(e,t){this.notificationCenter.removeListener(e,t)},e.prototype.once=function(e,t,n,r){this.notificationCenter.once(e,t,n,r)},e.prototype.registerPlugin=function(e){var t=this;Array.isArray(e)?e.forEach((function(e){t.registerPlugin(e)})):e&&Object.keys(e).forEach((function(n){var r=e[n];t.plugins[n]=t.plugins[n]||[],t.plugins[n].unshift(r)}))},e.prototype.unRegisterPlugin=function(e){var t=this;Array.isArray(e)?e.forEach((function(e){t.unRegisterPlugin(e)})):e&&Object.keys(e).forEach((function(n){var r=e[n];t.plugins[n]=t.plugins[n]||[];var o=t.plugins[n],i=o.indexOf(r);i>=0&&o.splice(i,1)}))},e.prototype.run=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this,i=this.plugins[e]||[],a=0;function s(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var c=i[a];if(a+=1,c)return e.length&&(t=e),c.apply(void 0,(0,o.__spreadArray)([r,s],(0,o.__read)(t),!1))}return s()},e.prototype.reset=function(){this.notificationCenter.reset(),this.plugins={}},e}(),c=new s,l=n(82487),u=n(32922);!function(e){e.InsertText="InsertText",e.DeleteText="DeleteText",e.ModifyParagraphProp="ModifyParagraphProp",e.ModifySectionProp="ModifySectionProp",e.ModifyStoryProp="ModifyStoryProp",e.ModifySubStoryProp="ModifySubStoryProp",e.ModifyRunProp="ModifyRunProp",e.ModifyCommentProp="ModifyCommentProp",e.ModifyDrawingProp="ModifyDrawingProp",e.ModifyPictureProp="ModifyPictureProp",e.ModifyEmbeddedObjectProp="ModifyEmbeddedObjectProp",e.ModifyFieldProp="ModifyFieldProp",e.ModifyFootnoteProp="ModifyFootnoteProp",e.ModifyEndnoteProp="ModifyEndnoteProp",e.ModifyTableProp="ModifyTableProp",e.ModifyTableRowProp="ModifyTableRowProp",e.ModifyTableCellProp="ModifyTableCellProp",e.InsertComment="InsertComment",e.DeleteComment="DeleteComment",e.SettingOperation="SettingOperation",e.InsertQuote="InsertQuote",e.DeleteQuote="DeleteQuote",e.ModifyMathProp="ModifyMathProp",e.ModifyMathObjectProp="ModifyMathObjectProp",e.ModifyMathRunProp="ModifyMathRunProp",e.ModifySdtProp="ModifySdtProp",e.InsertRange="InsertRange",e.DeleteRange="DeleteRange"}(r||(r={}));var d,p,h=function(){function e(){this._param={},this._exDirtyRange=null,this.mutationArray=[],this.inverseArray=[]}return e.prototype.forEachMutation=function(e){var t=this;this.mutations.forEach((function(n){if(!t.verifyType(n))throw new Error("mutation type doesn't match operation");e(n)}))},Object.defineProperty(e.prototype,"dirtyRange",{get:function(){return this._dirtyRange?this._dirtyRange.clone():null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exDirtyRange",{get:function(){return this._exDirtyRange||[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mutations",{get:function(){return this.mutationArray},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inverses",{get:function(){return this.inverseArray},enumerable:!1,configurable:!0}),e.prototype.setMutation=function(e,t){void 0===t&&(t=!0),this.parseMutation(e),t&&this.addMutation(e)},e.prototype.addMutation=function(e){this.mutationArray.push(e)},e.prototype.setParam=function(e){this._param=e},e.prototype.isValid=function(){return!0},e.prototype.clone=function(){var e=this,t=new(0,Object.getPrototypeOf(this).constructor);this.mutationArray.forEach((function(e){t.setMutation(e)}));var n=Object.keys(this.param).reduce((function(t,n){var r,i=e.param[n];return(0,o.__assign)((0,o.__assign)({},t),((r={})[n]=i instanceof l.YGK?i.clone():(0,u.Z)(i),r))}),{});return t.setParam(n),t},e.prototype.clearMutations=function(){this.mutationArray=[],this.inverseArray=[]},e}(),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"param",{get:function(){return this._param},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"range",{get:function(){return this.param.range.clone()},enumerable:!1,configurable:!0}),t.prototype.doInverseIfNeed=function(e,t){var n,r=this;if(t.undoOption.needInverse){var i=[];this.forEachMutation((function(n){i.push.apply(i,(0,o.__spreadArray)([],(0,o.__read)(r.doInverse(e,n,t.mutOption.baseLen)),!1))})),(n=this.inverseArray).push.apply(n,(0,o.__spreadArray)([],(0,o.__read)(i),!1))}},t.prototype.apply=function(e,t){var n=t.isInputDoc,r=e.getDataStream();n||this.startApply(e,t),this.doApply(r,t),n||this.updateDirtyRange(r)},t.prototype.startApply=function(e,t){if(!t.fromServer){var n=e.getDataStream();t.mutOption.baseLen=n.getTextStream().getLength(),t.undoOption.fromUndoRedo||this.createMutation(n,(0,o.__assign)({},t.mutOption)),this.doInverseIfNeed(e,t)}},t.prototype.doApply=function(e,t){var n=this;this.forEachMutation((function(r){if(!t.isInputDoc){var o=e.getTextStream().getLength();if(o!==r.options.baseLen)throw new Error("base len not match! stream length: ".concat(o,", mutation: ").concat(JSON.stringify(r),", Command: ").concat(t.commandType,"!"));if(!n.verifyData(e,r))throw new Error("mutation data error! mutation: ".concat(JSON.stringify(r),", Command: ").concat(t.commandType,"!"))}n.applyMutation(e,r,t)}))},t.prototype.verifyChar=function(e,t){return!!e.includes(t)||(i.Logger.error("char do not match! origin: ".concat(JSON.stringify(e),", target: ").concat(t,"!")),!1)},t}(h),g=n(64282),v=function(){function e(e,t){this.type=e.type,this.mutation=e,this.options=t}return e.prototype.serialize=function(){return(0,o.__assign)((0,o.__assign)({},this.mutation.serialize()),{bl:this.options.baseLen})},e.prototype.toJSON=function(){return this.serialize()},e.prototype.getMutation=function(){return this.mutation},Object.defineProperty(e.prototype,"content",{get:function(){var t=this;if(this.type===g.x1.mlti&&this.mutation.content)return this.mutation.content.map((function(n){return new e(n,(0,o.__assign)({},t.options))}))},enumerable:!1,configurable:!0}),e.prototype.transform=function(t,n){if(void 0===this.options.baseLen||void 0===t.options.baseLen||this.options.baseLen!==t.options.baseLen)throw Error("baseLen unequal! ".concat(this.options.baseLen," !== ").concat(t.options.baseLen));var r=this.mutation.transform(t.mutation,n),i=this.options.baseLen+this.getChangeLen(t);return new e(r,(0,o.__assign)((0,o.__assign)({},this.options),{baseLen:i}))},e.prototype.compose=function(t){if(void 0===this.options.baseLen||void 0===t.options.baseLen||this.options.baseLen+this.getChangeLen(this)!==t.options.baseLen)throw Error("baseLen not match! ".concat(this.options.baseLen," & ").concat(t.options.baseLen));var n=this.mutation.compose(t.mutation);return n?new e(n,(0,o.__assign)({},this.options)):null},e.prototype.transformGcpRange=function(e,t){return this.mutation.transformGcpRange(e,t)},e.prototype.getChangeLen=function(e){var t=0;switch(e.type){case g.x1.insert:t=e.getMutation().text.length;break;case g.x1.delete:var n=e.getMutation();t=n.beginIndex-n.endIndex}return t},e.prototype.getAfterLen=function(){if(this.options.baseLen)return this.options.baseLen+this.getChangeLen(this)},e}(),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.deserialize=function(t){var n=e.deserialize.call(this,t);return new v(n,{baseLen:t.bl})},t}(g.Fe),m=((d={})[l.IfD.TableStart]=[l.uSS.TableProperty],d[l.IfD.TableRowBreak]=[l.uSS.TableRowProperty],d[l.IfD.TableCellBreak]=[l.uSS.TableCellProperty],d[l.IfD.FieldBegin]=[l.uSS.FieldCharProperty],d[l.IfD.ParagraphReturn]=[l.uSS.ParagraphProperty],d[l.IfD.CommentReference]=[l.uSS.CommentReferenceProperty],d[l.IfD.DrawingAnchor]=[l.uSS.DrawingProperty],d[l.IfD.SubStoryBegin]=[l.uSS.HeaderStoryProperty,l.uSS.FooterStoryProperty,l.uSS.FooterStoryProperty,l.uSS.EndnoteStoryProperty,l.uSS.CommentStoryProperty,l.uSS.TextboxStoryProperty],d);function b(e,t){var n=t.getTableStream().createTableIterator({limitRange:e,isRawIter:!0});return m[l.IfD.TableStart].includes(n.getPropertyType())}function _(e,t){var n=t.getFieldStream().createFieldIterator({limitRange:e,isRawIter:!0});return m[l.IfD.FieldBegin].includes(n.getPropertyType())}function C(e,t){var n=t.getStoryStream().createSubStoryIterator({limitRange:e,isRawIter:!0});return m[l.IfD.SubStoryBegin].includes(n.getPropertyType())}var S,w,E=((p={})[l.IfD.TableStart]=b,p[l.IfD.TableEnd]=b,p[l.IfD.TableRowBreak]=function(e,t){var n=t.getTableStream().createRowIterator({limitRange:e,isRawIter:!0});return m[l.IfD.TableRowBreak].includes(n.getPropertyType())},p[l.IfD.TableCellBreak]=function(e,t){var n=t.getTableStream().createCellIterator({limitRange:e,isRawIter:!0});return m[l.IfD.TableCellBreak].includes(n.getPropertyType())},p[l.IfD.FieldBegin]=_,p[l.IfD.FieldSeparate]=_,p[l.IfD.FieldEnd]=_,p[l.IfD.SubStoryBegin]=C,p[l.IfD.SubStoryEnd]=C,p[l.IfD.ParagraphReturn]=function(e,t){var n=t.getTextStream().createParagraphIterator(e,!0);return m[l.IfD.ParagraphReturn].includes(n.getPropertyType())},p[l.IfD.CommentReference]=function(e,t){var n=t.getAnnotationStream().createCommentIterator(e,!0);return m[l.IfD.CommentReference].includes(n.getPropertyType())},p[l.IfD.DrawingAnchor]=function(e,t){var n=t.getDrawingStream().createDrawingIterator(e,!0);return m[l.IfD.DrawingAnchor].includes(n.getPropertyType())},p),x="STORY_ORDER_NOT_MATCH",T="STORY_BREAK_CHAR_ERROR",R="MAIN_STORY_LAST_SECTION_RELATIVE_CHAR",I="SUB_STORY_BEGIN_NOT_MATCH_END",P="LACK_OF_STORY_BREAK_CHAR";!function(e){e.Empty="Empty",e.DocKeyframe="DocKeyframe",e.DocUndo="DocUndo",e.DocRedo="DocRedo",e.DocCopy="DocCopy",e.DocPaste="DocPaste",e.DocCut="DocCut",e.DocPasteKeepSource="DocPasteKeepSource",e.DocPasteKeepTarget="DocPasteKeepTarget",e.DocPasteKeepTextOnly="DocPasteKeepTextOnly",e.DocMoveContent="DocMoveContent",e.DocInsertText="DocInsertText",e.DocDeleteText="DocDeleteText",e.DocModifyText="DocModifyText",e.DocClearTextStyle="DocClearTextStyle",e.DocReplaceText="DocReplaceText",e.DocReplaceAllText="DocReplaceAllText",e.DocModifyCharacterStyle="DocModifyCharacterStyle",e.DocInsertImage="DocInsertImage",e.DocModifyImage="DocModifyImage",e.DocInsertChart="DocInsertChart",e.DocDeleteChart="DocDeleteChart",e.DocModifyChart="DocModifyChart",e.DocInsertDiagram="DocInsertDiagram",e.DocDeleteDiagram="DocDeleteDiagram",e.DocModifyDiagram="DocModifyDiagram",e.DocInsertShape="DocInsertShape",e.DocDeleteShape="DocDeleteShape",e.DocModifyShape="DocModifyShape",e.DocInsertTextframe="DocInsertTextframe",e.DocDeleteTextframe="DocDeleteTextframe",e.DocModifyTextframe="DocModifyTextframe",e.DocInsertGroupShape="DocInsertGroupShape",e.DocDeleteGroupShape="DocDeleteGroupShape",e.DocModifyGroupShape="DocModifyGroupShape",e.DocInsertField="DocInsertField",e.DocUpdateField="DocUpdateField",e.DocModifyField="DocModifyField",e.DocInsertCodeBlock="DocInsertCodeBlock",e.DocDeleteCodeBlock="DocDeleteCodeBlock",e.DocModifyCodeBlock="DocModifyCodeBlock",e.DocInsertParagraph="DocInsertParagraph",e.DocModifyParagraph="DocModifyParagraph",e.DocModifyParagraphNumbering="DocModifyParagraphNumbering",e.DocModifyParagraphStyle="DocModifyParagraphStyle",e.DocModifyNumberingStyle="DocModifyNumberingStyle",e.DocInsertLine="DocInsertLine",e.DocInsertColumn="DocInsertColumn",e.DocInsertTable="DocInsertTable",e.DocDeleteTable="DocDeleteTable",e.DocModifyTable="DocModifyTable",e.DocModifyTableStyle="DocModifyTableStyle",e.DocInsertTableRow="DocInsertTableRow",e.DocDeleteTableRow="DocDeleteTableRow",e.DocModifyTableRow="DocModifyTableRow",e.DocInsertTableColumn="DocInsertTableColumn",e.DocDeleteTableColumn="DocDeleteTableColumn",e.DocModifyTableColumn="DocModifyTableColumn",e.DocModifyTableCell="DocModifyTableCell",e.DocMergeCells="DocMergeCells",e.DocSplitCells="DocSplitCells",e.DocModifyTableColumnWidth="DocModifyTableColumnWidth",e.DocModifyTableRowHeight="DocModifyTableRowHeight",e.DocMoveTableRow="DocMoveTableRow",e.DocMoveTableColumn="DocMoveTableColumn",e.DocAverageTableColumnWidth="DocAverageTableColumnWidth",e.DocScaleTable="DocScaleTable",e.DocInsertSection="DocInsertSection",e.DocModifySection="DocModifySection",e.DocInsertPage="DocInsertPage",e.DocInsertTextbox="DocInsertTextbox",e.DocDeleteTextbox="DocDeleteTextbox",e.DocInsertComment="DocInsertComment",e.DocDeleteComment="DocDeleteComment",e.DocModifyComment="DocModifyComment",e.DocInsertQuote="DocInsertQuote",e.DocDeleteQuote="DocDeleteQuote",e.DocInsertEndnote="DocInsertEndnote",e.DocDeleteEndnote="DocDeleteEndnote",e.DocInsertFootnote="DocInsertFootnote",e.DocDeleteFootnote="DocDeleteFootnote",e.DocInsertHeader="DocInsertHeader",e.DocDeleteHeader="DocDeleteHeader",e.DocInsertFooter="DocInsertFooter",e.DocDeleteFooter="DocDeleteFooter",e.DocInsertWatermark="DocInsertWatermark",e.DocInsertBookmark="DocInsertBookmark",e.DocDeleteBookmark="DocDeleteBookmark",e.DocInsertPermission="DocInsertPermission",e.DocDeletePermission="DocDeletePermission",e.DocSetStyles="DocSetStyles",e.DocSetBackground="DocSetBackground",e.DocSetNumbering="DocSetNumbering",e.DocSetFonts="DocSetFonts",e.DocSetThemes="DocSetThemes",e.DocSetSettings="DocSetSettings",e.DocSetWebSettings="DocSetWebSettings",e.DocInsertPlugin="DocInsertPlugin",e.DocDeletePlugin="DocDeletePlugin",e.DocModifyPlugin="DocModifyPlugin",e.DocCreateNewDocument="DocCreateNewDocument",e.DocInsertMainStory="DocInsertMainStory",e.DocCompositionStart="DocCompositionStart",e.DocCompositionUpdate="DocCompositionUpdate",e.DocCompositionEnd="DocCompositionEnd",e.DocInsertContentStart="DocInsertContentStart",e.DocInsertContentProgress="DocInsertContentProgress",e.DocInsertContentFinish="DocInsertContentFinish",e.DocInsertContentCancel="DocInsertContentCancel"}(S||(S={})),function(e){e.TABLE="table",e.FIELD="field",e.DRAWING="drawing",e.COMMENT="comment",e.STORY="story",e.RUN="run",e.PARAGRAPH="paragraph"}(w||(w={}));var O=!1;function k(e){var t=e.module,n=e.commandType,r=e.detail,o=e.isBreak,s=void 0!==o&&o;if(![S.DocCompositionUpdate,S.DocCompositionStart,S.DocCompositionEnd].includes(n)&&(i.Logger.error("[data error] module:".concat(t," break:").concat(s," commandType:").concat(n," info:").concat(r)),!O)){var c=s?a.GI.DATA_CHECK_FAILED:a.GI.DATA_CHECK_WARN,l="".concat(c,"(").concat(t,")");a.kQ.captureException(l,{extra:{isBreak:s,commandType:n,detail:r}});var u=s?1:0;window.log&&window.log.report("doc-dirty-data-".concat(t,"-").concat(u)),a.kQ.tdwReport({opername:"doc_word_data",module:t,action:"check",ver5:u,ver6:n,ver7:r}),O=!0}}function D(e,t){k({module:w.TABLE,commandType:e,detail:t,isBreak:!0})}function M(e,t){k({module:w.TABLE,commandType:e,detail:t})}function A(e,t){k({module:w.FIELD,commandType:e,detail:t})}function L(e,t){k({module:w.RUN,commandType:e,detail:t})}function N(e,t){k({module:w.STORY,commandType:e,detail:t})}function B(e,t){k({module:w.DRAWING,commandType:e,detail:t})}function F(e,t){k({module:w.COMMENT,commandType:e,detail:t})}var U,H,j,G,V=function(){function e(){}return e.validateRange=function(e,t,n){var r=e.getTextStream().getLength();return t<=n&&t>=0&&t<=r&&t>=0&&n<=r||(i.Logger.error("validateRange out of bounds! range: [".concat(t,", ").concat(n,"), baseLen: ").concat(r)),!1)},e.validateDeleteRange=function(e,t,n){if(!this.validateRange(e,t,n))return!1;var r=e.getStoryStream().getStoryInfoFromGcp(t);if(!r)return!1;var o=new l.ICE(t,n-t);if(r.storyProp.storyType===l.AHI.mainDocument){var a=new l.ICE(r.contentRange.begin(),r.contentRange.length()-1);return!!a.contains(o)||(i.Logger.error("validateDeleteRange main story range valid error! incoming range[".concat(o.begin(),", ").concat(o.end(),")! main story range[").concat(a.begin(),", ").concat(a.end(),")!")),!1)}return!!r.contentRange.contains(o)||(i.Logger.error("validateDeleteRange sub story range valid error! incoming range[".concat(o.begin(),", ").concat(o.end(),"]! sub story range[").concat(r.contentRange.begin(),", ").concat(r.contentRange.end(),"]!")),!1)},e.validateProperty=function(e,t){return!(!t||!Object.keys(l.LK6).includes(e)||!t[e])},e.validatePlaceholderFeatureProperty=function(e){var t=e.gcpRange,n=e.dataStream,r=e.placeholderChar,o=E[r];return!o||o(t,n)},e.validateStoryPlaceholderChar=function(e){var t,n,r={result:!0,detail:""};if(e.context.uuid!==(null===(n=null===(t=window.pad)||void 0===t?void 0:t.editor)||void 0===n?void 0:n.uuid))return r;for(var o=[l.AHI.mainDocument,l.AHI.headerContent,l.AHI.footerContent,l.AHI.footnoteContent,l.AHI.endnoteContent,l.AHI.commentContent,l.AHI.textboxContent],i=e.getStoryStream().createStoryIterator();i.hasNext();){var a=i.getProperty();if((null==a?void 0:a.storyType)!==o.shift()){r.result=!1,r.detail=x;break}if(e.getTextStream().readText(i.getRange().end()-1,1)!==l.IfD.StoryBreak){r.result=!1,r.detail=T;break}var s=i.getContentRange();if((null==a?void 0:a.storyType)===l.AHI.mainDocument){var c=e.getTextStream().readText(s.end()-2,2);if(c[0]!==l.IfD.ParagraphReturn||c[1]!==l.IfD.SectionBreak){r.result=!1,r.detail=R;break}}else{var u=this.validateSubStoryPlaceholderChar(e,s);if(u)return u}i.next()}return r.result&&0!==o.length&&(r.result=!1,r.detail=P),r},e.validateSubStoryPlaceholderChar=function(e,t){for(var n=e.getStoryStream().createSubStoryIterator({limitRange:t,isRawIter:!0}),r=[];n.hasNext();){var o=n.getRange().end()-1;if(!t.contains(o))break;switch(e.getTextStream().readText(o,1)){case l.IfD.SubStoryBegin:r.push(l.IfD.SubStoryBegin);break;case l.IfD.SubStoryEnd:if(r.pop()!==l.IfD.SubStoryBegin)return i.Logger.error("[SubStory]  gcp:".concat(n.getRange().begin())),{result:!1,detail:I}}n.next()}if(r.length)return{result:!1,detail:I}},e}(),W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"param",{get:function(){return this._param},enumerable:!1,configurable:!0}),t.prototype.setMutation=function(t,n){void 0===n&&(n=!0),e.prototype.setMutation.call(this,t,n),n||(this.param.mode=l.XS7.Insert)},t.prototype.parseMutation=function(e){if(e.type===g.x1.modify){var t=e.getMutation(),n=t.beginIndex,r=t.endIndex;this.param.range=new l.ICE(n,r-n),this.param.mode=l.vCY.propUpdateMode(t.modifyMode),this.param.property=l.vCY.deserialize(t.property)}},t.prototype.verifyType=function(e){return e.type===g.x1.modify},t.prototype.verifyData=function(e,t){var n=t.getMutation();return n.beginIndex<n.endIndex&&V.validateRange(e,n.beginIndex,n.endIndex)&&V.validateProperty(n.modifyType,n.property)},t.prototype.getMutationChar=function(e,t){var n=t.getMutation();return e.getTextStream().readText(n.beginIndex,n.endIndex-n.beginIndex)},Object.defineProperty(t.prototype,"afterRange",{get:function(){return this.param.mode===l.XS7.Insert?new l.ICE(this.range.begin()+this.range.len,0):this.range},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"changeLen",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.isValid=function(){return e.prototype.isValid.call(this)},t.prototype.updateDirtyRange=function(e){this._dirtyRange=this.range},t.prototype.createModifyMutation=function(e,t,n,r){var i,a=new g.OJ({beginIndex:n.begin(),endIndex:n.end(),modifyMode:l.vCY.mutationModifyMode(this.param.mode),modifyType:e,property:(i={},i[e]=t,i)}),s=new v(a,(0,o.__assign)({},r));this.mutationArray.push(s)},t.prototype.doInverse=function(e,t,n){if(this.param.mode===l.XS7.Insert)return[];var r=t.getMutation(),o=new g.OJ({beginIndex:r.beginIndex,endIndex:r.endIndex,modifyMode:l.GsI.merge,modifyType:r.modifyType,property:r.property}),i=new v(o,{baseLen:n});return t.options.undo=i,[i]},t.prototype.updateProperty=function(e,t){var n,r,o,i=e.getMutation(),a=i.modifyType;i.property=((n={})[a]=t.modifiedProp,n);var s=null===(o=e.options.undo)||void 0===o?void 0:o.getMutation();s&&(s.property=((r={})[a]=t.inverseProp,r)),delete e.options.undo},t.prototype.mutationProperty=function(e,t){var n=this.param.property||l.vCY.deserialize(e.property);return t?n:n.clone()},t}(f),z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.applyMutation=function(e,t,n){var r=t.getMutation(),o=e.setParagraphProp(r.beginIndex,r.endIndex-r.beginIndex,this.param.mode,this.mutationProperty(r,n.isInputDoc),!n.fromServer,n.isInputDoc);this.param.mode!==l.XS7.Insert&&o&&this.updateProperty(t,o)},t.prototype.verifyType=function(t){if(!e.prototype.verifyType.call(this,t))return!1;var n=t.getMutation();return n.modifyType===l.LK6.paragraph||n.modifyType===l.LK6.tableCell},t.prototype.verifyData=function(t,n){if(!e.prototype.verifyData.call(this,t,n))return!1;var r=this.getMutationChar(t,n),i=[l.IfD.TableCellBreak,l.IfD.TableRowBreak,l.IfD.TableStart,l.IfD.TableEnd],a=(0,o.__spreadArray)([l.IfD.ParagraphReturn,l.IfD.ParagraphBreak,l.IfD.SectionBreak,l.IfD.SubStoryBegin,l.IfD.SubStoryEnd,l.IfD.StoryBreak],(0,o.__read)(i),!1);return this.verifyChar(a,r)||this.verifyChar(i,r)},Object.defineProperty(t.prototype,"operationType",{get:function(){return r.ModifyParagraphProp},enumerable:!1,configurable:!0}),t.prototype.updateDirtyRange=function(e){var t=e.getTextStream().createParagraphIterator();t.seek(this.param.range.begin());var n=t.getRange();if(n.end()<this.param.range.end()){t.seek(this.param.range.end()-1);var r=t.getRange().end();n.len=r-n.begin()}this._dirtyRange=n},t.prototype.createMutation=function(e,t){if(this.param.mode===l.XS7.Insert)this.createModifyMutation(l.LK6.paragraph,this.param.property,this.param.range,t);else{var n=e.getTextStream().createParagraphIterator(this.param.range);do{if(n.getCloneProperty()){var r=n.getRange(),o=new l.ICE(r.end()-1,1);this.createModifyMutation(l.LK6.paragraph,this.param.property,o,t)}}while(n.next())}},t}(W),K=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.applyMutation=function(e,t,n){var r=t.getMutation(),o=e.setRunProp(r.beginIndex,r.endIndex-r.beginIndex,this.param.mode,this.mutationProperty(r,n.isInputDoc),!n.fromServer,n.isInputDoc);o&&this.updateProperty(t,o)},t.prototype.updateProperty=function(t,n){var r,i;if(e.prototype.updateProperty.call(this,t,n),this.param.mode!==l.XS7.Insert){var a=t.getMutation(),s=[];null===(i=n.inverseProps)||void 0===i||i.forEach((function(e){var n,r=new g.OJ({beginIndex:e.range.gcpBegin,endIndex:e.range.gcpBegin+e.range.len,modifyMode:a.modifyMode,modifyType:a.modifyType,property:(n={},n[a.modifyType]=e.prop,n)}),o=new v(r,{baseLen:t.options.baseLen});s.push(o)})),(r=this.inverseArray).push.apply(r,(0,o.__spreadArray)([],(0,o.__read)(s),!1))}},t.prototype.doInverse=function(){return[]},t.prototype.verifyType=function(t){return!!e.prototype.verifyType.call(this,t)&&t.getMutation().modifyType===l.LK6.run},Object.defineProperty(t.prototype,"operationType",{get:function(){return r.ModifyRunProp},enumerable:!1,configurable:!0}),t.prototype.createMutation=function(e,t){this.createModifyMutation(l.LK6.run,this.param.property,this.param.range,t)},t}(W),q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"param",{get:function(){return this._param},enumerable:!1,configurable:!0}),t.prototype.parseMutation=function(e){if(e.type===g.x1.insert){var t=e.getMutation();this.param.range=new l.ICE(t.beginIndex,0),this.param.text=t.text}},t.prototype.doInverse=function(e,t,n){var r=t.getMutation(),o=new g.jn({beginIndex:r.beginIndex,endIndex:r.beginIndex+r.text.length}),i=n+this.changeLen;return[new v(o,{baseLen:i})]},t.prototype.applyMutation=function(e,t,n){var r=t.getMutation();e.insertText(r.beginIndex,r.text.length,r.text,n.optAuthor)},t.prototype.verifyType=function(e){return e.type===g.x1.insert},t.prototype.verifyData=function(e,t){var n=t.getMutation();return V.validateRange(e,n.beginIndex,n.beginIndex)},t.prototype.updateDirtyRange=function(e){this._dirtyRange=new l.ICE(this.param.range.gcpBegin,this.param.text.length)},Object.defineProperty(t.prototype,"changeLen",{get:function(){return this.param.text.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"afterRange",{get:function(){return new l.ICE(this.param.range.gcpBegin+this.param.text.length,0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"operationType",{get:function(){return r.InsertText},enumerable:!1,configurable:!0}),t.prototype.isValid=function(){return e.prototype.isValid.call(this)&&this.param.text.length>0},t.prototype.createMutation=function(e,t){var n=new g.Qr({beginIndex:this.param.range.begin(),text:this.param.text}),r=new v(n,(0,o.__assign)({},t));this.mutationArray.push(r)},t}(f),Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"param",{get:function(){return this._param},enumerable:!1,configurable:!0}),t.prototype.parseMutation=function(e){if(e.type===g.x1.setting){var t=e.getMutation();this.param.property=l.vCY.deserialize(t.property),this.param.settingType=t.settingType}},t.prototype.verifyType=function(e){return e.type===g.x1.setting},t.prototype.apply=function(e,t){var n=t.isInputDoc,r=e.getDataManager();this.baseLen=e.getDataStream().getTextStream().getLength(),n||this.createMutation(r,t),this.doApply(r,t),n||this.updateDirtyRange(e)},t.prototype.doApply=function(e,t){var n=this;this.forEachMutation((function(r){if(!t.isInputDoc){if(n.baseLen!==r.options.baseLen)throw new Error("base len not match! stream length: ".concat(n.baseLen,", mutation: ").concat(JSON.stringify(r)));if(!n.verifyData(e,r))throw new Error("mutation data error! mutation: ".concat(JSON.stringify(r)))}n.applyMutation(e,r,t)}))},t.prototype.createMutation=function(e,t){var n,r;if(!t.fromServer&&!t.undoOption.fromUndoRedo){var i=new g.Lq({settingType:this.param.settingType,property:(n={},n[this.param.settingType]=this.param.property,n)}),a=new v(i,(0,o.__assign)((0,o.__assign)({},t.mutOption),{baseLen:this.baseLen}));this.mutationArray.push(a);var s=new g.Lq({settingType:this.param.settingType,property:(r={},r[this.param.settingType]=this.param.property,r)}),c=new v(s,(0,o.__assign)((0,o.__assign)({},t.mutOption),{baseLen:this.baseLen}));this.inverseArray.push(c),a.options.undo=c}},Object.defineProperty(t.prototype,"operationType",{get:function(){return r.SettingOperation},enumerable:!1,configurable:!0}),t.prototype.verifyData=function(e,t){var n=t.getMutation();return V.validateProperty(n.settingType,n.property)},Object.defineProperty(t.prototype,"changeLen",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.updateDirtyRange=function(e){var t,n;this.param.settingType===l.LK6.settings&&(this._dirtyRange=null!==(n=null===(t=e.getDataStream().getStoryStream().getMainStoryInfo())||void 0===t?void 0:t.contentRange)&&void 0!==n?n:l.ICE.emptyRange())},Object.defineProperty(t.prototype,"afterRange",{get:function(){return l.ICE.invalidRange()},enumerable:!1,configurable:!0}),t}(h),Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.applyMutation=function(e,t,n){var r=t.getMutation(),o=this.mutationProperty(r,n.isInputDoc);if(o){var i=null;switch(this.param.settingType){case l.LK6.settings:i=e.setDocumentSettings(o);break;case l.LK6.webSettings:i=e.setWebSettings(o);break;case l.LK6.background:i=e.setDocBackgroundProperty(o);break;case l.LK6.styles:i=e.setStyleSheet(o);break;case l.LK6.numbering:i=e.setNumberingProperty(o);break;case l.LK6.fonts:i=e.setFontTable(o);break;case l.LK6.themes:i=e.setThemesProperty(o)}i&&!n.fromServer&&this.updateProperty(t,i)}},t.prototype.updateProperty=function(e,t){var n,r,o,i=e.getMutation(),a=i.settingType;i.property=((n={})[a]=t.modifiedProp,n);var s=null===(o=e.options.undo)||void 0===o?void 0:o.getMutation();s&&(s.property=((r={})[a]=t.inverseProp,r)),delete e.options.undo},t.prototype.mutationProperty=function(e,t){var n=this.param.property||l.vCY.deserialize(e.property);return t?n:n.clone()},t}(Y),Z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"changeLen",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"afterRange",{get:function(){return this.param.mode===l.XS7.Insert?new l.ICE(this.range.begin()+this.range.len,0):this.range},enumerable:!1,configurable:!0}),t.prototype.updateDirtyRange=function(e){this._dirtyRange=this.range},t}(W),X=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.applyMutation=function(e,t,n){var r=t.getMutation(),o=e.setTableProp(r.beginIndex,r.endIndex-r.beginIndex,this.param.mode,this.mutationProperty(r,n.isInputDoc),!n.fromServer);this.param.mode!==l.XS7.Insert&&o&&this.updateProperty(t,o)},t.prototype.verifyType=function(t){return!!e.prototype.verifyType.call(this,t)&&t.getMutation().modifyType===l.LK6.table},t.prototype.verifyData=function(t,n){if(!e.prototype.verifyData.call(this,t,n))return!1;var r=this.getMutationChar(t,n);return this.verifyChar([l.IfD.TableStart,l.IfD.TableEnd],r)},Object.defineProperty(t.prototype,"operationType",{get:function(){return r.ModifyTableProp},enumerable:!1,configurable:!0}),t.prototype.createMutation=function(e,t){if(this.param.mode===l.XS7.Insert)this.createModifyMutation(l.LK6.table,this.param.property,this.param.range,t);else{var n=this.param.property.nestingLevel,r=e.getTableStream().createTableIterator({nestingLevel:n,limitRange:this.param.range});do{if(r.getCloneProperty()){var o=r.getRange(!0),i=new l.ICE(o.end()-1,1);this.createModifyMutation(l.LK6.table,this.param.property,i,t)}}while(r.next())}},t.prototype.updateDirtyRange=function(e){var t;this._dirtyRange=(null===(t=e.getTableStream().getTableInfo(this.range.begin()))||void 0===t?void 0:t.range)||this.range},t}(Z),J=16777215;!function(e){e[e.Text=0]="Text",e[e.Table=1]="Table",e[e.Mix=2]="Mix"}(H||(H={})),function(e){e[e.None=0]="None",e[e.Table=1]="Table",e[e.TitleStyle=2]="TitleStyle"}(j||(j={})),function(e){e.HEADER_REF_ID="headerRefId",e.FOOTER_REF_ID="footerRefId",e.PAGE_WIDTH="pageWidth",e.PAGE_HEIGHT="pageHeight",e.MARGIN_TOP="marginTop",e.MARGIN_BOTTOM="marginBottom",e.MARGIN_LEFT="marginLeft",e.MARGIN_RIGHT="marginRight",e.PAGE_NUM_FMT="pageNumFmt",e.PAGE_NUM_START="pageNumStart"}(G||(G={}));var $,ee=((U={})[r.InsertText]=function(e,t){var n=e;return t>=n.range.gcpBegin?t+n.text.length:t},U[r.DeleteText]=function(e,t){var n=e;return t>n.range.gcpBegin?t>n.range.end()?t-n.range.length():n.range.gcpBegin:t},U[r.InsertRange]=function(e,t){return t},U[r.DeleteRange]=function(e,t){return t},U);!function(e){e[e.Text=1]="Text",e[e.Img=2]="Img",e[e.Table=4]="Table",e[e.Link=8]="Link",e[e.Code=16]="Code",e[e.Field=32]="Field",e[e.Comment=64]="Comment",e[e.Plugin=128]="Plugin"}($||($={}));var te,ne,re,oe=n(25756),ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.applyMutation=function(e,t,n){var r=t.getMutation(),o=e.setFieldProp(r.beginIndex,r.endIndex-r.beginIndex,this.param.mode,this.mutationProperty(r,n.isInputDoc),!n.fromServer);this.param.mode!==l.XS7.Insert&&o&&this.updateProperty(t,o)},t.prototype.verifyType=function(t){return!!e.prototype.verifyType.call(this,t)&&t.getMutation().modifyType===l.LK6.field},t.prototype.verifyData=function(t,n){if(!e.prototype.verifyData.call(this,t,n))return!1;var r=this.getMutationChar(t,n);return this.verifyChar([l.IfD.FieldBegin,l.IfD.FieldSeparate,l.IfD.FieldEnd],r)},Object.defineProperty(t.prototype,"operationType",{get:function(){return r.ModifyFieldProp},enumerable:!1,configurable:!0}),t.prototype.createMutation=function(e,t){this.createModifyMutation(l.LK6.field,this.param.property,this.param.range,t)},t}(W),ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.applyMutation=function(e,t,n){var r=t.getMutation(),o=e.setSubStoryProp(r.beginIndex,r.endIndex-r.beginIndex,this.param.mode,this.mutationProperty(r,n.isInputDoc),!n.fromServer);this.param.mode!==l.XS7.Insert&&o&&this.updateProperty(t,o)},t.prototype.verifyType=function(t){if(!e.prototype.verifyType.call(this,t))return!1;var n=t.getMutation();return[l.LK6.headerContent,l.LK6.footerContent,l.LK6.footnoteContent,l.LK6.endnoteContent,l.LK6.commentContent,l.LK6.textboxContent].includes(n.modifyType)},t.prototype.verifyData=function(t,n){if(!e.prototype.verifyData.call(this,t,n))return!1;var r=this.getMutationChar(t,n);return r===l.IfD.SubStoryBegin||r===l.IfD.SubStoryEnd},Object.defineProperty(t.prototype,"operationType",{get:function(){return r.ModifySubStoryProp},enumerable:!1,configurable:!0}),t.prototype.getModifyType=function(){var e=this.param.property.propertyType,t=new Map([[l.uSS.HeaderStoryProperty,l.LK6.headerContent],[l.uSS.FooterStoryProperty,l.LK6.footerContent],[l.uSS.FootnoteStoryProperty,l.LK6.footnoteContent],[l.uSS.EndnoteStoryProperty,l.LK6.endnoteContent],[l.uSS.CommentStoryProperty,l.LK6.commentContent],[l.uSS.TextboxStoryProperty,l.LK6.textboxContent]]);if(!t.get(e))throw Error("Unable to find the modified definition for the property type ".concat(e,"!"));return t.get(e)},t.prototype.createMutation=function(e,t){this.createModifyMutation(this.getModifyType(),this.param.property,this.param.range,t)},t}(W),se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.doInverse=function(){return[]},t.prototype.applyMutation=function(e,t,n){var r=t.getMutation(),o=e.setStoryProp(r.beginIndex,r.endIndex-r.beginIndex,this.param.mode,this.mutationProperty(r,n.isInputDoc),!n.fromServer);o&&(r.property=o)},t.prototype.verifyType=function(t){return!!e.prototype.verifyType.call(this,t)&&t.getMutation().modifyType===l.LK6.story},t.prototype.verifyData=function(t,n){return e.prototype.verifyData.call(this,t,n)&&this.verifyChar([l.IfD.StoryBreak],this.getMutationChar(t,n))},Object.defineProperty(t.prototype,"operationType",{get:function(){return r.ModifyStoryProp},enumerable:!1,configurable:!0}),t.prototype.createMutation=function(e,t){this.createModifyMutation(l.LK6.story,this.param.property,this.param.range,t)},t}(W),ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.applyMutation=function(e,t,n){var r=t.getMutation(),o=e.setDrawingProp(r.beginIndex,r.endIndex-r.beginIndex,this.param.mode,this.mutationProperty(r,n.isInputDoc),!n.fromServer);this.param.mode!==l.XS7.Insert&&o&&this.updateProperty(t,o)},t.prototype.verifyType=function(t){return!!e.prototype.verifyType.call(this,t)&&t.getMutation().modifyType===l.LK6.drawing},t.prototype.verifyData=function(t,n){return e.prototype.verifyData.call(this,t,n)&&this.verifyChar([l.IfD.DrawingAnchor],this.getMutationChar(t,n))},Object.defineProperty(t.prototype,"operationType",{get:function(){return r.ModifyDrawingProp},enumerable:!1,configurable:!0}),t.prototype.createMutation=function(e,t){this.createModifyMutation(l.LK6.drawing,this.param.property,this.param.range,t)},t}(W),le=function(){function e(){}return e.isTableStart=function(t){return e.isTableStartCharOp(t)||t instanceof X&&t.param.property.isBegin},e.isTableEnd=function(e,t,n,r){var o=!1;if(t-1>0){var i=n[t-1];o=i instanceof X&&!i.param.property.isBegin&&(!r||i.param.property.nestingLevel===r)}return e instanceof z&&e.param.property.isPlaceholder&&o},e.isTableStartCharOp=function(e){return e instanceof q&&e.param.text===l.IfD.TableStart},e.isTableEndCharOp=function(e){return e instanceof q&&e.param.text===l.IfD.TableEnd},e.isNumberingOp=function(e){return e.operationType===r.SettingOperation&&e.param.property instanceof l.kkf.getPropertyClass(l.uSS.NumberingProperty)},e.isSubStoryBeginCharOp=function(e){return e instanceof q&&e.param.text===l.IfD.SubStoryBegin},e.isSubStoryBeginOp=function(e){return e instanceof ae&&e.param.property.isBegin},e.isDrawingAnchorOp=function(e){return e instanceof q&&e.param.text===l.IfD.DrawingAnchor},e.isSubStoryEndOp=function(e){return e instanceof ae&&!e.param.property.isBegin},e.isSubStoryEndCharOp=function(e){return e instanceof q&&e.param.text===l.IfD.SubStoryEnd},e.isFieldStart=function(e){return e instanceof q&&e.param.text===l.IfD.FieldBegin},e.isFieldEnd=function(e){return e instanceof ie&&e.param.property.fldCharType===l.P1W.end},e.isInsertParagraph=function(e){return e instanceof q&&e.param.text===l.IfD.ParagraphReturn},e.isField=function(e){return[l.IfD.FieldBegin,l.IfD.FieldSeparate,l.IfD.FieldEnd].includes(e)},e.isFieldChar=function(e){return e instanceof q&&[l.IfD.FieldBegin,l.IfD.FieldSeparate,l.IfD.FieldEnd].includes(e.param.text)},e.isCodeBlock=function(e){return e instanceof ae&&e.param.property instanceof l.kkf.getPropertyClass(l.uSS.TextboxStoryProperty)&&e.param.property.textBoxType===l.Xbc.CodeBlock},e.isLightBlock=function(e){return e instanceof ae&&e.param.property instanceof l.kkf.getPropertyClass(l.uSS.TextboxStoryProperty)&&e.param.property.textBoxType===l.Xbc.LightBlock},e.isTextFrame=function(e){return e instanceof ae&&e.param.property instanceof l.kkf.getPropertyClass(l.uSS.TextboxStoryProperty)&&e.param.property.textBoxType===l.Xbc.TextFrame},e.isComment=function(e){return e instanceof ae&&e.param.property instanceof l.kkf.getPropertyClass(l.uSS.CommentStoryProperty)},e.isImage=function(e){return e instanceof ce&&e.param.property.drawingType===l.HgR.Picture},e}(),ue=function(){function e(){}return e.moveOffset=function(e,t){if(e.param.range){var n=e.param.range.clone();return n.gcpBegin+=t,e.param.range=n,e}return i.Logger.info("opertaion ".concat(e.operationType," do not has range!!!!")),null},e.moveOps=function(t,n){var r,i;if(0===t.length)return[];var a=n-e.getContentBeginPos(t),s=[];try{for(var c=(0,o.__values)(t),l=c.next();!l.done;l=c.next()){var u=l.value,d=e.moveOffset(u,a);d?s.push(d):s.push(u)}}catch(e){r={error:e}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}return s},e.getFixPos=function(e,t){var n=t;return e.forEach((function(e){var t=e.operationType;ee[t]&&(n=ee[t].apply(void 0,[e.param,n]))})),n},e.getFixedGcpRange=function(e,t){var n=this.getFixPos(e,t.begin()),r=this.getFixPos(e,t.end());return t.gcpBegin=n,t.len=r-n,t},e.getOffset=function(e){var t=e.operationType,n=0;return ee[t]&&(n=ee[t].apply(void 0,[e.param,J])-J),n},e.getModifyFooterAndHeaderId=function(e){var t=[];return(e.defaultHeaderRefId||e.firstHeaderRefId||e.evenHeaderRefId)&&t.push(G.HEADER_REF_ID),(e.defaultFooterRefId||e.firstFooterRefId||e.evenFooterRefId)&&t.push(G.FOOTER_REF_ID),t},e.getModifyPageSizeKeys=function(e){var t=[],n=e.pgSz;return n.has(n.tKeys.w)&&t.push(G.PAGE_WIDTH),n.has(n.tKeys.h)&&t.push(G.PAGE_HEIGHT),t},e.getModifyPageMarginKeys=function(e){var t=[],n=e.pgMar;return n.has(n.tKeys.top)&&t.push(G.MARGIN_TOP),n.has(n.tKeys.bottom)&&t.push(G.MARGIN_BOTTOM),n.has(n.tKeys.left)&&t.push(G.MARGIN_LEFT),n.has(n.tKeys.right)&&t.push(G.MARGIN_RIGHT),t},e.getModifyPageNumKeys=function(e){var t=[],n=e.pgNumType;return n.has(n.tKeys.fmt)&&t.push(G.PAGE_NUM_FMT),n.has(n.tKeys.start)&&t.push(G.PAGE_NUM_START),t},e.splitCellRange=function(e,t,n){var r,i,a=e.createSelectionArea(t);if(!a||a.isCrossTable())n(t);else{if(a.isInnerCell())return void n(a.selectedRange);try{for(var s=(0,o.__values)(a.cellRanges),c=s.next();!c.done;c=s.next())c.value.eachCell((function(e,t){n(e.range,{isLastInRow:e.range.end()===t.contentRange.end(),isFirstInRow:e.range.begin()===t.range.begin(),cell:e})}))}catch(e){r={error:e}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}}},e.splitCellRangeWithIntersect=function(t,n,r){e.splitCellRange(t,n,(function(e,t){return r(n.intersectRange(e),t)}))},e.createTable=function(e,t,n){var r=e.currentRange().end(),o=new l.ICE(r,1);if(t===l.IfD.TableRowBreak)return e.insertText(r,t),e.setRunProperty(o,l.kkf.getPropertyClass(l.uSS.RunProperty).createPlaceholderRun(),l.XS7.Insert),e.setTableRowProperty(o,new(l.kkf.getPropertyClass(l.uSS.TableRowProperty)),l.XS7.Insert),void e.setParagraphProperty(o,l.kkf.getPropertyClass(l.uSS.ParagraphProperty).createPlaceholderParagraph(),l.XS7.Insert);var i=n||new(l.kkf.getPropertyClass(l.uSS.TableProperty));i.isBegin=!1,t===l.IfD.TableStart&&(i.isBegin=!0),e.insertText(r,t),e.setRunProperty(o,l.kkf.getPropertyClass(l.uSS.RunProperty).createPlaceholderRun(),l.XS7.Insert),e.setTableProperty(o,i,l.XS7.Insert),e.setParagraphProperty(o,l.kkf.getPropertyClass(l.uSS.ParagraphProperty).createPlaceholderParagraph(),l.XS7.Insert)},e.fixPlaceholderGCP=function(e,t){var n=t.createRunIterator();n.seek(e);var r=n.getRange(!0),o=t.readText(r.begin(),1);return o===l.IfD.TableStart?e+1:o===l.IfD.TableEnd?e-1:e},e.isStartTable=function(t){if(t)for(var n=0;n<t.length;n++){if(t[n].operationType===r.InsertText&&t[n].param.text[0]===l.IfD.TableStart)return!0;if(e.getOffset(t[n])){if(le.isNumberingOp(t[n]))continue;return!1}}return!1},e.transOperationToMutationWrapper=function(e){var t;switch(e.operationType){case r.InsertText:var n=e.param,o=new g.Qr({beginIndex:n.range.begin(),text:n.text});return new v(o,{});case r.DeleteText:return n=e.param,o=new g.jn({beginIndex:n.range.begin(),endIndex:n.range.end()}),new v(o,{});case r.ModifyCommentProp:return this.createModifyMutation(l.LK6.commentRef,e);case r.ModifyFootnoteProp:return this.createModifyMutation(l.LK6.footnoteRef,e);case r.ModifyEndnoteProp:return this.createModifyMutation(l.LK6.endnoteRef,e);case r.ModifyDrawingProp:return this.createModifyMutation(l.LK6.drawing,e);case r.ModifyPictureProp:return this.createModifyMutation(l.LK6.picture,e);case r.ModifyEmbeddedObjectProp:return this.createModifyMutation(l.LK6.embeddedObject,e);case r.ModifyParagraphProp:return this.createModifyMutation(l.LK6.paragraph,e);case r.ModifySectionProp:return this.createModifyMutation(l.LK6.section,e);case r.ModifyRunProp:return this.createModifyMutation(l.LK6.run,e);case r.ModifyFieldProp:return this.createModifyMutation(l.LK6.field,e);case r.ModifyTableProp:return this.createModifyMutation(l.LK6.table,e);case r.ModifyTableRowProp:return this.createModifyMutation(l.LK6.tableRow,e);case r.ModifyTableCellProp:return this.createModifyMutation(l.LK6.tableCell,e);case r.ModifyMathProp:return this.createModifyMutation(l.LK6.math,e);case r.ModifyMathObjectProp:return this.createModifyMutation(l.LK6.mathObject,e);case r.ModifyMathRunProp:return this.createModifyMutation(l.LK6.mathRun,e);case r.ModifySdtProp:return this.createModifyMutation(l.LK6.sdt,e);case r.ModifySubStoryProp:var i=null;return e.param.property instanceof l.kkf.getPropertyClass(l.uSS.CommentStoryProperty)?i=l.LK6.commentContent:e.param.property instanceof l.kkf.getPropertyClass(l.uSS.HeaderStoryProperty)?i=l.LK6.headerContent:e.param.property instanceof l.kkf.getPropertyClass(l.uSS.FooterStoryProperty)?i=l.LK6.footerContent:e.param.property instanceof l.kkf.getPropertyClass(l.uSS.TextboxStoryProperty)?i=l.LK6.textboxContent:e.param.property instanceof l.kkf.getPropertyClass(l.uSS.FootnoteStoryProperty)?i=l.LK6.footnoteContent:e.param.property instanceof l.kkf.getPropertyClass(l.uSS.EndnoteStoryProperty)&&(i=l.LK6.endnoteContent),i?this.createModifyMutation(i,e):null;case r.SettingOperation:return n=e.param,o=new g.Lq({property:(t={},t[n.settingType]=n.property,t),settingType:n.settingType}),new v(o,{});default:return null}},e.createModifyMutation=function(e,t){var n,r=t.param,o=r.property,i=r.range,a=r.mode,s=new oe.O({beginIndex:i.begin(),endIndex:i.end(),modifyMode:l.vCY.mutationModifyMode(a),modifyType:e,property:(n={},n[e]=o,n)});return new v(s,{})},e.filterSpecialOps=function(e,t){if(t&j.Table){var n=!1,r=0;e.opFilter((function(e,t,o){return!r&&e instanceof X&&(r=e.param.property.nestingLevel),le.isTableStart(e)?(n=!0,!1):le.isTableEnd(e,t,o,r)?(n=!1,r=0,!1):!n}))}e.opFilter((function(e,n,r){return e instanceof q&&t&j.TitleStyle&&le.isInsertParagraph(e)&&(r[n+2].param.property.pStyle=""),!0}))},e.getContentBeginPos=function(e){var t,n;try{for(var r=(0,o.__values)(e),i=r.next();!i.done;i=r.next()){var a=i.value;if(a instanceof f)return a.range.begin()}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return 0},e.filterPlugins=function(e,t){var n=this;void 0===t&&(t=function(){return!0});var r=!1,o=!1;return e.opFilter((function(e,i,a){if(le.isFieldStart(e)){var s=n.getNextInsertOperation(a,i);if(null!==s&&l.YU5.getInstance().isContainerField(s.param.text)&&t(s.param.text))return r=!0,o=!0,!1;o=!1}return le.isFieldEnd(e)&&o?(r=!1,!1):!r})),e},e.getContentType=function(e){var t=0,n=!1,r=!1,o=!1;return e.forEachOp((function(e,i,a){var s;if(le.isTableStart(e))n=!0,t|=$.Table;else if(le.isTableEnd(e,i,a))n=!1;else if(le.isSubStoryBeginCharOp(e)){r=!0;var c=a[i+3];le.isCodeBlock(c)?t|=$.Code:le.isComment(c)&&(t|=$.Comment)}else if(le.isSubStoryEndOp(e))r=!1;else if(le.isFieldStart(e)){o=!0;var u=a[i+3];if(u instanceof Q&&(u=a[i+4]),u instanceof q){var d=l.YU5.getInstance(),p=l.BqD.decodeFieldCode(u.param.text);if(!p)return;var h=d.getFieldProcessorByFieldCodeInfo(p);t|=null===(s=null==h?void 0:h.isShowPasteIcon(u.param.text))||void 0===s||s?$.Field:$.Plugin}}else if(le.isFieldEnd(e))o=!1;else if(le.isImage(e))t|=$.Img;else if(e instanceof q){var f=a[i+1].param.property;!(f instanceof l.kkf.getPropertyClass(l.uSS.RunProperty))||n||r||o||f.isPlaceholder||(t|=$.Text)}})),t},e.insertOperationAtTargetPos=function(t,n,r){if(n instanceof f){var o=0,i=n.param.range,a=this.getPrevInsertOperation(t.operations,r-1);o=a?a.param.range.gcpBegin+a.param.text.length-i.gcpBegin:t.globalOpts.originRange.end()-i.gcpBegin;var s=n instanceof q?o:o-i.len,c=e.moveOffset(n.clone(),s);c&&t.insertOperation(c,r)}else t.insertOperation(n,r)},e.getNextInsertOperation=function(e,t){for(var n=e.length,r=t+1;r<n;r++){var o=e[r];if(o instanceof q)return o}return null},e.getPrevInsertOperation=function(e,t){if(t>=e.length)return null;for(var n=t-1;n>=0;n--){var r=e[n];if(r instanceof q)return r}return null},e}(),de=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._allSectDirty=!1,t}return(0,o.__extends)(t,e),t.prototype.isValid=function(){return!0},t.prototype.updateDirtyRange=function(e){var t=this.getModifyPropertyKeys(),n=e.getSectionStream().createSectionIterator();n.seek(this.param.range.end());var r=n.getRange().end(),o=function(e,t){return e.some((function(e){return t.includes(e)}))};if(o(t,[G.PAGE_WIDTH,G.MARGIN_LEFT,G.MARGIN_RIGHT,G.PAGE_NUM_FMT,G.PAGE_NUM_START])){this._allSectDirty=!0,n.seek(this.param.range.begin());var i=n.getRange().begin();this._dirtyRange=new l.ICE(i,r-i)}else this._dirtyRange=new l.ICE(r-1,1);o(t,[G.PAGE_HEIGHT,G.MARGIN_TOP,G.MARGIN_BOTTOM,G.HEADER_REF_ID,G.FOOTER_REF_ID])&&(this._exDirtyRange||(this._exDirtyRange=[]),n.seek(this.param.range.begin()),i=n.getRange().begin(),this._exDirtyRange.push(new l.ICE(i,1)))},t.prototype.isAllSectDirty=function(){return this._allSectDirty},t.prototype.getModifyPropertyKeys=function(){var e=this,t=[];return this.mutationArray.forEach((function(){var n=e.param.property;if(n){var r=ue.getModifyFooterAndHeaderId(n),i=ue.getModifyPageSizeKeys(n),a=ue.getModifyPageMarginKeys(n),s=ue.getModifyPageNumKeys(n);t.push.apply(t,(0,o.__spreadArray)([],(0,o.__read)(r),!1)),t.push.apply(t,(0,o.__spreadArray)([],(0,o.__read)(i),!1)),t.push.apply(t,(0,o.__spreadArray)([],(0,o.__read)(a),!1)),t.push.apply(t,(0,o.__spreadArray)([],(0,o.__read)(s),!1))}})),t},t}(W),pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.applyMutation=function(e,t,n){var r=t.getMutation(),o=e.setSectionProp(r.beginIndex,r.endIndex-r.beginIndex,this.param.mode,this.mutationProperty(r,n.isInputDoc),!n.fromServer);this.param.mode!==l.XS7.Insert&&o&&this.updateProperty(t,o)},t.prototype.verifyType=function(t){return!!e.prototype.verifyType.call(this,t)&&t.getMutation().modifyType===l.LK6.section},t.prototype.verifyData=function(t,n){return e.prototype.verifyData.call(this,t,n)&&this.verifyChar([l.IfD.SectionBreak],this.getMutationChar(t,n))},Object.defineProperty(t.prototype,"operationType",{get:function(){return r.ModifySectionProp},enumerable:!1,configurable:!0}),t.prototype.createMutation=function(e,t){if(this.param.mode===l.XS7.Insert)this.createModifyMutation(l.LK6.section,this.param.property,this.param.range,t);else{var n=e.getSectionStream().createSectionIterator(this.param.range);do{if(n.getCloneProperty()){var r=n.getRange(),o=new l.ICE(r.end()-1,1);this.createModifyMutation(l.LK6.section,this.param.property,o,t)}}while(n.next())}},t}(de),he=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.applyMutation=function(e,t,n){var r=t.getMutation(),o=this.mutationProperty(r,n.isInputDoc),i=e.setCommentProp(r.beginIndex,r.endIndex-r.beginIndex,this.param.mode,o,!n.fromServer);this.param.mode!==l.XS7.Insert&&i&&this.updateProperty(t,i),this.inverseArray=[]},t.prototype.verifyType=function(t){return!!e.prototype.verifyType.call(this,t)&&t.getMutation().modifyType===l.LK6.commentRef},t.prototype.verifyData=function(t,n){return e.prototype.verifyData.call(this,t,n)&&this.verifyChar([l.IfD.CommentReference],this.getMutationChar(t,n))},Object.defineProperty(t.prototype,"operationType",{get:function(){return r.ModifyCommentProp},enumerable:!1,configurable:!0}),t.prototype.createMutation=function(e,t){this.createModifyMutation(l.LK6.commentRef,this.param.property,this.param.range,t)},t}(W),fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.applyMutation=function(e,t,n){var r=t.getMutation(),o=e.setTableRowProp(r.beginIndex,r.endIndex-r.beginIndex,this.param.mode,this.mutationProperty(r,n.isInputDoc),!n.fromServer);this.param.mode!==l.XS7.Insert&&o&&this.updateProperty(t,o)},t.prototype.verifyType=function(t){return!!e.prototype.verifyType.call(this,t)&&t.getMutation().modifyType===l.LK6.tableRow},t.prototype.verifyData=function(t,n){return e.prototype.verifyData.call(this,t,n)&&this.verifyChar([l.IfD.TableRowBreak,l.IfD.TableStart,l.IfD.TableEnd],this.getMutationChar(t,n))},Object.defineProperty(t.prototype,"operationType",{get:function(){return r.ModifyTableRowProp},enumerable:!1,configurable:!0}),t.prototype.createMutation=function(e,t){if(this.param.mode===l.XS7.Insert)this.createModifyMutation(l.LK6.tableRow,this.param.property,this.param.range,t);else{var n=this.param.property.nestingLevel,r=e.getTableStream().createRowIterator({nestingLevel:n,limitRange:this.param.range});do{if(r.getCloneProperty()){var o=r.getRange(!0),i=new l.ICE(o.end()-1,1);this.createModifyMutation(l.LK6.tableRow,this.param.property,i,t)}}while(r.next())}},t}(Z),ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.applyMutation=function(e,t,n){var r=t.getMutation(),o=e.setTableCellProp(r.beginIndex,r.endIndex-r.beginIndex,this.param.mode,this.mutationProperty(r,n.isInputDoc),!n.fromServer);this.param.mode!==l.XS7.Insert&&o&&this.updateProperty(t,o)},t.prototype.verifyType=function(t){return!!e.prototype.verifyType.call(this,t)&&t.getMutation().modifyType===l.LK6.tableCell},t.prototype.verifyData=function(t,n){return e.prototype.verifyData.call(this,t,n)&&this.verifyChar([l.IfD.TableRowBreak,l.IfD.TableStart,l.IfD.TableEnd,l.IfD.TableCellBreak],this.getMutationChar(t,n))},Object.defineProperty(t.prototype,"operationType",{get:function(){return r.ModifyTableCellProp},enumerable:!1,configurable:!0}),t.prototype.createMutation=function(e,t){if(this.param.mode===l.XS7.Insert)this.createModifyMutation(l.LK6.tableCell,this.param.property,this.param.range,t);else for(var n=this.param,r=n.range,o=n.property,i=e.getTableStream().createCellIterator({limitRange:r,nestingLevel:o.nestingLevel});i.hasNext();){var a=i.getRange(!0),s=new l.ICE(a.end()-1,1);this.createModifyMutation(l.LK6.tableCell,o,s,t),i.next()}},t}(Z),ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"param",{get:function(){return this._param},enumerable:!1,configurable:!0}),t.prototype.parseMutation=function(e){if(e.type===g.x1.deleteRange){var t=e.getMutation();this.param.id=t.id}},t.prototype.doInverse=function(e,t,n){var r,o,i,a=this.getRangeProperty(e.getDataStream());if(!a)return[];var s=new g.TF({id:this.param.id,rangeType:this.param.rangeType,beginIndex:(null===(o=this.param.range)||void 0===o?void 0:o.begin())||0,endIndex:(null===(i=this.param.range)||void 0===i?void 0:i.end())||0,property:(r={},r[this.param.rangeType]=a,r)}),c=n+this.changeLen;return t.options.undo=t,[new v(s,{baseLen:c})]},t.prototype.doDeleteAnnotationRange=function(e,t){switch(t.rangeType){case l.LK6.commentRange:return e.deleteCommentRange(t.id);case l.LK6.bookmarkRange:return e.deleteBookmarkRange(t.id);case l.LK6.permissionRange:return e.deletePermissionRange(t.id);case l.LK6.revisionRange:return e.deleteRevisionRange(t.id);case l.LK6.quoteRange:return e.deleteQuoteRange(t.id)}},t.prototype.applyMutation=function(e,t){var n=t.getMutation(),r=this.doDeleteAnnotationRange(e,n);r?(this.param.range=r,this.updateRange(t)):(this.inverseArray.pop(),this.mutationArray.pop())},t.prototype.updateRange=function(e){var t,n=null===(t=e.options.undo)||void 0===t?void 0:t.getMutation();n instanceof g.TF&&(n.beginIndex=this.param.range.begin(),n.endIndex=this.param.range.end())},t.prototype.verifyType=function(e){return e.type===g.x1.deleteRange},t.prototype.verifyData=function(){return!0},Object.defineProperty(t.prototype,"changeLen",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"afterRange",{get:function(){return l.ICE.invalidRange()},enumerable:!1,configurable:!0}),t.prototype.updateDirtyRange=function(){},Object.defineProperty(t.prototype,"operationType",{get:function(){return r.DeleteRange},enumerable:!1,configurable:!0}),t.prototype.createMutation=function(e,t){var n=new g.UR({id:this.param.id,rangeType:this.param.rangeType}),r=new v(n,t);this.mutationArray.push(r)},t.prototype.getRangeProperty=function(e){var t,n,r,o,i,a=e.getAnnotationStream();switch(this.param.rangeType){case l.LK6.commentRange:return null===(t=a.getCommentRangeSimpleInfoFromId(this.param.id))||void 0===t?void 0:t.rangeProp;case l.LK6.bookmarkRange:return null===(n=a.getBookmarkRangeInfoFromId(this.param.id))||void 0===n?void 0:n.rangeProp;case l.LK6.permissionRange:return null===(r=a.getPermissionRangeInfoFromId(this.param.id))||void 0===r?void 0:r.rangeProp;case l.LK6.revisionRange:return null===(o=a.getRevisionRangeInfoFromId(this.param.id))||void 0===o?void 0:o.rangeProp;case l.LK6.quoteRange:return null===(i=a.getQuoteRangeInfoFromId(this.param.id))||void 0===i?void 0:i.rangeProp}},t}(f),ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"param",{get:function(){return this._param},enumerable:!1,configurable:!0}),t.prototype.parseMutation=function(e){if(e.type===g.x1.insertRange){var t=e.getMutation(),n=t.beginIndex,r=t.endIndex;this.param.range=new l.ICE(n,r-n),this.param.id=t.id,this.param.rangeType=t.rangeType,this.param.property=l.vCY.deserialize(t.property)}},t.prototype.doInverse=function(e,t,n){var r=t.getMutation(),o=new g.UR({id:r.id,rangeType:r.rangeType}),i=n+this.changeLen;return[new v(o,{baseLen:i})]},t.prototype.applyMutation=function(e,t,n){var r=t.getMutation(),o=this.mutationProperty(r,n.isInputDoc);switch(r.rangeType){case l.LK6.commentRange:o instanceof l.kkf.getPropertyClass(l.uSS.CommentRangeProperty)&&e.insertCommentRange(r.beginIndex,r.endIndex-r.beginIndex,o);break;case l.LK6.bookmarkRange:o instanceof l.kkf.getPropertyClass(l.uSS.BookmarkRangeProperty)&&e.insertBookmarkRange(r.beginIndex,r.endIndex-r.beginIndex,o);break;case l.LK6.permissionRange:o instanceof l.kkf.getPropertyClass(l.uSS.PermissionRangeProperty)&&e.insertPermissionRange(r.beginIndex,r.endIndex-r.beginIndex,o);break;case l.LK6.revisionRange:o instanceof l.kkf.getPropertyClass(l.uSS.RevisionRangeProperty)&&e.insertRevisionRange(r.beginIndex,r.endIndex-r.beginIndex,o);break;case l.LK6.quoteRange:o instanceof l.kkf.getPropertyClass(l.uSS.QuoteRangeProperty)&&e.insertQuoteRange(r.beginIndex,r.endIndex-r.beginIndex,o)}},t.prototype.verifyType=function(e){return e.type===g.x1.insertRange},t.prototype.verifyData=function(e,t){var n=t.getMutation();return V.validateRange(e,n.beginIndex,n.endIndex)},t.prototype.updateDirtyRange=function(e){this._dirtyRange=this.range},Object.defineProperty(t.prototype,"changeLen",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"afterRange",{get:function(){return this.range},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"operationType",{get:function(){return r.InsertRange},enumerable:!1,configurable:!0}),t.prototype.isValid=function(){return e.prototype.isValid.call(this)&&this.param.id.length>0},t.prototype.createMutation=function(e,t){var n,r=new g.TF({id:this.param.id,rangeType:this.param.rangeType,beginIndex:this.param.range.begin(),endIndex:this.param.range.end(),property:(n={},n[this.param.rangeType]=this.param.property,n)}),o=new v(r,t);this.mutationArray.push(o)},t.prototype.mutationProperty=function(e,t){var n=this.param.property||l.vCY.deserialize(e.property);return t?n:n.clone()},t}(f),me=JSON.parse('[{"ty":"is","bi":0,"s":"\\r\\u000f\\u001e\\u001e\\u001e\\u001e\\u001e\\u001e\\u001e"},{"ty":"mp","bi":0,"ei":1,"mt":"run","pr":{"run":{"isPlaceholder":true}}},{"ty":"mp","bi":1,"ei":2,"mt":"run","pr":{"run":{"isPlaceholder":true}}},{"ty":"mp","bi":2,"ei":3,"mt":"run","pr":{"run":{"isPlaceholder":true}}},{"ty":"mp","bi":3,"ei":4,"mt":"run","pr":{"run":{"isPlaceholder":true}}},{"ty":"mp","bi":4,"ei":5,"mt":"run","pr":{"run":{"isPlaceholder":true}}},{"ty":"mp","bi":5,"ei":6,"mt":"run","pr":{"run":{"isPlaceholder":true}}},{"ty":"mp","bi":6,"ei":7,"mt":"run","pr":{"run":{"isPlaceholder":true}}},{"ty":"mp","bi":7,"ei":8,"mt":"run","pr":{"run":{"isPlaceholder":true}}},{"ty":"mp","bi":8,"ei":9,"mt":"run","pr":{"run":{"isPlaceholder":true}}},{"ty":"mp","bi":0,"ei":1,"mt":"paragraph","pr":{"paragraph":{}}},{"ty":"mp","bi":1,"ei":2,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":2,"ei":3,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":3,"ei":4,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":4,"ei":5,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":5,"ei":6,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":6,"ei":7,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":7,"ei":8,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":8,"ei":9,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":1,"ei":2,"mt":"section","pr":{"section":{"pgSz":{"w":11900,"h":16840},"pgMar":{"top":1440,"right":1800,"bottom":1440,"left":1800,"header":851,"footer":992,"gutter":0},"cols":{"space":425},"docGrid":{"type":"STDocGrid_lines","linePitch":312}}}},{"ty":"mp","bi":2,"ei":3,"mt":"story","pr":{"story":{"storyType":"STStoryType_mainDocument"}}},{"ty":"mp","bi":3,"ei":4,"mt":"story","pr":{"story":{"storyType":"STStoryType_headerContent"}}},{"ty":"mp","bi":4,"ei":5,"mt":"story","pr":{"story":{"storyType":"STStoryType_footerContent"}}},{"ty":"mp","bi":5,"ei":6,"mt":"story","pr":{"story":{"storyType":"STStoryType_footnoteContent"}}},{"ty":"mp","bi":6,"ei":7,"mt":"story","pr":{"story":{"storyType":"STStoryType_endnoteContent"}}},{"ty":"mp","bi":7,"ei":8,"mt":"story","pr":{"story":{"storyType":"STStoryType_commentContent"}}},{"ty":"mp","bi":8,"ei":9,"mt":"story","pr":{"story":{"storyType":"STStoryType_textboxContent"}}}]'),be=function(){function e(){}return e.serialize=function(e){return this.serializeLimitRangeDoc(e)},e.serializeEmptyDoc=function(){return g.hV.deserialize(me)},e.serializeContainSettingsDoc=function(e){var t=[];return t.push.apply(t,(0,o.__spreadArray)([],(0,o.__read)(this.serializeEmptyDoc()),!1)),t.push.apply(t,(0,o.__spreadArray)([],(0,o.__read)(this.collectSettingMutations(e.getDataManager())),!1)),t},e.serializeContainSubStoryDoc=function(e){var t=e.getDataStream(),n=t.getStoryStream().getMainStoryInfo(),r=0;if(n){var o=t.getTextStream().createParagraphIterator();o.seek(n.contentRange.end()-1),o.prev(),r=o.getRange().end()-1}var i=t.getTextStream().getLength()-r;return this.serializeLimitRangeDoc(e,{limitRange:new l.ICE(r,i)})},e.serializeLimitRangeDoc=function(e,t){var n=[],r=e.getDataStream();return n.push.apply(n,(0,o.__spreadArray)([],(0,o.__read)(this.collectInsertMutations(r,t)),!1)),n.push.apply(n,(0,o.__spreadArray)([],(0,o.__read)(this.collectModifyMutations(r,t)),!1)),n.push.apply(n,(0,o.__spreadArray)([],(0,o.__read)(this.collectRangeMutations(r,t)),!1)),(null==t?void 0:t.notIncludeSettings)||n.push.apply(n,(0,o.__spreadArray)([],(0,o.__read)(this.collectSettingMutations(e.getDataManager())),!1)),n},e.collectInsertMutations=function(e,t){var n,r,o=null!==(n=null==t?void 0:t.limitRange)&&void 0!==n?n:new l.ICE(0,e.getTextStream().getLength());return[new g.Qr({beginIndex:null!==(r=null==t?void 0:t.gcpOffset)&&void 0!==r?r:0,text:e.getTextStream().readText(o.begin(),o.length())})]},e.collectModifyMutations=function(e,t){var n,r=this,i=[],a=this.collectIterators(e,t),s=null!==(n=null==t?void 0:t.gcpOffset)&&void 0!==n?n:0;return a.forEach((function(e){i.push.apply(i,(0,o.__spreadArray)([],(0,o.__read)(r.generateModifyMutations(e,s||0,null==t?void 0:t.limitRange)),!1))})),i},e.collectSettingMutations=function(e){var t=this,n=[];return this.collectSettingPropertys(e).forEach((function(e){n.push.apply(n,(0,o.__spreadArray)([],(0,o.__read)(t.generateSettingMutation(e)),!1))})),n},e.collectRangeMutations=function(e,t){var n,r=null!==(n=null==t?void 0:t.limitRange)&&void 0!==n?n:new l.ICE(0,e.getTextStream().getLength()),i=[];return i.push.apply(i,(0,o.__spreadArray)([],(0,o.__read)(this.generateAnnotationRangeMutation(e.getAnnotationStream().collectCommentRangeInfoFromRange(r),r,l.LK6.commentRange,null==t?void 0:t.gcpOffset)),!1)),i.push.apply(i,(0,o.__spreadArray)([],(0,o.__read)(this.generateAnnotationRangeMutation(e.getAnnotationStream().collectBookmarkRangeInfoFromRange(r),r,l.LK6.bookmarkRange,null==t?void 0:t.gcpOffset)),!1)),i.push.apply(i,(0,o.__spreadArray)([],(0,o.__read)(this.generateAnnotationRangeMutation(e.getAnnotationStream().collectPermissionRangeInfoFromRange(r),r,l.LK6.permissionRange,null==t?void 0:t.gcpOffset)),!1)),i.push.apply(i,(0,o.__spreadArray)([],(0,o.__read)(this.generateAnnotationRangeMutation(e.getAnnotationStream().collectRevisionRangeInfoFromRange(r),r,l.LK6.revisionRange,null==t?void 0:t.gcpOffset)),!1)),i.push.apply(i,(0,o.__spreadArray)([],(0,o.__read)(this.generateAnnotationRangeMutation(e.getAnnotationStream().collectQuoteRangeInfoFromRange(r),r,l.LK6.quoteRange,null==t?void 0:t.gcpOffset)),!1)),i},e.collectIterators=function(e,t){var n=null==t?void 0:t.limitRange;return(0,o.__spreadArray)((0,o.__spreadArray)((0,o.__spreadArray)((0,o.__spreadArray)([e.getTextStream().createRunIterator(n,!0),e.getTextStream().createParagraphIterator(n,!0),e.getSectionStream().createSectionIterator(n,!0),e.getStoryStream().createSubStoryIterator({limitRange:n,isRawIter:!0}),e.getStoryStream().createStoryIterator(n,!0),e.getAnnotationStream().createCommentIterator(n,!0),e.getDrawingStream().createDrawingIterator(n,!0),e.getDrawingStream().createPictureIterator(n,!0),e.getDrawingStream().createEmbeddedObjectIterator(n,!0),e.getNotesStream().createFootnoteIterator(n,!0),e.getNotesStream().createEndnoteIterator(n,!0)],(0,o.__read)(this.collectFieldIterators(e.getFieldStream(),n)),!1),(0,o.__read)(this.collectTableIterators(e.getTableStream(),n)),!1),(0,o.__read)(this.collectMathIterators(e.getMathStream(),n)),!1),(0,o.__read)(this.collectSdtIterators(e.getSdtStream(),n)),!1)},e.collectTableIterators=function(e,t){for(var n=[],r=e.maxLevel,o=1;o<=r;o++)n.push(e.createTableIterator({limitRange:t,isRawIter:!0,nestingLevel:o})),n.push(e.createRowIterator({limitRange:t,isRawIter:!0,nestingLevel:o})),n.push(e.createCellIterator({limitRange:t,isRawIter:!0,nestingLevel:o}));return n},e.collectMathIterators=function(e,t){for(var n=[],r=e.maxLevel,o=1;o<=r;o++)n.push(e.createMathIterator({limitRange:t,isRawIter:!0,nestingLevel:o})),n.push(e.createMathObjectIterator({limitRange:t,isRawIter:!0,nestingLevel:o}));return n.push(e.createMathRunIterator(t,!0)),n},e.collectFieldIterators=function(e,t){for(var n=[],r=e.maxNestingLevel,o=1;o<=r;o++)n.push(e.createFieldIterator({limitRange:t,isRawIter:!0,nestingLevel:o}));return n},e.collectSdtIterators=function(e,t){for(var n=[],r=e.maxLevel,o=1;o<=r;o++)n.push(e.createSdtIterator({limitRange:t,isRawIter:!0,nestingLevel:o}));return n},e.generateModifyMutations=function(e,t,n){for(var r,o=[];e.hasNext();){var i=e.getOperationRange(),a=e.getCloneProperty();if(e.next(),i.isValid()&&!i.isEmpty()&&a&&!a.isFakeAttribute){if(n){if(!n.intersect(i))continue;(i=n.intersectRange(i)).offset(-n.begin())}var s=l.vCY.getMutationPropTypeFromProp(a);if(s){var c=s===l.LK6.run?l.GsI.insert:l.GsI.merge,u=new g.OJ({beginIndex:i.begin()+t,endIndex:i.end()+t,modifyType:s,property:(r={},r[s]=a,r),modifyMode:c});o.push(u)}}}return o},e.collectSettingPropertys=function(e){return[e.getSettingsManager().getDocSettingsProperty(),e.getSettingsManager().getWebSettingsProperty(),e.getSettingsManager().getDocBackgroundProperty(),e.getStyleSheetManager().getStylesProperty(),e.getNumberingManager().getNumberingProperty(),e.getFontTableManager().getFontsProperty(),e.getThemeManager().getThemesProperty()]},e.generateSettingMutation=function(e){var t,n=l.vCY.getMutationPropTypeFromProp(e);return n?[new g.Lq({settingType:n,property:(t={},t[n]=e,t)})]:[]},e.generateAnnotationRangeMutation=function(e,t,n,r){var o=null!=r?r:0,i=[];return e.forEach((function(e){var r,a=e.annotationRange;a.offset(-t.begin());var s=new g.TF({beginIndex:a.begin()+o,endIndex:a.end()+o,rangeType:n,id:e.rangeProp.id,property:(r={},r[n]=e.rangeProp,r)});i.push(s)})),i},e}(),_e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.parseMutation=function(e){if(e.type===g.x1.delete){var t=e.getMutation(),n=t.beginIndex,r=t.endIndex;this.param.range=new l.ICE(n,r-n)}},t.prototype.doInverse=function(e,t,n){var r=e.getDataStream(),o=t.getMutation(),i=new l.ICE(o.beginIndex,o.endIndex-o.beginIndex),a=r.getTextStream().readText(i.begin(),i.len),s=n+this.changeLen,c=[];return be.serializeLimitRangeDoc(e,{limitRange:i,gcpOffset:i.begin(),notIncludeSettings:!0}).forEach((function(e){var t=s+(e.type!==g.x1.insert?a.length:0),n=new v(e,{baseLen:t});c.push(n)})),c.reverse()},t.prototype.applyMutation=function(e,t,n){var r=t.getMutation(),o=r.beginIndex,i=r.endIndex,a=new l.ICE(o,i-o);e.deleteText(a.gcpBegin,a.len,n.optAuthor)},t.prototype.verifyType=function(e){return e.type===g.x1.delete},t.prototype.verifyData=function(e,t){var n=t.getMutation();return V.validateDeleteRange(e,n.beginIndex,n.endIndex)},Object.defineProperty(t.prototype,"operationType",{get:function(){return r.DeleteText},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"changeLen",{get:function(){return-this.range.length()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"afterRange",{get:function(){return new l.ICE(this.param.range.gcpBegin,0)},enumerable:!1,configurable:!0}),t.prototype.isValid=function(){return e.prototype.isValid.call(this)&&this.param.range.len>0},t.prototype.updateDirtyRange=function(e){this._dirtyRange=new l.ICE(this.param.range.gcpBegin,0)},t.prototype.createMutation=function(e,t){var n=new g.jn({beginIndex:this.param.range.begin(),endIndex:this.param.range.end()}),r=new v(n,(0,o.__assign)({},t));this.mutationArray.push(r)},t}(f),Ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.applyMutation=function(e,t,n){var r=t.getMutation(),o=e.setMathProp(r.beginIndex,r.endIndex-r.beginIndex,this.param.mode,this.mutationProperty(r,n.isInputDoc),!n.fromServer);this.param.mode!==l.XS7.Insert&&o&&this.updateProperty(t,o)},t.prototype.verifyType=function(t){return!!e.prototype.verifyType.call(this,t)&&t.getMutation().modifyType===l.LK6.math},t.prototype.verifyData=function(t,n){if(!e.prototype.verifyData.call(this,t,n))return!1;var r=this.getMutationChar(t,n);return this.verifyChar([l.IfD.MathStart,l.IfD.MathEnd],r)},Object.defineProperty(t.prototype,"operationType",{get:function(){return r.ModifyMathProp},enumerable:!1,configurable:!0}),t.prototype.createMutation=function(e,t){this.createModifyMutation(l.LK6.math,this.param.property,this.param.range,t)},t}(W),Se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.applyMutation=function(e,t,n){var r=t.getMutation(),o=e.setMathObjectProp(r.beginIndex,r.endIndex-r.beginIndex,this.param.mode,this.mutationProperty(r,n.isInputDoc),!n.fromServer);this.param.mode!==l.XS7.Insert&&o&&this.updateProperty(t,o)},t.prototype.verifyType=function(t){return!!e.prototype.verifyType.call(this,t)&&t.getMutation().modifyType===l.LK6.mathObject},t.prototype.verifyData=function(t,n){if(!e.prototype.verifyData.call(this,t,n))return!1;var r=this.getMutationChar(t,n);return this.verifyChar([l.IfD.MathObjectStart,l.IfD.MathObjectEnd],r)},Object.defineProperty(t.prototype,"operationType",{get:function(){return r.ModifyMathObjectProp},enumerable:!1,configurable:!0}),t.prototype.createMutation=function(e,t){this.createModifyMutation(l.LK6.mathObject,this.param.property,this.param.range,t)},t}(W),we=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.applyMutation=function(e,t,n){var r=t.getMutation(),o=e.setMathRunProp(r.beginIndex,r.endIndex-r.beginIndex,this.param.mode,this.mutationProperty(r,n.isInputDoc),!n.fromServer);this.param.mode!==l.XS7.Insert&&o&&this.updateProperty(t,o)},t.prototype.verifyType=function(t){return!!e.prototype.verifyType.call(this,t)&&t.getMutation().modifyType===l.LK6.mathRun},Object.defineProperty(t.prototype,"operationType",{get:function(){return r.ModifyMathRunProp},enumerable:!1,configurable:!0}),t.prototype.createMutation=function(e,t){this.createModifyMutation(l.LK6.mathRun,this.param.property,this.param.range,t)},t}(W),Ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.applyMutation=function(e,t,n){var r=t.getMutation(),o=e.setSdtProp(r.beginIndex,r.endIndex-r.beginIndex,this.param.mode,this.mutationProperty(r,n.isInputDoc),!n.fromServer);this.param.mode!==l.XS7.Insert&&o&&this.updateProperty(t,o)},t.prototype.verifyType=function(t){return!!e.prototype.verifyType.call(this,t)&&t.getMutation().modifyType===l.LK6.sdt},t.prototype.verifyData=function(t,n){if(!e.prototype.verifyData.call(this,t,n))return!1;var r=this.getMutationChar(t,n);return this.verifyChar([l.IfD.SdtStart,l.IfD.SdtEnd],r)},Object.defineProperty(t.prototype,"operationType",{get:function(){return r.ModifySdtProp},enumerable:!1,configurable:!0}),t.prototype.createMutation=function(e,t){this.createModifyMutation(l.LK6.sdt,this.param.property,this.param.range,t)},t}(W),xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.applyMutation=function(e,t,n){var r=t.getMutation(),o=e.setFootnoteProp(r.beginIndex,r.endIndex-r.beginIndex,this.param.mode,this.mutationProperty(r,n.isInputDoc),!n.fromServer);this.param.mode!==l.XS7.Insert&&o&&this.updateProperty(t,o)},t.prototype.verifyType=function(t){return!!e.prototype.verifyType.call(this,t)&&t.getMutation().modifyType===l.LK6.footnoteRef},t.prototype.verifyData=function(t,n){if(!e.prototype.verifyData.call(this,t,n))return!1;var r=this.getMutationChar(t,n);return this.verifyChar([l.IfD.FootnoteEndnoteReference],r)},Object.defineProperty(t.prototype,"operationType",{get:function(){return r.ModifyFootnoteProp},enumerable:!1,configurable:!0}),t.prototype.createMutation=function(e,t){this.createModifyMutation(l.LK6.footnoteRef,this.param.property,this.param.range,t)},t}(W),Te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.applyMutation=function(e,t,n){var r=t.getMutation(),o=e.setEndnoteProp(r.beginIndex,r.endIndex-r.beginIndex,this.param.mode,this.mutationProperty(r,n.isInputDoc),!n.fromServer);this.param.mode!==l.XS7.Insert&&o&&this.updateProperty(t,o)},t.prototype.verifyType=function(t){return!!e.prototype.verifyType.call(this,t)&&t.getMutation().modifyType===l.LK6.endnoteRef},t.prototype.verifyData=function(t,n){if(!e.prototype.verifyData.call(this,t,n))return!1;var r=this.getMutationChar(t,n);return this.verifyChar([l.IfD.FootnoteEndnoteReference],r)},Object.defineProperty(t.prototype,"operationType",{get:function(){return r.ModifyEndnoteProp},enumerable:!1,configurable:!0}),t.prototype.createMutation=function(e,t){this.createModifyMutation(l.LK6.endnoteRef,this.param.property,this.param.range,t)},t}(W),Re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.applyMutation=function(e,t,n){var r=t.getMutation(),o=e.setPictureProp(r.beginIndex,r.endIndex-r.beginIndex,this.param.mode,this.mutationProperty(r,n.isInputDoc),!n.fromServer);this.param.mode!==l.XS7.Insert&&o&&this.updateProperty(t,o)},t.prototype.verifyType=function(t){return!!e.prototype.verifyType.call(this,t)&&t.getMutation().modifyType===l.LK6.picture},t.prototype.verifyData=function(t,n){return e.prototype.verifyData.call(this,t,n)&&this.verifyChar([l.IfD.PictureAnchor],this.getMutationChar(t,n))},Object.defineProperty(t.prototype,"operationType",{get:function(){return r.ModifyPictureProp},enumerable:!1,configurable:!0}),t.prototype.createMutation=function(e,t){this.createModifyMutation(l.LK6.picture,this.param.property,this.param.range,t)},t}(W),Ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.applyMutation=function(e,t,n){var r=t.getMutation(),o=e.setEmbeddedObjectProp(r.beginIndex,r.endIndex-r.beginIndex,this.param.mode,this.mutationProperty(r,n.isInputDoc),!n.fromServer);this.param.mode!==l.XS7.Insert&&o&&this.updateProperty(t,o)},t.prototype.verifyType=function(t){return!!e.prototype.verifyType.call(this,t)&&t.getMutation().modifyType===l.LK6.embeddedObject},t.prototype.verifyData=function(t,n){return e.prototype.verifyData.call(this,t,n)&&this.verifyChar([l.IfD.EmbeddedObjectAnchor],this.getMutationChar(t,n))},Object.defineProperty(t.prototype,"operationType",{get:function(){return r.ModifyEmbeddedObjectProp},enumerable:!1,configurable:!0}),t.prototype.createMutation=function(e,t){this.createModifyMutation(l.LK6.embeddedObject,this.param.property,this.param.range,t)},t}(W),Pe=((te={})[r.InsertText]=q,te[r.DeleteText]=_e,te[r.ModifyParagraphProp]=z,te[r.ModifyRunProp]=K,te[r.ModifySectionProp]=pe,te[r.ModifySubStoryProp]=ae,te[r.ModifyStoryProp]=se,te[r.ModifyDrawingProp]=ce,te[r.ModifyPictureProp]=Re,te[r.ModifyEmbeddedObjectProp]=Ie,te[r.ModifyFieldProp]=ie,te[r.ModifyTableProp]=X,te[r.ModifyTableRowProp]=fe,te[r.ModifyTableCellProp]=ge,te[r.ModifyCommentProp]=he,te[r.ModifyFootnoteProp]=xe,te[r.ModifyEndnoteProp]=Te,te[r.ModifyMathProp]=Ce,te[r.ModifyMathObjectProp]=Se,te[r.ModifyMathRunProp]=we,te[r.ModifySdtProp]=Ee,te[r.InsertRange]=ye,te[r.DeleteRange]=ve,te[r.SettingOperation]=Q,te),Oe=((ne={})[l.LK6.paragraph]=function(){return Pe[r.ModifyParagraphProp]},ne[l.LK6.run]=function(){return Pe[r.ModifyRunProp]},ne[l.LK6.section]=function(){return Pe[r.ModifySectionProp]},ne[l.LK6.drawing]=function(){return Pe[r.ModifyDrawingProp]},ne[l.LK6.picture]=function(){return Pe[r.ModifyPictureProp]},ne[l.LK6.embeddedObject]=function(){return Pe[r.ModifyEmbeddedObjectProp]},ne[l.LK6.field]=function(){return Pe[r.ModifyFieldProp]},ne[l.LK6.story]=function(){return Pe[r.ModifyStoryProp]},ne[l.LK6.tableCell]=function(){return Pe[r.ModifyTableCellProp]},ne[l.LK6.tableRow]=function(){return Pe[r.ModifyTableRowProp]},ne[l.LK6.table]=function(){return Pe[r.ModifyTableProp]},ne[l.LK6.commentRef]=function(){return Pe[r.ModifyCommentProp]},ne[l.LK6.footnoteRef]=function(){return Pe[r.ModifyFootnoteProp]},ne[l.LK6.endnoteRef]=function(){return Pe[r.ModifyEndnoteProp]},ne[l.LK6.math]=function(){return Pe[r.ModifyMathProp]},ne[l.LK6.mathObject]=function(){return Pe[r.ModifyMathObjectProp]},ne[l.LK6.mathRun]=function(){return Pe[r.ModifyMathRunProp]},ne[l.LK6.sdt]=function(){return Pe[r.ModifySdtProp]},ne[l.LK6.headerContent]=function(){return Pe[r.ModifySubStoryProp]},ne[l.LK6.footerContent]=function(){return Pe[r.ModifySubStoryProp]},ne[l.LK6.footnoteContent]=function(){return Pe[r.ModifySubStoryProp]},ne[l.LK6.endnoteContent]=function(){return Pe[r.ModifySubStoryProp]},ne[l.LK6.commentContent]=function(){return Pe[r.ModifySubStoryProp]},ne[l.LK6.textboxContent]=function(){return Pe[r.ModifySubStoryProp]},ne),ke=function(){function e(){}return e.createServerOperation=function(e,t){void 0===t&&(t=!0);var n=null;switch(e.type){case g.x1.insert:n=Pe[r.InsertText];break;case g.x1.delete:n=Pe[r.DeleteText];break;case g.x1.insertRange:n=Pe[r.InsertRange];break;case g.x1.deleteRange:n=Pe[r.DeleteRange];break;case g.x1.modify:var o=e.getMutation(),a=Oe[o.modifyType];a?n=a.apply(void 0):i.Logger.error("mutation modify type error: ".concat(o.modifyType,""));break;case g.x1.setting:n=Pe[r.SettingOperation];break;default:i.Logger.error("mutation type error: ".concat(e.type,""))}if(n){var s=new n;return s.setMutation(e,t),s}return null},e.createLocalOperation=function(e,t){var n=new(0,Pe[t]);return n.setParam(e),n},e}(),De=[l.LK6.commentRange,l.LK6.bookmarkRange,l.LK6.permissionRange,l.LK6.revisionRange,l.LK6.quoteRange],Me=function(){function e(e){this.operations=[],this.globalOpts=e,this._currentRange=this.globalOpts.originRange}return e.prototype.setUpdateSelection=function(e){return this.globalOpts.updateSelection=e,this},e.prototype.setNeedCollab=function(e){return this.globalOpts.needCollab=e,this},e.prototype.setCommandType=function(e){this.globalOpts.commandType=e},e.prototype.setMutOption=function(e){this.globalOpts.mutOption=(0,o.__assign)((0,o.__assign)({},this.globalOpts.mutOption),e)},e.prototype.moveTo=function(e){return this._currentRange=e,this},e.prototype._addOperation=function(e){return e.isValid()&&(this.operations.push(e),e.afterRange.isValid()&&(this._currentRange=e.afterRange)),this},e.prototype.applyOperations=function(e,t){var n=this;this.operations.forEach((function(r){r.apply(e,n.globalOpts),t&&t(r)}))},e.prototype.getMutations=function(){var e=[],t=[];return this.forEachOp((function(n){e.push.apply(e,(0,o.__spreadArray)([],(0,o.__read)(n.mutations),!1)),t.push.apply(t,(0,o.__spreadArray)([],(0,o.__read)(n.inverses),!1))})),{mutations:e,inverses:t.reverse()}},e.prototype.forEachOp=function(e){this.operations.forEach((function(t,n,r){e(t,n,r)}))},e.prototype.someOp=function(e){return this.operations.some((function(t,n,r){return e(t,n,r)}))},e.prototype.currentRange=function(){return this._currentRange},e.prototype.insertText=function(e,t){if(t.length<=0)return this;var n={text:t,range:new l.ICE(e,0)},o=ke.createLocalOperation(n,r.InsertText);return this._addOperation(o)},e.prototype.deleteText=function(e){if(e.isEmpty())return this;var t={range:e.clone()},n=ke.createLocalOperation(t,r.DeleteText);return this._addOperation(n)},e.prototype.setParagraphProperty=function(e,t,n){var o=this.globalOpts.isInputDoc?t:t.clone();n!==l.XS7.Insert||o.paraId||(o.paraId=i.StringUtil.generateRandomId());var a={range:e.clone(),property:o,mode:n},s=ke.createLocalOperation(a,r.ModifyParagraphProp);return this._addOperation(s)},e.prototype.setDrawingProperty=function(e,t,n){var o=this.globalOpts.isInputDoc?t:t.clone(),i={range:e.clone(),property:o,mode:n},a=ke.createLocalOperation(i,r.ModifyDrawingProp);return this._addOperation(a)},e.prototype.setEmbeddedObjectProperty=function(e,t,n){var o=this.globalOpts.isInputDoc?t:t.clone(),i={range:e.clone(),property:o,mode:n},a=ke.createLocalOperation(i,r.ModifyEmbeddedObjectProp);return this._addOperation(a)},e.prototype.setRunProperty=function(e,t,n){if(!e.isValid()||e.isEmpty())return this;var o=this.globalOpts.isInputDoc?t:t.clone();this.globalOpts.fromServer||(o.author=l.keb.author);var i={range:e.clone(),property:o,mode:n},a=ke.createLocalOperation(i,r.ModifyRunProp);return this._addOperation(a)},e.prototype.setFieldProperty=function(e,t,n){var o=this.globalOpts.isInputDoc?t:t.clone(),i={range:e.clone(),property:o,mode:n},a=ke.createLocalOperation(i,r.ModifyFieldProp);return this._addOperation(a)},e.prototype.setSectionProperty=function(e,t,n){var o=this.globalOpts.isInputDoc?t:t.clone(),i={range:e.clone(),property:o,mode:n},a=ke.createLocalOperation(i,r.ModifySectionProp);return this._addOperation(a)},e.prototype.setSubStoryProperty=function(e,t,n){var o=this.globalOpts.isInputDoc?t:t.clone(),i={range:e.clone(),property:o,mode:n},a=ke.createLocalOperation(i,r.ModifySubStoryProp);return this._addOperation(a)},e.prototype.setStoryProperty=function(e,t,n){var o=this.globalOpts.isInputDoc?t:t.clone(),i={range:e.clone(),property:o,mode:n},a=ke.createLocalOperation(i,r.ModifyStoryProp);return this._addOperation(a)},e.prototype.setCommentProperty=function(e,t,n){var o=this.globalOpts.isInputDoc?t:t.clone(),i={range:e.clone(),property:o,mode:n},a=ke.createLocalOperation(i,r.ModifyCommentProp);return this._addOperation(a)},e.prototype.setSettingProperty=function(e,t,n){void 0===n&&(n=!0);var o={property:this.globalOpts.isInputDoc?e:n?e.clone():e,settingType:t},i=ke.createLocalOperation(o,r.SettingOperation);return this._addOperation(i)},e.prototype.setTableProperty=function(e,t,n){var o=this.globalOpts.isInputDoc?t:t.clone(),i={range:e.clone(),property:o,mode:n},a=ke.createLocalOperation(i,r.ModifyTableProp);return this._addOperation(a)},e.prototype.setTableRowProperty=function(e,t,n){var o=this.globalOpts.isInputDoc?t:t.clone(),i={range:e.clone(),property:o,mode:n},a=ke.createLocalOperation(i,r.ModifyTableRowProp);return this._addOperation(a)},e.prototype.setTableCellProperty=function(e,t,n){var o=this.globalOpts.isInputDoc?t:t.clone(),i={range:e.clone(),property:o,mode:n},a=ke.createLocalOperation(i,r.ModifyTableCellProp);return this._addOperation(a)},e.prototype.insertRange=function(e,t,n){if(!e.isValid()||!De.includes(t))return this;var o={range:e.clone(),id:n.id,rangeType:t,property:n},i=ke.createLocalOperation(o,r.InsertRange);return this._addOperation(i)},e.prototype.deleteRange=function(e,t,n){if(!t.isValid()||!e||!De.includes(n))return this;var o={id:e,rangeType:n,range:t.clone()},i=ke.createLocalOperation(o,r.DeleteRange);return this._addOperation(i)},e.prototype.insertCommentRange=function(e,t){if(""===e)return this;var n=new(l.kkf.getPropertyClass(l.uSS.CommentRangeProperty));return n.id=e,this.insertRange(t,l.LK6.commentRange,n)},e.prototype.deleteCommentRange=function(e,t){return this.deleteRange(e,t,l.LK6.commentRange)},e.prototype.insertRevisionRange=function(e,t){return this.insertRange(e,l.LK6.revisionRange,t)},e.prototype.deleteRevisionRange=function(e,t){return this.deleteRange(e,t,l.LK6.revisionRange)},e.prototype.insertQuoteRange=function(e,t){var n=new(l.kkf.getPropertyClass(l.uSS.QuoteRangeProperty));return n.id=t,this.insertRange(e,l.LK6.quoteRange,n)},e.prototype.deleteQuoteRange=function(e,t){return this.deleteRange(e,t,l.LK6.quoteRange)},e.prototype.insertPermissionRange=function(e,t){var n=new(l.kkf.getPropertyClass(l.uSS.PermissionRangeProperty));return n.id=t,this.insertRange(e,l.LK6.permissionRange,n)},e.prototype.deletePermissionRange=function(e,t){return this.deleteRange(e,t,l.LK6.permissionRange)},e.prototype.insertBookmarkRange=function(e,t,n){var r=new(l.kkf.getPropertyClass(l.uSS.BookmarkRangeProperty));return r.id=t,r.name=n,this.insertRange(e,l.LK6.bookmarkRange,r)},e.prototype.deleteBookmarkRange=function(e,t,n){return this.deleteRange(t,e,l.LK6.bookmarkRange)},e.prototype.opMap=function(e){this.operations=this.operations.map(e)},e.prototype.opMapList=function(e){var t=[];this.operations.forEach((function(n,r,i){t.push.apply(t,(0,o.__spreadArray)([],(0,o.__read)(e(n,r,i)),!1))})),this.operations=t},e.prototype.correctCurrentRange=function(){if(this.operations.length)for(var e=this.operations.length-1;e>=0;e--)if(this.operations[e]instanceof f){var t=this.operations[e].afterRange;this.moveTo(t);break}},e.prototype.opFilter=function(e){var t=this.operations.slice(0);this.operations=this.operations.filter((function(n,r,o){var i=e(n,r,o),a=Number.MAX_SAFE_INTEGER;if(n instanceof f&&(a=n.param.range.gcpBegin),!i)for(var s=-ue.getOffset(n),c=r+1;c<t.length;c++)t[c].param.range&&t[c].param.range.gcpBegin>=a&&ue.moveOffset(t[c],s);return i})),this.correctCurrentRange()},e.prototype.opFilterWithoutMovingOffset=function(e){this.operations=this.operations.filter(e)},e.prototype.addOperation=function(e){return this._addOperation(e)},e.prototype.insertOperation=function(e,t,n){if(void 0===n&&(n=!0),this.operations.splice(t,0,e),n)for(var r=ue.getOffset(e),o=t+1;o<this.operations.length;o++)ue.moveOffset(this.operations[o],r);e instanceof f&&(this._currentRange.gcpBegin+=e.changeLen)},e.prototype.insertOperations=function(e,t,n){void 0===n&&(n=!0);for(var r=0;r<e.length;r++)this.insertOperation(e[r],t+r,n)},e.prototype.splitValidRange=function(e,t,n){var r=this.currentRange().clone();ue.splitCellRange(e,null!=n?n:this.currentRange(),(function(e,n){return t(e,n),!0})),this.moveTo(r)},e.prototype.clearMutations=function(){this.operations.forEach((function(e){e.clearMutations()}))},e}();!function(e){e.Undo="undo",e.Redo="redo"}(re||(re={}));var Ae,Le=function(){function e(e,t,n,r,o,i,a,s){this.originRange=e,this.updateSelection=t,this.needCollab=n,this.fromServer=r,this.isInputDoc=o,this.undoOption=i,this.mutOption={},this.commandType=null!=a?a:S.Empty,this.extraInfo="",this.optAuthor=s||""}return e.prototype.setAuthor=function(e){this.optAuthor=e},e.createLocalDeltaOption=function(t,n,r){return void 0===n&&(n=!0),void 0===r&&(r=!0),new e(t,n,r,!1,!1,{needInverse:!0,needMergeUndoStackTop:!1,fromUndoRedo:!1,isUnMerge:!1})},e.createServerDeltaOption=function(t){return new e(t,!1,!1,!0,!1,{needInverse:!1,needMergeUndoStackTop:!1,fromUndoRedo:!1})},e.prototype.copy=function(){return new e(this.originRange.clone(),this.updateSelection,this.needCollab,this.fromServer,this.isInputDoc,this.undoOption,this.commandType,this.optAuthor)},e.prototype.buildDelta=function(){return new Me(this.copy())},e}();function Ne(e,t,n,r,o){var i,a,s,c,u;if(t[0].begin()>e.begin()){var d=t[0].begin()-e.begin();r.push({text:o.readText(e.begin(),d)}),n.push(new l.ICE(e.begin(),d))}for(var p=0;p<t.length;p++){var h=o.readText(t[p].begin(),t[p].len),f=l.YU5.getInstance().getFieldStructure(h),g=l.BqD.decodeFieldCode(f.fieldCode);if(g){var v=null===(i=g.instructions)||void 0===i?void 0:i[0],y=null===(a=g.instructions)||void 0===a?void 0:a[1],m=null===(s=g.instructions)||void 0===s?void 0:s[2],b=null===(c=g.instructions)||void 0===c?void 0:c[3],_=null===(u=g.instructions)||void 0===u?void 0:u[4],C={text:f.fieldResult,data:{mentionId:v,uid:m,nick:f.fieldResult,avatar:_,globalPadId:b,mentionType:g.name,mentionUserID:y}};if(r.push(C),p+1<t.length){d=t[p+1].begin()-t[p].end();var S=o.readText(t[p].end(),d);r.push({text:S})}}}e.end()>t[t.length-1].end()&&(d=e.end()-t[t.length-1].end(),S=o.readText(t[t.length-1].end(),d),r.push({text:S}))}!function(e){e.Paste="Paste",e.Insert="Insert"}(Ae||(Ae={}));var Be,Fe,Ue=function(){function e(){}return e.insertParagraph=function(e,t,n,r){var o=new l.ICE(e,1);r.insertText(e,l.IfD.ParagraphReturn),r.setRunProperty(o,l.kkf.getPropertyClass(l.uSS.RunProperty).createPlaceholderRun(t),l.XS7.Insert),!n.isEmpty(n.tKeys.isPlaceholder)&&n.isPlaceholder&&n.delete(n.tKeys.isPlaceholder),r.setParagraphProperty(o,n,l.XS7.Insert)},e.insertText=function(e,t,n,r){var o=new l.ICE(e,t.length);!function(e,t){t.isPlaceholder&&e.split("").every((function(e){return!Object.values(l.IfD).includes(e)}))&&t.delete(t.tKeys.isPlaceholder)}(t,n),r.insertText(e,t),r.setRunProperty(o,n,l.XS7.Insert)},e.replaceText=function(e,t,n,r){this.deleteText(new l.ICE(e,t.length),r),this.insertText(e,n,new(l.kkf.getPropertyClass(l.uSS.RunProperty)),r)},e.deleteText=function(e,t){t.deleteText(e)},e.insertImage=function(e,t,n,r){this.insertText(e,l.IfD.DrawingAnchor,l.kkf.getPropertyClass(l.uSS.RunProperty).createPlaceholderRun(r),n),l.Cf9.addDefaultProperty(t);var o=new l.ICE(e,1);n.setDrawingProperty(o,t,l.XS7.Insert)},e.insertFieldChar=function(e,t,n,r){var o="";switch(n.fldCharType){case l.P1W.begin:o=l.IfD.FieldBegin;break;case l.P1W.separate:o=l.IfD.FieldSeparate;break;case l.P1W.end:o=l.IfD.FieldEnd;break;default:i.Logger.warn("")}if(o){this.insertText(e,o,l.kkf.getPropertyClass(l.uSS.RunProperty).createPlaceholderRun(t),r);var a=new l.ICE(e,1);r.setFieldProperty(a,n,l.XS7.Insert)}},e.insertField=function(t,n,r,o,i,a){void 0===a&&(a=1),this.insertFieldByRange(t,r,o,(function(t){e.insertText(t.currentRange().end(),n,null!=i?i:r.clone(),t)}),a)},e.insertFieldByRange=function(t,n,r,o,i){void 0===i&&(i=1);var a=new(l.kkf.getPropertyClass(l.uSS.FieldCharProperty));a.fldCharType=l.P1W.begin,a.nestingLevel=i,e.insertFieldChar(r.currentRange().end(),l.kkf.getPropertyClass(l.uSS.RunProperty).createPlaceholderRun(n),a,r),e.insertText(r.currentRange().end(),t,n.clone(),r),a.fldCharType=l.P1W.separate,a.nestingLevel=i,e.insertFieldChar(r.currentRange().end(),l.kkf.getPropertyClass(l.uSS.RunProperty).createPlaceholderRun(n),a,r),o(r),a.fldCharType=l.P1W.end,a.nestingLevel=i,e.insertFieldChar(r.currentRange().end(),l.kkf.getPropertyClass(l.uSS.RunProperty).createPlaceholderRun(n),a,r)},e.insertSection=function(e,t,n,r,o){this.insertText(e,l.IfD.SectionBreak,l.kkf.getPropertyClass(l.uSS.RunProperty).createPlaceholderRun(t),o);var i=new l.ICE(e,1);o.setSectionProperty(i,r,l.XS7.Insert),o.setParagraphProperty(i,l.kkf.getPropertyClass(l.uSS.ParagraphProperty).createPlaceholderParagraph(n),l.XS7.Insert)},e.insertTable=function(e,t,n,r){var o=t.isBegin?l.IfD.TableStart:l.IfD.TableEnd;this.insertText(e,o,l.kkf.getPropertyClass(l.uSS.RunProperty).createPlaceholderRun(),n);var i=new l.ICE(e,1);this.setPlaceholderTableCell(e,t.nestingLevel,n),this.setPlaceholderTableRow(e,t.nestingLevel,n),n.setTableProperty(i,t,l.XS7.Insert),n.setParagraphProperty(i,l.kkf.getPropertyClass(l.uSS.ParagraphProperty).createPlaceholderParagraph(r),l.XS7.Insert)},e.insertTableStart=function(e,t,n,r){void 0===n&&(n=new(l.kkf.getPropertyClass(l.uSS.TableProperty))),n.isBegin=!0,this.insertTable(e,n,t,r)},e.insertTableEnd=function(e,t,n,r,o){var i=t.clone();null==o||o(i),i.tblPr.setDefault(i.tblPr.tKeys.isBegin),this.insertTable(e,i,n,r)},e.insertTableRow=function(e,t,n,r){this.insertText(e,l.IfD.TableRowBreak,l.kkf.getPropertyClass(l.uSS.RunProperty).createPlaceholderRun(),n);var o=new l.ICE(e,1);this.setPlaceholderTableCell(e,t.nestingLevel,n),n.setTableRowProperty(o,t,l.XS7.Insert),n.setParagraphProperty(o,l.kkf.getPropertyClass(l.uSS.ParagraphProperty).createPlaceholderParagraph(r),l.XS7.Insert)},e.insertTableCell=function(e,t,n,r){this.insertText(e,l.IfD.TableCellBreak,l.kkf.getPropertyClass(l.uSS.RunProperty).createPlaceholderRun(),n);var o=new l.ICE(e,1);n.setTableCellProperty(o,t,l.XS7.Insert),n.setParagraphProperty(o,l.kkf.getPropertyClass(l.uSS.ParagraphProperty).createPlaceholderParagraph(r),l.XS7.Insert)},e.insertDrawing=function(e,t,n,r){void 0===r&&(r=Ae.Insert),this.insertText(e,l.IfD.DrawingAnchor,l.kkf.getPropertyClass(l.uSS.RunProperty).createPlaceholderRun(),n),r===Ae.Insert&&(null==t?void 0:t.drawingType)===l.HgR.Picture&&(n.setCommandType(S.DocInsertImage),l.Cf9.addDefaultProperty(t));var o=new l.ICE(e,1);n.setDrawingProperty(o,t,l.XS7.Insert)},e.insertEmbeddedObject=function(e,t,n){this.insertText(e,l.IfD.EmbeddedObjectAnchor,l.kkf.getPropertyClass(l.uSS.RunProperty).createPlaceholderRun(),n);var r=new l.ICE(e,1);n.setEmbeddedObjectProperty(r,t,l.XS7.Insert)},e.insertSubStory=function(e,t,n,r,o){var i=t.clone();n===l.IfD.SubStoryBegin?i.isBegin=!0:i.setDefault(i.tKeys.isBegin),this.insertText(e,n,l.kkf.getPropertyClass(l.uSS.RunProperty).createPlaceholderRun(),r);var a=new l.ICE(e,1);r.setParagraphProperty(a,l.kkf.getPropertyClass(l.uSS.ParagraphProperty).createPlaceholderParagraph(),o),r.setSubStoryProperty(a,i,o)},e.insertStory=function(e,t,n){this.insertText(e,l.IfD.StoryBreak,l.kkf.getPropertyClass(l.uSS.RunProperty).createPlaceholderRun(),n);var r=new l.ICE(e,1);n.setStoryProperty(r,t,l.XS7.Insert),n.setParagraphProperty(r,l.kkf.getPropertyClass(l.uSS.ParagraphProperty).createPlaceholderParagraph(),l.XS7.Insert)},e.setParagraphProperty=function(e,t){t.setParagraphProperty(e.range,e.property,e.mode)},e.setStoryProperty=function(e,t){t.setStoryProperty(e.range,e.property,e.mode)},e.setSubStoryProperty=function(e,t){t.setSubStoryProperty(e.range,e.property,e.mode)},e.setRunProperty=function(e,t,n,r){n.setRunProperty(e,t,r)},e.setSectionProperty=function(e,t,n,r){n.setSectionProperty(e,t,r)},e.setDrawingProperty=function(e,t,n,r){n.setDrawingProperty(e,t,r)},e.insertCommentReference=function(e,t,n,r){r.insertCommentRange(n.id,t),this.insertText(e,l.IfD.CommentReference,l.kkf.getPropertyClass(l.uSS.RunProperty).createPlaceholderRun(),r),r.setCommentProperty(new l.ICE(e,1),n,l.XS7.Insert)},e.insertComment=function(e,t,n,r,o){var i=new(l.kkf.getPropertyClass(l.uSS.CommentReferenceProperty));i.id=e.refId,this.insertText(r.end(),l.IfD.CommentReference,l.kkf.getPropertyClass(l.uSS.RunProperty).createPlaceholderRun(),o),o.setCommentProperty(new l.ICE(r.end(),1),i,l.XS7.Insert),o.insertCommentRange(i.id,r);var a=t<r.end()?t:t+1;this.insertCommentStory(e,a,n,o),o.moveTo(r)},e.deleteQuote=function(e,t,n){n.deleteQuoteRange(t,e)},e.insertQuote=function(e,t,n){n.insertQuoteRange(e,t),n.moveTo(e)},e.deletePermissionRange=function(e,t,n){n.deletePermissionRange(t,e)},e.insertPermissionRange=function(e,t,n){n.insertPermissionRange(e,t),n.moveTo(e)},e.insertBookmark=function(e,t,n,r){r.insertBookmarkRange(e,t,n)},e.deleteBookmark=function(e,t,n,r){r.deleteBookmarkRange(e,t,n)},e.appendComment=function(e,t,n,r,o,i){o.setCommentProperty(r,i,l.XS7.Insert),this.insertCommentStory(e,t,n,o)},e.insertCommentStory=function(e,t,n,r){this.insertSubStory(t,e,l.IfD.SubStoryBegin,r,l.XS7.Insert),this.insertCommentContent(n,r),this.insertSubStory(r.currentRange().end(),e,l.IfD.SubStoryEnd,r,l.XS7.Insert)},e.updateCommentStory=function(e,t,n,r){var o=new l.ICE(t,1);r.setSubStoryProperty(o,e,l.XS7.Merge),this.insertCommentContent(n,r);var i=new l.ICE(r.currentRange().end(),1);r.setSubStoryProperty(i,e,l.XS7.Merge)},e.modifyArchiveComment=function(e,t,n){var r=new l.ICE(t.begin(),1);n.setSubStoryProperty(r,e,l.XS7.Merge);var o=new l.ICE(t.end()-1,1);n.setSubStoryProperty(o,e,l.XS7.Merge)},e.insertCommentContent=function(e,t){var n=this;(function(e){var t=[],n=[];try{t=JSON.parse(e)}catch(e){n.push({text:""})}return t.forEach((function(e){var t=e.data,r={};t?r.field={fieldCode:"".concat(t.mentionType," ").concat(t.mentionId," ").concat(t.mentionUserID," ").concat(t.uid," ").concat(t.globalPadId," ").concat(t.avatar),fieldResult:"".concat(e.text)}:r.text=e.text,n.push(r)})),n})(e).forEach((function(e){e.text&&n.insertText(t.currentRange().end(),e.text,new(l.kkf.getPropertyClass(l.uSS.RunProperty)),t),e.field&&n.insertField(e.field.fieldCode,e.field.fieldResult,new(l.kkf.getPropertyClass(l.uSS.RunProperty)),t)})),this.insertParagraph(t.currentRange().end(),new(l.kkf.getPropertyClass(l.uSS.RunProperty)),new(l.kkf.getPropertyClass(l.uSS.ParagraphProperty)),t)},e.updateCommentRef=function(e,t,n){n.setCommentProperty(t,e,l.XS7.Merge)},e.deleteComment=function(e,t,n){n.deleteCommentRange(t,e)},e.setTableProperty=function(e,t){t.setTableProperty(e.range,e.property,e.mode)},e.setTableCellProperty=function(e,t){t.setTableCellProperty(e.range,e.property,e.mode)},e.setTableRowProperty=function(e,t){t.setTableRowProperty(e.range,e.property,e.mode)},e.setSettingProperty=function(e,t,n,r){void 0===r&&(r=!0),n.setSettingProperty(e,t,r)},e.insertNormalTextVaild=function(e){if(e.indexOf(l.IfD.SectionBreak)>=0||e.indexOf(l.IfD.ParagraphReturn)>=0)throw i.Logger.error("insertNormalText shouldnt has EndSection or EndParagraph, please check:".concat(JSON.stringify(e))),Error("insertNormalText shouldnt has EndSection or EndParagraph, please check:".concat(JSON.stringify(e)))},e.createEmptyDoc=function(t){var n=new(l.kkf.getPropertyClass(l.uSS.StoryProperty));n.storyType=l.AHI.textboxContent,e.insertStory(0,n,t);var r=new(l.kkf.getPropertyClass(l.uSS.StoryProperty));r.storyType=l.AHI.commentContent,e.insertStory(0,r,t);var o=new(l.kkf.getPropertyClass(l.uSS.StoryProperty));o.storyType=l.AHI.endnoteContent,e.insertStory(0,o,t);var i=new(l.kkf.getPropertyClass(l.uSS.StoryProperty));i.storyType=l.AHI.footnoteContent,e.insertStory(0,i,t);var a=new(l.kkf.getPropertyClass(l.uSS.StoryProperty));a.storyType=l.AHI.footerContent,e.insertStory(0,a,t);var s=new(l.kkf.getPropertyClass(l.uSS.StoryProperty));s.storyType=l.AHI.headerContent,e.insertStory(0,s,t);var c=new(l.kkf.getPropertyClass(l.uSS.StoryProperty));c.storyType=l.AHI.mainDocument,e.insertStory(0,c,t),e.insertSection(0,l.kkf.getPropertyClass(l.uSS.RunProperty).createPlaceholderRun(),new(l.kkf.getPropertyClass(l.uSS.ParagraphProperty)),new(l.kkf.getPropertyClass(l.uSS.SectionProperty)),t),e.insertParagraph(0,l.kkf.getPropertyClass(l.uSS.RunProperty).createPlaceholderRun(),new(l.kkf.getPropertyClass(l.uSS.ParagraphProperty)),t)},e.getInsertParagraphOp=function(e,t){var n=[],o={text:l.IfD.ParagraphReturn,range:new l.ICE(e,0)},i=ke.createLocalOperation(o,r.InsertText),a={property:l.kkf.getPropertyClass(l.uSS.RunProperty).createPlaceholderRun(),range:new l.ICE(e,1),mode:l.XS7.Insert},s=ke.createLocalOperation(a,r.ModifyRunProp),c={property:t,range:new l.ICE(e,1),mode:l.XS7.Insert},u=ke.createLocalOperation(c,r.ModifyParagraphProp);return n.push(i),n.push(s),n.push(u),n},e.getDeleteOp=function(e){var t={range:e};return ke.createLocalOperation(t,r.DeleteText)},e.setPlaceholderTableCell=function(e,t,n){var r=new(l.kkf.getPropertyClass(l.uSS.TableCellProperty));r.nestingLevel=t,r.isPlaceholder=!0,this.setTableCellProperty({range:new l.ICE(e,1),property:r,mode:l.XS7.Insert},n)},e.setPlaceholderTableRow=function(e,t,n){var r=new(l.kkf.getPropertyClass(l.uSS.TableRowProperty));r.nestingLevel=t,r.isPlaceholder=!0,this.setTableRowProperty({range:new l.ICE(e,1),property:r,mode:l.XS7.Insert},n)},e}(),He=function(){function e(){}return e.appendStyle=function(e,t,n,r){if(void 0===r&&(r=!1),!this.styleCacheMap.get(t)){var o=new(l.kkf.getPropertyClass(l.uSS.StylesProperty)),i=e.getDataManager().getStyleSheetManager(),a=r?i.getMergedStyleSet(t):i.getStylePropertyFromId(t,!0);o.style.appendProperty(a,"styleId"),a&&(this.styleCacheMap.set(t,a),Ue.setSettingProperty(o,l.LK6.styles,n))}},e.clearStyleCache=function(){this.styleCacheMap.clear()},e.hasSetNumbId=function(e){return this.numIdCacheMap.has(e)},e.cacheNumId=function(e,t){this.numIdCacheMap.set(e,t)},e.getNewNumId=function(e){return this.numIdCacheMap.get(e)},e.clearNumIdCache=function(){this.numIdCacheMap.clear()},e.styleCacheMap=new Map,e.numIdCacheMap=new Map,e}(),je=((Be={})[l.IfD.TableCellBreak]=function(e,t,n,r,o,i,a,s){var c=e.getDataStream(),u=t.getRange(l.kbS.Span,!0),d=l.vCY.findPlaceholderCharProperty(c,u.begin());if(!(d instanceof l.kkf.getPropertyClass(l.uSS.TableCellProperty)))throw Error("data collector cellInfo is null! gcp: ".concat(i));(null==s?void 0:s.nestingLevelOffset)&&(d.nestingLevel-=s.nestingLevelOffset),Ue.insertTableCell(i,d,n)},Be[l.IfD.TableRowBreak]=function(e,t,n,r,o,i,a,s){var c=e.getDataStream(),u=t.getRange(l.kbS.Span,!0),d=l.vCY.findPlaceholderCharProperty(c,u.begin());if(!(d instanceof l.kkf.getPropertyClass(l.uSS.TableRowProperty)))throw Error("data collector rowinfo is null! gcp: ".concat(i));(null==s?void 0:s.nestingLevelOffset)&&(d.nestingLevel-=s.nestingLevelOffset),Ue.insertTableRow(i,d,n)},Be[l.IfD.TableStart]=function(e,t,n,r,o,i,a,s){var c=e.getDataStream(),u=t.getRange(l.kbS.Span,!0),d=l.vCY.findPlaceholderCharProperty(c,u.begin());if(!(d instanceof l.kkf.getPropertyClass(l.uSS.TableProperty)))throw Error("data collector tableinfo is null! gcp: ".concat(i));(null==s?void 0:s.nestingLevelOffset)&&(d.nestingLevel-=s.nestingLevelOffset),Ue.insertTableStart(n.currentRange().end(),n,d)},Be[l.IfD.TableEnd]=function(e,t,n,r,o,a,s,c){var u=e.getDataStream(),d=t.getRange(l.kbS.Span,!0),p=l.vCY.findPlaceholderCharProperty(u,d.begin());if(!(p instanceof l.kkf.getPropertyClass(l.uSS.TableProperty)))throw Error("data collector tableinfo is null! gcp: ".concat(a));(null==c?void 0:c.nestingLevelOffset)&&(p.nestingLevel-=c.nestingLevelOffset);var h=p.clone();h.isBegin=!1,h.tblId=i.StringUtil.generateRandomId();var f=h.tblPr.tblStyle,g=e.getDataManager().getStyleSheetManager(),v=g.getStylePropertyFromId(f);f&&v&&!g.isBuiltinStyle(null==v?void 0:v.name)&&He.appendStyle(e,f,n,!0),Ue.insertTableEnd(n.currentRange().end(),p,n,void 0,(function(e){e.isBegin=!1,e.tblId=i.StringUtil.generateRandomId()}))},Be[l.IfD.SectionBreak]=function(e,t,n,r,o,i){var a=t.getSectProp();if(!a)throw Error("data collector section is null! gcp: ".concat(i));var s=l.kkf.getPropertyClass(l.uSS.ParagraphProperty).createPlaceholderParagraph();Ue.insertSection(i,r,s,a,n)},Be[l.IfD.ParagraphReturn]=function(e,t,n,r,o,i){var a=e.getDataManager(),s=t.getParaProp();if(!s)throw Error("data collector paragraph is null! gcp: ".concat(i));if(!s.numPr.isEmpty(l.kkf.getPropertyClass(l.uSS.CTNumPr).tKeys.ilvl)&&!s.numPr.isEmpty(l.kkf.getPropertyClass(l.uSS.CTNumPr).tKeys.numId)&&a)if(He.hasSetNumbId(s.numPr.numId))s.numPr.numId=He.getNewNumId(s.numPr.numId);else{var c=l.g85.createId(),u=l.g85.getAbstractNumType(a.getNumberingManager().getNumberingProperty(!0),s.numPr.numId),d=new(l.kkf.getPropertyClass(l.uSS.NumberingProperty));if(u){var p=new(l.kkf.getPropertyClass(l.uSS.CTNum)),h=new(l.kkf.getPropertyClass(l.uSS.CTAbstractNum));h.abstractNumId=l.g85.createId(),h.lvl=u.lvl.clone(),p.abstractNumId=h.abstractNumId,p.numId=c,d.abstractNum.appendProperty(h,"abstractNumId"),d.num.appendProperty(p,"numId")}Ue.setSettingProperty(d,l.LK6.numbering,n),He.cacheNumId(s.numPr.numId,c),s.numPr.numId=c}!function(e,t,n){var r=e.getDataManager().getStyleSheetManager(),o=r.getStylePropertyFromId(t.pStyle);o&&(r.isBuiltinStyle(null==o?void 0:o.name)||He.appendStyle(e,t.pStyle,n,!0))}(e,s,n),Ue.insertParagraph(i,r,s,n)},Be[l.IfD.DrawingAnchor]=function(e,t,n,r,o,i){var a=e.getDataStream(),s=l.vCY.findPlaceholderCharProperty(a,i);if(!(s instanceof l.kkf.getPropertyClass(l.uSS.DrawingProperty)))throw Error("data collector drawing is null! gcp: ".concat(i));Ue.insertDrawing(i,s,n)},Be[l.IfD.SubStoryBegin]=function(e,t,n,r,o,i){var a=e.getDataStream(),s=t.getRange(l.kbS.Span,!0),c=l.vCY.findPlaceholderCharProperty(a,s.begin());if(!(c instanceof l.kkf.getPropertyClass(l.uSS.CTSubStoryPr)))throw Error("data collector SuStoryStart is null! gcp: ".concat(i));Ue.insertSubStory(i,c,l.IfD.SubStoryBegin,n,l.XS7.Insert)},Be[l.IfD.SubStoryEnd]=function(e,t,n,r,o,i){var a=e.getDataStream(),s=t.getRange(l.kbS.Span,!0),c=l.vCY.findPlaceholderCharProperty(a,s.begin());if(!(c instanceof l.kkf.getPropertyClass(l.uSS.CTSubStoryPr)))throw Error("data collector SubStoryEnd is null! gcp: ".concat(i));Ue.insertSubStory(i,c,l.IfD.SubStoryEnd,n,l.XS7.Insert)},Be),Ge=function(){function e(){}return e.collectDataToDelta=function(e,t,n,r,o,i){void 0===r&&(r=!0),void 0===o&&(o=!1);var a=e.getDataStream().createDataIterator(n),s=t.currentRange().begin(),c=this.recursiveCollectDataToDelta(e,a,t,n,s,r,o,i);return this.collectBookmarkRangeInfos(e,t,n),c},e.collectDataForCopy=function(e,t,n,r,o){var i=this;void 0===r&&(r=!0),void 0===o&&(o=!1);var a=e.getDataStream(),s=a.getTableStream().getTableInfo(n.end()-1),c=a.getTableStream().getCellInfo(n.begin(),null==s?void 0:s.property.nestingLevel),u={nestingLevelOffset:s?s.property.nestingLevel-1:0};if(s&&c){if(c.range.length()<=n.length()){var d=[],p=s.range.intersectRange(n);Ue.insertTableStart(t.currentRange().end(),t);var h=a.getTableStream().createMergedMapping(p),f=0,g=0;ue.splitCellRange(a.getTableStream(),p,(function(n,c){if(c){var p=c.cell,v=p.property,y=p.contentRange,m=l.Rh7.getWidth(v.tcW),b=new(l.kkf.getPropertyClass(l.uSS.TableCellProperty))(v),_=v.vMerge,C=_===l.m7Q.continue&&!h.getMainCell(f,g),S=_===l.m7Q.restart&&0===h.getMergedCount(f,g);if((C||S)&&b.setDefault(l.kkf.getPropertyClass(l.uSS.TableCellProperty).tKeys.vMerge),d=d.concat(i.recursiveCollectDataToDelta(e,a.createDataIterator(y),t,y,t.currentRange().end(),r,o,u)),g+=m,b.nestingLevel=1,Ue.insertTableCell(t.currentRange().end(),b,t),c.isLastInRow){var w=a.getTableStream().getRowInfo(n.begin(),s.property.nestingLevel),E=new(l.kkf.getPropertyClass(l.uSS.TableRowProperty))(null==w?void 0:w.property);E.nestingLevel=1,Ue.insertTableRow(t.currentRange().end(),E,t),f+=1,g=0}}else d=d.concat(i.recursiveCollectDataToDelta(e,a.createDataIterator(n),t,n,t.currentRange().end(),r,o,u));return!0}));var v=new(l.kkf.getPropertyClass(l.uSS.TableProperty))(s.property);v.nestingLevel=1;var y=s.property.tblPr.tblStyle,m=e.getDataManager().getStyleSheetManager(),b=m.getStylePropertyFromId(y);return y&&b&&!m.isBuiltinStyle(null==b?void 0:b.name)&&He.appendStyle(e,y,t,!0),Ue.insertTableEnd(t.currentRange().end(),v,t),He.clearStyleCache(),d}return this.collectDataToDelta(e,t,new l.ICE(n.begin(),Math.min(c.range.end()-1,n.end())-n.begin()),r,o,{nestingLevelOffset:s.property.nestingLevel})}return this.collectDataToDelta(e,t,n,r,o,u)},e.collectDataToOps=function(e,t,n){void 0===n&&(n=!0);var r=Le.createLocalDeltaOption(l.ICE.emptyRange()).buildDelta();return r.moveTo(new l.ICE(t.begin(),0)),this.collectDataToDelta(e,r,t,n),r.operations},e.recursiveCollectDataToDelta=function(e,t,n,r,o,i,a,s){var c,u;void 0===i&&(i=!0),void 0===a&&(a=!1);var d=e.getDataStream(),p=[],h=d.getTextStream();do{var f=t.getSpanProp(!0),g=t.getRange(l.kbS.Span,!0);if(g.isEmpty())break;var v=h.readText(g.begin(),g.length()),y=l.vCY.findPlaceholderCharProperty(d,g.begin());if(y instanceof l.kkf.getPropertyClass(l.uSS.CommentReferenceProperty)){if(!a)continue;var m=n.currentRange().end(),b=y.id;if(!(I=e.getDataStream().getAnnotationStream().getCommentRangeInfoFromId(b)))continue;var _=(null!==(c=I.commentRange)&&void 0!==c?c:I.annotationRange).intersectRange(r),C=new l.ICE(m-_.len,_.len);Ue.insertCommentReference(m,C,y,n);var S=d.getStoryStream().createSubStoryIterator({storyType:l.AHI.commentContent});do{var w=S.getCloneProperty();if(w&&w.refId===b){var E=new(l.kkf.getPropertyClass(l.uSS.StoryProperty))({storyType:l.AHI.commentContent});p=this.collectSubStoryDataToDelta(e,S.getRange(),w,E,p,i,a,s)}}while(S.hasNext()&&S.next())}else if(i&&y instanceof l.kkf.getPropertyClass(l.uSS.DrawingProperty)){m=n.currentRange().end(),Ue.insertDrawing(m,y,n,Ae.Paste);var x=d.getStoryStream().getSubStoryInfoFromId(y.drawing.graphic.graphicData.wsp.txbx.contentId,l.AHI.textboxContent);if(x){var T=x.range,R=x.subStoryProp;E=x.storyProp,p=this.collectSubStoryDataToDelta(e,T,R,E,p,i,a,s)}var I,P=l.vCY.findPlaceholderCharProperty(d,g.begin()+1);P instanceof l.kkf.getPropertyClass(l.uSS.CommentReferenceProperty)&&1===r.len&&1===(null===(u=null==(I=e.getDataStream().getAnnotationStream().getCommentRangeInfoFromId(P.id))?void 0:I.commentRange)||void 0===u?void 0:u.len)&&t.rangeExpand(1)}else if(y instanceof l.kkf.getPropertyClass(l.uSS.EmbeddedObjectProperty))m=n.currentRange().end(),Ue.insertEmbeddedObject(m,y,n);else if(y instanceof l.kkf.getPropertyClass(l.uSS.MathProperty)){var O=d.getMathStream().getMathInfo(g.begin(),1);O&&t.seek(O.range.end()-1)}else if(y instanceof l.kkf.getPropertyClass(l.uSS.MathObjectProperty)){var k=d.getMathStream().getMathObjectInfo(g.begin(),1);k&&t.seek(k.range.end()-1)}else if(y instanceof l.kkf.getPropertyClass(l.uSS.SdtProperty)){var D=d.getSdtStream().getSdtInfo(g.begin(),1);D&&t.seek(D.range.end()-1)}else{if(y instanceof l.kkf.getPropertyClass(l.uSS.FootnoteReferenceProperty)||y instanceof l.kkf.getPropertyClass(l.uSS.EndnoteReferenceProperty)||y instanceof l.kkf.getPropertyClass(l.uSS.PictureProperty))continue;m=n.currentRange().end(),this.collectSpanPropertyToDelta(e,t,n,f,v,m,p,s)}}while(t.next(l.kbS.Span));return He.clearStyleCache(),He.clearNumIdCache(),p},e.collectSubStoryDataToDelta=function(e,t,n,r,o,i,a,s){void 0===i&&(i=!0),void 0===a&&(a=!1);var c=e.getDataStream().createDataIterator(t),u=Le.createLocalDeltaOption(l.ICE.emptyRange()).buildDelta();u.setCommandType(S.DocCopy);var d={storyId:n.id,delta:u,storyType:r.storyType};return o.concat(d,this.recursiveCollectDataToDelta(e,c,u,t,0,i,a,s))},e.collectSpanPropertyToDelta=function(e,t,n,r,o,a,s,c){var l=e.getDataStream();try{if(je[o])je[o].apply(void 0,[e,t,n,r,o,a,s,c]);else if(le.isField(o)){var u=l.getFieldStream().getNestingFieldInfo(t.getRange().begin()),d=l.getFieldStream().createFieldIterator({isRawIter:!0,nestingLevel:null==u?void 0:u.nestingLevel});d.seek(t.getRange().begin());var p=d.getProperty();if(!p)throw Error("data collector field is null!");Ue.insertFieldChar(a,r,p,n)}else r&&(r.rStyle&&He.appendStyle(e,r.rStyle,n,!0),this.insertTextWithOutPlaceholder(a,o,r,n))}catch(e){i.Logger.error("span collect error: ",e),this.insertTextWithOutPlaceholder(a,o,r,n)}},e.collectBookmarkRangeInfos=function(e,t,n){e.getDataStream().getAnnotationStream().collectBookmarkRangeInfoFromRange(n).filter((function(e){return n.contains(e.annotationRange)})).forEach((function(e){var r=t.currentRange();Ue.insertBookmark(new l.ICE(e.annotationRange.begin()-n.begin(),e.annotationRange.length()),e.rangeProp.id,e.rangeProp.name,t),t.moveTo(r)}))},e.getAfterGCPFromAtext=function(e){try{return JSON.parse(e).atext.text.length}catch(e){return 0}},e.insertTextWithOutPlaceholder=function(e,t,n,r){n.has(n.tKeys.isPlaceholder)&&!Object.values(l.ghV).includes(t[t.length-1].charCodeAt(0))&&(n=n.clone()).delete(n.tKeys.isPlaceholder),Ue.insertText(e,t,n,r)},e.stylesCache=new Map,e}();!function(e){e.BeforeApplyDelta="BeforeApplyDelta",e.ModelChange="ModelChange",e.SyncModelChange="SyncModelChange",e.CoreSelectionChange="CoreSelectionChange",e.CollabToServer="CollabToServer",e.ListModelShouldChange="ListModelChange",e.InsertContainer="InsertContainer",e.DeleteContainer="DeleteContainer",e.InsertInsideField="InsertInsideField",e.DeleteField="DeleteField",e.DeleteFieldContainer="DeleteFieldContainer",e.ModifyContainer="ModifyContainer",e.CusorPropChange="CusorPropChange",e.InsertTablePlaceHolder="InsertTablePlaceHolder",e.GlobalPropChange="GlobalPropChange",e.NewDocument="new_document",e.EfficientModelChange="EfficientModelChange",e.ApplyDeltaCheck="ApplyDeltaCheck",e.DeleteComment="DeleteComment",e.DataWillDelete="DataWillDelete",e.DataFieldDelete="DataFieldDelete",e.DataFieldInsert="DataFieldInsert",e.DataInsertCommentRange="DataInsertCommentRange",e.UpdataTitle="UpdataTitle",e.NotificationAtPushMessage="NotificationAtPushMessage",e.DataInsertPermissionRange="DataInsertPermissionRange"}(Fe||(Fe={}));var Ve,We,ze,Ke,qe=function(){function e(e){this.dirtyRanges=e}return Object.defineProperty(e.prototype,"first",{get:function(){return this.dirtyRanges.length>0?this.dirtyRanges[0]:l.ICE.invalidRange()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"last",{get:function(){var e=this.dirtyRanges.length;return e>0?this.dirtyRanges[e-1]:l.ICE.invalidRange()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){return this.dirtyRanges},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"unionValue",{get:function(){var e;return this.dirtyRanges.forEach((function(t){e=e?e.unionRange(t):t.clone()})),e||(e=l.ICE.invalidRange()),e},enumerable:!1,configurable:!0}),e.prototype.contains=function(e){return 0!==this.dirtyRanges.length&&this.dirtyRanges.some((function(t){return t.contains(e)}))},e.prototype.isInvalid=function(){return 0===this.dirtyRanges.length||this.dirtyRanges.every((function(e){return!e.isValid()}))},e.prototype.intersect=function(e){return 0!==this.dirtyRanges.length&&this.dirtyRanges.some((function(t){return t.intersect(e)}))},e.prototype.toString=function(){var e="";return this.dirtyRanges.forEach((function(t){e+="[".concat(t.begin(),",").concat(t.end(),")")})),e},e.invalidRange=function(){return new e([])},e}(),Ye=function(e){function t(t,n,r){var o=e.call(this,Fe.ModelChange)||this;return o.changeData=t,o.fromServer=n,o.fullReflow=r,o}return(0,o.__extends)(t,e),t}(i.Notification),Qe=function(e){function t(t,n){var r=e.call(this,Fe.SyncModelChange)||this;return r.changeData=t,r.fromServer=n,r}return(0,o.__extends)(t,e),t}(i.Notification),Ze=function(e){function t(t,n){var r=e.call(this,Fe.EfficientModelChange)||this;return r.changeData=t,r.fromServer=n,r}return(0,o.__extends)(t,e),t}(i.Notification);!function(e){e[e.None=1]="None",e[e.Near=2]="Near",e[e.Top=3]="Top",e[e.NearTop=4]="NearTop",e[e.Center=5]="Center"}(Ve||(Ve={})),function(e){e[e.Show=1]="Show",e[e.Hide=2]="Hide",e[e.Keep=3]="Keep"}(We||(We={})),function(e){e[e.Show=1]="Show",e[e.Hide=2]="Hide",e[e.Keep=3]="Keep"}(ze||(ze={})),function(e){e.SEARCH="search"}(Ke||(Ke={}));var Xe,Je=function(e){function t(t,n,r){var o=e.call(this,Fe.CoreSelectionChange)||this;return o.range=t,o.cellRange=n,o.option=r,o}return(0,o.__extends)(t,e),t}(i.Notification),$e=function(e){function t(t){var n=e.call(this,Fe.ListModelShouldChange)||this;return n.listMarkerSpanProperty=t,n}return(0,o.__extends)(t,e),t}(i.Notification),et=function(e){function t(t,n){var r=e.call(this,Fe.CollabToServer)||this;return r.handled=t,r.delta=n,r}return(0,o.__extends)(t,e),t}(i.Notification),tt=function(e){function t(t,n){var r=e.call(this,Fe.InsertContainer)||this;return r.property=t,r.fromServer=n,r}return(0,o.__extends)(t,e),t}(i.Notification),nt=(function(e){function t(t,n){var r=e.call(this,Fe.InsertInsideField)||this;return r.drawingList=t,r.fromServer=n,r}(0,o.__extends)(t,e)}(i.Notification),function(e){function t(t,n){var r=e.call(this,Fe.DeleteContainer)||this;return r.drawingList=t,r.fromServer=n,r}return(0,o.__extends)(t,e),t}(i.Notification)),rt=function(e){function t(t,n){var r=e.call(this,Fe.DeleteFieldContainer)||this;return r.anchorIds=t,r.fieldCodes=n,r}return(0,o.__extends)(t,e),t}(i.Notification),ot=function(e){function t(t,n){var r=e.call(this,Fe.ModifyContainer)||this;return r.property=t,r.fromServer=n,r}return(0,o.__extends)(t,e),t}(i.Notification),it=function(e){function t(){return e.call(this,Fe.CusorPropChange)||this}return(0,o.__extends)(t,e),t}(i.Notification),at=function(e){function t(){return e.call(this,Fe.GlobalPropChange)||this}return(0,o.__extends)(t,e),t}(i.Notification),st=(function(e){function t(){return e.call(this,Fe.NewDocument)||this}(0,o.__extends)(t,e)}(i.Notification),function(e){function t(t){var n=e.call(this,Fe.ApplyDeltaCheck)||this;return n.delta=t,n}return(0,o.__extends)(t,e),t}(i.Notification)),ct=function(e){function t(t){var n=e.call(this,Fe.DeleteComment)||this;return n.properties=t,n}return(0,o.__extends)(t,e),t}(i.Notification),lt=(function(e){function t(t){var n=e.call(this,Fe.DataWillDelete)||this;return n.range=t,n}(0,o.__extends)(t,e)}(i.Notification),function(e){function t(t){var n=e.call(this,Fe.BeforeApplyDelta)||this;return n.fromServer=t,n.fromServer=t,n}return(0,o.__extends)(t,e),t}(i.Notification)),ut=function(e){function t(t,n){var r=e.call(this,Fe.DataFieldDelete)||this;return r.fieldCodes=t,r.fromServer=n,r}return(0,o.__extends)(t,e),t}(i.Notification),dt=function(e){function t(t,n,r,o){var i=e.call(this,Fe.DataFieldInsert)||this;return i.fieldCodes=t,i.ranges=n,i.fieldRanges=r,i.fromServer=o,i}return(0,o.__extends)(t,e),t}(i.Notification),pt=function(e){function t(t){var n=e.call(this,Fe.DataInsertCommentRange)||this;return n.property=t,n}return(0,o.__extends)(t,e),t}(i.Notification),ht=(function(e){function t(t){var n=e.call(this,Fe.NotificationAtPushMessage)||this;return n.needPushMessageStatus=t,n}(0,o.__extends)(t,e)}(i.Notification),function(e){function t(t){var n=e.call(this,Fe.DataInsertPermissionRange)||this;return n.property=t,n}return(0,o.__extends)(t,e),t}(i.Notification));!function(e){e.FEATURE_LOADED="feature_loaded"}(Xe||(Xe={}));var ft=function(e){function t(){return e.call(this,Xe.FEATURE_LOADED)||this}return(0,o.__extends)(t,e),t}(i.Notification),gt=function(){function e(){}return e.deserialize=function(e){var t,n=this,r=e;(Array.isArray(e)&&(null===(t=e[0])||void 0===t?void 0:t.ty)||(null==e?void 0:e.ty))&&(r=g.hV.deserialize(e));var o=l.ymk.createTempDataEngine();return Array.isArray(r)?r.forEach((function(e){n.applyMutation(o,e)})):this.applyMutation(o,r),o},e.applyMutation=function(e,t){switch(t.type){case g.x1.insert:this.applyInsertMutation(e.getDataStream(),t);break;case g.x1.delete:this.applyDeleteMutation(e.getDataStream(),t);break;case g.x1.modify:this.applyModifyMutation(e.getDataStream(),t);break;case g.x1.setting:this.applySettingMutation(e.getDataManager(),t);break;case g.x1.insertRange:this.applyInsertRangeMutation(e.getDataStream(),t);break;case g.x1.deleteRange:this.applyDeleteRangeMutation(e.getDataStream(),t);break;default:i.Logger.warn("ModelDeserialize: mutation")}return null},e.applyInsertMutation=function(e,t){e.insertText(t.beginIndex,t.text.length,t.text)},e.applyDeleteMutation=function(e,t){e.deleteText(t.beginIndex,t.endIndex-t.beginIndex)},e.applyModifyMutation=function(e,t){var n=this.getApplyModifyMutationMap(e).get(t.modifyType);n&&n.bind(e)(t.beginIndex,t.endIndex-t.beginIndex,l.vCY.propUpdateMode(t.modifyMode),l.vCY.deserialize(t.property),!1)},e.getApplyModifyMutationMap=function(e){return this.applyModifyMutationMap||(this.applyModifyMutationMap=new Map([[l.LK6.run,e.setRunProp],[l.LK6.paragraph,e.setParagraphProp],[l.LK6.section,e.setSectionProp],[l.LK6.headerContent,e.setSubStoryProp],[l.LK6.footerContent,e.setSubStoryProp],[l.LK6.footnoteContent,e.setSubStoryProp],[l.LK6.endnoteContent,e.setSubStoryProp],[l.LK6.commentContent,e.setSubStoryProp],[l.LK6.textboxContent,e.setSubStoryProp],[l.LK6.story,e.setStoryProp],[l.LK6.field,e.setFieldProp],[l.LK6.commentRef,e.setCommentProp],[l.LK6.drawing,e.setDrawingProp],[l.LK6.picture,e.setPictureProp],[l.LK6.embeddedObject,e.setEmbeddedObjectProp],[l.LK6.footnoteRef,e.setFootnoteProp],[l.LK6.endnoteRef,e.setEndnoteProp],[l.LK6.table,e.setTableProp],[l.LK6.tableRow,e.setTableRowProp],[l.LK6.tableCell,e.setTableCellProp],[l.LK6.math,e.setMathProp],[l.LK6.mathObject,e.setMathObjectProp],[l.LK6.mathRun,e.setMathRunProp],[l.LK6.sdt,e.setSdtProp]])),this.applyModifyMutationMap},e.applySettingMutation=function(e,t){var n=this.getApplySettingMutationMap(e).get(t.settingType);n&&n.bind(e)(l.vCY.deserialize(t.property))},e.getApplySettingMutationMap=function(e){return this.applySettingMutationMap||(this.applySettingMutationMap=new Map([[l.LK6.settings,e.setDocumentSettings],[l.LK6.webSettings,e.setWebSettings],[l.LK6.background,e.setDocBackgroundProperty],[l.LK6.styles,e.setStyleSheet],[l.LK6.numbering,e.setNumberingProperty],[l.LK6.fonts,e.setFontTable],[l.LK6.themes,e.setThemesProperty]])),this.applySettingMutationMap},e.applyInsertRangeMutation=function(e,t){var n=this.getApplyInsertRangeMutationMap(e).get(t.rangeType);n&&n.bind(e)(t.beginIndex,t.endIndex-t.beginIndex,l.vCY.deserialize(t.property))},e.getApplyInsertRangeMutationMap=function(e){return this.applyInsertRangeMutationMap||(this.applyInsertRangeMutationMap=new Map([[l.LK6.commentRange,e.insertCommentRange],[l.LK6.bookmarkRange,e.insertBookmarkRange],[l.LK6.permissionRange,e.insertPermissionRange],[l.LK6.revisionRange,e.insertRevisionRange],[l.LK6.quoteRange,e.insertQuoteRange]])),this.applyInsertRangeMutationMap},e.applyDeleteRangeMutation=function(e,t){var n=this.getApplyDeleteRangeMutationMap(e).get(t.rangeType);n&&n.bind(e)(t.id)},e.getApplyDeleteRangeMutationMap=function(e){return this.applyDeleteRangeMutationMap||(this.applyDeleteRangeMutationMap=new Map([[l.LK6.commentRange,e.deleteCommentRange],[l.LK6.bookmarkRange,e.deleteBookmarkRange],[l.LK6.permissionRange,e.deletePermissionRange],[l.LK6.revisionRange,e.deleteRevisionRange],[l.LK6.quoteRange,e.deleteQuoteRange]])),this.applyDeleteRangeMutationMap},e}(),vt=function(){function e(){}return e.registerDynamic=function(e,t){this.loaders[e]||(this.loaders[e]=[]),this.loaders[e].push(t)},e.asyncLoad=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,o.__awaiter)(this,void 0,void 0,(function(){var t,n=this;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:return t=e.map((function(e){return(0,o.__awaiter)(n,void 0,void 0,(function(){var t;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return(t=this.loaders[e])?[4,Promise.all(t.map((function(e){return e()})))]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))})),[4,Promise.all(t)];case 1:return r.sent(),[2]}}))}))},e.syncLoad=function(e,t){this.modules[e]||(this.modules[e]={});var n=t();this.modules[e]=(0,o.__assign)((0,o.__assign)({},this.modules[e]),n)},e.instantiate=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=this.get(e,t);if(i&&"function"==typeof i)return new(i.bind.apply(i,(0,o.__spreadArray)([void 0],(0,o.__read)(n),!1)))},e.get=function(e,t){var n,r=null===(n=this.modules[e])||void 0===n?void 0:n[t];if(r)return r;i.Logger.error("[Dynamic] Cannot get unloaded module for condition=".concat(e,", id=").concat(t.toString()))},e.loaders={},e.modules={},e}(),yt=n(95303),mt="WORD_COUNT",bt={wordCount:0,wordCountNoPunctuation:0,charactersNumber:0,charactersNumberNoSpaces:0},_t=["addonHina","location","audio"];function Ct(e){var t=e.dataEngine,n=e.textStream,r=e.text,o=e.startGcp,i={text:r,addSpaceLength:0};if(!r.includes("\b"))return i;var a="",s=l.vCY.findPlaceholderCharProperty(t.getDataStream(),o);if(s instanceof l.kkf.getPropertyClass(l.uSS.DrawingProperty)&&s.hasContentId()){var c=t.getDataStream().getStoryStream().getSubStoryInfoFromId(s.contentId),u=null==c?void 0:c.contentRange;u&&(i.addSpaceLength+=2,a=" ".concat(n.readText(u.gcpBegin,u.len)," "))}return i.text=r.replace(/[\b]/g,a),i}var St=function(){try{return new RegExp("[](.*?)[]|[]","ug")}catch(e){return i.Logger.error("[COUNT_WORD_UTIL] field result regex error",e),null}}();function wt(e){var t=l.BqD.getAllField(e),n=e;return null==t||t.map((function(e){_t.some((function(t){return e.includes(t)}))&&(n=n.replace(e,""))})),St?n.replace(St,""):n}var Et=function(){try{return new RegExp("[]","ug")}catch(e){return i.Logger.error("[COUNT_WORD_UTIL] comment regex error",e),null}}(),xt=(function(){try{new RegExp("[\0]","ug")}catch(e){return i.Logger.error("[COUNT_WORD_UTIL] comment regex error",e),null}}(),new RegExp("(".concat(l.IfD.TableStart,"|").concat(l.IfD.TableEnd,"|").concat(l.IfD.TableRowBreak,"|").concat(l.IfD.TableCellBreak,")+"),"g"));function Tt(e){return e.replace(xt,"")}function Rt(e){return Et?e.replace(Et,""):e}var It=/(\r|\n)+/g,Pt=function(){try{return new RegExp("([(\0-)|('\")]+|+||\\p{So}|||)+","ug")}catch(e){return i.Logger.error("[COUNT_WORD_UTIL] word regex error",e),new RegExp("[(\0-)|('\")]+","g")}}(),Ot=function(){try{return new RegExp("([\\p{Zs}\\t\r\n\\s]+)","ug")}catch(e){return i.Logger.error("[COUNT_WORD_UTIL] filter spaces regex error",e),new RegExp("([\\t\r\n\\s]+)","g")}}(),kt=function(){try{return new RegExp("\\p{P}","ug")}catch(e){return i.Logger.error("[COUNT_WORD_UTIL] punctuations regex error",e),""}}();function Dt(e){var t,n;if(!e.replace(It,"").length)return bt;var r=null!==(n=null===(t=e.match(It))||void 0===t?void 0:t.length)&&void 0!==n?n:0,o=e.replace(It," "),i=o.replace(/[]/g," ").replace(Ot,""),a=i.replace(Pt,"").replace(//g,""),s=new yt.UnicodeString(a).getGraphemeCount(),c=i.replace(kt,"").replace(Pt,"").replace(//g,""),l=new yt.UnicodeString(c).getGraphemeCount(),u=o.replace(Ot,"");return{wordCount:s,wordCountNoPunctuation:l,charactersNumber:new yt.UnicodeString(o).getGraphemeCount()-r,charactersNumberNoSpaces:new yt.UnicodeString(u).getGraphemeCount()}}},25606:function(e,t,n){n.d(t,{zq:function(){return M}});var r=n(85556),o=n(61533),i=n.n(o),a=n(80491),s=n(82487),c=n(43618),l=n(66907),u=n(46016),d=n(31518),p=n(30479),h=n(61251),f=function(){function e(){this.lastTime=0,this.recentEditInfoList=[],this._editTimes=0,this.costTime=new Float32Array(h.zI.COUNT)}return Object.defineProperty(e.prototype,"editTimes",{get:function(){return this._editTimes},enumerable:!1,configurable:!0}),e.prototype.increEditTimes=function(){this._editTimes+=1},e.prototype.resetEditTimes=function(){this._editTimes=0},e.prototype.addRecentEditInfo=function(e,t){this.recentEditInfoList.length>=10&&this.recentEditInfoList.shift(),this.recentEditInfoList.push({commandType:e.globalOpts.commandType,mutCount:e.getMutations().mutations.length,opCount:e.operations.length,fromServer:e.globalOpts.fromServer,editTime:t})},e.prototype.getPerfInfo=function(){return{applyDelta:Math.floor(100*this.costTime[h.zI.ApplyDelta])/100,collab:Math.floor(100*this.costTime[h.zI.Collab])/100,layout:Math.floor(100*this.costTime[h.zI.Layout])/100,reflow:Math.floor(100*this.costTime[h.zI.Reflow])/100,render:Math.floor(100*this.costTime[h.zI.Render])/100,overlay:Math.floor(100*this.costTime[h.zI.Overlay])/100,editTimes:this.editTimes,recentEditInfoList:this.recentEditInfoList}},e}(),g=n(2498),v=n(95303),y=function(){function e(){this.localMetricsCache=new Map,this.initCalcHeightDom()}return e.obtain=function(){return this.instance||(this.instance=new e),this.instance},e.prototype.calculateFontHeight=function(e){if(!e.style.rFonts.ascii&&!e.style.rFonts.eastAsia)return this.getEmptyFontMetrics(e);var t=this.mapFontInfoToKey(e),n=this.localMetricsCache.get(t);return n||(n=this.getMetrics(e),this.localMetricsCache.set(t,n)),this.adjustHeight(e,n)},e.prototype.getMetrics=function(e,t){void 0===t&&(t="M");var n={ascent:0,descent:0,emsize:(0,p.pxToTwips)(256),height:0},r=this.parseFont(e);this.caliper.innerText=t,this.caliper.setAttribute("style","font-family: ".concat(u.vW8.parseFontFamily(r).stringValue,"; font-size: 256px; line-height: normal;")),this.vernier.style.verticalAlign="baseline",n.ascent=(0,p.pxToTwips)(this.vernier.offsetTop-this.caliper.offsetTop),this.vernier.style.verticalAlign="bottom";var o=this.vernier.offsetTop-this.caliper.offsetTop-this.caliper.offsetHeight;return n.height=(0,p.pxToTwips)(this.vernier.offsetTop-this.caliper.offsetTop-o),n.descent=n.height-n.ascent,n},e.prototype.adjustHeight=function(e,t){var n=t.ascent,r=t.descent,o=t.height,i=t.emsize,a=e.style.renderFontSize;return{ascent:n*a/i,descent:r*a/i,height:((0,u.xlq)(this.parseFont(e))?1.3*o:o)*a/i,fontSize:a}},e.prototype.mapFontInfoToKey=function(e){var t=e.style,n="".concat(Number(t.b)).concat(Number(t.i));return"".concat(this.parseFont(e),"_").concat(n,"_").concat(t.renderFontSize)},e.prototype.parseFont=function(e){var t=e.style,n=e.character,r=t.rFonts,o=r.eastAsia,i=r.ascii,a=r.hAnsi,s=r.cs;return(0,v.isHanScript)(n)?o||i||a||s:i||i||a||s},e.prototype.initCalcHeightDom=function(){this.ruler=document.createElement("div"),this.ruler.className="ruler",this.caliper=document.createElement("span"),this.vernier=document.createElement("div"),this.ruler.setAttribute("style","position: fixed;top: 0;left: 0;background: grey;display: block;width: auto;height: auto;text-align: center;z-index: -99;opacity: 0;white-space: nowrap;"),this.vernier.setAttribute("style","display: inline-block; width: 15px; height: 1px; background: red;"),this.ruler.appendChild(this.caliper),this.ruler.appendChild(this.vernier),document.body.appendChild(this.ruler)},e.prototype.getEmptyFontMetrics=function(e){var t=e.style.renderFontSize||s.keb.fontSize,n=1.3*t;return{ascent:.8*n,descent:n*(1-.8),height:n,fontSize:t}},e}(),m=function(){function e(){this.ctx=null,this.fontMeasure=y.obtain(),this.checkMeasureCanvas()}return e.prototype.checkMeasureCanvas=function(){if(this.ctx)return!0;p.Logger.info("init measure nodes");var e=document.getElementById("melo-measure-canvas");return this.ctx=null==e?void 0:e.getContext("2d"),!!this.ctx||(p.Logger.error("measure|canvas context null"),!1)},e.prototype.measureSize=function(e,t,n){if(!this.checkMeasureCanvas())return{width:0,height:0,ascent:0,descent:0};var r=(0,p.twipsToPt)(t.renderFontSize),o=t.i?"italic":"normal",i=t.b?"bold":"normal";this.ctx.font="".concat(o," ").concat(i," ").concat(r,"pt ").concat(s.keb.fontFamily),this.ctx.font=n;var a=this.fontMeasure.calculateFontHeight({style:t,character:e}),c=a.height,l=this.ctx.measureText(e),u=t.spacing*new v.UnicodeString(e).getGraphemeCount(),d=a.ascent,h=a.descent;if(l.fontBoundingBoxAscent&&l.fontBoundingBoxDescent){var f=(c-(0,p.pxToTwips)(l.fontBoundingBoxAscent+l.fontBoundingBoxDescent))/2;d=(0,p.pxToTwips)(l.fontBoundingBoxAscent)+f,h=(0,p.pxToTwips)(l.fontBoundingBoxDescent)+f}var g=l.width;100!==t.w&&(g=l.width*t.w/100);var y=(0,p.pxToTwips)(g)+u;return y<=0&&(y=0),{width:y,height:c,ascent:d,descent:h}},e}(),b=function(){function e(e){this.cacheL1={},this.measureImp=new m,this.measureOpt=e}return e.prototype.updateMeasureOpt=function(e){Object.assign(this.measureOpt,e)},e.prototype.measure=function(e,t,n){Object.prototype.hasOwnProperty.call(this.cacheL1,n.key)||(this.cacheL1[n.key]=new Map);var r=this.cacheL1[n.key],o=r.get(e);if(o)return o;var i=(0,s.GDL)(e);return o=this.measureImp.measureSize(i,t,n.style),this.processBlank(i,o,t),r.set(e,o),o},e.prototype.clearCache=function(){this.cacheL1={}},e.prototype.invalidateCacheL1=function(e){var t,n;try{for(var o=(0,r.__values)(Object.keys(this.cacheL1)),i=o.next();!i.done;i=o.next()){var a=i.value;a.includes(e)&&(this.cacheL1[a]=new Map)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},e.prototype.processBlank=function(e,t,n){if(!0===this.measureOpt.balanceSingleByteDoubleByteWidth&&this.hasBlankChar(e)){t.width=0;for(var r=0,o=e.length,i=n.renderFontSize/2,a=n.renderFontSize;r<o;){var c=e.charAt(r);c===s.IfD.Space?t.width+=i:c===s.IfD.NonBreakSpace&&(t.width+=a),r+=1}}},e.prototype.hasBlankChar=function(e){for(var t=0;t<e.length;t++){var n=e[t].charAt(0);if(n!==s.IfD.Space&&n!==s.IfD.NonBreakSpace)return!1}return!0},e}(),_=function(){function e(e){this.measureImpl=new b(e),this.measureCache={}}return e.prototype.updateTextMeasure=function(e){this.measureImpl.updateMeasureOpt(e)},e.prototype.computeCSSStyleForTextRunAttr=function(e){var t;if(e===this.lastMeasuredAttr&&this.lastComputedCssStyle)return this.lastComputedCssStyle;var n,r=(0,p.twipsToPt)(e.renderFontSize),o=e.i?"italic":"normal",i=e.b?"bold":"normal",a=(0,p.twipsToPt)(e.spacing),s=e.w;n=e.fontFamily?u.vW8.parseFontFamily(e.fontFamily):u.Gc.createInstance(e.fontFamily);var c="".concat(o," ").concat(i," ").concat(r,"pt ").concat(null!==(t=null==n?void 0:n.stringValue)&&void 0!==t?t:""),l={key:"".concat(c," ").concat(a," ").concat(s),style:c};return this.lastMeasuredAttr=e,this.lastComputedCssStyle=l,l},e.prototype.measureAttributedText=function(e,t){if(0===e.length)return{width:0,height:0,ascent:0,descent:0};var n=this.computeCSSStyleForTextRunAttr(t),r=this.getCacheKey(e,n.key);if(r){var o=this.measureCache[r];return o||(o=this.measureImpl.measure(e.toString(),t,n),this.measureCache[r]=o,o)}return this.measureImpl.measure(e.toString(),t,n)},e.prototype.getCacheKey=function(e,t){var n=e.length;if(1===n){var r=e.codePointAt(0)||0;if((0,v.isHanScript)(r))return t;if(this.isCachableCode(r))return"".concat(t,":").concat(e[0])}else if(2===n){var o=e.codePointAt(0)||0,i=e.codePointAt(1)||0;if((0,v.isHanScript)(o)&&(0,v.isPunctuationCategory)(i))return"".concat(t).concat(e[1]);if((0,v.isHanScript)(i)&&(0,v.isPunctuationCategory)(o))return"".concat(e[0]).concat(t)}},e.prototype.isCachableCode=function(e){return(0,v.isLatinScript)(e)||(0,v.isCommonScript)(e)},e.prototype.measureChar=function(e,t,n,o){return(0,r.__assign)((0,r.__assign)({},this.measureAttributedText(e.substring(n,o),t)),{offsetLeft:this.measureAttributedText(e.substring(0,n),t).width})},e.prototype.clearCache=function(){this.measureCache={},this.measureImpl.clearCache()},e.prototype.invalidateMeasureCache=function(e){var t=this;Object.keys(this.measureCache).forEach((function(n){n.includes(e)&&(t.measureCache[n]=void 0)})),this.measureImpl.invalidateCacheL1(e)},e}(),C=n(87363),S=n.n(C),w=n(6956),E="surface",x=function(e){function t(t){var n,r=this;(r=e.call(this,t)||this).isSwitch=!1,r.textLength=0,r.onFocusInListener=function(){r.props.context.fire(new u.e2Q,!1),p.Logger.info("AutoFocus focusin! "),document.removeEventListener("focusin",r.onFocusInListener)},r.saveSnapshotData=function(e){var t;if(e.data.startUpdate&&!r.isSwitch){p.Logger.info("AutoFocus saveSnapshotData",e.data),r.isSwitch=!0;var n=null===(t=e.data)||void 0===t?void 0:t.isInputting;r.saveFromSnapshot(e),n?r.requestFakeInputFocus():(window.editableWhenCreateState&&(window.editableWhenCreateState.needEnterInputState=!1),r.props.context.fire(new u.e2Q,!1),document.removeEventListener("focusin",r.onFocusInListener)),window.parent.removeEventListener("message",r.saveSnapshotData)}};var o=null!==(n=window.editableWhenCreateState)&&void 0!==n?n:{},i=o.editableWhenCreate,a=o.needEnterInputState,s=o.editableAtDetailPage;return i||a?(document.addEventListener("focusin",r.onFocusInListener),r.props.context.once(u.kgn.HIDDEN_EDITOR_LOAD_FINISH,(function(){var e,t,n,o;if(p.Logger.info("AutoFocus HIDDEN_EDITOR_LOAD_FINISH",JSON.stringify(window.editableWhenCreateState)),s&&r.isPortraitOrientation())return null===(t=null===(e=window.tdocs)||void 0===e?void 0:e.requestFocus)||void 0===t||t.call(e),void document.addEventListener("performance_edit_hidden_input_inited",(function(){var e=setTimeout((function(){r.requestFakeInputFocus(),clearTimeout(e)}),1e3);r.requestFakeInputFocus()}));null===(o=(n=window.parent).postMessage)||void 0===o||o.call(n,{detailIsReady:!0},window.origin),window.parent.addEventListener("message",r.saveSnapshotData),p.Logger.info("AutoFocus postMessage ({ detailIsReady: true }")})),r):r}return(0,r.__extends)(t,e),t.prototype.saveFromSnapshot=function(e){var t=e.data.docSnapshotText,n=e.data.isFocusInContent;if(t&&""!==t){var r=0;""!==t.content&&(this.props.context.service.getSelection().setRange(1,1),this.props.context.service.getSelection().setText(t.content),r+=t.content.length),""!==t.title&&(this.props.context.service.getSelection().setRange(0,0),this.props.context.service.getSelection().setText(t.title),t.isTitleSave=!0,r+=t.title.length);var o=void 0;o=n?r+1:t.title.length,this.textLength=r,this.props.context.service.getSelection().setRange(o,o)}},t.prototype.requestFakeInputFocus=function(){var e,t;p.Logger.info("AutoFocus requestFakeInputFocus");var n=new s.ICE(this.textLength,0),r=null!==(e=this.props.context.getViewRangeFromGcpRange(n))&&void 0!==e?e:void 0;null===(t=this.props.context.surface)||void 0===t||t.requestFocus(r,!1)},t.prototype.isPortraitOrientation=function(){var e=(null===screen||void 0===screen?void 0:screen.orientation)?screen.orientation.angle:Number(null===window||void 0===window?void 0:window.orientation);return 90!==e&&-90!==e},t.prototype.render=function(){return null},t}(S().Component),T=n(86667),R=n.n(T),I={top:12,right:8,bottom:0,left:8},P=function(){function e(e,t,n){this.context=e,this.state=t,this.layoutController=n,this.root=null,this.surfaceDom=null,this.surfaceExtendedDom=null,this.paddingInfo=I,e.docEnv.renderType,s.y2q.Lite,this.renderer=new w.T(e,t,n)}return e.prototype.buildComponent=function(e){this.root=e;var t={context:this.context,state:this.state,layoutController:this.layoutController,renderer:this.renderer,root:e};return S().createElement(O,(0,r.__assign)({},t))},e.prototype.attach=function(){this.renderer.attach()},e.prototype.detach=function(){this.renderer.detach()},e.prototype.getViewSelection=function(){return this.renderer.getViewSelection()},e.prototype.getScrollHandler=function(){return this.renderer.scrollHandler},e.prototype.setScrollRoot=function(e){this.renderer.scrollHandler.setScrollRoot(e)},e.prototype.getScrollRoot=function(){return this.renderer.scrollHandler.getScrollRoot()},e.prototype.getRenderState=function(){return this.renderer.renderState},e.prototype.forceRerender=function(){this.renderer.forceRerender()},e.prototype.forceOverlayRerender=function(){this.renderer.forceOverlayRerender()},e.prototype.getDom=function(){return!this.surfaceDom&&this.root&&(this.surfaceDom=this.root.querySelector(".surface")),this.surfaceDom},e.prototype.getExtendedDom=function(){return!this.surfaceExtendedDom&&this.root&&(this.surfaceExtendedDom=this.root.querySelector(".surface .extended-components")),this.surfaceExtendedDom},e.prototype.getPadding=function(){return(0,r.__assign)({},this.paddingInfo)},e.prototype.setPadding=function(e){!this.surfaceDom&&this.root&&(this.surfaceDom=this.root.querySelector(".surface")),this.surfaceDom&&(this.paddingInfo=(0,r.__assign)((0,r.__assign)({},this.paddingInfo),e),this.surfaceDom.style.paddingTop="".concat(this.paddingInfo.top,"px"),this.surfaceDom.style.paddingRight="".concat(this.paddingInfo.right,"px"),this.surfaceDom.style.paddingBottom="".concat(this.paddingInfo.bottom,"px"),this.surfaceDom.style.paddingLeft="".concat(this.paddingInfo.left,"px")),this.renderer.selectionOverlay.clearCache(),this.renderer.selectionOverlay.onLayoutChanged(),this.renderer.selectionOverlay.afterDocumentRender()},e.prototype.resetPadding=function(){this.setPadding(I)},e.prototype.resetFocusOnInfo=function(){this.getRenderState().setFocusOnInfo({isFocusHeaderFooter:!1})},e}(),O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.onContextMenu=function(e){var t=this;if(this.props.context.docEnv.docViewType!==s.$BT.PresentationPreview){if(this.props.context.fire(new u.wZO(e),!1),e.preventDefault(),e.stopPropagation(),!R().isPC)return;setTimeout((function(){var e;null===(e=t.props.context.surface)||void 0===e||e.requestBlur()}))}},t.prototype.render=function(){var e=this,t=this.props.renderer;return S().createElement("div",{className:E,onContextMenu:function(t){e.onContextMenu(t)},style:{paddingTop:I.top,paddingRight:I.right,paddingBottom:I.bottom,paddingLeft:I.left}},t.buildComponent(),S().createElement("div",{className:"extended-components"},S().createElement("div",{className:"hidden-editor"}),S().createElement("div",{className:"hidden-accessibility"}),S().createElement("div",{className:"caret"}),S().createElement("div",{className:"mobile-caret-drag"}),S().createElement("div",{className:"mobile-selection-drag"}),S().createElement("div",{className:"hidden-selection"}),S().createElement(x,{context:this.props.context})))},t}(S().Component);function k(e,t){var n,o=e.readCache(d.gg);if(o)return o;if((0,h.dc)(e))n=function(e,t){var n=0,o=e.getRange(),i=t.state.getTextStream().readText(o.begin(),o.length());return n+=p.StringUtil.countWordReg(i),(0,r.__assign)((0,r.__assign)({},d.hn),{wordCount:n})}(e,t);else if((0,h.rM)(e))n=function(e,t){return e.content?k(e.content,t):d.hn}(e,t);else if((0,h.FG)(e)){var i=0,a=0,s=0,c=0;e.children.forEach((function(e){var n=k(e,t),r=n.wordCount,o=n.wordCountNoPunctuation,l=n.charactersNumber,u=n.charactersNumberNoSpaces;i+=r,a+=o,s+=l,c+=u})),n={wordCount:i,wordCountNoPunctuation:a,charactersNumber:s,charactersNumberNoSpaces:c}}else n=d.hn;return e.writeCache(d.gg,n),n}function D(e,t){var n,r=e.readCache(d.gg);if(r)return r;if((0,h.wS)(e))n=function(e,t){var n,r,o=e.getRange(),i=0,a=0,s=0,c=0,l=t.state.getTextStream().readText(o.gcpBegin,o.len);if(!l.replace(/(\r|\n)/gu,"").length&&function(e){for(var t=e;t;){if(!t.parentBox)return!0;if(t.parentBox.lastVisibleChild!==e)return!1;t=t.parentBox}return!0}(e))return d.hn;var u=l,p=0;(null===(n=e.property)||void 0===n?void 0:n.actualText)&&(u="".concat(null===(r=e.property)||void 0===r?void 0:r.actualText," ").concat(l)),u=(0,d.S3)(u);var h=(0,d.Td)({dataEngine:t.state.dataEngine,textStream:t.state.getTextStream(),text:u,startGcp:o.gcpBegin});u=h.text,p+=h.addSpaceLength,u=(0,d.ol)(u);var f=(0,d.Gb)(u);return{wordCount:i+=f.wordCount,wordCountNoPunctuation:a+=f.wordCountNoPunctuation,charactersNumber:s+=f.charactersNumber-p,charactersNumberNoSpaces:c+=f.charactersNumberNoSpaces}}(e,t);else if((0,h.n6)(e))n=e.body?D(e.body,t):d.hn;else if((0,h.Eb)(e)){var o=0,i=0,a=0,s=0;e.children.forEach((function(e){var n=D(e,t),r=n.wordCount,c=n.wordCountNoPunctuation,l=n.charactersNumber,u=n.charactersNumberNoSpaces;o+=r,i+=c,a+=l,s+=u})),n={wordCount:o,wordCountNoPunctuation:i,charactersNumber:a,charactersNumberNoSpaces:s}}else n=d.hn;return e.writeCache(d.gg,n),n}var M=function(e){function t(t){var n=e.call(this)||this;n.modelWrapperMgr=new g.Bh,n._docEnv=(0,r.__assign)({},s.K1I),n.root=null,n.isNewDocumentPrepared=!1,n.isRenderFinish=!1,n.updateDocEnv(t);var o=n.factory;return o.set(h.Qw,n),n._state=c.ZM.emptyState(n),o.set(c.yg,n.state),n.layoutController=d.rX.instantiate(n.docEnv.renderType,h.rl,n,n.state.dataEngine),o.set(h.QZ,n.layoutController),n.clipboardManager=new l.ClipboardManager(n),o.set(l.IClipboardManager,n.clipboardManager),n._view=new P(n,n.state,n.layoutController),n._perfManager=new f,n.getRenderFinishAllPromise(),n.zoom=n._docEnv.initZoom,n.on(h.Rr.LayoutChanged,(function(){n.updateExtendDom(n.zoom)}),n),n.once(u.kgn.RENDER_FINISH,(function(){n.isRenderFinish=!0})),n}var n,o;return(0,r.__extends)(t,e),t.prototype.initRenderFinishPromise=function(){var e=this,t=new Promise((function(t){e.once(u.kgn.RENDER_FINISH,t)}));return Promise.all([t])},t.prototype.getRenderFinishAllPromise=function(){return this.isRenderFinish?Promise.resolve():(this.renderFinishAllPromise||(this.renderFinishAllPromise=this.initRenderFinishPromise()),this.renderFinishAllPromise)},Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),t.prototype.isInBlockState=function(){return this._docEnv.isBlock},t.prototype.isRenderLiteType=function(){return this._docEnv.renderType===s.y2q.Lite},t.prototype.readContext=function(e,t){return this.state.getTextStream().readText(e,t)},t.emptyEditor=function(e){var n=new t(e);return n.emptyContent(),n},t.prototype.emptyContent=function(){var e;this.state.importEmptyDocData(),this.onContentInit(),null===(e=this._service)||void 0===e||e.getDocument().clearIteratorCache()},t.prototype.setContent=function(e){var t=s.ymk.createTempDataEngine();e.applyOperations(t),this.setDataEngine(t)},t.prototype.setDataEngine=function(e){var t,n,r,o,i;null===(n=null===(t=window.performance)||void 0===t?void 0:t.mark)||void 0===n||n.call(t,"MK_DATAENGINE_START"),null===(r=this._service)||void 0===r||r.getDocument().clearIteratorCache(),this.state.importDocData(e),null===(i=null===(o=window.performance)||void 0===o?void 0:o.mark)||void 0===i||i.call(o,"MK_DATAENGINE_END"),this.onContentInit()},t.prototype.onContentInit=function(){var e=this,t=this.state.dataEngine.getDataManager().getSettingsManager().getDocSettingsProperty();if(a.dp){var n=t.compat.balanceSingleByteDoubleByteWidth,r=new _({balanceSingleByteDoubleByteWidth:n});a.dp.getDefaultEngine().setTextRunMeasureImp(r)}var o=document.documentElement.clientWidth||s.keb.nativeScreenSize.width,i=document.documentElement.clientHeight||s.keb.nativeScreenSize.height;o>0&&i>0?this.newDocument():window.mqq&&window.mqq.invoke&&window.mqq.invoke("docx","getNativeScreenSize",{},(function(t){(null==t?void 0:t.data)&&(s.keb.nativeScreenSize={width:t.data.width,height:t.data.height},p.Logger.info("getNativeScreenSize","width: ".concat(s.keb.nativeScreenSize.width,", height: ").concat(s.keb.nativeScreenSize.height))),e.newDocument()}))},t.prototype.newDocument=function(){this.view.resetFocusOnInfo(),this.newDocumentCallback?this.newDocumentCallback():this.isNewDocumentPrepared=!0},t.prototype.setNewDocumentCallback=function(e){this.newDocumentCallback=e,this.isNewDocumentPrepared&&this.newDocumentCallback()},t.prototype.getNewDocumentCallback=function(){return this.newDocumentCallback},t.prototype.newContentFromEditor=function(e,t){this.state.importDocData(e.state.dataEngine,t),this.onContentInit()},t.prototype.generateDocumentKeyFrame=function(){return this.state.generateDocumentKeyFrame()},Object.defineProperty(t.prototype,"surface",{get:function(){return this._surface},enumerable:!1,configurable:!0}),t.prototype.getDrawingStream=function(){return this.state.dataEngine.getDataStream().getDrawingStream()},t.prototype.getTableStream=function(){return this.state.dataEngine.getDataStream().getTableStream()},t.prototype.getFieldStream=function(){return this.state.dataEngine.getDataStream().getFieldStream()},t.prototype.insertResourceStart=function(e,t,n){this.state.insertResourceStart(e,t,n)},t.prototype.insertResourceFinish=function(e,t,n,r){this.state.insertResourceFinish(e,t,n,r)},t.prototype.insertResourceCancel=function(e,t){this.state.insertResourceCancel(e,t)},t.prototype.updateDocEnv=function(e){e&&(this.state&&this.state.dataEngine.getIsChunkLoadReadonly()&&(e.editable=!1),Object.assign(this._docEnv,e))},Object.defineProperty(t.prototype,"docEnv",{get:function(){return this._docEnv},enumerable:!1,configurable:!0}),t.prototype.setEditable=function(e){this.state&&this.state.dataEngine.getIsChunkLoadReadonly()&&(e=!1),this._docEnv.editable=e},t.prototype.isEditable=function(){return this._docEnv.editable},t.prototype.setCopyable=function(e){this._docEnv.copyable=e},t.prototype.isCopyable=function(){return this._docEnv.copyable},Object.defineProperty(t.prototype,"isPagedView",{get:function(){return this._docEnv.layoutType===s.msV.Paged},enumerable:!1,configurable:!0}),t.prototype.setPermissionRangeMode=function(e){this._docEnv.usePermissionRangeMode=e},t.prototype.usePermissionRangeMode=function(){return this._docEnv.usePermissionRangeMode},Object.defineProperty(t.prototype,"service",{get:function(){if(!this._service)throw new Error("IService not injected yet!");return this._service},enumerable:!1,configurable:!0}),t.prototype.onSelection=function(){if(!this._service)throw new Error("IService not injected yet!");return this._service.getSelection()},t.prototype.onDocument=function(){if(!this._service)throw new Error("IService not injected yet!");return this._service.getDocument()},t.prototype.getFontService=function(){if(!this._service)throw new Error("IService not injected yet!");return this._service.getFontService()},t.prototype.getRoot=function(){return this.root},Object.defineProperty(t.prototype,"view",{get:function(){return this._view},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scrollHandler",{get:function(){return this._view.getScrollHandler()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"zoom",{get:function(){return this._view.renderer.zoom},set:function(e){e!==this.zoom&&(this._view.renderer.zoom=e,this.updateExtendDom(e))},enumerable:!1,configurable:!0}),t.prototype.updateExtendDom=function(e){var t=this.view.getExtendedDom();if(t){var n=void 0;n=this.docEnv.docViewType===s.$BT.PresentationPreview?u.vW8.calcDocBoxSize(this.getDocumentBox(),1):u.vW8.calcDocBoxSize(this.getDocumentBox(),1,I),t.style.transform=this.getExtendedDomTransform(e,n),t.style.width=n.width||"",t.style.height=n.height||"",t.style.pointerEvents="none"}},t.prototype.getExtendedDomTransform=function(e,t){var n={width:I.left,height:I.top};return u.vW8.calcDocBoxTransform(e,t,n)},t.prototype.isCaret=function(){return this.state.selection.isCollapse()},t.prototype.isCompositing=function(){return this.state.isCompositing()},t.prototype.getCurrentCompositionRange=function(){return this.state.getCurrentCompositionRange()},Object.defineProperty(t.prototype,"selection",{get:function(){return this.state.selection},enumerable:!1,configurable:!0}),t.prototype.setRangeTo=function(e,t){return this.state.setRangeTo(e,t)},t.prototype.getRangeFromIndex=function(e,t){return this.state.getTextStream().getRangeFromIndex(e,t)},t.prototype.getIndexFromRange=function(e){var t=this.state.getTextStream();return{first:t.getIndexFromGCP(e.begin()),last:t.getIndexFromGCP(e.end())}},Object.defineProperty(t.prototype,"viewSelection",{get:function(){return this._view.getViewSelection()},enumerable:!1,configurable:!0}),t.prototype.getViewRangeFromGcpRange=function(e,t){return(0,u.rhU)(this.layoutController,e,this._view.getRenderState(),t,this.state.getTextStream())},t.prototype.getInSightRange=function(){return this.scrollHandler.getInSightRange()},t.prototype.createRangeManager=function(e){return void 0===e&&(e=!0),this.state.dataEngine.createRangeClass(!1,e)},t.prototype.createGcpManager=function(e,t,n){return void 0===e&&(e=!0),void 0===t&&(t=s.mEF.Outer),this.state.dataEngine.createGCPClass(n,e,t)},t.prototype.createSelector=function(){return new u.Ad_(this.createRangeFinder())},t.prototype.createRangeFinder=function(){var e=this,t={domPosToBoxPos:function(t){return t/e.zoom},scrollerInfo:(0,u.kN2)(this._view.renderer.renderState),scrollerBox:u.khV};return(0,u.PFq)(this.docEnv.renderType,this.state,this.layoutController,this._view.renderer.containerFocus,t,this._view.renderer.renderState)},t.prototype.attachEditor=function(e){this.root=e,i().render(this._view.buildComponent(e),e),this.updateExtendDom(this.zoom),e.editor=this,this._view.attach(),this._surface&&this._surface.attach()},t.prototype.detach=function(){this.root&&this.root.remove(),this._view.detach(),this._surface&&this._surface.detach()},Object.defineProperty(t.prototype,"isUpdating",{get:function(){return this._view.renderer.lifeCycle.isUpdating},enumerable:!1,configurable:!0}),t.prototype.setLayoutType=function(e){this._docEnv.layoutType=e,this.layoutController.setLayoutType(e,{synced:!0})},t.prototype.getSurfaceDom=function(){var e,t;return null!==(t=null===(e=this.surface)||void 0===e?void 0:e.getSurfaceDom())&&void 0!==t?t:null},t.prototype.addContainerRender=function(e,t){this._view.renderer.containerRenderManager.addRender(e,t)},t.prototype.addContainerRenderPlugin=function(e){this._view.renderer.containerRenderManager.addRenderPlugin(e)},t.prototype.addLayoutExtension=function(e,t){this.layoutController.extend(e,t)},t.prototype.addLineOverlay=function(e){this._view.renderer.overlays.addOverlay(e)},t.prototype.addDecorator=function(e,t){this._view.renderer.decoratorManager.addDecorator(e,t)},t.prototype.addExtendRenderer=function(e,t){var n;null===(n=this._view.renderer.extRendererManager)||void 0===n||n.addExtendRenderer(e,t)},t.prototype.addStyleDecorator=function(e,t){this._view.renderer.decoratorManager.addStyleDecorator(e,t)},t.prototype.addClassNameDecorator=function(e,t){this._view.renderer.decoratorManager.addClassNameDecorator(e,t)},t.prototype.addContentDecorator=function(e,t,n,r){void 0===r&&(r=!1),this._view.renderer.decoratorManager.addContentDecorator(e,t,n,r)},t.prototype.addStyleProperty=function(e){this.state.dataEngine.getDataManager().setStyleSheet(e)},t.prototype.addScrollContainer=function(e,t){this.scrollHandler.addScrollContainer(e,t)},t.prototype.getDocumentBox=function(){return this.layoutController.getLayoutBox()},Object.defineProperty(t.prototype,"pageCount",{get:function(){return this.layoutController.layoutFinished?this.layoutController.getLayoutBox().children.length:Number.NaN},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordCount",{get:function(){return t=(e=this).getDocumentBox(),(0,h.gL)(t)?D(t,e):k(t,e);var e,t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLayoutFinished",{get:function(){return this.layoutController.layoutFinished},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"statisticInfo",{get:function(){var e=0,t=0,n=0,r="",o=this.getDocumentBox();o&&(e=o.countNodes(),t=o.countNodes((function(e){return(0,h.Oi)(e)})),n=o.countNodes((function(e){return(0,h.$o)(e)===h.uO.Table}),(function(e){return(0,h.$o)(e)===h.uO.Paragraph||(0,h.$o)(e)===h.uO.Table})),r=navigator.userAgent||"");var i=this.wordCount,a=i.wordCount,c=i.wordCountNoPunctuation,l=i.charactersNumber,u=i.charactersNumberNoSpaces,d=this._docEnv.layoutType===s.msV.Scroll?0:1,p=this.pageCount;return{mut_num:this.state.dataEngine.getMutNum(),dom_num:e,sheet_num:n,pic_num:t,page_count:p,scroll_page_count:p,wordNum:a,wordCountNoPunctuation:c,charactersNumber:l,charactersNumberNoSpaces:u,layoutType:d,browserInfo:r}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"perfManager",{get:function(){return this._perfManager},enumerable:!1,configurable:!0}),t.prototype.applyDelta=function(e){this.state.applyDelta(e)},t.prototype.applyMutations=function(e,t){this.state.applyMutations(e,t)},Object.defineProperty(t.prototype,"constraintSpace",{get:function(){return this.layoutController.constraintSpace},enumerable:!1,configurable:!0}),t.prototype.getRefText=function(e){var t=this.factory.get(l.CopyInterface);return t?t.getRefText(e):""},t.prototype.getRefHTML=function(e){var t=this.factory.get(l.CopyInterface);return t&&t.generateHtml?t.generateHtml(e,!1):null},t.prototype.getCopyContent=function(e){var t=this.factory.get(l.CopyInterface);if(t)return t.getCopyContent(e)},t.prototype.writeHtmlToClipboard=function(e){var t=this.factory.get(l.CopyInterface);t&&(t.writeClipboard(e),t.copy())},t.prototype.forceReflow=function(e){var t=new d.I3([e]),n=new Map;n.set(s.Eos.MainDocId,t),this.fire(new h.Ey(t,n),!1)},t.prototype.getShadingProperty=function(){return this._state.dataEngine.getDataManager().getSettingsManager().getShadingProperty()},t.prototype.serializeLimitRangeDoc=function(e){return this._state.serializeLimitRangeDoc(e)},t.prototype.getLayoutError=function(){return null},(0,r.__decorate)([h.vH,(0,r.__metadata)("design:type","function"==typeof(n=void 0!==h.vH&&h.vH)?n:Object)],t.prototype,"_service",void 0),(0,r.__decorate)([h.S$,(0,r.__metadata)("design:type","function"==typeof(o=void 0!==h.S$&&h.S$)?o:Object)],t.prototype,"_surface",void 0),t}(d._y)},80491:function(e,t,n){var r;n.d(t,{fQ:function(){return f},mz:function(){return v},Eo:function(){return o},Ad:function(){return c},O7:function(){return l},Cr:function(){return r},cG:function(){return h},VY:function(){return i},kI:function(){return s},st:function(){return d},dp:function(){return g}}),function(e){e[e.Normal=0]="Normal",e[e.Pause=1]="Pause",e[e.Abort=2]="Abort"}(r||(r={}));var o,i=function(){function e(e){this.node=e,this.status=r.Normal}return Object.defineProperty(e.prototype,"name",{get:function(){var e=this.constructor;return null==e?void 0:e.name},enumerable:!1,configurable:!0}),e.prototype.hasNext=function(){return!1},e.prototype.getNext=function(){throw new Error("LayoutContext.getNext must be overrided.")},e.prototype.commit=function(){},e.prototype.rollback=function(){},e.prototype.pause=function(){this.status=r.Pause},e.prototype.abort=function(){this.status=r.Abort},e.prototype.resume=function(){this.status=r.Normal},e.prototype.onDestroy=function(){},e}(),a=n(85556),s=function(){function e(e){this.node=e.node,this.name=e.name,this.context=e,this.iterator=this.createIterator()}return e.prototype.pause=function(){this.context.pause()},e.prototype.abort=function(){this.context.abort()},e.prototype.resume=function(){this.context.resume()},e.prototype.commit=function(){this.context.commit()},e.prototype.rollback=function(){this.context.rollback()},e.prototype.hasNext=function(){return this.context.hasNext()},e.prototype.getNext=function(){return this.iterator.next()},e.prototype.onDestroy=function(){this.context.onDestroy()},e.prototype.createIterator=function(){return(0,a.__generator)(this,(function(e){throw new Error("LayoutGenerator.createIterator must be overrided.")}))},e}(),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layoutDone=!1,t}return(0,a.__extends)(t,e),t.prototype.hasNext=function(){return!this.layoutDone},t.prototype.getNext=function(){throw new Error("ConstantContext can't call getNext.")},t.prototype.commit=function(){this.layoutDone=!0},t.prototype.rollback=function(){this.layoutDone=!1},t}(i),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.createIterator=function(){return(0,a.__generator)(this,(function(e){switch(e.label){case 0:return this.context.hasNext()?[4,this.context.getValues()]:[3,2];case 1:return e.sent(),[3,0];case 2:return[2]}}))},t}(s),u=n(82487),d=function(){function e(e){this.map=new Map,this.hfArray=[],this.dataEngine=e}return Object.defineProperty(e.prototype,"storyStream",{get:function(){return this.dataEngine.getDataStream().getStoryStream()},enumerable:!1,configurable:!0}),e.prototype.clear=function(){this.map.clear(),this.hfArray.splice(0,this.hfArray.length)},e.prototype.setBox=function(e,t){this.map.set(e,t)},e.prototype.removeBox=function(e){this.map.delete(e)},e.prototype.getBoxById=function(e){return this.map.get(e)},e.prototype.getBoxByRange=function(e){if(e&&!e.isNull()){var t=this.storyStream.getSubStoryInfoFromGcp(e.begin());if(t&&t.storyProp){var n=t.subStoryProp;return n.id!==u.Eos.MainDocId?this.getBoxById(n.id):void 0}}},e.prototype.addHeaderFooter=function(e){e&&this.hfArray.push(e)},e.prototype.getHeaderFooterIds=function(){return this.hfArray},Object.defineProperty(e.prototype,"storyNumber",{get:function(){return this.map.size},enumerable:!1,configurable:!0}),e.prototype.readStoryBox=function(e){this.map.forEach(e)},e}(),p=n(30479),h=function(){function e(){}return e.COST=!1,e.LOG=!1,e}(),f=function(){function e(e){this.dataEngine=e,this._bp2cpCache=new Map}return Object.defineProperty(e.prototype,"textStream",{get:function(){return this.dataEngine.getDataStream().getTextStream()},enumerable:!1,configurable:!0}),e.prototype.evictCache=function(){this._bp2cpCache.clear()},e.prototype.bp2cp=function(e){var t=this._bp2cpCache.get(e);return void 0===t&&(t=this.textStream.getGCPFromIndex(e),this._bp2cpCache.set(e,t)),t},e.prototype.getGCPTuple=function(e){return[this.bp2cp(e.first),this.bp2cp(e.last)]},e.prototype.getGCPPair=function(e){return{first:this.bp2cp(e.first),last:this.bp2cp(e.last)}},e.prototype.getGCPPairs=function(e){var t,n=this;return(t="indexPairs"in e?e.indexPairs:e)&&0!==t.length?t.map((function(e){return n.getGCPPair(e)})):[]},e.prototype.getGCPRanges=function(e){var t,n=this;t="indexPairs"in e?e.indexPairs:e;var r=[];return t&&0!==t.length?(t.forEach((function(e){var t=n.bp2cp(e.first),o=n.bp2cp(e.last)+1;r.push(new u.ICE(t,o-t))})),r):r},e.prototype.mergeBox=function(e,t){var n=this.getGCPPairs(e.indexPairs);this.mergeGCP(n,t)},e.prototype.unmergeBox=function(e,t){var n=this.getGCPPairs(e.indexPairs);this.unmergeGCP(t,n)},e.prototype.unmergeGCP=function(e,t){if(!(!e||e.length<=0||!t||t.length<=0)){var n,r=0;t.forEach((function(t){do{if(!((n=e[r]).last+1<t.first))break;r++}while(r<e.length);if(t.first<=n.first&&t.last>=n.last)e.splice(r,1);else if(t.first===n.first)n.first=t.last+1;else if(t.last===n.last)n.last=t.first-1;else if(t.first>n.first&&t.last<n.last){var o={first:t.last+1,last:n.last};n.last=t.first-1,e.splice(++r,0,o)}}))}},e.prototype.mergeGCP=function(e,t){if(e&&!(e.length<=0))if(0!==t.length)for(var n=0,r=0;n<e.length;){var o=e[n++],i=void 0;do{if(!((i=t[r]).last+1<o.first))break;r++}while(r<t.length);if(r>=t.length)t.push(o);else if(i.first<=o.last+1&&o.first<=i.last+1){i.first=Math.min(o.first,i.first),i.last=Math.max(o.last,i.last);for(var s=0,c=r+1;c<t.length;c++){var l=t[c];if(!(i.last+1>=l.first))break;i.last=Math.max(i.last,l.last),s+=1}s>0&&t.splice(r+1,s)}else o.last+1<i.first?t.splice(r++,0,o):i.last+1<o.first&&t.splice(++r,0,o)}else t.push.apply(t,(0,a.__spreadArray)([],(0,a.__read)(e),!1))},e.prototype.mergeIndex=function(e,t){if(e&&!(e.length<=0)){var n=e.map((function(e){return(0,a.__assign)({},e)}));if(0!==t.length)for(var r=0,o=0;r<n.length;){var i=n[r++],s=this.getGCPPair(i),c=void 0,l=void 0;do{if(c=t[o],!((l=this.getGCPPair(c)).last+1<s.first))break;o++}while(o<t.length);o>=t.length?t.push(i):l.first<=s.last+1&&s.first<=l.last+1?this.unionIndex([s,i],[l,c],o,t):s.last+1<l.first?t.splice(o++,0,i):l.last+1<s.first&&t.splice(++o,0,i)}else t.push.apply(t,(0,a.__spreadArray)([],(0,a.__read)(n),!1))}},e.prototype.unionIndex=function(e,t,n,r){var o=(0,a.__read)(e,2),i=o[0],s=o[1],c=(0,a.__read)(t,2),l=c[0],u=c[1];i.first<l.first&&(l.first=i.first,u.first=s.first),i.last>l.last&&(l.last=i.last,u.last=s.last);for(var d=0,h=n+1;h<r.length;h++){var f=r[h],g=this.getGCPPair(f);if(!(l.last+1>=g.first))break;g.last>l.last?(l.last=g.last,u.last=f.last):p.Logger.warn("layout|merge[".concat(l.first,",").concat(l.last,"][").concat(g.first,",").concat(g.last,"]")),d+=1}d>0&&r.splice(n+1,d)},e.prototype.isBoxInEnd=function(e,t){var n=e.indexPairs,r=n[n.length-1].last;return t===this.bp2cp(r)+1},e.prototype.printRanges=function(e){if(h.LOG){var t=this.getGCPPairs(e.indexPairs),n="layout|".concat(e.name,":");t.forEach((function(e){n+="[".concat(e.first,",").concat(e.last,"]")})),p.Logger.log(n)}},e}();!function(e){e[e.isDirty=0]="isDirty",e[e.beforeDirty=1]="beforeDirty",e[e.afterDirty=2]="afterDirty",e[e.noDirty=3]="noDirty",e[e.non=4]="non"}(o||(o={}));var g=function(){function e(){}return e.getDefaultEngine=function(){return this.instance},e.prototype.setTextRunMeasureImp=function(e){this.textRunMeasureImp=e},e.prototype.measureAttributedText=function(e,t){return this.textRunMeasureImp.measureAttributedText(e,t)},e.prototype.measureChar=function(e,t,n,r){return this.textRunMeasureImp.measureChar(e,t,n,r)},e.prototype.clearCache=function(){p.Logger.info("textMeasure|clearCache"),this.textRunMeasureImp.clearCache()},e.prototype.invalidateMeasureCache=function(e){var t;null===(t=this.textRunMeasureImp)||void 0===t||t.invalidateMeasureCache(e)},e.instance=new e,e}(),v=function(){function e(){this.refreshUUID()}return e.markFreshStart=function(){this.uuidFreshStart=this.uuidGen},e.isFreshBox=function(e){return Number.parseInt(e.boxUuid,10)>=this.uuidFreshStart},e.prototype.refreshUUID=function(){this.boxUuid="".concat(e.uuidGen),e.uuidGen+=1},Object.defineProperty(e.prototype,"uuid",{get:function(){return this.boxUuid},enumerable:!1,configurable:!0}),e.prototype.writeCache=function(e,t){this.cache||(this.cache=new Map),this.cache.set(e,t)},e.prototype.readCache=function(e){var t;return null===(t=this.cache)||void 0===t?void 0:t.get(e)},e.uuidGen=0,e.uuidFreshStart=0,e}()},47176:function(e,t,n){n.d(t,{hy:function(){return Xt},wl:function(){return Te},s9:function(){return Ee},MM:function(){return we},y7:function(){return ee},vm:function(){return S},Mi:function(){return k},eW:function(){return _t},zC:function(){return x},w8:function(){return R},oH:function(){return P},AT:function(){return T}});var r={};n.r(r),n.d(r,{Og:function(){return et},jG:function(){return $e},fC:function(){return qe},Zi:function(){return Pe}});var o={};n.r(o);var i={};n.r(i),n.d(i,{C5:function(){return Et},Ac:function(){return wt},Bc:function(){return yt},J3:function(){return mt}});var a={};n.r(a),n.d(a,{FC:function(){return zt},gq:function(){return Gt},eV:function(){return Kt}});var s=n(85556),c=n(82487),l=n(61251),u=n(30479),d=function(){function e(){}return e.obtain=function(e){var t=l.bH.obtain();if(!e)return t;var n=e.margin,r=e.border,o=e.padding;return n&&this.copy(t.margin,n),r&&this.copyBorder(t.border,r),o&&this.copy(t.padding,o),t},e.copyBorder=function(e,t){t.width&&this.copy(e.width,t.width)},e.copy=function(e,t){Object.assign(e,{top:t.before,left:t.start,bottom:t.after,right:t.end})},e}(),p=n(46861),h=n(80491),f=function(e){function t(t){var n=e.call(this)||this;return n.index=0,n.logicalSize=p.wY.obtain(t),n}return(0,s.__extends)(t,e),t.prototype.clone=function(e){var t=new(0,this.constructor);return t.index=this.index,t.logicalSize=p.wY.obtain(this.logicalSize),t.logicalEdge=p.z6.obtain(this.logicEdge),t.hidden=this.hidden,t.containFloating=this.containFloating,t},t.prototype.initFromNode=function(e){},t.prototype.getRangeBegin=function(){return c.S$m},t.prototype.getRangeEnd=function(){return c.S$m},t.prototype.getRange=function(e){return c.ICE.invalidRange()},t.prototype.getFullRanges=function(e){var t=this.getRange(e);return t.isValid()?[t]:[]},t.prototype.containsRangeOrCP=function(e,t){return this.getRange(!0).contains(e)},t.prototype.intersectRange=function(e,t){return this.getRange(!0).intersect(e)},t.prototype.compareRangeTo=function(e){var t=this.getRangeEnd();return t<e?p.Xq.EndBefore:t===e?p.Xq.EndAt:this.getRangeBegin()>e?p.Xq.After:p.Xq.Contains},Object.defineProperty(t.prototype,"rect",{get:function(){return new u.MeloRect({x:0,y:0,width:this.measure,height:this.extent})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"edge",{get:function(){return d.obtain(this.logicalEdge)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalWidth",{get:function(){return this.totalMeasure},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalHeight",{get:function(){return this.totalExtent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalBoxSize",{get:function(){return new u.MeloSize({width:this.measure+(this.logicEdge?this.logicEdge.measure:0),height:this.extent+(this.logicEdge?this.logicEdge.extent:0)})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"borderBoxSize",{get:function(){var e,t,n=this.measure,r=this.extent;return(null===(e=this.logicEdge)||void 0===e?void 0:e.padding)&&(n+=this.logicEdge.padding.measure,r+=this.logicEdge.padding.extent),(null===(t=this.logicEdge)||void 0===t?void 0:t.border)&&(n+=this.logicEdge.border.width.measure,r+=this.logicEdge.border.width.extent),new u.MeloSize({width:n,height:r})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"paddingBoxSize",{get:function(){var e,t=this.measure,n=this.extent;return(null===(e=this.logicEdge)||void 0===e?void 0:e.padding)&&(t+=this.logicEdge.padding.measure,n+=this.logicEdge.padding.extent),new u.MeloSize({width:t,height:n})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"positionBoxSize",{get:function(){var e,t;switch(null===(t=null===(e=this.logicEdge)||void 0===e?void 0:e.border)||void 0===t?void 0:t.type){case l.GJ.Inner:return this.borderBoxSize;case l.GJ.Both:var n=this.paddingBoxSize,r=this.logicEdge.border.width;return n.width+=r.measure/2,n.height+=r.extent/2,n;default:return this.paddingBoxSize}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"positionOutset",{get:function(){var e,t;switch(null===(t=null===(e=this.logicEdge)||void 0===e?void 0:e.border)||void 0===t?void 0:t.type){case l.GJ.Inner:return l.Wh.getNone(0);case l.GJ.Both:return this.edge.border.width.transform((function(e){return e/2}));default:return this.edge.border.width}},enumerable:!1,configurable:!0}),t.prototype.getOuterPoint=function(){var e=new u.MeloPoint,t=this.prevSibling;if(this.layoutCursor)e.x=this.layoutCursor.inlinePos,e.y=this.layoutCursor.blockPos;else for(;t;)this.display===l.gy.Block?e.y+=t.totalExtent:this.display!==l.gy.Inline&&this.display!==l.gy.InlineBlock||(e.x+=t.totalMeasure),t=t.prevSibling;if(this.parentBox){var n=((0,l.vv)(this.parentBox)?this.parentBox.getOriginSizeBox():this.parentBox).logicEdge;(null==n?void 0:n.padding)&&(e.x+=n.padding.start,e.y+=n.padding.before)}return e},t.prototype.getInnerPoint=function(){var e=this.getOuterPoint();return this.logicEdge&&e.offset(this.logicEdge.start,this.logicEdge.before),e},Object.defineProperty(t.prototype,"measure",{get:function(){return this.logicSize?this.logicSize.measure:0},enumerable:!1,configurable:!0}),t.prototype.setMeasure=function(e){this.logicalSize||(this.logicalSize=p.wY.obtain()),this.logicalSize.measure=e},Object.defineProperty(t.prototype,"extent",{get:function(){return this.logicSize?this.logicSize.extent:0},enumerable:!1,configurable:!0}),t.prototype.setExtent=function(e){this.logicalSize||(this.logicalSize=p.wY.obtain()),this.logicalSize.extent=e},t.prototype.getTotalMeasure=function(){return this.measure+(this.logicEdge?this.logicEdge.measure:0)},Object.defineProperty(t.prototype,"totalMeasure",{get:function(){return this.getTotalMeasure()},enumerable:!1,configurable:!0}),t.prototype.getTotalExtent=function(){return this.extent+(this.logicEdge?this.logicEdge.extent:0)},Object.defineProperty(t.prototype,"totalExtent",{get:function(){return this.getTotalExtent()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"logicSize",{get:function(){return this.logicalSize},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"logicEdge",{get:function(){return this.logicalEdge},set:function(e){this.logicalEdge=e},enumerable:!1,configurable:!0}),t.prototype.isZero=function(){return 0===this.measure||0===this.extent},t.prototype.setParentBox=function(e){this.parent=e},Object.defineProperty(t.prototype,"parentBox",{get:function(){return this.parent},enumerable:!1,configurable:!0}),t.prototype.setSiblingIndex=function(e){this.index=e},t.prototype.getSiblingIndex=function(){return this.index},Object.defineProperty(t.prototype,"nextSibling",{get:function(){if(this.parent){var e=this.index+1,t=this.parent.children;if(e<t.length)return t[e]}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"prevSibling",{get:function(){if(this.parent){var e=this.index-1;if(e>=0)return this.parent.children[e]}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"display",{get:function(){return l.gy.Block},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){var e=this.constructor;return null==e?void 0:e.name},enumerable:!1,configurable:!0}),t.prototype.countNodes=function(e,t){return!e||e(this)?1:0},t.prototype.recycle=function(e){this.logicalEdge&&(this.logicalEdge.recycle(),this.logicalEdge=void 0),this.logicalSize&&(this.logicalSize.recycle(),this.logicalSize=void 0),this.parent=void 0},t.prototype.isValid=function(){return!!this.logicalSize&&this.getRangeBegin()!==c.S$m},t.prototype.getAncestorOf=function(e){for(var t=this.parentBox;t&&(0,l.$o)(t)!==e;)t=t.parentBox;return t},t.prototype.isAffectedByFloating=function(){var e;if(this.containFloating)return!0;var t=null!==(e=this.getAncestorOf(l.uO.Body))&&void 0!==e?e:this.getAncestorOf(l.uO.HeaderFooter);return!!(null==t?void 0:t.containFloating)},t.prototype.onReuse=function(e){},Object.defineProperty(t.prototype,"isPageFirst",{get:function(){var e;return!!(null===(e=this.parent)||void 0===e?void 0:e.isPageFirst)&&0===this.index},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPageLast",{get:function(){var e;return!!(null===(e=this.parent)||void 0===e?void 0:e.isPageLast)&&this.index===this.parent.children.length-1},enumerable:!1,configurable:!0}),t}(h.mz),g=function(e){function t(t){var n=e.call(this,t)||this;return n.layoutDisplay=l.gy.Inline,n}return(0,s.__extends)(t,e),t.prototype.clone=function(t){var n=e.prototype.clone.call(this,t);return n.layoutDisplay=this.layoutDisplay,n},Object.defineProperty(t.prototype,"display",{get:function(){return this.layoutDisplay},set:function(e){this.layoutDisplay=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ascent",{get:function(){return this.totalExtent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"descent",{get:function(){return 0},enumerable:!1,configurable:!0}),t}(f),v={};function y(e){return function(t){t.kind=e.kind,v[e.kind]||(v[e.kind]={ctor:t});var n=v[e.kind];return e.predicate?(n.subCtors||(n.subCtors=[]),n.subCtors.push({predicate:e.predicate,subCtor:t})):n.ctor=t,t}}var m=n(46708),b=n(69890),_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.childBoxes=[],t}return(0,s.__extends)(t,e),t.prototype.clone=function(t){var n=e.prototype.clone.call(this,t),r=[];return this.childBoxes.forEach((function(e){var o=e.clone(t);o.setParentBox(n),r.push(o)})),n.childBoxes=r,n.env=this.env,n.version=this.version,n.rangesCache=this.getRanges(),n},t.prototype.setEnv=function(e,t){this.env=e,t&&(this.version=e.version,this.rangesCache=t)},t.prototype.calculateRangesBeforEmit=function(e){return this.calculateRanges()},t.prototype.calculateRanges=function(){if(0===this.childBoxes.length)return[];if(!this.isDiscrete()){var e=this.firstChild.getRangeBegin(),n=this.lastChild.getRangeEnd();return[new c.ICE(e,n-e)]}return(0,b.Jn)(this,(function(e){return e instanceof t?e.getRanges(!0):[e.getRange(!0)]}))},t.prototype.getRangeBegin=function(){var e,t;return null!==(t=null===(e=this.getRanges(!0)[0])||void 0===e?void 0:e.gcpBegin)&&void 0!==t?t:c.S$m},t.prototype.getRangeEnd=function(){var e,t;return null!==(t=null===(e=(0,m.Rz)(this.getRanges(!0)))||void 0===e?void 0:e.end())&&void 0!==t?t:c.S$m},t.prototype.getRange=function(e){var t=this.getRanges(!0);return 0===t.length?e?c.TUk:c.ICE.invalidRange():1===t.length?e?t[0]:t[0].clone():new c.ICE(t[0].gcpBegin,(0,m.Rz)(t).end()-t[0].gcpBegin)},t.prototype.isUnsafeToGetRangeBeforeEmitWithoutNode=function(){return this.isDiscrete()},t.prototype.getRanges=function(e){if(!this.env){var t=this.calculateRanges();return this.isUnsafeToGetRangeBeforeEmitWithoutNode()&&b.No.warn(b.Qq.GetRangeBeforeEmit,t.map((function(e){return e.toString()}))),e?t:t.map((function(e){return e.clone()}))}return this.env.version===this.version&&this.rangesCache||(this.rangesCache=this.calculateRanges(),this.version=this.env.version),e?this.rangesCache:this.rangesCache.map((function(e){return e.clone()}))},t.prototype.getFullRanges=function(){return(0,b.Jn)(this,(function(e){return e.getFullRanges()}))},t.prototype.containsRangeOrCP=function(e,t){var n,r;if(void 0===t&&(t=!1),!this.shouldCheckFull(e,t)){if(this.isDiscrete()){var o="number"==typeof e?e:e.gcpBegin,i="number"==typeof e?e:e.end();try{for(var a=(0,s.__values)(this.children),c=a.next();!c.done;c=a.next()){var l=c.value;if(!(l.getRangeBegin()>i||l.getRangeEnd()<=o)&&l.containsRangeOrCP(e,!1))return!0}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return!1}return this.getRange(!0).contains(e)}return this.children.some((function(t){return t.containsRangeOrCP(e,!0)}))},t.prototype.shouldCheckFull=function(e,t){if(t){var n=(0,l.gL)(this)?this:this.getAncestorOf(l.uO.Document),r="number"==typeof e?e:e.gcpBegin;return!(n&&n.getRangeEnd()>=r)}return!1},t.prototype.intersectRange=function(e,t){return void 0===t&&(t=!1),t||this.isDiscrete()?this.children.some((function(t){return t.intersectRange(e)})):this.getRange(!0).intersect(e)},t.prototype.compareRangeTo=function(e){var t,n,r,o=this.getRangeEnd();if(o<e)return p.Xq.EndBefore;if(o===e)return p.Xq.EndAt;if(this.getRangeBegin()>e)return p.Xq.After;if(this.isDiscrete()){var i=this.getRanges(!0);try{for(var a=(0,s.__values)(i),c=a.next();!c.done;c=a.next()){var u=c.value;if(u.contains(e))return p.Xq.Contains;if(u.end()===e)return p.Xq.EndAt}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}var d=null===(r=(0,l.n6)(this)?this:this.getAncestorOf(l.uO.Page))||void 0===r?void 0:r.prevSibling;return d&&d.compareRangeTo(e)!==p.Xq.EndBefore?p.Xq.After:p.Xq.EndBefore}return p.Xq.Contains},t.prototype.isDiscrete=function(){return!1},Object.defineProperty(t.prototype,"firstChild",{get:function(){return this.childBoxes[0]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"firstVisibleChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastChild",{get:function(){return(0,m.Rz)(this.childBoxes)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastVisibleChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"children",{get:function(){return this.childBoxes},enumerable:!1,configurable:!0}),t.prototype.getDescendantOf=function(e,t){for(var n=t(this);n&&(0,l.$o)(n)!==e&&(0,l.Eb)(n);)n=t(n);return n&&(0,l.$o)(n)===e?n:void 0},t.prototype.getFirstDescendantOf=function(e,t){return this.getDescendantOf(e,null!=t?t:function(e){return e.firstChild})},t.prototype.getLastDescendantOf=function(e,t){return this.getDescendantOf(e,null!=t?t:function(e){return e.lastChild})},t.prototype.getChildrenInY=function(e,t){var n=new u.MeloRect({x:0,y:e,width:0,height:t});return this.getChildrenByRect(n,(function(e,t){return t.y<=e.getBottom()&&e.y<=t.getBottom()}))},t.prototype.getChildrenByRect=function(e,t){var n=this;if(this.childBoxes.length<1)return[];var r=t||function(e,t){return t.intersect(e)},o=this.edge.padding.top,i={x:this.edge.padding.left,y:o},a=[];return this.childBoxes.forEach((function(t){var o=t.totalBoxSize,s=new u.MeloRect({x:i.x,y:i.y,width:o.width,height:o.height});t.display===l.gy.Block?i.y+=o.height:n.display!==l.gy.Inline&&n.display!==l.gy.InlineBlock||(i.x+=o.width),r(e,s)&&a.push(t)})),a},t.prototype.getChildByPoint=function(e,t){var n=this;if(this.childBoxes.length<1)return[];var r,o=t||function(e,t){return t.contains(e)},i=this.edge.padding.top,a={x:this.edge.padding.left+this.edge.margin.left,y:i+this.edge.margin.top};return this.childBoxes.some((function(t){var i=t.rect,s=t.totalBoxSize;return i=new u.MeloRect({x:a.x,y:a.y,width:s.width,height:s.height}),t.display===l.gy.Block?a.y+=s.height:n.display!==l.gy.None&&(a.x+=s.width),!!o(e,i)&&(r=[t,{x:e.x-i.x,y:e.y-i.y}],!0)})),r||[]},t.prototype.clearChildren=function(){this.childBoxes=[]},t.prototype.append=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if(n&&!(n.length<1)){var o=this.childBoxes.length;n.forEach((function(e,n){t.childBoxes.push(e),t.onAppendChild(e,o+n)}))}},t.prototype.onAppendChild=function(e,t){e.setParentBox(this),e.setSiblingIndex(t),e.containFloating&&(this.containFloating=!0)},t.prototype.countNodes=function(e,t){var n=0;return e&&!e(this)||(n+=1),(null==t?void 0:t(this))||this.children.forEach((function(r){n+=r.countNodes(e,t)})),n},t.prototype.recycle=function(t){var n=this;this.childBoxes.forEach((function(e){e.parentBox===n&&(e.setParentBox(void 0),e.recycle(t))})),this.childBoxes=[],e.prototype.recycle.call(this,t)},t.prototype.onReuse=function(e){this.refreshBreakpoints(),this.containsPageBreakSignal&&!e.state.hasPageBreak()&&e.state.setPageBreak()},t.prototype.refreshBreakpoints=function(){if(this.breakpointCPs){var e=this.children.reduce((function(e,n){var r;return n instanceof t&&n.refreshBreakpoints(),e.concat(null!==(r=n.breakpointCPs)&&void 0!==r?r:[])}),[]);this.breakpointCPs=e.length>0?e:void 0}},t.create=function(e,t){return new e(t)},Object.defineProperty(t.prototype,"contentExtent",{get:function(){return(0,m.Sm)(this.children.map((function(e){return e.totalExtent})))},enumerable:!1,configurable:!0}),(0,s.__decorate)([(0,m.BK)(),(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",[Boolean]),(0,s.__metadata)("design:returntype",Array)],t.prototype,"getRanges",null),t}(f),C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._ascent=0,t._descent=0,t.contentWidth=0,t}return(0,s.__extends)(t,e),t.prototype.clone=function(t){var n=e.prototype.clone.call(this,t);return n._ascent=this._ascent,n._descent=this._descent,n.contentWidth=this.contentWidth,n.isFirst=this.isFirst,n.env&&n.rangesCache&&(n.env.beginGCPManager.insertGCP(n,n.rangesCache[0].gcpBegin),n.env.endGCPManager.insertGCP(n,n.rangesCache[0].end())),n},t.prototype.calculateRangesBeforEmit=function(){return e.prototype.calculateRanges.call(this)},t.prototype.calculateRanges=function(){var e=this.env.beginGCPManager.getGCP(this);if(void 0!==e){var t=this.env.endGCPManager.getGCP(this);if(void 0!==t)return[new c.ICE(e,t-e)]}return[]},Object.defineProperty(t.prototype,"ascent",{get:function(){return this._ascent?this._ascent:this.extent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"descent",{get:function(){return this._descent},enumerable:!1,configurable:!0}),t.prototype.setBaseline=function(e,t){this._ascent=e,this._descent=t},t.prototype.recycle=function(t){var n,r;e.prototype.recycle.call(this,t),(null!==(n=this.env)&&void 0!==n?n:t).beginGCPManager.deleteGCP(this),(null!==(r=this.env)&&void 0!==r?r:t).endGCPManager.deleteGCP(this)},Object.defineProperty(t.prototype,"firstVisibleChild",{get:function(){var e=void 0;return this.childBoxes.some((function(t){return e=t,!t.hidden})),e},enumerable:!1,configurable:!0}),t=(0,s.__decorate)([y({kind:l.uO.Line})],t)}(_),S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t.prototype.clone=function(t){var n=e.prototype.clone.call(this,t);if(this.listMark){var r=this.listMark.clone(t);r.lineBox=n,n.listMark=r}return n},Object.defineProperty(t.prototype,"listMarkOffsetLeft",{get:function(){var e,t,n,r=null===(t=null===(e=this.logicEdge)||void 0===e?void 0:e.padding)||void 0===t?void 0:t.start;return void 0!==r?r-((null===(n=this.listMark)||void 0===n?void 0:n.totalWidth)||0):0},enumerable:!1,configurable:!0}),t=(0,s.__decorate)([y({kind:l.uO.Line,predicate:function(e){return e.isListLine()}})],t)}(C);function w(e){if(e.rangeCache.isValid()&&e.parentBox&&void 0!==e.gcpOffsetToLine){var t=e.getAncestorOf(l.uO.Line);if(t){var n=t.getRangeBegin();if(n>=0){var r=n+e.gcpOffsetToLine;e.rangeCache.gcpBegin!==r&&(e.rangeCache.gcpBegin=r)}}}}function E(e){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t.prototype.getRangeBegin=function(){return w(this),this.rangeCache.gcpBegin},t.prototype.getRangeEnd=function(){return w(this),this.rangeCache.end()},t.prototype.getRange=function(e){return w(this),e?this.rangeCache:this.rangeCache.clone()},t.prototype.clone=function(t){var n,r=e.prototype.clone.call(this,t);return r.rangeCache=null===(n=this.rangeCache)||void 0===n?void 0:n.clone(),r.gcpOffsetToLine=this.gcpOffsetToLine,r},t.prototype.onReuse=function(){w(this),this.gcpOffsetToLine=void 0},t.prototype.getOuterPoint=function(){for(var e,t,n=new u.MeloPoint,r=this.prevSibling;r;)n.x+=r.totalMeasure,r=r.prevSibling;if(this.parentBox){var o=this.parentBox,i=null!==(t=null===(e=o.logicEdge)||void 0===e?void 0:e.padding)&&void 0!==t?t:p.vk.sZero;n.x+=i.start,n.y=i.before+o.ascent-this.ascent}return n},t}(e)}var x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.text="",t}return(0,s.__extends)(t,e),t.prototype.clone=function(t){var n=e.prototype.clone.call(this,t);return n.hangingGlue=this.hangingGlue,n.text=this.text,n.textGlyph=this.textGlyph,n.property=this.property,n},t.prototype.textString=function(){return this.text},Object.defineProperty(t.prototype,"textStyle",{get:function(){return this.property||new(c.kkf.getPropertyClass(c.uSS.RunProperty))},set:function(e){this.property=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"glyph",{get:function(){return this.textGlyph},set:function(e){this.textGlyph=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ascent",{get:function(){return this.glyph?this.glyph.ascent:this.extent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"descent",{get:function(){return this.glyph?this.glyph.descent:0},enumerable:!1,configurable:!0}),t.prototype.getRenderString=function(){return this.textString()},t=(0,s.__decorate)([y({kind:l.uO.Text})],t)}(E(g)),T=function(e){function t(t){var n=e.call(this,t)||this;return n.display=l.gy.InlineBlock,n}return(0,s.__extends)(t,e),t}(x),R=function(e){function t(t){return e.call(this,t)||this}return(0,s.__extends)(t,e),t}(x),I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t.prototype.textString=function(){return c.IfD.NoWidthOptionalBreak},t}(x),P=function(e){function t(t){var n=e.call(this,t)||this;return n.charType=c.P1W.undefined,n.hidden=!0,n}return(0,s.__extends)(t,e),t.prototype.clone=function(t){var n=e.prototype.clone.call(this,t);return n.charType=this.charType,n},t}(x),O=function(e){function t(){var t=e.call(this,p.wY.zero)||this;return t.hidden=!0,t}return(0,s.__extends)(t,e),t.prototype.textString=function(){return c.IfD.NoWidthOptionalBreak},t}(x),k=function(e){function t(t){var n=e.call(this,t)||this;return n.offsetLeft=0,n.offsetTop=0,n.display=l.gy.InlineBlock,n}return(0,s.__extends)(t,e),Object.defineProperty(t.prototype,"lineBox",{get:function(){return this._lineBox},set:function(e){this._lineBox=e,this.setParentBox(e)},enumerable:!1,configurable:!0}),t.prototype.getRangeBegin=function(){return-1},t.prototype.getRangeEnd=function(){return-1},t.prototype.getRange=function(){return c.ICE.invalidRange()},Object.defineProperty(t.prototype,"fontFamilyPrefix",{get:function(){var e,t,n,r=null===(t=null===(e=this.lineBox)||void 0===e?void 0:e.parentBox)||void 0===t?void 0:t.property;return r&&(r.isTask||r.isBullet&&!(null===(n=r.listMarkerSpanProp)||void 0===n?void 0:n.fontFamily))?"txdocfont,":""},enumerable:!1,configurable:!0}),t.prototype.clone=function(t){return e.prototype.clone.call(this,t)},t.prototype.getOuterPoint=function(){var t=e.prototype.getOuterPoint.call(this);if(this.parentBox instanceof S){var n=this.parentBox;t.x=n.listMarkOffsetLeft+this.offsetLeft,t.y+=this.offsetTop}return t},t}(x),D=function(e){function t(t){var n=e.call(this,t)||this;return n.renderString="",n.display=l.gy.InlineBlock,n}return(0,s.__extends)(t,e),t.prototype.updateRenderString=function(e){this.renderString=e},t.prototype.getRenderString=function(){return this.renderString||this.textString()},t.prototype.textString=function(){return c.IfD.NoWidthOptionalBreak},t}(x),M=function(e,t){var n;if(1===e.length){var r=e.charCodeAt(0);(0,c.jUV)(r)?n=new R(t):(0,c.CLV)(r)?n=new I(t):r===c.ghV.FieldBegin?(n=new P(t)).charType=c.P1W.begin:r===c.ghV.FieldSeparate?(n=new P(t)).charType=c.P1W.separate:r===c.ghV.FieldEnd?(n=new P(t)).charType=c.P1W.end:r===c.ghV.TableStart||r===c.ghV.TableEnd?n=new O:(0,c.wR4)(r)&&(n=new D(t))}return n||(n=new x(t)),n.text=e,n},A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t.prototype.isDiscrete=function(){var e,t;return!!(null===(e=this.firstChild)||void 0===e?void 0:e.isDiscrete())||!!(null===(t=this.lastChild)||void 0===t?void 0:t.isDiscrete())},t.prototype.calculateRanges=function(){return this.isDiscrete()?(0,b.HM)(this):e.prototype.calculateRanges.call(this)},t}(_),L=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),Object.defineProperty(t.prototype,"property",{get:function(){return this.sectionProperty},set:function(e){this.sectionProperty=e},enumerable:!1,configurable:!0}),t.prototype.initFromNode=function(e){this.sectionProperty=e.getProperty()},t=(0,s.__decorate)([y({kind:l.uO.Section})],t)}(A),n(95303)),N=(new(function(){function e(){}return e.prototype.measureAttributedText=function(e,t){for(var n=new L.UnicodeString(e),r=0,o=0;o<n.getGraphemeCount();o++){var i=n.getAllGraphemes()[o];(0,L.isHanScript)(i.codePoints[0])?r+=t.sz:r+=.5*t.sz}var a=1.3*t.sz;return{width:r,height:a,ascent:.8*a,descent:a*(1-.8)}},e.prototype.measureChar=function(e,t,n,r){return(0,s.__assign)((0,s.__assign)({},this.measureAttributedText(e.substring(n,r),t)),{offsetLeft:this.measureAttributedText(e.substring(0,n),t).width})},e.prototype.clearCache=function(){},e.prototype.invalidateMeasureCache=function(e){},e}()),n(20113)),B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layoutCursor=p.tp.zero(),t}return(0,s.__extends)(t,e),t.prototype.append=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];e.prototype.append.apply(this,(0,s.__spreadArray)([t],(0,s.__read)(n),!1)),this.refreshUUID()},t.prototype.onAppendChild=function(t,n){t.layoutCursor=new p.tp(this.layoutCursor.inlinePos,this.layoutCursor.blockPos),this.layoutCursor.blockPos+=t.totalHeight,e.prototype.onAppendChild.call(this,t,n)},t.prototype.clearChildren=function(){e.prototype.clearChildren.call(this),this.layoutCursor=p.tp.zero()},Object.defineProperty(t.prototype,"parentBox",{get:function(){},enumerable:!1,configurable:!0}),t.prototype.isEmpty=function(){return 0===this.children.length},t.prototype.refreshBreakpoints=function(){this.breakpointCPs&&this.lastChild&&(this.lastChild.refreshBreakpoints(),this.breakpointCPs=this.lastChild.breakpointCPs)},t.prototype.isDiscrete=function(){var e;return!!(null===(e=this.lastChild)||void 0===e?void 0:e.isDiscrete())},Object.defineProperty(t.prototype,"isPageFirst",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPageLast",{get:function(){return!0},enumerable:!1,configurable:!0}),t=(0,s.__decorate)([y({kind:l.uO.Document})],t)}(_),F=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nestingLevel=1,t.rowIndex=-1,t.hasPrev=!1,t}return(0,s.__extends)(t,e),Object.defineProperty(t.prototype,"firstContentChild",{get:function(){for(var e=this.firstChild;e&&e.getRangeBegin()===c.S$m;)e=e.nextSibling;return e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastContentChild",{get:function(){for(var e=this.lastChild;e&&e.getRangeBegin()===c.S$m;)e=e.prevSibling;return e},enumerable:!1,configurable:!0}),t.prototype.clone=function(t){return e.prototype.clone.call(this,t)},t.prototype.initFromNode=function(e){this.hasPrev=e.hasOffsets,this.rowIndex=e.getRowIndex()},t.prototype.calculateRangesBeforEmit=function(e){return this.calculateRanges(e)},t.prototype.isUnsafeToGetRangeBeforeEmitWithoutNode=function(){var e;return!this.hasNextPartial&&!!(null===(e=this.lastChild)||void 0===e?void 0:e.isEmptyPlaceholder())},t.prototype.calculateRanges=function(t){var n,r;if(!this.isDiscrete()){var o=null!==(r=null===(n=this.firstContentChild)||void 0===n?void 0:n.getRangeBegin())&&void 0!==r?r:c.S$m;if(o!==c.S$m){var i=this.calculateRangeEnd(t);if(i!==c.S$m)return[new c.ICE(o,i-o)]}return[]}var a=e.prototype.calculateRanges.call(this).slice();if(!this.hasNextPartial){var u=this.calculateRangeEnd(t);if(u===c.S$m)return b.No.warn.apply(b.No,(0,s.__spreadArray)((0,s.__spreadArray)([b.Qq.MissingPrevPartial],(0,s.__read)(a),!1),[l.uO[(0,l.$o)(this)]],!1)),a;if(0===a.length)return[new c.ICE(u-1,1)];var d=(0,m.Rz)(a);d.end()+1===u?a[a.length-1]=new c.ICE(d.gcpBegin,d.len+1):a.push(new c.ICE(u-1,1))}return a},t.prototype.calculateRangeEnd=function(e){var t=this.hasNextPartial?0:1;if(e)return e.getGCPRange().end()-1+t;if(!this.lastChild)return c.S$m;if(this.lastChild.isEmptyPlaceholder()){for(var n=this.prevPartial;n&&n.lastChild&&n.lastChild.isEmptyPlaceholder();)n=n.prevPartial;return(null==n?void 0:n.lastChild)?n.lastChild.getRangeEnd()+t:c.S$m}return this.lastChild.getRangeEnd()+t},Object.defineProperty(t.prototype,"isRootNesting",{get:function(){return this.nestingLevel===c.AQ},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPrevPartial",{get:function(){return this.hasPrev},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasNextPartial",{get:function(){return this.childBoxes.some((function(e){return!e.isMergeBegin&&void 0===e.mergedType&&!!e.breakpointCPs}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"prevPartial",{get:function(){var e;if(this.hasPrevPartial){var t=null===(e=this.getAncestorOf(l.uO.Page))||void 0===e?void 0:e.prevSibling;if(t)return t.getLastDescendantOf(l.uO.TableRow,(function(e){return e.lastVisibleChild}))}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextPartial",{get:function(){var e;if(this.hasNextPartial){var t=null===(e=this.getAncestorOf(l.uO.Page))||void 0===e?void 0:e.nextSibling;if(t)return t.getFirstDescendantOf(l.uO.TableRow,(function(e){return e.firstVisibleChild}))}},enumerable:!1,configurable:!0}),t.prototype.getRowBegin=function(){for(var e=this,t=e.prevPartial;t;)e=t,t=t.prevPartial;return e.getRangeBegin()},t.prototype.getRowEnd=function(){for(var e=this,t=e.nextPartial;t;)e=t,t=t.nextPartial;return e.getRangeEnd()},t.prototype.isDiscrete=function(){return this.hasPrev||!!this.breakpointCPs||this.children.some((function(e){return e.mergedType===l.Wl.Secondary}))},t=(0,s.__decorate)([y({kind:l.uO.TableRow})],t)}(_),U=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isEmpty=!1,t}return(0,s.__extends)(t,e),t.prototype.clone=function(t){var n=e.prototype.clone.call(this,t);return n.paraProperty=this.paraProperty,n},Object.defineProperty(t.prototype,"property",{get:function(){return this.paraProperty||new(c.kkf.getPropertyClass(c.uSS.ParagraphProperty))},set:function(e){this.paraProperty=e},enumerable:!1,configurable:!0}),t.prototype.refreshBreakpoints=function(){this.breakpointCPs&&(this.breakpointCPs=[this.getRangeEnd()-1])},t=(0,s.__decorate)([y({kind:l.uO.Paragraph})],t)}(_),H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t}(_),j=function(e){function t(t){var n=e.call(this,t)||this;return n.type=l.GT.Text,n.subType="",n.ascentVal=0,n.descentVal=0,n.contentWidth=0,n.layoutDisplay=l.gy.Inline,n}var n;return(0,s.__extends)(t,e),t.prototype.clone=function(t){var n=e.prototype.clone.call(this,t);return n.type=this.type,n.subType=this.subType,n.ascentVal=this.ascentVal,n.descentVal=this.descentVal,n.layoutDisplay=this.layoutDisplay,n.contentWidth=this.contentWidth,n},Object.defineProperty(t.prototype,"ascent",{get:function(){return this.ascentVal?this.ascentVal:this.extent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"descent",{get:function(){return this.descentVal},enumerable:!1,configurable:!0}),t.prototype.setBaseline=function(e,t){this.ascentVal=e,this.descentVal=t},Object.defineProperty(t.prototype,"display",{get:function(){return this.layoutDisplay},set:function(e){this.layoutDisplay=e},enumerable:!1,configurable:!0}),t.prototype.getOuterPoint=function(){for(var e,t,n=new u.MeloPoint,r=this.prevSibling;r;)n.x+=r.totalMeasure,r=r.prevSibling;if(this.parentBox){var o=null!==(t=null===(e=this.parentBox.logicEdge)||void 0===e?void 0:e.padding)&&void 0!==t?t:p.vk.sZero;n.x+=o.start}return n},t=(0,s.__decorate)([y({kind:l.uO.SubLine}),(0,s.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==l.ILogicalSize&&l.ILogicalSize)?n:Object])],t)}(E(H)),G=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.colWidths=[],t.rowHeights=[],t.tableId="",t.nestingLevel=c.AQ,t.hasPrev=!1,t.hasNext=!1,t}(0,s.__extends)(t,e),t.prototype.clone=function(t){var n=e.prototype.clone.call(this,t);return n.colWidths=(0,s.__spreadArray)([],(0,s.__read)(this.colWidths),!1),n.rowHeights=(0,s.__spreadArray)([],(0,s.__read)(this.rowHeights),!1),n.tableId=this.tableId,this.floatingSpace&&(n.floatingSpace=this.floatingSpace,t.curFloatingHost.addTableBox(n)),n},t.prototype.initFromNode=function(e){var t;this.tableId=e.tableId,this.hasPrev=e.hasOffsets,this.hasNext=!e.isReachEnd||!!(null===(t=this.lastChild)||void 0===t?void 0:t.breakpointCPs)},t.prototype.calculateRanges=function(){var t=e.prototype.calculateRanges.call(this);if(0===t.length)return[];if(this.hasPrev||(t[0]=t[0].clone(),t[0].gcpBegin-=1,t[0].len+=1),!this.hasNext){var n=(0,m.Rz)(t).clone();n.len+=1,t[t.length-1]=n}return t},Object.defineProperty(t.prototype,"contentSize",{get:function(){var e=0;this.children.forEach((function(t){e=Math.max(t.totalMeasure,e)}));var t=(0,l.vv)(this)?this.floatingSpace.size.extent:this.borderBoxSize.height;return{width:e,height:t}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rectSize",{get:function(){return{width:Math.min(this.contentSize.width,this.borderBoxSize.width),height:this.contentSize.height}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"extent",{get:function(){return(0,l.vv)(this)?0:this.logicalSize?this.logicalSize.extent:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalExtent",{get:function(){return(0,l.vv)(this)?0:this.extent+(this.logicEdge?this.logicEdge.extent:0)},enumerable:!1,configurable:!0}),t.prototype.getGCPRange=function(){},Object.defineProperty(t.prototype,"isRootNesting",{get:function(){return this.nestingLevel===c.AQ},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPrevPartial",{get:function(){return this.hasPrev},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasNextPartial",{get:function(){return this.hasNext},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"prevPartial",{get:function(){var e;if(this.hasPrevPartial){var t=null===(e=this.getAncestorOf(l.uO.Page))||void 0===e?void 0:e.prevSibling;if(t){var n=t.getLastDescendantOf(l.uO.Table,(function(e){return e.lastVisibleChild}));if(this.tableId===(null==n?void 0:n.tableId))return n}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextPartial",{get:function(){var e;if(this.hasNextPartial){var t=null===(e=this.getAncestorOf(l.uO.Page))||void 0===e?void 0:e.nextSibling;if(t){var n=t.getFirstDescendantOf(l.uO.Table,(function(e){return e.firstVisibleChild}));if(this.tableId===(null==n?void 0:n.tableId))return n}}},enumerable:!1,configurable:!0}),t.prototype.getTableBegin=function(){for(var e=this,t=e.prevPartial;t;)e=t,t=t.prevPartial;return e.getRangeBegin()},t.prototype.getTableEnd=function(){for(var e=this,t=e.nextPartial;t;)e=t,t=t.nextPartial;return e.getRangeEnd()},t.prototype.isDiscrete=function(){return this.hasPrev||this.hasNext},t.prototype.getOriginSizeBox=function(){return this},t=(0,s.__decorate)([y({kind:l.uO.Table})],t)}(_),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isMergeBegin=!1,t.isLastMerged=!1,t.colBegin=0,t.hasPrev=!1,t}return(0,s.__extends)(t,e),Object.defineProperty(t.prototype,"nestingLevel",{get:function(){return this.cellProperty.nestingLevel||c.AQ},enumerable:!1,configurable:!0}),t.prototype.clone=function(t){var n=e.prototype.clone.call(this,t);return n.cellProperty=this.cellProperty,n.isMergeBegin=this.isMergeBegin,n.mergedType=this.mergedType,n.isLastMerged=this.isLastMerged,n.colBegin=this.colBegin,n.hasPrev=this.hasPrev,n},t.prototype.recycle=function(t){var n;e.prototype.recycle.call(this,t),this.mergedType&&(null!==(n=this.env)&&void 0!==n?n:t).beginGCPManager.deleteGCP(this),this.isMergeBegin=!1,this.mergedType=void 0,this.isLastMerged=!1},t.prototype.calculateRangesBeforEmit=function(e){return this.calculateRanges(e)},t.prototype.isUnsafeToGetRangeBeforeEmitWithoutNode=function(){return void 0!==this.mergedType},t.prototype.calculateRanges=function(e){var t=this.calculateSelfRange(e);if(this.mergedType===l.Wl.Secondary){var n=this.childBoxes[0].getRange(!0);return this.breakpointCPs||(n=n.isValid()?new c.ICE(n.gcpBegin,n.len+1):n),this.hasPrev?[n]:[n,t]}if(0===this.childBoxes.length)return t?[t]:[];var r=this.childBoxes[0].getRanges(!0);return 1===r.length&&0===r[0].len||this.breakpointCPs?r:[new c.ICE(r[0].gcpBegin,r[0].len+1)]},t.prototype.calculateSelfRange=function(e){if(e)return void 0!==this.mergedType?e.getGCPRange():void 0;var t=this.env.beginGCPManager.getGCP(this);return void 0!==t?new c.ICE(t,2):void 0},t.prototype.getRange=function(t){if(void 0===this.mergedType)return e.prototype.getRange.call(this,t);var n=(0,m.Rz)(this.getRanges(!0));return n?t?n:n.clone():t?c.TUk:c.ICE.invalidRange()},t.prototype.initFromNode=function(e){this.cellProperty=e.getProperty(),this.mergedType=e.mergedType,this.isMergeBegin=e.isMergeBegin(),this.isLastMerged=e.isLastMerged(),this.colBegin=e.getColBegin(),this.hasPrev=e.hasOffsets},Object.defineProperty(t.prototype,"display",{get:function(){return this.mergedType===l.Wl.Hidden?l.gy.None:l.gy.InlineBlock},enumerable:!1,configurable:!0}),t.prototype.isNormal=function(){return!(this.isMergeBegin||this.mergedType||this.breakpointCPs||this.hasPrev)},Object.defineProperty(t.prototype,"vAlign",{get:function(){return this.cellProperty.vAlign},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"logicIndex",{get:function(){return this.getSiblingIndex()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"property",{get:function(){return this.cellProperty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRootNesting",{get:function(){return this.nestingLevel===c.AQ},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"noPaddingEdgeExtent",{get:function(){var e,t,n,r,o=null!==(e=this.logicEdge)&&void 0!==e?e:{},i=o.border,a=o.margin;return(null!==(n=null===(t=null==i?void 0:i.width)||void 0===t?void 0:t.extent)&&void 0!==n?n:0)+(null!==(r=null==a?void 0:a.extent)&&void 0!==r?r:0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPrevPartial",{get:function(){return this.hasPrev},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasNextPartial",{get:function(){return!!this.breakpointCPs},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"prevPartial",{get:function(){var e,t=this;if(this.hasPrevPartial){var n=null===(e=this.getAncestorOf(l.uO.Page))||void 0===e?void 0:e.prevSibling;if(n){var r=n.getLastDescendantOf(l.uO.TableRow,(function(e){return e.lastVisibleChild}));return null==r?void 0:r.children.find((function(e){return e.colBegin===t.colBegin}))}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextPartial",{get:function(){var e,t,n=this;if(this.hasNextPartial){var r=null===(e=this.getAncestorOf(l.uO.Page))||void 0===e?void 0:e.nextSibling;if(r){var o=r.getFirstDescendantOf(l.uO.TableRow,(function(e){return e.firstVisibleChild}));return null===(t=null==o?void 0:o.children)||void 0===t?void 0:t.find((function(e){return e.colBegin===n.colBegin}))}}},enumerable:!1,configurable:!0}),t.prototype.getCellBegin=function(){for(var e=this,t=e.prevPartial;t;)e=t,t=t.prevPartial;return e.getRangeBegin()},t.prototype.getCellEnd=function(){for(var e=this,t=e.nextPartial;t;)e=t,t=t.nextPartial;return e.getRangeEnd()},t.prototype.onReuse=function(t){var n;e.prototype.onReuse.call(this,t),(null===(n=this.logicEdge)||void 0===n?void 0:n.padding)&&(this.logicEdge.padding.before=0,this.logicEdge.padding.after=0)},t.prototype.refreshBreakpoints=function(){var t;(null===(t=this.childBoxes[0])||void 0===t?void 0:t.breakpointCPs)?e.prototype.refreshBreakpoints.call(this):this.breakpointCPs&&(this.breakpointCPs=[this.getRangeEnd()-1])},t.prototype.isEmptyPlaceholder=function(){return 0===this.childBoxes.length&&void 0===this.mergedType},Object.defineProperty(t.prototype,"equivalentMerginBegin",{get:function(){return this.isMergeBegin||this.mergedType===l.Wl.Secondary},enumerable:!1,configurable:!0}),t=(0,s.__decorate)([y({kind:l.uO.TableCell})],t)}(_)),V=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.number=1,t.pageIndex=0,t}return(0,s.__extends)(t,e),Object.defineProperty(t.prototype,"pageNumber",{get:function(){return this.number},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEven",{get:function(){return this.pageNumber%2==0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isOdd",{get:function(){return this.pageNumber%2==1},enumerable:!1,configurable:!0}),t.prototype.getPageIndex=function(){return this.pageIndex},Object.defineProperty(t.prototype,"isContinuous",{get:function(){return!!this.hiddenChildren},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"header",{get:function(){if(this.hiddenChildren)return this.hiddenChildren[0];var e=this.firstChild;return(0,l.AY)(e)?e:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"footer",{get:function(){if(this.hiddenChildren)return this.hiddenChildren[1];var e=this.lastChild;return(0,l.zd)(e)?e:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"body",{get:function(){return this.firstVisibleChild},enumerable:!1,configurable:!0}),t.prototype.initFromNode=function(e){this.number=e.pageNumber,this.pageIndex=e.pageIndex},t.prototype.cropBodyOuter=function(e){this.hiddenChildren=[this.header,this.footer];var t=this.childBoxes[1];t.layoutCursor&&(t.layoutCursor.blockPos=0),this.childBoxes=[t],e||(t.originExtent=t.extent,t.setExtent(t.children[0].totalExtent)),this.originExtent=this.extent,this.setExtent(t.extent)},Object.defineProperty(t.prototype,"firstVisibleChild",{get:function(){if((0,l.De)(this.firstChild)){var e=this.childBoxes[1];return(0,l.o2)(e)?e:void 0}return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastVisibleChild",{get:function(){if((0,l.De)(this.lastChild)){var e=this.childBoxes[this.childBoxes.length-2];return(0,l.o2)(e)?e:void 0}return this.lastChild},enumerable:!1,configurable:!0}),t.prototype.calculateRanges=function(){var e,t;return null!==(t=null===(e=this.body)||void 0===e?void 0:e.getRanges(!0))&&void 0!==t?t:[]},t.prototype.onReuse=function(t){var n,r;null===(n=this.header)||void 0===n||n.onReuse(t),null===(r=this.footer)||void 0===r||r.onReuse(t),e.prototype.onReuse.call(this,t)},t.prototype.isDiscrete=function(){var e;return!!(null===(e=this.body)||void 0===e?void 0:e.isDiscrete())},Object.defineProperty(t.prototype,"isPageFirst",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPageLast",{get:function(){return!1},enumerable:!1,configurable:!0}),t=(0,s.__decorate)([y({kind:l.uO.Page})],t)}(_),W=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.storyType=c.AHI.mainDocument,t}return(0,s.__extends)(t,e),t.prototype.clone=function(t){var n="body-".concat(Math.random().toString(16).substr(2,8));t.isPrintLayout&&t.floatingHostStack.pushEmpty(n);var r=e.prototype.clone.call(this,t);return r.storyType=this.storyType,r.storyId=this.storyId,t.isPrintLayout&&t.floatingHostStack.popEmpty(n),r},Object.defineProperty(t.prototype,"isPageFirst",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPageLast",{get:function(){return!0},enumerable:!1,configurable:!0}),t=(0,s.__decorate)([y({kind:l.uO.Body})],t)}(A),z=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),Object.defineProperty(t.prototype,"display",{get:function(){return l.gy.Inline},enumerable:!1,configurable:!0}),t=(0,s.__decorate)([y({kind:l.uO.RichTextArea})],t)}(A),n(2498)),K=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t.prototype.clone=function(t){var n="htr-".concat(Math.random().toString(16).substr(2,8));t.isPrintLayout&&t.floatingHostStack.pushEmpty(n);var r=e.prototype.clone.call(this,t);return r.storyType=this.storyType,r.storyId=this.storyId,r.parity=this.parity,t.constraintSpace.isEmpty()||(r.constraintSpace=t.constraintSpace),t.isPrintLayout&&t.floatingHostStack.popEmpty(n),r},t.prototype.initFromNode=function(e){this.storyId=e.storyId,this.storyType=e.storyType,this.parity=e.parity},t.prototype.onReuse=function(e){var t=(0,z.OH)(this.storyType,this.parity,this.storyId);e.getCachedBox(t)||e.cacheBox(this,t)},Object.defineProperty(t.prototype,"isPageFirst",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPageLast",{get:function(){return!0},enumerable:!1,configurable:!0}),t=(0,s.__decorate)([y({kind:l.uO.HeaderFooter})],t)}(_),q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t=(0,s.__decorate)([y({kind:l.uO.Empty})],t)}(E(g));function Y(e){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),Object.defineProperty(t.prototype,"ascent",{get:function(){return this.containFloating?0:this.totalExtent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"descent",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"logicSize",{get:function(){return this.containFloating?void 0:this.logicalSize},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"logicEdge",{get:function(){return this.containFloating?void 0:this.logicalEdge},set:function(e){this.logicalEdge=e},enumerable:!1,configurable:!0}),t.prototype.setMeasure=function(t){if(!this.containFloating)return e.prototype.setMeasure.call(this,t)},t.prototype.setExtent=function(t){if(!this.containFloating)return e.prototype.setExtent.call(this,t)},t.prototype.clone=function(t){var n=e.prototype.clone.call(this,t);return this.floatingSpace&&(n.floatingSpace=this.floatingSpace,t.curFloatingHost.constraintSpace.addFloatingBox(n)),n},t.prototype.getOriginSizeBox=function(){return this.containFloating?(this.originProxy||(this.originProxy=new Proxy(this,{get:function(e,t){if("containFloating"===t)return!1;e.containFloating=!1;var n=e[t];return e.containFloating=!0,n}})),this.originProxy):this},t}(e)}var Q,Z,X,J=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t.prototype.clone=function(t){var n=e.prototype.clone.call(this,t);return n.drawingProperty=this.drawingProperty,n},Object.defineProperty(t.prototype,"property",{get:function(){return this.drawingProperty},set:function(e){this.drawingProperty=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uniqueTypeId",{get:function(){return c.HgR.Picture},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){var e,t,n=this.getAncestorOf(l.uO.HeaderFooter);if(!(null===(e=this.property)||void 0===e?void 0:e.anchorId))return this.uuid;if(!n)return this.property.anchorId;var r=n.getAncestorOf(l.uO.Page);return"".concat(this.property.anchorId,"-").concat(null!==(t=null==r?void 0:r.getPageIndex())&&void 0!==t?t:0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shapeType",{get:function(){return l.DY.Rectangle},enumerable:!1,configurable:!0}),t=(0,s.__decorate)([y({kind:l.uO.Image})],t)}(Y(E(g))),$=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t.prototype.initFromNode=function(e){this.fieldPluginType=e.pluginType,this.fieldSubtype=e.fieldSubtype,this.fieldKey=e.key||this.uuid},t.prototype.clone=function(t){var n=e.prototype.clone.call(this,t);return n.fieldPluginType=this.pluginType,n.fieldSubtype=this.fieldSubtype,n.fieldKey=this.fieldKey,n.fieldInfo=this.fieldInfo,n},Object.defineProperty(t.prototype,"key",{get:function(){return this.fieldKey},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"independentRender",{get:function(){return this.fieldInfo.fieldCode.switches[c.VEu.independentRender]===c.UOC.True},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"borderRectSize",{get:function(){return this.borderBoxSize},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uniqueTypeId",{get:function(){return c.fSu},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shapeType",{get:function(){return l.DY.Rectangle},enumerable:!1,configurable:!0}),t=(0,s.__decorate)([y({kind:l.uO.FieldContainer})],t)}(E(g)),ee=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.typeId="",t}return(0,s.__extends)(t,e),Object.defineProperty(t.prototype,"borderRectSize",{get:function(){return this.borderBoxSize},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"property",{get:function(){return this.modelProperty},set:function(e){this.property=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uniqueTypeId",{get:function(){return this.typeId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.uuid},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shapeType",{get:function(){return l.DY.Rectangle},enumerable:!1,configurable:!0}),t.prototype.initFromNode=function(e){var t;this.modelProperty=null!==(t=e.getProperty())&&void 0!==t?t:void 0,this.typeId=e.uniqueTypeId},t=(0,s.__decorate)([y({kind:l.uO.LeafContainer})],t)}(E(g)),te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t}(_),ne=(function(e){function t(t,n){var r=e.call(this,t)||this;return r.storyId="",r.storyType=c.AHI.textboxContent,r.rangeCache=c.ICE.invalidRange(),r.textboxProperty=n,r}var n,r;(0,s.__extends)(t,e),Object.defineProperty(t.prototype,"content",{get:function(){return this.children[0]},enumerable:!1,configurable:!0}),t.prototype.clone=function(t){var n=e.prototype.clone.call(this,t);return n.drawingProperty=this.drawingProperty,n.textboxProperty=this.textboxProperty,n},t.prototype.initFromNode=function(e){this.drawingProperty=e.getProperty()},Object.defineProperty(t.prototype,"property",{get:function(){return this.drawingProperty},set:function(e){this.drawingProperty=e},enumerable:!1,configurable:!0}),t.prototype.containsRangeOrCP=function(e,t){var n;return void 0===t&&(t=!1),t?this.getRange(!0).contains(e)||(null===(n=this.childBoxes[0])||void 0===n?void 0:n.containsRangeOrCP(e)):this.getRange(!0).contains(e)},t.prototype.getFullRanges=function(e){var t=this.getRange(e);return t.isValid()&&this.children.length>0?[t,this.children[0].getRange(e)]:[]},t.prototype.countNodes=function(e,t){var n=0;return e&&!e(this)||(n+=1),(null==t?void 0:t(this))||this.children[0]&&(n+=this.children[0].countNodes(e,t)),n},t.prototype.findLongestPageBoxWidth=function(e){var t=e.edge,n=t.left,r=t.right;return e.children.every((function(e){return(0,l.wS)(e)&&e.firstChild}))?0===e.children.length?null:e.children.reduce((function(e,t){return e.firstChild.totalWidth>t.firstChild.totalWidth?e:t})).firstChild.totalWidth+n+r:null},Object.defineProperty(t.prototype,"contentSize",{get:function(){if(!this.firstChild||!this.property)return{width:0,height:0};var e=this.findLongestPageBoxWidth(this.firstChild),t=this.edge.padding,n=t.left,r=t.right,o=t.top,i=t.bottom;if(e){var a=e+n+r,s=this.totalWidth;return{width:a>s?a:s,height:this.firstChild.totalHeight+o+i}}return{width:this.firstChild.totalWidth+n+r,height:this.firstChild.totalHeight+o+i}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shapeType",{get:function(){return l.DY.Rectangle},enumerable:!1,configurable:!0}),t=(0,s.__decorate)([y({kind:l.uO.TextFrame}),(0,s.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==l.ILogicalSize&&l.ILogicalSize)?n:Object,"function"==typeof(r=void 0!==c.GUD&&c.GUD)?r:Object])],t)}(Y(E(te))),function(e){function t(t){var n=e.call(this,t)||this;return n.text="",n.containerType=c.lSx.Drawing,n.detailType=c.HgR.EmbeddedObject,n}var n,r;return(0,s.__extends)(t,e),n=t,t.obtain=function(e,t){var r=new n(t);return r.objectProperty=e,r},Object.defineProperty(t.prototype,"property",{get:function(){return this.objectProperty},set:function(e){this.objectProperty=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uniqueTypeId",{get:function(){return c.HgR.EmbeddedObject},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shapeType",{get:function(){return l.DY.Rectangle},enumerable:!1,configurable:!0}),t.prototype.textString=function(){return c.IfD.EmbeddedObjectAnchor},t.prototype.clone=function(t){var n=e.prototype.clone.call(this,t);return n.objectProperty=this.objectProperty,n},Object.defineProperty(t.prototype,"key",{get:function(){return this.uuid},enumerable:!1,configurable:!0}),t=n=(0,s.__decorate)([y({kind:l.uO.EmbeddedObject}),(0,s.__metadata)("design:paramtypes",["function"==typeof(r=void 0!==l.ILogicalSize&&l.ILogicalSize)?r:Object])],t)}(E(g))),re=n(82175),oe=n(97358),ie=function(){function e(e){this.context=e}return e.prototype.parse=function(e){var t=e.property;if(t&&t.drawingStates===c.Akw.Floating){var n=this.getCompatibleWrapDrawingData(e),r=n.posH,o=n.containerWidth,i={measure:o,extent:n.containerHeight},a=n.posV,s=re.z.obtain();s.padding=oe.v.zero,s.padding.start=(0,u.emuToTwips)(t.anchor.distL),s.padding.end=(0,u.emuToTwips)(t.anchor.distR),s.padding.after=(0,u.emuToTwips)(t.anchor.distB),s.padding.before=(0,u.emuToTwips)(t.anchor.distT);var l=this.getNoTransFormOffsetAndFixLimit(e,i.measure,i.extent,r,a),d=l.offsetLeft,p=l.offsetTop;return{id:t.anchorId,isFixed:n.wrapFixed,isOwnLine:n.wrapType===c.kCW.TopAndBottom,isExclude:this.isExclude(t),offset:{left:r-d,right:o+r-d,top:a-p,bottom:a+i.extent-p},size:i,edge:s,isBehind:t.anchor.behindDoc,zIndex:m.nU.getZIndex(t.anchor.relativeHeight,t.anchor.behindDoc)}}},e.prototype.getNoTransFormOffsetAndFixLimit=function(e,t,n,r,o){var i;if(!e.property)return{offsetLeft:0,offsetTop:0};var a=(t-(0,u.emuToTwips)(e.property.anchor.extent.cx))/2,s=(n-(0,u.emuToTwips)(e.property.anchor.extent.cy))/2;if(this.isExclude(e.property)&&!(null===(i=e.property)||void 0===i?void 0:i.isFixed)){var c=this.context.layoutRect.pageCoreRect;return{offsetLeft:r-Math.max(c.left,Math.min(c.right-t,r-a)),offsetTop:o-Math.max(c.top,Math.min(c.bottom-n,o-s))}}return{offsetLeft:a,offsetTop:s}},e.prototype.getCompatibleWrapDrawingData=function(e){var t=e.getOriginSizeBox(),n=t.property,r=(0,s.__assign)((0,s.__assign)({},c.Su2.getCompatibleWrapDrawingData(n)),{containerWidth:t.positionBoxSize.width+t.positionOutset.left+t.positionOutset.right,containerHeight:t.positionBoxSize.height+t.positionOutset.top+t.positionOutset.bottom}),o=n.anchor,i=o.positionH,a=o.positionV,l={width:r.containerWidth,height:r.containerHeight};return r.posH=this.getOffsetXFromPage(i,l,t),r.posV=this.getOffsetYFromPage(a,l,t),r},e.prototype.getFloatingId=function(e){return e.anchorId},e.prototype.isFixed=function(e){return e.isFixed},e.prototype.getOffsetXFromPage=function(e,t,n){var r=e.relativeFrom,o=e.posOffset,i=e.align,a=0,s=this.getHorizontalRect(r,n);switch(this.getHorizontalAlignType(i)){case c.fHH.left:a=-n.positionOutset.left;break;case c.fHH.center:a=(s.width-(t.width-n.positionOutset.left-n.positionOutset.right))/2;break;case c.fHH.right:a=s.width+n.positionOutset.right-t.width;break;case c.fHH.undefined:a=(0,u.emuToTwips)(o)}return a+s.left},e.prototype.getHorizontalRect=function(e,t){var n=this.context.layoutRect;switch(this.getHorizontalRelativeFrom(e)){case c.OO5.margin:return n.marginRect;case c.OO5.column:return n.columnRect;case c.OO5.leftMargin:return n.leftMarginRect;case c.OO5.rightMargin:return n.rightMarginRect;case c.OO5.page:return n.pageRect;case c.OO5.character:default:return n.getCharRect(t)}},e.prototype.getVerticalRect=function(e,t,n){var r=this.context.layoutRect;switch(this.getVerticalRelativeFrom(e)){case c.dxu.margin:return r.marginRect;case c.dxu.topMargin:return r.topMarginRect;case c.dxu.bottomMargin:return r.bottomMarginRect;case c.dxu.paragraph:return r.paragraphRect;case c.dxu.line:return r.getLineRect(n);case c.dxu.page:var o=this.context.layoutRect.pageRect.clone();return(t===c.eh1.inside||t===c.eh1.outside)&&o.height>1e3?(o.top+=500,o.bottom-=500,o):o}return r.pageRect},e.prototype.getHorizontalRelativeFrom=function(e){return e===c.OO5.insideMargin?this.context.isOddPage?c.OO5.leftMargin:c.OO5.rightMargin:e===c.OO5.outsideMargin?this.context.isOddPage?c.OO5.rightMargin:c.OO5.leftMargin:e},e.prototype.getOffsetYFromPage=function(e,t,n){var r=e.relativeFrom,o=e.posOffset,i=e.align,a=this.getVerticalRect(r,i,n);0===a.height&&((a=a.clone()).bottom+=a.top+t.height);var s=0;switch(this.getVerticalAlignType(i)){case c.eh1.top:s=-n.positionOutset.top;break;case c.eh1.center:s=(a.height-(t.height-n.positionOutset.top-n.positionOutset.bottom))/2;break;case c.eh1.bottom:s=a.height+n.positionOutset.bottom-t.height;break;case c.eh1.undefined:s=(0,u.emuToTwips)(o)||1}return a.top+s},e.prototype.getVerticalRelativeFrom=function(e){return e===c.dxu.insideMargin?this.context.isOddPage?c.dxu.topMargin:c.dxu.bottomMargin:e===c.dxu.outsideMargin?this.context.isOddPage?c.dxu.bottomMargin:c.dxu.topMargin:e},e.prototype.getVerticalAlignType=function(e){return e===c.eh1.inside?this.context.isOddPage?c.eh1.top:c.eh1.bottom:e===c.eh1.outside?this.context.isOddPage?c.eh1.bottom:c.eh1.top:e},e.prototype.getHorizontalAlignType=function(e){return e===c.fHH.inside?this.context.isOddPage?c.fHH.left:c.fHH.right:e===c.fHH.outside?this.context.isOddPage?c.fHH.right:c.fHH.left:e},e.prototype.isExclude=function(e){return!!e&&!e.anchor.wrapNone},e}(),ae=function(e){return e.logicEdge||re.z.sNone},se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t}(_),ce=function(e){function t(t){var n=e.call(this,t)||this;return n.type=l.GT.Field,n.subType="",n.ascentVal=0,n.descentVal=0,n.needUpdate=!1,n.layoutDisplay=l.gy.InlineBlock,n}var n;return(0,s.__extends)(t,e),t.prototype.clone=function(t){var n=e.prototype.clone.call(this,t);return n.subType=this.subType,n.ascentVal=this.ascentVal,n.descentVal=this.descentVal,n.layoutDisplay=this.layoutDisplay,n.fieldInfo=this.fieldInfo,n.fieldContext=this.fieldContext?(0,c.Bcl)(this.fieldContext):void 0,n},Object.defineProperty(t.prototype,"ascent",{get:function(){return this.ascentVal?this.ascentVal:this.totalExtent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"descent",{get:function(){return this.descentVal},enumerable:!1,configurable:!0}),t.prototype.setBaseline=function(e,t){this.ascentVal=e,this.descentVal=t},Object.defineProperty(t.prototype,"display",{get:function(){return this.layoutDisplay},set:function(e){this.layoutDisplay=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"content",{get:function(){var e=this.children[0];return(0,l.NF)(e)?e:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"firstVisibleChild",{get:function(){var e=void 0;return this.childBoxes.some((function(t){return e=t,!t.hidden})),e},enumerable:!1,configurable:!0}),t.prototype.containsRangeOrCP=function(e){return this.getRange(!0).contains(e)},Object.defineProperty(t.prototype,"lastVisibleChild",{get:function(){var e=void 0;return(0,s.__spreadArray)([],(0,s.__read)(this.children),!1).reverse().some((function(t){return e=t,!t.hidden})),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textBox",{get:function(){var e,t;try{for(var n=(0,s.__values)(this.children),r=n.next();!r.done;r=n.next()){var o=r.value;if(o instanceof x&&!(o instanceof P))return o}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return null},enumerable:!1,configurable:!0}),t.prototype.getOuterPoint=function(){var t,n,r=e.prototype.getOuterPoint.call(this);if(this.parentBox instanceof C){var o=this.parentBox,i=ae(o),a=this.logicEdge?this.logicEdge.before:0;r.y=(null!==(n=null===(t=i.padding)||void 0===t?void 0:t.before)&&void 0!==n?n:0)+o.ascent-this.ascent-a;var s=this.textBox;(null==s?void 0:s.textStyle.vertAlign)===c.TBk.superscript?r.y-=Math.round(s.textStyle.sz/2):(null==s?void 0:s.textStyle.vertAlign)===c.TBk.subscript&&(r.y+=Math.round(s.textStyle.sz/12))}return r},t=(0,s.__decorate)([y({kind:l.uO.Field}),(0,s.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==l.ILogicalSize&&l.ILogicalSize)?n:Object])],t)}(E(se));!function(e){e[e.Start=0]="Start",e[e.Default=1]="Default",e[e.PlaceHolder=2]="PlaceHolder",e[e.SeparatorCategory=3]="SeparatorCategory",e[e.PageBreak=4]="PageBreak",e[e.LineBreak=5]="LineBreak",e[e.SectionBreak=6]="SectionBreak",e[e.Tabstop=7]="Tabstop",e[e.HardParagraphBreak=8]="HardParagraphBreak"}(X||(X={}));var le=((Q={})[c.SW1.hyphen]="-",Q[c.SW1.dot]=".",Q[c.SW1.underscore]="_",Q[c.SW1.middleDot]="",Q[c.SW1.undefined]="",Q[c.SW1.heavy]="",Q[c.SW1.none]="",Q),ue=((Z={})[c.V_x.hyphen]=c.SW1.hyphen,Z[c.V_x.dot]=c.SW1.dot,Z[c.V_x.underscore]=c.SW1.underscore,Z[c.V_x.middleDot]=c.SW1.middleDot,Z[c.V_x.undefined]=c.SW1.undefined,Z[c.V_x.none]=c.SW1.none,Z);function de(e){var t;if(e instanceof x){var n=null===(t=e.glyphBoxes)||void 0===t?void 0:t[0];return n&&n.getTokenType()===X.SeparatorCategory}return!1}function pe(e){var t;if(e instanceof x){var n=null===(t=e.glyphBoxes)||void 0===t?void 0:t[0];return n&&n.getTokenType()===X.LineBreak}return!1}function he(e){var t;if(e instanceof x){var n=null===(t=e.glyphBoxes)||void 0===t?void 0:t[0];return n&&n.getTokenType()===X.SectionBreak}return!1}function fe(e){var t;if(e instanceof x){var n=null===(t=e.glyphBoxes)||void 0===t?void 0:t[0];return n&&n.getTokenType()===X.HardParagraphBreak}return!1}function ge(e,t){var n={height:0,width:0,descent:0,ascent:0},r="",o=0;e.forEach((function(e){n.width+=e.glyph.width,n.height=Math.max(e.glyph.height,n.height),n.descent=Math.max(e.glyph.descent,n.descent),n.ascent=Math.max(e.glyph.ascent,n.ascent),r+=e.text,o+=e.length}));var i=M(r||"",{measure:n.width,extent:n.height});i.glyph=n,i.textStyle=t;var a=new c.ICE(e[0].gcp,o);return i.rangeCache=a,i.glyphBoxes=e,i}var ve,ye=function(){function e(){this.defaultTextStyle=new(c.kkf.getPropertyClass(c.uSS.RunProperty))}return e.prototype.setDefaultTextStyle=function(e){this.defaultTextStyle=e},e.prototype.shapeToken=function(e,t){return this.measureToken(e,t)},e}(),me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t.prototype.measureToken=function(e,t){var n=t||this.defaultTextStyle;return h.dp.getDefaultEngine().measureAttributedText(e,n)},t}(ye),be=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.measureToken=function(e,t){var n=1.2*(0,u.twipsToPt)(t.sz||c.keb.fontSize),r=new N.UString(e);return{width:(0,u.twipsToPt)(t.sz||c.keb.fontSize)*r.graphemeCount(),height:n,ascent:.8*n,descent:n*(1-.8)}}}(ye),function(){function e(){if(this.context=document.createElement("canvas").getContext("2d"),null===this.context)throw Error("Canvas 2D Context ")}return Object.defineProperty(e.prototype,"shaper",{get:function(){return this._shaper||(this._shaper=new me),this._shaper},enumerable:!1,configurable:!0}),e.prototype.oldMeasure=function(e,t){return this.shaper.shapeToken(e,t)},e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.measureText=function(e,t){t&&(this.context.font=t);var n=this.context.measureText(e),r=n.width,o=n.actualBoundingBoxAscent,i=n.actualBoundingBoxDescent,a=n.fontBoundingBoxDescent;return{width:r,height:o+i,ascent:n.fontBoundingBoxAscent,descent:a}},e}()),_e=function(){function e(e,t){this.text=e,this.runProperty=t}return e.prototype.getTokenType=function(){var e,t,n;return this.tokenType||(this.tokenType=(e=this.text,t=e.charCodeAt(0),n=X.Default,(0,L.isSeparatorCategory)(t)?X.SeparatorCategory:e.length>1?n:n=(0,c.p1d)(t)?X.PageBreak:(0,c.EDJ)(t)?X.SectionBreak:(0,c.jUV)(t)?X.LineBreak:(0,c.wR4)(t)?X.Tabstop:(0,c.gw8)(t)?X.HardParagraphBreak:X.Default)),this.tokenType},Object.defineProperty(e.prototype,"glyph",{get:function(){if(this.text.length>500)return{descent:0,ascent:0,height:1,width:999999};if(!this.textGlyph){var e=this.processBeforeMeasure(this.text),t=be.getInstance().oldMeasure(e,this.runProperty);this.textGlyph=this.processAfterMeasure(t)}return this.textGlyph},enumerable:!1,configurable:!0}),e.prototype.processBeforeMeasure=function(e){switch(this.getTokenType()){case X.LineBreak:return c.IfD.NonBreakSpace;case X.PageBreak:case X.SectionBreak:return c.IfD.NoWidthOptionalBreak;default:return e}},e.prototype.processAfterMeasure=function(e){return this.getTokenType()===X.Tabstop?(0,s.__assign)((0,s.__assign)({},e),{width:c.keb.tabSize}):this.getTokenType()===X.SectionBreak||this.getTokenType()===X.PageBreak?(0,s.__assign)((0,s.__assign)({},e),{width:2400}):e},e}(),Ce=function(e){function t(t,n,r){var o=e.call(this,t.text,r)||this;return o.stringSlice=t,o.gcp=n+o.stringSlice.startIndex,o}return(0,s.__extends)(t,e),t}(_e),Se=function(e){function t(t,n,r){var o=e.call(this,t.text,r)||this;return o.stringSlice=t,o.gcp=n+o.stringSlice.startIndex,o}return(0,s.__extends)(t,e),Object.defineProperty(t.prototype,"length",{get:function(){return this.stringSlice.text.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"unicodeString",{get:function(){return this.uString||(this.uString=new L.UnicodeString(this.stringSlice.text)),this.uString},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"graphemeBoxList",{get:function(){var e=this;if(!this.graphemeBoxes){var t=new L.UnicodeString(this.stringSlice.text).getAllGraphemes();this.graphemeBoxes=t.map((function(t){return new Ce(t,e.gcp)}))}return this.graphemeBoxes},enumerable:!1,configurable:!0}),t.prototype.splitBySize=function(e,n){var r,o;if(void 0===n&&(n=!1),this.text.length>500){o=0;for(var i=0;this.text[o]&&(i+=l=be.getInstance().oldMeasure(this.text[o],this.runProperty).width)<e;)o+=1}else{var a=0,s=this.unicodeString.getAllGraphemes().length;for(o=s;;){var c=Math.floor((s-a)/2+a);if(c<=a){o=a;break}var l,u=this.unicodeString.sliceByGrapheme(0,c).text;if((l=be.getInstance().oldMeasure(u,this.runProperty).width)<e)a=c;else{if(!(l>e)){o=c;break}s=c}}o=null!==(r=this.unicodeString.getAllGraphemes()[o].startIndex-this.stringSlice.startIndex)&&void 0!==r?r:0}var d=this.stringSlice.startIndex;return new t({startIndex:d,endIndex:d+(o=n?Math.max(o,1):o),text:this.stringSlice.text.slice(0,o),codePoints:(0,N.toCodePoints)(this.text)},this.gcp,this.runProperty)},t}(_e),we=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.getRangeBegin=function(){return this.prevSibling?this.prevSibling.getRangeEnd():c.S$m},t.prototype.getRangeEnd=function(){return this.getRangeBegin()},t.prototype.getRange=function(){return this.prevSibling?new c.ICE(this.prevSibling.getRangeEnd(),0):c.ICE.invalidRange()},t=(0,s.__decorate)([y({kind:l.uO.Endnote})],t)}(_),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.refreshBreakpoints=function(){var e;this.children.forEach((function(e){return e.refreshBreakpoints()})),this.breakpointCPs=null===(e=this.lastChild)||void 0===e?void 0:e.breakpointCPs},t=(0,s.__decorate)([y({kind:l.uO.Columns})],t)}(A),function(){function e(){}return e.getOffsetPoint=function(t,n){return e.getBoxOffset(t,(function(e){return(0,l.$o)(e)===n}))},e.getBoxOffset=function(t,n){for(var r=0,o=0,i=t;i&&!n(i);)if((0,l.vv)(i)){var a=e.getFloatingBoxOffset(i,n);r+=a.x,o+=a.y,i=a.box}else{var s=i.getOuterPoint();if(r+=s.x,o+=s.y,(i=i.parentBox)&&!n(i)){var c=i.edge;if((0,l.vv)(i)){r+=c.border.width.left,o+=c.border.width.top;continue}r+=c.border.width.left+c.margin.left,o+=c.border.width.top+c.margin.top,c.recycle()}}return{x:r,y:o}},e.findParent=function(e,t){for(var n=e;n;){if((0,l.$o)(n)===t)return n;n=n.parentBox}},e.getGrandsonByPoint=function(e,t,n){for(var r=n,o=e;;){var i=(0,s.__read)(o.getChildByPoint(r),2),a=i[0],c=i[1];if(!a||!c)break;if((0,l.$o)(a)===t)return[a,c];if(!(0,l.Gz)(a))break;o=a,r=c}return[]},e.getLeastGrandsonByPoint=function(e,t){for(var n=t,r=e;;){var o=(0,s.__read)(r.getChildByPoint(n),2),i=o[0],a=o[1];if(!i||!a)break;if(!(0,l.Gz)(i))break;r=i,n=a}return[r,n]},e.getPrevBox=function(e){if(e&&!(0,l.Kg)(e)){var t=this.getPrevSibling(e);if(!t){var n=this.getPrevBox(e.parentBox);n&&(t=n.lastChild)}return t}},e.isSeekBoundaryBox=function(e){return(0,l.Kg)(e)||(0,l.De)(e)},e.getPrevBoxSkipHidden=function(e){if(e&&!this.isSeekBoundaryBox(e)){for(var t=this.getPrevSibling(e);!0===(null==t?void 0:t.hidden);)t=this.getPrevSibling(t);if(!t){var n=this.getPrevBoxSkipHidden(e.parentBox);n&&(t=n.lastChild)}return t}},e.getNextBox=function(e){if(e&&!this.isSeekBoundaryBox(e)){var t=this.getNextSibling(e);if(!t){var n=this.getNextBox(e.parentBox);n&&(t=n.firstChild)}return t}},e.getNextBoxSkipHidden=function(e){if(e&&!this.isSeekBoundaryBox(e)){for(var t=this.getNextSibling(e);!0===(null==t?void 0:t.hidden);)t=this.getNextSibling(t);if(!t){var n=this.getNextBoxSkipHidden(e.parentBox);n&&(t=n.firstChild)}return t}},e.getNextLineBox=function(e){for(var t=this.getVerticalNextBox(e);t;){var n=this.getVerticalLineBox(t,!0);if(n)return n;t=this.getVerticalNextBox(e)}return t},e.getVerticalNextLineBox=function(e){if(e instanceof C){for(var t=this.getNextSibling(e);t&&t.isEmptyLine;)t=this.getNextSibling(t);if(!t)for(var n=this.getVerticalNextBox(e.parentBox);n;){if(t=this.getVerticalLineBox(n,!0))return t;n=this.getVerticalNextBox(n)}return t}},e.getVerticalPrevLineBox=function(e){if(e instanceof C){for(var t=this.getPrevSibling(e);t&&t.isEmptyLine;)t=this.getPrevSibling(t);if(!t)for(var n=this.getVerticalPrevBox(e.parentBox);n;){if(t=this.getVerticalLineBox(n,!1))return t;n=this.getVerticalPrevBox(n)}return t}},e.getVerticalNextBox=function(e){if(e&&!(e instanceof B)){if(e instanceof G&&e.parentBox){var t=this.getNextBox(e.parentBox);if(t&&(0,l.sJ)(t)){var n=new u.MeloPoint;n.x=e.colBegin+1;var r=(0,s.__read)(t.getChildByPoint(n),1)[0];if(r)return r}return this.getVerticalNextBox(e.parentBox)}var o=this.getNextSibling(e);return!o&&e.parentBox?this.getVerticalNextBox(e.parentBox):o}},e.getVerticalPrevBox=function(e){if(e&&!(e instanceof B)){if(e instanceof G&&e.parentBox){var t=this.getPrevBox(e.parentBox);if(t&&(0,l.sJ)(t)){var n=new u.MeloPoint;n.x=e.colBegin+1;var r=(0,s.__read)(t.getChildByPoint(n),1)[0];if(r)return r}return this.getVerticalPrevBox(e.parentBox)}var o=this.getPrevSibling(e);return!o&&e.parentBox?this.getVerticalPrevBox(e.parentBox):o}},e.getVerticalLineBox=function(e,t){var n=t;e instanceof F&&!t&&(n=!t);for(var r=n?e.firstChild:e.lastChild;r;){if(r instanceof C&&this.isValidLineBox(r))return r;var o=this.getVerticalLineBox(r,t);if(o)return o;r=n?this.getNextSibling(r):this.getPrevSibling(r)}},e.isValidLineBox=function(e){return e.firstChild&&!(e.firstChild instanceof O)},e.getNextSibling=function(e){var t=e.nextSibling;return((0,l.$5)(e)||(0,l.YP)(e))&&e.nextPartial&&(t=e.nextPartial),t},e.getPrevSibling=function(e){var t=e.prevSibling;return((0,l.$5)(e)||(0,l.YP)(e))&&e.prevPartial&&(t=e.prevPartial),t},e.getOffsetByPosition=function(e,t){var n=e.textString();if(n){var r=new N.UString(n);return this.binarySearchPosition(r,e,t,0,r.graphemeCount(),n.length)}return{offset:0,offsetUString:0,offsetPx:0}},e.binarySearchPosition=function(e,t,n,r,o,i){if(o-r>1){var a=Math.floor((r+o)/2),s=h.dp.getDefaultEngine().measureChar(t.textString(),t.textStyle,e.graphemeIndex2CharCodeIndexRange(r).start,e.graphemeIndex2CharCodeIndexRange(a).start),c=s.width,l=s.offsetLeft;return n<=(0,u.twipsToPx)(l+c)?this.binarySearchPosition(e,t,n,r,a,i):this.binarySearchPosition(e,t,n,a,o,i)}var d=h.dp.getDefaultEngine().measureChar(t.textString(),t.textStyle,e.graphemeIndex2CharCodeIndexRange(r).start,e.graphemeIndex2CharCodeIndexRange(r).end+1>i?i:e.graphemeIndex2CharCodeIndexRange(r).end+1),p=d.width,f=d.offsetLeft;return n<=(0,u.twipsToPx)(f+p/2)?{offset:r,offsetUString:e.graphemeIndex2CharCodeIndexRange(r).start,offsetPx:(0,u.twipsToPx)(f)}:{offset:o,offsetUString:e.graphemeIndex2CharCodeIndexRange(r).end+1,offsetPx:(0,u.twipsToPx)(f+p)}},e.isBoxInTableCell=function(e,t){void 0===t&&(t=!0);var n,r=e;for(n=t?l.$5:l.UO;r&&!n(r);)r=r.parentBox;return!!r},e.getLatestPageBoxOfFloatingBox=function(t){var n=t.getAncestorOf(l.uO.Document),r=null==n?void 0:n.children;if(!Array.isArray(r))return[];var o=t.floatingSpace.offset,i=o.top,a=o.bottom;return r.filter((function(t){var n,r,o,s,c=e.getOffsetPoint(t,l.uO.Document),u=c.y+t.totalHeight-(null!==(r=null===(n=t.footer)||void 0===n?void 0:n.totalHeight)&&void 0!==r?r:0)-(null!==(s=null===(o=t.header)||void 0===o?void 0:o.totalHeight)&&void 0!==s?s:0);return i>=c.y&&i<=u||a>=c.y&&a<=u}))||[]},e.getPageIndex=function(e){for(var t=e;t;){if((0,l.n6)(t))return t.getSiblingIndex();t=t.parentBox}return 0},e.getFloatingBoxOffset=function(t,n){for(var r=t,o=void 0;r;){if(n(r)&&!o&&(o=r),(0,l.Cx)(r)&&r.constraintSpace.attachBox){(0,l.o2)(r)&&(r=r.parentBox);break}r=r.parentBox}var i=t.floatingSpace.offset.left,a=t.floatingSpace.offset.top;if(o===r||!o)return{x:i,y:a,box:r};var s=e.getBoxOffset(o,(function(e){return e===r}));return{x:i-s.x,y:a-s.y,box:o}},e}()),Ee=function(){function e(){}return e.getPrevTableBox=function(e){var t=e.parentBox;if((0,l.wS)(t)){var n=we.getPrevSibling(t);if(n&&n.property instanceof c.kkf.getPropertyClass(c.uSS.TableProperty)){var r=we.getPrevSibling(n);return(0,l.YP)(r)?r:void 0}}},e.getNextTableBox=function(e){var t=e.parentBox;if((0,l.wS)(t)){var n=we.getNextSibling(t);if(n&&n.property instanceof c.kkf.getPropertyClass(c.uSS.TableProperty)){var r=we.getNextSibling(n);return(0,l.YP)(r)?r:void 0}}},e.emptyCellAfterPage=function(e){return!!e.prevPartial&&0===e.children.length},e.realCell=function(e){if(e){if(this.isRealCell(e))return e;for(var t=e,n=!1;!this.isRealCell(t);){if(n||(n=this.isSameRowWithRealCell(t)&&!!t.mergedType),!n&&this.emptyCellAfterPage(t)){if(t=t.prevPartial,this.isRealCell(t))return t;n||(n=this.isSameRowWithRealCell(t)&&!!t.mergedType)}var r=n?this.getLeftCell(t):this.getUpCell(t);if(!r)return;if(t=r,this.isRealCell(t))return t}return t}},e.isRealCell=function(e){return e.isMergeBegin||e.mergedType===l.Wl.Secondary},e.getUpCell=function(e){var t=e.parentBox.prevSibling;if(t)return t.children[e.getSiblingIndex()]},e.getDownCell=function(e){var t=e.parentBox.nextSibling;if(t)return t.children[e.getSiblingIndex()]},e.getLeftCell=function(e){return e.prevSibling},e.isSameRowWithRealCell=function(e){if(!e.mergedType)return!1;if(this.isRealCell(e))return!0;if(this.emptyCellAfterPage(e)){for(var t=e;t;){if(!t.mergedType){if(!this.emptyCellAfterPage(t))return!0;break}t=this.getLeftCell(t)}return!1}var n=this.getUpCell(e);return!(n&&!n.isLastMerged&&(n.mergedType||n.isMergeBegin))},e.crossPageLeftDownCell=function(e){var t=this.realCell(e);if(t){if(!t.mergedType&&!t.isMergeBegin)return e;for(;t;){var n=this.getDownCell(t);if(!n){if(!we.getNextBox(t.parentBox))return t;t=t.parentBox.children[t.getSiblingIndex()]}if(null==n?void 0:n.isLastMerged)return n;t=n}}},e.isCrossPageFinalRow=function(e){var t=e.parentBox;return!!t&&!we.getNextBox(t)},e.getPosFromLineToTableCell=function(e,t,n){if(void 0===n&&(n=!0),n?!t.nextSibling:!t.prevSibling){var r,o=n?this.getNextTableBox(t):this.getPrevTableBox(t);if(o&&((n?o.firstChild:o.lastChild).children.slice(1,-1).forEach((function(t){(0,u.twipsToPx)(we.getOffsetPoint(t,l.uO.TableRow).x)<e&&(r=t)})),(0,l.$5)(r))){var i=this.realCell(r);if((0,l.$5)(i)){var a=(0,u.pxToTwips)(e)-we.getOffsetPoint(i,l.uO.RichTextArea).x,s=we.getVerticalLineBox(i,n);if(s)return{lineInTablePos:a,lineInTableBox:s}}}}},e.getPosFromTableCellToLine=function(e,t,n){void 0===n&&(n=!0);var r=t.getAncestorOf(l.uO.TableCell);if((0,l.$5)(r)){var o=r.parentBox,i=o.parentBox,a=this.crossPageLeftDownCell(r);if((0,l.$5)(a)){var s=t.parentBox;if((0,l.wS)(s)&&(n?!t.nextSibling&&!s.nextSibling&&this.isCrossPageFinalRow(a):!t.prevSibling&&1===s.getSiblingIndex()&&0===(null==o?void 0:o.getSiblingIndex()))){var c=we.getOffsetPoint(r,l.uO.RichTextArea).x+(0,u.pxToTwips)(e),d=n?i.nextSibling:i.prevSibling;if((0,l.wS)(d)){var p=n?d.nextSibling:d.prevSibling;if((0,l.wS)(p)){var h=we.getVerticalLineBox(p,n);if((0,l.o7)(h))return{lineOutsideTablePos:c,lineOutsideTableBox:h}}}}}}},e.getFirstTableBox=function(e){for(var t=e,n=we.getPrevBox(e);n&&(0,l.YP)(n)&&n.tableId===e.tableId;)t=n,n=we.getPrevBox(t);return t},e.getLastTableBox=function(e){for(var t=e,n=we.getNextBox(e);n&&(0,l.YP)(n)&&n.tableId===e.tableId;)t=n,n=we.getNextBox(t);return t},e.getTableBoxes=function(e){for(var t=[e],n=we.getPrevBox(e),r=e;n&&(0,l.YP)(n);)t.unshift(n),r=n,n=we.getPrevBox(r);for(var o=we.getNextBox(e),i=e;o&&(0,l.YP)(o);)t.push(o),i=o,o=we.getNextBox(i);return t},e.isOutestTableBox=function(e){return!!(0,l.YP)(e)&&e.nestingLevel===c.AQ},e.getOutestTableBox=function(t){for(var n=t;n&&!e.isOutestTableBox(n)&&!(0,l.t$)(n);)n=n.parentBox;if((0,l.YP)(n))return n},e.isOutestTableBoxLite=function(e){return!!(0,l.hE)(e)&&e.nestingLevel===c.AQ},e.getOutestTableBoxLite=function(t){for(var n=t;n&&!e.isOutestTableBoxLite(n)&&!(0,l.t$)(n);)n=n.parentBox;if((0,l.hE)(n))return n},e.getRelatedTableBoxes=function(e,t,n){for(var r=[],o=[e];o.length>0;){var i=o.shift();(0,l.YP)(i)&&i.nestingLevel===n&&t(i.getRangeBegin())?r.push(i):n===c.AQ&&(0,l.wS)(i)||(null==i?void 0:i.children)&&i.children.forEach((function(e){(0,l.Eb)(e)&&o.push(e)}))}return r},e}();!function(e){e[e.VERTICAL_PREV=0]="VERTICAL_PREV",e[e.VERTICAL_NEXT=1]="VERTICAL_NEXT"}(ve||(ve={}));var xe,Te=function(){function e(){}return e.filterNextLineBoxForHeaderFooter=function(e,t,n){if(void 0===n&&(n=!0),!t)return t;var r=n?ve.VERTICAL_NEXT:ve.VERTICAL_PREV;if(this.isBodyToHeaderFooter(e,t)){var o=e.getAncestorOf(l.uO.Page),i=n?null==o?void 0:o.nextSibling:null==o?void 0:o.prevSibling;return i&&i instanceof V?we.getVerticalLineBox(i.body,n):e}if(this.isHeaderFooterToBody(e,t)){var a=this.findNextHeaderFooter(e,r);return a?we.getVerticalLineBox(a,n):e}return t},e.findNextHeaderFooter=function(e,t){var n,r=e.getAncestorOf(l.uO.HeaderFooter),o=e.getAncestorOf(l.uO.Page),i=t===ve.VERTICAL_NEXT?null==o?void 0:o.nextSibling:null==o?void 0:o.prevSibling,a=(null==r?void 0:r.storyType)===c.AHI.headerContent;switch(t){case ve.VERTICAL_NEXT:n=a?null==o?void 0:o.footer:null==i?void 0:i.header;break;case ve.VERTICAL_PREV:n=a?null==i?void 0:i.footer:null==o?void 0:o.header}return n},e.isBodyToHeaderFooter=function(e,t){return!!e.getAncestorOf(l.uO.Body)&&!!t.getAncestorOf(l.uO.HeaderFooter)},e.isHeaderFooterToBody=function(e,t){return!!e.getAncestorOf(l.uO.HeaderFooter)&&!!t.getAncestorOf(l.uO.Body)},e}(),Re=function(){function e(){var e=this;this.floatingSpaces=new Map,this.floatingBoxes=new Map,this.children=[],this.additionalSpace=[],this.cacheFloatingInfo=null,this.counter={behind:0,wrap:0},this.containsBehind=function(){return e.counter.behind>0},this.containsWrapping=function(){return e.counter.wrap>0},this.containsFloating=function(){return e.floatingSpaces.size>0}}return e.prototype.floatingOnceExisted=function(){return this.floatingBoxes.size>0},Object.defineProperty(e.prototype,"maxBottom",{get:function(){var e=0;return this.floatingSpaces.forEach((function(t){e=Math.max(t.offset.bottom||0,e)})),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxTop",{get:function(){var e=0;return this.floatingSpaces.forEach((function(t){e=Math.max(t.offset.top||0,e)})),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minBottom",{get:function(){var e=0;return this.floatingSpaces.forEach((function(t){t.isExclude&&(e=Math.max(t.offset.bottom,e))})),e},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return 0===this.floatingBoxes.size&&0===this.children.length&&0===this.additionalSpace.length},e.prototype.addChildren=function(e){this.children.indexOf(e)>-1||(this.children.push(e),this.setParent(this))},e.prototype.getChildren=function(){return this.children},e.prototype.setParent=function(e){this.parent=e},e.prototype.offsetTopOfRelative=function(e){var t,n;try{for(var r=(0,s.__values)(this.floatingSpaces),o=r.next();!o.done;o=r.next()){var i=(0,s.__read)(o.value,2)[1];i.isFixed||(i.offset.top+=e,i.offset.bottom+=e)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e.prototype.addFloating=function(e){var t=e.id;if(t){var n=this.floatingBoxes.get(t);this.deleteFloating(t),this.floatingSpaces.set(t,e),this.updateCount(e,1),n&&(n.floatingSpace=e,this.floatingBoxes.set(t,n))}},e.prototype.deleteFloating=function(e){var t=this.floatingSpaces.get(e);t&&(this.updateCount(t,-1),this.floatingSpaces.delete(e)),this.floatingBoxes.delete(e)},e.prototype.pushAdditionalSpace=function(e){e&&this.additionalSpace.push(e)},e.prototype.collectBlankSpace=function(){var e,t,n=[];try{for(var r=(0,s.__values)(this.floatingSpaces),o=r.next();!o.done;o=r.next()){var i=(0,s.__read)(o.value,2)[1];this.floatingBoxes.has(i.id)||n.push(i)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},e.prototype.updateCount=function(e,t){e.isExclude?this.counter.wrap+=t:e.isBehind&&(this.counter.behind+=t)},e.prototype.splitLineSlice=function(t,n){var r=t.width,o=t.left,i=this.getCrossExclusions(t);return 0===i.length?[{measure:r,offsetLeft:0}]:e.getRemainingSpace(i,r,o,n)},e.prototype.getCrossExclusions=function(t){var n=[];return this.floatingSpaces.forEach((function(r){e.isLineCrossedExclusion(r,t)&&n.push(r)})),n.sort((function(e,t){return e.offset.left-t.offset.left})),n},e.prototype.hasCrossExclusions=function(t){var n,r;try{for(var o=(0,s.__values)(this.floatingSpaces),i=o.next();!i.done;i=o.next()){var a=(0,s.__read)(i.value,2)[1];if(e.isLineCrossedExclusion(a,t))return!0}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!1},e.prototype.merge=function(e){var t,n,r=this;if(e){var o=e.getFloatingBoxes();try{for(var i=(0,s.__values)(o),a=i.next();!a.done;a=i.next()){var c=(0,s.__read)(a.value,2),l=c[0],u=c[1];this.floatingBoxes.has(l)||this.addFloatingBox(u)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}e.getChildren().forEach((function(e){r.addChildren(e)}))}},e.prototype.getAllFloatingInfo=function(){var e,t,n,r,o=this;if(this.cacheFloatingInfo)return this.cacheFloatingInfo;var i=[];try{for(var a=(0,s.__values)(this.floatingBoxes),c=a.next();!c.done;c=a.next()){var l=(0,s.__read)(c.value,2)[1];i.push({box:l,offset:{y:l.floatingSpace.offset.top,x:l.floatingSpace.offset.left},isAdditional:!1})}}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}try{for(var u=(0,s.__values)(this.additionalSpace),d=u.next();!d.done;d=u.next()){var p=d.value;i.push.apply(i,(0,s.__spreadArray)([],(0,s.__read)(p.getAllFloatingInfo().map((function(e){return(0,s.__assign)((0,s.__assign)({},e),{isAdditional:!0})}))),!1))}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}return this.children.forEach((function(e){if(e.attachBox){var t=we.getBoxOffset(e.attachBox,(function(e){return e===o.attachBox}));e.getAllFloatingInfo().forEach((function(e){i.push({box:e.box,offset:{x:e.offset.x+t.x,y:e.offset.y+t.y},isAdditional:!1})}))}})),this.cacheFloatingInfo=i,i},e.prototype.addFloatingBox=function(e){this.addFloating(e.floatingSpace),this.floatingBoxes.set(e.floatingSpace.id,e)},e.isLineCrossedExclusion=function(e,t){if(!e.isExclude)return!1;var n=t.top,r=t.left,o=t.height,i=t.width,a=e.offset;return!(n>a.bottom||n+o<a.top||r+i<a.left||r>a.right)},e.getRemainingSpace=function(e,t,n,r){var o=[],i=t+n,a=n,s=0;return e.some((function(e){if(e.isOwnLine)return o=[],i=0,!0;var t=d.obtain(e.edge),n=t.padding.left,c=t.padding.right,l=e.size.measure+n+c,u=e.offset.left-r-n;return u<=a?(s+=Math.max(a,u+l)-a,a=Math.max(a,u+l),!1):(o.push({measure:Math.min(u-a,i-a),offsetLeft:s}),s=l,(a=u+l)>=i)})),a<i&&o.push({measure:i-a,offsetLeft:s}),o},e.prototype.getFloatingBoxByPosition=function(e,t){var n;return(null===(n=this.getFloatingInfoByPosition(e,t))||void 0===n?void 0:n.box)||null},e.prototype.getFloatingInfoByPosition=function(e,t){var n=this.getAllFloatingInfo().filter((function(n){var r=n.box,o=n.offset,i=r.floatingSpace.size,a=i.measure,s=i.extent;return e>o.x&&e<o.x+a&&t>o.y&&t<o.y+s})).sort((function(e,t){return e.box.floatingSpace.zIndex-t.box.floatingSpace.zIndex}));return n[n.length-1]||null},e.prototype.getFloatingBoxes=function(){return this.floatingBoxes},e.prototype.getFloatingBox=function(e){return this.floatingBoxes.get(e)},e.prototype.getFloatingSpace=function(e){return this.floatingSpaces.get(e)},e.prototype.getOffsetYByCursor=function(e,t){void 0===t&&(t=!1);var n=this.getCrossExclusions(e);if(!n||n.length<=0)return 0;var r=n[0].offset.bottom;return n.forEach((function(e){r=t?Math.max(e.offset.bottom,r):Math.min(e.offset.bottom,r)})),r-e.top+1},e}();new Map,function(e){e[e.TableRowLine=0]="TableRowLine",e[e.FrameTextLine=1]="FrameTextLine",e[e.TextLine=2]="TextLine",e[e.HeaderOrFooterLine=3]="HeaderOrFooterLine",e[e.Page=4]="Page",e[e.Column=5]="Column"}(xe||(xe={}));var Ie,Pe,Oe=function(){function e(){this.cursorStateStack=[xe.TextLine]}return e.prototype.getState=function(){return this.cursorStateStack[this.cursorStateStack.length-1]},e.prototype.saveState=function(e){void 0===e&&(e=xe.TextLine),this.cursorStateStack.push(e)},e.prototype.popState=function(){this.cursorStateStack.length>1&&this.cursorStateStack.pop()},e.prototype.shouldSkipSplit=function(){var e=new Set([xe.FrameTextLine,xe.HeaderOrFooterLine,xe.TableRowLine]);return this.cursorStateStack.some((function(t){return e.has(t)}))},e}(),ke=function(){function e(e){void 0===e&&(e={}),this.top=e.top||0,this.bottom=e.bottom||0,this.right=e.right||0,this.left=e.left||0}return Object.defineProperty(e.prototype,"width",{get:function(){return this.right-this.left},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.bottom-this.top},enumerable:!1,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.left=this.left,t.right=this.right,t.bottom=this.bottom,t.top=this.top,t},e}(),De=function(){function e(e,t){this.host=e,this.pageRect=new ke,this.marginRect=new ke,this.columnRect=new ke,this.paragraphRect=new ke,this.pageRegion=t,this.initRect(t)}return e.prototype.initRect=function(e){var t,n;this.pageRect.top=-(null!==(t=e.continueHiddenTop)&&void 0!==t?t:0),this.pageRect.bottom=-(null!==(n=e.continueHiddenBottom)&&void 0!==n?n:0),this.pageRect.right=e.measure,this.pageRect.bottom=e.extent,this.marginRect.top=e.margins.top,this.marginRect.left=e.margins.left,this.marginRect.right=e.measure-e.margins.right,this.marginRect.bottom=e.extent-e.margins.bottom,this.columnRect=this.marginRect.clone()},Object.defineProperty(e.prototype,"leftMarginRect",{get:function(){return new ke({right:this.pageRegion.margins.left})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightMarginRect",{get:function(){return new ke({left:this.marginRect.right,right:this.pageRect.right})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottomMarginRect",{get:function(){return new ke({top:this.marginRect.bottom,bottom:this.pageRect.bottom})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"topMarginRect",{get:function(){return new ke({bottom:this.marginRect.top})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageCoreRect",{get:function(){return new ke((0,s.__assign)((0,s.__assign)({},this.pageRect),{top:this.pageRect.top+(this.pageRegion.headerExtent||0),bottom:this.pageRect.bottom-(this.pageRegion.footerExtent||0)}))},enumerable:!1,configurable:!0}),e.prototype.getLineRect=function(e){var t=e.parentBox;if(!t)return this.paragraphRect;var n=we.getOffsetPoint(t,l.uO.Paragraph).y+this.paragraphRect.top;return new ke({top:n,bottom:n+t.totalExtent,right:t.totalMeasure})},e.prototype.getCharRect=function(e){if(!e)return this.paragraphRect;var t=we.getOffsetPoint(e,l.uO.Paragraph).x,n=this.paragraphRect.left+t;return new ke({left:n,right:n})},e}();!function(e){e[e.Inside=0]="Inside",e[e.Overflow=1]="Overflow"}(Ie||(Ie={})),function(e){e[e.Page=0]="Page",e[e.RichTextArea=1]="RichTextArea",e[e.Body=2]="Body",e[e.HeaderFooter=3]="HeaderFooter"}(Pe||(Pe={}));var Me,Ae=function(){function e(e,t,n){this.context=e,this.direction=t,this.content=n}return e.prototype.isEmpty=function(){return this.content.isEmpty()},e.prototype.clear=function(){this.content.clear()},e.prototype.getMaxContentMeasure=function(){var e,t=this.context.boxEnv;return t.contentMaxMeasure?t.contentMaxMeasure:t.fixedMeasure?t.fixedMeasure:null!==(e=t.maxMeasure)&&void 0!==e?e:Number.POSITIVE_INFINITY},e.prototype.getMaxContentExtent=function(){var e,t=this.context.boxEnv;return t.contentMaxExtent?t.contentMaxExtent:t.fixedExtent?t.fixedExtent:null!==(e=t.maxExtent)&&void 0!==e?e:Number.POSITIVE_INFINITY},e.prototype.getContentMeasure=function(){return this.content.inlinePos},e.prototype.getContentExtent=function(){return this.content.blockPos},e.prototype.getMeasure=function(){var e,t=this.context.boxEnv;if(t.fixedMeasure)return t.fixedMeasure;var n=Math.min(this.getContentMeasure(),null!==(e=t.maxMeasure)&&void 0!==e?e:Number.POSITIVE_INFINITY);return t.minMeasure?Math.max(t.minMeasure,n):n},e.prototype.getExtent=function(){var e,t=this.context.boxEnv;if(t.fixedExtent)return t.fixedExtent;var n=this.getContentExtent(),r=t.flexibleMaxExtent?n:Math.min(n,null!==(e=t.maxExtent)&&void 0!==e?e:Number.POSITIVE_INFINITY);return t.minExtent?Math.max(t.minExtent,r):r},e.prototype.getMaxContentRestMeasure=function(){return this.direction===l.U6.Block?this.getMaxContentMeasure():this.getMaxContentMeasure()-this.getContentMeasure()},e.prototype.getMaxContentRestExtent=function(){return this.direction===l.U6.Inline?this.getMaxContentExtent():this.getMaxContentExtent()-this.getContentExtent()},e.prototype.isOverflow=function(e){var t=this.getMaxFlowMetric();return!(!this.content.willOverflow(e,t)||this.context.boxEnv.nonSplitChildOverflow&&this.isContentEmpty())},e.prototype.isContentEmpty=function(){return this.content.isEmpty()},e.prototype.getMaxFlowMetric=function(){return this.direction===l.U6.Block?this.getMaxContentExtent():this.getMaxContentMeasure()},e.prototype.push=function(e){e.layoutCursor=new p.tp(this.direction===l.U6.Block?0:this.content.inlinePos,this.direction===l.U6.Block?this.content.blockPos:0),this.content.push(e)},e.prototype.pop=function(){return this.content.pop()},e.prototype.createBoxMetric=function(){return{size:this.createBoxSize(),edge:this.createEdge()}},e.prototype.createEdge=function(){var e;return null!==(e=this.context.boxEnv.edge)&&void 0!==e?e:p.z6.obtain()},e.prototype.createBoxSize=function(){return p.wY.obtain({measure:this.getMeasure(),extent:this.getExtent()})},e.prototype.getContentChildren=function(){return this.content.getChildren()},e.prototype.getBlockPos=function(e){var t=this.direction===l.U6.Block?this.content.blockPos:0;return this.context.parentContext?t+this.context.parentContext.container.getBlockPos(e):t},e.prototype.getInlinePos=function(e){var t=this.direction===l.U6.Inline?this.content.inlinePos:0;return this.context.parentContext?t+this.context.parentContext.container.getInlinePos(e):t},e}(),Le=function(){function e(e){this.direction=e,this.children=[],this.pos=0,this.diameters=[],this.children=[]}return e.prototype.getFlowMetric=function(e){return this.direction===l.U6.Block?e.totalExtent:e.totalMeasure},e.prototype.getFlowDiameter=function(e){return this.direction===l.U6.Block?e.totalMeasure:e.totalExtent},e.prototype.isEmpty=function(){return 0===this.children.length},e.prototype.push=function(e){this.children.push(e),this.pos+=this.getFlowMetric(e),this.diameters.push(this.getFlowDiameter(e))},e.prototype.pop=function(){var e=this.children.pop();return e&&(this.pos-=this.getFlowMetric(e),this.diameters.pop()),e},e.prototype.update=function(){var e=this,t=0;this.diameters=this.children.map((function(n){return t+=e.getFlowMetric(n),e.getFlowDiameter(n)})),this.pos=t},e.prototype.willOverflow=function(e,t){return e?this.pos+this.getOverflowFlowMetric(e)>t:this.pos>t},e.prototype.getOverflowFlowMetric=function(e){var t,n,r;return this.direction===l.U6.Block?e.totalExtent-(null!==(r=null===(n=null===(t=e.logicEdge)||void 0===t?void 0:t.margin)||void 0===n?void 0:n.after)&&void 0!==r?r:0):e.totalMeasure},e.prototype.clear=function(){this.children=[],this.diameters=[],this.pos=0},e.prototype.getChildren=function(){return this.children},Object.defineProperty(e.prototype,"count",{get:function(){return this.children.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inlinePos",{get:function(){return this.direction!==l.U6.Block?this.pos:this.flowDiameter},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blockPos",{get:function(){return this.direction===l.U6.Block?this.pos:this.flowDiameter},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"flowPos",{get:function(){return this.pos},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"flowDiameter",{get:function(){return Math.max.apply(Math,(0,s.__spreadArray)([0],(0,s.__read)(this.diameters),!1))},enumerable:!1,configurable:!0}),e}(),Ne=function(e){function t(t,n){return void 0===n&&(n=new Le(l.U6.Block)),e.call(this,t,l.U6.Block,n)||this}return(0,s.__extends)(t,e),t.prototype.isSealed=function(){return!!this.context.env.state.isBlockBreaked()&&Number.isFinite(this.getMaxContentExtent())},t}(Ae),Be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t}(Ne),Fe=function(e){function t(){return e.call(this,l.U6.Block)||this}return(0,s.__extends)(t,e),t.prototype.push=function(t){(0,l.o2)(t)&&0===this.children.length?e.prototype.push.call(this,t):u.Logger.error("[layout] Only one body box is allowed to VirtualPageContent.")},t}(Le),Ue=function(e){function t(){return e.call(this,l.U6.Block)||this}return(0,s.__extends)(t,e),t.prototype.push=function(e){if((0,l.AY)(e)){if(this.header)return void u.Logger.error("[Layout] Cannot push HeaderBox into PageContent since Header already exists.");this.header=e}else if((0,l.zd)(e)){if(this.footer)return void u.Logger.error("[Layout] Cannot push FooterBox into PageContent since Footer already exists.");this.footer=e}else{if(!(0,l.o2)(e))return void u.Logger.error("[Layout] Cannot push ".concat(l.uO[(0,l.$o)(e)],"Box into PageContent."));if(!this.isEmpty())return void u.Logger.error("[Layout] Cannot push more than one BodyBox into PageContent in PagedView.");this.children.push(e)}this.pos+=e.totalExtent},t.prototype.pop=function(){var t;if(!this.isEmpty())return e.prototype.pop.call(this);if(this.footer){var n=this.footer;return this.footer=void 0,this.pos-=n.totalExtent,n}return this.header?(n=this.header,this.header=void 0,this.pos-=null!==(t=n.totalExtent)&&void 0!==t?t:0,n):void 0},t.prototype.clear=function(){e.prototype.clear.call(this),this.header=void 0,this.footer=void 0},t.prototype.hasHeader=function(){return!!this.header},t.prototype.hasFooter=function(){return!!this.footer},t.prototype.getHeader=function(){return this.header},t.prototype.getFooter=function(){return this.footer},t.prototype.getChildren=function(){return(0,s.__spreadArray)((0,s.__spreadArray)([this.header],(0,s.__read)(this.children),!1),[this.footer],!1).filter((function(e){return!!e}))},Object.defineProperty(t.prototype,"flowDiameter",{get:function(){var e,t,n,r;return Math.max.apply(Math,(0,s.__spreadArray)([null!==(t=null===(e=this.header)||void 0===e?void 0:e.totalMeasure)&&void 0!==t?t:0,null!==(r=null===(n=this.footer)||void 0===n?void 0:n.totalMeasure)&&void 0!==r?r:0],(0,s.__read)(this.diameters),!1))},enumerable:!1,configurable:!0}),t}(Le),He=function(e){function t(t){return e.call(this,t,t.env.isPrintLayout?new Ue:new Fe)||this}return(0,s.__extends)(t,e),t.prototype.push=function(e){var t,n,r=new p.tp(0,this.content.blockPos);this.content instanceof Ue&&((0,l.o2)(e)?r.blockPos-=null!==(n=null===(t=this.content.getFooter())||void 0===t?void 0:t.totalExtent)&&void 0!==n?n:0:(0,l.zd)(e)&&(r.blockPos=this.getExtent()-e.totalExtent)),e.layoutCursor=r,this.content.push(e)},t.prototype.getBlockPos=function(t){return t===Pe.Page?0:e.prototype.getBlockPos.call(this,t)},t}(Ne),je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t.prototype.getInlinePos=function(t){var n,r,o,i=null!==(o=null===(r=null===(n=this.context.boxEnv.edge)||void 0===n?void 0:n.padding)||void 0===r?void 0:r.start)&&void 0!==o?o:0;return t===Pe.HeaderFooter?(this.direction===l.U6.Inline?this.content.inlinePos:0)+i:e.prototype.getInlinePos.call(this,t)+i},t.prototype.getBlockPos=function(e){var t,n,r,o=this.context.node.isHeader&&null!==(r=null===(n=null===(t=this.context.boxEnv.edge)||void 0===t?void 0:t.padding)||void 0===n?void 0:n.before)&&void 0!==r?r:0;return e===Pe.HeaderFooter?(this.direction===l.U6.Block?this.content.blockPos:0)+o:o},t}(Ne),Ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t.prototype.getInlinePos=function(){var e,t,n;return null!==(n=null===(t=null===(e=this.context.boxEnv.edge)||void 0===e?void 0:e.padding)||void 0===t?void 0:t.start)&&void 0!==n?n:0},t.prototype.getBlockPos=function(t){var n,r,o;if(t===Pe.Body)return this.direction===l.U6.Block?this.content.blockPos:0;var i=null===(n=this.context.parentContext)||void 0===n?void 0:n.container.content;if(i instanceof Ue){if((0,c.OqL)(this.context.env.docEnv.layoutType))return(null!==(o=null===(r=i.getHeader())||void 0===r?void 0:r.totalExtent)&&void 0!==o?o:0)+e.prototype.getBlockPos.call(this,t);if((0,c.WGN)(this.context.env.docEnv.layoutType))return c.keb.printLayout.continuous.paddingTop+e.prototype.getBlockPos.call(this,t)}return e.prototype.getBlockPos.call(this,t)},t}(Ne),Ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t.prototype.getInlinePos=function(){var e,t,n;return null!==(n=null===(t=null===(e=this.context.boxEnv.edge)||void 0===e?void 0:e.padding)||void 0===t?void 0:t.start)&&void 0!==n?n:0},t}(Ne),We=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t.prototype.getExtent=function(){return this.getContentExtent()},t.prototype.getBlockPos=function(t){var n,r,o,i;return e.prototype.getBlockPos.call(this,t)+((null===(i=null===(o=null===(r=null===(n=this.context)||void 0===n?void 0:n.boxEnv)||void 0===r?void 0:r.edge)||void 0===o?void 0:o.margin)||void 0===i?void 0:i.before)||0)},t.prototype.isContentEmpty=function(){return this.content.isEmpty()||this.content.getChildren().every((function(e){return e.isEmptyLine}))},t}(Ne),ze=function(e){function t(t,n){return void 0===n&&(n=new Le(l.U6.Inline)),e.call(this,t,l.U6.Inline,n)||this}return(0,s.__extends)(t,e),t}(Ae),Ke=function(e){function t(t){return e.call(this,t)||this}return(0,s.__extends)(t,e),Object.defineProperty(t.prototype,"maxParaMeasure",{get:function(){return this.context.parentContext?this.context.parentContext.container.getMaxContentMeasure():1/0},enumerable:!1,configurable:!0}),t.prototype.getMaxContentMeasure=function(){var t,n;return this.context.wrapLineInfo.isSubLine?null!==(n=null===(t=this.context.splitResult)||void 0===t?void 0:t.measure)&&void 0!==n?n:0:e.prototype.getMaxContentMeasure.call(this)},t.prototype.computeMetric=function(e){var t=void 0,n=this.getContentChildren().reduce((function(n,r){var o,i,a,s;return(0,l.Oi)(r)||(0,l.tJ)(r)?(n.fontAscent=Math.max(n.fontAscent,0),n.fontDescent=Math.max(n.fontDescent,0)):r instanceof ce&&r.wholeLine?(n.fontAscent=Math.max(n.fontAscent,(null===(o=r.content)||void 0===o?void 0:o.ascent)||0),n.fontDescent=Math.max(n.fontDescent,(null===(i=r.content)||void 0===i?void 0:i.descent)||0)):(n.fontAscent=Math.max(n.fontAscent,r.ascent),n.fontDescent=Math.max(n.fontDescent,r.descent),r instanceof x&&(t=!!t||r.textStyle.vertAlign===c.TBk.baseline)),n.lineAscent=Math.max(n.lineAscent,r.ascent),n.lineDescent=Math.max(n.lineDescent,r.descent,1.3*c.keb.fontSize*.2),r instanceof g?e.maxFontSize=Math.max(e.maxFontSize,null!==(s=null===(a=r.textStyle)||void 0===a?void 0:a.sz)&&void 0!==s?s:0):r instanceof ce&&(e.maxFontSize=Math.max(e.maxFontSize,r.content&&r.content.textStyle.sz||0)),n}),e);return!1===t?this.computeMetricWithoutBaselineText(n):n},t.prototype.computeLinePadding=function(e,n,r,o){void 0===o&&(o=this.getMaxContentMeasure());var i=this.context.boxEnv,a=i.paraProperty,s=i.sectionProperty,c=this.context.node.dataManager.getSettingsManager().getDocSettingsProperty(!0),l=t.computeLineTotalExtent(n,e.fontAscent,e.fontDescent,a,s),u=this.computeLinePaddingLeft(r,o),d=t.computeLinePaddingTopBottom(this.context.env.isPrintLayout,c,a,s,l,n,e.lineAscent),h=d.paddingTop,f=d.paddingBottom;return new p.vk({before:h,start:u,after:f,end:0})},t.prototype.computeMetricWithoutBaselineText=function(e){var t,n=e,r=(0,s.__read)(this.findMetricRefTextBox(e),2),o=r[0],i=r[1];return o&&(t=this.computeBaselineGlyphFromTextBox(o),n.fontAscent=Math.max(n.fontAscent,t.ascent),n.lineAscent=Math.max(n.lineAscent,t.ascent+ae(o).before)),i&&i!==o&&(t=this.computeBaselineGlyphFromTextBox(i),n.fontDescent=Math.max(n.fontDescent,t.descent),n.lineDescent=Math.max(n.lineDescent,t.descent+ae(i).after)),n},t.prototype.computeBaselineGlyphFromTextBox=function(e){var t=e.textStyle;return t.vertAlign!==c.TBk.superscript&&t.vertAlign!==c.TBk.subscript||((t=t.clone()).vertAlign=c.TBk.baseline),be.getInstance().shaper.shapeToken(" ",t)},t.prototype.findMetricRefTextBox=function(e){var t,n,r=void 0,o=void 0;try{for(var i=(0,s.__values)(this.getContentChildren()),a=i.next();!a.done;a=i.next()){var c=a.value;if(c instanceof x&&(c.ascent===e.fontAscent&&(r=c),c.descent===e.fontDescent&&(o=c),r&&o))break}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return[r,o]},t.calcSnapToGridHeight=function(e,t,n,r){var o=r.docGrid;if(this.isSnapToGrid(n,r)){var i=o.linePitch;return i*Math.max(Math.ceil(e/i),t)}return-1},t.isSnapToGrid=function(e,t){var n=t.docGrid;return e.snapToGrid&&n.type!==c.C0n.undefined&&n.type!==c.C0n.default},t.prototype.getAlignType=function(){var e,t=this.getContentChildren()[0];return t&&!this.context.env.isPrintLayout&&((0,l.qM)(t)||(0,l.tJ)(t))&&(null===(e=t.property)||void 0===e?void 0:e.isFloating)?c.aLG.center:this.context.boxEnv.paraProperty.jc},t.prototype.computeLinePaddingLeft=function(e,t){var n;switch(this.getAlignType()){case c.aLG.right:n=t-e;break;case c.aLG.center:case c.aLG.distribute:n=(t-e)/2;break;default:n=0}return n<0&&(u.Logger.error("Error linePadding=".concat(n)),n=0),n},t.computeLinePaddingTopBottom=function(e,t,n,r,o,i,a){var s=0;if(e)switch(n.spacing.lineRule){case c.NRl.undefined:case c.NRl.auto:s=this.isSnapToGrid(n,r)?(o-i)/2:0;break;case c.NRl.exact:s=t.compat.noExtraLineSpacing?0:Math.max(.8*o-a,0);break;case c.NRl.atLeast:var l=this.calcSnapToGridHeight(i,1,n,r);s=l>0?l>n.spacing.line?(o-i)/2:Math.max(.8*o-a,0):o-i}else s=(o-i)/2;var u=o-s-i;if(u<0){var d=(i-i/1.3)/2;s=o-(u=Math.max(Math.max((o-i)/2,-d),u))-i}return{paddingTop:s,paddingBottom:u}},t.computeLineTotalExtent=function(e,t,n,r,o){var i=t+n,a=e,s=e-i,l=r.spacing,u=l.line,d=0===u?1:u/c.jLu.autoLineRule;switch(l.lineRule){case c.NRl.undefined:case c.NRl.auto:a=(p=this.calcSnapToGridHeight(e,d,r,o))>0?p:i*d+s;break;case c.NRl.exact:a=u+s;break;case c.NRl.atLeast:var p;a=(p=this.calcSnapToGridHeight(e,1,r,o))>0?p>u?p:u:(i=i>u?i:u)+s;break;default:a=i+s}return a},t.prototype.isSealed=function(){return this.context.env.state.isInlineBreaked()},t}(ze),qe=function(e){function t(t){var n=e.call(this,t)||this;return n.listMarkExist=!1,n.listMarkOffset=0,n.numberingInfo=n.checkNumbering(),n}return(0,s.__extends)(t,e),t.prototype.isSpacedEnding=function(e){var t=e.codePointAt(e.length-1);if(void 0!==t&&"Common"===(0,N.getScript)(t)){var n=(0,N.getEastAsianWidth)(t);return"W"===n||"F"===n||"A"===n}return!1},t.prototype.calcMarkWidth=function(e,t,n,r){var o=t-n;if(o>(this.isSpacedEnding(e)?r/4:-r/4)){var i=r/2;return o>0?n+Math.ceil((t-n)/i)*i:n+i}return n},t.prototype.checkNumbering=function(){var e,t=this.context.boxEnv,n=t.paraProperty,r=t.specialIndent;if(this.context.isFirstLine()&&n instanceof c.Jhz){var o=n.measureText||n.actualText,i=n.listMarkerSpanProp||new(c.kkf.getPropertyClass(c.uSS.RunProperty)),a=be.getInstance().shaper.shapeToken(o,i),s=(null===(e=n.listMarkerSpanProp)||void 0===e?void 0:e.sz)||c.keb.fontSize;n.isNumbered||i.fontFamily||(a.width=s);var l=n.ind.hangingChars*this.context.boxEnv.firstCharFont||n.ind.hanging,u=(r<0?Math.abs(r):l)||Math.abs(c.keb.listDefaultHangingCharsNum*s);return{width:this.calcMarkWidth(o,a.width,u,s),text:n.actualText,textSpan:i,textGlyph:a}}},t.prototype.getMaxContentMeasure=function(){var t,n,r=null!==(n=null===(t=this.numberingInfo)||void 0===t?void 0:t.width)&&void 0!==n?n:0;return e.prototype.getMaxContentMeasure.call(this)-r},t.prototype.computeLinePaddingLeft=function(t,n){var r=e.prototype.computeLinePaddingLeft.call(this,t,n);return this.numberingInfo&&!this.listMarkExist&&(r+=this.numberingInfo.width),r},t}(Ke),Ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t}(Ne),Qe=function(e){function t(){return e.call(this,l.U6.Inline)||this}return(0,s.__extends)(t,e),t.prototype.push=function(e){this.children.push(e),this.pos+=e.totalMeasure,e.isMergeBegin||this.diameters.push(e.totalExtent)},t.prototype.pop=function(){var e=this.children.pop();return e&&(this.pos-=e.totalMeasure,e.isMergeBegin||this.diameters.pop()),e},t}(Le),Ze=function(e){function t(t){return e.call(this,t,new Qe)||this}return(0,s.__extends)(t,e),t.prototype.isSealed=function(){return this.context.env.state.isBlockBreaked()},t.prototype.isAllMerged=function(){return this.content.getChildren().every((function(e){return e.mergedType===l.Wl.Hidden||e.mergedType===l.Wl.Placeholder}))},t.prototype.getContentExtent=function(){var e=this,t=this.getLastMergedCells();return Math.max.apply(Math,(0,s.__spreadArray)((0,s.__spreadArray)((0,s.__spreadArray)([],(0,s.__read)(this.getInRowCells().map((function(e){return e.totalExtent}))),!1),(0,s.__read)(t.map((function(t){return e.getVisibleCellAndOverflowExtent(t).overflow}))),!1),[327],!1))},t.prototype.getInRowCells=function(){return this.content.getChildren().filter((function(e){return!e.equivalentMerginBegin}))},t.prototype.getLastMergedCells=function(){return this.content.getChildren().filter((function(e){return e.isLastMerged}))},t.prototype.getVisibleCellAndOverflowExtent=function(e){var t=this.context.node;return this.context.parentContext?(0,b.xx)({cell:e,rowIndex:t.getRowIndex(),colBegin:e.colBegin},this.context.parentContext.container.getContentChildren(),t.mergedMapping):{cell:void 0,overflow:0}},t}(ze),Xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t}(Ne),Je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t}(Ne),$e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t.prototype.isSealed=function(){return!1},t}(ze),et=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t.prototype.isSealed=function(){if(this.context.env.state.isBlockBreaked()){var e=this.context,t=e.container,n=e.boxEnv;return t.content.count===n.columnCount}return!1},t.prototype.isOverflow=function(){return!1},t}(ze),tt=function(){function e(e,t,n){this.env=e,this.boxes={},this.pendingRollback=this.createInitRollbackOpt(),this.pendingAdjustShapes=[],this.linePendingShapes=[],this.drawingParser=new ie(this),this.pageRegion=t,this.relativeFrom=Pe.Page,this.cursorState=new Oe,this.constraintSpace=new Re,this.layoutRect=new De(this,t),this.hostId=n}return e.prototype.reset=function(){this.cursorState=new Oe,this.constraintSpace=new Re,this.boxes={},this.pendingAdjustShapes=[],this.linePendingShapes=[]},e.prototype.createInitRollbackOpt=function(){return{verticalPos:Number.MAX_SAFE_INTEGER,horizontalPos:Number.MAX_SAFE_INTEGER}},Object.defineProperty(e.prototype,"isOddPage",{get:function(){return 0!=(1&Math.abs(e.currentPageNumber))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPrintLayout",{get:function(){return this.env.isPrintLayout},enumerable:!1,configurable:!0}),e.prototype.onColumnStart=function(e,t,n){this.layoutRect.columnRect.top=t,this.layoutRect.columnRect.left=e,n&&(this.layoutRect.columnRect.right=this.layoutRect.columnRect.left+n)},e.prototype.onBlockStart=function(e,t){this.layoutRect.paragraphRect.top=t,this.layoutRect.paragraphRect.left=e},e.prototype.onBlockDone=function(){this.adjustDrawingPosition()},e.prototype.onLineDone=function(){var e;(e=this.pendingAdjustShapes).push.apply(e,(0,s.__spreadArray)([],(0,s.__read)(this.linePendingShapes),!1)),this.linePendingShapes.length=0},e.prototype.addShape=function(e,t){this.env.isPrintLayout&&(this.linePendingShapes.push(e),this.boxes[this.getNodeKey(t)]=e)},e.prototype.addTableBox=function(e,t){var n,r,o,i;if(t&&(this.boxes[this.getNodeKey(t)]=e),(0,l.vv)(e)&&this.addBox(e),e.containFloating)try{for(var a=(0,s.__values)(e.children),c=a.next();!c.done;c=a.next()){var u=c.value;if(u.containFloating)try{for(var d=(o=void 0,(0,s.__values)(u.children)),p=d.next();!p.done;p=d.next()){var h=p.value;(0,l.Cx)(h)&&this.constraintSpace.addChildren(h.constraintSpace)}}catch(e){o={error:e}}finally{try{p&&!p.done&&(i=d.return)&&i.call(d)}finally{if(o)throw o.error}}}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}},e.prototype.getBox=function(e){return this.boxes[this.getNodeKey(e)]},e.prototype.addBox=function(e){e.floatingSpace.isExclude&&!this.constraintSpace.getFloatingSpace(e.floatingSpace.id)&&(this.pendingRollback.verticalPos=Math.max(Math.min(this.pendingRollback.verticalPos,e.floatingSpace.offset.top),this.pageRegion.margins.top),this.pendingRollback.horizontalPos=Math.min(this.pendingRollback.horizontalPos,e.floatingSpace.offset.left)),this.constraintSpace.addFloatingBox(e)},e.prototype.flushRollback=function(){var e=this.pendingRollback;return this.pendingRollback=this.createInitRollbackOpt(),{verticalPos:e.verticalPos,horizontalPos:e.horizontalPos}},e.prototype.adjustDrawingPosition=function(){var e,t;try{for(var n=(0,s.__values)(this.pendingAdjustShapes),r=n.next();!r.done;r=n.next()){var o=r.value;o.floatingSpace=void 0;var i=this.parseDrawingSpace(o);i&&(o.floatingSpace=i,this.addBox(o))}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.pendingAdjustShapes.length=0},e.prototype.parseDrawingSpace=function(e){var t=this.drawingParser.parse(e);return t&&t.isExclude&&this.constraintSpace.getFloatingSpace(t.id)||t},e.prototype.getNodeKey=function(e){var t=e.getGCPRange();return"".concat(t.gcpBegin,"-").concat(t.end())},e.prototype.popPendingDrawingsByGCP=function(e){for(;this.linePendingShapes.length>0&&this.linePendingShapes[this.linePendingShapes.length-1].getRangeEnd()>e;)this.linePendingShapes.pop()},e.prototype.clearPendingDrawings=function(){this.linePendingShapes.length=0,this.pendingAdjustShapes.length=0},e.prototype.clearPendingLine=function(){this.linePendingShapes.length=0},e.currentPageNumber=1,e}(),nt=function(){function e(e){this.env=e,this.hostStack=[]}return Object.defineProperty(e.prototype,"curHost",{get:function(){return(0,m.Rz)(this.hostStack)},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this.hostStack=[]},e.prototype.pushHost=function(e,t){var n=new tt(this.env,e,t);this.hostStack.push(n)},e.prototype.popToAttach=function(e,t,n){var r=this.findNestHostLevel(e);if(r&&!r.constraintSpace.isEmpty())return t&&(r.constraintSpace.attachBox=t),n&&(n.constraintSpace=r.constraintSpace),r},e.prototype.pushEmpty=function(e){this.pushHost({extent:0,measure:0,margins:{top:0,left:0,bottom:0,right:0}},e)},e.prototype.popEmpty=function(e){return this.findNestHostLevel(e)},e.prototype.findNestHostLevel=function(e){var t;if((null===(t=this.hostStack[this.hostStack.length-1])||void 0===t?void 0:t.hostId)===e)return this.hostStack.pop()},e}(),rt=function(){function e(){this.blockBreak=!1,this.pageBreak=!1}return e.prototype.isBreaked=function(){return this.blockBreak||!!this.inlineBreakPoint},e.prototype.isBlockBreaked=function(){return this.blockBreak||this.pageBreak},e.prototype.isInlineBreaked=function(){return!!this.inlineBreakPoint},e.prototype.setInlineBreak=function(e){this.inlineBreakPoint=e},e.prototype.clearInlineBreak=function(){this.inlineBreakPoint=void 0},e.prototype.getInlineBreak=function(){return this.inlineBreakPoint},e.prototype.setBlockBreak=function(){this.blockBreak=!0},e.prototype.setPageBreak=function(){this.ignorePageBreak||(this.pageBreak=!0)},e.prototype.clearBlockBreak=function(){this.blockBreak=!1},e.prototype.clearPageBreak=function(){this.pageBreak=!1},e.prototype.hasPageBreak=function(){return this.pageBreak},e.prototype.hasRollbackPos=function(){return void 0!==this.rollback},e.prototype.getRollbackPos=function(){var e;return null!==(e=this.rollback)&&void 0!==e?e:{pos:Number.POSITIVE_INFINITY,relativeFrom:Pe.Page}},e.prototype.setRollbackPos=function(e){this.rollback=e},e.prototype.clearRollbackPos=function(){this.rollback=void 0},e.prototype.getPageBreakGcp=function(){var e;return null!==(e=this.pageBreakGcp)&&void 0!==e?e:Number.POSITIVE_INFINITY},e.prototype.setPageBreakGcp=function(e){this.pageBreakGcp=e},e.prototype.clearPageBreakGcp=function(){this.pageBreakGcp=void 0},e}(),ot="LINE_REFLOW_END",it=function(){function e(e,t,n,r){this.dataEngine=t,this.forceLineReflow=!1,this.reflowEnd=!1,this.snapshots=[],this.currentSnapshotId=0,this.rangeManager=e.createRangeManager(!1),this.initDirtyRanges(n,r),null==r||r.rangeManager.destroy()}return e.prototype.initDirtyRanges=function(e,t){var n,r=this;(0,b.lr)(!1,e?this.extractStoryDirtyRanges(e):[],null!==(n=null==t?void 0:t.getUnclearedDirtyRanges())&&void 0!==n?n:[]).forEach((function(e){return r.rangeManager.insertRange(r.getRangeKey(),e)}))},Object.defineProperty(e.prototype,"dirtyRanges",{get:function(){return this.dirtyRangeCache||(this.dirtyRangeCache=this.rangeManager.collectAllRanges().map((function(e){return e.range})).sort((function(e,t){return e.gcpBegin-t.gcpBegin}))),this.dirtyRangeCache},enumerable:!1,configurable:!0}),e.prototype.getUnclearedDirtyRanges=function(){var e=this.dirtyRanges,t=this.rangeManager.getRange(ot);return t&&e.push(t),e},e.prototype.getRangeKey=function(){return u.StringUtil.generateRandomId()},e.prototype.updateLineReflowEnd=function(e){this.rangeManager.deleteRange(ot),this.rangeManager.insertRange(ot,new c.ICE(e,0))},e.prototype.clearDirtyRange=function(e){for(var t=this,n=this.dirtyRanges,r=n.length,o=0,i=0;o<n.length&&i<e.length;){var a=n[o],s=e[i];if(s.end()<=a.gcpBegin)i+=1;else if(s.gcpBegin>a.end()||s.gcpBegin===a.end()&&a.len>0)o+=1;else if(s.gcpBegin>a.gcpBegin){if(s.end()<a.end()){var l=a.end();a.len=s.gcpBegin-a.gcpBegin,n.splice(o+1,0,new c.ICE(s.end(),l-s.end())),o+=1;continue}a.len=s.gcpBegin-a.gcpBegin,((o+=1)>=n.length||n[o].gcpBegin>s.end())&&(i+=1)}else s.end()<a.end()?(a.len=a.end()-s.end(),a.gcpBegin=s.end(),i+=1):(n.splice(o,1),(o>=n.length||n[o].gcpBegin>s.end())&&(i+=1))}n.length<r&&(this.forceLineReflow=!0,this.updateLineReflowEnd((0,m.Rz)(e).end())),this.dirtyRangeCache=n,this.rangeManager.removeAll(),n.forEach((function(e){return t.rangeManager.insertRange(t.getRangeKey(),e)}))},e.prototype.backup=function(){if(this.snapshots.length>0){var e=(0,m.Rz)(this.snapshots);if(e.reflowEnd===this.reflowEnd&&e.forceLineReflow===this.forceLineReflow&&(0,m.qP)(e.dirtyRanges,this.dirtyRanges,(function(e,t){return e.equal(t)})))return e.id}var t={id:this.currentSnapshotId,dirtyRanges:this.dirtyRanges.map((function(e){return e.clone()})),reflowEnd:this.reflowEnd,forceLineReflow:this.forceLineReflow};return this.snapshots.push(t),this.currentSnapshotId+=1,t.id},e.prototype.restore=function(e){var t=this;if(void 0===e||e>this.currentSnapshotId)return!1;for(var n=this.snapshots.length-1;n>=0;--n){var r=this.snapshots[n];if(r.id===e)return this.reflowEnd=r.reflowEnd,this.forceLineReflow=r.forceLineReflow,this.dirtyRangeCache=r.dirtyRanges,this.rangeManager.removeAll(),r.dirtyRanges.forEach((function(e){return t.rangeManager.insertRange(t.getRangeKey(),e)})),this.currentSnapshotId=r.id,this.snapshots.splice(n),!0;if(r.id<e)return!1}return!1},e.prototype.markReflowEnd=function(){this.reflowEnd=!0,this.forceLineReflow=!1,this.dirtyRangeCache=void 0,this.rangeManager.removeAll(),this.snapshots=[],this.currentSnapshotId=0},e}(),at=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t.prototype.extractStoryDirtyRanges=function(e){var t,n;return(0,s.__spreadArray)([],(0,s.__read)(null!==(n=null===(t=e.get(c.Eos.MainDocId))||void 0===t?void 0:t.values)&&void 0!==n?n:[]),!1)},t.prototype.getDirtyBegin=function(){var e,t;return null!==(t=null===(e=this.dirtyRanges[0])||void 0===e?void 0:e.gcpBegin)&&void 0!==t?t:Number.POSITIVE_INFINITY},t.prototype.checkDirty=function(e){if(0===this.dirtyRanges.length)return p.RL.Non;if(e instanceof _&&e.isDiscrete()){var t=e.getRangeEnd(),n=this.checkDirtyAtDirtyBegin(e,this.dirtyRanges[0].gcpBegin);if(n===p.RL.Dirty)return n;for(var r=1;r<this.dirtyRanges.length;++r){var o=this.dirtyRanges[r];if(!(o.gcpBegin<=t))break;var i=e.compareRangeTo(o.gcpBegin);if(i===p.Xq.Contains||i===p.Xq.After)return p.RL.Dirty;i===p.Xq.EndAt&&(n=p.RL.EndAtDirtyBegin)}return n}return this.checkDirtyAtDirtyBegin(e,this.getDirtyBegin())},t.prototype.checkDirtyAtDirtyBegin=function(e,t){var n=e.compareRangeTo(t);return n===p.Xq.After?p.RL.Dirty:n},t}(it),st=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t.prototype.extractStoryDirtyRanges=function(e){var t=[];return e.forEach((function(e,n){n!==c.Eos.MainDocId&&t.push.apply(t,(0,s.__spreadArray)([],(0,s.__read)(e.values),!1))})),t},t.prototype.getDirtyBegin=function(e){var t,n,r=this.dataEngine.getDataStream().getStoryStream().getSubStoryInfoFromGcp(e.getRangeBegin());if(r){var o=r.contentRange;try{for(var i=(0,s.__values)(this.dirtyRanges),a=i.next();!a.done;a=i.next()){var c=a.value;if(o.intersect(c))return c.gcpBegin}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}return Number.POSITIVE_INFINITY},t.prototype.checkDirty=function(e){var t=this.getDirtyBegin(e);return Number.isFinite(t)?e.compareRangeTo(t)===p.Xq.After?p.RL.Dirty:e.compareRangeTo(t):p.RL.Non},t}(it),ct=function(){function e(e,t,n){var r,o=this;this.dataEngine=e,this.storyIds=[];var i=new Set(null!==(r=null==n?void 0:n.storyIds)&&void 0!==r?r:[]);null==t||t.forEach((function(e,t){var n,r,a=null===(r=null===(n=o.dataEngine.getDataStream().getStoryStream().getSubStoryInfoFromId(t))||void 0===n?void 0:n.storyProp)||void 0===r?void 0:r.storyType;a!==c.AHI.headerContent&&a!==c.AHI.footerContent||i.add(t)})),this.storyIds=(0,s.__spreadArray)([],(0,s.__read)(i),!1)}return e.prototype.checkDirty=function(e){return this.storyIds.includes(e.storyId)?p.RL.Dirty:p.RL.Non},e.prototype.markReflowEnd=function(){this.storyIds=[]},Object.defineProperty(e.prototype,"reflowEnd",{get:function(){return 0===this.storyIds.length},enumerable:!1,configurable:!0}),e}();!function(e){e[e.Schedule=0]="Schedule",e[e.Chunk=1]="Chunk",e[e.Edit=2]="Edit"}(Me||(Me={}));var lt=function(){function e(e,t,n,r,o){var i;this.trigger=this.getTrigger(r,o),this.mainStory=new at(e,t,n,null==r?void 0:r.mainStory),this.subStory=new st(e,t,n,null==r?void 0:r.subStory),this.headerFooter=new ct(t,n,null==r?void 0:r.headerFooter);var a=null===(i=t.getDataStream().getStoryStream().getMainStoryInfo())||void 0===i?void 0:i.contentRange;this.mainStoryEnd=a?a.end():Number.POSITIVE_INFINITY,this.dirtyRangeLen=(0,m.Sm)(this.mainStory.dirtyRanges.map((function(e){return e.len})))+(0,m.Sm)(this.subStory.dirtyRanges.map((function(e){return e.len})))}return e.prototype.getTrigger=function(e,t){var n=null!=t?t:Me.Edit;return e&&!e.reflowEnd?Math.max(e.trigger,n):n},e.prototype.isMainStoryBox=function(e){return e.getRangeBegin()<=this.mainStoryEnd},e.prototype.getDirtyBegin=function(e){return this.isMainStoryBox(e)?this.mainStory.getDirtyBegin():this.subStory.getDirtyBegin(e)},e.prototype.shouldForceLineReflow=function(e){return this.isMainStoryBox(e)?this.mainStory.forceLineReflow:this.subStory.forceLineReflow},e.prototype.updateLineReflowEnd=function(e){e<=this.mainStoryEnd?this.mainStory.updateLineReflowEnd(e):this.subStory.updateLineReflowEnd(e)},e.prototype.endForceLineReflow=function(e){this.isMainStoryBox(e)&&(this.mainStory.forceLineReflow=!1),this.subStory.forceLineReflow=!1},e.prototype.checkDirty=function(e){return(0,l.De)(e)?this.headerFooter.checkDirty(e):this.isMainStoryBox(e)?this.mainStory.checkDirty(e):this.subStory.checkDirty(e)},e.prototype.backup=function(){return[this.mainStory.backup(),this.subStory.backup()]},e.prototype.restore=function(e){this.mainStory.restore(e[0]),this.subStory.restore(e[1])},e.prototype.isReflowEnd=function(e){return(0,l.De)(e)?this.headerFooter.checkDirty(e)===p.RL.Non:(0,l.n6)(e)?this.mainStory.reflowEnd&&this.headerFooter.reflowEnd:this.isMainStoryBox(e)?this.mainStory.reflowEnd:this.subStory.reflowEnd},Object.defineProperty(e.prototype,"isHeaderFooterReflowEnd",{get:function(){return this.headerFooter.reflowEnd},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reflowEnd",{get:function(){return this.mainStory.reflowEnd&&this.subStory.reflowEnd&&this.headerFooter.reflowEnd},enumerable:!1,configurable:!0}),e.prototype.markReflowEnd=function(){this.mainStory.markReflowEnd(),this.subStory.markReflowEnd(),this.headerFooter.markReflowEnd()},e.prototype.clearDirtyRange=function(e){e[0].gcpBegin<=this.mainStoryEnd&&this.mainStory.clearDirtyRange(e),this.subStory.clearDirtyRange(e)},e.prototype.verify=function(e){var t,n,r,o,i=this.mainStory.getUnclearedDirtyRanges();if(i.length>0){var a=e.getRanges();try{for(var c=(0,s.__values)(a),l=c.next();!l.done;l=c.next()){var u=l.value;try{for(var d=(r=void 0,(0,s.__values)(i)),p=d.next();!p.done;p=d.next()){var h=p.value;if(u.intersect(h))return this.clearDirtyRange([u]),void b.No.warn(b.Qq.UnclearedBoxRange,h)}}catch(e){r={error:e}}finally{try{p&&!p.done&&(o=d.return)&&o.call(d)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}}},e}(),ut=function(){function e(){this.leafContainerExtensions=new Map}return e.prototype.add=function(e,t){e===l.dZ.LeafContainer&&this.leafContainerExtensions.set(t.uniqueTypeId,t)},e.prototype.get=function(e,t){if(e===l.dZ.LeafContainer)return this.leafContainerExtensions.get(t)},e.prototype.getAll=function(e){return e===l.dZ.LeafContainer?(0,s.__spreadArray)([],(0,s.__read)(this.leafContainerExtensions.values()),!1):[]},e}(),dt=((0,m.yh)("layoutGlobalEnv"),function(){function e(e,t){this.extensionManager=new ut,this.globalPageNum=0,this.hasNumPagesField=!1,this.pageBreakEnd=Number.MAX_SAFE_INTEGER,this.isFinished=!0,this.boxCache=new Map,this.complexity=p.jd.None,this.autofixCount=0,this.fatalBreak=!1,this.context=e,this.dataEngine=t,this.storyBoxMgr=new h.st(this.dataEngine),this.floatingHostStack=new nt(this),this.addedAnchorIds=new Set,this.state=new rt,this.version=0}var t;return Object.defineProperty(e.prototype,"isReflow",{get:function(){return!!this.reflowState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"constraintSpace",{get:function(){var e;return null===(e=this.floatingHostStack.curHost)||void 0===e?void 0:e.constraintSpace},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"curCursorState",{get:function(){var e;return null===(e=this.floatingHostStack.curHost)||void 0===e?void 0:e.cursorState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"curFloatingHost",{get:function(){return this.floatingHostStack.curHost},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docEnv",{get:function(){return this.context.docEnv},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"beginGCPManager",{get:function(){return this.beginGCPClass||(this.beginGCPClass=this.context.createGcpManager(!1,c.mEF.Inner,!0)),this.beginGCPClass},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endGCPManager",{get:function(){return this.endGCPClass||(this.endGCPClass=this.context.createGcpManager(!1,c.mEF.Outer,!0)),this.endGCPClass},enumerable:!1,configurable:!0}),e.prototype.cacheBox=function(e,t){this.boxCache.set(t,e)},e.prototype.getCachedBox=function(e){return this.boxCache.get(e)},e.prototype.reset=function(){var e;h.mz.markFreshStart(),this.isFinished=!1,this.version+=1,this.state=new rt,this.addedAnchorIds.clear(),this.boxCache.clear(),this.storyBoxMgr.clear(),this.floatingHostStack.reset(),this.contentRange=null===(e=this.dataEngine.getDataStream().getStoryStream().getMainStoryInfo())||void 0===e?void 0:e.contentRange},e.prototype.fullReset=function(){this.reset(),this.complexity=p.jd.None,this.autofixCount=0,this.errorStack=[],this.fatalBreak=!1},e.prototype.initReflowState=function(e,t){this.reflowState=new lt(this.context,this.dataEngine,e,this.reflowState,t)},e.prototype.isBoxReused=function(e){return!h.mz.isFreshBox(e)},Object.defineProperty(e.prototype,"isPrintLayout",{get:function(){return(0,c.KZv)(this.docEnv.layoutType)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPaged",{get:function(){return(0,c.OqL)(this.docEnv.layoutType)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isContinuousPaged",{get:function(){return(0,c.WGN)(this.docEnv.layoutType)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isScroll",{get:function(){return this.docEnv.layoutType===c.msV.Scroll},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isWebLayout",{get:function(){return this.docEnv.layoutType===c.msV.Web||this.docEnv.layoutType===c.msV.Scroll},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPresentation",{get:function(){return this.docEnv.docViewType===c.$BT.PresentationPreview},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textStream",{get:function(){return this.dataEngine.getDataStream().getTextStream()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMultiSection",{get:function(){for(var e=this.getContentRange(),t=this.dataEngine.getDataStream().getSectionStream().createSectionIterator(e||new c.ICE(0,0)),n=0;t.hasNext();)n+=1,t.next();return n>1},enumerable:!1,configurable:!0}),e.prototype.createModelWrapperContext=function(){return new z.fl(this.dataEngine,this.docEnv,this.context.modelWrapperMgr)},e.prototype.breakLayoutOnFatal=function(){this.fatalBreak=!0},e.prototype.updateComplexity=function(e){this.complexity|=e},e.prototype.getComplexity=function(){return this.complexity},e.prototype.allowAutofix=function(){return!this.fatalBreak&&this.autofixCount<5},e.prototype.increaseAutofixCounter=function(){this.autofixCount+=1},e.prototype.recordError=function(e){this.errorStack.includes(e)||this.errorStack.push(e)},Object.defineProperty(e.prototype,"containsError",{get:function(){return this.errorStack.length>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"errorAbstract",{get:function(){var e=new Set(this.errorStack.map((function(e){return e.split(",")[0]})));return(0,s.__spreadArray)([],(0,s.__read)(e),!1).join(";")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"errorSummary",{get:function(){return this.errorStack.length>0?this.errorStack.join(";"):void 0},enumerable:!1,configurable:!0}),e.prototype.getContentRange=function(){return this.contentRange},e=(0,s.__decorate)([(0,s.__param)(0,l.Qw),(0,s.__metadata)("design:paramtypes",[Object,"function"==typeof(t=void 0!==c.ymk&&c.ymk)?t:Object])],e)}()),pt=function(e,t){this.env=e,this.node=t},ht=function(e){function t(t,n,r,o){var i=e.call(this,t,n)||this;return i.parent=r,i.parentContainer=o,i}return(0,s.__extends)(t,e),t}(pt),ft={};function gt(e){return function(t){ft[e.type]={ctor:t}}}(function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.maxExtent=Number.POSITIVE_INFINITY,r}var n,r;(0,s.__extends)(t,e),t=(0,s.__decorate)([gt({type:l.Rz.MainStory}),(0,s.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==dt&&dt)?n:Object,"function"==typeof(r=void 0!==z.jv&&z.jv)?r:Object])],t)})(pt),function(e){function t(t,n,r,o){var i,a=this;if((a=e.call(this,t,n,r,o)||this).edge=p.z6.obtain(),a.env.isPaged&&(null===(i=a.node.context.docEnv)||void 0===i?void 0:i.docViewType)!==c.$BT.PrintPreview&&(a.edge.margin=oe.v.zero,a.edge.margin.after=c.keb.paperMarginBottom),a.env.isPrintLayout){var s=a.node.getProperty().pgSz;a.fixedMeasure=s.w,a.fixedExtent=s.h,a.env.isContinuousPaged&&(a.edge.padding=oe.v.zero,a.edge.padding.before=c.keb.printLayout.continuous.paddingTop,a.edge.padding.after=c.keb.printLayout.continuous.paddingBottom)}else{if(a.edge.padding=oe.v.zero,a.env.isScroll){var l=a.node.getFirstSectionProperty(),d=(s=l.pgSz,l.pgMar);a.fixedMeasure=s.w-d.left-d.right,a.maxExtent=s.h-d.top-d.bottom,a.edge.padding.start=d.left,a.edge.padding.end=d.right}else{var h=a.env.webPageMeasure;a.fixedMeasure=h,a.maxExtent=(0,u.pxToTwips)(Math.round((0,u.twipsToPx)(c.keb.webLayout.pageArea/a.fixedMeasure)))}a.flexibleMaxExtent=!0,n.hasOffsets||(a.edge.padding.before=a.env.isScroll?a.node.getFirstSectionProperty().pgMar.top:c.keb.webLayout.paddingTop,a.minExtent=a.maxExtent)}return a}var n,o,a,d;(0,s.__extends)(t,e),t.prototype.resetLastVirtualPageEdge=function(e){this.env.isWebLayout&&(e.padding||(e.padding=oe.v.zero),e.padding.after=this.env.isScroll?this.node.getFirstSectionProperty().pgMar.bottom:c.keb.webLayout.paddingBottom)},t=(0,s.__decorate)([gt({type:l.Rz.Page}),(0,s.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==dt&&dt)?n:Object,"function"==typeof(o=void 0!==z.u$&&z.u$)?o:Object,"function"==typeof(a=void 0!==i.IBoxEnv&&i.IBoxEnv)?a:Object,"function"==typeof(d=void 0!==r.IFlowContainer&&r.IFlowContainer)?d:Object])],t)}(ht);var vt,yt=function(e){function t(t,n,r,o){var i,a,s=this;(s=e.call(this,t,n,r,o)||this).edge=p.z6.obtain(),s.edge.padding=oe.v.zero,s.sectionProperty=s.node.getSectionProperty();var l=s.sectionProperty.pgMar;return s.edge.padding=oe.v.zero,s.edge.padding.start=l.left,s.edge.padding.end=l.right,s.fixedMeasure=s.parent.fixedMeasure-(null!==(a=null===(i=s.edge)||void 0===i?void 0:i.measure)&&void 0!==a?a:0),n.isHeader&&(s.edge.padding.before=n.storyId?l.header:Math.min(l.header,l.top),s.minExtent=Math.max(0,l.top-l.header),s.maxExtent=c.keb.headerMaxHeightRatio*s.sectionProperty.pgSz.h-s.edge.extent),n.isFooter&&(s.edge.padding.after=n.storyId?l.footer:Math.min(l.footer,l.bottom),s.minExtent=Math.max(0,l.bottom-l.footer),s.maxExtent=c.keb.footerMaxHeightRatio*s.sectionProperty.pgSz.h-s.edge.extent),s.contentMaxExtent=Number.POSITIVE_INFINITY,s.nonSplitChildOverflow=!0,s}var n,i,a,u;return(0,s.__extends)(t,e),t=(0,s.__decorate)([gt({type:l.Rz.HeaderFooter}),(0,s.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==dt&&dt)?n:Object,"function"==typeof(i=void 0!==z.zL&&z.zL)?i:Object,"function"==typeof(a=void 0!==o.IBoxEnv&&o.IBoxEnv)?a:Object,"function"==typeof(u=void 0!==r.IFlowContainer&&r.IFlowContainer)?u:Object])],t)}(ht),mt=(function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;return i.fixedMeasure=i.parent.fixedMeasure,i.env.isPrintLayout?(i.fixedExtent=i.parentContainer.getMaxContentRestExtent(),i.nonSplitChildOverflow=!0):(i.maxExtent=r.maxExtent,i.flexibleMaxExtent=r.flexibleMaxExtent),i}var n,i,a,c;(0,s.__extends)(t,e),t=(0,s.__decorate)([gt({type:l.Rz.Body}),(0,s.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==dt&&dt)?n:Object,"function"==typeof(i=void 0!==z.Wl&&z.Wl)?i:Object,"function"==typeof(a=void 0!==o.IBoxEnv&&o.IBoxEnv)?a:Object,"function"==typeof(c=void 0!==r.IFlowContainer&&r.IFlowContainer)?c:Object])],t)}(ht),function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;if(i.maxExtent=i.parentContainer.getMaxContentRestExtent(),i.flexibleMaxExtent=i.parent.flexibleMaxExtent,i.property=i.node.getProperty(),i.edge=p.z6.obtain(),i.env.isPrintLayout){i.edge.padding=p.vk.zero;var a=i.property.pgMar;i.edge.padding.start=a.left,i.edge.padding.end=a.right}return i.fixedMeasure=i.parent.fixedMeasure-i.edge.measure,i.nonSplitChildOverflow=!!i.parentContainer.isEmpty()&&i.parent.nonSplitChildOverflow,i}var n,i,a,c;return(0,s.__extends)(t,e),t=(0,s.__decorate)([gt({type:l.Rz.Section}),(0,s.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==dt&&dt)?n:Object,"function"==typeof(i=void 0!==z.kz&&z.kz)?i:Object,"function"==typeof(a=void 0!==o.IBoxEnv&&o.IBoxEnv)?a:Object,"function"==typeof(c=void 0!==r.IFlowContainer&&r.IFlowContainer)?c:Object])],t)}(ht)),bt=(function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;if(i.flexibleMaxExtent=r.flexibleMaxExtent,r.childSizings){var a=i.parentContainer.content.count;i.isLast=a===r.childSizings.length-1,Object.assign(i,r.childSizings[a])}else{i.isLast=!0;var s=o.getMaxContentMeasure();r.fixedMeasure&&Number.isFinite(s)?i.fixedMeasure=s:r.maxMeasure&&(i.maxMeasure=o.getMaxContentMeasure());var c=o.getMaxContentExtent();r.fixedExtent&&Number.isFinite(c)?i.fixedExtent=o.getMaxContentExtent():i.maxExtent=o.getMaxContentExtent(),i.nonSplitChildOverflow=r.nonSplitChildOverflow}return i}var n,i,a,c;(0,s.__extends)(t,e),t=(0,s.__decorate)([gt({type:l.Rz.RichTextArea}),(0,s.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==dt&&dt)?n:Object,"function"==typeof(i=void 0!==z.Fc&&z.Fc)?i:Object,"function"==typeof(a=void 0!==o.IBoxEnv&&o.IBoxEnv)?a:Object,"function"==typeof(c=void 0!==r.IFlowContainer&&r.IFlowContainer)?c:Object])],t)}(ht),function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;i.splitted=!1,i.edge=p.z6.obtain(),i.edge.margin=oe.v.zero,i.property=i.node.getProperty();for(var a=r;a;){if(a instanceof mt){i.sectionProperty=a.property;break}if(a instanceof yt||a instanceof wt){i.sectionProperty=a.sectionProperty;break}a=a.parent}if(!i.node.isHidden){var s=i.generateEdge();i.edge.margin=s.margin,i.edge.padding=s.padding,i.edge.border=s.border}return r.fixedMeasure&&(i.fixedMeasure=r.fixedMeasure-i.edge.margin.start-i.edge.margin.end),i.contentMaxMeasure=i.parentContainer.getMaxContentRestMeasure()-i.edge.margin.start-i.edge.margin.end,i.env.isPrintLayout?i.maxExtent=i.parentContainer.getMaxContentRestExtent()-i.edge.margin.before:i.maxExtent=Number.POSITIVE_INFINITY,i.env.isPrintLayout&&o.isEmpty()&&(i.nonSplitChildOverflow=i.parent.nonSplitChildOverflow),i}var n,o,a,d;return(0,s.__extends)(t,e),t.prototype.split=function(){this.splitted||(this.edge.margin.after=0,this.splitted=!0)},Object.defineProperty(t.prototype,"isSplitted",{get:function(){return this.splitted},enumerable:!1,configurable:!0}),t.prototype.generateEdge=function(){var e=this.node,t=e.getProperty(),n=oe.v.zero,r=p.gb.none,o=oe.v.zero,i=this.getPrevParaProp(e),a=this.calcParagraphSpacing();if(o.before=a.before,o.after=a.after,o.start=this.node.getLeftIndent(),o.end=this.node.getRightIndent(),!t.has(t.tKeys.pBdr))return{padding:n,border:r,margin:o};if(t.pBdr.has(c.kkf.getPropertyClass(c.uSS.CTPBdr).tKeys.left)){var s=t.pBdr.left;n.start=(0,u.ptToTwips)(s.space),r.width.start=this.getBorderWidth(s),o.start-=n.start+r.width.start}if(t.pBdr.has(c.kkf.getPropertyClass(c.uSS.CTPBdr).tKeys.right)){var l=t.pBdr.right;n.end=(0,u.ptToTwips)(l.space),r.width.end=this.getBorderWidth(l),o.end+=n.end+r.width.end}if(t.pBdr.has(c.kkf.getPropertyClass(c.uSS.CTPBdr).tKeys.top)){var d=t.pBdr.top;!t.pBdr.has(c.kkf.getPropertyClass(c.uSS.CTPBdr).tKeys.bottom)&&i&&i.pBdr.has(c.kkf.getPropertyClass(c.uSS.CTPBdr).tKeys.top)&&d.equalTo(i.pBdr.top)&&!i.pBdr.has(c.kkf.getPropertyClass(c.uSS.CTPBdr).tKeys.bottom)||(n.before=(0,u.ptToTwips)(d.space),r.width.before=this.getBorderWidth(d))}var h={has:!1,visible:!1},f=this.getNextParaProp(e);if(t.pBdr.has(c.kkf.getPropertyClass(c.uSS.CTPBdr).tKeys.bottom)){h.has=!0;var g=t.pBdr.bottom;!t.pBdr.has(c.kkf.getPropertyClass(c.uSS.CTPBdr).tKeys.top)&&f&&f.pBdr.has(c.kkf.getPropertyClass(c.uSS.CTPBdr).tKeys.bottom)&&g.equalTo(f.pBdr.bottom)&&!f.pBdr.has(c.kkf.getPropertyClass(c.uSS.CTPBdr).tKeys.top)||(h.visible=!0,n.after=(0,u.ptToTwips)(g.space),r.width.after=this.getBorderWidth(g))}if(t.pBdr.has(c.kkf.getPropertyClass(c.uSS.CTPBdr).tKeys.between)&&h.has&&!h.visible){var v=t.pBdr.between;f&&f.pBdr.has(c.kkf.getPropertyClass(c.uSS.CTPBdr).tKeys.between)&&(r.width.after=this.getBorderWidth(v))}return{padding:n,border:r,margin:o}},t.prototype.calcParagraphSpacing=function(){var e=this.parseSpacingFromParaProp(this.property);if(!this.node.hasOffsets){var t=this.getPrevParaProp(this.node);if(t){var n=this.parseSpacingFromParaProp(t);e.before=Math.max(0,e.before-n.after)}}return this.node.getGCPRange().gcpBegin>0&&this.isPageFirstParagraph()&&(e.before=0),e},t.prototype.parseSpacingFromParaProp=function(e){var t=oe.v.zero,n=e.spacing,r=n.before,o=n.after,i=n.beforeLines,a=n.afterLines,s=n.beforeAutospacing,l=n.afterAutospacing,u=this.sectionProperty.docGrid.linePitch;return t.before=s?c.keb.autoParagraphDefaultSpacing:i?i/100*u:r,t.after=l?c.keb.autoParagraphDefaultSpacing:a?a/100*u:o,t},t.prototype.isPageFirstParagraph=function(){var e;return(null===(e=this.parent.parent)||void 0===e?void 0:e.parent)instanceof mt&&this.parentContainer.isEmpty()},t.prototype.getPrevParaProp=function(e){var t=e.getPrevSibling();return this.getNodeParaProp(t)},t.prototype.getNextParaProp=function(e){var t=e.getNextSibling();return this.getNodeParaProp(t)},t.prototype.getNodeParaProp=function(e){if(!e||e.type!==l.Rz.Paragraph)return null;var t=e.getProperty();return t&&t instanceof c.kkf.getPropertyClass(c.uSS.ParagraphProperty)?t:null},t.prototype.getBorderWidth=function(e){if([c.EJ9.undefined,c.EJ9.nil,c.EJ9.none].includes(e.val))return 0;var t,n=(0,u.ptToTwips)(e.sz/8);switch(e.val){case c.EJ9.double:t=3*n;break;case c.EJ9.triple:t=5*n;break;case c.EJ9.thinThickSmallGap:case c.EJ9.thickThinSmallGap:t=3.7*n;break;case c.EJ9.thinThickThinSmallGap:t=5.6*n;break;case c.EJ9.thinThickMediumGap:case c.EJ9.thickThinMediumGap:t=3*n;break;case c.EJ9.thinThickThinMediumGap:t=4.8*n;break;case c.EJ9.thinThickLargeGap:case c.EJ9.thickThinLargeGap:t=4.75*n;break;case c.EJ9.thinThickThinLargeGap:t=7.75*n;break;case c.EJ9.wave:t=6*n;break;case c.EJ9.doubleWave:t=9*n;break;case c.EJ9.inset:case c.EJ9.outset:t=5.7*n;break;case c.EJ9.threeDEmboss:case c.EJ9.threeDEngrave:case c.EJ9.dashDotStroked:t=4*n;break;default:t=1.33*n}return t},t=(0,s.__decorate)([gt({type:l.Rz.Paragraph}),(0,s.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==dt&&dt)?n:Object,"function"==typeof(o=void 0!==z.CK&&z.CK)?o:Object,"function"==typeof(a=void 0!==i.IBoxEnv&&i.IBoxEnv)?a:Object,"function"==typeof(d=void 0!==r.IFlowContainer&&r.IFlowContainer)?d:Object])],t)}(ht)),_t=(function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;i.marginStart=0,i.firstCharFont=c.keb.fontSize,i.specialIndent=0,i.flexibleMaxExtent=r.flexibleMaxExtent;var a=r;for(a instanceof bt&&(i.paraProperty=a.property);a;){if(a instanceof mt){i.sectionProperty=a.property;break}if(a instanceof yt||a instanceof wt){i.sectionProperty=a.sectionProperty;break}a=a.parent}return i.setSpecialIndent(),i.marginStart=i.getReservedIndent(i.isFirstLine(),i.isListLine())+i.getFeatureIndent(),i.contentMaxMeasure=i.parentContainer.getMaxContentRestMeasure()-i.marginStart,i.contentMaxExtent=i.parentContainer.getMaxContentRestExtent(),i}var n,o,a,u;(0,s.__extends)(t,e),t.prototype.setSpecialIndent=function(){var e,t,n,r,o=this.paraProperty.ind,i=this.node.getBeginChild();if(i instanceof z.B$){var a=i instanceof z.R2?i.getProperty():i.getRunProperty();a&&(this.firstCharFont=a.sz)}var s=this.paraProperty instanceof c.Jhz;o.hangingChars>0?this.specialIndent=-this.firstCharFont*(o.hangingChars/c.jLu.indentChars):o.firstLineChars>0?this.specialIndent=this.firstCharFont*(o.firstLineChars/c.jLu.indentChars):o.hanging>0?s&&this.paraProperty instanceof c.Jhz&&!(null===(t=null===(e=this.paraProperty)||void 0===e?void 0:e.listParaInd)||void 0===t?void 0:t.hanging)&&o.hanging===(null===(r=null===(n=this.paraProperty)||void 0===n?void 0:n.listInd)||void 0===r?void 0:r.hanging)?this.specialIndent=-o.hanging/c.keb.fontSizeStable*c.keb.fontSize:this.specialIndent=-o.hanging:o.firstLine>0&&(this.specialIndent=o.firstLine)},t.prototype.getReservedIndent=function(e,t){return e||t?this.specialIndent>0?this.specialIndent:0:this.specialIndent>0?0:Math.abs(this.specialIndent)},t.prototype.getFeatureIndent=function(){return this.paraProperty.blockQuote?240:0},t.prototype.isListLine=function(){return this.parent.node.getProperty()instanceof c.Jhz&&!this.parentContainer.getContentChildren().length},t.prototype.isFirstLine=function(){return this.node.isFirstChild()},t=(0,s.__decorate)([gt({type:l.Rz.Line}),(0,s.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==dt&&dt)?n:Object,"function"==typeof(o=void 0!==z.yS&&z.yS)?o:Object,"function"==typeof(a=void 0!==i.IBoxEnv&&i.IBoxEnv)?a:Object,"function"==typeof(u=void 0!==r.IFlowContainer&&r.IFlowContainer)?u:Object])],t)}(ht),function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;return i.property=n.getProperty(),i}var n,o,a,c;(0,s.__extends)(t,e),t=(0,s.__decorate)([gt({type:l.Rz.Text}),(0,s.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==dt&&dt)?n:Object,"function"==typeof(o=void 0!==z.R2&&z.R2)?o:Object,"function"==typeof(a=void 0!==i.IBoxEnv&&i.IBoxEnv)?a:Object,"function"==typeof(c=void 0!==r.IFlowContainer&&r.IFlowContainer)?c:Object])],t)}(ht),function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;i.margin=i.getMargin(),i.padding=i.getPadding(),i.border=i.getBorder(),i.originalSize=i.getOriginalRectSize();var a=i.getFinalSize(i.getFitSize()),s=i.node,c=s.measureFit,l=s.extentFit;return c!==z.Tf.FitContent?i.fixedMeasure=a.measure:i.maxMeasure=i.node.measureOverflow===z.hS.Fit?i.getMaxSize().measure:Number.POSITIVE_INFINITY,i.node.wrapContent||(i.contentMaxMeasure=Number.POSITIVE_INFINITY),l!==z.Tf.FitContent?i.fixedExtent=a.extent:i.maxExtent=i.node.extentOverflow===z.hS.Fit?i.getMaxSize().extent:Number.POSITIVE_INFINITY,i.contentMaxExtent=Number.POSITIVE_INFINITY,i.edge=p.z6.obtain(),i.margin&&(i.edge.margin=i.margin),i.padding&&(i.edge.padding=i.padding),i.border&&(i.edge.border=i.border),i}return(0,s.__extends)(t,e),t.prototype.getMargin=function(){},t.prototype.getPadding=function(){},t.prototype.getBorder=function(){},t.prototype.getMaxSize=function(){var e,t,n,r,o,i,a,s;return this.maxSize?this.maxSize:this.parentContainer.context.wrapLineInfo.isSubLine?{measure:Number.POSITIVE_INFINITY,extent:Number.POSITIVE_INFINITY}:(this.maxSize={measure:this.getMaxMeasure()-(null!==(t=null===(e=this.margin)||void 0===e?void 0:e.measure)&&void 0!==t?t:0)-(null!==(r=null===(n=this.padding)||void 0===n?void 0:n.measure)&&void 0!==r?r:0),extent:this.getMaxExtent()-(null!==(i=null===(o=this.margin)||void 0===o?void 0:o.extent)&&void 0!==i?i:0)-(null!==(s=null===(a=this.padding)||void 0===a?void 0:a.extent)&&void 0!==s?s:0)},this.maxSize)},t.prototype.getMaxMeasure=function(){return this.parentContainer.getMaxContentMeasure()},t.prototype.getMaxExtent=function(){for(var e,t=this.parent;t&&!t.fixedExtent;)t=null==t?void 0:t.parent;return null!==(e=null==t?void 0:t.fixedExtent)&&void 0!==e?e:this.parentContainer.getMaxContentExtent()},t.prototype.getFitSize=function(){var e=this.node,t=e.measureFit,n=e.extentFit;return t===z.Tf.FitParent?n===z.Tf.FitParent?this.getFitBothSize():this.getFitMeasureSize():n===z.Tf.FitParent?this.getFitExtentSize():this.originalSize},t.prototype.getFitBothSize=function(){var e=this.getMaxSize();if(this.node.isFixedRatio){var t=this.originalSize.extent/this.originalSize.measure;if(!Number.isNaN(t)&&Number.isFinite(t))if(e.measure*t>e.extent){var n=this.originalSize.measure/this.originalSize.extent;!Number.isNaN(t)&&Number.isFinite(t)&&(e.measure*=n)}else e.extent*=t}return e},t.prototype.getFitMeasureSize=function(){var e={measure:this.getMaxSize().measure,extent:this.originalSize.extent};return this.autoScaleExtent(e)},t.prototype.autoScaleExtent=function(e){var t=e;if(this.node.isFixedRatio){var n=this.originalSize.extent/this.originalSize.measure;!Number.isNaN(n)&&Number.isFinite(n)&&(t.extent=t.measure*n)}return t},t.prototype.getFitExtentSize=function(){var e={measure:this.originalSize.measure,extent:this.getMaxSize().extent};return this.autoScaleMeasure(e)},t.prototype.autoScaleMeasure=function(e){var t=e;if(this.node.isFixedRatio){var n=this.originalSize.measure/this.originalSize.extent;!Number.isNaN(n)&&Number.isFinite(n)&&(t.measure=t.extent*n)}return t},t.prototype.getFinalSize=function(e){var t=this.getMaxSize(),n=e;return this.node.extentOverflow===z.hS.Fit&&e.extent>t.extent&&(n.extent=t.extent,n=this.autoScaleMeasure(n)),this.node.measureOverflow===z.hS.Fit&&e.measure>t.measure&&(n.measure=t.measure,n=this.autoScaleExtent(n)),n},t}(ht)),Ct=(function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;return i.property=n.getProperty(),i.isFloating=n.isFloating&&t.isPrintLayout,i}var n,i,a,d;(0,s.__extends)(t,e),t.prototype.getBorder=function(){var e=this.node.getProperty().drawing.graphic.graphicData.pic.spPr;if(!e.isEmpty(e.tKeys.ln)){var t=p.gb.none,n=(0,u.emuToTwips)(e.ln.w);return t.width.before=n,t.width.after=n,t.width.start=n,t.width.end=n,t}},t.prototype.getOriginalRectSize=function(){var e=this.node.getProperty(),t=this.getRotate();return{measure:(0,u.emuToTwips)(Math.abs(e.drawing.extent.cx*Math.cos(t))+Math.abs(e.drawing.extent.cy*Math.sin(t))),extent:(0,u.emuToTwips)(Math.abs(e.drawing.extent.cy*Math.cos(t))+Math.abs(e.drawing.extent.cx*Math.sin(t)))}},t.prototype.getRotate=function(){var e=this.node.getProperty();if(e.drawingType===c.HgR.Picture){var t=c.Cf9.getImageProperty(e).rotateDegree;return(null!=t?t:0)/c.jLu.rotate/90%4*Math.PI/2}return 0},t=(0,s.__decorate)([gt({type:l.Rz.Image}),(0,s.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==dt&&dt)?n:Object,"function"==typeof(i=void 0!==z.HJ&&z.HJ)?i:Object,"function"==typeof(a=void 0!==o.IBoxEnv&&o.IBoxEnv)?a:Object,"function"==typeof(d=void 0!==r.IFlowContainer&&r.IFlowContainer)?d:Object])],t)}(_t),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.getOriginalRectSize=function(){var e=this.node.fieldLayoutInfo.containerLayoutConfig,t=e?e.fieldWidth:0;return{measure:Math.min(this.getMaxSize().measure,t),extent:e?e.fieldHeight:0}},t=(0,s.__decorate)([gt({type:l.Rz.FieldContainer})],t)}(_t),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.getOriginalRectSize=function(){return{measure:0,extent:0}},t=(0,s.__decorate)([gt({type:l.Rz.LeafContainer})],t)}(_t),function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;return i.drawingProp=n.getProperty(),i.textboxProp=n.textboxProperty,i}var n,i,a,d;(0,s.__extends)(t,e),t.prototype.getOriginalRectSize=function(){var e,t,n,r,o,i,a,s,l,d;if(this.node.isCodeblock||this.node.isLightBlock)return{measure:0,extent:0};var p=this.node.getProperty(),h=p.drawing.extent.cy;if(p.drawingType===c.HgR.WordprocessingShape){var f=c.Su2.getSpPr(p);f&&f.ln.w&&f.xfrm.ext.cy<f.ln.w&&(h=(0,u.emuToTwips)(f.ln.w))}return{measure:(0,u.emuToTwips)(p.drawing.extent.cx)-(null!==(t=null===(e=this.padding)||void 0===e?void 0:e.measure)&&void 0!==t?t:0)-(null!==(o=null===(r=null===(n=this.border)||void 0===n?void 0:n.width)||void 0===r?void 0:r.measure)&&void 0!==o?o:0)/2,extent:(0,u.emuToTwips)(h)-(null!==(a=null===(i=this.padding)||void 0===i?void 0:i.extent)&&void 0!==a?a:0)-(null!==(d=null===(l=null===(s=this.border)||void 0===s?void 0:s.width)||void 0===l?void 0:l.extent)&&void 0!==d?d:0)/2}},t.prototype.getMargin=function(){var e=this.node.getProperty().drawing,t=e.distT,n=e.distB,r=e.distL,o=e.distR,i=oe.v.zero;return this.node.isFloating?(i.before=(0,u.emuToTwips)(t),i.after=(0,u.emuToTwips)(n),i.start=(0,u.emuToTwips)(r),i.end=(0,u.emuToTwips)(o),i):i},t.prototype.getPadding=function(){if(this.node.isCodeblock||this.node.isLightBlock)return(t=oe.v.zero).before=Math.max((0,u.pxToTwips)(12),(0,m.hU)()),t.after=t.before,this.node.isCodeblock?(t.start=(0,u.pxToTwips)(42),t.end=(0,m.E)()):this.node.isLightBlock&&(t.start=(0,u.pxToTwips)(12),t.end=t.start),t;var e=this.node.getProperty();if(e.drawingType===c.HgR.WordprocessingShape&&e.contentId){var t,n=e.drawing.graphic.graphicData.wsp.bodyPr,r=n.tIns,o=n.bIns,i=n.lIns,a=n.rIns;return(t=oe.v.zero).before=(0,u.emuToTwips)(r),t.after=(0,u.emuToTwips)(o),t.start=(0,u.emuToTwips)(i),t.end=(0,u.emuToTwips)(a),t}},t.prototype.getBorder=function(){if(!this.node.isCodeblock&&!this.node.isLightBlock){var e=this.node.getProperty();if(e.drawingType===c.HgR.WordprocessingShape){var t=e.drawing.graphic.graphicData.wsp.spPr;if(!t.isEmpty(t.tKeys.ln)){var n=p.gb.none,r=(0,u.emuToTwips)(t.ln.w);return n.width.before=r,n.width.after=r,n.width.start=r,n.width.end=r,n.type=l.GJ.Both,n}}}},t=(0,s.__decorate)([gt({type:l.Rz.TextFrame}),(0,s.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==dt&&dt)?n:Object,"function"==typeof(i=void 0!==z.ww&&z.ww)?i:Object,"function"==typeof(a=void 0!==o.IBoxEnv&&o.IBoxEnv)?a:Object,"function"==typeof(d=void 0!==r.IFlowContainer&&r.IFlowContainer)?d:Object])],t)}(_t),function(){function e(e,t){this.property=t.property,this.env=e,this.floatingContext=this.env.curFloatingHost}return Object.defineProperty(e.prototype,"tblpPr",{get:function(){return this.property.tblPr.tblpPr},enumerable:!1,configurable:!0}),e.prototype.resolveContainerOffsetY=function(e){return this.resolvePageOffsetY(e)},e.prototype.tableBlockPos=function(){var e,t;return null!==(t=null===(e=this.tableBoxEnv.parentContainer)||void 0===e?void 0:e.getBlockPos())&&void 0!==t?t:0},e.prototype.resolvePageOffsetY=function(e){if(!this.env.isPrintLayout&&this.property.isFixed)return this.tableBlockPos();var t=this.getVertRect();return this.resolveHeightOffset(e,t.height)+t.top},e.prototype.resolveGlobalOffsetY=function(e){if(!this.env.isPrintLayout)return this.property.isFixed?this.tableBlockPos():this.tableBlockPos()+this.tblpPr.tblpY;var t=this.resolvePageOffsetY(e);return Math.max(Math.min(t,this.floatingContext.layoutRect.pageRect.height-e),0)},e.prototype.resolvePageOffsetX=function(e){if(this.tblpPr.horzAnchor===c.Er3.page)return this.resolvePageAnchorOffsetX(e);var t=this.getHorzRect();return Math.max(0,this.resolveWidthOffset(null!=e?e:t.width,t.width)+t.left)},e.prototype.getVertRect=function(){var e=this.tblpPr.vertAnchor;return e===c.B6J.text?this.floatingContext.layoutRect.paragraphRect:e===c.B6J.page?this.floatingContext.layoutRect.pageRect:this.floatingContext.layoutRect.marginRect},e.prototype.resolvePageAnchorOffsetX=function(e){void 0===e&&(e=0);var t=this.floatingContext.layoutRect,n=t.marginRect,r=t.pageRect,o=this.tblpPr,i=o.leftFromText,a=o.rightFromText,s=o.tblpX;switch(this.getXSpec()){case c.xxK.left:return n.left>e+i?n.left-i-e:r.left;case c.xxK.right:return r.right-n.right>e+a?n.right+a:r.width-e;case c.xxK.center:return(r.width-e)/2}return r.left+s},e.prototype.getHorzRect=function(){return this.tblpPr.horzAnchor===c.Er3.margin?this.floatingContext.layoutRect.marginRect:this.floatingContext.layoutRect.columnRect},e.prototype.resolveHeightOffset=function(e,t){switch(this.getYSpec()){case c.VKo.top:return 0;case c.VKo.center:return Math.max((t-e)/2,0);case c.VKo.bottom:return Math.max(t-e,0)}return this.tblpPr.tblpY},e.prototype.resolveWidthOffset=function(e,t){switch(this.getXSpec()){case c.xxK.left:return 0;case c.xxK.center:return Math.max((t-e)/2,0);case c.xxK.right:return Math.max(t-e,0)}return this.tblpPr.tblpX},e.prototype.getXSpec=function(){var e=this.tblpPr,t=e.tblpXSpec,n=e.tblpX;if(t===c.xxK.undefined&&0===n)return c.xxK.left;var r=this.floatingContext.isOddPage;return t===c.xxK.inside?r?c.xxK.left:c.xxK.right:t===c.xxK.outside?r?c.xxK.right:c.xxK.left:t},e.prototype.getYSpec=function(){var e=this.tblpPr.tblpYSpec,t=this.floatingContext.isOddPage;return e===c.VKo.inside?t?c.VKo.top:c.VKo.bottom:e===c.VKo.outside?t?c.VKo.bottom:c.VKo.top:e},e}()),St=(function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;i.property=n.getProperty(),i.sectionProperty=i.getSectionProperty(),i.edge=i.getTableDefaultEdge();var a=i.sectionProperty.pgMar,s=a.left-(0,u.pxToTwips)(c.keb.tableHeaderWidth);s=s>0?s:0,i.edge.margin=new p.vk({before:c.keb.table.marginTop,after:c.keb.table.marginBottom,start:i.getTableIndent(s,i.property.tblPr.tblInd),end:i.getTableIndent(a.right,i.property.tblPr.tblIndRight)}),i.isFirstTable=!n.hasOffsets;var l=i.env.curFloatingHost.relativeFrom;if(i.env.curFloatingHost.onBlockStart(o.getInlinePos(l),o.getBlockPos(l)),t.isPrintLayout){if(i.maxExtent=o.getMaxContentRestExtent()-i.edge.extent,i.env.isPrintLayout&&i.isFirstTable&&n.isFloating()&&!n.getProperty().isRelativeAlignV){var d=new Ct(i.env,i),h=i.env.curFloatingHost.pageRegion,f=h.margins,g=h.footerExtent,v=i.env.curFloatingHost.pageRegion.extent-Math.max(f.bottom,null!=g?g:0)-d.resolveContainerOffsetY(0),y=i.node.getProperty().tblPr.tblpPr.vertAnchor;y!==c.B6J.page&&y!==c.B6J.margin?i.maxExtent=Math.min(v,i.maxExtent):i.maxExtent=v,i.maxExtent<0&&(o.isEmpty()?(i.node.closeTableFloating(),i.maxExtent=o.getMaxContentRestExtent()-i.edge.extent):i.env.state.setBlockBreak())}}else i.maxExtent=Number.POSITIVE_INFINITY;return i.contentMaxMeasure=Number.POSITIVE_INFINITY,i.maxMeasure=o.getMaxContentMeasure()-i.edge.measure,i}var n,i,a,d;(0,s.__extends)(t,e),t.prototype.getTableDefaultEdge=function(){var e=p.z6.obtain(),t=this.property.nestingLevel>1;return e.border=new p.gb({width:new p.vk({before:t?0:c.keb.tableBorderWidth,start:c.keb.tableBorderWidth,after:0,end:0}),type:l.GJ.Outer}),e.margin=p.vk.zero,e},t.prototype.getTableIndent=function(e,t){return(null==t?void 0:t.type)===c.i7d.dxa?t.w<0&&Math.abs(t.w)>e?-e:t.w:0},t.prototype.getSectionProperty=function(){for(var e=this.parent;e;){if(e instanceof mt)return e.property;if(e instanceof yt)return e.sectionProperty;e=e.parent}return c.kkf.createProperty(c.uSS.SectionProperty)},t=(0,s.__decorate)([gt({type:l.Rz.Table}),(0,s.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==dt&&dt)?n:Object,"function"==typeof(i=void 0!==z.Fh&&z.Fh)?i:Object,"function"==typeof(a=void 0!==o.IBoxEnv&&o.IBoxEnv)?a:Object,"function"==typeof(d=void 0!==r.IFlowContainer&&r.IFlowContainer)?d:Object])],t)}(ht),function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;i.property=n.getProperty(),i.tableProperty=r.property,i.maxExtent=o.getMaxContentRestExtent(),i.minExtent=i.property.trHeight.val,i.minExtent>i.maxExtent&&i.isFitBody()&&(i.minExtent=i.maxExtent);var a=p.vk.zero;return a.start=Math.max(i.property.wBefore.w,0),i.edge=p.z6.obtain(),i.edge.margin=a,i.maxMeasure=Number.POSITIVE_INFINITY,i}var n,i,a,c;(0,s.__extends)(t,e),t.prototype.isFitBody=function(){var e,t,n=null===(t=null===(e=this.parent.parent)||void 0===e?void 0:e.parent)||void 0===t?void 0:t.parent;return n instanceof mt&&n.parentContainer.isEmpty()&&this.parent.parentContainer.isEmpty()&&this.parentContainer.isEmpty()},t=(0,s.__decorate)([gt({type:l.Rz.TableRow}),(0,s.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==dt&&dt)?n:Object,"function"==typeof(i=void 0!==z.g0&&z.g0)?i:Object,"function"==typeof(a=void 0!==o.IBoxEnv&&o.IBoxEnv)?a:Object,"function"==typeof(c=void 0!==r.IFlowContainer&&r.IFlowContainer)?c:Object])],t)}(ht),n(43670)),wt=(function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;i.property=n.getProperty();var a=r;return i.rowProperty=a.property,i.tableProperty=a.tableProperty,i.rowIndex=n.getRowIndex(),i.colIndex=n.getColBegin(),n.mergedType===l.Wl.Hidden?(i.fixedExtent=0,i.edge=p.z6.obtain()):(i.edge=i.getCellEdge(),i.maxExtent=o.getMaxContentExtent()-i.edge.extent),i.fixedMeasure=i.property.tcW.w-i.edge.measure,i.nonSplitChildOverflow=i.isFitBody(),i}var n,i,a,u;(0,s.__extends)(t,e),t.prototype.getCellEdge=function(){var e=new p.vk({before:0,start:0,after:c.keb.tableBorderWidth,end:c.keb.tableBorderWidth}),t=p.z6.obtain();t.border=new St.g({width:e,type:l.GJ.Outer});var n=this.property.tcMar;return t.padding=new p.vk({before:Number(n.top.w),start:Number(n.left.w),after:Number(n.bottom.w),end:Number(n.right.w)}),t},t.prototype.isFitBody=function(){return this.parent.isFitBody()},t=(0,s.__decorate)([gt({type:l.Rz.TableCell}),(0,s.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==dt&&dt)?n:Object,"function"==typeof(i=void 0!==z.Cr&&z.Cr)?i:Object,"function"==typeof(a=void 0!==o.IBoxEnv&&o.IBoxEnv)?a:Object,"function"==typeof(u=void 0!==r.IFlowContainer&&r.IFlowContainer)?u:Object])],t)}(ht),function(e){function t(t,n,r,o){var i,a=this;a=e.call(this,t,n,r,o)||this;for(var s=r;s;){if(s instanceof mt){a.sectionProperty=s.property;break}if(s instanceof yt){a.sectionProperty=s.sectionProperty;break}s=s.parent}if(a.edge=re.z.obtain(),a.node.wrappedMetric){var l=a.node.wrappedMetric,u=l.padding,d=l.margin;u&&(a.edge.padding=new p.vk(u)),d&&(a.edge.margin=new p.vk(d))}var h=a.node.fieldProps;a.maxMeasure=o.getMaxContentMeasure()-a.edge.measure;var f=a.env.dataEngine.getDataStream().getFieldStream(),g=null!==(i=null==h?void 0:h.displayLayoutType)&&void 0!==i?i:c.dLA.Text;if([c.dLA.Card,c.dLA.Preview].includes(g)&&h){var v=f.getFieldLayoutInfo(h);a.fixedMeasure=v.containerLayoutConfig.fieldWidth||a.parentContainer.getMaxContentMeasure()-a.edge.measure,a.fixedExtent=v.containerLayoutConfig.fieldHeight}return a.contentMaxMeasure=Number.POSITIVE_INFINITY,a}var n,o,a,u;(0,s.__extends)(t,e),t=(0,s.__decorate)([gt({type:l.Rz.FieldCode}),(0,s.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==dt&&dt)?n:Object,"function"==typeof(o=void 0!==z.px&&z.px)?o:Object,"function"==typeof(a=void 0!==i.IBoxEnv&&i.IBoxEnv)?a:Object,"function"==typeof(u=void 0!==r.IFlowContainer&&r.IFlowContainer)?u:Object])],t)}(ht),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.getOriginalRectSize=function(){var e=this.node.getProperty();return{measure:e.shapeProperty.styleProps.width,extent:e.shapeProperty.styleProps.height}},t=(0,s.__decorate)([gt({type:l.Rz.EmbeddedObject})],t)}(_t),function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;if(i.edge=p.z6.obtain(),i.sectionProperty=i.node.getSectionProperty(),i.env.isPrintLayout){i.edge.padding=p.vk.zero;var a=i.sectionProperty.pgMar;i.edge.padding.start=a.left,i.edge.padding.end=a.right}return i.fixedMeasure=i.parent.fixedMeasure-i.edge.measure,i}var n,i,a,c;return(0,s.__extends)(t,e),t=(0,s.__decorate)([gt({type:l.Rz.Endnote}),(0,s.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==dt&&dt)?n:Object,"function"==typeof(i=void 0!==z.lF&&z.lF)?i:Object,"function"==typeof(a=void 0!==o.IBoxEnv&&o.IBoxEnv)?a:Object,"function"==typeof(c=void 0!==r.IFlowContainer&&r.IFlowContainer)?c:Object])],t)}(ht)),Et=(function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;return i.maxExtent=i.parentContainer.getMaxContentRestExtent(),i.flexibleMaxExtent=i.parent.flexibleMaxExtent,i.fixedMeasure=i.parent.fixedMeasure,i.nonSplitChildOverflow=i.parent.nonSplitChildOverflow,i.columns=i.initColumns(),i.childSizings=i.initChildSizings(),i}var n,i,a,c;(0,s.__extends)(t,e),t.prototype.isBalanced=function(){return this.columns.length>1&&this.node.isBalanced()},t.prototype.initColumns=function(){if(Array.isArray(this.node.columnsConfig))return this.node.columnsConfig;var e=this.node.columnsConfig,t=e.count,n=e.space,r=(this.fixedMeasure-(t-1)*n)/t;return new Array(t).fill({measure:r,space:n})},Object.defineProperty(t.prototype,"columnCount",{get:function(){return this.columns.length},enumerable:!1,configurable:!0}),t.prototype.initChildSizings=function(){var e=this;return this.columns.map((function(t,n){var r={};return r.fixedMeasure=t.measure,r.maxExtent=e.maxExtent,n<e.columnCount-1&&(r.edge=p.z6.obtain(),r.edge.margin=p.vk.zero,r.edge.margin.end=t.space),r.nonSplitChildOverflow=e.nonSplitChildOverflow,r}))},t=(0,s.__decorate)([gt({type:l.Rz.Columns}),(0,s.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==dt&&dt)?n:Object,"function"==typeof(i=void 0!==z.bs&&z.bs)?i:Object,"function"==typeof(a=void 0!==o.IBoxEnv&&o.IBoxEnv)?a:Object,"function"==typeof(c=void 0!==r.IFlowContainer&&r.IFlowContainer)?c:Object])],t)}(ht),function(){function e(){}return e.create=function(e,t,n,r){var o=t.type,i=function(e){var t;return null===(t=ft[e])||void 0===t?void 0:t.ctor}(o);if(o===l.Rz.LeafContainer){var a=e.extensionManager.get(l.dZ.LeafContainer,t.uniqueTypeId);a&&(i=a.BoxEnv)}return i?new i(e,t,n,r):new pt(e,t)},e}());!function(e){e[e.No=0]="No",e[e.NoForAll=1]="NoForAll",e[e.Current=2]="Current",e[e.CurrentToEnd=3]="CurrentToEnd"}(vt||(vt={}));var xt=function(){function e(e,t,n){this.env=e,this.node=t,this.parentContext=n}return e.prototype.createBoxEnv=function(){var e,t;return Et.create(this.env,this.node,null===(e=this.parentContext)||void 0===e?void 0:e.boxEnv,null===(t=this.parentContext)||void 0===t?void 0:t.container)},Object.defineProperty(e.prototype,"boxEnv",{get:function(){return this.boxEnvVal||(this.boxEnvVal=this.createBoxEnv()),this.boxEnvVal},enumerable:!1,configurable:!0}),e.prototype.getRootContext=function(){return this.parentContext?this.parentContext.getRootContext():this},e.prototype.isRoot=function(){return!this.parentContext&&this.node.isRoot},e.prototype.canReuse=function(e){return vt.No},e}(),Tt=function(e){function t(t,n,r){return e.call(this,t,n,r)||this}return(0,s.__extends)(t,e),Object.defineProperty(t.prototype,"container",{get:function(){return this.containerVal||(this.containerVal=this.createContainer()),this.containerVal},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.container.clear()},t.prototype.canReuse=function(e){var t=this.env.reflowState;return t.isReflowEnd(e)?vt.CurrentToEnd:t.shouldForceLineReflow(e)?vt.No:this.canReuseRegular(e)},t.prototype.canReuseRegular=function(e){return vt.No},t}(xt),Rt={};function It(e){return function(t){Rt[e.type]={ctor:t}}}(function(e){function t(t,n){return e.call(this,t,n)||this}var n,r;(0,s.__extends)(t,e),t.prototype.createContainer=function(){return new Be(this)},t.prototype.canReuse=function(){return vt.No},t=(0,s.__decorate)([It({type:l.Rz.MainStory}),(0,s.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==dt&&dt)?n:Object,"function"==typeof(r=void 0!==z.jv&&z.jv)?r:Object])],t)})(Tt),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),Object.defineProperty(t.prototype,"canHeaderReuse",{get:function(){return this.reuseHeader},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canFooterReuse",{get:function(){return this.reuseFooter},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shouldReflowHeaderFooter",{get:function(){return!this.reuseHeader||!this.reuseFooter},enumerable:!1,configurable:!0}),t.prototype.createContainer=function(){return new He(this)},t.prototype.canReuse=function(t){return this.env.reflowState.trigger===Me.Schedule?vt.Current:this.env.isPrintLayout&&(this.reuseHeader=this.canReuseHeaderFooter(this.node.header,t.header),this.reuseFooter=this.canReuseHeaderFooter(this.node.footer,t.footer),this.shouldReflowHeaderFooter)||this.env.isScroll&&!this.boxEnv.edge.equal(t.logicEdge)?vt.No:e.prototype.canReuse.call(this,t)},t.prototype.canReuseHeaderFooter=function(e,t){if(e.getGCPRange().isValid()!==t.isValid()||e.storyId!==t.storyId||e.parity!==t.parity)return!1;if(this.env.reflowState.checkDirty(t)===p.RL.Non){var n=Et.create(this.env,e,this.boxEnv,this.container);return e.isHeader?this.headerBoxEnv=n:this.footerBoxEnv=n,n.fixedMeasure===t.measure&&t.extent>=n.minExtent&&t.extent<=n.maxExtent&&n.edge.equal(t.logicEdge)}return!1},t.prototype.canReuseRegular=function(e){var t=this.env.reflowState,n=t.checkDirty(e);return n===p.RL.Non?this.isPageViewIdentical(e)&&t.isHeaderFooterReflowEnd?vt.CurrentToEnd:vt.No:n===p.RL.BeforeDirty&&!this.canBeforeDirtyPageBeDirty(e)&&this.isPageViewIdentical(e)?vt.Current:vt.No},t.prototype.canBeforeDirtyPageBeDirty=function(e){var t=e.nextSibling;return!!t&&this.env.reflowState.checkDirty(t)===p.RL.Dirty&&!(0,b.hg)(t,this.env.reflowState)},t.prototype.isPageViewIdentical=function(e){return e.isContinuous===this.env.isContinuousPaged},t=(0,s.__decorate)([It({type:l.Rz.Page})],t)}(Tt),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.createContainer=function(){return new je(this)},t.prototype.canReuse=function(e){var t;if(this.env.reflowState){var n=this.parentContext;return(null!==(t=this.node.isHeader?n.canHeaderReuse:n.canFooterReuse)&&void 0!==t?t:this.parentContext.canReuseHeaderFooter(this.node,e))?vt.Current:vt.No}return vt.No},t.prototype.createBoxEnv=function(){var t=this.parentContext,n=this.node.isHeader?null==t?void 0:t.headerBoxEnv:null==t?void 0:t.footerBoxEnv;return null!=n?n:e.prototype.createBoxEnv.call(this)},t=(0,s.__decorate)([It({type:l.Rz.HeaderFooter})],t)}(Tt),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.createContainer=function(){return new Ge(this)},t.prototype.canReuseRegular=function(e){var t=this.env.reflowState;if(this.parentContext){var n=this.parentContext;if(!n.shouldReflowHeaderFooter)return vt.No;if(!this.isBodyExtentIdentical(e))return vt.No;var r=t.checkDirty(e);if(r===p.RL.BeforeDirty&&e.parentBox&&!n.canBeforeDirtyPageBeDirty(e.parentBox))return vt.Current;if(r===p.RL.Non)return vt.Current}return vt.No},t.prototype.isBodyExtentIdentical=function(e){var t;return(null!==(t=e.originExtent)&&void 0!==t?t:e.extent)===this.boxEnv.fixedExtent},t=(0,s.__decorate)([It({type:l.Rz.Body})],t)}(Tt),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.createContainer=function(){return new Ve(this)},t.prototype.canReuseRegular=function(e){if(e.isAffectedByFloating())return vt.No;var t=this.env.reflowState.checkDirty(e);return t!==p.RL.BeforeDirty&&t!==p.RL.Non||!this.canReuseInRemaingSpace(e)?vt.No:vt.Current},t.prototype.canReuseInRemaingSpace=function(e){var t;if(this.boxEnv.fixedMeasure!==e.measure)return!1;if(this.parentContext){var n=this.parentContext.container.getMaxContentRestExtent()-e.extent;if(n<0)return!1;if(e.nextSibling)return!0;var r=null===(t=e.getAncestorOf(l.uO.Page))||void 0===t?void 0:t.nextSibling;return!r||!(0,b.K6)(n,r,this.env.reflowState)}return!1},t=(0,s.__decorate)([It({type:l.Rz.Section})],t)}(Tt);var Pt,Ot,kt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t.prototype.getInlinePos=function(t){return t===Pe.RichTextArea?this.direction===l.U6.Inline?this.content.inlinePos:0:e.prototype.getInlinePos.call(this,t)},t.prototype.getBlockPos=function(t){return t===Pe.RichTextArea?this.direction===l.U6.Block?this.content.blockPos:0:e.prototype.getBlockPos.call(this,t)},t}(Ne);(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.createContainer=function(){return new kt(this)},t.prototype.canReuseRegular=function(e){return e.maxContentMeasure!==this.container.getMaxContentMeasure()?vt.NoForAll:vt.No},t=(0,s.__decorate)([It({type:l.Rz.RichTextArea})],t)})(Tt),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.createContainer=function(){return new We(this)},t.prototype.canReuseRegular=function(e){if(e.isAffectedByFloating()||this.env.curFloatingHost.constraintSpace.containsWrapping())return vt.NoForAll;var t=this.env.reflowState.checkDirty(e);return t!==p.RL.BeforeDirty&&t!==p.RL.Non||!this.canReuseInRemainingSpace(e)?vt.No:vt.Current},t.prototype.canReuseInRemainingSpace=function(e){var t;if(this.parentContext){var n=this.parentContext.container;if((0,m.Rz)(n.getContentChildren())instanceof U&&this.boxEnv.calcParagraphSpacing().before!==e.edge.margin.top)return!1;var r=n.getMaxContentRestExtent()-e.totalExtent;if(r>0){if(!e.breakpointCPs)return!0;var o=null===(t=e.getAncestorOf(l.uO.Page))||void 0===t?void 0:t.nextSibling,i=!o||!(0,b.K6)(r,o,this.env.reflowState);return i&&this.env.state.setBlockBreak(),i}}return!1},t=(0,s.__decorate)([It({type:l.Rz.Paragraph})],t)}(Tt),function(e){e[e.none=0]="none",e[e.end=1]="end"}(Pt||(Pt={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Center=2]="Center",e[e.Justify=3]="Justify",e[e.Distribute=4]="Distribute"}(Ot||(Ot={})),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.subLineBoxes=[],t}(0,s.__extends)(t,e),Object.defineProperty(t.prototype,"align",{get:function(){switch(this.boxEnv.paraProperty.jc){case c.aLG.both:return Ot.Justify;case c.aLG.center:return Ot.Center;case c.aLG.left:return Ot.Left;case c.aLG.right:return Ot.Right;case c.aLG.distribute:return Ot.Distribute}return Ot.Left},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"splitResult",{get:function(){var e=this.subLineBoxes.length;return this.wrapLineInfo.lineSlices[e]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wrapLineInfo",{get:function(){var e;return(null===(e=this.rollbackContext)||void 0===e?void 0:e.wrapLineInfo)?this.rollbackContext.wrapLineInfo:{isSubLine:!1,lineSlices:[]}},enumerable:!1,configurable:!0}),t.prototype.createContainer=function(){return this.isListLine()?new qe(this):new Ke(this)},t.prototype.isListLine=function(){return this.boxEnv.isListLine()},t.prototype.isFirstLine=function(){return this.boxEnv.isFirstLine()},t.prototype.getLeftIndent=function(){var e=this.boxEnv.marginStart,t=this.boxEnv.paraProperty.ind,n=t.leftChars,r=t.left,o=t.hanging;return void 0!==n&&0!==n?e+=n*c.keb.fontSize/c.jLu.indentChars:(void 0!==(e+=r)&&0!==e&&(e-=o),e)},t.prototype.getTailGlueInfo=function(e){for(var t={tailGlueCount:0,tailGlueWidth:0},n=e.length-1;n>=0;n-=1){var r=e[n];if(!(de(r)||r instanceof R||he(r))&&r.totalMeasure>0)return t;t.tailGlueCount+=1,t.tailGlueWidth+=r.measure}return t},t.prototype.canReuseRegular=function(e){if(e.isAffectedByFloating())return vt.No;var t=this.env.reflowState.checkDirty(e);return t===p.RL.BeforeDirty?this.canBeforeDirtyLineBeDirty(e)?vt.Current:vt.No:t===p.RL.Non?vt.Current:vt.No},t.prototype.canBeforeDirtyLineBeDirty=function(e){var t,n,r=e.nextSibling;if(!r&&(null===(t=e.parentBox)||void 0===t?void 0:t.breakpointCPs)){var o=null===(n=e.getAncestorOf(l.uO.Page))||void 0===n?void 0:n.nextSibling;r=null==o?void 0:o.getFirstDescendantOf(l.uO.Line,(function(e){return e.firstVisibleChild}))}return!r||!r.firstChild||this.env.reflowState.checkDirty(r)!==p.RL.Dirty||this.align!==Ot.Distribute&&this.align!==Ot.Justify&&this.boxEnv.contentMaxMeasure-e.totalMeasure<r.firstChild.totalMeasure},t.prototype.isLastLine=function(){var e=this.container.getContentChildren();return(0,m.Rz)(e)instanceof R},t.prototype.getCurrentTab=function(e,t){return this.getAbsoluteTab(t)||this.getParagraphTab(e)},t.prototype.getDecimalPos=function(e,t){var n,r,o;try{for(var i=(0,s.__values)(this.container.getContentChildren()),a=i.next();!a.done;a=i.next()){var c=a.value;if(c instanceof x){var l=null===(o=c.layoutCursor)||void 0===o?void 0:o.inlinePos,u=c.measure;if(void 0===l)return t-e;if(!(l>t||l+u<e)){var d=c.text.indexOf(".");if(!(d<0))return t-(this.getLeftIndent()+l+be.getInstance().oldMeasure(c.text.slice(0,d),c.textStyle).width)}}}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return t-e},t.prototype.hasPTab=function(e){return e.has(c.kkf.getPropertyClass(c.uSS.RunProperty).tKeys.ptab)&&e.ptab.alignment!==c.g4b.undefined},t.prototype.getParagraphTab=function(e){var t,n,r=this.boxEnv.paraProperty.tabs.tab.getPropertyList();if(!r||0===r.length)return null;try{for(var o=(0,s.__values)(r),i=o.next();!i.done;i=o.next()){var a=i.value;if(a.pos>e&&a.val!==c.lp4.clear&&a.val!==c.lp4.bar)return a}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return null},t.prototype.getAbsoluteTab=function(e){if(!this.hasPTab(e))return null;var t=e.ptab,n=t.alignment,r=t.relativeTo,o=t.leader,i=new(c.kkf.getPropertyClass(c.uSS.CTTabStop)),a=this.getPageCoreWidth(),s=this.parentContext.node.getRightIndent();switch(n){case c.g4b.right:i.pos=a-Math.max(s,0),i.val=c.lp4.right;break;case c.g4b.left:i.pos=0,i.val=c.lp4.left;break;case c.g4b.center:i.val=c.lp4.center,i.pos=r===c.j97.indent?(a+this.getLeftIndent())/2:a/2}return i.leader=ue[o],i},t.prototype.getPageCoreWidth=function(){for(var e=this.parentContext;e;){if(e instanceof Bt)return e.container.getMaxContentMeasure();e=e.parentContext}return this.container.getMaxContentMeasure()},t=(0,s.__decorate)([It({type:l.Rz.Line})],t)}(Tt);var Dt,Mt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t=(0,s.__decorate)([It({type:l.Rz.Text})],t)}(xt),At=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t.prototype.createContainer=function(){return new Je(this)},t=(0,s.__decorate)([It({type:l.Rz.TextFrame})],t)}(Tt),Lt=n(75939),Nt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t.prototype.createContainer=function(){return new Ye(this)},t.prototype.canReuseRegular=function(e){if(e.isAffectedByFloating())return vt.NoForAll;var t=this.env.reflowState,n=t.getDirtyBegin(e);return e.getTableEnd()<=n&&(0,Lt.dr)(this,e,t)?vt.Current:(this.forceDirty(e),vt.No)},t.prototype.forceDirty=function(e){for(var t=e;null==t?void 0:t.hasNextPartial;)for(var n=t=t.nextPartial;n;)n.nonReusable=!0,n=n.parentBox},t=(0,s.__decorate)([It({type:l.Rz.Table})],t)}(Tt);(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.createContainer=function(){return new Ze(this)},t.prototype.canReuseRegular=function(e){var t=this.env.reflowState,n=t.getDirtyBegin(e);if(e.getRowEnd()<=n){if(e.children.some((function(e){return e.isMergeBegin||void 0!==e.mergedType})))return vt.No;if(e.rowIndex!==this.node.getRowIndex())return this.indexChanged=!0,vt.No;if((0,Lt.dr)(this,e,t))return vt.Current}return vt.No},t=(0,s.__decorate)([It({type:l.Rz.TableRow})],t)})(Tt),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.createContainer=function(){return new Xe(this)},t.prototype.canReuseRegular=function(e){var t;if(this.checkConsistency(e)){if(null===(t=this.parentContext)||void 0===t?void 0:t.indexChanged)return vt.No;if(e.isEmptyPlaceholder())return vt.No;if(e.isMergeBegin||void 0!==e.mergedType)return vt.No;var n=this.env.reflowState;return n.checkDirty(e)===p.RL.BeforeDirty&&(0,Lt.dr)(this,e,n)?vt.Current:vt.No}return vt.No},t.prototype.checkConsistency=function(e){return e.mergedType===this.node.mergedType&&(0,m.n$)(this.node.isEmptyPlaceholder(),e.getRangeBegin()===c.S$m)},t=(0,s.__decorate)([It({type:l.Rz.TableCell})],t)}(Tt),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t=(0,s.__decorate)([It({type:l.Rz.Image})],t)}(xt),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.canReuse=function(e){return e.key===this.node.key&&e.fieldPluginType===this.node.pluginType&&e.fieldSubtype===this.node.fieldSubtype&&this.node.measureFit!==z.Tf.FitParent?vt.Current:vt.No},t=(0,s.__decorate)([It({type:l.Rz.FieldContainer})],t)}(xt),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t=(0,s.__decorate)([It({type:l.Rz.LeafContainer})],t)}(xt),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t=(0,s.__decorate)([It({type:l.Rz.EmbeddedObject})],t)}(xt),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.createContainer=function(){return new $e(this)},t=(0,s.__decorate)([It({type:l.Rz.Endnote})],t)}(Tt),function(e){e[e.Perfect=0]="Perfect",e[e.Inperfect=1]="Inperfect",e[e.Not=2]="Not",e[e.PreferLast=3]="PreferLast"}(Dt||(Dt={}));var Bt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t.prototype.createContainer=function(){return new et(this)},t.prototype.canReuseRegular=function(){return vt.No},t=(0,s.__decorate)([It({type:l.Rz.Columns})],t)}(Tt),Ft=function(){function e(){}return e.create=function(e,t,n){var r=function(e){var t;return null===(t=Rt[e])||void 0===t?void 0:t.ctor}(t.type);return r?new r(e,t,n):void 0},e}(),Ut=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t.prototype.isSealed=function(){return!1},t}(ze),Ht=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.createContainer=function(){return new Ut(this)},t=(0,s.__decorate)([It({type:l.Rz.FieldCode})],t)}(Tt),{});function jt(e){return function(t){Ht[e.type]={ctor:t,property:e}}}function Gt(e){var t;return null===(t=Ht[e])||void 0===t?void 0:t.property}var Vt=function(){function e(e){this.context=e,this.context=e}return e.prototype.onReuse=function(e){},e}(),Wt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.selfRollbackCount=0,t}return(0,s.__extends)(t,e),t.prototype.canPush=function(e){var t=this.context.container;return!t.isOverflow(e)||this.context.container.direction===l.U6.Block&&!!this.context.boxEnv.flexibleMaxExtent&&!t.isOverflow()},t.prototype.shouldSetBlockBreak=function(){return!this.context.env.state.isBlockBreaked()&&this.context.container.direction===l.U6.Block},t.prototype.push=function(e){if(this.canPush(e))return this.context.container.push(e),void(this.shouldSetBlockBreak()&&this.context.container.isOverflow()&&this.context.env.state.setBlockBreak());this.shouldSetBlockBreak()&&this.context.env.state.setBlockBreak()},t.prototype.emit=function(){var e=this.context.node.isHidden?this.createHiddenBox():this.createBox();return e&&(e.initFromNode(this.context.node),e.setEnv(this.context.env,e.calculateRangesBeforEmit(this.context.node))),e},t.prototype.beforeFlow=function(){},t.prototype.onCommit=function(e){},t.prototype.beforeVisit=function(){},t.prototype.createHiddenBox=function(){var e=this.createEmptyBox();return e.hidden=!0,e},t.prototype.allowEmpty=function(){return!1},t.prototype.mergeBreakpoints=function(e){var t=e.children.reduce((function(e,t){var n;return e.concat(null!==(n=t.breakpointCPs)&&void 0!==n?n:[])}),[]);return t.length>0?t:void 0},t.prototype.createBox=function(){var e=this.context.container.getContentChildren();if(0!==e.length||this.allowEmpty()){var t=this.createEmptyBox(),n=this.context.env;return t.append.apply(t,(0,s.__spreadArray)([n],(0,s.__read)(e),!1)),t.breakpointCPs=this.mergeBreakpoints(t),t}},t.prototype.createEmptyBox=function(){var e=this.context.container.createBoxMetric(),t=new(this.getBoxConstructor())(e.size);return t.logicEdge=e.edge,t},t.prototype.getBoxConstructor=function(){return function(e,t){var n,r,o=v[e];if(o)return t&&o.subCtors&&null!==(r=null===(n=o.subCtors.find((function(e){return e.predicate(t)})))||void 0===n?void 0:n.subCtor)&&void 0!==r?r:o.ctor}(Gt(this.context.node.type).kind,this.context.boxEnv)},t.prototype.shouldBreak=function(){return this.context.container.isSealed()},t.prototype.rollbackSelf=function(){this.context.reset(),this.selfRollbackCount+=1},t.prototype.shouldRollbackAll=function(e){var t=this.context.container;return t.getBlockPos(e.relativeFrom)-t.content.blockPos>e.pos},t.prototype.rollbackTo=function(e){for(var t=this.context.container;t.getBlockPos(e.relativeFrom)>e.pos&&!t.isEmpty();)t.pop()},t.prototype.shouldRollbackSelf=function(e){return!1},t.prototype.isSelfRollbackExceedsLimit=function(e,t){var n;if(void 0===t&&(t=!0),this.selfRollbackCount>b.T4.MAX_SELF_ROLLBACK){if(t){var r=e.getRanges(!0);b.No.error({error:b.oY.InfiniteRollback,boxKind:null===(n=Gt(this.context.node.type))||void 0===n?void 0:n.kind,rangeOrRanges:r},this.context.env)}return!0}return!1},t.prototype.shouldVisit=function(){return!0},t}(Vt);(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.emit=function(){var t,n=e.prototype.emit.call(this);return n&&(n.breakpointCPs=null===(t=n.lastChild)||void 0===t?void 0:t.breakpointCPs),n},t.prototype.onCommit=function(e){var t=this.context.env.reflowState;t&&e.getRangeEnd()+1===t.mainStoryEnd&&t.markReflowEnd()},t=(0,s.__decorate)([jt({type:l.Rz.MainStory,kind:l.uO.Document})],t)})(Wt),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.emit=function(){var t=e.prototype.emit.call(this),n=this.context.env,r=n.state,o=n.floatingHostStack,i=n.curFloatingHost;if(r.clearBlockBreak(),r.clearPageBreak(),t){if(void 0===t.body||!(0,l.o2)(t.body))return;t.children.forEach((function(e){e instanceof K&&(null==i||i.constraintSpace.pushAdditionalSpace(null==e?void 0:e.constraintSpace)),e instanceof W&&i.constraintSpace.merge(e.constraintSpace)})),this.context.env.isPrintLayout&&o.popToAttach("page-".concat(this.context.node.getGCPRange().begin()),t,t),t.containFloating&&this.context.env.updateComplexity(p.jd.Floating)}return t},t.prototype.onCommit=function(e){var t=this.isLastPage(e);this.context.env.isWebLayout?t&&this.context.boxEnv.resetLastVirtualPageEdge(e.logicEdge):this.context.env.isContinuousPaged&&e.cropBodyOuter(t)},t.prototype.isLastPage=function(e){var t,n=null===(t=this.context.env.getContentRange())||void 0===t?void 0:t.end();return e.getRangeEnd()+1===n},t.prototype.onReuse=function(){this.context.env.isPrintLayout&&this.context.env.floatingHostStack.popEmpty("page-".concat(this.context.node.getGCPRange().begin()))},t.prototype.beforeVisit=function(){this.context.env.pageBreakEnd=Number.MAX_SAFE_INTEGER;var e=this.context.node.getProperty(),t=e.pgSz,n=e.pgMar,r=n.top,o=n.bottom,i=0;(0,c.WGN)(this.context.env.docEnv.layoutType)&&(r=c.keb.printLayout.continuous.paddingTop,o=c.keb.printLayout.continuous.paddingBottom,i=n.top+n.bottom-r-o),this.context.env.floatingHostStack.pushHost({measure:t.w,extent:t.h-i,margins:{left:n.left,right:n.right,top:r,bottom:o}},"page-".concat(this.context.node.getGCPRange().begin())),tt.currentPageNumber=this.context.node.pageNumber},t=(0,s.__decorate)([jt({type:l.Rz.Page,kind:l.uO.Page})],t)}(Wt),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.emit=function(){var t,n=this.context,r=n.node,o=n.env,i=r.uniqueKey;if(r.isMirror){var a=o.getCachedBox(i);t=null==a?void 0:a.clone(o)}else(t=e.prototype.emit.call(this))&&(o.cacheBox(t,i),o.state.clearBlockBreak(),t.breakpointCPs=void 0),this.floatingProcess(t);return t&&t.children.length>0&&this.context.env.updateComplexity(p.jd.HeaderFooter),t},t.prototype.onCommit=function(e){var t,n;if(e.storyId){var r=null===(t=this.context.env.dataEngine.getDataStream().getStoryStream().getSubStoryInfoFromId(e.storyId))||void 0===t?void 0:t.contentRange;r&&(null===(n=this.context.env.reflowState)||void 0===n||n.clearDirtyRange([r]))}},t.prototype.floatingProcess=function(e){var t;if(e&&this.context.env.isPrintLayout){var n=this.context.env.curFloatingHost.pageRegion.extent;e&&this.context.env.floatingHostStack.popToAttach("hft-".concat(this.context.node.getGCPRange().begin(),"-").concat(this.context.node.uniqueKey),void 0,e),this.context.node.isHeader||null===(t=e.constraintSpace)||void 0===t||t.offsetTopOfRelative(n-e.totalExtent)}},t.prototype.allowEmpty=function(){return this.context.node.storyId&&u.Logger.error("[Layout] Header/Footer empty with content."),!0},t.prototype.shouldVisit=function(){return!this.context.node.isMirror},t.prototype.onReuse=function(){this.context.env.isPrintLayout&&this.context.env.floatingHostStack.popEmpty("hft-".concat(this.context.node.getGCPRange().begin(),"-").concat(this.context.node.uniqueKey))},t.prototype.beforeVisit=function(){if(this.context.env.isPrintLayout){var e=this.context.node.getSectionProperty(),t=e.pgSz,n=e.pgMar;this.context.env.floatingHostStack.pushHost({measure:t.w,extent:t.h,margins:n},"hft-".concat(this.context.node.getGCPRange().begin(),"-").concat(this.context.node.uniqueKey)),this.context.env.curFloatingHost.relativeFrom=Pe.HeaderFooter}},t.prototype.shouldRollbackAll=function(){return!1},t=(0,s.__decorate)([jt({type:l.Rz.HeaderFooter,kind:l.uO.HeaderFooter})],t)}(Wt),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.shouldRollbackError=!1,t}(0,s.__extends)(t,e),t.prototype.emit=function(){var t=this.context.env.errorRecoveryNodeType===l.Rz.Body,n=t?void 0:e.prototype.emit.call(this);if(!n){if(this.isDataError())return;return this.autofix(t)?(this.shouldRollbackError=!0,this.createEmptyBox()):void 0}return this.context.env.state.ignorePageBreak&&(this.context.env.state.ignorePageBreak=void 0),this.context.env.isPrintLayout?this.context.env.floatingHostStack.popToAttach("body-".concat(this.context.node.getGCPRange().begin()),n,n):this.context.env.state.clearBlockBreak(),n},t.prototype.isDataError=function(){return!this.context.node.getBeginChild()&&(this.context.env.containsDataError=!0,!0)},t.prototype.autofix=function(e){var t=void 0;if(e)this.context.env.errorRecoveryNodeType=void 0;else{var n=this.context.node.beginOffset,r=this.context.node.getGCPRange().end(),o=new c.ICE(n,r-n);t=this.diagnosisError(o),b.No.error({error:t,rangeOrRanges:o},this.context.env)}if(!this.context.env.allowAutofix())return!1;if(t===b.oY.UnexpectedPageBreak)this.context.env.state.ignorePageBreak=!0,this.context.env.state.clearPageBreak();else if(t===b.oY.ErrorTable)this.context.node.skipFirstParaOrTable();else if(t===b.oY.EmptyBody||void 0===t){var i=this.context.node.parent;this.context.env.isPrintLayout&&i&&!i.isMinimalistMode()?i.enableMinimalistMode():this.context.node.skipFirstParaOrTable()}return this.context.env.state.clearBlockBreak(),this.context.env.increaseAutofixCounter(),this.lastError=t,!0},t.prototype.diagnosisError=function(e){if(this.context.env.state.hasPageBreak())return b.oY.UnexpectedPageBreak;if(this.context.env.state.isBlockBreaked()&&this.lastError!==b.oY.UnexpectedBreak)return b.oY.UnexpectedBreak;var t=this.context.env.dataEngine.getDataStream().getTableStream().createTableIterator();return t.seek(e.gcpBegin),t.getRange().contains(e.gcpBegin)?b.oY.ErrorTable:b.oY.EmptyBody},t.prototype.shouldRollbackSelf=function(e){return!(this.isSelfRollbackExceedsLimit(e)||(this.shouldRollbackError?(this.shouldRollbackError=!1,this.context.env.curFloatingHost.reset(),0):!this.checkRollbackSpace(e)||(this.context.env.state.clearBlockBreak(),this.context.env.state.clearPageBreak(),0)))},t.prototype.checkRollbackSpace=function(e){var t,n,r,o,i,a=e.getRangeEnd()-1,c=null===(r=e.constraintSpace)||void 0===r?void 0:r.getFloatingBoxes();if(!c||0===c.size)return!1;this.context.env.pageBreakEnd=Number.MAX_SAFE_INTEGER;var l=null!==(i=null===(o=this.context.env.getContentRange())||void 0===o?void 0:o.end())&&void 0!==i?i:1/0;try{for(var u=(0,s.__values)(c),d=u.next();!d.done;d=u.next()){var p=(0,s.__read)(d.value,2)[1],h=p.getRangeBegin();a>0&&a<h&&h<l&&(this.context.env.pageBreakEnd=Math.min(this.context.env.pageBreakEnd,h),this.context.env.constraintSpace.deleteFloating(p.floatingSpace.id))}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return this.context.env.pageBreakEnd!==Number.MAX_SAFE_INTEGER},t.prototype.beforeVisit=function(){var e,t,n,r,o;if(this.context.env.isPrintLayout){var i=this.context.node.getProperty(),a=i.pgSz,s=i.pgMar,l=null===(e=this.context.parentContext)||void 0===e?void 0:e.container.content;if(!(l instanceof Ue))return;var u=null!==(n=null===(t=l.getHeader())||void 0===t?void 0:t.totalExtent)&&void 0!==n?n:0,d=null!==(o=null===(r=l.getFooter())||void 0===r?void 0:r.totalExtent)&&void 0!==o?o:0,p=s.top,h=s.bottom,f=0;(0,c.WGN)(this.context.env.docEnv.layoutType)?(p=c.keb.printLayout.continuous.paddingTop,h=c.keb.printLayout.continuous.paddingBottom,f=s.top+s.bottom-p-h):(p=u,h=d),this.context.env.floatingHostStack.pushHost({measure:a.w,extent:a.h-f,headerExtent:u,footerExtent:d,margins:{left:s.left,right:s.right,top:p,bottom:h},continueHiddenTop:u-p,continueHiddenBottom:d-h},"body-".concat(this.context.node.getGCPRange().begin()))}},t=(0,s.__decorate)([jt({type:l.Rz.Body,kind:l.uO.Body})],t)}(Wt),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t=(0,s.__decorate)([jt({type:l.Rz.Section,kind:l.uO.Section})],t)}(Wt),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.emit=function(){var t=e.prototype.emit.call(this);return this.context.env.isPrintLayout&&(this.context.boxEnv.isLast||this.context.env.state.clearBlockBreak()),t&&(t.maxContentMeasure=this.context.container.getMaxContentMeasure(),this.context.env.state.hasPageBreak()&&(t.containsPageBreakSignal=!0)),t},t.prototype.beforeVisit=function(){if(this.context.env.isPrintLayout&&this.context.parentContext instanceof Bt){var e=this.context.env.curFloatingHost.relativeFrom;this.context.env.curFloatingHost.onColumnStart(this.context.container.getInlinePos(e),this.context.container.getBlockPos(e))}},t=(0,s.__decorate)([jt({type:l.Rz.RichTextArea,kind:l.uO.RichTextArea})],t)}(Wt),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.createBox=function(){var t=e.prototype.createBox.call(this);if(t)return t.property=this.context.boxEnv.property,this.context.boxEnv.isSplitted&&(t.breakpointCPs=[t.getRangeEnd()-1]),t},t.prototype.emit=function(){var t=e.prototype.emit.call(this);return t&&this.context.env.state.hasPageBreak()&&(t.containsPageBreakSignal=!0),t},t.prototype.push=function(e){var t,n,r=this.context,o=r.container,i=r.env,a=r.boxEnv;if(this.context.env.pageBreakEnd!==Number.MAX_SAFE_INTEGER){var s=e.getRangeEnd()-1,c=null!==(n=null===(t=this.context.env.dataEngine.getDataStream().getStoryStream().getMainStoryInfo())||void 0===t?void 0:t.contentRange.end())&&void 0!==n?n:1/0;if(this.context.env.pageBreakEnd<=s&&s<c)return this.context.env.curFloatingHost.clearPendingLine(),void i.state.setBlockBreak()}return e.getRangeBegin()===i.state.getPageBreakGcp()?(i.state.clearPageBreakGcp(),void(this.shouldSetBlockBreak()&&i.state.setBlockBreak())):this.canPush(e)?(this.context.env.curFloatingHost.popPendingDrawingsByGCP(e.getRangeEnd()),this.context.env.curFloatingHost.onLineDone(),void o.push(e)):(i.isPrintLayout&&a.split(),void(this.shouldSetBlockBreak()&&i.state.setBlockBreak()))},t.prototype.onCommit=function(){this.context.env.curFloatingHost.onBlockDone();var e=this.context.env.curFloatingHost.relativeFrom,t=this.context.env.curFloatingHost.flushRollback();t.verticalPos<this.context.container.getBlockPos(e)&&this.context.env.state.setRollbackPos({pos:t.verticalPos,relativeFrom:e})},t.prototype.checkKeepNext=function(){var e,t,n,r,o,i=this.context,a=i.container,c=i.parentContext;if(0!==a.content.getChildren().length||!c||this.context.node.hasOffsets)return!0;for(var l=null,u=0,d=c.container.getContentChildren(),p=d.length-1;p>=0;p--){var h=d[p];if(h instanceof U){if(!h.property.keepNext)break;if(u+=1,l=(0,s.__read)(h.children.slice(-1),1)[0],h.breakpointCPs)break;if(1!==h.children.length)break}}if(u===d.length)return!1;if(l){var f=this.context.env.curFloatingHost.relativeFrom,g=((null===(t=null===(e=this.context.parentContext)||void 0===e?void 0:e.parentContext)||void 0===t?void 0:t.container.getBlockPos(f))||0)+((null===(r=null===(n=l.parentBox)||void 0===n?void 0:n.layoutCursor)||void 0===r?void 0:r.blockPos)||0)+((null===(o=l.layoutCursor)||void 0===o?void 0:o.blockPos)||0);return g&&this.context.env.state.setRollbackPos({pos:g,relativeFrom:f}),this.context.env.state.setPageBreakGcp(l.getRangeBegin()),!1}return!0},t.prototype.beforeVisit=function(){var e=this.context.env.curFloatingHost.relativeFrom;this.context.env.curFloatingHost.onBlockStart(this.context.parentContext.container.getInlinePos(e),this.context.parentContext.container.getBlockPos(e))},t=(0,s.__decorate)([jt({type:l.Rz.Paragraph,kind:l.uO.Paragraph})],t)}(Wt),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.needSplitLasteBox=!0,t.hasPageBreak=!1,t}(0,s.__extends)(t,e),t.prototype.createBoxWithoutFloating=function(){this.alignLine();var t=e.prototype.createBox.call(this);if(t){var n,r=this.context.container,o=this.context.getTailGlueInfo(this.lineChildBoxes).tailGlueWidth,i=r.content.flowPos-o;t instanceof S&&r instanceof qe&&r.numberingInfo&&(n=this.createListMark(r.numberingInfo),t.listMark=n,t.listMark.lineBox=t);var a=this.getInitialValue(n),s=r.computeMetric(a),c=s.lineAscent+s.lineDescent;return t.setExtent(c),t.contentWidth=i,t.setBaseline(s.lineAscent,s.lineDescent),t.logicEdge=re.z.obtain(),t.logicEdge.margin=oe.v.zero,t.logicEdge.margin.start=this.context.boxEnv.marginStart,t.logicEdge.padding=r.computeLinePadding(s,c,i),t.isFirst=this.context.isFirstLine(),t}},t.prototype.getInitialValue=function(e){if(e){var t=e.ascent,n=e.descent,r=ae(e);return{fontAscent:t,fontDescent:n,lineAscent:t+r.before,lineDescent:n+r.after,maxFontSize:e.textStyle.sz}}return{fontAscent:0,fontDescent:0,lineAscent:0,lineDescent:0,maxFontSize:0}},t.prototype.createListMark=function(e){this.context.env.updateComplexity(p.jd.Numbering);var t=e.textGlyph.width,n=e.textGlyph.height,r=new k({measure:t,extent:n});return r.text=this.context.isListLine()?e.text:"",r.glyph=e.textGlyph,r.textStyle=e.textSpan,r.logicEdge=re.z.obtain(),r.logicEdge.padding=new oe.v({before:0,after:0,start:0,end:e.width-t}),r},t.prototype.getLastBox=function(e,t,n,r){var o,i,a;if(void 0===r&&(r=0),e instanceof x&&!(e instanceof D)){var s=this.context.parentContext.boxEnv;if(s.textCache&&s.textCache.textBoxes.length>0){var l=s.textCache.textBoxes.indexOf(e);if(l>0)for(var u=0;u<l;u++)s.textCache.textBoxes.shift();(null===(o=s.textCache.textBoxes)||void 0===o?void 0:o[0])&&(s.textCache.rangeBegin=s.textCache.textBoxes[0].getRangeBegin())}else s.textCache={rangeBegin:-1,textBoxes:[]};var d=e.getRange(!0),p=[],h={height:0,width:0,descent:0,ascent:0},f="",g=e.glyphBoxes;if(!g)return;if(g.some((function(e){return h.width+e.glyph.width>n&&(e.getTokenType()!==X.SeparatorCategory||e.text[0]===c.IfD.NonBreakSpace)||(h.width+=e.glyph.width,h.height=Math.max(e.glyph.height,h.height),h.descent=e.glyph.descent,h.ascent=e.glyph.ascent,f+=e.text,p.push(e),!1)})),0===p.length&&!t)return;s.textCache.textBoxes.shift();var v=[];for(u=g.length-1;u>=p.length;u--)v.unshift(g[u]);if(0===p.length){var y=g[0].splitBySize(n,0===r);p.push(y),h=y.glyph,f=y.text;var m=g[0].text.slice(y.text.length);if(m.length>0){var b=new Se(new L.UnicodeString(m).toSlice(),y.gcp+y.length,e.textStyle);v.shift(),v.unshift(b)}}var _=M(f||"",{measure:h.width,extent:g[0].glyph.height});if(_.textStyle=e.textStyle,_.glyph=h,_.rangeCache=new c.ICE(d.gcpBegin,f.length),_.glyphBoxes=p,v.length>0){var C=ge(v,e.textStyle);s.textCache.textBoxes.unshift(C)}return s.textCache.rangeBegin=null===(a=null===(i=s.textCache.textBoxes)||void 0===i?void 0:i[0])||void 0===a?void 0:a.getRangeBegin(),_}if(t)return e},t.prototype.getContinuousWordLen=function(e){var t;if(!(e instanceof x))return 0;for(var n=e,r=0,o=this.lineChildBoxes.length-1;o>=0;o--){var i=this.lineChildBoxes[o];if(i instanceof x&&1===(null===(t=i.glyphBoxes)||void 0===t?void 0:t.length)){var a=new L.LineBreakIterator(i.text+n.text).next().value;if(a&&a.text.length===i.text.length+n.text.length||(0,l.yv)(i)||(0,l._g)(n)){n instanceof P&&(n=i),r+=1;continue}}break}return r},t.prototype.createBox=function(){if(this.context.wrapLineInfo.isSubLine)return this.createBoxWithFloating();this.autoUpdatePrevTabSpace();var e=this.context.env.state.getInlineBreak();if(e&&this.needSplitLasteBox){var t=this.getContinuousWordLen(e),n=this.context.container.getContentChildren().length===t,r=this.context.container.getMaxContentRestMeasure(),o=this.getLastBox(e,n,r,t);if(!n&&t>0)for(var i=0;i<t;i++)this.context.container.pop();o&&this.context.container.push(o)}return this.context.env.state.clearInlineBreak(),this.clearAutoSpaceDnOrDe(this.lastMergeBox),this.createBoxWithoutFloating()},t.prototype.emit=function(){var e=this.createBox();if(e){e.children.forEach((function(e){return e.gcpOffsetToLine=void 0}));var t=e.isEmptyLine?[new c.ICE(this.context.node.getLineBegin(),0)]:e.calculateRangesBeforEmit();e.setEnv(this.context.env,t),this.context.env.beginGCPManager.insertGCP(e,e.getRangeBegin()),this.context.env.endGCPManager.insertGCP(e,e.getRangeEnd());var n=e.getRangeBegin();e.children.forEach((function(e){e.gcpOffsetToLine=e.rangeCache.gcpBegin-n,((0,l.Jt)(e)||(0,l.tq)(e))&&e.children.forEach((function(e){var t=e;t.gcpOffsetToLine=t.rangeCache.gcpBegin-n}))})),this.setSpecialBreak(e),this.context.env.state.hasPageBreak()&&(e.containsPageBreakSignal=!0),this.verify(e)}return e},t.prototype.verify=function(e){var t,n;if(e.isEmptyLine){var r=e.totalExtent;(r<=0||!Number.isFinite(r)||Number.isNaN(r))&&(b.No.error({error:b.oY.AbnormalExtent,rangeOrRanges:e.getRanges(),extraContext:"extent: ".concat(String(e.extent),", edge: ").concat(String(null!==(n=null===(t=e.logicEdge)||void 0===t?void 0:t.extent)&&void 0!==n?n:0),", emptyLine")},this.context.env),this.context.env.errorRecoveryNodeType=l.Rz.Body)}},t.prototype.onCommit=function(e){var t;e.isEmptyLine||null===(t=this.context.env.reflowState)||void 0===t||t.clearDirtyRange([e.getRange(!0)])},t.prototype.distributeAlign=function(){var e=this,t=[],n=this.lineChildBoxes[0].getRangeBegin();this.lineChildBoxes.forEach((function(e){if(e instanceof x&&!e.isReplaceText){var r=e.glyphBoxes[0].graphemeBoxList;r&&t.push.apply(t,(0,s.__spreadArray)([],(0,s.__read)(r.map((function(t){var r=M(t.text||"",{measure:t.glyph.width,extent:t.glyph.height});return r.glyph=t.glyph,r.textStyle=e.textStyle,r.rangeCache=new c.ICE(n,1),r.glyphBoxes=[new Se(new L.UnicodeString(t.text).toSlice(),n,r.textStyle)],n+=1,r}))),!1))}else n+=e.getRange().len,t.push(e)})),this.context.container.clear(),t.forEach((function(t){e.context.container.push(t)})),this.justifyAlign()},t.prototype.justifyAlign=function(){var e=this.context.getTailGlueInfo(this.lineChildBoxes),t=e.tailGlueWidth,n=this.lineChildBoxes.length-e.tailGlueCount,r=this.context.container.getMaxContentMeasure(),o=this.context.container.content.flowPos-t;if(!(o>=r||this.lineChildBoxes.length<=1)){for(var i=r-o,a=[],s=0;s<n-1;s+=1){var c=this.lineChildBoxes[s];0!==c.totalMeasure&&(de(c)?a.push(c):c instanceof D?a=[]:de(this.lineChildBoxes[s+1])||this.lineChildBoxes[s+1]instanceof R||a.push(c))}var l=i/a.length;a.forEach((function(e){e.setMeasure(e.measure+l)})),this.context.container.content.update()}},Object.defineProperty(t.prototype,"lineChildBoxes",{get:function(){return this.context.container.getContentChildren()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastMergeBox",{get:function(){return(0,m.Rz)(this.lineChildBoxes)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastNotPlaceholderTextBox",{get:function(){for(var e=this.lineChildBoxes.length-1;e>=0;e--){var t=this.lineChildBoxes[e];if(t instanceof x&&!(t instanceof P))return t;if(!(t instanceof x))break}return null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"content",{get:function(){return this.context.container.content},enumerable:!1,configurable:!0}),t.prototype.alignLine=function(){if(Number.isFinite(this.context.boxEnv.contentMaxMeasure)){var e=this.context.align;e===Ot.Distribute?this.distributeAlign():e!==Ot.Justify||this.context.isLastLine()||this.justifyAlign()}},t.prototype.canPush=function(t){return!!e.prototype.canPush.call(this,t)||!!(t instanceof x&&1===t.text.length&&(de(t)||pe(t)||he(t))&&t.text[0]!==c.IfD.NonBreakSpace)},t.prototype.push=function(t){if(!this.needForceBreak(t,this.lastMergeBox)){if(this.autoSpaceDnOrDe(this.lastNotPlaceholderTextBox,t),this.autoUpdateTabSpace(t))return;if(this.context.wrapLineInfo.isSubLine&&!(t instanceof j))return void this.pushSubLine(t);if(this.canPush(t))return e.prototype.push.call(this,t),void(this.context.node.virtualEnds=[t.getRangeEnd()])}this.context.env.state.setInlineBreak(t)},t.prototype.autoUpdateTabSpace=function(e){if(e instanceof D){if(this.autoUpdatePrevTabSpace()&&this.lastTabStopBox){var t=this.lineChildBoxes.indexOf(this.lastTabStopBox);this.context.env.state.setInlineBreak(this.lastTabStopBox);for(var n=this.lineChildBoxes.length-1;n>=Math.max(t,1);n--)this.lineChildBoxes.pop();return this.content.update(),!0}var r=this.content.inlinePos+this.context.getLeftIndent();if(this.context.hasPTab(e.textStyle)&&e.textStyle.ptab.alignment===c.g4b.left&&(e.textStyle.ptab.relativeTo===c.j97.indent||r>0))return!this.context.container.isEmpty()&&(e.setMeasure(0),this.context.env.state.setInlineBreak(e),!0);var o=this.context.getCurrentTab(r,e.textStyle);if(!o){var i=this.context.env.dataEngine.getDataManager().getSettingsManager().getDocSettingsProperty(!0).defaultTabStop||c.keb.tabSize;return e.setMeasure(i-r%i),!1}var a=o.pos-r,s=0;switch(o.val){case c.lp4.left:s=a;break;case c.lp4.center:case c.lp4.right:case c.lp4.decimal:s=0}s=Math.min(Math.max(s,0),this.context.container.getMaxContentMeasure()),e.setMeasure(s),this.lastTabStopBox=e,this.updateTabStopLeadingText(e,o),this.content.update()}return!1},t.prototype.autoUpdatePrevTabSpace=function(){var e,t,n=this.lastTabStopBox;if(!n)return!1;this.lastTabStopBox=void 0;var r=this.content.inlinePos+this.context.getLeftIndent()-this.context.getTailGlueInfo(this.lineChildBoxes).tailGlueWidth,o=(null!==(t=null===(e=n.layoutCursor)||void 0===e?void 0:e.inlinePos)&&void 0!==t?t:0)+this.context.getLeftIndent(),i=this.context.getCurrentTab(o,n.textStyle);if(i){var a=0;switch(i.val){case c.lp4.right:a=i.pos-r;break;case c.lp4.center:a=i.pos-(r+o)/2;break;case c.lp4.decimal:a=this.context.getDecimalPos(o,i.pos);break;default:return}var s=this.context.container.getMaxContentMeasure()+this.context.getLeftIndent()-r+n.measure,l=a>=s;return a=Math.max(Math.min(a,s),0),n.setMeasure(a),this.updateTabStopLeadingText(n,i),this.content.update(),l}return!1},t.prototype.updateTabStopLeadingText=function(e,t){var n=le[t.leader];if(n){var r=be.getInstance().oldMeasure(n,e.textStyle||void 0).width;e.updateRenderString(n.repeat(Math.floor(e.measure/r)))}},t.prototype.autoSpaceDnOrDe=function(e,t){if(e&&t&&e instanceof x&&t instanceof x){var n=this.measureTextGap(e,t);e.setMeasure(e.measure+n),this.content.update()}},t.prototype.clearAutoSpaceDnOrDe=function(e){var t;e instanceof x&&!(e instanceof D)&&(e.setMeasure((null===(t=e.glyphBoxes)||void 0===t?void 0:t.reduce((function(e,t){return t.glyph.width+e}),0))||0),this.content.update())},t.prototype.measureTextGap=function(e,t){var n=e.text.charAt(e.text.length-1),r=t.text.charAt(0);return this.context.parentContext.node.getProperty().autoSpaceDE&&((0,L.isHanScript)(n)&&(0,L.isLatinScript)(r)||(0,L.isHanScript)(r)&&(0,L.isLatinScript)(n))||this.context.parentContext.node.getProperty().autoSpaceDN&&((0,L.isHanScript)(n)&&(0,L.isDigitCategory)(r)||(0,L.isHanScript)(r)&&(0,L.isDigitCategory)(n))?.25*e.textStyle.renderFontSize:0},t.prototype.setSpecialBreak=function(e){this.hasPageBreak&&this.safeSetPageBreak(e);var t=(0,l.Jt)(e.lastChild)?e.lastChild.lastChild:e.lastChild;if(he(t)){var n=this.context.env.dataEngine.getDataStream().getSectionStream().createSectionIterator();n.seek(t.getRangeBegin()+1);var r=n.getProperty();r&&r.type!==c.SN$.continuous&&this.safeSetPageBreak(e)}},t.prototype.safeSetPageBreak=function(e){if(this.context.env.isPrintLayout){var t=e.getRangeBegin(),n=this.context.env.dataEngine.getDataStream().getTableStream().createTableIterator();n.seek(t),n.getRange().contains(t)||this.context.env.state.setPageBreak()}},t.prototype.needForceBreak=function(e,t){var n,r;return this.needSplitLasteBox=!1,!(!(!this.context.env.isPrintLayout&&this.lineChildBoxes.length>0&&((0,l.qM)(e)||(0,l.qM)(t)||(0,l.tJ)(e)||(0,l.tJ)(t))&&((null===(n=e.property)||void 0===n?void 0:n.isFloating)||(null===(r=null==t?void 0:t.property)||void 0===r?void 0:r.isFloating)))&&(!pe(t)||he(e)&&fe(t))&&(!function(e){var t;if(e instanceof x){var n=null===(t=e.glyphBoxes)||void 0===t?void 0:t[0];return n&&n.getTokenType()===X.PageBreak}return!1}(t)||(this.hasPageBreak=!0,fe(e)||he(e)||0===e.totalMeasure))&&(this.needSplitLasteBox=!0,1))},t.prototype.shouldRollbackSelf=function(e){var t,n,r;if(this.isSelfRollbackExceedsLimit(e))return!1;if(e.children[0]instanceof j||e.isEmptyLine)return!1;if(!this.context.env.constraintSpace.containsFloating()||(null===(t=this.context.env.curCursorState)||void 0===t?void 0:t.shouldSkipSplit()))return!1;var o=null!==(r=null===(n=this.context.env.getContentRange())||void 0===n?void 0:n.end())&&void 0!==r?r:1/0;if(e.getRangeEnd()<o&&e.getRangeEnd()>this.context.env.pageBreakEnd)return!1;var i=this.context.env.curFloatingHost.relativeFrom;if(this.lastLineRect={top:this.context.container.getBlockPos(i),left:this.context.parentContext.container.getInlinePos(i),height:e.totalExtent,width:e.totalMeasure},!this.context.env.constraintSpace.hasCrossExclusions(this.lastLineRect))return!1;var a=this.context.getLeftIndent(),c=this.context.env.constraintSpace.splitLineSlice((0,s.__assign)((0,s.__assign)({},this.lastLineRect),{width:this.context.container.maxParaMeasure-this.context.boxEnv.marginStart}),a),l=this.context.container;return l instanceof qe&&(l.listMarkExist=!1,c.forEach((function(e){var t,n;e.measure-=null!==(n=null===(t=l.numberingInfo)||void 0===t?void 0:t.width)&&void 0!==n?n:0}))),this.context.rollbackContext={last:e,wrapLineInfo:{isSubLine:!0,lineSlices:c}},this.context.env.curFloatingHost.clearPendingLine(),!0},t.prototype.pushSubLine=function(e){var t,n;if(!(e.getRangeBegin()>(null===(n=null===(t=this.context.node)||void 0===t?void 0:t.virtualEnds)||void 0===n?void 0:n[0]))){var r=this.context.wrapLineInfo.lineSlices;if(0!==r.length){if(!this.content.willOverflow(e,this.context.splitResult.measure))return this.content.push(e),this.context.node.virtualEnds=[e.getRangeEnd()],void this.context.env.state.clearInlineBreak();var o=this.context.splitResult.measure>0?this.getLastBox(e,!1,this.context.splitResult.measure-this.content.inlinePos):null;!o||o instanceof j||this.content.push(o);var i=this.createSubLine();if(i.children.length>0){var a=i.firstChild.getRangeBegin();i.rangeCache=new c.ICE(a,i.lastChild.getRangeEnd()-a)}else i.rangeCache=new c.ICE(e.getRangeBegin(),0);this.content.clear(),this.context.subLineBoxes.push(i),this.context.subLineBoxes.length>=r.length&&this.context.env.state.setInlineBreak(e),this.context.node.virtualEnds=o?[o.getRangeEnd()]:[e.getRangeBegin()]}else this.context.env.state.setInlineBreak(e)}},t.prototype.createSubLine=function(){var e,t;this.alignLine();var n=this.context.container,r=this.content.inlinePos,o=r-this.context.getTailGlueInfo(this.content.getChildren()).tailGlueWidth,i=this.getInitialValue(void 0),a=this.context,c=a.splitResult,l=a.subLineBoxes,u=n.computeMetric(i),d=u.lineAscent+u.lineDescent,p=new j({measure:r,extent:d});return p.contentWidth=o,p.setBaseline(u.lineAscent,u.lineDescent),p.logicEdge=re.z.obtain(),p.logicEdge.margin=oe.v.zero,p.logicEdge.margin.start=c.offsetLeft,p.logicEdge.padding=n.computeLinePadding(u,d,o,c.measure),p.logicEdge.padding.end=c.measure-o-p.logicEdge.padding.start,n instanceof qe&&!n.listMarkExist&&(p.logicEdge.padding.end+=null!==(t=null===(e=n.numberingInfo)||void 0===e?void 0:e.width)&&void 0!==t?t:0,n.listMarkOffset+=c.offsetLeft+(l.length>0?this.context.wrapLineInfo.lineSlices[l.length-1].measure:0),o>0?(this.context.wrapLineInfo.lineSlices.forEach((function(e){var t,r;e.measure+=null!==(r=null===(t=n.numberingInfo)||void 0===t?void 0:t.width)&&void 0!==r?r:0})),n.listMarkExist=!0):n.listMarkOffset+=p.edge.padding.left),p.append.apply(p,(0,s.__spreadArray)([this.context.env],(0,s.__read)(this.content.getChildren()),!1)),p},t.prototype.createBoxWithFloating=function(){if(!this.content.isEmpty()){var e=this.createSubLine(),t=e.firstChild.getRangeBegin();e.rangeCache=new c.ICE(t,e.lastChild.getRangeEnd()-t),this.content.clear(),this.context.subLineBoxes.push(e)}if(this.context.subLineBoxes.every((function(e){return 0===e.children.length}))){var n=this.context.env.constraintSpace.getOffsetYByCursor(this.lastLineRect),r=new C({measure:0,extent:n});return r.isEmptyLine=!0,this.context.env.state.clearInlineBreak(),r}var o=new(this.getBoxConstructor());o.contentWidth=0;var i=0;this.context.subLineBoxes.forEach((function(e){o.contentWidth+=e.totalWidth,o.setExtent(Math.max(o.extent,e.totalExtent)),o.setBaseline(Math.min(e.ascent,o.ascent),Math.max(e.descent,o.descent)),i=Math.max(e.extent,i)})),this.context.subLineBoxes.forEach((function(e){e.setExtent(i),e.setBaseline(i-o.descent,o.descent)}));var a,l=this.context.container;return o instanceof S&&l instanceof qe&&l.numberingInfo&&(a=this.createListMark(l.numberingInfo),o.listMark=a,a.offsetLeft=l.listMarkOffset,o.listMark.lineBox=o),o.setMeasure(o.contentWidth),o.logicEdge=re.z.obtain(),o.logicEdge.margin=oe.v.zero,o.logicEdge.margin.start=this.context.boxEnv.marginStart,o.isFirst=this.context.isFirstLine(),o.append.apply(o,(0,s.__spreadArray)([this.context.env],(0,s.__read)(this.context.subLineBoxes),!1)),this.context.env.state.clearInlineBreak(),o},t=(0,s.__decorate)([jt({type:l.Rz.Line,kind:l.uO.Line})],t)}(Wt),function(e){function t(t){var n=e.call(this,t)||this;return n.node=t.node,n.env=t.env,n}var n;(0,s.__extends)(t,e),t.prototype.getGlyphBoxes=function(e){var t=this;return 1===e.length?[new Se(new L.UnicodeString(e).toSlice(),this.node.getTextRange().begin(),this.node.getProperty())]:new L.UnicodeString(e).getAllNoWordWrapSlice().map((function(e){return new Se(new L.UnicodeString(e.text).toSlice(),t.node.getTextRange().begin()+e.startIndex,t.node.getProperty())}))},t.prototype.isSpecialToken=function(e){var t=e.getTokenType();return t===X.SeparatorCategory||t===X.Tabstop||""===e.text},t.prototype.createTextBox=function(){var e,t=this.context.parentContext.parentContext.boxEnv;if((null===(e=t.textCache)||void 0===e?void 0:e.rangeBegin)===this.node.getTextRange().begin()&&t.textCache.textBoxes.length>0)return t.textCache.textBoxes;for(var n=this.node.getTextContent(),r=this.getGlyphBoxes(n),o=[],i=[],a=this.context.parentContext.align===Ot.Justify||this.context.parentContext.align===Ot.Distribute,s=this.context.parentContext.node instanceof z.px||void 0!==this.context.node.replacedText;r&&r.length>0;){var c=r.shift();if(i.push(c),this.shouldSplitBox(c,r,s,a)){var l=ge(i,this.context.boxEnv.property);o.push(l),i=[]}}i.length>0&&(l=ge(i,this.context.boxEnv.property),o.push(l));var u=this.changeReplaceTextBoxRange(o);return t.textCache={rangeBegin:this.node.getTextRange().begin(),textBoxes:u},u},t.prototype.shouldSplitBox=function(e,t,n,r){if(void 0===n&&(n=!1),void 0===r&&(r=!1),n)return!1;if(r)return!0;if(0===t.length)return!0;var o=t[0];if(this.isSpecialToken(e)||this.isSpecialToken(o))return!0;var i=e.text.charAt(e.text.length-1),a=o.text.charAt(0);return!(!(0,L.isHanScript)(i)||!(0,L.isLatinScript)(a)&&!(0,L.isDigitCategory)(a))||!(!(0,L.isHanScript)(a)||!(0,L.isLatinScript)(i)&&!(0,L.isDigitCategory)(i))},t.prototype.unionTextBoxes=function(e){if(0!==e.length){var t="",n={height:0,width:0,descent:0,ascent:0},r=[];e.forEach((function(e){t+=e.text,e.glyphBoxes&&r.push.apply(r,(0,s.__spreadArray)([],(0,s.__read)(e.glyphBoxes),!1)),e.glyph&&(n.width+=e.glyph.width,n.height=Math.max(e.glyph.height,n.height),n.descent=e.glyph.descent,n.ascent=e.glyph.ascent)}));var o=M(t||"",{measure:n.width,extent:n.height});o.glyph=n,o.textStyle=this.context.boxEnv.property;var i=new c.ICE(e[0].getRangeBegin(),e[e.length-1].getRangeEnd()-e[0].getRangeBegin());return o.rangeCache=i,o.glyphBoxes=r,o}},t.prototype.changeReplaceTextBoxRange=function(e){if(this.context.node.replacedText&&1===e.length){var t=e[0];return t.rangeCache=this.context.node.getTextRange(),t.isReplaceText=!0,[t]}return e},t.prototype.emit=function(){return this.createTextBox()},t=(0,s.__decorate)([jt({type:l.Rz.Text,kind:l.uO.Text,multiEmission:!0}),(0,s.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==Mt&&Mt)?n:Object])],t)}(Vt),function(e){function t(t){var n=e.call(this,t)||this;return n.env=t.env,n}var n;(0,s.__extends)(t,e),t.prototype.allowEmpty=function(){return!0},t.prototype.emit=function(){var t,n=e.prototype.emit.call(this);if(this.context.env.isPrintLayout&&this.context.env.floatingHostStack.popEmpty("textframe-".concat(this.context.node.getGCPRange().begin())),n)return n.rangeCache=this.context.node.getGCPRange(),this.blockAlignContent(n),(null===(t=n.property)||void 0===t?void 0:t.isFloating)&&this.env.isPrintLayout?(this.env.curFloatingHost.addShape(n,this.context.node),n.containFloating=!0,n.hidden=!0,n):(this.context.env.updateComplexity(p.jd.TextFrame),n)},t.prototype.blockAlignContent=function(e){var t=this.context.container.getContentChildren()[0];if(null==t?void 0:t.logicEdge){var n=t.logicEdge;if(n.margin||(n.margin=p.vk.zero),e.extent>t.contentExtent){var r=n.margin;switch(this.context.boxEnv.drawingProp.drawing.graphic.graphicData.wsp.bodyPr.anchor){case c._d6.ctr:r.before=(e.extent-(t.contentExtent-r.extent))/2;break;case c._d6.b:r.before=e.extent-(t.contentExtent-r.extent)}}}},t.prototype.createEmptyBox=function(){var t=e.prototype.createEmptyBox.call(this);return t.textboxProperty=this.context.boxEnv.textboxProp,t.storyId=this.context.node.storyId,t},Object.defineProperty(t.prototype,"richTextAreaBox",{get:function(){return this.context.container.getContentChildren()[0]},enumerable:!1,configurable:!0}),t.prototype.canPush=function(){return!0},t.prototype.onReuse=function(){this.context.env.isPrintLayout&&this.context.env.floatingHostStack.popEmpty("textframe-".concat(this.context.node.getGCPRange().begin()))},t.prototype.beforeVisit=function(){this.context.env.isPrintLayout&&this.context.env.floatingHostStack.pushEmpty("textframe-".concat(this.context.node.getGCPRange().begin()))},t=(0,s.__decorate)([jt({type:l.Rz.TextFrame,kind:l.uO.TextFrame}),(0,s.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==At&&At)?n:Object])],t)}(Wt),function(e){function t(t){var n=e.call(this,t)||this;return n.context=t,n}var n;(0,s.__extends)(t,e),t.prototype.beforeFlow=function(){var e;this.context.node.hasOffsets||null===(e=this.context.env.reflowState)||void 0===e||e.clearDirtyRange([new c.ICE(this.context.node.getGCPRange().gcpBegin,1)])},t.prototype.emit=function(){var t=e.prototype.emit.call(this);if(t){var n=this.context.node;return this.context.env.state.isBlockBreaked()&&this.blockAlignLastRowUnalignedMergeCells(t),n.isFloating()&&(this.floatingPosition=new Ct(this.context.env,this.context.boxEnv),t.floatingSpace=function(e,t,n){var r,o=t.node.getProperty(),i=o.tblPr.tblpPr,a=p.z6.obtain();a.padding=p.vk.zero,a.padding.start=i.leftFromText,a.padding.end=i.rightFromText,a.padding.before=i.topFromText,a.padding.after=i.bottomFromText;var s=Math.min(e.contentSize.width,e.rectSize.width),c=e.contentSize.height,l=t.env.floatingHostStack.curHost.pageRegion,u=t.boxEnv.isFirstTable?n.resolvePageOffsetY(c):Math.max(l.margins.top,null!==(r=l.headerExtent)&&void 0!==r?r:0),d=n.resolvePageOffsetX(Math.min((null==e?void 0:e.rectSize.width)||0,(null==e?void 0:e.contentSize.width)||0));return{id:o.tblId,isExclude:!0,isFixed:o.isFixed,isOwnLine:!1,offset:{left:d,top:u,right:d+s,bottom:u+c},edge:a,size:{measure:s,extent:c},zIndex:0}}(t,this.context,this.floatingPosition),t.logicEdge&&(t.logicEdge.margin=p.vk.zero),t.containFloating=!0),this.alignTable(t),t.nestingLevel=n.getProperty().nestingLevel,this.context.env.updateComplexity(p.jd.Table),t.nestingLevel>1&&this.context.env.updateComplexity(p.jd.NestingTable),t}},t.prototype.onCommit=function(e){var t;e.hasNextPartial||null===(t=this.context.env.reflowState)||void 0===t||t.clearDirtyRange([new c.ICE(this.context.node.getGCPRange().end()-1,1)]),this.context.env.isPrintLayout&&this.context.env.curFloatingHost.addTableBox(e,this.context.node);var n=this.context.env.curFloatingHost.flushRollback(),r=this.context.env.curFloatingHost.relativeFrom;this.context.parentContext&&n.verticalPos<this.context.parentContext.container.getBlockPos(r)&&this.context.env.state.setRollbackPos({pos:n.verticalPos,relativeFrom:r})},t.prototype.blockAlignLastRowUnalignedMergeCells=function(e){var t=this,n=e.children,r=(0,m.Rz)(n);r.children.forEach((function(e){if(e.mergedType!==l.Wl.Hidden||e.isLastMerged)e.isMergeBegin&&e.totalExtent<r.extent&&(0,b.uu)(e,r.extent-e.extent-e.noPaddingEdgeExtent);else{var o=(0,b.xx)({cell:e,rowIndex:t.context.node.getBeginRowIndex()+n.length-1,colBegin:e.colBegin},n.slice(0,n.length-1),t.context.node.mergedMapping),i=o.cell,a=o.overflow;if(i){var s=r.extent-a-i.noPaddingEdgeExtent;s>=0&&(0,b.uu)(i,s)}}}))},t.prototype.alignTable=function(e){var t,n=this.context.boxEnv.parentContainer.getMaxContentRestMeasure();if((null===(t=e.logicEdge)||void 0===t?void 0:t.margin)&&!e.containFloating&&n){var r=this.context.boxEnv.property.tblPr.jc,o=e.logicEdge.margin;return r===c.y83.center?(o.start=(n-e.measure)/2,void(o.end=(n-e.measure)/2)):r===c.y83.right||r===c.y83.end?(o.start=n-e.measure,void(o.end=0)):void 0}},t.prototype.beforeVisit=function(){if(this.context.env.isPrintLayout&&!this.context.node.hasOffsets&&this.context.node.isFloating()&&!this.context.node.getProperty().isRelativeAlignV){var e=new Ct(this.context.env,this.context.boxEnv),t=this.context.env.curFloatingHost.pageRegion,n=t.margins,r=t.footerExtent;this.context.boxEnv.maxExtent=Math.min(this.context.env.curFloatingHost.pageRegion.extent-Math.max(n.bottom,null!=r?r:0)-e.resolveContainerOffsetY(0),this.context.boxEnv.maxExtent)}},t.prototype.shouldRollbackSelf=function(e){return!(this.isSelfRollbackExceedsLimit(e)||!this.context.env.isPrintLayout||e.containFloating||!e.hasNextPartial||!this.containsOverflowCell(e)||(this.context.rollbackContext={maxExtent:e.extent},0))},t.prototype.containsOverflowCell=function(e){var t,n,r,o,i,a,c,u;if(this.context.env.isPrintLayout&&e.hasNextPartial&&!e.containFloating){var d=e.extent,p=0;try{for(var h=(0,s.__values)(e.children),f=h.next();!f.done;f=h.next()){var g=f.value;try{for(var v=(r=void 0,(0,s.__values)(g.children)),y=v.next();!y.done;y=v.next()){var m=y.value;if((m.isMergeBegin||m.mergedType===l.Wl.Secondary)&&p+m.totalExtent-(null!==(u=null===(c=null===(a=null===(i=m.logicEdge)||void 0===i?void 0:i.border)||void 0===a?void 0:a.width)||void 0===c?void 0:c.after)&&void 0!==u?u:0)>d)return!0}}catch(e){r={error:e}}finally{try{y&&!y.done&&(o=v.return)&&o.call(v)}finally{if(r)throw r.error}}p+=g.totalExtent}}catch(e){t={error:e}}finally{try{f&&!f.done&&(n=h.return)&&n.call(h)}finally{if(t)throw t.error}}}return!1},t.prototype.rollbackSelf=function(){var t,n;e.prototype.rollbackSelf.call(this),this.context.env.state.clearBlockBreak(),this.context.boxEnv.maxExtent=null!==(n=null===(t=this.context.rollbackContext)||void 0===t?void 0:t.maxExtent)&&void 0!==n?n:0},t.prototype.onReuse=function(e){this.context.env.isPrintLayout&&this.context.env.curFloatingHost.addTableBox(e,this.context.node)},t.prototype.shouldVisit=function(){return!(this.context.boxEnv.maxExtent&&this.context.boxEnv.maxExtent<=0)},t=(0,s.__decorate)([jt({type:l.Rz.Table,kind:l.uO.Table}),(0,s.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==Nt&&Nt)?n:Object])],t)}(Wt),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.emit=function(){if(!this.context.env.state.isBlockBreaked()){var t=e.prototype.emit.call(this);if(t)return this.isRowCrossPage(t)&&this.context.env.state.setBlockBreak(),this.isRowEmpty(t)?void this.context.env.state.setBlockBreak():(this.blockAlignCells(t),t);this.context.env.isPrintLayout&&this.context.env.state.setBlockBreak()}},t.prototype.isRowEmpty=function(e){return 0===e.children.length||e.children.every((function(e){return 0===e.children.length}))&&!this.context.container.isAllMerged()},t.prototype.isRowCrossPage=function(e){return e.children.some((function(e){return e.breakpointCPs&&!e.isMergeBegin}))},t.prototype.onCommit=function(e){var t;if(!this.isRowCrossPage(e)){var n=this.context.node.getGCPRange().end();null===(t=this.context.env.reflowState)||void 0===t||t.clearDirtyRange([new c.ICE(n-1,1)])}},t.prototype.blockAlignCells=function(e){e.children.forEach((function(t){if(!t.isMergeBegin&&void 0===t.mergedType){var n=e.extent-t.extent-t.noPaddingEdgeExtent;(0,b.uu)(t,n)}}));var t=this.context.container;t.getLastMergedCells().forEach((function(n){var r=t.getVisibleCellAndOverflowExtent(n),o=r.cell,i=r.overflow;if(o){var a=e.extent-i-o.noPaddingEdgeExtent;(0,b.uu)(o,a)}}))},t.prototype.shouldVisit=function(){var e=this.context.boxEnv;return e.maxExtent>=e.minExtent},t=(0,s.__decorate)([jt({type:l.Rz.TableRow,kind:l.uO.TableRow})],t)}(Wt),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.isBlockBreaked=function(){return this.context.env.isPrintLayout&&this.context.env.state.isBlockBreaked()},t.prototype.allowEmpty=function(){return this.context.node.isEmptyPlaceholder()||this.context.node.isMergedPlaceholder()},t.prototype.emit=function(){var t=e.prototype.emit.call(this);if(t){if(void 0!==t.mergedType){var n=this.context.node.getGCPRange();this.context.env.beginGCPManager.insertGCP(t,n.gcpBegin)}return this.isBlockBreaked()&&this.context.env.state.clearBlockBreak(),t.setExtent(Math.max(this.context.env.curFloatingHost.constraintSpace.minBottom,t.extent)),this.context.env.isPrintLayout&&this.context.env.floatingHostStack.popToAttach("tableCell-".concat(this.context.node.getGCPRange().begin()),t.children[0],t),t}this.context.env.isPrintLayout&&(this.context.env.floatingHostStack.popEmpty("tableCell-".concat(this.context.node.getGCPRange().begin())),this.context.env.state.setBlockBreak())},t.prototype.mergeBreakpoints=function(t){var n=e.prototype.mergeBreakpoints.call(this,t);if(n)return n;if(this.isBlockBreaked()){var r=t.children[0].getRangeEnd();if(r<this.context.node.getContentRange().end())return[r-1]}},t.prototype.onCommit=function(e){var t=this.context.env.reflowState;if(t)return void 0!==e.mergedType?(t.clearDirtyRange([this.context.node.getGCPRange()]),void(e.mergedType!==l.Wl.Secondary||e.breakpointCPs||t.clearDirtyRange([new c.ICE(this.context.node.getContentRange().end(),1)]))):void(e.breakpointCPs||t.clearDirtyRange([new c.ICE(this.context.node.getGCPRange().end()-1,1)]))},t.prototype.onReuse=function(){this.context.env.isPrintLayout&&this.context.env.floatingHostStack.popEmpty("tableCell-".concat(this.context.node.getGCPRange().begin()))},t.prototype.beforeVisit=function(){if(this.context.env.isPrintLayout){var e=this.getCellMargin();this.context.env.floatingHostStack.pushHost({extent:0,measure:this.context.node.width,margins:e},"tableCell-".concat(this.context.node.getGCPRange().begin())),this.context.env.curFloatingHost.relativeFrom=Pe.RichTextArea}},t.prototype.getCellMargin=function(){var e=this.context.node.getProperty();if(!e)return{top:0,left:0,bottom:0,right:0};var t=e.tcMar;return{top:0,left:t.left.w,bottom:0,right:t.right.w}},t=(0,s.__decorate)([jt({type:l.Rz.TableCell,kind:l.uO.TableCell})],t)}(Wt),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.createBox=function(){var e=this.context.boxEnv,t=p.wY.obtain();t.extent=e.fixedExtent,t.measure=e.fixedMeasure;var n=new J(t);return t.recycle(),n.logicEdge=e.edge,n.property=e.property,n.rawRunProperty=e.node.getRawRunProperty()||new(c.kkf.getPropertyClass(c.uSS.RunProperty)),n.rangeCache=this.context.node.getGCPRange().clone(),e.isFloating&&(this.context.env.isPrintLayout&&(this.context.env.curFloatingHost.addShape(n,this.context.node),n.hidden=!0),n.containFloating=!0),n},t.prototype.emit=function(){return this.createBox()},t=(0,s.__decorate)([jt({type:l.Rz.Image,kind:l.uO.Image})],t)}(Vt),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.createBox=function(){var e=this.context.boxEnv,t=new(this.getBoxConstructor())({extent:e.fixedExtent,measure:e.fixedMeasure});return t.logicEdge=e.edge,t.initFromNode(this.context.node),t.rangeCache=this.context.node.getGCPRange().clone(),t},t.prototype.getBoxConstructor=function(){var e=this.context.env.extensionManager.get(l.dZ.LeafContainer,this.context.node.uniqueTypeId);return e?e.Box:ee},t.prototype.emit=function(){return this.createBox()},t=(0,s.__decorate)([jt({type:l.Rz.LeafContainer,kind:l.uO.LeafContainer})],t)}(Vt),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.createBox=function(){var e=this.context.boxEnv,t=new $({extent:e.fixedExtent,measure:e.fixedMeasure});return t.logicEdge=e.edge,t.initFromNode(this.context.node),t.rangeCache=this.context.node.getGCPRange().clone(),t.fieldInfo=this.context.node.fieldInfo,t},t.prototype.emit=function(){return this.createBox()},t=(0,s.__decorate)([jt({type:l.Rz.FieldContainer,kind:l.uO.FieldContainer})],t)}(Vt),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.createBox=function(){var e=this.context,t=e.boxEnv,n=e.node,r=new ne({extent:t.fixedExtent,measure:t.fixedMeasure});return r.logicEdge=t.edge,r.property=n.getProperty(),r.rawRunProperty=t.node.getRawRunProperty()||new(c.kkf.getPropertyClass(c.uSS.RunProperty)),r.rangeCache=n.getGCPRange().clone(),r},t.prototype.emit=function(){return this.createBox()},t=(0,s.__decorate)([jt({type:l.Rz.EmbeddedObject,kind:l.uO.EmbeddedObject})],t)}(Vt),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.allowEmpty=function(){return!0},t=(0,s.__decorate)([jt({type:l.Rz.Endnote,kind:l.uO.Endnote})],t)}(Wt),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.emit=function(){this.context.boxEnv.columnCount>1&&this.context.env.updateComplexity(p.jd.Columns);var t=this.context.rollbackContext;return(null==t?void 0:t.state)===Dt.PreferLast?t.last:e.prototype.emit.call(this)},t.prototype.mergeBreakpoints=function(e){var t;return null===(t=e.lastChild)||void 0===t?void 0:t.breakpointCPs},t.prototype.shouldRollbackSelf=function(e){var t,n,r,o=this.context.boxEnv.isBalanced();if(this.isSelfRollbackExceedsLimit(e,!o))return o&&b.No.warn(b.Qq.CannotBalancedColumns,e.getRange(!0).toString()),!1;if(this.context.env.state.isBlockBreaked())return!1;if(this.context.boxEnv.columnCount>1&&!e.breakpointCPs&&o){var i=this.checkBalance(e);return this.context.rollbackContext={counter:(null!==(n=null===(t=this.context.rollbackContext)||void 0===t?void 0:t.counter)&&void 0!==n?n:0)+1,last:i===Dt.PreferLast?this.context.rollbackContext.last:e,state:i},i!==Dt.Perfect||(u.Logger.info("[Layout] Balanced Column, rollback count = ".concat(null!==(r=this.context.rollbackContext.counter)&&void 0!==r?r:0)),!1)}return!1},t.prototype.rollbackSelf=function(){e.prototype.rollbackSelf.call(this);var t=this.context.rollbackContext;if(t){var n=t.state;n===Dt.Not?this.balanceNext():n===Dt.Inperfect&&this.perfectBalanceNext()}},t.prototype.checkBalance=function(e){var t=e.children;if(1===t.length)return Dt.Not;var n=t[0].totalExtent;if(t.some((function(e){return e.extent!==n}))){if(this.context.rollbackContext){var r=this.context.rollbackContext.last,o=Math.max.apply(Math,(0,s.__spreadArray)([],(0,s.__read)(t.map((function(e){return e.extent}))),!1)),i=Math.max.apply(Math,(0,s.__spreadArray)([],(0,s.__read)(r.children.map((function(e){return e.extent}))),!1));if(o>i)return Dt.PreferLast;if(o===i)return(0,m.Rz)(t).extent<=(0,m.Rz)(r.children).extent?this.context.boxEnv.childSizings[0].maxExtent===o?Dt.Perfect:Dt.Inperfect:Dt.PreferLast}return Dt.Not}return Dt.Perfect},t.prototype.balanceNext=function(){var e=this.context.rollbackContext;if(e){var t=e.last,n=this.context.boxEnv;if(1===e.counter){var r=(0,m.Sm)(t.children.map((function(e){return function(e){return e.extent*e.measure}(e)})))/(0,m.Sm)(n.columns.map((function(e){return e.measure})));this.setChildSizings(n,r)}else{var o=t.children[0],i=(0,m.Rz)(t.children);o.extent>i.extent?this.setChildSizings(n,n.childSizings[0].maxExtent-function(e){for(var t=e;!(0,l.o7)(t);){var n=t.lastChild;if(!(n instanceof _)){u.Logger.error("[Layout] Cannot find Line inside target, please use a ancestor box that contains line as descendants.");break}t=n}return t}(o).totalExtent):o.extent<i.extent&&this.setChildSizings(n,n.childSizings[0].maxExtent+function(e){for(var t=e;!(0,l.o7)(t);){var n=t.firstChild;if(!(n instanceof _)){u.Logger.error("[Layout] Cannot find Line inside target, please use a ancestor box that contains line as descendants.");break}t=n}return t}(i).totalExtent)}}},t.prototype.perfectBalanceNext=function(){var e=this.context.rollbackContext;if(e){var t=Math.max.apply(Math,(0,s.__spreadArray)([],(0,s.__read)(e.last.children.map((function(e){return e.extent}))),!1));this.setChildSizings(this.context.boxEnv,t)}},t.prototype.setChildSizings=function(e,t){for(var n=e.childSizings,r=0;r<n.length-1;++r)n[r].maxExtent=t},t=(0,s.__decorate)([jt({type:l.Rz.Columns,kind:l.uO.Columns})],t)}(Wt);var zt=function(){function e(){}return e.create=function(e,t,n){var r=function(e){var t;return null===(t=Ht[e])||void 0===t?void 0:t.ctor}(t.type);if(r){var o=Ft.create(e,t,n);if(o)return new r(o)}return function(e){return{canPush:function(){return!0},push:function(){},emit:function(){return u.Logger.error("[Layout] Generator not implement for",l.Rz[e.type]),[new q]}}}(t)},e}();function Kt(e){return!!e.shouldVisit}!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,s.__extends)(t,e),t.prototype.canPush=function(e){return!0},t.prototype.allowEmpty=function(){return!0},t.prototype.emit=function(){var t,n,r=null!==(t=e.prototype.createBox.call(this))&&void 0!==t?t:e.prototype.createEmptyBox.call(this),o=this.context.node.fieldProps,i=null!==(n=null==o?void 0:o.displayLayoutType)&&void 0!==n?n:c.dLA.Text,a=[c.dLA.Card,c.dLA.Preview].includes(i);r.wholeLine=a,r.logicEdge=this.context.boxEnv.edge,r.fieldInfo=this.context.node.fieldProps;var s=this.calculateBaseline(r,a),l=s.ascent,u=s.descent;return r.setBaseline(l,u),r.fieldContext=this.context.node.fieldContext,r.fieldInfo&&(r.subType=r.fieldInfo.fieldCode.name),r.rangeCache=this.context.node.getGCPRange(),this.handleEllipsisEnd(r),this.context.env.updateComplexity(p.jd.Field),r},t.prototype.getPageNode=function(){for(var e=this.context.node.parent;e&&!(e instanceof z.u$);)e=e.parent;return e},t.prototype.createFieldContext=function(){var e=this,t=this.getPageNode(),n=this.context.node.fieldProps;if(!t||!n)return{};var r={};return[c.E2N.PAGE_NUM,c.E2N.PAGE_COUNT,c.E2N.PAGE_NUM_FORMAT].forEach((function(n){var o;switch(n){case c.E2N.PAGE_NUM:r.pageNum=t.pageNumber;break;case c.E2N.PAGE_COUNT:r.pageCount=e.context.env.globalPageNum,e.context.env.hasNumPagesField=!0;break;case c.E2N.PAGE_NUM_FORMAT:r.pageNumFormat=null===(o=e.context.boxEnv.sectionProperty)||void 0===o?void 0:o.pgNumType.fmt}})),r},t.prototype.calculateBaseline=function(e,t,n){var r={ascent:0,descent:0};return t?{ascent:e.totalExtent,descent:0}:(e.children.forEach((function(e){r.ascent=Math.max(r.ascent,e.ascent),r.descent=Math.max(r.descent,e.descent)})),r)},t.prototype.handleEllipsisEnd=function(e){var t=e.children[0],n=this.context.boxEnv.maxMeasure;if(n&&t instanceof x&&t.glyphBoxes&&!(n>=t.measure)){var r=0,o="",i=new Se(new L.UnicodeString("...").toSlice(),0,t.textStyle),a=n-i.glyph.width;t.glyphBoxes.some((function(e){if(r+e.glyph.width>a){var t=e.splitBySize(a-r);return o+="".concat(t.text,"..."),r+=t.glyph.width+i.glyph.width,!0}return r+=e.glyph.width,o+=e.text,!1})),t.text=o,e.setMeasure(r)}},t.prototype.beforeVisit=function(){this.context.node.fieldContext=this.createFieldContext()},t=(0,s.__decorate)([jt({type:l.Rz.FieldCode,kind:l.uO.Field})],t)}(Wt);var qt=n(31518),Yt=function(){function e(e,t,n){this.oldDoc=e,this.mainStoryEnd=t,this.reflowState=n,this.currentLevel=0,this.visitLeveL=-1,this.disabled=!1,this.pointer=e}var t;return e.prototype.getCandidate=function(e){if(!this.disabled){if(this.exitInnerLevel(),this.isHeaderFooter(e))return this.getHeaderFooterCandidate(e);if(this.isSubStoryDescendant(e))return this.isHeaderFooterDescendant(e)?this.getHeaderFooterDescendantCandidate(e):this.getSubStoryDescendantCandidate(e);for(var t=e.getGCPRange().begin()+e.beginOffset;[p.Xq.EndBefore,p.Xq.EndAt].includes(this.pointer.compareRangeTo(t));){var n=this.getNextSibling(this.pointer);if(!n)return;this.pointer=n}return this.enterInnerLevel(t),!this.pointer.nonReusable&&this.isTypeMatch(e)&&this.isRangeMatch(e,t)?this.pointer:void 0}},e.prototype.isTypeMatch=function(e){var t;return this.currentLevel===this.visitLeveL&&(null===(t=Gt(e.type))||void 0===t?void 0:t.kind)===(0,l.$o)(this.pointer)},e.prototype.isRangeMatch=function(e,t){if(this.pointer.getRangeBegin()===t){if(e.getGCPRange().end()-t<=0){var n=this.pointer.getRange(!0);return!n.isValid()||0===n.len}if(this.pointer instanceof _&&this.pointer.isDiscrete()){var r=this.pointer.getRanges(!0),o=e.getOffsets();if(!(r.length>=o.length))return!1;for(var i=1;i<o.length;++i){var a=e.getGCPRange().gcpBegin+o[i];if(r[i].gcpBegin!==a)return!1}}return!0}return!1},e.prototype.isHeaderFooter=function(e){return e.type===l.Rz.HeaderFooter},e.prototype.getHeaderFooterCandidate=function(e){var t=this.oldDoc.children[e.parent.pageIndex];return e.isHeader?null==t?void 0:t.header:null==t?void 0:t.footer},e.prototype.isHeaderFooterDescendant=function(e){return e.getSubstoryRootNode().type===l.Rz.HeaderFooter},e.prototype.getHeaderFooterDescendantCandidate=function(e){var t=e.getSubstoryRootNode(),n=this.getHeaderFooterCandidate(t);if(n)return this.findCandidateInChildren(n,e)},e.prototype.findCandidateInChildren=function(e,t){var n,r,o,i=t.getGCPRange().begin()+t.beginOffset;try{for(var a=(0,s.__values)(e.children),c=a.next();!c.done;c=a.next()){var u=c.value;if(u.getRangeBegin()===i&&(null===(o=Gt(t.type))||void 0===o?void 0:o.kind)===(0,l.$o)(u))return u;if(u instanceof _&&u.containsRangeOrCP(i))return this.findCandidateInChildren(u,t)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}},e.prototype.isSubStoryDescendant=function(e){return!!e.getSubstoryRootNode()},e.prototype.getSubStoryDescendantCandidate=function(e){var t=e.getSubstoryRootNode().getGCPRange().begin();if(this.pointer.getRangeBegin()===t&&(0,l.Wf)(this.pointer)&&this.pointer instanceof _)return this.findCandidateInChildren(this.pointer,e)},e.prototype.exitInnerLevel=function(){for(;this.currentLevel>this.visitLeveL;)this.exitOneLevel()},e.prototype.exitOneLevel=function(){this.pointer.parentBox?(this.pointer=this.pointer.parentBox,this.currentLevel-=1):(this.pointer=this.oldDoc,this.currentLevel=0)},e.prototype.getNextSibling=function(e){var t;if(e.nextSibling)return e.nextSibling;if(!(e.getRangeEnd()>=this.mainStoryEnd)&&e.isPageLast){var n=e.getAncestorOf(l.uO.Page);if(null==n?void 0:n.nextSibling){var r=(0,l.$o)(e);return null===(t=n.nextSibling)||void 0===t?void 0:t.getFirstDescendantOf(r,(function(e){return e.firstVisibleChild}))}}},e.prototype.enterInnerLevel=function(e,t){var n,r;if(void 0===t&&(t=this.pointer),this.currentLevel<this.visitLeveL&&(0,l.Eb)(t)){var o=(0,l.n6)(t)?[t.body]:t.children;try{for(var i=(0,s.__values)(o),a=i.next();!a.done;a=i.next()){var c=a.value;if(c.parentBox===t&&c.compareRangeTo(e)===p.Xq.Contains)return this.currentLevel+=1,this.pointer=c,void this.enterInnerLevel(e,c)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}},e.prototype.onVisitBegin=function(e){e.getGCPRange().begin()<this.mainStoryEnd&&(this.visitLeveL+=1)},e.prototype.onVisitEnd=function(e){e.getGCPRange().begin()<this.mainStoryEnd&&(this.visitLeveL-=1)},e.prototype.onReuse=function(e){e===this.pointer&&this.exitOneLevel()},(0,s.__decorate)([(0,m.BK)(),(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==z.rn&&z.rn)?t:Object]),(0,s.__metadata)("design:returntype",void 0)],e.prototype,"getCandidate",null),e}();function Qt(e,t,n){if(e>b.T4.SLOW_PAGE_LAYOUT){var r=t.children.filter((function(e){return!n.env.isBoxReused(e)})).length;e/r>b.T4.SLOW_PAGE_LAYOUT&&u.Logger.warn("[Layout] layout cost over ".concat(b.T4.SLOW_PAGE_LAYOUT,"ms per page, cost ").concat(e,"ms for ").concat(r," pages"))}}var Zt=function(){function e(e,t){this.env=e,this.breaker=t,this.breaked=!1}var t,n,r,o,i,u;return e.prototype.run=function(e,t){var n,r;this.breaked=!1;var o=null!==(r=null===(n=this.env.getContentRange())||void 0===n?void 0:n.end())&&void 0!==r?r:-1;o||b.No.warn(b.Qq.ReadPropertyOfUndefined,"get contentRange of getMainStoryInfo"),this.finder=t?new Yt(t,o,this.env.reflowState):void 0;var i=(0,s.__read)(this.visit(e).emission,1)[0];return null==t||t.recycle(this.env),i},e.prototype.visit=function(e,t){var n,r,o,i;void 0===t&&(t={}),null===(n=this.finder)||void 0===n||n.onVisitBegin(e);var a=null!==(r=t.rollbackGenerator)&&void 0!==r?r:zt.create(this.env,e,t.parentContext);if(!Kt(a)){var s=this.visitLeaf(e,a,t);if(null===(o=this.finder)||void 0===o||o.onVisitEnd(e),s){var c={emission:Array.isArray(s)?s:[s]};return this.forceCorrectAbnormalResult(c),c}return{emission:[]}}var l=this.visitParent(e,a,t);return this.forceCorrectAbnormalResult(l),null===(i=this.finder)||void 0===i||i.onVisitEnd(e),l},e.prototype.forceCorrectAbnormalResult=function(e){var t=this;e.emission.forEach((function(e){var n,r,o=e.totalExtent;if(o<0||!Number.isFinite(o)||Number.isNaN(o)){var i=e.extent,a=null!==(r=null===(n=e.logicEdge)||void 0===n?void 0:n.extent)&&void 0!==r?r:0;if(b.No.error({error:b.oY.AbnormalExtent,boxKind:(0,l.$o)(e),rangeOrRanges:e instanceof _?e.getRanges():e.getRange(),extraContext:"extent: ".concat(String(i),", edge: ").concat(String(a))},t.env),e.extent<0||Number.isNaN(e.extent))e.setExtent(0);else if(!Number.isFinite(i)){var s=e instanceof _?e.contentExtent:Number.NaN;!Number.isNaN(s)&&Number.isFinite(s)?e.setExtent(s):e.setExtent(c.keb.section.pageSize.height)}(a<0||Number.isNaN(a)||!Number.isFinite(a))&&(e.logicEdge=p.z6.obtain())}}))},e.prototype.visitLeaf=function(e,t,n){var r,o;if(!(null===(r=Gt(e.type))||void 0===r?void 0:r.multiEmission)){var i=null===(o=this.finder)||void 0===o?void 0:o.getCandidate(e),a=this.tryReuse(e,t,i);if(null==a?void 0:a.emission)return a.emission}return t.emit()},e.prototype.visitParent=function(e,t,n){var r,o=null===(r=this.finder)||void 0===r?void 0:r.getCandidate(e),i=this.tryReuse(e,t,o);if(null==i?void 0:i.emission){var a={emission:[i.emission],reusability:i.reusability};return this.updateReflowStateOnReuse(a),a}if((null==i?void 0:i.reusability)===vt.NoForAll&&(this.finder.disabled=!0),t.beforeFlow(),this.visitChildren(e,t))return this.restoreReuse(i),{emission:[]};var s=t.emit();if(s){if(t.shouldRollbackSelf(s))return t.rollbackSelf(),this.restoreReuse(i),this.visit(e,{parentContext:n.parentContext,rollbackGenerator:t});t.onCommit(s),this.markVirtualEnds(e,s),o&&this.updateReflowStateOnFlow(t.context,s,o)}return this.restoreReuse(i),{emission:s?[s]:[]}},e.prototype.restoreReuse=function(e){(null==e?void 0:e.reusability)===vt.NoForAll&&(this.finder.disabled=!1)},e.prototype.visitChildren=function(e,t){var n;if(t.shouldVisit()){t.beforeVisit();for(var r=[],o=[],i=e.getBeginChild();i&&!t.shouldBreak();){if(this.shouldBreakOnError(e))return!1;r.push(i),this.saveReflowState(i,o);var a=this.visit(i,{parentContext:t.context}),s=a.emission;if(a.reusability===vt.CurrentToEnd){this.directlyReuseRest(t,s[0]);break}if(this.env.state.hasRollbackPos()){var c=this.env.state.getRollbackPos();if(t.shouldRollbackAll(c))return!0;i=this.rollbackChild(t,r,i),this.restoreReflowState(r,o)}else{if(this.pushChildren(s,t),t.shouldBreak()){this.revertReflowStateAfterOverflow(i,s,t,o);break}if(!this.breaked&&s.length>0&&(this.breaked=!!(null===(n=this.breaker)||void 0===n?void 0:n.call(this,s[0]))),this.breaked)break;i=i.getNextSibling()}}null===i&&(e.isReachEnd=!0)}return!1},e.prototype.shouldBreakOnError=function(e){return!!this.env.fatalBreak||void 0!==this.env.errorRecoveryNodeType&&this.env.errorRecoveryNodeType!==e.type},e.prototype.revertReflowStateAfterOverflow=function(e,t,n,r){e.isParent&&this.env.reflowState&&(n.context.container.getContentChildren().includes(t[0])||this.env.reflowState.restore((0,m.Rz)(r)))},e.prototype.directlyReuseRest=function(e,t){for(var n=t;n;)n.onReuse(this.env),this.pushChildren([n],e),n=n.nextSibling},e.prototype.saveReflowState=function(e,t){var n;t.push(e.isParent?null===(n=this.env.reflowState)||void 0===n?void 0:n.backup():void 0)},e.prototype.restoreReflowState=function(e,t){var n;if(e.length<t.length){var r=t[e.length];t.splice(e.length),void 0!==r&&(null===(n=this.env.reflowState)||void 0===n||n.restore(r))}},e.prototype.tryReuse=function(e,t,n){var r;if(n){var o=t.context.canReuse(n);return o!==vt.No&&o!==vt.NoForAll?(null===(r=this.finder)||void 0===r||r.onReuse(n),n.onReuse(this.env),t.onReuse(n),e.isVirtual&&this.markVirtualEnds(e,n),{emission:n,reusability:o}):{reusability:o}}},e.prototype.rollbackChild=function(e,t,n){e.rollbackTo(this.env.state.getRollbackPos());var r=e.context.container.getContentChildren().length,o=void 0;return t.length>r&&(o=(0,s.__read)(t.splice(r),1)[0]),this.env.state.clearRollbackPos(),this.env.state.clearPageBreak(),this.env.state.clearBlockBreak(),null!=o?o:n},e.prototype.markVirtualEnds=function(e,t){var n,r;if(e.isVirtual&&t){var o=t.getRangeEnd(),i=null!==(r=null===(n=t.breakpointCPs)||void 0===n?void 0:n.map((function(e){return e+1})))&&void 0!==r?r:[o];i.includes(o)||i.push(o),e.virtualEnds=i.sort((function(e,t){return e-t}))}},e.prototype.pushChildren=function(e,t){var n,r;try{for(var o=(0,s.__values)(e),i=o.next();!i.done;i=o.next()){var a=i.value;if(t.push(a),t.shouldBreak())return}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},e.prototype.updateReflowStateOnReuse=function(e){e.reusability===vt.CurrentToEnd&&(0,l.n6)(e.emission[0])&&this.env.reflowState.markReflowEnd()},e.prototype.updateReflowStateOnFlow=function(e,t,n){var r,o,i,a,s=this.env.reflowState;if((0,l.o7)(t)&&s.shouldForceLineReflow(n)){if(s.updateLineReflowEnd(n.getRangeEnd()),n.isAffectedByFloating())return;n.getRange(!0).equal(t.getRange(!0))&&(null===(r=n.layoutCursor)||void 0===r?void 0:r.blockPos)===(null===(a=null===(i=null===(o=e.parentContext)||void 0===o?void 0:o.container)||void 0===i?void 0:i.content)||void 0===a?void 0:a.blockPos)&&s.endForceLineReflow(n)}},(0,s.__decorate)([function(e,t,n){var r=n.value;n.value=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=performance.now(),o=r.call.apply(r,(0,s.__spreadArray)([this],(0,s.__read)(e),!1)),i=performance.now()-n;return Qt(i,o,this),o}},(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==z.jv&&z.jv)?t:Object,"function"==typeof(n=void 0!==B&&B)?n:Object]),(0,s.__metadata)("design:returntype",void 0)],e.prototype,"run",null),(0,s.__decorate)([(0,m.BK)({extractKeyFromArgs:function(e){return l.Rz[e.type]}}),(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",["function"==typeof(r=void 0!==z.rn&&z.rn)?r:Object,Object]),(0,s.__metadata)("design:returntype",Object)],e.prototype,"visit",null),(0,s.__decorate)([(0,m.BK)(),(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",["function"==typeof(o=void 0!==z.rn&&z.rn)?o:Object,"function"==typeof(i=void 0!==a.IFlowGenerator&&a.IFlowGenerator)?i:Object,"function"==typeof(u=void 0!==f&&f)?u:Object]),(0,s.__metadata)("design:returntype",Object)],e.prototype,"tryReuse",null),e}(),Xt=function(){function e(e,t){var n=this;this.flowCosts=[],this.isFirstPageLayout=!0,this.isFullLayout=!0,this.unclearCounter={count:0},this.env=new dt(e,t),this.docBox=new B,e.on(qt.at.ModelChange,(function(e){n.layout({isReflow:!0,reflowDirtyRangeMap:e.changeData.dirtyRangeMap})})),e.on(l.Rr.ForceReflow,(function(e){n.layout({isReflow:!0,reflowDirtyRangeMap:e.allDirty})}))}return e.prototype.extend=function(e,t){this.env.extensionManager.add(e,t),e===l.dZ.LeafContainer&&z.fl.leafModelManager.addLeafModel(t.nodeCreator)},e.prototype.layout=function(e){void 0===e&&(e={}),this.flowCosts=[],this.unclearCounter={count:0},this.env.fullReset(),e.isReflow&&!this.docBox.isEmpty()?this.env.initReflowState(e.reflowDirtyRangeMap):(this.docBox.recycle(this.env),this.docBox=new B,this.isFullLayout=!0),e.synced||e.onlyFirstPage?(this.flow(!!e.onlyFirstPage),this.onFlowFinish(this.getFinishGCP())):this.scheduleFlow()},e.prototype.scheduleFlow=function(){var e=this;m.Oh.getInstance().scheduleQueue((function(){if(e.env.fatalBreak)return e.onLayoutFinished(),e.reportOnFlowFinish(),!0;var t=e.getFinishGCP();if(!e.docBox.isEmpty()&&e.docBox.compareRangeTo(t)===p.Xq.EndBefore){var n=e.getNextLayoutRanges(t);if(e.detectInfiniteLayout(n))return e.onLayoutFinished(),e.reportOnFlowFinish(),!0;e.env.reset(),e.env.initReflowState(new Map([[c.Eos.MainDocId,new qt.I3(n)]]),Me.Schedule)}return e.flow(!0),e.onFlowFinish(t)}),{id:"".concat(this.env.context.uuid,"-LAYOUT"),immediately:!0})},e.prototype.detectInfiniteLayout=function(e){var t,n=this;if(e.length>0)if(this.unclearCounter.ranges&&(0,m.qP)(this.unclearCounter.ranges,e,(function(e,t){return e.equal(t)}))){if(this.unclearCounter.count+=1,this.unclearCounter.count>b.T4.UNCLEAR_RELAYOUT)return null===(t=this.env.reflowState)||void 0===t||t.clearDirtyRange(e),b.No.error({error:b.oY.UnclearableDirty,rangeOrRanges:e,extraContext:e.map((function(e){return n.env.dataEngine.getDataStream().getTextStream().readText(e.gcpBegin,e.len)})).join("\n")},this.env),!0}else this.unclearCounter={ranges:e,count:1};return!1},e.prototype.onFlowFinish=function(e){var t=this.docBox.compareRangeTo(e)!==p.Xq.EndBefore;return t&&(this.env.context.fire(new l.$K(l.Xj.Full)),this.env.dataEngine.getIsChunkLoading()||(this.onLayoutFinished(),this.reportOnFlowFinish())),t},e.prototype.reportOnFlowFinish=function(){var e;if(this.isFullLayout){var t=this.docBox.children.length;t>0&&(0,b.H6)(b.bJ.averagePageCost,{cost:(0,m.Sm)(this.flowCosts)/t,pageCount:t,rangeLen:this.docBox.getRange().len,layoutType:this.env.docEnv.layoutType,complexity:this.env.getComplexity()}),this.isFullLayout=!1,(0,b.mz)({success:!this.env.containsError,layoutType:this.env.docEnv.layoutType,complexity:this.env.getComplexity(),errorAbstract:this.env.errorAbstract,errorSummary:this.env.errorSummary,containsDataError:this.env.containsDataError})}else if((null===(e=this.env.reflowState)||void 0===e?void 0:e.trigger)===Me.Edit){var n=(0,m.Sm)(this.flowCosts);n>b.T4.EDIT_LAG&&(0,b.H6)(b.bJ.editCost,{cost:n,rangeLen:this.env.reflowState.dirtyRangeLen,layoutType:this.env.docEnv.layoutType,complexity:this.env.getComplexity()})}},e.prototype.getNextLayoutRanges=function(e){for(var t=this.docBox.getRanges(!0),n=[],r=0;r<t.length-1;++r){var o=t[r].end(),i=t[r+1].gcpBegin;n.push(new c.ICE(o,i-o))}var a=(0,m.Rz)(t).end();return n.push(new c.ICE(a,e-a)),n},e.prototype.getFinishGCP=function(){var e;if(this.env.dataEngine.getIsChunkLoading())return this.env.dataEngine.getGCPChunkEnd();var t=null===(e=this.env.dataEngine.getDataStream().getStoryStream().getMainStoryInfo())||void 0===e?void 0:e.contentRange.end();return t?t-1:(b.No.warn(b.Qq.ReadPropertyOfUndefined,"get contentRange of getMainStoryInfo"),-1)},e.prototype.flow=function(e){var t=performance.now();this.docLayoutType=this.env.docEnv.layoutType;var n=new Zt(this.env,e?this.createBreaker():void 0),r=this.createNode(),o=this.env.isReflow&&!this.docBox.isEmpty()?this.docBox:void 0;this.docBox=n.run(r,o);var i=performance.now()-t;this.flowCosts.push(i),this.reportAfterEachFlow(),this.onLayoutChanged()},e.prototype.reportAfterEachFlow=function(){this.isFirstPageLayout&&((0,b.H6)(b.bJ.firstPageCost,{cost:this.flowCosts[0],rangeLen:this.docBox.children[0].getRange().len,layoutType:this.env.docEnv.layoutType,complexity:this.env.getComplexity()}),(0,b.mz)({isFirstPage:!0,success:!this.env.containsError,layoutType:this.env.docEnv.layoutType,complexity:this.env.getComplexity(),errorAbstract:this.env.errorAbstract,errorSummary:this.env.errorSummary,containsDataError:this.env.containsDataError}),this.isFirstPageLayout=!1)},e.prototype.createBreaker=function(){var e=this;return function(t){var n,r;return!(!(0,l.n6)(t)||e.env.isBoxReused(t))&&t.getRangeBegin()===(null!==(r=null===(n=e.docBox.getRanges()[0])||void 0===n?void 0:n.end())&&void 0!==r?r:0)}},e.prototype.createNode=function(){var e=this.env.createModelWrapperContext();return(0,z.Kb)(e)},e.prototype.onLayoutChanged=function(){var e,t;null===(e=this.onLayoutCallback)||void 0===e||e.call(this);var n=this.docBox.getRangeEnd()-1;this.env.context.fire(new l.$z(l.Xj.Full,this.env.isReflow,n)),null===(t=this.env.reflowState)||void 0===t||t.verify(this.docBox)},e.prototype.onLayoutChange=function(e){this.onLayoutCallback=e},e.prototype.onLayoutFinish=function(e){this.onLayoutFinishCallback=e},e.prototype.getLayoutState=function(){return{pageCount:this.env.isPrintLayout?this.docBox.children.length:1,isFinished:this.env.isFinished,isReflowing:!1}},e.prototype.getLayoutBox=function(){return this.docBox},Object.defineProperty(e.prototype,"layoutFinished",{get:function(){return this.env.isFinished},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storyBoxMgr",{get:function(){return this.env.storyBoxMgr},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"constraintSpace",{get:function(){return this.env.constraintSpace},enumerable:!1,configurable:!0}),e.prototype.onLayoutFinished=function(){var e;this.env.isFinished=!0,null===(e=this.onLayoutFinishCallback)||void 0===e||e.call(this),this.env.context.fire(new l.Zl(l.Xj.Full)),this.env.isPrintLayout&&this.env.hasNumPagesField&&(this.env.globalPageNum=this.getLayoutState().pageCount,this.env.context.fire(new c.RlB))},e.prototype.setLayoutType=function(e){e!==this.docLayoutType&&(void 0!==this.docLayoutType&&(0,c.KZv)(e)&&(0,c.KZv)(this.docLayoutType)?this.layout({isReflow:!0,synced:!0}):this.layout({synced:!0}))},e}()},46861:function(e,t,n){n.d(t,{RL:function(){return s},jd:function(){return c},gb:function(){return o.g},z6:function(){return l.z},tp:function(){return u},vk:function(){return d.v},wY:function(){return f},Xq:function(){return a}});var r,o=n(43670);!function(e){e.None="none",e.Contents="contents",e.Block="block",e.Inline="inline",e.InlineBlock="inline-block"}(r||(r={}));var i,a,s,c,l=n(82175),u=function(){function e(e,t){this.inlinePos=0,this.blockPos=0,this.inlinePos=e,this.blockPos=t}return e.zero=function(){return new e(0,0)},e}(),d=n(97358),p=n(85556),h=n(30479),f=function(e){function t(t){var n=e.call(this)||this;return n.measure=t.measure,n.extent=t.extent,n}return(0,p.__extends)(t,e),t.obtain=function(e){var n=t.sPool.obtain();return e?(n?(n.measure=e.measure,n.extent=e.extent):n=new t(e),n):n||t.zero},t.prototype.recycle=function(){this.measure=0,this.extent=0,t.sPool.recycle(this)},Object.defineProperty(t,"zero",{get:function(){return new t({measure:0,extent:0})},enumerable:!1,configurable:!0}),t.prototype.equal=function(e){return this.measure===e.measure&&this.extent===e.extent},t.prototype.contain=function(e){return this.measure>=e.measure&&this.extent>=e.extent},t.prototype.isZero=function(){return 0===this.measure&&0===this.extent},t.prototype.toString=function(){return"(m=".concat(this.measure,", e=").concat(this.extent,")")},t.sPool=new h.ObjectPool(100),t}(h.PoolNode);!function(e){e.HORIZONTAL_TB="horizontal-tb",e.VERTICAL_RL="vertical-rl",e.VERTICAL_LR="vertical-lr"}(i||(i={})),function(){function e(){this.value=i.HORIZONTAL_TB}e.prototype.isVerticalRl=function(){return this.value===i.VERTICAL_RL},e.prototype.isTextVertical=function(){return this.value.startsWith("vertical")},e.prototype.isTextHorizontal=function(){return this.value.startsWith("horizontal")}}(),function(e){e[e.EndBefore=0]="EndBefore",e[e.EndAt=1]="EndAt",e[e.Contains=2]="Contains",e[e.After=3]="After"}(a||(a={})),function(e){e[e.BeforeDirty=0]="BeforeDirty",e[e.EndAtDirtyBegin=1]="EndAtDirtyBegin",e[e.Dirty=2]="Dirty",e[e.Non=3]="Non"}(s||(s={})),function(e){e[e.None=0]="None",e[e.HeaderFooter=1]="HeaderFooter",e[e.Table=2]="Table",e[e.NestingTable=4]="NestingTable",e[e.Numbering=8]="Numbering",e[e.Field=16]="Field",e[e.Columns=32]="Columns",e[e.Floating=64]="Floating",e[e.TextFrame=128]="TextFrame",e[e.Footnote=256]="Footnote",e[e.Endnote=512]="Endnote"}(c||(c={}))},43670:function(e,t,n){n.d(t,{g:function(){return i}});var r=n(61251),o=n(97358),i=function(){function e(e){this.width=e.width}return Object.defineProperty(e,"none",{get:function(){return new e({width:o.v.zero,type:r.GJ.Outer})},enumerable:!1,configurable:!0}),e.equal=function(e,t){return e?!!t&&o.a.equal(e.width,t.width)&&e.type===t.type:!t},e.sNone=e.none,e}()},82175:function(e,t,n){n.d(t,{z:function(){return s}});var r=n(85556),o=n(30479),i=n(43670),a=n(97358),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),Object.defineProperty(t.prototype,"start",{get:function(){return(this.margin?this.margin.start:0)+(this.border?this.border.width.start:0)+(this.padding?this.padding.start:0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return(this.margin?this.margin.end:0)+(this.border?this.border.width.end:0)+(this.padding?this.padding.end:0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"before",{get:function(){return(this.margin?this.margin.before:0)+(this.border?this.border.width.before:0)+(this.padding?this.padding.before:0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"after",{get:function(){return(this.margin?this.margin.after:0)+(this.border?this.border.width.after:0)+(this.padding?this.padding.after:0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"measure",{get:function(){return this.start+this.end},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"extent",{get:function(){return this.before+this.after},enumerable:!1,configurable:!0}),t.prototype.equal=function(e){return!!e&&a.a.equal(this.margin,e.margin)&&a.a.equal(this.padding,e.padding)&&i.g.equal(this.border,e.border)},t.prototype.recycle=function(){this.margin=void 0,this.border=void 0,this.padding=void 0,t.sPool.recycle(this)},t.obtain=function(e){var n=t.sPool.obtain()||new t;return e&&(e.margin&&(n.margin=new a.v(e.margin)),e.border&&(n.border=new i.g(e.border)),e.padding&&(n.padding=new a.v(e.padding))),n},t.sPool=new o.ObjectPool(50),t.sNone=new t,t}(o.PoolNode)},97358:function(e,t,n){n.d(t,{a:function(){return o},v:function(){return i}});var r=n(85556),o=function(){function e(e){this.before=e.before,this.start=e.start,this.after=e.after,this.end=e.end}return e.equal=function(e,t){return e?!!t&&e.before===t.before&&e.start===t.start&&e.after===t.after&&e.end===t.end:!t},e}(),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),Object.defineProperty(t,"zero",{get:function(){return new t({before:0,start:0,after:0,end:0})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"measure",{get:function(){return this.start+this.end},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"extent",{get:function(){return this.before+this.after},enumerable:!1,configurable:!0}),t.sZero=t.zero,t}(o)},69890:function(e,t,n){n.d(t,{T4:function(){return R},oY:function(){return u},No:function(){return C},bJ:function(){return c},Qq:function(){return l},uu:function(){return a},xx:function(){return s},K6:function(){return S.K6},hg:function(){return S.hg},Jn:function(){return x},HM:function(){return T},lr:function(){return w},H6:function(){return v},mz:function(){return y}});var r=n(82487),o=n(46861),i=n(61251);function a(e,t){if(!e.hidden){var n=e.logicEdge;n.padding||(n.padding=o.vk.zero);var a=e.hasPrevPartial||e.mergedType===i.Wl.Secondary?r.lZc.top:e.vAlign;a===r.lZc.bottom?(n.padding.before=t,n.padding.after=0):a===r.lZc.center?(n.padding.before=Math.ceil(t/2),n.padding.after=Math.floor(t/2)):(n.padding.before=0,n.padding.after=t)}}function s(e,t,n){var r,o;if(0===t.length)return{cell:e.cell,overflow:e.cell.extent};var i=n.getMainCell(e.rowIndex,e.colBegin);if(i){var a=i.rowIndex,s=i.colBegin,c=e.rowIndex-t.length,l=Math.max(a-c,0),u=t[l].children.find((function(e){return e.colBegin===s}));if(u){for(var d=0,p=l;p<t.length;++p)d+=null!==(o=null===(r=t[p])||void 0===r?void 0:r.totalExtent)&&void 0!==o?o:0;return{cell:u,overflow:u.extent-d}}}return{cell:void 0,overflow:0}}var c,l,u,d=n(85556),p=n(30479),h=n(46708),f="doc_core",g="layout";function v(e,t){var n,r={opername:f,module:g,action:e,ver1:null===(n=window.clientVars)||void 0===n?void 0:n.globalPadId,ver5:void 0!==t.cost?String(Math.round(t.cost)):void 0,ver6:void 0!==t.pageCount?String(t.pageCount):void 0,ver7:void 0!==t.rangeLen?String(t.rangeLen):void 0,ver8:void 0!==t.layoutType?String(t.layoutType):void 0,ver9:void 0!==t.complexity?String(t.complexity):void 0};h.kQ.tdwReport(r)}function y(e){var t,n=e.isFirstPage?c.firstPageSuccess:c.success,r={opername:f,module:g,action:n,ver1:null===(t=window.clientVars)||void 0===t?void 0:t.globalPadId,ver5:e.success?1:0,ver6:void 0!==e.layoutType?String(e.layoutType):void 0,ver7:void 0!==e.complexity?String(e.complexity):void 0,ver8:e.errorAbstract,ver9:e.errorSummary,ver10:e.containsDataError?1:0};h.kQ.tdwReport(r);var o=e.isFirstPage?h.GI.FIRST_PAGE_LAYOUT_SUCESS_RATE:h.GI.LAYOUT_SUCESS_RATE;h.kQ.monitor007Status(o,e.success?h.eG.SUCCESS:h.eG.FAIL,e.errorAbstract)}!function(e){e.firstPageCost="first_page_layout_cost",e.averagePageCost="average_page_layout_cost",e.editCost="edit_layout_cost",e.error="layout_error",e.firstPageSuccess="first_page_layout_success",e.success="layout_success"}(c||(c={})),function(e){e.BoxRangeOverlapped="box range overlapped",e.UnclearedBoxRange="uncleared dirty range",e.InvalidChildBox="invalid child box",e.GetRangeBeforeEmit="try to call range series function before box emit",e.BreakBeforeEndPlaceholder="page breaked before end placeholder",e.MissingPrevPartial="breaked table-type box cannot find prev partial",e.ReadPropertyOfUndefined="read property of undefined",e.CannotBalancedColumns="cannot balance columns"}(l||(l={})),function(e){e.AbnormalExtent="box extent is abnormal",e.ErrorTable="table layout error",e.UnexpectedBreak="unexpected block break set",e.UnexpectedPageBreak="unexpected page break set",e.EmptyBody="body box content is empty",e.UnclearableDirty="unclearable dirty range",e.InfiniteRollback="infinite rollback detected",e.FlowStuck="flow stuck",e.DataError="data error occured"}(u||(u={}));var m=[u.ErrorTable,u.UnexpectedBreak,u.EmptyBody,u.InfiniteRollback,u.FlowStuck,u.DataError],b="[Layout]",_="".concat(b,"[FATAL]"),C=function(){function e(){}return e.warn=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=(0,d.__spreadArray)([b,e],(0,d.__read)(t.map((function(e){return"".concat(e)}))),!1).join(" ");r!==this.lastMessage&&(this.lastMessage=r,p.Logger.warn(r))},e.error=function(e,t){var n=void 0;e.rangeOrRanges&&(n=Array.isArray(e.rangeOrRanges)?e.rangeOrRanges:[e.rangeOrRanges]);var r=t.containsDataError?u.DataError:e.error,o={error:r,boxKind:void 0!==e.boxKind?i.uO[e.boxKind]:void 0,rangeOrRanges:n?n.map((function(e){return e.toString()})).join(", "):void 0,layoutType:void 0!==t.docEnv.layoutType?String(t.docEnv.layoutType):void 0,extraContext:e.extraContext},a=m.includes(r)&&!t.allowAutofix(),s=a?_:b,l=[o.error,o.boxKind,o.rangeOrRanges,o.extraContext].filter((function(e){return!!e})).join(","),d=[s,l].join(" ");p.Logger.error(d),t.recordError(l),function(e,t){var n,r={opername:f,module:g,action:c.error,ver1:null===(n=window.clientVars)||void 0===n?void 0:n.globalPadId,ver5:t?"fatal":"error",ver6:e.error,ver7:e.boxKind,ver8:e.layoutType};h.kQ.tdwReport(r)}(o,a),a&&t.breakLayoutOnFatal()},e}(),S=n(75939);function w(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=t.reduce((function(e,t){return e.concat(t)}),[]).sort((function(e,t){return e.gcpBegin-t.gcpBegin})),o=0;o<r.length-1;){var i=r[o],a=r[o+1];i.end()>=a.gcpBegin?(e&&i.end()>a.gcpBegin&&C.warn(l.BoxRangeOverlapped,i,a),r[o]=i.unionRange(a),r.splice(o+1,1)):o+=1}return r}function E(e){var t=e.children.filter((function(t){return t.parentBox===e}));return t.length!==e.children.length&&C.warn(l.InvalidChildBox),t}function x(e,t){var n=E(e).map((function(e){return t(e).filter((function(e){return e.isValid()}))}));return w.apply(void 0,(0,d.__spreadArray)([!0],(0,d.__read)(n),!1))}function T(e){var t=E(e);if(0===t.length)return[];var n=w(!0,t[0].getRanges(!0));if(1===t.length)return n;var r=w(!0,(0,h.Rz)(t).getRanges(!0));if(2===t.length)return w(!0,n,r);var o=(0,h.Rz)(n).end();return r[0]=r[0].clone(),r[0].len+=r[0].gcpBegin-o,r[0].gcpBegin=o,w(!0,n,r)}var R={UNCLEAR_RELAYOUT:5,EDIT_LAG:200,SLOW_PAGE_LAYOUT:500,MAX_SELF_ROLLBACK:10}},75939:function(e,t,n){n.d(t,{K6:function(){return a},dr:function(){return s},hg:function(){return i}});var r=n(61251),o=n(46861);function i(e,t){var n,i=null!==(n=e.getFirstDescendantOf(r.uO.Table,(function(e){return e.firstVisibleChild})))&&void 0!==n?n:e.getFirstDescendantOf(r.uO.Line,(function(e){return e.firstVisibleChild}));return t.checkDirty(i)===o.RL.BeforeDirty}function a(e,t,n){if(i(t,n)){var o=function(e){var t=e.getFirstDescendantOf(r.uO.Table,(function(e){return e.firstVisibleChild}));if(t){var n=t.firstChild.children.map((function(e){return e.getFirstDescendantOf(r.uO.Line)})).filter((function(e){return!!e}));return n.length>0?n:void 0}var o=e.getFirstDescendantOf(r.uO.Line,(function(e){return e.firstVisibleChild}));return o?[o]:void 0}(t);return!!o&&o.every((function(t){return t.totalExtent<=e}))}return!0}function s(e,t,n){var o,i,s;if(!e.env.isPrintLayout)return!0;var c=e.boxEnv,l=c.maxExtent+(null!==(i=null===(o=c.edge)||void 0===o?void 0:o.extent)&&void 0!==i?i:0),u=t.totalExtent;if(t.hasNextPartial){if(l<u)return!1;if(l===u)return!0;var d=null===(s=t.getAncestorOf(r.uO.Page))||void 0===s?void 0:s.nextSibling;return!d||!a(l-u,d,n)}return l>=u}},2613:function(e,t,n){n.d(t,{BOTTOM_MARGIN_OF_DELETE_ICON:function(){return u.RpJ},BaseLineOverlay:function(){return u.ry8},BlockLayerForceUpdateNotification:function(){return u.fDs},BoxKind:function(){return i.uO},BuiltinStyleName:function(){return c.HiI},BuiltinStyles:function(){return c.zjl},BulletText:function(){return c.ly6},CODEBLOCK_LANGUAGES:function(){return c.ag_},CaretChangeNotification:function(){return u.QMx},Changeset:function(){return f.hV},ChangesetDataType:function(){return p.wh},ClipboardNotificationType:function(){return h.ClipboardNotificationType},ClipboardType:function(){return h.ClipboardType},CodeblockTheme:function(){return c.o6o},ColorUtil:function(){return p.u$},CommandType:function(){return o.wI},Commands:function(){return o.Gh},CommonSettingOperation:function(){return o.Tj},ContentType:function(){return o.zc},ContextMenuMobileNotification:function(){return u.Rmi},ContextPool:function(){return p.D2},CoveredPanelHeightNotification:function(){return u.Xg1},CssFontFamily:function(){return u.Gc},CssStyleMap:function(){return u.zOr},CssUtil:function(){return u.vW8},CusorPropChangeNotification:function(){return o.$C},DEFAULT_COUNT_WORD_DATA:function(){return o.hn},DEFAULT_TABLE_NESTING_LEVEL:function(){return c.AQ},DELETE_ICON_HEIGHT:function(){return u.GEy},DFSlideGestureNotification:function(){return u.EKA},DRAG_DISABLE_TABLE_ELEMENT:function(){return u.hpT},DataCollector:function(){return o.Me},DataEngine:function(){return c.ymk},DataStreamNotifyType:function(){return c.R4b},DecoratorTypes:function(){return u.cip},Defaults:function(){return c.keb},DefaultsUnit:function(){return c.jLu},DeleteOperation:function(){return o.uE},DeltaOption:function(){return o.C1},DiffType:function(){return c.UuS},DocViewType:function(){return c.$BT},DoubleFingerGestureNotificationType:function(){return u.LfI},DrawingType:function(){return c.HgR},DynamicCoreModules:function(){return o.rX},EditorDocumentType:function(){return p.y4},EnterBlockStateFromUserNotification:function(){return u.W4e},ExitBlockStateFromUserNotification:function(){return u.BrT},ExtendRendererTypes:function(){return u.Rli},ExtensionNodeType:function(){return i.dZ},FeatureLoadFinishedNotification:function(){return o.IS},FeatureNotificationType:function(){return o.wq},FieldBoolean:function(){return c.UOC},FieldCodeLayoutContextKey:function(){return c.E2N},FieldCodeManager:function(){return c.YU5},FieldCodeNotification:function(){return u.dXU},FieldCodeNotificationType:function(){return u.vt1},FieldCodeProcessor:function(){return c.FZ},FieldCommonSwitchesName:function(){return c.VEu},FieldDisplayLayoutType:function(){return c.dLA},FieldLayoutType:function(){return c.Zjt},FieldName:function(){return c.Lpg},FieldType:function(){return c.fSu},FieldUtil:function(){return c.BqD},FilterOpType:function(){return o.Pj},FocusBlurNotification:function(){return u.D_l},FocusBlurNotificationType:function(){return u.cbw},FooterRefType:function(){return l.nr},GCPRange:function(){return c.ICE},GlobalContext:function(){return o.kn},GridManager:function(){return c.wNn},GroupNode:function(){return l.Gw},HeaderRefType:function(){return l.ZK},HeaderType:function(){return u.n0j},HiddenEditorNotificationType:function(){return i.Dk},IBlockParagraphContext:function(){return i.qH},IComponentView:function(){return i.MJ},IContentOperationBase:function(){return o.h1},ICubeModule:function(){return p.Lf},IDrawingView:function(){return i.Se},IOverlayView:function(){return i.iW},IRoundRectView:function(){return i.fp},IScrollContainerView:function(){return i.fo},ITextView:function(){return i.mu},IdType2OssType:function(){return p.oI},IdkeyName:function(){return p.bP},IdkeyType:function(){return p.Vm},ImageSizeInitNotification:function(){return u.OEm},ImageUpdateNotification:function(){return u.bag},InsertMutation:function(){return f.Qr},InsertOperation:function(){return o.IZ},InsertRangeOperation:function(){return o.I},KeyAssist:function(){return p.N9},KeyCode:function(){return p.VD},KeyboardHeightNotification:function(){return u.Cyd},KeyboardNotification:function(){return i.wr},KeyboardNotificationFrom:function(){return i.Gt},KeyboardNotificationType:function(){return i.Ln},KeyboardState:function(){return i.zO},LandscapeStateNotification:function(){return u.sfL},LayoutInputNodeType:function(){return i.Rz},LayoutNotification:function(){return i.Rr},LayoutTableUtil:function(){return s.s9},LayoutType:function(){return c.msV},LayoutTypeChangeNotification:function(){return i.Aj},LayoutUtil:function(){return s.MM},LeafContainerBox:function(){return s.y7},LeafContainerNode:function(){return l.Fm},LineNode:function(){return l.yS},LineOverlayHeight:function(){return u.YQK},LineOverlayStyle:function(){return u.xNC},LineOverlayType:function(){return u.iz9},ListInfo:function(){return c.Jhz},ListLineBox:function(){return s.vm},ListType:function(){return c.RHh},ListUtils:function(){return c.g85},LocalLogger:function(){return p._Z},MODEL_DID_CHANGE_ACTION:function(){return d.rt},MarkdownParserType:function(){return i.og},MeloEditor:function(){return r.zq},MobileContextMenuType:function(){return o.A6},MobileParagraphDragNotification:function(){return u.y8O},MobileSelectionDragAction:function(){return i.iA},MobileSelectionDragNotificationType:function(){return i.Qj},MobileSelectionDragType:function(){return o.p2},ModelChangeNotification:function(){return o.BB},ModelDirtyRange:function(){return o.I3},ModelWrapperContext:function(){return l.fl},ModifyCommentOperation:function(){return o.Zw},ModifyDrawingOperation:function(){return o.gt},ModifyEmbeddedObjectOperation:function(){return o.c3},ModifyFieldOperation:function(){return o.iO},ModifyMutation:function(){return f.OJ},ModifyOperationBase:function(){return o.Zl},ModifyParagraphOperation:function(){return o.Ks},ModifyRunOperation:function(){return o.jb},ModifySubStoryOperation:function(){return o.di},ModifyTableOperation:function(){return o.vW},MonitorName:function(){return p.GI},MouseAction:function(){return i.oX},MouseCode:function(){return p.Gk},MouseNotificationType:function(){return i.V6},MutationModifyMode:function(){return c.GsI},MutationPropType:function(){return c.LK6},MutationType:function(){return f.x1},MutationWrapper:function(){return o.iN},MutationWrapperDeserialize:function(){return o.h9},NodeUtil:function(){return p.$w},NumberedListUtil:function(){return c.BsU},OSSPlatformType:function(){return p.V7},OperationFactory:function(){return o.Bz},OperationParseUtil:function(){return o.NC},OperationType:function(){return o.C8},OperationUtil:function(){return o.Yy},OverlayGraphicsType:function(){return u.ddz},PageOrderType:function(){return u.hjr},PagedView:function(){return u.x3A},ParagraphDragActionType:function(){return u.w0b},PasteDeltaProcessorPriority:function(){return h.PasteDeltaProcessorPriority},PasteDstType:function(){return h.PasteDstType},PasteNodeProcessorPriority:function(){return h.PasteNodeProcessorPriority},PerfUtilLogger:function(){return p.j7},PlaceholderChar:function(){return c.IfD},PlaceholderCharCode:function(){return c.ghV},PluginContainerFocusNotification:function(){return u.EZ5},PoolNodeFactory:function(){return p.Ij},PosPolicy:function(){return c.mEF},PropUpdateMode:function(){return c.XS7},PropertyColorUtil:function(){return c.QBv},PropertyFactory:function(){return c.kkf},PropertyImageUtil:function(){return c.Cf9},PropertyType:function(){return c.uSS},PropertyUtil:function(){return c.vCY},QuickLRU:function(){return u.cUw},REFRESH_LAYER_TIMEOUT:function(){return i.xl},RavenLogger:function(){return p.We},Region:function(){return u.ypq},RenderLayoutChange:function(){return u.$oP},RenderNextTickNotification:function(){return u.kv7},RenderNotificationTypes:function(){return u.kgn},RenderPriorityConfig:function(){return u._AL},RenderPriorityType:function(){return u.Ypk},RenderType:function(){return c.y2q},ReportContactType:function(){return p.ok},ReportHelper:function(){return p.kQ},SCROLL_DISTANCE_PX:function(){return u.bu_},SCROLL_DOWN_THRESHOLD_PX:function(){return u.RUH},SCROLL_INTERVAL_MS:function(){return u.qgr},SCROLL_UP_THRESHOLD_PX:function(){return u.sRw},SFLongTapGestureNotification:function(){return u.hAO},SFSlideGestureNotification:function(){return u.H4t},STAddonSourceType:function(){return c.SfV},STAlignH:function(){return c.fHH},STBorder:function(){return c.EJ9},STFldCharType:function(){return c.P1W},STHdrFtr:function(){return c.SoA},STHexColorAuto:function(){return c.oPf},STJcTable:function(){return c.y83},STJcWml:function(){return c.aLG},STLineSpacingRule:function(){return c.NRl},STMerge:function(){return c.m7Q},STNumberFormat:function(){return c.OBG},STOutlineLvl:function(){return c.ilm},STPageOrientation:function(){return c.VFj},STRelFromH:function(){return c.OO5},STRelFromV:function(){return c.dxu},STSectionMark:function(){return c.SN$},STShadingType:function(){return c.$Dc},STShd:function(){return c.VHU},STStoryType:function(){return c.AHI},STStyleType:function(){return c.TAq},STTaskState:function(){return c.RWe},STTblOverlap:function(){return c.wD4},STTblWidth:function(){return c.i7d},STUnderline:function(){return c.qc8},STVAnchor:function(){return c.B6J},STVerticalAlignRun:function(){return c.TBk},STVerticalJc:function(){return c.lZc},STXAlign:function(){return c.xxK},STYAlign:function(){return c.VKo},ScrollToUnrenderNotification:function(){return u.Wr$},ScrollViewType:function(){return o.hF},ScrollableResizeNotification:function(){return u.JxG},SearchDialogNotification:function(){return u.TV9},SectionNode:function(){return l.kz},SelTableNotification:function(){return u.p1Y},SelectionChangeNotification:function(){return u.NgY},ShapeBoxEnv:function(){return s.eW},ShapeFit:function(){return l.Tf},ShapePropertyBuilder:function(){return c.yRb},SingleFingerGestureNotificationType:function(){return u.r3l},SlideDirectionType:function(){return u.RV3},SlidePhrase:function(){return u.Am3},StateNotification:function(){return o.at},Status007:function(){return p.eG},StoryID:function(){return c.Eos},SurfaceMode:function(){return i.ns},TABLE_BUBBLE_REMINDER_ID:function(){return u.QhY},TABLE_COLS_HEADER:function(){return u.fnp},TABLE_COLS_HEADER_WRAPPER:function(){return u.Knp},TDBreakType:function(){return i.EQ},TDConstants:function(){return i.Jj},TDFieldType:function(){return i.X5},TableCssUtil:function(){return u.CAo},TablePropertyUtil:function(){return c.Rh7},TableThemeName:function(){return c.gjK},TaskScheduler:function(){return p.Oh},TaskStateChar:function(){return c.MJL},TaskText:function(){return c.G2o},TextBox:function(){return s.zC},TextBreakerBox:function(){return s.w8},TextFieldCharBox:function(){return s.oH},TextFrameType:function(){return c.Xbc},TextGroupNode:function(){return l.Yw},TextNode:function(){return l.R2},TextRunMeasureEngine:function(){return a.dp},TextboxDrawingPropertyBuilder:function(){return c.p$i},TextframeBackgroundChangeNotification:function(){return u.NlU},TextframeDidScrollNotification:function(){return u.$hw},ToolbarNotificationType:function(){return i.TP},TouchAction:function(){return i.Nl},TouchNotificationType:function(){return i.U1},TriggerSelectionChangeFeature:function(){return o.xG},UndoRedoType:function(){return o.z$},UserIdentifyFlag:function(){return p.WZ},ViewRange:function(){return u.rOq},ViewRangePointFull:function(){return u.SE$},WdBorderType:function(){return c.b0e},WeChatCorpId:function(){return p.Wb},WhiteSpaceType:function(){return c.H0c},WrapType:function(){return c.kCW},ZeroSpaceNode:function(){return l.Tp},ZoomNotification:function(){return u.yAE},ZoomNotificationType:function(){return u.KQB},ZoomStatusNotification:function(){return u.MpL},ZoomStatusType:function(){return u.hxJ},borderHtmlTypeMap:function(){return h.borderHtmlTypeMap},borderV2SizeMap:function(){return h.borderV2SizeMap},borerV2V3Map:function(){return h.borerV2V3Map},borerV3V2Map:function(){return h.borerV3V2Map},cached:function(){return p.HX},createCodeblockTextboxProperty:function(){return c.EBh},createDefaultLightblockProperty:function(){return c.lU6},createDefaultTextframeProperty:function(){return c.pjL},createIdleAsyncTask:function(){return p._v},createSectionNode:function(){return l.ej},deepEqual:function(){return p.vZ},excludeBorderType:function(){return c.SXW},filterSpecialChar:function(){return c.pzl},getCookie:function(){return p.ej},getCurrentPageDom:function(){return u._cT},getPrintableText:function(){return c.GDL},getScrollerHeight:function(){return p.hU},getScrollerWidth:function(){return p.E},getTableCbKey:function(){return u.NQT},getXsrf:function(){return p.fM},hasLoginCookie:function(){return p.Bp},isCommentRefChar:function(){return c.fHc},isContainerBoxLite:function(){return i.e_},isDebugEnviroment:function(){return p.hb},isDocumentBoxLite:function(){return i.E0},isDontRenderChar:function(){return c.Jn0},isEmbeddedObjectBox:function(){return i.oN},isEmbeddedObjectLite:function(){return i.i1},isFieldBox:function(){return i.tq},isFieldBoxLite:function(){return i.Hg},isFieldContainerBox:function(){return i.eJ},isFloatingBox:function(){return i.vv},isFooterBox:function(){return i.zd},isHeaderBox:function(){return i.AY},isHeaderFooterBox:function(){return i.De},isImageBox:function(){return i.qM},isImageBoxLite:function(){return i.AO},isLayoutBoxLite:function(){return i.pm},isLeafBox:function(){return i.Dy},isLeafBoxLite:function(){return i.Av},isLeafContainer:function(){return i.Oi},isLineBox:function(){return i.o7},isLineBreaker:function(){return c.jUV},isNormalText:function(){return c.b4K},isPageBox:function(){return i.n6},isParagraphBox:function(){return i.wS},isParagraphBoxLite:function(){return i.dc},isRichTextAreaBox:function(){return i.cu},isSubLineBox:function(){return i.Jt},isTableBox:function(){return i.YP},isTableBoxLite:function(){return i.hE},isTableCellBox:function(){return i.$5},isTableCellLite:function(){return i.UO},isTextBox:function(){return i.NF},isTextBoxLite:function(){return i.k4},isTextFrameBox:function(){return i.tJ},isTextFrameBoxLite:function(){return i.rM},isValidRegion:function(){return u.UHV},makeEmptyCopyData:function(){return h.makeEmptyCopyData},makeFrame:function(){return u.SsA},matchBorderType:function(){return c.JAq},mergeBorderType:function(){return c.iL1},renderStyles:function(){return u.F51},reportCommentDataCheckError:function(){return o.te},reportDrawingDataCheckError:function(){return o.Md},reportFieldDataCheckError:function(){return o.VO},reportTableDataCheckError:function(){return o.gA},restoreFocus:function(){return p.vg},saveFocus:function(){return p.S7},transformListIdToMsoId:function(){return h.transformListIdToMsoId},updateDefaultLightblockBackgroundColor:function(){return c.hRj},updateDefaultLightblockBorderColor:function(){return c.jxk}}),n(23537);var r=n(25606),o=n(31518),i=n(61251),a=n(80491),s=n(47176),c=n(82487),l=n(2498),u=(n(6956),n(46016)),d=n(43618),p=n(46708),h=n(66907);n.o(h,"Changeset")&&n.d(t,{Changeset:function(){return h.Changeset}}),n.o(h,"ClipboardNotificationData")&&n.d(t,{ClipboardNotificationData:function(){return h.ClipboardNotificationData}}),n.o(h,"ISelectionInnerData")&&n.d(t,{ISelectionInnerData:function(){return h.ISelectionInnerData}}),n.o(h,"InsertMutation")&&n.d(t,{InsertMutation:function(){return h.InsertMutation}}),n.o(h,"ModifyMutation")&&n.d(t,{ModifyMutation:function(){return h.ModifyMutation}}),n.o(h,"MutationType")&&n.d(t,{MutationType:function(){return h.MutationType}});var f=n(64282)},23537:function(e,t,n){var r=n(85556),o=n(31518),i=n(82487);o.rX.registerDynamic(i.y2q.Canvas,(function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8382),n.e(5367),n.e(5100)]).then(n.bind(n,95367))];case 1:return e.sent(),[2]}}))}))})),o.rX.registerDynamic(i.y2q.Lite,(function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(3959).then(n.bind(n,13959))];case 1:return e.sent(),[2]}}))}))}))},2498:function(e,t,n){n.d(t,{B$:function(){return I},Wl:function(){return f},bs:function(){return y},lF:function(){return ue},px:function(){return F},$1:function(){return D},nr:function(){return C},Gw:function(){return Z},zL:function(){return S},ZK:function(){return _},HJ:function(){return k},rn:function(){return s},Fm:function(){return O},yS:function(){return ee},jv:function(){return he},fl:function(){return H},Bh:function(){return ve},hS:function(){return T},u$:function(){return R},CK:function(){return re},sN:function(){return p},Fc:function(){return m},kz:function(){return de},Tf:function(){return x},Cr:function(){return ne},Fh:function(){return ae},g0:function(){return oe},ww:function(){return A},Yw:function(){return J},R2:function(){return M},Tp:function(){return L},OH:function(){return b},Kb:function(){return fe},zp:function(){return ge},ej:function(){return pe}});var r,o,i=n(85556),a=n(82487),s=function(){function e(e,t,n,r,o){this.limitRanges=[],this.nodeProperty=null,this.context=e,this.range=t,this.virtualEndGcps=[t.end()],this.offsets=o&&o.length>0?o:[0],this.type=n,this.parentNode=r,this.root=r?r.root:this,r&&this.intersectLimitRange(r.limitRanges)}return Object.defineProperty(e.prototype,"isVirtual",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isParent",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRoot",{get:function(){return!this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHidden",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.getSubstoryRootNode=function(){var e,t;return null!==(t=null===(e=this.parentNode)||void 0===e?void 0:e.getSubstoryRootNode())&&void 0!==t?t:null},Object.defineProperty(e.prototype,"parent",{get:function(){return this.parentNode||null},enumerable:!1,configurable:!0}),e.prototype.setParent=function(e){this.parentNode=e},e.prototype.getOffsets=function(){return this.offsets},Object.defineProperty(e.prototype,"beginOffset",{get:function(){return this.offsets[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasOffsets",{get:function(){return this.offsets[0]>0},enumerable:!1,configurable:!0}),e.prototype.seek=function(e){this.offsets=e},Object.defineProperty(e.prototype,"virtualEnds",{get:function(){return this.virtualEndGcps},set:function(e){var t=this;this.isVirtual&&(this.virtualEndGcps=[],e.forEach((function(e){if(e>=t.offsets[0]+t.range.gcpBegin){var n=new a.ICE(t.range.gcpBegin,e-t.range.gcpBegin);t.parentNode&&(n=n.intersectRange(t.parentNode.getGCPRange()),t.intersectLimitRange(t.parentNode.limitRanges));var r=n.end();t.virtualEndGcps.includes(r)||t.virtualEndGcps.push(r)}})))},enumerable:!1,configurable:!0}),e.prototype.getGCPRange=function(){return this.range},e.prototype.setGCPRange=function(e){this.range=e},e.prototype.getTextContent=function(){var e=this.getTextRange();return this.textStream.readText(e.gcpBegin,e.len)},e.prototype.getTextRange=function(){var e=(0,i.__read)(this.offsets,1)[0];return new a.ICE(this.range.begin()+e,this.range.length()-e)},e.prototype.getNextModelSibling=function(){return this.getNextSibling()},e.prototype.getModelBeginChild=function(){return this.getBeginChild()},e.prototype.setLimit=function(e){this.limitRanges=e},e.prototype.intersectLimitRange=function(e){var t=this;!e||e.length<1||(this.limitRanges=[],e.forEach((function(e){e.intersect(t.range)&&t.limitRanges.push(e.intersectRange(t.range))})))},e.prototype.getLimitRanges=function(){return this.limitRanges},e.prototype.getLimitRange=function(){var e=this.limitRanges.length;if(e>0){var t=this.limitRanges[0].begin(),n=this.limitRanges[e-1].end();return new a.ICE(t,n-t)}return this.range},e.prototype.getLimitContent=function(){var e=this.range;return this.limitRanges.length>0&&(e=(0,i.__read)(this.limitRanges,1)[0]),this.textStream.readText(e.begin(),e.length())},Object.defineProperty(e.prototype,"textStream",{get:function(){return this.dataStream.getTextStream()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tableStream",{get:function(){return this.dataStream.getTableStream()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storyStream",{get:function(){return this.dataStream.getStoryStream()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataStream",{get:function(){return this.context.dataStream},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataManager",{get:function(){return this.context.dataManager},enumerable:!1,configurable:!0}),e.prototype.getBPFirstIndex=function(){return this.textStream.getIndexFromGCP(this.range.begin())},e.prototype.getBPLastIndex=function(){return this.textStream.getIndexFromGCP(this.range.end()-1)},e}(),c=n(61251);!function(e){e[e.Block=0]="Block",e[e.Inline=1]="Inline",e[e.AtomicInline=2]="AtomicInline"}(o||(o={}));var l=((r={})[c.Rz.Section]=a.kbS.Section,r[c.Rz.Paragraph]=a.kbS.Paragraph,r[c.Rz.Table]=a.kbS.Paragraph,r[c.Rz.TextGroup]=a.kbS.Span,r[c.Rz.TableRow]=a.kbS.Span,r[c.Rz.TableCell]=a.kbS.Span,r[c.Rz.Text]=a.kbS.Span,r[c.Rz.Image]=a.kbS.Span,r[c.Rz.FieldContainer]=a.kbS.Span,r[c.Rz.LeafContainer]=a.kbS.Span,r[c.Rz.TextFrame]=a.kbS.Span,r[c.Rz.FieldCode]=a.kbS.Span,r);function u(e){var t;return null!==(t=l[e])&&void 0!==t?t:null}var d=n(30479),p=function(e){function t(t,n,r,o,i,a){var s=this,c=Array.isArray(n);return s=e.call(this,t,c?n[0]:n,r,o,i)||this,c&&(s.ranges=n),s.rangeOffsetIndex=null!=a?a:0,s}return(0,i.__extends)(t,e),Object.defineProperty(t.prototype,"isPolymeric",{get:function(){return!!this.ranges},enumerable:!1,configurable:!0}),t.prototype.getChildIterType=function(){},t.prototype.getActiveRange=function(){return this.ranges&&this.ranges.length>1?this.ranges[this.rangeOffsetIndex]:this.range},t.prototype.generateBeginChild=function(e){var t=this.getActiveRange();if(t.isEmpty())return null;var n=this.getChildIterType();if(void 0===n)return null;var r=this.createDataIterator(n,t),o=t.begin(),i=this.offsets.map((function(e){return o+e}));r.seek(i[0]);var a=r.getRange(!0);if(!a||a.isEmpty())return null;var s=a.begin();return e(a,i.map((function(e){return e-s})))},t.prototype.getLimitRangeForNextChild=function(e){if(this.ranges){var t=this.ranges.findIndex((function(t){return t.intersect(e)}));if(-1===t)return null;var n=this.limit(this.ranges[t]);if(!n)return null;if(e.end()>=n.end()){for(var r=t+1;r<this.ranges.length;++r){var o=this.limit(this.ranges[r]);if(o)return o}return null}return n}return this.getLimitRange()},t.prototype.getLimitRangeForPrevChild=function(e){if(this.ranges){var t=this.ranges.findIndex((function(t){return t.intersect(e)}));if(-1===t)return null;var n=this.limit(this.ranges[t]);if(!n)return null;if(e.begin()<=n.begin()){for(var r=t-1;r>=0;--r){var o=this.limit(this.ranges[r]);if(o)return o}return null}return n}return this.getLimitRange()},t.prototype.limit=function(e){var t,n;if(this.limitRanges.length>0){try{for(var r=(0,i.__values)(this.limitRanges),o=r.next();!o.done;o=r.next()){var a=o.value;if(a.intersect(e))return e.intersectRange(a)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return null}return e},t.prototype.generateNextSibling=function(e){if(this.isRoot)return null;var n=u(this.type),r=this.parent;if(null!==n&&r){var o=this.getActiveRange(),i=r instanceof t?r.getLimitRangeForNextChild(o):r.getLimitRange();if(i){var a=this.createDataIterator(n,i);i.intersect(o)&&(a.seek(o.end()-1),a.next());var s=a.getRange(!0);if(s.isValid()&&s.len>0)return e(s)}}return null},t.prototype.generatePrevSibling=function(e){if(this.isRoot)return null;var n=u(this.type),r=this.parent;if(null!==n&&r){var o=this.getActiveRange(),i=r instanceof t?r.getLimitRangeForPrevChild(o):r.getLimitRange();if(i){var a=this.createDataIterator(n,i);i.intersect(o)&&(a.seek(o.begin()),a.prev());var s=a.getRange(!0);if(s.isValid()&&s.len>0)return e(s)}}return null},t.prototype.createDataIterator=function(e,t){switch(e){case a.kbS.Section:return this.context.getSectionIterator(t);case a.kbS.Paragraph:return this.context.getParagraphIterator(t);case a.kbS.Span:return this.context.getSpanIterator(t);default:return d.Logger.error("unsupported IterType:".concat(e)),this.context.getSpanIterator(t)}},Object.defineProperty(t.prototype,"isParent",{get:function(){return!0},enumerable:!1,configurable:!0}),t}(s),h=n(46708),f=function(e){function t(t,n,r,o){return e.call(this,t,n,c.Rz.Body,r,o)||this}return(0,i.__extends)(t,e),Object.defineProperty(t.prototype,"isVirtual",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.skipFirstParaOrTable=function(){var e=this,t=0,n=this.beginOffset+this.range.gcpBegin,r=this.tableStream.createTableIterator();r.seek(n);var o=r.getRange();if(o.contains(n))t=o.end()-n;else{var i=this.textStream.createParagraphIterator();i.seek(n),t=i.getRange().end()-n}this.offsets[0]+=t,this.offsets=this.offsets.filter((function(t){return t>=e.offsets[0]}))},t.prototype.getProperty=function(){return this.nodeProperty||(this.nodeProperty=this.parentNode.getProperty()),this.nodeProperty},t.prototype.getChildIterType=function(){return a.kbS.Section},t.prototype.getBeginChild=function(){var t=this;return e.prototype.generateBeginChild.call(this,(function(e,n){return de.create(t.context,e,t,n)}))},t.prototype.getNextSibling=function(){return null},(0,i.__decorate)([(0,h.BK)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[]),(0,i.__metadata)("design:returntype",Object)],t.prototype,"getProperty",null),t}(p);function g(e,t,n){return new f(e,t.getGCPRange(),t,n)}function v(e,t){for(var n,r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var a=e.parent;if(e.isVirtual&&a){var s=e.getGCPRange(),c=e.virtualEnds.map((function(e){return e-s.gcpBegin})).filter((function(e){return e<s.end()}));if(c.length>0)return new(t.bind.apply(t,(0,i.__spreadArray)([void 0,e.context,s,null!==(n=e.parent)&&void 0!==n?n:void 0,c],(0,i.__read)(r),!1)))}return null}var y=function(e){function t(t,n,r,o,i,a){var s=e.call(this,t,n,c.Rz.Columns,i,a)||this;return s.columnsConfig=r,s.balanced=o,s}return(0,i.__extends)(t,e),Object.defineProperty(t.prototype,"columnCount",{get:function(){return Array.isArray(this.columnsConfig)?this.columnsConfig.length:this.columnsConfig.count},enumerable:!1,configurable:!0}),t.prototype.isBalanced=function(){return this.parentNode instanceof de?this.parentNode.isBalancedColumn():!!this.balanced},t.prototype.getProperty=function(){return null},Object.defineProperty(t.prototype,"isVirtual",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.getBeginChild=function(){var e;return new m(this.context,null!==(e=this.ranges)&&void 0!==e?e:this.range,this,this.offsets)},t.prototype.getNextSibling=function(){return null},t}(p),m=function(e){function t(t,n,r,o,i,a){void 0===i&&(i=0);var s=e.call(this,t,n,c.Rz.RichTextArea,r,o,a)||this;return s.index=i,s}return(0,i.__extends)(t,e),t.prototype.getSubstoryRootNode=function(){var e;return null!==(e=this.substoryRoot)&&void 0!==e?e:null},t.prototype.setSubstoryRoot=function(e){this.substoryRoot=e},Object.defineProperty(t.prototype,"isVirtual",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.getChildIterType=function(){return a.kbS.Paragraph},t.prototype.getBeginChild=function(t,n){var r=this;return le(e.prototype.generateBeginChild.call(this,(function(e,o){return ce(r.context,e,r,t,o,n)})),this.context.dataStream)},t.prototype.getProperty=function(){return null},t.prototype.getNextSibling=function(){if(this.parentNode instanceof y&&this.index<this.parentNode.columnCount-1){var e=v(this,t,this.index+1);return e&&(e.substoryRoot=this.substoryRoot),e}return null},t}(p);function b(e,t,n){return"".concat(e,"-").concat(t,"-").concat(n)}var _,C,S=function(e){function t(t,n,r,o){var i=e.call(this,t,n,c.Rz.HeaderFooter,r,o)||this;return i.storyType=a.AHI.undefined,i.storyId="",i.parity=a.SoA.undefined,i.isMirror=!1,i}return(0,i.__extends)(t,e),Object.defineProperty(t.prototype,"isVirtual",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uniqueKey",{get:function(){return b(this.storyType,this.parity,this.storyId)},enumerable:!1,configurable:!0}),t.prototype.getProperty=function(){if(!this.range.isValid())return null;if(!this.nodeProperty){var e=this.context.dataStream.getStoryStream().getSubStoryInfoFromGcp(this.range.begin());e&&(this.nodeProperty=e.subStoryProp)}return this.nodeProperty},t.prototype.getSectionProperty=function(){return this.parentNode.getProperty()},t.prototype.getChildIterType=function(){return a.kbS.Paragraph},t.prototype.getBeginChild=function(){if(this.range.isValid()){var e=new m(this.context,this.range,this);return e.setSubstoryRoot(this),e}return null},t.prototype.getNextSibling=function(){var e;return this.storyType===a.AHI.headerContent&&null!==(e=this.parentNode.footer)&&void 0!==e?e:g(this.context,this.parentNode,this.parentNode.getOffsets())},Object.defineProperty(t.prototype,"isHeader",{get:function(){return this.storyType===a.AHI.headerContent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFooter",{get:function(){return this.storyType===a.AHI.footerContent},enumerable:!1,configurable:!0}),t.prototype.hasPageAlignDrawing=function(){if(void 0!==this.hasPageAlignDraw)return this.hasPageAlignDraw;this.hasPageAlignDraw=!1;var e=this.context.dataStream.getDrawingStream();if(e)for(var t=e.createDrawingIterator(this.range);t.hasNext();){var n=t.getProperty();if(n&&n.isFloating&&(n.anchor.positionH.align===a.fHH.inside||n.anchor.positionH.align===a.fHH.outside)){this.hasPageAlignDraw=!0;break}t.next()}return this.hasPageAlignDraw},(0,i.__decorate)([(0,h.BK)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[]),(0,i.__metadata)("design:returntype",Object)],t.prototype,"getProperty",null),t}(p);function w(e,t,n){var r=void 0,o=e.dataStream.getSectionStream().createSectionIterator();o.seek(t);do{var i=o.getProperty();r=null==i?void 0:i[n]}while(!r&&o.prev());return null!=r?r:""}function E(e,t,n){var r=function(e,t,n){var r=t.getProperty(),o=t.getGCPRange().gcpBegin+t.beginOffset,i=n?_:C,s="",c=a.SoA.default;(null==r?void 0:r.titlePg)&&t.isFirstPageOfSection?(s=w(e,o,i.first),c=a.SoA.first):function(e){return e.dataManager.getSettingsManager().getDocSettingsProperty(!0).evenAndOddHeaders}(e)&&t.isEvenPage?(s=w(e,o,i.even),c=a.SoA.even):s=w(e,o,i.default);var l=n?a.AHI.headerContent:a.AHI.footerContent,u=function(e,t,n){var r=e.dataStream.getStoryStream();if(t){var o=r.getSubStoryInfoFromId(t,n);if(o)return o.contentRange}}(e,s,l);return{storyId:u?s:"",storyType:l,range:null!=u?u:a.ICE.invalidRange(),parity:c}}(e,t,n),o=new S(e,r.range,t);return o.storyId=r.storyId,o.storyType=r.storyType,o.parity=r.parity,o.isMirror=e.cache.has(o.uniqueKey),o.isMirror||e.cache.set(o.uniqueKey,!0),o.hasPageAlignDrawing()&&(o.isMirror=!1),o}!function(e){e.default="defaultHeaderRefId",e.first="firstHeaderRefId",e.even="evenHeaderRefId"}(_||(_={})),function(e){e.default="defaultFooterRefId",e.first="firstFooterRefId",e.even="evenFooterRefId"}(C||(C={}));var x,T,R=function(e){function t(t,n,r,o){return e.call(this,t,n,c.Rz.Page,r,o)||this}var n;return(0,i.__extends)(t,e),t.prototype.initPageNumber=function(){var e,t,n,r;this.prevPage?this.pageIndex=this.prevPage.pageIndex+1:this.pageIndex=0,this.isFirstPageOfSection?((r=this.getProperty()).has(r.tKeys.pgNumType)&&r.pgNumType.has(r.pgNumType.tKeys.start)?this.pageNumber=r.pgNumType.start:this.prevPage?this.pageNumber=this.prevPage.pageNumber+1:this.pageNumber=a.keb.section.pageStartAt,(r.type!==a.SN$.evenPage||this.isEvenPage)&&(r.type!==a.SN$.oddPage||this.isOddPage)||(this.pageNumber+=1)):(null===(t=null===(e=this.prevPage)||void 0===e?void 0:e.sectionRange)||void 0===t?void 0:t.begin())!==(null===(n=this.sectionRange)||void 0===n?void 0:n.begin())&&(r=this.getProperty()).has(r.tKeys.pgNumType)&&r.pgNumType.has(r.pgNumType.tKeys.start)?this.pageNumber=r.pgNumType.start+1:this.pageNumber=this.prevPage.pageNumber+1},Object.defineProperty(t.prototype,"isVirtual",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.getProperty=function(){var e;if(!this.nodeProperty){var t=this.range.gcpBegin+this.offsets[0];if((null===(e=this.prevPage)||void 0===e?void 0:e.sectionRange)&&this.prevPage.sectionRange.contains(t))this.sectionRange=this.prevPage.sectionRange,this.nodeProperty=this.prevPage.nodeProperty;else{var n=this.dataStream.getSectionStream().createSectionIterator(this.range);n.seek(this.range.gcpBegin+this.offsets[0]),this.sectionRange=n.getRange(),this.nodeProperty=n.getProperty()}}return this.nodeProperty||(this.nodeProperty=a.kkf.createProperty(a.uSS.SectionProperty)),this.nodeProperty},t.prototype.getFirstSectionProperty=function(){for(var e=this;e.prevPage;)e=e.prevPage;return e.getProperty()},Object.defineProperty(t.prototype,"isFirstPageOfSection",{get:function(){return this.sectionRange||this.getProperty(),this.range.gcpBegin+this.offsets[0]===this.sectionRange.gcpBegin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEvenPage",{get:function(){return this.pageNumber%2==0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isOddPage",{get:function(){return this.pageNumber%2==1},enumerable:!1,configurable:!0}),t.prototype.getBeginChild=function(){var e,t;return this.context.minimalistMode=this.minimalistMode,null!==(t=null!==(e=this.header)&&void 0!==e?e:this.footer)&&void 0!==t?t:g(this.context,this,this.offsets)},Object.defineProperty(t.prototype,"hasHeader",{get:function(){return!!this.header},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasFooter",{get:function(){return!!this.footer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"header",{get:function(){return!this.headerNode&&this.isPrintLayout&&(this.headerNode=E(this.context,this,!0)),this.headerNode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"footer",{get:function(){return!this.footerNode&&this.isPrintLayout&&(this.footerNode=E(this.context,this,!1)),this.footerNode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPrintLayout",{get:function(){var e,t=null===(e=this.context.docEnv)||void 0===e?void 0:e.layoutType;return void 0!==t&&(0,a.KZv)(t)},enumerable:!1,configurable:!0}),t.prototype.getNextSibling=function(){var e=v(this,t);return e&&(e.prevPage=this,e.initPageNumber()),e},t.prototype.enableMinimalistMode=function(){this.minimalistMode=!0,this.context.minimalistMode=!0},t.prototype.isMinimalistMode=function(){return!!this.minimalistMode},(0,i.__decorate)([(0,h.BK)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[]),(0,i.__metadata)("design:returntype","function"==typeof(n=void 0!==a.k$D&&a.k$D)?n:Object)],t.prototype,"getProperty",null),t}(p),I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.generateProperty=function(){var e=this.textStream.createRunIterator(this.range).getProperty();return e||null},t.prototype.getRawRunProperty=function(){return this.generateProperty()},t.prototype.getRunProperty=function(){var e=this.generateProperty();if(e){var t=this.textStream.createParagraphIterator(this.range).getProperty();if(t){var n=this.context.dataManager,r=this.getRunPropOfTblStylePr();e=n.getStyleSheetManager().mergeStyleRunProperty(e,t,r),n.getThemeManager().mergeThemeForRun(e,a.Op5.EastAsian)}}return e},t.prototype.getRunPropOfTblStylePr=function(){var e,t=this.getCellAncestor();if(!t)return null;var n=t.getCellTblStylePrInfo();return n&&(null===(e=this.context.dataManager.getStyleSheetManager().getTblStylePrManager().getPropertyOfTblStylePr(n.tableCellPos,n.tblStylePrLook))||void 0===e?void 0:e.runProperty)||null},t.prototype.getCellAncestor=function(){var e,t=null===(e=this.parentNode)||void 0===e?void 0:e.parent;return t instanceof re?t.getCellAncestor():null},t.prototype.getBeginChild=function(){return null},t.prototype.getNextSibling=function(){var e=this.parent;if((null==e?void 0:e.virtualEnds)&&e.virtualEnds.length>0){var t=(0,i.__read)(e.virtualEnds,1)[0];if(t>=this.getTextRange().begin()&&t<this.range.end())return this.seek([t-this.range.begin()]),this}if(e instanceof Z||e instanceof F)return e.getChildNodeNextSibling(this);if(e instanceof p){var n=e.getLimitRange(),r=this.range.begin()+this.range.length();return Y(e,this.context,n,r,!1)}return null},t}(s),P=function(e){function t(t,n,r){return e.call(this,t,n,c.Rz.Empty,r)||this}return(0,i.__extends)(t,e),t.prototype.getProperty=function(){return this.nodeProperty||(this.nodeProperty=e.prototype.generateProperty.call(this)),this.nodeProperty},t}(I);!function(e){e[e.None=0]="None",e[e.FitParent=1]="FitParent",e[e.FitContent=2]="FitContent"}(x||(x={})),function(e){e[e.None=0]="None",e[e.Fit=1]="Fit"}(T||(T={}));var O=function(e){function t(t,n,r,o,i){return void 0===r&&(r=c.Rz.LeafContainer),e.call(this,t,n,r,o,i)||this}return(0,i.__extends)(t,e),Object.defineProperty(t.prototype,"isFixedRatio",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"measureFit",{get:function(){return x.None},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"extentFit",{get:function(){return x.None},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"measureOverflow",{get:function(){return T.None},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"extentOverflow",{get:function(){return T.None},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wrapContent",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.getProperty=function(){return null},Object.defineProperty(t.prototype,"uniqueTypeId",{get:function(){return""},enumerable:!1,configurable:!0}),t}(I),k=function(e){function t(t,n,r,o){return e.call(this,t,n,c.Rz.Image,r,o)||this}var n;return(0,i.__extends)(t,e),Object.defineProperty(t.prototype,"isSignBar",{get:function(){return this.getProperty().drawing.addonSource===a.SfV.signbar},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFixedRatio",{get:function(){return!this.isSignBar&&!this.getProperty().drawing.cNvGraphicFramePr.graphicFrameLocks.noChangeAspect},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"measureFit",{get:function(){return this.isSignBar?x.FitParent:x.None},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"extentFit",{get:function(){return x.None},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"measureOverflow",{get:function(){var e;return this.getProperty().drawing.graphic.graphicData.pic.isNotAutoFitLayout&&(null===(e=this.context.docEnv)||void 0===e?void 0:e.layoutType)!==a.msV.Web?T.None:T.Fit},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wrapContent",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFloating",{get:function(){var e;return(null===(e=this.context.docEnv)||void 0===e?void 0:e.layoutType)===a.msV.Paged&&!this.context.minimalistMode&&this.getProperty().isFloating&&!this.isZeroSize()},enumerable:!1,configurable:!0}),t.prototype.isZeroSize=function(){var e=this.getProperty().drawing.extent,t=e.cx,n=e.cy;return 0===t||0===n},t.prototype.getProperty=function(){var e;if(!this.property){var t=this.context.dataStream.getDrawingStream().createDrawingIterator(this.range).getProperty();if(!t)return new(a.kkf.getPropertyClass(a.uSS.DrawingProperty));if(this.context.wrapperMgr){var n=this.context.wrapperMgr.get(c.Rz.Image);n&&(this.wrappedModel=n(t))}this.property=(null===(e=this.wrappedModel)||void 0===e?void 0:e.data)||t}return this.property},Object.defineProperty(t.prototype,"uniqueTypeId",{get:function(){return this.getProperty().drawingType},enumerable:!1,configurable:!0}),(0,i.__decorate)([(0,h.BK)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[]),(0,i.__metadata)("design:returntype","function"==typeof(n=void 0!==a.bO4&&a.bO4)?n:Object)],t.prototype,"getProperty",null),t}(O),D=function(e){function t(t,n,r,o,i){var a=e.call(this,t,n,c.Rz.FieldContainer,o,i)||this,s=r.displayLayoutType;a.fieldInfo=r;var l=a.context.dataStream.getFieldStream().getFieldLayoutInfo(r);return a.measure=l.containerLayoutConfig.fitToParentWidth?x.FitParent:x.None,a.extent=l.containerLayoutConfig.fitToParentHeight?x.FitParent:x.None,a.pluginType=s,a.fieldLayoutInfo=l,a}return(0,i.__extends)(t,e),Object.defineProperty(t.prototype,"isFixedRatio",{get:function(){var e,t;return null!==(t=null===(e=this.fieldLayoutInfo.containerLayoutConfig)||void 0===e?void 0:e.lockAspectRatio)&&void 0!==t&&t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"measureFit",{get:function(){return this.measure},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"extentFit",{get:function(){return this.extent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"measureOverflow",{get:function(){return T.Fit},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"extentOverflow",{get:function(){return T.Fit},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wrapContent",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fieldSubtype",{get:function(){var e,t=this.fieldInfo.fieldCode.switches;return null!==(e=a.BqD.getComplexFieldSubType(t))&&void 0!==e?e:""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){var e,t=this.fieldInfo.fieldCode.switches;return null!==(e=null==t?void 0:t[a.VEu.key])&&void 0!==e?e:""},enumerable:!1,configurable:!0}),t.prototype.getProperty=function(){return null},Object.defineProperty(t.prototype,"uniqueTypeId",{get:function(){return this.fieldSubtype},enumerable:!1,configurable:!0}),t}(O),M=function(e){function t(t,n,r,o){return e.call(this,t,n,c.Rz.Text,r,o)||this}var n;return(0,i.__extends)(t,e),t.prototype.getProperty=function(){return this.replacedProp?this.replacedProp:(this.nodeProperty||(this.nodeProperty=this.getRunProperty()),this.nodeProperty||(this.nodeProperty=a.kkf.createProperty(a.uSS.RunProperty)),this.nodeProperty)},t.prototype.getTextContent=function(){return this.replacedText?this.replacedText:e.prototype.getTextContent.call(this)},(0,i.__decorate)([(0,h.BK)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[]),(0,i.__metadata)("design:returntype","function"==typeof(n=void 0!==a.fRv&&a.fRv)?n:Object)],t.prototype,"getProperty",null),t}(I),A=function(e){function t(t,n,r,o){var i,s=this;(s=e.call(this,t,n,c.Rz.TextFrame,r,o)||this).subStoryInfo=null,s.size=d.MeloSize.zeroSize(),s.padding=c.Wh.getNone(0);var l=s.getProperty();if(s.subStoryInfo=s.storyStream.getSubStoryInfoFromId(s.property.contentId),l.drawingType===a.HgR.WordprocessingShape){var u=null===(i=s.subStoryInfo)||void 0===i?void 0:i.subStoryProp;u instanceof a.kkf.getPropertyClass(a.uSS.TextboxStoryProperty)&&(s.textboxProperty=u)}return s}var n;return(0,i.__extends)(t,e),t.prototype.getProperty=function(){if(this.property)return this.property;var e=this.nodeProperty?this.nodeProperty:this.context.dataStream.getDrawingStream().createDrawingIterator(this.range).getProperty(),t=(null==e?void 0:e.clone())||new(a.kkf.getPropertyClass(a.uSS.DrawingProperty));return this.property=t,t},Object.defineProperty(t.prototype,"isFixedRatio",{get:function(){return!this.getProperty().drawing.cNvGraphicFramePr.graphicFrameLocks.noChangeAspect},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isCodeblock",{get:function(){var e;return!!(null===(e=this.textboxProperty)||void 0===e?void 0:e.isCodeBlock)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLightBlock",{get:function(){var e;return!!(null===(e=this.textboxProperty)||void 0===e?void 0:e.isLightBlock)},enumerable:!1,configurable:!0}),t.prototype.isTextWrapping=function(){return this.getProperty().drawing.graphic.graphicData.wsp.bodyPr.wrap===a.ZFu.none},t.prototype.isFitContentSize=function(){var e;if(this.getProperty().drawingType===a.HgR.WordprocessingGroupShape)return!1;var t=this.getProperty().drawing.graphic.graphicData.wsp.bodyPr;return!(!t.has(t.tKeys.spAutoFit)||!(null===(e=this.subStoryInfo)||void 0===e?void 0:e.contentRange))},Object.defineProperty(t.prototype,"wrapContent",{get:function(){var e;return!this.isCodeblock||!!(null===(e=this.textboxProperty)||void 0===e?void 0:e.wordWrap)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"measureFit",{get:function(){return this.isCodeblock||this.isLightBlock?x.FitParent:this.isTextWrapping()?x.FitContent:x.None},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"extentFit",{get:function(){return this.isCodeblock||this.isLightBlock||this.isFitContentSize()?x.FitContent:x.None},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"measureOverflow",{get:function(){return this.isTextWrapping()?T.Fit:T.None},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"extentOverflow",{get:function(){return this.isCodeblock||this.isLightBlock?T.Fit:T.None},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFloating",{get:function(){var e;return(null===(e=this.context.docEnv)||void 0===e?void 0:e.layoutType)===a.msV.Paged&&!this.context.minimalistMode&&this.getProperty().isFloating},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"storyId",{get:function(){return this.getProperty().contentId},enumerable:!1,configurable:!0}),t.prototype.getBeginChild=function(){var e;if(!(null===(e=this.subStoryInfo)||void 0===e?void 0:e.contentRange))return null;var t=new m(this.context,this.subStoryInfo.contentRange,this,this.offsets);return t.setSubstoryRoot(this),t},t.prototype.getModelBeginChild=function(){var e;return(null===(e=this.subStoryInfo)||void 0===e?void 0:e.contentRange)&&!this.subStoryInfo.contentRange.isEmpty()?de.create(this.context,this.subStoryInfo.contentRange):null},(0,i.__decorate)([(0,h.BK)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[]),(0,i.__metadata)("design:returntype","function"==typeof(n=void 0!==a.bO4&&a.bO4)?n:Object)],t.prototype,"getProperty",null),t}(I),L=function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;return i.measuredText=a.IfD.ZeroSpace,i.replacedText=a.IfD.ZeroSpace,i.replacedProp=new(a.kkf.getPropertyClass(a.uSS.RunProperty)),i}return(0,i.__extends)(t,e),t}(M),N=function(e){function t(t,n,r,o){return e.call(this,t,n,c.Rz.EmbeddedObject,r,o)||this}return(0,i.__extends)(t,e),t.prototype.getProperty=function(){var e,t;return this.nodeProperty||(this.nodeProperty=null!==(t=null===(e=this.context.dataStream.getDrawingStream().getEmbeddedObjectInfoFromGcp(this.range.begin()))||void 0===e?void 0:e.property)&&void 0!==t?t:new(a.kkf.getPropertyClass(a.uSS.EmbeddedObjectProperty))),this.nodeProperty},Object.defineProperty(t.prototype,"isFixedRatio",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"measureFit",{get:function(){return x.None},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"extentFit",{get:function(){return x.None},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uniqueTypeId",{get:function(){return a.HgR.EmbeddedObject},enumerable:!1,configurable:!0}),t}(O),B=function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;return i.measuredText=a.IfD.FieldBegin,i.replacedText=a.IfD.FieldBegin,i.replacedProp=new(a.kkf.getPropertyClass(a.uSS.RunProperty)),i}return(0,i.__extends)(t,e),t}(M),F=function(e){function t(t,n,r,o){var i=e.call(this,t,n,c.Rz.FieldCode,r,o)||this;return i.isBegin=!1,i.children=[],i.childNodes=[],i.isGroup=!0,i}return(0,i.__extends)(t,e),t.prototype.getChildIterType=function(){return a.kbS.Span},Object.defineProperty(t.prototype,"fieldProps",{get:function(){return this.originFieldProps},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fieldInfo",{get:function(){return this.originFieldProps},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wrappedMetric",{get:function(){var e;return null===(e=this.wrappedModel)||void 0===e?void 0:e.metric},enumerable:!1,configurable:!0}),t.prototype.getProperty=function(){return null},t.prototype.getChildNodeNextSibling=function(e){var t=this.childNodes.indexOf(e);return t>=0&&t<this.childNodes.length-1?this.childNodes[t+1]:null},t.prototype.getChildNodePrevSibling=function(e){var t=this.childNodes.indexOf(e);return t>=1&&t<this.childNodes.length?this.childNodes[t-1]:null},t.prototype.getNextSibling=function(){var e=this.parent;return e instanceof Z?e.getChildNodeNextSibling(this):null},t.prototype.getBeginChild=function(){var e,t,n,r,o,i=null!==(n=null===(t=null===(e=this.fieldProps)||void 0===e?void 0:e.fieldResult)||void 0===t?void 0:t.range)&&void 0!==n?n:this.range,s=new M(this.context,i);if(this.childNodes=[s],this.wrappedModel&&this.fieldProps&&i){var c=this.dataStream.getFieldStream().getFieldLayoutInfo(this.fieldProps,null!==(r=this.fieldContext)&&void 0!==r?r:{}),l=(null==c?void 0:c.formatFieldResultText)||this.fieldProps.fieldResult.result||"",u=(0,a.GDL)(l);s.measuredText=u,s.replacedText=u,s.replacedProp=this.wrappedModel.fieldResultProp}return null!==(o=this.childNodes[0])&&void 0!==o?o:null},t.prototype.getModelBeginChild=function(){var t=this;return e.prototype.generateBeginChild.call(this,(function(e,n){return Q(t,t.context,t.getLimitRange(),e.begin(),!1,n)}))},t.prototype.setFieldInfo=function(e){var t,n=new(a.kkf.getPropertyClass(a.uSS.RunProperty));if(e.fieldResult){var r=new M(this.context,e.fieldResult.range),o=r.getRawRunProperty();n=r.getProperty(),(t=e.fieldCode.name)!==a.Lpg.HYPERLINK&&t!==a.Lpg.ATTACHMENT||!o||(o.isEmpty(o.tKeys.rStyle)&&(o.isEmpty(o.tKeys.color)&&(n.color.val=a.keb.linkColor),o.isEmpty(o.tKeys.u)&&(n.u.val=a.qc8.single)),e.displayLayoutType===a.dLA.Inline&&(n.vertAlign=a.TBk.undefined),e.displayLayoutType!==a.dLA.Text&&o.isEmpty(o.tKeys.u)&&(n.u.val=a.qc8.none))}var s=this.context.dataStream.getFieldStream().getFieldLayoutInfo(e);if(this.originFieldProps=(0,i.__assign)({layoutInfo:s,fieldResultProp:n},e),this.originFieldProps&&this.context.wrapperMgr){var l=this.context.wrapperMgr.get(c.Rz.FieldCode);l&&(this.wrappedModel=l(this.originFieldProps))}},t.prototype.getResultNode=function(e){var t,n;if(!this.originFieldProps||this.originFieldProps.layoutType===a.Zjt.Text)return null;var r=this.originFieldProps.fieldResult,o=this.context.dataStream.getFieldStream();if(!o||!r)return null;var i=r.range,s=o.getFieldLayoutInfo(this.originFieldProps,e),c=s.formatFieldResultText,l=(0,a.GDL)(c),u=new M(this.context,i);return u.measuredText=l,u.replacedText=l,u.replacedProp=null===(t=this.wrappedModel)||void 0===t?void 0:t.fieldResultProp,s.isAutoUpdate?u:this.wrappedModel?(null===(n=this.context.docEnv)||void 0===n?void 0:n.renderType)===a.y2q.Lite?new J(this.context,[u],this):u:Y(this,this.context,i,i.begin(),!1)},t}(p),U=function(){function e(){this.creators=[]}return e.prototype.createLeaf=function(e,t,n,r,o,a){var s,c;if(this.creators.length>0)try{for(var l=(0,i.__values)(this.creators),u=l.next();!u.done;u=l.next()){var d=(0,u.value)(e,t,n,r,o,a);if(d)return d}}catch(e){s={error:e}}finally{try{u&&!u.done&&(c=l.return)&&c.call(l)}finally{if(s)throw s.error}}return null},e.prototype.addLeafModel=function(e){this.creators.includes(e)||this.creators.push(e)},e}(),H=function(){function e(e,t,n){this.dataEngine=e,this.docEnv=t,this.wrapperMgr=n,this.cache=new Map,this.fieldInfos=[]}return Object.defineProperty(e.prototype,"dataStream",{get:function(){return this.dataEngine.getDataStream()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataManager",{get:function(){return this.dataEngine.getDataManager()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gcpChunkEnd",{get:function(){return this.dataEngine.getGCPChunkEnd()},enumerable:!1,configurable:!0}),e.prototype.getSpanIterator=function(e){if(this.spanIterator)e&&this.spanIterator.setLimitRange(e);else{var t=this.dataStream.getTextStream();this.spanIterator=t.createRunIterator(e)}return this.spanIterator},e.prototype.getParagraphIterator=function(e){if(this.paragraphIterator)e&&this.paragraphIterator.setLimitRange(e);else{var t=this.dataStream.getTextStream();this.paragraphIterator=t.createParagraphIterator(e)}return this.paragraphIterator},e.prototype.getSectionIterator=function(e){if(this.sectionIterator)e&&this.sectionIterator.setLimitRange(e);else{var t=this.dataStream.getSectionStream();this.sectionIterator=t.createSectionIterator(e)}return this.sectionIterator},e.prototype.getEndnoteIterator=function(e){if(this.endnoteIterator)e&&this.endnoteIterator.setLimitRange(e);else{var t=this.dataStream.getNotesStream();this.endnoteIterator=t.createEndnoteIterator(e)}return this.endnoteIterator},e.prototype.getFootnoteIterator=function(e){if(this.footnoteIterator)e&&this.footnoteIterator.setLimitRange(e);else{var t=this.dataStream.getNotesStream();this.footnoteIterator=t.createFootnoteIterator(e)}return this.footnoteIterator},e.leafModelManager=new U,e}(),j=function(e){function t(t,n,r,o,i){var a=e.call(this,t,r,o,i)||this;return a.notesProperty=n,a}return(0,i.__extends)(t,e),t.prototype.getTextContent=function(){return"1"},t}(M),G=function(e){function t(t,n,r,o,i){var a=e.call(this,t,r,o,i)||this;return a.notesProperty=n,a}return(0,i.__extends)(t,e),t.prototype.getTextContent=function(){return"1"},t}(M),V=function(e,t){return t?e.prev()?e.getProperty():null:e.next()?e.getProperty():null};function W(e,t,n,r,o){var i,a=e.createFieldIterator({nestingLevel:t,isRawIter:!0});return a.seek(n.begin()),(null===(i=a.getProperty())||void 0===i?void 0:i.nestingLevel)===t&&(o&&r.seek(o.fieldRange.end()+1),!0)}function z(e,t,n,r,o,i){var s,c=o.charCodeAt(0);if(!(0,a.Eo8)(c)||t instanceof F)return null;var l=e.dataStream.getFieldStream(),u=null==l?void 0:l.getDecodedFieldInfo(n.begin());if(!u)return null;var d=u.fieldRange,p=u.layoutType,h=u.hasNestField;if((null==u?void 0:u.fieldRange.begin())<n.begin()&&h&&W(l,(null==u?void 0:u.nestingLevel)||1,n,r,u))return null;if((null==u?void 0:u.nestingLevel)&&u.nestingLevel>1||h)return r.seek(u.fieldRange.end()-1),new L(e,u.fieldRange,t,i);if(p===a.Zjt.Text||h)return null!==(s=function(e,t,n,r,o){var i=o.fieldCode,s=o.layoutType,c=o.hasNestField;if(s===a.Zjt.Text||c){var l=i.range;if(e.dataStream.getFieldStream().isValidField(l.begin())){if(r===a.ghV.FieldBegin&&!l.isNull()){var u=a.ICE.inset(l,-1);return n.seek(u.end()-1),(d=new F(e,u)).setFieldInfo(o),d.isBegin=!0,d}var d;return r===a.ghV.FieldEnd?((d=new F(e,t)).setFieldInfo(o),d.isBegin=!1,d):null}}}(e,n,r,c,u))&&void 0!==s?s:null;if(d&&!d.isNull()){if(r.seek(d.end()-1),!(0,a.Uru)(u))return new D(e,d,u,void 0,i);var f=new F(e,d);return f.setFieldInfo(u||void 0),f}return null}function K(e,t,n,r,o,i){if((0,a.b4K)(r))return null;var s=function(e,t){var n,r=e.dataStream.getDrawingStream().createDrawingIterator();r.seek(t.begin());var o=new a.ICE(r.getRange().end()-1,1);if(t.contains(o))return null!==(n=r.getProperty())&&void 0!==n?n:void 0}(e,n);return(null==s?void 0:s.drawingType)===a.HgR.WordprocessingShape||(null==s?void 0:s.drawingType)===a.HgR.WordprocessingGroupShape?new A(e,n,i?t:void 0,o):s&&(0,a.mMZ)(r.charCodeAt(0))?new k(e,n,i?t:void 0,o):null}function q(e,t,n,r,o,i,s,c){void 0===o&&(o=!1),void 0===c&&(c=!1);var l=t.getSpanIterator(n);l.seek(r);var u=l.getProperty();if(!u||l.getRange().isEmpty()||r>=n.end())return{iter:l};var d=function(n,r){var o=l.getRange(),i=t.dataStream.getTextStream().readText(l.getRange().end()-1,1),u=c?z(t,e,o,l,i,r):function(e,t,n,r,o,i,s){var c=i.charCodeAt(0),l=e.dataStream.getFieldStream();if((0,a.Eo8)(c)&&c===a.ghV.FieldBegin){var u=l.getDecodedFieldInfo(n.begin());if(!u)return null;var d=u.fieldRange,p=u.hasNestField;if(u.fieldRange.begin()<n.begin()&&p&&W(l,u.nestingLevel,n,o,u))return null;if(u.layoutType===a.Zjt.Text){if(u.fieldResult&&c===a.ghV.FieldBegin){var h=u.fieldResult.range;o.seek(h.begin()-1);var f=new a.ICE(n.begin(),h.begin()-n.begin());return e.fieldInfos.push(u),new B(e,f,t,s)}return null}if(u.layoutType!==a.Zjt.Container)return null;if(!(0,a.Uru)(u))return o.seek(d.end()-1),new D(e,d,u,void 0,s);if(t instanceof F)return null;if(c===a.ghV.FieldBegin&&!d.isNull()){o.seek(d.end()-1);var g=new F(e,d);return g.setFieldInfo(u),g}}else if((0,a.Eo8)(c)&&c===a.ghV.FieldEnd)e.fieldInfos.length>0&&e.fieldInfos.pop();else if(e.fieldInfos.length>0){var v=e.fieldInfos[e.fieldInfos.length-1],y=e.fieldInfos.length>2?e.fieldInfos[e.fieldInfos.length-2]:l.getDecodedFieldInfo(v.fieldRange.begin(),v.nestingLevel-1);v.fieldCode.name===a.Lpg.HYPERLINK&&(null==y?void 0:y.fieldCode.name)===a.Lpg.TOC&&r.setDefault(r.tKeys.rStyle)}return null}(t,e,o,n,l,i,r);if(u)return u;var d=function(e,t,n,r,o,i){var s=e.dataStream.getMathStream(),c=null;return o===a.IfD.MathStart?c=s.getMathInfo(n.begin(),1):o===a.IfD.MathObjectStart&&(c=s.getMathObjectInfo(n.begin(),1)),c?(r.seek(c.range.end()-1),new L(e,c.range,t,i)):null}(t,e,o,l,i,r);if(d)return d;var p=function(e,t,n,r,o,i){if(o===a.IfD.SdtStart){var s=e.dataStream.getSdtStream().getSdtInfo(n.begin(),1);if(s)return r.seek(s.range.end()-1),new L(e,s.range,t,i)}return null}(t,e,o,l,i,r);if(p)return p;var h=function(e,t,n,r,o,i){if(o===a.IfD.FootnoteEndnoteReference){var s=e.dataStream.getNotesStream(),c=n.begin(),l=s.getFootnoteInfoFromGcp(c)||s.getEndnoteInfoFromGcp(c);if(l)return r.seek(l.range.end()-1),new L(e,l.range,t,i);var u=e.dataStream.getNotesStream(),d=n.begin(),p=u.getEndnoteInfoFromGcp(d);if(p)return r.seek(p.range.end()-1),new j(e,p.property,p.range,t,i);if(p=u.getFootnoteInfoFromGcp(d))return r.seek(p.range.end()-1),new G(e,p.property,p.range,t,i)}return null}(t,e,o,l,i,r);if(h)return h;var f=function(e,t,n,r,o,i){var s=e.dataStream.getDrawingStream(),c=null;if(o===a.IfD.PictureAnchor)c=s.getPictureInfoFromGcp(n.begin());else if(o===a.IfD.EmbeddedObjectAnchor)return c=s.getEmbeddedObjectInfoFromGcp(n.begin()),new N(e,n,t,i);return c?(r.seek(c.range.end()-1),new L(e,c.range,t,i)):null}(t,e,o,l,i,r);if(f)return f;var g=K(t,e,o,i,r,s);if(g)return g;var v=H.leafModelManager.createLeaf(t,e,o,null!=r?r:[],i,l);return v||new M(t,o,s?e:void 0,r)},p=d(u,i),h=[];h=[p];do{if(!(u=V(l,o)))break;if(!(p=d(u)))break;o?h.splice(0,0,p):h.push(p)}while(u);return{children:h,iter:l}}function Y(e,t,n,r,o,i){void 0===o&&(o=!1);var a=q(e,t,n,r,o,i,!1,!1);if(!a.children)return null;var s=a.children,c=a.iter;return s.length?new ee(t,s,e):new P(t,c.getRange(),e)}function Q(e,t,n,r,o,i){void 0===o&&(o=!1);var a=q(e,t,n,r,o,i,!0,!0);return a.children?0===a.children.length?new P(t,a.iter.getRange(),e):new J(t,a.children,e):null}var Z=function(e){function t(t,n,r,o){var i=this;if(n.length<=0)throw new Error("Group Node Must at least have one child node");var s=n[0].getGCPRange().begin(),c=0;n.forEach((function(e){e.setParent(i),o&&e.intersectLimitRange(o.getLimitRanges()),c=Math.max(e.getGCPRange().end(),c)}));var l=n[0].getOffsets();return(i=e.call(this,t,new a.ICE(s,c-s),r,o,l)||this).childNodes=n,i}return(0,i.__extends)(t,e),t.prototype.getChildNodeNextSibling=function(e){var t=this.childNodes.indexOf(e);return t>=0&&t<this.childNodes.length-1?this.childNodes[t+1]:null},t.prototype.getChildNodePrevSibling=function(e){var t=this.childNodes.indexOf(e);return t>=1&&t<this.childNodes.length?this.childNodes[t-1]:null},t.prototype.getNextSibling=function(){var e=this.parent;return e&&e instanceof t?e.getChildNodeNextSibling(this):null},t.prototype.getBeginChild=function(){var e=this,t=0,n=null;return this.childNodes.some((function(r){var o=r.getGCPRange(),a=(0,i.__read)(e.offsets,1)[0];return t+o.end()-o.begin()>a?(r.seek([a-t]),n=r,!0):(t+=o.end()-o.begin(),!1)})),n},t}(s),X=function(e){function t(t,n,r,o){return e.call(this,t,n,o||c.Rz.TextGroup,r)||this}return(0,i.__extends)(t,e),t.prototype.getProperty=function(){return null},t.prototype.getNextSibling=function(){var e=this.parent;if(e){var t=e.getLimitRange(),n=this.range.begin()+this.range.length();return Y(e,this.context,t,n,!1)}return null},t.prototype.getNextModelSibling=function(){var e=this.parent;if(e){var t=e.getLimitRange(),n=this.range.begin()+this.range.length();return Q(e,this.context,t,n,!1)}return null},t.prototype.isFirstChild=function(){var e=this.parent;if(e){var t=e.getGCPRange().begin();return this.range.begin()+this.offsets[0]===t}return!1},t}(Z),J=function(e){function t(t,n,r){return e.call(this,t,n,r,c.Rz.TextGroup)||this}return(0,i.__extends)(t,e),t}(X),$=function(e){function t(t,n,r){return e.call(this,t,n,c.Rz.List,r)||this}return(0,i.__extends)(t,e),t.prototype.getProperty=function(){return null},t.prototype.getNextSibling=function(e){if(this.parentNode){var t=this.parentNode.getLimitRange(),n=this.context.getParagraphIterator(t);if(n.seek(this.getGCPRange().end()-1),n.next()){var r=n.getRange(!0);return ce(this.context,r,this.parentNode,e)}}return null},t.prototype.getListManager=function(){return this.context.dataManager.getNumberingManager()},t.create=function(e,n,r){for(var o="",i=[],a=n;a&&a instanceof re;){var s=a.getProperty(),c=null==s?void 0:s.numPr.numId;if(!c||o&&c!==o)break;o=c,i.push(a),a=a.getNextSibling()}return new t(e,i,r)},t}(Z),ee=function(e){function t(t,n,r){return e.call(this,t,n,r,c.Rz.Line)||this}return(0,i.__extends)(t,e),Object.defineProperty(t.prototype,"isVirtual",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isParent",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.getLineBegin=function(){return this.range.gcpBegin+this.offsets[0]},t.prototype.getChildIterType=function(){return a.kbS.Paragraph},t.prototype.getNextSibling=function(){if(this.parentNode){var e=this.getGCPRange(),n=this.parentNode.getGCPRange().end(),r=this.virtualEnds.filter((function(e){return e<n})).map((function(t){return t-e.gcpBegin}));if(r.length>0){var o=new t(this.context,this.childNodes,this.parentNode);return o.seek(r),o}}return null},t}(X),te=n(69890),ne=function(e){function t(t,n,r,o){var i=e.call(this,t,n.range,c.Rz.TableCell,r,o)||this;return i.colBegin=0,i.gridIndex=0,i.cellIndex=0,i.mainCellOffset=0,i.cellTblStylePrInfo=null,i.cellInfo=n,i}var n;return(0,i.__extends)(t,e),t.prototype.updateMergedType=function(){if(this.cellInfo.property.vMerge===a.m7Q.continue){if(this.parentNode.isFirstChild){var e=this.parentNode.mergedMapping.getMainCell(this.parentNode.getRowIndex(),this.colBegin);if(e){var t=this.parentNode.parent;this.mainRowIndex=e.rowIndex;var n=t.getSkippedCell(e.rowIndex,e.colBegin);return void(void 0!==n?(this.mergedCellType=c.Wl.Secondary,this.mainCellInfo=n.info,this.mainCellOffset=n.offset):(this.mergedCellType=this.beginOffset>=this.range.len?void 0:c.Wl.Placeholder,this.mainCellInfo=this.getMainCellInfoBy(e.rowIndex,e.colBegin)))}}this.mergedCellType=c.Wl.Hidden}},t.prototype.getMainCellInfoBy=function(e,t){for(var n,r,o,i=this.tableStream.createRowIterator({limitRange:null===(r=null===(n=this.parent)||void 0===n?void 0:n.parent)||void 0===r?void 0:r.getGCPRange(),nestingLevel:this.nestingLevel}),s=0;s<e;++s)i.next();var c=this.tableStream.createCellIterator({limitRange:i.getContentRange(),nestingLevel:this.nestingLevel}),l=0;do{if(l===t)return null!==(o=this.tableStream.getCellInfo(c.getContentRange().gcpBegin,this.nestingLevel))&&void 0!==o?o:void 0;l+=a.Rh7.getWidth(c.getProperty().tcW)}while(c.hasNext()&&c.next())},Object.defineProperty(t.prototype,"mergedType",{get:function(){return this.mergedCellType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nestingLevel",{get:function(){return this.cellInfo.property.nestingLevel},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return a.Rh7.getWidth(this.cellInfo.property.tcW)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isHidden",{get:function(){return this.mergedCellType===c.Wl.Hidden},enumerable:!1,configurable:!0}),t.prototype.isEmptyPlaceholder=function(){return void 0===this.mergedType&&(this.offsets[0]===this.range.len-1&&te.No.warn(te.Qq.BreakBeforeEndPlaceholder,this.range,this.offsets,this.type),this.offsets[0]>=this.range.len-1)},t.prototype.isMergedPlaceholder=function(){return this.mergedCellType===c.Wl.Placeholder},t.prototype.isMergeBegin=function(){return this.cellInfo.property.vMerge===a.m7Q.restart&&this.getRowSpan()>1},t.prototype.isLastMerged=function(){return this.cellInfo.property.vMerge===a.m7Q.continue&&this.parent.mergedMapping.isLastMergedCell(this.getRowIndex(),this.getColBegin())},t.prototype.getProperty=function(){var e;if(!this.nodeProperty){var t=this.getTableStyleProp(),n=(null!==(e=this.mainCellInfo)&&void 0!==e?e:this.cellInfo).property.clone(),r=this.context.dataManager.getStyleSheetManager(),o=this.getCellPropOfTblStylePr(t.tblPr.tblStyle),i=r.mergeStyleTableCellProperty(n,t,o),s=this.mergeTableBorder(i,t,!1);this.nodeProperty=(0,a.dv7)(s,t,!1)}return this.nodeProperty||(this.nodeProperty=a.kkf.createProperty(a.uSS.TableCellProperty)),this.nodeProperty},t.prototype.getCellTblStylePrInfo=function(){return this.cellTblStylePrInfo},t.prototype.getCellPropOfTblStylePr=function(e){var t,n=this.context.dataManager.getStyleSheetManager().getTblStylePrManager();if(!n.isApplyTblStylePr(e))return null;var r=this.calcTableCellPos(),o=this.getTblStylePrLook();return this.cellTblStylePrInfo={tableCellPos:r,tblStylePrLook:o},(null===(t=n.getPropertyOfTblStylePr(r,o))||void 0===t?void 0:t.tableCellProperty)||null},t.prototype.getTblStylePrLook=function(){var e=this.getTableStyleProp().tblPr;return{styleId:e.tblStyle,tblLook:e.tblLook}},t.prototype.calcTableCellPos=function(){var e;return{cellIndex:this.cellIndex,rowIndex:null!==(e=this.mainRowIndex)&&void 0!==e?e:this.getRowIndex(),isLastCell:!this.tableStream.getCellInfo(this.range.end(),this.nestingLevel),isLastRow:!this.mainCellInfo&&!this.tableStream.getRowInfo(this.parentNode.getGCPRange().end(),this.parentNode.nestingLevel)}},t.prototype.getNextSibling=function(){return this.getNextSiblingImpl(!0)},t.prototype.getNextModelSibling=function(){return this.getNextSiblingImpl(!1)},t.prototype.getNextSiblingImpl=function(e){var n=this,r=this,o=r.parentNode,i=r.range,a=r.context;if(o){var s=this.tableStream.getCellInfo(i.end(),this.nestingLevel),c=this.gridIndex+this.getGridSpan();if(!s)return this.parentNode.setLastGridIndex(c),null;var l=this.offsets.map((function(e){return e+n.range.begin()-s.range.begin()})).filter((function(e){return e>=0}));e&&this.beginOffset>0&&0===l.length&&(l=[this.parentNode.getGCPRange().end()-s.range.gcpBegin]);var u=new t(a,s,o,l);return u.setColBegin(this.colBegin+this.width),u.setGridIndex(this.gridIndex+this.getGridSpan()),u.setCellIndex(this.cellIndex+1),u.updateMergedType(),u}return null},t.prototype.getBeginChild=function(){return this.isHidden||this.isEmptyPlaceholder()||this.isMergedPlaceholder()?null:this.mainCellInfo?new m(this.context,this.getContentRange(),this,[this.mainCellOffset]):new m(this.context,this.getContentRange(),this,this.offsets)},t.prototype.getModelBeginChild=function(t){var n=this;return e.prototype.generateBeginChild.call(this,(function(e,r){return ce(n.context,e,n,t,r)}))},t.prototype.isBreaker=function(e){return e instanceof re&&e.getPlaceholderChar()===a.IfD.TableCellBreak},t.prototype.getRowIndex=function(){return this.parentNode?this.parentNode.getRowIndex():0},t.prototype.getColBegin=function(){return this.colBegin},t.prototype.setColBegin=function(e){this.colBegin=e},t.prototype.setGridIndex=function(e){this.gridIndex=e},t.prototype.getGridIndex=function(){return this.gridIndex},t.prototype.setCellIndex=function(e){this.cellIndex=e},t.prototype.getCellIndex=function(){return this.cellIndex},t.prototype.getGridSpan=function(){return this.parentNode.gridManager.getSpan(this.gridIndex,this.width)},t.prototype.getRowSpan=function(){return this.parentNode.mergedMapping.getMergedCount(this.getRowIndex(),this.colBegin)+1},t.prototype.getChildIterType=function(){return a.kbS.Paragraph},t.prototype.getTableNode=function(){var e,t=null===(e=this.parentNode)||void 0===e?void 0:e.parent;return t||null},t.prototype.getTableStyleProp=function(){var e=this.getTableNode(),t=null==e?void 0:e.getProperty();return t||new(a.kkf.getPropertyClass(a.uSS.TableProperty))},t.prototype.mergeTableBorder=function(e,t,n){void 0===n&&(n=!0);var r=e.nestingLevel,o=n?e.clone():e,i=t.tblPr.tblBorders,s=o.tcBorders,c=this.range;if((0,a._ky)(s,a.kkf.getPropertyClass(a.uSS.CTTcBorders).tKeys.top,!0)&&(this.parentNode.getPrevSibling()?s.top=i.insideH:s.top=i.top),(0,a._ky)(s,a.kkf.getPropertyClass(a.uSS.CTTcBorders).tKeys.left,!0)){var l=this.tableStream.getCellInfo(c.begin()-1,r);s.left=l?i.insideV:i.left}if((0,a._ky)(s,a.kkf.getPropertyClass(a.uSS.CTTcBorders).tKeys.right,!0)){var u=this.tableStream.getCellInfo(c.end(),r);s.right=u?i.insideV:i.right}return(0,a._ky)(s,a.kkf.getPropertyClass(a.uSS.CTTcBorders).tKeys.bottom,!0)&&(this.parentNode.getNextSibling()?s.bottom=i.insideH:s.bottom=i.bottom),o},t.prototype.getContentRange=function(){return this.mainCellInfo?this.mainCellInfo.contentRange:this.cellInfo.contentRange},(0,i.__decorate)([(0,h.BK)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[]),(0,i.__metadata)("design:returntype","function"==typeof(n=void 0!==a.Zcu&&a.Zcu)?n:Object)],t.prototype,"getProperty",null),t}(p),re=function(e){function t(t,n,r,o){return e.call(this,t,n,c.Rz.Paragraph,r,o)||this}var n;return(0,i.__extends)(t,e),t.prototype.getChildIterType=function(){return a.kbS.Span},t.prototype.getPlaceholderChar=function(){return this.textStream.readText(this.range.end()-1,1)},t.prototype.getProperty=function(){if(!this.nodeProperty){var e=this.textStream.createParagraphIterator(this.range).getProperty();if(e){var t=this.context.dataManager,n=this.getParaPropOfTblStylePr();if((e=t.getStyleSheetManager().mergeStyleParagraphProperty(e,n)).has(e.tKeys.numPr)&&e.numPr.numId&&t.getNumberingManager()){var r=t.getNumberingManager().getListInfoFromGcpRange(this.range);r&&(e=r)}}this.nodeProperty=this.getWrappedProperty(e)}return this.nodeProperty||(this.nodeProperty=a.kkf.createProperty(a.uSS.ParagraphProperty)),this.nodeProperty},t.prototype.getParaPropOfTblStylePr=function(){var e,t=this.getCellAncestor();if(!t)return null;var n=t.getCellTblStylePrInfo();return n&&(null===(e=this.context.dataManager.getStyleSheetManager().getTblStylePrManager().getPropertyOfTblStylePr(n.tableCellPos,n.tblStylePrLook))||void 0===e?void 0:e.paragraphProperty)||null},t.prototype.getCellAncestor=function(){var e;return this.parent instanceof ne?this.parent:(null===(e=this.parent)||void 0===e?void 0:e.parent)instanceof ne?this.parent.parent:null},t.prototype.getNextSibling=function(n){var r=this;if(this.next)return this.next;var o=e.prototype.generateNextSibling.call(this,(function(e){return ce(r.context,e,r.parentNode,n)}));return o instanceof t&&(o.prev=this,this.next=o),o},t.prototype.getNextModelSibling=function(t){var n=this;return e.prototype.generateNextSibling.call(this,(function(e){return ce(n.context,e,n.parentNode,t)}))},t.prototype.getPrevSibling=function(){var n=this;if(this.prev)return this.prev;var r=e.prototype.generatePrevSibling.call(this,(function(e){return ce(n.context,e,n.parentNode)}));return r instanceof t&&(r.next=this,this.prev=r),r},t.prototype.getBeginChild=function(){var t=this;return e.prototype.generateBeginChild.call(this,(function(e,n){return Y(t,t.context,t.getLimitRange(),e.begin(),!1,n)}))},t.prototype.getModelBeginChild=function(){var t=this;return e.prototype.generateBeginChild.call(this,(function(e,n){return Q(t,t.context,t.getLimitRange(),e.begin(),!1,n)}))},t.prototype.concat=function(e){var t=e.getGCPRange();this.range.end()===t.begin()&&(this.range.len+=t.len)},t.prototype.getLeftIndent=function(){var e=this.getProperty();if(!e)return 0;var t=e.ind,n=t.hanging;t.firstLineChars&&(n=0);var r=t.left-n;return t.hangingChars&&(r=0),0!==t.leftChars&&(r=a.keb.fontSize*(t.leftChars/a.jLu.indentChars)),r},t.prototype.getRightIndent=function(){var e=this.getProperty();if(!e)return 0;var t=e.ind,n=t.right;return 0!==t.rightChars&&(n=a.keb.fontSize*(t.rightChars/a.jLu.indentChars)),n},t.prototype.getWrappedProperty=function(e){if(e&&this.context.wrapperMgr){var t=this.context.wrapperMgr.get(c.Rz.Paragraph);if(t){var n=t(e,this);return(null==n?void 0:n.data)||e}}return e},(0,i.__decorate)([(0,h.BK)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[]),(0,i.__metadata)("design:returntype","function"==typeof(n=void 0!==a.HFQ&&a.HFQ)?n:Object)],t.prototype,"getProperty",null),t}(p),oe=function(e){function t(t,n,r,o,i){void 0===i&&(i=!1);var a=e.call(this,t,n,c.Rz.TableRow,r,o)||this;return a.isFirstChild=i,a.rowIndex=0,a.afterGridIndex=0,a.gridManager=r.girdManager,a.mergedMapping=r.mergedMapping,a}var n;return(0,i.__extends)(t,e),Object.defineProperty(t.prototype,"height",{get:function(){var e;return(null===(e=this.getProperty())||void 0===e?void 0:e.trHeight.val)||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nestingLevel",{get:function(){var e;return(null===(e=this.getProperty())||void 0===e?void 0:e.nestingLevel)||1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"beforeGridSpan",{get:function(){return this.gridManager.getSpan(0,a.Rh7.getWidth(this.getProperty().wBefore))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"beforeWidth",{get:function(){return a.Rh7.getWidth(this.getProperty().wBefore)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"afterGridSpan",{get:function(){return this.gridManager.getRestSpan(this.afterGridIndex)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"afterWidth",{get:function(){return this.gridManager.getWidth(this.afterGridIndex,this.afterGridSpan)},enumerable:!1,configurable:!0}),t.prototype.getChildIterType=function(){return a.kbS.Span},t.prototype.getProperty=function(){if(!this.nodeProperty){var e=this.tableStream.getRowInfo(this.range.begin(),this.parentNode.getProperty().nestingLevel);e&&(this.nodeProperty=e.property)}return this.nodeProperty||(this.nodeProperty=a.kkf.createProperty(a.uSS.TableRowProperty)),this.nodeProperty},t.prototype.getPrevSibling=function(){var e=this,n=e.parentNode,r=e.range,o=e.context;if(n){var i=n.getLimitRange(),a=this.tableStream.createRowIterator({limitRange:i,nestingLevel:this.nestingLevel}),s=r.begin();if(a.seek(s),a.prev()){var c=new t(o,a.getRange(),n);return c.setRowIndex(this.rowIndex-1),c}}return null},t.prototype.getNextSibling=function(){var e=this,n=this,r=n.parentNode,o=n.range,i=n.context;if(r){var a=this.tableStream.getRowInfo(o.end(),this.nestingLevel);if(!a)return null;var s=this.offsets.map((function(t){return t+e.range.begin()-a.range.begin()})).filter((function(e){return e>=0})),c=new t(i,a.range,r,s);return c.setRowIndex(this.rowIndex+1),c}return null},t.prototype.getBeginChild=function(){return this.getBeginChildImpl(!1)},t.prototype.getModelBeginChild=function(){return this.getBeginChildImpl(!0)},t.prototype.getBeginChildImpl=function(e){var t=this;void 0===e&&(e=!0);var n=this.range.begin()+(e?this.beginOffset:0),r=this.nestingLevel,o=this.tableStream.getCellInfo(n,r),i=this.tableStream.getCellInterval(n,r);if(!o||!i)return null;var a=this.offsets.map((function(e){return e+t.range.begin()-o.range.begin()})).filter((function(e){return e>=0})),s=new ne(this.context,o,this,a);return s.setColBegin(i.begin),s.setGridIndex(this.gridManager.getGridIndex(i.begin)),s.updateMergedType(),s},t.prototype.getRowIndex=function(){return this.rowIndex},t.prototype.setRowIndex=function(e){this.rowIndex=e},t.prototype.setLastGridIndex=function(e){this.afterGridIndex=e},(0,i.__decorate)([(0,h.BK)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[]),(0,i.__metadata)("design:returntype","function"==typeof(n=void 0!==a.eJd&&a.eJd)?n:Object)],t.prototype,"getProperty",null),t}(p);function ie(e,t,n){var r,o,i=e.getRowInfo(n,t),a=0;if(i)for(var s=e.createCellIterator({nestingLevel:t,limitRange:i.range});s.hasNext()&&!s.getRange(!0).contains(n);)a+=null!==(o=null===(r=s.getProperty())||void 0===r?void 0:r.tcW.w)&&void 0!==o?o:0,s.next();return a}var ae=function(e){function t(t,n,r,o,i){var a=e.call(this,t,n,c.Rz.Table,o,i)||this;return a.nestingLevel=r,a.tableInfo=a.tableStream.getTableInfo(a.range.begin(),r),a.girdManager=a.tableStream.getGridManager(n.begin(),r),a.mergedMapping=a.tableStream.getMergedMapping(n.begin(),r),a}var n;return(0,i.__extends)(t,e),t.prototype.getChildIterType=function(){return a.kbS.Span},t.prototype.closeTableFloating=function(){this.disableFloating=!0},t.prototype.getProperty=function(){if(!this.nodeProperty&&this.tableInfo){var e=this.tableInfo.property,t=this.parentNode&&this.parentNode.getProperty();if(t instanceof a.kkf.getPropertyClass(a.uSS.SectionProperty)&&this.context.wrapperMgr){var n=this.context.wrapperMgr.get(c.Rz.Table),r=n&&n(e,t);this.nodeProperty=this.mergeTableProperty((null==r?void 0:r.data)||e)}else this.nodeProperty=this.mergeTableProperty(this.tableInfo.property)}return this.nodeProperty||new(a.kkf.getPropertyClass(a.uSS.TableProperty))},Object.defineProperty(t.prototype,"tableId",{get:function(){return this.getProperty().tblId},enumerable:!1,configurable:!0}),t.prototype.getNextSibling=function(e){var t=this;return this.generateNextSibling((function(n){return ce(t.context,n,t.parentNode,e)}))},t.prototype.getBeginChild=function(){var e=this,t=this.findFirstVisibleRowGcp(),n=this.tableStream.getRowInfo(t,this.nestingLevel);if(!n)return null;var r=this.offsets.map((function(t){return Math.max(t,1)+e.range.begin()-n.range.begin()})).filter((function(e){return e>=0})),o=new oe(this.context,n.range,this,r,!0);return o.setRowIndex(this.getRowIndex(t)),this.beginRowIndex=o.getRowIndex(),o},t.prototype.getBeginRowIndex=function(){return this.beginRowIndex},t.prototype.getRowIndex=function(e){var t;return function(e,t,n,r){for(var o=e.createRowIterator({nestingLevel:n,limitRange:t}),i=0;o.hasNext()&&!o.getRange(!0).contains(r);)i+=1,o.next();return i}(this.tableStream,(null===(t=this.tableInfo)||void 0===t?void 0:t.contentRange)||this.getGCPRange(),this.nestingLevel,e)},t.prototype.findFirstVisibleRowGcp=function(){var e=this.range.begin();if(0===this.offsets[0])return e+1;for(var t=0;t<this.offsets.length;++t){var n=e+this.offsets[t],r=this.tableStream.getCellInfo(n,this.nestingLevel);if((null==r?void 0:r.property.vMerge)===a.m7Q.restart){if(0==n-r.range.begin())return n;var o=this.getCrossPageRowGCP(e,n,t);if(o!==n&&this.setSkippedCell(n,r),void 0!==o){for(var i=t+1;i<this.offsets.length;++i){var s=e+this.offsets[i];if(s<o){var c=this.tableStream.getCellInfo(s,this.nestingLevel);(null==c?void 0:c.property.vMerge)===a.m7Q.restart&&this.setSkippedCell(s,c)}}return o}}return n}return this.tableStream.getRowInfo((0,h.Rz)(this.offsets)+e,this.nestingLevel).range.end()},t.prototype.getCrossPageRowGCP=function(e,t,n){for(var r=this.getRowIndex(t),o=ie(this.tableStream,this.nestingLevel,t),i=r+this.mergedMapping.getMergedCount(r,o),s=n+1;s<this.offsets.length;++s){var c=e+this.offsets[s],l=this.getRowIndex(c),u=this.tableStream.getCellInfo(c,this.nestingLevel);if(l>i){var d=this.tableStream.createRowIterator({limitRange:this.range,nestingLevel:this.nestingLevel});d.seek(t);for(var p=r+1;p<=i;++p)d.next();return d.getRange().gcpBegin}if((null==u?void 0:u.property.vMerge)!==a.m7Q.restart)return c}},t.prototype.setSkippedCell=function(e,t){this.skippedCells||(this.skippedCells={});var n=e-t.range.begin();if(n<=t.range.len){var r=this.getRowIndex(e),o=ie(this.tableStream,this.nestingLevel,e),i=this.mergedMapping.generateKey(r,o);this.skippedCells[i]={info:t,offset:n}}},t.prototype.getSkippedCell=function(e,t){var n,r=this.mergedMapping.generateKey(e,t);return null===(n=this.skippedCells)||void 0===n?void 0:n[r]},t.prototype.isFloating=function(){var e;return(null===(e=this.context.docEnv)||void 0===e?void 0:e.layoutType)===a.msV.Paged&&!this.context.minimalistMode&&this.nestingLevel===a.AQ&&this.getProperty().isWrapText&&!this.disableFloating},t.prototype.mergeTableProperty=function(e){return this.context.dataManager.getStyleSheetManager().mergeStyleTableProperty(e)},(0,i.__decorate)([(0,h.BK)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[]),(0,i.__metadata)("design:returntype","function"==typeof(n=void 0!==a.vE6&&a.vE6)?n:Object)],t.prototype,"getProperty",null),t}(p);function se(e,t){var n=t.getGCPRange(),r=e.getFieldStream().getDecodedFieldInfo(n.end()-1);return!r||r.layoutType===a.Zjt.Text}function ce(e,t,n,r,o,i){var s=t.begin(),c=e.dataStream.getTableStream().getTableInfo(s,null!=i?i:function(e){for(var t=e;t;){if(t instanceof ne)return t.nestingLevel;t=t.parent}return 0}(n)+1),l=null==c?void 0:c.range,u=e.dataEngine.getGCPChunkEnd(),d=e.dataEngine.getIsChunkLoading(),p=l&&l.end()<=u;if(c&&l&&(!d||p)){var h=o?o.map((function(e){return Math.max(0,t.begin()+e-l.begin())})):o;return new ae(e,l,c.property.nestingLevel,n,h)}for(var f=e.dataStream.getTextStream(),g=t,v=new re(e,t,n,o);v&&!se(e.dataStream,v);)(v=v.getNextSibling())&&(g=g.unionRange(v.getGCPRange()));var y=new re(e,g,n,o);if(function(){if(!n)return!1;var e=n.getGCPRange().end()-1;if(t.end()===e){var r=f.charCodeAt(e);return(0,a.EDJ)(r)}return!1}()){var m=new re(e,new a.ICE(g.end(),1),n);y.concat(m)}if(r){var b=y.getProperty();if(null==b?void 0:b.numPr.numId)return $.create(e,y,n)}return y}function le(e,t){if(!e)return null;for(var n=e.getGCPRange(),r=e;r&&!se(t,r);)(r=r.getNextSibling())&&(n=n.unionRange(r.getGCPRange()));return e===r||e.setGCPRange(n),e}var ue=function(e){function t(t,n,r){var o,s,l,u,d=this;(d=e.call(this,t.context,new a.ICE(t.getGCPRange().end(),0),c.Rz.Endnote,null!==(l=t.parent)&&void 0!==l?l:void 0,r)||this).prev=t,d.storyIds=n,d.ranges=[];var p=d.context.dataStream.getStoryStream();try{for(var h=(0,i.__values)(d.storyIds),f=h.next();!f.done;f=h.next()){var g=f.value,v=null===(u=p.getSubStoryInfoFromId(g))||void 0===u?void 0:u.contentRange;v&&d.ranges.push(v)}}catch(e){o={error:e}}finally{try{f&&!f.done&&(s=h.return)&&s.call(h)}finally{if(o)throw o.error}}return d}return(0,i.__extends)(t,e),t.prototype.getSectionProperty=function(){return this.prev.getProperty()},t.prototype.getProperty=function(){return null},t.prototype.getNextSibling=function(){return this.prev.getNextSibling(!0)},t.prototype.getBeginChild=function(){return new y(this.context,this.ranges,this.prev.columnsConfig,!0,this,this.offsets)},t}(p),de=function(e){function t(t,n,r,o){var i=e.call(this,t,n,c.Rz.Section,r,o)||this;return i.columnsConfig=i.initColumns(),0===i.range.begin()&&i.getProperty().endnotePr.pos!==a.lMK.sectEnd&&(i.root.isEndnoteAtDocEnd=!0),i}var n;return(0,i.__extends)(t,e),t.prototype.initColumns=function(){var e;if(this.context.minimalistMode)return{count:1,space:0};var t=this.getProperty();if(t&&this.context.docEnv&&(0,a.KZv)(null===(e=this.context.docEnv)||void 0===e?void 0:e.layoutType)){var n=t.cols;if(n.equalWidth||1===n.num)return{count:n.num,space:n.space};if(!n.col.isEmpty()){var r=[];if(n.col.forEach((function(e){r.push({measure:e.w,space:e.space})})),r.length>0)return r}}return{count:1,space:0}},t.prototype.isBalancedColumn=function(){return!(this.isLastSection()&&!this.hasEndnotes())},t.prototype.hasEndnotes=function(){return!!this.context.getEndnoteIterator(this.range).getProperty()},t.prototype.ignoreSectionBreak=function(){var e=this.textStream.charCodeAt(this.range.end()-1);(0,a.EDJ)(e)&&(this.range=this.range.clone(),this.range.len-=1)},t.prototype.isLastSection=function(){if(this.isRoot)return!0;var e=this.storyStream.getMainStoryInfo().contentRange;return this.range.end()>=e.end()-1},t.prototype.getProperty=function(){if(!this.nodeProperty){var e=this.context.dataStream.getSectionStream().createSectionIterator(this.range).getProperty()||new(a.kkf.getPropertyClass(a.uSS.SectionProperty));this.parentNode?this.nodeProperty=this.getWrappedProperty(e):this.nodeProperty=e}return this.nodeProperty||(this.nodeProperty=a.kkf.createProperty(a.uSS.SectionProperty)),this.nodeProperty},t.prototype.getChildIterType=function(){return a.kbS.Paragraph},t.prototype.getNextSibling=function(n){var r=this;return!n&&(this.collectEndnoteIds(),this.endnoteIds)?new ue(this,this.endnoteIds):e.prototype.generateNextSibling.call(this,(function(e){return t.create(r.context,e,r.parentNode)}))},t.prototype.collectEndnoteIds=function(){return[]},t.prototype.getBeginChild=function(e,t){return new y(this.context,this.range,this.columnsConfig,void 0,this,this.offsets)},t.prototype.getModelBeginChild=function(t,n){var r=this;return le(e.prototype.generateBeginChild.call(this,(function(e,o){return ce(r.context,e,r,t,o,n)})),this.context.dataStream)},t.create=function(e,n,r,o){var i=new t(e,n,r,o);return i.isLastSection()&&i.ignoreSectionBreak(),i.getTextRange().isEmpty()?null:i},t.prototype.getWrappedProperty=function(e){if(e&&this.context.wrapperMgr){var t=this.context.wrapperMgr.get(c.Rz.Section);if(t){var n=t(e);return(null==n?void 0:n.data)||e}}return e},(0,i.__decorate)([(0,h.BK)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[]),(0,i.__metadata)("design:returntype","function"==typeof(n=void 0!==a.k$D&&a.k$D)?n:Object)],t.prototype,"getProperty",null),t}(p);function pe(e,t){var n=de.create(e,t[0]);return 0===(null==n?void 0:n.getLimitRanges().length)&&n.setLimit(t),n}var he=function(e){function t(t,n,r){var o=e.call(this,t,n,c.Rz.MainStory,void 0,r)||this;return o.storyType=a.AHI.mainDocument,o.storyId=a.Eos.MainDocId,o}return(0,i.__extends)(t,e),t.prototype.getProperty=function(){if(!this.nodeProperty){var e=this.context.dataStream.getStoryStream().getSubStoryInfoFromGcp(this.range.begin());e&&(this.nodeProperty=e.subStoryProp)}return this.nodeProperty},t.prototype.getChildIterType=function(){return a.kbS.Section},t.prototype.getNextSibling=function(){return null},t.prototype.getBeginChild=function(){var e=new R(this.context,this.range,this,this.offsets);return e.initPageNumber(),e},t.prototype.getModelBeginChild=function(){var t=this;return e.prototype.generateBeginChild.call(this,(function(e,n){return de.create(t.context,e,t,n)}))},t.prototype.getTextRange=function(){var t=e.prototype.getTextRange.call(this),n=this.textStream.charCodeAt(this.range.end()-1);return(0,a.EDJ)(n)&&(t.len-=1),t},t.prototype.getChildByOffset=function(e){if(this.range.isEmpty())return null;var t=this.context.dataStream.getSectionStream().createSectionIterator(this.range),n=this.range.begin()+e;t.seek(n);var r=t.getRange(!0);return!r||r.isEmpty()?null:de.create(this.context,r,this,[n-r.begin()])},(0,i.__decorate)([(0,h.BK)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[]),(0,i.__metadata)("design:returntype",Object)],t.prototype,"getProperty",null),t}(p);function fe(e){var t,n=e.gcpChunkEnd||0,r=e.dataStream.getStoryStream().getMainStoryInfo(),o=(null===(t=null==r?void 0:r.contentRange)||void 0===t?void 0:t.backwardExpand(-1))||a.ICE.emptyRange();if(n>0){var i=new a.ICE(0,n);o=o.intersectRange(i)}return o.isEmpty()&&d.Logger.error("main document range is empty!"),(o.isEmpty()||0!==o.begin())&&h.kQ.captureException(h.GI.CHANGESET_ERROR_MAIN_RANGE,{},new Error(JSON.stringify(o))),new he(e,o)}function ge(e,t){if(!t||t.length<0)d.Logger.error("createMainStoryNodeFromRanges | invalid ranges");else{var n=e.dataStream.getStoryStream().getSubStoryInfoFromGcp(t[0].begin());if(n&&!n.contentRange.isEmpty()){var r=n.contentRange.begin(),o=t.map((function(e){return e.begin()-r})),i=new he(e,n.contentRange,o);return i.setLimit(t),i}d.Logger.error("createMainStoryNodeFromRanges | document range is empty!")}}var ve=function(){function e(){this.wrappers=new Map}return e.prototype.add=function(e,t){this.wrappers.set(e,t)},e.prototype.get=function(e){if(this.wrappers.has(e))return this.wrappers.get(e)},e.prototype.remove=function(e){return this.wrappers.delete(e)},e.prototype.clear=function(){this.wrappers.clear()},e}()},36695:function(e,t,n){n.d(t,{k:function(){return s}});var r=n(85556),o=n(30479),i=n(82557),a=n(46886),s=function(){function e(){}return e.author="",e.Default_DocData_Version=6,e.newDefaultStyleVersion=8,e.curDocDataVersion=Number.MAX_SAFE_INTEGER,e.fontFamily=(0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)([]),!1),['"Helvetica Neue"',"Helvetica",'"PingFang SC"','"Microsoft YaHei"','"Source Han Sans SC"','"Noto Sans CJK SC"','"WenQuanYi Micro Hei"',"sans-serif"],!1).join(","),e.fontSize=210,e.fontSizeStable=210,e.textColor="#000000",e.textHighlight="transparent",e.textBgFill="transparent",e.bgColor="transparent",e.linkColor="#1E6FFF",e.fontWeight=400,e.section={pageSize:{width:11906,height:16838,orientation:i.VFj.portrait},pageMargins:{top:1500,right:1200,bottom:1500,left:1200,header:851,footer:992,gutter:0},columns:{equalWidth:!0,num:1,sep:!1,space:425,cols:[]},pageStartAt:1},e.maxColNum=45,e.minColNum=1,e.tabCharsCount=2,e.headerMaxHeightRatio=.3,e.footerMaxHeightRatio=.3,e.paperMarginBottom=375,e.listLevelLimit=9,e.maxSupportListLevelLimit=9,e.specialListFont="txdocfont",e.smallListFontNum=1.6,e.mediumListFontNum=2.2,e.bigListFontNum=3.2,e.listDefaultHangingCharsNum=e.smallListFontNum,e.listDefaultHangingChars=e.listDefaultHangingCharsNum*a.j.indentChars,e.listDefaultHanging=e.listDefaultHangingCharsNum*e.fontSizeStable,e.mentionColor="#1e6fff",e.docLinkColor="#175CEB",e.caretColor="#1e6fff",e.containerMargin={left:30,top:0,right:30,bottom:0},e.tabSize=420,e.nativeScreenSize={width:0,height:0},e.ellipsis="...",e.pageBoxShawdow="0 0 10px 0 rgba(0, 0, 0, 0.06), 0 0 0 1px rgba(0, 0, 0, 0.04)",e.pageBoxShawdowMobile="0 0 0 1px rgba(0, 0, 0, 0.12)",e.pageBoxShawdowTimeline="",e.layoutLimit={wordCount:1e3,paraCount:20},e.webLayout={paddingTop:e.section.pageMargins.top,paddingBottom:e.section.pageMargins.bottom,pageArea:e.section.pageSize.width*e.section.pageSize.height},e.printLayout={continuous:{paddingTop:(0,o.pxToTwips)(4),paddingBottom:(0,o.pxToTwips)(4)}},e.table={marginTop:(0,o.pxToTwips)(12),marginBottom:(0,o.pxToTwips)(8),marginLeft:(0,o.pxToTwips)(0),marginRight:(0,o.pxToTwips)(0)},e.tableHeaderWidth=12,e.defaultTableStyleName="Table Grid",e.defaultBorder={borderWidth:6,borderStyle:i.EJ9.single,borderColor:"#CBCDD1"},e.tableCell={cellcolor:"#CBCDD1",borderTop:e.defaultBorder,borderRight:e.defaultBorder,borderBottom:e.defaultBorder,borderLeft:e.defaultBorder,colSpan:1,rowSpan:1,isMerged:!1,padding:{left:(0,o.pxToTwips)(4),top:(0,o.pxToTwips)(4),bottom:(0,o.pxToTwips)(3),right:(0,o.pxToTwips)(4)}},e.tableTextWrap={leftFromText:180,rightFromText:180,tblpY:1},e.tableBorderWidth=(0,o.pxToTwips)(1),e.splitlineColor="#000000",e.splitlineSize=1,e.autoParagraphDefaultSpacing=280,e.paragraphSpacingLinesUnitRadio=100,e}()},46886:function(e,t,n){n.d(t,{j:function(){return r}});var r=function(){function e(){}return e.rotate=6e4,e.percentage=1e5,e.autoLineRule=240,e.indentChars=100,e}()},94038:function(e,t,n){n.d(t,{IC:function(){return o},S$:function(){return r},TU:function(){return i}});var r=-1,o=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.gcpBegin=e,this.len=t}return e.prototype.begin=function(){return this.gcpBegin},e.prototype.end=function(){return this.gcpBegin+this.len},e.prototype.length=function(){return this.len},e.prototype.isEmpty=function(){return this.len<=0},e.prototype.isNull=function(){return 0===this.gcpBegin&&this.len<=0},e.prototype.isValid=function(){return this.gcpBegin>=0&&this.len>=0},e.prototype.intersect=function(e,t){var n=!0;return(this.end()<e.begin()||this.end()===e.begin()&&this.length()>0&&!t||this.begin()>e.end()||this.begin()===e.end()&&e.length()>0&&!t)&&(n=!1),n},e.prototype.contains=function(t){var n=t instanceof e?t.begin():t,r=t instanceof e?t.end():t,o=!1;return this.begin()<=n&&(r<this.end()||r===this.end()&&n!==r)&&(o=!0),o},e.prototype.intersectRange=function(t){var n=Math.max(this.begin(),t.begin());return new e(n,Math.min(this.end(),t.end())-n)},e.prototype.unionRange=function(t){var n=Math.min(this.begin(),t.begin());return new e(n,Math.max(this.end(),t.end())-n)},e.prototype.lessThan=function(e){return this.begin()<e.begin()||this.begin()===e.begin()&&this.end()<e.end()},e.prototype.notEqual=function(e){return this.gcpBegin!==e.gcpBegin||this.len!==e.len},e.prototype.equal=function(e){return!this.notEqual(e)},e.prototype.clone=function(){return new e(this.gcpBegin,this.len)},e.prototype.copyFrom=function(e){return this.gcpBegin=e.gcpBegin,this.len=e.len,this},e.prototype.relativeInRange=function(t){return new e(this.begin()-t.begin(),this.length())},e.prototype.offset=function(e){return this.gcpBegin+=e,this},e.prototype.backwardExpand=function(e){return this.len+=e,this},e.prototype.toString=function(){return"[".concat(this.gcpBegin,", ").concat(this.end(),")")},e.emptyRange=function(){return new e(0,0)},e.invalidRange=function(){return new e(-1,-1)},e.inset=function(t,n){return new e(t.begin()+n,t.length()-2*n)},e.insetBoth=function(t,n,r){return new e(t.begin()+n,t.length()-n-r)},e}(),i=new o(-1,-1)},55307:function(e,t,n){var r;n.d(t,{CL:function(){return u},ED:function(){return c},Eo:function(){return h},GD:function(){return m},If:function(){return o},Jn:function(){return p},LC:function(){return s},b4:function(){return y},dA:function(){return g},fH:function(){return f},gh:function(){return r},gw:function(){return a},jU:function(){return i},mM:function(){return v},p1:function(){return l},pz:function(){return b},wR:function(){return d}}),function(e){e[e.ZeroSpace=0]="ZeroSpace",e[e.FootnoteEndnoteReference=2]="FootnoteEndnoteReference",e[e.SdtStart=3]="SdtStart",e[e.SdtEnd=4]="SdtEnd",e[e.CommentReference=5]="CommentReference",e[e.TableRowBreak=6]="TableRowBreak",e[e.TableCellBreak=7]="TableCellBreak",e[e.DrawingAnchor=8]="DrawingAnchor",e[e.Tab=9]="Tab",e[e.ParagraphBreak=10]="ParagraphBreak",e[e.LineBreak=11]="LineBreak",e[e.PageBreak=12]="PageBreak",e[e.ParagraphReturn=13]="ParagraphReturn",e[e.ColumnBreak=14]="ColumnBreak",e[e.SectionBreak=15]="SectionBreak",e[e.EmbeddedObjectAnchor=17]="EmbeddedObjectAnchor",e[e.PictureAnchor=18]="PictureAnchor",e[e.FieldBegin=19]="FieldBegin",e[e.FieldSeparate=20]="FieldSeparate",e[e.FieldEnd=21]="FieldEnd",e[e.MathStart=22]="MathStart",e[e.MathEnd=23]="MathEnd",e[e.MathObjectStart=24]="MathObjectStart",e[e.MathObjectEnd=25]="MathObjectEnd",e[e.TableStart=26]="TableStart",e[e.TableEnd=27]="TableEnd",e[e.SubStoryBegin=28]="SubStoryBegin",e[e.SubStoryEnd=29]="SubStoryEnd",e[e.StoryBreak=30]="StoryBreak",e[e.OptionalHyphen=31]="OptionalHyphen",e[e.Space=32]="Space",e[e.NonBreakSpace=160]="NonBreakSpace",e[e.NoWidthOptionalBreak=8204]="NoWidthOptionalBreak",e[e.NoWidthNoBreak=8205]="NoWidthNoBreak",e[e.FullWidthSpace=12288]="FullWidthSpace"}(r||(r={}));var o=function(){function e(){}return e.ZeroSpace=String.fromCharCode(r.ZeroSpace),e.FootnoteEndnoteReference=String.fromCharCode(r.FootnoteEndnoteReference),e.SdtStart=String.fromCharCode(r.SdtStart),e.SdtEnd=String.fromCharCode(r.SdtEnd),e.CommentReference=String.fromCharCode(r.CommentReference),e.TableRowBreak=String.fromCharCode(r.TableRowBreak),e.TableCellBreak=String.fromCharCode(r.TableCellBreak),e.DrawingAnchor=String.fromCharCode(r.DrawingAnchor),e.Tab=String.fromCharCode(r.Tab),e.ParagraphBreak=String.fromCharCode(r.ParagraphBreak),e.LineBreak=String.fromCharCode(r.LineBreak),e.PageBreak=String.fromCharCode(r.PageBreak),e.ParagraphReturn=String.fromCharCode(r.ParagraphReturn),e.ColumnBreak=String.fromCharCode(r.ColumnBreak),e.SectionBreak=String.fromCharCode(r.SectionBreak),e.EmbeddedObjectAnchor=String.fromCharCode(r.EmbeddedObjectAnchor),e.PictureAnchor=String.fromCharCode(r.PictureAnchor),e.FieldBegin=String.fromCharCode(r.FieldBegin),e.FieldSeparate=String.fromCharCode(r.FieldSeparate),e.FieldEnd=String.fromCharCode(r.FieldEnd),e.MathStart=String.fromCharCode(r.MathStart),e.MathEnd=String.fromCharCode(r.MathEnd),e.MathObjectStart=String.fromCharCode(r.MathObjectStart),e.MathObjectEnd=String.fromCharCode(r.MathObjectEnd),e.TableStart=String.fromCharCode(r.TableStart),e.TableEnd=String.fromCharCode(r.TableEnd),e.SubStoryBegin=String.fromCharCode(r.SubStoryBegin),e.SubStoryEnd=String.fromCharCode(r.SubStoryEnd),e.StoryBreak=String.fromCharCode(r.StoryBreak),e.OptionalHyphen=String.fromCharCode(r.OptionalHyphen),e.Space=String.fromCharCode(r.Space),e.NonBreakSpace=String.fromCharCode(r.NonBreakSpace),e.NoWidthOptionalBreak=String.fromCharCode(r.NoWidthOptionalBreak),e.NoWidthNoBreak=String.fromCharCode(r.NoWidthNoBreak),e.FullWidthSpace=String.fromCharCode(r.FullWidthSpace),e}();function i(e){return[r.ParagraphBreak,r.LineBreak,r.ParagraphReturn,r.TableCellBreak].includes(e)}function a(e){return[r.ParagraphBreak,r.ParagraphReturn].includes(e)}function s(e){return e===r.LineBreak}function c(e){return[r.SectionBreak].includes(e)}function l(e){return[r.PageBreak].includes(e)}function u(e){return c(e)||l(e)}function d(e){return[r.Tab].includes(e)}function p(e){return e<r.Space&&!d(e)}function h(e){return[r.FieldBegin,r.FieldSeparate,r.FieldEnd].includes(e)}function f(e){return[r.CommentReference].includes(e)}function g(e){return[r.TableCellBreak,r.TableRowBreak,r.TableStart,r.TableEnd].includes(e)}function v(e){return[r.DrawingAnchor].includes(e)}function y(e){return void 0!==e&&!Object.values(o).some((function(t){return t===e}))}function m(e){void 0===e&&(e="");var t=new RegExp(/([\u0000-\u0008]|[\u000A-\u001F]|\u007F|\uFEFF)+/,"g");return e.replace(t,"")}function b(e){void 0===e&&(e="");var t=m(e),n=new RegExp("(".concat([o.NonBreakSpace,o.NoWidthOptionalBreak,o.NoWidthNoBreak,o.FullWidthSpace].join("|"),")+"),"g");return t.replace(n,"")}},50044:function(e,t,n){var r,o,i,a,s,c;n.d(t,{Eo:function(){return d},G2:function(){return a},H0:function(){return o},Hi:function(){return p},MJ:function(){return i},QP:function(){return v},RH:function(){return s},Uu:function(){return u},XS:function(){return r},dL:function(){return g},il:function(){return h},lS:function(){return f},ly:function(){return c}}),function(e){e[e.Merge=0]="Merge",e[e.Insert=1]="Insert",e[e.Cover=2]="Cover",e[e.Clean=3]="Clean"}(r||(r={})),function(e){e[e.Normal=0]="Normal",e[e.Nowrap=1]="Nowrap"}(o||(o={})),function(e){e.Done="",e.Todo=""}(i||(i={})),function(e){e.Done="",e.Todo=""}(a||(a={})),function(e){e[e.Bullet=0]="Bullet",e[e.Numbered=1]="Numbered",e[e.Task=2]="Task",e[e.None=3]="None"}(s||(s={})),function(e){e.Circle="",e.HollowCircle="",e.Square="",e.Diamond="",e.Star="",e.Hook="",e.Arrow=""}(c||(c={}));var l,u,d,p,h,f,g,v=new Map([[c.Circle,""],[c.HollowCircle,""],[c.Square,""],[c.Diamond,""],[c.Star,""],[c.Hook,""],[c.Arrow,""]]);!function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e[e.Justify=3]="Justify",e[e.Distribute=4]="Distribute"}(l||(l={})),function(e){e[e.None=0]="None",e[e.Minus=1]="Minus",e[e.Plus=2]="Plus"}(u||(u={})),function(e){e.MainDocId="BB08J2"}(d||(d={})),function(e){e.None="",e.Normal="Normal",e.Heading1="heading 1",e.Heading2="heading 2",e.Heading3="heading 3",e.Heading4="heading 4",e.Heading5="heading 5",e.Heading6="heading 6",e.Heading7="heading 7",e.Heading8="heading 8",e.Heading9="heading 9",e.Title="Title",e.Subtitle="Subtitle",e.Comments="Comments"}(p||(p={})),function(e){e[e.Level1=0]="Level1",e[e.Level2=1]="Level2",e[e.Level3=2]="Level3",e[e.Level4=3]="Level4",e[e.Level5=4]="Level5",e[e.Level6=5]="Level6",e[e.Level7=6]="Level7",e[e.Level8=7]="Level8",e[e.Level9=8]="Level9",e[e.LevelNone=9]="LevelNone"}(h||(h={})),function(e){e[e.Drawing=0]="Drawing",e[e.Plugin=1]="Plugin"}(f||(f={})),function(e){e.NoField="noField",e.Text="text",e.Inline="inline",e.Card="card",e.Preview="preview",e.IFrame="iframe",e.Hina="hina"}(g||(g={}))},82487:function(e,t,n){n.d(t,{HiI:function(){return G.Hi},zjl:function(){return In},ly6:function(){return G.ly},QP6:function(){return G.QP},ag_:function(){return O.ag_},F8o:function(){return O.F8o},Ist:function(){return bt},o6o:function(){return O.o6o},YGK:function(){return O.YGK},lSx:function(){return G.lS},AQ:function(){return tr},ymk:function(){return $n},kU_:function(){return an},R4b:function(){return le},keb:function(){return H.k},jLu:function(){return j.j},UuS:function(){return G.Uu},$BT:function(){return T},bO4:function(){return O.bO4},Akw:function(){return O.Akw},HgR:function(){return O.HgR},UOC:function(){return V},E2N:function(){return Yn},YU5:function(){return pt},FZ:function(){return ut},VEu:function(){return B},dLA:function(){return G.dL},Zjt:function(){return F},Lpg:function(){return N},Cl$:function(){return Gn},fSu:function(){return O.fSu},BqD:function(){return at},Op5:function(){return Mn},ICE:function(){return b.IC},wNn:function(){return jt},Pye:function(){return O.Pye},S$m:function(){return b.S$},TUk:function(){return b.TU},kbS:function(){return z},msV:function(){return x},Jhz:function(){return mn},RHh:function(){return G.RH},g85:function(){return yn},mFF:function(){return Vt},GsI:function(){return O.GsI},LK6:function(){return O.LK6},BsU:function(){return _n},RlB:function(){return Qn},HFQ:function(){return O.HFQ},IfD:function(){return k.If},ghV:function(){return k.gh},mEF:function(){return s},XS7:function(){return G.XS},QBv:function(){return O.QBv},Su2:function(){return O.Su2},kkf:function(){return O.kkf},Cf9:function(){return O.Cf9},uSS:function(){return O.uSS},vCY:function(){return O.vCY},y2q:function(){return R},fRv:function(){return O.fRv},SfV:function(){return O.SfV},fHH:function(){return O.fHH},eh1:function(){return O.eh1},EJ9:function(){return O.EJ9},C0n:function(){return O.C0n},lMK:function(){return O.lMK},P1W:function(){return O.P1W},Er3:function(){return O.Er3},SoA:function(){return O.SoA},oPf:function(){return O.oPf},y83:function(){return O.y83},aLG:function(){return O.aLG},NRl:function(){return O.NRl},m7Q:function(){return O.m7Q},OBG:function(){return O.OBG},ilm:function(){return G.il},g4b:function(){return O.g4b},V_x:function(){return O.V_x},j97:function(){return O.j97},VFj:function(){return O.VFj},OO5:function(){return O.OO5},dxu:function(){return O.dxu},SN$:function(){return O.SN$},$Dc:function(){return O.$Dc},VHU:function(){return O.VHU},ZWb:function(){return O.ZWb},AHI:function(){return O.AHI},TAq:function(){return O.TAq},lp4:function(){return O.lp4},SW1:function(){return O.SW1},RWe:function(){return O.RWe},wD4:function(){return O.wD4},i7d:function(){return O.i7d},_d6:function(){return O._d6},H6e:function(){return O.H6e},ZFu:function(){return O.ZFu},qc8:function(){return O.qc8},B6J:function(){return O.B6J},TBk:function(){return O.TBk},lZc:function(){return O.lZc},xxK:function(){return O.xxK},VKo:function(){return O.VKo},k$D:function(){return O.k$D},yRb:function(){return O.yRb},Eos:function(){return G.Eo},LCw:function(){return Fn},Zcu:function(){return O.Zcu},vE6:function(){return O.vE6},Rh7:function(){return r},eJd:function(){return O.eJd},gjK:function(){return gn},MJL:function(){return G.MJ},G2o:function(){return G.G2},Xbc:function(){return O.Xbc},p$i:function(){return O.p$i},GUD:function(){return O.GUD},b0e:function(){return O.b0e},H0c:function(){return G.H0},kCW:function(){return O.kCW},EbI:function(){return O.EbI},EBh:function(){return O.EBh},pRf:function(){return Ut},DbJ:function(){return O.DbJ},lU6:function(){return O.lU6},pjL:function(){return O.pjL},y5v:function(){return O.y5v},K1I:function(){return U},SXW:function(){return O.SXW},Bcl:function(){return dt},pzl:function(){return k.pz},Uru:function(){return mt},GDL:function(){return k.GD},fHc:function(){return k.fH},WGN:function(){return A},Jn0:function(){return k.Jn},mMZ:function(){return k.mM},Eo8:function(){return k.Eo},gw8:function(){return k.gw},jUV:function(){return k.jU},b4K:function(){return k.b4},p1d:function(){return k.p1},OqL:function(){return M},KZv:function(){return D},EDJ:function(){return k.ED},CLV:function(){return k.CL},LCi:function(){return k.LC},wR4:function(){return k.wR},dAl:function(){return k.dA},JAq:function(){return O.JAq},iL1:function(){return O.iL1},dv7:function(){return O.dv7},Jmy:function(){return er},_ky:function(){return O._ky},hRj:function(){return O.hRj},jxk:function(){return O.jxk}});var r={};n.r(r),n.d(r,{createTableProperty:function(){return Kt},getCellsVMergeStatusOfLastRow:function(){return Yt},getCellsVMergeStatusWithNextRow:function(){return Qt},getVMergeStatusOfContinueCell:function(){return qt},getWidth:function(){return zt},resolveMar:function(){return Zt}});var o,i=n(85556),a=function(){function e(){}return e.prototype.setData=function(e){},e.prototype.postNext=function(){var e=this.copy();return this.next(),e},e.prototype.postPrev=function(){var e=this.copy();return this.prev(),e},e.prototype.notEqual=function(e){return!this.equal(e)},e}();!function(e){e[e.RED=0]="RED",e[e.BLACK=1]="BLACK"}(o||(o={}));var s,c,l=function(){},u=function(){function e(){}return e.prototype.left=function(e){return null!==e?e.left:null},e.prototype.right=function(e){return null!==e?e.right:null},e.prototype.parent=function(e){return null!==e?e.parent:null},e.prototype.setLeft=function(e,t){return null!==e?(e.left=t,e.left):null},e.prototype.setRight=function(e,t){return null!==e?(e.right=t,e.right):null},e.prototype.setParent=function(e,t){return null!==e?(e.parent=t,e.parent):null},e.prototype.color=function(e){return null!==e?e.color:null},e.prototype.setColor=function(e,t){return null!==e?(e.color=t,e.color):null},e.prototype.reset=function(e,t,n,r,o){this.setLeft(e,t),this.setRight(e,n),this.setParent(e,r),void 0!==o&&this.setColor(e,o)},e.prototype.isRoot=function(e){return this.color(e)===o.BLACK&&this.parent(this.parent(e))===e},e.prototype.isHeader=function(e){return this.color(e)===o.RED&&this.parent(this.parent(e))===e},e.prototype.root=function(e){for(;!this.isRoot(e);)e=this.parent(e);return e},e.prototype.header=function(e){for(;!this.isHeader(e);)e=this.parent(e);return e},e.prototype.leftMostChild=function(e){for(;this.left(e);)e=this.left(e);return e},e.prototype.rightMostChild=function(e){for(;this.right(e);)e=this.right(e);return e},e.prototype.next=function(e){if(this.isHeader(e))return this.left(e);if(this.right(e))return this.leftMostChild(this.right(e));for(var t=this.parent(e);e===this.right(t);)e=t,t=this.parent(e);return this.right(e)===t?e:t},e.prototype.prev=function(e){if(this.isHeader(e))return this.right(e);if(this.left(e))return this.rightMostChild(this.left(e));for(var t=this.parent(e);e===this.left(t);)e=t,t=this.parent(e);return this.left(e)===t?e:t},e.prototype.deep=function(e,t){for(var n=0;t?e!==t:!this.isHeader(e);e=this.parent(e))n+=1;return n},e.prototype.rotateLeft=function(e,t){var n=this.right(t),r=this.left(n);this.setRight(t,r),r&&this.setParent(r,t);var o=this.parent(t);this.setParent(n,o),o===e?this.setParent(e,n):this.left(o)===t?this.setLeft(o,n):this.setRight(o,n),this.setLeft(n,t),this.setParent(t,n)},e.prototype.rotateRight=function(e,t){var n=this.left(t),r=this.right(n);this.setLeft(t,r),r&&this.setParent(r,t);var o=this.parent(t);this.setParent(n,o),o===e?this.setParent(e,n):this.left(o)===t?this.setLeft(o,n):this.setRight(o,n),this.setRight(n,t),this.setParent(t,n)},e.prototype.insertFixUp=function(e,t){for(;t!==this.parent(e)&&this.color(this.parent(t))===o.RED;){var n=this.parent(t),r=this.parent(n);if(this.left(r)===n){if(!(a=this.right(r))||this.color(a)!==o.RED){if(t===this.right(n)){this.rotateLeft(e,n);var i=t;t=n,n=i}this.setColor(n,o.BLACK),this.setColor(r,o.RED),this.rotateRight(e,r);break}this.setColor(n,o.BLACK),this.setColor(a,o.BLACK),this.setColor(r,o.RED),t=r}else{var a;if(!(a=this.left(r))||this.color(a)!==o.RED){t===this.left(n)&&(this.rotateRight(e,n),i=t,t=n,n=i),this.setColor(n,o.BLACK),this.setColor(r,o.RED),this.rotateLeft(e,r);break}this.setColor(n,o.BLACK),this.setColor(a,o.BLACK),this.setColor(r,o.RED),t=r}}this.color(this.parent(e))===o.RED&&this.setColor(this.parent(e),o.BLACK)},e.prototype.eraseSwap=function(e,t){var n=this.leftMostChild(this.right(t)),r=this.parent(t),o=this.left(t),i=this.right(n);if(n===this.right(t))this.setParent(t,n),this.setRight(n,t);else{var a=this.right(t),s=this.parent(n);this.setParent(t,s),this.setRight(n,a),this.setParent(a,n),this.setLeft(s,t)}this.setLeft(t,null),this.setRight(t,i),this.setParent(n,r),this.setLeft(n,o),this.setParent(o,n),i&&this.setParent(i,t),r===e?this.setParent(r,n):this.left(r)===t?this.setLeft(r,n):this.setRight(r,n);var c=this.color(t);this.setColor(t,this.color(n)),this.setColor(n,c)},e.prototype.eraseFixUp=function(e,t){for(;t!==this.parent(e);){if(this.color(t)===o.RED){this.setColor(t,o.BLACK);break}var n,r=this.parent(t);if(this.left(r)===t){var i=this.right(r);if(this.color(i)===o.RED&&(this.rotateLeft(e,r),this.setColor(r,o.RED),this.setColor(i,o.BLACK),i=this.right(r)),!(n=this.right(i))||this.color(n)===o.BLACK){if(!(a=this.left(i))||this.color(a)===o.BLACK){this.setColor(i,o.RED),t=r;continue}this.rotateRight(e,i),this.setColor(i,o.RED),this.setColor(a,o.BLACK),i=this.right(r),n=this.right(i)}this.rotateLeft(e,r),this.setColor(i,this.color(r)),this.setColor(r,o.BLACK),this.setColor(n,o.BLACK);break}if(i=this.left(r),this.color(i)===o.RED&&(this.rotateRight(e,r),this.setColor(r,o.RED),this.setColor(i,o.BLACK),i=this.left(r)),!(n=this.left(i))||this.color(n)===o.BLACK){var a;if(!(a=this.right(i))||this.color(a)===o.BLACK){this.setColor(i,o.RED),t=r;continue}this.rotateLeft(e,i),this.setColor(i,o.RED),this.setColor(a,o.BLACK),i=this.left(r),n=this.left(i)}this.rotateRight(e,r),this.setColor(i,this.color(r)),this.setColor(r,o.BLACK),this.setColor(n,o.BLACK);break}},e.prototype.eraseCut=function(e,t){var n=this.left(t);n||(n=this.right(t));var r=this.parent(t);n&&this.setParent(n,r),r===e?n?(this.setParent(e,n),this.color(n)===o.RED&&this.setColor(n,o.BLACK)):this.setParent(e,e):this.left(r)===t?this.setLeft(r,n):this.setRight(r,n),this.left(e)===t&&(this.right(t)?this.setLeft(e,this.leftMostChild(this.right(t))):this.setLeft(e,this.parent(t))),this.right(e)===t&&(this.left(t)?this.setRight(e,this.rightMostChild(this.left(t))):this.setRight(e,this.parent(t)))},e.prototype.insert=function(e,t,n){if(t===e)(t=this.right(e))===e?this.reset(e,n,n,n):(this.setRight(t,n),this.setRight(e,n));else if(this.left(t)){for(t=this.left(t);this.right(t);)t=this.right(t);this.setRight(t,n)}else this.setLeft(t,n),t===this.left(e)&&this.setLeft(e,n);return this.reset(n,null,null,t,o.RED),this.insertFixUp(e,n),n},e.prototype.insertToRight=function(e,t,n){if(t===e)(t=this.left(e))===e?this.reset(e,n,n,n):(this.setLeft(t,n),this.setLeft(e,n));else if(this.right(t)){for(t=this.right(t);this.left(t);)t=this.left(t);this.setLeft(t,n)}else this.setRight(t,n),t===this.right(e)&&this.setRight(e,n);return this.reset(n,null,null,t,o.RED),this.insertFixUp(e,n),n},e.prototype.insertRoot=function(e,t){return this.reset(e,t,t,t),this.reset(t,null,null,e,o.BLACK),t},e.prototype.insertLeft=function(e,t,n){return this.setLeft(t,n),t===this.left(e)&&this.setLeft(e,n),this.reset(n,null,null,t,o.RED),this.insertFixUp(e,n),n},e.prototype.insertRight=function(e,t,n){return this.setRight(t,n),t===this.right(e)&&this.setRight(e,n),this.reset(n,null,null,t,o.RED),this.insertFixUp(e,n),n},e.prototype.erase=function(e,t){return this.left(t)&&this.right(t)&&this.eraseSwap(e,t),this.eraseFixUp(e,t),this.eraseCut(e,t),t},e}(),d=function(e){function t(t,n){var r=e.call(this)||this;return r.node=t,r.policy=n,r}return(0,i.__extends)(t,e),t.prototype.next=function(){return this.node=this.policy.next(this.node),this},t.prototype.postNext=function(){var e=this.copy();return this.next(),e},t.prototype.prev=function(){return this.node=this.policy.prev(this.node),this},t.prototype.postPrev=function(){var e=this.copy();return this.prev(),e},t.prototype.equal=function(e){return this.node===e.getNode()},t.prototype.getNode=function(){return this.node},t}(a),p=function(){function e(e){this._header=e,this.resetHeader()}return e.prototype.resetHeader=function(){var e=this.header();this.policy().reset(e,e,e,e,o.RED)},e.prototype.policy=function(){return this._policy||(this._policy=new u),this._policy},e.prototype.header=function(){return this._header},e.prototype.root=function(){return this.policy().parent(this.header())},e.prototype.leftMost=function(){return this.policy().left(this.header())},e.prototype.rightMost=function(){return this.policy().right(this.header())},e.prototype.insert=function(e,t){return this.policy().insert(this.header(),e,t)},e.prototype.erase=function(e){return this.policy().erase(this.header(),e)},e.prototype.deep=function(e){return this.policy().deep(this.header(),e)},e}(),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t}(l);!function(e){function t(){var t=new h;return e.call(this,t)||this}(0,i.__extends)(t,e)}(p),function(e){e[e.Outer=0]="Outer",e[e.Inner=1]="Inner"}(s||(s={})),function(e){e[e.Allow=0]="Allow",e[e.Forbid=1]="Forbid"}(c||(c={}));var f,g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t}(l),v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.posPolicy=s.Outer,t.dupPolicy=c.Forbid,t}return(0,i.__extends)(t,e),t.prototype.off=function(e){return null!==e?e.off:0},t.prototype.setOff=function(e,t){return null!==e?(e.off=t,e.off):0},t.prototype.data=function(e){return null!==e?e.data:null},t.prototype.setData=function(e,t){return null!==e?(e.data=t,e.data):null},t.prototype.cmpPos=function(e,t){return this.posPolicy===s.Outer?t>=e:this.posPolicy===s.Inner&&e<t},t.prototype.findInsertPos=function(e,t){var n=this.parent(e);if(n===e)return{node:n,pos:t};var r=e;if(this.dupPolicy===c.Forbid)for(;n;)if(this.off(n)<t)t-=this.off(n),n=this.right(n);else{if(!(t<this.off(n)))return{node:null,pos:t};r=n,n=this.left(n)}else if(this.dupPolicy===c.Allow)for(;n;)this.cmpPos(this.off(n),t)?(t-=this.off(n),n=this.right(n)):(r=n,n=this.left(n));return{node:r,pos:t}},t.prototype.position=function(e,t){for(var n=e,r=this.off(n),o=this.parent(n);o!==t;o=this.parent(o))this.right(o)===n&&(r+=this.off(o)),n=o;return r},t.prototype.findOuter=function(e,t){var n=this.parent(e);if(n===e)return e;for(var r=t,o=e;n;)this.cmpPos(this.off(n),r)?(r-=this.off(n),n=this.right(n)):(o=n,n=this.left(n));return o},t.prototype.findInner=function(e,t){var n=this.parent(e);if(n===e)return e;for(var r=t,o=e;n;)this.cmpPos(this.off(n),r)?(r-=this.off(n),o=n,n=this.right(n)):n=this.left(n);return o},t.prototype.insertSpace=function(e,t,n){var r=this.parent(e);if(r!==e)for(var o=t;r;)this.cmpPos(this.off(r),o)?(o-=this.off(r),r=this.right(r)):(this.setOff(r,this.off(r)+n),r=this.left(r))},t.prototype.eraseSpace=function(e,t,n){var r=this.parent(e);if(r!==e)for(var o=t;r;)this.cmpPos(this.off(r),o)?(o-=this.off(r),r=this.right(r)):(this.setOff(r,this.off(r)-n),r=this.left(r))},t.prototype.rotateLeft=function(t,n){var r=this.right(n);this.setOff(r,this.off(r)+this.off(n)),e.prototype.rotateLeft.call(this,t,n)},t.prototype.rotateRight=function(t,n){var r=this.left(n);this.setOff(n,this.off(n)-this.off(r)),e.prototype.rotateRight.call(this,t,n)},t.prototype.eraseSwap=function(t,n){for(var r=this.right(n);this.left(r);)r=this.left(r);var o=this.off(r);this.setOff(r,this.off(n)+o),this.setOff(n,0);for(var i=this.parent(r);i!==n;i=this.parent(i))this.setOff(i,this.off(i)-o);e.prototype.eraseSwap.call(this,t,n)},t.prototype.eraseCut=function(t,n){if(this.right(n))for(var r=this.off(n),o=this.right(n);o;o=this.left(o))this.setOff(o,this.off(o)+r);e.prototype.eraseCut.call(this,t,n)},t}(u),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.copy=function(){return new t(this.node,this.policy)},t.prototype.data=function(){return this.policy.data(this.node)},t.prototype.setData=function(e){this.policy.setData(this.node,e)},t}(d),m=function(e){function t(t,n){void 0===t&&(t=s.Outer),void 0===n&&(n=c.Forbid);var r=new g;return e.call(this,r,t,n)||this}return(0,i.__extends)(t,e),t}(function(e){function t(t,n,r){var o=e.call(this,t)||this;return o._header=t,o._posPolicy=n,o._dupPolicy=r,o.resetHeader(),o}return(0,i.__extends)(t,e),t.prototype.resetHeader=function(){var t=this.header();return this.policy().setOff(t,0),e.prototype.resetHeader.call(this)},t.prototype.policy=function(){return this._ftPolicy||(this._ftPolicy=new v),this._ftPolicy.posPolicy=this._posPolicy,this._ftPolicy.dupPolicy=this._dupPolicy,this._ftPolicy},t.prototype.doEraseSpace=function(e,t){for(var n=this,r=[],o=this.policy().findOuter(this.header(),e),i=this.policy().findOuter(this.header(),e+t);o!==i;)o&&r.push(o),o=this.policy().next(o);var a=[];return r.forEach((function(e){var t=n.position(e);n.policy().erase(n.header(),e),n.policy().setOff(e,t),n.policy().reset(e,null,null,null),a.push({pos:t,data:e.data})})),this.policy().eraseSpace(this.header(),e,t),a},t.prototype.allocNode=function(e,t){var n=new g;return this.policy().setOff(n,e),this.policy().setData(n,t),n},t.prototype.insertFloat=function(e,t){var n=this.policy().findInsertPos(this.header(),e);if(n.node){var r=this.allocNode(n.pos,t);return this.policy().insert(this.header(),n.node,r),new y(r,this.policy())}return this.end()},t.prototype.insertSpace=function(e,t){this.policy().insertSpace(this.header(),e,t)},t.prototype.eraseSpace=function(e,t,n){var r=this.doEraseSpace(e,t);n&&n(r)},t.prototype.eraseFloat=function(e){this.policy().erase(this.header(),e.getNode())},t.prototype.position=function(e){return e instanceof y?this.policy().position(e.getNode(),this.header()):e instanceof g?this.policy().position(e,this.header()):-1},t.prototype.findOuter=function(e){return new y(this.policy().findOuter(this.header(),e),this.policy())},t.prototype.findInner=function(e){return new y(this.policy().findInner(this.header(),e),this.policy())},t.prototype.setDefaultData=function(e){return this.policy().setData(this.header(),e)},t.prototype.begin=function(){return new y(this.leftMost(),this.policy())},t.prototype.end=function(){return new y(this.header(),this.policy())},t.prototype.rbegin=function(){return new y(this.rightMost(),this.policy())},t}(p)),b=n(94038),_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t}(l),C=function(e,t,n){this.node=e,this.bLeft=t,this.pos=n},S=function(e){function t(t){void 0===t&&(t=!1);var n=e.call(this)||this;return n.isPolicy2=t,n}return(0,i.__extends)(t,e),t.prototype.left=function(e){return this.isPolicy2?null!==e?e.left2:null:null!==e?e.left:null},t.prototype.right=function(e){return this.isPolicy2?null!==e?e.right2:null:null!==e?e.right:null},t.prototype.parent=function(e){return this.isPolicy2?null!==e?e.parent2:null:null!==e?e.parent:null},t.prototype.setLeft=function(e,t){return this.isPolicy2&&null!==e?(e.left2=t,e.left2):null!==e?(e.left=t,e.left):null},t.prototype.setRight=function(e,t){return this.isPolicy2&&null!==e?(e.right2=t,e.right2):null!==e?(e.right=t,e.right):null},t.prototype.setParent=function(e,t){return this.isPolicy2&&null!==e?(e.parent2=t,e.parent2):null!==e?(e.parent=t,e.parent):null},t.prototype.color=function(e){return this.isPolicy2?null!==e?e.color2:null:null!==e?e.color:null},t.prototype.setColor=function(e,t){return this.isPolicy2&&null!==e?(e.color2=t,e.color2):null!==e?(e.color=t,e.color):null},t.prototype.off=function(e){return this.isPolicy2?null!==e?e.off2:0:null!==e?e.off:0},t.prototype.setOff=function(e,t){return this.isPolicy2&&null!==e?(e.off2=t,e.off2):null!==e?(e.off=t,e.off):0},t.prototype.len=function(e){return null!==e?e.len:0},t.prototype.setLen=function(e,t){return null!==e?(e.len=t,e.len):0},t.prototype.findForInsertFloat=function(e,t,n){var r=this.parent(e);if(r===e)return e;for(var o=e,i=t;r;)if(this.off(r)<i+n){if(i<this.off(r)+this.len(r))return null;i-=this.off(r),r=this.right(r)}else o=r,r=this.left(r);return o},t.prototype.findForInsertSpace=function(e,t){var n=t,r=this.parent(e);if(r===e)return new C(e,!0,n);for(;;)if(this.off(r)<n){if(n<this.off(r)+this.len(r))return new C(r,!1,n-this.off(r));if(n-=this.off(r),!this.right(r))return r=this.next(r),new C(r,!0,n);r=this.right(r)}else{if(!this.left(r))return new C(r,!0,n);r=this.left(r)}},t.prototype.insertFloat=function(t,n,r){return e.prototype.insertToRight.call(this,t,n,r)},t.prototype.insertSpaceBefore=function(e,t,n){var r=t;this.setOff(r,this.off(r)+n);for(var o=this.parent(r);o!==e;)this.left(o)===r&&this.setOff(o,this.off(o)+n),r=o,o=this.parent(r)},t.prototype.eraseSpaceBefore=function(e,t,n){var r=t;this.setOff(r,this.off(r)-n);for(var o=this.parent(r);o!==e;)this.left(o)===r&&this.setOff(o,this.off(o)-n),r=o,o=this.parent(r)},t.prototype.find=function(e,t){var n=this.parent(e);if(n===e)return{node:null,off:0};for(var r=t;n;)if(r<this.off(n))n=this.left(n);else{if(r<this.off(n)+this.len(n))return{node:n,off:r-this.off(n)};r-=this.off(n),n=this.right(n)}return{node:null,off:0}},t.prototype.position=function(e,t){var n=e,r=this.off(n);if(void 0!==t)for(var o=this.parent(n);o!==t;o=this.parent(o))this.right(o)===n&&(r+=this.off(o)),n=o;else for(o=this.parent(n);!this.isHeader(o);o=this.parent(o))this.right(o)===n&&(r+=this.off(o)),n=o;return r},t.prototype.rotateLeft=function(t,n){var r=this.right(n);this.setOff(r,this.off(r)+this.off(n)),e.prototype.rotateLeft.call(this,t,n)},t.prototype.rotateRight=function(t,n){var r=this.left(n);this.setOff(n,this.off(n)-this.off(r)),e.prototype.rotateRight.call(this,t,n)},t.prototype.eraseSwap=function(t,n){for(var r=this.right(n);this.left(r);)r=this.left(r);var o=this.off(r);this.setOff(r,this.off(n)+o),this.setOff(n,0);for(var i=this.parent(r);i!==n;i=this.parent(i))this.setOff(i,this.off(i)-o);e.prototype.eraseSwap.call(this,t,n)},t.prototype.eraseCut=function(t,n){if(this.right(n))for(var r=this.off(n),o=this.right(n);o;o=this.left(o))this.setOff(o,this.off(o)+r);e.prototype.eraseCut.call(this,t,n)},t}(u),w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.resetHeader=function(){var e=this.header();this.policy1().setOff(e,0),this.policy2().setOff(e,0),this.policy1().reset(e,e,e,e,o.RED),this.policy2().reset(e,e,e,e,o.RED)},t.prototype._allocNode=function(){return new _},t.prototype.policy1=function(){return this._mirrorPolicy1||(this._mirrorPolicy1=new S),this._mirrorPolicy1},t.prototype.policy2=function(){return this._mirrorPolicy2||(this._mirrorPolicy2=new S(!0)),this._mirrorPolicy2},t.prototype.policy=function(){return this.policy1()},t.prototype.split=function(e,t){var n=this._allocNode();return this.policy().setLen(n,this.policy().len(e)-t),this.policy1().setOff(n,t),this.policy2().setOff(n,t),this.policy1().right(e)?this.policy1().insertLeft(this.header(),this.policy1().leftMostChild(this.policy1().right(e)),n):this.policy1().insertRight(this.header(),e,n),this.policy2().right(e)?this.policy2().insertLeft(this.header(),this.policy2().leftMostChild(this.policy2().right(e)),n):this.policy2().insertRight(this.header(),e,n),this.cutRight(e,t),n},t.prototype.cutLeft=function(e,t){this.policy().setLen(e,this.policy().len(e)-t),this.policy1().setOff(e,this.policy1().off(e)+t);for(var n=this.policy1().right(e);n;n=this.policy1().left(n))this.policy1().setOff(n,this.policy1().off(n)-t);for(this.policy2().setOff(e,this.policy2().off(e)+t),n=this.policy2().right(e);n;n=this.policy2().left(n))this.policy2().setOff(n,this.policy2().off(n)-t)},t.prototype.extendLeft=function(e,t){this.policy().setLen(e,this.policy().len(e)+t),this.policy1().setOff(e,this.policy1().off(e)-t);for(var n=this.policy1().right(e);n;n=this.policy1().left(n))this.policy1().setOff(n,this.policy1().off(n)+t);for(this.policy2().setOff(e,this.policy2().off(e)-t),n=this.policy2().right(e);n;n=this.policy2().left(n))this.policy2().setOff(n,this.policy2().off(n)+t)},t.prototype.cutRight=function(e,t){this.policy().setLen(e,t)},t.prototype.extendRight=function(e,t){this.policy().setLen(e,this.policy().len(e)+t)},t.prototype._eraseMapping=function(e){var t=this.policy1().position(e),n=this.policy2().position(e);return this.policy1().erase(this.header(),e),this.policy2().erase(this.header(),e),this.policy1().setOff(e,t),this.policy2().setOff(e,n),e},t.prototype._eraseSpace=function(e,t,n,r){var o,i,a=this,s=[],c=n.findForInsertSpace(this.header(),e);if(c.node===this.header())return s;if(c.bLeft)o=c.node;else{if(c.pos+t<n.len(c.node)){var l=this.split(c.node,c.pos+t);return this.cutRight(c.node,c.pos),n.eraseSpaceBefore(this.header(),l,t),s}this.cutRight(c.node,c.pos),o=n.next(c.node)}var u=n.findForInsertSpace(this.header(),e+t);if((i=u.node)!==this.header())if(u.bLeft){var d=n.prev(o);d!==this.header()&&n.position(i)===n.position(d)+n.len(d)+t&&r.position(i)===r.position(d)+r.len(d)&&(n.setLen(d,n.len(d)+n.len(i)),i=n.next(i))}else this.cutLeft(i,u.pos);for(;o!==i;o=n.next(o))s.push(o);return s.forEach((function(e){a._eraseMapping(e)})),i!==this.header()&&n.eraseSpaceBefore(this.header(),i,t),s},t.prototype.mapping=function(e,t,n){var r=this.policy1().findForInsertFloat(this.header(),e,n);if(!r)return null;var o=this.policy2().findForInsertFloat(this.header(),t,n);if(!o)return null;var i=this.policy1().position(r),a=this.policy2().position(o);if(r!==this.header()&&r===o&&i-n===e&&a-n===t)return this.extendLeft(r,n),r;var s=this.policy1().prev(r),c=this.policy2().prev(o),l=this.policy1().position(s),u=this.policy2().position(c);if(s!==this.header()&&s===c&&e-l===this.policy().len(s)&&t-u===this.policy().len(c))return this.extendRight(s,n),s;var d=this._allocNode();return this.policy().setLen(d,n),this.policy1().setOff(d,e-l),this.policy2().setOff(d,t-u),this.policy1().insertFloat(this.header(),s,d),this.policy2().insertFloat(this.header(),c,d),d},t.prototype.forwardMapping=function(e,t){var n=this.policy1().find(this.header(),e);return n.node?n.off+this.policy2().position(n.node,this.header()):t},t.prototype.backwardMapping=function(e,t){var n=this.policy2().find(this.header(),e);return n.node?n.off+this.policy1().position(n.node,this.header()):t},t.prototype.insertSpace1=function(e,t){var n=this.policy1().findForInsertSpace(this.header(),e);if(n.node!==this.header())if(n.bLeft)this.policy1().insertSpaceBefore(this.header(),n.node,t);else{var r=this.split(n.node,n.pos);this.policy1().insertSpaceBefore(this.header(),r,t)}},t.prototype.insertSpace2=function(e,t){var n=this.policy2().findForInsertSpace(this.header(),e);if(n.node!==this.header())if(n.bLeft)this.policy2().insertSpaceBefore(this.header(),n.node,t);else{var r=this.split(n.node,n.pos);this.policy2().insertSpaceBefore(this.header(),r,t)}},t.prototype.eraseSpace=function(e,t,n,r,o){var i=this._eraseSpace(e,t,n,r);o&&o(i)},t.prototype.eraseSpace1=function(e,t,n){return this.eraseSpace(e,t,this.policy1(),this.policy2(),n)},t.prototype.eraseSpace2=function(e,t,n){return this.eraseSpace(e,t,this.policy2(),this.policy1(),n)},t.prototype.forwardSpace=function(e,t,n){var r,o,i=[],a=this.policy1().find(this.header(),e);if(!a.node)return i;r=(c=this.policy2().position(a.node))+a.off,o=c+this.policy2().len(a.node),e+=t;var s,c,l=this.policy1().find(this.header(),e);l.node?s=(c=this.policy2().position(l.node))+l.off:(l.node=this.header(),s=n);for(var u=new b.IC(r,0),d=a.node;;){if(d===l.node){l.node!==this.header()?u.len=Math.min(o,s)-u.begin():u.len=o-u.begin(),i.push(u);break}if(u.len=o-u.begin(),i.push(u),(d=this.policy1().next(d))===this.header()){r=n,o=n;break}o=(r=this.policy2().position(d))+this.policy2().len(d),u=new b.IC(r,0)}return i},t}(p),E=function(e){function t(){var t=new _;return e.call(this,t)||this}return(0,i.__extends)(t,e),t}(w);!function(e){e[e.Normal=0]="Normal",e[e.BOF=1]="BOF",e[e.EOF=2]="EOF"}(f||(f={}));var x,T,R,I=function(){function e(e,t,n){void 0===n&&(n=!1),this.baseFloatTree=e,this.limitRange=t,this.baseIter=this.baseFloatTree.findOuter(this.limitRange.begin()),this.posFlag=f.Normal,this.isRawIter=n}return e.prototype.rangeBegin=function(){return this.baseFloatTree.position(this.baseIter.copy().prev())},e.prototype.rangeEnd=function(){return this.baseFloatTree.position(this.baseIter)},e.prototype.range=function(){var e=this.rangeBegin(),t=this.rangeEnd();return new b.IC(e,t-e)},e.prototype.rangeBeginFromIter=function(e){return this.baseFloatTree.position(e.copy().prev())},e.prototype.rangeEndFromIter=function(e){return this.baseFloatTree.position(e)},e.prototype.data=function(){return this.baseIter.data()},e.prototype.seek=function(e){var t=Math.min(Math.max(e,this.limitRange.begin()),this.limitRange.end());return this.baseIter=this.baseFloatTree.findOuter(t),this.posFlag=f.Normal,!0},e.prototype.isNextNotEnd=function(){var e=this.getRange().begin();return e>=0&&e<this.limitRange.end()&&this.baseIter.notEqual(this.baseFloatTree.end())},e.prototype.hasNext=function(){return!(this.posFlag&f.EOF)&&this.isNextNotEnd()},e.prototype.next=function(){if(this.posFlag&f.EOF)throw new Error("".concat(this.constructor," next out of bounds."));this.baseIter.next();var e=this.isNextNotEnd();return e||(this.posFlag|=f.EOF),e},e.prototype.isPrevNotEnd=function(){var e=this.getRange().end();return e>=0&&e>this.limitRange.begin()&&this.baseIter.notEqual(this.baseFloatTree.end())},e.prototype.hasPrev=function(){return!(this.posFlag&f.BOF)&&this.isPrevNotEnd()},e.prototype.prev=function(){if(this.posFlag&f.BOF)throw new Error("".concat(this.constructor," prev out of bounds."));this.baseIter.prev();var e=this.isPrevNotEnd();return e||(this.posFlag|=f.BOF),e},e.prototype.getRange=function(e){if(void 0===e&&(e=!1),this.posFlag&f.EOF)return b.IC.invalidRange();var t=this.range();return e&&(t=t.intersectRange(this.limitRange)),t},e.prototype.getLimitRange=function(){return this.limitRange.clone()},e.prototype.setLimitRange=function(e){this.limitRange.copyFrom(e),this.seek(e.begin())},e}(),P=function(){function e(e,t){this.createBaseIterator=e,this.dataFilter=t,this._floatTree=new m}return e.prototype.createIterator=function(e){return new I(this._floatTree,e)},e.prototype.insertFloat=function(t,n){var r;if(!(null===(r=this.dataFilter)||void 0===r?void 0:r.call(this,n)))if(n&&0===Math.floor(Math.random()*e.MaxSkipDistance)){var o=this._floatTree.findInner(t),i=o.data(),a=i?this._floatTree.position(o):0,s=t,c=this.createBaseIterator(new b.IC(a,s-a));c.seek(t-1);for(var l=1;c.prev()&&(!i||c.data()!==i.data);)l+=1;this._floatTree.insertFloat(t,{distance:l,data:n})}else{var u=this._floatTree.findOuter(t).data();u&&(u.distance+=1)}},e.prototype.eraseFloat=function(e){var t=this.createBaseIterator().rangeEndFromIter(e),n=this._floatTree.findOuter(t);this._floatTree.eraseFloat(n),this._updateDistance(t)},e.prototype.insertSpace=function(e,t){this._floatTree.insertSpace(e,t)},e.prototype.eraseSpace=function(e,t){var n=this;this._floatTree.eraseSpace(e,t,(function(){n._updateDistance(e)}))},e.prototype._updateDistance=function(e){var t=this._floatTree.findOuter(e);if(t.notEqual(this._floatTree.end())){for(var n=this._floatTree.position(this._floatTree.findInner(e)),r=this._floatTree.position(t),o=this.createBaseIterator(new b.IC(n,r-n)),i=0;o.hasNext();)i+=1,o.next();t.data().distance=i}},e.prototype.getIndexFast=function(e,t){if(t&&(t.isEmpty()||!t.isValid()))return 0;var n=this.createBaseIterator(t).getLimitRange(),r=new b.IC(0,e),o=this.createIterator(n.intersectRange(r)),i=0,a=o.getRange(!0).end();if(o.hasNext())for(i=this.getIndex(a,n);o.next()&&!o.getRange().contains(e);){var s=o.data();i+=(null==s?void 0:s.distance)||0,a=o.getRange().end()}var c=new b.IC(a,e-a);return i+=this.getIndex(e,n.intersectRange(c))},e.prototype.getIndex=function(e,t){if(t&&(t.isEmpty()||!t.isValid()))return 0;for(var n=new b.IC(0,e),r=0,o=this.createBaseIterator(t?t.intersectRange(n):n);o.hasNext()&&!o.getRange().contains(e);)r+=1,o.next();return r},e.prototype.getRangeFromIndexFast=function(e,t){var n;if(t&&(t.isEmpty()||!t.isValid()))return b.IC.invalidRange();var r=this.createBaseIterator(t).getLimitRange(),o=r.begin(),i=0,a=this.createIterator(r);if(a.hasNext()){if(i=this.getIndex(a.getRange(!0).end(),r),o=a.getRange().end(),e<=i)return this.getRangeFromIndex(e,r);for(;a.next();){var s=(null===(n=a.data())||void 0===n?void 0:n.distance)||0;if(i+s>e)break;i+=s,o=a.getRange().end()}}return this.getRangeFromIndex(e-i,new b.IC(o,r.end()-o))},e.prototype.getRangeFromIndex=function(e,t){if(t&&(t.isEmpty()||!t.isValid()))return b.IC.invalidRange();for(var n=0,r=this.createBaseIterator(t);r.hasNext()&&e!==n;)n+=1,r.next();return r.getRange()},e.MaxSkipDistance=100,e}(),O=n(71145),k=n(55307);function D(e){return e===x.Paged||e===x.ContinuousPaged}function M(e){return e===x.Paged}function A(e){return e===x.ContinuousPaged}!function(e){e[e.Paged=0]="Paged",e[e.Scroll=1]="Scroll",e[e.EnterpriseWeb=2]="EnterpriseWeb",e[e.ContinuousPaged=3]="ContinuousPaged",e[e.Web=4]="Web"}(x||(x={})),function(e){e[e.Normal=0]="Normal",e[e.PrintPreview=1]="PrintPreview",e[e.SnapPreview=2]="SnapPreview",e[e.RecordPreview=3]="RecordPreview",e[e.TranslatePreview=4]="TranslatePreview",e[e.PresentationPreview=5]="PresentationPreview"}(T||(T={})),function(e){e[e.Canvas=0]="Canvas",e[e.React=1]="React",e[e.Lite=2]="Lite"}(R||(R={}));var L,N,B,F,U=new function(){this.initZoom=1,this.layoutType=x.Scroll,this.docViewType=T.Normal,this.renderType=R.Canvas,this.uniqueId="",this.preview=!1,this.editable=!0,this.copyable=!0,this.isSSR=!1,this.isBlock=!1,this.isDragging=!1,this.usePermissionRangeMode=!1},H=n(36695),j=n(46886),G=n(50044);!function(e){e.PAGE="PAGE",e.NUM_PAGES="NUMPAGES",e.HYPERLINK="HYPERLINK",e.EMBED="EMBED",e.DATE="DATE",e.PAGE_REF="PAGEREF",e.MENTION_QQ="MENTION_QQ",e.MENTION_WXWORK="MENTION_WXWORK",e.MENTION="MENTION",e.TOC="TOC",e.ATTACHMENT="ATTACHMENT",e.DATE_REMINDER="DATE_REMINDER",e.MEMBER_CONTACT_CARD="MEMBER_CONTACT_CARD",e.GROUP_CONTACT_CARD="GROUP_CONTACT_CARD",e.WXWORK_CALENDER="WXWORK_CALENDER",e.WXWORK_MEETING="WXWORK_MEETING",e.WXWORK_GROUP_CHAT="WXWORK_GROUP_CHAT",e.WXWORK_APP="WXWORK_APP",e.WxWORK_COLD_START_BUTTON="WxWORK_COLD_START_BUTTON"}(N||(N={})),function(e){e.displayLayoutType="tdlt",e.layoutType="tdly",e.key="tdkey",e.width="tdw",e.height="tdh",e.lockAspectRatio="tdlar",e.padding="tdp",e.subtype="tdsub",e.independentRender="tdindr",e.isEscape="tdes",e.extendedData="tdext"}(B||(B={})),function(e){e.Text="text",e.Container="container"}(F||(F={}));var V,W=((L={}).normalLink=G.dL.Text,L.docLink=G.dL.Text,L.addonLink=G.dL.Text,L.calendar=G.dL.Text,L.database=G.dL.Text,L.attachment=G.dL.Text,L.addonHina=G.dL.Preview,L.addonIframe=G.dL.Preview,L.tdSheetIframe=G.dL.Preview,L.file=G.dL.Preview,L.location=G.dL.Preview,L.audio=G.dL.Preview,L.video=G.dL.Preview,L.preview=G.dL.Preview,L.text=G.dL.Text,L.inline=G.dL.Inline,L.card=G.dL.Card,L.iframe=G.dL.Preview,L.hina=G.dL.Preview,L[N.TOC]=G.dL.Text,L[N.PAGE]=G.dL.Inline,L[N.NUM_PAGES]=G.dL.Inline,L[N.HYPERLINK]=G.dL.Text,L[N.EMBED]=G.dL.Preview,L[N.DATE]=G.dL.Text,L[N.MENTION_QQ]=G.dL.Inline,L[N.MENTION_WXWORK]=G.dL.Inline,L[N.MENTION]=G.dL.Inline,L[N.ATTACHMENT]=G.dL.Inline,L[N.DATE_REMINDER]=G.dL.Inline,L[N.MEMBER_CONTACT_CARD]=G.dL.Inline,L[N.GROUP_CONTACT_CARD]=G.dL.Inline,L[N.WXWORK_CALENDER]=G.dL.Inline,L[N.WXWORK_MEETING]=G.dL.Inline,L[N.WXWORK_GROUP_CHAT]=G.dL.Inline,L[N.WXWORK_APP]=G.dL.Inline,L[N.WxWORK_COLD_START_BUTTON]=G.dL.Inline,L);!function(e){e.False="0",e.True="1"}(V||(V={}));var z,K=function(e){function t(t,n,r){void 0===r&&(r=!1);var o=e.call(this,t,n,r)||this;return!o.isValidCursor()&&e.prototype.hasNext.call(o)&&o.next(),o}return(0,i.__extends)(t,e),t.prototype.isValidCursor=function(e){return void 0===e&&(e=!1),!0},t.prototype.seek=function(t){var n=e.prototype.seek.call(this,t);return this.isValidCursor()||this.next(),n},t.prototype.hasNext=function(){var t=e.prototype.hasNext.call(this);return t&&!this.isValidCursor()&&(t=this.next()),t},t.prototype.next=function(){var t=e.prototype.next.call(this);return t&&!this.isValidCursor()&&(t=this.next()),t},t.prototype.hasPrev=function(){var t=e.prototype.hasPrev.call(this);return t&&!this.isValidCursor(!0)&&(t=this.prev()),t},t.prototype.prev=function(){var t=e.prototype.prev.call(this);return t&&!this.isValidCursor(!0)&&(t=this.prev()),t},t.prototype.getContentRange=function(e){return void 0===e&&(e=!1),this.getRange(e)},t.prototype.getOperationRange=function(){return new b.IC(this.getRange().end()-1,1)},t.prototype.getProperty=function(){return this.data()},t.prototype.getCloneProperty=function(){var e,t=this.data();return null!==(e=null==t?void 0:t.clone())&&void 0!==e?e:t},t.prototype.getPropertyType=function(){var e,t=null===(e=this.data())||void 0===e?void 0:e.propertyType;return t||null},t}(I),q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.isValidCursor=function(e){if(this.isRawIter)return!0;var t=this.getProperty();return!!t&&!t.isPlaceholder},t.prototype.getContentRange=function(t){void 0===t&&(t=!1);var n=b.IC.insetBoth(e.prototype.getRange.call(this),0,1);return t&&(n=n.intersectRange(this.limitRange)),n},t}(K),Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.isValidCursor=function(){var e;return!!this.isRawIter||!(null===(e=this.getProperty())||void 0===e?void 0:e.isBegin)},t.prototype.rangeBegin=function(){var t=e.prototype.rangeBegin.call(this);return this.isValidCursor()?Math.max(t-1,0):t},t.prototype.getContentRange=function(e){void 0===e&&(e=!1);var t=b.IC.inset(this.getRange(),1);return e&&(t=t.intersectRange(this.limitRange)),t},t}(K),Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t}(Y),Z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.isValidCursor=function(e){if(this.isRawIter)return!0;var t=this.getProperty();return!!t&&!t.isPlaceholder},t.prototype.getContentRange=function(t){void 0===t&&(t=!1);var n=b.IC.insetBoth(e.prototype.getRange.call(this),0,1);return t&&(n=n.intersectRange(this.limitRange)),n},t}(K),X=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t}(Y),J=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.getContentRange=function(t){void 0===t&&(t=!1);var n=b.IC.insetBoth(e.prototype.getRange.call(this),0,1);return t&&(n=n.intersectRange(this.limitRange)),n},t}(K),$=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.getContentRange=function(t){void 0===t&&(t=!1);var n=b.IC.insetBoth(e.prototype.getRange.call(this),0,1);return t&&(n=n.intersectRange(this.limitRange)),n},t}(K),ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.getOperationRange=function(){return this.getRange()},t}(K),te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.getContentRange=function(t){void 0===t&&(t=!1);var n=b.IC.insetBoth(e.prototype.getRange.call(this),0,1);return t&&(n=n.intersectRange(this.limitRange)),n},t}(K),ne=n(82557),re=n(30479),oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.getRange=function(t){var n,r;if(void 0===t&&(t=!1),this.posFlag&f.EOF)return b.IC.invalidRange();if((null===(n=this.getProperty())||void 0===n?void 0:n.fldCharType)!==ne.P1W.end||this.isRawIter)return e.prototype.getRange.call(this,t);var o=this.baseIter.copy().prev(),i=0;i=(null===(r=o.data())||void 0===r?void 0:r.fldCharType)===ne.P1W.separate?this.rangeBeginFromIter(o)-1:this.rangeBeginFromIter(this.baseIter.copy())-1;var a=this.rangeEnd();i<0&&(re.Logger.error("[FIELD ITERATOR] :",i,a),i=0);var s=new b.IC(i,a-i);return t&&(s=s.intersectRange(this.limitRange)),s},t.prototype.isValidCursor=function(e){if(void 0===e&&(e=!1),e||this.isRawIter)return!0;var t=this.getProperty();return!(t&&t.fldCharType!==ne.P1W.end)},t}(K),ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.getRange=function(){var e=this.range();return new b.IC(e.end()-1,1)},t}(K),ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t}(ie),se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t}(ie),ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t}(ie);!function(e){e[e.Span=0]="Span",e[e.Paragraph=1]="Paragraph",e[e.Section=2]="Section"}(z||(z={}));var le,ue=function(){function e(e,t,n,r,o){this._sectPosFlag=f.Normal,this._paraPosFlag=f.Normal,this._spanPosFlag=f.Normal,this._textStream=e,this._sectTable=t,this._paraTable=n,this._spanTable=r,this._limitRange=o,this._paraIter=this._paraTable.seek(this._limitRange.begin()),this._spanIter=this._spanTable.seek(this._limitRange.begin()),this._sectIter=this._sectTable.seek(this._limitRange.begin()),this._gcpTick=this._limitRange.begin()}return e.prototype.seek=function(e){return this._gcpTick=Math.max(e,this._limitRange.begin()),this._gcpTick=Math.min(this._gcpTick,this._limitRange.end()),this._paraIter=this._paraTable.seek(this._gcpTick),this._spanIter=this._spanTable.seek(this._gcpTick),this._sectIter=this._sectTable.seek(this._gcpTick),this._sectPosFlag=f.Normal,this._paraPosFlag=f.Normal,this._spanPosFlag=f.Normal,!0},e.prototype.getCurrentIndex=function(){return this._textStream.getIndexFromGCP(this._gcpTick)},e.prototype.hasNext=function(e){void 0===e&&(e=z.Span);var t=!1;switch(e){case z.Span:if(this._spanPosFlag&f.EOF)break;var n=this._spanTable.rangeBegin(this._spanIter);n>=0&&n<this._limitRange.end()&&this._spanIter.notEqual(this._spanTable.end())&&(t=!0);break;case z.Paragraph:if(this._paraPosFlag&f.EOF)break;var r=this._paraTable.rangeBegin(this._paraIter);r>=0&&r<this._limitRange.end()&&this._paraIter.notEqual(this._paraTable.end())&&(t=!0);break;case z.Section:if(this._sectPosFlag&f.EOF)break;var o=this._sectTable.rangeBegin(this._sectIter);o>=0&&o<this._limitRange.end()&&this._sectIter.notEqual(this._sectTable.end())&&(t=!0)}return t},e.prototype.next=function(e){void 0===e&&(e=z.Span);var t=!1;switch(e){case z.Span:if(this._spanPosFlag&f.EOF)throw new Error("DataIterator next span out of bounds.");var n=this._spanTable.rangeEnd(this._spanIter);if(n<this._limitRange.end()){if(this._spanIter.next(),this._spanIter.equal(this._spanTable.end())){this._spanPosFlag|=f.EOF,t=!0;break}n===this._paraTable.rangeEnd(this._paraIter)&&this._paraIter.next(),n===this._sectTable.rangeEnd(this._sectIter)&&this._sectIter.next(),this._gcpTick=n}else this._spanPosFlag|=f.EOF,t=!0;break;case z.Paragraph:if(this._paraPosFlag&f.EOF)throw new Error("DataIterator next paragraph out of bounds.");var r=this._paraTable.rangeEnd(this._paraIter);if(r<this._limitRange.end()){if(this._paraIter.next(),this._paraIter.equal(this._paraTable.end())){this._paraPosFlag|=f.EOF,t=!0;break}this._spanIter=this._spanTable.seek(r),r===this._sectTable.rangeEnd(this._sectIter)&&this._sectIter.next(),this._gcpTick=r}else this._paraPosFlag|=f.EOF,t=!0;break;case z.Section:if(this._sectPosFlag&f.EOF)throw new Error("DataIterator next section out of bounds.");var o=this._sectTable.rangeEnd(this._sectIter);if(o<this._limitRange.end()){if(this._sectIter.next(),this._sectIter.equal(this._sectTable.end())){this._sectPosFlag|=f.EOF,t=!0;break}this._paraIter=this._paraTable.seek(this._gcpTick),this._spanIter=this._spanTable.seek(this._gcpTick),this._gcpTick=o}else this._sectPosFlag|=f.EOF,t=!0}return!t},e.prototype.hasPrev=function(e){void 0===e&&(e=z.Span);var t=!1;switch(e){case z.Span:if(this._spanPosFlag&f.BOF)break;var n=this._spanTable.rangeEnd(this._spanIter);n>=0&&n>=this._limitRange.begin()&&this._spanIter.notEqual(this._spanTable.end())&&(t=!0);break;case z.Paragraph:if(this._paraPosFlag&f.BOF)break;var r=this._paraTable.rangeEnd(this._paraIter);r>=0&&r>=this._limitRange.begin()&&this._paraIter.notEqual(this._paraTable.end())&&(t=!0);break;case z.Section:if(this._sectPosFlag&f.BOF)break;var o=this._sectTable.rangeEnd(this._sectIter);o>=0&&o>=this._limitRange.begin()&&this._sectIter.notEqual(this._sectTable.end())&&(t=!0)}return t},e.prototype.prev=function(e){void 0===e&&(e=z.Span);var t=!1;switch(e){case z.Span:if(this._spanPosFlag&f.BOF)throw new Error("DataIterator prev span out of bounds.");var n=this._spanTable.rangeBegin(this._spanIter);if(n>this._limitRange.begin()){if(this._spanIter.prev(),this._spanIter.equal(this._spanTable.end())){this._spanPosFlag|=f.BOF,t=!0;break}n===this._paraTable.rangeBegin(this._paraIter)&&this._paraIter.prev(),n===this._sectTable.rangeBegin(this._sectIter)&&this._sectIter.prev(),this._gcpTick=this._spanTable.rangeBegin(this._spanIter)}else this._spanPosFlag|=f.BOF,t=!0;break;case z.Paragraph:if(this._paraPosFlag&f.BOF)throw new Error("DataIterator prev paragraph out of bounds.");var r=this._paraTable.rangeBegin(this._paraIter);if(r>this._limitRange.begin()){if(this._paraIter.prev(),this._paraIter.equal(this._paraTable.end())){this._paraPosFlag|=f.BOF,t=!0;break}r===this._sectTable.rangeBegin(this._sectIter)&&this._sectIter.prev(),this._gcpTick=this._paraTable.rangeBegin(this._paraIter),this._spanIter=this._spanTable.seek(this._gcpTick)}else this._paraPosFlag|=f.BOF,t=!0;break;case z.Section:if(this._sectPosFlag&f.BOF)throw new Error("DataIterator prev section out of bounds.");if(this._sectTable.rangeBegin(this._sectIter)>this._limitRange.begin()){if(this._sectIter.prev(),this._sectIter.equal(this._sectTable.end())){this._sectPosFlag|=f.BOF,t=!0;break}this._gcpTick=this._sectTable.rangeBegin(this._sectIter),this._paraIter=this._paraTable.seek(this._gcpTick),this._spanIter=this._spanTable.seek(this._gcpTick)}else this._sectPosFlag|=f.BOF,t=!0}return!t},e.prototype.getRange=function(e,t){void 0===e&&(e=z.Span),void 0===t&&(t=!1);var n=new b.IC(0,0);switch(e){case z.Span:if(this._spanPosFlag&f.EOF)break;n=this._spanTable.range(this._spanIter),t&&(n=n.intersectRange(this._limitRange));break;case z.Paragraph:if(this._paraPosFlag&f.EOF)break;n=this._paraTable.range(this._paraIter),t&&(n=n.intersectRange(this._limitRange));break;case z.Section:if(this._sectPosFlag&f.EOF)break;n=this._sectTable.range(this._sectIter),t&&(n=n.intersectRange(this._limitRange))}return n},e.prototype.getSpanProp=function(e){void 0===e&&(e=!1);var t=this._spanIter.data();return t&&!e&&(t=t.clone()),t},e.prototype.getParaProp=function(e){void 0===e&&(e=!1);var t=this._paraIter.data();return t&&!e&&(t=t.clone()),t},e.prototype.getSectProp=function(e){void 0===e&&(e=!1);var t=this._sectIter.data();return t&&!e&&(t=t.clone()),t},e.prototype.getLimitRange=function(){return this._limitRange.clone()},e.prototype.setLimitRange=function(e){if(e.contains(this._limitRange)){this._limitRange.copyFrom(e);var t=this._spanTable.range(this._spanIter);t.end()>e.end()&&(this._spanPosFlag&=~f.EOF),t.begin()<e.begin()&&(this._spanPosFlag&=~f.BOF);var n=this._paraTable.range(this._paraIter);n.end()>e.end()&&(this._paraPosFlag&=~f.EOF),n.begin()<e.begin()&&(this._paraPosFlag&=~f.BOF);var r=this._sectTable.range(this._sectIter);r.end()>e.end()&&(this._sectPosFlag&=~f.EOF),r.begin()<e.begin()&&(this._sectPosFlag&=~f.BOF)}else this._limitRange.copyFrom(e),this.seek(e.begin())},e.prototype.rangeExpand=function(e){var t=this._limitRange.backwardExpand(e);this.setLimitRange(t)},e}(),de=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t}(ie),pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t}(Y),he=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t}(Y),fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.getOperationRange=function(){return this.getRange()},t}(K),ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t}(Y),ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t}(ie),ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t}(ie);!function(e){e.InsertText="InsertText",e.DeleteText="DeleteText",e.RunChange="runChange",e.ParaChange="ParaChange",e.SectChange="SectChange",e.StoryChange="StoryChange",e.SubStoryChange="SubStoryChange",e.DrawingChange="DrawingChange",e.PictureChange="PictureChange",e.EmbeddedObjectChange="EmbeddedObjectChange",e.FootnoteChange="FootnoteChange",e.EndnoteChange="EndnoteChange",e.FieldChange="FieldChange",e.CommentChange="CommentChange",e.TableChange="TableChange",e.TableRowChange="TableRowChange",e.TableCellChange="TableCellChange",e.MathChange="MathChange",e.MathObjectChange="MathObjectChange",e.MathRunChange="MathRunChange",e.SdtChange="SdtChange",e.InsertCommentRange="InsertCommentRange",e.DeleteCommentRange="DeleteCommentRange",e.InsertBookmarkRange="InsertBookmarkRange",e.DeleteBookmarkRange="DeleteBookmarkRange",e.InsertPermissionRange="InsertPermissionRange",e.DeletePermissionRange="DeletePermissionRange",e.InsertQuoteRange="InsertQuoteRange",e.DeleteQuoteRange="DeleteQuoteRange",e.InsertRevisionRange="InsertRevisionRange",e.DeleteRevisionRange="DeleteRevisionRange",e.DeletePara="DeletePara",e.DeleteSect="DeleteSect",e.DeleteSubStory="DeleteSubStory",e.DeleteField="DeleteField",e.DeleteDrawing="DeleteDrawing",e.DeleteComment="DeleteComment",e.DeleteTable="DeleteTable",e.DeleteTableRow="DeleteTableRow",e.DeleteTableCell="DeleteTableCell",e.DeletePicture="DeletePicture",e.DeleteEmbeddedObject="DeleteEmbeddedObject"}(le||(le={}));var me,be=function(e){function t(t,n){var r=e.call(this,le.InsertCommentRange)||this;return r.range=t,r.commentRangeProp=n,r}return(0,i.__extends)(t,e),t}(re.Notification),_e=function(e){function t(t){var n=e.call(this,le.DeleteCommentRange)||this;return n.id=t,n}return(0,i.__extends)(t,e),t}(re.Notification),Ce=(function(e){function t(t,n){var r=e.call(this,le.InsertBookmarkRange)||this;return r.range=t,r.bookmarkRangeProp=n,r}(0,i.__extends)(t,e)}(re.Notification),function(e){function t(t){var n=e.call(this,le.DeleteBookmarkRange)||this;return n.id=t,n}(0,i.__extends)(t,e)}(re.Notification),function(e){function t(t,n){var r=e.call(this,le.InsertPermissionRange)||this;return r.range=t,r.permissionRangeProp=n,r}return(0,i.__extends)(t,e),t}(re.Notification)),Se=function(e){function t(t){var n=e.call(this,le.DeletePermissionRange)||this;return n.id=t,n}return(0,i.__extends)(t,e),t}(re.Notification),we=function(e){function t(t,n){var r=e.call(this,le.InsertRevisionRange)||this;return r.range=t,r.revisionRangeProp=n,r}return(0,i.__extends)(t,e),t}(re.Notification),Ee=function(e){function t(t){var n=e.call(this,le.DeleteRevisionRange)||this;return n.id=t,n}return(0,i.__extends)(t,e),t}(re.Notification),xe=function(e){function t(t,n){var r=e.call(this,t)||this;return r.propList=n,r}return(0,i.__extends)(t,e),t}(re.Notification),Te=function(e){function t(t,n,r){var o=e.call(this,le.InsertText)||this;return o.range=t,o.text=n,o.optAuthor=r||"",o}return(0,i.__extends)(t,e),t}(re.Notification),Re=function(e){function t(t,n){var r=e.call(this,le.DeleteText)||this;return r.range=t,r.optAuthor=n||"",r}return(0,i.__extends)(t,e),t}(re.Notification),Ie=function(e){function t(t,n,r,o){var i=e.call(this,r)||this;return i.range=t,i.updateMode=n,i.isInputDoc=o,i}return(0,i.__extends)(t,e),t}(re.Notification),Pe=function(e){function t(t,n,r,o){var i=e.call(this,t,r,o)||this;return i.fieldProperty=n,i}return(0,i.__extends)(t,e),t}(Ie),Oe=(function(e){function t(t){var n=e.call(this,le.InsertQuoteRange)||this;return n.id=t,n}(0,i.__extends)(t,e)}(re.Notification),function(e){function t(t){var n=e.call(this,le.DeleteQuoteRange)||this;return n.id=t,n}(0,i.__extends)(t,e)}(re.Notification),function(){function e(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!0),this.async=!0,this.dataMap=new Map,this.notificationCenter=e,this.needReservedWhenEraseSpace=t,this.async=n,this.addListener()}return e.prototype.destroy=function(){this.destroyListener(),this.changeCallback=void 0},e.prototype.onChange=function(e){this.changeCallback=e},e.prototype.removeAll=function(){this.dataMap.clear()},e.prototype.getValue=function(e){return this.dataMap.get(e)},e.prototype.hasValue=function(e){return this.hasKey(e)},e.prototype.setNotificationCenter=function(e){this.notificationCenter=e,this.destroyListener(),this.addListener()},e.prototype.setValue=function(e,t){this.dataMap.set(e,void 0===t?null:t)},e.prototype.hasKey=function(e){return this.dataMap.has(e)},e.prototype.deleteKey=function(e){return this.dataMap.delete(e)},e.prototype.addListener=function(){var e=this;this.notificationCenter&&(this.notificationCenter.on(le.InsertText,(function(t){e.insertSpace(t.range),e.changeCallback&&e.changeCallback()}),this.async,this),this.notificationCenter.on(le.DeleteText,(function(t){e.eraseSpace(t.range),e.changeCallback&&e.changeCallback()}),this.async,this))},e.prototype.destroyListener=function(){this.notificationCenter&&(this.notificationCenter.removeListener(le.InsertText,this),this.notificationCenter.removeListener(le.DeleteText,this))},e}()),ke=function(e){function t(t,n,r,o){void 0===n&&(n=!1),void 0===r&&(r=!0),void 0===o&&(o=s.Outer);var i=e.call(this,t,n,r)||this;return i.cache=new Map,i.needNotificationFieldCode=!0,i.posPolicy=o,i.floatTree=new m(o),i}return(0,i.__extends)(t,e),t.prototype.insertSpace=function(e){this.cache.clear(),this.floatTree.insertSpace(e.begin(),e.length())},t.prototype.eraseSpace=function(e){var t=this;this.cache.clear(),this.floatTree.eraseSpace(e.begin(),e.length(),(function(n){if(t.needReservedWhenEraseSpace||t.eraseList){var r=[];n.forEach((function(n){n.data.forEach((function(n){t.needReservedWhenEraseSpace?t.insertGCP(n,e.begin()):r.push(n)}))})),t.eraseList&&t.needNotificationFieldCode&&t.eraseList(r)}}))},t.prototype.onEraseList=function(e){this.eraseList=e},t.prototype.removeAll=function(){e.prototype.removeAll.call(this),this.floatTree=new m(this.posPolicy)},t.prototype.containGCP=function(e){return this.hasKey(e)},t.prototype.insertGCP=function(e,t,n){if(t<0)return!1;if(this.getGCP(e))return!1;var r=e,o=[r],i=this.getFTTreeIterator(t),a=i.data();return a&&this.floatTree.position(i)===t?a.push(r):this.floatTree.insertFloat(t,o),this.setValue(e,n),!0},t.prototype.getGCP=function(e){var t,n=this;if(this.containGCP(e)){var r=this.cache.get(e);if(void 0!==r)return r;this.forEachGCP((function(r){return n.cache.set(r.key,r.gcp),r.key===e&&(t=r.gcp,!0)}))}return t},t.prototype.deleteGCP=function(e){var t=this.getGCP(e);if(void 0===t)return!1;var n=!1,r=this.getFTTreeIterator(t),o=r.data();if(o)for(var i=0;i<o.length;i++)if(o[i]===e){o.splice(i,1),0===o.length&&this.floatTree.eraseFloat(r),this.deleteKey(e),n=!0;break}return n},t.prototype.findGCPs=function(){var e=[];return this.forEachGCP((function(t){return e.push(t),!1})),e},t.prototype.forEachGCP=function(e){for(var t=this.floatTree.begin();!t.equal(this.floatTree.end());t.next()){var n=t.data();if(!n)return;for(var r=this.floatTree.position(t),o=0;o<n.length;o++)if(e({gcp:r,key:n[o]}))return}},t.prototype.getFTTreeIterator=function(e){return this.posPolicy===s.Inner?this.floatTree.findOuter(e):this.floatTree.findInner(e)},t}(Oe);function De(e){return{pointType:e.pointType,key:e.key,pos:e.pos}}!function(e){e[e.Begin=0]="Begin",e[e.End=1]="End"}(me||(me={}));var Me=function(e){function t(t,n,r,o){void 0===n&&(n=!1),void 0===r&&(r=!0),void 0===o&&(o=s.Outer);var i=e.call(this,t,n,r)||this;return i.posPolicy=o,i.floatTree=new m(o),i}return(0,i.__extends)(t,e),t.prototype.insertSpace=function(e){this.floatTree.insertSpace(e.begin(),e.length())},t.prototype.eraseSpace=function(e){var t=this;this.floatTree.eraseSpace(e.begin(),e.length(),(function(n){var r=new Map,o=[],a=[];n.forEach((function(e){for(var n=e.data,i=0;i<n.length;i++){var s=n[i],c=s.key,l=r.get(c);l?(r.delete(c),t.needReservedWhenEraseSpace?o.push(l,s):t.eraseList&&a.push(c)):r.set(c,s)}})),r.forEach((function(e){o.push(e)}));var s=t.floatTree.findInner(e.begin()),c=s.data();c&&t.floatTree.position(s)===e.begin()?c.push.apply(c,(0,i.__spreadArray)([],(0,i.__read)(o),!1)):t.floatTree.insertFloat(e.begin(),o),t.eraseList&&t.eraseList(a)}))},t.prototype.onEraseList=function(e){this.eraseList=e},t.prototype.removeAll=function(){e.prototype.removeAll.call(this),this.floatTree=new m(this.posPolicy)},t.prototype.containRange=function(e){return this.hasKey(e)},t.prototype.insertRange=function(e,t,n){if(!t.isValid())return!1;if(this.hasKey(e))return!1;var r={pointType:me.Begin,key:e},o=[r],i=this.floatTree.findInner(t.begin()),a=i.data();a&&this.floatTree.position(i)===t.begin()?a.push(r):this.floatTree.insertFloat(t.begin(),o);var s={pointType:me.End,key:e};o=[s];var c=this.floatTree.findInner(t.end()),l=c.data();return l&&this.floatTree.position(c)===t.end()?l.push(s):this.floatTree.insertFloat(t.end(),o),this.setValue(e,n),!0},t.prototype.getRange=function(e){var t;return this.containRange(e)&&this.forEachRange((function(n){return n.key[0]===e&&(t=n.range,!0)})),t},t.prototype.deleteRange=function(e){var t=this.getRange(e);if(t)return this.deletePoint(e,t.begin(),me.Begin),this.deletePoint(e,t.end(),me.End),this.deleteKey(e),t},t.prototype.collectAllRanges=function(e){void 0===e&&(e=!1);var t=[];return this.forEachRange((function(e){return t.push(e),!1}),e),t},t.prototype.collectRangesFromGcp=function(e,t){return void 0===t&&(t=!1),this.collectRangesFromGcpOrRange(e,t)},t.prototype.collectRangesFromRange=function(e,t){return void 0===t&&(t=!1),this.collectRangesFromGcpOrRange(e,t)},t.prototype.collectRangesFromGcpOrRange=function(e,t){var n=this,r=[];return this.forEachRange((function(t){return e instanceof b.IC&&!t.range.intersect(e)||!(e instanceof b.IC)&&!t.range.contains(e)||t.key.forEach((function(e){n.getValue(e)&&r.push(t)})),!1}),t),r},t.prototype.forEachRange=function(e,t){void 0===t&&(t=!1);var n=this.floatTree.findInner(0);n.equal(this.floatTree.end())&&(n=this.floatTree.findOuter(0));var r=new Map,o=null,i=[];do{var a=n.data(),s=this.floatTree.position(n);if(a){for(var c=0;c<a.length;c++){var l=De(a[c]);l.pos=s;var u=l.key,d=r.get(u);if(d){var p=-1,h=-1;if(d.pointType===me.Begin&&l.pointType===me.End&&void 0!==d.pos?(p=d.pos,h=l.pos):l.pointType===me.Begin&&d.pointType===me.End&&void 0!==d.pos&&(p=l.pos,h=d.pos),p>=0&&h>=0){var f=new b.IC(p,h-p);if(t)o=o?o.unionRange(f):f,i.push(l.key);else if(e({range:f,key:[l.key]}))return}r.delete(u)}else r.set(u,l)}if(t&&0===r.size&&o){if(e({range:o,key:i}))return;o=null,i=[]}}n.next()}while(!n.equal(this.floatTree.end()))},t.prototype.deletePoint=function(e,t,n){var r=!1,o=this.floatTree.findInner(t),i=o.data();if(i)for(var a=0;a<i.length;a++){var s=i[a];if(s.key===e&&s.pointType===n){i.splice(a,1),0===i.length&&this.floatTree.eraseFloat(o),r=!0;break}}return r},t}(Oe);function Ae(e){return{key:e.key,pos:e.pos}}var Le=function(e){function t(t,n,r,o){void 0===n&&(n=!1),void 0===r&&(r=!0),void 0===o&&(o=s.Outer);var i=e.call(this,t,n,r)||this;return i.posPolicy=o,i.leftSideFloatTree=new m(o),i.rightSideFloatTree=new m(o),i}return(0,i.__extends)(t,e),t.prototype.insertSpace=function(e){this.leftSideFloatTree.insertSpace(e.begin(),e.length()),this.rightSideFloatTree.insertSpace(e.begin(),e.length())},t.prototype.eraseSpace=function(e){var t=this,n=[];this.leftSideFloatTree.eraseSpace(e.begin(),e.length(),(function(e){n=e}));var r=[];this.rightSideFloatTree.eraseSpace(e.begin(),e.length(),(function(e){r=e}));var o=new Map;n.forEach((function(e){for(var t=e.data,n=0;n<t.length;n++){var r=t[n],i=r.key;o.set(i,r)}}));var a=[],s=[],c=[];function l(t,n){var r=t.findInner(e.begin()),o=r.data();o&&t.position(r)===e.begin()?o.push.apply(o,(0,i.__spreadArray)([],(0,i.__read)(n),!1)):t.insertFloat(e.begin(),n)}r.forEach((function(e){for(var n=e.data,r=0;r<n.length;r++){var i=n[r],l=i.key,u=o.get(l);u?(o.delete(l),t.needReservedWhenEraseSpace?(a.push(u),s.push(i)):t.eraseList&&c.push(l)):s.push(i)}})),o.forEach((function(e){a.push(e)})),l(this.leftSideFloatTree,a),l(this.rightSideFloatTree,s),this.eraseList&&this.eraseList(c)},t.prototype.onEraseList=function(e){this.eraseList=e},t.prototype.removeAll=function(){e.prototype.removeAll.call(this),this.leftSideFloatTree=new m(this.posPolicy),this.rightSideFloatTree=new m(this.posPolicy)},t.prototype.containRange=function(e){return this.hasKey(e)},t.prototype.insertRange=function(e,t,n){if(!t.isValid())return!1;if(this.getRange(e))return!1;var r={key:e},o=[r],i=this.leftSideFloatTree.findInner(t.begin()),a=i.data();a&&this.leftSideFloatTree.position(i)===t.begin()?a.push(r):this.leftSideFloatTree.insertFloat(t.begin(),o);var s={key:e};o=[s];var c=this.rightSideFloatTree.findInner(t.end()),l=c.data();return l&&this.rightSideFloatTree.position(c)===t.end()?l.push(s):this.rightSideFloatTree.insertFloat(t.end(),o),this.setValue(e,n),!0},t.prototype.getRange=function(e){var t;return this.containRange(e)&&this.forEachRange((function(n){return n.key[0]===e&&(t=n.range,!0)})),t},t.prototype.deleteRange=function(e){var t=this.getRange(e);if(t)return this.deletePoint(e,t.begin(),this.leftSideFloatTree),this.deletePoint(e,t.end(),this.rightSideFloatTree),this.deleteKey(e),t},t.prototype.collectAllRanges=function(e){void 0===e&&(e=!1);var t=[];return this.forEachRange((function(e){return t.push(e),!1}),e),t},t.prototype.collectRangesFromGcp=function(e,t){var n=[];return this.forEachRangeFromStartGcp((function(e){return n.push(e),!(!t||!t(e))}),e),n},t.prototype.collectRangesFromRange=function(e,t){return void 0===t&&(t=!1),this.collectRangesFromGcpOrRange(e,t)},t.prototype.collectRangesFromGcpOrRange=function(e,t){var n=[];return this.forEachRange((function(t){return e instanceof b.IC&&!t.range.intersect(e)||!(e instanceof b.IC)&&!t.range.contains(e)||n.push(t),!1}),t),n},t.prototype.forEachRange=function(e,t){var n,r;function o(e){var t=e.findInner(0);return t.equal(e.end())&&(t=e.findOuter(0)),t}void 0===t&&(t=!1);var a=new Map,s=o(this.leftSideFloatTree),c=function(){var e=s.data();if(!e)return s.next(),"continue";var t=l.leftSideFloatTree.position(s);e.forEach((function(e){var n=Ae(e);n.pos=t,a.set(n.key,n)})),s.next()},l=this;do{c()}while(!s.equal(this.leftSideFloatTree.end()));var u=o(this.rightSideFloatTree);do{var d=u.data();if(d){var p=this.rightSideFloatTree.position(u);try{for(var h=(n=void 0,(0,i.__values)(d)),f=h.next();!f.done;f=h.next()){var g=Ae(f.value);g.pos=p;var v=a.get(g.key);if(v&&void 0!==v.pos&&e({range:new b.IC(v.pos,g.pos-v.pos),key:[g.key]}))return}}catch(e){n={error:e}}finally{try{f&&!f.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}u.next()}else u.next()}while(!u.equal(this.rightSideFloatTree.end()))},t.prototype.forEachRangeFromStartGcp=function(e,t){var n,r,o,a,s=new Map,c=this.leftSideFloatTree.findInner(t),l=new Map,u=this.rightSideFloatTree.findInner(t),d=this.rightSideFloatTree.position(u);for((u.equal(this.rightSideFloatTree.end())||d!==t)&&(u=this.rightSideFloatTree.findOuter(t));!u.equal(this.rightSideFloatTree.end())&&!c.equal(this.leftSideFloatTree.end());){var p=c.data();if(!p)break;var h=u.data();if(!h)break;var f=this.leftSideFloatTree.position(c);try{for(var g=(n=void 0,(0,i.__values)(p)),v=g.next();!v.done;v=g.next()){(w=Ae(v.value)).pos=f;var y=l.get(w.key);if(y&&void 0!==y.pos){var m=new b.IC(w.pos,y.pos-w.pos);if(this.contains(m,t)&&e({range:m,key:[w.key]}))return;l.delete(w.key)}else s.set(w.key,w)}}catch(e){n={error:e}}finally{try{v&&!v.done&&(r=g.return)&&r.call(g)}finally{if(n)throw n.error}}var _=this.rightSideFloatTree.position(u);try{for(var C=(o=void 0,(0,i.__values)(h)),S=C.next();!S.done;S=C.next()){var w;(w=Ae(S.value)).pos=_;var E=s.get(w.key);if(E&&void 0!==E.pos){if(m=new b.IC(E.pos,w.pos-E.pos),this.contains(m,t)&&e({range:m,key:[w.key]}))return;s.delete(w.key)}else l.set(w.key,w)}}catch(e){o={error:e}}finally{try{S&&!S.done&&(a=C.return)&&a.call(C)}finally{if(o)throw o.error}}c.prev(),u.next()}},t.prototype.deletePoint=function(e,t,n){var r=!1,o=n.findInner(t),i=o.data();if(i)for(var a=0;a<i.length;a++)if(i[a].key===e){i.splice(a,1),0===i.length&&n.eraseFloat(o),r=!0;break}return r},t.prototype.contains=function(e,t){if(0===e.len)return e.begin()===t;var n=t,r=t,o=!1;return e.begin()<=n&&(r<e.end()||r===e.end()&&n!==r)&&(o=!0),o},t}(Oe),Ne=function(){function e(){}return e.isInsertPropType=function(e,t,n){return e===G.XS.Insert||!n.isExistNode(t)},e}(),Be=function(){function e(e){this.textPool=e}return e.prototype.checkValidityGCP=function(e){return e>=0&&e<=this.getLength()},e.prototype.getLength=function(){return this.textPool.size()-1},e.prototype.validRange=function(e){var t=new b.IC(0,this.getLength());return e&&(t=e.intersectRange(t)),t},e.prototype.constraintToValidityLength=function(e,t){return Math.min(t,this.getLength()-e)},e.prototype.constraintToValidityGcp=function(e){return Math.min(e,this.getLength())},e.prototype.setPropCommon=function(e,t,n,r,o,i){if(!Ne.isInsertPropType(r,t+n,e))return e.modifyProp(t,n,r,o,i);e.insertProp(t+n,o)},e}(),Fe=n(97079),Ue=function(e){function t(t,n,r){void 0===n&&(n=s.Outer),void 0===r&&(r=c.Forbid);var o=e.call(this,n,r)||this;return t&&(o.skipList=new P(t,o.dataFilter)),o}return(0,i.__extends)(t,e),t.prototype.dataFilter=function(e){return!e},t.prototype.openSkipList=function(e){this.skipList=new P(e,this.dataFilter)},t.prototype.insertFloat=function(t,n){var r,o=e.prototype.insertFloat.call(this,t,n);return null===(r=this.skipList)||void 0===r||r.insertFloat(t,n),o},t.prototype.insertSpace=function(t,n){var r;e.prototype.insertSpace.call(this,t,n),null===(r=this.skipList)||void 0===r||r.insertSpace(t,n)},t.prototype.eraseSpace=function(t,n,r){var o;e.prototype.eraseSpace.call(this,t,n,r),null===(o=this.skipList)||void 0===o||o.eraseSpace(t,n)},t.prototype.eraseFloat=function(t){var n;e.prototype.eraseFloat.call(this,t),null===(n=this.skipList)||void 0===n||n.eraseFloat(t)},t.prototype.getIndexFast=function(e,t){if(this.skipList)return this.skipList.getIndexFast(e,t);throw new Error("getIndexFast skipList undefined")},t.prototype.getIndex=function(e,t){if(this.skipList)return this.skipList.getIndex(e,t);throw new Error("getIndex skipList undefined")},t.prototype.getRangeFromIndexFast=function(e,t){if(this.skipList)return this.skipList.getRangeFromIndexFast(e,t);throw new Error("getRangeFromIndexFast skipList undefined")},t.prototype.getRangeFromIndex=function(e,t){if(this.skipList)return this.skipList.getRangeFromIndex(e,t);throw new Error("getRangeFromIndex skipList undefined")},t}(m),He=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.seek=function(t){return e.prototype.findOuter.call(this,t)},t.prototype.insertProp=function(e,t){return t?this.split(e,t):this.end()},t.prototype.split=function(t,n){return n?e.prototype.insertFloat.call(this,t,n):this.end()},t.prototype.merge=function(t){var n=t.copy();return e.prototype.eraseFloat.call(this,n.postNext()),n},t.prototype.extend=function(t,n){e.prototype.insertSpace.call(this,t,n)},t.prototype.shrink=function(t,n,r){e.prototype.eraseSpace.call(this,t,n,(function(e){r&&e.length>0&&r(e)}))},t.prototype.begin=function(){return e.prototype.begin.call(this)},t.prototype.end=function(){return e.prototype.end.call(this)},t.prototype.rbegin=function(){return e.prototype.rbegin.call(this)},t.prototype.range=function(e){var t=this.rangeBegin(e),n=this.rangeEnd(e);return new b.IC(t,n-t)},t.prototype.rangeBegin=function(t){return e.prototype.position.call(this,t.copy().prev())},t.prototype.rangeEnd=function(t){return e.prototype.position.call(this,t)},t.prototype.modifyProp=function(e,t,n,r,o){var i=this.seek(e),a=i.data(),s=null==a?void 0:a.clone(),c=Fe.vC.modifyProps(n,r,s,o);return s&&!Fe.vC.isEqualProp(s,a)&&i.setData(s),c},t.prototype.findNearestPos=function(e){var t=this.findInner(e);return this.position(t)},t.prototype.isExistNode=function(e){return this.findNearestPos(e)===e},t}(Ue),je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.createIterator=function(e,t){return new de(this,e,t)},t}(He),Ge=n(31374),Ve=function(e){function t(t,n,r,o,i,a){var s=e.call(this,t)||this;return s.commentPropList=new je,s.commentRangeList=n,s.bookmarkRangeList=r,s.permissionRangeList=o,s.revisionRangeList=i,s.quoteRangeList=a,s}return(0,i.__extends)(t,e),t.prototype.setNotificationCenter=function(e){this.commentRangeList.setNotificationCenter(e),this.bookmarkRangeList.setNotificationCenter(e),this.permissionRangeList.setNotificationCenter(e),this.revisionRangeList.setNotificationCenter(e),this.quoteRangeList.setNotificationCenter(e)},t.prototype.createCommentIterator=function(e,t){return this.commentPropList.createIterator(this.validRange(e),!!t)},t.prototype.getCommentRangeSimpleInfoFromId=function(e){return this.getSimpleRangeInfoFromId(e,this.commentRangeList)},t.prototype.getCommentRangeInfoFromId=function(e){for(var t=null,n=null,r=this.createCommentIterator();r.hasNext();){if((null==(n=r.getCloneProperty())?void 0:n.id)===e){t=new b.IC(r.getRange().end()-1,1);break}r.next()}if(t&&n){var o=this.getCommentRangeSimpleInfoFromIdAndRefRange(e,t);return{annotationRange:o.annotationRange,rangeProp:o.rangeProp,refProp:n,refRange:t,commentRange:this.commentRangeList.getRange(e)||t}}return null},t.prototype.collectCommentRangeInfoFromGcp=function(e){return this.doCollectCommentRangeInfos(e)},t.prototype.collectCommentRangeInfoFromRange=function(e){return this.doCollectCommentRangeInfos(e)},t.prototype.doCollectCommentRangeInfos=function(e){for(var t=[],n=this.createCommentIterator();n.hasNext();){var r=n.getCloneProperty(),o=new b.IC(n.getRange().end()-1,1);if(r&&o.isValid()){var i=this.getCommentRangeSimpleInfoFromIdAndRefRange(r.id,o),a=i.annotationRange,s=i.rangeProp;(e instanceof b.IC&&a.intersect(e)||!(e instanceof b.IC)&&a.contains(e))&&t.push({annotationRange:a,rangeProp:s,refProp:r,refRange:o})}n.next()}return t},t.prototype.getCommentRangeSimpleInfoFromIdAndRefRange=function(e,t){var n=this.commentRangeList.getValue(e);return n||((n=new(Ge.kk.getPropertyClass(Ge.uS.CommentRangeProperty))).id=e),{annotationRange:this.commentRangeList.getRange(e)||new b.IC(t.begin(),0),rangeProp:n}},t.prototype.getBookmarkRangeInfoFromId=function(e){return this.getSimpleRangeInfoFromId(e,this.bookmarkRangeList)},t.prototype.collectBookmarkRangeInfoFromGcp=function(e){return this.doCollectSimpleRangeInfos(e,this.bookmarkRangeList)},t.prototype.collectBookmarkRangeInfoFromRange=function(e){return this.doCollectSimpleRangeInfos(e,this.bookmarkRangeList)},t.prototype.forEachPermissionRange=function(e,t){this.forEachRange(e,this.permissionRangeList,(function(e){return t(e)}))},t.prototype.getPermissionRangeInfoFromId=function(e){return this.getSimpleRangeInfoFromId(e,this.permissionRangeList)},t.prototype.collectPermissionRangeInfoFromGcp=function(e){return this.doCollectSimpleRangeInfos(e,this.permissionRangeList)},t.prototype.collectPermissionRangeInfoFromRange=function(e){return this.doCollectSimpleRangeInfos(e,this.permissionRangeList)},t.prototype.getRevisionRangeInfoFromId=function(e){return this.getSimpleRangeInfoFromId(e,this.revisionRangeList)},t.prototype.collectRevisionRangeInfoFromGcp=function(e){return this.doCollectSimpleRangeInfos(e,this.revisionRangeList)},t.prototype.collectRevisionRangeInfoFromRange=function(e){return this.doCollectSimpleRangeInfos(e,this.revisionRangeList)},t.prototype.collectQuoteRangeInfoFromGcp=function(e){return this.doCollectSimpleRangeInfos(e,this.quoteRangeList)},t.prototype.collectQuoteRangeInfoFromRange=function(e){return this.doCollectSimpleRangeInfos(e,this.quoteRangeList)},t.prototype.getQuoteRangeInfoFromId=function(e){return this.getSimpleRangeInfoFromId(e,this.quoteRangeList)},t.prototype.getSimpleRangeInfoFromId=function(e,t){var n=t.getRange(e),r=t.getValue(e);return n&&r?{annotationRange:n,rangeProp:r}:null},t.prototype.doCollectSimpleRangeInfos=function(e,t){var n=[];return this.forEachRange(e,t,(function(e){return n.push(e),!1})),n},t.prototype.forEachRange=function(e,t,n){t.forEachRange((function(r){if(e instanceof b.IC&&!r.range.intersect(e)||!(e instanceof b.IC)&&!r.range.contains(e))return!1;var o=!1;return r.key.forEach((function(e){var i=t.getValue(e);i&&(o=n({rangeProp:i,annotationRange:r.range}))})),o}))},t}(Be),We=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.shrink=function(e,t,n){this.commentPropList.shrink(e,t,(function(e){var t=e.map((function(e){return e.data}));null==n||n.deleteProperty(le.DeleteComment,t)}))},t.prototype.extend=function(e,t){this.commentPropList.extend(e,t)},t.prototype.setCommentProp=function(e,t,n,r,o){return this.setPropCommon(this.commentPropList,e,t,n,r,o)},t.prototype.insertCommentRange=function(e,t,n){return this.deleteCommentRange(n.id),this.commentRangeList.insertRange(n.id,new b.IC(e,t),n)},t.prototype.deleteCommentRange=function(e){return this.commentRangeList.deleteRange(e)},t.prototype.insertBookmarkRange=function(e,t,n){return this.bookmarkRangeList.insertRange(n.id,new b.IC(e,t),n)},t.prototype.deleteBookmarkRange=function(e){return this.bookmarkRangeList.deleteRange(e)},t.prototype.insertPermissionRange=function(e,t,n){return this.permissionRangeList.insertRange(n.id,new b.IC(e,t),n)},t.prototype.deletePermissionRange=function(e){return this.permissionRangeList.deleteRange(e)},t.prototype.insertQuoteRange=function(e,t,n){return this.quoteRangeList.insertRange(n.id,new b.IC(e,t),n)},t.prototype.deleteQuoteRange=function(e){return this.quoteRangeList.deleteRange(e)},t.prototype.insertRevisionRange=function(e,t,n){return this.revisionRangeList.insertRange(n.id,new b.IC(e,t),n)},t.prototype.deleteRevisionRange=function(e){return this.revisionRangeList.deleteRange(e)},t}(Ve),ze=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.createIterator=function(e,t){return new ae(this,e,t)},t}(He),Ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.createIterator=function(e,t){return new ce(this,e,t)},t}(He),qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.createIterator=function(e,t){return new se(this,e,t)},t}(He),Ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.shrink=function(e,t,n){this.drawingPropList.shrink(e,t,(function(e){var t=e.map((function(e){return e.data}));null==n||n.deleteProperty(le.DeleteDrawing,t)})),this.picturePropList.shrink(e,t,(function(e){var t=e.map((function(e){return e.data}));null==n||n.deleteProperty(le.DeletePicture,t)})),this.embeddedObjectPropList.shrink(e,t,(function(e){var t=e.map((function(e){return e.data}));null==n||n.deleteProperty(le.DeleteEmbeddedObject,t)}))},t.prototype.extend=function(e,t){this.drawingPropList.extend(e,t),this.picturePropList.extend(e,t),this.embeddedObjectPropList.extend(e,t)},t.prototype.setDrawingProp=function(e,t,n,r,o){return this.setPropCommon(this.drawingPropList,e,t,n,r,o)},t.prototype.setPictureProp=function(e,t,n,r,o){return this.setPropCommon(this.picturePropList,e,t,n,r,o)},t.prototype.setEmbeddedObjectProp=function(e,t,n,r,o){return this.setPropCommon(this.embeddedObjectPropList,e,t,n,r,o)},t}(function(e){function t(t){var n=e.call(this,t)||this;return n.drawingPropList=new ze,n.picturePropList=new qe,n.embeddedObjectPropList=new Ke,n}return(0,i.__extends)(t,e),t.prototype.getDrawingInfo=function(e){return this.getDrawingInfoFromId(e,!1)},t.prototype.getDrawingInfoFromContentId=function(e,t){return void 0===t&&(t=!1),this.getDrawingInfoFromId(e,!0,t)},t.prototype.getDrawingInfoFromId=function(e,t,n){void 0===n&&(n=!1);for(var r=this.createDrawingIterator();r.hasNext();){var o=n?r.getProperty():r.getCloneProperty();if(o&&(t?o.drawing.graphic.graphicData.wsp.txbx.contentId:o.anchorId)===e){var i=r.getRange().end();return{property:o,range:new b.IC(i-1,1)}}r.next()}return null},t.prototype.getDrawingInfoFromGcp=function(e){var t=this.createDrawingIterator(new b.IC(e,1));return this.getInfoFromGcp(e,t)},t.prototype.forEachDrawingRange=function(e,t){for(var n=this.createDrawingIterator(t);n.hasNext();){var r=n.getCloneProperty();if(r){var o=n.getRange().end();e({property:r,range:new b.IC(o-1,1)}),n.next()}}},t.prototype.getPictureInfoFromGcp=function(e){var t=this.createPictureIterator(new b.IC(e,1));return this.getInfoFromGcp(e,t)},t.prototype.getEmbeddedObjectInfoFromGcp=function(e){var t=this.createEmbeddedObjectIterator(new b.IC(e,1));return this.getInfoFromGcp(e,t)},t.prototype.getInfoFromGcp=function(e,t){t.seek(e);var n=t.getCloneProperty(),r=t.getRange();if(n&&r.contains(e)){var o=r.end();return{property:n,range:new b.IC(o-1,1)}}return null},t.prototype.createDrawingIterator=function(e,t){return this.drawingPropList.createIterator(this.validRange(e),!!t)},t.prototype.createPictureIterator=function(e,t){return this.picturePropList.createIterator(this.validRange(e),!!t)},t.prototype.createEmbeddedObjectIterator=function(e,t){return this.embeddedObjectPropList.createIterator(this.validRange(e),!!t)},t}(Be)),Qe=new RegExp("[]((.|\r|\n)*?)[]","g"),Ze=new RegExp("(?:[]).+(?=[])","g"),Xe=function(e){try{var t=new RegExp("(?<=[]).+(?=[])","g");return e.match(t)}catch(t){var n=e.match(Ze);return null==n?void 0:n.map((function(e){return e.replace(/[\u0014]/g,"")}))}},Je=new RegExp("[](.*?)[]+|[]+|[](.*)","g"),$e=new RegExp("(?:[])(.*)(?=([]))","g"),et=function(e){try{var t=new RegExp("(?<=[])(.*)(?=([]))","g");return e.match(t)}catch(t){var n=e.match($e);return null==n?void 0:n.map((function(e){return e.replace(/[\u0013]/g,"")}))}},tt=new RegExp("(\\w+)(?=(\\s))?","g"),nt=new RegExp("\\\\((\\w+)|@|\\*)\\s?","g"),rt=[B.displayLayoutType,B.layoutType,B.key,B.width,B.height,B.lockAspectRatio,B.padding,B.subtype,B.independentRender,B.isEscape],ot=[N.MENTION_QQ,N.MENTION_WXWORK,N.DATE_REMINDER,N.WXWORK_GROUP_CHAT,N.MEMBER_CONTACT_CARD,N.GROUP_CONTACT_CARD,N.WXWORK_APP,N.WXWORK_CALENDER,N.WXWORK_MEETING,N.WxWORK_COLD_START_BUTTON],it=[N.DATE_REMINDER,N.WXWORK_GROUP_CHAT,N.MEMBER_CONTACT_CARD,N.GROUP_CONTACT_CARD,N.WXWORK_APP,N.WXWORK_CALENDER,N.WXWORK_MEETING,N.WxWORK_COLD_START_BUTTON],at=function(){function e(){}return e.getFilterFieldCodeText=function(e){var t=e;return t.indexOf(k.If.FieldBegin)>=0&&t.indexOf(k.If.FieldSeparate)>=0&&(t=t.replace(Je,"")),t},e.encodeField=function(e,t){var n,r,o,a,s,c=re.StringUtil.generateRandomId(),l=e.fieldCode,u=e.fieldResult,d=void 0===u?{result:""}:u,p=l.name,h=l.instructions,f=l.switches,g=null!==(a=null==f?void 0:f[B.key])&&void 0!==a?a:c,v=(null==(f=(0,i.__assign)((0,i.__assign)({},f),((n={})[B.key]=g,n)))?void 0:f[B.isEscape])?function(e){return escape(e)}:function(e){return e},y={key:g,fieldCode:"".concat(p).concat(h?h.reduce((function(e,t){return"".concat(e," ").concat(t)}),""):""),fieldResult:d.result},m=(0,i.__spreadArray)((0,i.__spreadArray)([],(0,i.__read)(null!==(s=null==t?void 0:t.forbiddenEscapeSwitches)&&void 0!==s?s:[]),!1),(0,i.__read)(rt),!1);try{for(var b=(0,i.__values)(Object.entries(f)),_=b.next();!_.done;_=b.next()){var C=(0,i.__read)(_.value,2),S=C[0],w=C[1];if(w){var E=m.includes(S)?w:v(w);y.fieldCode="".concat(y.fieldCode," \\").concat(S," ").concat(E)}}}catch(e){r={error:e}}finally{try{_&&!_.done&&(o=b.return)&&o.call(b)}finally{if(r)throw r.error}}return y},e.getFieldCodeText=function(e){var t=e,n=this.getAllField(e);if(null!==n){var r=et(n[0]);if(!r)return null;t=(0,i.__read)(r,1)[0]}return t},e.decodeFieldCode=function(e){var t,n,r,o=e,a=this.getAllField(e);if(null!==a){var s=et(a[0]);if(!s)return null;o=(0,i.__read)(s,1)[0]}var c=null!==(n=null===(t=o.match(tt))||void 0===t?void 0:t[0])&&void 0!==n?n:null;if(!c)return null;if(it.includes(c))return{name:c,instructions:[o.replace(c,"")],fieldCode:e};var l=o.split('"'),u=-1,d=[];l.forEach((function(e,t){var n;if(t%2==0){var r=null!==(n=e.match(nt))&&void 0!==n?n:[];r.length&&-1===u&&(u=t),d.push.apply(d,(0,i.__spreadArray)([],(0,i.__read)(r),!1))}}));var p=[];l.some((function(e,t){var n,r;if(0===t){if(e===c)return!1;e=e.replace("".concat(c," "),"")}return t===u?(p=p.concat(null===(r=e.split(null!==(n=d[0])&&void 0!==n?n:""))||void 0===r?void 0:r[0].split(" ").filter((function(e){return e.length}))),!0):(t%2==1?p.push(e):p=p.concat(e.split(" ").filter((function(e){return e.length}))),!1)}),[]);var h={};l.forEach((function(e,t){var n;if(!(t<u)&&t%2==0){var r=e.split(" \\");r.shift();var o=r.length;if(!o)return;r[o-1]=r[o-1].concat(null!==(n=l[t+1])&&void 0!==n?n:""),r.forEach((function(e){var t="\\".concat(e);d.some((function(e){var n=e.replace(/(\s*)$/g,"");if(0===t.indexOf(n)){if(t.length!==n.length){var r=new RegExp("^(\\".concat(n,")\\s.*"),"g");if(!t.match(r))return!1}var o=e.replace(/(\\)|\s/g,""),i=t.replace(e,"").replace(/(\s*)$/g,"");return h[o]=i,!0}return!1}))}))}}));var f=this.getSubtype(c,h,p);f&&(h[B.subtype]=f),h[B.independentRender]=this.getIndependentRender(h);var g=null!==(r=this.getDisplayLayoutType(c,p,h))&&void 0!==r?r:G.dL.Text;g&&(h[B.displayLayoutType]=g);var v=this.getKey(h);return v&&(h[B.key]=v),{name:c,instructions:p,switches:h,fieldCode:e}},e.getFieldNameDefaultLayoutType=function(e){return e in N&&![N.DATE].includes(e)?G.dL.Inline:G.dL.Text},e.getDisplayLayoutType=function(e,t,n){var r=null==n?void 0:n[B.displayLayoutType];return r||(r=e===N.HYPERLINK?null==t?void 0:t[1]:e),W[r]},e.getSubtype=function(e,t,n){void 0===n&&(n=[]);var r=null==t?void 0:t[B.subtype];return ot.includes(e)||(r=null!=r?r:null==n?void 0:n[1]),r||e!==N.HYPERLINK||(r="normalLink"),r},e.getKey=function(e){var t,n;return null!==(n=null!==(t=e[B.key])&&void 0!==t?t:e.tdaci)&&void 0!==n?n:""},e.getIndependentRender=function(e){var t=e[B.independentRender];if(t)return t;var n=e[B.subtype];return["audio","addonIframe","addonHina"].includes(n)?V.True:V.False},e.encodeFieldCode=function(e,t,n){void 0===t&&(t=[]),void 0===n&&(n={});var r=[];return Object.entries(n).forEach((function(e){var t=(0,i.__read)(e,2),n=t[0],o=t[1];"boolean"==typeof o&&o?r.push("\\".concat(n)):"string"==typeof o&&r.push("\\".concat(n),o)})),(0,i.__spreadArray)((0,i.__spreadArray)([e],(0,i.__read)(t),!1),(0,i.__read)(r),!1).filter((function(e){return!!e})).map((function(e){return e.includes(" ")?'"'.concat(e,'"'):e})).join(" ")},e.isComplexField=function(e){return!!(null==e?void 0:e[B.subtype])},e.getComplexFieldSubType=function(e){return null==e?void 0:e[B.subtype]},e.getAllField=function(e){var t=e.match(Qe);return t||null},e.parseFieldInfo=function(e){var t,n=this.decodeFieldCode(e);if(!n)return null;var r=null===(t=Xe(e))||void 0===t?void 0:t[0];if(r){var o=r.match(Qe);null==o||o.map((function(e){r=null==r?void 0:r.replace(e,"")}))}return{fieldCode:n,fieldResult:r}},e.getFieldResult=function(e,t){var n,r;void 0===t&&(t=!1);var o=this.getAllField(e);return o?t?o.map((function(e){var t,n;return null!==(n=null===(t=Xe(e))||void 0===t?void 0:t[0])&&void 0!==n?n:""})):[null!==(r=null===(n=Xe(o[0]))||void 0===n?void 0:n[0])&&void 0!==r?r:""]:null},e.isContainerField=function(e){var t,n=null==e?void 0:e[B.layoutType],r=null!==(t=null==e?void 0:e[B.displayLayoutType])&&void 0!==t?t:G.dL.Text;return n===F.Container||r===G.dL.Preview},e.getFieldCodeInfoByFieldInfo=function(t){var n=t.fieldCode,r=n.name,o=n.instructions,i=n.switches;return{name:r,fieldCode:e.encodeFieldCode(r,o,i),instructions:o,switches:i}},e}(),st=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.createIterator=function(e,t){return new oe(this,e,t)},t}(He),ct=n(99444),lt=n(21761),ut=function(){function e(){this.isAutoUpdate=!1,this.isShowDropdowns=!0,this.isShowHover=!0}return e.prototype.canFocusInField=function(e){var t;return(null===(t=e.switches)||void 0===t?void 0:t[B.displayLayoutType])===G.dL.Text},e.prototype.getFieldLayoutText=function(e,t){return""},e.prototype.requiredContext=function(e){return[]},e.prototype.getPrefab=function(e){return null},e.prototype.getDropdownItems=function(e,t){return[]},e.prototype.handleFieldClick=function(e,t,n){},e.prototype.afterShowDropdown=function(){},e.prototype.isProhibitForcesFocus=function(e,t,n){return!1},e.prototype.getNoFieldShowText=function(e,t,n,r){return void 0===r&&(r={}),this.isAutoUpdate?this.getFieldLayoutText(t,r):null!=n?n:""},e.prototype.isShowPasteIcon=function(e){return!0},e.prototype.getPluginContainerFitRule=function(e){var t;return(null===(t=e.switches)||void 0===t?void 0:t[B.displayLayoutType])===G.dL.Preview?{fitToParentWidth:!0,fitToParentHeight:!1}:{fitToParentWidth:!1,fitToParentHeight:!1}},e.prototype.getFieldLayoutType=function(e){var t;return e.switches&&null!==(t=e.switches[B.displayLayoutType])&&void 0!==t?t:G.dL.Inline},e.prototype.getFieldHeight=function(e){},e.prototype.getFieldWidth=function(e){},e.prototype.getContainerDefaultSize=function(e){return{width:0,height:0}},e}();function dt(e){var t={};return t.pageNum=e.pageNum,t.pageCount=e.pageCount,t.pageNumFormat=e.pageNumFormat,t}var pt=function(){function e(){if(e.instance)return e.instance;this.supportedFieldNames=new Map,e.instance=this}return e.getInstance=function(){return new e},e.filterFieldCode=function(t){var n=at.getAllField(t),r=e.getInstance(),o=t;return null==n||n.map((function(e){var t=at.parseFieldInfo(e);if(!t)return null;var n=t.fieldCode,i=t.fieldResult,a=at.getComplexFieldSubType(n.switches),s=r.getFieldProcessor(n.name,a);if(s){var c=s.getNoFieldShowText(e,n,i);o=o.replace(e,c)}})),o},e.prototype.isContainerField=function(e){var t,n,r,o=at.decodeFieldCode(e);if(!o)return!1;var i=null===(t=o.switches)||void 0===t?void 0:t[B.layoutType],a=null!==(r=null===(n=o.switches)||void 0===n?void 0:n[B.displayLayoutType])&&void 0!==r?r:G.dL.Text;return i===F.Container||a===G.dL.Preview},e.prototype.getDrawingFromFieldInfo=function(e){var t,n,r,o,i=e.fieldCode,a=i.switches,s=at.getComplexFieldSubType(i.switches),c=new(ct.k.getPropertyClass(lt.u.DrawingProperty));if(a){var l=new(ct.k.getPropertyClass(lt.u.CTInline));c.fieldType=null!==(t=a[B.displayLayoutType])&&void 0!==t?t:G.dL.Preview;var u=a[B.width],d=a[B.height];if(!u||!d){var p=this.getFieldProcessor(i.name,s);if(p){var h=at.getFieldCodeInfoByFieldInfo(e);!u&&(u="".concat(null!==(n=p.getFieldWidth(h))&&void 0!==n?n:0)),!d&&(d="".concat(null!==(r=p.getFieldHeight(h))&&void 0!==r?r:0))}}l.extent.cx=Number(u),l.extent.cy=Number(d),l.graphic.graphicData.pic.spPr.xfrm.ext.cx=c.drawing.extent.cx,l.graphic.graphicData.pic.spPr.xfrm.ext.cy=c.drawing.extent.cy,l.cNvGraphicFramePr.graphicFrameLocks.noChangeAspect=!Number(a[B.lockAspectRatio]),c.inlineKeyword=l,c.anchorId=String(null!==(o=a[B.key])&&void 0!==o?o:""),c.fieldSubtype=null!=s?s:i.name}return c},e.prototype.setFieldProcessorCallback=function(e){this.fieldProcessorCallback=e},e.prototype.getFieldProcessor=function(e,t){var n,r=null===(n=this.fieldProcessorCallback)||void 0===n?void 0:n.call(this,e,t);return r||(t?(r=this.getProcessor(e,t))||(re.Logger.warn("field processor is not exit",e,t),this.getProcessor(e,e===N.HYPERLINK?"normalLink":void 0)):this.getProcessor(e))},e.prototype.getFieldProcessorByFieldCodeInfo=function(e){var t=at.getComplexFieldSubType(e.switches);return this.getFieldProcessor(e.name,t)},e.prototype.isSupported=function(e){return this.supportedFieldNames.has(e)},e.prototype.getProcessor=function(e,t){if(!this.isSupported(e))return null;var n=this.supportedFieldNames.get(e);return!t||n instanceof ut?n instanceof ut?n:null:n.get(t)},e.prototype.addProcessor=function(e,t){this.isSupported(e)?re.Logger.warn("Fieldcode ".concat(e," already has a processor.")):this.supportedFieldNames.set(e,t)},e.prototype.removeProcessor=function(e){this.supportedFieldNames.delete(e)},e.prototype.getFieldStructure=function(e){var t=e.search(k.If.FieldBegin),n=e.search(k.If.FieldSeparate),r=e.search(k.If.FieldEnd);return{fieldCode:e.slice(t+1,n),fieldResult:e.slice(n+1,r)}},e}();function ht(e,t){var n=e.getProperty();return n?{property:n,range:e.getRange(!0),contentRange:e.getContentRange(!0),nestingLevel:t}:null}var ft=function(){function e(e,t){this.propListFactory=e,this.validRange=t,this.collection=[]}return Object.defineProperty(e.prototype,"maxLevel",{get:function(){return this.collection.length},enumerable:!1,configurable:!0}),e.prototype.extend=function(e,t){this.collection.forEach((function(n){n.extend(e,t)}))},e.prototype.shrink=function(e,t,n){this.collection.forEach((function(r){r.shrink(e,t,n)}))},e.prototype.createIterator=function(e){var t=this.formatOption(e),n=t.nestingLevel,r=t.limitRange,o=t.isRawIter;return this.getOrCreatePropList(n).createIterator(this.validRange(r),o)},e.prototype.setProp=function(e,t,n,r,o){var i=this.resolvePropList(n,r,e+t);if(!Ne.isInsertPropType(n,e+t,i))return i.modifyProp(e,t,n,r,o);i.insertProp(e+t,r)},e.prototype.openSkipList=function(e){this.skipListIteratorFactory=e},e.prototype.getInfo=function(e,t,n){if(this.isLegalLevel(t)){if(!this.collection[this.storagePos(t)])return null;var r=this.createIterator({nestingLevel:t,limitRange:n});return this.resolveInfoFromIterator(r,e,t)}for(var o=this.maxLevel;o>0;o--){r=this.createIterator({nestingLevel:o,limitRange:n});var i=this.resolveInfoFromIterator(r,e,o);if(i)return i}return null},e.prototype.resolvePropList=function(e,t,n){var r,o;if(t.has("nestingLevel")||e===G.XS.Insert)return this.getOrCreatePropList(t.nestingLevel);try{for(var a=(0,i.__values)(this.collection),s=a.next();!s.done;s=a.next()){var c=s.value;if(null==c?void 0:c.isExistNode(n))return c}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return this.getOrCreatePropList(t.nestingLevel)},e.prototype.getOrCreatePropList=function(e){if(!this.isLegalLevel(e))throw new Error(" ".concat(e));var t=this.storagePos(e),n=this.collection[t];return n||(n=this.propListFactory(),this.collection[t]=n,this.skipListIteratorFactory&&n.openSkipList(this.skipListIteratorFactory.bind(null,{nestingLevel:e}))),n},e.prototype.storagePos=function(e){return e-1},e.prototype.formatOption=function(e){return{nestingLevel:(null==e?void 0:e.nestingLevel)||1,limitRange:this.validRange(null==e?void 0:e.limitRange),isRawIter:null==e?void 0:e.isRawIter}},e.prototype.resolveInfoFromIterator=function(e,t,n){e.seek(t);var r=ht(e,n);return(null==r?void 0:r.range.contains(t))?r:null},e.prototype.isLegalLevel=function(e){return!!e&&e>=1},e}();function gt(e,t,n){var r=n.fieldRange,o=n.fieldCodeRange,a=n.fieldResultRange,s=n.nestingLevel,c=function(e,t){var n,r,o,a,s,c=at.decodeFieldCode(t);if(!c)return null;var l=c.name,u=(0,i.__assign)((0,i.__assign)({},c),{isValid:!0,fieldcode:t}),d=e.getFieldProcessorByFieldCodeInfo(u);if(!d){var p=null!==(r=null===(n=c.switches)||void 0===n?void 0:n[B.displayLayoutType])&&void 0!==r?r:G.dL.Text;return{isValid:!0,prefab:"",fieldCode:t,fieldSubType:null!==(a=null===(o=c.switches)||void 0===o?void 0:o[B.subtype])&&void 0!==a?a:"",fieldLayoutType:p,isAutoUpdate:!1,canFocusInField:p===G.dL.Text,requiredContext:[],fieldType:l}}var h=d.isAutoUpdate,f=d.canFocusInField(u),g=d.requiredContext(u),v=d.getPrefab(u),y=d.getFieldLayoutType(u),m=d.getFieldHeight(u),b=d.getFieldWidth(u);return{isValid:!0,prefab:v,fieldCode:t,fieldSubType:null!==(s=at.getComplexFieldSubType(u.switches))&&void 0!==s?s:"",fieldLayoutType:y,isAutoUpdate:h,canFocusInField:f,fieldWidth:b,fieldHeight:m,requiredContext:g,fieldType:l}}(t,e.readText(o.gcpBegin,o.len));if(!c)return null;var l=e.readText(a.gcpBegin,a.len),u=l.includes(k.If.FieldBegin);return(0,i.__assign)((0,i.__assign)({},c),{fieldRange:r,fieldCodeRange:o,fieldResultRange:a,fieldResult:l,hasNestField:u,nestingLevel:s,fieldLayoutType:u?G.dL.Text:c.fieldLayoutType})}var vt=[N.ATTACHMENT,N.DATE_REMINDER,N.WXWORK_APP,N.WXWORK_MEETING,N.WXWORK_CALENDER,N.WXWORK_GROUP_CHAT,N.GROUP_CONTACT_CARD,N.MEMBER_CONTACT_CARD,N.WxWORK_COLD_START_BUTTON];function yt(e,t){var n=e.name,r=e.switches;if(vt.includes(n)){var o=t.getFieldProcessorByFieldCodeInfo(e);if(o)return o.getFieldLayoutType(e)}return null==r?void 0:r[B.displayLayoutType]}function mt(e){return e.displayLayoutType===G.dL.Inline}var bt,_t=function(e){function t(t,n){var r=e.call(this,t)||this;return r.textPool=t,r.textStream=n,r.fieldPropCollection=new ft((function(){return new st}),r.validRange.bind(r)),r.fieldManager=pt.getInstance(),r}return(0,i.__extends)(t,e),Object.defineProperty(t.prototype,"maxNestingLevel",{get:function(){return this.fieldPropCollection.maxLevel},enumerable:!1,configurable:!0}),t.prototype.isValidField=function(e,t){var n,r,o,i=this.getNestingFieldInfo(e,t);if(null==i?void 0:i.nestingLevel)for(var a=i.nestingLevel-1;a>0;a--){var s=this.getNestingFieldInfo(e,a);if(null===(n=null==s?void 0:s.range)||void 0===n?void 0:n.begin()){var c=this.getFieldRange(null===(r=null==s?void 0:s.contentRange)||void 0===r?void 0:r.begin());if(null===(o=null==c?void 0:c.fieldCodeRange)||void 0===o?void 0:o.contains(i.range))return!1}}return!0},t.prototype.createFieldIterator=function(e){return void 0===e&&(e={}),this.fieldPropCollection.createIterator(e)},t.prototype.getFieldRange=function(e,t){void 0===t&&(t=1);var n=this.createFieldIterator({nestingLevel:t});n.seek(e);var r=n.getProperty();if(!r||r.fldCharType!==ne.P1W.end)return null;var o=n.getRange();if(!o.contains(e))return null;var i=n.prev(),a=n.getProperty();if(!a)return null;var s=null;if((null==a?void 0:a.fldCharType)===ne.P1W.separate){if(!i)return null;s=n.getRange(),n.prev()}var c=n.getProperty();if(!c||c.fldCharType!==ne.P1W.begin)return null;var l=o.begin()+1,u=s?s.end()-1:o.end()-1,d=new b.IC(l,u-l),p=s?s.end():o.end()-1,h=o.end()-1;return{fieldRange:o,fieldCodeRange:d,fieldResultRange:new b.IC(p,h-p),nestingLevel:t}},t.prototype.getFieldRanges=function(e,t){void 0===t&&(t=1);var n=[],r=this.getFieldRange(e.begin(),t),o=this.getFieldRange(e.end(),t),a=e.begin(),s=e.end();if(r&&o){if(n.push(r),r.fieldRange.equal(o.fieldRange))return n;a=r.fieldRange.end(),s=o.fieldRange.begin()}else r?(n.push(r),a=r.fieldRange.end()):o&&(s=o.fieldRange.begin());if(s-a>0){var c=new b.IC(a,s-a),l=this.getFieldRangesByLimitRange(c,t);n.push.apply(n,(0,i.__spreadArray)([],(0,i.__read)(l),!1))}return o&&n.push(o),n},t.prototype.getFieldCode=function(e,t){void 0===t&&(t=1);var n=this.getFieldRange(e,t);if(!n)return null;var r=n.fieldCodeRange;return this.textStream.readText(r.gcpBegin,r.len)},t.prototype.getFieldResult=function(e){var t=this.getFieldRange(e);if(!t)return null;var n=t.fieldResultRange;return this.textStream.readText(n.gcpBegin,n.len)},t.prototype.getFieldLayoutInfo=function(e,t){var n,r,o=null!==(r=null===(n=e.fieldResult)||void 0===n?void 0:n.result)&&void 0!==r?r:"",a=this.getFormatFieldResultText(e,t),s=e.layoutType,c={originFieldResultText:o,formatFieldResultText:a,layoutType:s};if(s===F.Container){var l=this.getFieldContainerLayoutConfig(e);return(0,i.__assign)((0,i.__assign)({},c),{containerLayoutConfig:l})}return c},t.prototype.isRangeInField=function(e){var t=this.getFieldRange(e.begin()),n=this.getFieldRange(e.end());return this.isEqualRange(null==t?void 0:t.fieldRange,null==n?void 0:n.fieldRange)},t.prototype.isRangeInFieldCode=function(e){var t=this.getFieldRange(e.begin()),n=this.getFieldRange(e.end());return this.isEqualRange(null==t?void 0:t.fieldCodeRange,null==n?void 0:n.fieldCodeRange)&&(null==t?void 0:t.fieldCodeRange.contains(e))},t.prototype.isRangeInFieldResult=function(e){var t=this.getFieldRange(e.begin()),n=this.getFieldRange(e.end());return this.isEqualRange(null==t?void 0:t.fieldResultRange,null==n?void 0:n.fieldResultRange)&&(null==t?void 0:t.fieldResultRange.contains(e))},t.prototype.isEqualRange=function(e,t){return!(!e||!t||e.begin()!==t.begin()||e.length()!==t.length())},t.prototype.getDecodedFieldInfo=function(e,t){var n,r=t;if(!t){var o=this.getNestingFieldInfo(e,t);r=null!==(n=null==o?void 0:o.nestingLevel)&&void 0!==n?n:t}var i=this.getFieldRange(e,r);return i?this.getDecodedFieldInfoByFieldRangeInfo(i):null},t.prototype.getDecodedFieldInfos=function(e,t){var n=this;return this.getFieldRanges(e,t).map((function(e){return n.getDecodedFieldInfoByFieldRangeInfo(e)})).filter((function(e){return!!e}))},t.prototype.getNestingFieldInfo=function(e,t){return this.fieldPropCollection.getInfo(e,t)},t.prototype.getNestingFieldInfos=function(e){for(var t=[],n=this.textStream.createRunIterator(e);n.hasNext();){var r=n.getRange().end();if(r+1<=e.end()&&this.textStream.readText(r,1).charCodeAt(0)===k.gh.FieldEnd){var o=this.getNestingFieldInfo(r-1);o&&t.push(o)}n.next()}return t},t.prototype.getFieldInfo=function(e,t){void 0===t&&(t=1);var n=this.getFieldRange(e,t);return n?gt(this.textStream,this.fieldManager,n):null},t.prototype.getExcludeNestingFieldResult=function(e){var t=e.fieldResult,n=e.fieldResultRange;if(!e.nestingLevel)return t;var r=this.getNestingFieldInfos(n);if(null==r?void 0:r.length){for(var o=n.begin(),i="",a=0,s=0;s<r.length;s++)i+=t.slice(a,r[s].contentRange.begin()-o),a=r[s].contentRange.begin()+r[s].contentRange.len;return i+=t.slice(a-o)}return t},t.prototype.getFieldRangesByLimitRange=function(e,t){void 0===t&&(t=1);for(var n=[],r=this.createFieldIterator({limitRange:e,nestingLevel:t,isRawIter:!0});r.hasNext();){var o=r.getRange();if(!e.contains(o.end()))break;var i=r.getProperty();if(i&&i.fldCharType===ne.P1W.begin){var a=r.next(),s=r.getProperty();if(s){var c=null;if(s.fldCharType===ne.P1W.separate){if(!a)break;c=r.getRange(),a=r.next()}var l=r.getProperty();if(l&&l.fldCharType===ne.P1W.end){var u=r.getRange(),d=o.end()-1,p=new b.IC(d,u.end()-d),h=o.end(),f=c?c.end()-1:u.end()-1,g=new b.IC(h,f-h),v=u.end()-1,y=c?c.end():v,m=new b.IC(y,v-y);n.push({fieldRange:p,fieldCodeRange:g,fieldResultRange:m,nestingLevel:t}),a&&r.next()}else a&&r.next()}else a&&r.next()}else r.next()}return n},t.prototype.getDecodedFieldInfoByFieldRangeInfo=function(e){var t,n,r,o,i=e.fieldRange,a=e.fieldCodeRange,s=e.fieldResultRange,c=e.nestingLevel,l=this.textStream.readText(s.gcpBegin,s.len),u=this.textStream.readText(a.gcpBegin,a.len),d=at.decodeFieldCode(u);if(!d)return null;var p=at.getComplexFieldSubType(d.switches),h=yt(d,this.fieldManager),f=this.getFieldLayoutType(d,h),g=l.includes(k.If.FieldBegin),v=this.fieldManager.getFieldProcessor(d.name,p),y=null!==(t=null==v?void 0:v.isAutoUpdate)&&void 0!==t&&t,m=null!==(n=null==v?void 0:v.canFocusInField(d))&&void 0!==n?n:f===F.Text;return{fieldCode:{name:d.name,instructions:null!==(r=d.instructions)&&void 0!==r?r:[],switches:null!==(o=d.switches)&&void 0!==o?o:{},range:a},fieldResult:{result:l,range:s},layoutType:f,displayLayoutType:h,fieldRange:i,nestingLevel:c,hasNestField:g,isAutoUpdate:y,canFocusInField:m}},t.prototype.getFieldLayoutType=function(e,t){var n,r=null===(n=e.switches)||void 0===n?void 0:n[B.layoutType];return r||(t===G.dL.Text?F.Text:F.Container)},t.prototype.getFormatFieldResultText=function(e,t){var n,r,o=at.getFieldCodeInfoByFieldInfo(e),i=this.fieldManager.getFieldProcessorByFieldCodeInfo(o);return e.isAutoUpdate&&i?i.getFieldLayoutText(o,null!=t?t:{}):(e.layoutType,F.Container,null!==(r=null===(n=e.fieldResult)||void 0===n?void 0:n.result)&&void 0!==r?r:"")},t.prototype.getFieldContainerLayoutConfig=function(e){var t,n,r,o=e.fieldCode.switches,i=at.getFieldCodeInfoByFieldInfo(e),a=function(e,t){var n,r,o,i,a,s,c,l,u=yt(e,t),d=t.getFieldProcessorByFieldCodeInfo(e);if(u===G.dL.Card&&d)return{fieldWidth:null!==(n=d.getFieldWidth(e))&&void 0!==n?n:0,fieldHeight:null!==(r=null==d?void 0:d.getFieldHeight(e))&&void 0!==r?r:0};var p=Number(null!==(i=null===(o=e.switches)||void 0===o?void 0:o[B.width])&&void 0!==i?i:0),h=Number(null!==(s=null===(a=e.switches)||void 0===a?void 0:a[B.height])&&void 0!==s?s:0);return p&&h||!d||(!p&&(p=null!==(c=d.getFieldWidth(e))&&void 0!==c?c:0),!h&&(h=null!==(l=d.getFieldHeight(e))&&void 0!==l?l:0)),{fieldWidth:p,fieldHeight:h}}(i,this.fieldManager),s=a.fieldWidth,c=a.fieldHeight,l=this.fieldManager.getFieldProcessorByFieldCodeInfo(i);s&&c||!l||(!s&&(s=null!==(t=l.getFieldWidth(i))&&void 0!==t?t:0),!c&&(c=null!==(n=l.getFieldHeight(i))&&void 0!==n?n:0));var u=null!==(r=null==l?void 0:l.getPluginContainerFitRule(i))&&void 0!==r?r:{},d=u.fitToParentWidth,p=u.fitToParentHeight;return{fieldWidth:s,fieldHeight:c,lockAspectRatio:!!(null==o?void 0:o[B.lockAspectRatio]),fitToParentWidth:d,fitToParentHeight:p}},t.prototype.getDisplayLayoutType=function(e){return yt(at.getFieldCodeInfoByFieldInfo(e),this.fieldManager)},t}(Be),Ct=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.shrink=function(e,t,n){var r=this;this.fieldPropCollection.shrink(e,t,(function(e){if(n){var t=e.map((function(e){return e.data}));n.deleteProperty(le.DeleteField,t);var o=r.collectDeleteFieldCodes(e);o.length>0&&n.deleteFieldCodes(o)}}))},t.prototype.extend=function(e,t){this.fieldPropCollection.extend(e,t)},t.prototype.setFieldProp=function(e,t,n,r,o){return this.fieldPropCollection.setProp(e,t,n,r,o)},t.prototype.collectDeleteFieldCodes=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];if(r.data.fldCharType===ne.P1W.begin){var o=e[n+1];(null==o?void 0:o.data.fldCharType)===ne.P1W.separate&&(t.push(this.textStream.readText(r.pos,o.pos-r.pos-1)),n+=1)}}return t},t}(_t),St=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.createIterator=function(e,t){return new he(this,e,t)},t}(He),wt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.createIterator=function(e,t){return new pe(this,e,t)},t}(He),Et=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.createIterator=function(e,t){return new fe(this,e,t)},t}(He),xt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.shrink=function(e,t,n){this.mathPropCollection.shrink(e,t),this.mathObjectPropCollection.shrink(e,t),this.mathRunPropList.shrink(e,t)},t.prototype.extend=function(e,t){this.mathPropCollection.extend(e,t),this.mathObjectPropCollection.extend(e,t),this.mathRunPropList.extend(e,t)},t.prototype.setMathProp=function(e,t,n,r,o){return this.mathPropCollection.setProp(e,t,n,r,o)},t.prototype.setMathObjectProp=function(e,t,n,r,o){return this.mathObjectPropCollection.setProp(e,t,n,r,o)},t.prototype.setMathRunProp=function(e,t,n,r,o){return this.setPropCommon(this.mathRunPropList,e,t,n,r,o)},t}(function(e){function t(t){var n=e.call(this,t)||this,r=n.validRange.bind(n);return n.mathPropCollection=new ft((function(){return new wt}),r),n.mathObjectPropCollection=new ft((function(){return new St}),r),n.mathRunPropList=new Et,n}return(0,i.__extends)(t,e),Object.defineProperty(t.prototype,"maxLevel",{get:function(){return this.mathPropCollection.maxLevel},enumerable:!1,configurable:!0}),t.prototype.createMathIterator=function(e){return this.mathPropCollection.createIterator(e)},t.prototype.createMathObjectIterator=function(e){return this.mathObjectPropCollection.createIterator(e)},t.prototype.createMathRunIterator=function(e,t){return this.mathRunPropList.createIterator(this.validRange(e),!!t)},t.prototype.getMathInfo=function(e,t){return this.mathPropCollection.getInfo(e,t)},t.prototype.getMathObjectInfo=function(e,t){return this.mathObjectPropCollection.getInfo(e,t)},t}(Be)),Tt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.createIterator=function(e,t){return new ye(this,e,t)},t}(He),Rt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.createIterator=function(e,t){return new ve(this,e,t)},t}(He),It=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.shrink=function(e,t,n){this.footnotePropList.shrink(e,t),this.endnotePropList.shrink(e,t)},t.prototype.extend=function(e,t){this.footnotePropList.extend(e,t),this.endnotePropList.extend(e,t)},t.prototype.setFootnoteProp=function(e,t,n,r,o){return this.setPropCommon(this.footnotePropList,e,t,n,r,o)},t.prototype.setEndnoteProp=function(e,t,n,r,o){return this.setPropCommon(this.endnotePropList,e,t,n,r,o)},t}(function(e){function t(t){var n=e.call(this,t)||this;return n.footnotePropList=new Rt,n.endnotePropList=new Tt,n}return(0,i.__extends)(t,e),t.prototype.getFootnoteInfo=function(e){for(var t=this.createFootnoteIterator();t.hasNext();){var n=t.getCloneProperty();if(n&&n.id===e){var r=t.getRange().end();return{property:n,range:new b.IC(r-1,1)}}t.next()}return null},t.prototype.getFootnoteInfoFromGcp=function(e){var t=this.createFootnoteIterator(new b.IC(e,1));t.seek(e);var n=t.getCloneProperty(),r=t.getRange();if(n&&r.contains(e)){var o=r.end();return{property:n,range:new b.IC(o-1,1)}}return null},t.prototype.getEndnoteInfo=function(e){for(var t=this.createEndnoteIterator();t.hasNext();){var n=t.getCloneProperty();if(n&&n.id===e){var r=t.getRange().end();return{property:n,range:new b.IC(r-1,1)}}t.next()}return null},t.prototype.getEndnoteInfoFromGcp=function(e){var t=this.createEndnoteIterator(new b.IC(e,1));t.seek(e);var n=t.getCloneProperty(),r=t.getRange();if(n&&r.contains(e)){var o=r.end();return{property:n,range:new b.IC(o-1,1)}}return null},t.prototype.createFootnoteIterator=function(e,t){return this.footnotePropList.createIterator(this.validRange(e),!!t)},t.prototype.createEndnoteIterator=function(e,t){return this.endnotePropList.createIterator(this.validRange(e),!!t)},t}(Be)),Pt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.createIterator=function(e,t){return new ge(this,e,t)},t}(He),Ot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.shrink=function(e,t,n){this.sdtPropCollection.shrink(e,t)},t.prototype.extend=function(e,t){this.sdtPropCollection.extend(e,t)},t.prototype.setSdtProp=function(e,t,n,r,o){return this.sdtPropCollection.setProp(e,t,n,r,o)},t}(function(e){function t(t){var n=e.call(this,t)||this,r=n.validRange.bind(n);return n.sdtPropCollection=new ft((function(){return new Pt}),r),n}return(0,i.__extends)(t,e),Object.defineProperty(t.prototype,"maxLevel",{get:function(){return this.sdtPropCollection.maxLevel},enumerable:!1,configurable:!0}),t.prototype.createSdtIterator=function(e){return this.sdtPropCollection.createIterator(e)},t.prototype.getSdtInfo=function(e,t){return this.sdtPropCollection.getInfo(e,t)},t}(Be)),kt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.createIterator=function(e,t){return new $(this,e,t)},t}(He),Dt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.shrink=function(e,t){this.sectionPropList.shrink(e,t)},t.prototype.extend=function(e,t){this.sectionPropList.extend(e,t)},t.prototype.setSectionProp=function(e,t,n,r,o){return this.setPropCommon(this.sectionPropList,e,t,n,r,o)},t}(function(e){function t(t){var n=e.call(this,t)||this;return n.sectionPropList=new kt,n}return(0,i.__extends)(t,e),t.prototype.createSectionIterator=function(e,t){return this.sectionPropList.createIterator(this.validRange(e),!!t)},t}(Be)),Mt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.createIterator=function(e,t){return new J(this,e,t)},t}(He),At=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.createIterator=function(e,t){return new X(this,e,t)},t}(He),Lt=function(e){function t(t){var n=e.call(this,t)||this;return n.storyPropList=new Mt,n.subStoryPropList=new At,n}return(0,i.__extends)(t,e),t.prototype.getStoryInfo=function(e){for(var t=this.createStoryIterator();t.hasNext();){var n=t.getCloneProperty();if((null==n?void 0:n.storyType)===e)return{storyProp:n,range:t.getRange(),contentRange:t.getContentRange()};t.next()}return null},t.prototype.getStoryInfoFromGcp=function(e){var t=this.createStoryIterator();t.seek(e);var n=t.getCloneProperty();return n&&t.getRange().contains(e)?{storyProp:n,range:t.getRange(),contentRange:t.getContentRange()}:null},t.prototype.getMainStoryInfo=function(){return this.getStoryInfo(ne.AHI.mainDocument)},t.prototype.getSubStoryInfoFromGcp=function(e){var t=this.getStoryInfoFromGcp(e);if(!t)return null;if(t.storyProp.storyType===ne.AHI.mainDocument)return(0,i.__assign)((0,i.__assign)({},t),{subStoryProp:new(Ge.kk.getPropertyClass(Ge.uS.MainStoryProperty))({id:G.Eo.MainDocId})});var n=this.createSubStoryIterator({limitRange:t.range});n.seek(e);var r=n.getCloneProperty();return r&&n.getRange().contains(e)?(0,i.__assign)((0,i.__assign)({},t),{subStoryProp:r,range:n.getRange(),contentRange:n.getContentRange()}):null},t.prototype.getSubStoryInfoFromId=function(e,t,n){var r;if(void 0===n&&(n=!1),e.length<=0)return null;if(e===G.Eo.MainDocId){var o=this.getMainStoryInfo();return o?(0,i.__assign)((0,i.__assign)({},o),{subStoryProp:new(Ge.kk.getPropertyClass(Ge.uS.MainStoryProperty))({id:e})}):null}for(var a=this.createSubStoryIterator({storyType:t});a.hasNext();){var s=n?a.getProperty():a.getCloneProperty();if(s&&s.id===e){var c=a.getRange(),l=t?new(Ge.kk.getPropertyClass(Ge.uS.StoryProperty))({storyType:t}):null===(r=this.getStoryInfoFromGcp(c.begin()))||void 0===r?void 0:r.storyProp;if(l)return{subStoryProp:s,storyProp:l,range:c,contentRange:a.getContentRange()};break}a.next()}return null},t.prototype.collectCommentStoryInfosFromId=function(e,t){void 0===t&&(t=!1);for(var n=this.createSubStoryIterator({storyType:ne.AHI.commentContent}),r=[];n.hasNext();){var o=t?n.getProperty():n.getCloneProperty();if((null==o?void 0:o.refId)===e){var i=n.getRange(),a=new(Ge.kk.getPropertyClass(Ge.uS.StoryProperty))({storyType:ne.AHI.commentContent});r.push({subStoryProp:o,storyProp:a,range:i,contentRange:n.getContentRange()})}n.next()}return r},t.prototype.getStoryLastPos=function(e){var t;return(null===(t=this.getStoryInfo(e))||void 0===t?void 0:t.contentRange.end())||0},t.prototype.isSameSubStoryRange=function(e){var t=this.getMainStoryInfo();if(null==t?void 0:t.range.contains(e))return!0;var n=this.getSubStoryInfoFromGcp(e.begin());return!!(null==n?void 0:n.range.contains(e))},t.prototype.createStoryIterator=function(e,t){return this.storyPropList.createIterator(this.validRange(e),!!t)},t.prototype.createSubStoryIterator=function(e){var t;void 0===e&&(e={});var n=e.storyType,r=e.limitRange,o=e.isRawIter,i=void 0!==n?null===(t=this.getStoryInfo(n))||void 0===t?void 0:t.range:void 0,a=this.validRange(r);return this.subStoryPropList.createIterator(i?a.intersectRange(i):a,!!o)},t}(Be),Nt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.shrink=function(e,t,n){this.storyPropList.shrink(e,t),this.subStoryPropList.shrink(e,t,(function(e){var t=e.map((function(e){return e.data}));null==n||n.deleteProperty(le.DeleteSubStory,t)}))},t.prototype.extend=function(e,t){this.storyPropList.extend(e,t),this.subStoryPropList.extend(e,t)},t.prototype.setStoryProp=function(e,t,n,r,o){return this.setPropCommon(this.storyPropList,e,t,n,r,o)},t.prototype.setSubStoryProp=function(e,t,n,r,o){return this.setPropCommon(this.subStoryPropList,e,t,n,r,o)},t}(Lt),Bt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.createIterator=function(e,t){return new Z(this,e,t)},t}(He),Ft=function(){function e(e,t){this.begin=e,this.end=t}return Object.defineProperty(e.prototype,"len",{get:function(){return this.end-this.begin},enumerable:!1,configurable:!0}),e.prototype.isContain=function(e){return this.begin<=e.begin&&this.end>=e.end},e.prototype.isIntersect=function(e){return!(this.isLess(e)||e.isLess(this))},e.prototype.isEqual=function(e){return this.begin===e.begin&&this.end===e.end},e.prototype.union=function(t){return new e(Math.min(this.begin,t.begin),Math.max(this.end,t.end))},e.prototype.isLess=function(e){return this.end<=e.begin},e.prototype.hashNum=function(){return(this.begin<<16)+this.end},e.prototype.offset=function(t){return new e(this.begin-t,this.end-t)},e}(),Ut=function(e,t){return new Ft(e,t)},Ht=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.createIterator=function(e,t){return new q(this,e,t)},t}(He),jt=function(){function e(e,t){this.grid=[],this.defaultWidth=0,this.grid=e,this.defaultWidth=t||e[0]||0}return Object.defineProperty(e.prototype,"totalWidth",{get:function(){return this.grid.reduce((function(e,t){return e+t}))},enumerable:!1,configurable:!0}),e.prototype.getWidth=function(e,t){if(0===this.grid.length)return this.defaultWidth;if(0===t)return 0;for(var n=0,r=0;r<t;r++)n+=this.grid[e+r]||0;return n},e.prototype.getSpan=function(e,t){if(0===this.grid.length)return 0;if(0===t)return 0;for(var n=0,r=0,o=e;o<this.grid.length&&(n+=1,!((r+=this.grid[o])>=t));o++);return n},e.prototype.getGridIndex=function(e){for(var t=0,n=0;n<this.grid.length;n++){if(t>=e)return n;t+=this.grid[n]}return this.grid.length-1},e.prototype.getRestSpan=function(e){return this.grid.length-e},e.prototype.getGrid=function(){return this.grid},e.prototype.scale=function(e){this.grid=this.grid.map((function(t){return Math.floor(t*e)}))},e}(),Gt=function(){function e(){this.grid=[],this.stageGrid=[]}return e.prototype.nextRow=function(){this.mergeStageGrid()},e.prototype.addItem=function(e){e<=0||this.stageGrid.push(e)},e.prototype.getGrid=function(){return this.stageGrid.length>0&&this.mergeStageGrid(),this.grid},e.prototype.mergeStageGrid=function(){this.grid=this.mergeGrid(this.grid,this.stageGrid),this.stageGrid.length=0},e.prototype.mergeGrid=function(e,t){for(var n=[];e.length>0&&t.length>0;){var r=e[0],o=t[0];r!==o?r>o?(n.push(t.shift()),e[0]=r-o):(n.push(e.shift()),t[0]=o-r):(n.push(o),e.shift(),t.shift())}return e.length>0&&(n=n.concat(e)),t.length>0&&(n=n.concat(t)),n},e}(),Vt=function(){function e(){this.mergedToMain=new Map,this.mergedCount=new Map,this.colMap=new Map,this.nextColMap=new Map,this.errorMergedCells=[],this.currentRowIndex=0}return e.prototype.addItem=function(e,t){t===O.m7Q.restart?this.addRestartItem(e):t===O.m7Q.continue&&this.addContinueItem(e)},e.prototype.addRestartItem=function(e){var t=this.generateKey(this.currentRowIndex,e.begin);this.mergedCount.set(t,0),this.nextColMap.set(e.hashNum(),t)},e.prototype.addContinueItem=function(e){var t=e.hashNum();if(this.colMap.has(t)){this.nextColMap.set(t,this.colMap.get(t));var n=this.colMap.get(t),r=this.generateKey(this.currentRowIndex,e.begin);this.mergedToMain.set(r,n);var o=this.mergedCount.get(n)||0;this.mergedCount.set(n,o+1)}else this.errorMergedCells.push({rowIndex:this.currentRowIndex,colBegin:e.begin})},e.prototype.nextRow=function(){var e=this.colMap;this.colMap=this.nextColMap,this.nextColMap=e,this.nextColMap.clear(),this.currentRowIndex+=1},e.prototype.isLastMergedCell=function(e,t){var n=this.generateKey(e,t),r=this.mergedToMain.get(n);return void 0!==r&&e-(r>>17)===(this.mergedCount.get(r)||0)},e.prototype.getMergedCount=function(e,t){return this.mergedCount.get(this.generateKey(e,t))||0},e.prototype.clearTmpData=function(){this.colMap.clear()},e.prototype.getMainCell=function(e,t){var n=this.generateKey(e,t);return this.mergedToMain.has(n)?this.decodeKey(this.mergedToMain.get(n)):null},e.prototype.getErrorCells=function(){var e,t,n=[];try{for(var r=(0,i.__values)(this.mergedCount),o=r.next();!o.done;o=r.next()){var a=(0,i.__read)(o.value,2),s=a[0];0===a[1]&&n.push(this.decodeKey(s))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n.concat(this.errorMergedCells)},e.prototype.getErrorMergedCells=function(){return this.errorMergedCells},e.prototype.generateKey=function(e,t){return(e<<17)+t},e.prototype.decodeKey=function(e){return{rowIndex:e>>17,colBegin:131071&e}},e}(),Wt=function(){function e(e,t){void 0===t&&(t=50),this.tableMap=new Map,this.tableStream=e,this.maxCacheSize=t}return e.prototype.getGrid=function(e){var t=e.property.tblId;return this.tableMap.has(t)?this.tableMap.get(t).grid:this.buildCacheItem(t,e).grid},e.prototype.getMergedMapping=function(e){var t=e.property.tblId;return this.tableMap.has(t)?this.tableMap.get(t).mergedMapping:this.buildCacheItem(t,e).mergedMapping},e.prototype.clearCache=function(e){this.tableMap.delete(e.property.tblId)},e.prototype.clearFromDirtyRange=function(e){var t,n;try{for(var r=(0,i.__values)(e),o=r.next();!o.done;o=r.next()){var a=o.value;this.tableMap.delete(a)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e.prototype.buildCacheItem=function(e,t){var n,r;this.clearIfExceedSize();for(var o=t.property.nestingLevel,a=this.tableStream.createRowIterator({limitRange:t.contentRange,nestingLevel:o}),s=new Gt,c=new Vt;a.hasNext();){var l=this.tableStream.getCellsOfRowRange(a.getContentRange(!0),o);s.addItem(l.row.property.wBefore.w);try{for(var u=(n=void 0,(0,i.__values)(l.cells)),d=u.next();!d.done;d=u.next()){var p=d.value;s.addItem(p.interval.len),c.addItem(p.interval,p.property.vMerge)}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}s.nextRow(),c.nextRow(),a.next()}c.clearTmpData();var h={grid:new jt(s.getGrid()),mergedMapping:c};return this.tableMap.set(e,h),h},e.prototype.clearIfExceedSize=function(){if(!(this.tableMap.size<this.maxCacheSize)){for(var e=new Map,t=this.tableStream.createTableIterator();t.hasNext();){var n=t.getCloneProperty().tblId,r=this.tableMap.get(n);r&&e.set(n,r),t.next()}e.size>=this.maxCacheSize&&(this.maxCacheSize*=2),this.tableMap.clear(),this.tableMap=e}},e}();!function(e){e[void 0]="not_vertical_merge_cell",e.main="vertical_merge_main_cell",e.middle="vertical_merge_middle_cell",e.last="vertical_merge_last_cell"}(bt||(bt={}));var zt=function(e){return Number(e.w)},Kt=function(){var e=new(O.kkf.getPropertyClass(O.uSS.TableProperty));return e.tblPr.tblLayout.type=ne.rG7.fixed,e};function qt(e,t){var n,r;try{for(var o=(0,i.__values)(t.cells),a=o.next();!a.done;a=o.next()){var s=a.value;if(s.interval.begin>=e.interval.end)return bt.last;if(s.property.vMerge===ne.m7Q.continue&&e.interval.isEqual(s.interval))return bt.middle}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return bt.last}function Yt(e){var t=[];return e.cells.forEach((function(e){e.property.vMerge!==ne.m7Q.restart?e.property.vMerge!==ne.m7Q.undefined?t.push(bt.last):t.push(bt.undefined):t.push(bt.main)})),t}function Qt(e,t){var n=[];return e.cells.forEach((function(e){e.property.vMerge!==ne.m7Q.restart?e.property.vMerge!==ne.m7Q.undefined?n.push(qt(e,t)):n.push(bt.undefined):n.push(bt.main)})),n}var Zt=function(e,t){return t.isEmpty(O.kkf.getPropertyClass(O.uSS.TableCellProperty).tKeys.tcMar)?e.tblPr.tblCellMar:t.tcMar},Xt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.createIterator=function(e,t){return new Q(this,e,t)},t}(He),Jt=function(){function e(e,t,n){if(0===t.length)throw new Error(" GCPRange  TableCellRange ");this.tableStream=e,this.rowRanges=t,this.nestingLevel=n}return Object.defineProperty(e.prototype,"rowCount",{get:function(){var e=this;return this.rowRanges.reduce((function(t,n){return e.tableStream.getRowCountFromRange(n,e.nestingLevel)+t}),0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"colCount",{get:function(){var e=this;return this.getSplitRowRanges().reduce((function(t,n){return Math.max(e.tableStream.getCellCountFromRange(n,e.nestingLevel),t)}),0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"begin",{get:function(){return this.rowRanges[0].begin()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this.rowRanges[this.rowRanges.length-1].end()},enumerable:!1,configurable:!0}),e.prototype.eachCell=function(e){var t,n;try{for(var r=(0,i.__values)(this.rowRanges),o=r.next();!o.done;o=r.next()){var a=o.value,s=this.tableStream.getTableInfo(a.begin(),this.nestingLevel);if(s)for(var c=this.tableStream.createRowIterator({limitRange:s.contentRange.intersectRange(a),nestingLevel:s.property.nestingLevel});c.hasNext();){for(var l=ht(c),u=this.tableStream.createCellIterator({nestingLevel:this.nestingLevel,limitRange:a.intersectRange(c.getContentRange(!0))});u.hasNext();){if(e(ht(u),l))return;u.next()}c.next()}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e.prototype.isEqualToTable=function(){if(this.rowRanges.length>1)return!1;var e=this.rowRanges[0],t=this.tableStream.getTableInfo(e.begin(),this.nestingLevel);if(!t)return!1;var n=t.range,r=t.contentRange;return n.equal(e)||r.equal(e)},e.prototype.isEqualToCell=function(){if(this.rowRanges.length>1)return!1;var e=this.rowRanges[0],t=this.tableStream.getCellInfo(e.begin(),this.nestingLevel);return(null==t?void 0:t.range.equal(e))||!1},e.prototype.isContain=function(e){return this.rowRanges.some((function(t){return t.contains(e)}))},e.prototype.isIntersect=function(e){return this.rowRanges.some((function(t){return t.intersect(e)}))},e.prototype.splitToCellGCPRanges=function(){var e=[];return this.eachCell((function(t){e.push(t.range)})),e},e.prototype.getRanges=function(){return this.rowRanges},e.prototype.getSplitRowRanges=function(){if(1!==this.rowRanges.length)return this.rowRanges;for(var e=this.tableStream.createRowIterator({limitRange:this.rowRanges[0],nestingLevel:this.nestingLevel}),t=[];e.hasNext();)t.push(e.getRange(!0)),e.next();return t},e}(),$t=function(){function e(e,t,n,r){this.tableStream=e,this.cellRanges=t,this.selectedRange=n,this.nestingLevel=r}return e.create=function(e,t){return e.createSelectionArea(t)},Object.defineProperty(e.prototype,"firstCellRange",{get:function(){return this.cellRanges[0]||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"begin",{get:function(){return this.isInnerCell()?this.selectedRange.begin():this.cellRanges[0].begin},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this.isInnerCell()?this.selectedRange.end():this.cellRanges[this.cellRanges.length-1].end},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"range",{get:function(){return new b.IC(this.begin,this.end-this.begin)},enumerable:!1,configurable:!0}),e.prototype.isInnerCell=function(e){var t;if(this.firstCellRange)return!1;var n=null===(t=this.tableStream.getCellInfo(this.selectedRange.begin(),this.nestingLevel))||void 0===t?void 0:t.range;return!!n&&!!new b.IC(n.begin(),n.len-1).contains(null!=e?e:this.selectedRange)},e.prototype.isInnerTable=function(){if(!this.firstCellRange)return!1;if(this.cellRanges.length>1)return!1;var e=this.firstCellRange,t=e.begin,n=e.end;return!(this.selectedRange.begin()<t||this.selectedRange.end()>n)},e.prototype.isWholeTable=function(){return this.isInnerTable()&&!!this.firstCellRange&&this.firstCellRange.isEqualToTable()},e.prototype.isWholeRows=function(){if(!this.isInnerTable()||this.isWholeTable())return!1;var e=this.tableStream.getRowInfo(this.selectedRange.begin(),this.nestingLevel);if(!e)return!1;var t=e.range;return this.begin===t.begin()&&this.isContainRange(t)},e.prototype.isWholeCols=function(){if(!this.isInnerTable()||this.isWholeTable()||this.isWholeRows())return!1;var e=this.tableStream.getTableInfo(this.selectedRange.begin(),this.nestingLevel);if(!e)return!1;var t=this.tableStream.getRowInfo(e.contentRange.begin(),this.nestingLevel),n=this.tableStream.getRowInfo(e.contentRange.end()-1,this.nestingLevel);if(!t||!n)return!1;var r=this.isIntersectRange(t.range),o=this.isIntersectRange(n.range);return r&&o},e.prototype.isCrossTable=function(){return!this.isInnerTable()&&!this.isInnerCell()},e.prototype.isContainRange=function(e){return 0===this.cellRanges.length?this.selectedRange.contains(e):this.cellRanges.some((function(t){return t.isContain(e)}))},e.prototype.isIntersectRange=function(e){return 0===this.cellRanges.length?this.selectedRange.intersect(e):this.cellRanges.some((function(t){return t.isIntersect(e)}))},e}(),en=function(){function e(e,t){this.nestingLevel=1,this.tableStream=e,this.gcpRange=t,this.table=this.locateTable(t),this.table&&(this.nestingLevel=this.table.property.nestingLevel)}return e.prototype.create=function(){return this.table?this.gcpRange.isEmpty()?this.createCellInsideArea():this.createTableInsideArea():this.createCrossTableArea()},e.prototype.createCellInsideArea=function(){return this.createAreaFromCellRange([])},e.prototype.createCrossTableArea=function(){for(var e=[],t=this.tableStream.createTableIterator({limitRange:this.gcpRange,nestingLevel:this.nestingLevel});t.hasNext();)e.push(new Jt(this.tableStream,[t.getRange()],this.nestingLevel)),t.next();return 0===e.length?null:new $t(this.tableStream,e,this.gcpRange,this.nestingLevel)},e.prototype.createTableInsideArea=function(){var e;if(this.determineIsInsideCell())return this.createCellInsideArea();if(this.isEqualToTableRange())return this.createAreaFromGCPRange((null===(e=this.table)||void 0===e?void 0:e.range)||this.gcpRange);var t=this.getUnionCellInterval();if(!t)return this.selectParentElement();var n=this.getIntersectCells(t);if(0===n.length)return null;var r=n[0].begin(),o=n[n.length-1].end();return this.createAreaFromCellRange([this.createTableCellRange(n)],new b.IC(r,o-r))},e.prototype.selectParentElement=function(){if(!this.table)return null;var e=this.tableStream.getRowInfo(this.gcpRange.begin(),this.nestingLevel),t=this.tableStream.getRowInfo(this.gcpRange.end()-1,this.nestingLevel);return e&&t?this.createAreaFromGCPRange(e.range.unionRange(t.range)):this.createAreaFromGCPRange(this.table.range)},e.prototype.isEqualToTableRange=function(){return!!this.table&&(this.gcpRange.end()===this.table.range.end()||this.gcpRange.begin()===this.table.range.begin())},e.prototype.determineIsInsideCell=function(){var e=this.tableStream.getNearestNextCell(this.gcpRange.begin(),this.nestingLevel),t=this.tableStream.getNearestPreviousCell(this.gcpRange.end()-1,this.nestingLevel);return e&&t?e.range.equal(t.range)?(this.gcpRange=this.gcpRange.intersectRange(e.range),e.contentRange.contains(this.gcpRange)):t.range.begin()<e.range.begin()&&(this.gcpRange=new b.IC(t.contentRange.end()-1),!0):(t&&(this.gcpRange=new b.IC(t.contentRange.end()-1)),e&&(this.gcpRange=new b.IC(e.contentRange.begin())),!1)},e.prototype.getIntersectCells=function(e){var t=[];return this.forEachRow(this.gcpRange,(function(n){var r,o,a=new b.IC(Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);try{for(var s=(0,i.__values)(n.cells),c=s.next();!c.done;c=s.next()){var l=c.value;if(e.isLess(l.interval))break;l.interval.isLess(e)||(a=a.unionRange(l.range))}}catch(e){r={error:e}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}a.isEmpty()||t.push(n.contentRange.equal(a)?n.range:a)})),t},e.prototype.forEachRow=function(e,t){var n=this.tableStream.getRowInfo(this.offsetTablePlaceholder(e.begin()),this.nestingLevel),r=this.tableStream.getRowInfo(this.offsetTablePlaceholder(e.end()-1),this.nestingLevel);if(n&&r)for(var o=this.tableStream.createRowIterator({limitRange:n.range.unionRange(r.range),nestingLevel:this.nestingLevel});o.hasNext();){var i=o.getRange(!0),a=this.tableStream.getCellsOfRowRange(i,this.nestingLevel);if(a&&!1===t({cells:a.cells,range:a.row.range,contentRange:a.row.contentRange}))return;o.next()}},e.prototype.locateTable=function(e){var t=this.tableStream.getTableInfo(e.begin());if(e.isEmpty())return t;var n=this.tableStream.getTableInfo(e.end()-1);if(!n||!t)return null;if(t.range.equal(n.range))return t;var r=t.property.nestingLevel,o=n.property.nestingLevel,i=this.resolveParentTable(e,Math.min(r,o));return i&&(this.gcpRange=this.expandTableRange(e,i.property.nestingLevel+1)),i},e.prototype.resolveParentTable=function(e,t){for(var n=t;n>=1;n--){var r=this.tableStream.getTableInfo(e.begin(),n);if(null==r?void 0:r.range.contains(e))return r}return null},e.prototype.expandTableRange=function(e,t){var n=this.tableStream.getTableInfo(e.begin(),t),r=this.tableStream.getTableInfo(e.end()-1,t),o=e;return n&&(o=o.unionRange(n.range)),r&&(o=o.unionRange(r.range)),o},e.prototype.getUnionCellInterval=function(){var e=this.tableStream.getCellInterval(this.gcpRange.begin(),this.nestingLevel),t=this.tableStream.getCellInterval(this.gcpRange.end()-1,this.nestingLevel);return e&&t?e.union(t):null},e.prototype.createAreaFromCellRange=function(e,t){return new $t(this.tableStream,e,t||this.gcpRange,this.nestingLevel)},e.prototype.createAreaFromGCPRange=function(e){return this.createAreaFromCellRange([this.createTableCellRange(e)])},e.prototype.createTableCellRange=function(e){var t=Array.isArray(e)?this.mergeRowRanges(e):e;return new Jt(this.tableStream,Array.isArray(t)?t:[t],this.nestingLevel)},e.prototype.mergeRowRanges=function(e){if(0===e.length)return e;for(var t=e[0],n=1;n<e.length;n++){if(t.end()!==e[n].begin())return e;t=t.unionRange(e[n])}return t},e.prototype.offsetTablePlaceholder=function(e){return this.table?this.table.range.begin()===e?e+1:this.table.range.end()-1===e?e-1:e:e},e}(),tn=function(e){function t(t){var n=e.call(this,t)||this;n.tableCache=new Wt(n);var r=n.validRange.bind(n);return n.tablePropCollection=new ft((function(){return new Xt}),r),n.rowPropCollection=new ft((function(){return new Ht}),r),n.cellPropCollection=new ft((function(){return new Bt}),r),n.rowPropCollection.openSkipList(n.createRowIterator.bind(n)),n}return(0,i.__extends)(t,e),Object.defineProperty(t.prototype,"maxLevel",{get:function(){return this.tablePropCollection.maxLevel},enumerable:!1,configurable:!0}),t.prototype.createTableIterator=function(e){return this.tablePropCollection.createIterator(e)},t.prototype.createRowIterator=function(e){return this.rowPropCollection.createIterator(e)},t.prototype.createCellIterator=function(e){return this.cellPropCollection.createIterator(e)},t.prototype.getTableInfo=function(e,t){return this.tablePropCollection.getInfo(e,t)},t.prototype.getRowInfo=function(e,t){var n=this.getTableInfo(e,t);if(!n)return null;var r=this.rowPropCollection.getInfo(e,n.property.nestingLevel,n.contentRange);return r||t||n.property.nestingLevel<=1?r:this.getRowInfo(e,n.property.nestingLevel-1)},t.prototype.getCellInfo=function(e,t){var n=this.getRowInfo(e,t);if(!n)return null;var r=this.cellPropCollection.getInfo(e,n.property.nestingLevel,n.contentRange);return r||t||n.property.nestingLevel<=1?r:this.getCellInfo(e,n.property.nestingLevel-1)},t.prototype.getCellTblStylePrInfo=function(e){var t=this.getCellInfo(e);if(!t)return null;var n=this.getRowInfo(e),r=this.getTableInfo(e);if(!n||!r)return null;var o=r.property,i={styleId:o.tblPr.tblStyle,tblLook:o.tblPr.tblLook},a=this.getCellIndex(e,r.nestingLevel),s=this.getRowIndex(e,r.nestingLevel);return-1===a||-1===s?null:{tableCellPos:{cellIndex:a,rowIndex:s,isLastCell:t.range.end()===n.contentRange.end(),isLastRow:n.range.end()===r.contentRange.end()},tblStylePrLook:i}},t.prototype.getRowCountFromRange=function(e,t){void 0===t&&(t=1);var n=this.getTableInfo(e.begin(),t);if(!n)return 0;for(var r=0,o=this.createRowIterator({limitRange:e.intersectRange(n.contentRange),nestingLevel:t});o.hasNext();)r+=1,o.next();return r},t.prototype.getCellCountFromRange=function(e,t){void 0===t&&(t=1);var n=this.getRowInfo(e.begin(),t);if(!n)return 0;for(var r=0,o=this.createCellIterator({limitRange:n.contentRange.intersectRange(e),nestingLevel:t});o.hasNext();)r+=1,o.next();return r},t.prototype.getCellsOfRowRange=function(e,t){void 0===t&&(t=1);var n=this.getTableInfo(e.begin(),t),r=this.getRowInfo(e.begin(),t);if(!n||!r)return null;for(var o=[],i=this.createCellIterator({limitRange:r.contentRange,nestingLevel:t}),a=zt(r.property.wBefore);i.hasNext();){var s=i.getProperty(),c=zt(s.tcW);e.intersect(i.getRange(!0))&&o.push({interval:Ut(a,a+c),property:s,range:i.getRange(!0),contentRange:i.getContentRange(!0)}),a+=c,i.next()}return{cells:o,table:n,row:r}},t.prototype.getCellsVMergeStatusOfRowRange=function(e,t){var n=this.getCellsOfRowRange(e,t),r=this.getCellsOfRowRange(new b.IC(e.end()+1,1),t);return n?r?Qt(n,r):Yt(n):null},t.prototype.isIncludeVMergeContinueCellInRow=function(e,t){var n,r,o=this.getTableInfo(e),a=this.getRowInfo(e);if(!o||!a)return!1;var s=this.getCellsOfRowRange(a.range,t);try{for(var c=(0,i.__values)(s.cells),l=c.next();!l.done;l=c.next())if(l.value.property.vMerge===ne.m7Q.continue)return!0}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return!1},t.prototype.getCellInterval=function(e,t){void 0===t&&(t=1);var n=this.getTableInfo(e,t);if(!n)return null;if(e===n.range.begin())return Ut(0,0);var r=this.getRowInfo(e===n.range.end()-1?e-1:e,t);if(!r)return null;for(var o=this.createCellIterator({limitRange:r.contentRange,nestingLevel:t}),i=zt(r.property.wBefore);o.hasNext();){var a=o.getProperty(),s=zt(a.tcW);if(o.getRange(!0).contains(e))return Ut(i,i+s);i+=s,o.next()}return Ut(i,i)},t.prototype.createSelectionArea=function(e){return new en(this,e).create()},t.prototype.getGridManager=function(e,t){void 0===t&&(t=1);var n=this.getTableInfo(e,t);return n?this.tableCache.getGrid(n):null},t.prototype.getMergedMapping=function(e,t){void 0===t&&(t=1);var n=this.getTableInfo(e,t);return n?this.tableCache.getMergedMapping(n):null},t.prototype.getNearestPreviousCell=function(e,t){return void 0===t&&(t=1),this.getNearestCell(e,-1,t)},t.prototype.getNearestNextCell=function(e,t){return void 0===t&&(t=1),this.getNearestCell(e,1,t)},t.prototype.onModelChange=function(e){e&&this.tableCache.clearFromDirtyRange(this.collectTableInfos(e).map((function(e){return e.property.tblId})))},t.prototype.createMergedMapping=function(e){var t=new Vt,n=this.createSelectionArea(e);if(!(null==n?void 0:n.isInnerTable()))return t;var r,o=n.cellRanges[0],i=0;return o.eachCell((function(e,n){r||(r=n),r.range.notEqual(n.range)&&(t.nextRow(),i=0,r=n);var o=zt(e.property.tcW);t.addItem(Ut(i,i+o),e.property.vMerge),i+=o})),t},t.prototype.getRowIndex=function(e,t){void 0===t&&(t=1);var n=this.getTableInfo(e,t);if(!n)return-1;for(var r=this.createRowIterator({limitRange:n.contentRange,nestingLevel:t}),o=0;r.hasNext();){if(r.getRange(!0).contains(e))return o;o+=1,r.next()}return-1},t.prototype.getCellIndex=function(e,t){void 0===t&&(t=1);var n=this.getRowInfo(e,t);if(!n)return-1;for(var r=this.createCellIterator({limitRange:n.contentRange,nestingLevel:t}),o=0;r.hasNext();){if(r.getRange(!0).contains(e))return o;o+=1,r.next()}return-1},t.prototype.collectTableInfos=function(e){if(0===e.length)return[];var t=e[e.length-1],n=this.getTableInfo(Math.max(t.begin(),t.end()-1)),r=this.collectTableInfosByNestingLevel(e,(null==n?void 0:n.property.nestingLevel)||1);return 0===r.length&&n&&r.push(n),r},t.prototype.convertToTableRanges=function(e){return this.collectTableInfos(e).map((function(e){return e.range}))},t.prototype.collectTableInfosByNestingLevel=function(e,t){for(var n=e[0].begin(),r=e[e.length-1].end(),o=new b.IC(n,r-n),i=this.createTableIterator({limitRange:o,nestingLevel:t}),a=[],s=0;i.hasNext();){var c=i.getProperty(),l=c?{range:i.getRange(),property:c,contentRange:i.getContentRange()}:null;if(l){var u=this.splitIntersectRanges(s,e,l.range),d=u.nextIndex,p=u.ranges;p.length>0&&(a.push(l),a=a.concat(this.collectTableInfosByNestingLevel(p,t+1))),s=d}i.next()}return a},t.prototype.getNearestCell=function(e,t,n){void 0===n&&(n=1);var r=e;if(!this.getTableInfo(r,n))return null;this.getRowInfo(r,n)||(r+=t);var o=this.getCellInfo(r,n);return o||this.getCellInfo(r+t,n)},t.prototype.splitIntersectRanges=function(e,t,n){for(var r=[],o=e;o<t.length&&t[o].intersect(n)&&(r.push(t[o].intersectRange(n)),!(t[o].end()>n.end()));o++);return{ranges:r,nextIndex:o}},t}(Be),nn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.extend=function(e,t){this.tablePropCollection.extend(e,t),this.rowPropCollection.extend(e,t),this.cellPropCollection.extend(e,t)},t.prototype.shrink=function(e,t){this.tablePropCollection.shrink(e,t),this.rowPropCollection.shrink(e,t),this.cellPropCollection.shrink(e,t)},t.prototype.setTableProp=function(e,t,n,r,o){return this.tablePropCollection.setProp(e,t,n,r,o)},t.prototype.setRowProp=function(e,t,n,r,o){return this.rowPropCollection.setProp(e,t,n,r,o)},t.prototype.setCellProp=function(e,t,n,r,o){return this.cellPropCollection.setProp(e,t,n,r,o)},t}(tn),rn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.createIterator=function(e,t){return new te(this,e,t)},t}(He);function on(e,t,n){var r;return t?n?(n.modifiedProp.assign(t.modifiedProp),n.inverseProp.assign(t.inverseProp),null===(r=n.inverseProps)||void 0===r||r.push({prop:t.inverseProp.clone(),range:e}),n):(t.inverseProps=[{prop:t.inverseProp.clone(),range:e}],t):n}var an,sn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.firstInsertProp=function(t,n,r){return!this.seek(t).data()&&(e.prototype.insertProp.call(this,t+n,r),!0)},t.prototype.insertPropEx=function(t,n,r,o,i){var a,s,c=this.seek(t),l=e.prototype.range.call(this,c),u=o.clone(),d=i?{modifiedProp:u.clone(),inverseProp:null!==(s=null===(a=c.data())||void 0===a?void 0:a.clone())&&void 0!==s?s:new(O.kkf.getPropertyClass(O.uSS.RunProperty))}:void 0;if(!Fe.vC.isEqualProp(u,c.data())&&(l.begin()<t&&e.prototype.split.call(this,t,c.data()),l.end()>t+n&&(c=e.prototype.split.call(this,t+n,u)),t<=l.begin()&&0!==t)){var p=c.copy();p.prev(),Fe.vC.canMergeProp(u,p.data())&&e.prototype.merge.call(this,p)}if(l.end()===t+n){var h=c.copy();h.next(),h.notEqual(this.end())&&u&&Fe.vC.canMergeProp(u,h.data())&&e.prototype.merge.call(this,c)}return d},t.prototype.modifyProp=function(t,n,r,o,i){var a;if(!this.firstInsertProp(t,n,o)){if(r===G.XS.Insert)return this.insertPropEx(t,n,r,o,i);for(var s=this.seek(t),c=new b.IC(t,n),l=void 0;s.notEqual(this.end());){var u=e.prototype.range.call(this,s),d=null===(a=s.data())||void 0===a?void 0:a.clone(),p=Fe.vC.modifyProps(r,o,d,i);if(d&&!Fe.vC.isEqualProp(d,s.data())&&(u.begin()<t&&e.prototype.split.call(this,t,s.data()),u.end()>t+n&&(s=e.prototype.split.call(this,t+n,s.data())),s.setData(d),t<=u.begin()&&0!==t)){var h=s.copy();h.prev(),Fe.vC.canMergeProp(d,h.data())&&e.prototype.merge.call(this,h)}if(l=on(c.intersectRange(u),p,l),u.end()>=t+n){if(u.end()===t+n){var f=s.copy();f.next(),f.notEqual(this.end())&&d&&Fe.vC.canMergeProp(d,f.data())&&e.prototype.merge.call(this,s)}break}s.next()}return l}},t.prototype.shrink=function(t,n){var r=this.seek(t);if(e.prototype.rangeBegin.call(this,r)!==t?r=e.prototype.split.call(this,t,r.data()):r.prev(),e.prototype.shrink.call(this,t,n),r.notEqual(this.end())){var o=r.copy();o.next(),o.notEqual(this.end())&&Fe.vC.canMergeProp(r.data(),o.data())&&e.prototype.merge.call(this,r)}},t.prototype.createIterator=function(e,t){return new ee(this,e,t)},t}(He),cn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.shrink=function(e,t,n){this.runPropList.shrink(e,t),this.paraPropList.shrink(e,t,(function(e){var t=e.map((function(e){return e.data}));null==n||n.deleteProperty(le.DeletePara,t)}))},t.prototype.extend=function(e,t){this.runPropList.extend(e,t),this.paraPropList.extend(e,t)},t.prototype.setRunProp=function(e,t,n,r,o){return this.runPropList.modifyProp(e,t,n,r,o)},t.prototype.setParagraphProp=function(e,t,n,r,o){return this.setPropCommon(this.paraPropList,e,t,n,r,o)},t}(function(e){function t(t){var n=e.call(this,t)||this;return n.runPropList=new sn,n.paraPropList=new rn,n}return(0,i.__extends)(t,e),t.prototype.getIndexFromGCP=function(e){return this.textPool.cp2bp(e)},t.prototype.getGCPFromIndex=function(e){return this.textPool.bp2cp(e)},t.prototype.getRangeFromIndex=function(e,t){var n=this.textPool.bp2cp(e),r=this.textPool.bp2cp(t)+1;return new b.IC(n,r-n)},t.prototype.getLength=function(){return this.textPool.size()-1},t.prototype.charAt=function(e){return this.checkValidityGCP(e)?this.textPool.charAt(e):""},t.prototype.charCodeAt=function(e){return this.checkValidityGCP(e)?this.textPool.charCodeAt(e):0},t.prototype.readText=function(e,t){if(!this.checkValidityGCP(e))return"";var n=this.constraintToValidityLength(e,t);return this.textPool.subText(e,n)},t.prototype.createRunIterator=function(e,t){return this.runPropList.createIterator(this.validRange(e),!!t)},t.prototype.createParagraphIterator=function(e,t){return this.paraPropList.createIterator(this.validRange(e),!!t)},t}(Be)),ln=2048,un=function(){function e(e){void 0===e&&(e=""),this._lastIdx=0,this._endIdx=ln,this._originStr=e,this._poolPages=[],this._strPool=new Uint16Array(ln),this._poolPages.push(this._strPool)}return e.prototype.append=function(e){for(var t=this.size(),n=0;n<e.length;n++){var r=e.charCodeAt(n);this._strPool[this._lastIdx]=r,this._lastIdx+=1,this._lastIdx===this._endIdx&&this._appendPage()}return t},e.prototype.charAt=function(e){return e<0||e>=this.size()?"":String.fromCharCode(this.charCodeAt(e))},e.prototype.charCodeAt=function(e){if(e<0||e>=this.size())return-1;if(e<this._originStr.length)return this._originStr.charCodeAt(e);var t=e-this._originStr.length,n=Math.floor(t/ln),r=t%ln;return this._poolPages[n][r]},e.prototype.subText=function(e,t){if(t<1)return"";if(1===t)return this.charAt(e);var n="";if(e<0||e>=this.size())return n;var r=e,o=Math.min(t,this.size()-e);if(r<this._originStr.length){if(r+o<=this._originStr.length)return n=this._originStr.substr(r,o);var a=this._originStr.length-r;n=this._originStr.substr(r,a),o-=a,r=0}else r-=this._originStr.length;for(var s=Math.floor(r/ln),c=r%ln,l=this._poolPages[s];;){if(!(o>l.length-c)){u=l.subarray(c,c+o),n=n.concat(String.fromCharCode.apply(String,(0,i.__spreadArray)([],(0,i.__read)(Array.from?Array.from(u):[].slice.call(u)),!1)));break}var u=l.subarray(c,l.length);n=n.concat(String.fromCharCode.apply(String,(0,i.__spreadArray)([],(0,i.__read)(Array.from?Array.from(u):[].slice.call(u)),!1))),o-=l.length-c,c=0,s+=1,l=this._poolPages[s]}return n},e.prototype.size=function(){return this._originStr.length+(this._poolPages.length-1)*ln+this._lastIdx},e.prototype.empty=function(){return this._originStr.length<=0&&this._poolPages.length<=1&&this._lastIdx<=0},e.prototype._appendPage=function(){this._strPool=new Uint16Array(ln),this._lastIdx=0,this._poolPages.push(this._strPool)},e}(),dn=function(e){function t(t,n,r){var o=e.call(this)||this;if(o._textBuffer=t,o._mirrorTree=n,void 0!==r&&r>=0){var i=o._mirrorTree.policy1().find(o._mirrorTree.header(),r);if(o._node=i.node,o._node){var a=o._mirrorTree.policy2().position(o._node);o._bp=a+i.off,o._maxBP=a+o._mirrorTree.policy2().len(o._node),o._minBP=a}else o._node=o._mirrorTree.header(),o._bp=-1,o._maxBP=-1,o._minBP=-1}else o._node=o._mirrorTree.header(),o._bp=-1,o._maxBP=-1,o._minBP=-1;return o}return(0,i.__extends)(t,e),t.prototype.getCP=function(){return this._mirrorTree.backwardMapping(this._bp,-1)},t.prototype.getBP=function(){return this._bp},t.prototype.copy=function(){return new t(this._textBuffer,this._mirrorTree,this.getCP())},t.prototype.data=function(){return this._textBuffer.charAt(this._bp)},t.prototype.next=function(){return this._bp+=1,this._bp===this._maxBP&&(this._node=this._mirrorTree.policy1().next(this._node),this._node!==this._mirrorTree.header()?(this._bp=this._mirrorTree.policy2().position(this._node),this._maxBP=this._bp+this._mirrorTree.policy2().len(this._node),this._minBP=this._bp):(this._bp=-1,this._maxBP=-1,this._minBP=-1)),this},t.prototype.prev=function(){return this._bp===this._minBP?(this._node=this._mirrorTree.policy1().prev(this._node),this._node!==this._mirrorTree.header()?(this._minBP=this._mirrorTree.policy2().position(this._node),this._maxBP=this._minBP+this._mirrorTree.policy2().len(this._node),this._bp=this._maxBP-1):(this._bp=-1,this._maxBP=-1,this._minBP=-1)):this._bp-=1,this},t.prototype.equal=function(e){return this._node===e._node&&this._bp===e._bp},t}(a),pn=function(){function e(e){void 0===e&&(e=""),this._textBuffer=new un(e),this._mirrorTree=new E,this._mirrorTree.mapping(0,0,e.length),this._size=e.length}return e.prototype.append=function(e){var t=this._textBuffer.append(e),n=this.size();this._mirrorTree.mapping(n,t,e.length),this._setSize(this.size()+e.length)},e.prototype.insert=function(e,t){if(!(e>this.size())){var n=this._textBuffer.append(t);this._mirrorTree.insertSpace1(e,t.length),this._mirrorTree.mapping(e,n,t.length),this._setSize(this.size()+t.length)}},e.prototype.erase=function(e,t){if(!(e>this.size())){var n=t;e+t>this.size()&&(n=this.size()-e),this._mirrorTree.eraseSpace1(e,n),this._setSize(this.size()-n)}},e.prototype.size=function(){return this._size},e.prototype.empty=function(){return this._size<=0},e.prototype.charAt=function(e){return this._textBuffer.charAt(this.cp2bp(e))},e.prototype.charCodeAt=function(e){return this._textBuffer.charCodeAt(this.cp2bp(e))},e.prototype.subText=function(e,t){var n=this;if(t<1)return"";if(1===t)return this.charAt(e);var r=this._mirrorTree.forwardSpace(e,t,-1),o=[];return r.forEach((function(e){o.push(n._textBuffer.subText(e.begin(),e.length()))})),o.join("")},e.prototype.seek=function(e){return new dn(this._textBuffer,this._mirrorTree,e)},e.prototype.end=function(){return new dn(this._textBuffer,this._mirrorTree)},e.prototype.garbageCollection=function(){var e=this.subText(0,this.size());this._textBuffer=new un(e),this._mirrorTree=new E,this._mirrorTree.mapping(0,0,e.length),this._size=e.length},e.prototype.cp2bp=function(e){return this._mirrorTree.forwardMapping(e,-1)},e.prototype.bp2cp=function(e){return this._mirrorTree.backwardMapping(e,-1)},e.prototype.iter2cp=function(e){return e.getCP()},e.prototype.iter2bp=function(e){return e.getBP()},e.prototype._setSize=function(e){return this._size=e,this._size},e}(),hn=function(){function e(e){this.streamList=[],this.newFontNamesCache=new Set,this.textPool=new pn("".concat(e||"").concat(k.If.ZeroSpace))}return e.prototype.setNotification=function(e){this.notification=e;var t=this.getNotificationCenter();t&&this.getAnnotationStream().setNotificationCenter(t)},e.prototype.getNotificationCenter=function(){var e;return null===(e=this.notification)||void 0===e?void 0:e.getNotificationCenter()},e.prototype.getTextStream=function(){return this.textStream||(this.textStream=new cn(this.textPool),this.streamList.push(this.textStream)),this.textStream},e.prototype.getSectionStream=function(){return this.sectionStream||(this.sectionStream=new Dt(this.textPool),this.streamList.push(this.sectionStream)),this.sectionStream},e.prototype.getStoryStream=function(){return this.storyStream||(this.storyStream=new Nt(this.textPool),this.streamList.push(this.storyStream)),this.storyStream},e.prototype.getTableStream=function(){return this.tableStream||(this.tableStream=new nn(this.textPool),this.streamList.push(this.tableStream)),this.tableStream},e.prototype.getFieldStream=function(){return this.fieldStream||(this.fieldStream=new Ct(this.textPool,this.getTextStream()),this.streamList.push(this.fieldStream)),this.fieldStream},e.prototype.getDrawingStream=function(){return this.drawingStream||(this.drawingStream=new Ye(this.textPool),this.streamList.push(this.drawingStream)),this.drawingStream},e.prototype.getNotesStream=function(){return this.notesStream||(this.notesStream=new It(this.textPool),this.streamList.push(this.notesStream)),this.notesStream},e.prototype.getMathStream=function(){return this.mathStream||(this.mathStream=new xt(this.textPool),this.streamList.push(this.mathStream)),this.mathStream},e.prototype.getSdtStream=function(){return this.sdtStream||(this.sdtStream=new Ot(this.textPool),this.streamList.push(this.sdtStream)),this.sdtStream},e.prototype.getAnnotationStream=function(){return this.annotationStream||(this.annotationStream=new We(this.textPool,this.createRangeClass(!1,!1),this.createRangeClass(!1,!1),this.createRangeClass(!1,!1),this.createRangeClass(!1,!1),this.createRangeClass(!1,!1)),this.streamList.push(this.annotationStream)),this.annotationStream},e.prototype.setRunProp=function(e,t,n,r,o,i){var a;if(!(t<1)){var s=this.getTextStream();if(s.checkValidityGCP(e)){var c=s.constraintToValidityLength(e,t),l=s.setRunProp(e,c,n,r,o);return null===(a=this.notification)||void 0===a||a.setRunProp(e,c,n,i),this.handleNewRunProperty(r),l}}},e.prototype.setParagraphProp=function(e,t,n,r,o,i){var a;if(1===t){var s=this.getTextStream();if(s.checkValidityGCP(e)){var c=s.constraintToValidityLength(e,t),l=s.setParagraphProp(e,c,n,r,o);return null===(a=this.notification)||void 0===a||a.setParagraphProp(e,c,n,i),l}}},e.prototype.setSectionProp=function(e,t,n,r,o){var i;if(1===t){var a=this.getSectionStream();if(a.checkValidityGCP(e)){var s=a.constraintToValidityLength(e,t),c=a.setSectionProp(e,s,n,r,o);return null===(i=this.notification)||void 0===i||i.setSectionProp(e,s,n),c}}},e.prototype.setSubStoryProp=function(e,t,n,r,o){var i;if(1===t){var a=this.getStoryStream();if(a.checkValidityGCP(e)){var s=a.constraintToValidityLength(e,t),c=a.setSubStoryProp(e,s,n,r,o);return null===(i=this.notification)||void 0===i||i.setSubStoryProp(e,s,n),c}}},e.prototype.setStoryProp=function(e,t,n,r,o){var i;if(1===t){var a=this.getStoryStream();if(a.checkValidityGCP(e)){var s=a.constraintToValidityLength(e,t),c=a.setStoryProp(e,s,n,r,o);return null===(i=this.notification)||void 0===i||i.setStoryProp(e,s,n),c}}},e.prototype.setFieldProp=function(e,t,n,r,o){var i;if(1===t){var a=this.getFieldStream();if(a.checkValidityGCP(e)){var s=a.constraintToValidityLength(e,t),c=a.setFieldProp(e,s,n,r,o);return null===(i=this.notification)||void 0===i||i.setFieldProp(e,s,r,n),c}}},e.prototype.setCommentProp=function(e,t,n,r,o){var i;if(1===t){var a=this.getAnnotationStream();if(a.checkValidityGCP(e)){var s=a.constraintToValidityLength(e,t),c=a.setCommentProp(e,s,n,r,o);return null===(i=this.notification)||void 0===i||i.setCommentProp(e,s,n),c}}},e.prototype.setDrawingProp=function(e,t,n,r,o){var i;if(1===t){var a=this.getDrawingStream();if(a.checkValidityGCP(e)){var s=a.constraintToValidityLength(e,t),c=a.setDrawingProp(e,s,n,r,o);return null===(i=this.notification)||void 0===i||i.setDrawingProp(e,s,n),c}}},e.prototype.setPictureProp=function(e,t,n,r,o){var i;if(1===t){var a=this.getDrawingStream();if(a.checkValidityGCP(e)){var s=a.constraintToValidityLength(e,t),c=a.setPictureProp(e,s,n,r,o);return null===(i=this.notification)||void 0===i||i.setPictureProp(e,s,n),c}}},e.prototype.setEmbeddedObjectProp=function(e,t,n,r,o){var i;if(1===t){var a=this.getDrawingStream();if(a.checkValidityGCP(e)){var s=a.constraintToValidityLength(e,t),c=a.setEmbeddedObjectProp(e,s,n,r,o);return null===(i=this.notification)||void 0===i||i.setEmbeddedObjectProp(e,s,n),c}}},e.prototype.setFootnoteProp=function(e,t,n,r,o){var i;if(1===t){var a=this.getNotesStream();if(a.checkValidityGCP(e)){var s=a.constraintToValidityLength(e,t),c=a.setFootnoteProp(e,s,n,r,o);return null===(i=this.notification)||void 0===i||i.setFootnoteProp(e,s,n),c}}},e.prototype.setEndnoteProp=function(e,t,n,r,o){var i;if(1===t){var a=this.getNotesStream();if(a.checkValidityGCP(e)){var s=a.constraintToValidityLength(e,t),c=a.setEndnoteProp(e,s,n,r,o);return null===(i=this.notification)||void 0===i||i.setEndnoteProp(e,s,n),c}}},e.prototype.setTableProp=function(e,t,n,r,o){var i;if(1===t){var a=this.getTableStream();if(a.checkValidityGCP(e)){var s=a.constraintToValidityLength(e,t),c=a.setTableProp(e,s,n,r,o);return null===(i=this.notification)||void 0===i||i.setTableProp(e,s,n),c}}},e.prototype.setTableRowProp=function(e,t,n,r,o){var i;if(1===t){var a=this.getTableStream();if(a.checkValidityGCP(e)){var s=a.constraintToValidityLength(e,t),c=a.setRowProp(e,s,n,r,o);return null===(i=this.notification)||void 0===i||i.setTableRowProp(e,s,n),c}}},e.prototype.setTableCellProp=function(e,t,n,r,o){var i;if(1===t){var a=this.getTableStream();if(a.checkValidityGCP(e)){var s=a.constraintToValidityLength(e,t),c=a.setCellProp(e,s,n,r,o);return null===(i=this.notification)||void 0===i||i.setTableCellProp(e,s,n),c}}},e.prototype.setMathProp=function(e,t,n,r,o){var i;if(1===t){var a=this.getMathStream();if(a.checkValidityGCP(e)){var s=a.constraintToValidityLength(e,t),c=a.setMathProp(e,s,n,r,o);return null===(i=this.notification)||void 0===i||i.setMathProp(e,s,n),c}}},e.prototype.setMathObjectProp=function(e,t,n,r,o){var i;if(1===t){var a=this.getMathStream();if(a.checkValidityGCP(e)){var s=a.constraintToValidityLength(e,t),c=a.setMathObjectProp(e,s,n,r,o);return null===(i=this.notification)||void 0===i||i.setMathObjectProp(e,s,n),c}}},e.prototype.setMathRunProp=function(e,t,n,r,o){var i;if(1===t){var a=this.getMathStream();if(a.checkValidityGCP(e)){var s=a.constraintToValidityLength(e,t),c=a.setMathRunProp(e,s,n,r,o);return null===(i=this.notification)||void 0===i||i.setMathRunProp(e,s,n),c}}},e.prototype.setSdtProp=function(e,t,n,r,o){var i;if(1===t){var a=this.getSdtStream();if(a.checkValidityGCP(e)){var s=a.constraintToValidityLength(e,t),c=a.setSdtProp(e,s,n,r,o);return null===(i=this.notification)||void 0===i||i.setSdtProp(e,s,n),c}}},e.prototype.insertText=function(e,t,n,r){var o,i=this.getTextStream().constraintToValidityGcp(e);return this.textPool.insert(i,n),this.streamList.forEach((function(n){n.extend(e,t)})),null===(o=this.notification)||void 0===o||o.insertText(e,t,n,r),new b.IC(i,t)},e.prototype.deleteText=function(e,t,n){var r,o=this,i=this.getTextStream().constraintToValidityLength(e,t),a=this.getTextStream().readText(e,i);return this.streamList.forEach((function(t){t.shrink(e,i,o.notification)})),this.textPool.erase(e,i),null===(r=this.notification)||void 0===r||r.deleteText(e,i,n),a},e.prototype.insertCommentRange=function(e,t,n){var r,o=this.getTextStream().constraintToValidityGcp(e),i=this.getTextStream().constraintToValidityLength(e,t);return this.getAnnotationStream().insertCommentRange(o,i,n),null===(r=this.notification)||void 0===r||r.insertCommentRange(o,i,n),new b.IC(o,i)},e.prototype.deleteCommentRange=function(e){var t,n=this.getAnnotationStream().deleteCommentRange(e);return null===(t=this.notification)||void 0===t||t.deleteCommentRange(e),n},e.prototype.insertBookmarkRange=function(e,t,n){var r,o=this.getTextStream().constraintToValidityGcp(e),i=this.getTextStream().constraintToValidityLength(e,t);return this.getAnnotationStream().insertBookmarkRange(o,i,n),null===(r=this.notification)||void 0===r||r.insertBookmarkRange(o,i,n),new b.IC(o,i)},e.prototype.deleteBookmarkRange=function(e){var t,n=this.getAnnotationStream().deleteBookmarkRange(e);return null===(t=this.notification)||void 0===t||t.deleteBookmarkRange(e),n},e.prototype.insertPermissionRange=function(e,t,n){var r,o=this.getTextStream().constraintToValidityGcp(e),i=this.getTextStream().constraintToValidityLength(e,t);return this.getAnnotationStream().insertPermissionRange(o,i,n),null===(r=this.notification)||void 0===r||r.insertPermissionRange(o,i,n),new b.IC(o,i)},e.prototype.deletePermissionRange=function(e){var t,n=this.getAnnotationStream().deletePermissionRange(e);return null===(t=this.notification)||void 0===t||t.deletePermissionRange(e),n},e.prototype.insertRevisionRange=function(e,t,n){var r,o=this.getTextStream().constraintToValidityGcp(e),i=this.getTextStream().constraintToValidityLength(e,t);return this.getAnnotationStream().insertRevisionRange(o,i,n),null===(r=this.notification)||void 0===r||r.insertRevisionRange(o,i,n),new b.IC(o,i)},e.prototype.deleteRevisionRange=function(e){var t,n=this.getAnnotationStream().deleteRevisionRange(e);return null===(t=this.notification)||void 0===t||t.deleteRevisionRange(e),n},e.prototype.insertQuoteRange=function(e,t,n){var r,o=this.getTextStream().constraintToValidityGcp(e),i=this.getTextStream().constraintToValidityLength(e,t);return this.getAnnotationStream().insertQuoteRange(o,i,n),null===(r=this.notification)||void 0===r||r.insertQuoteRange(n.id),new b.IC(o,i)},e.prototype.deleteQuoteRange=function(e){var t,n=this.getAnnotationStream().deleteQuoteRange(e);return null===(t=this.notification)||void 0===t||t.deleteQuoteRange(e),n},e.prototype.createFastRangeClass=function(e,t){return void 0===e&&(e=!1),void 0===t&&(t=!0),new Le(this.getNotificationCenter(),e,t,s.Outer)},e.prototype.createRangeClass=function(e,t){return void 0===e&&(e=!1),void 0===t&&(t=!0),new Me(this.getNotificationCenter(),e,t,s.Outer)},e.prototype.createGCPClass=function(e,t,n){return void 0===e&&(e=!1),void 0===t&&(t=!0),void 0===n&&(n=s.Outer),new ke(this.getNotificationCenter(),e,t,n)},e.prototype.createDataIterator=function(e){var t=this.getTextStream();return new ue(t,this.getSectionStream().sectionPropList,t.paraPropList,t.runPropList,t.validRange(e))},e.prototype.handleNewRunProperty=function(e){var t=e.fontFamily;t&&this.newFontNamesCache.add(t)},e.prototype.getFontNamesCache=function(){return(0,i.__spreadArray)([],(0,i.__read)(this.newFontNamesCache),!1)},e.prototype.clearFontNamesCache=function(){this.newFontNamesCache.clear()},e}(),fn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.setFontsProp=function(e){return(0,i.__assign)({},this.fontsProperty.merge(e,!0))},t}(function(){function e(){this.fontsProperty=new(Ge.kk.getPropertyClass(Ge.uS.FontsProperty))}return e.prototype.getFontsProperty=function(e){return void 0===e&&(e=!1),e?this.fontsProperty:this.fontsProperty.clone()},e}());!function(e){e.DocumentSettingsChange="DocumentSettingsChange",e.WebSettingsChange="WebSettingsChange",e.DocBackgroundChange="DocBackgroundChange",e.StyleSheetChange="StyleSheetChange",e.NumberingChange="NumberingChange",e.FontTableChange="FontTableChange",e.ThemeChange="ThemeChange"}(an||(an={}));var gn,vn=function(e){function t(t,n){var r=e.call(this,n)||this;return r.modifiedProp=t,r}return(0,i.__extends)(t,e),t}(re.Notification),yn=function(){function e(){}return e.getListStyle=function(t){var n={listFormat:t.listFmt,listText:t.lvlText};return e.isBulletFormat(n.listFormat)&&(n.listText=e.getCompatiableBulletText(n.listText)),n},e.getTaskStateText=function(e){return e===ne.RWe.done?G.MJ.Done:G.MJ.Todo},e.getPeriodListStyleset=function(e){var t=e[0];if(e.length>0&&!this.isTaskFormat(t.listFormat)&&e.length<3){var n=e.slice();if(this.isBulletFormat(e[0].listFormat))for(var r=e.length;r<3;++r)n[r]={listFormat:ne.OBG.bullet,listText:this.getDefaultBulletListText(r)};else for(r=e.length;r<3;++r)n[r]=this.getDefaultNumberListStyle(r);return n}return e},e.findParagraphPeriod=function(e){if(e.length<3)return 3;for(var t=3;t<e.length;++t){var n=e[t];if(!n||n.numFmt===e[0].numFmt&&n.lvlText===e[0].lvlText)return t}return e.length},e.completeListTemplateParagraphs=function(e,t,n){var r=Math.min(n||H.k.listLevelLimit,H.k.maxSupportListLevelLimit);if(e.numFmt.val===ne.OBG.task){var o=e;o.pPr.ind.hanging||(o.pPr.ind.left-=o.pPr.ind.hanging,o.pPr.ind.hanging=H.k.listDefaultHanging,o.pPr.ind.left+=o.pPr.ind.hanging),t.splice(1)}else{var i=this.findParagraphPeriod(t),a=t;a.splice(0).forEach((function(e){a[e.ilvl]=e})),a[0]?a[0].equalTo(e)||(a[0]=e,re.Logger.error("rootParaProp")):a[0]=e,this.setChildTemplate(e,a,r,i)}},e.setChildTemplate=function(t,n,r,o){for(var i=n,a=1;a<r;++a){var s=i[a];if(!s){if((s=new(Ge.kk.getPropertyClass(Ge.uS.CTLvlWml))).ilvl=a,s.start=1,a>=o){var c=e.getDefaultNumberListStyle(a).listText,l=i[a%o];s.lvlText.val=l.lvlText.val,e.isNumberedFormat(t.numFmt.val)&&(s.lvlText.val=c),s.numFmt.val=l.numFmt.val,s.pPr.ind.hanging=l.pPr.ind.hanging}else if(e.isBulletFormat(t.numFmt.val))c=e.getDefaultBulletListText(a),s.lvlText.val=c,s.numFmt.val=ne.OBG.bullet,s.pPr.ind.hanging=H.k.listDefaultHanging;else if(e.isNumberedFormat(t.numFmt.val)){var u=e.getDefaultNumberListStyle(a),d=u.listFormat;c=u.listText,s.lvlText.val=c,s.numFmt.val=d,s.pPr.ind.hanging=H.k.listDefaultHanging}i[a]=s}if(Ge.kk.getPropertyClass(Ge.uS.RunProperty).getFontFamily(t.rPr)&&e.setSpanFont(s.rPr,Ge.kk.getPropertyClass(Ge.uS.RunProperty).getFontFamily(t.rPr)),!e.isBulletFormat(t.numFmt.val)&&!e.isTaskFormat(t.numFmt.val)||Ge.kk.getPropertyClass(Ge.uS.RunProperty).getFontFamily(t.rPr)||(e.setSpanFont(t.rPr,"wingdings"),e.setSpanFont(s.rPr,"wingdings")),!s.pPr.ind.has(Ge.kk.getPropertyClass(Ge.uS.CTInd).tKeys.leftChars)&&!s.pPr.ind.has(Ge.kk.getPropertyClass(Ge.uS.CTInd).tKeys.left)){var p=i[a-1];p.pPr.ind.has(Ge.kk.getPropertyClass(Ge.uS.CTInd).tKeys.left)?s.pPr.ind.left=H.k.tabCharsCount*H.k.fontSize+Number(p.pPr.ind.left-p.pPr.ind.hanging)+s.pPr.ind.hanging:s.pPr.ind.leftChars=H.k.tabCharsCount*j.j.indentChars+p.pPr.ind.leftChars}}},e.setSpanFont=function(e,t){Ge.kk.getPropertyClass(Ge.uS.RunProperty).setFontFamily(e,t),e.rFonts.hint=ne.NiC.default},e.getDefaultNumberListStyle=function(e){var t;switch(e%3){case 0:default:t={listFormat:ne.OBG.decimal,listText:"%".concat(e+1,".")};break;case 1:t={listFormat:ne.OBG.lowerLetter,listText:"%".concat(e+1,".")};break;case 2:t={listFormat:ne.OBG.lowerRoman,listText:"%".concat(e+1,".")}}return t},e.getDefaultBulletListText=function(e){var t;switch(e%3){case 0:default:t=G.ly.Circle;break;case 1:t=G.ly.HollowCircle;break;case 2:t=G.ly.Square}return t},e.createId=function(){return re.StringUtil.generateRandomId()},e.isNumberedFormat=function(e){return!this.isBulletFormat(e)&&!this.isTaskFormat(e)},e.isBulletFormat=function(e){return ne.OBG.bullet===e},e.isTaskFormat=function(e){return ne.OBG.task===e},e.getCompatiableBulletText=function(e){var t=e;return Object.values(G.ly).includes(e)?G.QP.get(t)||"":G.QP.get(G.ly.Circle)||""},e.getStartCharsByLevel=function(e){return e.pPr.ind.leftChars},e.setStartCharsByLevel=function(e,t){e.pPr.ind.leftChars=t},e.getNumPropertyByAbstractNumId=function(e,t){var n;return e.num.forEach((function(e){e.abstractNumId===t&&(n=e)})),n},e.getNumberingPropertyByNumId=function(e,t){var n=this.getAbstractNumType(e,t),r=e.num.getProperty(t),o=new(Ge.kk.getPropertyClass(Ge.uS.NumberingProperty));return n&&r&&(o.abstractNum.appendProperty(n,"abstractNumId"),o.num.appendProperty(r,"numId")),o},e.getAbstractNumType=function(e,t){var n=e.num.getProperty(t);return n?e.abstractNum.getProperty(n.abstractNumId):n},e.setAbstractNumType=function(e,t,n,r){var o=this;return Array.isArray(r)&&r.length?(r.forEach((function(r){o.insertLevelType(e,t,n,r)})),e):e},e.createAbstractNumType=function(t,n){var r=new(Ge.kk.getPropertyClass(Ge.uS.CTAbstractNum)),o=e.createId();r.abstractNumId=o,t.abstractNum.appendProperty(r,"abstractNumId");var i=new(Ge.kk.getPropertyClass(Ge.uS.CTNum));return i.numId=n,i.abstractNumId=o,t.num.appendProperty(i,"numId"),t},e.removeAbstractNumType=function(e,t){var n=new(Ge.kk.getPropertyClass(Ge.uS.NumberingProperty)),r=this.getAbstractNumType(t,e);return r?(r&&(n.num.deleteProperty(e),n.abstractNum.deleteProperty(r.abstractNumId)),n):null},e.getLevelType=function(e,t,n){var r=this.getAbstractNumType(e,t);return r&&r.lvl&&r.lvl.getProperty(String(n))||null},e.insertLevelType=function(e,t,n,r){var o=this.getAbstractNumType(e,t);return o||(this.createAbstractNumType(e,t),o=this.getAbstractNumType(e,t)),(null==o?void 0:o.lvl.getProperty(String(n)))||null==o||o.lvl.appendProperty(r,"ilvl"),e},e.insertLevelsType=function(e,t,n){var r=this.getAbstractNumType(e,t);return r||(this.createAbstractNumType(e,t),r=this.getAbstractNumType(e,t)),null==r||r.lvl.clean(new(Ge.kk.getPropertyClass(Ge.uS.CTLvlWml))),n.forEach((function(e){null==r||r.lvl.appendProperty(e,"ilvl")})),e},e.setLevelType=function(e,t,n,r,o){void 0===o&&(o=G.XS.Merge);var i=this.getLevelType(e,t,n);return i?(Ge.vC.modifyProps(o,r,i,!1),e):e},e.setLevelRunProperty=function(e,t,n,r,o){void 0===o&&(o=G.XS.Merge);var i=this.getLevelType(e,t,n);return i?(Ge.vC.modifyProps(o,r,i.rPr,!1),e):e},e.getValueFromLevelType=function(e,t,n,r){var o;return(null===(o=this.getLevelType(e,t,n))||void 0===o?void 0:o[r])||null},e}(),mn=function(e){function t(t,n){var r=e.call(this,t)||this;return r.actualText="",r.dirty=!0,r.order=-1,r.gcp=-1,r.isVirtual=!1,r.virtualChildCount=0,n&&r.updateByNumberingProperty(n),r}return(0,i.__extends)(t,e),Object.defineProperty(t.prototype,"listId",{get:function(){return this.numPr.numId},set:function(e){this.numPr.numId=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"listLevel",{get:function(){return this.numPr.ilvl},set:function(e){this.numPr.ilvl=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftIndent",{get:function(){return this.ind.left},set:function(e){this.ind.left=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftCharsIndent",{get:function(){return this.ind.leftChars},set:function(e){this.ind.leftChars=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isBullet",{get:function(){return this.listFmt===O.OBG.bullet},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isNumbered",{get:function(){return!this.isBullet&&!this.isTask},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isTask",{get:function(){return this.listFmt===O.OBG.task},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"listType",{get:function(){return this.isBullet?G.RH.Bullet:this.isNumbered?G.RH.Numbered:this.isTask?G.RH.Task:G.RH.None},enumerable:!1,configurable:!0}),t.prototype.updateByNumberingProperty=function(e){var t,n;this.listFmt=(null===(t=yn.getValueFromLevelType(e,this.listId,this.listLevel,"numFmt"))||void 0===t?void 0:t.val)||O.OBG.none,this.start=yn.getValueFromLevelType(e,this.listId,this.listLevel,"start")||1,this.lvlText=(null===(n=yn.getValueFromLevelType(e,this.listId,this.listLevel,"lvlText"))||void 0===n?void 0:n.val)||""},t.prototype.clone=function(){var n=new t(e.prototype.clone.call(this));return n.actualText=this.actualText,n.measureText=this.measureText,n.dirty=this.dirty,n.order=this.order,n.listMarkerSpanProp=this.listMarkerSpanProp,n.gcp=this.gcp,n.parent=this.parent,n.isVirtual=this.isVirtual,n.virtualChildCount=this.virtualChildCount,n.deleted=this.deleted,n.paragraphStyle=this.paragraphStyle,n.listFmt=this.listFmt,n.start=this.start,n.lvlText=this.lvlText,n.listInd=this.listInd,n},t}(O.kkf.getPropertyClass(O.uSS.ParagraphProperty)),bn=function(){function e(){}return e.hasValue=function(e){return!!e.getNode()&&!!e.getNode().data},e.forEach=function(e,t,n){for(void 0===n&&(n=function(){return!0});this.hasValue(e)&&n(e.getNode().data);)t(e.getNode().data,e.getNode()),e.next()},e.get=function(e,t){void 0===t&&(t=function(){return!0});for(var n=[];this.hasValue(e)&&t(e.getNode().data);)n.push(e.getNode().data),e.next();return n},e.isEmpty=function(e){return!e.root()||!e.root().data},e.delete=function(e,t){t.forEach((function(t){e.erase(t)}))},e.insert=function(e,t){t.forEach((function(t){var n=t.data;n&&e.insertFloat(n.gcp,n)}))},e}(),_n=function(){function e(){}return e.numeric2ListText=function(e,t){switch(t){case ne.OBG.decimal:return e.toString();case ne.OBG.lowerLetter:return this.number2Letter(e,!1);case ne.OBG.lowerRoman:return this.number2Roman(e,!1);case ne.OBG.chineseCountingThousand:case ne.OBG.japaneseCounting:return this.number2Chinese(e);case ne.OBG.upperLetter:return this.number2Letter(e,!0);case ne.OBG.upperRoman:return this.number2Roman(e,!0);default:return e.toString()}},e.getNumberListText=function(e){var t=this,n=[e],r=e.lvlText.match(/%([1-9])/g);Array.isArray(r)&&r.reverse();var o=0;return e.lvlText.replace(/%([1-9])/g,(function(i,a){var s=(null==r?void 0:r.length)&&(null==r?void 0:r.length)>1?0:e.listLevel,c=r&&r[o]?r[o].slice(1):a;o+=1;var l=parseInt(c,10)-1-s;if(l>0&&1===n.length)for(var u=e.parent;u;)n.push(u),u=u.parent;return n[l]?t.numeric2ListText(n[l].order+n[l].start,n[l].listFmt):""}))},e.getNumberListMeasureText=function(e){var t=e.replace(/\d/g,"0");return t!==e?t:void 0},e.number2Chinese=function(e){var t=["","","","","","","","","",""],n=["","","","",""],r=["","","",""],o=e,i=0,a="",s="",c=!1;if(0===o)return t[0];for(var l=o;o>0;){var u=o%1e4;c&&(s=t[0]+s),a=this.sectionToChinese(u,t,r),s=(a+=0!==u?n[i]:n[0])+s,c=u<1e3&&u>0,o=Math.floor(o/1e4),i+=1}return l>=10&&l<20&&(s=s.substring(1)),s},e.sectionToChinese=function(e,t,n){for(var r="",o="",i=0,a=!0,s=e;s>0;){var c=s%10;0===c?a||(a=!0,o=t[c]+o):(a=!1,r=t[c],o=(r+=n[i])+o),i+=1,s=Math.floor(s/10)}return o},e.number2Roman=function(e,t){var n=e,r={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1};t||(r={m:1e3,cm:900,d:500,cd:400,c:100,xc:90,l:50,xl:40,x:10,ix:9,v:5,iv:4,i:1});var o="";return Object.keys(r).forEach((function(e){for(;n>=r[e];)o+=e,n-=r[e]})),o},e.number2Letter=function(e,t){for(var n=[],r=e;r;){var o=r%26;o||(o=26,r-=1),n.push(String.fromCharCode(o+(t?64:96))),r=~~(r/26)}return n.reverse().join("")},e}(),Cn=.5,Sn="LAST_UPDATE_GCP_POS_KEY",wn=function(){function e(e,t){this.listLevels=new Map,this.listTemplateMap=new Map,this.listTemplateReverseMap=new Map,this.dirtyLists=new Set,this.numberingProperty=new(Ge.kk.getPropertyClass(Ge.uS.NumberingProperty)),this.dataStream=e,this.styleSheetManager=t}return e.prototype.getNumberingProperty=function(e){return void 0===e&&(e=!1),e?this.numberingProperty:this.numberingProperty.clone()},e.prototype.resetListManager=function(){var e,t;null===(e=this.gcpClass)||void 0===e||e.destroy(),null===(t=this.lastUpdateGcpClass)||void 0===t||t.destroy(),this.gcpClass=this.dataStream.createGCPClass(!1,!1),this.lastUpdateGcpClass=this.dataStream.createGCPClass(!1,!1),this.setLastUpdateGcpPos(b.S$),this.listLevels=new Map,this.listTemplateMap=new Map;var n=this.getUpdates(new b.IC(0,this.dataStream.getTextStream().getLength()));n.reorderLevels.length>0&&this.reorderLevels(n.reorderLevels),n.dirtyLists.length>0&&(this.markDirty(n.dirtyLists),this.dirtyLists.clear()),this.monitorDataNotification()},Object.defineProperty(e.prototype,"lastUpdateGcp",{get:function(){var e;return null!==(e=this.lastUpdateGcpClass.getGCP(Sn))&&void 0!==e?e:b.S$},enumerable:!1,configurable:!0}),e.prototype.setLastUpdateGcpPos=function(e){this.lastUpdateGcpClass.removeAll(),e>=0&&this.lastUpdateGcpClass.insertGCP(Sn,e)},e.prototype.monitorDataNotification=function(){var e=this;this.notificationCenter=this.dataStream.getNotificationCenter(),this.notificationCenter&&(this.notificationCenter.on(le.InsertText,(function(t){t instanceof Te&&e.onDataInsert()}),!1),this.notificationCenter.on(le.DeleteText,(function(){e.onDataDelete()}),!1),this.notificationCenter.on(le.RunChange,(function(t){t instanceof Ie&&e.onSpanChange(t)}),!1),this.notificationCenter.on(le.ParaChange,(function(t){t instanceof Ie&&e.onParaPropChange(t)}),!1),this.notificationCenter.on(an.NumberingChange,(function(t){e.onTemplateChange(t)}),!1))},e.prototype.getLevelType=function(e,t){return yn.getLevelType(this.numberingProperty,e,t)},e.prototype.getAbstractNumType=function(e){return yn.getAbstractNumType(this.numberingProperty,e)},e.prototype.isListParagraph=function(e){if(this.isListParaProp(e)){var t=this.getLevelKey(this.getListId(e),this.getListLevel(e));return this.listLevels.has(t)}return!1},e.prototype.isTablePlaceholder=function(e,t){if(e instanceof Ge.kk.getPropertyClass(Ge.uS.ParagraphProperty)&&e.isPlaceholder){var n=this.dataStream.getTextStream().charCodeAt(t.end()-1);if((0,k.dA)(n))return!0}return!1},e.prototype.getListInfoFromGcpRange=function(e){for(var t=this.createParagraphIterator(e),n=t.getProperty();this.isTablePlaceholder(n,t.getRange());)t.next(),n=t.getProperty();if(!n)return null;var r=this.getMergedStyleNumPr(n),o=r.numId,i=r.ilvl;if(yn.getLevelType(this.numberingProperty,o,i)){var a=this.getListInfoByGcp(o,i,t.getRange().end());return(null==a?void 0:a.dirty)&&this.combineList(a),a}return null},e.prototype.getListInfoArrayFromGcpRange=function(e){var t=[],n=this.createParagraphIterator(e);do{for(var r=n.getProperty();this.isTablePlaceholder(r,n.getRange());)n.next(),r=n.getProperty();if(r){var o=this.getMergedStyleNumPr(r),i=o.numId,a=o.ilvl;if(yn.getLevelType(this.numberingProperty,i,a)){var s=this.getListInfoByGcp(i,a,n.getRange().end());(null==s?void 0:s.dirty)&&this.combineList(s),s&&t.push(s)}if(!n.hasNext())break}}while(n.next());return t},e.prototype.getWholeListByListId=function(e){var t=this,n=[];if(e){var r=new RegExp("".concat(e,"+(?=_\\d+$)"));this.listLevels.forEach((function(e,o){var i=o.match(r);(null==i?void 0:i[0])&&bn.forEach(e.begin(),(function(e){e.dirty&&t.combineList(e),n.push(e)}))}))}return n},e.prototype.getListTypeByListId=function(e){for(var t,n=0;n<H.k.maxSupportListLevelLimit;++n){var r=this.getLevelKey(e,n),o=this.listLevels.get(r),i=null===(t=null==o?void 0:o.root())||void 0===t?void 0:t.data;if(i)return i.listType}return G.RH.None},e.prototype.getExistsListLevels=function(e){for(var t=[],n=0;n<H.k.maxSupportListLevelLimit;++n){var r=this.getLevelKey(e,n);this.listLevels.has(r)&&t.push(n)}return t},e.prototype.getListTemplateId=function(e){return this.listTemplateReverseMap.get(e)},e.prototype.exists=function(e){return!!this.getListTemplateId(e)},e.prototype.getListsByListTemplateId=function(e){var t=this,n=[];return this.gcpClass.forEachGCP((function(r){return r.key.listId===e&&(r.key.dirty&&t.combineList(r.key),n.push(r.key)),!1})),n},e.prototype.modifyRenderRange=function(e){var t=this.createParagraphIterator();this.dirtyLists.forEach((function(n){t.seek(n.gcp-1),e(new b.IC(t.getRange().gcpBegin,1))})),this.dirtyLists.clear()},e.prototype.hasTemplate=function(e){return this.listTemplateMap.has(e)},e.prototype.createParagraphIterator=function(e){return this.dataStream.getTextStream().createParagraphIterator(e)},e.prototype.createRunIterator=function(e){return this.dataStream.getTextStream().createRunIterator(e)},e.prototype.getListId=function(e){return e.has(e.tKeys.numPr)?e.numPr.numId:""},e.prototype.getListLevel=function(e){return e.has(e.tKeys.numPr)?e.numPr.ilvl:0},e.prototype.getMergedStyleNumPr=function(e){var t=e.has(e.tKeys.numPr)?e.numPr:null;return this.styleSheetManager.traceToParagraphBaseStyle(e,(function(e){return!(t||!e.has(e.tKeys.numPr)||(t=e.numPr,0))}),!0),{numId:t?t.numId:"",ilvl:t?t.ilvl:0}},e.prototype.getLevelKey=function(e,t){return"".concat(e,"_").concat(t)},e.prototype.isListParaProp=function(e){var t=this.getListId(e),n=this.getListLevel(e);return!!this.getListId(e)&&!!yn.getLevelType(this.numberingProperty,t,n)},e.prototype.getListInfoByGcp=function(e,t,n){var r,o=this.listLevels.get(this.getLevelKey(e,t));if(o){var i=o.findInner(n).getNode();if((null===(r=null==i?void 0:i.data)||void 0===r?void 0:r.gcp)===n)return i.data}return null},e.prototype.markDirty=function(e,t){var n=this;void 0===t&&(t=!1),this.notificationCenter&&e.forEach((function(e){!e.isNumbered&&!t||e.isVirtual||n.dirtyLists.add(e),e.dirty=!0}))},e.prototype.reorderLevels=function(e){e.forEach((function(e){e.forEach((function(e,t){e.order=t}))}))},e.prototype.updateLevelRange=function(e,t){var n=[],r=[];return bn.forEach(e.begin(),(function(e,o){if(t.has(e)){var i=t.get(e);e.gcp!==i&&(e.gcp=i,n.push(o))}else e.deleted=!0,r.push(o)})),bn.delete(e,r),bn.delete(e,n),bn.insert(e,n),r.length>0?{list:r[0].data,level:e}:null},e.prototype.correctListLevel=function(e,t,n){var r=this;if(e.listLevel<H.k.maxSupportListLevelLimit-1){var o=this.listLevels.get(this.getLevelKey(e.listId,e.listLevel+1));o&&bn.forEach(o.begin(),(function(e){var t;(null===(t=e.parent)||void 0===t?void 0:t.deleted)&&(r.attachParent(e),n.push(e))}))}bn.forEach(t.begin(),(function(e){n.push(e)}))},e.prototype.updateRanges=function(){var e=this,t=new Map;this.gcpClass.forEachGCP((function(e){return t.set(e.key,e.gcp),!1}));var n=[];this.listLevels.forEach((function(r){var o=e.updateLevelRange(r,t);o&&n.push(o)})),n.sort((function(e,t){return e.list.listId>t.list.listId?1:e.list.listId===t.list.listId?t.list.listLevel-e.list.listLevel:-1}));var r=[];return n.forEach((function(t){e.correctListLevel(t.list,t.level,r)})),this.getReorderLevels(new Set(r))},e.prototype.removeListIdRelation=function(e){if(0===this.getExistsListLevels(e).length){var t=this.listTemplateReverseMap.get(e);if(t){this.listTemplateReverseMap.delete(e);var n=this.listTemplateMap.get(t);if(n){var r=n.indexOf(e);-1!==r&&(1===n.length?this.listTemplateMap.delete(t):n.splice(r,1))}}}},e.prototype.removeEmptyLevels=function(){var e=this,t=[];this.listLevels.forEach((function(e,n){bn.isEmpty(e)&&t.push(n)}));var n=new Set;t.forEach((function(t){e.listLevels.delete(t),n.add(t.split("_")[0])})),n.forEach((function(t){e.removeListIdRelation(t)}))},e.prototype.getUpdates=function(e){var t=this.createParagraphIterator(e),n=new Set,r=new Set,o=this.gcpClass.findGCPs(),a=function(){var e=t.getProperty();if(!e)return"continue";var i=s.getMergedStyleNumPr(e).numId,a=t.getRange(),c=o.find((function(e){return e.gcp===a.end()}));if(!c&&!i)return"continue";if(e=s.styleSheetManager.mergeStyleParaPropWithGcp(e,a.begin()),!c)return(u=s.insertList(e,a.end()))&&n.add(u),s.setLastUpdateGcpPos(a.end()),"continue";var l=c.key.listId===s.getListId(e)&&c.key.listLevel===s.getListLevel(e);if(c&&!l){var u,d=s.deleteList(c.key,c.gcp);return d&&n.add(d),(u=s.insertList(e,a.end()))&&n.add(u),s.setLastUpdateGcpPos(a.end()),"continue"}if(c&&l){var p=s.getListInfoByGcp(s.getListId(e),s.getListLevel(e),a.end());c.key.listFmt!==O.OBG.task||p||re.Logger.log("[task item click]  listInfo",e,a),p&&r.add(p)}},s=this;do{a()}while(t.next());var c=this.getReorderLevels(n);return c.forEach((function(e){e.forEach((function(e){r.add(e)}))})),{reorderLevels:(0,i.__spreadArray)([],(0,i.__read)(c),!1),dirtyLists:(0,i.__spreadArray)([],(0,i.__read)(r),!1)}},e.prototype.getReorderRefParent=function(e,t){var n;if(e.parent&&e.deleted){var r=t.findOuter(e.gcp).getNode();return(null===(n=null==r?void 0:r.data)||void 0===n?void 0:n.parent)&&r.data.parent.gcp>=e.parent.gcp?r.data.parent:void 0}return e.parent},e.prototype.expandDescendantLists=function(e,t){if(!(e.listLevel>=H.k.maxSupportListLevelLimit-1))for(var n=e.listLevel;n<H.k.maxSupportListLevelLimit;++n){var r=this.listLevels.get(this.getLevelKey(e.listId,n));if(r){var o=r.findOuter(e.gcp);if(bn.hasValue(o)){var i=o.data();/[0-9].*[0-9]/.test(i.lvlText)?bn.get(o).forEach((function(e){return t.add(e)})):n===e.listLevel+1&&t.add(i)}}}},e.prototype.expandVirtualParentLists=function(e,t){if(e.listLevel>0)for(var n=e.parent;(null==n?void 0:n.isVirtual)&&-1===n.order&&!n.deleted;n=n.parent)t.add(n)},e.prototype.getMinimalReorderMap=function(e){var t=this,n=new Set(e);e.forEach((function(e){t.expandVirtualParentLists(e,n),t.expandDescendantLists(e,n)}));var r=new Map;return n.forEach((function(e){var n=t.getLevelKey(e.listId,e.listLevel);if(!e.isTask&&t.listLevels.has(n)){var o=r.get(n);if(o){var i=o.get(e.parent);(!i||i.deleted&&!e.deleted)&&o.set(e.parent,e)}else r.set(n,new Map([[e.parent,e]]))}})),r},e.prototype.getReorderLevels=function(e){var t=this,n=this.getMinimalReorderMap(e),r=[];return n.size>0&&n.forEach((function(e,n){e.forEach((function(e){var o=null,i=t.listLevels.get(n),a=t.getReorderRefParent(e,i);a&&(o=t.getLevelArrayByParent(i,a)),o||0!==e.listLevel||(o=bn.get(i.begin())),o&&o.length>0&&r.push(o)}))})),r},e.prototype.getLevelArrayByParent=function(e,t){var n=null,r=this.listLevels.get(this.getLevelKey(t.listId,t.listLevel));if(!r)return null;var o=r.findOuter(t.gcp);if(bn.hasValue(o)){var i=o.getNode().data.gcp;n=bn.get(e.findOuter(t.gcp-.25),(function(e){return e.gcp<i}))}else n=bn.get(e.findOuter(t.gcp-.25));return n},e.prototype.getNearestAncestor=function(e){for(var t=null,n=Number.MAX_SAFE_INTEGER,r=e.listLevel-1;r>=0;--r){var o=this.listLevels.get(this.getLevelKey(e.listId,r));if(o){var i=o.findInner(e.gcp).getNode();if(null==i?void 0:i.data){var a=e.gcp-i.data.gcp;a<n&&(t=i.data,n=a)}}}return t},e.prototype.insertListData=function(e,t){var n=this.getLevelKey(e.listId,e.listLevel),r=this.listLevels.get(n);r||(r=new m,this.listLevels.set(n,r)),r.insertFloat(t,e),this.gcpClass.insertGCP(e,t)},e.prototype.deleteListData=function(e,t,n){var r,o=this.getLevelKey(e,t),i=this.listLevels.get(o);if(i){var a=i.findInner(n).getNode();if((null===(r=null==a?void 0:a.data)||void 0===r?void 0:r.gcp)===n)return i.erase(a),this.gcpClass.deleteGCP(a.data),a.data}return null},e.prototype.createVirtualList=function(e,t,n,r){var o=new mn(e,this.numberingProperty);o.listLevel=t,o.gcp=n,o.parent=r,o.isVirtual=!0,o.virtualChildCount=1;var i=this.getLevelType(e.listId,t);return o.start=i?i.start:1,o},e.prototype.attachParent=function(e){if(e.listLevel>0){var t=this.getNearestAncestor(e),n=e;if(!t||e.listLevel-t.listLevel>1){for(var r=void 0,o=t,i=e.gcp-Cn,a=t?t.listLevel+1:0;a<e.listLevel;++a)r=this.createVirtualList(e,a,i,o||void 0),this.insertListData(r,r.gcp),o=r;n.parent=r}else n.parent=t,t.isVirtual&&(t.virtualChildCount=(t.virtualChildCount||0)+1)}},e.prototype.replaceParent=function(e,t,n){var r=this,o=new Set;bn.forEach(e,(function(e){var n;if(e.parent&&e.parent!==t){for(var r=e.parent;r&&r.isVirtual;)void 0!==r.virtualChildCount&&(r.virtualChildCount-=1),o.add(r),r=r.parent;e.parent=t,t.isVirtual&&(t.virtualChildCount=(null!==(n=t.virtualChildCount)&&void 0!==n?n:0)+1)}}),n),o.forEach((function(e){e.gcp>=t.gcp-Cn&&r.deleteListData(e.listId,e.listLevel,e.gcp)}))},e.prototype.attachSiblings=function(e){if(e.listLevel>0){var t=this.listLevels.get(this.getLevelKey(e.listId,e.listLevel));t&&this.replaceParent(t.findOuter(e.gcp),e.parent,(function(t){return!!t.parent&&t.parent!==e.parent&&t.parent.isVirtual}))}},e.prototype.attachChildren=function(e){if(e.listLevel<H.k.maxSupportListLevelLimit-1){var t=e.listLevel+1,n=this.createParagraphIterator();n.seek(Math.ceil(e.gcp));var r=b.S$;do{var o=n.getProperty();if(!(o&&this.getListId(o)===e.listId&&this.getListLevel(o)>e.listLevel))break;r=n.getRange().end()}while(n.next());if(r>b.S$){var i=this.listLevels.get(this.getLevelKey(e.listId,t));i&&this.replaceParent(i.findOuter(e.gcp),e,(function(e){return e.gcp<=r}))}}},e.prototype.registerTemplate=function(e){var t=this.getListId(e),n=this.listTemplateMap.get(t);n&&!n.includes(e.listId)?n.push(e.listId):this.listTemplateMap.set(t,[e.listId]),this.listTemplateReverseMap.set(e.listId,t)},e.prototype.insertList=function(e,t){if(this.isListParaProp(e)){var n=new mn(e,this.numberingProperty);return n.gcp=t,this.attachParent(n),this.attachSiblings(n),this.attachChildren(n),this.insertListData(n,t),this.registerTemplate(n),n}return null},e.prototype.detachChildren=function(e){if(e.listLevel<H.k.maxSupportListLevelLimit-1){var t=this.listLevels.get(this.getLevelKey(e.listId,e.listLevel+1)),n=t?bn.get(t.findOuter(e.gcp),(function(t){return t.parent===e})):[];if(n.length>0){this.attachParent(n[0]);for(var r=1;r<n.length;++r)n[r].parent=n[0].parent}}},e.prototype.detachParent=function(e){for(var t=e.parent;(null==t?void 0:t.isVirtual)&&(void 0!==t.virtualChildCount&&(t.virtualChildCount-=1),!t.virtualChildCount);)this.deleteListData(t.listId,t.listLevel,t.gcp),t=t.parent},e.prototype.deleteList=function(e,t){if(this.isListParaProp(e)){var n=this.deleteListData(this.getListId(e),this.getListLevel(e),t);return n&&(this.detachChildren(n),this.detachParent(n),n.deleted=!0),n}return null},e.prototype.mergeParagraphPropertyToTemplate=function(e,t){if(e.merge(t),t.ind.firstLine&&!t.ind.has(Ge.kk.getPropertyClass(Ge.uS.CTInd).tKeys.firstLineChars)&&e.ind.setDefault(Ge.kk.getPropertyClass(Ge.uS.CTInd).tKeys.hanging),t.ind.firstLineChars){var n=Ge.kk.getPropertyClass(Ge.uS.CTInd);e.ind.setDefault(n.tKeys.hanging),e.ind.setDefault(n.tKeys.hangingChars)}t.ind.has(Ge.kk.getPropertyClass(Ge.uS.CTInd).tKeys.firstLineChars)&&e.ind.setDefault(Ge.kk.getPropertyClass(Ge.uS.CTInd).tKeys.firstLine)},e.prototype.combineParaProp=function(e,t,n){var r=e;r.setDefault(Ge.kk.getPropertyClass(Ge.uS.ParagraphProperty).tKeys.ind),r.setDefault(Ge.kk.getPropertyClass(Ge.uS.ParagraphProperty).tKeys.taskPr),n&&r.merge(n);var o=this.styleSheetManager.mergeStyleParaPropWithGcp(t,e.gcp);r.listParaInd=o.ind,r.taskPr=t.taskPr,o.outlineLvl!==G.il.LevelNone&&(r.ind.left=r.ind.hanging),this.mergeParagraphPropertyToTemplate(r,o),r.paragraphStyle=t.pStyle,r.paraId=t.paraId},e.prototype.combineSpanProp=function(e,t,n,r){var o=e;if(o.listMarkerSpanProp=this.styleSheetManager.mergeStyleRunPropWithGcp(t.clone(),n,e.gcp),r&&o.listMarkerSpanProp.merge(r),o.isBullet){var i=r||new(Ge.kk.getPropertyClass(Ge.uS.RunProperty));o.listMarkerSpanProp.b=i.b,o.listMarkerSpanProp.i=i.i,o.listMarkerSpanProp.u=i.u}else if(o.isTask){var a=Ge.kk.createProperty(Ge.uS.RunProperty);a.fontFamily=H.k.specialListFont,a.sz=o.listMarkerSpanProp.sz,o.listMarkerSpanProp=a}},e.prototype.generateListText=function(e){var t=e;e.isNumbered?(t.actualText=_n.getNumberListText(e),t.measureText=_n.getNumberListMeasureText(e.actualText)):e.isBullet?t.actualText=yn.getCompatiableBulletText(e.lvlText):t.actualText=e.lvlText},e.prototype.combineList=function(e){if(e.listId){var t=e;if(!e.isVirtual){var n=this.createParagraphIterator(),r=this.createRunIterator();n.seek(e.gcp-1),r.seek(e.gcp-1);var o=n.getProperty(),i=r.getProperty();if(!o||!i)return void re.Logger.error("applyTemplate cannot find paraProp or paraBreakSpan");var a=this.getLevelType(e.listId,e.listLevel);a&&(t.start=a.start,t.listFmt=a.numFmt.val,t.listInd=a.pPr.ind,this.combineParaProp(t,o,a.pPr),this.combineSpanProp(t,i,o,a.rPr),t.lvlText=e.isTask?yn.getTaskStateText(e.taskPr.taskState):a.lvlText.val,t.listMarkerSpanProp&&"wingdings"===t.listMarkerSpanProp.fontFamily&&yn.isBulletFormat(t.listFmt)&&t.listMarkerSpanProp.setDefault(t.listMarkerSpanProp.tKeys.rFonts)),this.updateVirtualListInfoInParentChain(t),this.generateListText(t)}t.dirty=!1}else re.Logger.error("list|recompose| invalid list info, listId=".concat(e.listId))},e.prototype.updateVirtualListInfoInParentChain=function(e){for(var t=this,n=[],r=e.parent;r;)r&&r.isVirtual&&n.push(r),r=r.parent;n.forEach((function(e){return e.updateByNumberingProperty(t.numberingProperty)}))},e.prototype.onDataInsert=function(){this.updateRanges()},e.prototype.onParaPropChange=function(e){var t,n,r=this.getUpdates(e.range);t=r.reorderLevels,n=r.dirtyLists,this.removeEmptyLevels(),t.length>0&&this.reorderLevels(t),n.length>0&&this.markDirty(n)},e.prototype.onDataDelete=function(){var e,t=this.updateRanges();this.removeEmptyLevels(),t.length>0&&(this.reorderLevels(t),this.markDirty((e=[]).concat.apply(e,(0,i.__spreadArray)([],(0,i.__read)(t),!1))))},e.prototype.onSpanChange=function(e){var t=this.onNormalSpanChange(e);t.length>0&&this.markDirty(t)},e.prototype.onNormalSpanChange=function(e){var t=[],n=this.createParagraphIterator(e.range);if(n.getRange().isValid())do{var r=n.getProperty();if(r){var o=this.getListInfoByGcp(this.getListId(r),this.getListLevel(r),n.getRange().end());o&&t.push(o)}}while(n.next());return t},e.prototype.onTemplateChange=function(e){var t=this,n=new Set;e.modifiedProp.abstractNum.forEach((function(e,r){var o=yn.getNumPropertyByAbstractNumId(t.numberingProperty,r);e.lvl.forEach((function(e,r){var i=t.listLevels.get(t.getLevelKey((null==o?void 0:o.numId)||"",Number(r)));i&&bn.forEach(i.begin(),(function(e){n.add(e)}))}))})),e.modifiedProp.num.forEach((function(e,r){var o=t.numberingProperty.abstractNum.getProperty(e.abstractNumId);null==o||o.lvl.forEach((function(e,o){var i=t.listLevels.get(t.getLevelKey(r||"",Number(o)));i&&bn.forEach(i.begin(),(function(e){n.add(e)}))}))})),this.markDirty((0,i.__spreadArray)([],(0,i.__read)(n),!1),!0)},e.prototype.collectListInfo=function(e){var t=[];return this.gcpClass.forEachGCP((function(n){return e(n.key,n.gcp)&&t.push(n.key),!1})),t},e}(),En=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.setNumberingProp=function(e){return(0,i.__assign)({},this.numberingProperty.merge(e,!0))},t}(wn),xn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.setDocSettingsProp=function(e){return(0,i.__assign)({},this.docSettingsProperty.merge(e,!0))},t.prototype.setWebSettingsProp=function(e){return(0,i.__assign)({},this.webSettingsProperty.merge(e,!0))},t.prototype.setDocBackgroundProp=function(e){return(0,i.__assign)({},this.docBackgroundProperty.merge(e,!0))},t}(function(){function e(){this.docSettingsProperty=new(Ge.kk.getPropertyClass(Ge.uS.DocumentSettingsProperty)),this.webSettingsProperty=new(Ge.kk.getPropertyClass(Ge.uS.WebSettingsProperty)),this.docBackgroundProperty=new(Ge.kk.getPropertyClass(Ge.uS.DocBackgroundProperty))}return e.prototype.getDocSettingsProperty=function(e){return void 0===e&&(e=!1),e?this.docSettingsProperty:this.docSettingsProperty.clone()},e.prototype.getWebSettingsProperty=function(e){return void 0===e&&(e=!1),e?this.webSettingsProperty:this.webSettingsProperty.clone()},e.prototype.getDocBackgroundProperty=function(e){return void 0===e&&(e=!1),e?this.docBackgroundProperty:this.docBackgroundProperty.clone()},e.prototype.getShadingProperty=function(e){return void 0===e&&(e=!1),e?this.docSettingsProperty.shadingPr:this.docSettingsProperty.has(this.docSettingsProperty.tKeys.shadingPr)?this.docSettingsProperty.shadingPr.clone():new(Ge.kk.getPropertyClass(Ge.uS.CTShadingPr))},e}()),Tn=JSON.parse('[{"type":"STStyleType_paragraph","defaultKeyword":true,"name":{"val":"Normal"},"pPr":{"spacing":{"before":60,"after":60,"line":240,"lineRule":"STLineSpacingRule_auto"},"widowControl":{"val":false},"jc":{"val":"STJcWml_left"}},"rPr":{"color":{"val":"333333"},"sz":{"val":220}}},{"type":"STStyleType_character","defaultKeyword":true,"name":{"val":"Default Paragraph Font"},"uiPriority":{"val":"1"},"semiHidden":{"val":true},"unhideWhenUsed":{"val":true}},{"type":"STStyleType_table","defaultKeyword":true,"name":{"val":"Normal Table"},"uiPriority":{"val":"99"},"semiHidden":{"val":true},"unhideWhenUsed":{"val":true},"tblPr":{"tblInd":{"w":0,"type":"STTblWidth_dxa"},"tblCellMar":{"top":{"w":0,"type":"STTblWidth_dxa"},"left":{"w":108,"type":"STTblWidth_dxa"},"bottom":{"w":0,"type":"STTblWidth_dxa"},"right":{"w":108,"type":"STTblWidth_dxa"}}}},{"type":"STStyleType_numbering","defaultKeyword":true,"name":{"val":"No List"},"uiPriority":{"val":"99"},"semiHidden":{"val":true},"unhideWhenUsed":{"val":true}},{"type":"STStyleType_paragraph","name":{"val":"heading 1"},"basedOn":{"val":"Normal"},"next":{"val":"Normal"},"uiPriority":{"val":9},"qFormat":{"val":true},"pPr":{"keepNext":{"val":true},"keepLines":{"val":true},"spacing":{"before":0,"after":0,"line":408,"lineRule":"STLineSpacingRule_auto"},"outlineLvl":{"val":0}},"rPr":{"b":{"val":true},"bCs":{"val":true},"sz":{"val":360},"szCs":{"val":360},"color":{"val":"1A1A1A"}}},{"type":"STStyleType_paragraph","name":{"val":"heading 2"},"basedOn":{"val":"Normal"},"next":{"val":"Normal"},"uiPriority":{"val":9},"qFormat":{"val":true},"pPr":{"keepNext":{"val":true},"keepLines":{"val":true},"spacing":{"before":0,"after":0,"line":408,"lineRule":"STLineSpacingRule_auto"},"outlineLvl":{"val":1}},"rPr":{"b":{"val":true},"bCs":{"val":true},"sz":{"val":320},"szCs":{"val":320},"color":{"val":"1A1A1A"}}},{"type":"STStyleType_paragraph","name":{"val":"heading 3"},"basedOn":{"val":"Normal"},"next":{"val":"Normal"},"uiPriority":{"val":9},"qFormat":{"val":true},"pPr":{"keepNext":{"val":true},"keepLines":{"val":true},"spacing":{"before":0,"after":0,"line":408,"lineRule":"STLineSpacingRule_auto"},"outlineLvl":{"val":2}},"rPr":{"b":{"val":true},"bCs":{"val":true},"sz":{"val":280},"szCs":{"val":280},"color":{"val":"1A1A1A"}}},{"type":"STStyleType_paragraph","name":{"val":"heading 4"},"basedOn":{"val":"Normal"},"next":{"val":"Normal"},"uiPriority":{"val":9},"qFormat":{"val":true},"pPr":{"keepNext":{"val":true},"keepLines":{"val":true},"spacing":{"before":0,"after":0,"line":408,"lineRule":"STLineSpacingRule_auto"},"outlineLvl":{"val":3}},"rPr":{"b":{"val":true},"bCs":{"val":true},"sz":{"val":240},"szCs":{"val":240},"color":{"val":"1A1A1A"}}},{"type":"STStyleType_paragraph","name":{"val":"heading 5"},"basedOn":{"val":"Normal"},"next":{"val":"Normal"},"uiPriority":{"val":9},"qFormat":{"val":true},"pPr":{"keepNext":{"val":true},"keepLines":{"val":true},"spacing":{"before":0,"after":0,"line":408,"lineRule":"STLineSpacingRule_auto"},"outlineLvl":{"val":4}},"rPr":{"b":{"val":true},"bCs":{"val":true},"sz":{"val":220},"szCs":{"val":220},"color":{"val":"1A1A1A"}}},{"type":"STStyleType_paragraph","name":{"val":"heading 6"},"basedOn":{"val":"Normal"},"next":{"val":"Normal"},"uiPriority":{"val":9},"qFormat":{"val":true},"pPr":{"keepNext":{"val":true},"keepLines":{"val":true},"spacing":{"before":0,"after":0,"line":408,"lineRule":"STLineSpacingRule_auto"},"outlineLvl":{"val":5}},"rPr":{"b":{"val":true},"bCs":{"val":true},"sz":{"val":220},"szCs":{"val":220},"color":{"val":"1A1A1A"}}},{"type":"STStyleType_paragraph","name":{"val":"heading 7"},"basedOn":{"val":"Normal"},"next":{"val":"Normal"},"uiPriority":{"val":9},"qFormat":{"val":true},"pPr":{"keepNext":{"val":true},"keepLines":{"val":true},"spacing":{"before":0,"after":0,"line":408,"lineRule":"STLineSpacingRule_auto"},"outlineLvl":{"val":6}},"rPr":{"b":{"val":true},"bCs":{"val":true},"sz":{"val":220},"szCs":{"val":220},"color":{"val":"1A1A1A"}}},{"type":"STStyleType_paragraph","name":{"val":"heading 8"},"basedOn":{"val":"Normal"},"next":{"val":"Normal"},"uiPriority":{"val":9},"qFormat":{"val":true},"pPr":{"keepNext":{"val":true},"keepLines":{"val":true},"spacing":{"before":0,"after":0,"line":408,"lineRule":"STLineSpacingRule_auto"},"outlineLvl":{"val":7}},"rPr":{"b":{"val":true},"bCs":{"val":true},"sz":{"val":220},"szCs":{"val":220},"color":{"val":"1A1A1A"}}},{"type":"STStyleType_paragraph","name":{"val":"heading 9"},"basedOn":{"val":"Normal"},"next":{"val":"Normal"},"uiPriority":{"val":9},"qFormat":{"val":true},"pPr":{"keepNext":{"val":true},"keepLines":{"val":true},"spacing":{"before":0,"after":0,"line":408,"lineRule":"STLineSpacingRule_auto"},"outlineLvl":{"val":8}},"rPr":{"b":{"val":true},"bCs":{"val":true},"sz":{"val":220},"szCs":{"val":220},"color":{"val":"1A1A1A"}}},{"type":"STStyleType_paragraph","name":{"val":"Title"},"basedOn":{"val":"Normal"},"next":{"val":"Normal"},"uiPriority":{"val":9},"qFormat":{"val":true},"pPr":{"keepNext":{"val":true},"keepLines":{"val":true},"spacing":{"before":0,"after":0,"line":408,"lineRule":"STLineSpacingRule_auto"},"jc":{"val":"STJcWml_center"},"outlineLvl":{"val":0}},"rPr":{"b":{"val":true},"bCs":{"val":true},"sz":{"val":480},"szCs":{"val":480},"color":{"val":"1A1A1A"}}},{"type":"STStyleType_paragraph","name":{"val":"Subtitle"},"basedOn":{"val":"Normal"},"next":{"val":"Normal"},"uiPriority":{"val":9},"qFormat":{"val":true},"pPr":{"keepNext":{"val":true},"keepLines":{"val":true},"spacing":{"before":0,"after":0,"line":408,"lineRule":"STLineSpacingRule_auto"},"jc":{"val":"STJcWml_center"},"outlineLvl":{"val":1}},"rPr":{"b":{"val":true},"bCs":{"val":true},"sz":{"val":360},"szCs":{"val":360},"color":{"val":"5C5C5C"}}},{"type":"STStyleType_paragraph","name":{"val":"Comments"},"basedOn":{"val":"Normal"},"next":{"val":"Normal"},"uiPriority":{"val":9},"qFormat":{"val":true},"pPr":{"keepNext":{"val":true},"keepLines":{"val":true},"spacing":{"before":0,"after":0,"line":408,"lineRule":"STLineSpacingRule_auto"},"outlineLvl":{"val":0}},"rPr":{"b":{"val":false},"bCs":{"val":false},"sz":{"val":210},"szCs":{"val":210},"color":{"val":"7E7E7E"}}},{"type":"STStyleType_paragraph","name":{"val":"header"},"basedOn":{"val":"Normal"},"uiPriority":{"val":99},"unhideWhenUsed":{"val":true},"pPr":{"pBdr":{"bottom":{"val":"STBorder_single","sz":6,"space":1,"color":"STHexColorAuto_auto"}},"tabs":{"tab":[{"val":"STTabJc_center","pos":"4153"},{"val":"STTabJc_right","pos":"8306"}],"tab_op":{"opType":"Set"}},"snapToGrid":{"val":false},"jc":{"val":"STJcWml_center"}},"rPr":{"sz":{"val":180},"szCs":{"val":180}}},{"type":"STStyleType_paragraph","name":{"val":"footer"},"basedOn":{"val":"Normal"},"uiPriority":{"val":99},"unhideWhenUsed":{"val":true},"pPr":{"tabs":{"tab":[{"val":"STTabJc_center","pos":"4153"},{"val":"STTabJc_right","pos":"8306"}],"tab_op":{"opType":"Set"}},"snapToGrid":{"val":false},"jc":{"val":"STJcWml_center"}},"rPr":{"sz":{"val":180},"szCs":{"val":180}}},{"type":"STStyleType_table","name":{"val":"Table Grid"},"basedOn":{"val":"Normal Table"},"uiPriority":{"val":"39"},"tblPr":{"tblBorders":{"top":{"val":"STBorder_single","sz":"6","space":"0","color":"CBCDD1"},"bottom":{"val":"STBorder_single","sz":"6","space":"0","color":"CBCDD1"},"left":{"val":"STBorder_single","sz":"6","space":"0","color":"CBCDD1"},"right":{"val":"STBorder_single","sz":"6","space":"0","color":"CBCDD1"},"insideH":{"val":"STBorder_single","sz":"6","space":"0","color":"CBCDD1"},"insideV":{"val":"STBorder_single","sz":"6","space":"0","color":"CBCDD1"}}},"tcPr":{"vAlign":{"val":"STVerticalJc_center"}}},{"type":"STStyleType_table","name":{"val":"Doc Table Band 1st"},"basedOn":{"val":"Table Grid"},"uiPriority":{"val":49},"rsid":{"val":"00186440"},"tblPr":{"tblStyleRowBandSize":{"val":1},"tblStyleColBandSize":{"val":1}},"tblStylePr":{"STTblStyleOverrideType_band2Horz":{"tblPr":{},"tcPr":{"shd":{"val":"STShd_clear","color":"STHexColorAuto_auto","fill":"F3F5F7"}},"type":"STTblStyleOverrideType_band2Horz"},"STTblStyleOverrideType_firstRow":{"rPr":{"b":{"val":true},"bCs":{"val":true},"color":{"val":"FFFFFF"}},"tcPr":{"shd":{"val":"STShd_clear","color":"STHexColorAuto_auto","fill":"485368"}},"type":"STTblStyleOverrideType_firstRow"}}},{"type":"STStyleType_table","name":{"val":"Doc Table Band 2nd"},"basedOn":{"val":"Table Grid"},"uiPriority":{"val":49},"rsid":{"val":"00186440"},"tblPr":{"tblStyleRowBandSize":{"val":1},"tblStyleColBandSize":{"val":1}},"tblStylePr":{"STTblStyleOverrideType_band2Horz":{"tblPr":{},"tcPr":{"shd":{"val":"STShd_clear","color":"STHexColorAuto_auto","fill":"E5EFFF"}},"type":"STTblStyleOverrideType_band2Horz"},"STTblStyleOverrideType_firstRow":{"rPr":{"b":{"val":true},"bCs":{"val":true},"color":{"val":"FFFFFF"}},"tcPr":{"shd":{"val":"STShd_clear","color":"STHexColorAuto_auto","fill":"2972F4"}},"type":"STTblStyleOverrideType_firstRow"}}},{"type":"STStyleType_table","name":{"val":"Doc Table Band 3rd"},"basedOn":{"val":"Table Grid"},"uiPriority":{"val":49},"rsid":{"val":"00186440"},"tblPr":{"tblStyleRowBandSize":{"val":1},"tblStyleColBandSize":{"val":1}},"tblStylePr":{"STTblStyleOverrideType_band2Horz":{"tblPr":{},"tcPr":{"shd":{"val":"STShd_clear","color":"STHexColorAuto_auto","fill":"EAFAF1"}},"type":"STTblStyleOverrideType_band2Horz"},"STTblStyleOverrideType_firstRow":{"rPr":{"b":{"val":true},"bCs":{"val":true},"color":{"val":"FFFFFF"}},"tcPr":{"shd":{"val":"STShd_clear","color":"STHexColorAuto_auto","fill":"319B62"}},"type":"STTblStyleOverrideType_firstRow"}}},{"type":"STStyleType_table","name":{"val":"Doc Table Band 4th"},"basedOn":{"val":"Table Grid"},"uiPriority":{"val":49},"rsid":{"val":"00186440"},"tblPr":{"tblStyleRowBandSize":{"val":1},"tblStyleColBandSize":{"val":1}},"tblStylePr":{"STTblStyleOverrideType_band2Horz":{"tblPr":{},"tcPr":{"shd":{"val":"STShd_clear","color":"STHexColorAuto_auto","fill":"FFF3EB"}},"type":"STTblStyleOverrideType_band2Horz"},"STTblStyleOverrideType_firstRow":{"rPr":{"b":{"val":true},"bCs":{"val":true},"color":{"val":"FFFFFF"}},"tcPr":{"shd":{"val":"STShd_clear","color":"STHexColorAuto_auto","fill":"F88825"}},"type":"STTblStyleOverrideType_firstRow"}}},{"type":"STStyleType_table","name":{"val":"Doc Table Band 5th"},"basedOn":{"val":"Table Grid"},"uiPriority":{"val":49},"rsid":{"val":"00186440"},"tblPr":{"tblStyleRowBandSize":{"val":1},"tblStyleColBandSize":{"val":1}},"tblStylePr":{"STTblStyleOverrideType_band2Horz":{"tblPr":{},"tcPr":{"shd":{"val":"STShd_clear","color":"STHexColorAuto_auto","fill":"E5F6FF"}},"type":"STTblStyleOverrideType_band2Horz"},"STTblStyleOverrideType_firstRow":{"rPr":{"b":{"val":true},"bCs":{"val":true},"color":{"val":"FFFFFF"}},"tcPr":{"shd":{"val":"STShd_clear","color":"STHexColorAuto_auto","fill":"00A3F5"}},"type":"STTblStyleOverrideType_firstRow"}}},{"name":{"val":"Doc Table Column 1st"},"basedOn":{"val":"Table Grid"},"uiPriority":{"val":50},"rsid":{"val":"00EA4D8C"},"tblPr":{"tblStyleRowBandSize":{"val":1},"tblStyleColBandSize":{"val":1}},"type":"STStyleType_table","styleId":"521002","tblStylePr":{"STTblStyleOverrideType_firstRow":{"rPr":{"b":{"val":true},"bCs":{"val":true},"color":{"val":"FFFFFF"}},"tblPr":{},"tcPr":{"shd":{"val":"STShd_clear","color":"STHexColorAuto_auto","fill":"485368"}},"type":"STTblStyleOverrideType_firstRow"},"STTblStyleOverrideType_firstCol":{"tcPr":{"shd":{"val":"STShd_clear","color":"STHexColorAuto_auto","fill":"F3F5F7"}},"type":"STTblStyleOverrideType_firstCol"}}},{"name":{"val":"Doc Table Column 2nd"},"basedOn":{"val":"Table Grid"},"uiPriority":{"val":50},"rsid":{"val":"00EA4D8C"},"tblPr":{"tblStyleRowBandSize":{"val":1},"tblStyleColBandSize":{"val":1}},"type":"STStyleType_table","styleId":"521002","tblStylePr":{"STTblStyleOverrideType_firstRow":{"rPr":{"b":{"val":true},"bCs":{"val":true},"color":{"val":"FFFFFF"}},"tblPr":{},"tcPr":{"shd":{"val":"STShd_clear","color":"STHexColorAuto_auto","fill":"2972F4"}},"type":"STTblStyleOverrideType_firstRow"},"STTblStyleOverrideType_firstCol":{"tcPr":{"shd":{"val":"STShd_clear","color":"STHexColorAuto_auto","fill":"E5EFFF"}},"type":"STTblStyleOverrideType_firstCol"}}},{"name":{"val":"Doc Table Column 3rd"},"basedOn":{"val":"Table Grid"},"uiPriority":{"val":50},"rsid":{"val":"00EA4D8C"},"tblPr":{"tblStyleRowBandSize":{"val":1},"tblStyleColBandSize":{"val":1}},"type":"STStyleType_table","styleId":"521002","tblStylePr":{"STTblStyleOverrideType_firstRow":{"rPr":{"b":{"val":true},"bCs":{"val":true},"color":{"val":"FFFFFF"}},"tblPr":{},"tcPr":{"shd":{"val":"STShd_clear","color":"STHexColorAuto_auto","fill":"319B62"}},"type":"STTblStyleOverrideType_firstRow"},"STTblStyleOverrideType_firstCol":{"tcPr":{"shd":{"val":"STShd_clear","color":"STHexColorAuto_auto","fill":"EAFAF1"}},"type":"STTblStyleOverrideType_firstCol"}}},{"type":"STStyleType_character","name":{"val":"Hyperlink"},"basedOn":{"val":"Default Paragraph Font"},"uiPriority":{"val":99},"unhideWhenUsed":{"val":true},"rPr":{"color":{"val":"1E6FFF","themeColor":"STThemeColor_hyperlink"},"u":{"val":"STUnderline_single"}}},{"propertyType":"CTStyleWml","type":"STStyleType_paragraph","name":{"val":"melo-codeblock-Base-theme-para"},"basedOn":{"val":"Normal"},"pPr":{"spacing":{"line":360,"before":0,"after":0,"lineRule":"STLineSpacingRule_auto"}},"rPr":{"rFonts":{"ascii":"Monaco","hAnsi":"Monaco","eastAsia":"Monaco","cs":"Monaco"},"sz":{"val":210},"color":{"val":"000000"}}},{"propertyType":"CTStyleWml","type":"STStyleType_character","name":{"val":"melo-codeblock-Base-theme-char"},"rPr":{"rFonts":{"ascii":"Monaco","hAnsi":"Monaco","eastAsia":"Monaco","cs":"Monaco"},"sz":{"val":210},"color":{"val":"000000"}}}]'),Rn=new Map([[ne.TAq.undefined,"Normal"],[ne.TAq.paragraph,"Normal"],[ne.TAq.character,"Default Paragraph Font"],[ne.TAq.table,"Normal Table"],[ne.TAq.numbering,"No List"]]),In=function(){function e(){this.normalStylesMap=new Map,this.loadStyle()}return e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},e.isBasicStyleName=function(e){return(0,i.__spreadArray)([],(0,i.__read)(Rn.values()),!1).includes(e)},e.getBasicStyleName=function(e){return Rn.get(e)},e.prototype.getBasicStyle=function(e,t){void 0===t&&(t=!1);var n=Rn.get(e);return this.getStyle(n,t)},e.prototype.getStyle=function(e,t){void 0===t&&(t=!1);var n=this.normalStylesMap.get(e);return n?t?n:n.clone():null},e.prototype.isBuiltinStyle=function(e){return this.normalStylesMap.has(e)},e.prototype.addStyle=function(e){e.name&&this.normalStylesMap.set(e.name,e)},e.prototype.loadStyle=function(){var e=this;Tn.forEach((function(t){var n=Fe.vC.deserializeFromType(lt.u.CTStyleWml,t);n instanceof Ge.kk.getPropertyClass(lt.u.CTStyleWml)&&(n.styleId=re.StringUtil.generateRandomId(),e.normalStylesMap.set(n.name,n))}))},e}(),Pn=new Map([["Normal",{zh_CN:""}],["heading 1",{zh_CN:" 1"}],["heading 2",{zh_CN:" 2"}],["heading 3",{zh_CN:" 3"}],["heading 4",{zh_CN:" 4"}],["heading 5",{zh_CN:" 5"}],["heading 6",{zh_CN:" 6"}],["heading 7",{zh_CN:" 7"}],["heading 8",{zh_CN:" 8"}],["heading 9",{zh_CN:" 9"}],["Title",{zh_CN:""}],["Subtitle",{zh_CN:""}],["Default Paragraph Font",{zh_CN:""}],["Normal Table",{zh_CN:""}],["No List",{zh_CN:""}],["Comments",{zh_CN:""}],["header",{zh_CN:""}],["footer",{zh_CN:""}]]),On=JSON.parse('{"rPrDefault":{"rPr":{"kern":{"val":20},"sz":{"val":210},"szCs":{"val":220}}},"pPrDefault":{}}'),kn=Ge.kk.getPropertyClass(Ge.uS.CTTblLook),Dn=[kn.tKeys.firstRow,kn.tKeys.lastRow,kn.tKeys.firstColumn,kn.tKeys.lastColumn,kn.tKeys.noHBand,kn.tKeys.noVBand];!function(e){e.DefaultTheme="Table Grid",e.FirstBand="Doc Table Band 1st",e.SecondBand="Doc Table Band 2nd",e.ThirdBand="Doc Table Band 3rd",e.FourthBand="Doc Table Band 4th",e.FifthBand="Doc Table Band 5th",e.FirstColumn="Doc Table Column 1st",e.SecondColumn="Doc Table Column 2nd",e.ThirdColumn="Doc Table Column 3rd"}(gn||(gn={}));var Mn,An=Ge.kk.getPropertyClass(Ge.uS.CTTblStylePr),Ln=[An.tKeys.tblPr,An.tKeys.trPr,An.tKeys.tcPr,An.tKeys.pPr,An.tKeys.rPr],Nn=[ne.W4f.nwCell,ne.W4f.neCell,ne.W4f.swCell,ne.W4f.seCell,ne.W4f.firstRow,ne.W4f.lastRow,ne.W4f.firstCol,ne.W4f.lastCol,ne.W4f.band1Horz,ne.W4f.band2Horz,ne.W4f.band1Vert,ne.W4f.band2Vert],Bn=function(){function e(e,t){this.styleSheetManager=e,this.tableStream=t,this.styleIdToBandInfoMap=new Map,this.cellPosToPropertyMap=new Map}return e.prototype.isApplyTblStylePr=function(e){var t=this.getTableStyleSheetFromId(e);return!!t&&(t.has(t.tKeys.tblStylePr)||t.has(t.tKeys.rPr)||t.has(t.tKeys.pPr))},e.prototype.getPropOfTblStylePrFromGcp=function(e){var t=this.tableStream.getCellTblStylePrInfo(e);return t?this.getPropertyOfTblStylePr(t.tableCellPos,t.tblStylePrLook):null},e.prototype.getPropertyOfTblStylePr=function(e,t){var n=this.calcCellStylePosKey(e,t),r=this.cellPosToPropertyMap.get(n);if(r)return r;var o=this.mergeTblStylePrProperty(e,t);return o?(this.cellPosToPropertyMap.set(n,o),o):null},e.prototype.mergeTblStylePrInStyle=function(e){for(var t=e.tblStylePr,n=e.basedOn,r=[e.styleId,n];;){var o=this.getTableStyleSheetFromId(n);if(!o)break;if(o.has(o.tKeys.tblStylePr)&&(t=this.mergeTblStylePrOfLayer(t,o.tblStylePr)),r.includes(o.basedOn))break;r.push(o.basedOn),n=o.basedOn}return t},e.prototype.mergeTblStylePrOfLayer=function(e,t){var n=this;return Nn.forEach((function(r){var o=t.getProperty(r),i=e.getProperty(r);(o||i)&&(o&&i?e.appendProperty(n.mergeTblStylePr(i,o),"type"):o&&e.appendProperty(o,"type"))})),e},e.prototype.mergeTblStylePr=function(e,t){return Ln.forEach((function(n){t.has(n)&&(e[n]=Fe.vC.mergeProperty(e[n],t[n]))})),e},e.prototype.mergeTblStylePrProperty=function(e,t){var n=this,r=this.calcCellStylePosType(e,t),o={tableCellProperty:new(Ge.kk.getPropertyClass(Ge.uS.TableCellProperty)),paragraphProperty:new(Ge.kk.getPropertyClass(Ge.uS.ParagraphProperty)),runProperty:new(Ge.kk.getPropertyClass(Ge.uS.RunProperty))};return Nn.forEach((function(e){r[e]&&(o=n.mergeTblStylePrOfOneType(e,o,t.styleId))})),o=this.mergeParaAndRunPropInTable(o,t.styleId)},e.prototype.mergeTblStylePrOfOneType=function(e,t,n){for(var r=[n],o=n,i=t;;){var a=this.getTableStyleSheetFromId(o);if(!a)break;if(a.has(a.tKeys.tblStylePr)){var s=a.tblStylePr.getProperty(e);s&&(i=this.mergeTblStylePrOfOneLayer(i,s))}if(r.includes(a.basedOn))break;r.push(a.basedOn),o=a.basedOn}return i},e.prototype.calcCellStylePosType=function(e,t){var n,r=this.getCellPosInRowAndCol(e,t),o=r.isFirstRow,i=r.isLastRow,a=r.isFristCol,s=r.isLastCol,c=this.getCellPosInBand(e,t),l=c.isBand1Horz,u=c.isBand2Horz,d=c.isBand1Vert,p=c.isBand2Vert;return(n={})[ne.W4f.firstRow]=o,n[ne.W4f.lastRow]=i,n[ne.W4f.firstCol]=a,n[ne.W4f.lastCol]=s,n[ne.W4f.nwCell]=o&&a,n[ne.W4f.neCell]=o&&s,n[ne.W4f.swCell]=i&&a,n[ne.W4f.seCell]=i&&s,n[ne.W4f.band1Horz]=l,n[ne.W4f.band2Horz]=u,n[ne.W4f.band1Vert]=d,n[ne.W4f.band2Vert]=p,n},e.prototype.mergeTblStylePrOfOneLayer=function(e,t){var n=e.tableCellProperty,r=e.paragraphProperty,o=e.runProperty;return t.has(t.tKeys.tcPr)&&(n=Fe.vC.mergeProperty(n,t[t.tKeys.tcPr])),t.has(t.tKeys.pPr)&&(r=Fe.vC.mergeProperty(r,t[t.tKeys.pPr])),t.has(t.tKeys.rPr)&&(o=Fe.vC.mergeProperty(o,t[t.tKeys.rPr])),{tableCellProperty:n,paragraphProperty:r,runProperty:o}},e.prototype.mergeParaAndRunPropInTable=function(e,t){for(var n=e.paragraphProperty,r=e.runProperty,o=[t],i=t;;){var a=this.getTableStyleSheetFromId(i);if(!a)break;if(a.has(a.tKeys.pPr)&&(n=Fe.vC.mergeProperty(n,a[a.tKeys.pPr])),a.has(a.tKeys.rPr)&&(r=Fe.vC.mergeProperty(r,a[a.tKeys.rPr])),o.includes(a.basedOn))break;o.push(a.basedOn),i=a.basedOn}return{paragraphProperty:n,runProperty:r,tableCellProperty:e.tableCellProperty}},e.prototype.calcCellStylePosKey=function(e,t){var n=e.cellIndex,r=e.rowIndex,o=e.isLastRow,i=e.isLastCell,a=t.tblLook,s=t.styleId,c="".concat(n,"-").concat(r,"-").concat(o?"1":"0","-").concat(i?"1":"0"),l=Dn.forEach((function(e){return a[e]?"1":"0"}));return"".concat(s,"-").concat(c,"-").concat(l)},e.prototype.isOddBand=function(e,t,n){var r=n;if(e){if(0===n)return!1;r-=1}return Math.floor(r/t)%2==0},e.prototype.getCellPosInRowAndCol=function(e,t){var n=e.cellIndex,r=e.rowIndex,o=t.tblLook;return{isFirstRow:o.firstRow&&0===r,isLastRow:o.lastRow&&e.isLastRow,isFristCol:o.firstColumn&&0===n,isLastCol:o.lastColumn&&e.isLastCell}},e.prototype.getCellPosInBand=function(e,t){var n=e.cellIndex,r=e.rowIndex,o=t.styleId,i=t.tblLook,a=this.getOddEvenBandInfo(o)||{hasFirstRowProp:!1,hasFirstColProp:!1,bandRowSize:1,bandColSize:1},s=a.hasFirstRowProp,c=a.hasFirstColProp,l=a.bandRowSize,u=a.bandColSize,d=this.isOddBand(s,l,r),p=this.isOddBand(c,u,n);return{isBand1Horz:!i.noHBand&&d,isBand2Horz:!i.noHBand&&!d&&0!==r,isBand1Vert:!i.noVBand&&p,isBand2Vert:!i.noVBand&&!p&&0!==n}},e.prototype.getOddEvenBandInfo=function(e){var t=this.styleIdToBandInfoMap.get(e);if(t)return t;var n=this.calcOddEvenBandInfo(e);return n?(this.styleIdToBandInfoMap.set(e,n),n):null},e.prototype.calcOddEvenBandInfo=function(e){var t=this.getTableStyleSheetFromId(e);if(!t||!t.has(t.tKeys.tblStylePr))return null;for(var n={hasFirstRowProp:!1,hasFirstColProp:!1,bandRowSize:1,bandColSize:1},r=[],o=e;n=this.calcOddEvenBandInfoOfOneLayer(n,t),r.push(o),!r.includes(t.basedOn)&&(o=t.basedOn,t=this.getTableStyleSheetFromId(o)););return n},e.prototype.calcOddEvenBandInfoOfOneLayer=function(e,t){var n=(0,i.__assign)({},e),r=Ge.kk.getPropertyClass(Ge.uS.CTTblPrBase);return t.tblPr.has(r.tKeys.tblStyleRowBandSize)&&(n.bandRowSize=t.tblPr.tblStyleRowBandSize),t.tblPr.has(r.tKeys.tblStyleColBandSize)&&(n.bandColSize=t.tblPr.tblStyleColBandSize),t.has(Ge.kk.getPropertyClass(Ge.uS.CTStyleWml).tKeys.tblStylePr)&&(t.tblStylePr.getProperty(ne.W4f.firstRow)&&(n.hasFirstRowProp=!0),t.tblStylePr.getProperty(ne.W4f.firstCol)&&(n.hasFirstColProp=!0)),n},e.prototype.getTableStyleSheetFromId=function(e){var t=this.styleSheetManager.getStylePropertyFromId(e,!0);return t&&t.type===ne.TAq.table?t:null},e}(),Fn=function(){function e(e){this.tableStream=e,this.styleNameMap=new Map,this.loadedDefaultStyle=!1,this.stylesProperty=new(Ge.kk.getPropertyClass(Ge.uS.StylesProperty)),this.tblStylePrManager=new Bn(this,e)}return e.prototype.getStylesProperty=function(e){return void 0===e&&(e=!1),e?this.stylesProperty:this.stylesProperty.clone()},e.createStylesPropertyFromStyleProps=function(e){var t=new(Ge.kk.getPropertyClass(Ge.uS.StylesProperty));return e.length>0&&(t.style=new(Ge.kk.getPropertyClass(Ge.uS.CommonPropertyDict)),e.forEach((function(e){return t.style.appendProperty(e,"styleId")}))),t},e.getStyleShowName=function(e){var t;return e.aliases||(null===(t=Pn.get(e.name))||void 0===t?void 0:t.zh_CN)||e.name},Object.defineProperty(e.prototype,"styleDict",{get:function(){return this.stylesProperty.style||new(Ge.kk.getPropertyClass(Ge.uS.CommonPropertyDict))},enumerable:!1,configurable:!0}),e.prototype.getDocDefaultsStyle=function(e){void 0===e&&(e=!1),!this.loadedDefaultStyle&&this.stylesProperty.isEmpty(this.stylesProperty.tKeys.docDefaults)&&(this.stylesProperty.docDefaults=this.loadDocDefaults()),this.loadedDefaultStyle=!0;var t=this.stylesProperty.docDefaults;return e?t:t.clone()},e.prototype.getLatentStylesProperty=function(e){void 0===e&&(e=!1);var t=this.stylesProperty.latentStyles;return t?e?t:t.clone():null},e.prototype.getStylePropertyFromId=function(e,t){void 0===t&&(t=!1);var n=this.styleDict.getProperty(e);return n?t?n:n.clone():null},e.prototype.getMergedStyleSet=function(e){var t=this.getStylePropertyFromId(e);return t?(""===t.basedOn||(t.rPr=this.mergeStyleProperty(t.type,t.basedOn,t.rPr,"rPr"),t.pPr=this.mergeStyleProperty(t.type,t.basedOn,t.pPr,"pPr"),t.type===ne.TAq.table&&(t.tblPr=this.mergeStyleProperty(ne.TAq.table,t.basedOn,t.tblPr,"tblPr"),t.trPr=this.mergeStyleProperty(ne.TAq.table,t.basedOn,t.trPr,"trPr"),t.tcPr=this.mergeStyleProperty(ne.TAq.table,t.basedOn,t.tcPr,"tcPr"),t.tblStylePr=this.tblStylePrManager.mergeTblStylePrInStyle(t)),t.basedOn=""),t):null},e.prototype.getStylePropertyFromName=function(e,t){var n;return void 0===t&&(t=!1),this.styleDict.forEach((function(t){if(e===t.name)return n=t,!0})),n?t?n:n.clone():null},e.prototype.isBuiltinStyle=function(e){return In.getInstance().isBuiltinStyle(e)},e.prototype.isBasicStyle=function(e){return In.isBasicStyleName(e.name)},e.prototype.packBuiltinStylePropertyFromName=function(e,t){var n=In.getInstance().getStyle(e);if(!n)return null;if(n.styleId=re.StringUtil.generateRandomId(),n.basedOn===n.name)n.basedOn="";else{var r=this.getStylePropertyFromName(n.basedOn);r||(r=this.packBuiltinStylePropertyFromName(n.basedOn,t)),n.basedOn=(null==r?void 0:r.styleId)||""}if(n.next===n.name)n.next=n.styleId;else{var o=this.getStylePropertyFromName(n.next);o||(o=this.packBuiltinStylePropertyFromName(n.next,t)),n.next=(null==o?void 0:o.styleId)||""}return t.style.appendProperty(n,"styleId"),n},e.prototype.packBuiltinStyleProperty=function(e){if(this.getStylePropertyFromName(e))return null;var t=new(Ge.kk.getPropertyClass(Ge.uS.StylesProperty)),n=this.packBuiltinStylePropertyFromName(e,t);return n?{stylesProp:t,styleProp:n}:null},e.prototype.mergeStyleParaPropWithGcp=function(e,t){var n;return this.mergeStyleParagraphProperty(e,null===(n=this.tblStylePrManager.getPropOfTblStylePrFromGcp(t))||void 0===n?void 0:n.paragraphProperty)},e.prototype.mergeStyleParagraphProperty=function(e,t){var n=Ge.kk.getPropertyClass(Ge.uS.CTInd).tKeys,r=new Map([[Ge.uS.CTInd,new Map([[n.start,n.startChars],[n.startChars,n.start],[n.end,n.endChars],[n.endChars,n.end],[n.left,n.leftChars],[n.leftChars,n.left],[n.right,n.rightChars],[n.rightChars,n.right],[n.hanging,n.hangingChars],[n.hangingChars,n.hanging],[n.firstLine,n.firstLineChars],[n.firstLineChars,n.firstLine],[n.firstLine,n.hanging],[n.hanging,n.firstLine]])]]),o=this.mergeStyleProperty(ne.TAq.paragraph,e.pStyle,e,"pPr",r);t&&(o=Fe.vC.mergeProperty(o,t,r));var i=this.getDocDefaultsStyle(!0).pPrDefault.pPr;return o=Fe.vC.mergeProperty(o,i,r),e.has(e.tKeys.paraId)&&(o.paraId=e.paraId),o},e.prototype.mergeStyleRunPropWithGcp=function(e,t,n){var r;return this.mergeStyleRunProperty(e,t,null===(r=this.tblStylePrManager.getPropOfTblStylePrFromGcp(n))||void 0===r?void 0:r.runProperty)},e.prototype.mergeStyleRunProperty=function(e,t,n){var r=Ge.kk.getPropertyClass(Ge.uS.CTFontsWml).tKeys,o=Ge.kk.getPropertyClass(Ge.uS.CTColorWml).tKeys,i=new Map([[Ge.uS.CTFontsWml,new Map([[r.ascii,r.asciiTheme],[r.asciiTheme,r.ascii],[r.hAnsi,r.hAnsiTheme],[r.hAnsiTheme,r.hAnsi],[r.eastAsia,r.eastAsiaTheme],[r.eastAsiaTheme,r.eastAsia],[r.cs,r.cstheme],[r.cstheme,r.cs]])],[Ge.uS.CTColorWml,new Map([[o.val,o.themeColor],[o.themeColor,o.val]])]]),a=this.mergeStyleProperty(ne.TAq.character,e.rStyle,e,"rPr",i);a=this.mergeStyleProperty(ne.TAq.paragraph,t.pStyle,a,"rPr",i),n&&(a=Fe.vC.mergeProperty(a,n,i));var s=this.getDocDefaultsStyle(!0).rPrDefault.rPr;return a=Fe.vC.mergeProperty(a,s,i)},e.prototype.mergeStyleTableProperty=function(e){var t=e.clone(),n=this.mergeStyleProperty(ne.TAq.table,t.tblPr.tblStyle,t.tblPr,"tblPr");return t.tblPr=n,t},e.prototype.mergeStyleTableRowProperty=function(e,t){return this.mergeStyleProperty(ne.TAq.table,t.tblPr.tblStyle,e,"trPr")},e.prototype.mergeTableCellPropWithGcp=function(e,t,n){var r;return this.mergeStyleTableCellProperty(e,t,null===(r=this.tblStylePrManager.getPropOfTblStylePrFromGcp(n))||void 0===r?void 0:r.tableCellProperty)},e.prototype.mergeStyleTableCellProperty=function(e,t,n){var r=e;return n&&(r=Fe.vC.mergeProperty(r,n)),r=this.mergeStyleProperty(ne.TAq.table,t.tblPr.tblStyle,r,"tcPr")},e.prototype.getTblStylePrManager=function(){return this.tblStylePrManager},e.prototype.mergeStyleProperty=function(e,t,n,r,o){var i=n,a=this.getStylePropertyFromId(t,!0);if(a&&a.type===e)for(var s=[t];a.has(a.tKeys[r])&&(i=Fe.vC.mergeProperty(i,a[r],o)),!s.includes(a.basedOn)&&(s.push(a.basedOn),(a=this.getStylePropertyFromId(a.basedOn,!0))&&a.type===e););else(a=this.getBasicStyleFromType(e,!0)).has(a.tKeys[r])&&(i=Fe.vC.mergeProperty(i,a[r],o));return i},e.prototype.traceToParagraphBaseStyle=function(e,t,n){void 0===n&&(n=!1);var r=!1;if(this.traceToBaseStyle(ne.TAq.paragraph,e.pStyle,"pPr",(function(e){return r=t(e)}),n),!r){var o=this.getDocDefaultsStyle(!0).pPrDefault.pPr;t(o)}},e.prototype.traceToRunBaseStyle=function(e,t,n,r){void 0===r&&(r=!1);var o=!1;if(this.traceToBaseStyle(ne.TAq.character,e.rStyle,"rPr",(function(e){return o=n(e)}),r),o||this.traceToBaseStyle(ne.TAq.paragraph,t.pStyle,"rPr",(function(e){return o=n(e)}),r),!o){var i=this.getDocDefaultsStyle(!0).rPrDefault.rPr;n(i)}},e.prototype.traceToBaseStyle=function(e,t,n,r,o){var i=this.getStylePropertyFromId(t,o);if(i&&i.type===e)for(var a=[];;){if(r(i[n]))return;if(a.includes(i.basedOn))break;if(a.push(i.basedOn),!(i=this.getStylePropertyFromId(i.basedOn,o))||i.type!==e)break}(i=this.getBasicStyleFromType(e,o)).has(i.tKeys[n])&&r(i[n])},e.prototype.getBasicStyleFromType=function(e,t){void 0===t&&(t=!1);var n=In.getBasicStyleName(e),r=null,o=this.styleNameMap.get(n);return o?r=this.getStylePropertyFromId(o,t):(r=this.getStylePropertyFromName(n,t),this.styleNameMap.set(n,(null==r?void 0:r.styleId)||"")),r||In.getInstance().getBasicStyle(e,t)},e.prototype.loadDocDefaults=function(){return new(Ge.kk.getPropertyClass(Ge.uS.CTDocDefaults))(On)},e}(),Un=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.setStylesProp=function(e){var t=this.stylesProperty.merge(e,!0);return this.updateDefaultConfig(),t},t.prototype.updateDefaultConfig=function(){var e=this.getBasicStyleFromType(O.TAq.paragraph,!0).rPr,t=this.getDocDefaultsStyle(!0).rPrDefault.rPr;e=O.vCY.mergeProperty(e,t),H.k.fontSize=e.sz,H.k.textColor=O.QBv.parseHexColor(e.color.val,H.k.textColor),H.k.textBgFill=O.QBv.parseShadingProperties(e.shd,H.k.textBgFill),H.k.textHighlight=O.QBv.parseHighlightColor(e.highlight,H.k.textHighlight)},t}(Fn),Hn=n(46708),jn=function(){function e(e){this.clrScheme=e,this.clrSchemeMapping=this.getDefaultColorSchemeMapping(),this.initMaping()}return e.prototype.initMaping=function(){this.themeColorToColorSchemeIndexMap=this.createThemeColorToColorSchemeIndexMapping(),this.schemeColorToColorSchemeIndexMap=this.createSchemeColorToColorSchemeIndexMapping(),this.colorSchemeIndexToStringMap=this.createColorSchemeIndexToStringMapping()},e.prototype.setColorSchemeMapping=function(e){this.clrSchemeMapping=e,this.initMaping()},e.prototype.mergeThemeColorForRun=function(e){var t=e.color;if(t.has(t.tKeys.themeColor)){var n=this.getRGBColorFromColorWml(t);n&&(t.val=Hn.u$.rgbaColor2hex(n))}},e.prototype.mergeThemeColorForFill=function(e,t){var n=this;if(e.isEmpty(e.tKeys.solidFill))if(e.isEmpty(e.tKeys.gradFill))if(e.isEmpty(e.tKeys.pattFill))(e instanceof O.kkf.getPropertyClass(O.uSS.EGLineFillProperties)||e.isEmpty(e.tKeys.blipFill))&&e.isEmpty(e.tKeys.noFill);else{var r=e.pattFill,o=O.QBv.parseColorObjToRGBAColor(r.fgClr,void 0,this,t);o&&(r.fgClr.srgbClr.val=Hn.u$.rgbaColor2hex(o));var i=O.QBv.parseColorObjToRGBAColor(r.bgClr,void 0,this,t);i&&(r.bgClr.srgbClr.val=Hn.u$.rgbaColor2hex(i))}else e.gradFill.gsLst.gs.forEach((function(e){var r=O.QBv.parseColorObjToRGBAColor(e.egColorChoice,void 0,n,t);r&&(e.egColorChoice.srgbClr.val=Hn.u$.rgbaColor2hex(r))}));else{var a=e.solidFill.egColorChoice,s=O.QBv.parseColorObjToRGBAColor(a,void 0,this,t);s&&(a.srgbClr.val=Hn.u$.rgbaColor2hex(s))}},e.prototype.parseColorObjToHexColor=function(e,t){var n=this.parseColorObjToRGBAColor(e,t);return n?Hn.u$.rgbaColor2hex(n,!0):""},e.prototype.parseColorObjToRGBAColor=function(e,t){return O.QBv.parseColorObjToRGBAColor(e,void 0,this,t)},e.prototype.getRGBColorFromSchemeColor=function(e){var t=this.getColorDmlFromSchemeColorVal(e.val);if(t)return O.QBv.parseColorObjToRGBAColor(t)},e.prototype.getRGBColorFromColorWml=function(e){var t=this.getColorDmlFromThemeColor(e.themeColor);if(t&&!t.isEmpty()){var n={};return e.themeTint?(n.lumMod=parseInt(e.themeTint,16)/255,n.lumOff=1-n.lumMod):e.themeShade&&(n.lumMod=parseInt(e.themeShade,16)/255),O.QBv.parseColorObjToRGBAColor(t,n)}},e.prototype.getColorDmlFromThemeColor=function(e){var t=this.themeColorToColorSchemeIndexMap.get(e);if(t)return this.getColorDmlFromClrSchemeIdx(t)},e.prototype.getColorDmlFromSchemeColorVal=function(e){var t=this.schemeColorToColorSchemeIndexMap.get(e);if(t)return this.getColorDmlFromClrSchemeIdx(t)},e.prototype.getColorDmlFromClrSchemeIdx=function(e){var t=this.colorSchemeIndexToStringMap.get(e);if(t)return this.getClrScheme()[t]},e.prototype.getClrScheme=function(){return this.clrScheme},e.prototype.getDefaultColorSchemeMapping=function(){var e=new(O.kkf.getPropertyClass(O.uSS.CTColorSchemeMapping));return e.bg1=O.eZk.light1,e.t1=O.eZk.dark1,e.bg2=O.eZk.light2,e.t2=O.eZk.dark2,e.accent1=O.eZk.accent1,e.accent2=O.eZk.accent2,e.accent3=O.eZk.accent3,e.accent4=O.eZk.accent4,e.accent5=O.eZk.accent5,e.accent6=O.eZk.accent6,e.hyperlink=O.eZk.hyperlink,e.followedHyperlink=O.eZk.followedHyperlink,e},e.prototype.createThemeColorToColorSchemeIndexMapping=function(){return new Map([[O.cd7.dark1,this.clrSchemeMapping.t1],[O.cd7.light1,this.clrSchemeMapping.bg1],[O.cd7.dark2,this.clrSchemeMapping.t2],[O.cd7.light2,this.clrSchemeMapping.bg2],[O.cd7.accent1,this.clrSchemeMapping.accent1],[O.cd7.accent2,this.clrSchemeMapping.accent2],[O.cd7.accent3,this.clrSchemeMapping.accent3],[O.cd7.accent4,this.clrSchemeMapping.accent4],[O.cd7.accent5,this.clrSchemeMapping.accent5],[O.cd7.accent6,this.clrSchemeMapping.accent6],[O.cd7.hyperlink,this.clrSchemeMapping.hyperlink],[O.cd7.followedHyperlink,this.clrSchemeMapping.followedHyperlink],[O.cd7.background1,this.clrSchemeMapping.bg1],[O.cd7.text1,this.clrSchemeMapping.t1],[O.cd7.background2,this.clrSchemeMapping.bg2],[O.cd7.text2,this.clrSchemeMapping.t2],[O.cd7.none,O.eZk.undefined],[O.cd7.undefined,O.eZk.undefined]])},e.prototype.createSchemeColorToColorSchemeIndexMapping=function(){return new Map([[O.vuv.dk1,this.clrSchemeMapping.t1],[O.vuv.lt1,this.clrSchemeMapping.bg1],[O.vuv.dk2,this.clrSchemeMapping.t2],[O.vuv.lt2,this.clrSchemeMapping.bg2],[O.vuv.accent1,this.clrSchemeMapping.accent1],[O.vuv.accent2,this.clrSchemeMapping.accent2],[O.vuv.accent3,this.clrSchemeMapping.accent3],[O.vuv.accent4,this.clrSchemeMapping.accent4],[O.vuv.accent5,this.clrSchemeMapping.accent5],[O.vuv.accent6,this.clrSchemeMapping.accent6],[O.vuv.hlink,this.clrSchemeMapping.hyperlink],[O.vuv.folHlink,this.clrSchemeMapping.followedHyperlink],[O.vuv.bg1,this.clrSchemeMapping.bg1],[O.vuv.tx1,this.clrSchemeMapping.t1],[O.vuv.bg2,this.clrSchemeMapping.bg2],[O.vuv.tx2,this.clrSchemeMapping.t2],[O.vuv.phClr,O.eZk.undefined],[O.vuv.undefined,O.eZk.undefined]])},e.prototype.createColorSchemeIndexToStringMapping=function(){var e=O.kkf.getPropertyClass(O.uSS.CTColorScheme).tKeys;return new Map([[O.eZk.dark1,e.dk1],[O.eZk.light1,e.lt1],[O.eZk.dark2,e.dk2],[O.eZk.light2,e.lt2],[O.eZk.accent1,e.accent1],[O.eZk.accent2,e.accent2],[O.eZk.accent3,e.accent3],[O.eZk.accent4,e.accent4],[O.eZk.accent5,e.accent5],[O.eZk.accent6,e.accent6],[O.eZk.hyperlink,e.hlink],[O.eZk.followedHyperlink,e.folHlink],[O.eZk.undefined,""]])},e}();!function(e){e.ASCII="ASCII",e.HighANSI="HighANSI",e.EastAsian="EastAsian",e.ComplexScript="ComplexScript"}(Mn||(Mn={}));var Gn,Vn=function(){function e(e){this.fontScheme=e}return e.prototype.mergeThemeFontForRun=function(e,t){if(!e.isEmpty(e.tKeys.rFonts)){var n=e,r=n.rFonts,o="",i=O.Rdv.undefined;switch(t){case Mn.ASCII:o=r.ascii,i=r.asciiTheme;break;case Mn.HighANSI:o=r.hAnsi,i=r.hAnsiTheme;break;case Mn.EastAsian:o=r.eastAsia,i=r.eastAsiaTheme;break;case Mn.ComplexScript:o=r.cs,i=r.cstheme}i&&(o=this.getFontFromTheme(i)),n.mergeThemeFont(o)}},Object.defineProperty(e.prototype,"majorFont",{get:function(){return this.fontScheme.majorFont},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minorFont",{get:function(){return this.fontScheme.minorFont},enumerable:!1,configurable:!0}),e.prototype.getMajorLatinFont=function(){return this.majorFont.latin.typeface},e.prototype.getMajorEastAsiaFont=function(){var e=this.majorFont.ea.typeface;return this.majorFont.font.forEach((function(t){if("Hans"===t.script)return e=t.typeface,!0})),e},e.prototype.getMajorComplexScriptFont=function(){return this.majorFont.cs.typeface},e.prototype.getMinorLatinFont=function(){return this.minorFont.latin.typeface},e.prototype.getMinorEastAsiaFont=function(){var e=this.minorFont.ea.typeface;return this.minorFont.font.forEach((function(t){if("Hans"===t.script)return e=t.typeface,!0})),e},e.prototype.getMinorComplexScriptFont=function(){return this.minorFont.cs.typeface},e.prototype.getFontFromTheme=function(e){var t="";switch(e){case O.Rdv.majorEastAsia:t=this.getMajorEastAsiaFont();break;case O.Rdv.majorBidi:t=this.getMajorComplexScriptFont();break;case O.Rdv.majorAscii:case O.Rdv.majorHAnsi:t=this.getMajorLatinFont();break;case O.Rdv.minorEastAsia:t=this.getMinorEastAsiaFont();break;case O.Rdv.minorBidi:t=this.getMinorComplexScriptFont();break;case O.Rdv.minorAscii:case O.Rdv.minorHAnsi:t=this.getMinorLatinFont()}return t},e}(),Wn=function(){function e(e){this.fmtScheme=e}return e.prototype.getLineProperties=function(e){return this.getFmtScheme().lnStyleLst.ln.getProperty(e.idx-1)},e.prototype.getFillProperties=function(e){return this.getFmtScheme().fillStyleLst.egFillProperties.getProperty(e.idx-1)},e.prototype.getEffectProperties=function(e){return this.getFmtScheme().effectStyleLst.effectStyle.getProperty(e.idx-1)},e.prototype.getFmtScheme=function(){return this.fmtScheme},e}(),zn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.setThemesProp=function(e){return(0,i.__assign)({},this.themesProperty.merge(e,!0))},t.prototype.setColorSchemeMapping=function(e){this.themeColorManager.setColorSchemeMapping(e)},t}(function(){function e(){this.themesProperty=new(Ge.kk.getPropertyClass(Ge.uS.ThemesProperty)),this.themeFontManager=new Vn(this.themesProperty.themeElements.fontScheme),this.themeColorManager=new jn(this.themesProperty.themeElements.clrScheme),this.themeFormatManager=new Wn(this.themesProperty.themeElements.fmtScheme)}return e.prototype.getThemesProperty=function(e){return void 0===e&&(e=!1),e?this.themesProperty:this.themesProperty.clone()},e.prototype.mergeThemeForRun=function(e,t){this.themeFontManager.mergeThemeFontForRun(e,t),this.themeColorManager.mergeThemeColorForRun(e)},e}()),Kn=function(){function e(e){this.dataStream=e}return e.prototype.setNotification=function(e){this.notification=e},e.prototype.getNotificationCenter=function(){var e;return null===(e=this.notification)||void 0===e?void 0:e.getNotificationCenter()},e.prototype.getSettingsManager=function(){return this.settingsManager||(this.settingsManager=new xn),this.settingsManager},e.prototype.getStyleSheetManager=function(){return this.styleSheetManager||(this.styleSheetManager=new Un(this.dataStream.getTableStream())),this.styleSheetManager},e.prototype.getNumberingManager=function(){return this.numberingManager||(this.numberingManager=new En(this.dataStream,this.getStyleSheetManager())),this.numberingManager},e.prototype.getFontTableManager=function(){return this.fontTableManager||(this.fontTableManager=new fn),this.fontTableManager},e.prototype.getThemeManager=function(){return this.themeManager||(this.themeManager=new zn),this.themeManager},e.prototype.setDocumentSettings=function(e){var t,n=this.getSettingsManager().setDocSettingsProp(e);return null===(t=this.notification)||void 0===t||t.setDocumentSettings(n.modifiedProp),this.initColorSchemeMapping(),n},e.prototype.setWebSettings=function(e){var t,n=this.getSettingsManager().setWebSettingsProp(e);return null===(t=this.notification)||void 0===t||t.setWebSettings(n.modifiedProp),n},e.prototype.setDocBackgroundProperty=function(e){var t,n=this.getSettingsManager().setDocBackgroundProp(e);return null===(t=this.notification)||void 0===t||t.setDocBackgroundProperty(n.modifiedProp),n},e.prototype.setStyleSheet=function(e){var t,n=this.getStyleSheetManager().setStylesProp(e);return null===(t=this.notification)||void 0===t||t.setStyleSheet(n.modifiedProp),n},e.prototype.setNumberingProperty=function(e){var t,n=this.getNumberingManager().setNumberingProp(e);return null===(t=this.notification)||void 0===t||t.setNumberingProperty(n.modifiedProp),n},e.prototype.setFontTable=function(e){var t,n=this.getFontTableManager().setFontsProp(e);return null===(t=this.notification)||void 0===t||t.setFontTable(n.modifiedProp),n},e.prototype.setThemesProperty=function(e){var t,n=this.getThemeManager().setThemesProp(e);return null===(t=this.notification)||void 0===t||t.setThemesProperty(n.modifiedProp),this.initColorSchemeMapping(),n},e.prototype.initColorSchemeMapping=function(){this.themeManager&&this.settingsManager&&!this.settingsManager.getDocSettingsProperty().clrSchemeMapping.isEmpty()&&this.themeManager.setColorSchemeMapping(this.settingsManager.getDocSettingsProperty().clrSchemeMapping)},e}(),qn=function(){function e(){this._asyncEmitters=new Map,this._syncEmitters=new Map}return e.prototype.getAsyncEmitter=function(e){var t=this._asyncEmitters.get(e);return t||(t=new re.Emitter,this._asyncEmitters.set(e,t)),t},e.prototype.getSyncEmitter=function(e){var t=this._syncEmitters.get(e);return t||(t=new re.Emitter,this._syncEmitters.set(e,t)),t},e.prototype.removeEmitter=function(e){this._asyncEmitters&&this._asyncEmitters.delete(e),this._syncEmitters&&this._syncEmitters.delete(e)},e.prototype.on=function(e,t,n,r,o){void 0===n&&(n=!0),(n?this.getAsyncEmitter(e):this.getSyncEmitter(e)).addListener(t,r,o)},e.prototype.fire=function(e){this.getAsyncEmitter(e.type).fire(e,!0),this.getSyncEmitter(e.type).fire(e,!1)},e.prototype.removeCallBack=function(e,t){var n=this.getAsyncEmitter(e);n.removeCallBack(t),(n=this.getSyncEmitter(e)).removeCallBack(t)},e.prototype.removeListener=function(e,t){var n=this.getAsyncEmitter(e);n.removeListener(t),(n=this.getSyncEmitter(e)).removeListener(t)},e.prototype.once=function(e,t,n,r){void 0===n&&(n=!0),(n?this.getAsyncEmitter(e):this.getSyncEmitter(e)).addListener((function(e){t(e),e.callOnce()}),r)},e}();!function(e){e.PageNumChanged="PageNumChanged",e.FieldDelete="FieldDelete",e.FieldInsert="FieldInsert"}(Gn||(Gn={}));var Yn,Qn=function(e){function t(){return e.call(this,Gn.PageNumChanged)||this}return(0,i.__extends)(t,e),t}(re.Notification),Zn=function(e){function t(t){var n=e.call(this,Gn.FieldDelete)||this;return n.fieldCodes=t,n}return(0,i.__extends)(t,e),t}(re.Notification),Xn=function(){function e(e){this.notificationCenter=e}return e.prototype.getNotificationCenter=function(){return this.notificationCenter},e.prototype.setRunProp=function(e,t,n,r){this.notificationCenter.fire(new Ie(new b.IC(e,t),n,le.RunChange,r))},e.prototype.setParagraphProp=function(e,t,n,r){this.notificationCenter.fire(new Ie(new b.IC(e,t),n,le.ParaChange,r))},e.prototype.setSectionProp=function(e,t,n){this.notificationCenter.fire(new Ie(new b.IC(e,t),n,le.SectChange))},e.prototype.setStoryProp=function(e,t,n){this.notificationCenter.fire(new Ie(new b.IC(e,t),n,le.StoryChange))},e.prototype.setSubStoryProp=function(e,t,n){this.notificationCenter.fire(new Ie(new b.IC(e,t),n,le.SubStoryChange))},e.prototype.setCommentProp=function(e,t,n){this.notificationCenter.fire(new Ie(new b.IC(e,t),n,le.CommentChange))},e.prototype.setDrawingProp=function(e,t,n){this.notificationCenter.fire(new Ie(new b.IC(e,t),n,le.DrawingChange))},e.prototype.setPictureProp=function(e,t,n){this.notificationCenter.fire(new Ie(new b.IC(e,t),n,le.PictureChange))},e.prototype.setEmbeddedObjectProp=function(e,t,n){this.notificationCenter.fire(new Ie(new b.IC(e,t),n,le.EmbeddedObjectChange))},e.prototype.setFootnoteProp=function(e,t,n){this.notificationCenter.fire(new Ie(new b.IC(e,t),n,le.FootnoteChange))},e.prototype.setEndnoteProp=function(e,t,n){this.notificationCenter.fire(new Ie(new b.IC(e,t),n,le.EndnoteChange))},e.prototype.setTableProp=function(e,t,n){this.notificationCenter.fire(new Ie(new b.IC(e,t),n,le.TableChange))},e.prototype.setTableRowProp=function(e,t,n){this.notificationCenter.fire(new Ie(new b.IC(e,t),n,le.TableRowChange))},e.prototype.setTableCellProp=function(e,t,n){this.notificationCenter.fire(new Ie(new b.IC(e,t),n,le.TableCellChange))},e.prototype.setFieldProp=function(e,t,n,r){this.notificationCenter.fire(new Pe(new b.IC(e,t),n,r,le.FieldChange))},e.prototype.setMathProp=function(e,t,n){this.notificationCenter.fire(new Ie(new b.IC(e,t),n,le.MathChange))},e.prototype.setMathObjectProp=function(e,t,n){this.notificationCenter.fire(new Ie(new b.IC(e,t),n,le.MathObjectChange))},e.prototype.setMathRunProp=function(e,t,n){this.notificationCenter.fire(new Ie(new b.IC(e,t),n,le.MathRunChange))},e.prototype.setSdtProp=function(e,t,n){this.notificationCenter.fire(new Ie(new b.IC(e,t),n,le.SdtChange))},e.prototype.insertText=function(e,t,n,r){this.notificationCenter.fire(new Te(new b.IC(e,t),n,r))},e.prototype.deleteText=function(e,t,n){this.notificationCenter.fire(new Re(new b.IC(e,t),n))},e.prototype.deleteProperty=function(e,t){return this.notificationCenter.fire(new xe(e,t))},e.prototype.insertCommentRange=function(e,t,n){return this.notificationCenter.fire(new be(new b.IC(e,t),n))},e.prototype.deleteCommentRange=function(e){return this.notificationCenter.fire(new _e(e))},e.prototype.insertBookmarkRange=function(e,t,n){return this.notificationCenter.fire(new be(new b.IC(e,t),n))},e.prototype.deleteBookmarkRange=function(e){return this.notificationCenter.fire(new _e(e))},e.prototype.insertPermissionRange=function(e,t,n){return this.notificationCenter.fire(new Ce(new b.IC(e,t),n))},e.prototype.deletePermissionRange=function(e){return this.notificationCenter.fire(new Se(e))},e.prototype.insertRevisionRange=function(e,t,n){return this.notificationCenter.fire(new we(new b.IC(e,t),n))},e.prototype.deleteRevisionRange=function(e){return this.notificationCenter.fire(new Ee(e))},e.prototype.deleteFieldCodes=function(e){return this.notificationCenter.fire(new Zn(e))},e.prototype.insertQuoteRange=function(e){return this.notificationCenter.fire(new Se(e))},e.prototype.deleteQuoteRange=function(e){return this.notificationCenter.fire(new Se(e))},e}(),Jn=function(){function e(e){this.notificationCenter=e}return e.prototype.getNotificationCenter=function(){return this.notificationCenter},e.prototype.setDocumentSettings=function(e){this.notificationCenter.fire(new vn(e,an.DocumentSettingsChange))},e.prototype.setWebSettings=function(e){this.notificationCenter.fire(new vn(e,an.WebSettingsChange))},e.prototype.setDocBackgroundProperty=function(e){this.notificationCenter.fire(new vn(e,an.DocBackgroundChange))},e.prototype.setStyleSheet=function(e){this.notificationCenter.fire(new vn(e,an.StyleSheetChange))},e.prototype.setNumberingProperty=function(e){this.notificationCenter.fire(new vn(e,an.NumberingChange))},e.prototype.setFontTable=function(e){this.notificationCenter.fire(new vn(e,an.FontTableChange))},e.prototype.setThemesProperty=function(e){this.notificationCenter.fire(new vn(e,an.ThemeChange))},e}(),$n=function(){function e(e){this.notificationCenter=new qn,this.needNotification=e,this.dataStream=new hn,this.dataManager=new Kn(this.dataStream),this.mutNum=0,this.gcpChunkEnd=-1,this.isChunkLoadReadonly=!1,this.initNotification()}return e.prototype.initNotification=function(){this.needNotification?(this.dataStream.setNotification(new Xn(this.notificationCenter)),this.dataManager.setNotification(new Jn(this.notificationCenter))):(this.dataStream.setNotification(void 0),this.dataManager.setNotification(void 0)),this.dataManager.getNumberingManager().resetListManager()},e.createCoreDataEngine=function(){return new e(!0)},e.createTempDataEngine=function(){return new e(!1)},e.prototype.getNotificationCenter=function(){return this.notificationCenter},e.prototype.getDataStream=function(){return this.dataStream},e.prototype.getMutNum=function(){return this.mutNum},e.prototype.setMutNum=function(e){this.mutNum=e},e.prototype.getIsChunkLoading=function(){return this.gcpChunkEnd>=0},e.prototype.getGCPChunkEnd=function(){return this.gcpChunkEnd},e.prototype.setGCPChunkEnd=function(e){this.gcpChunkEnd=e},e.prototype.getIsChunkLoadReadonly=function(){return this.isChunkLoadReadonly},e.prototype.setIsChunkLoadReadonly=function(e){this.isChunkLoadReadonly=e},e.prototype.getDataManager=function(){return this.dataManager},e.prototype.copyFrom=function(e){return this.dataManager=e.dataManager,this.dataStream=e.dataStream,this.notificationCenter=e.notificationCenter,this.gcpChunkEnd=e.gcpChunkEnd,this.initNotification(),this},e.prototype.createFastRangeClass=function(e,t){return void 0===e&&(e=!1),void 0===t&&(t=!0),this.dataStream.createFastRangeClass(e,t)},e.prototype.createRangeClass=function(e,t){return void 0===e&&(e=!1),void 0===t&&(t=!0),this.dataStream.createRangeClass(e,t)},e.prototype.createGCPClass=function(e,t,n){return void 0===e&&(e=!1),void 0===t&&(t=!0),void 0===n&&(n=s.Outer),this.dataStream.createGCPClass(e,t,n)},e}();!function(e){e.PAGE_NUM="pageNum",e.PAGE_COUNT="pageCount",e.PAGE_NUM_FORMAT="pageNumFormat"}(Yn||(Yn={}));var er=function(e,t,n,r){void 0===r&&(r=1);for(var o=e.getLength(),i=t;i<o&&i>=0;i+=r)if(n.indexOf(e.charAt(i))<0)return i;return t},tr=1},46016:function(e,t,n){n.d(t,{LV0:function(){return to},RpJ:function(){return oo},AOE:function(){return po},qv2:function(){return uo},rcG:function(){return gr},PdL:function(){return Xo},ry8:function(){return pr},Ad_:function(){return jn},vRN:function(){return we},fDs:function(){return be},d_x:function(){return _n},QMx:function(){return y},bL4:function(){return Nn},kvr:function(){return zr},f8X:function(){return Wr},Rmi:function(){return z},F78:function(){return K},wZO:function(){return W},Xg1:function(){return Q},Gc:function(){return Et},zOr:function(){return hn},vW8:function(){return fn},GEy:function(){return no},EKA:function(){return me},hpT:function(){return fo},CVG:function(){return jr},cip:function(){return Br},LfI:function(){return ee},JiU:function(){return D},Pb7:function(){return or},_Nr:function(){return Pe},tBw:function(){return Jo},W4e:function(){return _e},BrT:function(){return Ce},Rli:function(){return Vr},dXU:function(){return Ie},vt1:function(){return Ee},n2p:function(){return M},Dyt:function(){return l},D_l:function(){return w},cbw:function(){return i},uWz:function(){return De},Lll:function(){return Re},a7B:function(){return d},EuV:function(){return q},n0j:function(){return Xr},yS1:function(){return h},e2Q:function(){return f},ajJ:function(){return j},h9f:function(){return eo},$_n:function(){return Ko},OEm:function(){return _},bag:function(){return C},hss:function(){return R},Ojn:function(){return I},uZK:function(){return bn},Cyd:function(){return Y},sfL:function(){return Oe},xt0:function(){return mn},rZg:function(){return qo},Fw4:function(){return zo},YQK:function(){return $n},xNC:function(){return ir},iz9:function(){return er},x7H:function(){return pe},MYZ:function(){return Qr},y8O:function(){return xe},lvA:function(){return L},kyn:function(){return k},ddz:function(){return tr},A5G:function(){return Jn},YDw:function(){return ce},VDf:function(){return se},hjr:function(){return mr},NkY:function(){return ae},x3A:function(){return ke},w0b:function(){return fe},EZ5:function(){return Z},cUw:function(){return Bn},ypq:function(){return Pr},Qgp:function(){return c},$oP:function(){return u},kv7:function(){return p},kgn:function(){return r},tm2:function(){return mi},_AL:function(){return nr},Ypk:function(){return Hn},nTW:function(){return Kr},Oy7:function(){return Ao},LB5:function(){return U},bu_:function(){return Cr},RUH:function(){return Sr},qgr:function(){return _r},sRw:function(){return wr},YHz:function(){return ye},hAO:function(){return ve},H4t:function(){return ge},tkU:function(){return qn},YF2:function(){return br},l29:function(){return rr},Wr$:function(){return le},JxG:function(){return G},TV9:function(){return V},p1Y:function(){return x},Xvi:function(){return Me},IjZ:function(){return T},HLW:function(){return Ae},NgY:function(){return g},x70:function(){return fr},bBX:function(){return Yr},Hzo:function(){return qr},PvE:function(){return H},fyQ:function(){return N},r3l:function(){return $},RV3:function(){return re},Am3:function(){return oe},QhY:function(){return ho},fnp:function(){return mo},Knp:function(){return yo},s9W:function(){return Vo},ekG:function(){return A},CAo:function(){return o},Vy7:function(){return B},Vpn:function(){return F},xDH:function(){return Go},LNB:function(){return E},M5B:function(){return Wo},NlU:function(){return de},$hw:function(){return ue},SOA:function(){return Se},jcg:function(){return P},XNP:function(){return O},rOq:function(){return Ne},SE$:function(){return ct},$gc:function(){return Qe},yAE:function(){return J},KQB:function(){return S},MpL:function(){return ie},hxJ:function(){return X},VI0:function(){return Sn},rhU:function(){return gt},PFq:function(){return Un},khV:function(){return ot},kN2:function(){return rt},FZR:function(){return On},_cT:function(){return kn},$Zc:function(){return at},NQT:function(){return bo},Aa5:function(){return Rn},YrZ:function(){return lt},xlq:function(){return Ln},B8I:function(){return wn},bqj:function(){return In},UHV:function(){return Pn},jVi:function(){return En},SsA:function(){return Cn},vQ7:function(){return xn},L9X:function(){return Tn},UY:function(){return it},F51:function(){return Ge}});var r,o={};n.r(o),n.d(o,{VAlignMap:function(){return St},alignToTblpXSpecMap:function(){return Kt},baseCellToCss:function(){return Mt},bordersToCss:function(){return kt},createCellStyle:function(){return At},getTableCellTotalWidth:function(){return Lt},getTableRightBorderWidth:function(){return Nt},horzAnchorToStyleMap:function(){return Ut},marginToCss:function(){return Dt},msoTable:function(){return Yt},styleToHorzAnchorMap:function(){return Ht},styleToOverlapMap:function(){return qt},styleToTblpXSpecToMap:function(){return Vt},styleToTblpYSpecMap:function(){return zt},styleToVerAnchorMap:function(){return Ft},tblpXSpecToAlignMap:function(){return Gt},tblpXSpecToStyleMap:function(){return jt},tblpYSpecToStyleMap:function(){return Wt},verAnchorToStyleMap:function(){return Bt},widthCss:function(){return Pt}}),function(e){e.CARET_CHANGE="caret_change",e.REQUEST_FOCUS="REQUEST_FOCUS",e.CONTAINER_FOCUS="container_foucus",e.CONTEXT_MENU_EVENT="context_menu",e.CONTEXT_MENU_MOBILE_EVENT="context_menu_mobile",e.FIRST_RENDER="first_render",e.HEADERFOOTER_DBCLICK="headerfooter_dbclick",e.MAINCONTAINER_DBCLICK="maincontainer_dbclick",e.IMAGE_LAZY_LOAD="image_lazy_load",e.IMAGE_RESIZE="image_resize",e.IMAGE_SIZE_INIT="image_size_init",e.IMAGE_UPDATE="image_update",e.PAGEGAP_DBCLICK="pagegap_dbclick",e.RENDER_FINISH="render_finish",e.RENDER_FINISH_TABLE="render_finish_table",e.RENDER_LAYOUT_CHANGE="render_layout_change",e.RENDER_RANGE="render_range",e.SCROLLABLE_RESIZE="scrollable_resize",e.SELECTION_CHANGE="selection_change",e.SELECTION_END="selection_end",e.SELECTION_LIST="selection_list",e.SEL_TABLE="sel_table",e.SELECT_TABLE_ROWCOL="select_table_rowcol",e.INSERT_TABLE_COL="insert_table_col",e.INSERT_TABLE_ROW="insert_table_row",e.DELETE_TABLE_ROW="delete_table_row",e.DELETE_TABLE_COL="delete_table_col",e.DELETE_TABLE="delete_table",e.MOVE_TABLE_ROWS="move_table_rows",e.MOVE_TABLE_COLS="move_table_cols",e.DRAGGING_TABLE_ROWS="dragging_table_rows",e.FINISH_DRAG_TABLE_ROWS="finish_drag_table_rows",e.TABLE_COL_BLUE_LINE_DISPLAY="table_col_blue_line_display",e.SHOW_TABLE_ICON="show_table_icon",e.SHOW_TABLE_HIGHLIGHT="show_table_highlight",e.SPLITLINE_CLICK="splitline_click",e.TABLE_ROW_COL_CHANGE="table_row_col_change",e.UPDATE_COVERED_PANEL="udpate_covered_panel",e.UPDATE_KEYBOARD_HEIGHT="update_keyboard_height",e.PLUGIN_CONTAINER_WILL_FOCUS="plugin_container_will_focus",e.LOCATION_CLICK="location_click",e.FULL_RENDER="full_render",e.FULL_RENDER_FINISH="full_render_finish",e.TABLE_DID_SCROLL="table_did_scroll",e.TABLE_DID_AUTO_SCROLL="table_did_auto_scroll",e.TEXTFRAME_DID_SCROLL="textframe_did_scroll",e.TEXTFRAME_NEED_CHANGE_BACKGROUND="textframe_need_change_background",e.SEARCH_DIALOG="search_dialog",e.RENDER_NEXT_TICK="render_next_tick",e.PAGE_MOUSE_EVENT="page_mouse_event",e.PAGE_TOUCH_EVENT="page_touch_event",e.SCROLL_TO_UNRENDER="scroll_to_unrender",e.SNAPSHOT_RENDER_START="snapshot_render_start",e.SNAPSHOT_RENDER_FINISH="snapshot_render_finish",e.SHOW_EDIT_TIPS="show_edit_tips",e.UPDATE_TABLE_COL_WIDTH="update_table_col_width",e.UPDATE_TABLE_COLS_WIDTH="update_table_cols_width",e.BLOCK_LAYER_FORCE_UPDATE="block_layer_force_update",e.BLOCK_PARAGRAPH_CHECK="block_paragraph_check",e.CONTEXT_MENU_FOR_BLOCK_EVENT="context_menu_for_block",e.INIT_BLOCK_STATE="init_block_state",e.ENTER_BLOCK_STATE="enter_block_state",e.EXIT_BLOCK_STATE="exit_block_state",e.ENTER_BLOCK_STATE_FROM_USER="enter_block_state_from_user",e.EXIT_BLOCK_STATE_FROM_USER="exit_block_state_from_user",e.UPDATE_BLOCK_RANGES="update_block_ranges",e.RESIZE_TABLE="resize_table",e.SHOW_TABLE_BUBBLE_REMINDER="show_table_bubble_reminder",e.HIDE_TABLE_BUBBLE_REMINDER="hide_table_bubble_reminder",e.HIDDEN_EDITOR_LOAD_FINISH="hidden_editor_load_finish",e.HIDE_SNAPSHOT="hide_snapshot",e.BLOCK_UNDO="block_undo",e.BLOCK_REDO="block_redo",e.SELECT_WORD="select_word",e.SELECT_PARAGRAPH="select_paragraph",e.ON_LANDSCAPE_CHANGE="on_landspace_change",e.TOGGLE_MOBILE_CONTEXTMENU="toggle_mobile_contextmenu"}(r||(r={}));var i,a=n(85556),s=n(30479),c=function(e){function t(){return e.call(this,r.RENDER_FINISH)||this}return(0,a.__extends)(t,e),t}(s.Notification),l=function(e){function t(){return e.call(this,r.FIRST_RENDER)||this}return(0,a.__extends)(t,e),t}(s.Notification),u=function(e){function t(){return e.call(this,r.RENDER_LAYOUT_CHANGE)||this}return(0,a.__extends)(t,e),t}(s.Notification),d=(function(e){function t(){return e.call(this,r.FULL_RENDER)||this}(0,a.__extends)(t,e)}(s.Notification),function(e){function t(){return e.call(this,r.FULL_RENDER_FINISH)||this}return(0,a.__extends)(t,e),t}(s.Notification)),p=function(e){function t(t){void 0===t&&(t=!0);var n=e.call(this,r.RENDER_NEXT_TICK)||this;return n.documentUpdate=t,n}return(0,a.__extends)(t,e),t}(s.Notification),h=function(e){function t(){return e.call(this,r.HIDDEN_EDITOR_LOAD_FINISH)||this}return(0,a.__extends)(t,e),t}(s.Notification),f=function(e){function t(){return e.call(this,r.HIDE_SNAPSHOT)||this}return(0,a.__extends)(t,e),t}(s.Notification),g=function(e){function t(t,n,o){var i=e.call(this,r.SELECTION_CHANGE)||this;return i.viewRange=t,i.zoom=n,i.option=o,i}return(0,a.__extends)(t,e),t}(s.Notification),v=function(e){function t(t,n){var o=e.call(this,r.SELECTION_END)||this;return o.viewRange=t,o.option=n,o}return(0,a.__extends)(t,e),t}(s.Notification),y=function(e){function t(t,n){var o=e.call(this,r.CARET_CHANGE)||this;return o.viewRange=t,o.option=n,o}return(0,a.__extends)(t,e),t}(s.Notification),m=function(e){function t(t){var n=e.call(this,r.SELECTION_LIST)||this;return n.listInfo=t,n}return(0,a.__extends)(t,e),t}(s.Notification),b=function(e){function t(t,n,o){var i=e.call(this,r.CONTAINER_FOCUS)||this;return i.focus=t,i.focusedContainer=o,i.currentContainer=o,i.clickState=n,i}return(0,a.__extends)(t,e),t}(s.Notification),_=function(e){function t(t,n,o){var i=e.call(this,r.IMAGE_SIZE_INIT)||this;return i.height=t,i.width=n,i.imageHeight=0,i.imageWidth=0,i.imageHeight=t,i.imageWidth=n,i.range=o,i}return(0,a.__extends)(t,e),t}(s.Notification),C=function(e){function t(t){var n=e.call(this,r.IMAGE_UPDATE)||this;return n.anchorId=t,n}return(0,a.__extends)(t,e),t}(s.Notification);!function(e){e.ON_FOCUS="on_focus",e.ON_BLUR="on_blur",e.ON_REQUEST_FOCUS="on_request_focus",e.ON_REQUEST_BLUR="on_request_blur"}(i||(i={}));var S,w=function(e){function t(t,n){var r=e.call(this,t)||this;return r.viewRange=n,r}return(0,a.__extends)(t,e),t}(s.Notification),E=function(e){function t(t,n,o,i,a,s){var c=e.call(this,r.TABLE_ROW_COL_CHANGE)||this;return c.cellGcpBegin=t,c.twips=n,c.edge=o,c.nestingLevel=i,c.diffLeft=a,c.diffRight=s,c}return(0,a.__extends)(t,e),t}(s.Notification),x=function(e){function t(t){var n=e.call(this,r.SEL_TABLE)||this;return n.gcpBegin=t,n}return(0,a.__extends)(t,e),t}(s.Notification),T=function(e){function t(t){var n=e.call(this,r.SELECT_TABLE_ROWCOL)||this;return n.rowOrColGCPRanges=t,n}return(0,a.__extends)(t,e),t}(s.Notification),R=function(e){function t(t,n,o,i){var a=e.call(this,r.INSERT_TABLE_COL)||this;return a.tableGcpBegin=t,a.addTargetGCP=n,a.nestingLevel=o,a.onRight=i,a}return(0,a.__extends)(t,e),t}(s.Notification),I=function(e){function t(t,n,o,i){var a=e.call(this,r.INSERT_TABLE_ROW)||this;return a.tableGcpBegin=t,a.addTargetGCP=n,a.nestingLevel=o,a.onBottom=i,a}return(0,a.__extends)(t,e),t}(s.Notification),P=function(e){function t(t,n,o){var i=e.call(this,r.UPDATE_TABLE_COL_WIDTH)||this;return i.colBeginGcp=t,i.width=n,i.nestingLevel=o,i}return(0,a.__extends)(t,e),t}(s.Notification),O=function(e){function t(t,n,o){var i=e.call(this,r.UPDATE_TABLE_COLS_WIDTH)||this;return i.tableGcpBegin=t,i.colsWidth=n,i.nestingLevel=o,i}return(0,a.__extends)(t,e),t}(s.Notification),k=function(e){function t(t,n,o){var i=e.call(this,r.MOVE_TABLE_ROWS)||this;return i.tableGcpBegin=t,i.moveRange=n,i.targetPos=o,i}return(0,a.__extends)(t,e),t}(s.Notification),D=function(e){function t(t,n){var o=e.call(this,r.DRAGGING_TABLE_ROWS)||this;return o.tableCbkey=t,o.clientY=n,o}return(0,a.__extends)(t,e),t}(s.Notification),M=function(e){function t(t,n,o){var i=e.call(this,r.FINISH_DRAG_TABLE_ROWS)||this;return i.tableCbkey=t,i.clientY=n,i.applyDrag=o,i}return(0,a.__extends)(t,e),t}(s.Notification),A=function(e){function t(t,n,o){var i=e.call(this,r.TABLE_COL_BLUE_LINE_DISPLAY)||this;return i.tableCbkey=t,i.leftPos=n,i.show=o,i}return(0,a.__extends)(t,e),t}(s.Notification),L=function(e){function t(t,n,o){var i=e.call(this,r.MOVE_TABLE_COLS)||this;return i.tableGcpBegin=t,i.moveColsInterval=n,i.targetPoses=o,i}return(0,a.__extends)(t,e),t}(s.Notification),N=function(e){function t(t,n,o){var i=e.call(this,r.SHOW_TABLE_ICON)||this;return i.tableGcpBegin=t,i.show=n,i.isSelected=o,i}return(0,a.__extends)(t,e),t}(s.Notification),B=function(e){function t(){return e.call(this,r.TABLE_DID_AUTO_SCROLL)||this}return(0,a.__extends)(t,e),t}(s.Notification),F=function(e){function t(t){var n=e.call(this,r.TABLE_DID_SCROLL)||this;return n.gcp=t,n}return(0,a.__extends)(t,e),t}(s.Notification),U=function(e){function t(t,n,o,i,a){var s=e.call(this,r.RESIZE_TABLE)||this;return s.resizeColWidthRatio=t,s.resizeRowHeights=n,s.tableGcpBegin=o,s.rowGcpBegin=i,s.nestingLevel=a,s}return(0,a.__extends)(t,e),t}(s.Notification),H=function(e){function t(t,n,o){var i=e.call(this,r.SHOW_TABLE_BUBBLE_REMINDER)||this;return i.left=t,i.top=n,i.width=o,i}return(0,a.__extends)(t,e),t}(s.Notification),j=function(e){function t(){return e.call(this,r.HIDE_TABLE_BUBBLE_REMINDER)||this}return(0,a.__extends)(t,e),t}(s.Notification),G=function(e){function t(){return e.call(this,r.SCROLLABLE_RESIZE)||this}return(0,a.__extends)(t,e),t}(s.Notification),V=function(e){function t(t){var n=e.call(this,r.SEARCH_DIALOG)||this;return n.searchDialogShow=t,n}return(0,a.__extends)(t,e),t}(s.Notification),W=function(e){function t(t){var n=e.call(this,r.CONTEXT_MENU_EVENT)||this;return n.event=t,n}return(0,a.__extends)(t,e),t}(s.Notification),z=function(e){function t(t){var n=e.call(this,r.CONTEXT_MENU_MOBILE_EVENT)||this;return n.viewRange=t,n}return(0,a.__extends)(t,e),t}(s.Notification),K=function(e){function t(){return e.call(this,r.TOGGLE_MOBILE_CONTEXTMENU)||this}return(0,a.__extends)(t,e),t}(s.Notification),q=function(e){function t(t,n,o,i,a){var s=e.call(this,r.HEADERFOOTER_DBCLICK)||this;return s.isHeader=t,s.hdrFtrType=n,s.shouldInsert=o,s.lastRange=i,s.viewRange=a,s}return(0,a.__extends)(t,e),t}(s.Notification),Y=function(e){function t(t){var n=e.call(this,r.UPDATE_KEYBOARD_HEIGHT)||this;return n.keyboardHeight=t,n}return(0,a.__extends)(t,e),t}(s.Notification),Q=function(e){function t(t,n){void 0===n&&(n=!0);var o=e.call(this,r.UPDATE_COVERED_PANEL)||this;return o.showPanel=n,o._coverState=t||o.hiddenState,o}return(0,a.__extends)(t,e),Object.defineProperty(t.prototype,"hiddenState",{get:function(){return{height:-1,withToolbar:!0}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"coverState",{get:function(){return this._coverState},enumerable:!1,configurable:!0}),t}(s.Notification),Z=function(e){function t(){return e.call(this,r.PLUGIN_CONTAINER_WILL_FOCUS)||this}return(0,a.__extends)(t,e),t}(s.Notification);!function(e){e.ZOOM_START="ZOOM_START",e.ZOOM_FINISH="ZOOM_FINISH"}(S||(S={}));var X,J=function(e){function t(t,n,r){var o=e.call(this,t)||this;return o.prev=n,o.next=r,o}return(0,a.__extends)(t,e),t}(s.Notification);!function(e){e.ING="ING",e.END="END"}(X||(X={}));var $,ee,te,ne,re,oe,ie=function(e){function t(t,n){void 0===n&&(n=!0);var r=e.call(this,t)||this;return r.immediately=n,r}return(0,a.__extends)(t,e),t}(s.Notification),ae=function(e){function t(t,n){var o=e.call(this,r.PAGE_TOUCH_EVENT)||this;return o.event=t,o.hitPoint=n,o}return(0,a.__extends)(t,e),t}(s.Notification),se=function(e){function t(t,n){var o=e.call(this,r.PAGE_MOUSE_EVENT)||this;return o.event=t,o.hitPoint=n,o}return(0,a.__extends)(t,e),t}(s.Notification),ce=function(e){function t(){return e.call(this,r.PAGEGAP_DBCLICK)||this}return(0,a.__extends)(t,e),t}(s.Notification),le=function(e){function t(t,n){var o=e.call(this,r.SCROLL_TO_UNRENDER)||this;return o.viewRange=t,o.headerViewHeight=n,o}return(0,a.__extends)(t,e),t}(s.Notification),ue=function(e){function t(){return e.call(this,r.TEXTFRAME_DID_SCROLL)||this}return(0,a.__extends)(t,e),t}(s.Notification),de=function(e){function t(t,n){var o=e.call(this,r.TEXTFRAME_NEED_CHANGE_BACKGROUND)||this;return o.rectSize=t,o.drawingProperty=n,o}return(0,a.__extends)(t,e),t}(s.Notification),pe=function(e){function t(){return e.call(this,r.MAINCONTAINER_DBCLICK)||this}return(0,a.__extends)(t,e),t}(s.Notification);!function(e){e.SWIPE="SINGLE_SWIPE",e.SLIDE="SINGLE_SLIDE",e.LONG_TAP="SINGLE_LONG_TAP",e.LONG_TAP_CANCEL="SINGLE_LONG_TAP_CANCEL"}($||($={})),function(e){e.SLIDE="DOUBLE_SLIDE"}(ee||(ee={})),function(e){e.SLIDE="SLIDE_RENDER"}(te||(te={})),function(e){e.UP="UP",e.DOWN="DOWN",e.LEFT="LEFT",e.RIGHT="RIGHT",e.NONE="NONE"}(ne||(ne={})),function(e){e.DOWN="SLIDE_DOWN",e.UP="SLIDE_UP",e.LEFT="SLIDE_LEFT",e.RIGHT="SLIDE_RIGHT",e.NONE="SLIDE_NONE"}(re||(re={})),function(e){e.START="START",e.MOVE="MOVE",e.END="END"}(oe||(oe={}));var he,fe,ge=function(e){function t(t,n){var r=e.call(this,t)||this;return r.info=n,r}return(0,a.__extends)(t,e),t}(s.Notification),ve=function(e){function t(t,n){var r=e.call(this,t)||this;return r.info=n,r}return(0,a.__extends)(t,e),t}(s.Notification),ye=function(e){function t(){return e.call(this,$.LONG_TAP_CANCEL)||this}return(0,a.__extends)(t,e),t}(s.Notification),me=function(e){function t(t,n){var r=e.call(this,t)||this;return r.info=n,r}return(0,a.__extends)(t,e),t}(s.Notification),be=(function(e){function t(t,n){var r=e.call(this,t)||this;return r.info=n,r}(0,a.__extends)(t,e)}(s.Notification),function(e){function t(t){var n=e.call(this,r.BLOCK_LAYER_FORCE_UPDATE)||this;return n.clear=t,n}return(0,a.__extends)(t,e),t}(s.Notification)),_e=function(e){function t(t){var n=e.call(this,r.ENTER_BLOCK_STATE_FROM_USER)||this;return n.info=t,n}return(0,a.__extends)(t,e),t}(s.Notification),Ce=function(e){function t(){return e.call(this,r.EXIT_BLOCK_STATE_FROM_USER)||this}return(0,a.__extends)(t,e),t}(s.Notification),Se=function(e){function t(t){var n=e.call(this,r.UPDATE_BLOCK_RANGES)||this;return n.info=t,n}return(0,a.__extends)(t,e),t}(s.Notification),we=function(e){function t(t){var n=e.call(this,r.INIT_BLOCK_STATE)||this;return n.selectedRangesMap=t,n}return(0,a.__extends)(t,e),t}(s.Notification);(function(e){function t(){return e.call(this,r.BLOCK_UNDO)||this}(0,a.__extends)(t,e)})(s.Notification),function(e){function t(){return e.call(this,r.BLOCK_REDO)||this}(0,a.__extends)(t,e)}(s.Notification),function(e){e.MOBILE="TextDragType_MOBILE"}(he||(he={})),function(e){function t(t){var n=e.call(this,he.MOBILE)||this;return n.viewRange=t,n}(0,a.__extends)(t,e)}(s.Notification),function(e){e.MOBILE_DRAG="ParagraphDragActionType_MOBILE_DRAG",e.MOBILE_DRAGGING="ParagraphDragActionType_MOBILE_MOBILE_DRAGGING",e.MOBILE_DRAG_CANCELLED="ParagraphDragActionType_MOBILE_DRAG_CANCELLED",e.SWIPE_LOCK="ParagraphDragActionType_SWIPE_LOCK",e.GRAY_PARAGRAPH="ParagraphDragActionType_GRAY_PARAGRAPH",e.ANIMATION="ParagraphDragActionType_ANIMATION"}(fe||(fe={}));var Ee,xe=function(e){function t(t,n){var r=e.call(this,t)||this;return r.type=t,r.payload=n,r}return(0,a.__extends)(t,e),t}(s.Notification);!function(e){e.Delete="delete",e.Highlight="highlight",e.cancelHighlight="cancelHighlight",e.MouseMove="mouseMove"}(Ee||(Ee={}));var Te,Re,Ie=function(e){function t(t,n,r){var o=e.call(this,t)||this;return o.fieldInfo=n,o.callback=r,o}return(0,a.__extends)(t,e),t}(s.Notification),Pe=function(e){function t(){return e.call(this,r.SHOW_EDIT_TIPS)||this}return(0,a.__extends)(t,e),t}(s.Notification),Oe=function(e){function t(t){var n=e.call(this,r.ON_LANDSCAPE_CHANGE)||this;return n.isLandscape=t,n}return(0,a.__extends)(t,e),t}(s.Notification);!function(e){e.UPDATE_COMMENT_STATE="UPDATE_COMMENT_STATE"}(Te||(Te={})),function(e){function t(){return e.call(this,Te.UPDATE_COMMENT_STATE)||this}(0,a.__extends)(t,e)}(s.Notification),function(e){e.HIDDEN="hidden",e.SHOW="show"}(Re||(Re={}));var ke,De=function(e){function t(t){var n=e.call(this,t)||this;return n.type=t,n}return(0,a.__extends)(t,e),t}(s.Notification),Me=function(e){function t(){return e.call(this,r.SELECT_PARAGRAPH)||this}return(0,a.__extends)(t,e),t}(s.Notification),Ae=function(e){function t(){return e.call(this,r.SELECT_WORD)||this}return(0,a.__extends)(t,e),t}(s.Notification);!function(e){e.Canvas="Canvas",e.Lite="Lite"}(ke||(ke={})),function(e){function t(t,n){void 0===n&&(n=!0);var r=e.call(this,t)||this;return r.immediately=n,r}(0,a.__extends)(t,e)}(s.Notification);var Le=n(82487),Ne=function(){function e(e,t){this.start=e,this.end=e.gcp<t.gcp?t:e}return e.prototype.isCaret=function(){return!(!this.start||!this.end)&&this.start.equals(this.end)},e.prototype.getGCPRange=function(){if(this.start&&this.end){var e=this.end.gcp,t=this.start.gcp;return new Le.ICE(t,e-t)}return Le.ICE.emptyRange()},Object.defineProperty(e.prototype,"documentRange",{get:function(){var e=document.createRange(),t=this.start.leafBox.__node__,n=this.end.leafBox.__node__;return t&&n?(t.firstChild&&t.firstChild.nodeType===Node.TEXT_NODE&&(t=t.firstChild),n.firstChild&&n.firstChild.nodeType===Node.TEXT_NODE&&(n=n.firstChild),e.setStart(t,this.start.charsOffset),e.setEnd(n,this.end.charsOffset),e):null},enumerable:!1,configurable:!0}),e.prototype.isValid=function(){return this.start.isValid()&&this.end.isValid()},e.prototype.equals=function(e){return e&&this.start.equals(e.start)&&this.end.equals(e.end)},e}(),Be=function(){function e(e,t,n,r){this._leafBox=e,this.charsOffset=t,this.gcp=n,this.pos=r,this._cacheZoomLevel=0}return e.prototype.getDocumentOffset=function(e){return void 0===e&&(e=1),this._cacheDocumentOffset},e.prototype.getLineDocumentOffset=function(e){return void 0===e&&(e=1),this._cacheLineDocumentOffset},e.prototype.caretHeight=function(e){return void 0===e&&(e=1),0},e.prototype.linePosOffset=function(e,t){void 0===e&&(e=1),void 0===t&&(t=!1)},e.prototype.leafBoxOffset=function(e){void 0===e&&(e=1)},e.prototype.getSurfaceOffset=function(e){var t;void 0===e&&(e=1);var n=null===(t=this.documentBox)||void 0===t?void 0:t.__node__,r=Object.assign({},this.getDocumentOffset(e));return n?(r.x+=n.offsetLeft,r.y+=n.offsetTop,{x:r.x,y:r.y}):{x:r.x,y:r.y}},e.prototype.getWindowOffset=function(e){var t;void 0===e&&(e=1);var n=null===(t=this.documentBox)||void 0===t?void 0:t.__node__,r=Object.assign({},this.getDocumentOffset(e));if(!n)return{x:r.x,y:r.y};r.x*=e,r.y*=e;var o=n.getBoundingClientRect();return r.x+=o.x,r.y+=o.y,{x:r.x,y:r.y}},e.prototype.isValid=function(){var e;return!!(null===(e=this.leafBox)||void 0===e?void 0:e.isValid())},e.prototype.equals=function(e){return this.leafBox===e.leafBox&&this.charsOffset===e.charsOffset},e.prototype.clearCache=function(){this._cacheZoomLevel=0,this._cachedLinePosOffset=void 0,this._cachedParaPosOffset=void 0,this._cacheDocumentOffset=void 0,this._cacheLineDocumentOffset=void 0,this.pos=void 0},e}(),Fe=n(61251),Ue=n(47176),He=n(80491),je={"melo-section":"melo-section",meloSection:"melo-section","melo-page-view":"melo-page-view",meloPageView:"melo-page-view","melo-doc-view":"melo-doc-view",meloDocView:"melo-doc-view","melo-page-upper-anchor-view":"melo-page-upper-anchor-view",meloPageUpperAnchorView:"melo-page-upper-anchor-view","melo-page-lower-anchor-view":"melo-page-lower-anchor-view",meloPageLowerAnchorView:"melo-page-lower-anchor-view","melo-page-container-view":"melo-page-container-view",meloPageContainerView:"melo-page-container-view","melo-page-behind-view":"melo-page-behind-view",meloPageBehindView:"melo-page-behind-view","melo-page-front-view":"melo-page-front-view",meloPageFrontView:"melo-page-front-view","melo-page-canvas-view":"melo-page-canvas-view",meloPageCanvasView:"melo-page-canvas-view","melo-addon-view":"melo-addon-view",meloAddonView:"melo-addon-view","melo-page-gap":"melo-page-gap",meloPageGap:"melo-page-gap","melo-paragraph-task":"melo-paragraph-task",meloParagraphTask:"melo-paragraph-task","melo-paragraph-content":"melo-paragraph-content",meloParagraphContent:"melo-paragraph-content","melo-line":"melo-line",meloLine:"melo-line","melo-line-fragment":"melo-line-fragment",meloLineFragment:"melo-line-fragment","melo-table-wrapper":"melo-table-wrapper",meloTableWrapper:"melo-table-wrapper","melo-table-container":"melo-table-container",meloTableContainer:"melo-table-container","melo-table":"melo-table",meloTable:"melo-table","melo-td":"melo-td",meloTd:"melo-td","melo-selection-overlay":"melo-selection-overlay",meloSelectionOverlay:"melo-selection-overlay","table-row-border-dragger":"table-row-border-dragger",tableRowBorderDragger:"table-row-border-dragger","table-row-border-guide":"table-row-border-guide",tableRowBorderGuide:"table-row-border-guide","table-col-border-dragger":"table-col-border-dragger",tableColBorderDragger:"table-col-border-dragger","table-col-border-guide":"table-col-border-guide",tableColBorderGuide:"table-col-border-guide","table-corner-header":"table-corner-header",tableCornerHeader:"table-corner-header","table-cols-header-wrapper":"table-cols-header-wrapper",tableColsHeaderWrapper:"table-cols-header-wrapper","table-cols-header":"table-cols-header",tableColsHeader:"table-cols-header","table-cols-header-inner":"table-cols-header-inner",tableColsHeaderInner:"table-cols-header-inner","table-single-col-header":"table-single-col-header",tableSingleColHeader:"table-single-col-header","table-rows-header":"table-rows-header",tableRowsHeader:"table-rows-header","table-single-row-header":"table-single-row-header",tableSingleRowHeader:"table-single-row-header","move-text-instruction":"move-text-instruction",moveTextInstruction:"move-text-instruction","drag-cols-preview-container":"drag-cols-preview-container",dragColsPreviewContainer:"drag-cols-preview-container","drag-cols-preview-header":"drag-cols-preview-header",dragColsPreviewHeader:"drag-cols-preview-header","drag-cols-preview-content":"drag-cols-preview-content",dragColsPreviewContent:"drag-cols-preview-content","drag-rows-preview-container":"drag-rows-preview-container",dragRowsPreviewContainer:"drag-rows-preview-container","drag-rows-preview-header":"drag-rows-preview-header",dragRowsPreviewHeader:"drag-rows-preview-header","drag-rows-preview-content":"drag-rows-preview-content",dragRowsPreviewContent:"drag-rows-preview-content","drag-cols-or-rows-mask":"drag-cols-or-rows-mask",dragColsOrRowsMask:"drag-cols-or-rows-mask","drag-row-graph-reminder":"drag-row-graph-reminder",dragRowGraphReminder:"drag-row-graph-reminder","drag-row-circle-reminder":"drag-row-circle-reminder",dragRowCircleReminder:"drag-row-circle-reminder","drag-row-line-reminder":"drag-row-line-reminder",dragRowLineReminder:"drag-row-line-reminder","table-add-icon":"table-add-icon",tableAddIcon:"table-add-icon",animate:"animate","table-move-circle":"table-move-circle",tableMoveCircle:"table-move-circle","table-delete-icon":"table-delete-icon",tableDeleteIcon:"table-delete-icon","table-scale-dragger":"table-scale-dragger",tableScaleDragger:"table-scale-dragger","table-scale-guide":"table-scale-guide",tableScaleGuide:"table-scale-guide","table-scale-dragger-rect":"table-scale-dragger-rect",tableScaleDraggerRect:"table-scale-dragger-rect","scroller-custom-wrapper":"scroller-custom-wrapper",scrollerCustomWrapper:"scroller-custom-wrapper",scroller:"scroller",horizontal:"horizontal",vertical:"vertical","scroller-default-wrapper":"scroller-default-wrapper",scrollerDefaultWrapper:"scroller-default-wrapper","scroller-default-content":"scroller-default-content",scrollerDefaultContent:"scroller-default-content","table-scroller-right-shadow":"table-scroller-right-shadow",tableScrollerRightShadow:"table-scroller-right-shadow","table-scroller-left-shadow":"table-scroller-left-shadow",tableScrollerLeftShadow:"table-scroller-left-shadow","melo-container-placeholder":"melo-container-placeholder",meloContainerPlaceholder:"melo-container-placeholder","melo-container":"melo-container",meloContainer:"melo-container"},Ge=new function(){this.meloSection=je.meloSection,this.meloPageView=je.meloPageView,this.meloDocView=je.meloDocView,this.meloPageUpperAnchorView=je.meloPageUpperAnchorView,this.meloPageFrontView=je.meloPageFrontView,this.meloPageLowerAnchorView=je.meloPageLowerAnchorView,this.meloPageContainerView=je.meloPageContainerView,this.meloPageBehindView=je.meloPageBehindView,this.meloPageCanvasView=je.meloPageCanvasView,this.meloPageGap=je.meloPageGap,this.meloAddonView=je.meloAddonView,this.meloParagraph=je.meloParagraph,this.meloLine=je.meloLine,this.meloLineFragment=je.meloLineFragment,this.meloTableWrapper=je.meloTableWrapper,this.meloTableContainer=je.meloTableContainer,this.meloTable=je.meloTable,this.meloTd=je.meloTd,this.meloSelectionOverlay=je.meloSelectionOverlay,this.tableRowBorderDragger=je.tableRowBorderDragger,this.tableRowBorderGuide=je.tableRowBorderGuide,this.tableColBorderDragger=je.tableColBorderDragger,this.tableColBorderGuide=je.tableColBorderGuide,this.tableHeader=je.tableHeader,this.tableColsHeaderWrapper=je.tableColsHeaderWrapper,this.tableColsHeader=je.tableColsHeader,this.tableColsHeaderInner=je.tableColsHeaderInner,this.tableSingleColHeader=je.tableSingleColHeader,this.tableRowsHeader=je.tableRowsHeader,this.tableSingleRowHeader=je.tableSingleRowHeader,this.tableCornerHeader=je.tableCornerHeader,this.dragColsPreviewContainer=je.dragColsPreviewContainer,this.dragColsPreviewHeader=je.dragColsPreviewHeader,this.dragColsPreviewContent=je.dragColsPreviewContent,this.dragRowsPreviewContainer=je.dragRowsPreviewContainer,this.dragRowsPreviewHeader=je.dragRowsPreviewHeader,this.dragRowsPreviewContent=je.dragRowsPreviewContent,this.dragColsOrRowsMask=je.dragColsOrRowsMask,this.dragRowGraphReminder=je.dragRowGraphReminder,this.dragRowCircleReminder=je.dragRowCircleReminder,this.dragRowLineReminder=je.dragRowLineReminder,this.tableIcon=je.tableIcon,this.tableIconSvg=je.tableIconSvg,this.tableAddIcon=je.tableAddIcon,this.tableMoveCircle=je.tableMoveCircle,this.tableDeleteIcon=je.tableDeleteIcon,this.tableScaleDragger=je.tableScaleDragger,this.tableScaleGuide=je.tableScaleGuide,this.tableScaleDraggerRect=je.tableScaleDraggerRect,this.scrollerCustomWrapper=je.scrollerCustomWrapper,this.scrollerDefaultWrapper=je.scrollerDefaultWrapper,this.scrollerDefaultContent=je.scrollerDefaultContent,this.scroller=je.scroller,this.tableScrollerLeftShadow=je.tableScrollerLeftShadow,this.tableScrollerRightShadow=je.tableScrollerRightShadow,this.horizontal=je.horizontal,this.vertical=je.vertical,this.meloParagraphContent=je.meloParagraphContent,this.meloContainer=je.meloContainer,this.meloContainerPlaceholder=je.meloContainerPlaceholder},Ve=n(46708),We=function(){function e(e,t,n,r,o,i){this.renderType=e,this.state=t,this.layoutController=n,this.containerFocus=r,this.callbacks=o,this.renderState=i}return e.prototype.findViewPoint=function(e,t,n,r,o){throw new Error("Method not implemented.")},e.prototype.findHitViewPoint=function(e,t,n,r,o,i){throw new Error("Method not implemented.")},e.prototype.findViewPointForLineEnd=function(e,t,n){throw new Error("Method not implemented.")},e.prototype.getDataStream=function(){return this.state.getDataStream()},e.prototype.getSelection=function(){return this.state.selection},e.prototype.isCanvasRender=function(){return this.renderType===Le.y2q.Canvas},e.prototype.isLiteRender=function(){return this.renderType===Le.y2q.Lite},e.prototype.findHitParagraphBox=function(e){throw new Error("Method not implemented")},e}(),ze=0;function Ke(e,t,n,r){var o=n.__node__.getBoundingClientRect(),i=parseFloat(n.__node__.style.lineHeight),a=!0;n.property&&(a=n.property.spacing.lineRule===Le.NRl.auto||n.property.spacing.lineRule===Le.NRl.atLeast);var s,c,l,u=e.getBoundingClientRect(),d=(s=e,c=t,(0,Fe.k4)(s.__vm__)&&((l=Ve.$w.getPointRangeRect(s.firstChild,c)).x||l.y||l.width||l.height)||(l=s.getBoundingClientRect(),c>0&&(l=Ve.$w.createDOMRect(l.right,l.y,0,l.height))),l),p=d.top,h=d.bottom,f=parseFloat(e.style.fontSize)||0,g=f?d.height:0,v=!0,y=!0;function m(e,t){if((0,Fe.k4)(e.__vm__)){var n=e.getClientRects();return t?n[0].left:n[n.length-1].right}var r=e.getClientRects().item(0);return t?r.left:r.right}function b(e,t){if(e.className.indexOf("melo-leaf")<0)t.top<p&&(p=t.top),t.bottom>h&&(h=t.bottom);else{t.top<p&&(p=t.top),t.bottom>h&&(h=t.bottom),t.height>g&&(g=t.height);var n=parseFloat(e.style.fontSize)||0;n>f&&(f=n)}}if(u.top===d.top&&function(){for(var t=m(e,!0),n=e.previousSibling;n&&n.getClientRects&&t>o.left&&!(n.className.indexOf("list-marker")>=0);){var r=n.getClientRects(),i=r.item(r.length-1);if(!(Math.abs(i.right-t)<.1))break;if(t=i.left,v=!1,b(n,i),r.length>1)break;n=n.previousSibling}}(),Math.abs(u.bottom-d.bottom)<.001&&function(){for(var t=m(e,!1),n=e.nextSibling;n&&n.getClientRects&&t<o.right;){var r=n.getClientRects(),i=r.item(0);if(!(Math.abs(i.left-t)<.1))break;if(t=i.right,y=!1,b(n,i),r.length>1)break;n=n.nextSibling}}(),!a||f){var _=f*function(){if(ze)return ze;var e=document.createElement("div");return e.style.height="1pt",e.style.width="1pt",e.style.top="-100%",e.style.left="-100%",e.style.position="absolute",document.body.appendChild(e),ze=e.getBoundingClientRect().height,document.body.removeChild(e),ze||4/3}()*r,C=((a?_*i:i)-g)/2;return{top:Math.min(h-g-C,p),bottom:h+C,left:d.left,isLeftEdge:v,isRightEdge:y}}return{top:p,bottom:h,left:d.left,isLeftEdge:v,isRightEdge:y}}var qe,Ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.findViewPoint=function(e,t,n,r,o){var i=this.getHTMLRange(e,t,n);if(!i)return null;var a=this.getSearchResult(i);if(!a||!a.node)return null;if(a.node.className.includes("card-wrapper")){var s=a.node.parentElement.parentElement.nextSibling;a.node=s}else if(!a.node.__vm__){var c=Array.from(a.node.children).find((function(e){return"melo-leaf"===e.className}));if(!c)return null;a.node=c}var l=a.node.__vm__,u=((0,Fe.Hg)(l.parentBox)?l.parentBox:l).getRange(),d=a.offsetUString,p=u.begin()+a.offsetUString,h=this.callbacks.domPosToBoxPos(a.offsetPx);return!o&&(0,Fe.k4)(l)&&(0,Le.jUV)(l.text.charCodeAt(0))&&(d=0,p=u.begin(),h=0),new Qe(l,d,p,h)},t.prototype.getHTMLRange=function(e,t,n){var r,o=document.elementFromPoint(e,t),i=this.getContainerBoxDom(o);if(i)return(r=document.createRange()).setStart(i,1),r;if(s.PlatformUtil.isSafari()&&!s.PlatformUtil.isChrome())r=this.findSafariCaretRange(n,e,t);else if((r=Ve.$w.getMouseEventCaretRange(e,t))&&!Ve.$w.isTextNode(r.startContainer)&&!(0,Fe.k4)(r.startContainer.__vm__)&&r.startContainer instanceof Element)return this.getNonTextRange(r.startContainer,e);return r},t.prototype.getSearchResult=function(e){var t=e.startContainer.__vm__;return Ve.$w.isTextNode(e.startContainer)&&e.startContainer.parentElement?{node:e.startContainer.parentElement,offset:e.startOffset,offsetUString:e.startOffset,offsetPx:0}:(0,Fe.k4)(t)||(0,Fe.e_)(t)||(0,Fe.dc)(t)?{node:e.startContainer,offset:e.startOffset,offsetUString:e.startOffset,offsetPx:0}:(0,Fe.Hg)(t)?{node:e.startContainer.nextSibling,offset:e.startOffset,offsetUString:e.startOffset,offsetPx:0}:void 0},t.prototype.getNonTextRange=function(e,t){var n=e.getBoundingClientRect(),r=t>(n.left+n.right)/2?e.nextSibling:e;if(r){var o=document.createRange();return o.setStart(r,0),o.setEnd(r,0),o}},t.prototype.findSafariCaretRange=function(e,t,n){var r=this.findBoxFromElement(e,t,n);if(r){var o=r.__node__;return(0,Fe.k4)(r)?Ve.$w.getCaretRangeSafari(o,t,n):(0,Fe.e_)(r)||(0,Fe.Hg)(r)?this.getNonTextRange(o,t):(0,Fe.dc)(r)?this.findCaretRangeInPara(r,o,t,n):(0,Fe.Le)(r)||(0,Fe.E0)(r)||(0,Fe.UO)(r)?this.findCaretRangeInDocument(o,t,n):void 0}},t.prototype.findBoxFromElement=function(e,t,n){var r,o,i=(null==e?void 0:e.__vm__)||(null===(r=null==e?void 0:e.parentElement)||void 0===r?void 0:r.__vm__);if(!(0,Fe.Av)(i)&&!(0,Fe.Hg)(i)&&!(0,Fe.dc)(i)){var a=document.elementFromPoint(t,n),s=(null==a?void 0:a.__vm__)||(null===(o=null==a?void 0:a.parentElement)||void 0===o?void 0:o.__vm__);s&&(i=s)}return i},t.prototype.findCaretRangeInPara=function(e,t,n,r){var o,i,a,c,l=t.getBoundingClientRect(),u=1/this.callbacks.domPosToBoxPos(1),d=this.getNonTextRange;function p(e,t,n,r,s){if(s>=t.top&&s<=t.bottom){var c=t.isLeftEdge?l.left:n.left,u=t.isRightEdge?l.right:n.right;return r>=c&&r<=u?(i=(n.top+n.bottom)/2,o=r,r<n.left&&(o=n.left+1),r>n.right&&(o=n.right-1),a=e,0):r<c?-1:1}return s<t.top?-1:1}function h(t,n,r,s){if(!n)return 0;var l=n.getClientRects(),h=Ke(n,0,e,u),f=p(n,h,l.item(0),r,s);if(0!==f||(0,Fe.k4)(t)||(c=d(n,r)),1===l.length||1!==f)return f;var g=Ke(n,n.firstChild.length,e,u);if(-1!==(f=p(n,g,l.item(l.length-1),r,s)))return f;if(l.length>2&&s>=h.bottom&&s<=g.top&&function(e,t,n,r){for(var s=Number.POSITIVE_INFINITY,c=0,l=1;l<e.length-1;l++){var u=e[l],d=Math.abs((u.top+u.bottom)/2-r);if(d>s)break;s=d,c=l}if(c>0&&s!==Number.POSITIVE_INFINITY){var p=e[c];return i=(p.top+p.bottom)/2,o=n,n<p.left&&(o=p.left+1),n>p.right&&(o=p.right-1),a=t,!0}return!1}(l,n,r,s))return 0;throw new Error}var f=r;if(e.property){var g=(0,s.twipsToPx)(e.property.spacing.before),v=(0,s.twipsToPx)(e.property.spacing.after);r<l.top+g&&(f=l.top+g+1),r>l.bottom-v&&(f=l.bottom-v-1)}try{return function t(n,r,s,l){var u,d;if(l-s>0){var p=Math.floor((s+l)/2),f=h(e.children[p],e.children[p].__node__,n,r);if(-1===f)return t(n,r,s,p-1);if(1===f)return t(n,r,p+1,l)}if(a||c||h(e.children[s],e.children[s].__node__,n,r),c)return c;if(a)return Ve.$w.getCaretRangeSafari(a,o,i);var g=document.createRange();return(null===(d=null===(u=e.children)||void 0===u?void 0:u[e.children.length-1])||void 0===d?void 0:d.__node__)?g.setStart(e.children[e.children.length-1].__node__,0):g.setStart(e.__node__,0),g}(n,f,0,e.children.length-1)}catch(e){return console.error(e),null}},t.prototype.contentElementFromPoint=function(e,t){var n=document.elementFromPoint(e,t),r=document.querySelector(".mobile-selection-drag");if(!(r instanceof HTMLElement&&n instanceof Node))return n;if(r.contains(n)){var o=r.style.pointerEvents;r.style.pointerEvents="none",n=document.elementFromPoint(e,t),r.style.pointerEvents=o}return n},t.prototype.getBoxFromTagert=function(e){var t,n,r;if(!e)return null;if(this.shoudFallBackToRootBox(e))return this.layoutController.getLayoutBox();if("IMG"===e.nodeName)return null===(n=null===(t=null==e?void 0:e.parentElement)||void 0===t?void 0:t.parentElement)||void 0===n?void 0:n.__vm__;var o=(null==e?void 0:e.__vm__)||(null===(r=null==e?void 0:e.parentElement)||void 0===r?void 0:r.__vm__);if(o)return o;for(var i=e.parentElement;i&&!i.__vm__;)i=i.parentElement;return i?i.__vm__:this.layoutController.getLayoutBox()},t.prototype.shoudFallBackToRootBox=function(e){var t,n;if("string"!=typeof e.className)return!1;switch(!0){case null===(n=null===(t=e.parentElement)||void 0===t?void 0:t.parentElement)||void 0===n?void 0:n.className.includes("tdocs-doc-link-card-wedoc-wrapper-preview"):case e.className.includes("wedrive"):return!0}return!1},t.prototype.findCaretRangeInDocument=function(e,t,n){var r,o=e.getBoundingClientRect(),i=(o.left+o.right)/2,s=n,c=!1,l=this.contentElementFromPoint(i,n);l||(l=this.contentElementFromPoint(t,n));var u=this.getBoxFromTagert(l);if(u&&this.isBoxInTableCell(u)){l=this.contentElementFromPoint(t,n);var d=this.getBoxFromTagert(l);if(h=d.children){u=(0,a.__read)(h,1)[0];for(var p=0;p<h.length;p++)(y=(v=h[p]).__node__)&&((m=y.getBoundingClientRect()).top>n||m.bottom<n||(u=v))}else u=d.parentBox}if(u&&((0,Fe.E0)(u)||(0,Fe.Le)(u))&&u.children.length>0){var h=void 0,f=(h=(0,Fe.E0)(u)?u.children[u.children.length-1].children:u.children)[h.length-1],g=null===(r=f.__node__)||void 0===r?void 0:r.getBoundingClientRect();if(n>(null==g?void 0:g.bottom))u=f,s=g.bottom-1,i=g.right,c=!0;else for(p=0;p<h.length;p++){var v,y=(v=h[p]).__node__;if(!v.hidden&&!(0,Fe.hE)(u)&&y){var m=y.getBoundingClientRect();if(0===p&&m.bottom>n){u=v;break}if(!(m.top>n||m.bottom<n)){u=v;break}var b=v.nextSibling,_=v.prevSibling;if(_&&(0,Fe.hE)(_)&&n>=m.top-8){u=v;break}if(b&&(0,Fe.hE)(b)&&n<=m.bottom+12){u=v;break}}}}for(;u&&!(0,Fe.dc)(u);)u=u.parentBox;if(u&&u.__node__)return c||(i=t),t<(o=(l=u.__node__).getBoundingClientRect()).left&&(i=o.left),t>o.right&&(i=o.right),this.findCaretRangeInPara(u,l,i,s)},t.prototype.isBoxInTableCell=function(e){for(var t=e;t&&!(0,Fe.UO)(t);)t=t.parentBox;return!(!t||!(0,Fe.UO)(t))},t.prototype.getContainerBoxDom=function(e){for(var t=e;t&&!(0,Fe.e_)(t.__vm__);)t=t.parentElement;return t},t}(We),Qe=function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;return i._lineHeight=0,i._paraOffsetTop=0,i}return(0,a.__extends)(t,e),Object.defineProperty(t.prototype,"leafBox",{get:function(){return this._leafBox},enumerable:!1,configurable:!0}),t.prototype.getDocumentOffset=function(e){var t,n;if(void 0===e&&(e=1),this._cacheZoomLevel===e&&this._cacheDocumentOffset)return this._cacheDocumentOffset;this._cacheZoomLevel=e;var r=0,o=0,i=this.documentBox,a=null==i?void 0:i.__node__,c=this.getLeafDom();if(!a||!c)return s.Logger.error("find ".concat(Ge.meloDocView," or leafDom failed")),{x:0,y:0,docWidth:0,docHeight:0};var l=a.getBoundingClientRect();if((0,Fe.k4)(this.leafBox)&&!(0,Fe.Hg)(this.leafBox.parentBox))r=((u=Ve.$w.getPointRangeRect(c.firstChild,this.charsOffset)).right-l.left)/e,o=(u.top-l.top)/e;else{var u=c.getBoundingClientRect(),d=(0,Fe.e_)(this.leafBox)?u.height-this.caretHeight(e):0,p=0;if((0,Fe.Hg)(this.leafBox.parentBox)){var h=this.leafBox.parentBox;if((null===(t=h.fieldInfo)||void 0===t?void 0:t.layoutType)===Le.Zjt.Text){var f=this.getTextFieldRelyInfo(h);f&&(o=((u=Ve.$w.getPointRangeRect(f.element.firstChild,f.charsOffset)).top-l.top)/e)}else{this.leafBox===h.lastChild&&(p=u.width);var g=null===(n=h.content)||void 0===n?void 0:n.__node__;g&&(d+=g.getBoundingClientRect().top-u.top),o=(u.y+d-l.top)/e}}else o=(u.y+d-l.top)/e;r=(u.x+p-l.left)/e}return this._cacheDocumentOffset={x:r,y:o,docWidth:a.offsetWidth,docHeight:a.offsetHeight},this._cacheDocumentOffset},t.prototype.getLeafDom=function(e){var t;if(void 0===e&&(e=!1),(0,Fe.rM)(this.leafBox))return null===(t=this.leafBox.content)||void 0===t?void 0:t.__node__;var n=this.leafBox.__node__;return(0,Fe.Hg)(this.leafBox.parentBox)&&!e&&(n=this.leafBox.parentBox.__node__),n},t.prototype.getLineDocumentOffset=function(e){void 0===e&&(e=1);var t=this.paraBox;if(!((0,Fe.dc)(t)&&t.__node__&&this.documentBox&&this.documentBox.__node__&&this.getLeafDom()))return this.getDocumentOffset(e);if(this._cacheZoomLevel===e&&this._cacheLineDocumentOffset)return this._cacheLineDocumentOffset;this._cacheZoomLevel=e;var n=0,r=0,o=this.documentBox.__node__,i=t.__node__.getBoundingClientRect(),a=o.getBoundingClientRect();n=(i.left-a.left)/e,r=(i.top-a.top)/e;var s=this.paraPosOffset(e);return s&&(n+=s.x,r+=s.y),this._cacheLineDocumentOffset={x:n,y:r,docWidth:o.offsetWidth,docHeight:o.offsetHeight},this._cacheLineDocumentOffset},t.prototype.paraPosOffset=function(e){if(void 0===e&&(e=1),this._cacheZoomLevel===e&&this._cachedParaPosOffset)return this._cachedParaPosOffset;this._cacheZoomLevel=e;var t=this.paraBox,n=null==t?void 0:t.__node__,r=this.getLeafDom();if(r&&n){var o=n.getBoundingClientRect(),i=0,a=0;t.property&&(i=(0,s.twipsToPx)(t.property.spacing.before),a=(0,s.twipsToPx)(t.property.spacing.after));try{var c=Ke(r,this.charsOffset,t,e);this._lineHeight=(c.bottom-c.top)/e,this._paraOffsetTop=(c.top-o.top)/e,Math.abs(this._paraOffsetTop-i)<1&&(this._lineHeight+=this._paraOffsetTop-i,this._paraOffsetTop=i),Math.abs(this._paraOffsetTop+this._lineHeight+a-o.height)<1&&(this._lineHeight=o.height-a-this._paraOffsetTop),this._cachedParaPosOffset={x:(c.left-o.left)/e,y:this._paraOffsetTop}}catch(e){this._cachedParaPosOffset=void 0}}else this._cachedParaPosOffset=void 0;return this._cachedParaPosOffset},t.prototype.leafBoxOffset=function(){return this.pos||void 0},t.prototype.caretHeight=function(e){var t,n;void 0===e&&(e=1);var r=(0,s.twipsToPx)(330);if((0,Fe.e_)(this.leafBox))return r;var o=this.getLeafDom(),i=this.leafBox.parentBox;if((0,Fe.Hg)(i)&&(null===(t=i.fieldInfo)||void 0===t?void 0:t.layoutType)===Le.Zjt.Text){var a=this.getTextFieldRelyInfo(i);return Ve.$w.getPointRangeRect(null==a?void 0:a.element.firstChild,this.charsOffset).height/e}if((0,Fe.Hg)(this.leafBox.parentBox)){var c=this.leafBox.parentBox,l=(null===(n=c.content)||void 0===n?void 0:n.__node__)||c.__node__;return l?l.getBoundingClientRect().height:r}if(o)try{return Ve.$w.getPointRangeRect(o.firstChild,this.charsOffset).height/e}catch(e){var u=o.firstChild.textContent,d=this.leafBox.text,p=new Error("".concat(e.message,", ").concat(this.gcp,":").concat(this.leafBox.kind,":").concat(this.charsOffset,", ").concat(null==d?void 0:d.length,":").concat(null==u?void 0:u.length,", ").concat(d,":").concat(u));Ve.kQ.captureException(Ve.GI.ACTIVE_REPORT_ERROR,{},p)}return r},Object.defineProperty(t.prototype,"documentBox",{get:function(){for(var e=this.leafBox.parentBox;e&&!(0,Fe.E0)(e);)e=e.parentBox;return e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"paraBox",{get:function(){var e=this.leafBox.parentBox;return e&&(0,Fe.Hg)(e)&&(e=e.parentBox),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineBox",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineHeight",{get:function(){return this._lineHeight||this.caretHeight()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"paraOffsetTop",{get:function(){return this._paraOffsetTop},enumerable:!1,configurable:!0}),t.prototype.linePosOffset=function(e){var t;if(void 0===e&&(e=1),this._cacheZoomLevel===e&&this._cachedLinePosOffset)return this._cachedLinePosOffset;this._cacheZoomLevel=e;var n=this.getLeafDom(),r=null===(t=this.paraBox)||void 0===t?void 0:t.__node__;if(n&&r){var o,i=0,a=r.getBoundingClientRect();(0,Fe.k4)(this.leafBox)&&!(0,Fe.Hg)(this.leafBox.parentBox)?i=(o=Ve.$w.getPointRangeRect(n.firstChild,this.charsOffset)).right:(i=(o=n.getBoundingClientRect()).left,(0,Fe.Hg)(this.leafBox.parentBox)&&this.leafBox===this.leafBox.parentBox.lastChild&&(i+=o.width)),this._cachedLinePosOffset=(i-a.left)/e}else this._cachedLinePosOffset=void 0;return this._cachedLinePosOffset},t.prototype.clone=function(){return new t(this.leafBox,this.charsOffset,this.gcp,this.pos)},t.prototype.getTextFieldRelyInfo=function(e){if(e.nextSibling)return!e.isBegin&&(0,Fe.Hg)(e.nextSibling)&&(0,Fe.k4)(e.prevSibling)?{charsOffset:e.prevSibling.text.length,element:e.prevSibling.__node__}:{charsOffset:0,element:e.nextSibling.__node__}},t.prototype.getLeafRect=function(e){var t=e.firstChild,n=this.charsOffset,r=n-1;this.charsOffset>0&&Ve.$w.isZeroWidthNobreakSpace(Ve.$w.getStringFromTextNodeByIndex(t,r))&&(n=Ve.$w.seekNextMeasureableChar(t,r).len);var o=document.createRange();o.setStart(t,0),o.setEnd(t,0);var i=o.getBoundingClientRect(),a=He.dp.getDefaultEngine(),c=new(Le.kkf.getPropertyClass(Le.uSS.RunProperty));c.b="bold"===e.style.fontWeight,c.sz=(0,s.ptToTwips)(parseInt(e.style.fontSize,10)),c.spacing=(0,s.ptToTwips)(parseInt(e.style.letterSpacing,10)),c.fontFamily=e.style.fontFamily;var l=a.measureAttributedText(t.substringData(0,n),c),u=l.width,d=l.height;return Ve.$w.createDOMRect(i.left,i.top,(0,s.twipsToPx)(u),(0,s.twipsToPx)(d))},t}(Be),Ze={prev:{siblingOf:function(e){var t;return null!==(t=e.prevSibling)&&void 0!==t?t:null},childOf:function(e){var t;return null!==(t=e.lastChild)&&void 0!==t?t:null}},next:{siblingOf:function(e){var t;return null!==(t=e.nextSibling)&&void 0!==t?t:null},childOf:function(e){var t;return null!==(t=e.firstChild)&&void 0!==t?t:null}}},Xe=function(){function e(){}return e.prototype.findLeaf=function(e,t,n,r){var o=e;for(this.dir=t?Ze.prev:Ze.next,this.stopper=r;!this.shouldStop(o);)if(!(o=this.getNeighborLeafBox(o))||n(o))return o;return null},e.prototype.walkLeaf=function(e,t){this.dir=Ze.next,this.stopper=void 0;for(var n=this.getLeafBox(e);n;){if(!t(n))return!1;n=this.getNeighborLeafBox(n)}return!0},e.prototype.findParent=function(e,t){for(var n="function"==typeof t?t:function(e){return(0,Fe.$o)(e)===t},r=e.parentBox;r&&!n(r);)r=r.parentBox;return null!=r?r:null},e.prototype.getNeighborLeafBox=function(e){var t,n=e;for(this.anchor=e;!this.shouldStop(n);){var r=this.dir.siblingOf(n);if(r)return this.getLeafBox(r);n=null!==(t=n.parentBox)&&void 0!==t?t:null}return null},e.prototype.getLeafBox=function(e){if(this.shouldStop(e))return null;if((0,Fe.Dy)(e))return e;var t=this.dir.childOf(e);return t?this.getLeafBox(t):this.getNeighborLeafBox(e)},e.prototype.shouldStop=function(e){return!e||e!==this.anchor&&!!this.stopper&&this.stopper(e)},e}();!function(e){e.BEFORE_BOX="beforeBox",e.INSIDE_BOX="insideBox",e.AFTER_BOX="afterBox"}(qe||(qe={}));var Je=function(){function e(){var e=this;this.navigator=new Xe,this.predicate=function(t){return!(0,Fe.tq)(t.parentBox)&&e.isFollowable(t)},this.stopper=function(t){return e.inLine?(0,Fe.o7)(t):e.inField?(0,Fe.Pq)(t):(0,Fe.wS)(t)}}return e.prototype.follow=function(e,t){return void 0===t&&(t=!0),this.point=e,this.inLine=t,this.caretLoc=this.detectCaretLocation(),this.caretLoc===qe.INSIDE_BOX?this.point:this.findPoint()},e.prototype.detectCaretLocation=function(){if(0===this.point.charsOffset)return qe.BEFORE_BOX;if(this.point.leafBox.constructor!==Ue.zC&&this.point.charsOffset>0)return qe.AFTER_BOX;var e=this.point.leafBox.parentBox;return e&&(0,Fe.tq)(e)?qe.AFTER_BOX:qe.INSIDE_BOX},e.prototype.findPoint=function(){this.inField=this.detectInField();var e=this.findBox();if(!e)return this.point;var t=e.text.length,n=this.point,r=n.gcp,o=n.renderState;return new ct(e,t,r,0,o)},e.prototype.findBox=function(){switch(this.caretLoc){case qe.BEFORE_BOX:return this.findPrevBox()||this.useCurrBox()||this.findNextBox();case qe.AFTER_BOX:return this.useCurrBox()||this.findPrevBox()||this.findNextBox()}return null},e.prototype.findPrevBox=function(){return this.navigator.findLeaf(this.point.leafBox,!0,this.predicate,this.stopper)},e.prototype.findNextBox=function(){return this.navigator.findLeaf(this.point.leafBox,!1,this.predicate,this.stopper)},e.prototype.useCurrBox=function(){return this.predicate(this.point.leafBox)?this.point.leafBox:null},e.prototype.isFollowable=function(e){if(!(0,Fe.NF)(e))return!1;if(1!==e.text.length)return e.text.length>1;var t=e.text.charCodeAt(0);return this.isFollowablePlaceholder(t)||!this.isPlaceholder(t)},e.prototype.isFollowablePlaceholder=function(e){return(0,Le.gw8)(e)||(0,Le.LCi)(e)},e.prototype.isPlaceholder=function(e){return Object.values(Le.ghV).includes(e)},e.prototype.detectInField=function(){var e=this.point.leafBox;return!!this.navigator.findLeaf(e,!0,Fe.yv,(function(e){return(0,Fe.wS)(e)||(0,Fe._g)(e)}))},e}(),$e=function(){function e(){}return e.prototype.follow=function(e){if(0!==e.charsOffset)return e;var t,n=e.leafBox;if((0,Fe.dc)(n.parentBox)){if(t=n.prevSibling,(0,Fe.w5)(t))return e}else n.parentBox&&n.parentBox.prevSibling&&(t=n.parentBox.prevSibling);if(t&&!(0,Fe.Av)(t)&&(t=t.lastChild),t&&(0,Fe.k4)(t)){var r=t.text.length;return new Qe(t,r,e.gcp,0)}return e},e}(),et=function(e){return e},tt=function(e){return{left:0,top:0}},nt=function(e){return!1};function rt(e){return function(t){return function(e,t){var n;if((0,Fe.YP)(e)){var r=t.getScrollerInfo("table-".concat(e.tableId));return(0,a.__assign)({left:0,top:0},r)}return(0,Fe.tJ)(e)?(r=t.getScrollerInfo("textframe-".concat(null===(n=e.property)||void 0===n?void 0:n.drawing.graphic.graphicData.wsp.txbx.contentId)),(0,a.__assign)({left:0,top:0},r)):{left:0,top:0}}(t,e)}}function ot(e){return!!((0,Fe.YP)(e)&&e.isRootNesting||(0,Fe.tJ)(e))}function it(e,t){if(t){for(var n=e;n&&!ot(n);)n=n.parentBox;if(null!==n)return rt(t)(n)}return{left:0,top:0}}function at(e,t){return void 0===t&&(t=!0),e instanceof ct?(new Je).follow(e,t):(new $e).follow(e)}function st(e,t,n,r,o){return(0,Fe.Av)(e)?new Qe(e,t,n,r):new ct(e,t,n,r,o)}var ct=function(e){function t(t,n,r,o,i){var a=e.call(this,t,n,r,o)||this;return a.renderState=i,a}return(0,a.__extends)(t,e),Object.defineProperty(t.prototype,"leafBox",{get:function(){return this._leafBox},enumerable:!1,configurable:!0}),t.prototype.getDocumentOffset=function(e){if(void 0===e&&(e=1),this._cacheZoomLevel===e&&this._cacheDocumentOffset)return this._cacheDocumentOffset;this._cacheZoomLevel=e;var t=0,n=0,r=this.documentBox,o=null==r?void 0:r.__node__;if(!o)return s.Logger.error("find ".concat(Ge.meloDocView," failed")),{x:0,y:0,docWidth:0,docHeight:0};if(this.leafBox instanceof Ue.oH)t=this.getFieldOffset().posX,n=this.getFieldOffset().posY;else{var i=(0,Fe.tq)(this.leafBox.parentBox)?this.leafBox.parentBox:this.leafBox,a=this.getDocumentOffsetConsiderAnchor(i),c=a.x,l=a.y;t=(0,s.twipsToPx)(c),n=(0,s.twipsToPx)(l)}var u=it(this.leafBox,this.renderState);t-=u.left,n-=u.top;var d=this.leafBoxOffset();return void 0!==d&&(t+=d),this._cacheDocumentOffset={x:t,y:n,docWidth:o.offsetWidth/e,docHeight:o.offsetHeight/e},this._cacheDocumentOffset},t.prototype.getFieldOffset=function(){if((0,Fe.tq)(this.leafBox.parentBox)){var e=(0,Fe.tq)(this.leafBox.parentBox)?this.leafBox.parentBox:this.leafBox,t=this.getDocumentOffsetConsiderAnchor(e),n=t.x,r=t.y;return{posX:(0,s.twipsToPx)(n),posY:(0,s.twipsToPx)(r)}}if(this.leafBox.charType===Le.P1W.begin){var o=this.getDocumentOffsetConsiderAnchor(this.leafBox.nextSibling);return n=o.x,r=o.y,{posX:(0,s.twipsToPx)(n),posY:(0,s.twipsToPx)(r)}}return this.leafBox.charType===Le.P1W.end?(n=this.getDocumentOffsetConsiderAnchor(this.leafBox).x,r=this.getDocumentOffsetConsiderAnchor(this.leafBox.prevSibling).y,{posX:(0,s.twipsToPx)(n),posY:(0,s.twipsToPx)(r)}):{posX:0,posY:0}},t.prototype.getLeafDomForLineBase=function(){return(0,Fe.tq)(this.leafBox.parentBox)||this.leafBox.__node__?(0,Fe.tq)(this.leafBox.parentBox)?this.leafBox.parentBox.__node__:this.leafBox.__node__:this.leafBox.__node__?this.leafBox.__node__:void 0},t.prototype.getLineDocumentOffset=function(e){void 0===e&&(e=1);var t=this.lineBox;if(!(0,Fe.o7)(t))return this.getDocumentOffset(e);if(this._cacheZoomLevel===e&&this._cacheLineDocumentOffset)return this._cacheLineDocumentOffset;this._cacheZoomLevel=e;var n=0,r=0,o=this.documentBox,i=null==o?void 0:o.__node__;if(!i)return s.Logger.error("find ".concat(Ge.meloDocView," failed")),{x:0,y:0,docWidth:0,docHeight:0};var a=t.__node__;if((0,Fe.o7)(t)&&a){var c=i.getBoundingClientRect(),l=a.getBoundingClientRect();n=(l.left-c.left)/e,r=(l.top-c.top)/e}else{var u=this.getDocumentOffsetConsiderAnchor(t),d=u.x,p=u.y;n=(0,s.twipsToPx)(d),r=(0,s.twipsToPx)(p);var h=it(this.leafBox,this.renderState);n-=h.left,r-=h.top}var f=this.linePosOffset();return void 0!==f&&(n+=(0,s.twipsToPx)(f)),this._cacheLineDocumentOffset={x:n,y:r,docWidth:i.offsetWidth,docHeight:i.offsetHeight},this._cacheLineDocumentOffset},t.prototype.leafBoxOffset=function(e,t){var n;if(void 0===e&&(e=1),void 0===t&&(t=!1),!this.pos){var r=this.leafBox.parentBox;if(r&&(0,Fe.tq)(r)&&!t&&(this.leafBox===r.lastChild||this.leafBox===r.lastVisibleChild)&&this.charsOffset>0)this.pos=(0,s.twipsToPx)(r.borderBoxSize.width);else if(r&&(0,Fe.tq)(r)&&this.leafBox===r.firstChild)this.pos=0;else if((0,Fe.Oi)(this.leafBox)&&0!==this.charsOffset)this.pos=(0,s.twipsToPx)(Le.keb.containerMargin.left+(null===(n=this.leafBox)||void 0===n?void 0:n.borderBoxSize.width)||0+Le.keb.containerMargin.right);else if(0===this.charsOffset)this.pos=0;else if(this.endOfBox())this.pos=(0,s.twipsToPx)(this.leafBox.borderBoxSize.width);else if((0,Fe.yR)(this.leafBox))this.pos=0===this.charsOffset?0:this.leafBox.totalWidth;else if((0,Fe.NF)(this.leafBox)){var o=He.dp.getDefaultEngine().measureChar(this.leafBox.text,this.leafBox.textStyle,0,this.charsOffset).width;this.pos=(0,s.twipsToPx)(o)}else(0,Fe.eJ)(this.leafBox)||(0,Fe.tq)(this.leafBox)?this.pos=(0,s.twipsToPx)(this.leafBox.borderBoxSize.width):s.Logger.warn("view range cannot find leaf node")}return this.pos},t.prototype.endOfBox=function(){return(0,Fe.NF)(this.leafBox)&&this.charsOffset===this.leafBox.text.length||!(0,Fe.NF)(this.leafBox)&&1===this.charsOffset},t.prototype.caretHeight=function(){var e,t,n=(0,s.twipsToPx)(330);if(this.leafBox&&(0,Fe.Oi)(this.leafBox)&&!this.leafBox.prevSibling){var r=null===(e=this.leafBox.parentBox)||void 0===e?void 0:e.prevSibling;if((0,Fe.o7)(r)&&!(r.lastChild instanceof Ue.w8))return 0}if(this.leafBox instanceof Ue.oH&&!(0,Fe.tq)(this.leafBox.parentBox)){if(this.leafBox.charType===Le.P1W.begin&&this.leafBox.nextSibling instanceof Ue.zC)return this.leafBox.nextSibling.glyph&&this.leafBox.nextSibling.glyph.height?(0,s.twipsToPx)(this.leafBox.nextSibling.glyph.height):n;if(this.leafBox.charType===Le.P1W.end&&this.leafBox.prevSibling instanceof Ue.zC)return this.leafBox.prevSibling.glyph&&this.leafBox.prevSibling.glyph.height?(0,s.twipsToPx)(this.leafBox.prevSibling.glyph.height):n}if((0,Fe.tq)(this.leafBox.parentBox))return(null===(t=this.leafBox.parentBox)||void 0===t?void 0:t.rect.height)?(0,s.twipsToPx)(this.leafBox.parentBox.rect.height):n;var o=this.getLeafDomForLineBase();if(o)return o.offsetHeight;var i=this.leafBox.rect.height;return!i&&this.leafBox.parentBox&&(i=this.leafBox.parentBox.rect.height),i?(0,s.twipsToPx)(i):n},Object.defineProperty(t.prototype,"documentBox",{get:function(){return this.leafBox.getAncestorOf(Fe.uO.Document)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineBox",{get:function(){return this.leafBox.getAncestorOf(Fe.uO.Line)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineHeight",{get:function(){return this.lineBox?(0,s.twipsToPx)(this.lineBox.totalHeight):0},enumerable:!1,configurable:!0}),t.prototype.linePosOffset=function(e,t){if(void 0===e&&(e=1),void 0===t&&(t=!1),this._cacheZoomLevel===e&&this._cachedLinePosOffset)return this._cachedLinePosOffset;this._cacheZoomLevel=e;var n=(0,s.pxToTwips)(this.leafBoxOffset(e,t));return this._cachedLinePosOffset=void 0!==n?n+this.calcLineOffset(this.leafBox,t):void 0,this._cachedLinePosOffset},t.prototype.clone=function(){return new t(this.leafBox,this.charsOffset,this.gcp,this.pos,this.renderState)},t.prototype.calcLineOffset=function(e,t){if(void 0===t&&(t=!1),!this.lineBox||!e.parentBox)return 0;var n,r=e;e.parentBox&&(0,Fe.tq)(e.parentBox)&&!t&&(r=e.parentBox),n=(0,Fe.Jt)(e.parentBox)?Ue.MM.getOffsetPoint(e,Fe.uO.SubLine):Ue.MM.getOffsetPoint(r,Fe.uO.Line);var o=this.lineBox.edge,i=n.x+o.border.width.left;return o.recycle(),i},t.prototype.getDocumentOffsetConsiderAnchor=function(e){return Ue.MM.getOffsetPoint(e,Fe.uO.Document)},t}(Be);function lt(e,t){return e.gcp===t.gcp?e.charsOffset<t.charsOffset:e.gcp>t.gcp}var ut=function(){function e(){}return Object.defineProperty(e.prototype,"archorPoint",{get:function(){return this.archor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"forcusPoint",{get:function(){return this.focus},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backward",{get:function(){return!(!this.archor||!this.focus)&&lt(this.archor,this.focus)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gcpRange",{get:function(){if(!this.archor||!this.focus)return Le.ICE.emptyRange();var e=Math.min(this.archor.gcp,this.focus.gcp),t=Math.abs(this.archor.gcp-this.focus.gcp);return new Le.ICE(e,t)},enumerable:!1,configurable:!0}),e.prototype.getViewRange=function(){if(this.archor&&this.focus)return this.backward?new Ne(this.focus,this.archor):new Ne(this.archor,this.focus)},e.prototype.setViewRange=function(e){this.setBaseAndExtent(e.start,e.end)},e.prototype.setBaseAndExtent=function(e,t){this.archor=e,this.focus=t},e.prototype.removeAll=function(){this.archor=void 0,this.focus=void 0},e}();function dt(e,t,n){var r,o,i,s,c;if((0,Fe.Kg)(e)||e.containsRangeOrCP(t,!0)){if((0,Fe.tR)(e)||(0,Fe.tq)(e))return e;if((0,Fe.tJ)(e)&&e.getRange().contains(t))return e;if((0,Fe.UB)(e)){if(void 0!==n&&(0,Fe.De)(e)){var l=null===(c=null===(s=null===(i=e.parentBox)||void 0===i?void 0:i.parentBox)||void 0===s?void 0:s.children)||void 0===c?void 0:c[n],u=(0,Fe.AY)(e)?null==l?void 0:l.header:null==l?void 0:l.footer;if(u&&(h=dt(u,t)))return h}try{for(var d=(0,a.__values)(e.children),p=d.next();!p.done;p=d.next()){var h;if(h=dt(p.value,t,n))return h}}catch(e){r={error:e}}finally{try{p&&!p.done&&(o=d.return)&&o.call(d)}finally{if(r)throw r.error}}}}}function pt(e,t,n){for(var r=e.getLength(),o=t;o>=0&&o<=r;o+=n)if([Le.IfD.TableStart,Le.IfD.TableEnd,Le.IfD.TableRowBreak,Le.IfD.TableCellBreak].indexOf(e.charAt(o))<0)return o;return t}function ht(e,t){if((0,Fe.k4)(e.leafBox)&&!e.leafBox.hidden){var n=e.leafBox.text.length;if(n<e.charsOffset){var r="".concat(t.first,":").concat(t.last+1,":").concat(e.leafBox.firstIndex,":").concat(e.leafBox.lastIndex),o=new Error("invalid point ".concat(e.gcp,":").concat(e.charsOffset,", textLen:").concat(n," ").concat(e.leafBox.text,", box:").concat(r));return Ve.kQ.captureException(Ve.GI.ACTIVE_REPORT_ERROR,{},o),!1}}return!0}function ft(e){var t=e.getRange();return{first:t.gcpBegin,last:t.end()-1}}function gt(e,t,n,r,o){void 0===r&&(r=0);var i=function(e,t,n){var r=e.storyBoxMgr;if(!r.storyNumber)return e.getLayoutBox();var o=r.getBoxByRange(t);if(!o)return e.getLayoutBox();if((0,Fe.yB)(o)&&o.content){var i=dt(e.getLayoutBox(),o.getRangeBegin(),n);return i&&(0,Fe.yB)(i)?i.content:o.content}s.Logger.error("Find story box which has no content, story id=".concat(o.storyId,"."))}(e,t,r||0);if(!i)return null;var a={first:t.begin(),last:t.end()};o&&(a.first=pt(o,a.first,1),t.len>0?(a.last=pt(o,a.last-1,-1)+1,a.first>a.last&&(a.last=a.first+1)):a.last=a.first);for(var c=dt(i,a.first,r);c&&(0,Fe.k4)(c)&&(0,Fe.w5)(c);)c=null==c?void 0:c.prevSibling;if(c){var l=ft(c),u=st(c,a.first-l.first,a.first,0,n);if(u&&ht(u,l)){var d=void 0;if(l.last>=a.last?d=c:(d=dt(i,a.last>a.first?a.last-1:a.last,r))&&(l=ft(d)),d){var p=st(d,a.last-l.first,a.last,0,n);if(p&&ht(p,l))return new Ne(u,p)}}}return null}var vt,yt,mt,bt,_t,Ct,St,wt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.getFontFamily=function(e){return this.get(e)},t.prototype.setFontFamily=function(e,t){this.set(e,t)},t}(function(){function e(){this.pool={},this.poolSize=0,e.caches.push(this)}return e.clearCaches=function(){e.caches.forEach((function(e){e.clear()}))},e.prototype.clear=function(){this.pool={},this.poolSize=0},e.prototype.get=function(e){return this.pool[e]},e.prototype.set=function(t,n){this.poolSize===e.MaxPoolSize&&this.clear(),this.pool[t]||(this.poolSize+=1),this.pool[t]=n},e.MaxPoolSize=1e3,e.caches=[],e}()),Et=function(e){function t(t){return e.call(this,t)||this}return(0,a.__extends)(t,e),t.createInstance=function(e){var n=wt.instance.getFontFamily(e);return n||(n=new t(e),wt.instance.setFontFamily(e,n)),n},t}(function(){function e(e){this.value=e}return Object.defineProperty(e.prototype,"stringValue",{get:function(){return this.value},enumerable:!1,configurable:!0}),e.prototype.setValue=function(e){this.value=e},e.prototype.isEqualTo=function(e){return this.value===e.value},e}());!function(e){e[e.top=Le.lZc.top]="top",e[e.middle=Le.lZc.center]="middle",e[e.bottom=Le.lZc.bottom]="bottom"}(St||(St={}));var xt,Tt,Rt=((vt={})[Le.EJ9.single]="solid",vt),It=function(e){return e.val===Le.EJ9.none||e.val===Le.EJ9.nil?"none":"".concat((r=e.sz,"".concat((0,s.twipsToPx)((0,Ve.B0)(r)),"px"))," ").concat((n=e.val,Rt[n]||"solid")," ").concat((t=e.color)&&t!==Le.oPf.auto&&"auto"!==t?Le.QBv.parseHexColor(t):"windowtext");var t,n,r},Pt=function(e){return"".concat((0,s.twipsToPx)(e),"px")},Ot=function(e){return Pt(e.w)},kt=function(e){return{borderTop:It(e.top),borderRight:It(e.right),borderBottom:It(e.bottom),borderLeft:It(e.left)}},Dt=function(e){return{paddingTop:Ot(e.top),paddingLeft:Ot(e.left),paddingBottom:Ot(e.bottom),paddingRight:Ot(e.right)}},Mt=function(e){var t,n={width:Ot(e.tcW),boxSizing:"border-box"},r=Le.QBv.getHexColorFromShd(e.shd);return r&&r!==Le.oPf.auto&&r!==Le.oPf.undefined&&(n.backgroundColor=Le.QBv.parseHexColor(Le.QBv.getHexColorFromShd(e.shd),Le.keb.bgColor)),n.verticalAlign=(t=e.vAlign,St[t]||"top"),n},At=function(e){return e?(0,a.__assign)((0,a.__assign)((0,a.__assign)({},Mt(e)),Dt(e.tcMar)),kt(e.tcBorders)):{}},Lt=function(e){return e?(0,s.twipsToPx)(Number(e.tcW.w))+(0,s.twipsToPx)(Number(e.tcMar.left.w))+(0,s.twipsToPx)(Number(e.tcMar.right.w))+(0,s.twipsToPx)((0,Ve.B0)(e.tcBorders.left.sz)):0},Nt=function(e){return e?(0,s.twipsToPx)((0,Ve.B0)(e.tcBorders.right.sz)):0},Bt=((yt={})[Le.B6J.page]="page",yt[Le.B6J.text]="paragraph",yt[Le.B6J.margin]="margin",yt),Ft={page:Le.B6J.page,paragraph:Le.B6J.text,margin:Le.B6J.margin},Ut=((mt={})[Le.Er3.page]="page",mt[Le.Er3.margin]="margin",mt[Le.Er3.text]="column",mt),Ht={page:Le.Er3.page,margin:Le.Er3.margin,column:Le.Er3.text},jt=((bt={})[Le.xxK.center]="center",bt[Le.xxK.inside]="inside",bt[Le.xxK.outside]="outside",bt[Le.xxK.left]="left",bt[Le.xxK.right]="right",bt),Gt=((_t={})[Le.xxK.center]=Le.y83.center,_t[Le.xxK.left]=Le.y83.left,_t[Le.xxK.right]=Le.y83.right,_t),Vt={center:Le.xxK.center,inside:Le.xxK.inside,outside:Le.xxK.outside,left:Le.xxK.left,right:Le.xxK.right},Wt=((Ct={})[Le.VKo.center]="middle",Ct[Le.VKo.inside]="inside",Ct[Le.VKo.outside]="outside",Ct[Le.VKo.top]="top",Ct[Le.VKo.bottom]="bottom",Ct),zt={middle:Le.VKo.center,inside:Le.VKo.inside,outside:Le.VKo.outside,top:Le.VKo.top,bottom:Le.VKo.bottom},Kt={right:Le.xxK.left,left:Le.xxK.right},qt={never:Le.wD4.never,overlap:Le.wD4.overlap},Yt={verticalAnchor:"mso-table-anchor-vertical",horizonAnchor:"mso-table-anchor-horizontal",tblpX:"mso-table-left",tblpY:"mso-table-top",paddingFromText:"mso-padding-alt",overlap:"mso-table-overlap",marginLeft:"margin-left",marginRight:"margin-right"},Qt='Monaco,"Courier New",monospace',Zt="Roboto",Xt='STSong,SimSun,"Songti SC","","","-",SimSun_GB2312,"_GB2312"',Jt='SimHei,"Heiti SC",Hei,"","-"',$t='KaiTi,kai,Kai,"KaiTi SC","","-",KaiTi_GB2312,"_GB2312"',en='"Microsoft YaHei",""',tn='PingFang,"PingFang SC","","-"',nn={"":"".concat('FangSong,"",FangSong_GB2312,"_GB2312"',",").concat(Xt),"":"".concat(en,",").concat(tn),"":"".concat(tn,",").concat(en)},rn={"":"".concat('DFKai-SB,""',",").concat($t),"":"".concat('"Hiragino Sans GB",""',",").concat(nn.),"":"".concat('STFangsong,""',",").concat(nn.),"":"".concat('STKaiti,""',",").concat($t),"":"".concat('STSong,""',",").concat(Xt),"":"".concat('STZhongsong,""',",").concat(Xt),"":"".concat('STHeiti,""',",").concat(nn.),"":"".concat('NSimSun,""',",").concat(Xt),"":"".concat('"Microsoft JhengHei",""',",").concat(nn.),"":"".concat('PMingLiU,""',",").concat(Xt)},on='TencentSans,""," W3"," W7"',an={"":"".concat('FZDocHei,""',",").concat(nn.),"_GBK":"".concat('FZFangSong-Z02,"_GBK"',",").concat(nn.),"_GBK":'FZLiShu-S01,"_GBK"',"_GBK":"".concat('FZNewKai-Z03,"_GBK"',",").concat($t),"_GBK":'FZYaoTi-M06,"_GBK"',"_GBK":"".concat('FZHei-B01,"_GBK"',",").concat(nn.),"_GBK":"".concat('FZKai-Z03,"_GBK"',",").concat($t),"_GBK":"".concat('FZXiaoBiaoSong-B05,"_GBK"',",").concat(Xt),"_GBK":"".concat('FZDaBiaoSong-B06,"_GBK"',",").concat(Xt)},sn={"":"".concat('FZFangSong-Z02S,""',",").concat(an._GBK),"":"".concat('FZFangSongB-Z02,""',",").concat(an._GBK),"":"".concat('FZLiShu-S01S,""',",").concat(an._GBK),"":"".concat('FZJLiShu-S01,""',",").concat(an._GBK),"":"".concat('FZNewKai-Z03S,""',",").concat(an._GBK),"":"".concat('FZYaoTi-M06S,""',",").concat(an._GBK),"":"".concat('FZJYaoTi-M06,""',",").concat(an._GBK),"":"".concat('FZHei-B01S,""',",").concat(an._GBK),"":"".concat('FZHeiB-B01,""',",").concat(an._GBK),"":"".concat('FZKai-Z03S,""',",").concat(an._GBK),"":"".concat('FZKaiB-Z03,""',",").concat(an._GBK),"":"".concat('FZXiaoBiaoSong-B05S,""',",").concat(an._GBK),"":"".concat('FZXiaoBiaoSongB-B05,""',",").concat(an._GBK),"":"".concat('FZDaBiaoSong-B06S,""',",").concat(an._GBK),"":"".concat('FZDaBiaoSongB-B06,""',",").concat(an._GBK)},cn=new Map([["monospace",Qt],["Monaco",Qt],["Courier New",Qt],["Roboto",Zt],["SimSun",Xt],["Songti SC",Xt],["",Xt],["-",Xt],["SimSun_GB2312",Xt],["_GB2312",Xt],["SimHei",Jt],["Heiti SC",Jt],["Hei",Jt],["",Jt],["-",Jt],["KaiTi",$t],["kai",$t],["Kai",$t],["KaiTi SC",$t],["",$t],["-",$t],["KaiTi_GB2312",$t],["_GB2312",$t],["FangSong",nn.],["",nn.],["FangSong_GB2312",nn.],["_GB2312",nn.],["Microsoft YaHei",nn.],["",nn.],["PingFang",nn.],["PingFang SC",nn.],["",nn.],["-",nn.],["DFKai-SB",rn.],["",rn.],["Hiragino Sans GB",rn.],["",rn.],["STFangsong",rn.],["",rn.],["STKaiti",rn.],["",rn.],["STSong",rn.],["",rn.],["STZhongsong",rn.],["",rn.],["STHeiti",rn.],["",rn.],["NSimSun",rn.],["",rn.],["Microsoft JhengHei",rn.],["",rn.],["PMingLiU",rn.],["",rn.],["TencentSans",on],["",on],[" W3",on],[" W7",on],["FZDocHei",an.],["",an.],["FZFangSong-Z02",an._GBK],["_GBK",an._GBK],["FZFangSong-Z02S",sn.],["",sn.],["FZFangSongB-Z02",sn.],["",sn.],["FZLiShu-S01",an._GBK],["_GBK",an._GBK],["FZLiShu-S01S",sn.],["",sn.],["FZJLiShu-S01",sn.],["",sn.],["FZNewKai-Z03",an._GBK],["_GBK",an._GBK],["FZNewKai-Z03S",sn.],["",sn.],["FZYaoTi-M06",an._GBK],["_GBK",an._GBK],["FZYaoTi-M06S",sn.],["",sn.],["FZJYaoTi-M06",sn.],["",sn.],["FZHei-B01",an._GBK],["_GBK",an._GBK],["FZHei-B01S",sn.],["",sn.],["FZHeiB-B01",sn.],["",sn.],["FZKai-Z03",an._GBK],["_GBK",an._GBK],["FZKai-Z03S",sn.],["",sn.],["FZKaiB-Z03",sn.],["",sn.],["FZXiaoBiaoSong-B05",an._GBK],["_GBK",an._GBK],["FZXiaoBiaoSong-B05S",sn.],["",sn.],["FZXiaoBiaoSongB-B05",sn.],["",sn.],["FZDaBiaoSong-B06",an._GBK],["_GBK",an._GBK],["FZDaBiaoSong-B06S",sn.],["",sn.],["FZDaBiaoSongB-B06",sn.],["",sn.]]),ln=function(){function e(){this.fontFamilyArray=[],this.fontFallbackSet=new Set}return Object.defineProperty(e.prototype,"length",{get:function(){return this.fontFamilyArray.length},enumerable:!1,configurable:!0}),e.prototype.appendFontName=function(e){var t=e.replace(/'/g,"").replace(/"/g,"");if(t){var n=cn.get(t);this.fontFamilyArray.push('"'.concat(t,'"')),n&&this.fontFallbackSet.add(n)}},e.prototype.getFontFamilyString=function(e){return[this.fontFamilyArray.join(","),Array.from(this.fontFallbackSet).join(","),e].filter((function(e){return""!==e})).join(",")},e}(),un={verticalAlign:"vertical-align",textDecoration:"text-decoration",whiteSpace:"white-space",fontFamily:"font-family",fontSize:"font-size",fontStyle:"font-style",fontWeight:"font-weight",color:"color",backgroundColor:"background",fontScaling:"mso-font-width",letterSpacing:"letter-spacing",writingMode:"writing-mode",border:"border",opacity:"opacity",left:"left",top:"top",height:"height",width:"width",margin:"margin",marginLeft:"margin-left",marginRight:"margin-right",marginTop:"margin-top",marginBottom:"margin-bottom",padding:"padding",position:"position"},dn=(xt=function(){return{fontFamily:Et.createInstance(Le.keb.fontFamily),fontSize:"".concat((0,s.twipsToPt)(Le.keb.fontSize),"pt"),color:Le.keb.textColor,linkColor:Le.keb.linkColor,fontWeight:Le.keb.fontWeight,fontStyle:"normal",textDecoration:"",writingMode:"horizontal-tb",verticalAlign:"baseline"}},Tt=null,function(e){return void 0===e&&(e=!1),Tt&&!e||(Tt=xt()),Tt}),pn=new Set(["textDecoration","textDecorationColor"]),hn=function(){function e(e){this.styles=e||{}}return e.prototype.setProperty=function(e){e&&(this.styles=e)},e.prototype.mergeTo=function(e){var t=this;return Object.keys(this.styles).forEach((function(n){e.styles[n]=t.styles[n]})),e},Object.defineProperty(e.prototype,"cssProperties",{get:function(){return this.styles},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cssText",{get:function(){var e=this,t=[];return Object.keys(this.styles).forEach((function(n){var r=un[n];r||(r=s.StringUtil.camelToChain(n)),e.computeCssText(t,e.styles,r,n)})),t.join(";")},enumerable:!1,configurable:!0}),e.cssText=function(t){return new e(t).cssText},e.prototype.computeCssText=function(e,t,n,r){var o,i;"fontFamily"===r?e.push("".concat(n,":").concat(null!==(i=null===(o=this.styles.fontFamily)||void 0===o?void 0:o.stringValue)&&void 0!==i?i:"")):e.push("".concat(n,":").concat(this.styles[r]))},e}(),fn=function(){function e(){}return e.computeStyles=function(e){return e instanceof Le.Pye?this.computeStylesFromProps(e):(0,Fe.fX)(e)?this.computeStylesFromBox(e):new hn},e.computeTextSpanFullStyles=function(e){var t=new hn,n=this.parseTextSpan(e,["whiteSpace"]);return"top"===n.verticalAlign&&(n.verticalAlign="super"),"super"!==n.verticalAlign&&"sub"!==n.verticalAlign||(n.fontSize="".concat((0,s.twipsToPt)(e.sz),"pt")),this.filterPropFontFamily(n),t.setProperty(n),t},e.computeStylesFromBox=function(e){var t,n;if((0,Fe.tq)(e)&&e.content)return this.computeStylesFromBox(e.content);var r={};if((0,Fe.NF)(e)){var o=e instanceof Ue.w8?["backgroundColor","textDecoration"]:["backgroundColor"];r=this.parseTextSpan(e.textStyle,o),e instanceof Ue.Mi&&(r.fontFamily=Et.createInstance("".concat(e.fontFamilyPrefix).concat(null!==(n=null===(t=r.fontFamily)||void 0===t?void 0:t.stringValue)&&void 0!==n?n:"")))}else(0,Fe.$5)(e)&&(r=this.parseTableCell(e));var i=new hn;return i.setProperty(r),i},e.computeStylesFromProps=function(e){var t=new hn;if(e instanceof Le.kkf.getPropertyClass(Le.uSS.RunProperty)){var n=this.parseTextSpan(e,["backgroundColor"]);t.setProperty(n)}else e instanceof Le.kkf.getPropertyClass(Le.uSS.TableCellProperty)&&(n=this.parseTableCellProps(e),t.setProperty(n));return t},e.parseTableCellProps=function(e){return(0,a.__assign)((0,a.__assign)((0,a.__assign)({},Mt(e)),Dt(e.tcMar)),kt(e.tcBorders))},e.parseTextSpan=function(e,t,n){var r=this,o=dn(),i=[],a="";e.strike&&i.push("line-through"),(e.u.val!==Le.qc8.undefined&&e.u.val!==Le.qc8.none||e.pinyin)&&(i.push("underline"),e.u.color&&e.u.color!==Le.oPf.auto&&(a=Le.QBv.parseHexColor(e.u.color)));var c=Le.QBv.parseHexColor(e.color.val,Le.keb.textColor),l=o.verticalAlign;e.vertAlign===Le.TBk.superscript?l="top":e.vertAlign===Le.TBk.subscript&&(l="sub");var u={fontSize:"".concat((0,s.twipsToPt)(e.renderFontSize),"pt"),fontFamily:this.parseFontFamilyProp(e),fontWeight:e.b?"bold":"normal",fontStyle:e.i?"italic":o.fontStyle,textDecoration:i.length>0?i.join(" "):o.textDecoration,color:c,backgroundColor:Le.QBv.parseTextBackgroundColor(e.highlight,e.shd),letterSpacing:"".concat((0,s.twipsToPt)(e.spacing),"pt"),fontScaling:"".concat(e.w,"%"),verticalAlign:l,textDecorationColor:a,textUnderlinePosition:""};return t&&t.forEach((function(e){Object.prototype.hasOwnProperty.call(u,e)&&delete u[e]})),n&&Object.keys(u).forEach((function(e){!r.isDefaultCss(e,u[e])&&u[e]||delete u[e]})),u},e.parseFontFamilyProp=function(e){var t=dn().fontFamily;return e.fontFamily&&(t=this.parseFontFamily(e.fontFamily)),t},e.parseFontFamily=function(t){var n=dn();if(t===n.fontFamily.stringValue)return Et.createInstance(t);var r=this.fontFamilyCache[t];if(!r){var o=t.split(","),i=new ln;if(o.forEach((function(t){var n=t.trim();n.length>0&&"sans-serif"!==n&&e.isSupportedFontFamily(n)&&i.appendFontName(n)})),0===i.length)return Et.createInstance(n.fontFamily.stringValue);r=i.getFontFamilyString(n.fontFamily.stringValue),this.fontFamilyCache[t]=r}return Et.createInstance(r)},e.isSupportedFontFamily=function(e){return!(!e||0===e.length||e.includes("-apple-system")||e.includes("system-ui"))},e.isDefaultCss=function(e,t){var n=dn();return"backgroundColor"===e?"transparent"===t:e&&n[e]&&n[e]===t},e.parseTableCell=function(e){return(0,a.__assign)({backgroundColor:e.property.shd.fill,verticalAlign:e.prevPartial?"top":e.vAlign},this.boxBorder(e))},e.boxSize=function(e,t,n){var r=e.rect;(0,Fe.vv)(e)?(r.width=e.floatingSpace.size.measure,r.height=e.floatingSpace.size.extent):(r.width+=e.edge.padding.left+e.edge.padding.right,r.height+=e.edge.padding.bottom+e.edge.padding.top);var o={};return t=t||1,r.width&&(o.width="".concat((0,s.twipsToPx)(r.width)*t+((null==n?void 0:n.width)||0),"px")),r.height&&(o.height="".concat((0,s.twipsToPx)(r.height)*t+((null==n?void 0:n.height)||0),"px")),o},e.calcDocBoxSize=function(t,n,r){var o=t.lastChild,i=(0,s.twipsToPx)((null==o?void 0:o.edge.margin.bottom)||0)*(n||1),a={width:((null==r?void 0:r.left)||0)+((null==r?void 0:r.right)||0),height:((null==r?void 0:r.top)||0)+((null==r?void 0:r.bottom)||0)-i};return e.boxSize(t,n,a)},e.calcDocBoxTransform=function(e,t,n){var r=Number((t.width||"").replace("px",""))||0,o=Number((t.height||"").replace("px",""))||0,i=(r/2-((null==n?void 0:n.width)||0))*(e-1),a=(o/2-((null==n?void 0:n.height)||0))*(e-1);return"matrix(".concat(e,", 0, 0, ").concat(e,", ").concat(i,", ").concat(a,")")},e.boxBorder=function(e){var t=e.edge,n=t.border,r={borderTop:"".concat((0,s.twipsToPx)(n.width.top),"px"),borderLeft:"".concat((0,s.twipsToPx)(n.width.left),"px"),borderRight:"".concat((0,s.twipsToPx)(n.width.right),"px"),borderBottom:"".concat((0,s.twipsToPx)(n.width.bottom),"px")};return t.recycle(),r},e.boxMargin=function(e,t){var n=e.edge,r=n.margin;t=t||1;var o={margin:"".concat((0,s.twipsToPx)(r.top)*t,"px ").concat((0,s.twipsToPx)(r.right)*t,"px ").concat((0,s.twipsToPx)(r.bottom)*t,"px ").concat((0,s.twipsToPx)(r.left)*t,"px")};return n.recycle(),o},e.boxPadding=function(e,t){var n=e.edge,r=n.padding;t=t||1;var o={padding:"".concat((0,s.twipsToPx)(r.top)*t,"px ").concat((0,s.twipsToPx)(r.right)*t,"px ").concat((0,s.twipsToPx)(r.bottom)*t,"px ").concat((0,s.twipsToPx)(r.left)*t,"px")};return n.recycle(),o},e.computeParagraphIndents=function(t,n,r,o){var i,a;void 0===o&&(o="string");var c,l=t,u=0,d=0,p=0,h=e.getFirstCharacterFontSize(n);if(n.property instanceof Le.Jhz){var f=(null===(a=null===(i=n.property)||void 0===i?void 0:i.listMarkerSpanProp)||void 0===a?void 0:a.sz)||Le.keb.fontSize;(c=e.getSpecialIndent(r,h,!0))>=0?u+=c+Math.abs(Le.keb.listDefaultHangingCharsNum*f):d+=Math.abs(c)}else u+=c=e.getSpecialIndent(r,h,!1);var g=r.ind.hanging;r.ind.firstLineChars&&(g=0);var v=r.ind.left-g;r.ind.hangingChars&&(v=0),0!==r.ind.leftChars&&(v=r.ind.leftChars*Le.keb.fontSize/Le.jLu.indentChars),c<0&&!(n.property instanceof Le.Jhz)&&(v-=c),d+=v;var y=r.ind.right;0!==r.ind.rightChars&&(y=r.ind.rightChars*Le.keb.fontSize/Le.jLu.indentChars),p+=y,n.property.blockQuote&&(d+=240),l.textIndent="string"===o?"".concat((0,s.twipsToPx)(u),"px"):(0,s.twipsToPx)(u),l.paddingLeft="string"===o?"".concat((0,s.twipsToPx)(d),"px"):(0,s.twipsToPx)(d),l.marginRight="string"===o?"".concat((0,s.twipsToPx)(p),"px"):(0,s.twipsToPx)(p)},e.fixIndentStyle=function(t,n){var r,o,i=e.computeParagraphWidth(n);if(!(i>=32)){var a=t,s=parseFloat(null!==(r=t.paddingLeft)&&void 0!==r?r:"0px"),c=parseFloat(null!==(o=t.marginLeft)&&void 0!==o?o:"0px");(c+=i-32)<0&&(s+=c,c=0),a.paddingLeft="".concat(s,"px"),a.marginLeft="".concat(c,"px")}},e.getSpecialIndent=function(e,t,n){return void 0===n&&(n=!1),0!==e.ind.hangingChars?-e.ind.hangingChars/Le.jLu.indentChars*t:0!==e.ind.firstLineChars?t*e.ind.firstLineChars/Le.jLu.indentChars:0!==e.ind.hanging?n?-e.ind.hanging/Le.keb.fontSizeStable*Le.keb.fontSize:-e.ind.hanging:0!==e.ind.firstLine?e.ind.firstLine:0},e.getFirstCharacterFontSize=function(e){var t=Le.keb.fontSize,n=e.children&&e.children.length&&e.children[0].property instanceof Le.kkf.getPropertyClass(Le.uSS.RunProperty)?e.children[0].property:null;return n?n.sz:t},e.styleHash=function(e){var t,n;return"".concat(e.fontStyle).concat(e.fontWeight).concat(e.fontSize).concat(null!==(n=null===(t=e.fontFamily)||void 0===t?void 0:t.stringValue)&&void 0!==n?n:"").concat(e.color).concat(e.opacity).concat(e.letterSpacing).concat(e.fontScaling)},e.getCursorType=function(e){if(s.PlatformUtil.isTencentDocsIPadApp()&&!e)return"auto"},e.getDiffColorFromId=function(t){var n=e.colorMap.get(t);if(!n){e.subHistoryItemChangeColorList.length<=0&&(e.subHistoryItemChangeColorList=e.historyItemChangeColorList.slice(0));var r=Math.floor(Math.random()*e.subHistoryItemChangeColorList.length);n=e.subHistoryItemChangeColorList[r],e.colorMap.set(t,n),e.subHistoryItemChangeColorList.splice(r,1)}return n},e.getDiffColorMap=function(){return new Map((0,a.__spreadArray)([],(0,a.__read)(e.colorMap),!1))},e.setDiffColorMap=function(t){e.colorMap=new Map((0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(e.colorMap),!1),(0,a.__read)(t),!1))},e.getDiffColorStyle=function(t){var n=e.getDiffColorFromId(t||window.clientVars.userId),r=n.split("#"),o=parseInt(r[1].substr(0,2),16),i=parseInt(r[1].substr(2,2),16),a=parseInt(r[1].substr(4,2),16);return{color:n,backgroundColor:"rgba(".concat(o,",").concat(i,",").concat(a,", 0.2)")}},e.removeStyle=function(e,t){var n={};return Object.keys(e).forEach((function(r){t(r,e[r])&&(n[r]=e[r],delete e[r])})),n},e.takeStyle=function(e,t){if(0===Object.keys(e).length)return e;var n=t===Fe.gy.Inline?function(e){return pn.has(e)}:function(e){return!pn.has(e)};return this.removeStyle(e,n)},e.getPageMaxWidth=function(){return(0,s.twipsToPx)(Le.keb.section.pageSize.width-Le.keb.section.pageMargins.left-Le.keb.section.pageMargins.right)},e.getMeloPageViewStyle=function(t){if(t&&(0,Fe.Le)(t)&&t.property){var n=t.property,r=n.pgSz.w-n.pgMar.left-n.pgMar.right,o={paddingTop:"".concat((0,s.twipsToPx)(n.pgMar.top),"px"),paddingLeft:"".concat((0,s.twipsToPx)(n.pgMar.left),"px"),paddingRight:"".concat((0,s.twipsToPx)(n.pgMar.right),"px"),paddingBottom:"".concat((0,s.twipsToPx)(n.pgMar.bottom),"px"),minHeight:"".concat((0,s.twipsToPx)(n.pgSz.h),"px"),marginBottom:"25px",background:"#fff",position:"relative",whiteSpace:"pre-wrap"};return(0,a.__assign)({width:"".concat((0,s.twipsToPx)(r),"px"),boxShadow:e.getPageBoxShawdow()},o)}return{}},e.getPageBoxShawdow=function(e){return Le.msV.EnterpriseWeb,e===Le.msV.Scroll?"":Le.keb.pageBoxShawdow},e.getPageViewShawdow=function(e){return e===Le.msV.Scroll?Le.keb.pageBoxShawdow:""},e.computeParagraphWidth=function(t){var n,r={textIndent:0,paddingLeft:0,marginLeft:0,marginRight:0},o=t.parentBox;if((0,Fe.dc)(t)&&o){if((0,Fe.Le)(o)&&o.property){n=o.property,e.computeParagraphIndents(r,t,t.property,"int");var i=r;return(0,s.twipsToPx)(n.pgSz.w-n.pgMar.left-n.pgMar.right)-(i.textIndent?i.textIndent:0)-(i.marginLeft?i.marginLeft:0)-(i.paddingLeft?i.paddingLeft:0)-(i.marginRight?i.marginRight:0)}if(!(0,Fe.Le)(o)&&o)return(0,s.twipsToPx)(o.width)}return(0,s.twipsToPx)(Le.keb.section.pageSize.width-Le.keb.section.pageMargins.left-Le.keb.section.pageMargins.right)},e.getTableBoxLite=function(e){var t=e.parentBox;if((0,Fe.UO)(t))for(;t;){if((0,Fe.hE)(t))return t;t=t.parentBox}return null},e.cssPropsToStyle=function(e){var t,n,r={};return e&&(r=e.fontFamily?(0,a.__assign)((0,a.__assign)({},e),{fontFamily:null!==(n=null===(t=null==e?void 0:e.fontFamily)||void 0===t?void 0:t.stringValue)&&void 0!==n?n:""}):(0,a.__assign)({},e)),r},e.computeContainerStyles=function(t,n,r,o,i){var c={};t.display===Fe.gy.InlineBlock&&(c.display="inline-block",c.width=n?"".concat((0,s.twipsToPx)(n.width),"px"):e.boxSize(t).width),(0,Fe.Oi)(t)&&(c.lineHeight="normal"),t instanceof Ue.AT&&(c.lineHeight="normal");var l=this.computeHeaderFooterFocusStyles(r,o,i);return(0,a.__assign)((0,a.__assign)({},c),l)},e.computeHeaderFooterFocusStyles=function(e,t,n){var r={};return e===Le.$BT.PrintPreview?(r.opacity=1,r):(r.opacity=n?t?1:.4:t?.4:1,r)},e.filterPropFontFamily=function(e){var t,n;if((null===(t=e.fontFamily)||void 0===t?void 0:t.stringValue)===Le.keb.fontFamily)delete e.fontFamily;else{var r=null===(n=e.fontFamily)||void 0===n?void 0:n.stringValue.split(",")[0];r&&(e.fontFamily=new Et(r))}},e.historyItemChangeColorList=["#B30000","#E6118F","#F1633A","#3646A0","#3184E9","#09A9B9","#822F1D","#C67600","#FFB400","#0D6C54","#918B3D","#7BB725"],e.subHistoryItemChangeColorList=e.historyItemChangeColorList.slice(0),e.colorMap=new Map,e.fontFamilyCache={},e.computeParagraphStyles=function(t,n){var r={};return n&&(n.jc===Le.aLG.left?r.textAlign="left":n.jc===Le.aLG.center?r.textAlign="center":n.jc===Le.aLG.right?r.textAlign="right":n.jc===Le.aLG.both?r.textAlign="justify":n.jc===Le.aLG.distribute&&(r.textAlign="justify",r.textAlignLast="justify"),n.spacing.lineRule===Le.NRl.auto?r.lineHeight=Math.max(1,n.spacing.line/Le.jLu.autoLineRule*1.3||1.3):n.spacing.lineRule===Le.NRl.exact?r.lineHeight="".concat((0,s.twipsToPx)(n.spacing.line),"px"):n.spacing.lineRule===Le.NRl.atLeast&&(r.lineHeight=1.3),0!==n.spacing.before&&(r.paddingTop="".concat((0,s.twipsToPx)(n.spacing.before),"px")),0!==n.spacing.after&&(r.paddingBottom="".concat((0,s.twipsToPx)(n.spacing.after),"px")),e.computeParagraphIndents(r,t,n),e.fixIndentStyle(r,t)),r},e}(),gn=function(e,t){return e-t};function vn(e){for(var t=0,n=0;n<e.length;n++)t=10*t+e.charCodeAt(n)-48;return t}function yn(e){var t=[];return(0,Fe.wS)(e)||(0,Fe.dc)(e)?t.push(vn(e.uuid)):((0,Fe.Eb)(e)||(0,Fe.FG)(e))&&e.children.length>0&&e.children.forEach((function(e){yn(e).forEach((function(e){t.push(e)}))})),t}var mn,bn=function(){function e(){this.key=1,this.keymap=new Map,this.boxKey=new Map}return e.prototype.build=function(e,t){var n=this;if(e.uuid!==this.hostId){this.hostId=e.uuid;var r=e.children;t&&(r=r.filter(t));var o=new Map,i=new Map,a=new Map,s=[];r.forEach((function(e){var t=vn(e.uuid);if(n.boxKey.has(t)){var r=n.boxKey.get(t),c=n.keymap.get(r);n.keymap.delete(r),i.set(r,c),a.set(t,r)}else c=yn(e).sort(gn),o.set(t,c),s.push(t)}));var c=[];s.forEach((function(e){var t=o.get(e),r=n.findClosestKey(t,n.keymap);r>0?(a.set(e,r),i.set(r,t),n.keymap.delete(r)):c.push(e)})),s=[],c.forEach((function(e){var t=o.get(e),r=0;n.keymap.forEach((function(e,n){r||e.length!==t.length||(r=n)})),r?(a.set(e,r),i.set(r,t),n.keymap.delete(r)):s.push(e)})),s.forEach((function(e){var t=o.get(e),r=n.key;n.key+=1,a.set(e,r),i.set(r,t)})),this.keymap=i,this.boxKey=a}},e.prototype.findClosestKey=function(e,t){var n=this,r=0,o=0;return t.forEach((function(t,i){var a=n.findMatch(e,t);a>r&&(r=a,o=i)})),o},e.prototype.findMatch=function(e,t){return(0,Ve.__)(e,t,gn)},e.prototype.reset=function(){this.boxKey.clear(),this.keymap.clear(),this.key=1},e.prototype.getKey=function(e){return this.boxKey.get(vn(e.uuid))||vn(e.uuid)},e}();!function(e){e[e.Continue=0]="Continue",e[e.Break=1]="Break",e[e.Return=2]="Return"}(mn||(mn={}));var _n=function(){function e(){}return e.getLeastGrandsonByPoint=function(e,t){for(var n=t,r=e;;){var o=r.__node__;o&&o.scrollLeft>0&&(n.x+=(0,s.pxToTwips)(o.scrollLeft));var i=(0,a.__read)(r.getChildByPoint(n),2),c=i[0],l=i[1];if(!c||!l)break;if(!(0,Fe.Eb)(c))break;r=c,n=l}return[r,n]},e.layoutBoxTraversal=function(t,n,r){var o=[],i=function(e){o.push(e)};if(n({childBoxItem:t,appendBox:i})!==mn.Return)for(;o.length;){var a=o.shift();if(!a)break;var s=a.layoutBox,c=a.offset;if((0,Fe.Eb)(s))for(var l=null==r?void 0:r(s,c),u=e.createChildPointIterator(s,c,l),d=u.next();!d.done;){var p=d.value;d=u.next();var h=n({parentBoxItem:a,childBoxItem:p,appendBox:i});if(h===mn.Break)break;if(h===mn.Return)return}}},e.createChildPointIterator=function(e,t,n){return(0,Fe.n6)(e)?this.createPageChildPointIterator(e,t,n):(0,Fe.YP)(e)?this.createTableChildPointIterator(e,t,n):(0,Fe.sJ)(e)?this.createTableRowChildPointIterator(e,t,n):this.createBaseChildPointIterator(e,t,n)},e.createBaseChildPointIterator=function(e,t,n){var r,o,i,s,c,l,u,d,p;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:r=t.x,o=t.y,r+=e.edge.border.width.left,o+=e.edge.border.width.top,i=0,s=e.children.length,n&&(i=Math.max(n.start.vIndex-1,i),s=Math.min(n.end.vIndex+1,s)),c=i,a.label=1;case 1:return c<s?(l=e.children[c],u=l.edge.margin,d=l.getOuterPoint(),p={x:r+d.x+u.left,y:o+d.y+u.top},[4,{layoutBox:l,offset:p,index:c}]):[3,4];case 2:a.sent(),a.label=3;case 3:return c++,[3,1];case 4:return[2]}}))},e.createPageChildPointIterator=function(e,t,n){var r,o,i,s;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:r=0,a.label=1;case 1:return r<e.children.length?(o=e.children[r],i=o.getOuterPoint(),s=o.edge.margin,i.offset(t.x+s.left,t.y+s.top),[4,{layoutBox:o,offset:i,index:r,traversalRange:(0,Fe.zd)(o)?n:void 0}]):[3,4];case 2:a.sent(),a.label=3;case 3:return++r,[3,1];case 4:return[2]}}))},e.createTableChildPointIterator=function(e,t,n){var r,o,i,s,c;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:r=t.x+e.edge.border.width.left,o=t.y+e.edge.border.width.top,i=n?n.end.vIndex:e.children.length-1,s=0,a.label=1;case 1:return s<=i?[4,{layoutBox:c=e.children[s],offset:{x:r+c.edge.margin.left,y:o},index:s,traversalRange:n}]:[3,4];case 2:a.sent(),o+=c.totalHeight,a.label=3;case 3:return s++,[3,1];case 4:return[2]}}))},e.createTableRowChildPointIterator=function(e,t,n){var r,o,i,s,c,l,u,d;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:r=t.x,o=t.y,i=e.children.length,s=0,c=0,a.label=1;case 1:return s<i?(l=e.children[c])?l.totalWidth<=0?(s-=1,[3,3]):(u={x:r,y:o},l.isZero()||(d=l.edge,u.x+=d.margin.left,u.y+=d.margin.top,d.recycle()),[4,{layoutBox:l,offset:{x:r,y:o},index:s,traversalRange:n}]):[3,3]:[3,4];case 2:a.sent(),r+=l.totalWidth,a.label=3;case 3:return s+=1,c+=1,[3,1];case 4:return[2]}}))},e.createAllTableCellPointIterator=function(t,n){var r,o,i,s,c,l,u,d;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:r=e.createChildPointIterator(t,n),o=r.next(),a.label=1;case 1:if(o.done)return[3,5];if(i=o.value,s=i.layoutBox,o=r.next(),!(0,Fe.sJ)(s))return[3,1];c=e.createChildPointIterator(s,i.offset),l=c.next(),a.label=2;case 2:return l.done?[3,4]:(u=l.value,d=u.layoutBox,l=c.next(),(0,Fe.$5)(d)?[4,{layoutBox:d,offset:u.offset,index:0}]:[3,2]);case 3:return a.sent(),[3,2];case 4:return[3,1];case 5:return[2]}}))},e.isFirstParaOfDoc=function(e){return 0===e.getSiblingIndex()&&0===e.getRangeBegin()},e.isEmpytPara=function(e){return e.getRange().len<=1},e.findBoxTraversalIndex=function(e,t,n,r){for(var o=t,i=-1,a=e.length-1,s=0;s<e.length;s++){var c=e[s],l=c+o;if(-1===i&&l>n&&(i=s),l>r){a=s;break}o+=c}return{start:i,end:a}},e.textBoxVerticalAlignAdapter=function(e,t){var n=t;return e.textStyle.vertAlign===Le.TBk.superscript?n-=Math.round(e.textStyle.sz/2):e.textStyle.vertAlign===Le.TBk.subscript&&(n+=Math.round(e.textStyle.sz/12)),n},e.binSearchNearest=function(e,t,n,r){if(void 0===n&&(n=0),void 0===r&&(r=0),n===r)return n;var o=Math.floor((n+r)/2),i=t(e[o]);return i>0?this.binSearchNearest(e,t,o+1,r):i<0?this.binSearchNearest(e,t,n,o):o},e.getBlockViewPortIndexRange=function(e,t,n){var r=t.firstPos,o=t.lastPos,i=this.binSearchNearest(e,(function(e){var t=e.getOuterPoint().y;return r-(n.y+t)}),0,e.length-1),a=this.binSearchNearest(e,(function(e){var t=e.getOuterPoint().y;return o-(n.y+t)}),0,e.length-1);return{first:i=Math.max(0,i-1),last:a+=1}},e.findRootContainerBox=function(e){for(var t,n,r=[e];r.length>0;){var o=r.shift();if((0,Fe.o2)(o))return o;if((0,Fe.Eb)(o))try{for(var i=(t=void 0,(0,a.__values)(o.children)),s=i.next();!s.done;s=i.next()){var c=s.value;r.push(c)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}},e.getSectionOffset=function(e){var t=e.getFirstDescendantOf(Fe.uO.Section);return t?Ue.MM.getOffsetPoint(t,Fe.uO.Document):{x:0,y:0}},e}();function Cn(e,t,n,r){return{x:e,y:t,width:n,height:r}}function Sn(e){return Cn(e.x,e.y,e.width,e.height)}function wn(e,t){return e===t||e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function En(e,t){if(e||t)return{clipInfo:e,textTransform:t}}function xn(e){return{hex:e}}function Tn(e,t,n,r){return{start:{x:e,y:t},end:{x:n,y:r}}}function Rn(e,t){var n=e.x,r=e.y,o=e.width,i=e.height,a=t.x,s=t.y,c=t.width,l=t.height,u=Math.max(n,a),d=Math.max(r,s),p=Math.min(n+o,a+c),h=Math.min(r+i,s+l);return{x:u<p?u:0,y:d<h?d:0,width:Math.max(0,p-u),height:Math.max(0,h-d)}}function In(e,t){return e===t||!(!e||!t)&&e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Pn(e){return e.width>0&&e.height>0}function On(e,t){if(e){var n=t-e.querySelectorAll(".".concat(Ge.meloDocView))[0].getBoundingClientRect().top,r=e.querySelectorAll(".".concat(Ge.meloPageView))[0].getBoundingClientRect().height,o=e.querySelectorAll(".".concat(Ge.meloPageGap));return o.length>0&&(r+=o[0].getBoundingClientRect().height),Math.ceil(n/r)}return 1}function kn(e,t){if(e)for(var n=Ge.meloPageView,r=e.querySelectorAll(".".concat(n)),o=0;o<r.length;o++){var i=r[o].getBoundingClientRect(),a=i.top,s=i.height;if(t>=a&&t<=a+s)return r[o]}return null}var Dn=new Set(["Adobe  Std","Adobe  Std","Adobe  Std","Adobe  Std","Hei","DengXian","Kai","Microsoft JhengHei","Microsoft JhengHei Light","Microsoft JhengHei UI","Microsoft JhengHei UI Light","Microsoft YaHei UI","Microsoft YaHei UI Light","MingLiU","MingLiU_HKSCS","PMingLiU","STFangsong","STHeiti","STKaiti","STSong","","","","","-","","-","","","","","","","","-","-","","-",""," Light","-","-","","","-","-","-","-","-","-","-","","","-",""," Light","_GB2312","_GB2312","","",""].concat(["","_GBK","_GBK","_GBK","_GBK","_GBK","_GBK","_GBK","_GBK"]).concat(["","","","","","","","","",""])),Mn=new Set(["Apple LiGothic","Apple LiSung","BiauKai","Hiragino Sans CNS","LiHei Pro","LiSong Pro","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-"]),An=["Bahnschrift Condensed","Bahnschrift Light","Bahnschrift Light Condensed","Bahnschrift Light SemiCondensed","Bahnschrift SemiBold","Bahnschrift SemiBold Condensed","Bahnschrift SemiBold SemiConden","Bahnschrift SemiCondensed","Bahnschrift SemiLight","Bahnschrift SemiLight Condensed","Bahnschrift SemiLight SemiConde",""];function Ln(e){return!An.includes(e)&&(function(e){return Dn.has(e)}(e)||function(e){return Mn.has(e)}(e))}var Nn,Bn=function(){function e(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=e,this.cache=new Map,this.oldCache=new Map,this._size=0}return e.prototype._set=function(e,t){this.cache.set(e,t),this._size+=1,this._size>=this.maxSize&&(this._size=0,this.oldCache=this.cache,this.cache=new Map)},e.prototype.get=function(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e)){var t=this.oldCache.get(e);return this.oldCache.delete(e),t&&this._set(e,t),t}},e.prototype.set=function(e,t){return this.cache.has(e)?this.cache.set(e,t):this._set(e,t),this},e.prototype.has=function(e){return this.cache.has(e)||this.oldCache.has(e)},e.prototype.peek=function(e){return this.cache.has(e)?this.cache.get(e):this.oldCache.has(e)?this.oldCache.get(e):void 0},e.prototype.delete=function(e){var t=this.cache.delete(e);return t&&(this._size-=1),this.oldCache.delete(e)||t},e.prototype.clear=function(){this.cache.clear(),this.oldCache.clear(),this._size=0},e}(),Fn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.findHitViewPoint=function(e,t,n,r,o,i){void 0===i&&(i=!0);var a=this.findHitLeafBox(e,t,n,o);return a&&(i||a.targetRect.contains(n))?this.findHitViewPointInLeaf(a,n,r,o):null},t.prototype.findHitLeafBox=function(e,t,n,r){var o,i=this.findHitFloatingLeafBox(e,t,n,r);if(i&&!i.isBehind)return i;var a=this.findHitLeafBoxInParentBox(e,t,n,r);return a&&((null===(o=a.matchRect)||void 0===o?void 0:o.contains(n))||a.targetRect.contains(n))||!i?a:i},t.prototype.findHitFloatingLeafBox=function(e,t,n,r){var o=this.findHitFloatingBox(e,t,n);if(!o)return null;var i=o.box.floatingSpace,c=i.size,l=i.isBehind;if((0,Fe.Dy)(o.box))return{isBehind:!!l,targetBox:o.box,targetRect:new s.MeloRect((0,a.__assign)((0,a.__assign)({},o.offset),{width:c.measure,height:c.extent}))};var u=this.findHitLeafBoxInParentBox(o.box.getOriginSizeBox(),o.offset,n,r);return u?(0,a.__assign)({isBehind:l},u):null},t.prototype.findHitFloatingBox=function(e,t,n){var r,o,i;if(!(0,Fe.gL)(e))return null;var c=_n.createBaseChildPointIterator(e,t);try{for(var l=(0,a.__values)(c),u=l.next();!u.done;u=l.next()){var d=u.value,p=d.layoutBox,h=d.offset,f=p.borderBoxSize;if(new s.MeloRect((0,a.__assign)((0,a.__assign)({},h),f)).contains(n)){var g=null===(i=p.constraintSpace)||void 0===i?void 0:i.getFloatingInfoByPosition(n.x-h.x,n.y-h.y);return g?(0,a.__assign)((0,a.__assign)({},g),{offset:{x:g.offset.x+h.x,y:g.offset.y+h.y}}):null}}}catch(e){r={error:e}}finally{try{u&&!u.done&&(o=l.return)&&o.call(l)}finally{if(r)throw r.error}}return null},t.prototype.findHitViewPointInLeaf=function(e,t,n,r){var o=e.targetBox.getRange();if((0,Fe.tq)(e.targetBox.parentBox)){var i=e.targetBox.parentBox.totalWidth,a=e.targetRect.x-e.targetBox.getOuterPoint().x,c=a+i-t.x>t.x-a,l=c?0:o.length(),u=c?0:(0,s.twipsToPx)(i);return new ct(e.targetBox,l,this.findNearestValidGcp(e.targetBox,c),u,this.renderState)}if(r&&e.targetBox instanceof Ue.Mi)return new ct(e.targetBox,0,-1,0,this.renderState);if((0,Fe.tJ)(e.targetBox)){var d=e.targetBox.getRange().begin();return new ct(e.targetBox,0,d,0,this.renderState)}if((0,Fe.NF)(e.targetBox)){if(!n&&(Fe.LC.getTypeByText(e.targetBox.textString())===Fe.yG.LineBreak||(0,Le.EDJ)(e.targetBox.text.charCodeAt(0)))){var p=o.begin();return new ct(e.targetBox,0,p,0,this.renderState)}var h=!!Ue.s9.getOutestTableBox(e.targetBox),f=it(e.targetBox,this.renderState),g=Ue.MM.getOffsetByPosition(e.targetBox,(0,s.twipsToPx)(t.x-e.targetRect.x)+(h?0:f.left)),v=g.offsetUString,y=o.begin()+g.offsetUString,m=g.offsetPx;return new ct(e.targetBox,v,y,m,this.renderState)}if((0,Fe.Oi)(e.targetBox)){var b=e.targetRect,_=b.x,C=b.width,S=t.x-_>=C/2,w=S?o.length():0,E=S?o.begin()+o.length():o.begin(),x=S?(0,s.twipsToPx)(e.targetRect.getRight()-e.targetRect.x):0;return new ct(e.targetBox,w,E,x,this.renderState)}var T=o.begin();return new ct(e.targetBox,0,T,0,this.renderState)},t.prototype.findHitLeafBoxInParentBox=function(e,t,n,r){var o;if((0,Fe.tJ)(e))return this.findHitLeafBoxInTextFrameBox(e,t,n,r);var i=this.findHitLineOrParagraphBoxInParentBox(e,t,n);if(!i)return null;if(i){if(r&&i.targetBox instanceof Ue.vm&&i.targetBox.listMark){var a=i.targetRect.clone();if(a.width=i.targetBox.listMark.rect.width+(null===(o=i.targetBox.listMark.edge)||void 0===o?void 0:o.padding.right)/2,a.x+=i.targetBox.listMarkOffsetLeft+i.targetBox.listMark.offsetLeft,a.contains(n))return{targetBox:i.targetBox.listMark,targetRect:a}}var s=this.findHitLeafBoxInLine(i.targetBox,i.targetRect,n);if(s&&(0,Fe.tJ)(s.targetBox))return this.findHitLeafBoxInTextFrameBox(s.targetBox,s.targetRect,n,r);if(s&&((0,Fe.Jt)(s.targetBox)||(0,Fe.tq)(s.targetBox))&&(s=this.findHitLeafBoxInLine(s.targetBox,s.targetRect,n)),s&&(0,Fe.Jt)(s.targetBox)&&(s=this.findHitLeafBoxInLine(s.targetBox,s.targetRect,n)),s&&(0,Fe.Dy)(s.targetBox))return{targetBox:s.targetBox,targetRect:s.targetRect}}return null},t.prototype.findHitLineOrParagraphBoxInParentBox=function(e,t,n,r){for(var o,i=null,c=(0,a.__assign)((0,a.__assign)({},n),{originX:n.x,originY:n.y}),l=[{layoutBox:e,offset:t}];l.length;){var u=l.shift();if(!u)break;var d=u.layoutBox,p=u.offset;if((0,Fe.Eb)(d)&&!d.hidden){if((0,Fe.o7)(d)||r&&(0,Fe.wS)(d)){i={targetBox:d,targetRect:new s.MeloRect({x:p.x,y:p.y,width:d.borderBoxSize.width,height:d.borderBoxSize.height})};break}var h=(0,a.__assign)({},p);if(this.callbacks.scrollerBox(d)){var f=this.callbacks.scrollerInfo(d);h={x:p.x-(0,s.pxToTwips)(f.left),y:p.y-(0,s.pxToTwips)(f.top)}}var g=this.findNearestChildBox(d,h,c,!1),v=g.nearestDistance,y=g.nearestChildBox,m=g.nearestChildRect,b=g.hitPointFix;if(c.x=b.x,c.y=b.y,y&&m){if(v<=0&&((0,Fe.o7)(y)||r&&(0,Fe.wS)(y))){i={targetBox:y,targetRect:m};break}o={layoutBox:y,offset:m.getLeftTop()},l.push(o)}}}return i},t.prototype.findNearestChildBox=function(e,t,n,r){for(var o={nearestDistance:Number.MAX_SAFE_INTEGER,nearestChildBox:void 0,nearestChildRect:void 0,hitPointFix:(0,a.__assign)({},n)},i=_n.createChildPointIterator(e,t),c=i.next();!c.done;){var l=c.value;c=i.next();var u=l.layoutBox;if(!u.hidden){var d=new s.MeloRect({x:l.offset.x,y:l.offset.y,width:u.borderBoxSize.width,height:u.borderBoxSize.height}),p=0,h=void 0;if((0,Fe.sJ)(u)){if(this.selectTableRowHitPoint(d,n),(h=this.findNearestChildBox(u,l.offset,n,!0)).nearestDistance<=0){o=(0,a.__assign)({},h);break}p=h.nearestDistance}else{if(d.contains(n)){o.nearestDistance=0,o.nearestChildBox=u,o.nearestChildRect=d;break}(u.display===Fe.gy.InlineBlock||u.display===Fe.gy.Inline||r)&&(n.x<d.x?p+=Math.abs(d.x-n.x):n.x>d.getRight()&&(p+=Math.abs(n.x-d.getRight()))),(u.display===Fe.gy.Block||r)&&(n.y<d.y?p+=Math.abs(d.y-n.y):n.y>d.getBottom()&&(p+=Math.abs(n.y-d.getBottom())))}p<o.nearestDistance&&((0,Fe.sJ)(u)&&h?o=(0,a.__assign)({},h):(o.nearestDistance=p,o.nearestChildBox=u,o.nearestChildRect=d))}}return(0,Fe.YP)(e)||this.fixHitPointToRect(o),o},t.prototype.fixHitPointToRect=function(e){e.nearestDistance>0&&e.nearestChildRect&&(e.hitPointFix.x<e.nearestChildRect.x?e.hitPointFix.x=e.nearestChildRect.x:e.hitPointFix.x>e.nearestChildRect.getRight()&&(e.hitPointFix.x=e.nearestChildRect.getRight()),e.hitPointFix.y<e.nearestChildRect.y?e.hitPointFix.y=e.nearestChildRect.y:e.hitPointFix.y>e.nearestChildRect.getBottom()&&(e.hitPointFix.y=e.nearestChildRect.getBottom()))},t.prototype.selectTableRowHitPoint=function(e,t){e.x+e.width>t.originX&&(t.x=t.originX),e.y+e.height>t.originY&&(t.y=t.originY)},t.prototype.findHitLeafBoxInLine=function(e,t,n){var r,o,i=null,a=Number.POSITIVE_INFINITY;if(e.children.length>0)for(var c=_n.createChildPointIterator(e,t.getLeftTop()),l=c.next();!l.done;){var u=l.value.layoutBox,d=l.value.offset;if(l=c.next(),(0,Fe.Dy)(u)&&!u.hidden||(0,Fe.tq)(u)||(0,Fe.Jt)(u)||(0,Fe.tJ)(u)||u instanceof Ue.oH){var p=new s.MeloRect({x:d.x,y:d.y,width:u.totalWidth,height:t.height}),h=p.getRight();if((0,Fe.Jt)(u)){var f=0;n.x>h?f+=n.x-h:n.x<p.x&&(f+=p.x-n.x),f<a&&(a=f,i={targetBox:u,targetRect:p})}else if((null===(r=u.parentBox)||void 0===r?void 0:r.firstVisibleChild)===u&&n.x<p.x||n.x>=p.x&&n.x<h||(null===(o=u.parentBox)||void 0===o?void 0:o.lastVisibleChild)===u&&n.x>=h){i={targetBox:u,targetRect:p};break}}}return i},t.prototype.findHitLeafBoxInTextFrameBox=function(e,t,n,r){var o=(0,a.__assign)({},n),i=it(e,this.renderState);o.x+=(0,s.pxToTwips)(i.left),o.y+=(0,s.pxToTwips)(i.top);var c={targetBox:e,targetRect:new s.MeloRect((0,a.__assign)((0,a.__assign)({},t),e.borderBoxSize))},l=e.content;if(!l)return c;var u=l.edge.padding,d=l.getOuterPoint(),p=e.edge.border.width,h={x:t.x+u.left+d.x+p.left,y:t.y+u.top+d.y+p.top},f=e.textboxProperty;if(!f||(null==f?void 0:f.textBoxType)===Le.Xbc.TextFrame){var g=this.findHitLeafBoxInParentBox(l,h,o,r),v=e.paddingBoxSize,y=v.width,m=v.height,b=e.edge.padding;if(!new s.MeloRect({x:t.x+Math.max(30,p.left+b.left/2),y:t.y+Math.max(30,p.top+b.top/2),width:y-Math.max(60,(b.left+b.right)/2),height:m-Math.max(60,(b.top+b.bottom)/2)}).contains(o))return c;if(!g)return c}var _=this.findHitLeafBoxInParentBox(l,h,o,r);return _?{targetBox:_.targetBox,targetRect:_.targetRect,matchRect:c.targetRect}:null},t.prototype.findViewPointForLineEnd=function(e,t,n){var r,o=this;if(!e)return null;var i=t?e.children.slice(0).reverse().find((function(e){return!o.isHiddenLeafBox(e)})):e.children.slice(0).find((function(e){return!o.isHiddenLeafBox(e)}));if((0,Fe.tq)(i)){if(r=(t?(0,a.__spreadArray)([],(0,a.__read)(i.children),!1).reverse():i.children).find((function(e){return!e.hidden}))){var c=r.getRange(),l=t?c.length():0,u=t?(0,s.twipsToPx)(r.parentBox.totalWidth):0;return new ct(r,l,this.findNearestValidGcp(r,!t),u,this.renderState)}}else(0,Fe.Jt)(i)?(0,Fe.Dy)(i.children[0])&&(r=(0,a.__read)(i.children,1)[0]):r=i;if(r){c=r.getRange(),l=t?c.length():0;var d=t?c.begin()+c.length():c.begin();return!n&&t&&function(e,t){if(t.length()>1)return!1;if((0,Fe.NF)(e)){var n=e.text.charCodeAt(0);return(0,Le.jUV)(n)||(0,Le.CLV)(n)}return!1}(r,c)&&(l=0,d=c.begin()),new ct(r,l,d,0,this.renderState)}return null},t.prototype.findHitParagraphBox=function(e){var t=this.findHitLineOrParagraphBoxInParentBox(this.layoutController.getLayoutBox(),{x:0,y:0},e,!0);return null==t?void 0:t.targetBox},t.prototype.findNearestValidGcp=function(e,t){var n=e.parentBox.getRange();return t?n.begin():n.end()-1},t.prototype.isHiddenLeafBox=function(e){return!(!(0,Fe.Dy)(e)||!e.hidden)},t}(We);function Un(e,t,n,r,o,i){return e===Le.y2q.Canvas?new Fn(e,t,n,r,(0,a.__assign)({scrollerInfo:tt,scrollerBox:nt},o),i):e===Le.y2q.Lite?new Ye(e,t,n,r,(0,a.__assign)({domPosToBoxPos:et},o)):void 0}!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.MOUSE_DOWN=1]="MOUSE_DOWN",e[e.MOUSE_UP=2]="MOUSE_UP",e[e.MOUSE_MOVE=3]="MOUSE_MOVE",e[e.CONTEXTMENU=4]="CONTEXTMENU"}(Nn||(Nn={}));var Hn,jn=function(){function e(e,t){this.finder=e,this.renderState=t,this.lastSelectList=!1,this.isMoving=!1,this.forceFocus=!0,this.lastRange=Le.ICE.emptyRange(),this.defaultDocOffset={x:0,y:0},this.srcBox=null,this.getParaBoxLiteByClientY=function(e,t){for(var n,r=0;r<t.length;r++){var o=t[r],i=o.__node__;if(!o.hidden&&i){var a=i.getBoundingClientRect();if(0===r&&a.bottom>e){n=o;break}if(!(a.top>e||a.bottom<e)){n=o;break}var s=o.nextSibling,c=o.prevSibling;if(c&&(0,Fe.hE)(c)&&e>=a.top-8){n=o;break}if(s&&(0,Fe.hE)(s)&&e<=a.bottom+12){n=o;break}}}return n}}return e.prototype.updateBothFromRange=function(e){this.start=e.start,this.end=e.end},e.prototype.updateBoth=function(e,t){var n,r=null;if(this.lastSelectList=!1,this.finder.isCanvasRender()){if((r=this.findHitViewPoint(!0,!1,!0,t))&&r.leafBox instanceof Ue.Mi&&r.leafBox.lineBox){if((i=r.leafBox.lineBox.parentBox)&&i.property instanceof Le.Jhz){var o=this.getListInfoFromIndexPair(i)||i.property;this.listInfo=o,this.lastSelectList=!0}r=this.finder.findViewPointForLineEnd(r.leafBox.lineBox,!1,!1)}}else if(null===(n=e.element)||void 0===n?void 0:n.className.includes("list-overlay")){var i=e.element.closest(".melo-paragraph").__vm__;this.listInfo=this.getListInfoFromIndexPair(i)||i.paraProps;var a=i.firstChild.getRangeBegin();r=new Qe(i.firstChild,0,a)}else r=this.findViewPoint(e,!0,!1);return!(!r||this.lastSelectList||(this.start=r,this.end=r,0))},e.prototype.updateStart=function(e,t){var n=this.finder.isCanvasRender()?this.findHitViewPoint(!1,!1,!1,t):this.findViewPoint(e,!1,!1);n&&(this.start=n)},e.prototype.updateEnd=function(e,t){var n=!this.start||!this.end||!lt(this.start,this.end),r=this.finder.isCanvasRender()?this.findHitViewPoint(!1,n,!1,t):this.findViewPoint(e,!1,n);this.setUpdateEnd(r)},e.prototype.getListInfoFromIndexPair=function(e){var t=e.getRange();return this.finder.state.dataEngine.getDataManager().getNumberingManager().getListInfoFromGcpRange(t)},e.prototype.setUpdateEnd=function(e){e&&!this.start?this.end=e:!e||this.end&&this.end.equals(e)||this.finder.getDataStream().getStoryStream().isSameSubStoryRange(new Le.ICE(Math.min(this.start.gcp,e.gcp),Math.abs(e.gcp-this.start.gcp)))&&(this.end=e)},e.prototype.updateRange=function(e,t){t?(this.start=e.end,this.end=e.start):(this.start=e.start,this.end=e.end),this.lastRange=new Le.ICE(e.start.gcp,e.end.gcp-e.start.gcp)},e.prototype.getSelection=function(){var e;if(this.start&&this.end){var t=lt(this.start,this.end),n=(0,a.__read)([this.start,this.end],2),r=n[0],o=n[1];return t&&(r=(e=(0,a.__read)([o,r],2))[0],o=e[1]),{backward:t,viewRange:new Ne(r,o)}}},e.prototype.findHitViewPoint=function(e,t,n,r,o){if(!r)return null;var i=this.finder.layoutController.getLayoutBox();return(0,Fe.gL)(i)?this.finder.findHitViewPoint(i,this.defaultDocOffset,r,t,n,o):null},e.prototype.findViewPoint=function(e,t,n){var r;void 0===t&&(t=!1),void 0===n&&(n=!1);var o=this.hasPointInTable(),i=!t&&o,a=this.finder.findViewPoint(e.clientX,e.clientY,e.element,i,n);return a||this.finder.isLiteRender()?a:(s.Logger.error("selection cant find viewpoint, node: ".concat(null===(r=e.element)||void 0===r?void 0:r.className)),null)},e.prototype.findViewPointCompatible=function(e,t,n,r,o){return this.finder.isCanvasRender()?this.findHitViewPoint(t,n,r,o):this.findViewPoint(e,t,n)},e.prototype.hasPointInField=function(e){var t=this;return[this.start,this.end].reduce((function(n,r){return!!n||t.pointInFiled(r,e)}),!1)},e.prototype.pointInFiled=function(e,t){if(e){var n=e.gcp,r=this.finder.getDataStream().getFieldStream().getDecodedFieldInfo(n,1);return t?(null==r?void 0:r.fieldCode.name)===t:!!r}return!1},e.prototype.hasPointInTable=function(){var e=this;return[this.start,this.end].reduce((function(t,n){return!!t||e.pointInTable(n)}),!1)},e.prototype.hasUnitPointInTable=function(e,t){var n=this.pointInTable(e),r=this.pointInTable(t);return n&&!r||!n&&r},e.prototype.pointInTable=function(e){if(e){var t=e.gcp;if(this.finder.getDataStream().getTableStream().getCellInfo(t))return!0}return!1},e.prototype.hasUnitPointInTextFrame=function(e,t){var n=this.isPointInTextFrame(e),r=this.isPointInTextFrame(t);return n&&!r||!n&&r},e.prototype.isPointInTextFrame=function(e){if(e){var t=e.gcp;return!!window.pad.editor.service.getDocument().getSelectionFrameType(t)}return!1},e.prototype.isPointInSelectionRange=function(e,t){var n,r,o=this.finder.isCanvasRender()?this.findHitViewPoint(!1,!1,!1,t):this.findViewPoint(e),i=this.finder.getSelection();if(o){var s=o.gcp,c=i.gcpRanges;try{for(var l=(0,a.__values)(c),u=l.next();!u.done;u=l.next()){var d=u.value;if(s>=d.begin()&&s<=d.end())return!0}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}}return!1},e.prototype.checkExpanding=function(){if(this.start&&this.end){var e=lt(this.start,this.end),t=(0,a.__read)(this.getStartAndEnd(e,this.start,this.end),2),n=t[0],r=t[1],o=new Le.ICE(n.gcp,r.gcp-n.gcp),i=this.lastRange;if(this.lastRange=o,!(o.length()<=i.length())){var s=this.getChar(n,r),c=s.beforeChar,l=s.lastChar,u=s.afterChar;if((0,Le.jUV)(c.charCodeAt(0))&&(0,Le.jUV)(u.charCodeAt(0))&&!(0,Le.jUV)(l.charCodeAt(0))){var d=void 0;if(r.leafBox instanceof Ue.w8)d=r.leafBox;else{if(!r.leafBox.nextSibling)return;d=r.leafBox.nextSibling}var p=st(d,1,r.gcp+1,0,this.renderState);e?this.start=p:this.end=p,this.lastRange.len+=1}}}},e.prototype.getStartAndEnd=function(e,t,n){return e?[n,t]:[t,n]},e.prototype.getChar=function(e,t){var n=this.finder.getDataStream().getTextStream();return{beforeChar:e.gcp>0?n.readText(e.gcp-1,1):Le.IfD.LineBreak,lastChar:n.readText(t.gcp-1,1),afterChar:n.readText(t.gcp,1)}},e.prototype.moveToLinePoint=function(e,t){var n=this.finder.findViewPointForLineEnd(e,!t,!1);return n?(this.start=n,this.end=n,this.afterChange(Nn.DEFAULT),n.gcp):null},e.prototype.afterChange=function(e){var t;null===(t=this.selectionCallback)||void 0===t||t.call(this,this,e),this.listInfo=void 0},e.prototype.findHitParagraphBox=function(e){return this.finder.isCanvasRender()?this.finder.findHitParagraphBox(e):null},e}(),Gn=function(e){function t(t,n,r){var o=e.call(this,t,n)||this;return o.context=r,o.shouldStopMouseMove=!1,o.isWrongEventTarget=function(e){if(!s.PlatformUtil.isTencentDocsIPadApp())return!1;var t=Array.from(e.classList);return!!(t.includes("melo-mobile-selection-caret")||t.includes("melo-mobile-selection-drag-left")||t.includes("melo-mobile-selection-drag-right"))},o}return(0,a.__extends)(t,e),t.prototype.onMouseEvent=function(e,t,n){var r=this.getEventInfo(e);if(!e)return!1;var o=!1;switch(t){case Fe.PO.DOWN:o=this.handleMouseDown(e,r,n);break;case Fe.PO.MOVE:o=this.handleMouseMove(e,r,n);break;case Fe.PO.UP:o=this.handleMouseUp();break;case Fe.PO.CONTEXTMENU:o=this.handleMouseOnContextMenu(e,r,n)}return(!this.start||!this.end)&&o},t.prototype.getEventInfo=function(e){return{clientX:e.clientX,clientY:e.clientY,element:e.target}},t.prototype.onDoubleClick=function(e){var t,n=null===(t=this.start)||void 0===t?void 0:t.leafBox;(0,Fe.vv)(n)&&(0,Ve.OR)(n.__node__,e,"dblclick",!1)},t.prototype.handleMouseDown=function(e,t,n){return this.isMoving=!0,e.shiftKey?this.updateEnd(t,n):this.updateBoth(t,n),this.shouldStopMouseMove=!1,this.handleContainerBoxWhenMouseDown(e,!1,n),this.handleTextFrameBoxWhenMouseDown(e),this.afterChange(Nn.MOUSE_DOWN),!0},t.prototype.handleMouseMove=function(e,t,n){if(this.shouldStopMouseMove)return!1;this.isMoving=!0;var r=this.end;return!this.isWrongEventTarget(e.target)&&(this.updateEnd(t,n),this.checkExpanding(),this.end&&r&&this.end.equals(r)||this.afterChange(Nn.MOUSE_MOVE),!0)},t.prototype.handleMouseUp=function(){return this.isMoving=!1,this.srcBox=null,this.afterChange(Nn.MOUSE_UP),!0},t.prototype.handleMouseOnContextMenu=function(e,t,n){return this.isMoving=!1,this.isPointInSelectionRange(t,n)||(this.updateBoth(t,n),this.handleContainerBoxWhenMouseDown(e,!0,n),this.handleTextFrameBoxWhenMouseDown(e),this.afterChange(Nn.CONTEXTMENU)),!0},t.prototype.handleContainerBoxWhenMouseDown=function(e,t,n){var r;if(!this.finder.isLiteRender()&&n&&("mousedown"===e.type||"contextmenu"===e.type)){var o=null===(r=this.start)||void 0===r?void 0:r.leafBox;(0,Fe.vv)(o)&&(0,Fe.Oi)(o)&&this.focusOnDrawingBox(o)&&(0,Ve.OR)(o.__node__,e,"mousedown",t)}},t.prototype.handleTextFrameBoxWhenMouseDown=function(e){var t,n;if(this.end&&("mousedown"===e.type||"contextmenu"===e.type)){var r=this.end.leafBox;if((0,Fe.tJ)(r))null===(t=this.context)||void 0===t||t.view.renderer.containerFocus.onFocus(r,{isDoubleClick:!1}),this.focusOnDrawingBox(r),r.property&&(null===(n=r.floatingSpace)||void 0===n?void 0:n.isBehind)&&(0,Ve.nT)(r.property.anchorId,e,"mousedown",!1);else if((0,Fe.Dy)(r)){var o=r.getAncestorOf(Fe.uO.TextFrame);(0,Fe.tJ)(o)&&(this.srcBox=o)}}},t.prototype.focusOnDrawingBox=function(e){var t,n=e.getRange();if(!n)return!1;var r=null===(t=this.context)||void 0===t?void 0:t.getViewRangeFromGcpRange(n,Ue.MM.getPageIndex(e));return!!r&&(this.start=r.start,this.end=r.end,this.shouldStopMouseMove=!0,!0)},t}(jn),Vn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.setSelectionCrossCallback=function(e){t.selectionCrossCallback=e},t}return(0,a.__extends)(t,e),t.prototype.fixElementWithLineBreak=function(e,t){var n=(e||{}).children;if(!n||!Array.from(e.classList).includes("melo-paragraph-content")||n.length<2||!Array.from(n).some((function(e){return"BR"===e.tagName})))return e;for(var r=0;r<n.length;r++){var o=n[r];if("BR"!==o.tagName){var i=o.getBoundingClientRect(),a=i.y,s=i.height;if(a<t&&a+s>t)return o;if(a>t)return n[Math.max(0,r-1)]}}return n[n.length-1]},t.prototype.onTouchEvent=function(e,t,n){var r=null==e?void 0:e.changedTouches[0];"touchstart"===e.type&&(this.forceFocus=!1);var o={clientX:r.clientX,clientY:r.clientY,element:this.fixElementWithLineBreak(r.target,r.clientY)};return!!this.updateBoth(o,t)&&(this.afterChange(Nn.DEFAULT),!0)},t.prototype.moveBoth=function(e,t){this.updateBoth(e,t),this.forceFocus=!1,this.afterChange(Nn.DEFAULT)},t.prototype.moveStart=function(e,t){var n,r,o,i;this.updateStart(e,t),this.checkExpanding(),(null===(n=this.start)||void 0===n?void 0:n.gcp)&&(null===(r=this.end)||void 0===r?void 0:r.gcp)&&(null===(o=this.start)||void 0===o?void 0:o.gcp)>(null===(i=this.end)||void 0===i?void 0:i.gcp)&&this.selectionCrossCallback(!1),this.afterChange(Nn.DEFAULT)},t.prototype.moveEnd=function(e,t){var n,r,o,i;this.updateEnd(e,t),this.forceFocus=!1,this.checkExpanding(),(null===(n=this.start)||void 0===n?void 0:n.gcp)&&(null===(r=this.end)||void 0===r?void 0:r.gcp)&&(null===(o=this.start)||void 0===o?void 0:o.gcp)>(null===(i=this.end)||void 0===i?void 0:i.gcp)&&this.selectionCrossCallback(!0),this.afterChange(Nn.DEFAULT)},t.prototype.updateStart=function(e,t){var n,r=this.finder.isCanvasRender()?this.findHitViewPoint(!1,!1,!1,t):this.findViewPoint(e,!1,!1);return r&&this.end&&this.hasUnitPointInTable(this.end,r)?!!(n=this.getNewViewPointCrossTable(r,e,!1))&&(this.start=n,!0):r&&this.end&&this.hasUnitPointInTextFrame(this.start,r)?!!(n=this.getNewViewPointCrossTextFrame(r,e,!1))&&(this.start=n,!0):!(!r||!this.end||this.hasUnitPointInTable(r,this.end)||(this.start=r,0))},t.prototype.updateEnd=function(e,t){var n,r=!this.start||!this.end||!lt(this.start,this.end),o=this.finder.isCanvasRender()?this.findHitViewPoint(!1,r,!1,t):this.findViewPoint(e,!1,r);return o&&this.start&&this.hasUnitPointInTable(this.start,o)?!!(n=this.getNewViewPointCrossTable(o,e,!0))&&(this.end=n,!0):o&&this.start&&this.hasUnitPointInTextFrame(this.start,o)?!!(n=this.getNewViewPointCrossTextFrame(o,e,!0))&&(this.end=n,!0):!(!o||!this.start||this.hasUnitPointInTable(this.start,o)||(this.end=o,0))},t.prototype.getNewViewPointCrossTable=function(e,t,n){var r,o;if(!(0,Fe.Av)(e.leafBox))return null;var i=Ue.s9.getOutestTableBoxLite(e.leafBox);if(!i)return null;var a=n?null===(r=i.nextSibling)||void 0===r?void 0:r.firstChild:null===(o=i.prevSibling)||void 0===o?void 0:o.lastChild;return a?this.getViewPointLite(n,a):null},t.prototype.getNewViewPointCrossTextFrame=function(e,t,n){if(!(0,Fe.Av)(e.leafBox))return null;var r=this.getTextFrameBoxFromChild(e.leafBox);if(r){var o=n?r.nextSibling:r.parentBox.prevSibling.lastChild;return this.getViewPointLite(n,o)}},t.prototype.getViewPointLite=function(e,t){var n=e?t.getRangeBegin():t.getRangeEnd();return new Qe(t,0,n)},t.prototype.updateByStartAndEnd=function(e,t){this.start=e,this.end=t,this.afterChange(Nn.DEFAULT)},t.prototype.keepMoving=function(){this.isMoving=!0},t.prototype.finishMoving=function(){this.isMoving=!1,this.afterChange(Nn.DEFAULT)},t.prototype.getTouchViewRangePoint=function(e){var t=null==e?void 0:e.changedTouches[0],n={clientX:t.clientX,clientY:t.clientY,element:t.target};return this.findViewPoint(n,!0,!1)},t.prototype.getTextFrameBoxFromChild=function(e){for(var t=e;t&&!(0,Fe.rM)(t);)t=t.parentBox;return t},t}(jn),Wn=n(31518),zn=function(){function e(e){this.uuid=e,this.colored=!1}return Object.defineProperty(e.prototype,"size",{get:function(){return this.children?this.children.length:0},enumerable:!1,configurable:!0}),e.prototype.childAt=function(e){return this.children?this.children[e]:void 0},e.prototype.append=function(e){this.children||(this.children=[]),this.children.push(e)},e}(),Kn=new(function(e){function t(){return e.call(this,"")||this}return(0,a.__extends)(t,e),t.prototype.childAt=function(){return this},t}(zn)),qn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.childAt=function(t){return e.prototype.childAt.call(this,t)||Kn},t}(zn),Yn=function(e){function t(t,n,r){var o=e.call(this,t,n)||this;return o.rootBox=t,o.orderRanges=n,o.storyId=r,o}return(0,a.__extends)(t,e),t.prototype.getRanges=function(){return this.orderRanges.getRanges(this.storyId)},t.prototype.diffFrom=function(e){return this.orderRanges.diffWithStoryId(e,this.storyId)},t}(function(){function e(e,t){this.rootBox=e,this.orderRanges=t,this.root=Kn,this.map=new Map;var n=this.getRanges();n.length&&(this.root=this.buildTree(e,n))}return e.prototype.getRanges=function(){return this.orderRanges.ranges},e.prototype.getRoot=function(){return this.root},e.prototype.reset=function(e){this.rootBox=e,this.root=Kn,this.orderRanges.reset(),this.map.clear()},e.prototype.buildTree=function(e,t){var n=this,r=t.filter((function(t){return n.hitRange(e,t)}));if(!r.length)return Kn;var o=this.map.get(e.uuid);return o||(o=new qn(e.uuid),this.map.set(e.uuid,o),o.colored=!0,(0,Fe.o7)(e)||(0,Fe.dc)(e)||e.children.forEach((function(e){var t=n.buildTree(e,r);o.append(t)})),o)},e.prototype.boxUpdate=function(e){var t=this;this.root=this.buildTree(e,this.getRanges());var n=new Map,r=function(e){var o=e.uuid,i=t.map.get(o);n.set(o,i),e.size&&e.children.forEach((function(e){e!==Kn&&r(e)}))};this.root!==Kn&&r(this.root),this.map=n,this.rootBox=e},e.prototype.rangesUpdate=function(e){var t=this,n=function(e,r,o){var i=o.local.filter((function(n){return t.hitRange(e,n)})),a=o.income.filter((function(n){return t.hitRange(e,n)})),s=o.share.filter((function(n){return t.hitRange(e,n)}));if(!i.length&&!a.length)return r;if(!a.length&&!s.length)return t.map.delete(e.uuid),Kn;if(i.length===a.length){var c=i.filter((function(n){return t.inRange(e,n)})),l=a.filter((function(n){return t.inRange(e,n)}));if(c.length&&l.length&&c.length===l.length)return r}var u=new qn(e.uuid);return u.colored=!0,t.map.set(e.uuid,u),(0,Fe.o7)(e)||(0,Fe.dc)(e)||e.children.forEach((function(e,t){var o=n(e,r.childAt(t)||Kn,{local:i,income:a,share:s});u.append(o)})),u},r=this.diffFrom(e);this.root=n(this.rootBox,this.root,r),this.orderRanges=e},e.prototype.diffFrom=function(e){return this.orderRanges.diff(e)},e.prototype.hitRange=function(e,t){var n=this,r=!1;return!(!(0,Fe.gL)(e)&&!(0,Fe.E0)(e))||((0,Fe.n6)(e)?r=r||e.children.some((function(e){return n.hitRange(e,t)})):e.intersectRange(new Le.ICE(t.first,t.last-t.first+1)))},e.prototype.inRange=function(e,t){var n=this,r=!1;if((0,Fe.gL)(e)||(0,Fe.E0)(e))r=!1;else{if(!(0,Fe.n6)(e)){var o=e.getRange();return o.gcpBegin>=t.first&&o.end()-1<=t.last}r=r||e.children.some((function(e){return n.inRange(e,t)}))}return r},e}()),Qn=function(e,t){return e.first<t.first||e.first===t.first&&e.last<t.last?-1:e.first===t.first&&e.last===t.last?0:1},Zn=function(){function e(e){this.comparator=Qn,this._ranges=e||[]}return Object.defineProperty(e.prototype,"ranges",{get:function(){return this._ranges},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._ranges.length},enumerable:!1,configurable:!0}),e.prototype.init=function(e){this._ranges=(0,a.__spreadArray)([],(0,a.__read)(e),!1)},e.prototype.safeInit=function(e){for(var t,n=e.length-1;n>=0;n--){for(var r=!1,o=0;o<n;o++)e[o].first>e[o+1].first&&(t=(0,a.__read)([e[o+1],e[o]],2),e[o]=t[0],e[o+1]=t[1],r=!0);if(!r)break}this._ranges=(0,a.__spreadArray)([],(0,a.__read)(e),!1)},e.prototype.reset=function(){this._ranges=[]},e.prototype.makeOrderRanges=function(t){return new e(t)},e.prototype.concat=function(e){var t=(0,Ve.lu)(this.ranges,e.ranges,this.comparator);return this.makeOrderRanges(t)},e.prototype.diff=function(e){return(0,Ve.vS)(this.ranges,e.ranges,this.comparator)},e.prototype.remove=function(e){for(var t=this._ranges,n=(0,a.__spreadArray)([],(0,a.__read)(e._ranges),!1),r=0;n.length&&r<t.length;)for(var o=n.shift();r<t.length;r++)0===this.comparator(t[r],o)&&t.splice(r,1)},e}(),Xn=function(e){function t(t,n){var r=e.call(this,n)||this;return r.findStoryRange=t,r}return(0,a.__extends)(t,e),t.prototype.getRanges=function(e){return e&&this.length?this.findStoryRange(e,this._ranges):this._ranges},t.prototype.makeOrderRanges=function(e){return new t(this.findStoryRange,e)},t.prototype.diffWithStoryId=function(e,t){var n=this.findStoryRange(t,this.ranges),r=this.findStoryRange(t,e.ranges);return(0,Ve.vS)(n,r,this.comparator)},t}(Zn),Jn=function(){function e(e,t,n){var r=this;this.context=e,this.state=t,this.layoutController=n,this.overlays=[],this.overlayCallback=function(e){return!!r.layoutNotChange()&&(r.onUpdate(e),!0)},this.overlayTrees=new Map,this.watcheres=[],this.storyRangeFinder=function(e,t){if(!t.length)return t;var n,o,i=function(e,t){return e.first>=t.first&&e.last<=t.last};if(e===Le.Eos.MainDocId){var a=r.layoutController.storyBoxMgr;if(0===a.storyNumber)return t;var s=r.state.getStoryStream().getSubStoryInfoFromId(e),c={first:s.range.begin(),last:s.range.end()-1};if(t[0].first>=c.first&&t[t.length-1].last<=c.last)return t;var l=a.getHeaderFooterIds(),u=[];return l.forEach((function(e){var t=r.state.getStoryStream().getSubStoryInfoFromId(e);if(t){var n={first:t.range.begin(),last:t.range.end()-1};u.push(n)}})),(n=c,(o=u).length?function(e){return e.filter((function(e){return i(e,n)||o.some((function(t){return i(e,t)}))}))}:function(e){return e.filter((function(e){return i(e,n)}))})(t)}var d=r.state.getStoryStream().getSubStoryInfoFromId(e);if(!d)return[];var p={first:d.range.begin(),last:d.range.end()-1};return t[t.length-1].last<p.first||t[0].first>p.last?[]:t.filter((function(e){return i(e,p)}))},this.onCoreSelectionChange=function(e){r.context.isInBlockState()||(r.overlays.forEach((function(t){t.onCoreSelectionChagne(e)})),r.layoutNotChange()&&(r.isRenderCanvasType()?r.overlays.forEach((function(e){e.afterDocumentRender()})):r.onUpdate()))};var o=n.getLayoutBox();if(!this.isRenderCanvasType()){var i=Le.Eos.MainDocId,a=new Yn(o,new Xn(this.storyRangeFinder),i);this.overlayTrees.set(i,a)}this.rootBoxId=o.uuid,e.on(Wn.at.CoreSelectionChange,this.onCoreSelectionChange)}return e.prototype.layoutNotChange=function(){return this.rootBoxId===this.layoutController.getLayoutBox().uuid},e.prototype.addOverlay=function(e){e.setCallback(this.overlayCallback),e.setZoomProvider(this.context),this.overlays.push(e)},e.prototype.onUpdate=function(e){var t=this,n=s.PerfUtil.now(),r=new Xn(this.storyRangeFinder);this.overlays.forEach((function(e){var n=e.getClassName()||"";r=r.concat(new Xn(t.storyRangeFinder,function(e,t){var n=[];return e.forEach((function(e){(e.len>0||"melo-comment-overlay"===t)&&n.push({first:e.begin(),last:e.end()-1})})),n}(e.getRanges(),n)))})),this.isRenderCanvasType()||this.overlayTrees.forEach((function(e){e.rangesUpdate(r)})),this.watcheres.forEach((function(t){t(e)})),this.overlays.forEach((function(e){e.afterDocumentRender()})),(n=s.PerfUtil.now()-n)>30&&s.Logger.log("perf|overlay update ".concat(n,"ms")),this.context.perfManager.costTime[Fe.zI.Overlay]=n},e.prototype.onNewDocument=function(){if(this.overlays.forEach((function(e){e.reset()})),!this.isRenderCanvasType()){var e=Le.Eos.MainDocId,t=this.overlayTrees.get(e);t.reset(this.layoutController.getLayoutBox()),this.overlayTrees.clear(),this.overlayTrees.set(e,t)}},e.prototype.getOverlayNode=function(e){var t=this.overlayTrees.get(e);return t?t.getRoot():Kn},e.prototype.addWatcher=function(e){this.watcheres.push(e)},e.prototype.removeWatcher=function(e){var t=this.watcheres.indexOf(e);t&&this.watcheres.splice(t,1)},e.prototype.onLayoutChanged=function(){var e=this;if(!this.isRenderCanvasType()){var t=this.layoutController.storyBoxMgr,n=new Map;t.readStoryBox((function(t,r){if((0,Fe.yB)(t)&&t.content){var o=e.overlayTrees.get(r);o?o.boxUpdate(t.content):o=new Yn(t.content,new Xn(e.storyRangeFinder),r),n.set(r,o)}}));var r=Le.Eos.MainDocId,o=this.overlayTrees.get(r);o.boxUpdate(this.layoutController.getLayoutBox()),n.set(r,o),this.overlayTrees=n}this.overlays.forEach((function(t){e.context.isInBlockState()||t.onLayoutChanged()})),this.isRenderCanvasType()||this.onUpdate(),this.rootBoxId=this.layoutController.getLayoutBox().uuid},e.prototype.buildLineOverlay=function(e){var t=[];return this.overlays.forEach((function(n,r){var o=n.renderOverlay(e,r);o&&t.push(o)})),t},e.prototype.buildParaOverlay=function(e){var t=[];return this.overlays.forEach((function(n,r){var o=n.renderParaOverlay(e,r);o&&t.push(o)})),t},e.prototype.buildCanvasOverlay=function(e){var t=[];return this.overlays.forEach((function(n){var r=n.checkOverlay(e);(null==r?void 0:r.length)>0&&t.push.apply(t,(0,a.__spreadArray)([],(0,a.__read)(r),!1))})),t},e.prototype.isRenderCanvasType=function(){return this.context.docEnv.renderType===Le.y2q.Canvas},e}();!function(e){e[e.UnderLowest=0]="UnderLowest",e[e.UnderLower=1]="UnderLower",e[e.UnderDefault=2]="UnderDefault",e[e.UnderHigher=3]="UnderHigher",e[e.UnderHighest=4]="UnderHighest",e[e.OverlayLowest=5]="OverlayLowest",e[e.OverlayLower=6]="OverlayLower",e[e.OverlayDefault=7]="OverlayDefault",e[e.OverlayHigher=8]="OverlayHigher",e[e.OverlayHighest=9]="OverlayHighest",e[e.UpperLowest=10]="UpperLowest",e[e.UpperLower=11]="UpperLower",e[e.UpperDefault=12]="UpperDefault",e[e.UpperHigher=13]="UpperHigher",e[e.UpperHighest=14]="UpperHighest",e[e.UpperImages=15]="UpperImages"}(Hn||(Hn={})),Object.keys(Hn).filter((function(e){return isNaN(Number(e))})).map((function(e){return Hn[e]}));var $n,er,tr,nr={paragraphBackground:Hn.OverlayLowest,taskActiveBackground:Hn.OverlayLowest,lightblockBackground:Hn.OverlayLowest,tableCellBackground:Hn.OverlayLowest,codeblockBackground:Hn.OverlayLowest,backgroundColorOverlay:Hn.OverlayLower,quoteOverlay:Hn.OverlayLower,behindTextImage:Hn.OverlayLower,lineOverlay:Hn.OverlayDefault,selectionCellOverlay:Hn.OverlayHigher,wemeetAudienceOverlay:Hn.OverlayHigher,fieldOverlay:Hn.OverlayHigher,spellcheckOverlay:Hn.OverlayHigher,translateOverlay:Hn.OverlayHigher,listActivedOverlay:Hn.OverlayHighest,highlightOverlay:Hn.OverlayHighest,searchOverlay:Hn.OverlayHigher,searchSelectedOverlay:Hn.OverlayHigher,selectionOverlay:Hn.OverlayHighest,commentOverlay:Hn.OverlayHighest,headerFooter:Hn.UpperLowest,tableWrapper:Hn.UpperLower,codeblockWrapper:Hn.UpperLower,mainText:Hn.UpperDefault,componentElement:Hn.UpperDefault,extend:Hn.UpperDefault,listQwxTodo:Hn.UpperHigher,codeblockLineNumber:Hn.UpperHigher,containerPage:Hn.UpperHighest,inFrontOfTextImage:Hn.UpperImages};!function(e){e[e.Total=0]="Total",e[e.Source=1]="Source",e[e.StrokeUnderLine=2]="StrokeUnderLine"}($n||($n={})),function(e){e[e.OverlayView=0]="OverlayView",e[e.GraphicView=1]="GraphicView"}(er||(er={})),function(e){e[e.Customize=0]="Customize",e[e.WaveLine=1]="WaveLine"}(tr||(tr={}));var rr,or,ir=function(){function e(e,t,n,r){this.left=e,this.width=t,this.height=n,this.top=r}return e.prototype.equals=function(e){return this===e||this.left===e.left&&this.width===e.width&&this.top===e.top},e.prototype.meta=function(){return{left:this.left,width:this.width,heightType:$n.Total,backgroundColor:"rbg(0, 0, 0)",priority:nr.lineOverlay,isTextSelection:!1,overlayType:er.OverlayView,graphicType:tr.Customize}},e.prototype.style=function(){return{left:"".concat((0,s.twipsToPx)(this.left),"px"),width:"".concat((0,s.twipsToPx)(this.width),"px"),height:"".concat(this.height?"".concat((0,s.twipsToPx)(this.height),"px"):0),top:"".concat(this.top?"".concat((0,s.twipsToPx)(this.top),"px"):0),backgroundColor:"rgb(0, 0, 0)"}},e}(),ar=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.style=function(){return(0,a.__assign)((0,a.__assign)({},e.prototype.style.call(this)),{position:"absolute",backgroundColor:"#1e6fff",opacity:.3,zIndex:16})},t.prototype.meta=function(){return(0,a.__assign)((0,a.__assign)({},e.prototype.meta.call(this)),{backgroundColor:"rgba(30, 111, 255, 0.3)",priority:nr.selectionOverlay,isTextSelection:!0})},t}(ir),sr=function(e){function t(t,n){void 0===n&&(n=0);var r=e.call(this,0,t,n)||this;return r.width=t,r.height=n,r}return(0,a.__extends)(t,e),t.prototype.style=function(){return(0,a.__assign)((0,a.__assign)({},e.prototype.style.call(this)),{position:"absolute",top:"0",backgroundColor:"#1E6FFF",opacity:.16,zIndex:12})},t.prototype.meta=function(){return(0,a.__assign)((0,a.__assign)({},e.prototype.meta.call(this)),{backgroundColor:"rgba(30, 111, 255, 0.16)",priority:nr.selectionCellOverlay})},t}(ar),cr=function(e){function t(t,n,r,o){var i=e.call(this,t,n,void 0,o)||this;return i.left=t,i.width=n,i.color=r,i.top=o,i}return(0,a.__extends)(t,e),t.prototype.meta=function(){return(0,a.__assign)((0,a.__assign)({},e.prototype.meta.call(this)),{heightType:$n.Source,backgroundColor:this.color,priority:nr.backgroundColorOverlay})},t}(ir),lr=n(87363),ur=n.n(lr),dr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.style,n=e.classNames;return ur().createElement("div",{className:n,style:(0,a.__assign)((0,a.__assign)({},t.style()),{pointerEvents:"none"})})},t}(ur().Component),pr=function(){function e(){}return Object.defineProperty(e.prototype,"zoom",{get:function(){var e,t;return null!==(t=null===(e=this.zoomProvider)||void 0===e?void 0:e.zoom)&&void 0!==t?t:1},enumerable:!1,configurable:!0}),e.prototype.setZoomProvider=function(e){this.zoomProvider=e},e.prototype.setCallback=function(e){this.callback=e},e.prototype.notifyUpdate=function(e){return!!this.callback&&this.callback(e)},e.prototype.onCoreSelectionChagne=function(e){},e.prototype.afterDocumentRender=function(){},e.prototype.getClassName=function(){},e.prototype.getViewRangeFromGcpRange=function(e){return null},e.prototype.createLineOverlayStyle=function(e,t,n,r){return new ir(e,t,n,r)},e.prototype.renderOverlay=function(e,t){var n=this,r=this.checkOverlay(e);return 0===r.length?null:1===r.length?ur().createElement(dr,{key:t,classNames:this.getClassName(),style:r[0]}):ur().createElement("div",{key:t},r.map((function(e,t){return ur().createElement(dr,{key:t,classNames:n.getClassName(),style:e})})))},e.prototype.checkOverlay=function(e){var t=this,n=[],r=this.getRanges();if(r.length>0){var o=e.getRange();this.searchIntersectRange(o,r,(function(r){var i=e.rect,a=i.width,s=i.height,c=t.styleFromRange(r,o.begin(),o.end(),a,s);c&&n.push(c)}))}return n},e.prototype.styleFromRange=function(e,t,n,r,o,i,a){var s,c,l,u,d,p,h;void 0===o&&(o=0),void 0===i&&(i=0),void 0===a&&(a=!1);var f=this.getViewRangeFromGcpRange(e);if(!f)return null;var g=null===(s=null==f?void 0:f.start)||void 0===s?void 0:s.leafBox;if(a&&(0,Fe.tq)(g)&&(null==g?void 0:g.content)){var v=g.content,y=e.begin()-v.getRangeBegin(),m=y+e.length(),b=He.dp.getDefaultEngine().measureChar(v.text,v.textStyle,0,y).width,_=He.dp.getDefaultEngine().measureChar(v.text,v.textStyle,y,m).width,C=g.borderBoxSize.width,S=(f.start.linePosOffset(this.zoom,a)||0)-C+g.edge.left+b;return this.createLineOverlayStyle(S,_,o)}var w=new Le.ICE(t,n-t),E=this.getViewRangeFromGcpRange(w),x=null!==(u=null===(l=null===(c=null==E?void 0:E.start.lineBox)||void 0===c?void 0:c.edge)||void 0===l?void 0:l.left)&&void 0!==u?u:0,T=0;return e.begin()<t&&e.end()>n?T=r:e.begin()>=t&&e.end()<=n?(x=f.start.linePosOffset(this.zoom,a),T=(m=(m=f.end.linePosOffset(this.zoom,a))>0?m:r)-x):e.begin()<t&&e.end()>t?T=f.end.linePosOffset()-x:e.begin()<n&&e.end()>n&&(T=r+i-(x=f.start.linePosOffset())+(null!==(h=null===(p=null===(d=null==E?void 0:E.start.lineBox)||void 0===d?void 0:d.edge)||void 0===p?void 0:p.left)&&void 0!==h?h:0)),this.createLineOverlayStyle(x,T,o)},e.prototype.renderParaOverlay=function(e,t){var n=this,r=this.checkParaOverlay(e);return 0===r.length?null:1===r.length?ur().createElement(dr,{key:t,classNames:this.getClassName(),style:r[0]}):ur().createElement("div",{key:t,style:{position:"absolute",left:"0",top:"0"}},r.map((function(e){return ur().createElement(dr,{key:Math.random(),classNames:n.getClassName(),style:e})})))},e.prototype.checkParaOverlay=function(e){var t=this,n=[],r=this.getRanges();if(r.length>0){var o=e.getRange();this.searchIntersectRange(o,r,(function(r){var i=t.getParaOverlayStyle(e,o,r);i&&n.push.apply(n,(0,a.__spreadArray)([],(0,a.__read)(i),!1))}))}return n},e.prototype.getParaOverlayStyle=function(e,t,n,r){var o,i,a;if(void 0===r&&(r=!1),0===e.children.length)return[];var c=this.getViewRangeFromGcpRange(n),l=null===(o=e.__node__)||void 0===o?void 0:o.getBoundingClientRect();if(!c||!l)return[];var u=c.start,d=c.end;if(!t.intersect(new Le.ICE(u.gcp,d.gcp-u.gcp)))return[];function p(e,t){var n;return(0,Fe.k4)(e.__vm__)&&((n=Ve.$w.getPointRangeRect(e.firstChild,t)).x||n.y||n.width||n.height)||(n=e.getBoundingClientRect(),t>0&&(n=Ve.$w.createDOMRect(n.right,n.y,0,n.height))),n}!function(){if(u.gcp<t.begin()&&(u=new Qe(e.children[0],0,t.begin())),d.gcp>=t.end()&&d.leafBox!==e.lastChild){var n=e.lastChild;d=new Qe(n,n.text.length,t.end())}}();var h,f,g=u.getLeafDom(r),v=d.getLeafDom(r);if(!g||!v)return[];try{h=p(g,u.charsOffset),f=p(v,d.charsOffset)}catch(e){return[]}var y=[];if(d.paraPosOffset(this.zoom),function(e){var t,n,r=!1,o=v.getBoundingClientRect();if(u.leafBox===d.leafBox)r=h.top!==f.top;else if(o.top!==f.top)r=!0;else{var i=null===(t=u.paraPosOffset(e))||void 0===t?void 0:t.y,a=null===(n=d.paraPosOffset(e))||void 0===n?void 0:n.y;r=void 0!==i&&void 0!==a&&Math.abs(i-a)>.001}return r}(this.zoom)){u.paraPosOffset(this.zoom),function(){if(g!==v&&Ve.$w.isTextNode(g.firstChild)&&g.firstChild.length===u.charsOffset)return!!(0,Fe.Hg)(u.leafBox.nextSibling);if(h.top!==f.top&&Ve.$w.isTextNode(g.firstChild)&&g.firstChild.length>u.charsOffset){var e=document.createRange();e.setStart(g.firstChild,u.charsOffset),e.setEnd(g.firstChild,u.charsOffset+1);var t=e.getBoundingClientRect();if(h.top<t.top)return!1}return!0}()&&y.push(this.createLineOverlayStyle((0,s.pxToTwips)((h.left-l.left)/this.zoom),(0,s.pxToTwips)((l.right-h.left)/this.zoom),(0,s.pxToTwips)(u.lineHeight),(0,s.pxToTwips)(u.paraOffsetTop)));var m=parseFloat((null===(a=null===(i=e.__node__)||void 0===i?void 0:i.style)||void 0===a?void 0:a.paddingLeft)||"")||0,b=d.paraOffsetTop-(u.paraOffsetTop+u.lineHeight);b>1&&y.push(this.createLineOverlayStyle((0,s.pxToTwips)(m/this.zoom),(0,s.pxToTwips)((l.width-m)/this.zoom),(0,s.pxToTwips)(b),(0,s.pxToTwips)(u.paraOffsetTop+u.lineHeight)));var _=0;Math.abs(b)<=1&&(_=b),y.push(this.createLineOverlayStyle((0,s.pxToTwips)(m/this.zoom),(0,s.pxToTwips)((f.left-l.left-m)/this.zoom),(0,s.pxToTwips)(d.lineHeight+_),(0,s.pxToTwips)(d.paraOffsetTop-_)))}else y.push(this.createLineOverlayStyle((0,s.pxToTwips)((h.left-l.left)/this.zoom),(0,s.pxToTwips)((f.left-h.left)/this.zoom),(0,s.pxToTwips)(d.lineHeight),(0,s.pxToTwips)(d.paraOffsetTop)));return y},e.prototype.searchIntersectRange=function(e,t,n){var r,o;try{for(var i=(0,a.__values)(t),s=i.next();!s.done;s=i.next()){var c=s.value;e.intersect(c)&&n(c)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}},e}(),hr=["code-editor","code-editor core-blank"],fr=function(e){function t(t,n,r,o,i){var a=e.call(this)||this;return a.context=t,a.state=n,a.layoutController=r,a.renderState=o,a.containerFocus=i,a.gcpRange=Le.ICE.emptyRange(),a.isCommentStateUpdated=!1,a.notifyDelay=!1,a.isPrevViewRangeCaret=!0,a.viewSelection=new ut,a.finder=Un(t.docEnv.renderType,n,r,i,{domPosToBoxPos:function(e){return e/a.zoom},scrollerInfo:rt(o),scrollerBox:ot},o),a.mouseSelector=new Gn(a.finder,o,t),a.touchSelector=new Vn(a.finder,o),a.currentSelector=a.mouseSelector,a.listenChange(),a.context.on(Te.UPDATE_COMMENT_STATE,(function(e){var t=e.status;a.isCommentStateUpdated=t})),a}return(0,a.__extends)(t,e),Object.defineProperty(t.prototype,"tableStream",{get:function(){return this.state.getTableStream()},enumerable:!1,configurable:!0}),t.prototype.getRanges=function(){var e;return(null===(e=this.state.selection.tableSelectionArea)||void 0===e?void 0:e.isInnerTable())?this.state.selection.gcpRanges:this.gcpRange.len?[this.gcpRange]:[]},t.prototype.reset=function(){this.gcpRange=Le.ICE.emptyRange(),this.viewRange=void 0,this.viewSelection.removeAll(),this.isPrevViewRangeCaret=!0},t.prototype.getRangeFinder=function(){return this.finder},t.prototype.onLayoutChanged=function(){var e,t=this.containerFocus.getContext(),n=this.state.selection,r=n.gcpRange,o=n.backWard;this.gcpRange=r,this.updateFromCoreRange(r,{scrollToView:Wn.hF.None,forceFocus:!1,mobileSelectionDrag:Wn.p2.Keep,mobileContextMenu:Wn.A6.Keep}),this.updateSelector(o),this.notifyDelay=!0;var i=!1===t.docEnv.editable&&0===this.gcpRange.len,a=hr.includes((null===(e=null===document||void 0===document?void 0:document.activeElement)||void 0===e?void 0:e.className)||"");!this.viewRange||a||this.isCommentStateUpdated||i||this.context.fire(new y(this.viewRange),!1),this.notifyDelay&&this.afterDocumentRender()},t.prototype.getClassName=function(){return"melo-selection-overlay"},t.prototype.onCoreSelectionChagne=function(e){var t,n,r,o,i,a;if((null===(t=e.option)||void 0===t?void 0:t.noSendCaret)!==(null===(n=this.notifySelectionOption)||void 0===n?void 0:n.noSendCaret)&&!(null===(r=e.option)||void 0===r?void 0:r.noSendCaret)){var s=gt(this.layoutController,this.processToCellContent(e.range),this.renderState,this.pageIndex);s&&this.notifySelection(s,e.option)}if(this.notifySelectionOption=e.option,this.viewRange&&e.range.equal(this.gcpRange)&&this.viewRange.isValid()||this.currentSelector.isMoving)return this.notifySelectionOption=e.option,void((null===(o=this.notifySelectionOption)||void 0===o?void 0:o.forceNotify)&&(this.notifyDelay=!0));if(!(null===(i=e.option)||void 0===i?void 0:i.afterApplyDelta)){this.updateFromCoreRange(e.range,e.option);var c=!!(null===(a=e.option)||void 0===a?void 0:a.backward)&&e.option.backward;this.updateSelector(c),this.notifyDelay=!0}},t.prototype.listenChange=function(){var e=this,t=function(t,n){if(e.currentSelector=t,e.updateSelection(t.getSelection(),t.forceFocus,t.listInfo,n),t.listInfo){var r=t.listInfo,o=r.gcp,i=r.listFmt,a=r.paraId;s.Logger.log("[task item click] , ",o,i,a,t.listInfo),e.context.fire(new m(t.listInfo))}};this.mouseSelector.selectionCallback=t,this.touchSelector.selectionCallback=t},t.prototype.updateSelection=function(e,t,n,r){if(e&&(!e.viewRange.equals(this.viewRange)||this.selectListChanged(n,r))){this.updatePageNum(e.viewRange);var o=this.getGCPRange(e.viewRange),i=this.fixToPageBreakRange(e,o),s={backward:e.backward,forceFocus:t,noSendCaret:!0};this.state.setRangeTo(o,(0,a.__assign)({},s)),s.noSendCaret=!1;var c=this.state.selection.gcpRange;return!c.equal(e.viewRange.getGCPRange())||i?this.updateFromCoreRange(c,s):this.updateRange(e.viewRange,c,s),c.equal(this.gcpRange)?this.notifySelection(this.viewRange,s):(this.notifyDelay=!0,this.notifySelectionOption=s),!0}return!1},t.prototype.selectListChanged=function(e,t){return(e&&!this.context.state.listMarkerSpanProp||!e&&this.context.state.listMarkerSpanProp)&&t===Nn.MOUSE_DOWN},t.prototype.getGCPRange=function(e){var t=this.tableStream.getCellInfo(e.start.gcp),n=this.tableStream.getCellInfo(e.end.gcp);if(t&&n&&t.range.intersect(n.range))return e.getGCPRange();var r=e.getGCPRange();return t&&(r=r.unionRange(t.range)),n&&(r=r.unionRange(n.range)),r},t.prototype.fixToPageBreakRange=function(e,t){var n=e.viewRange.start;return!!((0,Fe.NF)(n.leafBox)&&n.leafBox.text&&n.leafBox.text.endsWith(Le.IfD.PageBreak)&&n.charsOffset===n.leafBox.text.length)&&(t.gcpBegin-=1,!0)},t.prototype.updatePageNum=function(e){if(e.start instanceof ct){var t=e.start.leafBox.getAncestorOf(Fe.uO.Page);t&&(this.pageIndex=t.getSiblingIndex())}},t.prototype.updatePageIndexByCount=function(e){this.pageIndex=e},t.prototype.updateFromCoreRange=function(e,t){var n=gt(this.layoutController,this.processToCellContent(e),this.renderState,this.pageIndex);n&&this.updateRange(n,e,t)},t.prototype.updateRange=function(e,t,n){var r,o;this.isPrevViewRangeCaret=null===(o=null===(r=this.viewRange)||void 0===r?void 0:r.isCaret())||void 0===o||o,this.viewRange=e,this.gcpRange=t;var i=!!(null==n?void 0:n.backward)&&n.backward,s=(0,a.__read)(i?[e.end,e.start]:[e.start,e.end],2),c=s[0],l=s[1];this.viewSelection.setBaseAndExtent(c,l)},t.prototype.notifySelection=function(e,t){console.log("############### --- selection changed"),this.context.fire(new g(e,this.zoom,t)),this.context.fire(new y(e,t),!1),this.notifySelectionEnd(e,t),this.notifyDelay=!1,this.notifySelectionOption=void 0},t.prototype.notifySelectionEnd=function(e,t){var n=this;this.notifyEndTaskId&&window.clearTimeout(this.notifyEndTaskId),this.notifyEndTaskId=window.setTimeout((function(){n.currentSelector.isMoving?n.notifySelectionEnd(e,t):n.context.fire(new v(e,t))}),200)},t.prototype.updateSelector=function(e){this.viewRange&&(this.mouseSelector.updateRange(this.viewRange,e),this.touchSelector.updateRange(this.viewRange,e))},t.prototype.afterDocumentRender=function(){this.viewRange&&this.notifyDelay&&(this.notifySelectionOption||(this.notifySelectionOption={scrollToView:Wn.hF.None,forceFocus:!1,mobileSelectionDrag:Wn.p2.Keep,mobileContextMenu:Wn.A6.Keep}),!this.isPrevViewRangeCaret&&this.viewRange.isCaret()&&(this.notifySelectionOption.noSendCaret=!1),this.notifySelection(this.viewRange,this.notifySelectionOption))},t.prototype.checkOverlay=function(e){if(!this.viewRange||this.viewRange.isCaret()||!this.containerFocus.selectionSwitchOn()||e.isZero())return[];if(this.checkInCell(e))return[];var t=this.viewRange,n=t.start,r=t.end,o=this.gcpRange.begin(),i=this.gcpRange.end(),a=e.getRangeBegin(),s=e.getRangeEnd()-1,c=e.edge,l=e.rect.width,u=e.totalHeight,d=c.border.width.left+c.padding.left,p=d,h=0;if(c.recycle(),o>s||i<=a)return[];if(o>=a){n.clearCache();var f=n.linePosOffset();if(n.leafBox.hidden&&n.leafBox.nextSibling&&(f=new ct(n.leafBox.nextSibling,0,n.gcp+1,0).linePosOffset()),(o>a||f>0)&&(p=f),(0,Fe.o7)(e)&&p>=l+d)return[];r.clearCache(),h=i<=s?r.linePosOffset(this.zoom)-p:l+d-p}else i<=s?(r.clearCache(),h=r.linePosOffset(this.zoom)-p):h=l;return h>0?[new ar(p,h,u)]:[]},t.prototype.checkCellOverlay=function(e){var t,n=this.state.selection.tableSelectionArea;if(!n)return null;var r=e,o=e,i=0,a=0;if((0,Fe.$5)(e)){for(;r.prevPartial;)r=r.prevPartial;if(e.isNormal())for(;o.nextPartial&&0!==o.nextPartial.children.length;)o=o.nextPartial;else o=r;var c=null===(t=e.children)||void 0===t?void 0:t[0],l=null==c?void 0:c.borderBoxSize;i=l&&Math.ceil(l.width)||0,a=l&&Math.ceil(l.height)||0}else{if(!e.__node__)return null;var u=e.__node__.getBoundingClientRect();i=(0,s.pxToTwips)(u.width),a=(0,s.pxToTwips)(u.height)}var d=r.getRangeBegin(),p=o.getRangeEnd(),h=-1===p?0:p-d,f=new Le.ICE(d,h);return n.isContainRange(f)&&this.checkMatchNestingLevel(e.nestingLevel,n)?new sr(i,a):null},t.prototype.checkMatchNestingLevel=function(e,t){return t.isInnerCell()?e-1===t.nestingLevel:e===t.nestingLevel},t.prototype.checkCellRange=function(e,t){if(1===e.length)return(0,a.__read)(e,1)[0].equal(t);if(e.length>1){var n=Math.round(e.length/2),r=e[n];return!!r.equal(t)||(r.begin()>t.begin()?this.checkCellRange(e.slice(0,n),t):this.checkCellRange(e.slice(n+1,e.length),t))}return!1},t.prototype.checkIfTable=function(e,t){var n=e.getRangeBegin(),r=this.tableStream.getTableInfo(n),o=null!=t?t:this.gcpRange.begin();return!!(null==r?void 0:r.range.contains(o))},t.prototype.checkInCell=function(e){var t=this.state.selection.tableSelectionArea;if(!t)return!1;if(t.isInnerTable())return!0;var n=e.getRange(),r=t.nestingLevel+(t.isInnerCell()?1:0),o=this.tableStream.getTableInfo(n.gcpBegin,r);return!!o&&o.range.contains(n)},t.prototype.processToCellContent=function(e){var t=this.state.selection.tableSelectionArea;if(e.isEmpty()||!t||t.isInnerCell())return e;var n=this.trimToCellLeaf(e.begin(),1,e),r=this.trimToCellLeaf(e.end()-1,-1,e)+1;return new Le.ICE(n,r-n)},t.prototype.trimToCellLeaf=function(e,t,n){return(0,Le.Jmy)(this.state.getTextStream(),this.trimContinueCell(e,t,n),[Le.IfD.TableStart,Le.IfD.TableEnd,Le.IfD.TableRowBreak,Le.IfD.TableCellBreak],t)},t.prototype.trimContinueCell=function(e,t,n){var r=e;if(!this.tableStream.getTableInfo(e))return e;for(;r>=n.begin()&&r<n.end();){var o=this.tableStream.getCellInfo(r);if(o){if(o.property.vMerge!==Le.m7Q.continue)return r;r+=t*o.range.len}else r+=t}return e},t.prototype.checkParaOverlay=function(e){if(!this.viewRange||this.viewRange.isCaret()||!this.containerFocus.selectionSwitchOn())return[];var t=e.getRange();return this.getParaOverlayStyle(e,t,this.gcpRange)},t.prototype.getViewRangeFromGcpRange=function(e){return this.viewRange||null},t.prototype.createLineOverlayStyle=function(e,t,n,r){return new ar(e,t,n,r)},t.prototype.clearCache=function(){var e,t,n,r;null===(e=this.viewRange)||void 0===e||e.start.clearCache(),null===(t=this.viewRange)||void 0===t||t.end.clearCache(),null===(n=this.viewSelection.archorPoint)||void 0===n||n.clearCache(),null===(r=this.viewSelection.forcusPoint)||void 0===r||r.clearCache()},t}(pr),gr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.getRanges=function(){return[]},t.prototype.reset=function(){},t.prototype.checkOverlay=function(e){var t=this,n=[],r=e.edge,o=r.border.width.left+r.padding.left;return r.recycle(),e.children.forEach((function(e){var r=e.totalWidth,i=(0,Fe.tq)(e)?e.content:e,a=(0,Fe.NF)(i)?i.textStyle:i.rawRunProperty;if(t.shouldProcessOverlay(i)&&a){var s=Le.QBv.parseTextBackgroundColor(a.highlight,a.shd);if(s){var c=n.pop();if(c&&Math.round(c.left+c.width)===Math.round(o)&&c.color===s){var l=new cr(c.left,c.width+r,s);n.push(l)}else c&&n.push(c),l=new cr(o,r,s),n.push(l)}}o+=r})),n},t.prototype.shouldProcessOverlay=function(e){return!(!(0,Fe.Dy)(e)||e instanceof Ue.w8||(0,Fe.NF)(e)&&e.hangingGlue)},t.prototype.onLayoutChanged=function(){},t}(pr),vr=function(){function e(){this.scrollContainerHandlers=[]}return e.prototype.addScrollContainerHandler=function(e){this.scrollContainerHandlers.push(e)},e.prototype.scrollByIfNeed=function(e,t,n){for(var r=0;r<this.scrollContainerHandlers.length;r++)if(this.scrollContainerHandlers[r].scrollByIfNeed(e,t,n))return!0;return!1},e}(),yr=function(){function e(e,t,n,r,o){this.zoom=n,this.scrollContainerGetFunc=r,this.scrollConfig=o,this.context=e,this.state=t,o||(this.scrollConfig={feet:60,marginX:30,marginY:30})}return e.prototype.scrollByIfNeed=function(e,t,n){var r=this.getScrollContainer(n);if(r){var o=this.calcScrollPositionIfNeed(e,t,r),i=o.scrollX,a=o.scrollY;if(0!==i||0!==a)return this.scrollBy(i,a,r),!0}return!1},e.prototype.scrollBy=function(e,t,n){if(n)if(n.scrollBy)n.scrollBy(e,t);else{var r=n.scrollLeft+e,o=n.scrollTop+t;this.scrollTo(r,o,n)}},e.prototype.scrollTo=function(e,t,n){n&&(n.scrollTo?n.scrollTo(e,t):(n.scrollLeft=e,n.scrollTop=t))},e.prototype.getScrollContainer=function(e){var t=e.leafBox;return t?this.scrollContainerGetFunc(t):null},e.prototype.getScrollContainerSize=function(e){var t=e.getBoundingClientRect();return{left:t.left,top:t.top,right:t.right,bottom:t.bottom}},e.prototype.calcScrollPositionIfNeed=function(e,t,n){var r=this.getScrollContainerSize(n),o=r.left,i=r.top,a=r.right,s=r.bottom,c=this.scrollConfig.feet,l=this.scrollConfig.marginX,u=this.scrollConfig.marginY,d=0;e-l<o?d=-c:e+l>a&&(d=c);var p=0;return t-u<i?p=-c:t+u>s&&(p=c),{scrollX:d,scrollY:p}},e}();!function(e){e.client="clientPosition",e.scroll="scrollPosition"}(rr||(rr={})),function(e){e.top="top",e.bottom="bottom",e.left="left",e.right="right"}(or||(or={}));var mr,br=function(){function e(e,t,n,o,c){var l=this;this.zoom=o,this.rangeFinder=c,this.scrollRoot=null,this.disableScrollOnSelectionChange=!1,this.keyboardHeight=-1,this.keyboardHeightFromSDK=-1,this.nativeToolbarHeightPx=-1,this.titlebarHeightFromSDK=-1,this.coveredPanel={height:-1,withToolbar:!0},this.isEditable=function(){return!0},this.intervalId=0,this.mobileTopMarginExtra=0,this.scrollContainerManager=new vr,this.defaultMarginX=30,this.defaultMarginY=10,this.extraMarginX=0,this.scrollByIfNeedThrottle=(0,s.throttle)((function(e,t,n){l.scrollContainerManager.scrollByIfNeed(e,t,n)||l.scrollByIfNeed(e,t)}),20),this.stopScroll=function(){var e=function(){document.body.removeEventListener("touchmove",l.preventDefault)};return e(),document.body.addEventListener("touchmove",l.preventDefault,{passive:!1}),e},this.preventDefault=function(e){e.preventDefault(),s.Logger.info("touchmove preventDefault by scroll animate")},this.context=e,this.state=t,this.layoutController=n,this.onKeyBoardHeightNotifyListener=this.onKeyBoardHeightNotify.bind(this),this.context.on(r.SELECTION_CHANGE,(function(e){l.onSelectionChanged(e)}),this),this.context.on(i.ON_REQUEST_FOCUS,(function(e){e.viewRange&&l.checkViewRange(e.viewRange.end)})),this.context.on(r.UPDATE_KEYBOARD_HEIGHT,(function(e){l.keyboardHeight=e.keyboardHeight,l.keyboardHeight>0&&l.viewRange&&l.checkViewRange(l.viewRange.end)}),this),this.context.on(r.UPDATE_COVERED_PANEL,(function(e){var t,n;l.coveredPanel=(0,a.__assign)({},e.coverState),l.viewRange&&l.checkViewRange(l.viewRange.end,null===(t=l.coveredPanel)||void 0===t?void 0:t.anchorPointX,null===(n=l.coveredPanel)||void 0===n?void 0:n.anchorPointY)}),this),this.renderType=this.context.docEnv.renderType}return e.prototype.attach=function(){document.addEventListener("onNativeKeyboardHeightNotify",this.onKeyBoardHeightNotifyListener)},e.prototype.detach=function(){document.removeEventListener("onNativeKeyboardHeightNotify",this.onKeyBoardHeightNotifyListener)},e.prototype.setExtraMarginX=function(e){this.extraMarginX=e},e.prototype.restoreExtraMarginX=function(){this.extraMarginX=0},e.prototype.addScrollContainer=function(e,t){var n=new yr(this.context,this.state,this.zoom,e,t);this.scrollContainerManager.addScrollContainerHandler(n)},e.prototype.setIsEditable=function(e){this.isEditable=e},e.prototype.setScrollRoot=function(e){this.scrollRoot=e},e.prototype.getScrollRoot=function(){return this.scrollRoot},e.prototype.addScrollListener=function(e){this.scrollRoot&&this.scrollRoot.addEventListener("scroll",e)},e.prototype.removeScrollListener=function(e){this.scrollRoot&&this.scrollRoot.removeEventListener("scroll",e)},e.prototype.onKeyBoardHeightNotify=function(e){this.keyboardHeightFromSDK=e.detail.nativeKeyboardHeightPx,this.nativeToolbarHeightPx=e.detail.nativeToolbarHeightPx,this.titlebarHeightFromSDK=e.detail.nativeTitlebarHeightPx},e.prototype.setMobileTopMarginExtra=function(e){this.mobileTopMarginExtra=e},e.prototype.scrollBySelection=function(e,t){var n,r,o,i=e.start.getDocumentOffset(this.zoom()),a=t.start.getDocumentOffset(this.zoom()),c=t.end.getDocumentOffset(this.zoom()),l=null!==(r=null===(n=this.getScrollRoot())||void 0===n?void 0:n.getBoundingClientRect().height)&&void 0!==r?r:0,u=(0,s.supportNativeTitleBar)("doc");o=(u?i.y+l-44:i.y+l)-20<a.y?i.y+(c.y-l-i.y)+t.start.lineHeight:i.y,u&&(o-=44),this.scrollTo(0,o)},e.prototype.onScrollPartRendered=function(e,t){this.waitForRender&&(this.viewRange.start.clearCache(),this.scrollToViewRangeTop(e,t),this.waitForRender=!1)},e.prototype.scrollToViewRangeTop=function(e,t){var n,r=e.start.getSurfaceOffset(this.zoom()),o=r.x,i=r.y;return n=null!=t?t:0,o*=this.zoom(),i*=this.zoom(),this.scrollToTop(o,i-n)},e.prototype.scrollToViewCenter=function(e,t){return void 0===t&&(t=!1),this.scrollToCustomPositionIfNeed(2,e,t)},e.prototype.scrollToViewNearTop=function(e,t){return void 0===t&&(t=!1),this.scrollToCustomPositionIfNeed(5,e,t)},e.prototype.onSelectionChanged=function(e){var t;if(this.shouldScrollFromSelectionChange(e)){this.viewRange=e.viewRange;var n=e.option,r=void 0===n?{}:n,o=r.scrollToView;if(o!==Wn.hF.None){if(o&&e.viewRange.start){if(!e.viewRange.start.leafBox.__node__&&this.context.docEnv.renderType===Le.y2q.Lite)return this.waitForRender=!0,void this.context.fire(new le(e.viewRange));if(o===Wn.hF.Top)return void this.scrollToViewRangeTop(e.viewRange,r.headerViewHeight);if(o===Wn.hF.Center)return void this.scrollToViewCenter(e.viewRange);if(o===Wn.hF.NearTop)return void this.scrollToViewNearTop(e.viewRange)}var i;(i=(null===(t=null==e?void 0:e.option)||void 0===t?void 0:t.backward)?e.viewRange.start:e.viewRange.end)&&this.checkViewRange(i)}}},e.prototype.checkViewRange=function(e,t,n){var r;if(clearTimeout(this.checkViewRangeTimer),(e.lineBox||this.renderType===Le.y2q.Lite)&&e.documentBox&&e.leafBox){var o=e.caretHeight(),i=e.getSurfaceOffset(this.zoom()),s=i.x,c=i.y;s*=this.zoom(),c*=this.zoom(),void 0!==t&&void 0!==n&&(s=(r=(0,a.__read)([t,n+this.getMobileTopMargin()],2))[0],c=r[1]),this.scrollToIfNeed(s,c,o)}},e.prototype.scrollByIfNeed=function(e,t){if(this.scrollRoot){var n=this.getScrollRootSize(),r=n.left,o=n.top,i=n.right,a=n.bottom,s=0;e-10<r?s=-60:e+10>i&&(s=60);var c=0;t-10<o?c=-60:t+10>a&&(c=60),0===s&&0===c||this.scrollBy(s,c)}},e.prototype.getTouchEdgeJudgeInfoMobile=function(e){if(!this.scrollRoot)return null;var t=e.x,n=e.y,r=e.type,o=e.xOffset,i=void 0===o?15:o,a=e.yOffset,s=void 0===a?15:a,c="scrollPosition"===r?t-this.scrollRoot.scrollLeft:t,l="scrollPosition"===r?n-this.scrollRoot.scrollTop:n,u=this.getScrollRootSize(),d=u.left,p=u.top,h=u.right,f=u.bottom,g=null;c-i<d?g=or.left:c+i>h&&(g=or.right);var v=null;return l-s-this.getMobileTopMargin()<p?v=or.top:l+s+this.getMobileBottomMargin()>f&&(v=or.bottom),v||g?{verticalEdge:v,horizontalEdge:g}:null},e.prototype.scrollBy=function(e,t,n){if(void 0===n&&(n="auto"),this.scrollRoot)if(this.scrollRoot.scrollBy)this.scrollRoot.scrollBy({left:e,top:t,behavior:n});else{var r=this.getScrollLeft()+e,o=this.getScrollTop()+t;this.scrollTo(r,o)}},e.prototype.scrollToCustomPositionIfNeed=function(e,t,n){var r=this;this.context.fire(new le(t),!1);var o=t.end.getDocumentOffset(),i=o.x,a=o.y;if(i*=this.zoom(),a*=this.zoom(),!this.scrollRoot)return!1;var s=this.scrollRoot.offsetHeight||this.scrollRoot.clientHeight,c=this.getScrollTop();return!(c<a&&a<c+s)&&new Promise((function(t){return r.scrollTo(i,a-s/e,n,"auto",(function(e){return t(e)}))}))},e.prototype.scrollToByAnimal=function(e,t,n,r,o){var i=this;if(void 0===r&&(r=16),void 0===o&&(o=200),this.scrollRoot){var a=this.scrollRoot.scrollTop,s=t>a,c=Math.abs(t-a);c>o&&(r*=c/o),clearInterval(this.intervalId);var l=this.stopScroll(),u=(new Date).getTime();this.intervalId=setInterval((function(){if(i.scrollRoot){var e=s?Math.min(t,i.scrollRoot.scrollTop+r):Math.max(t,i.scrollRoot.scrollTop-r),o=i.scrollRoot.scrollTop;i.scrollRoot.scrollTop=e;var a=(new Date).getTime()-u>200;(a||e===t||i.scrollRoot.scrollTop===o)&&(l(),clearInterval(i.intervalId),a&&(i.scrollRoot.scrollTop=t),null==n||n(!0)),u=(new Date).getTime()}}),16)}else null==n||n(!1)},e.prototype.scrollToIfNeed=function(e,t,n,r){if(void 0===r&&(r=!1),this.scrollRoot){var o=this.getScrollRootSize(),i=o.left,a=o.top,s=o.right-i,c=o.bottom-a-n,l=this.defaultMarginX,u=this.defaultMarginY,d=this.scrollRoot.scrollLeft,p=this.scrollRoot.scrollTop,h=d;e<d?h=Math.max(e-l,0):e>d+s&&(h=e-s+l);var f=p;t<p?f=Math.max(t-u,0):t>p+c&&(f=t-c+u),h===d&&f===p||this.scrollTo(h,f,r)}},e.prototype.scrollToIfNeedMobile=function(e,t,n,r){if(void 0===r&&(r=!1),this.scrollRoot&&(0!==e||0!==t)){var o=window.orientation,i=0===o||180===o,a=window.innerHeight,c=this.getMobileTopMargin(),l=this.getScrollRootSize(),u=l.left,d=l.top,p=l.right-u,h=l.bottom-d-n-c-this.getMobileBottomMargin();/(uiwebview)/i.test(navigator.userAgent)&&h>a&&(h=a-n-c);var f=this.defaultMarginX,g=this.defaultMarginY,v=this.scrollRoot.scrollLeft,y=this.scrollRoot.scrollTop,m=v;e<v?m=Math.max(e-f,0):e>v+p&&(m=e-p+f);var b=y;t<y+c?b=Math.max(t-c,0):t>y+c+h&&(b=t-h+g),!i&&s.PlatformUtil.isWXorQQMiniProgram()&&(b=Math.max(t-5,0)),m===v&&b===y||this.scrollTo(m,b,r)}},e.prototype.scrollTo=function(e,t,n,r,o){if(void 0===n&&(n=!1),void 0===r&&(r="auto"),this.scrollRoot){var i=!1;n?(this.scrollToByAnimal(e,t,o),i=!0):this.scrollRoot.scrollTo?this.scrollRoot.scrollTo({left:e,top:t,behavior:r}):(this.scrollRoot.scrollLeft=e,this.scrollRoot.scrollTop=t),!i&&(null==o||o(!0))}else null==o||o(!1)},e.prototype.scrollToTop=function(e,t){var n=this;if(!this.scrollRoot)return!1;var r=this.defaultMarginX+this.extraMarginX,o=this.defaultMarginY,i=e>r?e-r:0,a=t>o?t-o:0;return new Promise((function(e){return n.scrollTo(i,a,!1,"auto",(function(t){return e(t)}))}))},e.prototype.scrollToView=function(e){e&&this.onSelectionChanged(new g(e,this.zoom(),{scrollToView:Wn.hF.Near}))},e.prototype.getScrollRootSize=function(){var e=Ve.$w.getElementZoomValue(document.body);if(this.scrollRoot){var t=this.scrollRoot.getBoundingClientRect();return{left:t.left*e,top:t.top*e,right:t.right*e,bottom:t.bottom*e}}return{left:0,top:0,right:window.innerWidth*e,bottom:window.innerHeight*e}},e.prototype.getScrollTop=function(){return this.scrollRoot?this.scrollRoot.scrollTop:0},e.prototype.setScrollTop=function(e){this.scrollRoot&&(this.scrollRoot.scrollTop=e)},e.prototype.getScrollLeft=function(){return this.scrollRoot?this.scrollRoot.scrollLeft:0},e.prototype.getOffsetHeight=function(){return this.scrollRoot?this.scrollRoot.offsetHeight:window.innerHeight},e.prototype.getOffsetWidth=function(){return this.scrollRoot?this.scrollRoot.offsetWidth:window.innerWidth},e.prototype.getClientHeight=function(){return this.scrollRoot?this.scrollRoot.clientHeight:window.innerHeight},e.prototype.getClientWidth=function(){return this.scrollRoot?this.scrollRoot.clientWidth:window.innerWidth},e.prototype.isScrollBeforeTop=function(){return!!(this.scrollRoot&&this.scrollRoot.scrollTop<0)},e.prototype.isScrollAfterBottom=function(){return!!(this.scrollRoot&&this.scrollRoot.scrollTop+this.scrollRoot.clientHeight-this.scrollRoot.scrollHeight>2)},e.prototype.isScrollBeforeLeft=function(){return!!(this.scrollRoot&&this.scrollRoot.scrollLeft<0)},e.prototype.isScrollAfterRight=function(){return!!(this.scrollRoot&&this.scrollRoot.scrollLeft+this.scrollRoot.clientWidth-this.scrollRoot.scrollWidth>2)},e.prototype.isKickBack=function(){return!!(this.isScrollBeforeTop()||this.isScrollAfterBottom()||this.isScrollBeforeLeft()||this.isScrollAfterRight())},e.prototype.getScrollHeight=function(){return this.scrollRoot?this.scrollRoot.scrollHeight:window.innerHeight},e.prototype.enableScrollOnSelectionChanged=function(){this.disableScrollOnSelectionChange=!1},e.prototype.disableScrollOnSelectionChanged=function(){this.disableScrollOnSelectionChange=!0},e.prototype.disableMobileScroll=function(){},e.prototype.enableMobileScroll=function(){},e.prototype.getMobileTopMargin=function(){var e=this.mobileTopMarginExtra,t=0;return s.PlatformUtil.isWeWork()?e:((-1===this.keyboardHeight&&0===this.mobileTopMarginExtra||(0,s.supportNativeTitleBar)("doc"))&&(t=44),t+e)},e.prototype.getMobileBottomMargin=function(){var e=44;-1!==this.nativeToolbarHeightPx&&(e=this.nativeToolbarHeightPx);var t=0,n=0===window.orientation||180===window.orientation?window.innerHeight<screen.height-180:window.innerHeight<screen.width-180;return-1!==this.coveredPanel.height?(t=this.coveredPanel.height,this.coveredPanel.withToolbar&&(t+=e)):t=-1!==this.keyboardHeightFromSDK?n?0:this.keyboardHeightFromSDK+e:-1!==this.keyboardHeight?n?e:this.keyboardHeight+e:n||!this.context.isEditable()||this.isViewState()?0:window.innerHeight/2,t},e.prototype.getInSightRange=function(){var e=this.layoutController,t=this.state,n=e.getLayoutBox();if(!(n&&(0,Fe.gL)(n)&&this.scrollRoot&&t))return{startGCP:0,endGCP:0};var r=(0,a.__read)([0,0],2),o=r[0],i=r[1],c=this.getScrollTop(),l=this.getScrollTop()+window.innerHeight,u=new s.MeloPoint;if(this.context.docEnv.layoutType===Le.msV.Paged){u.y=(0,s.pxToTwips)(c);var d=(0,a.__read)(Ue.MM.getGrandsonByPoint(n,Fe.uO.Page,u),2),p=d[0],h=(d[1],p?Ue.MM.getPrevBox(p):null);o=p&&h?h.getRangeBegin():0,u.y=(0,s.pxToTwips)(l);var f=(0,a.__read)(Ue.MM.getGrandsonByPoint(n,Fe.uO.Page,u),2),g=f[0],v=(f[1],g?Ue.MM.getNextBox(g):null);i=g&&v?v.getRangeBegin():t.getTextStream().getLength()}else{c-=1e3,l+=1e3,u.y=(0,s.pxToTwips)(c),u.x=n.totalBoxSize.width/2;var y=(0,a.__read)(Ue.MM.getGrandsonByPoint(n,Fe.uO.Paragraph,u),2);p=y[0],y[1],o=p?p.getRangeBegin():0,u.y=(0,s.pxToTwips)(l);var m=(0,a.__read)(Ue.MM.getGrandsonByPoint(n,Fe.uO.Paragraph,u),2);g=m[0],m[1],i=g?g.getRangeBegin():t.getTextStream().getLength()}return{startGCP:o,endGCP:i}},e.prototype.getInSightStartBox=function(){var e=this.layoutController,t=this.state,n=e.getLayoutBox();if(!(n&&(0,Fe.gL)(n)&&this.scrollRoot&&t))return{startGCP:0};var r=0,o=this.getScrollTop();o/=this.zoom();var i=new s.MeloPoint;i.y=(0,s.pxToTwips)(o),i.x=n.totalBoxSize.width/2;var c,l,u=(0,a.__read)(Ue.MM.getGrandsonByPoint(n,Fe.uO.Paragraph,i),2),d=u[0],p=u[1],h=-1,f=-1;if(d){var g=0,v=d.children&&d.children[g];if(v){for(var y=v.rect.getBottom();i.y>y&&g<d.children.length;)y=(v=d.children[g]).rect.getBottom(),g+=1;h=(0,s.twipsToPx)(p.x),f=(0,s.twipsToPx)(p.y-v.rect.y),(0,Fe.NF)(v.firstChild)&&(l=v.firstChild.text),c=v}else c=d,f=o;r=d.getRangeBegin()}else r=0,f=o;return{startBox:d,startGCP:r,startBoxOffsetX:h,startBoxOffsetY:f,startSubBox:c,startText:l}},e.prototype.getInSightFirstStartBox=function(e){void 0===e&&(e=!1);var t=this.layoutController.getLayoutBox(),n={startGCP:-1};if(this.renderType===Le.y2q.Lite){var r=t.__node__;if(r){var o=r.clientWidth/2,i=20,c=this.rangeFinder.findViewPoint(o,i,r);if(c instanceof Qe)return{startGCP:c.gcp,startBox:c.leafBox}}}else{var l=this.getScrollTop()/this.zoom(),u=this.layoutController.getLayoutBox(),d=(o=(0,Fe.gL)(u)?u.totalBoxSize.width/2:0,i=(0,s.pxToTwips)(l)+20,this.context.getDocumentBox()),p=(0,a.__read)(this.getLeafBoxByPointY(d,{x:o,y:i}),1)[0];if(!p)return n;var h=Ue.MM.findParent(p,Fe.uO.HeaderFooter);if(!e||!h)return{startGCP:p.getRangeBegin(),startBox:p};var f=Ue.MM.getNextLineBox(h);if(f)return{startGCP:f.getRangeBegin(),startBox:f}}return n},e.prototype.getInSightLastEndBox=function(){var e=this.layoutController.getLayoutBox();if(this.renderType===Le.y2q.Lite){var t=e.__node__;if(t){var n=t.clientWidth/2,r=document.body.clientHeight-55;if((o=this.rangeFinder.findViewPoint(n,r,t))instanceof Qe)return{endGCP:o.gcp,endBox:o.leafBox}}}else{var o,i=this.getScrollTop()/this.zoom(),a=this.layoutController.getLayoutBox();if(n=(0,Fe.gL)(a)?a.totalBoxSize.width/2:0,r=(0,s.pxToTwips)(i)+55,(o=this.rangeFinder.findHitViewPoint(this.context.getDocumentBox(),{x:0,y:0},{x:n,y:r},!1,!1))instanceof ct)return{endGCP:o.gcp,endBox:o.leafBox}}return{endGCP:-1}},e.prototype.getLeafBoxByPointY=function(e,t,n){for(var r=t,o=e,i=function(e,t){return e.y>=t.y&&e.y<=t.getBottom()},s=0;;){var c=(0,a.__read)(o.getChildByPoint(r,i,n),2),l=c[0],u=c[1];if(!l||!u)return s>0?[o,r]:[];if(!(0,Fe.Eb)(l))return[l,u];o=l,r=u,s+=1}},e.prototype.scrollToRange=function(e,t,n){void 0===n&&(n=!1);var r=gt(this.layoutController,e);if(r){var o=r.start.getDocumentOffset(),i=o.x,a=o.y;return this.scrollTo(i,Math.max(0,a-t)),{x:i,y:a}}},e.prototype.isViewState=function(){return document.activeElement===document.body},e.prototype.shouldScrollFromSelectionChange=function(e){var t;return!(!(null==e?void 0:e.viewRange)||this.disableScrollOnSelectionChange&&!(null===(t=e.option)||void 0===t?void 0:t.scrollToView))},e}(),_r=10,Cr=10,Sr=100,wr=Sr+150,Er=function(){function e(){this.decorators=[]}return e.prototype.addDecorator=function(e){this.decorators.push(e)},e.prototype.removeDecorators=function(){this.decorators=[]},e}(),xr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.decorate=function(e,t){var n=e,r=new hn;return this.decorators.forEach((function(e){var o=e(n,t);n=o.component,r.setProperty(o.overrideStyle)})),{component:n,overrideStyle:r.cssProperties}},t}(Er),Tr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.decorate=function(e,t){var n=e;return this.decorators.forEach((function(e){n=e(n,t)})),n},t}(Er),Rr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.decorate=function(e){var t=[];return this.decorators.forEach((function(n,r){var o=n(e,r);o&&t.push(o)})),t},t}(Er),Ir=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.decorate=function(e){var t=new hn;return this.decorators.forEach((function(n){var r=n(e);t.setProperty(r)})),t.cssProperties},t}(Er);!function(e){e[e.Front=0]="Front",e[e.Container=1]="Container",e[e.Canvas=2]="Canvas",e[e.Back=3]="Back",e[e.Bottom=4]="Bottom"}(mr||(mr={}));var Pr,Or=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.decorate=function(e){var t=[];return this.decorators.forEach((function(n){var r=n(e);r&&t.push(r)})),t},t}(Er),kr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.decorate=function(e){var t=[],n=new hn;return this.decorators.forEach((function(r){var o=r(e);o&&(o.component&&t.push(o.component),n.setProperty(o.overrideStyle))})),{components:t,overrideStyle:n.cssProperties}},t}(Er),Dr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.decorate=function(e,t){var n=e,r=new hn;return this.decorators.forEach((function(o){var i=o(e,t);n=i.component,r.setProperty(i.overrideStyle)})),{component:n,overrideStyle:r.cssProperties}},t}(Er),Mr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.decorate=function(e){var t=[];return this.decorators.forEach((function(n,r){var o=n(e,r);o&&t.push(o)})),t},t}(Er),Ar=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.decorate=function(e){return this.decorators.map((function(t){return new hn(t(e))})).reduce((function(e,t){return e.mergeTo(t)}),new hn).cssProperties},t}(Er),Lr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.decorate=function(e,t){var n=e;return this.decorators.forEach((function(e){var r=e(n,t);n=r})),n},t}(Er),Nr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.decorate=function(e){return this.decorators.map((function(t){return t(e)||[]})).reduce((function(e,t){return e.concat(t)}),[])},t}(Er);!function(e){e.Start="start",e.Center="center",e.End="end",e.Content="content",e.Out="out"}(Pr||(Pr={}));var Br,Fr=function(){function e(){this.styleDecorators=new Ar,this.classNameDecorators=new Nr,this.regionDecorators=new Map([[Pr.Start,new Lr],[Pr.Center,new Lr],[Pr.End,new Lr],[Pr.Content,new Lr],[Pr.Out,new Lr]])}return e.prototype.addStyle=function(e){this.styleDecorators.addDecorator(e)},e.prototype.addRegion=function(e,t){var n;null===(n=this.regionDecorators.get(e))||void 0===n||n.addDecorator(t)},e.prototype.addClassName=function(e){this.classNameDecorators.addDecorator(e)},e.prototype.decorateStyle=function(e){return this.styleDecorators.decorate(e)},e.prototype.decorateClassName=function(e){return this.classNameDecorators.decorate(e)},e.prototype.decorateRegion=function(e,t,n){var r=this.regionDecorators.get(e);return r?r.decorate(t,n):t},e.prototype.removeDecorators=function(){this.styleDecorators.removeDecorators(),this.regionDecorators.forEach((function(e){return e.removeDecorators()})),this.classNameDecorators.removeDecorators()},e}(),Ur=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t}(Fr);!function(e){e[e.Text=0]="Text",e[e.LinePaddingLeft=1]="LinePaddingLeft",e[e.Paragraph=2]="Paragraph",e[e.HeaderFooter=3]="HeaderFooter",e[e.Page=4]="Page",e[e.Textframe=5]="Textframe",e[e.LineFragment=6]="LineFragment",e[e.LinePlaceholder=7]="LinePlaceholder",e[e.BlockParagraph=8]="BlockParagraph"}(Br||(Br={}));var Hr,jr=function(){function e(e){var t=this;this.map=new Map,this.boxMap=new Map,this.blockBoxMap=new Map,this.map.set(Br.Text,new xr),this.map.set(Br.LinePaddingLeft,new Rr),this.map.set(Br.Paragraph,new Ir),this.map.set(Br.HeaderFooter,new kr),this.map.set(Br.Page,new Or),this.map.set(Br.Textframe,new Tr),this.map.set(Br.LineFragment,new Dr),this.map.set(Br.LinePlaceholder,new Mr),this.blockBoxMap.set(Br.BlockParagraph,new Ur),null==e||e.forEach((function(e){return t.boxMap.set(e,new Fr)}))}return e.prototype.addDecorator=function(e,t){var n=this.map.get(e);n&&n.addDecorator(t)},e.prototype.getDecorator=function(e){return this.map.get(e)},e.prototype.addStyleDecorator=function(e,t){var n=this.boxMap.get(e);null==n||n.addStyle(t)},e.prototype.addClassNameDecorator=function(e,t){var n=this.boxMap.get(e);null==n||n.addClassName(t)},e.prototype.addContentDecorator=function(e,t,n,r){if(void 0===r&&(r=!1),r){var o=this.blockBoxMap.get(Br.BlockParagraph);null==o||o.addRegion(t,n)}else{var i=this.boxMap.get(e);null==i||i.addRegion(t,n)}},e.prototype.getBoxDecorators=function(e){return this.boxMap.get(e)},e.prototype.getBlockBoxDecorators=function(){return this.blockBoxMap.get(Br.BlockParagraph)},e.prototype.removeAllDecorators=function(){this.map.get(Br.Text).removeDecorators(),this.map.get(Br.LinePaddingLeft).removeDecorators(),this.map.get(Br.Paragraph).removeDecorators(),this.map.get(Br.HeaderFooter).removeDecorators(),this.map.get(Br.Page).removeDecorators(),this.map.get(Br.Textframe).removeDecorators(),this.map.get(Br.LineFragment).removeDecorators(),this.map.get(Br.LinePlaceholder).removeDecorators(),this.boxMap.forEach((function(e){return e.removeDecorators()}))},e}(),Gr=function(){function e(){this.map=new Map}return e.prototype.addRender=function(e,t){this.map.set(e,t)},e.prototype.getRender=function(e){return this.map.get(e)},e}();!function(e){e[e.Plugin=0]="Plugin"}(Hr||(Hr={}));var Vr,Wr=function(){function e(e){this.context=e,this.map=new Gr,this.pluginMap=new Map,this.pluginMap.set(Hr.Plugin,[])}return e.prototype.addRender=function(e,t){this.map.addRender(e,t)},e.prototype.getRender=function(e){return this.map.getRender(e)},e.prototype.addRenderPlugin=function(e){var t=e instanceof Array?e:[e],n=(this.pluginMap.get(Hr.Plugin)||[]).concat(t);this.pluginMap.set(Hr.Plugin,n)},e.prototype.isRenderPlugin=function(e){var t=this.pluginMap.get(Hr.Plugin);return!(!t||!t.length)&&t.indexOf(e)>-1},e.prototype.renderContainerBox=function(e,t){var n=this.getType(e);if(!n)return null;var r=this.getRender(n);return r?r(e,t,this.context):null},e.prototype.getType=function(e){var t;return(0,Fe.Oi)(e)?e.uniqueTypeId:e.property.fieldType!==Le.dLA.NoField?Le.fSu:null!==(t=e.uniqueTypeId)&&void 0!==t?t:e.property.drawingType},e}(),zr=function(){function e(e,t){var n=this;this.editor=e,this.state=t,this.selectionSwitch={on:!0},this.selectionChangeCallback=function(e){if(n.focusedContainer){var t=e.range,r=n.focusedContainer.getRange();t.equal(r)||n.clearFocus()}},e.on(Wn.at.CoreSelectionChange,this.selectionChangeCallback,{},{priority:s.NotificationPriority.high})}return e.prototype.onFocus=function(e,t,n){var r;void 0===t&&(t={}),void 0===n&&(n=Wn.A6.Show),this.focusedContainer=e;var o=this.focusedContainer.getRange();if((0,Fe.vv)(e)){var i=null===(r=this.editor.getDrawingStream())||void 0===r?void 0:r.getDrawingInfo(e.floatingSpace.id);i&&(o=i.range)}this.state.setRangeTo(o,{mobileSelectionDrag:Wn.p2.Hide,forceFocus:!1,scrollToView:Wn.hF.None,forceNotify:!0,mobileContextMenu:n}),this.editor.fire(new b(!0,t,this.focusedContainer)),this.selectionSwitch.on=!1},e.prototype.clearFocus=function(){this.focusedContainer=void 0,this.editor.fire(new b(!1,{})),this.selectionSwitch.on=!0},e.prototype.getFocusedContainer=function(){return this.focusedContainer},e.prototype.selectionSwitchOn=function(){return this.selectionSwitch.on},e.prototype.getContext=function(){return this.editor},e}(),Kr=function(){function e(){this._cache=new Map}return e.prototype.getRenderInfo=function(e,t){var n="".concat(e,"_").concat(t);if(this._cache.has(n))return this._cache.get(n)},e.prototype.setRenderInfo=function(e,t,n){this._cache.set("".concat(e,"_").concat(t),n)},e.prototype.getScrollerInfo=function(e){return this.getRenderInfo(Fe.qg.Scroller,e)},e.prototype.setScrollerInfo=function(e,t){this.setRenderInfo(Fe.qg.Scroller,e,t)},e.prototype.getFocusOnInfo=function(){return this.getRenderInfo(Fe.qg.FocusOn,"focusOn")},e.prototype.setFocusOnInfo=function(e){this.setRenderInfo(Fe.qg.FocusOn,"focusOn",e)},e.prototype.getEditorInfo=function(){return this.getRenderInfo(Fe.qg.EditorInfo,"zoom")},e.prototype.setEditorInfo=function(e){this.setRenderInfo(Fe.qg.EditorInfo,"zoom",e)},e.prototype.setTaskActiveInfo=function(e){var t=this.getTaskActiveInfo();this.setRenderInfo(Fe.qg.TaskActive,"taskActive",(0,a.__assign)((0,a.__assign)({},t),e))},e.prototype.getTaskActiveInfo=function(){return this.getRenderInfo(Fe.qg.TaskActive,"taskActive")||{}},e.prototype.setParagraphShortcutMenuInfo=function(e){var t=this.getParagraphShortcutMenuInfo();this.setRenderInfo(Fe.qg.ParagraphShortcutMenu,"paragraphShortcutMenu",(0,a.__assign)((0,a.__assign)({},t),e))},e.prototype.getParagraphShortcutMenuInfo=function(){return this.getRenderInfo(Fe.qg.ParagraphShortcutMenu,"paragraphShortcutMenu")||{}},e.prototype.setTextFrameActiveInfo=function(e){var t=e?(0,a.__assign)({},e):void 0;this.setRenderInfo(Fe.qg.TextFrameActive,"textFrameActive",t)},e.prototype.getTextFrameActiveInfo=function(){return this.getRenderInfo(Fe.qg.TextFrameActive,"textFrameActive")},e}(),qr=function(e,t,n,r,o,i,a,s,c,l,u,d){this.overlays=e,this.selectionOverlay=t,this.containerFocus=n,this.scrollHandler=r,this.containerRenderManager=o,this.decoratorManager=i,this.lifeCycle=a,this.isEditable=s,this.isFirstRender=c,this.docEnv=l,this.renderState=u,this.state=d},Yr=function(e){function t(t,n,r,o,i,a,s,c,l,u,d,p,h){var f=e.call(this,t,n,r,o,i,a,s,c,l,u,d,p)||this;return f.extRendererManager=h,f}return(0,a.__extends)(t,e),Object.defineProperty(t.prototype,"isFocusHeaderFooter",{get:function(){return(this.renderState.getFocusOnInfo()||{isFocusHeaderFooter:!1}).isFocusHeaderFooter},enumerable:!1,configurable:!0}),t}(qr),Qr=20;!function(e){e[e.Text=0]="Text",e[e.Paragraph=1]="Paragraph",e[e.HeaderFooter=2]="HeaderFooter",e[e.Page=3]="Page",e[e.Textframe=4]="Textframe",e[e.LeafContainer=5]="LeafContainer",e[e.TextLineFragment=6]="TextLineFragment",e[e.TextLine=7]="TextLine",e[e.OverlayParagraph=8]="OverlayParagraph",e[e.OverlayTaskCheckbox=9]="OverlayTaskCheckbox",e[e.OverlayTable=10]="OverlayTable",e[e.Image=11]="Image"}(Vr||(Vr={}));var Zr,Xr,Jr,$r,eo=Symbol("IExtendRendererManager");!function(e){e[e.Undefined=0]="Undefined",e[e.Header=1]="Header",e[e.Line=2]="Line"}(Zr||(Zr={})),function(e){e[e.Row=0]="Row",e[e.Col=1]="Col"}(Xr||(Xr={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right"}(Jr||(Jr={})),function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Stop=2]="Stop"}($r||($r={}));var to=Le.keb.tableHeaderWidth,no=36,ro=160,oo=8,io="#F3F5F7",ao="#E9EBED",so="#81868F",co="#777B84",lo=100,uo=30,po=6,ho="table-bubble-reminder-id",fo="drag-disable-table-element",go="rows-or-cols-drag-preview-id",vo="drag-cols-or-rows-mask",yo="table-cols-header-wrapper",mo="table-cols-header",bo=function(e){return"table-".concat(e)};function _o(e,t){return-1===t?1:Math.abs(e-t)+1}function Co(e,t){return-1===t?{beginIndex:e,endIndex:e}:e>t?{beginIndex:t,endIndex:e}:{beginIndex:e,endIndex:t}}var So=function(e,t,n){return e.addEventListener(t,n),function(){e.removeEventListener(t,n)}};function wo(e,t,n){var r=document.body,o=null,i=So(r,"mousemove",(function(t){e(t)})),a=So(r,"mouseup",(function(e){t(e),o&&o()})),s=So(r,"mouseleave",(function(){n(),o&&o()}));return o=function(){i(),a(),s()}}function Eo(){var e=document.getElementById("melo-hidden-editor");e&&e.focus()}function xo(e,t){return!!e.isPagedView&&Ue.s9.getTableBoxes(t).length>1}function To(e){return Ue.s9.getFirstTableBox(e)===e}function Ro(e,t,n){var r=function(){var e=document.getElementById(vo);return e||((e=document.createElement("div")).id=vo,e.className=Ge.dragColsOrRowsMask,document.body.appendChild(e)),e.style.display="block",e}();r.style.left="".concat(e+-30,"px"),r.style.top="".concat(t+-20,"px"),r.style.cursor=n}function Io(){var e=document.getElementById(vo);e&&(e.style.display="none")}function Po(){var e,t,n=document.getElementById(go);return n?(e=n.firstChild,(t=n.lastChild).innerText=""):((n=document.createElement("div")).id=go,e=document.createElement("div"),n.appendChild(e),t=document.createElement("div"),n.appendChild(t),document.body.appendChild(n)),{previewContainer:n,previewHeader:e,previewContent:t}}function Oo(e,t){var n=window.$t;return n?e===Xr.Col?n("{{colsCount}}",{colsCount:t}):n("{{rowsCount}}",{rowsCount:t}):"".concat(t).concat(e===Xr.Col?"":"")}function ko(){var e=document.getElementById(go);return e?("block"!==e.style.display&&(e.style.display="block"),e):null}function Do(){var e=document.getElementById(go);e&&(e.style.display="none"),Io()}function Mo(e,t,n,r){var o=e-t-r[0]/2;if(o<=0)return 0;if(e>=n-r[r.length-1]/2)return r.length;for(var i=1;o>0&&i<r.length;)o=o-r[i-1]/2-r[i]/2,i+=1;return i-1}var Ao=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={rowGuiderShow:!1,rowGuiderY:0,colGuiderShow:!1,colGuiderX:0,mouseStart:0,rowDraggerEvent:"all"},t.removeHandler=null,t.rowDraggerEventTimer=null,t.onRowDraggerMouseDown=function(e){t.setState({rowGuiderShow:!0,rowGuiderY:t.props.top,mouseStart:e.clientY}),t.attachDragMouseEvent(t.onRowDraggerMouseMove,t.onRowDraggerMouseUp,t.onRowDraggerMouseLeave)},t.onRowDraggerMouseMove=function(e){if(t.state.rowGuiderShow){e.stopPropagation();var n=e.clientY-t.state.mouseStart;n+t.valueRangeStart>Qr&&t.setState({rowGuiderY:t.props.top+n})}},t.onRowDraggerMouseUp=function(e){e.stopPropagation();var n=t.state.rowGuiderY-t.props.top;t.props.onFinish&&t.props.onFinish(n/t.zoom,e.clientY/t.zoom),t.setState({rowGuiderShow:!1})},t.onRowDraggerMouseLeave=function(e){e.stopPropagation(),t.setState({rowGuiderShow:!1})},t.onColDraggerMouseDown=function(e){var n=e.clientX;if(t.props.box){var r=t.props.box.__node__;if((null==r?void 0:r.getBoundingClientRect)&&0===r.cellIndex){var o=r.getBoundingClientRect();n-o.left<o.right-n&&(n=o.left)}}t.setState({colGuiderShow:!0,colGuiderX:t.props.left,mouseStart:n});var i=t.props.left/t.zoom;t.changeColBlueLineDisplayStatus(i,!0),t.attachDragMouseEvent(t.onColDraggerMouseMove,t.onColDraggerMouseUp,t.onColDraggerMouseLeave)},t.onHandleEnterDragger=function(e){t.props.onEnterDragger&&t.props.onEnterDragger(e)},t.onHandleLeaveDragger=function(){t.props.onLeaveDragger&&t.props.onLeaveDragger()},t.onColDraggerMouseMove=function(e){if(t.state.colGuiderShow){e.stopPropagation();var n=e.clientX-t.state.mouseStart-1;if(n+t.valueRangeStart>Qr&&(!t.valueRangeEnd||n+t.valueRangeStart<t.valueRangeEnd)){t.setState({colGuiderX:t.props.left+n});var r=(t.props.left+n)/t.zoom;t.changeColBlueLineDisplayStatus(r,!0)}}},t.onColDraggerMouseUp=function(e){e.stopPropagation();var n=t.state.colGuiderX-t.props.left;t.props.onFinish&&t.props.onFinish(n/t.zoom,e.clientX/t.zoom),t.setState({colGuiderShow:!1}),t.changeColBlueLineDisplayStatus(-1,!1)},t.onColDraggerMouseLeave=function(e){e.stopPropagation(),t.setState({colGuiderShow:!1}),t.changeColBlueLineDisplayStatus(-1,!1)},t.handleColAdjust=function(e){var n,r;null===(r=(n=t.props).onColAdjust)||void 0===r||r.call(n,e)},t}return(0,a.__extends)(t,e),t.prototype.componentWillUnmount=function(){this.removeMouseHandler()},Object.defineProperty(t.prototype,"zoom",{get:function(){return this.props.zoom||1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rowDraggerStyle",{get:function(){var e=this.props,t=e.edge,n=e.top;return("top"===t||"bottom"===t)&&n>0?{top:((this.state.rowGuiderShow?this.state.rowGuiderY:n)-3.5)/this.zoom,cursor:s.PlatformUtil.isWXMiniProgram()?"ns-resize":"row-resize",pointerEvents:this.state.rowDraggerEvent}:{display:"none"}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"colDraggerStyle",{get:function(){var e=this.props,t=e.edge,n=e.left,r=e.scrollLeft;return"left"===t||"right"===t?{left:(n+(r||0)-3.5)/this.zoom,cursor:s.PlatformUtil.isWXMiniProgram()||s.PlatformUtil.isWindows()?"ew-resize":"col-resize"}:{display:"none"}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rowGuiderStyle",{get:function(){var e=this.props.rowGuiderShow||this.state.rowGuiderShow,t=this.props.rowGuiderShow?this.props.rowGuiderTopPos:this.state.rowGuiderY,n=0,r=this.props.width;return this.shouldRowGuiderExtendToHeader()&&(n=-1*to,r+=to),{top:t/this.zoom,left:"".concat(n,"px"),width:"".concat(r,"px"),display:e?"block":"none"}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"colGuiderStyle",{get:function(){var e=this.props.colGuiderShow||this.state.colGuiderShow,t=this.props.colGuiderShow?this.props.colGuiderLeftPos:this.state.colGuiderX,n=0,r=this.props.height;return this.shouldColGuiderExtendToHeader()&&(n=-1*to,r+=to),{top:"".concat(n,"px"),height:"".concat(r,"px"),display:e?"block":"none",left:(t+(this.props.scrollLeft||0))/this.zoom}},enumerable:!1,configurable:!0}),t.prototype.shouldColGuiderExtendToHeader=function(){return this.state.colGuiderShow&&this.props.showTableHeader&&To(this.props.layoutBox)},t.prototype.shouldRowGuiderExtendToHeader=function(){return this.state.rowGuiderShow&&this.props.showTableHeader},t.prototype.attachDragMouseEvent=function(e,t,n){var r=this,o=document.body,i=So(o,"mousemove",(function(t){var n=r.props.zoom?r.props.zoom:1;t.clientX<100||t.clientX>o.clientWidth*n-100?(r.removeMouseHandler(),r.setState({rowGuiderShow:!1,colGuiderShow:!1}),r.changeColBlueLineDisplayStatus(-1,!1)):e(t)})),a=So(o,"mouseup",(function(e){t(e),r.removeMouseHandler()})),s=So(o,"mouseleave",(function(e){n(e),r.removeMouseHandler()}));this.removeHandler=function(){i(),a(),s()}},t.prototype.changeColBlueLineDisplayStatus=function(e,t){xo(this.props.context,this.props.layoutBox)&&this.props.context.fire(new A(this.props.cbKey,e,t))},t.prototype.removeMouseHandler=function(){this.removeHandler&&(this.removeHandler(),this.removeHandler=null)},Object.defineProperty(t.prototype,"valueRangeStart",{get:function(){return this.props.valueRange&&this.props.valueRange.length>0&&this.props.valueRange[0]||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"valueRangeEnd",{get:function(){return this.props.valueRange&&this.props.valueRange.length>1&&this.props.valueRange[1]||0},enumerable:!1,configurable:!0}),t.prototype.onHandleWheel=function(e){var t=this;Math.abs(e.deltaY)>Math.abs(e.deltaX)&&!e.shiftKey||(this.rowDraggerEventTimer?clearTimeout(this.rowDraggerEventTimer):this.setState({rowDraggerEvent:"none"}),this.rowDraggerEventTimer=setTimeout((function(){t.setState({rowDraggerEvent:"all"}),t.rowDraggerEventTimer=null}),500))},t.prototype.render=function(){var e=this,t="".concat(this.props.width,"px"),n="".concat(this.props.height,"px");return ur().createElement("div",null,ur().createElement("div",null,ur().createElement("div",{className:je.tableRowBorderDragger,style:(0,a.__assign)((0,a.__assign)({},this.rowDraggerStyle),{width:t}),onMouseDown:this.onRowDraggerMouseDown,onMouseEnter:function(){return e.onHandleEnterDragger(Xr.Row)},onMouseLeave:this.onHandleLeaveDragger,onWheel:this.onHandleWheel.bind(this)}),ur().createElement("div",{className:je.tableRowBorderGuide,style:(0,a.__assign)({},this.rowGuiderStyle)})),ur().createElement("div",null,ur().createElement("div",{className:je.tableColBorderDragger,style:(0,a.__assign)((0,a.__assign)({},this.colDraggerStyle),{height:n}),onMouseDown:this.onColDraggerMouseDown,onMouseEnter:function(){return e.onHandleEnterDragger(Xr.Col)},onMouseLeave:this.onHandleLeaveDragger,onDoubleClick:this.handleColAdjust}),ur().createElement("div",{className:je.tableColBorderGuide,style:(0,a.__assign)({},this.colGuiderStyle)})))},t}(ur().Component),Lo=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={showColAddIcon:!1,addIconLeftPos:0,addIconTopPos:0,deleteIconLeftPos:-1,deleteIconTopPos:-1,onRight:!1,onBottom:!1,addTargetGCP:null,showColsMoveCircle:!1,moveCircleLeftPos:0,moveCircleTopPos:0,isDraggingCols:!1,selectColActiveForCursor:!1},t.refColsHeader=ur().createRef(),t.refColsHeaderWrapper=ur().createRef(),t.selectColActiveForDrag=!1,t.selectedFirstColBeginGCP=-1,t.selectedFirstColEndGCP=-1,t.selectedLastColBeginGCP=-1,t.selectedFirstColIndex=-1,t.selectedLastColIndex=-1,t.dragPreviewWidth=0,t.targetIndexOnDragCols=-1,t.startXOnDragCols=-1,t.forbidDragColsIndexRange=[],t.lastMouseMoveClientX=-1,t.lastHoverType=Zr.Undefined,t.lastHoveredColIndex=-1,t.isLastMouseDownWithShift=!1,t}return(0,a.__extends)(t,e),t.prototype.render=function(){var e=this;this.updateSelectedStatus();var t=this.props,n=t.rectSize,r=t.scrollLeft,o=t.layoutBox,i=t.totalColHeaderWidth,c=t.colHeadersInfo,l=t.colHeadersColor,u=(0,s.twipsToPx)(o.edge.border.width.left);return ur().createElement("div",{className:Ge.tableColsHeaderWrapper,onMouseOut:function(){return e.handleMouseOutHeader()}},ur().createElement("div",{className:Ge.tableColsHeader,style:{width:n.width+2*u},ref:this.refColsHeaderWrapper},ur().createElement("div",{className:Ge.tableColsHeaderInner,style:{width:i,left:r},ref:this.refColsHeader},c.map((function(t,n){return ur().createElement("div",{key:"table-col-header-".concat(n),className:"".concat(Ge.tableSingleColHeader," ").concat(fo),style:(0,a.__assign)({width:t.headerWidth,backgroundColor:l[n],cursor:e.getColHeaderCursorStyle(n)},e.getColHeaderRightBorderColor(n)),onMouseDown:function(r){return e.handleColHeaderMouseDown(r,t,n)},onMouseMove:function(r){return e.handleColHeaderMouseMove(r,t,n)}})})))),this.renderAddIcon(),this.renderColsMoveCircle())},t.prototype.renderAddIcon=function(){if(this.props.draggerInfo.colDraggerShow){var e=this.props.draggerInfo.left/this.props.zoom,t=this.getColIndexWithOffsetLeft(e);this.lastHoveredColIndex=t,this.lastHoverType=Zr.Line;var n=-1*to,r=this.getColLeftPosInTable(t)+this.props.scrollLeft-to/2;return this.getRenderAddColIcon(r,n)}return this.state.showColAddIcon||this.props.showColAddIcon?this.getRenderAddColIcon(this.state.addIconLeftPos,this.state.addIconTopPos):null},t.prototype.getRenderAddColIcon=function(e,t){return ur().createElement(Vo,(0,a.__assign)({},{left:e+1,top:t,onMouseClick:this.handleClickAddColIcon.bind(this),onMouseEnter:this.handleEnterAddColIcon.bind(this,e,t),onMouseLeave:this.handleLeaveAddColIcon.bind(this)}))},t.prototype.renderColsMoveCircle=function(){if(this.state.showColsMoveCircle){var e=-1*to,t=this.state.moveCircleLeftPos-Math.abs(this.props.scrollLeft)-to/2+1;return ur().createElement("div",{className:Ge.tableMoveCircle,style:{left:t,top:e}})}return null},t.prototype.handleColHeaderMouseDown=function(e,t,n){e.stopPropagation();var r=t.firstCellRange,o=t.lastCellRange;if(!1===this.selectColActiveForDrag&&this.isColIndexSelected(r)&&this.isColCanbeDrag(n))return this.startXOnDragCols=e.clientX,this.setState({isDraggingCols:!0}),void this.handleDragSelectedCols();if(this.selectColActiveForDrag=!0,this.setState({selectColActiveForCursor:!0}),wo(this.handleMouseMoveOnDragSelect.bind(this),this.handleMouseUpOrLeaveOnDragSelect.bind(this),this.handleMouseUpOrLeaveOnDragSelect.bind(this)),e.shiftKey){if(-1!==this.selectedLastColBeginGCP&&this.selectedLastColBeginGCP!==r.begin()){this.selectedLastColBeginGCP=r.begin();var i=this.selectedFirstColEndGCP-this.selectedFirstColBeginGCP,a=o.end()-this.selectedLastColBeginGCP;this.selectedLastColIndex=n;var s=[new Le.ICE(this.selectedFirstColBeginGCP,i),new Le.ICE(this.selectedLastColBeginGCP,a)];this.props.selectColsOrRows(s)}this.isLastMouseDownWithShift=!0}else{this.selectedFirstColBeginGCP=r.begin(),this.selectedFirstColEndGCP=o.end(),this.selectedLastColBeginGCP=r.begin(),this.selectedFirstColIndex=n,this.selectedLastColIndex=-1;var c=this.selectedFirstColEndGCP-this.selectedFirstColBeginGCP;this.props.selectColsOrRows([new Le.ICE(this.selectedFirstColBeginGCP,c)]),this.isLastMouseDownWithShift=!1}},t.prototype.handleColHeaderMouseMove=function(e,t,n){if(e.stopPropagation(),this.refColsHeader.current){var r=e.clientX,o=this.refColsHeader.current.getBoundingClientRect(),i=this.calcColAddIconPosInfo(r+(0,s.twipsToPx)(this.props.leftOffset),o,t,n),a=i.onRight,c=i.addIconLeftPos,l=i.addIconTopPos,u=i.showColAddIcon;this.lastHoverType=Zr.Header,c===this.state.addIconLeftPos&&u===this.state.showColAddIcon||this.setState({onRight:a,addTargetGCP:t.firstCellRange,addIconLeftPos:c,addIconTopPos:l,showColAddIcon:u})}},t.prototype.handleMouseOutHeader=function(){this.setState({showColAddIcon:!1})},t.prototype.handleMouseMoveOnDragSelect=function(e){var t=this.resolveColIndexOnMouseClientX(e.clientX);if(-1!==t){var n=this.props.colHeadersInfo[t],r=n.firstCellRange,o=n.lastCellRange;if(this.horizonScrollIfThreshold(e),Ro(e.clientX,e.clientY,"default"),this.selectColActiveForDrag&&-1!==this.selectedFirstColBeginGCP&&this.selectedLastColBeginGCP!==r.begin()){this.selectedLastColBeginGCP=r.begin();var i=this.selectedFirstColEndGCP-this.selectedFirstColBeginGCP,a=o.end()-this.selectedLastColBeginGCP;this.selectedLastColIndex=t;var s=[new Le.ICE(this.selectedFirstColBeginGCP,i),new Le.ICE(this.selectedLastColBeginGCP,a)];this.props.selectColsOrRows(s)}}},t.prototype.handleMouseUpOrLeaveOnDragSelect=function(){this.selectColActiveForDrag=!1,this.setState({selectColActiveForCursor:!1}),this.clearHorizonScrollInterval(),Io(),Eo()},t.prototype.resolveColIndexOnMouseClientX=function(e){var t,n=null===(t=this.refColsHeader.current)||void 0===t?void 0:t.getBoundingClientRect();if(!n)return-1;var r=this.props,o=r.colHeadersInfo,i=r.zoom,a=0,s=e-n.left;if(s<=0)return a;for(;s>0&&a<o.length;)s-=o[a].headerWidth*i,a+=1;return a-1},t.prototype.handleClickAddColIcon=function(){var e=this.getAddColPosInfo(),t=e.onRight,n=e.addTargetGCP;this.props.context.fire(new R(this.props.layoutBox.getRangeBegin(),n,this.props.layoutBox.nestingLevel,t))},t.prototype.handleEnterAddColIcon=function(e,t){this.setState({addIconLeftPos:e,addIconTopPos:t}),this.props.onEnterAddColIcon(e,t)},t.prototype.handleLeaveAddColIcon=function(){this.props.onLeaveAddColIcon()},t.prototype.getAddColPosInfo=function(){var e=this.state,t=e.addTargetGCP,n=e.onRight;if(this.lastHoverType===Zr.Line){var r=this.props.colHeadersInfo;this.lastHoveredColIndex<r.length?(t=r[this.lastHoveredColIndex].firstCellRange,n=!1):(t=r[r.length-1].firstCellRange,n=!0)}return{onRight:n,addTargetGCP:t}},t.prototype.updateSelectedStatus=function(){this.props.isColSelected||this.selectColActiveForDrag||(this.resetSelectedCol(),this.isLastMouseDownWithShift=!1),this.updateSelectedColIndex(),this.updateForbidDragColsStatus()},t.prototype.resetSelectedCol=function(){this.selectedFirstColBeginGCP=-1,this.selectedFirstColEndGCP=-1,this.selectedLastColBeginGCP=-1,this.selectedFirstColIndex=-1,this.selectedLastColIndex=-1},t.prototype.updateSelectedColIndex=function(){if(this.props.selectedCellsGCPRanges&&!this.props.isTableSelected){var e=this.props.selectedCellsGCPRanges[0];this.props.isColSelected&&this.updateSelectedGCPOnColSelected(e),this.props.isRowSelected&&!this.selectColActiveForDrag&&(this.selectedFirstColBeginGCP=-1,this.selectedFirstColEndGCP=-1,this.selectedLastColBeginGCP=-1)}},t.prototype.updateSelectedGCPOnColSelected=function(e){if(!this.selectColActiveForDrag){var t=this.getSelectedColsIndex(e);if(0!==t.length){var n=t[0],r=t[t.length-1],o=this.props.colHeadersInfo;this.isLastMouseDownWithShift||(this.selectedFirstColIndex=n,this.selectedLastColIndex=r,this.selectedFirstColBeginGCP=o[this.selectedFirstColIndex].firstCellRange.begin(),this.selectedFirstColEndGCP=o[this.selectedFirstColIndex].lastCellRange.end(),this.selectedLastColBeginGCP=o[this.selectedLastColIndex].firstCellRange.begin())}}},t.prototype.getSelectedColsIndex=function(e){var t=[];return this.props.colHeadersInfo.forEach((function(n,r){e.contains(n.firstCellRange)&&t.push(r)})),t},t.prototype.updateForbidDragColsStatus=function(){if(!this.props.isColSelected||this.isSelectedColsCanbeDraged())this.forbidDragColsIndexRange=[];else{var e=Co(this.selectedFirstColIndex,this.selectedLastColIndex),t=e.beginIndex,n=e.endIndex;this.forbidDragColsIndexRange=[t,n]}},t.prototype.isSelectedColsCanbeDraged=function(){var e=this.props.selectedCellsGCPRanges;if(!e)return!0;var t=this.getCellsIntervalRange(e[0]);if(!t)return!0;for(var n=1;n<e.length;n++){var r=this.getCellsIntervalRange(e[n]);if(!(0,Ve.vZ)(r,t))return!1}return!0},t.prototype.getCellsIntervalRange=function(e){var t=this.props.shares.state.getTableStream(),n=t.getCellInterval(e.begin()),r=t.getCellInterval(e.end()-1);return n&&r?[n.begin,r.end]:null},t.prototype.getColHeaderCursorStyle=function(e){var t=this.props.colHeadersColor;return!1===this.state.selectColActiveForCursor&&t[e]===so&&this.isColCanbeDrag(e)?this.state.isDraggingCols?"grabbing":"grab":"default"},t.prototype.getColHeaderRightBorderColor=function(e){var t=this.props.colHeadersColor;return t[e]===so?null:e+1<t.length&&t[e+1]===so?{borderRightColor:co}:null},t.prototype.getDragPreviewSize=function(){var e,t,n=Co(this.selectedFirstColIndex,this.selectedLastColIndex),r=n.beginIndex,o=n.endIndex;return(e=this.props.colHeadersInfo.map((function(e){return e.headerWidth})).slice(r,o+1).reduce((function(e,t){return e+t}),0))>120&&(e=120),(t=this.props.rectSize.height)>ro?t=ro:xo(this.props.context,this.props.layoutBox)&&(t=0,document.querySelectorAll(".".concat(this.props.cbKey)).forEach((function(e){var n=e.getBoundingClientRect();t+=n.height})),t=t>ro?ro:t),{previewWidth:e,previewHeight:t}},t.prototype.isColCanbeDrag=function(e){return!this.props.isTableSelected&&(0===this.forbidDragColsIndexRange.length||e<this.forbidDragColsIndexRange[0]||e>this.forbidDragColsIndexRange[1])},t.prototype.handleDragSelectedCols=function(){if(this.props.selectedCellsGCPRanges){var e=_o(this.selectedFirstColIndex,this.selectedLastColIndex),t=this.getDragPreviewSize(),n=t.previewWidth,r=t.previewHeight;this.dragPreviewWidth=n,function(e,t,n,r){var o=Po(),i=o.previewContainer,a=o.previewHeader,s=o.previewContent;i.className=Ge.dragColsPreviewContainer,a.className=Ge.dragColsPreviewHeader,s.className=Ge.dragColsPreviewContent,a.style.width="".concat(t*r,"px"),a.style.height="".concat(to*r,"px"),a.style.borderRadius="".concat(4*r,"px ").concat(4*r,"px 0  0"),e>1&&(s.innerText=Oo(Xr.Col,e)),i.style.width="".concat(t*r,"px"),i.style.height="".concat((n+to)*r,"px"),s.style.width="".concat(t*r,"px"),s.style.height="".concat(n*r,"px"),s.style.borderWidth="".concat(1*r,"px"),s.style.fontSize="".concat(14*r,"px")}(e,n,r,this.props.zoom),wo(this.handleMouseMoveOnDragCols.bind(this),this.handleMouseUpOnDragCols.bind(this),this.handleMouseLeaveOnDragCols.bind(this))}},t.prototype.handleMouseMoveOnDragCols=function(e){var t,n,r,o,i;t=e.clientX,n=e.clientY,r=this.dragPreviewWidth,o=this.props.zoom,(i=ko())&&(i.style.left="".concat(t-r*o/2,"px"),i.style.top="".concat(n-to*o/2,"px"),Ro(t,n,"grabbing")),this.horizonScrollIfThreshold(e),this.lastMouseMoveClientX=e.clientX,this.updateDragColsGraphReminder()},t.prototype.handleMouseUpOnDragCols=function(){if(-1!==this.targetIndexOnDragCols&&this.props.selectedCellsGCPRanges){var e=this.calcSelectedColsInterval();if(e){this.props.context.fire(new L(this.props.layoutBox.getRangeBegin(),e,this.targetPosesOnDragCols));var t=this.calcSelectedColsRangeAfterMove(this.props.selectedCellsGCPRanges,this.targetPosesOnDragCols);this.props.selectColsOrRows([t])}}this.finishDragCols()},t.prototype.handleMouseLeaveOnDragCols=function(){this.finishDragCols()},t.prototype.updateDragColsGraphReminder=function(){var e=Co(this.selectedFirstColIndex,this.selectedLastColIndex),t=e.beginIndex,n=e.endIndex,r=this.getColsMoveTarget(this.lastMouseMoveClientX,this.startXOnDragCols,t,n);if(!r)return this.hideDragColsGraphReminder(),void(this.targetIndexOnDragCols=-1);this.targetPosesOnDragCols=r.targetPoses,this.targetIndexOnDragCols=r.targetIndex,this.showDragColsGraphReminder()},t.prototype.horizonScrollIfThreshold=function(e){var t,n=this.props,r=n.rectSize,o=n.contentSize,i=Math.abs(this.props.scrollLeft);if(o.width<=r.width)this.clearHorizonScrollInterval();else{var a=null===(t=this.refColsHeaderWrapper.current)||void 0===t?void 0:t.getBoundingClientRect();if(a){var s=a.left+a.width;e.clientX-s>-1*Sr?this.horizonScrollIfMouseInTableRight(i):e.clientX-a.left<Sr?this.horizonScrollIfMouseInTableLeft(i):this.clearHorizonScrollInterval()}}},t.prototype.horizonScrollIfMouseInTableRight=function(e){var t=this.props,n=t.rectSize;e!==t.contentSize.width-n.width?this.setHorizonScrollInterval(Jr.Left):this.clearHorizonScrollInterval()},t.prototype.horizonScrollIfMouseInTableLeft=function(e){0!==e?this.setHorizonScrollInterval(Jr.Right):this.clearHorizonScrollInterval()},t.prototype.setHorizonScrollInterval=function(e){if(!this.horizonScrollInterval){if(e===Jr.Left)return void this.setHorizonIntervalToLeft();this.setHorizonIntervalToRight()}},t.prototype.setHorizonIntervalToRight=function(){var e=this;this.horizonScrollInterval=setInterval((function(){var t=Math.abs(e.props.scrollLeft),n=Math.max(t-Cr,0);if(e.changeHorizonScrollInfo(n),0===t)return!1===e.selectColActiveForDrag&&e.updateDragColsGraphReminder(),void e.clearHorizonScrollInterval()}),_r)},t.prototype.setHorizonIntervalToLeft=function(){var e=this,t=this.props,n=t.contentSize,r=t.rectSize,o=Math.round(n.width-r.width);this.horizonScrollInterval=setInterval((function(){var t=Math.abs(e.props.scrollLeft),i=Math.min(Cr+t,o);if(e.changeHorizonScrollInfo(i),t===Math.round(n.width-r.width))return!1===e.selectColActiveForDrag&&e.updateDragColsGraphReminder(),void e.clearHorizonScrollInterval()}),_r)},t.prototype.clearHorizonScrollInterval=function(){this.horizonScrollInterval&&clearInterval(this.horizonScrollInterval),this.horizonScrollInterval=null},t.prototype.changeHorizonScrollInfo=function(e){var t=this.props.shares.renderState,n=this.props.cbKey,r=t.getScrollerInfo(n)||{left:0,top:0};r.left=e,t.setScrollerInfo(n,r),this.props.context.fire(new p)},t.prototype.calcSelectedColsInterval=function(){if(-1===this.selectedFirstColIndex)return null;var e=Co(this.selectedFirstColIndex,this.selectedLastColIndex),t=e.beginIndex,n=e.endIndex;return this.props.colHeadersInfo[t].interval.union(this.props.colHeadersInfo[n].interval)},t.prototype.calcSelectedColsRangeAfterMove=function(e,t){if(e[0].gcpBegin>t[0]){var n=t[0],r=t[t.length-1]+e[e.length-1].len;return new Le.ICE(n,r-n)}var o=t[0]-e[0].len,i=t[t.length-1];return new Le.ICE(o,i-o)},t.prototype.showDragColsGraphReminder=function(){var e=this.getColLeftPosInTable(this.targetIndexOnDragCols);this.isXPosInContainerRange(e)?(this.props.showColsOrRowsMoveInstruction(Xr.Col,e),this.setState({showColsMoveCircle:!0,moveCircleLeftPos:e}),this.changeColBlueLineDisplayStatus(this.targetIndexOnDragCols,!0)):this.hideDragColsGraphReminder()},t.prototype.isXPosInContainerRange=function(e){var t=this.props,n=t.rectSize,r=t.scrollLeft,o=t.layoutBox,i=e-Math.abs(r);if(i<0)return!1;var a=(0,s.twipsToPx)(o.edge.border.width.left);return!(i>n.width+2*a)},t.prototype.changeColBlueLineDisplayStatus=function(e,t){if(xo(this.props.context,this.props.layoutBox)){var n=this.getColLeftPosInTable(e);this.props.context.fire(new A(this.props.cbKey,n,t))}},t.prototype.getColLeftPosInTable=function(e){var t=this.props.colHeadersInfo.map((function(e){return e.headerWidth})).slice(0,e).reduce((function(e,t){return e+t}),0),n=(0,s.twipsToPx)(this.props.layoutBox.edge.border.width.left);return 0!==e&&(t-=n),t},t.prototype.getColIndexWithOffsetLeft=function(e){for(var t,n=e,r=this.props.colHeadersInfo,o=0;o<r.length-1&&n-r[o].headerWidth>0;)n-=r[o].headerWidth,o+=1;return n>(null===(t=r[o])||void 0===t?void 0:t.headerWidth)/2&&(o+=1),o},t.prototype.getColsMoveTarget=function(e,t,n,r){var o=this.getTargetColIndexOnColsMove(e,n,r);if(-1===o)return null;var i=this.props.layoutBox.firstChild.children,a=this.props.colHeadersInfo.length,s=o<a?i[o].colBegin:i[a-1].colBegin,c=this.getTargetPosesOnColsDrag(s,o);return c?{targetPoses:c,targetIndex:o}:null},t.prototype.getTargetColIndexOnColsMove=function(e,t,n){var r,o=this,i=null===(r=this.refColsHeader.current)||void 0===r?void 0:r.getBoundingClientRect();if(!i||-1===n||-1===t)return-1;var a=this.props.colHeadersInfo.map((function(e){return e.headerWidth*o.props.zoom})),s=Mo(e,i.left,i.right,a);return s>=t&&s<=n+1?-1:s},t.prototype.getTargetPosesOnColsDrag=function(e,t){return this.props.selectedCellsGCPRanges?t===this.props.colHeadersInfo.length?this.getTargetPosesOnDragColsToLast(this.props.selectedCellsGCPRanges):this.getTargetPosesOnDragColsToBefore(e,this.props.selectedCellsGCPRanges):null},t.prototype.getTargetPosesOnDragColsToLast=function(e){var t,n,r=[],o=this.props.shares.state.getTableStream(),i=this.props.colHeadersInfo[0].firstCellRange.begin(),s=o.getRowInfo(i),c=o.getCellsOfRowRange(s.range,1).cells,l=c[c.length-1].interval.end;try{for(var u=(0,a.__values)(e),d=u.next();!d.done;d=u.next()){var p=d.value.begin(),h=o.getRowInfo(p),f=o.getCellsOfRowRange(h.range,1).cells;if(f[f.length-1].interval.end!==l)return null;r.push(f[f.length-1].range.end())}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return r},t.prototype.getTargetPosesOnDragColsToBefore=function(e,t){var n,r,o,i,s=[],c=this.props.shares.state.getTableStream();try{for(var l=(0,a.__values)(t),u=l.next();!u.done;u=l.next()){var d=u.value.begin(),p=c.getRowInfo(d),h=c.getCellsOfRowRange(p.range,1).cells;try{for(var f=(o=void 0,(0,a.__values)(h)),g=f.next();!g.done;g=f.next()){var v=g.value;if(v.interval.begin===e){s.push(v.range.begin());break}if(!this.isColInCellLeft(e,v.interval))return null}}catch(e){o={error:e}}finally{try{g&&!g.done&&(i=f.return)&&i.call(f)}finally{if(o)throw o.error}}}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}return s},t.prototype.isColInCellLeft=function(e,t){return!(t.begin<e&&t.end>e||t.begin>e)},t.prototype.finishDragCols=function(){this.setState({isDraggingCols:!1}),Do(),this.hideDragColsGraphReminder(),this.clearColsDragCondition(),this.clearHorizonScrollInterval(),this.changeColBlueLineDisplayStatus(0,!1)},t.prototype.clearColsDragCondition=function(){this.props.resetSelectedCells(),this.targetIndexOnDragCols=-1,this.targetPosesOnDragCols=[],this.startXOnDragCols=-1},t.prototype.hideDragColsGraphReminder=function(){this.setState({showColsMoveCircle:!1,moveCircleLeftPos:0}),this.props.hideColsOrRowsMoveInstruction(Xr.Col),this.changeColBlueLineDisplayStatus(0,!1)},t.prototype.isColIndexSelected=function(e){if(-1===this.selectedFirstColBeginGCP)return!1;var t=this.selectedFirstColBeginGCP,n=this.selectedLastColBeginGCP;return t>n&&(t=this.selectedLastColBeginGCP,n=this.selectedFirstColBeginGCP),e.begin()>=t&&e.begin()<=n},t.prototype.calcColAddIconPosInfo=function(e,t,n,r){var o=n.interval,i=n.headerWidth,a=(0,s.pxToTwips)(e-t.left)/this.props.zoom,c=(0,s.twipsToPx)(a-o.begin)>i/2,l=-1*to,u=-1*to/2,d=this.props.scrollLeft+(c?this.getColLeftPosInTable(r+1):this.getColLeftPosInTable(r));return{onRight:c,addIconLeftPos:d+u,addIconTopPos:l,showColAddIcon:!(d<0||Math.floor(d)>this.props.tableScrollWidth)}},t}(ur().Component),No=function(){function e(e){this.scrollHandler=e,this.scrollInterval=null}return e.prototype.scrollIfOutsideThreshold=function(e,t){this.clearScrollInterval();var n=e();n===$r.Bottom?this.setScrollInterval(Cr,e,t):n===$r.Top?this.setScrollInterval(-Cr,e,t):this.clearScrollInterval()},e.prototype.clearScrollInterval=function(){this.scrollInterval&&clearInterval(this.scrollInterval),this.scrollInterval=null},e.prototype.setScrollInterval=function(e,t,n){var r=this;this.scrollInterval||(this.scrollInterval=setInterval((function(){r.scrollHandler.scrollBy(0,e),t()!==$r.Stop?n():r.clearScrollInterval()}),_r))},e}();function Bo(e){var t=[];return document.querySelectorAll(".".concat(e)).forEach((function(e){var n=e.getBoundingClientRect();t.push({left:n.left,top:n.top,bottom:n.bottom})})),t.sort((function(e,t){return e.top-t.top})),0===t.length?null:t}function Fo(e,t){var n=e.clientY,r=n<180,o=n+80>window.innerHeight;if(!r&&!o)return $r.Stop;var i=Bo(t);return i?function(e,t){return e?t[0].top>200?$r.Stop:$r.Top:t[t.length-1].bottom+lo<window.innerHeight?$r.Stop:$r.Bottom}(r,i):$r.Stop}function Uo(e,t,n,r,o,i){e.stopPropagation(),function(e,t,n,r){var o=ko();o&&(o.style.left="".concat(e-to*r/2,"px"),o.style.top="".concat(t-n*r/2,"px"),Ro(e,t,"grabbing"))}(e.clientX,e.clientY,n,i),o.scrollIfOutsideThreshold((function(){return Fo(e,r)}),(function(){t.fire(new D(r,e.clientY))})),t.fire(new D(r,e.clientY))}function Ho(e,t,n,r,o){t.fire(new M(n,e.clientY,o)),Do(),r.clearScrollInterval()}var jo=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={showRowAddIcon:!1,addIconLeftPos:0,addIconTopPos:0,deleteIconLeftPos:-1,deleteIconTopPos:-1,onRight:!1,onBottom:!1,addTargetGCP:null,showRowsMoveCircle:!1,moveCircleLeftPos:0,moveCircleTopPos:0,isDraggingRows:!1,selectRowActiveForCursor:!1},t.refRowsHeader=ur().createRef(),t.selectRowActiveForDrag=!1,t.selectedFirstRowBeginGCP=-1,t.selectedFirstRowEndGCP=-1,t.selectedLastRowBeginGCP=-1,t.selectedFirstRowIndex=-1,t.selectedLastRowIndex=-1,t.lastHoverType=Zr.Undefined,t.lastHoveredRowIndex=-1,t.forbidDragRowsIndexRange=[],t}return(0,a.__extends)(t,e),t.prototype.render=function(){var e=this;this.updateSelectedStatus();var t=this.props,n=t.rectSize,r=t.rowHeadersInfo,o=t.rowHeadersColor;return ur().createElement("div",{className:Ge.tableRowsHeader,style:{height:n.height},onMouseOut:function(){return e.handleMouseOutHeader()},ref:this.refRowsHeader},r.map((function(t,n){return ur().createElement("div",{key:"table-row-header-".concat(n),className:"".concat(Ge.tableSingleRowHeader," ").concat(fo),style:(0,a.__assign)((0,a.__assign)({height:t.headerHeight,backgroundColor:o[n],cursor:e.getRowHeaderCursorStyle(n)},e.getLastRowHeaderStyle(n,r.length)),e.getRowHeaderTopBorderColor(n)),onMouseDown:function(r){return e.handleRowHeaderMouseDown(r,t,n)},onMouseMove:function(n){return e.handleRowHeaderMouseMove(n,t)}})})),this.renderAddIcon(),this.renderRowsMoveCircle())},t.prototype.componentDidMount=function(){this.handleDraggingRowsFn=this.handleDraggingRowsNotification.bind(this),this.props.context.on(r.DRAGGING_TABLE_ROWS,this.handleDraggingRowsFn,this),this.handleFinishDragRowsFn=this.handleFinishDragRowsNotification.bind(this),this.props.context.on(r.FINISH_DRAG_TABLE_ROWS,this.handleFinishDragRowsFn,this)},t.prototype.componentWillUnmount=function(){this.props.context.removeCallBack(r.DRAGGING_TABLE_ROWS,this.handleDraggingRowsFn),this.props.context.removeCallBack(r.FINISH_DRAG_TABLE_ROWS,this.handleFinishDragRowsFn)},t.prototype.getLastRowHeaderStyle=function(e,t){return e===t-1&&this.props.isLastTableBox?{borderBottom:"none",borderBottomLeftRadius:"4px"}:null},t.prototype.getRowHeaderTopBorderColor=function(e){var t=this.props.rowHeadersColor;return 0===e||t[e]===so?null:t[e-1]===so?{borderTopColor:co}:null},t.prototype.handleRowHeaderMouseDown=function(e,t,n){e.stopPropagation();var r=t.beginGCP,o=t.endGCP;if(!1===this.selectRowActiveForDrag&&this.isRowIndexSelected(r)&&this.isRowCanbeDrag(n))return this.setState({isDraggingRows:!0}),void this.handleDragSelectedRows();this.selectRowActiveForDrag=!0,this.setState({selectRowActiveForCursor:!0});var i=this.props.context;if(this.rowDraggingScroller=new No(i.scrollHandler),wo(this.handleMouseMoveOnDragSelect.bind(this),this.handleMouseUpOrLeaveOnDragSelect.bind(this),this.handleMouseUpOrLeaveOnDragSelect.bind(this)),e.shiftKey){if(-1!==this.selectedLastRowBeginGCP&&this.selectedLastRowBeginGCP!==r){this.selectedLastRowBeginGCP=r;var a=this.selectedFirstRowEndGCP-this.selectedFirstRowBeginGCP,s=o-this.selectedLastRowBeginGCP;this.selectedLastRowIndex=n;var c=[new Le.ICE(this.selectedFirstRowBeginGCP,a),new Le.ICE(this.selectedLastRowBeginGCP,s)];this.props.selectColsOrRows(c)}}else this.selectedFirstRowBeginGCP=r,this.selectedFirstRowEndGCP=o,this.selectedLastRowBeginGCP=r,this.selectedFirstRowIndex=n,this.selectedLastRowIndex=-1,this.props.selectColsOrRows([new Le.ICE(r,o-r)])},t.prototype.handleRowHeaderMouseMove=function(e,t){if(e.stopPropagation(),this.refRowsHeader.current){var n=e.clientY,r=this.refRowsHeader.current.getBoundingClientRect(),o=this.calcRowAddIconPosInfo(n,r,t),i=o.onBottom,a=o.addIconLeftPos,s=o.addIconTopPos;if(this.lastHoverType=Zr.Header,s!==this.state.addIconTopPos||!this.state.showRowAddIcon){var c=new Le.ICE(t.beginGCP,t.endGCP-t.beginGCP);this.setState({onBottom:i,addTargetGCP:c,addIconLeftPos:a,addIconTopPos:s,showRowAddIcon:!0})}}},t.prototype.handleMouseMoveOnDragSelect=function(e){var t=this;Ro(e.clientX,e.clientY,"default"),this.rowDraggingScroller.scrollIfOutsideThreshold((function(){return t.resolveScrollTypeOnDragSelect(e)}),(function(){t.updateStatusOnDragSelect(e)})),this.updateStatusOnDragSelect(e)},t.prototype.handleMouseUpOrLeaveOnDragSelect=function(){this.selectRowActiveForDrag=!1,this.setState({selectRowActiveForCursor:!1}),Io(),this.rowDraggingScroller.clearScrollInterval(),Eo()},t.prototype.updateStatusOnDragSelect=function(e){var t,n=null===(t=this.refRowsHeader.current)||void 0===t?void 0:t.getBoundingClientRect();if(n){var r=this.resolveRowIndexOnDragSelect(e.clientY,n.top),o=this.props.rowHeadersInfo[r],i=o.beginGCP,a=o.endGCP;if(this.selectRowActiveForDrag&&-1!==this.selectedFirstRowBeginGCP&&this.selectedLastRowBeginGCP!==i){this.selectedLastRowBeginGCP=i;var s=this.selectedFirstRowEndGCP-this.selectedFirstRowBeginGCP,c=a-this.selectedLastRowBeginGCP;this.selectedLastRowIndex=r;var l=[new Le.ICE(this.selectedFirstRowBeginGCP,s),new Le.ICE(this.selectedLastRowBeginGCP,c)];this.props.selectColsOrRows(l)}}},t.prototype.resolveScrollTypeOnDragSelect=function(e){var t,n,r,o,i=null===(t=this.refRowsHeader.current)||void 0===t?void 0:t.getBoundingClientRect();return i?(n=i.top,r=i.bottom,(o=e.clientY)<180?n>200?$r.Stop:$r.Top:o+80>window.innerHeight?r+lo<window.innerHeight?$r.Stop:$r.Bottom:$r.Stop):$r.Stop},t.prototype.resolveRowIndexOnDragSelect=function(e,t){var n=this.props,r=n.rowHeadersInfo,o=n.zoom,i=0,a=e-t;if(a<=0)return i;for(;a>0&&i<r.length;)a-=r[i].headerHeight*o,i+=1;return i-1},t.prototype.handleDragSelectedRows=function(){if(this.props.selectedCellsGCPRanges){var e=this.props.context,t=_o(this.selectedFirstRowIndex,this.selectedLastRowIndex),n=this.getDragPreviewSize(),r=n.previewWidth,o=n.previewHeight;!function(e,t,n,r){var o=Po(),i=o.previewContainer,a=o.previewHeader,s=o.previewContent;i.className=Ge.dragRowsPreviewContainer,a.className=Ge.dragRowsPreviewHeader,s.className=Ge.dragRowsPreviewContent,a.style.width="".concat(to*r,"px"),a.style.height="".concat(n*r,"px"),a.style.borderRadius="".concat(4*r,"px 0 0 ").concat(4*r,"px"),e>1&&(s.innerText=Oo(Xr.Row,e)),i.style.width="".concat((t+to)*r,"px"),i.style.height="".concat(n*r,"px"),s.style.width="".concat(t*r,"px"),s.style.height="".concat(n*r,"px"),s.style.borderWidth="".concat(1*r,"px"),s.style.fontSize="".concat(14*r,"px")}(t,r,o,this.props.zoom),function(e,t,n,r,o,i){var a=document.body,s=new No(n.scrollHandler),c=null,l=So(a,"mousemove",(function(t){e(t,n,r,o,s,i)})),u=So(a,"mouseup",(function(e){t(e,n,o,s,!0),null==c||c()})),d=So(a,"mouseleave",(function(e){t(e,n,o,s,!1),null==c||c()}));c=function(){l(),u(),d()}}(Uo,Ho,e,o,this.props.cbKey,this.props.zoom)}},t.prototype.handleDraggingRowsNotification=function(e){var t=e.tableCbkey,n=e.clientY;if(t===this.props.cbKey){if(!this.isMousePosInRange(n))return void this.hideDragRowsGraphReminder();var r=this.getRowsMoveTarget(n);if(!r)return void this.hideDragRowsGraphReminder();this.showDragRowsGraphReminder(r.targetRowIndex)}},t.prototype.handleFinishDragRowsNotification=function(e){var t=e.tableCbkey,n=e.clientY,r=e.applyDrag;if(t===this.props.cbKey){if(this.hideDragRowsGraphReminder(),this.setState({isDraggingRows:!1}),!r||!this.isMousePosInRange(n))return;var o=this.getRowsMoveTarget(n);if(!o)return;if(!this.props.selectedCellsGCPRanges)return;var i=this.props.selectedCellsGCPRanges[0];this.props.context.fire(new k(this.props.layoutBox.getRangeBegin(),i,o.targetGcpPos));var a=this.calcSelectedRowsRangeAfterMove(i,o.targetGcpPos);this.props.selectColsOrRows([a])}},t.prototype.renderAddIcon=function(){if(this.props.draggerInfo.rowDraggerShow){var e=this.props.draggerInfo.top;this.lastHoveredRowIndex=this.getRowIndexWithTopOffset(e/this.props.zoom),this.lastHoverType=Zr.Line;var t=e/this.props.zoom-to/2;return this.getRenderAddRowIcon(0,t)}return this.state.showRowAddIcon||this.props.showRowAddIcon?this.getRenderAddRowIcon(this.state.addIconLeftPos,this.state.addIconTopPos):null},t.prototype.getRenderAddRowIcon=function(e,t){return ur().createElement(Vo,(0,a.__assign)({},{left:e,top:t+1,onMouseClick:this.handleClickAddRowIcon.bind(this),onMouseEnter:this.handleEnterAddRowIcon.bind(this,e,t),onMouseLeave:this.handleLeaveAddRowIcon.bind(this)}))},t.prototype.handleEnterAddRowIcon=function(e,t){this.setState({addIconLeftPos:e,addIconTopPos:t}),this.props.onEnterAddRowIcon(e,t)},t.prototype.handleLeaveAddRowIcon=function(){this.props.onLeaveAddRowIcon()},t.prototype.handleClickAddRowIcon=function(){var e=this.getAddRowPosInfo(),t=e.onBottom,n=e.addTargetGCP;this.props.context.fire(new I(this.props.layoutBox.getRangeBegin(),n,this.props.layoutBox.nestingLevel,t))},t.prototype.renderRowsMoveCircle=function(){if(this.state.showRowsMoveCircle){var e=this.state.moveCircleTopPos-to/2+1;return ur().createElement("div",{className:Ge.tableMoveCircle,style:{left:0,top:e}})}return null},t.prototype.getRowIndexWithTopOffset=function(e){var t=this.props.rowHeadersInfo,n=0;if(0===t.length)return-1;for(var r=t[n].headerHeight/2;n<t.length&&r<e;)r+=t[n].headerHeight/2,n+1<t.length&&(r+=t[n+1].headerHeight/2),n+=1;return n},t.prototype.getAddRowPosInfo=function(){var e=this.state,t=e.addTargetGCP,n=e.onBottom;if(this.lastHoverType===Zr.Line){var r=this.props.rowHeadersInfo,o=void 0;this.lastHoveredRowIndex<r.length?(o=this.lastHoveredRowIndex,n=!1):(o=r.length-1,n=!0),t=new Le.ICE(r[o].beginGCP,r[o].endGCP-r[o].beginGCP)}return{onBottom:n,addTargetGCP:t}},t.prototype.updateSelectedStatus=function(){this.props.isRowSelected||this.selectRowActiveForDrag||this.resetSelectedRow(),this.updateSelectedRowIndex(),this.updateForbidDragRowsStatus()},t.prototype.resetSelectedRow=function(){this.selectedFirstRowBeginGCP=-1,this.selectedFirstRowEndGCP=-1,this.selectedLastRowBeginGCP=-1,this.selectedFirstRowIndex=-1,this.selectedLastRowIndex=-1},t.prototype.updateSelectedRowIndex=function(){var e=this.props.selectedCellsGCPRanges;if(e&&!this.props.isTableSelected){var t=e[0];this.props.isRowSelected&&this.updateSelectedGCPOnRowSelected(t),this.props.isColSelected&&!this.selectRowActiveForDrag&&(this.selectedFirstRowBeginGCP=-1,this.selectedFirstRowEndGCP=-1,this.selectedLastRowBeginGCP=-1)}},t.prototype.updateSelectedGCPOnRowSelected=function(e){if(!this.selectRowActiveForDrag){var t=this.getSelectedRowsIndex(e);if(0!==t.length){var n=t[0],r=t[t.length-1],o=this.props.rowHeadersInfo;this.selectedFirstRowBeginGCP!==o[n].beginGCP&&this.selectedFirstRowBeginGCP!==o[r].beginGCP&&(this.selectedFirstRowIndex=n,this.selectedLastRowIndex=r,this.selectedFirstRowBeginGCP=o[this.selectedFirstRowIndex].beginGCP,this.selectedLastRowBeginGCP=o[this.selectedLastRowIndex].beginGCP,this.selectedFirstRowEndGCP=o[this.selectedFirstRowIndex].endGCP)}}},t.prototype.getSelectedRowsIndex=function(e){var t=[];return this.props.rowHeadersInfo.forEach((function(n,r){e.contains(n.beginGCP)&&t.push(r)})),t},t.prototype.getRowHeaderCursorStyle=function(e){var t=this.props.rowHeadersColor;return!this.state.selectRowActiveForCursor&&t[e]===so&&this.isRowCanbeDrag(e)?this.state.isDraggingRows?"grabbing":"grab":"default"},t.prototype.getDragPreviewSize=function(){var e,t,n=Co(this.selectedFirstRowIndex,this.selectedLastRowIndex),r=n.beginIndex,o=n.endIndex;return(e=this.props.contentSize.width)>200&&(e=200),(t=this.props.rowHeadersInfo.map((function(e){return e.headerHeight})).slice(r,o+1).reduce((function(e,t){return e+t}),0))>48&&(t=48),{previewWidth:e,previewHeight:t}},t.prototype.isRowCanbeDrag=function(e){return!this.props.isTableSelected&&(0===this.forbidDragRowsIndexRange.length||e<this.forbidDragRowsIndexRange[0]||e>this.forbidDragRowsIndexRange[1])},t.prototype.hideDragRowsGraphReminder=function(){this.setState({showRowsMoveCircle:!1,moveCircleTopPos:0}),this.props.hideColsOrRowsMoveInstruction(Xr.Row)},t.prototype.showDragRowsGraphReminder=function(e){var t=this.getTargetYPosInTableBox(this.props.layoutBox,e);this.props.showColsOrRowsMoveInstruction(Xr.Row,t),this.setState({showRowsMoveCircle:!0,moveCircleTopPos:t})},t.prototype.isMousePosInRange=function(e){if(!xo(this.props.context,this.props.layoutBox))return!0;var t=Bo(this.props.cbKey),n=this.refRowsHeader.current;if(!t||!n)return!1;var r=n.getBoundingClientRect(),o=this.getTableDomIndex(e,t),i=(t[o].top+t[o].bottom)/2;return i>r.top&&i<r.bottom},t.prototype.getTableDomIndex=function(e,t){for(var n=0;n<t.length;n++){var r=t[n].bottom;if(n+1<t.length&&(r=(t[n].bottom+t[n+1].top)/2),e<r)return n}return t.length-1},t.prototype.getRowsMoveTarget=function(e){var t,n=null===(t=this.refRowsHeader.current)||void 0===t?void 0:t.getBoundingClientRect();if(!n)return null;var r={left:n.left,top:n.top,bottom:n.bottom},o=this.getTargetRowIndexOnDragRows(e,this.props.layoutBox,r),i=this.getRowsMoveTargetGcpPos(this.props.layoutBox,o);return!i||this.isGcpPosAroundSelectRange(i)?null:{targetRowIndex:o,targetGcpPos:i}},t.prototype.getTargetYPosInTableBox=function(e,t){var n=e.edge,r=this.props.rowHeadersInfo.map((function(e){return e.headerHeight})),o=r.slice(0,t).reduce((function(e,t){return e+t}),0);return t===r.length&&(o-=(0,s.twipsToPx)(n.border.width.top)),o},t.prototype.isGcpPosAroundSelectRange=function(e){var t=this.props.selectedCellsGCPRanges;return!t||!(e<t[0].begin()-2||e>t[0].end()+2)},t.prototype.getRowsMoveTargetGcpPos=function(e,t){var n=this.props.shares.state.getTableStream(),r=e.children;if(this.isRowDividedByPaged(t))return null;if(t===r.length){var o=r[r.length-1].getRangeBegin(),i=r[r.length-1].getRangeEnd();return this.isRowBelowNeat(o)?i:null}var a=r[t].getRangeBegin(),s=n.getRowInfo(a,e.nestingLevel);return s?n.isIncludeVMergeContinueCellInRow(s.range.begin(),1)?null:s.range.begin():null},t.prototype.isRowDividedByPaged=function(e){var t,n,r,o,i=this.props.context,s=this.props.layoutBox;if(!i.isPagedView)return!1;if(0===e){var c=s.children[e].children;try{for(var l=(0,a.__values)(c),u=l.next();!u.done;u=l.next())if(void 0!==u.value.prevPartial)return!0}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}}if(e===s.children.length){c=s.children[e-1].children;try{for(var d=(0,a.__values)(c),p=d.next();!p.done;p=d.next())if(void 0!==p.value.nextPartial)return!0}catch(e){r={error:e}}finally{try{p&&!p.done&&(o=d.return)&&o.call(d)}finally{if(r)throw r.error}}}return!1},t.prototype.getTargetRowIndexOnDragRows=function(e,t,n){var r=this,o=t.children.map((function(e){return(0,s.twipsToPx)(e.totalHeight)*r.props.zoom}));return Mo(e,n.top,n.bottom,o)},t.prototype.calcSelectedRowsRangeAfterMove=function(e,t){return e.gcpBegin>t?new Le.ICE(t,e.len):new Le.ICE(t-e.len,e.len)},t.prototype.calcRowAddIconPosInfo=function(e,t,n){var r=this,o=n.beginGCP,i=n.headerHeight,a=this.props,c=a.rowHeadersInfo,l=a.layoutBox,u=(0,s.pxToTwips)(e-t.top)/this.props.zoom,d=c.findIndex((function(e){return e.beginGCP===r.props.firstRowGCPRange.begin()})),p=c.findIndex((function(e){return e.beginGCP===o})),h=c.slice(d,p).reduce((function(e,t){return e+t.headerHeight}),0),f=(0,s.twipsToPx)(u)-h>i/2,g=(f?h+i:h)+-1*to/2;return p===c.length-1&&f&&(g-=(0,s.twipsToPx)(l.edge.border.width.top)),{onBottom:f,addIconLeftPos:0,addIconTopPos:g}},t.prototype.isRowIndexSelected=function(e){if(-1===this.selectedFirstRowBeginGCP)return!1;var t=this.selectedFirstRowBeginGCP,n=this.selectedLastRowBeginGCP;return t>n&&(t=this.selectedLastRowBeginGCP,n=this.selectedFirstRowBeginGCP),e>=t&&e<=n},t.prototype.updateForbidDragRowsStatus=function(){if(!this.props.isRowSelected||this.isSelectedRowsCanbeDraged())this.forbidDragRowsIndexRange=[];else{var e=Co(this.selectedFirstRowIndex,this.selectedLastRowIndex),t=e.beginIndex,n=e.endIndex;this.forbidDragRowsIndexRange=[t,n]}},t.prototype.isSelectedRowsCanbeDraged=function(){var e=this.props.selectedCellsGCPRanges;return!e||!!this.isSelectedFirstRowContainMergedCell(e[0])&&!!this.isRowBelowNeat(e[0].end()-2)},t.prototype.isSelectedFirstRowContainMergedCell=function(e){var t,n,r=this.props.shares.state.getTableStream(),o=r.getRowInfo(e.begin());if(!o)return!1;var i=r.getCellsOfRowRange(o.range,1);try{for(var s=(0,a.__values)(i.cells),c=s.next();!c.done;c=s.next())if(c.value.property.vMerge===Le.m7Q.continue)return!1}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return!0},t.prototype.isRowBelowNeat=function(e){var t,n,r=this.props.shares.state.getTableStream(),o=r.getRowInfo(e);if(!o)return!1;var i=r.getCellsVMergeStatusOfRowRange(o.range,1);if(!i)return!1;try{for(var s=(0,a.__values)(i),c=s.next();!c.done;c=s.next()){var l=c.value;if(l===Le.Ist.main||l===Le.Ist.middle)return!1}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return!0},t.prototype.handleMouseOutHeader=function(){this.setState({showRowAddIcon:!1})},t}(ur().Component),Go=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.colHeadersInfo=[],t.rowHeadersInfo=[],t.totalColHeaderWidth=0,t.isRowSelected=!1,t.isColSelected=!1,t.isTableSelected=!1,t.isFirstTableBox=!0,t.selectedCellsGCPRanges=null,t.headerLeftOffset=0,t}return(0,a.__extends)(t,e),Object.defineProperty(t.prototype,"nestingLevel",{get:function(){return this.props.nestingLevel},enumerable:!1,configurable:!0}),t.prototype.render=function(){this.initHeadersInfo(),this.updateSelectedStatus(),this.selectedCellsGCPRanges=this.getSelectedCellRanges(),this.isFirstTableBox=To(this.props.layoutBox);var e,t=this.getHeadersColor(),n=t.rowHeadersColor,r=t.colHeadersColor,o=t.cornerHeaderColor;return ur().createElement(ur().Fragment,null,this.isFirstTableBox?this.renderCornerHeader(o):null,this.isFirstTableBox?ur().createElement(Lo,(0,a.__assign)({},this.props,{colHeadersInfo:this.colHeadersInfo,colHeaderWidths:this.colHeaderWidths,colHeadersColor:r,totalColHeaderWidth:this.totalColHeaderWidth,isColSelected:this.isColSelected,isRowSelected:this.isRowSelected,isTableSelected:this.isTableSelected,leftOffset:this.headerLeftOffset,selectColsOrRows:this.selectColsOrRows.bind(this),selectedCellsGCPRanges:this.selectedCellsGCPRanges,onEnterAddColIcon:this.handleEnterAddColIcon.bind(this),onLeaveAddColIcon:this.handleLeaveAddColIcon.bind(this),resetSelectedCells:this.resetSelectedCells.bind(this)})):null,ur().createElement(jo,(0,a.__assign)({},this.props,{rowHeadersInfo:this.rowHeadersInfo,rowHeadersColor:n,isColSelected:this.isColSelected,isRowSelected:this.isRowSelected,isTableSelected:this.isTableSelected,firstRowGCPRange:this.firstRowGCPRange,selectColsOrRows:this.selectColsOrRows.bind(this),selectedCellsGCPRanges:this.selectedCellsGCPRanges,isLastTableBox:(e=this.props.layoutBox,Ue.s9.getLastTableBox(e)===e),resetSelectedCells:this.resetSelectedCells.bind(this)})))},t.prototype.componentDidMount=function(){xo(this.props.context,this.props.layoutBox)&&(this.handleColBlueLineDisplayFn=this.handleColBlueLineDisplay.bind(this),this.props.context.on(r.TABLE_COL_BLUE_LINE_DISPLAY,this.handleColBlueLineDisplayFn,this))},t.prototype.componentWillUnmount=function(){xo(this.props.context,this.props.layoutBox)&&this.props.context.removeCallBack(r.TABLE_COL_BLUE_LINE_DISPLAY,this.handleColBlueLineDisplayFn)},t.prototype.getSelectedCellRanges=function(){var e=this.props.shares.state.selection.tableSelectionArea;if(!e)return null;var t=e.cellRanges;return t[0]?t[0].getRanges():null},t.prototype.resetSelectedCells=function(){this.selectedCellsGCPRanges=null},t.prototype.selectColsOrRows=function(e){this.props.context.fire(new T(e))},t.prototype.handleEnterAddColIcon=function(e,t){this.props.onEnterAddColIcon(e,t);var n=e+this.props.tableScrollLeft+to/2;this.changeColBlueLineDisplayStatus(n,!0)},t.prototype.handleLeaveAddColIcon=function(){this.props.onLeaveAddColIcon(),this.changeColBlueLineDisplayStatus(-1,!1)},t.prototype.changeColBlueLineDisplayStatus=function(e,t){xo(this.props.context,this.props.layoutBox)&&this.props.context.fire(new A(this.props.cbKey,e,t))},t.prototype.handleCornerHeaderClick=function(e){e.stopPropagation(),this.props.selTable()},t.prototype.getHeadersColorBySelection=function(){var e=this.props,t=e.selectedRange,n=e.selectedCellRanges;return t?this.isTableSelected?{rowHeadersColor:this.generateColors(this.rowHeadersInfo,so),colHeadersColor:this.generateColors(this.colHeadersInfo,so)}:this.getHeadersColorExceptTableSelected(t,n):{rowHeadersColor:[],colHeadersColor:[]}},t.prototype.getHeadersColorExceptTableSelected=function(e,t){var n=this,r=[],o=[];if(this.isRowSelected)r=this.rowHeadersInfo.map((function(t){return n.getRowHeaderColor(t,e)})),o=this.generateColors(this.colHeadersInfo,ao);else if(this.isColSelected){var i=[];t.forEach((function(e){i.push.apply(i,(0,a.__spreadArray)([],(0,a.__read)(e.getRanges()),!1))})),o=this.colHeadersInfo.map((function(e){return n.getColHeaderColor(e,i)})),r=this.generateColors(this.rowHeadersInfo,ao)}else r=this.getRowHeadersColorOnFocus(),o=this.getColHeadersColorOnFocus();return{rowHeadersColor:r,colHeadersColor:o}},t.prototype.getColHeadersColorOnFocus=function(){var e=this.props,t=e.selectedRange,n=e.shares,r=e.selectedCellRanges,o=n.state.getTableStream(),i=o.getCellInfo(t.begin(),this.nestingLevel);return i?Array.isArray(r)&&r.length>0?this.getColsHeaderColorOnMultiSelect(r,o):this.getColsHeaderColorOnClickCell(i,o):this.generateColors(this.colHeadersInfo,io)},t.prototype.getColsHeaderColorOnMultiSelect=function(e,t){var n=this,r=[];e.forEach((function(e){r.push.apply(r,(0,a.__spreadArray)([],(0,a.__read)(e.getRanges()),!1))}));var o=[];return r.forEach((function(e){var n,r=null===(n=t.getCellsOfRowRange(e,1))||void 0===n?void 0:n.cells;Array.isArray(r)&&r.length>0&&o.push.apply(o,(0,a.__spreadArray)([],(0,a.__read)(r),!1))})),this.colHeadersInfo.map((function(e){return n.getSingleColHeaderColor(o,e.interval)}))},t.prototype.getColsHeaderColorOnClickCell=function(e,t){var n=e.range.begin(),r=t.getCellInterval(n);return this.colHeadersInfo.map((function(e){return r.isIntersect(e.interval)?ao:io}))},t.prototype.getSingleColHeaderColor=function(e,t){return e.find((function(e){return e.interval.isIntersect(t)}))?ao:io},t.prototype.getRowHeadersColorOnFocus=function(){var e=this.props,t=e.selectedRange,n=e.shares,r=e.selectedCellRanges,o=n.state.getTableStream(),i=o.getRowInfo(t.begin(),this.nestingLevel);return i?Array.isArray(r)&&r.length>0?this.getRowsHeaderColorOnMultiSelect(r,o):this.getRowsHeaderColorOnClickCell(i):this.generateColors(this.rowHeadersInfo,io)},t.prototype.getRowsHeaderColorOnMultiSelect=function(e,t){var n=[];e.forEach((function(e){n.push.apply(n,(0,a.__spreadArray)([],(0,a.__read)(e.getRanges()),!1))}));var r=n.map((function(e){var n;return null===(n=t.getRowInfo(e.begin()))||void 0===n?void 0:n.range.begin()}),this.nestingLevel);return this.rowHeadersInfo.map((function(e){return r.includes(e.beginGCP)?ao:io}))},t.prototype.getRowsHeaderColorOnClickCell=function(e){var t=e.range.begin();return this.rowHeadersInfo.map((function(e){return e.beginGCP===t?ao:io}))},t.prototype.getRowHeaderColor=function(e,t){var n=new Le.ICE(e.beginGCP,e.endGCP-e.beginGCP);return t.contains(n)?so:io},t.prototype.getColHeaderColor=function(e,t){return t.find((function(t){return t.contains(e.firstCellRange)}))?so:io},t.prototype.generateColors=function(e,t){return e.map((function(){return t}))},t.prototype.updateSelectedStatus=function(){var e=this.props,t=e.selectedRange,n=e.selectedCellRanges;if(!t||!n||0===n.length)return this.isColSelected=!1,this.isRowSelected=!1,void(this.isTableSelected=!1);this.isColSelected=this.isRangeCoverCol(t),this.isRowSelected=this.isRangeCoverRow(n),this.isTableSelected=this.isRowSelected&&this.isColSelected},t.prototype.isRangeCoverCol=function(e){return!!this.colHeadersInfo.find((function(t){return e.contains(t.firstCellRange)&&e.contains(t.lastSelectCellRange)}))},t.prototype.isRangeCoverRow=function(e){return this.rowHeadersInfo.some((function(t){var n=new Le.ICE(t.beginGCP,t.endGCP-t.beginGCP);return e.some((function(e){return e.isContain(n)}))}))},t.prototype.getHeadersColor=function(){var e=io;this.isTableSelected&&(e=so);var t=this.getHeadersColorBySelection();return(0,a.__assign)((0,a.__assign)({},t),{cornerHeaderColor:e})},t.prototype.initHeadersInfo=function(){var e=this.props.shares.state,t=e.getTableStream(),n=e.getTextStream();this.initRowHeadersInfo(t),this.initColHeadersInfo(t,n)},t.prototype.initRowHeadersInfo=function(e){var t=this,n=this.getTableRowBox();0!==n.length&&(this.firstRowGCPRange=n[0].getRange(),this.rowHeadersInfo=[],n.forEach((function(r,o){var i=r.getRangeBegin(),a=e.getRowInfo(i,t.nestingLevel);if(a){var s=a.range.end();t.rowHeadersInfo.push({headerHeight:t.calRowHeaderHeight(r,o===n.length-1),beginGCP:i,endGCP:s})}})))},t.prototype.initColHeadersInfo=function(e,t){this.totalColHeaderWidth=0;var n=Ue.s9.getFirstTableBox(this.props.layoutBox).firstChild;if(n){var r=n.children;this.headerLeftOffset=n.edge.margin.left,this.colHeaderWidths=r.map((function(e){return e.totalWidth}));var o=this.getCellsDetailOfBorderRow(e,t,n);if(o){var i=o.firstCellsDetail,a=o.lastCellsDetail;this.resolveColHeadersInfo(i,a,r)}}},t.prototype.getCellsDetailOfBorderRow=function(e,t,n){var r=this.getCellsDetailOfRow(t,e,n);if(!r)return null;var o=Ue.s9.getLastTableBox(this.props.layoutBox),i=this.getTableRowBox(o);if(0===i.length)return null;var a=i[i.length-1],s=this.getCellsDetailOfRow(t,e,a);return s?{firstCellsDetail:r,lastCellsDetail:s}:null},t.prototype.getTableRowBox=function(e){return(null!=e?e:this.props.layoutBox).children.filter((function(e){return e.children.length>0}))},t.prototype.getCellsDetailOfRow=function(e,t,n){var r=n.getRange(),o=t.getRowInfo(r.begin(),this.nestingLevel);return o?t.getCellsOfRowRange(o.range,this.nestingLevel):null},t.prototype.resolveColHeadersInfo=function(e,t,n){var r=this;this.colHeadersInfo=e.cells.map((function(o,i){var a=o.interval,s=o.range,c=o.range;t.cells.forEach((function(e){e.interval.isIntersect(a)&&(s=s?s.unionRange(e.range):e.range,c=s)}));var l=r.calcColHeaderWidth(n[i],0===i);return r.totalColHeaderWidth+=l,{headerWidth:l,interval:a,firstCellRange:e.cells[i].range,lastCellRange:s,lastSelectCellRange:c}}))},t.prototype.calRowHeaderHeight=function(e,t){var n=this.props.layoutBox.edge.border.width.top,r=Ue.MM.getOffsetPoint(e,Fe.uO.Document).y-n,o=this.getSharpTwips(r+e.totalHeight)-this.getSharpTwips(r);return(0,s.twipsToPx)(o+(t?n:0))},t.prototype.calcColHeaderWidth=function(e,t){if(!e)return 0;var n=this.props.layoutBox.edge.border.width.left,r=Ue.MM.getOffsetPoint(e,Fe.uO.Document).x-n,o=this.getSharpTwips(r+e.totalWidth)-this.getSharpTwips(r);return(0,s.twipsToPx)(o+(t?n:0))},t.prototype.getSharpTwips=function(e){var t=(0,s.twipsToPx)(e);return(0,s.pxToTwips)(Math.round(t)+.5)},t.prototype.findMainCellRange=function(e,t){var n=e.range.begin(),r=t.getMergedMapping(n),o=t.getRowIndex(n),i=null==r?void 0:r.getMainCell(o,e.interval.begin);if(i){var a=t.getRowIndex(this.firstRowGCPRange.begin()),s=i.rowIndex-a,c=this.rowHeadersInfo[s];if(c){var l=t.getRowInfo(c.beginGCP,this.nestingLevel),u=t.getCellsOfRowRange(l.range,1),d=null==u?void 0:u.cells.find((function(e){return e.interval.begin===i.colBegin}));if(d)return d.range}}return null},t.prototype.handleColBlueLineDisplay=function(e){var t=e.tableCbkey,n=e.leftPos,r=e.show;t===this.props.cbKey&&(r?this.props.showColsOrRowsMoveInstruction(Xr.Col,n):this.props.hideColsOrRowsMoveInstruction(Xr.Col))},t.prototype.renderCornerHeader=function(e){var t=this;return ur().createElement("div",{className:Ge.tableCornerHeader,style:{backgroundColor:e},onClick:function(e){return t.handleCornerHeaderClick(e)}})},t}(ur().Component),Vo=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleMouseClick=function(e){t.props.onMouseClick(),e.stopPropagation()},t.handleMouseEnter=function(e){t.props.onMouseEnter(),e.stopPropagation()},t.handleMouseLeave=function(e){t.props.onMouseLeave(),e.stopPropagation()},t}return(0,a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.left,n=e.top;return ur().createElement("svg",{className:je.tableAddIcon,style:{left:t,top:n},onClick:this.handleMouseClick,onMouseDown:this.handleMouseClick,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,viewBox:"0 0 12 12"},ur().createElement("g",null,ur().createElement("path",{fill:"#FFF",d:"M6.75,3 L6.75,5.25 L9,5.25 L9,6.75 L6.749,6.75 L6.75,9 L5.25,9 L5.249,6.75 L3,6.75 L3,5.25 L5.25,5.25 L5.25,3 L6.75,3 Z"})))},t}(ur().PureComponent),Wo=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={leftOffset:0,topOffset:0,showBorderRect:!1,isMouseDown:!1,isMouseMove:!1,startX:0,startY:0},t.removeHandler=null,t.handleMouseDown=function(e){var n=e.clientX,r=e.clientY;e.stopPropagation(),t.removeHandler=wo(t.handleMouseMove.bind(t),t.handleMouseUp.bind(t),t.handleMouseLeave.bind(t)),t.setState({isMouseDown:!0,startX:n/t.zoom,startY:r/t.zoom})},t.handleMouseMove=function(e){var n=e.clientX,r=e.clientY;t.state.isMouseDown&&t.setState({showBorderRect:!0,isMouseMove:!0,leftOffset:n/t.zoom-t.state.startX,topOffset:r/t.zoom-t.state.startY})},t.handleMouseUp=function(){if(!t.state.isMouseMove)return t.props.selTable(),void t.setState({isMouseDown:!1,showBorderRect:!1});t.handleTableScale()},t.handleMouseLeave=function(){t.handleTableScale()},t.handleTableScale=function(){var e=t.state,n=e.leftOffset,r=e.topOffset;t.props.onFinish&&t.props.onFinish(n,r),t.state.isMouseDown&&t.setState({isMouseDown:!1,isMouseMove:!1,showBorderRect:!1})},t}return(0,a.__extends)(t,e),Object.defineProperty(t.prototype,"zoom",{get:function(){return this.props.zoom||1},enumerable:!1,configurable:!0}),t.prototype.removeMouseHandler=function(){this.removeHandler&&(this.removeHandler(),this.removeHandler=null)},t.prototype.componentWillUnmount=function(){this.removeMouseHandler()},t.prototype.render=function(){var e=this,t=this.props,n=t.width,r=t.height,o={top:r-9+this.state.topOffset,left:n-9+this.state.leftOffset,width:18,height:18,cursor:"nwse-resize"};return this.state.showBorderRect&&(o={top:r-15+this.state.topOffset,left:n-15+this.state.leftOffset,width:30,height:30,cursor:"crosshair"}),ur().createElement(ur().Fragment,null,ur().createElement("div",{className:je.tableScaleDraggerRect,style:{width:n+this.state.leftOffset,height:r+this.state.topOffset,display:this.state.showBorderRect?"block":"none"}}),ur().createElement("div",{className:je.tableScaleGuide,style:{top:r-5-1+this.state.topOffset,left:n-5+this.state.leftOffset,backgroundColor:this.state.showBorderRect?"#1e6fff":"#CBCDD1"}}),ur().createElement("div",{className:"".concat(je.tableScaleDragger," ").concat(fo),style:(0,a.__assign)({},o),onMouseDown:function(t){return e.handleMouseDown(t)}}))},t}(ur().PureComponent),zo=function(){function e(){this.updating=!1,this.watchers=[]}return Object.defineProperty(e.prototype,"isUpdating",{get:function(){return this.updating},enumerable:!1,configurable:!0}),e.prototype.willUpdate=function(){this.updating=!0},e.prototype.afterUpdate=function(){var e,t;this.updating=!1;try{for(var n=(0,a.__values)(this.watchers),r=n.next();!r.done;r=n.next())r.value.afterUpdate()}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},e.prototype.addWatcher=function(e){this.watchers.push(e),this.updating||e.afterUpdate()},e.prototype.removeWatcher=function(e){this.watchers.slice(this.watchers.indexOf(e))},e}(),Ko=Symbol("ILazyRenderManager"),qo=function(){function e(t,n){void 0===n&&(n=""),this.children=[],this.firstChildIndex=0,this.lastChildIndex=e.MAX_LOAD_INDEX,this.isLoaded=t,this.tag=n}return e.prototype.clone=function(){var t=new e(this.isLoaded,this.tag);return t.children=this.children,t.firstChildIndex=this.firstChildIndex,t.lastChildIndex=this.lastChildIndex,t},Object.defineProperty(e.prototype,"size",{get:function(){return this.children.length},enumerable:!1,configurable:!0}),e.prototype.setSize=function(e){this.children.length=e},e.prototype.setChildIndexRange=function(e,t){this.firstChildIndex=e,this.lastChildIndex=t,this.fill(Qo,0,e),this.setSize(t+1)},e.prototype.childAt=function(e){return this.children[e]||Qo},e.prototype.insert=function(e,t){this.children[e]=t},e.prototype.delete=function(e){delete this.children[e]},e.prototype.fill=function(e,t,n){this.children.length<n&&(this.children.length=n),this.children.fill(e,t,n)},e.prototype.equal=function(e){return this===e},e.prototype.isEmpty=function(){for(var e=0;e<this.size;e++)if(this.childAt(e)!==Qo)return!1;return!0},e.MAX_LOAD_INDEX=Number.MAX_SAFE_INTEGER,e}(),Yo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.childAt=function(){return this},t}(qo),Qo=new Yo(!1),Zo=new Yo(!0),Xo=function(){function e(){this.needFullRender=!1}return Object.defineProperty(e.prototype,"lazyRenderInfo",{get:function(){return this.needFullRender?Zo:this._lazyRenderInfo},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullRenderInfo",{get:function(){return Zo},enumerable:!1,configurable:!0}),e.prototype._updateChildInfo=function(e,t){var n,r=!1;return e instanceof Yo?(n=new qo(!0,t),r=!0):n=e.clone(),{newChildInfo:n,needUpdate:r}},e.prototype._updateChildLazy=function(e,t,n,r,o,i){var a=(0,Fe.pm)(r)?r.kind:(0,Fe.$o)(r),s=this._updateChildInfo(t.childAt(o),a.toString()),c=s.newChildInfo;return t.insert(o,c),e.push({parentBox:r,parentLazyInfo:c,grandparentType:n,topForParent:i,loadFirstIndex:-1,loadLastIndex:-1}),s.needUpdate},e.prototype._checkNeedUpdate=function(e,t){var n=t.firstBox,r=t.lastBox,o=t.lazyStack,i=t.parentLazyInfo,a=t.parentBox,s=t.firstIndex,c=t.lastIndex,l=t.topForParent,u=!1,d=!1,p=e;(0,Fe.UB)(n)&&this._isFirstBoxTooLarge(n)&&(p=this._updateChildLazy(o,i,a.kind,n,s,l)||p,u=!0),(0,Fe.UB)(r)&&this._isLastBoxTooLarge(r,n)&&(p=this._updateChildLazy(o,i,a.kind,r,c,l)||p,d=!0);for(var h=u?s+1:s;h<=(d?c-1:c);h++)i.childAt(h)!==Zo&&(i.insert(h,Zo),p=!0);return p},e}(),Jo=function(e){function t(){var t=e.call(this)||this;return t._lazyRenderInfo=new Yo(!1),t}return(0,a.__extends)(t,e),t.prototype._isFirstBoxTooLarge=function(){return!1},t.prototype.updateLazyRenderInfo=function(){return!1},t.prototype._isLastBoxTooLarge=function(){return!1},t}(Xo);function $o(e){var t;return ur().createElement("line",{className:"para-svg-border-line",x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,stroke:e.color,strokeWidth:e.strokeWidth,strokeDasharray:null!==(t=e.strokeDasharray)&&void 0!==t?t:""})}function ei(e){for(var t=5*e,n=4*e,r=t/4,o=n/4,i="M0 ".concat(o),a=0,s=Math.ceil(60/e);a<s;)i+="L".concat(t*a*2+t-r," ").concat(n-o),i+="Q".concat(t*a*2+t," ").concat(n," ").concat(t*a*2+t+r," ").concat(n-o),i+="L".concat(t*(a+1)*2-r," ").concat(o),i+="Q".concat(t*(a+1)*2," 0 ").concat(t*(a+1)*2+r," ").concat(o),a+=1;return i}function ti(e){return ur().createElement("path",{className:"para-svg-border-path",d:ei(e.strokeWidth),stroke:e.color,strokeLinejoin:"round",strokeWidth:e.strokeWidth,fill:"none"})}function ni(e){var t=1.33*e.strokeWidth;return $o({x1:"0px",y1:.5*t,x2:"100%",y2:.5*t,color:e.fillColor,strokeWidth:t})}function ri(e){var t=1.33*e.strokeWidth;return $o({x1:"0px",y1:.5*t,x2:"100%",y2:.5*t,color:e.fillColor,strokeWidth:t,strokeDasharray:"".concat(1*t,",").concat(1*t)})}function oi(e){var t=1.33*e.strokeWidth;return $o({x1:"0px",y1:.5*t,x2:"100%",y2:.5*t,color:e.fillColor,strokeWidth:t,strokeDasharray:"".concat(4*t,",").concat(1*t)})}function ii(e){var t=1.33*e.strokeWidth;return $o({x1:"0px",y1:.5*t,x2:"100%",y2:.5*t,color:e.fillColor,strokeWidth:t,strokeDasharray:"".concat(3.75*t,",").concat(3.75*t)})}function ai(e){var t=1.33*e.strokeWidth;return $o({x1:"0px",y1:.5*t,x2:"100%",y2:.5*t,color:e.fillColor,strokeWidth:t,strokeDasharray:"".concat(6*t,",\n            ").concat(2*t,",\n            ").concat(2*t,",\n            ").concat(2*t)})}function si(e){var t=1.33*e.strokeWidth;return $o({x1:"0px",y1:.5*t,x2:"100%",y2:.5*t,color:e.fillColor,strokeWidth:t,strokeDasharray:"".concat(5*t,",\n            ").concat(2*t,",\n            ").concat(1.5*t,",\n            ").concat(2*t,",\n            ").concat(1.5*t,",\n            ").concat(2*t)})}function ci(e){var t={x1:"0px",y1:.5*e.strokeWidth,x2:"100%",y2:.5*e.strokeWidth,color:e.fillColor,strokeWidth:e.strokeWidth},n=(0,a.__assign)((0,a.__assign)({},t),{y1:2.5*e.strokeWidth,y2:2.5*e.strokeWidth});return ur().createElement("g",null,$o(t),$o(n))}function li(e){var t={x1:"0px",y1:.5*e.strokeWidth,x2:"100%",y2:.5*e.strokeWidth,color:e.fillColor,strokeWidth:e.strokeWidth},n=(0,a.__assign)((0,a.__assign)({},t),{y1:2.5*e.strokeWidth,y2:2.5*e.strokeWidth}),r=(0,a.__assign)((0,a.__assign)({},t),{y1:4.5*e.strokeWidth,y2:4.5*e.strokeWidth});return ur().createElement("g",null,$o(t),$o(n),$o(r))}function ui(e,t){return function(n){var r=n.fillColor,o=n.strokeWidth,i={color:r,strokeWidth:o,x1:"0",y1:0,x2:"100%",y2:0},s=(0,a.__assign)({},i),c=null;return"thinThick"===e&&"small"===t&&(i.strokeWidth=2*o,i.y1=1*o,i.y2=1*o,s.strokeWidth=.7*o,s.y1=3.35*o,s.y2=3.35*o),"thickThin"===e&&"small"===t&&(i.strokeWidth=.7*o,i.y1=.35*o,i.y2=.35*o,s.strokeWidth=2*o,s.y1=2.7*o,s.y2=2.7*o),"thinThickThin"===e&&"small"===t&&(i.strokeWidth=.7*o,i.y1=.35*o,i.y2=.35*o,s.strokeWidth=2*o,s.y1=2.7*o,s.y2=2.7*o,(c=(0,a.__assign)({},i)).y1=5.05*o,c.y2=5.05*o),"thinThick"===e&&"medium"===t&&(i.strokeWidth=1.33*o,i.y1=.66*o,i.y2=.66*o,s.strokeWidth=.7*o,s.y1=2.65*o,s.y2=2.65*o),"thickThin"===e&&"medium"===t&&(i.strokeWidth=.7*o,i.y1=.35*o,i.y2=.35*o,s.strokeWidth=1.33*o,s.y1=2.35*o,s.y2=2.35*o),"thinThickThin"===e&&"medium"===t&&(i.strokeWidth=.7*o,i.y1=.35*o,i.y2=.35*o,s.strokeWidth=1.33*o,s.y1=2.35*o,s.y2=2.35*o,(c=(0,a.__assign)({},i)).y1=4.35*o,c.y2=4.35*o),"thinThick"===e&&"large"===t&&(i.strokeWidth=1.75*o,i.y1=.85*o,i.y2=.85*o,s.y1=4.25*o,s.y2=4.25*o),"thickThin"===e&&"large"===t&&(i.y1=.5*o,i.y2=.5*o,s.strokeWidth=1.75*o,s.y1=4*o,s.y2=4*o),"thinThickThin"===e&&"large"===t&&(i.y1=.5*o,i.y2=.5*o,s.strokeWidth=1.75*o,s.y1=3.85*o,s.y2=3.85*o,(c=(0,a.__assign)({},i)).y1=7.25*o,c.y2=7.25*o),ur().createElement(ur().Fragment,null,$o(i),$o(s),c&&$o(c))}}function di(e){return ti({color:e.fillColor,strokeWidth:e.strokeWidth})}function pi(e){var t={color:e.fillColor,strokeWidth:e.strokeWidth};return ur().createElement(ur().Fragment,null,ur().createElement("g",null,ti(t)),ur().createElement("g",{transform:"translate(0,".concat(3*e.strokeWidth,")")},ti(t)))}function hi(e){var t={x1:"0px",y1:.5*e.strokeWidth,x2:"100%",y2:.5*e.strokeWidth,color:e.fillColor,strokeWidth:e.strokeWidth};return ur().createElement(ur().Fragment,null,$o(t))}function fi(e){var t={x1:"0px",y1:.5*e.strokeWidth,x2:"100%",y2:.5*e.strokeWidth,color:"#d6d6d6",strokeWidth:e.strokeWidth},n=(0,a.__assign)((0,a.__assign)({},t),{y1:4.5*e.strokeWidth,y2:4.5*e.strokeWidth,color:e.fillColor});return ur().createElement(ur().Fragment,null,$o(n))}function gi(e){var t=e.fillColor,n=e.strokeWidth,r="pattern-".concat(Date.now());return ur().createElement(ur().Fragment,null,ur().createElement("defs",null,ur().createElement("pattern",{id:r,x:"0",y:"0",width:6*n,height:4*n,patternUnits:"userSpaceOnUse",patternTransform:"skewX(-45)"},ur().createElement("g",null,ur().createElement("rect",{x:"0",y:"0",width:4*n,height:4*n,fill:t}),ur().createElement("rect",{x:4.5*n,y:"0",width:n,height:4*n,fill:t})))),ur().createElement("rect",{fill:"url(#".concat(r,")"),x:"0",y:"0",width:"100%",height:4*n}))}function vi(e){return function(t){var n,r,o,i=(n=t.fillColor,r=function(e,t){var n=e;"#"===n[0]&&(n=n.slice(1));var r=parseInt(n,16),o=function(e){var t=Math.floor(e),n=Math.min(Math.max(t,0),255).toString(16);return 1===n.length?"0".concat(n):n},i=o((r>>16)*(3-t)/3),a=o((r>>8&255)*(3-t)/3),s=o((255&r)*(3-t)/3);return"#".concat(i).concat(a).concat(s)},function(e){var t=e;"#"===t[0]&&(t=t.slice(1));var n=parseInt(t,16);return n>>16<50&&(n>>8&255)<50&&(255&n)<50}(o=n)&&(o="#c0c0c0"),[r(o,0),r(o,1),r(o,2)]),s={x1:"0px",y1:.5*t.strokeWidth,x2:"100%",y2:.5*t.strokeWidth,color:"emboss"===e?i[0]:i[2],strokeWidth:t.strokeWidth},c=(0,a.__assign)((0,a.__assign)({},s),{y1:2*t.strokeWidth,y2:2*t.strokeWidth,strokeWidth:2*t.strokeWidth,color:i[1]}),l=(0,a.__assign)((0,a.__assign)({},s),{y1:3.5*t.strokeWidth,y2:3.5*t.strokeWidth,color:"emboss"===e?i[2]:i[0]});return ur().createElement(ur().Fragment,null,$o(s),$o(c),$o(l))}}function yi(e,t){var n;switch(e){case Le.EJ9.double:n=3*t;break;case Le.EJ9.triple:n=5*t;break;case Le.EJ9.thinThickSmallGap:case Le.EJ9.thickThinSmallGap:n=3.7*t;break;case Le.EJ9.thinThickThinSmallGap:n=5.6*t;break;case Le.EJ9.thinThickMediumGap:case Le.EJ9.thickThinMediumGap:n=3*t;break;case Le.EJ9.thinThickThinMediumGap:n=4.8*t;break;case Le.EJ9.thinThickLargeGap:case Le.EJ9.thickThinLargeGap:n=4.75*t;break;case Le.EJ9.thinThickThinLargeGap:n=7.75*t;break;case Le.EJ9.wave:n=6*t;break;case Le.EJ9.doubleWave:n=9*t;break;case Le.EJ9.inset:case Le.EJ9.outset:n=5*t;break;case Le.EJ9.threeDEmboss:case Le.EJ9.threeDEngrave:case Le.EJ9.dashDotStroked:n=4*t;break;default:n=t}return n=Math.ceil(n)}(function(){function e(e,t){this._idleConsumeTime=null!=e?e:50,this._rafConsumeTime=null!=t?t:10,this._toUpdateQueue=[]}e.prototype.filterInvaldTask=function(){this._toUpdateQueue=this._toUpdateQueue.filter((function(e){return e.isValid()}))},e.prototype.addTask=function(e){0===this._toUpdateQueue.length&&this.delayCommitTask(),this._toUpdateQueue.push(e)},e.prototype.removeTaskForKey=function(e){this._toUpdateQueue=this._toUpdateQueue.filter((function(t){return t.key!==e}))},e.prototype.delayCommitTask=function(){var e=this;"requestIdleCallback"in window?window.requestIdleCallback((function(){e.commitTask(e._idleConsumeTime)}),{timeout:3e3}):requestAnimationFrame((function(){e.commitTask(e._rafConsumeTime)}))},e.prototype.commitTask=function(e){this.filterInvaldTask();for(var t=window.performance.now();this._toUpdateQueue.length>0;){var n=this._toUpdateQueue.shift();if((null==n?void 0:n.isValid())&&n.update(Zo),window.performance.now()-t>e)break}this._toUpdateQueue.length>0&&this.delayCommitTask()},e.prototype.flushLazyTask=function(){this.commitTask(Number.MAX_SAFE_INTEGER)},e.prototype.clearLazyTask=function(){this._toUpdateQueue=[]}})(),function(){function e(e){this.lazyRenderInfo=e,this.firstUnloadTotalHeight=0}e.prototype.getUnloadBoxNode=function(e,t,n){return t<this.lazyRenderInfo.firstChildIndex?(this.firstUnloadTotalHeight+=e.totalHeight,t+1===this.lazyRenderInfo.firstChildIndex?ur().createElement("div",{className:n,key:"pre-".concat(t),style:{height:(0,s.twipsToPx)(this.firstUnloadTotalHeight)}}):null):t>this.lazyRenderInfo.lastChildIndex?null:void 0}}();var mi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.type,n=e.borderLength,r=e.color,o=e.strokeWidth,i={strokeWidth:.75*o,fillColor:Le.QBv.parseHexColor(r)},a=function(e){switch(e){case Le.EJ9.thick:return ni;case Le.EJ9.dotted:return ri;case Le.EJ9.dashSmallGap:return oi;case Le.EJ9.dashed:return ii;case Le.EJ9.dotDash:return ai;case Le.EJ9.dotDotDash:return si;case Le.EJ9.double:return ci;case Le.EJ9.triple:return li;case Le.EJ9.thinThickSmallGap:return ui("thinThick","small");case Le.EJ9.thickThinSmallGap:return ui("thickThin","small");case Le.EJ9.thinThickThinSmallGap:return ui("thinThickThin","small");case Le.EJ9.thinThickMediumGap:return ui("thinThick","medium");case Le.EJ9.thickThinMediumGap:return ui("thickThin","medium");case Le.EJ9.thinThickThinMediumGap:return ui("thinThickThin","medium");case Le.EJ9.thinThickLargeGap:return ui("thinThick","large");case Le.EJ9.thickThinLargeGap:return ui("thickThin","large");case Le.EJ9.thinThickThinLargeGap:return ui("thinThickThin","large");case Le.EJ9.wave:return di;case Le.EJ9.doubleWave:return pi;case Le.EJ9.inset:return hi;case Le.EJ9.outset:return fi;case Le.EJ9.threeDEmboss:return vi("emboss");case Le.EJ9.threeDEngrave:return vi("engrave");case Le.EJ9.dashDotStroked:return gi;default:return ni}}(t);return ur().createElement("svg",{className:t,width:n,height:yi(t,o)},ur().createElement("g",null,a(i)))},t}(ur().Component)},6956:function(e,t,n){n.d(t,{T:function(){return v}});var r=n(87363),o=n.n(r),i=n(85556),a=n(30479),s=n(61251),c=n(82487),l=n(46016),u=n(31518),d=n(43618),p=function(e){function t(t){var n=e.call(this,t)||this;return n.isUpdating=!1,n.firstRender=!0,n.layoutChangeCallback=function(){var e=a.PerfUtil.now();n.props.state.waitingForReflow=!1,n.props.shares.lifeCycle.willUpdate();var t=n.props.layoutController.getLayoutBox().uuid,r=n.overlays.getOverlayNode(c.Eos.MainDocId);n.renderAfterLayout(e,t,r)},n.overlayWatcher=function(e){n.renderAfterOverlayUpdate(e)},n.newDocumentCallback=function(){a.Logger.log("RenderDocumentWrapper","newDocumentCallback"),n.doLayout(),n.overlays.onNewDocument()},n.selectionChangeCallback=function(e){var t;(null===(t=e.option)||void 0===t?void 0:t.afterApplyDelta)||n.renderAfterSelectionChange()},n.resizeCallback=function(){var e=n.props.context.surface,t=null==e?void 0:e.getSurfaceDom(),r=null==t?void 0:t.clientWidth;n.clientWidth===r&&void 0!==n.clientWidth||(n.clientWidth=r,n.renderAfterResize())},n.scrollCallback=function(){n.renderAfterScroll()},n.onModelChange=function(e){void 0!==n.timerId&&window.clearTimeout(n.timerId),e.changeData.dirtyRangeMap.forEach((function(e,t){e.values.forEach((function(e){n.dirtyRangeManager.insertDirtyRange(t,e)}))})),n.handleNotification(500)},n._zoom=t.context.zoom,n.overlays=n.props.shares.overlays,n.dirtyRangeManager=new d.xJ(n.props.state.dataEngine),n}return(0,i.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.layoutController.onLayoutChange(this.layoutChangeCallback),this.props.layoutController.onLayoutFinish((function(){a.PerfUtil.mark("lastLayoutFinish"),e.props.context.fire(new l.Qgp)})),this.props.context.setNewDocumentCallback(this.newDocumentCallback),this.props.context.on(l.kgn.SELECTION_CHANGE,this.selectionChangeCallback),this.props.context.on(u.at.ModelChange,this.onModelChange),this.props.context.on(l.kgn.FULL_RENDER,(function(){return e.fullRenderHandler()}),this),this.overlays.addWatcher(this.overlayWatcher),this.props.context.on(l.KQB.ZOOM_FINISH,(function(t){return e.renderAfterZoom(t)}),this),window.addEventListener("resize",this.resizeCallback),this.props.scrollHandler.addScrollListener(this.scrollCallback)},t.prototype.componentWillUnmount=function(){this.props.context.removeCallBack(u.at.CoreSelectionChange,this.selectionChangeCallback),this.props.context.removeCallBack(u.at.ModelChange,this.onModelChange),this.props.context.removeListener(l.kgn.FULL_RENDER,this),this.overlays.removeWatcher(this.overlayWatcher),this.props.scrollHandler.removeScrollListener(this.scrollCallback),this.props.context.removeListener(l.KQB.ZOOM_FINISH,this),window.removeEventListener("resize",this.resizeCallback)},t.prototype.shouldComponentUpdate=function(e,t){var n=this.state.renderRect!==t.renderRect;return this.state.uuid!==t.uuid||this.state.overlayNode!==t.overlayNode||this.state.subStoryInfo.subStoryProp.id!==t.subStoryInfo.subStoryProp.id||!this.state.lazyRenderInfo.equal(t.lazyRenderInfo)||this.state.force!==t.force||n},t.prototype.componentDidUpdate=function(){this.props.shares.lifeCycle.afterUpdate(),this.isUpdating&&(this.fireNotification(),this.isUpdating=!1)},t.prototype.zoom=function(e){this._zoom=e},t.prototype.forceOverlayRerender=function(){},t.prototype.measureRenderPerf=function(e){var t=a.PerfUtil.now()-e;t>1e3?a.Logger.warn("perf|render ".concat(t,"ms")):t>30&&a.Logger.log("perf|render ".concat(t,"ms")),this.props.context.perfManager.costTime[s.zI.Render]=t},t.prototype.notifyRenderChange=function(){this.props.shares.isFirstRender()||(this.props.context.fire(new l.Dyt,!1),window.document.dispatchEvent(new CustomEvent(l.kgn.FIRST_RENDER))),this.props.context.fire(new l.$oP)},t.prototype.doLayout=function(){this.firstRender&&a.PerfUtil.mark("firstLayoutStart"),this.props.layoutController.layout({onlyFirstPage:!!(0,a.getUrlParameter)("prerender")})},t.prototype.handleNotification=function(e){var t=this;this.timerId=setTimeout((function(){t.props.shares.lifeCycle.isUpdating?t.isUpdating=!0:t.fireNotification()}),e)},t.prototype.fireNotification=function(){var e={dirtyRangeMap:this.dirtyRangeManager.genDirtyRangeMap()},t=new u.BQ(e,!1);this.props.context.fire(t),this.dirtyRangeManager.clean()},t}(o().Component),h=function(e){function t(t){var n=e.call(this,t)||this;n.prevSelectionPages=[],n.isZooming=!1,n.renderNextTick=(0,a.debounce)((function(e){window.requestAnimationFrame((function(){var t=e.documentUpdate;n.renderCanvas({documentUpdated:t,renderWithReused:!1,dirtyPageIndexes:t?n.getPrevPageAllIndexes():[]})}))})),n.onPageNumChanged=function(){n.renderCanvas({documentUpdated:!0,renderWithReused:!1})},n.onVisibilityChanged=function(){"visible"===document.visibilityState&&n.renderCanvas({documentUpdated:!1,renderWithReused:!1})},n.setZoomEnd=function(){n.docRender&&n.docRender.setZooming(!1),n.isZooming=!1},n.setZoomIng=function(){n.docRender&&n.docRender.setZooming(!0),n.isZooming=!0},n.lazyRenderManager=new l.tBw;var r=n.props.layoutController.getLayoutBox();return n.prevPageUuids=n.generatePageUuids(r),n.state={uuid:r.uuid,overlayNode:n.overlays.getOverlayNode(c.Eos.MainDocId),subStoryInfo:n.props.state.selection.subStoryInfo,lazyRenderInfo:n.lazyRenderManager.lazyRenderInfo,force:0,renderRect:(0,s.gL)(r)?n.calcCurrentRenderRect(r):null},n}return(0,i.__extends)(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.props.context.on(l.kgn.RENDER_NEXT_TICK,this.renderNextTick,this),this.props.context.on(c.Cl$.PageNumChanged,this.onPageNumChanged),document.addEventListener("visibilitychange",this.onVisibilityChanged),this.props.context.on(l.hxJ.ING,this.setZoomIng),this.props.context.on(l.hxJ.END,this.setZoomEnd)},t.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this),this.props.context.removeListener(l.kgn.RENDER_NEXT_TICK,this),this.props.context.removeCallBack(c.Cl$.PageNumChanged,this.onPageNumChanged),document.removeEventListener("visibilitychange",this.onVisibilityChanged),this.props.context.removeListener(l.hxJ.ING,this.setZoomIng),this.props.context.removeListener(l.hxJ.END,this.setZoomEnd)},t.prototype.render=function(){var e=this,t=this.props,n=t.context,r=t.layoutController,i=t.shares,a=this.state,l=a.overlayNode,d=a.renderRect,p=r.getLayoutBox(),h=u.rX.get(c.y2q.Canvas,s.yb);return o().createElement(h,{context:n,layoutController:r,layoutBox:p,renderRect:d,shares:i,overlayNode:l,subStoryInfo:this.state.subStoryInfo,force:this.state.force,ref:function(t){e.docRender=t}})},t.prototype.forceRerender=function(){var e=this,t=this.props.layoutController.getLayoutBox();if((0,s.gL)(t)){var n=this.calcCurrentRenderRect(t);this.setState({force:this.state.force+1,renderRect:n},(function(){e.renderCanvas({documentUpdated:!0,renderWithReused:!1,dirtyPageIndexes:e.getPrevPageAllIndexes()})}))}},t.prototype.forceOverlayRerender=function(){this.renderCanvas({documentUpdated:!1,renderWithReused:!1})},t.prototype.zoom=function(t){e.prototype.zoom.call(this,t),this.docRender&&this.docRender.setZoom(t)},t.prototype.renderAfterLayout=function(e,t,n){var r=this,o=this.props.layoutController.getLayoutBox();if((0,s.gL)(o)){var i=this.calcCurrentRenderRect(o);if(0!==i.height){var a=this.generatePageUuids(o),c=this.getDirtyPageIndexes(a,this.prevPageUuids);this.prevPageUuids=a,this.setState({uuid:t,overlayNode:n,lazyRenderInfo:this.lazyRenderManager.lazyRenderInfo,renderRect:i},(function(){r.overlays.onLayoutChanged(),r.renderCanvas({documentUpdated:!0,renderWithReused:!1,dirtyPageIndexes:c}),r.measureRenderPerf(e),r.notifyRenderChange()}))}}},t.prototype.renderAfterOverlayUpdate=function(e){var t=this;if(this.overlays.layoutNotChange()){var n=[];null==e||e.forEach((function(e){n=(0,i.__spreadArray)((0,i.__spreadArray)([],(0,i.__read)(n),!1),(0,i.__read)(t.getRelatedPagesWithRange(e)),!1)})),n=Array.from(new Set(n)),this.renderCanvas({documentUpdated:!1,renderWithReused:!1,dirtyPageIndexes:n})}},t.prototype.renderAfterSelectionChange=function(){var e,t,n,r=(e=this.props.state.selection,t=e.gcpRange,(null==(n=e.tableSelectionArea)?void 0:n.isInnerTable())?t.unionRange(new c.ICE(n.begin,n.end)):t),o=this.getRelatedPagesWithRange(r),a=Array.from(new Set((0,i.__spreadArray)((0,i.__spreadArray)([],(0,i.__read)(o),!1),(0,i.__read)(this.prevSelectionPages),!1)));this.renderCanvas({documentUpdated:!1,renderWithReused:!1,dirtyPageIndexes:a}),this.prevSelectionPages=o},t.prototype.renderAfterZoom=function(){var e=this,t=this.props.layoutController.getLayoutBox();if((0,s.gL)(t)){var n=this.calcCurrentRenderRect(t);0!==n.height&&this.setState({renderRect:n},(function(){e.renderCanvas({documentUpdated:!1,renderWithReused:!1})}))}},t.prototype.renderAfterResize=function(){this.renderCanvas({documentUpdated:!1,renderWithReused:!1})},t.prototype.renderAfterScroll=function(){var e=this,t=this.props.layoutController.getLayoutBox();if((0,s.gL)(t)){var n=this.calcCurrentRenderRect(t);0!==n.height&&this.setState({renderRect:n},(function(){e.renderCanvas({documentUpdated:!1,renderWithReused:!0})}))}},t.prototype.fullRenderHandler=function(){this.props.context.fire(new l.a7B)},t.prototype.renderCanvas=function(e){var t=this.props.layoutController.getLayoutBox();this.docRender&&this.docRender.renderCanvas(t,e)},t.prototype.calcCurrentRenderRect=function(e){if(this.props.shares.docEnv.docViewType===c.$BT.SnapPreview)return new a.MeloRect({x:0,y:0,width:1/0,height:1/0});var t,n,r,o,i,s,l,u,d,p,h,f=this.props.scrollHandler.getClientHeight(),g=this.props.scrollHandler.getScrollTop();return t=e,n={clientHeight:f,offsetTop:g},r=this._zoom,o=(0,a.pxToTwips)(n.clientHeight/r),i=(0,a.pxToTwips)(n.offsetTop/r),s=t.rect.height-o,l=Math.min(i,s),u=l+o,d=1*o,p=Math.max(l-d,0),h=Math.min(u+d,t.rect.height),new a.MeloRect({x:0,y:p,width:t.totalWidth,height:h-p})},t.prototype.getRelatedPagesWithRange=function(e){return this.props.layoutController.getLayoutBox().children.filter((function(t){return t.getRanges().find((function(t){return t.intersect(e)}))})).map((function(e){return e.getSiblingIndex()}))},t.prototype.generatePageUuids=function(e){return e.children.map((function(e){return e.uuid}))},t.prototype.getPrevPageAllIndexes=function(){return this.prevPageUuids.map((function(e,t){return t}))},t.prototype.getDirtyPageIndexes=function(e,t){var n=[],r=e.length!==t.length;return e.forEach((function(e,o){(r||e!==t[o])&&n.push(o)})),n},t}(p),f=function(e){function t(t){var n=e.call(this,t)||this;n.needUpdateLazyInfo=!0,n.lazyRenderScrollTicking=!1,n.isRenderingForScroll=!1,n.onScrollToUnrenderPart=function(e){var t=e.viewRange.start.gcp;n.lazyRenderManager.scrollViewRangeBeginGcp=t;var r=function(){e.viewRange.start.leafBox.__node__?n.props.scrollHandler.onScrollPartRendered(e.viewRange,e.headerViewHeight):a.Logger.error("scroll part has not been rendered")},o={afterUpdate:function(){n.isRenderingForScroll&&(r.apply(n),n.props.shares.lifeCycle.removeWatcher(o),n.isRenderingForScroll=!1)}};n.lazyRenderHandler(!0,void 0,void 0,!0),n.props.shares.lifeCycle.addWatcher(o)},n.lazyRenderHandler=function(e,t,r,o){if(n.lazyRenderManager.needFullRender||!e&&!n.needUpdateLazyInfo)n.lazyRenderScrollTicking=!1;else{var i=t||n._zoom,a=n.props.layoutController.getLayoutBox(),s=n.lazyRenderManager.updateLazyRenderInfo(n.props.scrollHandler,a,i,e,n.props.shares.isEditable(),r);e&&s?(n.needUpdateLazyInfo=!1,n.setState({lazyRenderInfo:n.lazyRenderManager.lazyRenderInfo},(function(){n.needUpdateLazyInfo=!0,n.lazyRenderScrollTicking=!1,o&&(n.isRenderingForScroll=!0)}))):n.lazyRenderScrollTicking=!1}},n.searchDialogChange=function(e){n.lazyRenderManager.needFullRender=e.searchDialogShow,setTimeout((function(){n.lazyRenderManager.needFullRender?n.fullRenderHandler():n.lazyRenderHandler(!1)}),1)},n.lazyRenderManager=u.rX.instantiate(c.y2q.Lite,l.$_n,!1,n.props.layoutController.boxHelper,n.props.state.getTextStream());var r=n.props.context.docEnv.isSSR?n.lazyRenderManager.fullRenderInfo:n.lazyRenderManager.lazyRenderInfo;return n.state={uuid:n.props.layoutController.getLayoutBox().uuid,overlayNode:n.overlays.getOverlayNode(c.Eos.MainDocId),subStoryInfo:n.props.state.selection.subStoryInfo,lazyRenderInfo:r,force:0,renderRect:null},n}return(0,i.__extends)(t,e),t.prototype.forceRerender=function(){this.setState({force:this.state.force+1})},t.prototype.renderAfterLayout=function(e,t,n){this.lazyRenderHandler(!1),this.setStateAfterLayoutChanged(e,t,n)},t.prototype.renderAfterOverlayUpdate=function(){this.setState({overlayNode:this.overlays.getOverlayNode(c.Eos.MainDocId)})},t.prototype.renderAfterSelectionChange=function(){this.setState({subStoryInfo:this.props.state.selection.subStoryInfo})},t.prototype.renderAfterZoom=function(e){e.next!==e.prev&&this.lazyRenderHandler(!0,e.next)},t.prototype.renderAfterResize=function(){this.lazyRenderHandler(!0)},t.prototype.renderAfterScroll=function(){var e=this;this.lazyRenderScrollTicking||(requestAnimationFrame((function(){e.lazyRenderHandler(!0)})),this.lazyRenderScrollTicking=!0)},t.prototype.setStateAfterLayoutChanged=function(e,t,n){var r=this;this.setState({uuid:t,overlayNode:n,lazyRenderInfo:this.lazyRenderManager.lazyRenderInfo},(function(){r.overlays.onLayoutChanged(),r.measureRenderPerf(e),r.notifyRenderChange()}))},t.prototype.fullRenderHandler=function(){var e=this,t=a.PerfUtil.now();this.setState({lazyRenderInfo:this.lazyRenderManager.fullRenderInfo},(function(){e.props.context.fire(new l.a7B);var n=a.PerfUtil.now()-t;n>30?a.Logger.warn("full perf|render ".concat(n,"ms")):a.Logger.log("full perf|render ".concat(n,"ms"))}))},t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.props.context.on(l.kgn.SEARCH_DIALOG,this.searchDialogChange),this.props.context.on(l.kgn.SCROLL_TO_UNRENDER,this.onScrollToUnrenderPart)},t.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this),this.props.context.removeCallBack(l.kgn.SEARCH_DIALOG,this.searchDialogChange),this.props.context.removeCallBack(l.kgn.SCROLL_TO_UNRENDER,this.onScrollToUnrenderPart)},t.prototype.render=function(){var e=this.props,t=e.context,n=e.layoutController,r=e.shares,i=this.state.overlayNode,a=n.getLayoutBox(),l=u.rX.get(c.y2q.Lite,s.yb);return o().createElement(l,{context:t,layoutController:this.props.layoutController,layoutBox:a,shares:r,overlayNode:i,subStoryInfo:this.state.subStoryInfo,lazyRenderInfo:this.state.lazyRenderInfo,force:this.state.force})},t}(p),g=function(e){function t(t){var n=e.call(this,t)||this;return n.state={hasError:!1},n}return(0,i.__extends)(t,e),t.getDerivedStateFromError=function(){return{hasError:!0}},t.prototype.componentDidCatch=function(e,t){a.Logger.error("[ReactError]",e,t)},t.prototype.render=function(){return this.state.hasError?null:this.props.children},t}(o().Component),v=function(){function e(e,t,n){var r=this;if(this.context=e,this.state=t,this.layoutController=n,this._isFirstRender=!1,this.wrapper=null,this._zoom=1,this.renderState=new l.nTW,this.overlays=new l.A5G(e,t,n),this.containerFocus=new l.kvr(e,t),this.selectionOverlay=new l.x70(e,t,n,this.renderState,this.containerFocus),this.scrollHandler=new l.YF2(e,t,n,(function(){return r._zoom}),this.selectionOverlay.getRangeFinder()),this.containerRenderManager=new l.f8X(e),this.decoratorManager=new l.CVG([s.uO.Body,s.uO.RichTextArea,s.uO.Paragraph,s.uO.Line,s.uO.Field,s.uO.Text]),this.lifeCycle=new l.Fw4,this.overlays.addOverlay(this.selectionOverlay),e.docEnv.renderType===c.y2q.Canvas){var o=new l.rcG;this.overlays.addOverlay(o),this.preloadTxdocfont()}else e.docEnv.renderType===c.y2q.Lite&&(this.decoratorManager=new l.CVG([s.uO.DocumentLite,s.uO.ParagraphLite,s.uO.TextFrameLite,s.uO.FieldCodeLite,s.uO.TextLite]));this.context.on(l.kgn.FIRST_RENDER,(function(){r.isFirstRender=!0})),this.context.docEnv.renderType===c.y2q.Canvas&&(this.extRendererManager=u.rX.instantiate(c.y2q.Canvas,l.h9f))}return e.prototype.buildComponent=function(){var e=this;if(this.scrollHandler.setIsEditable((function(){return e.isEditable})),this.context.docEnv.renderType===c.y2q.Canvas){var t=new l.bBX(this.overlays,this.selectionOverlay,this.containerFocus,this.scrollHandler,this.containerRenderManager,this.decoratorManager,this.lifeCycle,(function(){return e.isEditable}),(function(){return e.isFirstRender}),this.context.docEnv,this.renderState,this.state,this.extRendererManager);return o().createElement(g,null,o().createElement(h,{layoutController:this.layoutController,context:this.context,state:this.state,shares:t,scrollHandler:this.scrollHandler,ref:function(t){e.wrapper=t}}))}var n=new l.Hzo(this.overlays,this.selectionOverlay,this.containerFocus,this.scrollHandler,this.containerRenderManager,this.decoratorManager,this.lifeCycle,(function(){return e.isEditable}),(function(){return e.isFirstRender}),this.context.docEnv,this.renderState,this.state);return o().createElement(g,null,o().createElement(f,{layoutController:this.layoutController,context:this.context,state:this.state,shares:n,scrollHandler:this.scrollHandler,ref:function(t){e.wrapper=t}}))},e.prototype.getViewSelection=function(){return this.selectionOverlay.viewSelection},Object.defineProperty(e.prototype,"zoom",{get:function(){return this._zoom},set:function(e){this._zoom=e,this.wrapper&&this.wrapper.zoom(e)},enumerable:!1,configurable:!0}),e.prototype.attach=function(){this.scrollHandler.attach()},e.prototype.detach=function(){this.scrollHandler.detach()},Object.defineProperty(e.prototype,"isEditable",{get:function(){return this.context.isEditable()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFirstRender",{get:function(){return this._isFirstRender},set:function(e){this._isFirstRender=e},enumerable:!1,configurable:!0}),e.prototype.forceRerender=function(){this.wrapper&&this.wrapper.forceRerender()},e.prototype.forceOverlayRerender=function(){var e;null===(e=this.wrapper)||void 0===e||e.forceOverlayRerender()},e.prototype.preloadTxdocfont=function(){var e="preload-txdocfont-element",t=document.getElementById(e);t||((t=document.createElement("div")).id=e,t.innerHTML="text",t.style.fontFamily=c.keb.specialListFont,t.style.position="absolute",t.style.zIndex="-500000",t.style.left="-100000px",document.body.appendChild(t))},e}()},43618:function(e,t,n){n.d(t,{wA:function(){return c},xJ:function(){return f},_l:function(){return O},yg:function(){return R},rt:function(){return w},ZM:function(){return I}});var r,o=n(82487),i=n(31518),a=n(46708),s=n(30479),c=function(){function e(e,t,n,r){void 0===n&&(n=!1),void 0===r&&(r=!0),this._gcpRange=null,this._rangeClass=null,this.tableSelectionCache=null,this.dataEngine=e,this._updateSelection=n,this.reset(),this._fixRange=r,this._rangeKey=s.StringUtil.generateRandomId(),this._setGCPRange(t)}return e.prototype.reset=function(){this._updateSelection?(this._rangeClass&&this._rangeClass.destroy(),this._rangeClass=this.dataEngine.createRangeClass(!0,!1)):this._gcpRange=o.ICE.emptyRange(),this.tableSelectionCache=null},e.prototype.updateTableSelectionCache=function(){this._updateSelection&&(this.tableSelectionCache=this.createTableSelection(this.gcpRange))},Object.defineProperty(e.prototype,"_range",{get:function(){if(!this._updateSelection)return this._gcpRange.clone();var e=this._rangeClass.getRange(this._rangeKey);return e||o.ICE.emptyRange()},enumerable:!1,configurable:!0}),e.prototype._setGCPRange=function(e){var t=this._fixRange?this.fixToValidRange(e):e;return!(!t.isValid()||!t.notEqual(this._range)||(this._updateSelection?(this._rangeClass.deleteRange(this._rangeKey),this._rangeClass.insertRange(this._rangeKey,t)):this._gcpRange=t,0))},Object.defineProperty(e.prototype,"dataStream",{get:function(){return this.dataEngine.getDataStream()},enumerable:!1,configurable:!0}),e.prototype.getSubStoryInfoFromGcp=function(e){var t=this.dataStream.getStoryStream().getSubStoryInfoFromGcp(e);return t||{storyProp:new(o.kkf.getPropertyClass(o.uSS.StoryProperty))({storyType:o.AHI.mainDocument}),subStoryProp:new(o.kkf.getPropertyClass(o.uSS.MainStoryProperty))({id:o.Eos.MainDocId}),range:o.ICE.emptyRange(),contentRange:o.ICE.emptyRange()}},Object.defineProperty(e.prototype,"subStoryInfo",{get:function(){return this.getSubStoryInfoFromGcp(this._range.begin())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textboxHostStoryInfo",{get:function(){return this.subStoryInfo.subStoryProp.id!==o.AHI.textboxContent?this.subStoryInfo:this.getSubStoryInfoFromGcp(this.subStoryInfo.range.begin())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gcpRange",{get:function(){return this._range.clone()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backWard",{get:function(){return!(!this._option||!this._option.backward)&&this._option.backward},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tableSelectionArea",{get:function(){return this.tableSelectionCache},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tableCellGCPRanges",{get:function(){var e;return(null===(e=this.tableSelectionArea)||void 0===e?void 0:e.isInnerTable())?this.tableSelectionArea.cellRanges[0].splitToCellGCPRanges():[]},enumerable:!1,configurable:!0}),e.prototype.setRangeTo=function(e,t){return this._option=t,this._setGCPRange(e)},e.prototype.storyValidRange=function(){return this._storyValidRange(this._range)},e.prototype.fixToValidRange=function(e){var t=e.clone(),n=this._storyValidRange(t);0===(t=t.intersectRange(n)).length()&&t.begin()===n.end()&&(t.gcpBegin-=1);var r=this.fixToValidRangeForFieldCode(t);return this.fixToValidRangeForTable(r)},e.prototype.fixToValidDeleteRange=function(e){var t;if(null===(t=this.tableSelectionArea)||void 0===t?void 0:t.isInnerTable())return new o.ICE(e.begin(),0);var n=e.clone();n=this.fixToValidRange(n);var r=this._storyValidRange(n);return n.end()===r.end()&&(n.len-=1),n=this.fixToValidDeleteTableRange(n)},e.prototype.fixToValidDelFieldRange=function(e){var t=this.dataEngine.getDataStream().getFieldStream();if(e.length()>0&&t){var n=t.getFieldRange(e.begin());if(n){var r=n.fieldRange,i=Math.min(e.begin(),r.begin()),a=Math.max(e.end(),r.end());return new o.ICE(i,a-i)}}return e},e.prototype.fixToValidReplaceRange=function(e){if(this.tableSelectionArea&&!this.tableSelectionArea.isInnerCell()){var t=this.tableSelectionArea.cellRanges;if(!t[0])return e;var n=t[0].begin,r=this.dataStream.getTableStream().getCellInfo(n);if(!r)return e;var i=r.range;return this.fixToValidDeleteRange(new o.ICE(i.begin(),i.len-2))}return this.fixToValidDeleteRange(e)},e.prototype.fixToValidCommentRange=function(e){var t,n,r=e;if(e.len>0&&this.tableSelectionArea&&!this.tableSelectionArea.isCrossTable()&&!this.tableSelectionArea.isWholeTable()){var o=null===(n=null===(t=this.tableSelectionArea.cellRanges)||void 0===t?void 0:t[0])||void 0===n?void 0:n.getRanges();o&&o.length>0&&(r=o[o.length-1])}(r=this.fixToValidRange(r)).length()>e.length()&&r.begin()<=e.begin()&&r.end()>=e.end()&&(r=e);var i=this.dataEngine.getDataStream().getFieldStream().getFieldRange(e.begin(),1),a=(null!=i?i:{}).fieldRange;return a&&a.begin()<r.begin()&&r.begin()<a.end()&&(r=a),r},e.prototype.isCollapse=function(){return 0===this._range.length()},e.prototype.isParaBegin=function(e){var t=this.dataStream.getTextStream().createParagraphIterator();t.seek(e);var n=t.getRange();return n.length()>0&&n.begin()===e},e.prototype.isParaEnd=function(e){var t=this.dataStream.getTextStream().createParagraphIterator();t.seek(e);var n=t.getRange();return n.length()>0&&n.end()-1===e},e.prototype.isStoryBegin=function(e){var t=this._storyValidRange(new o.ICE(e,0));return t.length()>0&&t.begin()===e},e.prototype.isStoryEnd=function(e){var t=this._storyValidRange(new o.ICE(e,0));return t.length()>0&&t.end()-1===e},e.prototype.trimSpecialPlaceholder=function(e){for(var t=this.gcpNextToTablePlaceholder(e.begin(),e,1),n=this.gcpNextToTablePlaceholder(e.end()-1,e,-1)+1,r=this.dataStream.getTextStream();r.charAt(t)===o.IfD.CommentReference;)t+=1;return r.charAt(n)===o.IfD.TableCellBreak&&r.charAt(n-1)===o.IfD.ParagraphReturn&&(n-=1),new o.ICE(t,n-t)},e.prototype.createTableSelection=function(e){return this.dataStream.getTableStream().createSelectionArea(e)},e.prototype._storyValidRange=function(e){var t=this.dataStream.getStoryStream().getSubStoryInfoFromGcp(e.begin());if(!t)return o.ICE.emptyRange();var n=t.contentRange;if((null==t?void 0:t.storyProp.storyType)===o.AHI.mainDocument){n.len-=1;var r=this.dataEngine.getDataStream().getTextStream().createParagraphIterator();r.seek(n.end()),r.prev();var i=r.getRange().end();n.end()!==i&&(n.len+=i-n.end())}return n},e.prototype.fixToValidDeleteTableRange=function(e){if(0===e.length())return e;var t=e.end()-1,n=this.dataStream.getTableStream().getCellInfo(t),r=this.dataStream.getTableStream().getTableInfo(t),i=this.dataStream.getTableStream().getTableInfo(e.end());if(n){var a=o.ICE.insetBoth(n.contentRange,0,1);return e.intersectRange(a)}return i&&i.range.begin()===e.end()&&!r?new o.ICE(e.begin(),e.length()-1):r&&e.equal(r.contentRange)?r.range:e},e.prototype.fixToValidCaretForTable=function(e){var t=e.clone();if(0!==t.length())return e;var n=t.begin(),r=this.getPlaceholder(n);return r===o.IfD.TableStart&&(t=new o.ICE((0,o.Jmy)(this.dataStream.getTextStream(),n,[o.IfD.TableStart]),0)),r===o.IfD.TableEnd&&(t=n>this._range.begin()?new o.ICE(n+1,0):new o.ICE(n-3,0)),r===o.IfD.TableRowBreak&&(t=new o.ICE(n-2,0)),r===o.IfD.TableCellBreak&&(t=new o.ICE(n-1,0)),t},e.prototype.fixToValidRangeForTable=function(e){var t=this.dataStream.getTableStream().createSelectionArea(e.isEmpty()?this.fixToValidCaretForTable(e):e);return this.tableSelectionCache=t,t?t.isInnerTable()||t.isInnerCell()?t.range:t.isCrossTable()?e.unionRange(t.range):e:e},e.prototype.fixToValidRangeForFieldCode=function(e){var t=this.dataEngine.getDataStream().getFieldStream(),n=t.getDecodedFieldInfo(e.begin(),1),r=e.begin()===e.end()?n:t.getDecodedFieldInfo(e.end(),1);if(!n&&!r)return e;if(r&&(null==n?void 0:n.fieldRange.equal(r.fieldRange))&&!n.canFocusInField&&e.len>0)return n.fieldRange;if(0===e.len&&n){var i=e.gcpBegin;if(n.fieldResult.range.begin()===i)return new o.ICE(n.fieldRange.begin(),0);if(n.fieldResult.range.end()===i)return new o.ICE(n.fieldRange.end(),0)}if([n,r].every((function(t){return!t||t.fieldResult.range.equal(e)})))return n.fieldRange;if([n,r].every((function(t){return!t||t.fieldResult.range.contains(e)})))return e;if((null==n?void 0:n.fieldRange.gcpBegin)===e.gcpBegin&&e.isEmpty())return e;if((null==r?void 0:r.fieldRange.gcpBegin)===e.gcpBegin+e.len){if(n&&!n.fieldRange.equal(r.fieldRange)){var a=n.fieldRange.begin(),s=r.fieldRange.begin()-a;return new o.ICE(a,s)}return e}if(0===e.len)return n.fieldResult.range.begin()>=e.begin()?new o.ICE(n.fieldResult.range.begin(),0):new o.ICE(n.fieldResult.range.end(),0);var c=e.clone();return[n,r].forEach((function(e){var t;c=c.unionRange(null!==(t=null==e?void 0:e.fieldRange)&&void 0!==t?t:c)})),c},e.prototype.fixToValidRangeForComment=function(e){return 1===e.len&&this.getPlaceholder(e.begin())===o.IfD.CommentReference?new o.ICE(e.begin(),0):e},e.prototype.getPlaceholder=function(e){var t=this.dataStream.getTextStream().createRunIterator();t.seek(e);var n=t.getRange(!0);return this.dataStream.getTextStream().readText(n.begin(),1)},e.prototype.gcpNextToTablePlaceholder=function(e,t,n){for(var r,i=this.dataStream.getTextStream(),a=(null===(r=this.tableSelectionArea)||void 0===r?void 0:r.isCrossTable())?[o.IfD.TableStart,o.IfD.TableRowBreak,o.IfD.TableCellBreak]:[o.IfD.TableStart,o.IfD.TableEnd,o.IfD.TableRowBreak,o.IfD.TableCellBreak],s=e;s>=t.begin()&&s<=t.end();s+=n)if(a.indexOf(i.charAt(s))<0)return s;return e},e}(),l=function(){function e(e){this._coreRange=new c(e,o.ICE.emptyRange(),!0)}return e.prototype.reset=function(){this._coreRange.reset()},Object.defineProperty(e.prototype,"subStoryInfo",{get:function(){return this._coreRange.subStoryInfo},enumerable:!1,configurable:!0}),e.prototype.getCoreRange=function(){return this._coreRange},Object.defineProperty(e.prototype,"gcpRange",{get:function(){return this._coreRange.gcpRange},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backWard",{get:function(){return this._coreRange.backWard},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tableSelectionArea",{get:function(){return this._coreRange.tableSelectionArea},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gcpRanges",{get:function(){var e=this._coreRange.tableCellGCPRanges;return e.length>0?e:[this.gcpRange]},enumerable:!1,configurable:!0}),e.prototype.updateTableSelectionCache=function(){this._coreRange.updateTableSelectionCache()},e.prototype.setRangeTo=function(e,t){return this._coreRange.setRangeTo(e,t)},e.prototype.validDeleteRange=function(){return this._coreRange.fixToValidDeleteRange(this._coreRange.gcpRange)},e.prototype.validCompositionDeleteRange=function(){return this._coreRange.fixToValidReplaceRange(this._coreRange.gcpRange)},e.prototype.isCollapse=function(){return this._coreRange.isCollapse()},e}(),u=n(85556),d=n(64282),p=function(){function e(){this.exceptions=[]}return e.prototype.forEachException=function(e){this.exceptions.forEach((function(t,n){if(t.type!==d.x1.insert)throw new Error("there should not be any mutation other than insert");e(t,n)}))},e.prototype.findException=function(e){return this.exceptions.find((function(t,n){if(t.type!==d.x1.insert)throw new Error("there should not be any mutation other than insert");return e(t,n)}))},e.prototype.getExceptionRange=function(e,t,n){var r;void 0===n&&(n=!1);var i=-1;try{this.findException((function(n,a){if(n.options.exceptId===e){var s=n.getMutation();if(t.readText(s.beginIndex,s.text.length)!==s.text)throw new Error("the exception range is shifted");return r=new o.ICE(s.beginIndex,s.text.length),0===s.text.length&&(i=a),!0}return!1})),n&&-1!==i&&this.exceptions.splice(i,1)}catch(t){t.message+=" exceptId: ".concat(e,", exceptions: ").concat(this.printDebugInfo()),a.kQ.captureChangesetException(a.GI.CHANGESET_ERROR_DELTA2CS,{option:{}},t)}return r},e.prototype.meetsLocalMutation=function(e){if(0===this.exceptions.length)return e;var t=e.mutations,n=e.inverses,r=this.getUndoException(),o=(0,u.__read)(d.hV.followDouble(r,t),2),i=o[0],a=o[1];return this.exceptions=this.getNewExceptionFromUndo(i),{mutations:a,inverses:d.hV.followSingle(n,i,!1)}},e.prototype.meetsServerMutation=function(e,t){var n;if(0===this.exceptions.length)return e;var r=d.hV.followDouble(this.exceptions,e);return t||(n=(0,u.__read)(r,1),this.exceptions=n[0]),r[1]},e.prototype.startComposition=function(e,t,n){var r=new i.iN(new d.Qr({beginIndex:e,text:""}),{exceptId:t,baseLen:n});try{this.mergeExceptions([r])}catch(t){t.message+=" startComposition: ".concat(e,", exceptions: ").concat(this.printDebugInfo()),a.kQ.captureChangesetException(a.GI.CHANGESET_ERROR_DELTA2CS,{option:{}},t)}},e.prototype.mergeExceptions=function(e){var t=this;this.composeMutations(e).forEach((function(e){e.type===d.x1.insert?t.mergeInsertion(e):e.type===d.x1.delete&&t.mergeDeletion(e)}))},e.prototype.composeMutations=function(e){var t=e.filter((function(e){return e.type===d.x1.insert||e.type===d.x1.delete}));return d.hV.compose(t)},e.prototype.mergeInsertion=function(e){if(0!==this.exceptions.length){var t=e.getMutation(),n=!1,r=new i.iN(t,(0,u.__assign)({},e.options)),o=[];this.forEachException((function(a){var s=a.getMutation();if(a.options.exceptId&&a.options.exceptId===e.options.exceptId)throw new Error("duplicate exception id");if(s.beginIndex<t.beginIndex){if(s.beginIndex+s.text.length>t.beginIndex)throw new Error("illegal insert index");o.push(a)}else n||(o.push(r),n=!0),r.options.baseLen-=s.text.length,o.push(new i.iN(new d.Qr({beginIndex:s.beginIndex+t.text.length,text:s.text}),(0,u.__assign)((0,u.__assign)({},a.options),{baseLen:a.options.baseLen+t.text.length})))})),n||o.push(e),this.exceptions=o}else this.exceptions.push(e)},e.prototype.mergeDeletion=function(e){var t=e.getMutation(),n=t.endIndex-t.beginIndex,r=[],o=!1;if(this.forEachException((function(a){var s=a.getMutation();if(a.options.exceptId===e.options.exceptId){if(s.beginIndex===t.beginIndex&&s.beginIndex+s.text.length===t.endIndex)return void(o=!0);throw new Error("the exception to delete doesn't match")}if(s.beginIndex<t.endIndex&&s.beginIndex+s.text.length>t.beginIndex)throw new Error("the exception to delete overlaps");s.beginIndex<t.beginIndex?r.push(a):r.push(new i.iN(new d.Qr({beginIndex:s.beginIndex-n,text:s.text}),(0,u.__assign)((0,u.__assign)({},a.options),{baseLen:a.options.baseLen-n})))})),!o)throw new Error("the exception to delete is not found");this.exceptions=r},e.prototype.getUndoException=function(){var e=[];return this.forEachException((function(t){var n=t.getMutation();e.push(new i.iN(new d.jn({beginIndex:n.beginIndex,endIndex:n.beginIndex+n.text.length}),(0,u.__assign)((0,u.__assign)({},t.options),{undoText:n.text,baseLen:t.options.baseLen+n.text.length})))})),e.reverse()},e.prototype.getNewExceptionFromUndo=function(e){var t=[];return e.forEach((function(n){var r=n.getMutation();r.endIndex<r.beginIndex&&(r.endIndex=r.beginIndex);var o=r.endIndex-r.beginIndex;if(void 0===n.options.undoText||n.options.undoText.length!==o)throw new Error("exception text not match! text: ".concat(n.options.undoText,", undo: ").concat(JSON.stringify(e)));t.push(new i.iN(new d.Qr({beginIndex:r.beginIndex,text:n.options.undoText}),(0,u.__assign)((0,u.__assign)({},n.options),{undoText:void 0,baseLen:n.options.baseLen-o})))})),t.reverse()},e.prototype.removeAll=function(){this.exceptions=[]},e.prototype.printDebugInfo=function(){return JSON.stringify(this.exceptions)},e}(),h=function(){function e(e){this.exceptions=new p,this.compositionId="",this.compositionText="",this.state=e}return e.prototype.reset=function(){this.exceptions.removeAll(),this.compositionId="",this.compositionText=""},e.prototype.getTextStream=function(){return this.state.getTextStream()},e.prototype.getCurrentRange=function(){return this.exceptions.getExceptionRange(this.compositionId,this.getTextStream())},e.prototype.getCompositionRange=function(e){return this.exceptions.getExceptionRange(e,this.getTextStream())},e.prototype.meetsLocalMutation=function(e){return this.exceptions.meetsLocalMutation(e)},e.prototype.meetsServerMutation=function(e,t){return this.exceptions.meetsServerMutation(e,t)},e.prototype.mergeExceptions=function(e){this.exceptions.mergeExceptions(e)},e.prototype.printDebugInfo=function(){return this.exceptions.printDebugInfo()},e.prototype.isCompositing=function(){return this.compositionId.length>0},e.prototype.getCompositionId=function(){return this.compositionId},e.prototype.getCompositionText=function(){return this.compositionText},e.prototype.compositionStart=function(e,t){void 0===t&&(t=!1),this.compositionId&&this.compositionEnd(this.compositionId,"",!1);var n=this.state.delta();n.setCommandType(i.wI.DocDeleteText);var r=this.state.selection.validCompositionDeleteRange(),o=this.getTextStream().createParagraphIterator(r).getRange();(r.equal(o)||r.end()===o.end()&&1===r.length())&&(r.len-=1),s.Logger.info("compositionStart, insert index: ".concat(r.begin())),this.state.deleteText(r,n),this.state.applyDelta(n),this.compositionId=e,this.exceptions.startComposition(r.begin(),e,this.state.getTextStream().getLength())},e.prototype.compositionUpdate=function(e,t,n){if(void 0===n&&(n=!1),t){this.compositionId=e,this.compositionText=t;var r=this.exceptions.getExceptionRange(e,this.getTextStream(),!0);if(void 0!==r){if(this.getTextStream().readText(r.begin(),r.length())===t)return;var o=this.state.cusorSpanProp,a=this.state.delta();a.setCommandType(i.wI.DocCompositionUpdate),a.setNeedCollab(!1),a.setMutOption({exceptId:e}),a.deleteText(r),this.state.cusorSpanProp=o;var s=this.state.followSpanProp(r.begin());this.state.cusorSpanProp&&s.merge(this.state.cusorSpanProp),n&&(s.pinyin=!0),i.Gh.insertText(r.begin(),t,s,a),this.state.applyDelta(a),this.state.cusorSpanProp=o}}},e.prototype.compositionEnd=function(e,t,n){void 0===n&&(n=!0);var r=this.exceptions.getExceptionRange(e,this.getTextStream(),!0);if(void 0!==r){var o=this.state.cusorSpanProp,a=this.state.delta();a.setUpdateSelection(n),a.setCommandType(i.wI.DocCompositionEnd),a.setNeedCollab(!1),a.setMutOption({exceptId:e}),a.deleteText(r),this.state.applyDelta(a),this.state.cusorSpanProp=o,r.len=0,(a=this.state.delta()).setCommandType(i.wI.DocInsertText),this.state.selection.gcpRange.notEqual(r)&&a.setUpdateSelection(!1);var s=this.state.followSpanProp(r.begin());i.Gh.insertText(r.begin(),t,s,a),this.state.applyDelta(a)}this.compositionId=""},e.prototype.insertCopyImageFinish=function(e,t,n,r){var a=this.state.getDrawingStream();if(a){var c=a.getDrawingInfo(e);if(c){var l=this.getTextStream().createRunIterator(c.range),u=null==l?void 0:l.getCloneProperty(),d=new(o.kkf.getPropertyClass(o.uSS.DrawingProperty));d.inlineKeyword.graphic.graphicData.pic.blipFill.blip.embed=t,d.inlineKeyword.docPr.id=e,n&&r&&(d.inlineKeyword.extent.cx=(0,s.pxToEmu)(n),d.inlineKeyword.extent.cy=(0,s.pxToEmu)(r),d.inlineKeyword.graphic.graphicData.pic.spPr.xfrm.ext.cx=(0,s.pxToEmu)(n),d.inlineKeyword.graphic.graphicData.pic.spPr.xfrm.ext.cy=(0,s.pxToEmu)(r));var p=i.C1.createLocalDeltaOption(o.ICE.emptyRange(),!1,!0).buildDelta();p.setCommandType(i.wI.DocInsertImage),p.globalOpts.undoOption.needInverse=!1,p.deleteText(c.range),i.Gh.insertImage(c.range.begin(),d,p,null!=u?u:new(o.kkf.getPropertyClass(o.uSS.RunProperty))),p.setUpdateSelection(!1),this.state.applyDelta(p)}}},e.prototype.insertContentStart=function(e,t,n){var r=t.buildDelta();r.setCommandType(i.wI.DocDeleteText);var o=new c(this.state.dataEngine,r.currentRange()),a=o.fixToValidReplaceRange(o.gcpRange);s.Logger.info("insertContentStart, insert index: ".concat(a.begin())),this.state.deleteText(a,r),this.state.applyDelta(r);var l=a.begin();(r=t.buildDelta()).setCommandType(i.wI.DocInsertContentStart),r.setNeedCollab(!1),r.setMutOption({exceptId:e}),n(r,l,this.state.followSpanProp(l)),this.state.applyDelta(r)},e.prototype.insertContentProgress=function(e,t,n){var r=this.exceptions.getExceptionRange(e,this.getTextStream());if(void 0!==r){var a=r.begin(),c=this.getTextStream().createRunIterator(r).getCloneProperty();if(c instanceof o.kkf.getPropertyClass(o.uSS.DrawingProperty)&&e===c.anchorId){var l=t.buildDelta();l.setCommandType(i.wI.DocInsertContentProgress),l.setUpdateSelection(!1),l.setNeedCollab(!1),l.setMutOption({exceptId:e}),l.globalOpts.undoOption.needInverse=!1,n(l,a,c),this.state.applyDelta(l)}}else s.Logger.warn("state|insertContentProgress: compositionGcpClass invalid id: ".concat(e))},e.prototype.insertContentFinish=function(e,t,n,r,o){var a=this.exceptions.getExceptionRange(e,this.getTextStream());if(void 0!==a)if(n(a)){var c=t.buildDelta();c.setCommandType(i.wI.DocInsertContentFinish),c.setUpdateSelection(r),c.setNeedCollab(!1),c.setMutOption({exceptId:e});var l=this.getTextStream().createRunIterator(a).getCloneProperty();c.deleteText(a),this.state.applyDelta(c),(c=t.buildDelta()).setUpdateSelection(r),o(c,a.begin(),l),this.state.applyDelta(c)}else s.Logger.warn("state|insertContentFinish: compositionRange invalid: ".concat(a));else s.Logger.warn("state|insertContentFinish: compositionGcpClass invalid id: ".concat(e))},e.prototype.insertContentCancel=function(e,t){var n=this.exceptions.getExceptionRange(e,this.getTextStream());if(void 0!==n){var r=t?t.buildDelta():this.state.delta();r.setCommandType(i.wI.DocInsertContentCancel),r.setNeedCollab(!1),r.setMutOption({exceptId:e}),r.deleteText(n),this.state.applyDelta(r)}else s.Logger.warn("state|insertContentCancel: compositionGcpClass invalid id: ".concat(e))},e}(),f=function(){function e(e){this.dirtyRangeClassMap=new Map,this.dataEngine=e}return e.prototype.insertDirtyRange=function(e,t){this.getDirtyRangeClass(e).insertRange(s.StringUtil.generateRandomId(),t)},e.prototype.genDirtyRangeMap=function(){var e=new Map;return this.dirtyRangeClassMap.forEach((function(t,n){t.forEachRange((function(t){var r=e.get(n);return r?r.values.push(t.range):r=new i.I3([t.range]),e.set(n,r),!1}),!0)})),e},e.prototype.clean=function(){this.dirtyRangeClassMap.forEach((function(e){e.destroy()})),this.dirtyRangeClassMap.clear()},e.prototype.getDirtyRangeClass=function(e){var t=this.dirtyRangeClassMap.get(e);return t||(t=this.dataEngine.createRangeClass(!0,!1),this.dirtyRangeClassMap.set(e,t)),t},e}(),g=n(61251);!function(e){e[e.Fatal=0]="Fatal",e[e.Warning=1]="Warning"}(r||(r={}));var v=function(){function e(e){this.state=e}return e.prototype.afterModelChange=function(e,t){var n=this.state.getTextStream();return t.forEach((function(e,t){var a=e.unionValue,s=n.createParagraphIterator(a);s.seek(a.begin());do{var c=s.getProperty();if(null==c?void 0:c.isPlaceholder){var l=s.getRange();if(n.charAt(l.begin())===o.IfD.ParagraphReturn)return[{reportModule:i.bg.PARAGRAPH,errorType:r.Warning,message:'Placeholder in ParagraphProperty should not be "'.concat(o.IfD.ParagraphReturn,'". GCP: ').concat(l.begin(),". StoryId: ").concat(t)}]}}while(s.hasNext()&&s.next())})),{errors:[]}},e}(),y=function(){function e(e){this.state=e}return e.prototype.afterModelChange=function(e,t){var n=this.state.dataEngine.getDataStream(),a=n.getTextStream(),s=[];return t.forEach((function(e,t){var c=e.unionValue,l=a.createRunIterator(c);l.seek(c.begin());do{var u=l.getRange(),d=l.getProperty();if(null==d?void 0:d.isPlaceholder){if(1!==u.len)return void s.push({errorType:r.Warning,reportModule:i.bg.RUN,message:"placeholder len more than one gcp:".concat(u.begin()," storyId: ").concat(t)});var p=a.readText(u.begin(),u.len);if(!Object.values(o.ghV).includes(p.charCodeAt(0)))return void s.push({errorType:r.Warning,reportModule:i.bg.RUN,message:"isPlaceholder run property is not placeholderCharCode, gcp: ".concat(u.begin()," storyId:").concat(t)});if(!i.iW.validatePlaceholderFeatureProperty({gcpRange:u,dataStream:n,placeholderChar:p}))return void s.push({errorType:r.Warning,reportModule:i.bg.RUN,message:"lack of feature property gcp:".concat(u.begin()," storyId:").concat(t)})}}while(l.hasNext()&&l.next())})),{errors:s}},e}(),m=function(){function e(e){this.state=e}return e.prototype.afterModelChange=function(){var e=i.iW.validateStoryPlaceholderChar(this.state);return{errors:e.result?[]:[{errorType:r.Warning,reportModule:i.bg.STORY,message:e.detail}]}},e}(),b=[i.wI.DocCompositionUpdate,i.wI.DocCompositionStart,i.wI.DocCompositionEnd],_=function(){function e(e){this.validators=[new y(e),new m(e),new v(e)]}return e.prototype.beforeDeltaApply=function(e){if(!this.isNeedToCheckDeltaBeforeApply(e))return{isBreak:!1};var t=[],n=!1;return this.validators.forEach((function(n){var r,o=null===(r=n.beforeDeltaApply)||void 0===r?void 0:r.call(n,e).errors;(null==o?void 0:o.length)&&(t=t.concat(o))})),t.forEach((function(t){n=t.errorType===r.Fatal,t.reportModule&&(0,i.Tz)({module:t.reportModule,commandType:e.globalOpts.commandType,detail:t.message,isBreak:n})})),{isBreak:n}},e.prototype.afterModelChange=function(e,t){if(!this.isNeedToCheckDeltaAfterModelChange(e))return{isBreak:!1};var n=[],o=!1;return this.validators.forEach((function(r){var o,i=null===(o=r.afterModelChange)||void 0===o?void 0:o.call(r,e,t).errors;(null==i?void 0:i.length)&&(n=n.concat(i))})),n.forEach((function(t){o=t.errorType===r.Fatal,t.reportModule&&(0,i.Tz)({module:t.reportModule,commandType:e.globalOpts.commandType,detail:t.message,isBreak:o})})),{isBreak:o}},e.prototype.isNeedToCheckDeltaBeforeApply=function(e){return!e.globalOpts.fromServer&&!b.includes(e.globalOpts.commandType)},e.prototype.isNeedToCheckDeltaAfterModelChange=function(e){return!e.globalOpts.fromServer&&(!b.includes(e.globalOpts.commandType)||!e.globalOpts.fromServer&&"revertOrFix"!==e.globalOpts.extraInfo)},e}(),C=5e5,S=function(){function e(){}return e.validate=function(e){var t=0;return e.operations.every((function(e){return e instanceof i.IZ&&(t+=e.param.text.length),t<C})),t<C},e}(),w="modelDidChangeAction",E=function(){function e(e,t){this.state=e,this.dirtyRangeManager=new f(this.state.dataEngine),this.exceptionManager=t,this.validators=[new _(e)]}return e.prototype.reset=function(){this.dirtyRangeManager.clean()},e.prototype.forceUpdateDirtyRange=function(e){var t=this.state.dataEngine.getDataStream().getStoryStream().getSubStoryInfoFromGcp(e.begin());this.dirtyRangeManager.insertDirtyRange(t.subStoryProp.id,e)},e.prototype.updateDirtyRange=function(e){var t=this,n=e.dirtyRange;if(!n&&e.exDirtyRange.length>0&&(n=(0,u.__read)(e.exDirtyRange,1)[0]),n){var r=this.state.dataEngine.getDataStream().getStoryStream().getSubStoryInfoFromGcp(n.begin());r&&(e.dirtyRange&&this.dirtyRangeManager.insertDirtyRange(r.subStoryProp.id,e.dirtyRange),e.exDirtyRange.length>0&&e.exDirtyRange.forEach((function(e){return t.dirtyRangeManager.insertDirtyRange(r.subStoryProp.id,e)})),this.updateMoreDirtyRange(n,e,r))}},e.prototype.updateMoreDirtyRange=function(e,t,n){var r,a;if(n.storyProp.storyType===o.AHI.textboxContent){var s=this.state.dataEngine.getDataStream().getDrawingStream();if(s){var c=s.getDrawingInfoFromContentId(n.subStoryProp.id,!0);if(c){var l=this.state.dataEngine.getDataStream().getStoryStream().getSubStoryInfoFromGcp(c.range.begin());l&&this.dirtyRangeManager.insertDirtyRange(l.subStoryProp.id,c.range)}}}if(t&&t instanceof i.vn&&t.isAllSectDirty()){var u=this.state.dataEngine.getDataStream().getSectionStream().createSectionIterator(e),d=u.getContentRange();e.contains(d)||this.dirtyRangeManager.insertDirtyRange(o.Eos.MainDocId,d);do{var p=u.getProperty();if(p){var h=null===(r=p.headerReference.getProperty(o.SoA.default))||void 0===r?void 0:r.id,f=h&&this.state.dataEngine.getDataStream().getStoryStream().getSubStoryInfoFromId(h,o.AHI.headerContent);f&&this.dirtyRangeManager.insertDirtyRange(f.subStoryProp.id,f.range);var g=null===(a=p.footerReference.getProperty(o.SoA.default))||void 0===a?void 0:a.id,v=g&&this.state.dataEngine.getDataStream().getStoryStream().getSubStoryInfoFromId(g,o.AHI.footerContent);v&&this.dirtyRangeManager.insertDirtyRange(v.subStoryProp.id,v.range)}this.updateFitToParentTextFrameDirtyRange(d)}while(u.next())}},e.prototype.updateFitToParentTextFrameDirtyRange=function(e){var t=this,n=this.state.dataEngine.getDataStream().getDrawingStream();n&&n.forEachDrawingRange((function(n){var r=n.range;if(e.end()<r.begin())return!0;if(e.intersect(r)){var i=t.state.getTextStream().createRunIterator();i.seek(r.begin());var a=i.getProperty();if((null==a?void 0:a.isPlaceholder)&&o.vCY.findPlaceholderCharProperty(t.state.dataEngine.getDataStream(),r.begin())){var s=t.state.dataEngine.getDataStream().getDrawingStream().createDrawingIterator();s.seek(i.getRange().begin());var c=s.getProperty(),l=null==c?void 0:c.contentId;if(!l)return!1;var u=t.state.dataEngine.getDataStream().getStoryStream().getSubStoryInfoFromId(l);if((null==u?void 0:u.subStoryProp.id)!==l&&(null==c?void 0:c.anchor.sizeRelH.relativeFrom)!==o.ZWb.page&&100!==(null==c?void 0:c.anchor.sizeRelH.pctWidth))return!1;if((null==u?void 0:u.storyProp.storyType)!==o.AHI.textboxContent)return!1;if(!u.subStoryProp.id)return!1;var d=t.state.getDataStream().getStoryStream().getSubStoryInfoFromId(u.subStoryProp.id,o.AHI.textboxContent);d&&t.dirtyRangeManager.insertDirtyRange(d.subStoryProp.id,d.range)}}return!1}))},e.prototype.validateDelta=function(e){return e.operations.length<=0?(s.Logger.info("delta operations is emtpy"),!1):!!S.validate(e)||(this.state.context.fire(new i.NG(e),!1),!1)},e.prototype.validatePlaceholderRun=function(e,t){var n=this;t.forEach((function(t,r){var a=n.state.dataEngine.getDataStream(),s=a.getTextStream(),c=t.unionValue,l=s.createRunIterator(c);for(l.seek(c.begin());l.hasNext();){var u=l.getRange(),d=l.getProperty();if(null==d?void 0:d.isPlaceholder){if(1!==u.len)return(0,i.oH)(e.globalOpts.commandType,"placeholder len more than one gcp:".concat(u.begin()," storyId: ").concat(r));var p=s.readText(u.begin(),u.len);if(!Object.values(o.ghV).includes(p.charCodeAt(0)))return(0,i.oH)(e.globalOpts.commandType,"isPlaceholder run property is not placehoderCharCode, gcp: ".concat(u.begin()," storyId:").concat(r));if(!i.iW.validatePlaceholderFeatureProperty({gcpRange:u,dataStream:a,placeholderChar:p}))return(0,i.oH)(e.globalOpts.commandType,"lack of feature property gcp:".concat(u.begin()," storyId:").concat(r))}l.next()}}))},e.prototype.validateStoryPlaceholderChar=function(e){var t=i.iW.validateStoryPlaceholderChar(this.state);t.result||(0,i.Z1)(e.globalOpts.commandType,t.detail)},e.prototype.applyOperationsAndUpdate=function(e){var t=this;if(e.applyOperations(this.state.dataEngine,(function(e){t.updateDirtyRange(e)})),!e.globalOpts.isInputDoc){var n=this.state.dataEngine.getDataManager().getNumberingManager();n&&n.modifyRenderRange((function(e){var n,r=t.state.dataEngine.getDataStream().getStoryStream().getSubStoryInfoFromGcp(e.begin());if(r){var i=null===(n=t.state.getDrawingStream().getDrawingInfoFromContentId(r.subStoryProp.id))||void 0===n?void 0:n.range;i&&t.dirtyRangeManager.insertDirtyRange(o.Eos.MainDocId,i),t.dirtyRangeManager.insertDirtyRange(r.subStoryProp.id,e)}}))}},e.prototype.handleModelChange=function(e,t){var n,r=0;try{var i=t.genDirtyRangeMap(),a=null===(n=i.get(o.Eos.MainDocId))||void 0===n?void 0:n.values;this.state.getTableStream().onModelChange(a);var c=Date.now();if(!this.isNeedToCheckDelta(e))return;r=this.state.context.run(w,e,i),s.Logger.info("[handleModelChange] exec verify logic time(ms)",Date.now()-c)}catch(e){s.Logger.error("[handleModelChange] exec verify logic failed")}if(Number.isInteger(r)&&r>0)throw this.revertDelta(e,{msg:"revertOrFix"}),s.Logger.error("after apply delta error:".concat(r)),new Error("after apply delta error:".concat(r))},e.prototype.handleSelection=function(e,t,n){if(this.state.selection.updateTableSelectionCache(),e.globalOpts.updateSelection)if(e.globalOpts.fromServer)this.state.setRangeTo(e.currentRange(),{scrollToView:i.hF.None,forceNotify:!0,forceFocus:!1,mobileSelectionDrag:i.p2.Keep,mobileContextMenu:i.A6.Keep,afterApplyDelta:!0,noSendCaret:!0});else{var r=e.globalOpts.undoOption,a=r.fromUndoRedo,s=r.undoRedoType,c=r.undoSelectionRange,l=r.redoSelectionRange,u=e.currentRange();a&&(s===i.z$.Undo&&c?u=c:s===i.z$.Redo&&l&&(u=l)),this.state.setRangeTo(u,{forceNotify:!0,afterApplyDelta:!0,noSendCaret:!0})}else{var d=this.state.selection.gcpRange;if(t.notEqual(d)){var p=e.globalOpts.fromServer;this.state.context.fire(new i.aj(d,{},{scrollToView:i.hF.None,forceFocus:!p,mobileSelectionDrag:p?i.p2.Keep:i.p2.Show,mobileContextMenu:p?i.A6.Keep:i.A6.Show,afterApplyDelta:!0,noSendCaret:!0}))}}!e.globalOpts.fromServer&&t.notEqual(this.state.selection.gcpRange)&&(this.state.cusorSpanProp=null),this.state.cusorSpanProp=n||new(o.kkf.getPropertyClass(o.uSS.RunProperty))},e.prototype.handleCollab=function(e){if(!e.globalOpts.fromServer){var t=e.getMutations();try{if(e.globalOpts.needCollab){var n=this.exceptionManager.meetsLocalMutation(t);this.state.context.fire(new i.nl(n,e),!1)}else this.exceptionManager.mergeExceptions(t.mutations)}catch(e){e.message+=" mutations: ".concat(JSON.stringify(t.mutations),", exceptions: ").concat(this.exceptionManager.printDebugInfo()),a.kQ.captureChangesetException(a.GI.CHANGESET_ERROR_DELTA2CS,{option:{}},e)}}},e.prototype.handleUndoRedoInverse=function(e){e.globalOpts.undoOption.fromUndoRedo&&this.state.context.run("setInverseToStackTop",e)},e.prototype.apply=function(e){try{e.globalOpts.fromServer||e.globalOpts.commandType!==i.wI.Empty?this.state.dataEngine.getIsChunkLoading()||s.Logger.info("applyDelta: ".concat(e.globalOpts.commandType,", fromServer: ").concat(e.globalOpts.fromServer)):s.Logger.warn("WARNING! A CommandType for delta is highly recommended.");var t=[s.PerfUtil.now(),0,0];if(!this.validateDelta(e))return void s.Logger.warn("WARNING! delta is invalid and abandoned");if(this.validators.some((function(t){var n;return null===(n=t.beforeDeltaApply)||void 0===n?void 0:n.call(t,e).isBreak})))return;this.state.context.fire(new i.bq(e.globalOpts.fromServer),!1);var n=this.state.createNewCursorSpan(e),r=this.state.selection.gcpRange;e.globalOpts.undoOption.fromUndoRedo||(e.globalOpts.undoOption.undoSelectionRange=r.clone(),e.globalOpts.undoOption.redoSelectionRange=e.currentRange().clone()),this.applyOperationsAndUpdate(e),this.handleModelChange(e,this.dirtyRangeManager);var o=this.dirtyRangeManager.genDirtyRangeMap();if(this.validators.some((function(t){var n;return null===(n=t.afterModelChange)||void 0===n?void 0:n.call(t,e,o).isBreak})))return;this.sendSyncModelChangeNotification(e.globalOpts.fromServer),this.sendModelChangeNotification(e.globalOpts.fromServer),this.state.waitingForReflow=!0,this.handleSelection(e,r,n),t[1]=s.PerfUtil.now(),this.handleCollab(e),t[2]=s.PerfUtil.now(),this.handleUndoRedoInverse(e),this.updatePerfManagerInfo(t,e)}catch(t){e.globalOpts.fromServer||e.globalOpts.undoOption.fromUndoRedo||this.reportDataLost(),a.kQ.captureChangesetException(a.GI.CHANGESET_ERROR_APPLY_DELTA,{option:{}},t)}},e.prototype.applyMutations=function(e,t){if(0!==e.length)try{var n=this.exceptionManager.meetsServerMutation(e,t.undoOption.fromUndoRedo),r=t.buildDelta();n.forEach((function(e){return r.addOperation(i.Bz.createServerOperation(e))})),this.apply(r)}catch(n){t.undoOption.fromUndoRedo&&this.reportDataLost(),n.message+=" mutations: ".concat(JSON.stringify(e),", exceptions: ").concat(this.exceptionManager.printDebugInfo()),a.kQ.captureChangesetException(a.GI.CHANGESET_ERROR_APPLY_MUTATION,{option:{}},n)}},e.prototype.reportDataLost=function(){a.kQ.monitor(a.GI.DATA_PRODUCE_ERROR_FRONT),a.kQ.monitor007Status(a.GI.DATA_PRODUCE_ERROR_FRONT_3_0),a.kQ.tdwReport({opername:"doc_word_melo",module:"data_lost",action:"exp_tip",ver5:"1",ver6:a.y4.DOCUMENT,ver7:a.wh.EDIT_DATA,obj3:1})},e.prototype.updatePerfManagerInfo=function(e,t){var n=e[2]-e[0],r=e[2]-e[1],o=t.operations.length,i=this.state.context.perfManager;i.costTime[g.zI.ApplyDelta]=n,i.costTime[g.zI.Collab]=r,n>1e3?s.Logger.warn("perf|applyDelta total=".concat(n,"ms,collab=").concat(r,"ms,opCount=").concat(o)):n>30&&s.Logger.log("perf|applyDelta total=".concat(n,"ms,collab=").concat(r,"ms,opCount=").concat(o)),t.globalOpts.isInputDoc||i.addRecentEditInfo(t,e[0])},e.prototype.sendModelChangeNotification=function(e){var t=this;if(!this.mergeDeltaTimeout){var n=function(){var n=t.dirtyRangeManager.genDirtyRangeMap();t.state.context.fire(new i.BB({dirtyRangeMap:n},e),!1),t.dirtyRangeManager.clean(),t.mergeDeltaTimeout=null};this.mergeDeltaTimeout=requestAnimationFrame?requestAnimationFrame(n):setTimeout(n)}},e.prototype.sendSyncModelChangeNotification=function(e){var t=this.dirtyRangeManager.genDirtyRangeMap();t&&t.size>0&&this.state.context.fire(new i.z2({dirtyRangeMap:t},e),!1)},e.prototype.revertDelta=function(e,t){var n=e.getMutations().inverses,r=i.C1.createLocalDeltaOption(o.ICE.emptyRange(),!1,!1).buildDelta();r.globalOpts.extraInfo=t.msg,r.globalOpts.undoOption.needInverse=!1,r.globalOpts.undoOption.fromUndoRedo=!0,n.forEach((function(t){return e.addOperation(i.Bz.createServerOperation(t))})),this.apply(r)},e.prototype.isNeedToCheckDelta=function(e){return!e.globalOpts.fromServer&&"revertOrFix"!==e.globalOpts.extraInfo},e.prototype.validateFullDoc=function(){for(var e=new f(this.state.dataEngine),t=this.state.getStoryStream(),n=t.createStoryIterator();n.hasNext();){var r=n.getProperty(),i=n.getContentRange();if((null==r?void 0:r.storyType)===o.AHI.mainDocument)e.insertDirtyRange(o.Eos.MainDocId,i);else for(var a=t.createSubStoryIterator({limitRange:i});a.hasNext();){var s=t.getSubStoryInfoFromGcp(a.getRange().begin());s&&e.insertDirtyRange(s.subStoryProp.id,null==s?void 0:s.range),a.next()}n.next()}this.handleModelChange(this.state.delta(),e)},e}(),x=function(){function e(e){this.dataStream=e,this.paraFields=[],this.textStream=e.getTextStream(),this.fieldStream=e.getFieldStream()}return e.prototype.follow=function(e){return this.seek(e),this.gcpInsideSpan()?this.runIter.getCloneProperty():this.findPrevSpan()||this.useCurrSpan()||this.findNextSpan()},e.prototype.seek=function(e){this.gcp=e,this.paraIter=this.textStream.createParagraphIterator(),this.paraIter.seek(e),this.runIter=this.textStream.createRunIterator(),this.runIter.seek(e),this.collectParaFields(),this.gcpInField=this.detectCurrField()},e.prototype.gcpInsideSpan=function(){return this.gcp!==this.runIter.getRange().begin()},e.prototype.findPrevSpan=function(){return this.findSiblingSpan(!0)},e.prototype.findNextSpan=function(){return this.findSiblingSpan(!1)},e.prototype.findSiblingSpan=function(e){for(this.resetRunIter();!this.shouldStop(e);)if(e?this.runIter.prev():this.runIter.next(),this.predicate())return this.runIter.getCloneProperty();return null},e.prototype.useCurrSpan=function(){return this.resetRunIter(),this.predicate()?this.runIter.getCloneProperty():null},e.prototype.resetRunIter=function(){this.runIter.seek(this.gcp),this.detectCurrField(),this.skipping=!1},e.prototype.predicate=function(){var e=!!this.currField;return this.detectCurrField()!==e&&(this.skipping=!this.skipping),!this.skipping&&this.isFollowable()},e.prototype.shouldStop=function(e){if(this.gcpInField&&!this.currField)return!0;var t=e?this.runIter.hasPrev():this.runIter.hasNext(),n=this.paraIter.getRange().contains(this.runIter.getRange()),r=e&&this.runIter.getRange().begin()===this.paraIter.getRange().begin();return!t||!n||r},e.prototype.isFollowable=function(){var e=!!this.currField&&this.currField.fieldCodeRange.contains(this.runIter.getRange()),t=this.isPlaceholder(),n=this.runIter.getRange(),r=1===n.length()&&this.textStream.readText(n.begin(),1)===o.IfD.ParagraphReturn;return!e&&(!t||r)},e.prototype.isPlaceholder=function(){var e,t=this.runIter.getRange();return!(1!==t.length()||!(null===(e=this.runIter.getProperty())||void 0===e?void 0:e.isPlaceholder))&&null!==o.vCY.findPlaceholderCharProperty(this.dataStream,t.begin())},e.prototype.detectCurrField=function(){var e=this.runIter.getRange();return this.currField=this.paraFields.find((function(t){return t.fieldRange.contains(e)})),this.currField&&e.begin()===this.currField.fieldRange.begin()&&(this.currField=void 0),!!this.currField},e.prototype.collectParaFields=function(){this.paraFields=[];var e=this.paraIter.getRange(),t=this.textStream.createRunIterator(new o.ICE(e.begin(),e.length())),n=function(){var e=r.fieldStream.getFieldRange(t.getRange().begin());e&&!r.paraFields.find((function(t){return t.fieldRange.equal(e.fieldRange)}))&&r.paraFields.push(e)},r=this;do{n()}while(t.next())},e}(),T=function(){function e(e){this.state=e}return e.prototype.beforeDeleteText=function(e,t){var n=this.state.getStoryStream(),r=this.state.context.service.getComment(),o=n.getSubStoryInfoFromGcp(t.begin()),i=r.collectCommentSubStoryInfosByRange(t),a=[];return i.forEach((function(e){o&&o.range.lessThan(e.range)&&a.push(e)})),this.collectCommentSubStoryDeletionToDelta(e,a),this.fixCommentRefRange(t),!1},e.prototype.afterDeleteText=function(e,t){var n=this.state.getStoryStream(),r=this.state.context.service.getComment(),o=n.getSubStoryInfoFromGcp(t.begin()),i=r.collectCommentSubStoryInfosByRange(t),a=[];return i.forEach((function(e){o&&e.range.lessThan(o.range)&&a.push(e)})),this.collectCommentSubStoryDeletionToDelta(e,a),!1},e.prototype.collectCommentSubStoryDeletionToDelta=function(e,t){t.sort((function(e,t){return e.range.lessThan(t.range)?1:-1})),t.forEach((function(t){i.Gh.deleteText(t.range,e)}))},e.prototype.fixCommentRefRange=function(e){var t=this.state.context.service.getComment().collectCommentInfosFromGcpRanges(e).filter((function(t){return t.annotationRange&&e.contains(t.annotationRange)&&e.end()===t.refRange.begin()})).length;e.backwardExpand(t)},e}(),R=(0,a.yh)("state"),I=function(){function e(e){this._fromServer=!1,this._waitingForReflow=!1,this.context=e,this._dataEngine=o.ymk.createCoreDataEngine(),this._selection=new l(this._dataEngine),this._cusorSpanProp=null,this._listMarkerSpanProp=null,this._exceptionManager=new h(this),this._deltaApplyController=new E(this,this._exceptionManager),this._containerNeedUpdateCaret=null,this._hooks=[],this.initHooks(),this.monitorDataNotification()}return e.emptyState=function(t){return new e(t)},e.prototype.importDocData=function(e,t){if((null==t?void 0:t.isEmptyContent)||(null==t?void 0:t.isContainSubStory)){var n=this.serializeDataEngine({dataEngine:e,isContainSettings:null==t?void 0:t.isEmptyContent,isContainSubStory:null==t?void 0:t.isContainSubStory});this._dataEngine.copyFrom(this.deserializeDataEngine(n))}else(null==t?void 0:t.isDeepCopy)?(n=this.serializeDataEngine({dataEngine:e}),this._dataEngine.copyFrom(this.deserializeDataEngine(n))):this._dataEngine.copyFrom(e);this._selection.reset(),this._cusorSpanProp=null,this._listMarkerSpanProp=null,this._exceptionManager.reset(),this._deltaApplyController.reset(),this._containerNeedUpdateCaret=null,this.removeDataNotification(),this.monitorDataNotification()},e.prototype.monitorDataNotification=function(){var e=this;this._notificationCenter=this._dataEngine.getNotificationCenter(),this._notificationCenter.on(o.R4b.DrawingChange,this.onInsertDrawingNotification,!0,this),this._notificationCenter.on(o.R4b.DeleteDrawing,this.onDeleteDrawingNotification,!0,this),this._notificationCenter.on(o.R4b.SubStoryChange,this.onStoryChangeNotification,!0,this),this._notificationCenter.on(o.kU_.DocumentSettingsChange,(function(){e.context.fire(new i.a3)}),!1),this._notificationCenter.on(o.R4b.DeleteComment,(function(t){e.context.fire(new i.ZX(t.propList))}),!0,this),this._notificationCenter.on(o.Cl$.FieldDelete,(function(t){e.context.fire(new i.vc(t.fieldCodes,e._fromServer))}),!1),this._notificationCenter.on(o.R4b.FieldChange,(function(t){if(t.fieldProperty.fldCharType===o.P1W.end){var n=e._dataEngine.getDataStream().getFieldStream(),r=n.getFieldCode(t.range.begin()),a=n.getFieldRange(t.range.gcpBegin);r&&e.context.fire(new i.ki([r],[t.range],[null==a?void 0:a.fieldRange],e._fromServer))}}),!1),this._notificationCenter.on(o.R4b.InsertCommentRange,(function(t){e.context.fire(new i.Ow(t.commentRangeProp))})),this._notificationCenter.on(o.R4b.InsertPermissionRange,(function(t){e.context.fire(new i.Fm(t.permissionRangeProp))}))},e.prototype.removeDataNotification=function(){this._notificationCenter.removeListener(o.R4b.DrawingChange,this),this._notificationCenter.removeListener(o.R4b.DeleteDrawing,this),this._notificationCenter.removeListener(o.R4b.SubStoryChange,this),this._notificationCenter.removeListener(o.R4b.DeleteComment,this),this._notificationCenter.removeListener(o.kU_.DocumentSettingsChange,this),this._notificationCenter.removeListener(o.Cl$.FieldDelete,this),this._notificationCenter.removeListener(o.R4b.InsertPermissionRange,this)},e.prototype.onInsertDrawingNotification=function(e){var t=this.getDataStream().getDrawingStream().getDrawingInfoFromGcp(e.range.begin());t&&(e.updateMode===o.XS7.Insert&&this.context.fire(new i.j4(t.property,this._fromServer)),this.context.fire(new i.l(t.property,this._fromServer)))},e.prototype.onStoryChangeNotification=function(e){var t=this.getDataStream().getStoryStream().getSubStoryInfoFromGcp(e.range.begin());(null==t?void 0:t.storyProp)&&t.storyProp.storyType===o.AHI.mainDocument&&this.context.fire(new i.a3)},e.prototype.onDeleteDrawingNotification=function(e){e.propList&&this.context.fire(new i.LA(e.propList,this._fromServer))},e.prototype.insertGuardParagraph=function(e,t){if(!this.selection.getCoreRange().storyValidRange().notEqual(e)){var n=this.getTextStream().createParagraphIterator();n.seek(e.begin());var r=new(o.kkf.getPropertyClass(o.uSS.RunProperty)),a=n.getCloneProperty()||new(o.kkf.getPropertyClass(o.uSS.ParagraphProperty));i.Gh.insertParagraph(e.begin(),r,a,t)}},e.prototype.importEmptyDocData=function(){this.dataEngine.copyFrom(this.deserializeDataEngine(i.XT.serializeEmptyDoc()))},e.prototype.serializeDataEngine=function(e){var t=(null==e?void 0:e.dataEngine)||this.dataEngine;return(null==e?void 0:e.isContainSettings)?i.XT.serializeContainSettingsDoc(t):(null==e?void 0:e.isContainSubStory)?i.XT.serializeContainSubStoryDoc(t):i.XT.serialize(t)},e.prototype.serializeLimitRangeDoc=function(e){var t=[];return i.XT.serializeLimitRangeDoc(this.dataEngine,e).forEach((function(e){var n=new i.iN(e,{});t.push(n)})),t},e.prototype.deserializeDataEngine=function(e){return i.Eo.deserialize(e)},e.prototype.generateDocumentKeyFrame=function(){var e={commands:[{type:"kDocExtracCmdFromDoc",mutations:this.serializeDataEngine()}]};return JSON.stringify(e)},e.prototype.getTextStream=function(){return this._dataEngine.getDataStream().getTextStream()},e.prototype.getFieldStream=function(){return this._dataEngine.getDataStream().getFieldStream()},e.prototype.getTableStream=function(){return this._dataEngine.getDataStream().getTableStream()},e.prototype.getSectionStream=function(){return this._dataEngine.getDataStream().getSectionStream()},e.prototype.getDrawingStream=function(){return this._dataEngine.getDataStream().getDrawingStream()},e.prototype.getStoryStream=function(){return this._dataEngine.getDataStream().getStoryStream()},e.prototype.getAnnotationStream=function(){return this._dataEngine.getDataStream().getAnnotationStream()},e.prototype.getDataStream=function(){return this._dataEngine.getDataStream()},Object.defineProperty(e.prototype,"dataEngine",{get:function(){return this._dataEngine},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deltaApplyController",{get:function(){return this._deltaApplyController},enumerable:!1,configurable:!0}),e.prototype.delta=function(){return i.C1.createLocalDeltaOption(this.selection.gcpRange).buildDelta()},e.prototype.getCompositionRange=function(e){return this._exceptionManager.getCompositionRange(e)},e.prototype.getCurrentCompositionRange=function(){var e;return null!==(e=this._exceptionManager.getCurrentRange())&&void 0!==e?e:null},e.prototype.createNewCursorSpan=function(e){var t=null;if(e.operations[0].operationType===i.C8.DeleteText&&!e.globalOpts.fromServer&&!e.globalOpts.undoOption.fromUndoRedo&&e.globalOpts.needCollab&&e.globalOpts.updateSelection){var n=e.operations[0],r=this.followSpanProp(n.range.begin(),!0),o=this.currentSpanProp(n.range.begin());r.equalTo(o)||(t=r)}return t},e.prototype.applyDelta=function(e){this._fromServer=e.globalOpts.fromServer,this._deltaApplyController.apply(e)},e.prototype.applyMutations=function(e,t){this._fromServer=t.fromServer,this._deltaApplyController.applyMutations(e,t)},e.prototype.compositionStart=function(e,t){void 0===t&&(t=!1),this._exceptionManager.compositionStart(e,t)},e.prototype.compositionUpdate=function(e,t,n){void 0===n&&(n=!1),this._exceptionManager.compositionUpdate(e,t,n)},e.prototype.compositionEnd=function(e,t,n){void 0===n&&(n=!0),this._exceptionManager.compositionEnd(e,t,n)},e.prototype.insertCopyImageFinish=function(e,t,n,r){this._exceptionManager.insertCopyImageFinish(e,t,n,r)},e.prototype.insertResourceStart=function(e,t,n){this._exceptionManager.insertContentStart(e,t,n),this._containerNeedUpdateCaret=[e,!0]},e.prototype.insertResourceProgress=function(e,t,n){this._exceptionManager.insertContentProgress(e,t,n)},e.prototype.insertResourceFinish=function(e,t,n,r){var o=!(!this._containerNeedUpdateCaret||this._containerNeedUpdateCaret[0]!==e)&&this._containerNeedUpdateCaret[1];this._exceptionManager.insertContentFinish(e,t,n,o,r)},e.prototype.insertResourceCancel=function(e,t){this._exceptionManager.insertContentCancel(e,t)},e.prototype.insertTextStart=function(e,t,n){var r="text_".concat(e);this._exceptionManager.insertContentStart(r,t,n)},e.prototype.insertTextFinish=function(e,t,n){var r="text_".concat(e);this._exceptionManager.insertContentFinish(r,t,(function(){return!0}),!0,n)},e.prototype.insertTextCancel=function(e,t){var n="text_".concat(e);this._exceptionManager.insertContentCancel(n,t)},e.prototype.deleteText=function(e,t){if(!(e.length()<=0)){var n=this._hooks.some((function(n){var r;return null===(r=n.beforeDeleteText)||void 0===r?void 0:r.call(n,t,e)}));if(!n){this.dataEngine.getDataStream().getAnnotationStream().collectBookmarkRangeInfoFromRange(e).forEach((function(e){var n=t.currentRange();i.Gh.deleteBookmark(e.annotationRange,e.rangeProp.id,e.rangeProp.name,t),t.moveTo(n)})),i.Gh.deleteText(e,t);var r=this.getTextStream().createParagraphIterator(e),a=this.getTextStream().createRunIterator(e),s=r.getCloneProperty(),c=r.getRange();r.seek(c.end()-1),a.seek(c.end()-1);var l=a.getCloneProperty();if(s&&e.end()>=c.end()){var u=c.intersectRange(e);if(u.notEqual(c))if(u.length()>1)l&&i.Gh.insertParagraph(e.begin(),l,s,t);else{r.seek(e.end()),a.seek(e.end());var d=r.getCloneProperty(),p=r.getRange();(null==d?void 0:d.pBdr.bottom)&&(s.pBdr.bottom=d.pBdr.bottom.clone()),i.Gh.setParagraphProperty({range:new o.ICE(e.begin(),0),property:s,mode:o.XS7.Cover},t),p&&p.end()-e.end()==1&&l&&i.Gh.setRunProperty(new o.ICE(e.begin(),1),l,t,o.XS7.Cover)}}t.moveTo(new o.ICE(e.begin(),0));var h=this.createNewCursorSpan(t);h&&(this.cusorSpanProp=h);for(var f=this.getFieldStream().createFieldIterator({limitRange:e}),g=new Map,v=[];f.hasNext();){var y=f.getRange(!0),m=this.getFieldStream(),b=null==m?void 0:m.getDecodedFieldInfo(y.begin()),_=null==b?void 0:b.fieldRange;if(b&&_&&!_.isNull()){var C=b.fieldCode,S=C.switches,w=C.instructions,E=C.name;if(o.BqD.isContainerField(S)&&S&&g.set(S[o.VEu.key],!1),e.contains(_)){var x=o.BqD.encodeFieldCode(E,w,S);v.push(x)}}f.next()}this.insertGuardParagraph(e,t),this.context.fire(new i.ZP(g,v)),this._hooks.some((function(n){var r;return null===(r=n.afterDeleteText)||void 0===r?void 0:r.call(n,t,e)}))}}},Object.defineProperty(e.prototype,"selection",{get:function(){return this._selection},enumerable:!1,configurable:!0}),e.prototype.setRangeTo=function(e,t){var n,r,a,s,c;void 0===t&&(t={noSendCaret:!1});var l=!!(null===(s=null===(a=null===(r=null===(n=this.context.view)||void 0===n?void 0:n.getRenderState)||void 0===r?void 0:r.call(n))||void 0===a?void 0:a.getFocusOnInfo())||void 0===s?void 0:s.isFocusHeaderFooter),u=(null===(c=this._dataEngine.getDataStream().getStoryStream().getSubStoryInfoFromGcp(e.begin()))||void 0===c?void 0:c.storyProp.storyType)||o.AHI.mainDocument;if(!l&&(u===o.AHI.headerContent||u===o.AHI.footerContent))return!1;if(l&&u===o.AHI.mainDocument)return!1;var d=this._selection.setRangeTo(e,t);return(d||(null==t?void 0:t.forceNotify))&&(d&&(this.cusorSpanProp=null,this.listMarkerSpanProp=null,this._containerNeedUpdateCaret&&(this._containerNeedUpdateCaret[1]=!1)),this.context.fire(new i.aj(this._selection.gcpRange,this._selection.tableSelectionArea,t))),d},e.prototype.moveTo=function(e,t){this.setRangeTo(new o.ICE(e,t))},e.prototype.currentSpanProp=function(e){var t=this.getTextStream().createRunIterator();t.seek(e);var n=t.getCloneProperty();return n||new(o.kkf.getPropertyClass(o.uSS.RunProperty))},e.prototype.followSpanProp=function(e,t){var n;void 0===t&&(t=!1),this._spanPropFollower||(this._spanPropFollower=new x(this.getDataStream()));var r=this._spanPropFollower.follow(e);return n=r?new(o.kkf.getPropertyClass(o.uSS.RunProperty))(r):new(o.kkf.getPropertyClass(o.uSS.RunProperty)),!t&&e===this.selection.gcpRange.begin()&&this.cusorSpanProp&&n.merge(this.cusorSpanProp),n.setDefault(o.kkf.getPropertyClass(o.uSS.RunProperty).tKeys.isPlaceholder),n},e.prototype.currentParaProp=function(e){var t=this.getTextStream().createParagraphIterator();t.seek(e);var n=t.getCloneProperty();return n||new(o.kkf.getPropertyClass(o.uSS.ParagraphProperty))},e.prototype.followParaProp=function(e){var t=o.kkf.getPropertyClass(o.uSS.RunProperty).createPlaceholderRun(),n={paraProp:new(o.kkf.getPropertyClass(o.uSS.ParagraphProperty)),paraBreakSpan:t},r=this.getTextStream().createParagraphIterator();r.seek(e);var i=r.getCloneProperty(),a=r.getRange();if(!i||a.length()<1)return n;var c=this.dataEngine.getDataManager().getStyleSheetManager();if(i.paraId=s.StringUtil.generateRandomId(),t.merge(this.followSpanProp(e)),e===a.end()-1){var l=c.getStylePropertyFromId(i.pStyle);if(null==l?void 0:l.next){var u=c.getStylePropertyFromId(l.next);u&&u.styleId===i.pStyle&&!c.isBasicStyle(u)||(i.clean(o.vCY.createClearParagraphProperty()),u&&(i.pStyle=u.styleId))}i.has(i.tKeys.taskPr)&&i.taskPr.taskState===o.RWe.done&&(i.taskPr.taskState=o.RWe.todo),i.hintType&&(i.hintType=""),i.taskPr.taskId&&(i.taskPr.taskId=""),i.taskPr.taskId&&(i.taskPr.taskCompleter="")}return{paraProp:i,paraBreakSpan:t}},e.prototype.followSectProp=function(e){var t=this.dataEngine.getDataStream().getSectionStream().createSectionIterator();t.seek(e);var n=t.getCloneProperty();return n||new(o.kkf.getPropertyClass(o.uSS.SectionProperty))},Object.defineProperty(e.prototype,"cusorSpanProp",{get:function(){return this._cusorSpanProp},set:function(e){var t=!0;this._cusorSpanProp&&e?this._cusorSpanProp.merge(e):this._cusorSpanProp||e?this._cusorSpanProp=e:t=!1,t&&this.context.fire(new i.$C)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"listMarkerSpanProp",{get:function(){return this._listMarkerSpanProp},set:function(e){this._listMarkerSpanProp=e},enumerable:!1,configurable:!0}),e.prototype.isRangeBeginAtParaStart=function(e){if(0!==e.length())return!1;var t=this.dataEngine.getDataStream().getTextStream().createParagraphIterator();return t.seek(e.begin()),t.getRange().gcpBegin===e.begin()},e.prototype.isCompositing=function(){return this._exceptionManager.isCompositing()},e.prototype.getCompositionId=function(){return this._exceptionManager.getCompositionId()},e.prototype.getCompositionText=function(){return this._exceptionManager.getCompositionText()},e.prototype.meetsServerMutation=function(e,t){return this._exceptionManager.meetsServerMutation(e,t)},Object.defineProperty(e.prototype,"waitingForReflow",{get:function(){return this._waitingForReflow},set:function(e){this._waitingForReflow=e},enumerable:!1,configurable:!0}),e.prototype.initHooks=function(){this._hooks.push(new T(this))},e}(),P=n(20113),O=function(){function e(){}return e.nextTextBreak=function(e,t){if(t<0||t>=e.getLength()-1)return t;var n=this._findTextRange(e,t);return this._textBreak(e,n,t,!0)},e.previousTextBreak=function(e,t){if(t<=0||t>e.getLength()-1)return t;var n=this._findTextRange(e,t);return this._textBreak(e,n,t,!1)},e._textBreak=function(e,t,n,r){var o=n-t.begin();if(o>=0){var i=e.readText(t.begin(),t.end()),a=r?(0,P.nextBreak)(i,o):(0,P.previousBreak)(i,o);return t.begin()+a}return n},e._findTextRange=function(e,t){var n=e.createParagraphIterator();n.seek(t);var r=n.getRange();return n.prev()&&(r=r.unionRange(n.getRange())),r},e}()},46708:function(e,t,n){n.d(t,{wc:function(){return Se},wh:function(){return i},u$:function(){return te},D2:function(){return xe},aP:function(){return ne},y4:function(){return a},Lf:function(){return y},q2:function(){return V},Bx:function(){return W},oI:function(){return g},bP:function(){return l},Vm:function(){return c},yB:function(){return qe},cR:function(){return C},bV:function(){return U},ii:function(){return q},N9:function(){return F},VD:function(){return N},yl:function(){return B},_Z:function(){return De},wE:function(){return K},B7:function(){return Ee},GI:function(){return r},Gk:function(){return H},$w:function(){return p},V7:function(){return h},j7:function(){return Ze},Ij:function(){return we},We:function(){return o},ok:function(){return f},kQ:function(){return E},eG:function(){return s},Oh:function(){return ae},WZ:function(){return v},Wb:function(){return m},Al:function(){return j},nU:function(){return re},HX:function(){return Re},lu:function(){return P},yh:function(){return Qe},vM:function(){return Fe},_v:function(){return Ie},o3:function(){return se},BK:function(){return Pe},vZ:function(){return $},vS:function(){return R},B0:function(){return ee},ej:function(){return Q},hU:function(){return A},E:function(){return M},fM:function(){return Z},Bp:function(){return Y.isLogin},qP:function(){return D},hb:function(){return X},Rz:function(){return O},vg:function(){return Ae},S7:function(){return Me},__:function(){return x},OR:function(){return J},nT:function(){return oe},Sm:function(){return k},n$:function(){return Le}});var r,o,i,a,s,c,l,u=n(20113),d=/zoom: \d+(.\d+)?/,p=function(){function e(){}return e.isTextNode=function(e){return!!e&&e.nodeType===Node.TEXT_NODE},e.isCommentNode=function(e){return(null==e?void 0:e.nodeType)===Node.COMMENT_NODE},e.getTagName=function(e){return e?e.nodeName:""},e.getValue=function(e){return e?e.nodeValue:null},e.getNodeTextContent=function(t){var n=t.innerText||t.textContent||"";return!n&&t.childNodes.length&&t.childNodes.forEach((function(t){n+=e.getValue(t)||""})),n},e.getAttr=function(e,t){return this.isElementNode(e)?e.getAttribute(t):null},e.getChildNodeNum=function(e){return e.childNodes.length},e.getChildNode=function(t,n){return e.getChildNodeNum(t)>n&&n>=0?t.childNodes.item(n):null},e.getInnerHTML=function(e){return this.isElementNode(e)?e.innerHTML:""},e.getProp=function(e,t){return this.isElementNode(e)?"className"===t&&"http://www.w3.org/2000/svg"===e.namespaceURI?e[t].baseVal:e[t]:null},e.getTdocTitle=function(e){return e.split(" ").find((function(e){if("tco-title-title"===e||"tco-title-subtitle"===e)return e}))},e.getStyleMap=function(t){var n=new Map,r=e.getAttr(t,"style");if(r){var o=r.split(";");if(o)for(var i=0;i<o.length;i++)if(o[i]){var a=o[i].split(":");(null==a?void 0:a[0])&&a[1]&&n.set(a[0].trim(),a[1].trim())}}return n},e.getScrollOffset=function(e,t){var n={scrollX:0,scrollY:0};if(e)for(var r=e.parentElement;r&&r!==t;)n.scrollX+=r.scrollLeft,n.scrollY+=r.scrollTop,r=r.parentElement;return n},e.getOffsetByPosition=function(e,t,n){if(this.isTextNode(e)){var r=e.textContent;if(r){var o=new u.UString(r);return this.binarySearchPosition(o,e,t,n,0,o.graphemeCount(),r.length)}}return{offset:0,offsetUString:0,offsetPx:0}},e.binarySearchPosition=function(e,t,n,r,o,i,a){if(i-o>1){var s=Math.floor((o+i)/2),c=document.createRange();c.setStart(t,e.graphemeIndex2CharCodeIndexRange(o).start),c.setEnd(t,e.graphemeIndex2CharCodeIndexRange(s).end>a?a:e.graphemeIndex2CharCodeIndexRange(s).end);var l=c.getBoundingClientRect();return r<=l.left-n+l.width?this.binarySearchPosition(e,t,n,r,o,s,a):this.binarySearchPosition(e,t,n,r,s,i,a)}var u=document.createRange();u.setStart(t,e.graphemeIndex2CharCodeIndexRange(o).start),u.setEnd(t,e.graphemeIndex2CharCodeIndexRange(o).end+1>a?a:e.graphemeIndex2CharCodeIndexRange(o).end+1);var d=u.getBoundingClientRect(),p=d.left-n,h=d.width;return r<=p+h/2?{offset:o,offsetUString:e.graphemeIndex2CharCodeIndexRange(o).start,offsetPx:p}:{offset:i,offsetUString:e.graphemeIndex2CharCodeIndexRange(o).end+1,offsetPx:p+h}},e.fixGraphemeIndex=function(e){if(this.isTextNode(e.startContainer)&&e.startContainer.textContent&&!(0===e.startOffset||e.startOffset>=e.startContainer.textContent.length)){var t=new u.UString(e.startContainer.textContent),n=t.charCodeIndex2GraphemeIndex(e.startOffset),r=t.graphemeIndex2CharCodeIndexRange(n).start;e.setStart(e.startContainer,r)}},e.getMouseEventCaretRange=function(t,n){var r=document.createRange();if(document.caretPositionFromPoint){var o=document.caretPositionFromPoint(t,n);o&&r.setStart(o.offsetNode,o.offset),r.collapse(!0)}else document.caretRangeFromPoint&&(r=document.caretRangeFromPoint(t,n));return(r=e.contentRangeFromPoint(t,n,r))?(e.fixGraphemeIndex(r),r):null},e.contentRangeFromPoint=function(t,n,r){if(!r)return null;var o=r.startContainer,i=document.querySelector(".mobile-selection-drag");if(!(i instanceof HTMLElement&&o instanceof Node))return r;if(i.contains(o)){var a=i.style.pointerEvents;i.style.pointerEvents="none";var s=e.getMouseEventCaretRange(t,n);return i.style.pointerEvents=a,s}return r},e.getCaretRangeSafari=function(t,n,r){return function t(n,r,o,i,a){if(a-i>1){var s=Math.floor((i+a)/2),c=document.createRange();return c.setStart(n,i),c.setEnd(n,s),function(e,t,n){for(var r=0;r<n.length;r++){var o=n[r];if(e>=o.left&&e<=o.right&&t>=o.top&&t<=o.bottom)return!0}return!1}(r,o,c.getClientRects())?t(n,r,o,i,s):t(n,r,o,s,a)}var l=document.createRange();l.setStart(n,i),l.setEnd(n,a);var u=l.getBoundingClientRect();return a-i==1&&r>(u.left+u.right)/2&&l.setStart(n,a),e.fixGraphemeIndex(l),l}(t.firstChild,n,r,0,t.firstChild.length)},e.createDOMRect=function(e,t,n,r){return{x:e,y:t,width:n,height:r,top:t,bottom:t+r,left:e,right:e+n}},e.getPointRangeRect=function(e,t){var n=!1,r=t-1,o=t;0===t&&(r=0,o=1,n=!0);var i=document.createRange();try{i.setStart(e,r),i.setEnd(e,o)}catch(t){i.setEnd(e,r)}var a=i.getClientRects(),s=a[a.length-1];return s||(s=i.getBoundingClientRect()),n?this.createDOMRect(s.left,s.top,0,s.height):this.createDOMRect(s.right,s.top,0,s.height)},e.getDirectElementListForTags=function(e,t,n){if(!e||!t)return[];var r=e.childNodes,o=[];if(r){var i=[].slice.call(r);if((null==n?void 0:n[0])&&n[1]){var a=i.findIndex((function(e){return e.nodeType===Node.COMMENT_NODE&&e.nodeValue===n[0]})),s=i.findIndex((function(e){return e.nodeType===Node.COMMENT_NODE&&e.nodeValue===n[1]}));-1!==a&&-1!==s&&a<s&&(i=i.slice(0,a).concat(i.slice(s)))}o=i.filter((function(e){return t.some((function(t){return e.tagName&&e.tagName.toLowerCase()===t}))}))}return o},e.isElementNode=function(e){if(null==e)return!1;if(e instanceof Element)return!0;var t=e,n="";do{if(t=Object.getPrototypeOf(t),"[object Element]"===(n=Object.prototype.toString.call(t))||"[object ElementPrototype]"===n)return!0}while(null!==t&&"[object Node]"!==n&&"[object NodePrototype]"!==n);return!1},e.getElementZoomValue=function(e){var t;if(!e)return 1;var n=e.style.cssText,r=new RegExp(d,"ig"),o=n.match(r);if(o){var i=null===(t=o[0])||void 0===t?void 0:t.split(":");return Number(i[1].trim())}return 1},e.getClassName=function(e){return e.className?e.className:""},e.isZeroWidthNobreakSpace=function(e){return"\ufeff"===e},e.getStringFromTextNodeByIndex=function(e,t){return e.substringData(t,1)},e.seekNextMeasureableChar=function(e,t){var n=e.length;return t===n-1?{len:n}:this.isZeroWidthNobreakSpace(this.getStringFromTextNodeByIndex(e,t))?this.seekNextMeasureableChar(e,t+1):{len:t+1}},e}();!function(e){e.WHITESCREEN="WHITESCREEN",e.JS_ERROR_RELEASE="JS_ERROR_RELEASE",e.JS_ERROR_RELEASE_ONCE="JS_ERROR_RELEASE_ONCE",e.JS_ERROR_GRAY="JS_ERROR_GRAY",e.PV="PV",e.JS_ERROR_TOB="JS_ERROR_TOB",e.JS_ERROR_TOB_ONCE="JS_ERROR_TOB_ONCE",e.JQUERY_REWRITE_ERROR="JQUERY_REWRITE_ERROR",e.NON_EDIT_ERROR="NON_EDIT_ERROR",e.AUTO_TEST_ERROR="AUTO_TEST_ERROR",e.ACTIVE_REPORT_ERROR="ACTIVE_REPORT_ERROR",e.IGNORE_JS_ERROR_PLAY_BACKGROUND_MUSIC="IGNORE_JS_ERROR_PLAY_BACKGROUND_MUSIC",e.IGNORE_JS_ERROR_SET_KEYBOARD_HEIGHT="IGNORE_JS_ERROR_SET_KEYBOARD_HEIGHT",e.IGNORE_JS_ERROR_TEST="IGNORE_JS_ERROR_TEST",e.IGNORE_JS_ERROR_WEIXIN_JSBRIDGE="IGNORE_JS_ERROR_WEIXIN_JSBRIDGE",e.IGNORE_JS_ERROR_CAPTURED_EXCEPTION="IGNORE_JS_ERROR_CAPTURED_EXCEPTION",e.IGNORE_JS_ERROR_RELOCATEFORNATIVE="IGNORE_JS_ERROR_RELOCATEFORNATIVE",e.IGNORE_JS_ERROR_COMMON_BANNER="IGNORE_JS_ERROR_COMMON_BANNER",e.IGNORE_JS_ERROR_VIVO="IGNORE_JS_ERROR_VIVO",e.IGNORE_JS_ERROR_X5="IGNORE_JS_ERROR_X5",e.IGNORE_JS_ERROR_CEFQUERY="IGNORE_JS_ERROR_CEFQUERY",e.IGNORE_JS_ERROR_EXECUTE_JS_INTERFACE="IGNORE_JS_ERROR_EXECUTE_JS_INTERFACE",e.IGNORE_JS_ERROR_QTCONFIG="IGNORE_JS_ERROR_QTCONFIG",e.IGNORE_JS_ERROR_LOWB_INJECTION="IGNORE_JS_ERROR_LOWB_INJECTION",e.CHANGESET_ERROR_RELEASE="CHANGESET_ERROR_RELEASE",e.CHANGESET_ERROR_GRAY="CHANGESET_ERROR_GRAY",e.CHANGESET_ERROR_TOB="CHANGESET_ERROR_TOB",e.CHANGESET_ERROR_ONCE="CHANGESET_ERROR_ONCE",e.CHANGESET_ERROR_CONTINUE="CHANGESET_ERROR_CONTINUE",e.CHANGESET_ERROR_INIT="CHANGESET_ERROR_INIT",e.CHANGESET_ERROR_CREATE_DELTA="CHANGESET_ERROR_CREATE_DELTA",e.CHANGESET_ERROR_APPLY_DELTA="CHANGESET_ERROR_APPLY_DELTA",e.CHANGESET_ERROR_APPLY_MUTATION="CHANGESET_ERROR_APPLY_MUTATION",e.CHANGESET_ERROR_DELTA2CS="CHANGESET_ERROR_DELTA2CS",e.CHANGESET_ERROR_APPLY_OFFLINE="CHANGESET_ERROR_APPLY_OFFLINE",e.CHANGESET_ERROR_APPLY_ONLINE="CHANGESET_ERROR_APPLY_ONLINE",e.CHANGESET_ERROR_EASYSYNC="CHANGESET_ERROR_EASYSYNC",e.CHANGESET_ERROR_VERIFY="CHANGESET_ERROR_VERIFY",e.CHANGESET_ERROR_VERIFY_MODELEN="CHANGESET_ERROR_VERIFY_MODELEN",e.CHANGESET_ERROR_MAIN_RANGE="CHANGESET_ERROR_MAIN_RANGE",e.CHANGESET_ERROR_COMMIT="CHANGESET_ERROR_COMMIT",e.CHANGESET_ERROR_COMMIT_SPIKE="CHANGESET_ERROR_COMMIT_SPIKE",e.CHANGESET_ERROR_EXCEPTION="CHANGESET_ERROR_EXCEPTION",e.DATA_PRODUCE="DATA_PRODUCE",e.DATA_PRODUCE_TABLE_HEADER="DATA_PRODUCE_TABLE_HEADER",e.DATA_PRODUCE_TABLE="DATA_PRODUCE_TABLE",e.DATA_TRANSFORM="DATA_TRANSFORM",e.DATA_TRANSFORM_TABLE="DATA_TRANSFORM_TABLE",e.DATA_VERIFY="DATA_VERIFY",e.DATA_COMPOSE="DATA_COMPOSE",e.DATA_COMPOSE_TABLE_HEADER="DATA_COMPOSE_TABLE_HEADER",e.DATA_COMPOSE_TABLE="DATA_COMPOSE_TABLE",e.DATA_ACCEPT="DATA_ACCEPT",e.DATA_ACCEPT_TABLE_HEADER="DATA_ACCEPT_TABLE_HEADER",e.DATA_ACCEPT_TABLE="DATA_ACCEPT_TABLE",e.DATA_PRODUCE_ERROR_FRONT="DATA_PRODUCE_ERROR_FRONT",e.DATA_PRODUCE_ERROR_BACK="DATA_PRODUCE_ERROR_BACK",e.DATA_PRODUCE_ERROR_TIMEOUT="DATA_PRODUCE_ERROR_TIMEOUT",e.DATA_PRODUCE_ERROR_TIPS="DATA_PRODUCE_ERROR_TIPS",e.DATA_PRODUCE_LITTLE_UNCOMMIT="DATA_PRODUCE_LITTLE_UNCOMMIT",e.JS_ERROR_FREQUENT="JS_ERROR_FREQUENT",e.JS_ERROR_FREQUENT_HUNDRED="JS_ERROR_FREQUENT_HUNDRED",e.CORE_INDEX_PRODUCE_DELTA="CORE_INDEX_PRODUCE_DELTA",e.CORE_INDEX_PRODUCE_CHANGESET="CORE_INDEX_PRODUCE_CHANGESET",e.FRAME_DROP_NORMAL="FRAME_DROP_NORMAL",e.FRAME_DROP_SERIOUS="FRAME_DROP_SERIOUS",e.FRAME_DROP_REPORT="FRAME_DROP_REPORT",e.HTML_PARSE_ERROR="HTML_PARSE_ERROR",e.HOT_UPGRADE="HOT_UPGRADE",e.HOT_UPGRADE_STOCK="HOT_UPGRADE_STOCK",e.TABLE_MERGE="TABLE_MERGE",e.HAS_TABLE="HAS_TABLE",e.PV_PUBLISH="PV_PUBLISH",e.PV_TOB="PV_TOB",e.DATA_CHECK_WARN="DATA_CHECK_WARN",e.DATA_CHECK_FAILED="DATA_CHECK_FAILED",e.TABLE_DATA_CHECK_FAILED="TABLE_DATA_CHECK_FAILED",e.TABLE_DATA_FIX_FAILED="TABLE_DATA_FIX_FAILED",e.COMMENT_INVALID_PLACEHOLDER="COMMENT_INVALID_PLACEHOLDER",e.COMMENT_REPEAT_FIX="COMMENT_REPEAT_FIX",e.COMMENT_UPGRADE="COMMENT_UPGRADE",e.LAYOUT_MISSING_CONTENT="LAYOUT_LOST_CONTENT",e.LAYOUT_TABLE_FAILED="LAYOUT_TABLE_FAILED",e.REFLOWLAYOUT_TABLE_FAILED="REFLOWLAYOUT_TABLE_FAILED",e.LAYOUT_ERROR="LAYOUT_ERROR",e.FIRST_PAGE_LAYOUT_SUCESS_RATE="FIRST_PAGE_LAYOUT_SUCESS_RATE",e.LAYOUT_SUCESS_RATE="LAYOUT_SUCESS_RATE",e.NOTIFICATION_LISTENERS_EXCEED="NOTIFICATION_LISTENERS_EXCEED",e.PERFORMANCE_REPORT_NEGATIVE_ERROR="PERFORMANCE_REPORT_NEGATIVE_ERROR",e.COMMAND_TYPE_REQUIRED="COMMAND_TYPE_REQUIRED",e.PV_3_0="PV_3_0",e.DATA_PRODUCE_ERROR_FRONT_3_0="DATA_PRODUCE_ERROR_FRONT_3_0",e.DATA_PRODUCE_ERROR_BACK_3_0="DATA_PRODUCE_ERROR_BACK_3_0",e.DATA_PRODUCE_3_0="DATA_PRODUCE_3_0",e.JS_ERROR_RELEASE_ONCE_3_0="JS_ERROR_RELEASE_ONCE_3_0",e.DOC_WORD_NUM="DOC_WORD_NUM",e.FIRST_RENDER_TIME_3_0="FIRST_RENDER_TIME_3_0",e.FIRST_RENDER_TIME_LARGE_DOC_3_0="FIRST_RENDER_TIME_LARGE_DOC_3_0",e.FIRST_EDIT_TIME_3_0="FIRST_EDIT_TIME_3_0",e.FIRST_EDIT_TIME_LARGE_DOC_3_0="FIRST_EDIT_TIME_LARGE_DOC_3_0",e.OPEN_DOC_COST_3_0="OPEN_DOC_COST_3_0",e.OPEN_DOC_COST_LARGE_DOC_3_0="OPEN_DOC_COST_LARGE_DOC_3_0",e.EXPORT_COST_3_0="EXPORT_COST_3_0",e.EXPORT_SUC_RATE_3_0="EXPORT_SUC_RATE_3_0",e.DATA_PARSE_ERROR_3_0="DATA_PARSE_ERROR_3_0",e.WHITE_SCREEN="",e.KEY_DATA_FETCH_FAIL="",e.KEY_COMMIT_REQUEST_FAIL="",e.LOCAL_MUTATION_APPLY_ERROR="mutation",e.LOCAL_MUTATION_RENDER_ERROR="mutation",e.SERVER_MUTATION_APPLY_ERROR="",e.SOCKET_FAILED_IN_90S="90",e.SOCKET_SHUTDOWN="",e.OFFLINE_RESTORE_ERROR="",e.OFFLINE_SYNC_DATA_ERROR="",e.FIRST_RENDER_TIME="",e.FIRST_EDIT_TIME="",e.FIRST_EDIT_IN_5S="5s",e.JS_ERROR_OCCUR="JS",e.FRAME_DROP_OCCUR="",e.APPLY_DATA_FAIL="",e.OPEN_DOC_COST="OPEN_DOC_COST",e.OPEN_DOC_RETRY_COUNT="OPEN_DOC_RETRY_COUNT",e.REACT_ERROR_BOUNDARY="REACT_ERROR_BOUNDARY",e.IS_CHUNK_RATE="IS_CHUNK_RATE",e.CHUNK_USE_TIME="CHUNK_USE_TIME",e.CHUNK_REQUEST_SUCESS_RATE="CHUNK_REQUEST_SUCESS_RATE",e.CHUNK_ALL_LOAD_SUCESS="CHUNK_ALL_LOAD_SUCESS",e.FITST_CHUNK_LOAD_ERROR="FITST_CHUNK_LOAD_ERROR",e.OTHER_CHUNK_LOAD_ERROR="OTHER_CHUNK_LOAD_ERROR",e.COPY_DATA_USE_TIME="",e.PASTE_DATA_USE_TIME="",e.COPY_LENGTH_OVER_2500=" 2500",e.COPY_LENGTH_OVER_5000=" 5000",e.COPY_LENGTH_OVER_10000=" 10000",e.COPY_LENGTH_OVER_15000=" 15000",e.COPY_LENGTH_LESS_2500=" 2500",e.PASTE_LENGTH_OVER_2500=" 2500",e.PASTE_LENGTH_OVER_5000=" 5000",e.PASTE_LENGTH_OVER_10000=" 10000",e.PASTE_LENGTH_OVER_15000=" 15000",e.PASTE_LENGTH_LESS_2500=" 2500",e.COPY_DATA_LENGTH="",e.OPENDOC30_WITH_21DATA="OPENDOC30_WITH_21DATA",e.SYNC_IMPORT_FAILED="SYNC_IMPORT_FAILED",e.COPY_ERROR="COPY_ERROR",e.LOCAL_EDIT_OPEN_FAIL="LOCAL_EDIT_OPEN_FAIL",e.LOCAL_EDIT_SAVE_FAIL="LOCAL_EDIT_SAVE_FAIL"}(r||(r={})),function(e){e.DEFAULT="javascript",e.CHANGESET_COMMIT="changeset_commit",e.ACTIVE_REPORT="active_report",e.NON_EDIT_ERROR="non_edit_error"}(o||(o={})),function(e){e.EDIT_DATA="0",e.INIT_DATA="1",e.APPLY_SERVER_DATA="2"}(i||(i={})),function(e){e.DOCUMENT="1",e.TABLE="2"}(a||(a={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.FAIL=1]="FAIL",e[e.TIMEOUT=2]="TIMEOUT"}(s||(s={})),function(e){e[e.DEFAULT=291727]="DEFAULT",e[e.MONITOR=299787]="MONITOR"}(c||(c={})),function(e){e[e.PV_PC=20]="PV_PC",e[e.PV_MOBILE=21]="PV_MOBILE",e[e.PV=22]="PV",e[e.WEBSOCKET_ERROR=23]="WEBSOCKET_ERROR",e[e.BOTTOM_BAR_SHOW=24]="BOTTOM_BAR_SHOW",e[e.SERVER_ERROR=25]="SERVER_ERROR",e[e.COLLAB_ROOM_ERR=26]="COLLAB_ROOM_ERR",e[e.AUTH_FAILED=27]="AUTH_FAILED",e[e.INIT_JSSDK_FAILED=28]="INIT_JSSDK_FAILED",e[e.WECHAT_COPYPASTE_FAILED=29]="WECHAT_COPYPASTE_FAILED",e[e.PREOPEN_OPENDOC_ERR=30]="PREOPEN_OPENDOC_ERR"}(l||(l={}));var h,f,g={0:1,1:2,2:3};!function(e){e[e.Default=0]="Default",e[e.Wedoc=1]="Wedoc"}(h||(h={})),function(e){e[e.Recent=1]="Recent",e[e.Other=3]="Other"}(f||(f={}));var v,y,m="1970325134026788";!function(e){e[e.Corp=1]="Corp",e[e.Wechat=2]="Wechat"}(v||(v={})),function(e){e[e.Tips=1]="Tips",e[e.Websocket=2]="Websocket",e[e.Xhr=3]="Xhr",e[e.Snackbar=4]="Snackbar",e[e.Feature=6]="Feature",e[e.CoreEdit=7]="CoreEdit"}(y||(y={}));var b=n(85556),_=!0;window.addEventListener("online",(function(){_=!0})),window.addEventListener("offline",(function(){_=!1}));var C,S=n(30479),w=function(){function e(){var e=this;this.reportDataCache=new Map,this.reportAtInterval(),window.addEventListener("beforeunload",(function(){e.doActionReport()}))}return e.prototype.coreIndexReport=function(e,t,n){this.action(e,n),E.monitor(t)},e.prototype.action=function(e,t){try{if(t.reportAtOnce)E.tdwReportSingle(e);else{var n="".concat(e.opername,"&").concat(e.module,"&").concat(e.action,"&").concat(e.ver5),r=this.reportDataCache.get(n);r?r.obj3+=e.obj3:r=e,this.reportDataCache.set(n,r)}}catch(e){S.Logger.error(e)}},e.prototype.reportAtInterval=function(){var e=this;setTimeout((function(){e.doActionReport(),e.reportAtInterval()}),5e3)},e.prototype.doActionReport=function(){this.reportDataCache.size>0&&_&&(this.reportDataCache.forEach((function(e){E.tdwReport(e)})),this.reportDataCache.clear())},e}(),E=function(){function e(){}return e.monitor=function(t){var n;null===(n=e.monitorHandler)||void 0===n||n.monitor(t),e.weiMonitorCube({module:y.CoreEdit,name:t})},e.monitorWtihPlatform=function(t){var n;null===(n=e.monitorHandler)||void 0===n||n.monitorWtihPlatform(t),e.weiMonitorCube({module:y.CoreEdit,name:t})},e.monitor007Status=function(t,n,r,o){var i;void 0===n&&(n=s.SUCCESS),null===(i=e.monitorHandler)||void 0===i||i.monitor007Status(t,n,r,o)},e.zzsStatus=function(t){var n;null===(n=e.zzsHandler)||void 0===n||n.zzsStatus(t)},e.zzsValue=function(t,n){var r;null===(r=e.zzsHandler)||void 0===r||r.zzsValue(t,n)},e.monitor007Value=function(t,n){var r;null===(r=e.monitorHandler)||void 0===r||r.monitor007Value(t,n)},e.captureException=function(t,n,r){e.errorHandler&&(n.logger||(n.logger=o.ACTIVE_REPORT),e.errorHandler.captureException(t,n,r),r&&S.Logger.error(r))},e.captureChangesetException=function(e,t,n){t.option||(S.Logger.error("ravenExtraData.option undefined is not allowed"),t.option={}),t.option.needBreakAndRefresh=!0,t.logger=o.CHANGESET_COMMIT,this.captureException(e,t,n)},e.tdwReport=function(t,n){var r,o=t;null===(r=e.tdwHandler)||void 0===r||r.tdwReport(o,n)},e.tdwReportSingle=function(t){var n;null===(n=e.tdwHandler)||void 0===n||n.tdwReportSingle(t)},e.coreIndexReport=function(t,n,r){var o;null===(o=e.performanHandler)||void 0===o||o.coreIndexReport(t,n,r)},e.oss=function(t){var n;null===(n=e.KVRHandler)||void 0===n||n.ossReport(t)},e.getPlatform=function(t){var n;return(null===(n=e.KVRHandler)||void 0===n?void 0:n.getPlatform(t))||""},e.idkeyReport=function(t,n,r){var o;void 0===n&&(n=c.DEFAULT),(null===(o=null==e?void 0:e.idkeyHandler)||void 0===o?void 0:o.idkeyReport)&&(Array.isArray(t)?(0,b.__spreadArray)([],(0,b.__read)(new Set(t)),!1):[t]).forEach((function(t){var o;null===(o=e.idkeyHandler)||void 0===o||o.idkeyReport(t,n,r)}))},e.aegisReport=function(t){var n;null===(n=e.aegisHandler)||void 0===n||n.aegisReport(t)},e.aegisReportError=function(t){var n;null===(n=e.aegisHandler)||void 0===n||n.reportError(t)},e.weiMonitorCube=function(t){var n;null===(n=e.weiMonitor)||void 0===n||n.cube(t)},e.performanHandler=new w,e}();function x(e,t,n){for(var r=0,o=0,i=0;r<e.length&&o<t.length;){var a=n(e[r],t[o]);0===a?(i+=1,r+=1,o+=1):a<0?r+=1:o+=1}return i}function T(e,t,n){for(var r=n;r<t.length;r++)e.push(t[r])}function R(e,t,n){for(var r=[],o=[],i=[],a=0,s=0;a<e.length&&s<t.length;){var c=e[a],l=t[s],u=n(c,l);0===u?(i.push(c),a+=1,s+=1):u<0?(r.push(c),a+=1):(o.push(l),s+=1)}return a<e.length&&T(r,e,a),s<t.length&&T(o,t,s),{local:r,income:o,share:i}}function I(e,t,n,r){for(var o=r;o<t.length;o++)e[n]=t[o],n+=1;return n}function P(e,t,n){for(var r=new Array(e.length+t.length),o=0,i=0,a=0;i<e.length&&a<t.length;){var s=e[i],c=t[a];n(s,c)<=0?(r[o]=s,o+=1,i+=1):(r[o]=c,o+=1,a+=1)}return i<e.length&&(o=I(r,e,o,i)),a<t.length&&(o=I(r,t,o,a)),r}function O(e){return e[e.length-1]}function k(e){return e.reduce((function(e,t){return e+t}),0)}function D(e,t,n){return void 0===n&&(n=function(e,t){return e===t}),e.length===t.length&&(0===e.length||e.every((function(e,r){return n(e,t[r])})))}function M(){var e=(0,S.pxToTwips)(8);return S.PlatformUtil.isMac()||!S.PlatformUtil.isIE()&&!S.PlatformUtil.isFireFox()||(e=(0,S.pxToTwips)(18)),e}function A(){var e=(0,S.pxToTwips)(8);return S.PlatformUtil.isMac()||!S.PlatformUtil.isIE()&&!S.PlatformUtil.isFireFox()||(e=(0,S.pxToTwips)(18)),e}window.ReportHelper=E,function(e){e[e.ASC=1]="ASC",e[e.ASCJoin=2]="ASCJoin",e[e.DESC=3]="DESC",e[e.DESCJoin=4]="DESCJoin",e[e.Contain=5]="Contain",e[e.BeContain=6]="BeContain",e[e.Equal=7]="Equal",e[e.Error=8]="Error"}(C||(C={}));var L,N,B,F,U=function(){function e(){}return e.intersection=function(e,t){var n={start:Math.max(e.start,t.start),end:Math.min(e.end,t.end)};return this.isValid(n)?n:null},e.isValid=function(e){return e.end>=e.start},e.exclusive=function(t,n){var r=e.intersection(t,n),o=[];if(r){var i={start:Math.min(t.start,n.start),end:r.start},a={start:r.end,end:Math.max(t.end,n.end)};return this.isValid(i)&&o.push(i),this.isValid(a)&&o.push(a),o}return this.isValid(t)&&o.push(t),this.isValid(n)&&o.push(n),o},e.minus=function(t,n){var r=e.intersection(t,n);return r?t.end>r.end?{start:r.end,end:t.end}:{start:t.start,end:r.start}:t},e.intersectionLength=function(e,t){var n=this.intersection(e,t);return n?n.end-n.start+1:0},e.relationBetween=function(e,t){return e.end<t.start?C.ASC:e.start===t.start&&e.end===t.end?C.Equal:e.start<=t.start?e.end>=t.end?C.Contain:C.ASCJoin:e.start>t.end?C.DESC:t.start<=e.start?t.end>=e.end?C.BeContain:C.DESCJoin:C.Error},e}();!function(e){e[e.EMPTY=-1]="EMPTY",e[e.BREAK=3]="BREAK",e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.CLEAR=12]="CLEAR",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ALT=18]="ALT",e[e.PAUSE=19]="PAUSE",e[e.CAPS_LOCK=20]="CAPS_LOCK",e[e.ESCAPE=27]="ESCAPE",e[e.SPACE=32]="SPACE",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.ARROW_LEFT=37]="ARROW_LEFT",e[e.ARROW_UP=38]="ARROW_UP",e[e.ARROW_RIGHT=39]="ARROW_RIGHT",e[e.ARROW_DOWN=40]="ARROW_DOWN",e[e.SELECT=41]="SELECT",e[e.PRINT=42]="PRINT",e[e.EXECUTE=43]="EXECUTE",e[e.PRINT_SCREEN=44]="PRINT_SCREEN",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE",e[e.HELP=47]="HELP",e[e.NUM_0=48]="NUM_0",e[e.NUM_1=49]="NUM_1",e[e.NUM_2=50]="NUM_2",e[e.NUM_3=51]="NUM_3",e[e.NUM_4=52]="NUM_4",e[e.NUM_5=53]="NUM_5",e[e.NUM_6=54]="NUM_6",e[e.NUM_7=55]="NUM_7",e[e.NUM_8=56]="NUM_8",e[e.NUM_9=57]="NUM_9",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.META_LEFT=91]="META_LEFT",e[e.META_RIGHT=93]="META_RIGHT",e[e.SMALL_KEYBOARD_NUM_0=96]="SMALL_KEYBOARD_NUM_0",e[e.SMALL_KEYBOARD_NUM_1=97]="SMALL_KEYBOARD_NUM_1",e[e.SMALL_KEYBOARD_NUM_2=98]="SMALL_KEYBOARD_NUM_2",e[e.SMALL_KEYBOARD_NUM_3=99]="SMALL_KEYBOARD_NUM_3",e[e.SMALL_KEYBOARD_NUM_4=100]="SMALL_KEYBOARD_NUM_4",e[e.SMALL_KEYBOARD_NUM_5=101]="SMALL_KEYBOARD_NUM_5",e[e.SMALL_KEYBOARD_NUM_6=102]="SMALL_KEYBOARD_NUM_6",e[e.SMALL_KEYBOARD_NUM_7=103]="SMALL_KEYBOARD_NUM_7",e[e.SMALL_KEYBOARD_NUM_8=104]="SMALL_KEYBOARD_NUM_8",e[e.SMALL_KEYBOARD_NUM_9=105]="SMALL_KEYBOARD_NUM_9",e[e.NUM_TIMES=106]="NUM_TIMES",e[e.NUM_PLUS=107]="NUM_PLUS",e[e.NUM_MINUS=109]="NUM_MINUS",e[e.NUM_POINT=110]="NUM_POINT",e[e.NUM_DIVIDE=111]="NUM_DIVIDE",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.SEMI=186]="SEMI",e[e.EQUAL=187]="EQUAL",e[e.COMMA=188]="COMMA",e[e.MINUS=189]="MINUS",e[e.PERIOD=190]="PERIOD",e[e.SLASH=191]="SLASH",e[e.BACKQUOTE=191]="BACKQUOTE",e[e.BRACKET_LEFT=219]="BRACKET_LEFT",e[e.BACK_SLASH=220]="BACK_SLASH",e[e.BRACKET_RIGHT=221]="BRACKET_RIGHT",e[e.QUOTE=222]="QUOTE"}(N||(N={})),function(e){e[e.EQUAL=61]="EQUAL",e[e.MINUS=173]="MINUS",e[e.META_FIREFOX=224]="META_FIREFOX"}(B||(B={})),function(e){e[e.SHIFT=1e3]="SHIFT",e[e.ALT=1e4]="ALT",e[e.CTRL_WIN=1e5]="CTRL_WIN",e[e.CTRL_MAC=2e5]="CTRL_MAC",e[e.WIN=1e6]="WIN",e[e.COMMAND=2e6]="COMMAND"}(F||(F={}));var H,j,G,V,W,z,K=1e7;!function(e){e[e.PRIMARY_BUTTON=1*K]="PRIMARY_BUTTON",e[e.SECONDARY_BUTTON=2*K]="SECONDARY_BUTTON",e[e.MIDDLE_BUTTON=4*K]="MIDDLE_BUTTON"}(H||(H={})),function(e){e[e.WHEEL_ANTICLOCKWISE=1e8]="WHEEL_ANTICLOCKWISE",e[e.WHEEL_CLOCKWISE=2e8]="WHEEL_CLOCKWISE"}(j||(j={})),function(e){e.KEY_UP="keyup",e.KEY_PRESS="keypress",e.KEY_DOWN="keydown"}(G||(G={})),function(e){e.EMPTY="",e.A="a",e.B="b",e.C="c",e.D="d",e.E="e",e.F="f",e.G="g",e.H="h",e.I="i",e.J="j",e.K="k",e.L="l",e.M="m",e.N="n",e.O="o",e.P="p",e.Q="q",e.R="r",e.S="s",e.T="t",e.U="u",e.V="v",e.W="w",e.X="x",e.Y="y",e.Z="z",e.ARROW_LEFT="left",e.ARROW_UP="up",e.ARROW_RIGHT="right",e.ARROW_DOWN="down",e.EQUAL="="}(V||(V={})),function(e){e.NONE="",e.COMMAND="command",e.CTRL="control",e.SHIFT="shift",e.ALT="alt"}(W||(W={})),function(e){e.BRACKET_LEFT="BracketLeft",e.BRACKET_RIGHT="BracketRight",e.BACK_SLASH="Backslash",e.SEMICOLON="Semicolon",e.QUETE="Quote",e.COMMA="Comma",e.PERIOD="Period",e.SLASH="Slash"}(z||(z={}));var q=((L={})[z.BRACKET_LEFT]=N.BRACKET_LEFT,L[z.BRACKET_RIGHT]=N.BRACKET_RIGHT,L[z.BACK_SLASH]=N.BACK_SLASH,L[z.SEMICOLON]=N.SEMI,L[z.QUETE]=N.QUOTE,L[z.COMMA]=N.COMMA,L[z.PERIOD]=N.PERIOD,L[z.SLASH]=N.SLASH,L),Y=n(27379);function Q(e){var t=new RegExp("(?:^|;+|\\s+)".concat(e,"=([^;]*)")),n=document.cookie.match(t);return(n?n[1]:"")||null}function Z(){return Q("TOK")||""}function X(){return/env_id=sit/.test(document.cookie)}function J(e,t,n,r){if(e){var o=e.children[0];if(o&&o instanceof HTMLImageElement){var i=new MouseEvent(n,{view:window,bubbles:!0,cancelable:!0,buttons:r?2:1,clientX:t.clientX,clientY:t.clientY});e.dispatchEvent(i)}}}function $(e,t){return typeof e==typeof t&&(e===t||!(!t||!e||"object"!=typeof e)&&e.length===t.length&&Object.keys(e).every((function(n){return"object"==typeof e[n]?$(e[n],t[n]):e[n]===t[n]})))}var ee=function(e){return(0,S.ptToTwips)(e/8)},te=function(){function e(){}return e.rgb2hex=function(e){if(e){var t=e.replace(/\s+/g,"");if(/^rgba?\((\d+),(\d+),(\d+)(?:,(\d+(?:\.\d+)?))?\)$/i.test(t)){var n="#";return t.replace(/\d{1,3}/g,(function(e){var t=parseInt(e,10).toString(16);return n+=t.padStart(2,"0"),t})),n}}},e.hex2rgba=function(e){e.indexOf("#")>-1&&(e=e.replace("#",""));var t=1;3===e.length?e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]:4===e.length?(t=parseInt(e[3]+e[3],16)/255,e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]):8===e.length&&(t=parseInt(e[6]+e[7],16)/255,e=e.substring(0,6));var n=parseInt(e,16);return{red:n>>16&255,green:n>>8&255,blue:255&n,alpha:t}},e.hex2rgbaStr=function(e){var t=this.hex2rgba(e);return"rgba(".concat(t.red,",").concat(t.green,",").concat(t.blue,",").concat(t.alpha,")")},e.hex2rgb=function(e){e.indexOf("#")>-1&&(e=e.replace("#",""));var t=parseInt(e,16);return{red:t>>16&255,green:t>>8&255,blue:255&t}},e.rgbColor2hex=function(e,t){return"".concat(t?"#":"").concat(this.num2Hex(e.red)).concat(this.num2Hex(e.green)).concat(this.num2Hex(e.blue))},e.rgbaColor2hex=function(e,t){return"".concat(this.rgbColor2hex(e,t)).concat(this.alphaNum2Hex(e.alpha))},e.num2Hex=function(e){return e.toString(16).toUpperCase().padStart(2,"0")},e.alphaNum2Hex=function(e){return void 0===e?"":this.num2Hex(Math.round(255*e))},e.rgbToHsl=function(e){var t=e.red/255,n=e.green/255,r=e.blue/255,o=Math.max(t,n,r),i=Math.min(t,n,r),a=o-i,s=o+i,c=s/2,l=0,u=0;if(0!==a){switch(u=c>.5?a/(2-s):a/s,o){case t:l=(n-r)/a+(n<r?6:0);break;case n:l=(r-t)/a+2;break;case r:l=(t-n)/a+4}l/=6}return{hue:l,sat:u,lum:c}},e.hslToRgb=function(e){var t=e.hue,n=e.sat,r=e.lum,o=r,i=r,a=r;if(0!==n){var s=function(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e},c=r<.5?r*(1+n):r+n-r*n,l=2*r-c;o=s(l,c,t+1/3),i=s(l,c,t),a=s(l,c,t-1/3)}return{red:Math.round(255*o),green:Math.round(255*i),blue:Math.round(255*a)}},e.linearRgbToRgb=function(e){return{red:Math.round(255*this.gammaCorrectionFromLinear(e.red)),green:Math.round(255*this.gammaCorrectionFromLinear(e.green)),blue:Math.round(255*this.gammaCorrectionFromLinear(e.blue))}},e.rgbToLinearRgb=function(e){return{red:this.gammaCorrectionToLinear(e.red/255),green:this.gammaCorrectionToLinear(e.green/255),blue:this.gammaCorrectionToLinear(e.blue/255)}},e.gammaCorrectionFromLinear=function(e){return e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055},e.gammaCorrectionToLinear=function(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)},e}(),ne=0,re=function(){function e(){}return e.getZIndex=function(e,t){if(void 0===t&&(t=!1),!e)return ne;var n=(0,b.__read)([4,18],2),r=n[0],o=n[1],i=parseInt(e.toString(2).slice(r,o),2);return isNaN(i)?ne:i*(t?-1:1)},e.getRelativeHeight=function(e){var t=Math.abs(e).toString(2).padStart(14,"0");return parseInt("".concat("".padStart(4,"1")).concat(t).concat("".padEnd(10,"0")),2)},e.generatePriority=function(e,t){void 0===t&&(t=ne);var n=100*t+e;return this.renderPrioritysSet.add(n),n},e.getRenderPrioritys=function(){return(0,b.__spreadArray)([],(0,b.__read)(this.renderPrioritysSet),!1).sort((function(e,t){return e-t}))},e.getHighestPrioritys=function(){return(0,b.__spreadArray)([],(0,b.__read)(this.renderPrioritysSet),!1).sort((function(e,t){return e-t})).pop()},e.renderPrioritysSet=new Set,e}();function oe(e,t,n,r){var o;if(!(null===(o=t.target)||void 0===o?void 0:o.classList.contains("melo-text-frame-wrapper"))){var i=document.querySelector(".melo-page-container-view #melo-text-frame-".concat(e));if(i){var a=new MouseEvent(n,{view:window,bubbles:!0,cancelable:!0,buttons:r?2:1,clientX:t.clientX,clientY:t.clientY});i.dispatchEvent(a)}}}var ie=n(87782),ae=function(){function e(){this.aggresive=!1,this.taskQueues={},this.userActionDetected=!1}return e.getInstance=function(){return this.scheduler},e.prototype.markCriticalUserAction=function(){this.aggresive&&(this.userActionDetected=!0)},e.prototype.enableAggressiveMode=function(){this.aggresive=!0},e.prototype.schedule=function(e){var t=this;return this.aggresive&&!this.userActionDetected?requestAnimationFrame(e):ie.scheduler.scheduleTask((function(){t.userActionDetected=!1,e()}),{priority:ie.Priority.normal,minTime:8})},e.prototype.cancelSchedule=function(e){"number"==typeof e?cancelAnimationFrame(e):ie.scheduler.cancelTask(e)},e.prototype.scheduleQueue=function(e,t){var n;void 0===t&&(t={});var r=null!==(n=t.id)&&void 0!==n?n:S.StringUtil.generateRandomId(),o=this.taskQueues[r];void 0!==o&&this.cancelSchedule(o),t.immediately?this.runAndScheduleNext(r,e,t,!0):this.scheduleRestQueue(r,e,t)},e.prototype.scheduleRestQueue=function(e,t,n){var r=this;this.taskQueues[e]=this.schedule((function(){r.runAndScheduleNext(e,t,n)}))},e.prototype.runAndScheduleNext=function(e,t,n,r){var o,i,a=this;t()||(null===(o=n.forceBreak)||void 0===o?void 0:o.call(n))?(this.taskQueues[e]=void 0,null===(i=n.onDone)||void 0===i||i.call(n)):r?setTimeout((function(){a.scheduleRestQueue(e,t,n)})):this.scheduleRestQueue(e,t,n)},e.scheduler=new e,e}();function se(){return function(e,t,n){var r=n.value;n.value=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ae.getInstance().markCriticalUserAction(),r.call.apply(r,(0,b.__spreadArray)([this],(0,b.__read)(e),!1))}}}function ce(e){return null!=e}var le,ue,de=function(){function e(e){this.value=e}return e.prototype.isPresent=function(){return ce(this.value)},e.prototype.ifPresent=function(e){ce(this.value)&&e(this.value)},e.prototype.get=function(){if(!this.isPresent())throw new Error("No value present");return this.value},e.prototype.orElse=function(e){return this.isPresent()?this.value:e},e.prototype.orElseGet=function(e){return this.isPresent()?this.value:e()},e.prototype.orElseThrow=function(e){if(!this.isPresent())throw e()},e.prototype.map=function(t){return this.isPresent()?e.of(t(this.value)):e.empty()},e.prototype.flatMap=function(t){if(this.isPresent()){var n=t(this.value);if(!(n instanceof e))throw new Error("".concat(this.value," is not an Optional, please use Optional.map"));return n}return e.empty()},e.prototype.filter=function(t){return this.isPresent()?t(this.value)?this:e.empty():this},e.empty=function(){return this.emptyOptional},e.of=function(t){if(!ce(t))throw new Error("".concat(t," is nullable"));return new e(t)},e.ofNullable=function(t){return ce(t)?new e(t):e.empty()},e.emptyOptional=new e(null),e}();function pe(e){return!!e&&function(e){return"function"==typeof e}(e.compare)}function he(e,t,n){var r,o,i,a=function(e,t){var n=void 0;if("number"==typeof e&&"number"==typeof t&&(n=e-t),pe(e)&&pe(t)&&(n=e.compareTo(t)),void 0===n)throw new Error("a and b must be the same type, but a's type is ".concat(typeof e," and b's type is ").concat(typeof t));return n>0?le.MoreThan:0===n?le.Equals:le.LessThan}(e,t);if(!n)return a;switch(a){case le.MoreThan:null===(r=n.moreThan)||void 0===r||r.call(n);break;case le.LessThan:null===(o=n.lessThan)||void 0===o||o.call(n);break;case le.Equals:null===(i=n.equals)||void 0===i||i.call(n);break;default:throw new Error("unknown compare error, please check value: a is ".concat(e,", b is ").concat(t))}}!function(e){e.LessThan="LessThan",e.Equals="Equals",e.MoreThan="MoreThan"}(le||(le={})),function(e){e.Left="Left",e.Right="Right",e.LeftRight="LeftRight",e.RightLeft="RightLeft",e.None="None"}(ue||(ue={}));var fe=function(e,t){this.key=e,this.value=t,this.height=1,this.left=de.empty(),this.right=de.empty()};function ge(e){return e.map((function(e){return e.height})).orElse(0)}function ve(e){return ge(e.flatMap((function(e){return e.left})))-ge(e.flatMap((function(e){return e.right})))}function ye(e){var t=e.flatMap((function(e){return e.left})),n=t.flatMap((function(e){return e.right}));return t.ifPresent((function(t){return t.right=e})),e.ifPresent((function(e){return e.left=n})),e.ifPresent((function(e){return e.height=Math.max(ge(e.left),ge(e.right))+1})),t.ifPresent((function(e){return e.height=Math.max(ge(e.left),ge(e.right))+1})),t}function me(e){var t=e.flatMap((function(e){return e.right})),n=t.flatMap((function(e){return e.left}));return t.ifPresent((function(t){return t.left=e})),e.ifPresent((function(e){return e.right=n})),e.ifPresent((function(e){return e.height=Math.max(ge(e.left),ge(e.right))+1})),t.ifPresent((function(e){return e.height=Math.max(ge(e.left),ge(e.right))+1})),t}function be(e){if(!e.isPresent())return de.empty();switch(function(e){var t=ve(e),n=ve(e.flatMap((function(e){return e.left}))),r=ve(e.flatMap((function(e){return e.right})));return t>1&&n>0?ue.Right:t<-1&&r<0?ue.Left:t>1&&n<0?ue.LeftRight:t<-1&&r>0?ue.RightLeft:ue.None}(e)){case ue.Left:return me(e);case ue.Right:return ye(e);case ue.LeftRight:return(n=e).ifPresent((function(e){return e.left=me(e.left)})),ye(n);case ue.RightLeft:return(t=e).ifPresent((function(e){return e.right=ye(e.right)})),me(t);case ue.None:default:return e}var t,n}function _e(e){if(!e.isPresent())return{root:de.empty(),removed:de.empty()};if(!e.flatMap((function(e){return e.left})).isPresent())return{root:e.flatMap((function(e){return e.right})),removed:e};var t=_e(e.flatMap((function(e){return e.left})));return e.ifPresent((function(e){return e.left=t.root})),{removed:t.removed,root:e}}function Ce(e,t){return e.isPresent()?e.flatMap((function(n){switch(he(n.key,t)){case le.MoreThan:return Ce(n.left,t);case le.LessThan:return Ce(n.right,t);case le.Equals:default:return e}})):de.empty()}var Se=function(){function e(){this.root=de.empty(),this.size=0}return e.prototype.getSize=function(){return this.size},e.prototype.makeEmpty=function(){this.size=0,this.root=de.empty()},e.prototype.isEmpty=function(){return 0===this.size&&!this.root.isPresent()},e.prototype.internalInsert=function(e,t,n){var r=this;return e.isPresent()?(e.ifPresent((function(e){he(e.key,t,{moreThan:function(){return e.left=r.internalInsert(e.left,t,n)},lessThan:function(){return e.right=r.internalInsert(e.right,t,n)},equals:function(){return e.value=n}}),e.height=1+Math.max(ge(e.left),ge(e.right))})),be(e)):(this.size+=1,de.of(new fe(t,n)))},e.prototype.insert=function(e,t){this.root=this.internalInsert(this.root,e,t)},e.prototype.find=function(e){return Ce(this.root,e).map((function(e){return e.value}))},e.prototype.internalRemove=function(e,t){var n=this;if(!e.isPresent())return{value:de.empty(),node:de.empty()};var r=de.empty(),o=de.empty();return e.ifPresent((function(i){he(i.key,t,{moreThan:function(){var a=n.internalRemove(i.left,t);i.left=a.node,r=e,o=a.value},lessThan:function(){var a=n.internalRemove(i.right,t);i.right=a.node,r=e,o=a.value},equals:function(){if(o=de.of(i.value),i.left.isPresent()&&i.right.isPresent()){var t=_e(i.right),n=t.removed,a=t.root;n.ifPresent((function(e){var t=e.key,n=e.value;i.key=t,i.value=n})),i.right=a,r=e}else r=i.left.isPresent()?i.left:i.right,o=de.of(i.value)}}),r.ifPresent((function(e){return e.height=Math.max(ge(e.left),ge(e.right))+1})),r=be(r)})),{value:o,node:r}},e.prototype.remove=function(e){var t=this.internalRemove(this.root,e),n=t.value,r=t.node;return this.root=r,this.size-=1,n},e.prototype.toString=function(){return this.getValues().join(", ")},e.prototype.getValues=function(){var e=[],t=[];for(e.push(this.root);e.length;){var n=e.shift();n.ifPresent((function(e){return t.push(e.value)})),n.map((function(e){return e.left})).ifPresent((function(t){return e.push(t)})),n.map((function(e){return e.right})).ifPresent((function(t){return e.push(t)}))}return t},e}(),we=function(){function e(){}return e.register=function(e,t){this.poolTypes[e]=t},e.obtain=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return(t=this.poolTypes[e]).obtain.apply(t,(0,b.__spreadArray)([],(0,b.__read)(n),!1))},e.poolTypes={},e}();function Ee(e){return function(t){return we.register(e,t),t}}var xe=function(){function e(){}return e.provide=function(e,t){this.contexts[e]=t},e.use=function(e){return this.contexts[e]},e.contexts={},e}(),Te={};function Re(e){return void 0===e&&(e={}),function(t,n,r){var o=r.value,i={};e.name&&(Te[e.name]=i),r.value=function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var a=e.getKey?(t=e.getKey).call.apply(t,(0,b.__spreadArray)([this],(0,b.__read)(n),!1)):n.join("-"),s=i[a];if(void 0!==s)return s;var c=o.call.apply(o,(0,b.__spreadArray)([this],(0,b.__read)(n),!1));return void 0!==c&&(i[a]=c),c}}}function Ie(e,t){return new Promise((function(n){return ie.scheduler.scheduleTask((function(){e().then(n)}),t)}))}function Pe(e){return void 0===e&&(e={}),function(){}}new Map;var Oe,ke=function(){var e=new WeakSet;return function(t,n){if(n instanceof Error)return"Error.message: ".concat(n.message," \n  Error.stack: ").concat(n.stack);if("object"==typeof n&&null!==n){if(e.has(n))return"[Circular ".concat(t||"root","]");e.add(n)}return n}},De=function(){function e(){}return e.stringify=function(e){if("string"==typeof e)return e;try{return e instanceof Error?(JSON.stringify(e,ke(),4)||"undefined").replace(/"/gim,""):JSON.stringify(e,ke(),4)||"undefined"}catch(e){return"error happen when stringify: \n ".concat(e.message," \n ").concat(e.stack)}},e.handleLog=function(e,t){for(var n,r,o=this,i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];null===(r=null===(n=window.tdocs)||void 0===n?void 0:n.log)||void 0===r||r.call(n,{level:e,message:(0,b.__spreadArray)([t],(0,b.__read)(i||[]),!1).map((function(e){return o.stringify(e)})).join(" | ")})},e.log=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];S.Logger.log(e,t),this.handleLog("log",e,t)},e.debug=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];S.Logger.debug(e,t),this.handleLog("debug",e,t)},e.info=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];S.Logger.info(e,t),this.handleLog("info",e,t)},e.warn=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];S.Logger.warn(e,t),this.handleLog("warn",e,t)},e.error=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];S.Logger.error(e,t),this.handleLog("error",e,t)},e}();function Me(){Oe=document.activeElement}function Ae(){var e;null===(e=null==Oe?void 0:Oe.focus)||void 0===e||e.call(Oe)}function Le(e,t){return e&&t||!e&&!t}var Ne,Be=function(e,t,n){void 0===t&&(t=[]),void 0===n&&(n=!0),this.ctor=e,this.args=t,this.singleton=n},Fe=function(e,t,n){return void 0===t&&(t=[]),void 0===n&&(n=!0),new Be(e,t,n)},Ue=function(e){var t=e.prototype;return t?t.constructor:e.constructor};!function(e){e.Param="di:param",e.Props="di:props"}(Ne||(Ne={}));var He=function(e,t){var n=Ue(e);n["di:target"]===e?n[t.kind].push(t):(n[t.kind]=[t],n["di:target"]=e)};function je(e){var t;return null!==(t=Ue(e)[Ne.Param])&&void 0!==t?t:[]}function Ge(e){var t;return null!==(t=Ue(e)[Ne.Props])&&void 0!==t?t:[]}function Ve(e){var t=je(e),n=Ge(e),r=[];return Array.isArray(t)&&r.push.apply(r,(0,b.__spreadArray)([],(0,b.__read)(t),!1)),Array.isArray(n)&&r.push.apply(r,(0,b.__spreadArray)([],(0,b.__read)(n),!1)),r}var We=function(){function e(){this.entries=new Map,this.graph=new S.Graph((function(e){return e.toString()}))}return e.prototype.set=function(e,t){var n=this.entries.get(e);return!n||n instanceof Be||S.Logger.warn("override exist service:".concat(e)),this.entries.set(e,t),this.setDPs(e,t),n},e.prototype.has=function(e){return this.entries.has(e)},e.prototype.get=function(e){return this.entries.get(e)},e.prototype.forEach=function(e){this.entries.forEach((function(t,n){e(n,t)}))},Object.defineProperty(e.prototype,"dpGraph",{get:function(){return this.graph},enumerable:!1,configurable:!0}),e.prototype.setDPs=function(e,t){var n=this,r=Ve(t instanceof Be?t.ctor:Ue(t));!r||r.length<1||r.forEach((function(t){n.graph.insertEdge(e,t.id,{dp:t})}))},e}(),ze="function"==typeof Proxy&&(S.PlatformUtil.isChrome()?S.PlatformUtil.getChromeVersion()>=53:!S.PlatformUtil.isIE()),Ke=function(e){function t(t){var n=e.call(this,"cyclic dependency between services")||this;return n.message=t.toString(),n}return(0,b.__extends)(t,e),t}(Error),qe=function(){function e(e){void 0===e&&(e=new We),this.services=e}return Object.defineProperty(e.prototype,"dpString",{get:function(){return this.services.dpGraph.toString()},enumerable:!1,configurable:!0}),e.prototype.inject=function(e,t){var n=this;this.services.set(e,t);var r=this.getOrCreateInstance(e),o=this.services.dpGraph.lookup(e);return!r||!o||o.incoming.size<1||o.incoming.forEach((function(t){var o=(0,b.__read)(t,2),i=o[0].data,a=o[1];if(a){var s=a.dp;if(s.id===e&&s.kind===Ne.Props){var c=n.services.get(i);!c||c instanceof Be||Object.defineProperty(c,s.key,{get:function(){return r},configurable:!0})}}})),r},e.prototype.set=function(e,t){return this.services.set(e,t)},e.prototype.get=function(e){return this.getOrCreateInstance(e)},e.prototype.create=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return t=e instanceof Be?e:new Be(e,n),this.createInstance(t,!0)},e.prototype.getOrCreateInstance=function(e){var t=this,n=this.services.get(e);if(n){if(!(n instanceof Be))return n;for(var r=new S.Graph((function(e){return e.id.toString()})),o=0,i=[{id:e,desc:n}],a=function(){var n=i.pop();if(r.lookupOrInsertNode(n),(o+=1)>1e3)throw new Ke(r);var a=Ve(n.desc.ctor);if(!a||a.length<1)return"continue";a.forEach((function(o){var a=t.services.get(o.id);if(a||S.Logger.warn("".concat(e.toString()," depends on ").concat(o.id.toString()," which is not injected.")),a instanceof Be){var s={id:o.id,desc:a};r.insertEdge(n,s),i.push(s)}}))};i.length;)a();for(;;){var s=r.roots();if(0===s.length){if(!r.isEmpty())throw new Ke(r);break}s.forEach((function(e){var n=e.data,o=t.createInstance(n.desc,!0);t.services.set(n.id,o),r.removeNode(n)}))}return this.get(e)}},e.prototype.createInstance=function(e,t){var n=this;if(!t||!ze)return this.createNewInstance(e);var r=new ie.IdleValue((function(){return n.createNewInstance(e)}),{priority:ie.Priority.low});return new Proxy(Object.create(null),{get:function(t,n){if(n in t)return t[n];if("constructor"===n)return e.ctor;if("prototype"===n)return e.ctor.prototype;var o=r.getValue(),i=o[n];return"function"!=typeof i||(i=i.bind(o),t[n]=i),i},set:function(e,t,n){return e[t]=n,r.getValue()[t]=n,!0},defineProperty:function(e,t,n){var o=r.getValue();return Object.defineProperty(o,t,n),!0},getPrototypeOf:function(){return e.ctor.prototype}})},e.prototype.createNewInstance=function(e){var t,n=this,r=[],o=je(e.ctor);(null==o?void 0:o.length)>0&&(o.sort((function(e,t){return e.index-t.index})),o.forEach((function(e){var t=n.getOrCreateInstance(e.id);if(!t)throw new Error("".concat(e.id.toString()," is not injected!"));r.push(t)}))),r.push.apply(r,(0,b.__spreadArray)([],(0,b.__read)(e.args),!1));var i=new((t=e.ctor).bind.apply(t,(0,b.__spreadArray)([void 0],(0,b.__read)(r),!1))),a=Ge(e.ctor);return(null==a?void 0:a.length)>0&&a.forEach((function(e){var t=n.getOrCreateInstance(e.id);t&&Object.defineProperty(i,e.key,{get:function(){return t},configurable:!0})})),i},e}(),Ye=new Map,Qe=function(e){if(Ye.has(e))return Ye.get(e);var t=function(e,n,r){if(void 0===r){if(arguments.length>1)return He(e,{kind:Ne.Props,key:n,id:t}),{get:function(){S.Logger.warn("".concat(n," has not injected"))}};throw new Error("inject decorator can only be used to decorate a parameter & property")}He(e,{kind:Ne.Param,index:r,id:t})};return t.toString=function(){return e},Ye.set(e,t),t},Ze=function(){function e(){}return e.now=function(){return S.PerfUtil.now()},e.mark=function(e){try{var t=window.performance.timing.navigationStart||window.htmlLoadStart,n=Date.now()-t,r=this.lastEnd||n;this.lastEnd=n;var o="PerfUtil: name[".concat(e,"] type[lifeCycle] start[").concat(Number(r).toFixed(0),"] end[").concat(Number(n).toFixed(0),"]");S.Logger.info(o)}catch(e){console.error(e)}return S.PerfUtil.mark(e)},e.getMark=function(e){return S.PerfUtil.getMark(e)},e.measure=function(e,t){return S.PerfUtil.measure(e,t)},e.clearMarks=function(){return S.PerfUtil.clearMarks()},e}()},63184:function(e,t,n){n.d(t,{aU:function(){return r},Rh:function(){return b},Ce:function(){return x},Xm:function(){return R},zW:function(){return E},QD:function(){return a},Tf:function(){return h},EU:function(){return m}});var r,o=n(2613),i=JSON.parse('[{"ty":"is","bi":0,"s":"\\r\\r\\u000f\\u001e\\u001e\\u001e\\u001e\\u001e\\u001e\\u001e"},{"ty":"mp","bi":0,"ei":1,"mt":"run","pr":{"run":{"isPlaceholder":true}}},{"ty":"mp","bi":1,"ei":2,"mt":"run","pr":{"run":{"isPlaceholder":true}}},{"ty":"mp","bi":2,"ei":3,"mt":"run","pr":{"run":{"isPlaceholder":true}}},{"ty":"mp","bi":3,"ei":4,"mt":"run","pr":{"run":{"isPlaceholder":true}}},{"ty":"mp","bi":4,"ei":5,"mt":"run","pr":{"run":{"isPlaceholder":true}}},{"ty":"mp","bi":5,"ei":6,"mt":"run","pr":{"run":{"isPlaceholder":true}}},{"ty":"mp","bi":6,"ei":7,"mt":"run","pr":{"run":{"isPlaceholder":true}}},{"ty":"mp","bi":7,"ei":8,"mt":"run","pr":{"run":{"isPlaceholder":true}}},{"ty":"mp","bi":8,"ei":9,"mt":"run","pr":{"run":{"isPlaceholder":true}}},{"ty":"mp","bi":8,"ei":9,"mt":"run","pr":{"run":{"isPlaceholder":true}}},{"ty":"mp","bi":0,"ei":1,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"b"},"jc":{"val":"STJcWml_left"}}}},{"ty":"mp","bi":1,"ei":2,"mt":"paragraph","pr":{"paragraph":{}}},{"ty":"mp","bi":2,"ei":3,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":3,"ei":4,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":4,"ei":5,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":5,"ei":6,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":6,"ei":7,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":7,"ei":8,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":8,"ei":9,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":8,"ei":9,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":2,"ei":3,"mt":"section","pr":{"section":{"pgSz":{"w":11900,"h":16840},"pgMar":{"top":1440,"right":1800,"bottom":1440,"left":1800,"header":851,"footer":992,"gutter":0},"cols":{"space":425},"docGrid":{"type":"lines","linePitch":312}}}},{"ty":"mp","bi":3,"ei":4,"mt":"story","pr":{"story":{"storyType":"STStoryType_mainDocument"}}},{"ty":"mp","bi":4,"ei":5,"mt":"story","pr":{"story":{"storyType":"STStoryType_headerContent"}}},{"ty":"mp","bi":5,"ei":6,"mt":"story","pr":{"story":{"storyType":"STStoryType_footerContent"}}},{"ty":"mp","bi":6,"ei":7,"mt":"story","pr":{"story":{"storyType":"STStoryType_footnoteContent"}}},{"ty":"mp","bi":7,"ei":8,"mt":"story","pr":{"story":{"storyType":"STStoryType_endnoteContent"}}},{"ty":"mp","bi":8,"ei":9,"mt":"story","pr":{"story":{"storyType":"STStoryType_commentContent"}}},{"ty":"mp","bi":9,"ei":10,"mt":"story","pr":{"story":{"storyType":"STStoryType_textboxContent"}}},{"ty":"ms","mt":"styles","pr":{"styles":{"docDefaults":{"rPrDefault":{"rPr":{"rFonts":{"asciiTheme":"minorHAnsi","eastAsiaTheme":"minorEastAsia","hAnsiTheme":"minorHAnsi","cstheme":"minorBidi"},"kern":{"val":20},"sz":{"val":210},"szCs":{"val":240},"lang":{"val":"en-US","eastAsia":"zh-CN","bidi":"ar-SA"}}},"pPrDefault":{}},"latentStyles":{},"style":{"a":{"type":"STStyleType_paragraph","defaultKeyword":true,"styleId":"a","name":{"val":"Normal"},"pPr":{"widowControl":{"val":false},"jc":{"val":"STJcWml_both"}}},"a0":{"type":"STStyleType_character","defaultKeyword":true,"styleId":"a0","name":{"val":"Default Paragraph Font"},"uiPriority":{"val":"1"},"semiHidden":{"val":true},"unhideWhenUsed":{"val":true}},"a1":{"type":"STStyleType_table","defaultKeyword":true,"styleId":"a1","name":{"val":"Normal Table"},"uiPriority":{"val":"99"},"semiHidden":{"val":true},"unhideWhenUsed":{"val":true},"tblPr":{"tblInd":{"w":0,"type":"STTblWidth_dxa"},"tblCellMar":{"top":{"w":0,"type":"STTblWidth_dxa"},"left":{"w":108,"type":"STTblWidth_dxa"},"bottom":{"w":0,"type":"STTblWidth_dxa"},"right":{"w":108,"type":"STTblWidth_dxa"}}}},"a2":{"type":"STStyleType_numbering","defaultKeyword":true,"styleId":"a2","name":{"val":"No List"},"uiPriority":{"val":"99"},"semiHidden":{"val":true},"unhideWhenUsed":{"val":true}},"b":{"type":"STStyleType_paragraph","styleId":"b","name":{"val":"Title"},"basedOn":{"val":"Normal"},"next":{"val":"Normal"},"uiPriority":{"val":9},"qFormat":{"val":true},"pPr":{"keepNext":{"val":true},"keepLines":{"val":true},"spacing":{"before":240,"after":60,"line":312,"lineRule":"STLineSpacingRule_auto"},"jc":{"val":"STJcWml_center"},"outlineLvl":{"val":0}},"rPr":{"b":{"val":true},"bCs":{"val":true},"sz":{"val":320},"szCs":{"val":320}}}}}}}]'),a=function(){function e(t){this.dataEngine=e.initDataEngine(t.mutations)}return e.initDataEngine=function(t){var n,r;try{if(0===t.length)throw new Error("mutations cannot be 0");if((null===(n=t[0])||void 0===n?void 0:n.type)!==o.MutationType.insert)throw new Error("mutation format error");var i=null===(r=t[0])||void 0===r?void 0:r.getMutation();if(i&&0===i.text.length)throw new Error("the first mutation length cannot be 0 total mutation nums: ".concat(t.length,"!"))}catch(e){o.ReportHelper.monitor007Status(o.MonitorName.DATA_PARSE_ERROR_3_0,o.Status007.FAIL),o.ReportHelper.captureChangesetException(o.MonitorName.CHANGESET_ERROR_INIT,{option:{changesetDataType:o.ChangesetDataType.INIT_DATA}},e)}var a=e.createInitialDelta(t);return e.delta2DataEngine(a)},e.createInitialDelta=function(t){var n=e.mutations2Delta(t);return n.globalOpts.isInputDoc=!0,n},e.mutations2Delta=function(e){var t=o.DeltaOption.createServerDeltaOption(o.GCPRange.emptyRange()).buildDelta();return e.forEach((function(e){var n=o.OperationFactory.createServerOperation(e);n&&t.addOperation(n)})),t},e.delta2DataEngine=function(e){var t=o.DataEngine.createTempDataEngine();return e.applyOperations(t),t},e.loadSampleMutaions=function(t){void 0===t&&(t=i);var n=o.Changeset.deserialize(t,o.MutationWrapperDeserialize);return new e({mutations:Array.isArray(n)?n:[n]})},e}(),s=n(85556),c=n(30479);!function(e){e.TRANS_OPERATION_DATA_TO_DELTA="tranOperationDataToDelta",e.TRANS_DELTA_TO_OPERATION_DATA="transDeltaToOperationData",e.TRANS_SUBSTORY_TO_OPERATION_DATA="transSubStoryToOperationData",e.TRANS_MUTATION_TO_DELTA="transMutationToDelta",e.UNDO="undo",e.REDO="redo",e.IS_UNDO_AVAILBALE="isUndoAvailable",e.IS_REDO_AVAILBALE="isRedoAvailable",e.QUERY_UNDO_STACK_LENGTH="queryUndoStackLength",e.QUERY_REDO_STACK_LENGTH="queryRedoStackLength",e.CLEAR_UNDO_REDO_STACK="clearUndoRedoStack",e.SET_INVERSE_TO_STACK_TOP="setInverseToStackTop",e.INSERT_TEMPLATE="insertTemplate"}(r||(r={}));var l,u=n(82487);function d(e){return[o.OperationType.ModifyParagraphProp,o.OperationType.ModifySectionProp,o.OperationType.ModifyStoryProp,o.OperationType.ModifySubStoryProp,o.OperationType.ModifyRunProp,o.OperationType.ModifyDrawingProp,o.OperationType.ModifyPictureProp,o.OperationType.ModifyEmbeddedObjectProp,o.OperationType.ModifyFieldProp,o.OperationType.ModifyCommentProp,o.OperationType.ModifyFootnoteProp,o.OperationType.ModifyEndnoteProp,o.OperationType.ModifyTableProp,o.OperationType.ModifyTableRowProp,o.OperationType.ModifyTableCellProp,o.OperationType.ModifyMathProp,o.OperationType.ModifyMathObjectProp,o.OperationType.ModifyMathRunProp,o.OperationType.ModifySdtProp].includes(e)}var p,h,f=((l={})[o.OperationType.InsertText]=function(e){var t=e.data.param.text;e.delta.insertText(e.range.end(),t)},l[o.OperationType.ModifyParagraphProp]=function(e){var t=e.data.param,n=t.property,r=t.mode;if(e.data.propertyType){var i=o.PropertyUtil.deserializeFromType(e.data.propertyType,n);i instanceof u.kkf.getPropertyClass(o.PropertyType.ParagraphProperty)?(e.styleId&&(i.pStyle=e.styleId),e.delta.setParagraphProperty(e.range,i,r)):c.Logger.warn("property deserialize failed")}},l[o.OperationType.InsertRange]=function(e){var t=e.data.param,n=t.property,r=t.range;if(n&&r)if(e.data.param.rangeType===o.MutationPropType.commentRange)e.delta.insertCommentRange(n.id,new o.GCPRange(r.gcpBegin,r.len));else if(e.data.param.rangeType===o.MutationPropType.bookmarkRange){var i=e.data.param.property;e.delta.insertBookmarkRange(new o.GCPRange(e.range.gcpBegin,e.range.len),i.id,i.name)}},l[o.OperationType.DeleteRange]=function(e,t){return t>e.range.gcpBegin?0:t},l[o.OperationType.ModifySectionProp]=function(e){var t=e.data.param,n=t.property,r=t.mode;if(e.data.propertyType){var i=o.PropertyUtil.deserializeFromType(e.data.propertyType,n);i instanceof u.kkf.getPropertyClass(o.PropertyType.SectionProperty)?e.delta.setSectionProperty(e.range,i,r):c.Logger.warn("property deserialize failed")}},l[o.OperationType.ModifySubStoryProp]=function(e){var t=e.data.param,n=t.property,r=t.mode;if(e.data.propertyType){var i=o.PropertyUtil.deserializeFromType(e.data.propertyType,n);i instanceof u.kkf.getPropertyClass(o.PropertyType.CTSubStoryPr)?e.delta.setSubStoryProperty(e.range,i,r):c.Logger.warn("property deserialize failed")}},l[o.OperationType.ModifyCommentProp]=function(e){var t=e.data.param,n=t.property,r=t.mode;if(e.data.propertyType){var i=o.PropertyUtil.deserializeFromType(e.data.propertyType,n);i instanceof u.kkf.getPropertyClass(o.PropertyType.CommentReferenceProperty)?e.delta.setCommentProperty(e.range,i,r):c.Logger.warn("property deserialize failed")}},l[o.OperationType.ModifyRunProp]=function(e){var t=e.data.param,n=t.property,r=t.mode;if(e.data.propertyType){var i=o.PropertyUtil.deserializeFromType(e.data.propertyType,n);if(i&&i instanceof u.kkf.getPropertyClass(o.PropertyType.RunProperty)){if(!i.isEmpty(u.kkf.getPropertyClass(o.PropertyType.RunProperty).tKeys.rFonts)){var a=i.rFonts.ascii.slice(0,200),s=i.rFonts.hAnsi.slice(0,200),l=i.rFonts.eastAsia.slice(0,200),d=i.rFonts.cs.slice(0,200);i.rFonts.ascii=a,i.rFonts.hAnsi=s,i.rFonts.eastAsia=l,i.rFonts.cs=d}e.styleId&&(i.rStyle=e.styleId),e.delta.setRunProperty(e.range,i,r)}else c.Logger.warn("property deserialize failed")}},l[o.OperationType.ModifyDrawingProp]=function(e){var t=e.data.param,n=t.property,r=t.mode;if(e.data.propertyType){var i=o.PropertyUtil.deserializeFromType(e.data.propertyType,n);i instanceof u.kkf.getPropertyClass(o.PropertyType.DrawingProperty)?e.delta.setDrawingProperty(e.range,i,r):c.Logger.warn("property deserialize failed")}},l[o.OperationType.ModifyFieldProp]=function(e){var t=e.data.param,n=t.property,r=t.mode;if(e.data.propertyType){var i=o.PropertyUtil.deserializeFromType(e.data.propertyType,n);i instanceof u.kkf.getPropertyClass(o.PropertyType.FieldCharProperty)?e.delta.setFieldProperty(e.range,i,r):c.Logger.warn("property deserialize failed")}},l[o.OperationType.ModifyTableProp]=function(e){var t=e.data.param,n=t.property,r=t.mode,i=e.styleId;if(e.data.propertyType){var a=o.PropertyUtil.deserializeFromType(e.data.propertyType,n);a instanceof u.kkf.getPropertyClass(o.PropertyType.TableProperty)?(""!==i&&(a.tblPr.tblStyle=i),e.delta.setTableProperty(e.range,a,r)):c.Logger.warn("property deserialize failed")}},l[o.OperationType.ModifyTableRowProp]=function(e){var t=e.data.param,n=t.property,r=t.mode;if(e.data.propertyType){var i=o.PropertyUtil.deserializeFromType(e.data.propertyType,n);i instanceof u.kkf.getPropertyClass(o.PropertyType.TableRowProperty)?e.delta.setTableRowProperty(e.range,i,r):c.Logger.warn("property deserialize failed")}},l[o.OperationType.ModifyTableCellProp]=function(e){var t=e.data.param,n=t.property,r=t.mode;if(e.data.propertyType){var i=o.PropertyUtil.deserializeFromType(e.data.propertyType,n);i instanceof u.kkf.getPropertyClass(o.PropertyType.TableCellProperty)?e.delta.setTableCellProperty(e.range,i,r):c.Logger.warn("property deserialize failed")}},l[o.OperationType.SettingOperation]=function(e){var t=e.data.param,n=t.property,r=t.settingType;if(e.data.propertyType){var i=o.PropertyUtil.deserializeFromType(e.data.propertyType,n);i?e.delta.setSettingProperty(i,r):c.Logger.warn("property deserialize failed")}},l[o.OperationType.ModifyEmbeddedObjectProp]=function(e){var t=e.data.param,n=t.property,r=t.mode;if(e.data.propertyType){var i=o.PropertyUtil.deserializeFromType(e.data.propertyType,n);i&&i instanceof u.kkf.getPropertyClass(o.PropertyType.EmbeddedObjectProperty)?e.delta.setEmbeddedObjectProperty(e.range,i,r):c.Logger.warn("property deserialize failed")}},l),g=function(){function e(){}return e.transOperationDataToDelta=function(e,t,n,r){var i=e.currentRange().begin(),a=0;t.forEach((function(t){var s={delta:e,data:t,range:o.GCPRange.emptyRange(),styleId:""};if(t.operationType===o.OperationType.InsertText)a=e.currentRange().end(),s.range=new o.GCPRange(a,0);else if(d(t.operationType)){var c=t.param.range;s.range=new o.GCPRange(a,c.len)}else if(t.operationType===o.OperationType.InsertRange)if(t.param.rangeType===o.MutationPropType.commentRange){var l=s.data.param,u=e.currentRange().end()-l.range.len;l.range=new o.GCPRange(u,l.range.len)}else t.param.rangeType===o.MutationPropType.bookmarkRange&&(c=t.param.range,s.range=new o.GCPRange(i+c.gcpBegin,c.len));if(t.builtinStyleName){var p=void 0,h=r.get(t.builtinStyleName);h?p=h:(p=n.service.getDocument().generateStyleProperty(e,String(t.builtinStyleName)))&&r.set(t.builtinStyleName,p),p&&(s.styleId=p.styleId)}f[t.operationType](s)}))},e.getStyleName=function(e,t){var n=o.BuiltinStyleName.None,r="";o.OperationType.ModifyParagraphProp===t.operationType&&(r=t.param.property.pStyle),o.OperationType.ModifyRunProp===t.operationType&&(r=t.param.property.rStyle),o.OperationType.ModifyTableProp===t.operationType&&(r=t.param.property.tblPr.tblStyle);var i=e.getDataManager().getStyleSheetManager().getStylePropertyFromId(r,!0);return i&&(n=i.name),n},e.getPropertyType=function(e){var t;return d(e.operationType)&&(t=e.param.property.propertyType),e.operationType===o.OperationType.SettingOperation&&(t=e.param.property.propertyType),t},e}();!function(e){e.Undo="Undo",e.Redo="Redo"}(p||(p={})),function(e){e.Undo="UndoAction",e.Redo="RedoAction"}(h||(h={})),function(e){function t(t,n){var r=e.call(this,t)||this;return r.listeners=n,r}(0,s.__extends)(t,e)}(c.Notification);var v,y=function(e){function t(t){return e.call(this,t)||this}return(0,s.__extends)(t,e),t}(c.Notification);function m(e,t){var n;return(n={})[r.UNDO]=function(){t.fire(new y(h.Undo)),e.undo()},n[r.REDO]=function(){e.redo()},n[r.IS_UNDO_AVAILBALE]=function(){return e.isUndoAvailable()},n[r.IS_REDO_AVAILBALE]=function(){return e.isRedoAvailable()},n[r.CLEAR_UNDO_REDO_STACK]=function(){e.clearUndoRedoStack()},n[r.TRANS_OPERATION_DATA_TO_DELTA]=function(e,t,n,r,i,a,c,l){var u=new Map,d={operationDataList:a,storyRange:l},p=(0,s.__spreadArray)([d],(0,s.__read)(c.map((function(e){return{operationDataList:e.storyOps,storyRange:new o.GCPRange(r.getStoryLastPos(e.storyType),0)}}))),!1).sort((function(e,t){return e.storyRange.end()-t.storyRange.end()})),h=0;p.forEach((function(e){var t=e.storyRange,r=e.operationDataList;n.moveTo(new o.GCPRange(t.gcpBegin+h,t.len)),g.transOperationDataToDelta(n,r,i,u),h=n.currentRange().end()-t.gcpBegin}))},n[r.TRANS_DELTA_TO_OPERATION_DATA]=function(e,t,n,r,o){n.operations.forEach((function(e){var t=g.getPropertyType(e),n=g.getStyleName(o,e);r.push({operationType:e.operationType,param:e.param,propertyType:t,builtinStyleName:n})}))},n[r.TRANS_MUTATION_TO_DELTA]=function(e,t,n,r){try{var i=o.Changeset.parse(r);(Array.isArray(i)?i:[i]).forEach((function(e){var t=new o.MutationWrapper(e,{}),r=o.OperationFactory.createServerOperation(t,!1);r&&n.addOperation(r)}))}catch(e){c.Logger.error(e)}},n[r.SET_INVERSE_TO_STACK_TOP]=function(t,n,r){try{e.setInverse(r)}catch(e){c.Logger.error(e)}},n}!function(e){e.SERVER="undo_server",e.LOCAL="undo_local",e.INVALID="undo_invalid"}(v||(v={}));var b,_=function(){function e(e,t,n,r,o){this.changeMutations=[],this.inverseMutations=[],this.undoEventId="",this.source=r,this.changeMutations=e,this.inverseMutations=t,this.commandType=n,this.timestamp=(new Date).getTime(),this.undoOption=o,this.undoEventId=(null==o?void 0:o.undoEventId)||""}return e.prototype.clone=function(){return new e(this.changeMutations.slice(),this.inverseMutations.slice(),this.commandType,this.source,this.undoOption)},e}(),C=n(64282),S=function(){function e(e){this.undoStack=[],this.redoStack=[],this.mergeInterval=500,this.undoStack=[],this.redoStack=[],this.undoredo=e}return e.prototype.serverDo=function(e){this.undoStack.push(e),this.redoStack.push(e.clone())},e.prototype.localDo=function(e){this.checkLocalEventMerge(e)?this.mergeLocalEventMerge(e):this.undoStack.push(e),this.redoStack=[]},e.prototype.mergeLocalEventMerge=function(e){var t,n=this.undoStack[this.undoStack.length-1];n.changeMutations=n.changeMutations.concat(e.changeMutations),n.inverseMutations=e.inverseMutations.concat(n.inverseMutations),n.undoOption&&(n.undoOption.redoSelectionRange=null===(t=e.undoOption)||void 0===t?void 0:t.redoSelectionRange)},e.prototype.checkLocalEventMerge=function(e){var t,n=this.undoStack[this.undoStack.length-1],r=e.commandType,o=null==n?void 0:n.commandType;return!(n&&n.source===v.LOCAL&&e.source===v.LOCAL&&(null===(t=e.undoOption)||void 0===t?void 0:t.isUnMerge)||(!n||!n.undoEventId||n.undoEventId!==e.undoEventId)&&(!n||e.timestamp-n.timestamp>this.mergeInterval||(n.source!==v.LOCAL||r!==o)&&(!n||n.source!==v.LOCAL)))},e.prototype.undoRedo=function(e){try{for(var t=e===o.UndoRedoType.Undo?this.undoStack:this.redoStack,n=e===o.UndoRedoType.Undo?this.redoStack:this.undoStack,r=t.length-1;r>=0;r--){var i=t[r];if(i.source===v.LOCAL){var a=i,s=t.slice(r+1),c=this.invert(a,s);return c&&n.push(c),t.splice(r,1),c}}}catch(e){this.clear()}return null},e.prototype.invert=function(e,t){var n=this,r=new _(e.inverseMutations,e.changeMutations,e.commandType,v.LOCAL,e.undoOption);return t.forEach((function(e){n.handleUndoConflict(r,e)})),r},e.prototype.handleUndoConflict=function(e,t){if(t.changeMutations.length>0&&e.changeMutations.length>0){var n=e.changeMutations,r=t.changeMutations,o=e.undoOption;(null==o?void 0:o.undoSelectionRange)&&t.changeMutations.forEach((function(e){o.undoSelectionRange=e.transformGcpRange(o.undoSelectionRange,!0)})),(null==o?void 0:o.redoSelectionRange)&&t.changeMutations.forEach((function(e){o.redoSelectionRange=e.transformGcpRange(o.redoSelectionRange,!0)}));var i=(0,s.__read)(C.hV.followDouble(n,r),2),a=i[0],c=i[1];e.changeMutations=a,t.changeMutations=c,e.inverseMutations=[]}},e.prototype.isUndoAvailable=function(){return this.undoStack.length>0},e.prototype.isRedoAvailable=function(){return this.redoStack.length>0},e.prototype.clear=function(){this.undoStack=[],this.redoStack=[]},e}(),w=function(){function e(e,t){this.collab=e,this._stack=new S(this)}return e.prototype.undo=function(){var e=this._stack.undoRedo(o.UndoRedoType.Undo);e&&(this.collab.applyUndoRedoChange(e,o.UndoRedoType.Undo),o.ReportHelper.tdwReport({opername:"doc_word_editor",module:"doc_whole",action:"undo"}))},e.prototype.undoTo=function(e){for(;-1!==this._stack.undoStack.findIndex((function(t){return t.undoEventId===e}));)this.undo()},e.prototype.redo=function(){var e=this._stack.undoRedo(o.UndoRedoType.Redo);e&&(this.collab.applyUndoRedoChange(e,o.UndoRedoType.Redo),o.ReportHelper.tdwReport({opername:"doc_word_editor",module:"doc_whole",action:"redo"}))},e.prototype.isUndoAvailable=function(){return this._stack.isUndoAvailable()},e.prototype.isRedoAvailable=function(){return this._stack.isRedoAvailable()},e.prototype.getUndoStackLength=function(){return this._stack.undoStack.length},e.prototype.getRedoStackLength=function(){return this._stack.redoStack.length},e.prototype.clearUndoRedoStack=function(){this._stack.clear()},e.prototype.dispatchUndoRedoEvent=function(e,t,n,r,o){if(e.length>0||t.length>0){var i=v.LOCAL;r||(i=v.SERVER);var a=new _(e,t,n,i,o);this.dispatchEventToStack(a)}},e.prototype.setInverse=function(e){var t=e.globalOpts.undoOption,n=t.fromUndoRedo,r=t.undoRedoType;if(n&&r){var i,a=e.getMutations().inverses.slice(0),s=r===o.UndoRedoType.Undo?this._stack.redoStack:this._stack.undoStack;(i=s)[i.length-1]&&i[i.length-1].source===v.LOCAL&&0===i[i.length-1].inverseMutations.length&&(s[s.length-1].inverseMutations=a)}},e.prototype.dispatchEventToStack=function(e){e.source===v.LOCAL?this._stack.localDo(e):this._stack.serverDo(e)},e}();!function(e){e.push="pushChangesetLog",e.get="getChangsetLog",e.getActionType="getActionType",e.produceData="dataProduceAction",e.reportEdit="reportEdit"}(b||(b={}));var E,x=function(){function e(t){var n,r=this;this.dirty=t,this._changesetLog=[],this.plugin=((n={})[b.push]=function(t,n,o){r._changesetLog.unshift(o),r._changesetLog.length>e.MAX_LOG_COUNT&&r._changesetLog.pop()},n[b.get]=function(){return r._changesetLog},n[b.getActionType]=function(){var e="noActionType";return r._changesetLog.some((function(t){if(function(e){return void 0!==e.actionType}(t))return e=t.actionType,!0})),e},n[b.produceData]=function(e,t,n,r,i){if(void 0===i&&(i=1),o.ReportHelper.coreIndexReport({opername:"tech_doc_dataflow_melo",module:"data_produce",action:r,ver5:"0",obj3:i},n,{}),i>1)for(var a=1;a<i;a++)o.ReportHelper.monitor(n);c.Logger.debug("dataProduceAction | ".concat(r," ").concat(i))},n[b.reportEdit]=function(){o.ReportHelper.tdwReport({opername:"doc_core",module:"edit",action:"edit_text",obj3:c.PlatformUtil.getBrowser(),ver5:1===r.dirty()?"limited":"normal"})},n)}return e.prototype.registerPlugin=function(e){e.registerPlugin(this.plugin)},e.MAX_LOG_COUNT=10,e}();!function(e){e.LocalChange="LocalChange"}(E||(E={}));var T=function(e){function t(t){var n=e.call(this,E.LocalChange)||this;return n.changeset=t,n}return(0,s.__extends)(t,e),t}(c.Notification),R=function(){function e(e,t){var n=this;this.editor=e,this.ignoreLineRev=t,this.undoRedo=new w(this,e),this.editor.on(o.StateNotification.CollabToServer,(function(e){n.collabToServer(e.handled,e.delta.globalOpts)})),this.editor.registerPlugin(m(this.undoRedo,this.editor))}return e.prototype.setChangesetManager=function(e){this.changesetManager=e},e.prototype.getUndoRedo=function(){return this.undoRedo},e.prototype.applyUndoRedoChange=function(e,t){e.changeMutations.length>0&&this.applyUndoDelta(e,t)},e.prototype.applyUndoDelta=function(e,t){var n,r;if(e.changeMutations.length>0){var i=o.DeltaOption.createLocalDeltaOption(o.GCPRange.emptyRange(),!0,!0);i.undoOption.undoSelectionRange=null===(n=e.undoOption)||void 0===n?void 0:n.undoSelectionRange,i.undoOption.redoSelectionRange=null===(r=e.undoOption)||void 0===r?void 0:r.redoSelectionRange,i.undoOption.needInverse=!0,i.undoOption.fromUndoRedo=!0,i.undoOption.undoRedoType=t,i.commandType=t===o.UndoRedoType.Undo?o.CommandType.DocUndo:o.CommandType.DocRedo,this.editor.applyMutations(e.changeMutations,i)}},e.prototype.applyChangesToBase=function(e,t){this.applyToModel(e,t),this.undoRedo.dispatchUndoRedoEvent(e,[],o.CommandType.Empty,!1)},e.prototype.applyInitialData=function(e){this.editor.setDataEngine(e.dataEngine)},e.prototype.getWordCountCache=function(){return this.editor.wordCount.charactersNumber},e.prototype.applyToModel=function(e,t){if(e.length>0){var n=o.DeltaOption.createServerDeltaOption(o.GCPRange.emptyRange());t&&n.setAuthor(t),this.editor.applyMutations(e,n)}},e.prototype.collabToServer=function(e,t){var n=t.undoOption,r=n.needInverse,i=n.fromUndoRedo,a=e.mutations,s=e.inverses;if(o.GlobalContext.run(b.produceData,o.MonitorName.DATA_PRODUCE,"cs_produce"),o.ReportHelper.monitor007Status(o.MonitorName.DATA_PRODUCE_3_0),a.length>0){var l={mutations:a,type:t.commandType||o.CommandType.Empty},u={changeset:l,subId:"BB08J2"};c.Logger.info("collaboration = ".concat(JSON.stringify(u))),this.editor.fire(new T(l.mutations.slice(0))),this.changesetManager.composeUserChangeset(l)}t.commandType&&t.commandType!==o.CommandType.Empty||o.ReportHelper.captureException(o.MonitorName.COMMAND_TYPE_REQUIRED,{},new Error("command type required: ".concat(JSON.stringify(a)))),r&&!i&&a.length>0&&s.length>0&&this.undoRedo.dispatchUndoRedoEvent(a,o.Changeset.compose(s),t.commandType,!0,t.undoOption)},e}()},50841:function(e,t,n){n.d(t,{_:function(){return i}});var r=n(2613),o=n(63184),i=function(){function e(){}return e.getAllMutations=function(e){var t=e.initialAttributedText.text,n="string"==typeof t?this.safeParseJSON(t):t,o=Array.isArray(n)?n:[n],i=[];return o.forEach((function(e){return e.commands.forEach((function(e){var t=r.Changeset.deserialize(e.mutations,r.MutationWrapperDeserialize),n=Array.isArray(t)?t:[t];i=i.concat(n)}))})),i},e.safeParseJSON=function(e){var t;try{t=JSON.parse(e)}catch(n){t=JSON.parse(unescape(e))}return t},e.createDataInput=function(e){return new o.QD({mutations:this.getAllMutations(e)})},e}()},67551:function(e,t,n){var r=new WeakMap;function o(e,t){return r.get(e)&&r.get(e).get(t)}function i(e,t,n){if(void 0===t)throw new TypeError;var r=o(t,n);return r&&r.get(e)}function a(e,t,n,i){if(i&&!["string","symbol"].includes(typeof i))throw new TypeError;(o(n,i)||function(e,t){var n=r.get(e)||new Map;r.set(e,n);var o=n.get(t)||new Map;return n.set(t,o),o}(n,i)).set(e,t)}function s(e,t,n){return i(e,t,n)?i(e,t,n):Object.getPrototypeOf(t)?s(e,Object.getPrototypeOf(t),n):void 0}var c={decorate:function(e,t,n,r){if(!Array.isArray(e)||0===e.length)throw new TypeError;return void 0!==n?function(e,t,n,r){return e.reverse().forEach((function(e){r=e(t,n,r)||r})),r}(e,t,n,r):"function"==typeof t?function(e,t){return e.reverse().forEach((function(e){var n=e(t);n&&(t=n)})),t}(e,t):void 0},defineMetadata:function(e,t,n,r){a(e,t,n,r)},getMetadata:function(e,t,n){return s(e,t,n)},getOwnMetadata:function(e,t,n){return i(e,t,n)},hasMetadata:function(e,t,n){return!!s(e,t,n)},hasOwnMetadata:function(e,t,n){return!!i(e,t,n)},metadata:function(e,t){return function(n,r){a(e,t,n,r)}}};Object.assign(Reflect,c);var l,u,d,p=n(23336),h=n.n(p),f='<div id="app" style="height:100%;position:relative;z-index:2"> <div style="height:100%;display:flex;flex-direction:column"> <div id="legacy-titlebar"></div> <div id="workbench" style="flex:1 1 100%;height:calc(100vh - 55px)"></div> </div> </div> ',g=n(85556),v=n(99925),y=n(70794),m=n(48273),b=n(22828),_=n(81814);function C(e){return"number"==typeof e&&e>=u.PromiseRejectSlide&&e<=u.PromiseRejectUnkownReason}!function(e){e.Doc="doc",e.Excel="sheet",e.PPt="slide",e.AIO="aio",e.BlankPage="blankpage"}(l||(l={})),function(e){e[e.PromiseRejectSlide=1]="PromiseRejectSlide",e[e.PromiseRejectSheet=2]="PromiseRejectSheet",e[e.PromiseRejectBlankPage=3]="PromiseRejectBlankPage",e[e.PromiseRejectDataErr=4]="PromiseRejectDataErr",e[e.PromiseRejectFromServerFail=5]="PromiseRejectFromServerFail",e[e.PromiseRejectFromServerParseFail=6]="PromiseRejectFromServerParseFail",e[e.PromiseRejectFromIndexDBResultError=7]="PromiseRejectFromIndexDBResultError",e[e.PromiseRejectFromIndexDBResultFail=8]="PromiseRejectFromIndexDBResultFail",e[e.PromiseRejectFromIndexDBResultNone=9]="PromiseRejectFromIndexDBResultNone",e[e.PromiseRejectFromIndexDBInitFail=10]="PromiseRejectFromIndexDBInitFail",e[e.PromiseRejectDataBaseComposeExp=11]="PromiseRejectDataBaseComposeExp",e[e.PromiseRejectOnLineAndDataBaseBothFail=12]="PromiseRejectOnLineAndDataBaseBothFail",e[e.PromiseRejectGetDataFailUnkown=13]="PromiseRejectGetDataFailUnkown",e[e.PromiseRejectParamError=14]="PromiseRejectParamError",e[e.PromiseRejectUnkownReason=99]="PromiseRejectUnkownReason"}(u||(u={})),function(e){e[e.ReleaseCGIDefaultCode=51]="ReleaseCGIDefaultCode",e[e.ReleaseCGIPvCheckode=52]="ReleaseCGIPvCheckode"}(d||(d={}));var S=function(e){this.getClientVarsOnlineStart=-1,this.getClientVarsOnlineEnd=-1,this.getClientVarsOnlineCount=-1,this.getClientVarsOnlineCost=-1,this.getClientVarsDBStart=-1,this.getClientVarsDBEnd=-1,this.getClientVarsDBCompose=-1,this.getClientVarsDBCost=-1,this.getClientVarsSource="",this.getClientVarsStart=-1,this.getClientVarsEnd=-1,this.getClientVarsCost=-1,this.getOfflineDataCost=-1,this.getClientVarsStart=e},w=function(e,t){void 0!==e&&(this.error=e),this.data=t},E=function(e){if(e&&e.collab_client_vars&&e.globalPadId&&e.padType&&(e.padType===l.Doc||e.padType===l.AIO)){var t=function(e){var t=e;return t.isMac=b.t.isMac(),t.isIPad=b.t.isIPad(),t.isMobile=!t.isIPad&&b.t.isMobile(),t.isIPhone=b.t.isIPhone(),t.isTimOnline=!0,t.cdn="",t.padStatus=t.padStatus||_.DL.NORMAL,t.canShowCertification=!!t.official_auth_info,t}(e);return t=function(e){var t=e;return t.creatorDomain||(t.creatorDomain=t.domainId),t}(t)}return null},x=n(73557),T=n(26676);function R(e){for(var t=0,n=e||"",r=n.length,o={text:{type:"",value:null},attribs:{type:"",value:null},head:{type:"",value:null}};t<r;){var i=n.slice(t,t+50).split("\n");if(!(i&&i.length>=3))break;var a=i[0],s=i[1],c=Number(i[2]);t+=i[0].length+i[1].length+i[2].length+3;var l=n.slice(t,t+c);t+=c+1,"text"===a?(o.text.type=s,o.text.value="json"===s?JSON.parse(l):l):"head"===a?(o.head.type=s,o.head.value="json"===s?JSON.parse(l):l):"attribs"===a&&(o.attribs.type=s,o.attribs.value="json"===s?JSON.parse(l):l)}return o}var I=n(19762),P=n(28372),O=n(21856),k=n(2613),D=n(98337),M=function(){function e(e){this.secretId=e}return e.prototype.getDocDataFromServer=function(e,t,n){var r=location.search;r&&r.indexOf("?")>-1?((r+="&").indexOf("uid_key")>-1&&(r=(0,y.rg)(r,"uid_key")),r.indexOf("uid")>-1&&(r=(0,y.rg)(r,"uid"))):r+="?";var o="/dop-api/opendoc".concat(r,"&normal=1&noEscape=1&outformat=1&id=").concat(e,"&xsrf=").concat((0,I.f)(),"&doc_chunk_flag=").concat(b.t.isMobile()?0:1),i=(0,T.k8)("preview_token");return i&&(o="".concat(o,"&preview_token=").concat(i)),v.j.info(v.w.Launch,"Opendoc Url:".concat(o)),h().ajax({type:"get",url:o,timeout:3e4,cache:!0,dataType:"json",xhrFields:{withCredentials:!0},success:function(e){var r="string"==typeof e?JSON.parse(e):e,o=r.clientVars;t&&o?!0===o.isBlankPage?t(r):t(o):n&&(v.j.error(v.w.Launch,"Opendoc fail>:".concat(JSON.stringify(e))),n(r))},error:function(e,t,r){var o,i,a,s;try{if((null!==(s=null===(a=null===(i=null===(o=null==e?void 0:e.responseText)||void 0===o?void 0:o.match)||void 0===i?void 0:i.call(o,/"dver":"2.1.0"/g))||void 0===a?void 0:a.length)&&void 0!==s?s:0)>=2)return D.Q.instance.onDverUpdate("2.1.0")}catch(t){v.j.error(v.w.Launch,"parse dver fail>:".concat(null==e?void 0:e.responseText))}v.j.info(v.w.Launch,"Opendoc textStatus>".concat(JSON.stringify(t)," err>").concat(JSON.stringify(r)," errmsg>").concat(null==r?void 0:r.message," network>").concat(x.network.isOnline?"online":"offline"," request>").concat(JSON.stringify(e))),k.ReportHelper.tdwReport({opername:"open_doc_failed",module:"client_vars_online",action:"request",ver5:String(null==e?void 0:e.status),ver6:(null==e?void 0:e.statusText)||t,ver7:x.network.isOnline?1:0}),n&&n()}})},e.prototype.getPubDocDataFromServer=function(e,t,n){var r=O.X.getInstance().getConfig("custom.domains.publishServerDomain"),o="https://".concat(r,"/").concat(e,".doc1?t=").concat(Math.ceil(+new Date/1e4));return v.j.info(v.w.Launch,"getPubDocDataFromServer:".concat(o)),h().ajax({type:"get",url:o,timeout:1e4,cache:!0,success:function(e){var r=function(e){var t=R(e);if(t){var n=t.head.value;if(!n)return;return t.text&&t.text.value&&(n.clientVars.collab_client_vars.initialAttributedText.text=t.text.value,n.clientVars.collab_client_vars.initialAttributedText.attribs=t.attribs.value),n.clientVars}}(e);if(t&&r)if(!0===r.isBlankPage){var o=R(e).head.value;o&&t(o)}else r.isPublish=!0,t(r);else n&&n()},error:function(e,t,r){v.j.info(v.w.Launch,"T20:".concat(JSON.stringify(e),", ").concat(JSON.stringify(t),", ").concat(JSON.stringify(r))),n&&n({data:{errcode:d.ReleaseCGIDefaultCode},padType:"blankpage"})}})},e.prototype.pvcheckForPublish=function(e){var t="/pvcheck/publish?id=".concat(e);return h().ajax({type:"get",url:t,timeout:b.t.isMiniProgram()?3e4:2e4,cache:!0,success:function(e){e&&e.data&&!1===e.data.isNormal&&P.V.setBlankpageData(u.PromiseRejectBlankPage,{errcode:d.ReleaseCGIPvCheckode})}})},e.prototype.getClientVarsFromServer=function(e){return(0,g.__awaiter)(this,void 0,void 0,(function(){var t=this;return(0,g.__generator)(this,(function(n){return[2,new Promise((function(n,r){window.isPublishedURL?(t.getPubDocDataFromServer(e,(function(e){n(e)}),(function(e){n(e)})),t.pvcheckForPublish(e)):t.getDocDataFromServer(e,(function(e){n(e)}),(function(e){r(e)}))}))]}))}))},e.prototype.getClientVarsByXHR=function(e,t){var n=+new Date;this.getClientVarsFromServer(this.secretId).then((function(r){if(r){var o=+new Date-n;window.getClientVarsCost&&(window.getClientVarsCost.getClientVarsOnlineStart=n,window.getClientVarsCost.getClientVarsOnlineCost=o),v.j.info("".concat(v.w.Launch," getClientVarsByXHR: cost:").concat(o)),e(new _.x4(void 0,r))}else t(new _.x4(new Error("".concat(u.PromiseRejectFromServerParseFail))))})).catch((function(e){t(new _.x4(new Error("".concat(e?u.PromiseRejectFromServerFail:u.PromiseRejectUnkownReason)),e))}))},e.prototype.handleOpendocReponse=function(e,t,n){if(e){var r="string"==typeof e?JSON.parse(e):e,o=r.clientVars;if(o)return!0===o.isBlankPage?t(new _.x4(void 0,r)):t(new _.x4(void 0,o))}return this.getClientVarsByXHR(t,n)},e.prototype.handleOpenDocResponseJSONP=function(e,t,n){var r;return(0,g.__awaiter)(this,void 0,void 0,(function(){var o,i,a;return(0,g.__generator)(this,(function(s){switch(s.label){case 0:if(!e)return[3,6];s.label=1;case 1:return s.trys.push([1,5,,6]),o="string"==typeof e?JSON.parse(e):e,(i=o.clientVars)?i.isLogin||!(null===(r=window.tdocs)||void 0===r?void 0:r.docLogin)?[3,3]:[4,window.tdocs.docLogin()]:[3,4];case 2:return s.sent(),[2,this.getClientVarsByXHR(t,n)];case 3:return!0===i.isBlankPage?[2,t(new _.x4(void 0,o))]:[2,t(new _.x4(void 0,i))];case 4:return[3,6];case 5:return a=s.sent(),v.j.error(v.w.Launch,"[opendoc] handleOpenDocResponseJSONP error: ".concat(null==a?void 0:a.message)),[2,this.getClientVarsByXHR(t,n)];case 6:return[2,this.getClientVarsByXHR(t,n)]}}))}))},e.prototype.overWriteJsonpCallback=function(e,t){var n=this,r=window,o=r.clientVarsCallback,i=setTimeout((function(){return n.getClientVarsByXHR(e,t)}),1e4);r.clientVarsCallback=function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];o.apply(void 0,(0,g.__spreadArray)([],(0,g.__read)(a),!1)),clearTimeout(i),n.handleOpenDocResponseJSONP(r.openDocResponseText,e,t)}},e.prototype.overWriteXhrReadyStateChange=function(e,t,n){var r=this;e.onreadystatechange=function(){return(0,g.__awaiter)(r,void 0,void 0,(function(){return(0,g.__generator)(this,(function(r){return e.readyState!==XMLHttpRequest.DONE?[2]:200!==e.status?(v.j.error(v.w.Launch,"[opendoc] overWriteXhrReadyStateChange status: ".concat(null==e?void 0:e.status," responseText: ").concat(JSON.stringify(e.response))),[2,this.getClientVarsByXHR(t,n)]):[2,this.handleOpendocReponse(e.response,t,n)]}))}))}},e.prototype.getClientVars=function(){return(0,g.__awaiter)(this,void 0,Promise,(function(){var e=this;return(0,g.__generator)(this,(function(t){return[2,new Promise((function(t,n){try{"D0000000000000000"===e.secretId&&k.ReportHelper.idkeyReport(k.IdkeyName.PREOPEN_OPENDOC_ERR)}catch(e){console.error(e)}var r=window.openDocResponseText,o=window,i=o.openDocXhr,a=o.openDocType;if(v.j.info(v.w.Launch,"openDocType:".concat(a,", openDocXhr:").concat(i,", openDocResponseText:").concat(!!r)),!window.isPublishedURL){if("JSONP"===a&&void 0!==r)return k.PerfUtilLogger.mark("client_vars_not_wait"),e.handleOpenDocResponseJSONP(r,t,n);if("JSONP"===a&&void 0===r)return e.overWriteJsonpCallback(t,n);if(i&&void 0!==r)return k.PerfUtilLogger.mark("client_vars_not_wait"),e.handleOpendocReponse(r,t,n);if(i&&void 0===r)return e.overWriteXhrReadyStateChange(i,t,n)}return e.getClientVarsByXHR(t,n)}))]}))}))},e}(),A=n(39445),L=n(24689),N=n(64009),B=n(37084),F=n(147),U=n(28379),H=n(82132),j=n(38429),G=n(79329),V=n(13980);function W(e,t){return(0,g.__awaiter)(this,void 0,Promise,(function(){var n,r,o;return(0,g.__generator)(this,(function(i){switch(i.label){case 0:return n=_.Nt.INIT,r=(0,V.getUid)(),o=_.he.newInstance().addCondition("globalPadId",_.E1.ONLY,e).addCondition("type",_.E1.ONLY,n).addCondition("uid",_.E1.ONLY,r),void 0!==t&&o.addCondition("version",_.E1.UPPER_BOUND,{upper:t,open:!0}),[4,G.Wo.getDataBase().delete(_.me.DOCUMENT_DATA,o)];case 1:return[2,i.sent()]}}))}))}var z,K=n(89407),q=n(54267),Y=n(47307),Q=n(33931),Z=n(50841),X=function(){function e(e){this.clientVarsOri=e}return e.prototype.getKeyframeBaseLen=function(e){if(e[0].type!==k.MutationType.insert)throw new Error("keyframe first mutation is not insert");var t=e[0].getMutation().text.length;return v.j.info(v.w.Launch,"getKeyframeBaseLen: initial baseLen:".concat(t)),e.forEach((function(e,n){if(n>0&&(e.type===k.MutationType.insert||e.type===k.MutationType.delete)){if(e.options.baseLen!==t)throw new Error("keyframe composed mutation invalid, baseLen:".concat(t,", mutation:").concat(e));t=e.getAfterLen()}})),t},e.prototype.compose=function(e){var t=this.clientVarsOri.collab_client_vars.rev,n=[];return e&&e.length>0&&e.forEach((function(e){var r=e.baseRev||t;"BB08J2"===e.subId&&n.push.apply(n,(0,g.__spreadArray)([],(0,g.__read)((0,Q.By)(e.changeset)),!1)),r>t&&(t=r)})),{rev:t,mutations:k.Changeset.compose(n)}},e.prototype.getComposeClientVars=function(e){var t=this.clientVarsOri,n=new w,r=+new Date;try{var o=Z._.getAllMutations(t.collab_client_vars),i=this.getKeyframeBaseLen(o);v.j.info(v.w.Launch,"getComposeClientVars keyframe rev:".concat(t.collab_client_vars.rev,", baseLen:").concat(i));var a=this.compose(e);if(a.mutations.length>0&&i!==a.mutations[0].options.baseLen)throw new Error("gaps between keyframe and user changes, ".concat(JSON.stringify(a.mutations[0])));t.collab_client_vars.rev=a.rev,t.collab_client_vars.initialAttributedText.text=JSON.stringify([{commands:[{type:"DocKeyframe",mutations:o.concat(a.mutations)}]}]),n.data=t}catch(e){n.error=e||"getClientVars: compose error:".concat(e),v.j.error(v.w.Launch,"getClientVars: compose error:".concat(e))}var s=+new Date-r;return window.getClientVarsCost&&(window.getClientVarsCost.getClientVarsDBCompose=s),v.j.info(v.w.Launch,"getComposeClientVars cost:".concat(s)),n},e.LOG_Module="ClientVarsOfflineData ",e}(),J=n(17908),$=n(22494),ee=function(){function e(){}return e.prototype.printChangesetsToWeblog=function(e,t,n){v.j.info("rev:".concat(t&&t.collab_client_vars&&t.collab_client_vars.rev,"}")),n.forEach((function(e){e&&v.j.info(v.w.Launch,"changeset:".concat(e.changeset," rev:").concat(e.baseRev))})),setTimeout((function(){v.j.report("Word_MeloGetComposeClientVarsError")}),2e3)},e.prototype.loadInitAndServerChanges=function(e){return(0,g.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o,i,a,s,c,l,u,d;return(0,g.__generator)(this,(function(p){switch(p.label){case 0:return p.trys.push([0,3,,4]),window.clientVarsDBJSAPIPromise?(t=Date.now(),[4,window.clientVarsDBJSAPIPromise]):[3,2];case 1:if((null==(u=p.sent())?void 0:u.result)&&u.result.length)return $.Y.preGetDBDataSuccess=!0,n=Date.now()-t,v.j.info(v.w.Offline,"clientVarsDBJSAPIPromise cost:".concat(n)),[2,new _.x4(void 0,u.result.map((function(e){return new _.TU(e)})))];p.label=2;case 2:return[3,4];case 3:return r=p.sent(),v.j.info(v.w.Offline,"clientVarsDBJSAPIPromise error:".concat(r)),$.Y.preGetDBDataSuccess=!1,[3,4];case 4:return o=Date.now(),[4,G.Wo.DBStatusPromise];case 5:return i=p.sent(),a=Date.now()-o,v.j.info(v.w.Offline,"offlineDataHelperInstance.DBStatusPromise cost:".concat(a)),i!==G.q7.InitFinish?[3,7]:(s=(0,V.getUid)(),c=_.he.newInstance().addCondition("uid",_.E1.ONLY,s).addCondition("secretId",_.E1.ONLY,e).addCondition("type",_.E1.IN,[_.Nt.INIT,_.Nt.ACCEPTED,_.Nt.MISS_CHANGE,_.Nt.NEW_CHANGE]),l=Date.now(),[4,G.Wo.getDataBase().getAll(_.me.DOCUMENT_DATA,c)]);case 6:return u=p.sent(),d=Date.now()-l,v.j.info(v.w.Offline,"offlineDataHelperInstance.getDataBase().getAll cost:".concat(d)),[2,u];case 7:return v.j.info(v.w.Offline,"offlineDataHelperInstance.DBStatusPromiseInitFail status:".concat(i)),[2,new _.x4(new Error("PromiseRejectType.PromiseRejectFromIndexDBInitFail"))]}}))}))},e.prototype.getLocalChangesetsFromDatabase=function(e){return(0,g.__awaiter)(this,void 0,void 0,(function(){var t,n;return(0,g.__generator)(this,(function(r){switch(r.label){case 0:return t=(0,V.getUid)(),n=_.he.newInstance().addCondition("uid",_.E1.ONLY,t).addCondition("secretId",_.E1.ONLY,e).addCondition("type",_.E1.IN,[_.Nt.COMMITING,_.Nt.QUEUE,_.Nt.WATTING]),[4,G.Wo.getDataBase().getAll(_.me.OFFLINE_DATA,n)];case 1:return[2,r.sent()]}}))}))},e.prototype.sortServerChangesets=function(e){return e.sort((function(e,t){return e.version===t.version?e.data&&t.data&&e.data.baseVersion!==t.data.baseVersion?e.data.baseVersion-t.data.baseVersion:e.createTime-t.createTime:e.version-t.version})),e},e.prototype.getPadInfo=function(e){return(0,g.__awaiter)(this,void 0,Promise,(function(){var t,n;return(0,g.__generator)(this,(function(r){switch(r.label){case 0:return t=(0,V.getUid)(),n=_.he.newInstance().addCondition("secretId",_.E1.ONLY,e).addCondition("uid",_.E1.ONLY,t),[4,G.Wo.getDataBase().get(_.me.PAD_INFO,n)];case 1:return[2,r.sent()]}}))}))},e.prototype.getClientVarsFromMemory=function(e){var t,n,r,o;return(0,g.__awaiter)(this,void 0,Promise,(function(){var i,a;return(0,g.__generator)(this,(function(s){switch(s.label){case 0:return[4,this.getPadInfo(e)];case 1:return(i=s.sent()).error?(v.j.error(v.w.Launch,"get padInfo error:".concat(null===(t=i.error)||void 0===t?void 0:t.message)),[2,void 0]):(a=i.data).status===_.DL.LOCAL||a.status===_.DL.NEW?(v.j.info(v.w.Launch,"getClientVarsFromMemory padInfo.status:".concat(a.status)),[2,(0,J.d)({globalPadId:a.globalPadId,secretId:a.secretId,dver:null!==(n=a.dver)&&void 0!==n?n:null===(o=null===(r=window.App)||void 0===r?void 0:r.GlobalConfig)||void 0===o?void 0:o.globalCodeVersion,title:a.title})]):[2,void 0]}}))}))},e.prototype.loadLocalDocOfflineChangesets=function(e,t){return(0,g.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,g.__generator)(this,(function(o){switch(o.label){case 0:return[4,this.getLocalChangesetsFromDatabase(e)];case 1:return(n=o.sent()).error?(v.j.error(v.w.Launch,"loadLocalDocOfflineChangesets error:".concat(n.error.stack,", ").concat(n.error.message)),[2,new _.x4(n.error)]):(i=n.data,a=[],s=[_.Nt.COMMITING,_.Nt.QUEUE,_.Nt.WATTING],i.sort((function(e,t){return e.type===t.type?e.createTime-t.createTime:s.indexOf(e.type)-s.indexOf(t.type)})),i.forEach((function(e){var t=e.data,n=e.dver;if(t.modelVersion)a.push({commitId:e.taskId,subId:e.subSheetId,baseRev:e.version,createTimestamp:e.createTime,changeset:(0,Q.Uq)(t.changesetString)});else{var r=JSON.parse(t);a.push({commitId:e.taskId,subId:e.subSheetId,offlineMsg:r.isOfflineMessage,baseRev:e.version,createTimestamp:e.createTime,changeset:(0,Y.U)(n)?r.data.changeset:(0,Q.Uq)(t.changesetString)})}})),r=a,G.Wo.pushMergedToBaseUserChange(r),[2,new _.x4(void 0,{clientVars:t,changsets:r,rev:t.collab_client_vars.rev})])}var i,a,s}))}))},e.prototype.loadClientVarsAndChangsets=function(e){return(0,g.__awaiter)(this,void 0,Promise,(function(){var t,n,r,o,i,a,s;return(0,g.__generator)(this,(function(c){switch(c.label){case 0:return t=Date.now(),[4,this.loadInitAndServerChanges(e)];case 1:return n=c.sent(),r=Date.now()-t,v.j.info(v.w.Offline,"loadInitAndServerChanges cost:".concat(r)),n.error?(v.j.info(v.w.Offline,"loadInitAndServerChanges error:".concat(n.error)),[2,new _.x4(n.error)]):(i=[],n.data.forEach((function(e){e&&(e.type===_.Nt.INIT?((!o||o&&o.collab_client_vars&&o.collab_client_vars.rev<e.version)&&(o=e.data),o&&!o.collab_client_vars.initialAttributedText.text&&(o.collab_client_vars.initialAttributedText.text=J.F)):i.push(e))})),o?[3,3]:[4,this.getClientVarsFromMemory(e)]);case 2:if((o=c.sent())&&(0,q.w)(o),!o)return[2,new _.x4(new Error("DataBase has not clientVars."))];c.label=3;case 3:return o.padStatus===_.DL.LOCAL||o.padStatus===_.DL.NEW?[2,this.loadLocalDocOfflineChangesets(e,o)]:(a=this.sortServerChangesets(i),s=function(e,t){var n=[],r=t;return e.forEach((function(e){var o,i,a,s,c,l=null===(o=e.data)||void 0===o?void 0:o.data;if(l){if(e.version<=t)return;e.version>t&&(r=e.version);var u={baseRev:null!==(s=null!==(a=null!==(i=l.baseRev)&&void 0!==i?i:l.newVersion)&&void 0!==a?a:l.newRev)&&void 0!==s?s:l.new_rev,changeset:(0,Q.Uq)(null!==(c=l.commands)&&void 0!==c?c:l.changeset),commitId:l.taskId,firstCommitRev:l.baseRev,subId:l.subId};switch(e.type){case _.Nt.NEW_CHANGE:case _.Nt.MISS_CHANGE:case _.Nt.ACCEPTED:n.push(u)}}})),{changsets:n,rev:r}}(a,o.collab_client_vars.rev||-1),[2,new _.x4(void 0,{clientVars:o,changsets:s.changsets,rev:s.rev})])}}))}))},e.prototype.getClientVarsFromDataBase=function(e){var t;return(0,g.__awaiter)(this,void 0,Promise,(function(){var n,r,o,i,a,s,c,l;return(0,g.__generator)(this,(function(u){switch(u.label){case 0:return n=Date.now(),[4,this.loadClientVarsAndChangsets(e)];case 1:return r=u.sent(),o=Date.now()-n,v.j.info(v.w.Offline,"loadClientVarsAndChangsets cost:".concat(o)),r.error?(v.j.info(v.w.Offline,"loadClientVarsAndChangsets error:".concat(r.error)),[2,r]):r.data?(i=r.data.clientVars,a=r.data.changsets,s=r.data.rev,c=new X(i),l=c.getComposeClientVars(a),v.j.info("getClientVarsFromDataBase, baseRev: ".concat(s,", changes.length: ").concat(a.length," error:").concat(null===(t=l.error)||void 0===t?void 0:t.message)),l.error?(this.printChangesetsToWeblog(c,i,a),i&&(W(i.globalPadId),(0,K.C)(i.globalPadId)),[2,new _.x4(new Error("".concat(l.error)))]):(l.data&&(i=l.data)&&i.collab_client_vars&&i.collab_client_vars.rev&&s>i.collab_client_vars.rev&&(i.collab_client_vars.rev=s),[2,{data:i}])):[2,new _.x4(new Error("getClientVarsFromDataBase fail"))]}}))}))},e}(),te=n(44166),ne=n(30479),re=n(95507);!function(e){e[e.Local=1]="Local",e[e.online=2]="online"}(z||(z={}));var oe,ie,ae,se,ce=function(){function e(){this.getDataFromDataBaseFail=!1,this.getDataFromOnlineFail=!1,this.serverResult=void 0,this.hasResolve=!1}return e.prototype.updatePadinfoTime=function(e){var t=e;return t&&(t.last_browse_ts=Date.now()/1e3,t.last_modify_ts=Date.now()/1e3),t},e.prototype.updatePadinfoStatus=function(e){if(!(0,y.re)("prerender")&&!(0,U.g6)()){var t=this.updatePadinfoTime(e);t.status===_.DL.NEW&&(t.status=_.DL.LOCAL),G.Wo.handleDataFromIndexDB({type:G.nN.update,tableName:_.me.PAD_INFO,data:t})}},e.prototype.updatePadByStatus=function(e){var t=e.data;if(t&&t.status)switch(t.status){case _.DL.NEW:case _.DL.LOCAL:case _.DL.NORMAL:this.updatePadinfoStatus(t);case _.DL.DELETED:}},e.prototype.updatePadinfo=function(e){return(0,g.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o;return(0,g.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),t=(0,V.getUid)(),n=_.he.newInstance().addCondition("secretId",_.E1.ONLY,e).addCondition("uid",_.E1.ONLY,t),[4,G.Wo.getDataBase().get(_.me.PAD_INFO,n)];case 1:if((r=i.sent()).error)throw v.j.info(v.w.Offline,JSON.stringify(r.error||"")),r.error;return r&&r.data&&this.updatePadByStatus(r),[3,3];case 2:return o=i.sent(),v.j.error(v.w.Offline,"updatePadinfo error".concat(o)),[3,3];case 3:return[2]}}))}))},e.prototype.getDataFromOnline=function(e){return(0,g.__awaiter)(this,void 0,Promise,(function(){var t,n,r;return(0,g.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),v.j.info(v.w.Offline,"getDataFromOnline start"),[4,new M(e).getClientVars()];case 1:if((t=o.sent())&&t.data)return[2,new _.x4(void 0,t.data)];throw t;case 2:return n=o.sent(),r=Number(n.message)||u.PromiseRejectUnkownReason,v.j.warn(v.w.Offline,"getDataFromOnline fail:".concat(r)),[2,n];case 3:return[2]}}))}))},e.prototype.getClientVarsFromIndexDB=function(e){var t;return(0,g.__awaiter)(this,void 0,Promise,(function(){var n,r,o,i,a;return(0,g.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,4,,5]),e?(n=+new Date,[4,(new ee).getClientVarsFromDataBase(e)]):[3,2];case 1:if((r=s.sent()).error)throw v.j.info(v.w.Offline,"getClientVarsFromDataBase error:".concat(r.error)),u.PromiseRejectFromIndexDBResultError;if(r&&r.data){if(o=r.data,"2.1.0"===(null===(t=null==o?void 0:o.collab_client_vars)||void 0===t?void 0:t.dver))throw u.PromiseRejectFromIndexDBResultError;return o.padStatus===_.DL.NEW&&(o.padStatus=_.DL.LOCAL),o.sourceOfClientVars=te.dw.FROM_LOCAL,o.collab_client_vars.isChunked=!1,i=+new Date,window.getClientVarsCost&&(window.getClientVarsCost.getClientVarsDBStart=n,window.getClientVarsCost.getClientVarsDBEnd=i,window.getClientVarsCost.getClientVarsDBCost=i-n),v.j.info(v.w.Offline,"getClientVarsFromIndexDB cost:".concat(i-n)),[2,new _.x4(void 0,o)]}throw u.PromiseRejectFromIndexDBResultNone;case 2:throw u.PromiseRejectParamError;case 3:return[3,5];case 4:return a=s.sent(),v.j.warn(v.w.Offline,"getClientVarsFromIndexDB fail:".concat(JSON.stringify(a))),[2,new _.x4(new Error("".concat(a)))];case 5:return[2]}}))}))},e.prototype.getDataFromDataBase=function(e){return(0,g.__awaiter)(this,void 0,Promise,(function(){var t,n;return(0,g.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),v.j.info(v.w.Offline,"getDataFromDataBase start"),[4,this.getClientVarsFromIndexDB(e)];case 1:if((t=r.sent()).error)throw t.error;if(t.data)return[2,new _.x4(void 0,t.data)];throw this.updatePadinfo(e),u.PromiseRejectFromIndexDBResultFail;case 2:return n=r.sent(),v.j.info(v.w.Offline,"getDataFromDataBase catch:".concat(n)),[2,new _.x4(new Error("".concat(n)))];case 3:return[2]}}))}))},e.prototype.checkNeedReturn=function(e,t){var n=u.PromiseRejectGetDataFailUnkown;if(t===z.online)if(window.clientVarsOnline=e,e){if("blankpage"!==e.padType)return this.hasResolve=!0,e;if("blankpage"===e.padType){if(this.serverResult=e,!e.clientVars||20!==e.clientVars.type)return this.hasResolve=!0,e;this.getDataFromOnlineFail=!0}}else this.getDataFromOnlineFail=!0,n=u.PromiseRejectFromServerFail;else if(t===z.Local){if(e)return window.getClientVarsCost&&!this.hasResolve&&(window.getClientVarsCost.getClientVarsSource="local"),e;this.getDataFromDataBaseFail=!0,n=u.PromiseRejectFromIndexDBResultNone}if(this.getDataFromDataBaseFail&&this.getDataFromOnlineFail){if(this.serverResult)return this.hasResolve=!0,this.serverResult;n=u.PromiseRejectOnLineAndDataBaseBothFail}return n},e.prototype.getData=function(e){return(0,g.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o,i,a,s=this;return(0,g.__generator)(this,(function(c){switch(c.label){case 0:return t=!1,n=Date.now(),r=Date.now(),o=new Promise((function(n,o){s.getDataFromDataBase(e).then((function(e){var t;return r=Date.now()-r,v.j.info(v.w.Offline,"getDataFromDataBase cost:".concat(r)),$.Y.dbClientVarsCost=r,$.Y.dbHasResult=!!e.data,(t=e.data?s.checkNeedReturn(e.data,z.Local):s.checkNeedReturn(null,z.Local))===u.PromiseRejectOnLineAndDataBaseBothFail?(o(t),new _.x4(new Error("db fail"))):C(t)?new _.x4(new Error("db fail")):(n(t),new _.x4(void 0,t))})).then((function(e){var n,r=t?"online":"database";e.error&&(r="online");var o="data_from_".concat(r);$.Y.clientVarsFrom=r,ne.Logger.info(o),window.clientvarsDataFrom=r,null===(n=window.aegis)||void 0===n||n.reportEvent(o)}))})),i=new Promise((function(r,o){(0,y.re)("prerender")||s.getDataFromOnline(e).then((function(e){var i,a,c;n=Date.now()-n,$.Y.onlineClientVarsCost=n,(c=e.data?s.checkNeedReturn(e.data,z.online):s.checkNeedReturn(null,z.online))===u.PromiseRejectOnLineAndDataBaseBothFail?o(new _.x4(new Error("".concat(c)),e.data)):C(c)||(0===(null===(a=null===(i=null==c?void 0:c.clientVars)||void 0===i?void 0:i.privilegeAttribute)||void 0===a?void 0:a.can_read)&&o(new _.x4(new Error("".concat(u.PromiseRejectBlankPage)),e.data)),r(c)),t=!0}))})),this.onlinePromise=i,i.then((function(e){var t;if("blankpage"===e.padType||!(null==e?void 0:e.privilegeAttribute.can_read)&&!(null===(t=e.clientVars)||void 0===t?void 0:t.privilegeAttribute.can_read))return W(e.clientVars.padId),void(0,K.C)(e.clientVars.padId);s.saveClientVarsFromOnline(e)})),a=new Promise((function(e,t){v.j.info(v.w.Offline,"init timeout promise"),setTimeout((function(){v.j.info(v.w.Offline,"getData timeout"),t(u.PromiseRejectOnLineAndDataBaseBothFail)}),3e4)})),Promise.all([o,i]).then((function(e){var t,n=(0,g.__read)(e,2),r=n[0],o=n[1],i=null===(t=("online"===$.Y.clientVarsFrom?o:r).collab_client_vars.dver)||void 0===t?void 0:t.substr(0,3),a=ne.PerfUtil.getMark("start_init_clientvars"),s=ne.PerfUtil.getMark("clientvars_promise_resolved");$.Y.waitForClientVars=s-a,$.Y.openMode=m.Dl[(0,m.fp)().openMode]||"",$.r.keyPathReady?k.ReportHelper.tdwReport({opername:"quality_doc_melo",module:"preload_data",action:"info",file_type:"1",ver10:i,ver8:JSON.stringify($.Y)}):$.r.onlineAndDBReady=!0})).catch((function(){})),[4,Promise.race([i,o,a])];case 1:return[2,c.sent()]}}))}))},e.prototype.saveClientVarsFromOnline=function(e){var t,n;(null===(t=window.clientVars)||void 0===t?void 0:t.collab_client_vars.isChunked)?null===(n=re.E.fetchChunkPromise)||void 0===n||n.then((function(e){e&&(0,q.w)(window.clientVars,e)})):(0,q.w)(e)},e.prototype.getOnlinePromise=function(){return this.onlinePromise},e.prototype.createDoc=function(e){var t,n,r=(0,y.re)("title"),o=r?decodeURIComponent(r):void 0,i=decodeURIComponent((0,y.re)("globalPadId"));return(0,J.d)({globalPadId:i,secretId:e,dver:null===(n=null===(t=window.App)||void 0===t?void 0:t.GlobalConfig)||void 0===n?void 0:n.globalCodeVersion,title:o})},e}(),le=n(3139),ue="",de=function(e){var t,n=O.X.getInstance().getConfig("runtime.reportCgiMap.zzsReport");t="".concat(n,"?datas=").concat(encodeURIComponent(JSON.stringify(e)),"&t=").concat(Date.now()),"function"==typeof navigator.sendBeacon&&navigator.sendBeacon(t)},pe=function(){function e(e,t){var n=this;this.secretId="",this.padType=l.Doc,this.alreadyHandleClientVarsReject=!1,this.clientVarsRejectHandler=function(e){return(0,g.__awaiter)(n,void 0,void 0,(function(){var t,n,r,o,i,a,s,c,l,d,p,h,f,y,m,b,_,C,S;return(0,g.__generator)(this,(function(g){switch(g.label){case 0:if(this.alreadyHandleClientVarsReject)return[2];switch(this.alreadyHandleClientVarsReject=!0,t=!1,Number(null===(o=null===(r=e.error)||void 0===r?void 0:r.error)||void 0===o?void 0:o.message)||e.error){case u.PromiseRejectBlankPage:return[3,1];case u.PromiseRejectSheet:return[3,3];case u.PromiseRejectSlide:return[3,4]}return[3,5];case 1:return[4,F.F.getInstance().deleteCurrentSnapshotData()];case 2:return g.sent(),P.V.setBlankpageData(u.PromiseRejectBlankPage,e.data),this.discussion.hide(),null===(a=null===(i=null===window||void 0===window?void 0:window.tdocs)||void 0===i?void 0:i.hideDiscussion)||void 0===a||a.call(i),[3,6];case 3:return location.replace(window.multiAccountUtil.getMultiUrl(location.href.replace("/doc/","/sheet/"))),[3,6];case 4:return location.replace(window.multiAccountUtil.getMultiUrl(location.href.replace("/doc/","/slide/"))),[3,6];case 5:return setTimeout((function(){var t;v.j.report("Word_MeloOpenDocGetDataException_".concat(null!==(t=e.error)&&void 0!==t?t:-1))}),3e3),function(){var e=(0,A.pb)();if(L.u.getInstance(e).docRendered=!0,L.u.getInstance(e).docRenderFailed=!0,window.pad&&window.pad.collab&&window.pad.collab&&window.pad.collab.setData){var t=(0,U.cG)();window.pad.collab.setData(t)}B.L.getInstance().hide()}(),window.ShowRefreshAllScreen&&window.ShowRefreshAllScreen(),t=!0,[3,6];case 6:return n=null!==(_=null!==(b=null!==(y=null!==(h=null!==(l=null===(c=null===(s=e.data)||void 0===s?void 0:s.clientVars)||void 0===c?void 0:c.type)&&void 0!==l?l:null===(p=null===(d=e.data)||void 0===d?void 0:d.clientVars)||void 0===p?void 0:p.cgicode)&&void 0!==h?h:null===(f=e.data)||void 0===f?void 0:f.code)&&void 0!==y?y:null===(m=e.error)||void 0===m?void 0:m.message)&&void 0!==b?b:e.error)&&void 0!==_?_:-1,de([["doc","status",ue,t?k.Status007.FAIL:k.Status007.SUCCESS,["",t?n:"","".concat(window.isPublishedURL)]],["doc","status","doc_opendoc_web",t?k.Status007.FAIL:k.Status007.SUCCESS,["","".concat(window.isPublishedURL)]]]),v.j.info(v.w.Launch,"get clientvars fail. ".concat(JSON.stringify(e))),null===(S=null===(C=window.App)||void 0===C?void 0:C.reportDrive)||void 0===S||S.call(C,!1),[2]}}))}))},this.secretId=e,this.padType=t,this.getClientVarsCost=new S(+new Date),window.getClientVarsCost=this.getClientVarsCost,window.getClientVarsCost.getClientVarsSource="online"}var t;return e.prototype.getClientVarsPromise=function(){var e,t=this;if(j.cm){var n=H.r.getInstance();n.initLocalEdit(),e=n.getLocalClientVars(),this.onlinePromise=e}else e=new Promise((function(e,n){function r(t){t.padType||(t.padType=l.AIO);var r=E(t);r?e(r):"blankpage"===t.padType?n({error:u.PromiseRejectBlankPage,data:t}):"sheet"===t.padType?n({error:u.PromiseRejectSheet}):"slide"===t.padType?n({error:u.PromiseRejectSlide}):n({error:u.PromiseRejectDataErr})}if(window.App.GlobalConfig.IsSupportStore){var o=new ce;(0,U.g6)()?r((0,U.cG)()):(0,y.re)("new")?r(o.createDoc(t.secretId)):(o.getData(t.secretId).then((function(e){r(e)})).catch((function(e){n({error:e}),v.j.error(v.w.Launch,"getClientVarsFromgetData fail".concat(JSON.stringify(e),"."))})),t.onlinePromise=o.getOnlinePromise())}else t.onlinePromise=new M(t.secretId).getClientVars().then((function(e){return e.data&&r(e.data),e.data})).catch((function(e){var t=e.error&&Number(e.error.message)||u.PromiseRejectUnkownReason;n({errCode:t})}))}));return e.then((function(e){var n,r=+new Date,o=r-t.getClientVarsCost.getClientVarsStart;window.getClientVarsCost&&(window.getClientVarsCost.getClientVarsCost=o,window.getClientVarsCost.getClientVarsEnd=r),t.getClientVarsCost.getClientVarsCost=o,t.getClientVarsCost.getClientVarsEnd=r,window.clientVars=e,L.u.getInstance(t.secretId).setClientVars(e),v.j.info(v.w.Launch,"get clientvars success, secretId:".concat((0,A.pb)(),", globalPadId:").concat(e.globalPadId,", cost:").concat(o,", rev:").concat(window.clientVars&&window.clientVars.collab_client_vars.rev)),de([["doc","status",ue,k.Status007.SUCCESS]]);var i=null===(n=e.collab_client_vars.dver)||void 0===n?void 0:n.substr(0,3);D.Q.instance.onDverUpdate("".concat(i,".0"));var a=(0,m.fp)(),s=a.openMode,c=a.preloadWebviewCount;k.ReportHelper.tdwReport({opername:"quality_doc_melo",module:"preload",action:"open_mode",file_type:"1",ver5:i,ver11:s,ver12:c}),$.Y.preGetDBDataSuccess=!1})).catch(this.clientVarsRejectHandler),e},e.prototype.getClientVarsOnlinePromise=function(){return this.onlinePromise},(0,g.__decorate)([(0,le.tB)(),(0,g.__metadata)("design:type","function"==typeof(t=void 0!==N.Z&&N.Z)?t:Object)],e.prototype,"discussion",void 0),e}(),he=n(15857),fe=n(28223),ge=n(915),ve=n(92655),ye=n(85007),me=n.n(ye),be=n(81568),_e=n(46016),Ce=function(){function e(){}return e.registerTracer=function(){return(0,g.__awaiter)(this,void 0,void 0,(function(){return(0,g.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(8625).then(n.bind(n,28625))];case 1:return(0,e.sent().registerWebTracerProvider)({serviceName:"doc"}),[2]}}))}))},e.registerRUM=function(){return(0,g.__awaiter)(this,void 0,void 0,(function(){var e,t,r;return(0,g.__generator)(this,(function(o){switch(o.label){case 0:return[4,n.e(8625).then(n.bind(n,28625))];case 1:return e=o.sent(),t=e.registerRUM,r=e.customizeFirstScreen,t({serviceName:"websdk-doc",needManualReportFirstScreen:!0}),window.document.addEventListener(_e.kgn.FIRST_RENDER,(function(){r(Date.now())})),[2]}}))}))},e}();try{null===(ie=null===(oe=window.log)||void 0===oe?void 0:oe.identify)||void 0===ie||ie.call(oe,(0,V.getUid)())}catch(e){null===(ae=window.log)||void 0===ae||ae.warn("log.identify, error:".concat(null==e?void 0:e.message,", ").concat(null==e?void 0:e.stack))}Ce.registerTracer(),he.qO.getInstance().isDrivePreview&&Ce.registerRUM();var Se=location.href,we="pc-preload-header",Ee=function(){return new pe((0,A.pb)(),l.Doc)},xe=Ee();window.ClientVarsPromise=xe.getClientVarsPromise(),window.ClientVarsOnlinePromise=xe.getClientVarsOnlinePromise(),window.ClientVarsPromise.then((function(e){e.originalUrl=Se,k.Defaults.author=e.userId;var t=e.collab_client_vars;t.isChunked||(window.dataInput=Z._.createDataInput(t))})),window.refreshClientVarsPromise=function(){window.clientVarsOnline=void 0,window.openDocXhr=void 0,window.openDocType=void 0,window.clientVarsOnline=void 0;var e=Ee();window.ClientVarsPromise=e.getClientVarsPromise(),window.ClientVarsOnlinePromise=e.getClientVarsOnlinePromise()},b.t.isMobile()&&document.getElementById("mobile-preload-header")?h()("#mobile-preload-header").before(f):!b.t.isMobile()&&document.getElementById(we)?h()("#".concat(we)).before('<div id="app" style="height:100%;position:relative;z-index:2"> <div style="height:100%;display:flex;flex-direction:column"> <div id="workbench" style="flex:1 1 100%;height:calc(100vh)"></div> </div> </div> '):h()(f).prependTo("body");var Te=fe._.getInstance().recordAndStripPerformanceValueFromUrl(location.href);window.history.replaceState(null,"",Te);var Re=new ve.Z;Re.addDetector({name:"userAgent",lookup:function(){var e=navigator.userAgent.match(/language\/([a-zA-Z'-_]+)/i);if(e)return e[1].replace("_","-")}}),Re.addDetector({name:"toggle",lookup:function(){}}),(0,be.Zk)(ge.ZP,me()),ge.ZP.use(Re).init({resources:me(),defaultNS:"legacy",fallbackLng:{default:["zh-CN"],en:["en-US"],zh:["zh-CN"],"zh-TW":["zh-HK"],"en-US":["zh-CN"],"zh-HK":["zh-CN"]},detection:{order:["querystring","toggle","userAgent","cookie"],lookupCookie:"language",lookupQuerystring:"lng",caches:[]}}),null===(se=window.log)||void 0===se||se.info("[Performance] ".concat(window.__isOfflinePkg?"[]":"[]",", ").concat(function(){var e;try{return window.top.globalBoxEnv}catch(t){null===(e=window.log)||void 0===e||e.error("get global box env error.")}return null}()?"[]":"[]"))},32158:function(e,t,n){n.d(t,{rN:function(){return Le},S1:function(){return T},Xo:function(){return Ee},JO:function(){return De},$E:function(){return Se},GE:function(){return ae},qe:function(){return we},gS:function(){return Ie},NE:function(){return ve},b8:function(){return _e},qV:function(){return v},mV:function(){return g},E1:function(){return l},df:function(){return f}});var r=n(85556),o=n(87363),i=n.n(o),a=function(e){var t,n,r,o=new RegExp("(?:^|;+|\\s+)".concat(e,"=([^;]*)")),i=null===(r=null===(n=null===(t=null===window||void 0===window?void 0:window.document)||void 0===t?void 0:t.cookie)||void 0===n?void 0:n.match)||void 0===r?void 0:r.call(n,o);return(i?i[1]:"")||null},s=function(e,t){var n=navigator.userAgent.match(new RegExp(e+"/([\\d\\.]+)","i"));return function(e,t,n){var r=n&&n.lexicographical,o=n&&n.zeroExtend,i=e.split("."),a=t.split(".");if(o){for(;i.length<a.length;)i.push("0");for(;a.length<i.length;)a.push("0")}if(!r){for(var s=0;s<i.length;s++)i[s]=parseInt(i[s],10);for(s=0;s<a.length;s++)a[s]=parseInt(a[s],10)}for(s=0;s<i.length;++s){if(a.length==s)return 1;if(i[s]!=a[s])return i[s]>a[s]?1:-1}return i.length!=a.length?-1:0}(n&&n[1]||"0",t,{zeroExtend:!0})},c=function(){var e;return/(wxwork)/i.test(null===(e=null===window||void 0===window?void 0:window.navigator)||void 0===e?void 0:e.userAgent)},l=function(){var e;return!!(null===(e=null===window||void 0===window?void 0:window.isApiDocURL)||void 0===e?void 0:e.call(window))},u=function(){return!((a("uid")||"").startsWith("14")||a("utype")&&"ww"!==a("utype"))},d=function(){return!!(null===window||void 0===window?void 0:window.isPublishedURL)},p=function(){var e;return/isConversationEmbedded=1/.test((null===(e=null===window||void 0===window?void 0:window.location)||void 0===e?void 0:e.search)||"")},h=function(){var e=a("wedrive_uin");try{var t=localStorage.getItem("".concat(e,"_SCALED_CONFIG"))||"";if(t)return JSON.parse(t).maxCollabLimit}catch(e){console.error(e)}return 500},f=function(e){return"5629501042540346"===e||"13102702706618269"===e},g=function(){var e,t,n,r;return(null===(n=null===(t=null===(e=null===window||void 0===window?void 0:window.basicClientVars)||void 0===e?void 0:e.docInfo)||void 0===t?void 0:t.createInfo)||void 0===n?void 0:n.creatorId)||(null===(r=null===window||void 0===window?void 0:window.clientVars)||void 0===r?void 0:r.creatorId)||""},v=function(){var e,t,n,r,o,i,a,s=(null===(n=null===(t=null===(e=null===window||void 0===window?void 0:window.basicClientVars)||void 0===e?void 0:e.docInfo)||void 0===t?void 0:t.createInfo)||void 0===n?void 0:n.creatorId)||(null===(r=null===window||void 0===window?void 0:window.clientVars)||void 0===r?void 0:r.creatorId)||"";if(f(s))return"";var c=null===(i=null===(o=null===window||void 0===window?void 0:window.basicClientVars)||void 0===o?void 0:o.docInfo)||void 0===i?void 0:i.createInfo;return(null==c?void 0:c.creatorCorpId)&&(null==c?void 0:c.creatorNick)?c.creatorNick:(null===(a=null===window||void 0===window?void 0:window.clientVars)||void 0===a?void 0:a.creatorNick)||""},y=function(){return/meeting_wework/i.test(navigator.userAgent)||"meeting_wework"===a("open_theme_id")},m=function(e){var t=e.style;return i().createElement("div",{style:(0,r.__assign)({marginLeft:5,marginRight:5,height:20,width:1,opacity:.08,backgroundColor:"#000000",marginTop:6,marginBottom:6,verticalAlign:"top",display:"inline-block"},t)})},b=function(){return i().createElement("div",{id:"headerbar-avatar",style:{display:"var(--display,flex)",flexDirection:"row",alignItems:"center"}},i().createElement(m,{style:{height:"12px",marginRight:"1px",marginLeft:"4px"}}),i().createElement("div",{id:"titlebar-avatar",style:{height:28,marginLeft:11,marginRight:8}},i().createElement("div",{className:"headerbar-shins-loading"})))};b.getInitialVars=function(){return{id:"headerbar-avatar",vars:{"--display":c()?"none":"flex"}}};var _=function(){return i().createElement("div",{id:"headerbar-collect",style:{display:"var(--display)"}},i().createElement("div",{id:"titlebar-collect"},i().createElement("span",{className:"titlebar-collect-bg-icon"})))};_.getInitialVars=function(){return{id:"headerbar-collect",vars:{"--display":c()||l()?"none":"flex"}}};var C=n(56757),S={tag:"svg",attrs:{fill:"none",viewBox:"0 0 24 24",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.5 9c0-.28.22-.5.5-.5h6.5a.5.5 0 010 1H9a.5.5 0 01-.5-.5zM9 11.5a.5.5 0 000 1h4a.5.5 0 000-1H9z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4 5.5C4 4.67 4.67 4 5.5 4h13c.83 0 1.5.67 1.5 1.5v10c0 .83-.67 1.5-1.5 1.5h-5.31l-3.53 3.09a.7.7 0 01-1.16-.53V17h-3A1.5 1.5 0 014 15.5v-10zM5.5 5a.5.5 0 00-.5.5v10c0 .28.22.5.5.5h3.3c.39 0 .7.31.7.7v2.2l3.06-2.68a.9.9 0 01.59-.22h5.35a.5.5 0 00.5-.5v-10a.5.5 0 00-.5-.5h-13z",fillRule:"evenodd",clipRule:"evenodd"}}]},w=(0,o.forwardRef)((function(e,t){return(0,o.createElement)(C.A,Object.assign({},e,{id:"tdoc-titlebar-discussion",ref:t,icon:S}))}));w.displayName="TdocTitlebarDiscussion";var E=w,x=n(68808),T=function(e){var t=e.active,n=e.unreadCount,r=e.onClick;return i().createElement("div",{id:"headerbar-discussion",style:{display:"var(--display)"}},i().createElement("div",{id:"titlebar-discussion-button"},i().createElement("div",{className:"headerbar-discussion-wrapper".concat(t?" active":""),onClick:r},i().createElement(E,{className:"discussion-icon",style:{display:"var(--tdoc)"}}),i().createElement(x.Z,{className:"discussion-icon",style:{display:"var(--wecom)"}}),!!n&&i().createElement("p",{className:"discussion-unread"},n))))};T.getInitialVars=function(){return{id:"headerbar-discussion",vars:{"--display":y()?"none":"flex","--wecom":c()?"unset":"none","--tdoc":c()?"none":"unset"}}},T.runAfterHtml=function(){var e,t,n=null===(t=null===(e=document.querySelector("#tdocs-titlebar"))||void 0===e?void 0:e.querySelector)||void 0===t?void 0:t.call(e,"#titlebar-discussion-button");if(n){var r=window;n.onclick=function(){var e,t,n,o;null===(t=null===(e=null==r?void 0:r.discussionExt)||void 0===e?void 0:e.changeTab)||void 0===t||t.call(e,"chat"===(null===(o=null===(n=null==r?void 0:r.discussionExt)||void 0===n?void 0:n.getTab)||void 0===o?void 0:o.call(n))?"none":"chat")}}};var R={tag:"svg",attrs:{fill:"none",viewBox:"0 0 24 24",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.97 4.82a.5.5 0 00-.94 0l-3.66 9.5-1.84 5a.5.5 0 10.94.35L5.18 15h6.64l1.71 4.67a.5.5 0 00.94-.34l-1.83-5-3.67-9.51zM11.44 14H5.56L8.5 6.39 11.44 14z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.5 7a.5.5 0 000 1H20a.5.5 0 000-1h-6.5zM15.5 12a.5.5 0 000 1H20a.5.5 0 000-1h-4.5zM16.5 17.5c0-.28.22-.5.5-.5h3a.5.5 0 010 1h-3a.5.5 0 01-.5-.5z"}}]},I=(0,o.forwardRef)((function(e,t){return(0,o.createElement)(C.A,Object.assign({},e,{id:"tdoc-titlebar-editmenu",ref:t,icon:R}))}));I.displayName="TdocTitlebarEditmenu";var P=I,O={tag:"svg",attrs:{fill:"none",viewBox:"0 0 24 24",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.97 4.82a.5.5 0 00-.94 0l-3.66 9.5-1.84 5a.5.5 0 10.94.35L5.18 15h6.64l1.71 4.67a.5.5 0 00.94-.34l-1.83-5-3.67-9.51zM11.44 14H5.56L8.5 6.39 11.44 14z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.5 7a.5.5 0 000 1H20a.5.5 0 000-1h-6.5zM15.5 12a.5.5 0 000 1H20a.5.5 0 000-1h-4.5zM16.5 17.5c0-.28.22-.5.5-.5h3a.5.5 0 010 1h-3a.5.5 0 01-.5-.5z"}}]},k=(0,o.forwardRef)((function(e,t){return(0,o.createElement)(C.A,Object.assign({},e,{id:"wecom-titlebar-editmenu",ref:t,icon:O}))}));k.displayName="WecomTitlebarEditmenu";var D=k,M=function(e){var t=e.style;return i().createElement("div",{id:"headerbar-editmenu",style:(0,r.__assign)({display:"var(--display)"},t)},i().createElement("div",{className:"docs-headerbar-icon28"},i().createElement(P,{style:{display:"var(--tdoc)"}}),i().createElement(D,{style:{display:"var(--wecom)"}})))},A={marginLeft:"6px",marginRight:"6px"};M.getInitialVars=function(){return{id:"headerbar-editmenu",vars:{"--display":c()||l()?"none":"flex","--wecom":c()?"unset":"none","--tdoc":c()?"none":"unset"}}};var L={tag:"svg",attrs:{fill:"none",viewBox:"0 0 24 24",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.5 6.5c0-.28.22-.5.5-.5h14a.5.5 0 010 1H5a.5.5 0 01-.5-.5zm0 6c0-.28.22-.5.5-.5h14a.5.5 0 010 1H5a.5.5 0 01-.5-.5zM5 18a.5.5 0 000 1h14a.5.5 0 000-1H5z",fillRule:"evenodd",clipRule:"evenodd"}}]},N=(0,o.forwardRef)((function(e,t){return(0,o.createElement)(C.A,Object.assign({},e,{id:"tdoc-titlebar-menu",ref:t,icon:L}))}));N.displayName="TdocTitlebarMenu";var B=N,F={tag:"svg",attrs:{fill:"none",viewBox:"0 0 24 24",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.5 6.5c0-.28.22-.5.5-.5h14a.5.5 0 010 1H5a.5.5 0 01-.5-.5zm0 6c0-.28.22-.5.5-.5h14a.5.5 0 010 1H5a.5.5 0 01-.5-.5zM5 18a.5.5 0 000 1h14a.5.5 0 000-1H5z",fillRule:"evenodd",clipRule:"evenodd"}}]},U=(0,o.forwardRef)((function(e,t){return(0,o.createElement)(C.A,Object.assign({},e,{id:"wecom-titlebar-menu",ref:t,icon:F}))}));U.displayName="WecomTitlebarMenu";var H=U,j=function(e){var t=e.style;return i().createElement("div",{id:"headerbar-filemenu",style:(0,r.__assign)({display:"var(--display)"},t)},i().createElement("div",{className:"docs-headerbar-icon28"},i().createElement(B,{style:{display:"var(--tdoc)"}}),i().createElement(H,{style:{display:"var(--wecom)"}})))},G={marginLeft:"6px",marginRight:"6px"};j.getInitialVars=function(){return{id:"headerbar-filemenu",vars:{"--display":d()?"none":"flex","--wecom":c()?"unset":"none","--tdoc":c()?"none":"unset"}}};var V=function(e){return i().createElement("div",{id:"headerbar-home",style:{display:"var(--display)"}},i().createElement("div",{id:"titlebar-mini-list-wrapper"},i().createElement("div",{id:"titlebar-mini-list",className:"titlebar-mini-list"},i().createElement("div",{className:"homeBar-container-wrapper"},i().createElement("div",{className:"homeBar-container"},i().createElement("div",{className:"tabbar-home-sel",onClick:e.onHomeTrigger}),i().createElement("div",{className:"mini-list-dropdown-btn",onMouseOver:e.onDropdownTrigger,onClick:e.onDropdownTrigger},i().createElement("span",{className:"arrow-fill-down"}))))),!(null==e?void 0:e.hideDivider)&&i().createElement("div",{className:"titlebar-mini-list-divider"})))};V.getInitialVars=function(){return{id:"headerbar-home",vars:{"--display":s("wxwork","4.0.12")>=0||p()?"none":"flex"}}};var W={tag:"svg",attrs:{fill:"none",viewBox:"0 0 24 24",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.18 13.6C4.02 9.23 7.67 6 12 6s7.98 3.24 8.82 7.6a.5.5 0 00.98-.2C20.88 8.64 16.86 5 12 5s-8.88 3.63-9.8 8.4a.5.5 0 00.98.2z"}},{tag:"path",attrs:{fill:"currentColor",d:"M12 9a5 5 0 100 10 5 5 0 000-10zm-4 5a4 4 0 118 0 4 4 0 01-8 0z",fillRule:"evenodd",clipRule:"evenodd"}}]},z=(0,o.forwardRef)((function(e,t){return(0,o.createElement)(C.A,Object.assign({},e,{id:"wecom-titlebar-watching",ref:t,icon:W}))}));z.displayName="WecomTitlebarWatching";var K=z,q={tag:"svg",attrs:{fill:"none",viewBox:"0 0 24 24",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7 7.5a3.5 3.5 0 117 0v1.46c0 1.11-.38 2.19-1.07 3.05a1.9 1.9 0 00.62 2.89l.45.23v1.12l-.9-.46a2.9 2.9 0 01-.95-4.4c.55-.69.85-1.54.85-2.43V7.5a2.5 2.5 0 00-5 0v1.45c0 .89.3 1.75.87 2.44a2.9 2.9 0 01-.93 4.4l-4.55 2.32a.72.72 0 00-.39.64V19h13v1H2.95a.95.95 0 01-.95-.95v-.3c0-.65.36-1.24.94-1.54l4.54-2.31a1.9 1.9 0 00.61-2.88A4.86 4.86 0 017 8.95V7.5z"}},{tag:"path",attrs:{fill:"currentColor",d:"M18 13.5a.5.5 0 011 0V16h2.5a.5.5 0 010 1H19v2.5a.5.5 0 01-1 0V17h-2.5a.5.5 0 010-1H18v-2.5z"}}]},Y=(0,o.forwardRef)((function(e,t){return(0,o.createElement)(C.A,Object.assign({},e,{id:"tdoc-titlebar-addmember",ref:t,icon:q}))}));Y.displayName="TdocTitlebarAddmember";var Q=Y,Z={tag:"svg",attrs:{fill:"none",viewBox:"0 0 24 24",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7 7.5a3.5 3.5 0 117 0v1.46c0 1.11-.38 2.19-1.07 3.05a1.9 1.9 0 00.62 2.89l.45.23v1.12l-.9-.46a2.9 2.9 0 01-.95-4.4c.55-.69.85-1.54.85-2.43V7.5a2.5 2.5 0 00-5 0v1.45c0 .89.3 1.75.87 2.44a2.9 2.9 0 01-.93 4.4l-4.55 2.32a.72.72 0 00-.39.64V19h13v1H2.95a.95.95 0 01-.95-.95v-.3c0-.65.36-1.24.94-1.54l4.54-2.31a1.9 1.9 0 00.61-2.88A4.86 4.86 0 017 8.95V7.5z"}},{tag:"path",attrs:{fill:"currentColor",d:"M18 13.5a.5.5 0 011 0V16h2.5a.5.5 0 010 1H19v2.5a.5.5 0 01-1 0V17h-2.5a.5.5 0 010-1H18v-2.5z"}}]},X=(0,o.forwardRef)((function(e,t){return(0,o.createElement)(C.A,Object.assign({},e,{id:"wecom-titlebar-addmember",ref:t,icon:Z}))}));X.displayName="WecomTitlebarAddmember";var J=X,$={tag:"svg",attrs:{fill:"none",viewBox:"0 0 24 24",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.08 4.96A3.38 3.38 0 019.5 4c.86 0 1.74.29 2.42.96A4.15 4.15 0 0113 8v1c0 1.34-.59 2.37-1.3 3.3-.08.1-.2.39-.22.78-.02.38.04.79.25 1.12.19.32.57.6 1.25.94l.9.43.24.12c.43.2.9.43 1.4.7.42.21.83.43 1.23.66.3.17.55.34.74.52.2.19.35.4.42.65.08.24.1.49.1.74v.03c0 .13 0 .48-.27.73-.13.13-.3.2-.47.23-.16.04-.35.05-.57.05H2.3c-.22 0-.41-.01-.57-.05a.98.98 0 01-.47-.23c-.27-.25-.26-.6-.26-.73v-.03c0-.25.01-.5.09-.74.08-.26.22-.46.42-.65.19-.18.44-.35.74-.52a34.72 34.72 0 012.63-1.36l.24-.12.9-.43c.68-.35 1.06-.62 1.25-.94.2-.33.27-.74.25-1.12a1.6 1.6 0 00-.22-.78A5.31 5.31 0 016 9V8c0-1.35.4-2.37 1.08-3.04zm.71.7C7.34 6.13 7 6.87 7 8v1c0 1.02.43 1.83 1.1 2.7.23.3.39.8.42 1.32.03.53-.06 1.15-.4 1.7a3.9 3.9 0 01-1.65 1.31c-.28.15-.6.3-.93.45l-.23.11c-.43.2-.88.42-1.37.68l-1.19.64a3.2 3.2 0 00-.56.39.48.48 0 00-.15.22 1.54 1.54 0 00-.04.46l.3.02h14.4c.14 0 .24 0 .3-.02v-.02c0-.23-.01-.36-.04-.44a.48.48 0 00-.15-.22 3.2 3.2 0 00-.56-.39l-1.19-.64a33.6 33.6 0 00-1.37-.68l-.23-.1c-.33-.17-.65-.31-.93-.46a3.9 3.9 0 01-1.66-1.3 2.95 2.95 0 01-.39-1.7c.03-.52.19-1.02.42-1.33A4.33 4.33 0 0012 9V8c0-1.15-.34-1.88-.8-2.33A2.38 2.38 0 009.5 5c-.64 0-1.26.21-1.7.67z"}},{tag:"path",attrs:{fill:"currentColor",d:"M14.6 8.74A2.68 2.68 0 0116.5 8c.67 0 1.36.22 1.9.74.53.52.85 1.3.85 2.33v.73c0 1.03-.47 1.82-1 2.5-.04.05-.13.23-.14.5-.02.26.03.53.16.74.12.2.38.39.9.64l.66.32.18.08c.32.15.68.32 1.06.52l.05.02.87.47c.23.12.43.25.58.4.17.14.29.32.36.53a1.91 1.91 0 01.07.6c0 .1 0 .41-.24.64a.87.87 0 01-.4.2c-.14.03-.3.04-.46.04h-2.87v-1H22c0-.1-.02-.15-.03-.18 0-.02-.02-.05-.07-.1a2.28 2.28 0 00-.4-.27 27.7 27.7 0 00-.85-.45l-.04-.01a25.34 25.34 0 00-1.2-.58l-.7-.33c-.5-.26-1-.55-1.29-1.01a2.26 2.26 0 01-.31-1.33c.02-.4.14-.8.34-1.05.5-.63.8-1.19.8-1.89v-.73c0-.81-.25-1.32-.55-1.62-.32-.3-.75-.45-1.2-.45-.46 0-.89.15-1.2.45-.3.3-.55.8-.55 1.62v.73c0 .7.3 1.26.8 1.9.16.2.26.5.31.8.05.32.05.68-.06 1.05l-.96-.28c.06-.2.06-.42.03-.6a.89.89 0 00-.12-.36c-.54-.7-1-1.48-1-2.51v-.73c0-1.03.32-1.8.85-2.33z"}}]},ee=(0,o.forwardRef)((function(e,t){return(0,o.createElement)(C.A,Object.assign({},e,{id:"tdoc-titlebar-members",ref:t,icon:$}))}));ee.displayName="TdocTitlebarMembers";var te=ee,ne={tag:"svg",attrs:{fill:"none",viewBox:"0 0 24 24",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.08 4.96A3.38 3.38 0 019.5 4c.86 0 1.74.29 2.42.96A4.15 4.15 0 0113 8v1c0 1.34-.59 2.37-1.3 3.3-.08.1-.2.39-.22.78-.02.38.04.79.25 1.12.19.32.57.6 1.25.94l.9.43.24.12c.43.2.9.43 1.4.7.42.21.83.43 1.23.66.3.17.55.34.74.52.2.19.35.4.42.65.08.24.1.49.1.74v.03c0 .13 0 .48-.27.73-.13.13-.3.2-.47.23-.16.04-.35.05-.57.05H2.3c-.22 0-.41-.01-.57-.05a.98.98 0 01-.47-.23c-.27-.25-.26-.6-.26-.73v-.03c0-.25.01-.5.09-.74.08-.26.22-.46.42-.65.19-.18.44-.35.74-.52a34.72 34.72 0 012.63-1.36l.24-.12.9-.43c.68-.35 1.06-.62 1.25-.94.2-.33.27-.74.25-1.12a1.6 1.6 0 00-.22-.78A5.31 5.31 0 016 9V8c0-1.35.4-2.37 1.08-3.04zm.71.7C7.34 6.13 7 6.87 7 8v1c0 1.02.43 1.83 1.1 2.7.23.3.39.8.42 1.32.03.53-.06 1.15-.4 1.7a3.9 3.9 0 01-1.65 1.31c-.28.15-.6.3-.93.45l-.23.11c-.43.2-.88.42-1.37.68l-1.19.64a3.2 3.2 0 00-.56.39.48.48 0 00-.15.22 1.54 1.54 0 00-.04.46l.3.02h14.4c.14 0 .24 0 .3-.02v-.02c0-.23-.01-.36-.04-.44a.48.48 0 00-.15-.22 3.2 3.2 0 00-.56-.39l-1.19-.64a33.6 33.6 0 00-1.37-.68l-.23-.1c-.33-.17-.65-.31-.93-.46a3.9 3.9 0 01-1.66-1.3 2.95 2.95 0 01-.39-1.7c.03-.52.19-1.02.42-1.33A4.33 4.33 0 0012 9V8c0-1.15-.34-1.88-.8-2.33A2.38 2.38 0 009.5 5c-.64 0-1.26.21-1.7.67z"}},{tag:"path",attrs:{fill:"currentColor",d:"M14.6 8.74A2.68 2.68 0 0116.5 8c.67 0 1.36.22 1.9.74.53.52.85 1.3.85 2.33v.73c0 1.03-.47 1.82-1 2.5-.04.05-.13.23-.14.5-.02.26.03.53.16.74.12.2.38.39.9.64l.66.32.18.08c.32.15.68.32 1.06.52l.05.02.87.47c.23.12.43.25.58.4.17.14.29.32.36.53a1.91 1.91 0 01.07.6c0 .1 0 .41-.24.64a.87.87 0 01-.4.2c-.14.03-.3.04-.46.04h-2.87v-1H22c0-.1-.02-.15-.03-.18 0-.02-.02-.05-.07-.1a2.28 2.28 0 00-.4-.27 27.7 27.7 0 00-.85-.45l-.04-.01a25.34 25.34 0 00-1.2-.58l-.7-.33c-.5-.26-1-.55-1.29-1.01a2.26 2.26 0 01-.31-1.33c.02-.4.14-.8.34-1.05.5-.63.8-1.19.8-1.89v-.73c0-.81-.25-1.32-.55-1.62-.32-.3-.75-.45-1.2-.45-.46 0-.89.15-1.2.45-.3.3-.55.8-.55 1.62v.73c0 .7.3 1.26.8 1.9.16.2.26.5.31.8.05.32.05.68-.06 1.05l-.96-.28c.06-.2.06-.42.03-.6a.89.89 0 00-.12-.36c-.54-.7-1-1.48-1-2.51v-.73c0-1.03.32-1.8.85-2.33z"}}]},re=(0,o.forwardRef)((function(e,t){return(0,o.createElement)(C.A,Object.assign({},e,{id:"wecom-titlebar-members",ref:t,icon:ne}))}));re.displayName="WecomTitlebarMembers";var oe=re,ie=function(e,t){return{"--headerbareye":u()?"none":"block","--headerbarcollabcount":'"'.concat(e<=1?"":e>t?"":e,'"'),"--headerbarcollabiconadd":u()&&e<=1?"block":"none","--headerbarcollabiconmembers":u()&&e>1?"block":"none"}},ae=function(e){var t={};return void 0!==(null==e?void 0:e.collabCount)&&void 0!==(null==e?void 0:e.limit)&&(t=ie(e.collabCount,e.limit)),i().createElement("div",{id:"headerbar-member",style:(0,r.__assign)({display:"var(--display)"},t)},i().createElement("div",{id:"titlebar-collab-status",className:"ent-collab-users-container"},i().createElement("div",{className:"ent-collab-users".concat((null==e?void 0:e.isActive)?" active":""),onClick:null==e?void 0:e.onClick},i().createElement("div",{className:"ent-collab-icon-wrapper",style:{display:"var(--headerbareye)"}},i().createElement(K,{className:"ent-collab-icon"})),i().createElement("div",{className:"ent-collab-icon-wrapper",style:{display:"var(--headerbarcollabiconadd)"}},i().createElement(Q,{className:"ent-collab-icon",style:{display:"var(--tdoc)"}}),i().createElement(J,{className:"ent-collab-icon",style:{display:"var(--wecom)"}})),i().createElement("div",{className:"ent-collab-icon-wrapper",style:{display:"var(--headerbarcollabiconmembers)"}},i().createElement(te,{className:"ent-collab-icon",style:{display:"var(--tdoc)"}}),i().createElement(oe,{className:"ent-collab-icon",style:{display:"var(--wecom)"}})),i().createElement("div",{className:"user-length-wrap"},i().createElement("span",{className:"user-length"})))))},se=function(){if(window.location.pathname.indexOf("txdoc/")>=0||"home"===window.location.pathname.split("/")[1])return e=null,(t=window.location.search)&&(e=t.match(/(\\?|&)(docid|docId)=([^&]*)(&|$)/)),e?decodeURIComponent(e[3]):"";var e,t,n=window.location.href.split("?")[0].split("/");return n[n.length-1]};ae.getInitialVars=function(){return{id:"headerbar-member",vars:(0,r.__assign)({"--display":l()?"none":"flex","--wecom":c()?"unset":"none","--tdoc":c()?"none":"unset"},ie(u()?parseInt((null===(e=null===localStorage||void 0===localStorage?void 0:localStorage.getItem)||void 0===e?void 0:e.call(localStorage,"".concat(se(),"_COLLAB_COUNT")))||"0"):0,u()?h():9999))};var e},ae.runAfterHtml=function(){var e,t,n=null===(t=null===(e=document.querySelector("#tdocs-titlebar"))||void 0===e?void 0:e.querySelector)||void 0===t?void 0:t.call(e,"#titlebar-collab-status");if(n){var r=window;n.onclick=function(){var e,t,n,o,i=function(){if(window.location.pathname.indexOf("txdoc/")>=0||"home"===window.location.pathname.split("/")[1])return e=null,(t=window.location.search)&&(e=t.match(/(\\?|&)(docid|docId)=([^&]*)(&|$)/)),e?decodeURIComponent(e[3]):"";var e,t,n=window.location.href.split("?")[0].split("/");return n[n.length-1]},a=function(e){var t,n,r,o=new RegExp("(?:^|;+|\\s+)".concat(e,"=([^;]*)")),i=null===(r=null===(n=null===(t=null===window||void 0===window?void 0:window.document)||void 0===t?void 0:t.cookie)||void 0===n?void 0:n.match)||void 0===r?void 0:r.call(n,o);return(i?i[1]:"")||null},s=function(){var e;return parseInt((null===(e=null===localStorage||void 0===localStorage?void 0:localStorage.getItem)||void 0===e?void 0:e.call(localStorage,"".concat(i(),"_COLLAB_COUNT")))||"0")}();(s>1||a("utype")&&"ww"!==a("utype"))&&(null===(t=null===(e=null==r?void 0:r.discussionExt)||void 0===e?void 0:e.changeTab)||void 0===t||t.call(e,"member"===(null===(o=null===(n=null==r?void 0:r.discussionExt)||void 0===n?void 0:n.getTab)||void 0===o?void 0:o.call(n))?"none":"member"))}}};var ce=function(){return i().createElement("div",{id:"headerbar-movefile",style:{display:"var(--display)"}},i().createElement("div",{id:"titlebar-move-file",key:"tdocs-move-file"},i().createElement("span",{className:"titlebar-move-file-bg-icon"})))};ce.getInitialVars=function(){return{id:"headerbar-movefile",vars:{"--display":c()||!u()||y()||l()?"none":"flex"}}};var le=function(){return i().createElement("div",{style:{flex:1}})},ue={tag:"svg",attrs:{fill:"none",viewBox:"0 0 24 24",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12.03 4.32a.75.75 0 00-1.06 0L7.65 7.65a.5.5 0 10.7.7L11 5.71v7.79a.5.5 0 001 0V5.7l2.65 2.65a.5.5 0 00.7-.7l-3.32-3.33z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.5 11c.28 0 .5.22.5.5V18a1 1 0 001 1h11a1 1 0 001-1v-6.5a.5.5 0 011 0V18a2 2 0 01-2 2H6a2 2 0 01-2-2v-6.5c0-.28.22-.5.5-.5z"}}]},de=(0,o.forwardRef)((function(e,t){return(0,o.createElement)(C.A,Object.assign({},e,{id:"wecom-titlebar-forward",ref:t,icon:ue}))}));de.displayName="WecomTitlebarForward";var pe=de,he={tag:"svg",attrs:{fill:"none",viewBox:"0 0 24 24",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12.03 4.32a.75.75 0 00-1.06 0L7.65 7.65a.5.5 0 10.7.7L11 5.71v7.79a.5.5 0 001 0V5.7l2.65 2.65a.5.5 0 00.7-.7l-3.32-3.33z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.5 11c.28 0 .5.22.5.5V18a1 1 0 001 1h11a1 1 0 001-1v-6.5a.5.5 0 011 0V18a2 2 0 01-2 2H6a2 2 0 01-2-2v-6.5c0-.28.22-.5.5-.5z"}}]},fe=(0,o.forwardRef)((function(e,t){return(0,o.createElement)(C.A,Object.assign({},e,{id:"tdoc-titlebar-forward",ref:t,icon:he}))}));fe.displayName="TdocTitlebarForward";var ge=fe,ve=function(e){return i().createElement("div",{id:"headerbar-share",className:(null==e?void 0:e.disabled)?"disabled":"",style:{display:"var(--display)"}},i().createElement("div",{id:"titlebar-share-button"},i().createElement("div",{className:"docs-headerbar-icon28-hover",onClick:null==e?void 0:e.onClick,style:{margin:"0 6px",opacity:(null==e?void 0:e.disabled)?.3:1}},i().createElement(pe,{style:{display:"var(--wecom)"}}),i().createElement(ge,{style:{display:"var(--tdoc)"}}))))};ve.getInitialVars=function(){return{id:"headerbar-share",vars:{"--display":d()||c()&&s("wxwork","4.0.18")<0?"none":"flex","--wecom":c()?"unset":"none","--tdoc":c()?"none":"unset"}}};var ye={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.82 2.56c.13.1.22.27.22.44v10.5a.54.54 0 01-.7.5l-7.17-2.29-2.26 2.64a.54.54 0 01-.95-.35v-3.32l-1.62-.52a.54.54 0 01-.38-.5V6.71c0-.23.16-.44.38-.5l12-3.74a.54.54 0 01.48.08zM2.04 7.12v2.14l1.62.52c.23.07.38.28.38.51v2.26l1.55-1.8a.54.54 0 01.57-.17l6.8 2.18V3.72L2.04 7.12z",fillRule:"evenodd",clipRule:"evenodd"}}]},me=(0,o.forwardRef)((function(e,t){return(0,o.createElement)(C.A,Object.assign({},e,{id:"loudspeaker-16",ref:t,icon:ye}))}));me.displayName="Loudspeaker16";var be=me,_e=function(e){return i().createElement("div",{id:"subscription-notification",style:{display:(null==e?void 0:e.display)||"var(--display)","--headerbarsubscriptiontitle":(null==e?void 0:e.text)?'"'.concat(e.text,'"'):void 0}},i().createElement("div",{className:"subscription-container ".concat(e.disabled?"disabled":""),style:{marginLeft:12}},i().createElement("div",{className:"subscription-icon-wrapper"},i().createElement(be,{style:{fontSize:"16px",color:e.active?"#1E6FFF":e.disabled?"rgba(9, 16, 26, .4)":"#0b121a99"}})),i().createElement("div",{className:"subscription-text-wrapper"},i().createElement("span",{className:"notification-text",style:{color:e.active?"#1E6FFF":e.disabled?"rgba(9, 16, 26, .4)":"#0b121a99"}},i().createElement("span",{className:"notification-move-animation"})))))};_e.getInitialVars=function(){return{id:"subscription-notification",vars:{"--display":!u()||y()||l()?"none":"flex","--headerbarsubscriptionicon1":"flex","--headerbarsubscriptionicon2":"none","--headerbarsubscriptiontitle":'""'}}};var Ce=function(e){return i().createElement("input",{ref:null==e?void 0:e.inputRef,id:"melo-doc-title",className:"melo-doc-title".concat(e.canEditTitle?"":" melo-doc-title-readonly"),style:(0,r.__assign)({width:null==e?void 0:e.titleWidth,maxWidth:(null==e?void 0:e.maxWidth)||"100%",color:"#000000",boxSizing:"border-box"},null==e?void 0:e.style),autoComplete:"off",value:e.title,onFocus:null==e?void 0:e.onFocus,onChange:null==e?void 0:e.onChange,onCompositionStart:null==e?void 0:e.onCompositionStart,onCompositionUpdate:null==e?void 0:e.onCompositionUpdate,onCompositionEnd:null==e?void 0:e.onCompositionEnd,onMouseOver:null==e?void 0:e.onMouseOver,onMouseOut:null==e?void 0:e.onMouseOut,onBlur:null==e?void 0:e.onBlur,onKeyPress:function(e){"Enter"===e.key&&e.currentTarget.blur()},disabled:!e.canEditTitle})};Ce.getInitialVars=function(){var e=document.createElement("div");return e.id="text-measure-ent",e.className="melo-doc-title",document.body.appendChild(e),{id:"melo-doc-title",vars:{}}},Ce.runAfterHtml=function(){var e,t,n,r,o,i=(null===(n=null===(t=null===(e=null===window||void 0===window?void 0:window.basicClientVars)||void 0===e?void 0:e.docInfo)||void 0===t?void 0:t.padInfo)||void 0===n?void 0:n.padTitle)||"";document.title=i;var a=null===(o=null===(r=document.querySelector("#tdocs-titlebar"))||void 0===r?void 0:r.querySelector)||void 0===o?void 0:o.call(r,"#melo-doc-title");a&&(a.value=i,a.style.width="".concat(function(e){var t=document.getElementById("text-measure-ent");if(!t)return 18*e.length+2;var n=e;t.innerText=n;var r=Math.ceil(t.clientWidth)+5;return t.innerText="",r}(i),"px"))};var Se=function(e){var t=e.title,n=e.isShow;return i().createElement("div",{id:"titlebar-external"},i().createElement("div",{className:"external-tag",style:{display:n?"flex":"var(--display)","--title":t?'"'.concat(t,'"'):void 0}}))};Se.getInitialVars=function(){return{id:"titlebar-external",vars:{"--display":/isExternalDoc=1/.test((null===(e=null===window||void 0===window?void 0:window.location)||void 0===e?void 0:e.search)||"")&&!l()?"flex":"none","--title":u()?'""':'""'}};var e};var we=function(e){return i().createElement("div",{id:"titlebar-readonly-tips"},i().createElement("div",{onMouseOver:null==e?void 0:e.handleMouseOver,onMouseOut:null==e?void 0:e.handleMouseOut,style:{display:(null==e?void 0:e.visible)?"flex":"var(--display)"}},i().createElement("button",{className:"readonly-tip-btn"},i().createElement("div",{className:"titlebar-readonly-tips-text"},i().createElement("span",null,(null==e?void 0:e.text)||"",i().createElement("span",{className:"titlebar-readonly-tips-icon"}," "))))))};we.getInitialVars=function(){return{id:"titlebar-readonly-tips",vars:{"--display":"home"===(null===(n=null===(t=null===(e=null===location||void 0===location?void 0:location.pathname)||void 0===e?void 0:e.split)||void 0===t?void 0:t.call(e,"/"))||void 0===n?void 0:n[1])||!(null===window||void 0===window?void 0:window.basicClientVars)||(null===(i=null===(o=null===(r=null===window||void 0===window?void 0:window.basicClientVars)||void 0===r?void 0:r.authInfo)||void 0===o?void 0:o.attribute)||void 0===i?void 0:i.canEdit)||l()?"none":"flex"}};var e,t,n,r,o,i};var Ee=function(e){var t=e.isShow,n=e.style;return i().createElement("div",{id:"headerbar-divider",style:(0,r.__assign)({display:t?"flex":"none"},n)})},xe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 24 24",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.5 5a.5.5 0 000 1h13a.5.5 0 000-1h-13zM5.5 11a.5.5 0 000 1h4a.5.5 0 000-1h-4zM5.5 17a.5.5 0 000 1h6a.5.5 0 000-1h-6z"}},{tag:"path",attrs:{fill:"currentColor",d:"M15.07 15.97a3.5 3.5 0 10.86-6.94 3.5 3.5 0 00-.86 6.94zm.13-.99a2.5 2.5 0 10.6-4.96 2.5 2.5 0 00-.6 4.96z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M17.24 15.54l2.22 2.84a.5.5 0 10.79-.62l-2.22-2.84c-.23.24-.5.45-.79.62z"}}]},Te=(0,o.forwardRef)((function(e,t){return(0,o.createElement)(C.A,Object.assign({},e,{id:"wecom-titlebar-find",ref:t,icon:xe}))}));Te.displayName="WecomTitlebarFind";var Re=Te,Ie=function(e){var t=e.onClick,n=e.style;return i().createElement("div",{id:"headerbar-search",style:n},i().createElement("div",{id:"titlebar-search-button"},i().createElement("div",{className:"docs-headerbar-icon28-hover",onClick:t,style:{margin:"0"}},i().createElement(Re,null))))},Pe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 10 10",width:"1em",height:"1em"},children:[{tag:"g",attrs:{clipPath:"url(#caret-down-10_clip0_581_209680)"},children:[{tag:"path",attrs:{stroke:"currentColor",d:"M9 3L5.18 6.82c-.1.1-.26.1-.36 0L1 3",strokeLinecap:"round",strokeWidth:1.25}}]},{tag:"defs",attrs:{},children:[{tag:"clipPath",attrs:{id:"caret-down-10_clip0_581_209680"},children:[{tag:"path",attrs:{fill:"#fff",d:"M0 0h10v10H0z"}}]}]}],defIds:["caret-down-10_clip0_581_209680"]},Oe=(0,o.forwardRef)((function(e,t){return(0,o.createElement)(C.A,Object.assign({},e,{id:"caret-down-10",ref:t,icon:Pe}))}));Oe.displayName="CaretDown10";var ke=Oe,De=function(e){var t=e.onClick,n=e.active,r=e.style;return i().createElement("div",{id:"headerbar-dropdown",style:r},i().createElement("div",{id:"titlebar-dropdown-button",className:n?"dropdown-button-active":""},i().createElement(ke,{onClick:t})))},Me=function(e){var t=e.visible,n=void 0===t||t,o=e.style;return n?i().createElement("div",{id:"headerbar-apidoc-buttongroup",style:(0,r.__assign)({display:"var(--display)"},o)},i().createElement("div",{id:"titlebar-apidoc-buttongroup"},i().createElement(Ie,null),i().createElement(De,null),i().createElement(Ee,{isShow:!0}))):null};Me.getInitialVars=function(){return{id:"headerbar-apidoc-buttongroup",vars:{"--display":l()?"flex":"none"}}};var Ae=function(e){return e?e.replace(/"/g,'\\"'):""},Le=function(e){var t=e.creatorName,n=e.text,r=e.onClick,o=e.visible,a=e.disabled;return i().createElement("div",{id:"titlebar-creator-name"},i().createElement("div",{className:"titlebar-creator-name-wrapper",style:{display:o?"flex":"var(--display)"}},i().createElement("span",{className:"titlebar-creator-name-btn ".concat(a?"disabled":""),onClick:r,style:{"--creatorname":t?'"'.concat(Ae(t),'"'):void 0}}),i().createElement("span",{className:"titlebar-creator-name-text"},n||"")))};Le.getInitialVars=function(){return{id:"titlebar-creator-name",vars:{"--display":l()&&v()?"flex":"none","--creatorname":v()?'"'.concat(Ae(v()),'"'):'""'}}};var Ne=function(){return i().createElement("div",{id:"tdocs-titlebar",className:"docs-headerbar-wrapper"},i().createElement(V,null),i().createElement(Ce,{title:"",maxWidth:"570px"}),i().createElement(Le,null),i().createElement(Se,null),i().createElement(we,null),i().createElement(_,null),i().createElement(ce,null),i().createElement(_e,null),i().createElement(le,null),i().createElement(Me,null),i().createElement(ae,null),i().createElement(ve,null),i().createElement(T,null),i().createElement(j,{style:(0,r.__assign)({},G)}),i().createElement(M,{style:A}),i().createElement(b,null))};Ne.getInitialVars=function(){return{id:"tdocs-titlebar",vars:{"--headerbarmargintop":"0px","--headerbarheight":"".concat(p()?l()?52:45:56,"px"),"--headerbarpadding":p()&&!l()?"12px 6px 4px 12px":"0px 8px 0px 12px","--headerbarbordercolor":p()&&!l()?"transparent":"rgba(0, 0, 0, 0.04)"}}}},67921:function(){},83529:function(){},64261:function(){},49790:function(e,t,n){n.r(t),n.d(t,{ACCOUNT_TYPE:function(){return v},BIND_TYPE:function(){return m},BaseChangeModel:function(){return R},DB_NAME:function(){return _},DB_NAME_TESTENV:function(){return C},DOCUMENT_DATA_TYPE:function(){return p},DOCUMENT_POLICY:function(){return c},DOCUMENT_STATUS:function(){return l},DOCUMENT_TYPE:function(){return i},DOCUMENT_TYPE_DESC:function(){return a},DOCUMENT_TYPE_DESC_MAP:function(){return f},DOCUMENT_TYPE_MAP:function(){return h},DocumentData:function(){return D},DocumentEntity:function(){return k},DocumentId:function(){return P},DocumentStatus:function(){return O},LIST_INFO_TYPE:function(){return u},LIST_TYPE:function(){return d},OfflineData:function(){return M},PadInfo:function(){return I},TABLE_NAME:function(){return g},UserInfo:function(){return A},VipType:function(){return b}});var r,o,i,a,s=n(53581);!function(e){e[e.unknown=-1]="unknown",e[e.doc=0]="doc",e[e.sheet=1]="sheet",e[e.slide=4]="slide",e[e.smartSheet=5]="smartSheet",e[e.smartCanvas=6]="smartCanvas",e[e.flowchart=7]="flowchart",e[e.mind=8]="mind",e[e.pdf=9]="pdf"}(i||(i={})),function(e){e.doc="doc",e.sheet="sheet",e.form="form",e.slide="slide",e.smartSheet="smartSheet",e.smartCanvas="smartCanvas",e.flowchart="flowchart",e.mind="mind",e.pdf="pdf"}(a||(a={}));var c,l,u,d,p,h=((r={})[a.doc]=i.doc,r[a.sheet]=i.sheet,r[a.slide]=i.slide,r[a.smartSheet]=i.smartSheet,r[a.smartCanvas]=i.smartCanvas,r[a.flowchart]=i.flowchart,r[a.mind]=i.mind,r[a.pdf]=i.pdf,r),f=((o={})[i.doc]=a.doc,o[i.sheet]=a.sheet,o[i.slide]=a.slide,o[i.smartSheet]=a.smartSheet,o[i.smartCanvas]=a.smartCanvas,o[i.flowchart]=a.flowchart,o[i.mind]=a.mind,o[i.pdf]=a.pdf,o);!function(e){e[e.private=0]="private",e[e.partialShare=1]="partialShare",e[e.canRead=2]="canRead",e[e.canEdit=3]="canEdit"}(c||(c={})),function(e){e.new="new",e.local="local",e.deleted="deleted",e.normal="normal"}(l||(l={})),function(e){e[e.file=1]="file",e[e.folder=2]="folder"}(u||(u={})),function(e){e[e.trash=3]="trash",e[e.share=4]="share",e[e.myDoc=5]="myDoc",e[e.recent=6]="recent",e[e.start=7]="start"}(d||(d={})),function(e){e.init="init",e.document="document",e.workbook="workbook",e.chunk="chunk",e.accepted="accepted",e.missChange="misschange",e.newChange="newchange",e.committing="commiting",e.waiting="watting",e.queue="queue"}(p||(p={}));var g,v,y,m,b,_="TencentDocs",C="TencentDocs_TestEnv";function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}!function(e){e.documentStatus="DocumentStatus",e.documentEntities="DocumentEntities",e.newDocumentIds="NewDocumentIds",e.padinfo="PadInfo",e.offlineData="OfflineData",e.documentData="DocumentData",e.Users="Users"}(g||(g={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.QQ=1]="QQ",e[e.WX=2]="WX",e[e.WORK=3]="WORK",e[e.EMAIL=4]="EMAIL",e[e.PHONE=8]="PHONE",e[e.WORK_COMBINATION=9]="WORK_COMBINATION",e[e.TOWER=10]="TOWER",e[e.ROBOT=11]="ROBOT",e[e.QFYF=12]="QFYF",e[e.OPEN=13]="OPEN",e[e.MEETING=14]="MEETING"}(v||(v={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.WECHAT=4]="WECHAT",e[e.WEWORK=3]="WEWORK"}(y||(y={})),function(e){e.BINDING="BINDING",e.UNBIND="UNBIND"}(m||(m={})),function(e){e.NORMAL="NORMAL",e.SUPER="SUPER",e.NONE="NONE",e.EXPIRED="EXPIRED"}(b||(b={}));var w=function(e,t){return w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},w(e,t)};function E(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}w(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function x(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":S(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}function T(e,t){if("object"===("undefined"==typeof Reflect?"undefined":S(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}var R=function(e){function t(t){var n,r,o,i,a,s,c=this;return(c=e.call(this)||this).isDefaultChunk=!1,c.uid=t.uid,c.type=t.type,c.data=t.data,c.dataVersion=t.dataVersion,c.docType=t.docType,c.subId=t.subId,c.secretId=t.secretId,c.version=t.version,c.globalPadId=t.globalPadId,c.taskId=null!==(n=t.taskId)&&void 0!==n?n:c.getTaskId(),c.isDefaultChunk=null!==(r=t.isDefaultChunk)&&void 0!==r&&r,c.chunkId=null!==(o=t.chunkId)&&void 0!==o?o:0,c.docStatus=null!==(i=t.docStatus)&&void 0!==i?i:l.normal,c.createTimestamp=null!==(a=t.createTimestamp)&&void 0!==a?a:Date.now(),c.lastModifyTimestamp=null!==(s=t.lastModifyTimestamp)&&void 0!==s?s:Date.now(),c.key=c.getKey(),c.subGlobalPadId=t.subGlobalPadId,c.subDocType=t.subDocType,c}return E(t,e),t.prototype.getTaskId=function(){return Math.ceil(2147483648*Math.random())},t.prototype.getKey=function(){return this.type===p.init?"".concat(this.globalPadId,"_").concat(this.subId,"_").concat(this.uid):this.type===p.document?"".concat(this.globalPadId,"_").concat(this.uid,"_version_").concat(this.version):this.type===p.workbook?"".concat(this.globalPadId,"_").concat(this.subId,"_").concat(this.uid,"_version_").concat(this.version):this.type===p.chunk?"".concat(this.globalPadId,"_").concat(this.subId,"_").concat(this.chunkId,"_").concat(this.uid,"_version_").concat(this.version):"".concat(this.globalPadId,"_").concat(this.subId,"_").concat(this.uid,"_taskId_").concat(this.taskId)},x([(0,s.primary)(),T("design:type",String)],t.prototype,"key",void 0),x([(0,s.index)(),T("design:type",String)],t.prototype,"secretId",void 0),x([(0,s.index)(),T("design:type",String)],t.prototype,"globalPadId",void 0),x([(0,s.index)(),T("design:type",String)],t.prototype,"subGlobalPadId",void 0),x([(0,s.index)(),T("design:type",Number)],t.prototype,"subDocType",void 0),x([(0,s.index)(),T("design:type",Number)],t.prototype,"version",void 0),x([(0,s.index)(),T("design:type",String)],t.prototype,"type",void 0),x([(0,s.index)(),T("design:type",String)],t.prototype,"uid",void 0),x([(0,s.index)(),(0,s.field)("subSheetId"),T("design:type",String)],t.prototype,"subId",void 0),x([(0,s.index)(),T("design:type",Number)],t.prototype,"chunkId",void 0),x([(0,s.field)(),T("design:type",Number)],t.prototype,"taskId",void 0),x([(0,s.field)("_data"),T("design:type",String)],t.prototype,"data",void 0),x([(0,s.field)(),T("design:type",Number)],t.prototype,"docType",void 0),x([(0,s.field)("padStatus"),T("design:type",String)],t.prototype,"docStatus",void 0),x([(0,s.field)("createTime"),T("design:type",Number)],t.prototype,"createTimestamp",void 0),x([(0,s.field)(),T("design:type",Number)],t.prototype,"lastModifyTimestamp",void 0),x([(0,s.field)("dver"),T("design:type",String)],t.prototype,"dataVersion",void 0),x([(0,s.field)("default"),T("design:type",Object)],t.prototype,"isDefaultChunk",void 0),t}(s.Model),I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.addListTimestamp=0,t.attribute=null,t.docPolicy=c.private,t.docPrivilege=null,t.folderPolicy=0,t.folderPrivilege=null,t.isManualOffline=!1,t.isOfflineCache=!1,t.hasSnapShot=!1,t.isAddedToMy=0,t.isCollected=0,t.isOwner=1,t.isPinned=0,t.isShortcut=0,t.isUserChangeTitle=!1,t.lastCollectTimestamp=0,t.lastDeleteTimestamp=0,t.parents=[],t}return E(t,e),x([(0,s.primary)(),T("design:type",String)],t.prototype,"key",void 0),x([(0,s.index)(),T("design:type",String)],t.prototype,"secretId",void 0),x([(0,s.index)(),T("design:type",String)],t.prototype,"globalPadId",void 0),x([(0,s.index)(),T("design:type",String)],t.prototype,"uid",void 0),x([(0,s.field)("add_list_ts"),T("design:type",Object)],t.prototype,"addListTimestamp",void 0),x([(0,s.field)(),T("design:type",Object)],t.prototype,"attribute",void 0),x([(0,s.field)(),T("design:type",Number)],t.prototype,"childrenLength",void 0),x([(0,s.field)("client_version"),T("design:type",String)],t.prototype,"clientVersion",void 0),x([(0,s.field)("create_ts"),T("design:type",Number)],t.prototype,"createTimestamp",void 0),x([(0,s.field)(),T("design:type",String)],t.prototype,"creator",void 0),x([(0,s.field)("creator_domain"),T("design:type",String)],t.prototype,"creatorDomain",void 0),x([(0,s.field)("doc_icon"),T("design:type",String)],t.prototype,"icon",void 0),x([(0,s.field)("doc_policy"),T("design:type",Number)],t.prototype,"docPolicy",void 0),x([(0,s.field)("doc_privilege"),T("design:type",Object)],t.prototype,"docPrivilege",void 0),x([(0,s.field)("doc_thumbnail"),T("design:type",String)],t.prototype,"thumbnail",void 0),x([(0,s.field)("doc_type"),T("design:type",Number)],t.prototype,"docType",void 0),x([(0,s.field)("doc_type_desc"),T("design:type",String)],t.prototype,"docTypeDesc",void 0),x([(0,s.field)("doc_url"),T("design:type",String)],t.prototype,"url",void 0),x([(0,s.field)("domain_id"),T("design:type",String)],t.prototype,"domainId",void 0),x([(0,s.field)(),T("design:type",String)],t.prototype,"dver",void 0),x([(0,s.field)(),T("design:type",String)],t.prototype,"folder",void 0),x([(0,s.field)("folder_id"),T("design:type",String)],t.prototype,"folderId",void 0),x([(0,s.field)("folder_policy"),T("design:type",Object)],t.prototype,"folderPolicy",void 0),x([(0,s.field)("folder_privilege"),T("design:type",Object)],t.prototype,"folderPrivilege",void 0),x([(0,s.field)("isDelete"),T("design:type",Boolean)],t.prototype,"isDeleted",void 0),x([(0,s.field)(),T("design:type",Object)],t.prototype,"isManualOffline",void 0),x([(0,s.field)(),T("design:type",Boolean)],t.prototype,"isMyCreated",void 0),x([(0,s.field)(),T("design:type",Boolean)],t.prototype,"isMydoc",void 0),x([(0,s.field)(),T("design:type",Object)],t.prototype,"isOfflineCache",void 0),x([(0,s.field)(),T("design:type",Boolean)],t.prototype,"isRencent",void 0),x([(0,s.field)("isShareme"),T("design:type",Boolean)],t.prototype,"isShareToMe",void 0),x([(0,s.field)("isSnapShot"),T("design:type",Object)],t.prototype,"hasSnapShot",void 0),x([(0,s.field)(),T("design:type",Boolean)],t.prototype,"isStar",void 0),x([(0,s.field)("is_added_my"),T("design:type",Object)],t.prototype,"isAddedToMy",void 0),x([(0,s.field)("is_collected"),T("design:type",Object)],t.prototype,"isCollected",void 0),x([(0,s.field)("is_owner"),T("design:type",Object)],t.prototype,"isOwner",void 0),x([(0,s.field)("is_pinned"),T("design:type",Object)],t.prototype,"isPinned",void 0),x([(0,s.field)("is_shortcut"),T("design:type",Object)],t.prototype,"isShortcut",void 0),x([(0,s.field)(),T("design:type",Object)],t.prototype,"isUserChangeTitle",void 0),x([(0,s.field)("lastSyncTime"),T("design:type",Number)],t.prototype,"lastSyncTimestamp",void 0),x([(0,s.field)("last_browse_ts"),T("design:type",Number)],t.prototype,"lastBrowseTimestamp",void 0),x([(0,s.field)("last_collect_ts"),T("design:type",Object)],t.prototype,"lastCollectTimestamp",void 0),x([(0,s.field)("last_delete_ts"),T("design:type",Object)],t.prototype,"lastDeleteTimestamp",void 0),x([(0,s.field)("last_modify_ts"),T("design:type",Number)],t.prototype,"lastModifyTimestamp",void 0),x([(0,s.field)("last_modify_nick"),T("design:type",String)],t.prototype,"lastModifyNick",void 0),x([(0,s.field)("last_modify_uid"),T("design:type",String)],t.prototype,"lastModifyUid",void 0),x([(0,s.field)("last_pinned_ts"),T("design:type",Number)],t.prototype,"lastPinnedTimestamp",void 0),x([(0,s.field)("list_info_type"),T("design:type",Number)],t.prototype,"listInfoType",void 0),x([(0,s.field)("list_type"),T("design:type",Number)],t.prototype,"listType",void 0),x([(0,s.field)(),T("design:type",Boolean)],t.prototype,"offlineCommiting",void 0),x([(0,s.field)(),T("design:type",Boolean)],t.prototype,"offlineCommitSuccessd",void 0),x([(0,s.field)("origin_folder_id"),T("design:type",String)],t.prototype,"originFolderId",void 0),x([(0,s.field)("owner_nick"),T("design:type",String)],t.prototype,"ownerNick",void 0),x([(0,s.field)("owner_uid"),T("design:type",String)],t.prototype,"ownerUid",void 0),x([(0,s.field)("pad_id"),T("design:type",String)],t.prototype,"padId",void 0),x([(0,s.field)("parent_folder_id"),T("design:type",String)],t.prototype,"parentFolderId",void 0),x([(0,s.field)(),T("design:type",Array)],t.prototype,"parents",void 0),x([(0,s.field)(),T("design:type",Number)],t.prototype,"privilege",void 0),x([(0,s.field)(),T("design:type",String)],t.prototype,"status",void 0),x([(0,s.field)(),T("design:type",String)],t.prototype,"title",void 0),x([(0,s.field)(),T("design:type",Number)],t.prototype,"type",void 0),x([(0,s.field)("uncommit"),T("design:type",Boolean)],t.prototype,"hasLocalChanges",void 0),x([(0,s.field)("doc_sub_type"),T("design:type",Number)],t.prototype,"docSubType",void 0),x([(0,s.field)("official_auth_info"),T("design:type",String)],t.prototype,"officialAuthInfo",void 0),x([(0,s.field)("personalize_info"),T("design:type",String)],t.prototype,"personalizeInfo",void 0),x([(0,s.field)("nativeEngineStatusRecord"),T("design:type",String)],t.prototype,"nativeEngineStatusRecord",void 0),x([(0,s.field)("nativeEngineDocPrivilege"),T("design:type",String)],t.prototype,"nativeEngineDocPrivilege",void 0),x([(0,s.field)(),T("design:type",String)],t.prototype,"data",void 0),x([(0,s.field)(),T("design:type",String)],t.prototype,"ext",void 0),x([(0,s.field)(),T("design:type",Boolean)],t.prototype,"isOfflineCacheByNative",void 0),x([(0,s.field)("mime_type"),T("design:type",String)],t.prototype,"mimeType",void 0),x([(0,s.field)("owner_vip_info"),T("design:type",String)],t.prototype,"ownerVipInfo",void 0),t=x([(0,s.table)(g.padinfo)],t)}(s.Model),P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isCreated=!1,t}return E(t,e),x([(0,s.primary)(),T("design:type",String)],t.prototype,"globalPadId",void 0),x([(0,s.field)(),T("design:type",String)],t.prototype,"secretId",void 0),x([(0,s.field)(),T("design:type",Number)],t.prototype,"documentType",void 0),x([(0,s.field)(),T("design:type",String)],t.prototype,"localPadId",void 0),x([(0,s.field)(),T("design:type",Object)],t.prototype,"isCreated",void 0),t=x([(0,s.table)(g.newDocumentIds)],t)}(s.Model),O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lastSyncTimestamp=0,t}return E(t,e),x([(0,s.primary)(),T("design:type",String)],t.prototype,"globalPadId",void 0),x([(0,s.index)(),T("design:type",String)],t.prototype,"secretId",void 0),x([(0,s.index)(),T("design:type",String)],t.prototype,"uid",void 0),x([(0,s.field)("lastSyncTime"),T("design:type",Object)],t.prototype,"lastSyncTimestamp",void 0),x([(0,s.field)(),T("design:type",Number)],t.prototype,"lastErrorTimestamp",void 0),t=x([(0,s.table)(g.documentStatus)],t)}(s.Model),k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return E(t,e),x([(0,s.primary)(),T("design:type",String)],t.prototype,"key",void 0),x([(0,s.field)(),T("design:type",Object)],t.prototype,"data",void 0),t=x([(0,s.table)(g.documentEntities)],t)}(s.Model),D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return E(t,e),t=x([(0,s.table)(g.documentData)],t)}(R),M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return E(t,e),t=x([(0,s.table)(g.offlineData)],t)}(R),A=function(e){function t(t){var n,r,o,i=this;return(i=e.call(this)||this).docId=t.docId,i.pageType=t.pageType,i.updateTime=t.updateTime,i.tinyId=t.tinyId,i.wedriveUin=t.wedriveUin,i.wedocOpenId=t.wedocOpenId,i.nowUserIndex=null!==(n=t.nowUserIndex)&&void 0!==n?n:"",i.corpId=t.corpId,i.corpName=t.corpName,i.englishName=t.englishName,i.loginType=t.loginType,i.uidSource=t.uidSource,i.uin=t.uin,i.userId=t.userId,i.userName=t.userName,i.userPic=t.userPic,i.settings=t.settings,i.bindUserInfo=null!==(r=t.bindUserInfo)&&void 0!==r?r:{type:m.UNBIND,userName:"",userPic:"",accountType:v.UNKNOWN},i.vipUserInfo=null!==(o=t.vipUserInfo)&&void 0!==o?o:{type:b.NONE,beginTime:0,endTime:0},i.key="".concat(i.pageType,"-").concat(i.docId,"-").concat(i.tinyId),i}return E(t,e),x([(0,s.primary)(),T("design:type",String)],t.prototype,"key",void 0),x([(0,s.index)(),T("design:type",String)],t.prototype,"tinyId",void 0),x([(0,s.index)(),T("design:type",String)],t.prototype,"nowUserIndex",void 0),x([(0,s.index)(),T("design:type",String)],t.prototype,"docId",void 0),x([(0,s.index)(),T("design:type",String)],t.prototype,"pageType",void 0),x([(0,s.index)(),T("design:type",String)],t.prototype,"wedriveUin",void 0),x([(0,s.index)(),T("design:type",String)],t.prototype,"wedocOpenId",void 0),x([(0,s.field)(),T("design:type",String)],t.prototype,"corpId",void 0),x([(0,s.field)(),T("design:type",String)],t.prototype,"corpName",void 0),x([(0,s.field)(),T("design:type",String)],t.prototype,"englishName",void 0),x([(0,s.field)(),T("design:type",Number)],t.prototype,"loginType",void 0),x([(0,s.field)(),T("design:type",String)],t.prototype,"openId",void 0),x([(0,s.field)(),T("design:type",Number)],t.prototype,"uidSource",void 0),x([(0,s.field)(),T("design:type",String)],t.prototype,"uin",void 0),x([(0,s.field)(),T("design:type",String)],t.prototype,"userId",void 0),x([(0,s.field)(),T("design:type",String)],t.prototype,"userName",void 0),x([(0,s.field)(),T("design:type",String)],t.prototype,"userPic",void 0),x([(0,s.field)(),T("design:type",String)],t.prototype,"updateTime",void 0),x([(0,s.field)(),T("design:type",Object)],t.prototype,"settings",void 0),x([(0,s.field)(),T("design:type",Object)],t.prototype,"bindUserInfo",void 0),x([(0,s.field)(),T("design:type",Object)],t.prototype,"vipUserInfo",void 0),t=x([(0,s.table)(g.Users),T("design:paramtypes",[Object])],t)}(s.Model)},90304:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.r(t),n.d(t,{BaseBackoff:function(){return d},ConstantBackoff:function(){return p},CustomBackoff:function(){return C},IterableBackoff:function(){return _},REQUEST_ERROR_CODE:function(){return h},RetryPolicy:function(){return m},createNativeRequestInstance:function(){return F},createNetworkRequestInstance:function(){return He},nativeRequest:function(){return U},networkRequest:function(){return je}});var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},o(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var a=function(){return a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)};function s(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function c(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function l(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function u(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}var d=function(){function e(e){this.duration=e,this.attempt=0}return e.prototype.next=function(e){throw new Error("Method not implemented.")},e}(),p=function(e){function t(t,n){var r=e.call(this,t)||this;return r.limit=n,r}return i(t,e),t.prototype.next=function(){return void 0===this.limit?this:this.attempt>=this.limit?void 0:(this.attempt+=1,this)},t}(d);new p(0,0);var h,f,g=function(){return!1},v=function(){return!1},y=function(){function e(e,t){void 0===e&&(e=g),void 0===t&&(t=v),this.errorFilter=e,this.resultFilter=t}return e.prototype.invoke=function(e,t){return s(this,void 0,void 0,(function(){var n,r,o;return c(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e(t)];case 1:return n=i.sent(),this.resultFilter(n)?[2,{value:n}]:[2,{success:n}];case 2:if(r=i.sent(),o=r,!this.errorFilter(o))throw o;return[2,{error:o}];case 3:return[2]}}))}))},e}(),m=function(){function e(e){var t;this.options=e,this.executor=new y(e.errorFilter,e.resultFilter),this.backoffFactory=null!==(t=e.backoffFactory)&&void 0!==t?t:new p(0,e.maxRetry)}return e.prototype.execute=function(e){return s(this,void 0,void 0,(function(){var t,n,r,o,i;return c(this,(function(a){switch(a.label){case 0:t=0,a.label=1;case 1:return n={attempt:t,startTimestamp:Date.now()},[4,this.executor.invoke(e,n)];case 2:return"success"in(r=a.sent())?[2,r.success]:t<this.options.maxRetry?(o={attempt:t+1,result:r},(i=this.backoffFactory.next(o))?[4,(s=i.duration,c=Math.max(s,0),0===c?Promise.resolve():new Promise((function(e){return setTimeout(e,c)})))]:[3,4]):[3,5];case 3:a.sent(),a.label=4;case 4:return[3,6];case 5:if("error"in r)throw r.error;return[2,r.value];case 6:return t++,[3,1];case 7:return[2]}var s,c}))}))},e}(),b=function(e){return Math.max(null!=e?e:0,0)},_=function(e){function t(t){var n,r=this;return(r=e.call(this,null!==(n=b(t[0]))&&void 0!==n?n:0)||this).durations=t,r}return i(t,e),t.prototype.next=function(){if(!(this.attempt>=this.durations.length))return this.duration=b(this.durations[this.attempt]),this.attempt+=1,this},t}(d),C=function(e){function t(t){var n,r=this;return(r=e.call(this,null!==(n=t({attempt:0}))&&void 0!==n?n:0)||this).generator=t,r}return i(t,e),t.prototype.next=function(e){var t=this.generator(e);if(t)return this.duration=t,this},t}(d);function S(e){return{data:e,status:f.success,statusText:"Success"}}function w(e){return{data:[],status:f.unknown,statusText:e}}!function(e){e.aborted="ECONNABORTED",e.network="ERR_NETWORK",e.timeout="ETIMEDOUT",e.badRequest="ERR_BAD_REQUEST",e.badResponse="ERR_BAD_RESPONSE"}(h||(h={})),function(e){e[e.unknown=-1]="unknown",e[e.success=200]="success"}(f||(f={}));var E=function(){function e(){this.interceptors=[]}return e.prototype.add=function(e){this.interceptors.push(e)},e.prototype.proceed=function(e){return s(this,void 0,void 0,(function(){var t;return c(this,(function(n){return t=Array.from(this.interceptors),this.fillBuildInInterceptors(t,e),[2,this.dispatch(e,t,0)]}))}))},e.prototype.dispatch=function(e,t,n){var r=this;if(n>=t.length){var o=S([]);return Promise.resolve(o)}return t[n].intercept((function(){return r.dispatch(e,t,n+1)}),e)},e}(),x=function(e){function t(){var t=this||self;return delete e.prototype.__magic__,t}return"object"==typeof globalThis?globalThis:this?t():(e.defineProperty(e.prototype,"__magic__",{configurable:!0,get:t}),__magic__)}(Object),T=function(){function e(){var e,t;this.canUseNativeAndroid=(null===(e=x.mqq)||void 0===e?void 0:e.android)&&(null===(t=x._mqqWebViewJSInterface)||void 0===t?void 0:t.invoke),this.currentSeqId=0,this.reqCallbacks=new Map}return e.prototype.JSApiCallback=function(e){var t=this.reqCallbacks.get(e.callbackId);if(!t)throw new Error("TypeError:[ark-request] the reqCallback of response[".concat(e.callbackId,"] can't found!"));t.callback(e)},e.prototype.invokeNative=function(e,t,n,r){var o,i=null!=n?n:{},a=i.command;if(r){var s=this.createReqSeq();this.reqCallbacks.set(s,{callback:r,command:a,startTime:Date.now()}),i.callbackId=s}this.canUseNativeAndroid?this.invokeNativeAndroid(e,t,i):null===(o=x.mqq)||void 0===o||o.invoke(e,t,i)},e.prototype.invokeNativeAndroid=function(e,t,n){var r,o="jsbridge://".concat(encodeURIComponent(e),"/").concat(encodeURIComponent(t));n&&(o+="?p=".concat(encodeURIComponent(JSON.stringify(n)))),null===(r=x._mqqWebViewJSInterface)||void 0===r||r.invoke(o)},e.prototype.createReqSeq=function(){return this.currentSeqId+=1},e}();x.jsApi||(x.jsApi=new T,x.JSApiCallback||(x.JSApiCallback=x.jsApi.JSApiCallback.bind(x.jsApi)));var R=x.jsApi,I=function(){function e(){}return e.prototype.invoke=function(e){return new Promise((function(t,n){if(!e.namespace)throw new Error("jsapi, namespace is null.");var r=e.params||{},o=e.callback?function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t(S(e))}:void 0;try{R.invokeNative(e.namespace,e.method,r,o),o||t(S([]))}catch(e){n(w("Error:[ark-request] Jsapi invokeNative fail."))}}))},e}();function P(e){return"[object Function]"===Object.prototype.toString.call(e)}var O,k,D=function(e){function t(){var t=this||self;return delete e.prototype.__magic__,t}return"object"==typeof globalThis?globalThis:this?t():(e.defineProperty(e.prototype,"__magic__",{configurable:!0,get:t}),__magic__)}(Object),M=function(){function e(){}return e.prototype.invoke=function(e){return s(this,void 0,void 0,(function(){var t,n;return c(this,(function(r){switch(r.label){case 0:if(!D.mqq)throw new Error("UnknownError:[ark-request] mqq channel is undefined.");if(!e.namespace)throw new Error("TypeError:[ark-request] mqq invoke has no namespace!");return t=D.mqq[e.namespace],(n=null==t?void 0:t[e.method])&&P(n)?[4,this.innerModuleInvoke(n,e.params,e.callback)]:[3,2];case 1:case 3:return[2,r.sent()];case 2:return[4,this.innerCoreInvoke(D.mqq.invoke,e)]}}))}))},e.prototype.innerModuleInvoke=function(e,t,n){return new Promise((function(r,o){var i=[];t&&i.push(t),n&&i.push((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r(S(e))}));try{e.apply(void 0,u([],l(i),!1)),n||r(S([]))}catch(e){o(w("Error:[ark-request] Mqq invoke module fail."))}}))},e.prototype.innerCoreInvoke=function(e,t){return new Promise((function(n,r){try{e(t.namespace,t.method,t.params,(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];n(S(e))}))}catch(e){r(w("Error:[ark-request] Mqq invoke core[".concat(t.namespace,".").concat(t.method,"] fail.")))}}))},e}();!function(e){e.mqq="mqq",e.jsapi="jsapi"}(k||(k={}));var A={schema:"mqq",channels:(O={},O[k.mqq]=M,O[k.jsapi]=I,O)},L=function(){function e(){}return e.prototype.intercept=function(e,t){return s(this,void 0,void 0,(function(){var e;return c(this,(function(n){switch(n.label){case 0:if(!t.schema)throw Error("TypeError[ark-request]: the schema of request(".concat(t.namespace,".").concat(t.method,") is undefined."));if(!(e=A.channels[t.schema]))throw Error("TypeError[ark-request]: can't match strategy to handle request(".concat(t.schema,".").concat(t.namespace,".").concat(t.method,")."));return[4,(new e).invoke(t)];case 1:return[2,n.sent()]}}))}))},e}(),N=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.fillBuildInInterceptors=function(e){return e.push(new L),e},t}(E),B=function(){function e(e){this.interceptors=e}return e.prototype.invoke=function(e){this.interceptors.proceed(a({schema:A.schema},e)).then((function(t){var n,r,o=t.data;null===(n=e.callback)||void 0===n||n.call.apply(n,u([e],l(o),!1)),e.removeCallback&&(null===(r=e.params)||void 0===r?void 0:r.callbackId)&&R.reqCallbacks.delete(e.params.callbackId)}))},e.prototype.register=function(e,t){if(!P(t))throw new Error("TypeError:[ark-request] The handler[".concat(e,"] to register is not function."));this.getNativeChannel()[this.generateCallbackName(e)]=t},e.prototype.unregister=function(e){this.getNativeChannel()[this.generateCallbackName(e)]=void 0},e.prototype.notify=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this.getNativeChannel(),o=this.generateCallbackName(e),i=r[o];if(!P(i))throw new Error("TypeError:[ark-request] The handler[".concat(e,"] is not function!"));i.apply(void 0,u([],l(t),!1))},e.prototype.generateCallbackName=function(e){return e},e.prototype.getNativeChannel=function(){return window},e}();function F(){var e=new N;return new B(e)}var U=F(),H={maxRetry:3},j=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}},G=Object.prototype.toString;function V(e){return Array.isArray(e)}function W(e){return void 0===e}function z(e){return"[object ArrayBuffer]"===G.call(e)}function K(e){return null!==e&&"object"===r(e)}function q(e){if("[object Object]"!==G.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function Y(e){return"[object Function]"===G.call(e)}function Q(e,t){if(null!=e)if("object"!==r(e)&&(e=[e]),V(e))for(var n=0,o=e.length;n<o;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}var Z={isArray:V,isArrayBuffer:z,isBuffer:function(e){return null!==e&&!W(e)&&null!==e.constructor&&!W(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"[object FormData]"===G.call(e)},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&z(e.buffer)},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:K,isPlainObject:q,isUndefined:W,isDate:function(e){return"[object Date]"===G.call(e)},isFile:function(e){return"[object File]"===G.call(e)},isBlob:function(e){return"[object Blob]"===G.call(e)},isFunction:Y,isStream:function(e){return K(e)&&Y(e.pipe)},isURLSearchParams:function(e){return"[object URLSearchParams]"===G.call(e)},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:Q,merge:function e(){var t={};function n(n,r){q(t[r])&&q(n)?t[r]=e(t[r],n):q(n)?t[r]=e({},n):V(n)?t[r]=n.slice():t[r]=n}for(var r=0,o=arguments.length;r<o;r++)Q(arguments[r],n);return t},extend:function(e,t,n){return Q(t,(function(t,r){e[r]=n&&"function"==typeof t?j(t,n):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}};function X(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var J=function(e,t,n){if(!t)return e;var r;if(n)r=n(t);else if(Z.isURLSearchParams(t))r=t.toString();else{var o=[];Z.forEach(t,(function(e,t){null!=e&&(Z.isArray(e)?t+="[]":e=[e],Z.forEach(e,(function(e){Z.isDate(e)?e=e.toISOString():Z.isObject(e)&&(e=JSON.stringify(e)),o.push(X(t)+"="+X(e))})))})),r=o.join("&")}if(r){var i=e.indexOf("#");-1!==i&&(e=e.slice(0,i)),e+=(-1===e.indexOf("?")?"?":"&")+r}return e};function $(){this.handlers=[]}$.prototype.use=function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},$.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},$.prototype.forEach=function(e){Z.forEach(this.handlers,(function(t){null!==t&&e(t)}))};var ee=$,te=function(e,t){Z.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))},ne=function(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},e},re={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},oe=function(e,t,n,r,o){var i=new Error(e);return ne(i,t,n,r,o)},ie=Z.isStandardBrowserEnv()?{write:function(e,t,n,r,o,i){var a=[];a.push(e+"="+encodeURIComponent(t)),Z.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),Z.isString(r)&&a.push("path="+r),Z.isString(o)&&a.push("domain="+o),!0===i&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},ae=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],se=Z.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function r(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=r(window.location.href),function(t){var n=Z.isString(t)?r(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0};function ce(e){this.message=e}ce.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},ce.prototype.__CANCEL__=!0;var le=ce,ue=function(e){return new Promise((function(t,n){var r,o=e.data,i=e.headers,a=e.responseType;function s(){e.cancelToken&&e.cancelToken.unsubscribe(r),e.signal&&e.signal.removeEventListener("abort",r)}Z.isFormData(o)&&delete i["Content-Type"];var c=new XMLHttpRequest;if(e.auth){var l=e.auth.username||"",u=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";i.Authorization="Basic "+btoa(l+":"+u)}var d,p,h=(d=e.baseURL,p=e.url,d&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(p)?function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}(d,p):p);function f(){if(c){var r,o,i,l,u,d="getAllResponseHeaders"in c?(r=c.getAllResponseHeaders(),u={},r?(Z.forEach(r.split("\n"),(function(e){if(l=e.indexOf(":"),o=Z.trim(e.substr(0,l)).toLowerCase(),i=Z.trim(e.substr(l+1)),o){if(u[o]&&ae.indexOf(o)>=0)return;u[o]="set-cookie"===o?(u[o]?u[o]:[]).concat([i]):u[o]?u[o]+", "+i:i}})),u):u):null;!function(e,t,n){var r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(oe("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}((function(e){t(e),s()}),(function(e){n(e),s()}),{data:a&&"text"!==a&&"json"!==a?c.response:c.responseText,status:c.status,statusText:c.statusText,headers:d,config:e,request:c}),c=null}}if(c.open(e.method.toUpperCase(),J(h,e.params,e.paramsSerializer),!0),c.timeout=e.timeout,"onloadend"in c?c.onloadend=f:c.onreadystatechange=function(){c&&4===c.readyState&&(0!==c.status||c.responseURL&&0===c.responseURL.indexOf("file:"))&&setTimeout(f)},c.onabort=function(){c&&(n(oe("Request aborted",e,"ECONNABORTED",c)),c=null)},c.onerror=function(){n(oe("Network Error",e,null,c)),c=null},c.ontimeout=function(){var t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",r=e.transitional||re;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(oe(t,e,r.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",c)),c=null},Z.isStandardBrowserEnv()){var g=(e.withCredentials||se(h))&&e.xsrfCookieName?ie.read(e.xsrfCookieName):void 0;g&&(i[e.xsrfHeaderName]=g)}"setRequestHeader"in c&&Z.forEach(i,(function(e,t){void 0===o&&"content-type"===t.toLowerCase()?delete i[t]:c.setRequestHeader(t,e)})),Z.isUndefined(e.withCredentials)||(c.withCredentials=!!e.withCredentials),a&&"json"!==a&&(c.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&c.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&c.upload&&c.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(r=function(e){c&&(n(!e||e&&e.type?new le("canceled"):e),c.abort(),c=null)},e.cancelToken&&e.cancelToken.subscribe(r),e.signal&&(e.signal.aborted?r():e.signal.addEventListener("abort",r))),o||(o=null),c.send(o)}))},de={"Content-Type":"application/x-www-form-urlencoded"};function pe(e,t){!Z.isUndefined(e)&&Z.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var he,fe={transitional:re,adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(he=ue),he),transformRequest:[function(e,t){return te(t,"Accept"),te(t,"Content-Type"),Z.isFormData(e)||Z.isArrayBuffer(e)||Z.isBuffer(e)||Z.isStream(e)||Z.isFile(e)||Z.isBlob(e)?e:Z.isArrayBufferView(e)?e.buffer:Z.isURLSearchParams(e)?(pe(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):Z.isObject(e)||t&&"application/json"===t["Content-Type"]?(pe(t,"application/json"),function(e,t,n){if(Z.isString(e))try{return(t||JSON.parse)(e),Z.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional||fe.transitional,n=t&&t.silentJSONParsing,r=t&&t.forcedJSONParsing,o=!n&&"json"===this.responseType;if(o||r&&Z.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(o){if("SyntaxError"===e.name)throw ne(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};Z.forEach(["delete","get","head"],(function(e){fe.headers[e]={}})),Z.forEach(["post","put","patch"],(function(e){fe.headers[e]=Z.merge(de)}));var ge=fe,ve=function(e,t,n){var r=this||ge;return Z.forEach(n,(function(n){e=n.call(r,e,t)})),e},ye=function(e){return!(!e||!e.__CANCEL__)};function me(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new le("canceled")}var be=function(e){return me(e),e.headers=e.headers||{},e.data=ve.call(e,e.data,e.headers,e.transformRequest),e.headers=Z.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),Z.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||ge.adapter)(e).then((function(t){return me(e),t.data=ve.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return ye(t)||(me(e),t&&t.response&&(t.response.data=ve.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))},_e=function(e,t){t=t||{};var n={};function r(e,t){return Z.isPlainObject(e)&&Z.isPlainObject(t)?Z.merge(e,t):Z.isPlainObject(t)?Z.merge({},t):Z.isArray(t)?t.slice():t}function o(n){return Z.isUndefined(t[n])?Z.isUndefined(e[n])?void 0:r(void 0,e[n]):r(e[n],t[n])}function i(e){if(!Z.isUndefined(t[e]))return r(void 0,t[e])}function a(n){return Z.isUndefined(t[n])?Z.isUndefined(e[n])?void 0:r(void 0,e[n]):r(void 0,t[n])}function s(n){return n in t?r(e[n],t[n]):n in e?r(void 0,e[n]):void 0}var c={url:i,method:i,data:i,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:s};return Z.forEach(Object.keys(e).concat(Object.keys(t)),(function(e){var t=c[e]||o,r=t(e);Z.isUndefined(r)&&t!==s||(n[e]=r)})),n},Ce="0.26.1",Se=Ce,we={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){we[e]=function(n){return r(n)===e||"a"+(t<1?"n ":" ")+e}}));var Ee={};we.transitional=function(e,t,n){function r(e,t){return"[Axios v"+Se+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return function(n,o,i){if(!1===e)throw new Error(r(o," has been removed"+(t?" in "+t:"")));return t&&!Ee[o]&&(Ee[o]=!0,console.warn(r(o," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,o,i)}};var xe={assertOptions:function(e,t,n){if("object"!==r(e))throw new TypeError("options must be an object");for(var o=Object.keys(e),i=o.length;i-- >0;){var a=o[i],s=t[a];if(s){var c=e[a],l=void 0===c||s(c,a,e);if(!0!==l)throw new TypeError("option "+a+" must be "+l)}else if(!0!==n)throw Error("Unknown option "+a)}},validators:we},Te=xe.validators;function Re(e){this.defaults=e,this.interceptors={request:new ee,response:new ee}}Re.prototype.request=function(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},(t=_e(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var n=t.transitional;void 0!==n&&xe.assertOptions(n,{silentJSONParsing:Te.transitional(Te.boolean),forcedJSONParsing:Te.transitional(Te.boolean),clarifyTimeoutError:Te.transitional(Te.boolean)},!1);var r=[],o=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(o=o&&e.synchronous,r.unshift(e.fulfilled,e.rejected))}));var i,a=[];if(this.interceptors.response.forEach((function(e){a.push(e.fulfilled,e.rejected)})),!o){var s=[be,void 0];for(Array.prototype.unshift.apply(s,r),s=s.concat(a),i=Promise.resolve(t);s.length;)i=i.then(s.shift(),s.shift());return i}for(var c=t;r.length;){var l=r.shift(),u=r.shift();try{c=l(c)}catch(e){u(e);break}}try{i=be(c)}catch(e){return Promise.reject(e)}for(;a.length;)i=i.then(a.shift(),a.shift());return i},Re.prototype.getUri=function(e){return e=_e(this.defaults,e),J(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},Z.forEach(["delete","get","head","options"],(function(e){Re.prototype[e]=function(t,n){return this.request(_e(n||{},{method:e,url:t,data:(n||{}).data}))}})),Z.forEach(["post","put","patch"],(function(e){Re.prototype[e]=function(t,n,r){return this.request(_e(r||{},{method:e,url:t,data:n}))}}));var Ie=Re;function Pe(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;this.promise.then((function(e){if(n._listeners){var t,r=n._listeners.length;for(t=0;t<r;t++)n._listeners[t](e);n._listeners=null}})),this.promise.then=function(e){var t,r=new Promise((function(e){n.subscribe(e),t=e})).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e((function(e){n.reason||(n.reason=new le(e),t(n.reason))}))}Pe.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},Pe.prototype.subscribe=function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]},Pe.prototype.unsubscribe=function(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}},Pe.source=function(){var e;return{token:new Pe((function(t){e=t})),cancel:e}};var Oe=Pe,ke=function e(t){var n=new Ie(t),r=j(Ie.prototype.request,n);return Z.extend(r,Ie.prototype,n),Z.extend(r,n),r.create=function(n){return e(_e(t,n))},r}(ge);ke.Axios=Ie,ke.Cancel=le,ke.CancelToken=Oe,ke.isCancel=ye,ke.VERSION=Ce,ke.all=function(e){return Promise.all(e)},ke.spread=function(e){return function(t){return e.apply(null,t)}},ke.isAxiosError=function(e){return Z.isObject(e)&&!0===e.isAxiosError};var De=ke,Me=ke;De.default=Me;var Ae=De,Le=function(){function e(){}return e.prototype.intercept=function(e,t){return s(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,Ae.request(t)];case 1:return[2,e.sent()]}}))}))},e}(),Ne=function(e){var t;return null===(t=e.message)||void 0===t?void 0:t.includes("timeout")},Be=function(){function e(){}return e.prototype.intercept=function(e,t){return s(this,void 0,void 0,(function(){var n=this;return c(this,(function(r){return t.maxRetry<=0?[2,e()]:[2,new m(a({maxRetry:H.maxRetry,errorFilter:Ne},t)).execute((function(t){return s(n,void 0,void 0,(function(){var n;return c(this,(function(r){switch(r.label){case 0:return[4,e()];case 1:return(n=r.sent()).retryContext=t,[2,n]}}))}))}))]}))}))},e}(),Fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.fillBuildInInterceptors=function(e,t){var n;return(null!==(n=t.maxRetry)&&void 0!==n?n:H.maxRetry)>0&&e.push(new Be),e.push(new Le),e},t}(E),Ue=function(){function e(e,t){this.defaults=e,this.interceptors=t}return e.prototype.get=function(e,t){return this.dispatchRequest("get",e,void 0,t)},e.prototype.post=function(e,t,n){return this.dispatchRequest("post",e,t,n)},e.prototype.request=function(e){return this.interceptors.proceed(a(a({},this.defaults),e))},e.prototype.dispatchRequest=function(e,t,n,r){var o,i=null!=r?r:{},s=null!==(o=i.headers)&&void 0!==o?o:{};return i.contentType&&(s["Content-Type"]=i.contentType),this.interceptors.proceed(a(a(a({},this.defaults),i),{url:t,method:e,headers:s,data:null!=n?n:i.data}))},e}();function He(e){var t=new Fe;return new Ue(e||H,t)}var je=He()},7386:function(e,t,n){n.r(t),n.d(t,{DBEngineType:function(){return ee},DB_NAME_BACKUP:function(){return ae},DocumentDataStorage:function(){return le},DocumentEntityStorage:function(){return he},DocumentIdStorage:function(){return de},DocumentStatusStorage:function(){return pe},OfflineDataStorage:function(){return ue},PadInfoStorage:function(){return fe},SortOrder:function(){return c.SortOrder},StorageBackupManager:function(){return se},StorageManager:function(){return ie},UserInfoStorage:function(){return ge}});var r,o=n(49790),i=n(85556),a=n(5358),s=n(26660),c=n(53581);!function(e){e.pending="[PENDING]",e.success="[SUCCESS]",e.failure="[FAILURE]",e.slow="[SLOW]"}(r||(r={}));var l,u,d,p=Symbol("begin"),h=function(e,t){return e+"/"+t},f=function(e,t){return"["+e+"."+t+"]"},g=function(e){var t=Array.isArray(e)?e:Object.keys(e).filter((function(t){return void 0!==e[t]})).map((function(t){return t+"="+e[t]}));return t.length?(0,i.__spreadArray)(["args:"],(0,i.__read)(t)):[]},v=function(e){return"[-* "+e+"]"},y=function(){function e(e){var t=this,n=void 0===e?{logger:console,verbose:!1,disabled:!1,prefix:""}:e,o=n.logger,s=void 0===o?console:o,c=n.disabled,l=void 0!==c&&c,u=n.verbose,d=void 0!==u&&u,h=n.prefix,v=void 0===h?"":h;this.name="LoggerPlugin",this.formatQueryConditionsExp=function(e){if(e.type===a.Kl.AND||e.type===a.Kl.OR){if(!e.exps.length)return;return e.exps.map(t.formatQueryConditionsExp).filter(Boolean).map((function(t){return e.type===a.Kl.OR&&e.exps.length>1?"("+t+")":t})).join(e.type===a.Kl.AND?" AND ":" OR ")}return e.type===a.Kl.FILTER?t.formatPredicate(e.path,e.predicate):e.type},this.formatPredicate=function(e,t){return Object.keys(t).filter((function(e){return void 0!==t[e]})).map((function(n){return e+" "+n+" "+JSON.stringify(t[n])})).join(" AND ")},this.logMethodBegin=function(e,n,o,a){var s;e.timings.set(p,new Date),(s=t.logger).info.apply(s,(0,i.__spreadArray)([t.prefix,r.pending,f(n,o)],(0,i.__read)(g(a))))},this.logMethodEnd=function(e,n,o,a,s){var c,l,u,d,h=e.timings.get(p)||new Date,v=f(n,o),y=Date.now()-h.getTime(),m="cost="+y+"ms",b=y>=500;s.error?(c=t.logger).error.apply(c,(0,i.__spreadArray)([t.prefix,r.failure,f(n,o),m,null===(u=s.error)||void 0===u?void 0:u.message,null===(d=s.error)||void 0===d?void 0:d.stack],(0,i.__read)(g(a)))):(l=t.logger)[b?"warn":"info"].apply(l,(0,i.__spreadArray)((0,i.__spreadArray)((0,i.__spreadArray)((0,i.__spreadArray)([t.prefix,r.success],(0,i.__read)(b?[r.slow]:[])),[v,m]),(0,i.__read)(g(a))),["result:",s.data]))},this.logger=s,this.disabled=l,this.verbose=d,this.prefix=v}return e.prototype.register=function(e){this.disabled||(this.prefix=this.prefix||"["+e.name+"]",this.hookPrimaryKeyQueries(e),this.hookConditionQueries(e),this.hookDataManipulationQueries(e),this.hookEvents(e),this.hookMigration(e),this.verbose&&this.hookEngine(e))},e.prototype.dispose=function(e){throw new s.zF({storage:e})},e.prototype.hookMigration=function(e){var t=this,n=function(e,n,r){void 0===r&&(r="migration"),e.before((function(e){t.logMethodBegin(e,r,n,e.args)})).after((function(e){t.logMethodEnd(e,r,n,e.args,{data:e.return,error:e.error})}))};n(e.aspects.migration.buildMigration,"buildMigration"),n(e.aspects.migration.executeDataMigration,"executeDataMigration"),n(e.aspects.migration.executeSchemaMigration,"executeSchemaMigration"),n(e.aspects.migration.updateMigrationChangeInfo,"updateMigrationChangeInfo"),n(e.aspects.migration.prepareAutoUpgradeHandler,"prepareAutoUpgradeHandler"),n(e.aspects.migration.log,"innerLog"),n(e.aspects.migration.actionExecutor.executeSchemaAction,"executeSchemaAction"),n(e.aspects.migration.actionExecutor.executeDataAction,"executeDataAction")},e.prototype.hookEngine=function(e){var t=this,n=function(e,n,r){e.before((function(e){t.logMethodBegin(e,n,r,e.args)})).after((function(e){t.logMethodEnd(e,n,r,e.args,{data:e.return,error:e.error})}))},r=e.aspects.engine;n(r.openDB,"engine","openDB"),n(r.deleteDB,"engine","deleteDB"),this.hookEngineDatabase(r.database,n),this.hookEngineTable(r.table,n),this.hookEngineTransaction(r.transaction,n),this.hookEngineIndex(r.index,n),this.hookEngineCursor(r.cursor,n)},e.prototype.hookEngineDatabase=function(e,t){var n=h("engine","database");t(e.close,n,"close"),t(e.table,n,"table"),t(e.transaction,n,"transaction"),t(e.createTable,n,"createTable"),t(e.deleteTable,n,"deleteTable")},e.prototype.hookEngineTransaction=function(e,t){var n=h("engine","transaction");t(e.commit,n,"commit"),t(e.rollback,n,"rollback"),t(e.table,n,"table")},e.prototype.hookEngineIndex=function(e,t){var n=h("engine","index");t(e.get,n,"get"),t(e.getAll,n,"getAll"),t(e.getAllKeys,n,"getAllKeys"),t(e.openCursor,n,"openCursor")},e.prototype.hookEngineCursor=function(e,t){var n=h("engine","cursor");t(e.delete,n,"delete"),t(e.update,n,"update"),t(e.next,n,"next"),t(e.value,n,"value")},e.prototype.hookEngineTable=function(e,t){var n=h("engine","table");t(e.clear,n,"clear"),t(e.get,n,"get"),t(e.delete,n,"delete"),t(e.getAll,n,"getAll"),t(e.getAllKeys,n,"getAllKeys"),t(e.index,n,"index"),t(e.insert,n,"insert"),t(e.upsert,n,"upsert"),t(e.createIndex,n,"createIndex"),t(e.deleteIndex,n,"deleteIndex"),t(e.openCursor,n,"openCursor"),t(e.query,n,"query"),t(e.bulkDelete,n,"bulkDelete"),t(e.bulkUpsert,n,"bulkUpsert")},e.prototype.hookPrimaryKeyQueries=function(e){var t=this,n=function(e,n){e.before((function(e){t.logMethodBegin(e,e.this.name,n,{key:e.args[0]})})).after((function(e){t.logMethodEnd(e,e.this.name,n,{key:e.args[0]},{data:e.return,error:e.error})}))};n(e.aspects.collection.get,"get"),n(e.aspects.collection.has,"has"),n(e.aspects.collection.delete,"delete")},e.prototype.hookConditionQueries=function(e){var t=this,n=function(e,n){e.before((function(e){t.logMethodBegin(e,e.this.name,n,t.formatQueryConditions(e.this.conditions()))})).after((function(e){t.logMethodEnd(e,e.this.name,n,t.formatQueryConditions(e.this.conditions()),{data:e.return,error:e.error})}))};n(e.aspects.collection.count,"count"),n(e.aspects.collection.entries,"entries"),n(e.aspects.collection.keys,"keys"),n(e.aspects.collection.values,"values"),n(e.aspects.collection.first,"first"),n(e.aspects.collection.last,"last"),n(e.aspects.collection.clear,"clear"),n(e.aspects.collection.update,"update")},e.prototype.hookDataManipulationQueries=function(e){var t=this,n=function(e,n){e.before((function(e){t.logMethodBegin(e,e.this.name,n,e.args)})).after((function(e){t.logMethodEnd(e,e.this.name,n,e.args,{data:e.return,error:e.error})}))};n(e.aspects.collection.insert,"insert"),n(e.aspects.collection.upsert,"upsert"),n(e.aspects.collection.bulkInsert,"bulkInsert"),n(e.aspects.collection.bulkUpsert,"bulkUpsert")},e.prototype.hookEvents=function(e){var t,n=this,r=(t=Date.now(),function(){var e=Date.now(),n="+"+(e-t)+"ms";return t=e,n});e.events.onBootstrapStart((function(){n.logger.info(n.prefix,v(c.StorageEvent.BootstrapStart),r())})),e.events.onBootstrapEnd((function(){n.logger.info(n.prefix,v(c.StorageEvent.BootstrapEnd),r())})),e.events.onSchemaMigrationStart((function(){n.logger.info(n.prefix,v(c.StorageEvent.SchemaMigrationStart),r())})),e.events.onSchemaMigrationEnd((function(){n.logger.info(n.prefix,v(c.StorageEvent.SchemaMigrationEnd),r())})),e.events.onRegisterModel((function(e){var t,o=e.schema;return(t=n.logger).info.apply(t,(0,i.__spreadArray)((0,i.__spreadArray)([n.prefix,v(c.StorageEvent.RegisterModel)],(0,i.__read)(g({schema:JSON.stringify(o)}))),[r()]))})),e.events.onRegisterPlugin((function(e){var t,o=e.name;return(t=n.logger).info.apply(t,(0,i.__spreadArray)((0,i.__spreadArray)([n.prefix,v(c.StorageEvent.RegisterPlugin)],(0,i.__read)(g({name:o}))),[r()]))})),e.events.onReady((function(e){var t,o=e.version,a=e.tableNames;return(t=n.logger).info.apply(t,(0,i.__spreadArray)((0,i.__spreadArray)([n.prefix,v(c.StorageEvent.Ready)],(0,i.__read)(g({version:o,collections:Array.from(a)}))),[r()]))}))},e.prototype.formatQueryConditions=function(e){var t=e.offset,n=e.limit,r=e.order,o=e.exp;return{OFFSET:t||void 0,LIMIT:n,ORDER_BY:r&&"("+r.path+" "+r.type+")",WHERE:"("+this.formatQueryConditionsExp(o)+")"}},e}(),m=y;!function(e){e.storage="storage",e.collection="collection",e.query="query",e.migration="migration",e.engine="engine"}(l||(l={})),function(e){e.tableGetAll="table#getAll",e.tableGetAllKeys="table#getAllKeys",e.tableGet="table#get",e.tableInsert="table#insert",e.tableUpsert="table#upsert",e.tableDelete="table#delete",e.tableClear="table#clear",e.tableBulkUpsert="table#bulkUpsert",e.tableBulkDelete="table#bulkDelete",e.tableQuery="table#query",e.tableCreateIndex="table#createIndex",e.tableDeleteIndex="table#deleteIndex",e.indexGet="index#get",e.indexGetAll="index#getAll",e.indexGetAllKeys="index#getAllKeys",e.cursorNext="cursor#next",e.cursorValue="cursor#value",e.cursorUpdate="cursor#update",e.cursorDelete="cursor#delete",e.transactionCommit="transaction#commit",e.transactionRollback="transaction#rollback",e.databaseClose="database#close",e.databaseCreateTable="database#createTable",e.databaseDeleteTable="database#deleteTable",e.engineOpenDB="engine#openDB",e.engineDeleteDB="engine#deleteDB"}(u||(u={})),function(e){e[e.success=0]="success",e[e.fail=1]="fail"}(d||(d={}));var b=function(){function e(e,t){this.module=l.engine,this.actionExecuteState=0,this.status=0,this.time=new Date,this.action=e,this.cost=t}return e.prototype.markError=function(e){this.errorMsg=e.message,this.actionExecuteState=1,this.status=1},e}(),_=function(){function e(e,t){this.module=l.collection,this.status=0,this.actionExecuteState=0,this.write={count:0},this.read={count:0},this.delete={count:0},this.fail={count:0,reasons:[]},this.time=new Date,this.action=e,this.cost=t}return e.prototype.increment=function(e,t){void 0===t&&(t=1),this[e].count+=t},e.prototype.error=function(e){this.actionExecuteState=1,this.status=1,this.increment("fail"),this.fail.reasons.push(e.name)},e}(),C=Symbol("begin");function S(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e}var w,E,x,T=function(){function e(e){var t=this,n=void 0===e?{}:e,r=n.disabled,o=void 0!==r&&r,a=n.onEvent,s=n.onCollectionEvent,c=n.onEngineEvent;this.name="MonitorPlugin",this.begin=function(e){e.timings.set(C,new Date)},this.reportReadEvent=function(e,n){t.reportCollectionEvent(e,n,(function(r){return(0,i.__awaiter)(t,void 0,void 0,(function(){var t,o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return e.return?[4,e.return]:[3,2];case 1:t=i.sent(),o="has"===n?!t:null===t,r.increment("read",o?0:1),i.label=2;case 2:return[2]}}))}))}))},this.reportBatchReadEvent=function(e,n){t.reportCollectionEvent(e,n,(function(n){return(0,i.__awaiter)(t,void 0,void 0,(function(){var t,r,o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return e.return?(r=(t=n).increment,o=["read"],[4,e.return]):[3,2];case 1:r.apply(t,o.concat([i.sent().length])),i.label=2;case 2:return[2]}}))}))}))},this.reportWriteEvent=function(e,n){t.reportCollectionEvent(e,n,(function(n){return(0,i.__awaiter)(t,void 0,void 0,(function(){var t,r,o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return e.return?(r=(t=n).increment,o=["write"],[4,e.return]):[3,2];case 1:r.apply(t,o.concat([null===i.sent()?0:1])),i.label=2;case 2:return[2]}}))}))}))},this.reportBatchWriteEvent=function(e,n){t.reportCollectionEvent(e,n,(function(n){return(0,i.__awaiter)(t,void 0,void 0,(function(){var t,r,o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return e.return?(r=(t=n).increment,o=["write"],[4,e.return]):[3,2];case 1:r.apply(t,o.concat([i.sent().length])),i.label=2;case 2:return[2]}}))}))}))},this.reportDeleteEvent=function(e,n){t.reportCollectionEvent(e,n,(function(n){return(0,i.__awaiter)(t,void 0,void 0,(function(){var t,r,o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return e.return?(r=(t=n).increment,o=["delete"],[4,e.return]):[3,2];case 1:r.apply(t,o.concat([null===i.sent()?0:1])),i.label=2;case 2:return[2]}}))}))}))},this.reportBatchDeleteEvent=function(e,n){t.reportCollectionEvent(e,n,(function(n){return(0,i.__awaiter)(t,void 0,void 0,(function(){var t,r,o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return e.return?(r=(t=n).increment,o=["delete"],[4,e.return]):[3,2];case 1:r.apply(t,o.concat([i.sent().length])),i.label=2;case 2:return[2]}}))}))}))},this.disabled=o,this.onEvent=a,this.onCollectionEvent=s,this.onEngineEvent=c}return e.prototype.register=function(e){var t,n,r,o,a,s,c,l,d=this;if(!this.disabled){var p=e.aspects,h=p.collection,f=p.engine,g=function(e){h[e].before(v.begin).after((function(t){return d.reportReadEvent(t,e)}))},v=this;try{for(var y=(0,i.__values)(S("get","has","first","last")),m=y.next();!m.done;m=y.next())g(m.value)}catch(e){t={error:e}}finally{try{m&&!m.done&&(n=y.return)&&n.call(y)}finally{if(t)throw t.error}}var b=function(e){h[e].before(_.begin).after((function(t){return d.reportBatchReadEvent(t,e)}))},_=this;try{for(var C=(0,i.__values)(S("entries","keys","values","update")),w=C.next();!w.done;w=C.next())b(w.value)}catch(e){r={error:e}}finally{try{w&&!w.done&&(o=C.return)&&o.call(C)}finally{if(r)throw r.error}}var E=function(e){h[e].before(x.begin).after((function(t){return d.reportWriteEvent(t,e)}))},x=this;try{for(var T=(0,i.__values)(S("upsert","insert")),R=T.next();!R.done;R=T.next())E(R.value)}catch(e){a={error:e}}finally{try{R&&!R.done&&(s=T.return)&&s.call(T)}finally{if(a)throw a.error}}var I=function(e){h[e].before(P.begin).after((function(t){return d.reportBatchWriteEvent(t,e)}))},P=this;try{for(var O=(0,i.__values)(S("bulkUpsert","bulkInsert","update")),k=O.next();!k.done;k=O.next())I(k.value)}catch(e){c={error:e}}finally{try{k&&!k.done&&(l=O.return)&&l.call(O)}finally{if(c)throw c.error}}h.delete.before(this.begin).after((function(e){return d.reportDeleteEvent(e,"delete")})),h.clear.before(this.begin).after((function(e){return d.reportBatchDeleteEvent(e,"clear")})),f.openDB.before(this.begin).after((function(e){return d.reportEngineEvent(e,u.engineOpenDB)})),f.deleteDB.before(this.begin).after((function(e){return d.reportEngineEvent(e,u.engineDeleteDB)}));var D=f.database,M=f.table,A=f.transaction,L=f.index,N=f.cursor;D.close.before(this.begin).after((function(e){return d.reportEngineEvent(e,u.databaseClose)})),D.createTable.before(this.begin).after((function(e){return d.reportEngineEvent(e,u.databaseCreateTable)})),D.deleteTable.before(this.begin).after((function(e){return d.reportEngineEvent(e,u.databaseDeleteTable)})),M.get.before(this.begin).after((function(e){return d.reportEngineEvent(e,u.tableGet)})),M.getAll.before(this.begin).after((function(e){return d.reportEngineEvent(e,u.tableGetAll)})),M.getAllKeys.before(this.begin).after((function(e){return d.reportEngineEvent(e,u.tableGetAllKeys)})),M.insert.before(this.begin).after((function(e){return d.reportEngineEvent(e,u.tableInsert)})),M.upsert.before(this.begin).after((function(e){return d.reportEngineEvent(e,u.tableUpsert)})),M.delete.before(this.begin).after((function(e){return d.reportEngineEvent(e,u.tableDelete)})),M.clear.before(this.begin).after((function(e){return d.reportEngineEvent(e,u.tableClear)})),M.bulkDelete.before(this.begin).after((function(e){return d.reportEngineEvent(e,u.tableBulkDelete)})),M.bulkUpsert.before(this.begin).after((function(e){return d.reportEngineEvent(e,u.tableBulkUpsert)})),M.query.before(this.begin).after((function(e){return d.reportEngineEvent(e,u.tableQuery)})),M.createIndex.before(this.begin).after((function(e){return d.reportEngineEvent(e,u.tableCreateIndex)})),M.deleteIndex.before(this.begin).after((function(e){return d.reportEngineEvent(e,u.tableDeleteIndex)})),A.commit.before(this.begin).after((function(e){return d.reportEngineEvent(e,u.transactionCommit)})),A.rollback.before(this.begin).after((function(e){return d.reportEngineEvent(e,u.transactionRollback)})),L.get.before(this.begin).after((function(e){return d.reportEngineEvent(e,u.indexGet)})),L.getAll.before(this.begin).after((function(e){return d.reportEngineEvent(e,u.indexGetAll)})),L.getAllKeys.before(this.begin).after((function(e){return d.reportEngineEvent(e,u.indexGetAllKeys)})),N.delete.before(this.begin).after((function(e){return d.reportEngineEvent(e,u.cursorDelete)})),N.update.before(this.begin).after((function(e){return d.reportEngineEvent(e,u.cursorUpdate)})),N.next.before(this.begin).after((function(e){return d.reportEngineEvent(e,u.cursorNext)})),N.value.before(this.begin).after((function(e){return d.reportEngineEvent(e,u.cursorValue)}))}},e.prototype.dispose=function(e){throw new s.zF({storage:e})},e.prototype.reportEngineEvent=function(e,t){var n,r,o=e.timings.get(C)||new Date,i=Date.now()-o.getTime(),a=new b(t,i);e.error&&a.markError(e.error),null===(n=this.onEvent)||void 0===n||n.call(this,a),null===(r=this.onEngineEvent)||void 0===r||r.call(this,a)},e.prototype.reportCollectionEvent=function(e,t,n){var r,o;return(0,i.__awaiter)(this,void 0,void 0,(function(){var a,s,c;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return a=e.timings.get(C)||new Date,s=Date.now()-a.getTime(),c=new _(t,s),e.error?(c.error(e.error),[3,3]):[3,1];case 1:return[4,n(c,e)];case 2:i.sent(),i.label=3;case 3:return null===(r=this.onEvent)||void 0===r||r.call(this,c),null===(o=this.onCollectionEvent)||void 0===o||o.call(this,c),[2]}}))}))},e}(),R=T,I=n(95809);!function(e){e.INIT="init",e.GET="get",e.GET_ALL="getAll",e.DELETE="delete",e.INSERT="set",e.UPDATE="update",e.UPDATE_MUTIL_TABLE_DATA="updateMultiTableData",e.BEGIN_TRANSACTION="beginTransaction",e.COMMIT_TRANSACTION="commitTransaction",e.ROLLBACK_TRANSACTION="rollbackTransaction"}(w||(w={})),function(e){e[e.IN=0]="IN",e[e.LOWER_BOUND=1]="LOWER_BOUND",e[e.UPPER_BOUND=2]="UPPER_BOUND",e[e.BOUND=3]="BOUND",e[e.ONLY=4]="ONLY",e[e.NOT_IN=5]="NOT_IN"}(E||(E={})),function(e){e[e.INCREASE=0]="INCREASE",e[e.DECREASE=1]="DECREASE",e[e.INCREASE_BY_TEXT=2]="INCREASE_BY_TEXT",e[e.DECREASE_BY_TEXT=3]="DECREASE_BY_TEXT"}(x||(x={}));var P=n(90304),O=function(){function e(){}return e.send=function(t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,i.__generator)(this,(function(o){return n=new Promise((function(e){var n;(null===(n=null===window||void 0===window?void 0:window.tdocs)||void 0===n?void 0:n.clientDatabaseRequest)?window.tdocs.clientDatabaseRequest(t).then(e).catch((function(t,n){e({err_code:n,err_msg:t})})):P.nativeRequest.invoke({schema:"jsapi",namespace:"docx",method:"clientDatabaseRequest",params:t,removeCallback:!0,callback:function(t){e(t)}})})),r=new Promise((function(t){setTimeout((function(){t({err_msg:"req timeout",err_code:e.timeoutErrorCode})}),e.timeout)})),[2,Promise.race([n,r])]}))}))},e.timeout=1e4,e.timeoutErrorCode="100002",e}(),k=function(){function e(){}return e.getDBKeyFromKeyPath=function(e){return"string"==typeof e?e:e.join("_")},e.normalizeUnionKeyValue=function(e){return Array.isArray(e)?JSON.stringify(e):e},e.getKeyFromValue=function(e,t){if("object"!=typeof e)return e;var n=e;if("string"==typeof t)return n[t];var r=[];return t.forEach((function(e){r.push(n[e])})),r},e.addUnionKeyIfNeed=function(t,n){if("string"==typeof n)return t;var r=(0,i.__assign)({},t),o=e.getDBKeyFromKeyPath(n),a=[];return n.forEach((function(e){return a.push(r[e])})),r[o]=e.normalizeUnionKeyValue(a),r},e.deleteUnionKeyIfNeed=function(t,n){if("string"==typeof n)return t;var r=(0,i.__assign)({},t);return r[e.getDBKeyFromKeyPath(n)]=void 0,r},e}(),D=function(){function e(e,t,n,r,o){var i;this.direction=n,this.mode=r,this.engineAspects=o,this.delete=void 0,this.update=void 0,this.cursor=0,this.engineTable=t,this.values=this.preProcessedData(e),this.isPositiveDirection()||(this.cursor=this.values.length-1),r!==a.pF.READ_ONLY&&(this.delete=this.deleteData,this.update=this.updateData),(null===(i=this.engineAspects)||void 0===i?void 0:i.cursor)&&this.applyAspectPatch()}return e.prototype.next=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(t){return(e=this.cursor+(this.isPositiveDirection()?1:-1))<0||e>this.values.length-1?[2,null]:(this.cursor=e,[2,this])}))}))},e.prototype.value=function(){return this.values[this.cursor]},e.prototype[Symbol.asyncIterator]=function(){return new M(this)},e.prototype.deleteData=function(){var e=k.getKeyFromValue(this.value(),this.engineTable.keyPath);return this.engineTable.delete(e)},e.prototype.updateData=function(e){return this.engineTable.upsert(e)},e.prototype.isPositiveDirection=function(){return"next"===this.direction||"nextunique"===this.direction},e.prototype.isUniqueDirection=function(){return"nextunique"===this.direction||"prevunique"===this.direction},e.prototype.preProcessedData=function(e){return this.isUniqueDirection()?(0,i.__spreadArray)([],(0,i.__read)(new Set(e))):e},e.prototype.applyAspectPatch=function(){var e,t=null===(e=this.engineAspects)||void 0===e?void 0:e.cursor;this.mode!==a.pF.READ_ONLY&&(null==t||t.delete.patch(this,"delete"),null==t||t.update.patch(this,"update")),null==t||t.next.patch(this,"next"),null==t||t.value.patch(this,"value")},e}(),M=function(){function e(e){this.currentCursor=e}return e.prototype[Symbol.asyncIterator]=function(){return this},e.prototype.next=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,t;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return this.currentCursor?(e=this.currentCursor.value(),t=this,[4,this.currentCursor.next()]):[2,{value:void 0,done:!0}];case 1:return t.currentCursor=n.sent(),[2,{value:e,done:!1}]}}))}))},e}(),A=s.sH.withMessageCreator("UnSupportError Error",(function(e){return"client db does not support "+e})),L=s.sH.withMessageCreator("openDBError",(function(e){return"open db error in database , msg: "+e})),N=s.sH.withMessageCreator("tableNotExist",(function(e){return e+" is not exist in the database"})),B=s.sH.withMessageCreator("indexNotExist",(function(e){return e+" is not exist in the table"})),F=s.sH.withDefaultMessage("WhereOrUnsupportedError","multiple where clause is not supported in native engine"),U=s.sH.withMessageCreator("DBOperationError",(function(e){return"query or write db has error, msg: "+e}));function H(e,t){var n=t.collections.filter((function(t){return t.name===e}));if(!n.length)throw new N(e);return n[0]}function j(e,t,n){if(e.err_code||e.err_msg){var r=new U("has error in "+t+" opt, code: "+e.err_code+" msg: "+e.err_msg);throw null==n||n(r),r}}var G,V=function(){function e(){this.conditions=[],this.limitCount=Number.MAX_VALUE,this.offsetCount=0,this.orders=[]}return e.prototype.addKeyQueryCondition=function(e,t){var n=this;if("string"==typeof e)return this.addCondition(e,t);if(t instanceof Array)return this.addCondition(k.getDBKeyFromKeyPath(e),k.normalizeUnionKeyValue(t));if(!(t instanceof IDBKeyRange))throw new Error("unsupported key: "+t);var r=t.upper,o=t.upperOpen,i=t.lower,a=t.lowerOpen;return e.forEach((function(t,s){var c=null==i?void 0:i[s],l=null==r?void 0:r[s];if(void 0===c&&void 0===l)throw new Error("key range query param has error, keyPath: "+e+" lower: "+i+", upper: "+r);void 0!==c&&void 0!==l?n.addCondition(t,IDBKeyRange.bound(c,l,a,o)):void 0!==c?n.addCondition(t,IDBKeyRange.lowerBound(c,a)):n.addCondition(t,IDBKeyRange.upperBound(l,o))})),this},e.prototype.addCondition=function(e,t,n){void 0===n&&(n=E.ONLY);var r,o=n;return t instanceof IDBKeyRange?void 0!==t.lower&&void 0!==t.upper?(o=E.BOUND,r={lower:t.lower,upper:t.upper,lowerOpen:t.lowerOpen,upperOpen:t.upperOpen}):void 0!==t.lower?(o=E.LOWER_BOUND,r={lower:t.lower,open:t.lowerOpen}):(o=E.UPPER_BOUND,r={upper:t.upper,open:t.upperOpen}):r=t,this.conditions.push({type:o,column:e,value:r}),this},e.prototype.setLimit=function(e){return this.limitCount=e,this},e.prototype.setOffset=function(e){return this.offsetCount=e,this},e.prototype.addOrder=function(e,t){var n=x.INCREASE;t===a.As.DESCENDING&&(n=x.DECREASE),this.orders.push({key:e,type:n})},e.prototype.build=function(){return{_conditions:this.conditions,_limitCount:this.limitCount,_offsetCount:this.offsetCount,_orders:this.orders}},e}(),W=function(){function e(e,t,n,r,o){var i,a=this;this.dbName=e,this.table=t,this.mode=r,this.engineAspects=o,this.name=n.name,this.keyPath=n.path,this.unique=null!==(i=n.unique)&&void 0!==i&&i,this.transaction=t.transaction,this.reqErrorObserver=function(e){var t;return null===(t=a.transaction)||void 0===t?void 0:t.notifyTransactionFail(e)},(null==o?void 0:o.index)&&this.applyAspectPatch()}return e.prototype.getAll=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o=this;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return n={command:w.GET_ALL,dbName:this.dbName,tableName:this.table.tableName,where:e?(new V).addKeyQueryCondition(this.keyPath,e).setLimit(null!=t?t:Number.MAX_VALUE).build():void 0},[4,this.sendRequest(n)];case 1:return j(r=i.sent(),"getAll",this.reqErrorObserver),r.result?[2,r.result.map((function(e){return k.deleteUnionKeyIfNeed(e,o.table.keyPath)}))]:[2,[]]}}))}))},e.prototype.getAllKeys=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r=this;return(0,i.__generator)(this,(function(o){switch(o.label){case 0:return[4,this.getAll(null!=e?e:void 0,t)];case 1:return(n=o.sent())?[2,n.map((function(e){return k.getKeyFromValue(e,r.table.keyPath)}))]:[2,[]]}}))}))},e.prototype.get=function(e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return t={command:w.GET,dbName:this.dbName,tableName:this.table.tableName,where:(new V).addKeyQueryCondition(this.keyPath,e).build()},[4,this.sendRequest(t)];case 1:return j(n=r.sent(),"get",this.reqErrorObserver),n.result?[2,k.deleteUnionKeyIfNeed(n.result,this.table.keyPath)]:[2,null]}}))}))},e.prototype.openCursor=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.getAll(e)];case 1:return(n=r.sent())?[2,new D(n,this.table,null!=t?t:"next",this.mode)]:[2,null]}}))}))},e.prototype.sendRequest=function(e){var t,n;(null===(t=this.transaction)||void 0===t?void 0:t.transactionID)&&(e.transaction=this.transaction.transactionID);var r=O.send(e);return null===(n=this.transaction)||void 0===n||n.addResponsePromise(r),r},e.prototype.applyAspectPatch=function(){var e,t=null===(e=this.engineAspects)||void 0===e?void 0:e.index,n=this;null==t||t.get.patch(n,"get"),null==t||t.getAll.patch(n,"getAll"),null==t||t.getAllKeys.patch(n,"getAllKeys"),null==t||t.openCursor.patch(n,"openCursor")},e}(),z=function(){function e(e,t,n,r,o){var i,a,s,c=this;this.dbName=e,this.collectionSchema=t,this.mode=n,this.engineAspects=r,this.transaction=o,this.createIndex=void 0,this.delete=void 0,this.bulkDelete=void 0,this.clear=void 0,this.insert=void 0,this.upsert=void 0,this.deleteIndex=void 0,this.bulkUpsert=void 0,this.keyPath=null!==(a=null===(i=t.key)||void 0===i?void 0:i.path)&&void 0!==a?a:[],this.autoIncrement=!!(null===(s=t.key)||void 0===s?void 0:s.generator),this.tableName=t.name,this.indexNames=t.indices.map((function(e){return k.getDBKeyFromKeyPath(e.path)})),this.initWriteFun(n),this.reqErrorObserver=function(e){var t;return null===(t=c.transaction)||void 0===t?void 0:t.notifyTransactionFail(e)},(null==r?void 0:r.table)&&this.applyAspectPatch()}return e.prototype.query=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o,s=this;return(0,i.__generator)(this,(function(c){switch(c.label){case 0:return n={command:w.GET_ALL,dbName:this.dbName,tableName:this.tableName,where:this.getClientQueryCondition(e)},[4,this.sendRequest(n)];case 1:return j(r=c.sent(),"query",this.reqErrorObserver),r.result&&r.result.length?(o=r.result.map((function(e){return[k.getKeyFromValue(e,s.keyPath),k.deleteUnionKeyIfNeed(e,s.keyPath)]})),t===a.yE.COUNT?[2,o.length]:t===a.yE.KEYS?[2,o.map((function(e){return(0,i.__read)(e,1)[0]}))]:t===a.yE.VALUES?[2,o.map((function(e){return(0,i.__read)(e,2)[1]}))]:[2,o]):[2,[]]}}))}))},e.prototype.supports=function(){return!0},e.prototype.index=function(e){var t=this.collectionSchema.indices.filter((function(t){return t.name===e}));if(!t.length)throw new B(e);return new W(this.dbName,this,t[0],this.mode,this.engineAspects)},e.prototype.getAll=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o=this;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return n={command:w.GET_ALL,dbName:this.dbName,tableName:this.tableName,where:e?(new V).addKeyQueryCondition(this.keyPath,e).setLimit(null!=t?t:Number.MAX_VALUE).build():void 0},[4,this.sendRequest(n)];case 1:return j(r=i.sent(),"getAll",this.reqErrorObserver),r.result&&r.result.length?[2,r.result.map((function(e){return k.deleteUnionKeyIfNeed(e,o.keyPath)}))]:[2,[]]}}))}))},e.prototype.getAllKeys=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r=this;return(0,i.__generator)(this,(function(o){switch(o.label){case 0:return[4,this.getAll(null!=e?e:void 0,t)];case 1:return(n=o.sent())?[2,n.map((function(e){return k.getKeyFromValue(e,r.keyPath)}))]:[2,[]]}}))}))},e.prototype.get=function(e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return t={command:w.GET,dbName:this.dbName,tableName:this.tableName,where:(new V).addKeyQueryCondition(this.keyPath,e).build()},[4,this.sendRequest(t)];case 1:return j(n=r.sent(),"get",this.reqErrorObserver),n.result?[2,k.deleteUnionKeyIfNeed(n.result,this.keyPath)]:[2,null]}}))}))},e.prototype.openCursor=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.getAll(e)];case 1:return(n=r.sent())?[2,new D(n,this,null!=t?t:"next",this.mode,this.engineAspects)]:[2,null]}}))}))},e.prototype.initWriteFun=function(e){var t=this;e===a.pF.VERSION_CHANGE&&(this.createIndex=this.createIndexFun,this.deleteIndex=function(e){}),e!==a.pF.READ_ONLY&&(this.delete=this.deleteData,this.bulkDelete=this.bulkDeleteData,this.clear=this.deleteData,this.insert=this.insertAndUpdate,this.upsert=function(e){return t.insertAndUpdate(e,!0)},this.bulkUpsert=this.bulkUpsertData)},e.prototype.createIndexFun=function(e,t){var n=this.collectionSchema.indices.filter((function(t){return t.name===e}));if(!n.length)throw new B(e);return new W(this.dbName,this,n[0],this.mode)},e.prototype.bulkDeleteData=function(e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return t=e.map((function(e){return k.normalizeUnionKeyValue(e)})),n={command:w.DELETE,dbName:this.dbName,tableName:this.tableName,where:e?(new V).addCondition(k.getDBKeyFromKeyPath(this.keyPath),t,E.IN).build():void 0},[4,this.sendRequest(n)];case 1:return j(r.sent(),"bulkDelete",this.reqErrorObserver),[2]}}))}))},e.prototype.bulkUpsertData=function(e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,n,r=this;return(0,i.__generator)(this,(function(o){switch(o.label){case 0:return t=e.map((function(e){return k.addUnionKeyIfNeed(e,r.keyPath)})).map((function(e){return{tableName:r.tableName,data:e}})),n={command:w.UPDATE_MUTIL_TABLE_DATA,dbName:this.dbName,multiData:t},[4,this.sendRequest(n)];case 1:return j(o.sent(),"bulkUpsert",this.reqErrorObserver),[2,e.map((function(e){return k.getKeyFromValue(e,r.keyPath)}))]}}))}))},e.prototype.insertAndUpdate=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,i.__generator)(this,(function(o){switch(o.label){case 0:return n=k.addUnionKeyIfNeed(e,this.keyPath),r={command:t?w.UPDATE:w.INSERT,dbName:this.dbName,tableName:this.tableName,data:n},[4,this.sendRequest(r)];case 1:return j(o.sent(),t?"upsert":"insert",this.reqErrorObserver),[2,k.getKeyFromValue(e,this.keyPath)]}}))}))},e.prototype.deleteData=function(e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return t={command:w.DELETE,dbName:this.dbName,tableName:this.tableName,where:e?(new V).addKeyQueryCondition(this.keyPath,e).build():void 0},[4,this.sendRequest(t)];case 1:return j(n.sent(),e?"delete":"clear",this.reqErrorObserver),[2]}}))}))},e.prototype.sendRequest=function(e){var t,n;(null===(t=this.transaction)||void 0===t?void 0:t.transactionID)&&(e.transaction=this.transaction.transactionID);var r=O.send(e);return null===(n=this.transaction)||void 0===n||n.addResponsePromise(r),r},e.prototype.getClientQueryCondition=function(e){var t,n,r,o,s,c=new V;if(e.whereClauses.length>1)throw new F;if(!e.whereClauses.length)return c.build();var l=(0,i.__read)(e.whereClauses,1)[0];try{for(var u=(0,i.__values)(Object.entries(l)),d=u.next();!d.done;d=u.next()){var p=(0,i.__read)(d.value,2),h=p[0],f=p[1];if((0,a.ot)(f))c.addKeyQueryCondition(h,f);else if(!this.isEmptyPredicate(f)){var g=f[a.qW.In];Array.isArray(g)&&c.addCondition(k.getDBKeyFromKeyPath(h),g.map(k.normalizeUnionKeyValue),E.IN);var v=f[a.qW.NotIn];Array.isArray(v)&&c.addCondition(k.getDBKeyFromKeyPath(h),v.map(k.normalizeUnionKeyValue),E.NOT_IN);try{for(var y=(r=void 0,(0,i.__values)(Object.entries(f))),m=y.next();!m.done;m=y.next()){var b=(0,i.__read)(m.value,2),_=b[0],C=b[1];if(void 0!==C)if(_!==a.qW.NotEquals){var S=(s={},s[a.qW.Equals]=IDBKeyRange.only(C),s[a.qW.GreaterThan]=IDBKeyRange.lowerBound(C,!0),s[a.qW.GreaterOrEqualThan]=IDBKeyRange.lowerBound(C,!1),s[a.qW.LessThan]=IDBKeyRange.upperBound(C,!0),s[a.qW.LessOrEqualThan]=IDBKeyRange.upperBound(C,!1),s)[_];void 0!==S&&c.addKeyQueryCondition(h,S)}else c.addCondition(k.getDBKeyFromKeyPath(h),[k.normalizeUnionKeyValue(C)],E.NOT_IN)}}catch(e){r={error:e}}finally{try{m&&!m.done&&(o=y.return)&&o.call(y)}finally{if(r)throw r.error}}}}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return void 0!==e.limit&&c.setLimit(e.limit),c.setOffset(e.offset),void 0!==e.order&&c.addOrder(k.getDBKeyFromKeyPath(e.order.path),e.order.type),c.build()},e.prototype.isEmptyPredicate=function(e){return!e||Object.values(e).every((function(e){return void 0===e}))},e.prototype.applyAspectPatch=function(){var e,t=null===(e=this.engineAspects)||void 0===e?void 0:e.table;null==t||t.get.patch(this,"get"),null==t||t.getAll.patch(this,"getAll"),null==t||t.getAllKeys.patch(this,"getAllKeys"),null==t||t.index.patch(this,"index"),null==t||t.openCursor.patch(this,"openCursor"),this.mode===a.pF.VERSION_CHANGE&&(null==t||t.createIndex.patch(this,"createIndex"),null==t||t.deleteIndex.patch(this,"deleteIndex")),this.mode!==a.pF.READ_WRITE&&this.mode!==a.pF.VERSION_CHANGE||(null==t||t.delete.patch(this,"delete"),null==t||t.insert.patch(this,"insert"),null==t||t.upsert.patch(this,"upsert"),null==t||t.clear.patch(this,"clear"),null==t||t.query.patch(this,"query"),null==t||t.bulkDelete.patch(this,"bulkDelete"),null==t||t.bulkUpsert.patch(this,"bulkUpsert"))},e}();!function(e){e.ACTIVE="active",e.COMMITTING="committing",e.COMPLETED="completed"}(G||(G={}));var K=function(){function e(e,t,n,r,o,i){var a,s=this;this.tables=e,this.dbName=t,this.dbSchema=n,this.transactionID=r,this.mode=o,this.engineAspects=i,this.reqSeqFactory=(a=0,function(){return a+=1}),this.dbRequestSeqAndResponseMap=new Map,this.transactionStatus="active",this.autoCommitTimerId=null,this.onTransactionDonePromiseResolve=function(){},this.onTransactionDonePromiseReject=function(){},this.waitingTransactionDonePromise=new Promise((function(e,t){s.onTransactionDonePromiseResolve=e,s.onTransactionDonePromiseReject=t})),(null==i?void 0:i.transaction)&&this.applyAspectPatch(),this.tryToAutoCommit()}return e.prototype.notifyTransactionFail=function(e){this.onTransactionDonePromiseReject(e),this.clearAutoCommitTimer()},e.prototype.waitForTransactionDone=function(){return this.waitingTransactionDonePromise},e.prototype.addResponsePromise=function(e){var t=this,n=this.reqSeqFactory();this.clearAutoCommitTimer(),this.dbRequestSeqAndResponseMap.set(n,e),e.then((function(){t.dbRequestSeqAndResponseMap.delete(n),t.tryToAutoCommit()}))},e.prototype.table=function(e){return new z(this.dbName,H(e,this.dbSchema),this.mode,this.engineAspects,this)},e.prototype.commit=function(e){var t,n,r,o;return(0,i.__awaiter)(this,void 0,void 0,(function(){var a,s;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return this.clearAutoCommitTimer(),"active"!==this.transactionStatus?(e||null===(n=null===(t=window.log)||void 0===t?void 0:t.report)||void 0===n||n.call(t,"transaction_repeat_error",{query:{sessionId:null===(o=null===(r=window.log)||void 0===r?void 0:r.var)||void 0===o?void 0:o.sessionId}}),[2,!0]):this.transactionID?(a={command:w.COMMIT_TRANSACTION,dbName:this.dbName,transaction:this.transactionID},this.transactionStatus="committing",[4,O.send(a)]):(this.onTransactionDonePromiseResolve(),[2,!0]);case 1:return s=i.sent(),this.transactionStatus="completed",s.err_code||s.err_msg?(this.onTransactionDonePromiseReject(),[2,!1]):(this.onTransactionDonePromiseResolve(),[2,!0])}}))}))},e.prototype.rollback=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,t;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return this.transactionID?(e={command:w.ROLLBACK_TRANSACTION,dbName:this.dbName,transaction:this.transactionID},[4,O.send(e)]):(this.onTransactionDonePromiseResolve(),[2,!0]);case 1:return(t=n.sent()).err_code||t.err_msg?(this.onTransactionDonePromiseReject(),[2,!1]):(this.onTransactionDonePromiseResolve(),[2,!0])}}))}))},e.prototype.applyAspectPatch=function(){var e,t=null===(e=this.engineAspects)||void 0===e?void 0:e.transaction,n=this;null==t||t.commit.patch(n,"commit"),null==t||t.rollback.patch(n,"rollback"),null==t||t.table.patch(n,"table")},e.prototype.tryToAutoCommit=function(){var e=this;0===this.dbRequestSeqAndResponseMap.size&&null===this.autoCommitTimerId&&(this.autoCommitTimerId=setTimeout((function(){0===e.dbRequestSeqAndResponseMap.size&&"active"===e.transactionStatus&&e.commit(!0)})))},e.prototype.clearAutoCommitTimer=function(){null!==this.autoCommitTimerId&&(clearTimeout(this.autoCommitTimerId),this.autoCommitTimerId=null)},e}(),q=function(){function e(e,t,n,r,o,i){this.isSupportTransactions=o,this.engineAspects=i,this.schema=e,this.name=t,this.version=n,this.tableNames=r,(null==i?void 0:i.database)&&this.applyAspectPatch()}return e.prototype.setVersionChangeListener=function(){},e.prototype.close=function(){},e.prototype.createTable=function(e){return new z(this.name,H(e,this.schema),a.pF.VERSION_CHANGE,this.engineAspects)},e.prototype.deleteTable=function(){},e.prototype.transaction=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,i.__generator)(this,(function(o){switch(o.label){case 0:return this.isSupportTransactions&&t!==a.pF.READ_ONLY?(n={command:w.BEGIN_TRANSACTION,dbName:this.name},[4,O.send(n)]):[2,new K(e,this.name,this.schema,void 0,null!=t?t:a.pF.READ_ONLY,this.engineAspects)];case 1:return j(r=o.sent(),"startTransaction"),[2,new K(e,this.name,this.schema,r.result,null!=t?t:a.pF.READ_ONLY,this.engineAspects)]}}))}))},e.prototype.table=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(n){return[2,new z(this.name,H(e,this.schema),t,this.engineAspects)]}))}))},e.prototype.applyAspectPatch=function(){var e,t=null===(e=this.engineAspects)||void 0===e?void 0:e.database;null==t||t.deleteTable.patch(this,"deleteTable"),null==t||t.createTable.patch(this,"createTable"),null==t||t.transaction.patch(this,"transaction"),null==t||t.table.patch(this,"table"),null==t||t.close.patch(this,"close")},e}(),Y=function(e,t){return e===t?0:e>t?1:-1},Q=function(){function e(){this.cmp=Y}return e.prototype.deleteDB=function(e){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return[2]}))}))},e.prototype.setAspects=function(e){this.engineAspects=e,e.openDB.patch(this,"openDB"),e.deleteDB.patch(this,"deleteDB")},e.prototype.openDB=function(e,t,n,r){var o,s,c,l;return(0,i.__awaiter)(this,void 0,void 0,(function(){var u,d,p,h;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,O.send({command:w.INIT,dbName:e,table:this.getTableInfo(t)})];case 1:if((u=i.sent()).err_msg||u.err_code)throw new L(e+" errCode: "+u.err_code+", errMsg: "+u.err_msg);return[4,this.getDBExistTableNames(e)];case 2:return d=i.sent(),p=new q(t,e,null!=n?n:0,d,null!==(s=null===(o=u.result)||void 0===o?void 0:o.supportTransaction)&&void 0!==s&&s,this.engineAspects),(null===(c=u.result)||void 0===c?void 0:c.dbSchemaChange)&&(null==r?void 0:r.upgrade)?[4,p.transaction(d,a.pF.VERSION_CHANGE)]:[2,p];case 3:return h=i.sent(),null===(l=null==r?void 0:r.upgrade)||void 0===l||l.call(r,p,0,null!=n?n:null,h),[4,h.waitForTransactionDone()];case 4:return i.sent(),[2,p]}}))}))},e.prototype.getDBExistTableNames=function(e){var t;return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,i.__generator)(this,(function(o){switch(o.label){case 0:return[4,O.send({dbName:e,command:w.GET_ALL,tableName:a.O3.name})];case 1:return(n=o.sent()).err_code||n.err_msg||!(null===(t=n.result)||void 0===t?void 0:t.length)?[2,[]]:(r=n.result,[2,(0,i.__spreadArray)((0,i.__spreadArray)([],(0,i.__read)(r)),[a.O3]).map((function(e){return e.name}))])}}))}))},e.prototype.getTableInfo=function(e){return e?e.collections.map((function(e){var t;if(!(null===(t=e.key)||void 0===t?void 0:t.path))throw new A("key autoIncrement");var n=e.indices.map((function(e){if(e.path instanceof Array)throw new A("union index");return k.getDBKeyFromKeyPath(e.path)}));return e.key.path instanceof Array&&e.key.path.forEach((function(e){n.push(e)})),{tableName:e.name,keyName:k.getDBKeyFromKeyPath(e.key.path),indexs:(0,i.__spreadArray)([],(0,i.__read)(new Set(n)))}})):[]},e}(),Z=Q,X=function(e,t){return X=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},X(e,t)};function J(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}X(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var $,ee,te=function(){return te=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},te.apply(this,arguments)};function ne(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function re(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}!function(e){e[e.indexDB=1]="indexDB",e[e.nativeDB=2]="nativeDB"}(ee||(ee={}));var oe=(($={})[ee.indexDB]=I.default,$[ee.nativeDB]=Z,$),ie=function(){function e(e){var t;void 0===e&&(e={type:ee.indexDB,disableAutoOpen:!0}),this.config=e;var n=oe[e.type];this.storage=new c.default({name:null!==(t=e.databaseName)&&void 0!==t?t:o.DB_NAME,version:4,engine:new n,databaseSchema:'{"name":"unknown","collections":[{"name":"DocumentData","key":{"path":"key"},"indices":[{"name":"secretId","path":"secretId","unique":false},{"name":"globalPadId","path":"globalPadId","unique":false},{"name":"subGlobalPadId","path":"subGlobalPadId","unique":false},{"name":"subDocType","path":"subDocType","unique":false},{"name":"version","path":"version","unique":false},{"name":"type","path":"type","unique":false},{"name":"uid","path":"uid","unique":false},{"name":"subId","path":"subSheetId","unique":false},{"name":"chunkId","path":"chunkId","unique":false}],"properties":["key","secretId","globalPadId","subGlobalPadId","subDocType","version","type","uid","subId","chunkId","taskId","data","docType","docStatus","createTimestamp","lastModifyTimestamp","dataVersion","isDefaultChunk"]},{"name":"DocumentEntities","key":{"path":"key"},"indices":[],"properties":["key","data"]},{"name":"NewDocumentIds","key":{"path":"globalPadId"},"indices":[],"properties":["globalPadId","secretId","documentType","localPadId","isCreated"]},{"name":"DocumentStatus","key":{"path":"globalPadId"},"indices":[{"name":"secretId","path":"secretId","unique":false},{"name":"uid","path":"uid","unique":false}],"properties":["globalPadId","secretId","uid","lastSyncTimestamp","lastErrorTimestamp"]},{"name":"OfflineData","key":{"path":"key"},"indices":[{"name":"secretId","path":"secretId","unique":false},{"name":"globalPadId","path":"globalPadId","unique":false},{"name":"subGlobalPadId","path":"subGlobalPadId","unique":false},{"name":"subDocType","path":"subDocType","unique":false},{"name":"version","path":"version","unique":false},{"name":"type","path":"type","unique":false},{"name":"uid","path":"uid","unique":false},{"name":"subId","path":"subSheetId","unique":false},{"name":"chunkId","path":"chunkId","unique":false}],"properties":["key","secretId","globalPadId","subGlobalPadId","subDocType","version","type","uid","subId","chunkId","taskId","data","docType","docStatus","createTimestamp","lastModifyTimestamp","dataVersion","isDefaultChunk"]},{"name":"PadInfo","key":{"path":"key"},"indices":[{"name":"secretId","path":"secretId","unique":false},{"name":"globalPadId","path":"globalPadId","unique":false},{"name":"uid","path":"uid","unique":false}],"properties":["key","secretId","globalPadId","uid","addListTimestamp","attribute","childrenLength","clientVersion","createTimestamp","creator","creatorDomain","icon","docPolicy","docPrivilege","thumbnail","docType","docTypeDesc","url","domainId","dver","folder","folderId","folderPolicy","folderPrivilege","isDeleted","isManualOffline","isMyCreated","isMydoc","isOfflineCache","isRencent","isShareToMe","hasSnapShot","isStar","isAddedToMy","isCollected","isOwner","isPinned","isShortcut","isUserChangeTitle","lastSyncTimestamp","lastBrowseTimestamp","lastCollectTimestamp","lastDeleteTimestamp","lastModifyTimestamp","lastModifyNick","lastModifyUid","lastPinnedTimestamp","listInfoType","listType","offlineCommiting","offlineCommitSuccessd","originFolderId","ownerNick","ownerUid","padId","parentFolderId","parents","privilege","status","title","type","hasLocalChanges","docSubType","officialAuthInfo","personalizeInfo","nativeEngineStatusRecord","nativeEngineDocPrivilege","data","ext","isOfflineCacheByNative","mimeType","ownerVipInfo"]},{"name":"Users","key":{"path":"key"},"indices":[{"name":"tinyId","path":"tinyId","unique":false},{"name":"nowUserIndex","path":"nowUserIndex","unique":false},{"name":"docId","path":"docId","unique":false},{"name":"pageType","path":"pageType","unique":false},{"name":"wedriveUin","path":"wedriveUin","unique":false},{"name":"wedocOpenId","path":"wedocOpenId","unique":false}],"properties":["key","tinyId","nowUserIndex","docId","pageType","wedriveUin","wedocOpenId","corpId","corpName","englishName","loginType","openId","uidSource","uin","userId","userName","userPic","updateTime","settings","bindUserInfo","vipUserInfo"]}]}',disableAutoOpen:e.disableAutoOpen,plugins:this.getPlugins(e),supportCompatibleOpen:!0})}return e.prototype.dispose=function(){this.storage.close()},e.prototype.init=function(){return ne(this,void 0,void 0,(function(){var e=this;return re(this,(function(t){return[2,new Promise((function(t){var n,r=setTimeout((function(){var n,r;null===(r=null===(n=e.config.logger)||void 0===n?void 0:n.error)||void 0===r||r.call(n,"dababase init timeout."),t(!1)}),null!==(n=e.config.timeout)&&void 0!==n?n:15e3);e.storage.open().then((function(){t(!0),clearTimeout(r)})).catch((function(){t(!1),clearTimeout(r)}))}))]}))}))},e.prototype.getPlugins=function(e){var t,n=[];if(e.logger){var r=new m({logger:e.logger,disabled:!!e.disabled,verbose:!!e.verbose});n.push(r)}return e.monitorReporter&&n.push((t=e.monitorReporter,new R({onEvent:function(e){t.report("storageActionResultAndCost",{action:e.action,module:e.module,retCode:e.actionExecuteState,cost:e.cost,time:e.time.getTime(),errorMsg:e.errorMsg})}}))),n},e}(),ae="TencentDocsBackup",se=function(e){function t(t){void 0===t&&(t={type:ee.indexDB,disableAutoOpen:!0});var n=e.call(this,t)||this;return n.config=t,n}return J(t,e),t}(ie),ce=function(){function e(e){this.collection=e}return e.prototype.getChanges=function(e,t){return ne(this,void 0,void 0,(function(){var n;return re(this,(function(r){return n=this.collection.where({uid:e.uid,secretId:e.secretId,subGlobalPadId:e.subGlobalPadId,subDocType:{in:e.subDocType},type:{in:e.types},docType:e.docType,dataVersion:e.dataVersion,subId:{in:e.subId?(new Array).concat(e.subId):void 0},chunkId:{in:e.chunkId?(new Array).concat(e.chunkId):void 0},version:{">=":null==t?void 0:t.startVersion,"<=":null==t?void 0:t.endVersion}}),(null==t?void 0:t.orderPath)&&n.orderBy(t.orderPath,t.sortOrder),(null==t?void 0:t.limit)&&n.take(t.limit),[2,n.values()]}))}))},e.prototype.upsertChanges=function(e){return ne(this,void 0,void 0,(function(){return re(this,(function(t){switch(t.label){case 0:return[4,this.collection.bulkUpsert(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.deleteChanges=function(e){return ne(this,void 0,void 0,(function(){var t,n,r,o,i,a,s;return re(this,(function(c){switch(c.label){case 0:return t=e.uid,n=e.secretId,r=e.globalPadId,o=e.types,i=e.taskIds,a=e.subGlobalPadId,s=e.subDocType,[4,this.collection.where({uid:t,secretId:n,globalPadId:r,subGlobalPadId:a,subDocType:{in:s},type:{in:o},taskId:{in:i},version:{">":e.startVersion||Number.MIN_SAFE_INTEGER,"<":e.endVersion||Number.MAX_SAFE_INTEGER}}).clear()];case 1:return c.sent(),[2]}}))}))},e}(),le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J(t,e),t}(ce),ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J(t,e),t}(ce),de=function(){function e(e){this.collection=e}return e.prototype.popDocumentId=function(e){return ne(this,void 0,void 0,(function(){var t,n,r;return re(this,(function(o){switch(o.label){case 0:return[4,this.collection.where({documentType:e}).first()];case 1:return(t=o.sent())?(n=t.globalPadId,[4,this.collection.delete(n)]):[2,null];case 2:return r=o.sent(),n!==r?[2,null]:[2,t]}}))}))},e.prototype.upsertDocumentIds=function(e){return ne(this,void 0,void 0,(function(){return re(this,(function(t){switch(t.label){case 0:return[4,this.collection.bulkUpsert(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.countDocumentIds=function(e){return ne(this,void 0,void 0,(function(){return re(this,(function(t){return[2,this.collection.where({documentType:e}).count()]}))}))},e.prototype.deleteDocumentIds=function(){return ne(this,void 0,void 0,(function(){return re(this,(function(e){switch(e.label){case 0:return[4,this.collection.clear()];case 1:return e.sent(),[2]}}))}))},e}(),pe=function(){function e(e){this.collection=e}return e.prototype.getStatus=function(e,t){return ne(this,void 0,void 0,(function(){return re(this,(function(n){switch(n.label){case 0:return[4,this.collection.where({secretId:t,uid:e}).first()];case 1:return[2,n.sent()]}}))}))},e.prototype.upsertStatus=function(e){return ne(this,void 0,void 0,(function(){return re(this,(function(t){switch(t.label){case 0:return[4,this.collection.upsert(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.deleteStatus=function(e,t){return ne(this,void 0,void 0,(function(){return re(this,(function(n){switch(n.label){case 0:return[4,this.collection.where({secretId:t,uid:e}).clear()];case 1:return n.sent(),[2]}}))}))},e}(),he=function(){function e(e){this.collection=e}return e.prototype.getEntity=function(e){return ne(this,void 0,void 0,(function(){return re(this,(function(t){switch(t.label){case 0:return[4,this.collection.get(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.upsertEntities=function(e){return ne(this,void 0,void 0,(function(){return re(this,(function(t){switch(t.label){case 0:return[4,this.collection.bulkUpsert(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.deleteEntity=function(e){return ne(this,void 0,void 0,(function(){return re(this,(function(t){switch(t.label){case 0:return[4,this.collection.delete(e)];case 1:return t.sent(),[2]}}))}))},e}(),fe=function(){function e(e){this.collection=e}return e.prototype.getPadInfo=function(e,t){return ne(this,void 0,void 0,(function(){var n;return re(this,(function(r){switch(r.label){case 0:return[4,this.getPadInfos({uid:e,secretId:t})];case 1:return 0===(n=r.sent()).length?[2,null]:[2,n.shift()]}}))}))},e.prototype.getPadInfos=function(e){return ne(this,void 0,void 0,(function(){return re(this,(function(t){return[2,this.collection.where({uid:e.uid,secretId:{in:e.secretId?(new Array).concat(e.secretId):void 0}}).values()]}))}))},e.prototype.upsertPadInfo=function(e){return ne(this,void 0,void 0,(function(){return re(this,(function(t){switch(t.label){case 0:return[4,this.collection.upsert(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.updateField=function(e,t,n){return ne(this,void 0,void 0,(function(){var r;return re(this,(function(o){switch(o.label){case 0:return[4,this.collection.where({uid:e,secretId:t}).first()];case 1:return(r=o.sent())?(Object.assign(r,n),[4,this.collection.upsert(r)]):[2];case 2:return o.sent(),[2]}}))}))},e.prototype.deletePadInfo=function(e,t){return ne(this,void 0,void 0,(function(){return re(this,(function(n){switch(n.label){case 0:return[4,this.collection.where({uid:e,secretId:t}).clear()];case 1:return n.sent(),[2]}}))}))},e}(),ge=function(){function e(e){this.collection=e}return e.prototype.getUserInfoByNowUserIndex=function(e){return ne(this,void 0,void 0,(function(){var t;return re(this,(function(n){switch(n.label){case 0:return[4,this.collection.where({nowUserIndex:e}).last()];case 1:return(t=n.sent())?[2,t]:[4,this.getUserInfoLastByAll()];case 2:return[2,n.sent()]}}))}))},e.prototype.getUserInfoByDocInfo=function(e,t){return ne(this,void 0,void 0,(function(){var n;return re(this,(function(r){switch(r.label){case 0:return[4,this.collection.where({pageType:e,docId:t}).last()];case 1:return(n=r.sent())?[2,n]:[4,this.getUserInfoLastByAll()];case 2:return[2,r.sent()]}}))}))},e.prototype.addUserInfo=function(e){return ne(this,void 0,void 0,(function(){var t;return re(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.collection.get(e.key)];case 1:return t=n.sent(),this.collection.upsert(te(te({},t),e)),[2,!0];case 2:return n.sent(),[2,!1];case 3:return[2]}}))}))},e.prototype.updateUserInfo=function(e,t){return ne(this,void 0,void 0,(function(){var n,r;return re(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,this.collection.where(e).values()];case 1:return(n=o.sent()).length?(r=n.map((function(e){return te(te({},e),t)})),[4,this.collection.bulkUpsert(r)]):[2,!1];case 2:return o.sent(),[2,!0];case 3:return o.sent(),[2,!1];case 4:return[2]}}))}))},e.prototype.getUserInfoLastByAll=function(){return ne(this,void 0,void 0,(function(){return re(this,(function(e){switch(e.label){case 0:return[4,this.collection.last()];case 1:return[2,e.sent()]}}))}))},e}()},56086:function(e,t,n){var r={};function o(){return"undefined"!=typeof window}function i(){return void 0!==n.g}var a=o()?window:i()?n.g:o||"undefined"==typeof self?(i()&&n.g.describe,r):self;t.Z=a},5448:function(e,t,n){var r,o;n.d(t,{Q:function(){return r},R:function(){return o}}),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.QQ=1]="QQ",e[e.WX=2]="WX",e[e.WORK=3]="WORK",e[e.EMAIL=4]="EMAIL",e[e.PHONE=8]="PHONE",e[e.WORK_COMBINATION=9]="WORK_COMBINATION",e[e.TOWER=10]="TOWER",e[e.ROBOT=11]="ROBOT",e[e.QFYF=12]="QFYF",e[e.OPEN=13]="OPEN",e[e.MEETING=14]="MEETING"}(r||(r={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.WECHAT=4]="WECHAT",e[e.WEWORK=3]="WEWORK"}(o||(o={}))},89057:function(e,t,n){n.d(t,{L:function(){return r}});var r=n(5593).default.getInstance()},46163:function(e,t,n){n.d(t,{$W:function(){return r},ej:function(){return s},w$:function(){return c}});var r,o=n(56086),i=n(88694),a="document";function s(e){if(!(0,i.e$)(o.Z,a))return null;var t=new RegExp("(?:^|;+|\\s+)".concat(e,"=([^;]*)")),n=document.cookie.match(t);return(n?n[1]:null)||null}function c(e){return s(e)}!function(e){e.xsrf="TOK",e.devRouteId="dev_route_id",e.devOaName="dev_oa_name",e.fd="fd",e.envId="env_id",e.sid="SID",e.sids="SID_S",e.uid="uid",e.uidKey="uid_key",e.uin="uin",e.loginTime="loginTime",e.hasBeenLogin="has_been_login",e.adtag="adtag",e.plUin="p_luin",e.pUin="p_uin",e.pSkey="p_skey",e.plSkey="p_lskey"}(r||(r={}))},99181:function(e,t,n){n.d(t,{u:function(){return a}});var r=n(85556),o=function(e){return"".concat(String(e),"__locked")},i=function(e){return"".concat(String(e),"__result")};function a(){return function(e,t,n){var a=n.value,s=o(t),c=i(t);n.value=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this[s]||(this[c]=a.call.apply(a,(0,r.__spreadArray)([this],(0,r.__read)(e),!1)),this[s]=!0),this[c]}}}},36023:function(e,t,n){n.r(t),n.d(t,{Emitter:function(){return s}});var r=n(85556),o=n(60125),i=function(){function e(t){this.element=t,this.next=e.Undefined,this.prev=e.Undefined}return e.Undefined=new e(void 0),e}(),a=function(){function e(){this.first=i.Undefined,this.last=i.Undefined,this.mSize=0}return Object.defineProperty(e.prototype,"size",{get:function(){return this.mSize},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return this.first===i.Undefined},e.prototype.clear=function(){this.first=i.Undefined,this.last=i.Undefined,this.mSize=0},e.prototype.unshift=function(e){return this.insert(e,!1)},e.prototype.push=function(e){return this.insert(e,!0)},e.prototype.shift=function(){if(this.first!==i.Undefined){var e=this.first.element;return this.remove(this.first),e}},e.prototype.pop=function(){if(this.last!==i.Undefined){var e=this.last.element;return this.remove(this.last),e}},e.prototype[Symbol.iterator]=function(){var e;return(0,r.__generator)(this,(function(t){switch(t.label){case 0:e=this.first,t.label=1;case 1:return e===i.Undefined?[3,3]:[4,e.element];case 2:return t.sent(),e=e.next,[3,1];case 3:return[2]}}))},e.prototype.insert=function(e,t){var n=this,r=new i(e);if(this.first===i.Undefined)this.first=r,this.last=r;else if(t){var o=this.last;this.last=r,r.prev=o,o.next=r}else{var a=this.first;this.first=r,r.next=a,a.prev=r}this.mSize+=1;var s=!1;return function(){s||(s=!0,n.remove(r))}},e.prototype.remove=function(e){if(e.prev!==i.Undefined&&e.next!==i.Undefined){var t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===i.Undefined&&e.next===i.Undefined?(this.first=i.Undefined,this.last=i.Undefined):e.next===i.Undefined?(this.last=this.last.prev,this.last.next=i.Undefined):e.prev===i.Undefined&&(this.first=this.first.next,this.first.prev=i.Undefined);this.mSize-=1},e}(),s=function(){function e(e){this.disposed=!1,this.options=e}return Object.defineProperty(e.prototype,"event",{get:function(){var e=this;return this.mEvent||(this.mEvent=function(t,n,r){var i,s,c;e.listeners||(e.listeners=new a);var l=e.listeners.isEmpty();l&&(null===(i=e.options)||void 0===i?void 0:i.onFirstListenerAdd)&&e.options.onFirstListenerAdd(e);var u=e.listeners.push(n?[t,n]:t);l&&(null===(s=e.options)||void 0===s?void 0:s.onFirstListenerDidAdd)&&e.options.onFirstListenerDidAdd(e),(null===(c=e.options)||void 0===c?void 0:c.onListenerDidAdd)&&e.options.onListenerDidAdd(e,t,n);var d={dispose:function(){var t;e.disposed||(u(),(null===(t=e.options)||void 0===t?void 0:t.onLastListenerRemove)&&(e.listeners&&!e.listeners.isEmpty()||e.options.onLastListenerRemove(e))),(0,o.markTracked)(d)},disposableId:"event"};return Array.isArray(r)&&r.push(d),(0,o.trackDisposable)(d),d}),this.mEvent},enumerable:!1,configurable:!0}),e.prototype.fire=function(e){var t,n;if(this.listeners){this.deliveryQueue||(this.deliveryQueue=new a);try{for(var o=(0,r.__values)(this.listeners),i=o.next();!i.done;i=o.next()){var s=i.value;this.deliveryQueue.push([s,e])}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}for(;this.deliveryQueue.size>0;){var c=(0,r.__read)(this.deliveryQueue.shift(),2),l=(s=c[0],c[1]);try{"function"==typeof s?s.call(void 0,l):s[0].call(s[1],l)}catch(e){console.error(e)}}}},e.prototype.dispose=function(){this.listeners&&this.listeners.clear(),this.deliveryQueue&&this.deliveryQueue.clear(),this.disposed=!0},e}()},31072:function(e,t,n){n.r(t),n.d(t,{getHash:function(){return a},getHost:function(){return s},getHostname:function(){return c},getHref:function(){return f},getOrigin:function(){return u},getPathname:function(){return l},getPort:function(){return h},getProtocol:function(){return d},getQuery:function(){return g},getSearch:function(){return p},getU:function(){return v}});var r=n(56086),o=n(88694),i="location";function a(){return(0,o.e$)(r.Z,i)?location.hash:""}function s(){return(0,o.e$)(r.Z,i)?location.host:""}function c(){return(0,o.e$)(r.Z,i)?location.hostname:""}function l(){return(0,o.e$)(r.Z,i)?location.pathname:""}function u(){return(0,o.e$)(r.Z,i)?location.origin:""}function d(){return(0,o.e$)(r.Z,i)?location.protocol:""}function p(){return(0,o.e$)(r.Z,i)?location.search:""}function h(){return(0,o.e$)(r.Z,i)?location.port:""}function f(){return(0,o.e$)(r.Z,i)?location.href:""}function g(e,t){if(void 0===t&&(t={shouldDecodeURI:!1}),!(0,o.e$)(r.Z,i))return"";var n=new RegExp("(\\?|&)".concat(e,"=([^&]*)(#|&|$)")),a=((null==t?void 0:t.shouldDecodeURI)?decodeURIComponent(p()):p()).match(n);return a?decodeURIComponent(a[2]):""}function v(){return g("u")}},88694:function(e,t,n){n.d(t,{MO:function(){return a},e$:function(){return o},P1:function(){return i}});var r=n(23742);function o(e,t){return null!==e&&Object.prototype.hasOwnProperty.call(e,t)}function i(e){if(!e||!(0,r.isObject)(e))return e;var t={};return Object.keys(e).forEach((function(n){var r,o=(r=n).length<1?r:(r[0].toLowerCase()+r.substr(1)).replace(/([A-Z])/g,(function(e){return"_".concat(e.toLowerCase())}));if(Object.prototype.hasOwnProperty.call(e,n))if(e[n]instanceof Array){var a=e[n],s=[];a.forEach((function(e){var t=i(e);s.push(t)})),t[o]=s}else e[n]instanceof Object?t[o]=i(e[n]):t[o]=e[n]})),t}function a(e){if(!e||!(0,r.isObject)(e))return e;var t={};return Object.keys(e).forEach((function(n){var r=function(e){for(var t=e.split("_"),n="",r=0;r<t.length;r++){var o=t[r];o.length>0&&(n+=0===r?o:o="".concat(o[0].toUpperCase()).concat(o.substring(1)))}return n}(n);if(Object.prototype.hasOwnProperty.call(e,n))if(e[n]instanceof Array){var o=e[n],i=[];o.forEach((function(e){var t=a(e);i.push(t)})),t[r]=i}else e[n]instanceof Object?t[r]=a(e[n]):t[r]=e[n]})),t}},75789:function(e,t,n){n.d(t,{H:function(){return o}});var r=n(38298),o=function(e){var t=e;(0,r.tdwSingle)(t)}},28703:function(e,t,n){n.d(t,{Z:function(){return r},r:function(){return o}});var r=function(){try{var e=localStorage.getItem("person-account-wedriveUin-tinyid-map")||"{}";return JSON.parse(e)}catch(e){return console.error(e),{}}},o=function(e){var t=e.wedriveUin,n=e.tinyid;try{var r=localStorage.getItem("person-account-wedriveUin-tinyid-map")||"{}",o=JSON.parse(r);o[t]=n,localStorage.setItem("person-account-wedriveUin-tinyid-map",o)}catch(e){console.error(e)}}},23742:function(e,t,n){function r(e,t){return Object.prototype.toString.call(t)==="[object ".concat(e,"]")}function o(e){return r("Boolean",e)}function i(e){return r("Number",e)}function a(e){return r("String",e)}function s(e){return r("Function",e)}function c(e){return r("Array",e)}function l(e){return r("Date",e)}function u(e){return r("RegExp",e)}function d(e){return r("Object",e)}function p(e){return r("Error",e)}n.r(t),n.d(t,{isArray:function(){return c},isBoolean:function(){return o},isDate:function(){return l},isError:function(){return p},isFunction:function(){return s},isNumber:function(){return i},isObject:function(){return d},isRegExp:function(){return u},isString:function(){return a},isType:function(){return r}})},73154:function(e,t,n){n.d(t,{At:function(){return s}});var r="#",o="?",i="&";function a(e,t){if(e.includes(o)){var n=e;return Object.keys(t).map((function(e){n=function(e,t,n){var r=e.split(o),a=r[1].split(i),s=!0,c=new Map;a.forEach((function(e){var t=e.split("=");c.set(t[0],t[1])})),a.some((function(e){0===e.indexOf("".concat(t,"="))&&(c.set(t,n),s=!1)})),s&&c.set(t,n);var l=[];return c.forEach((function(e,t){var n="".concat(t,"=").concat(e);l.push(n)})),r[1]=l.join(i),r.join(o)}(n,e,t[e])})),n}var r=Object.keys(t).map((function(e){return"".concat(e,"=").concat(t[e])})).join(i);return"".concat(e,"?").concat(r)}function s(e,t){if(Object.keys(t).length<1)return e;if(e.includes(r)){var n=e.split(r);return n[0]=a(n[0],t),n.join(r)}return a(e,t)}},85109:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CREATE_INSTANCE_NOT_REGISTERED=t.LOADER_BASE_STATIC_INSTANTIATION=t.LOADER_BASE_ORPHAN_INSTANTIATION=t.SERVICE_NAME_DECORATOR_MISUSE=t.GRAPH_CYCLIC_DEPENDENCY=t.SERVICES_CYCLIC_DEPENDENCY=t.RESOLVE_UNKNOWN_SERVICE=t.CREATING_UNKNOWN_SERVICE=t.DEPEND_ON_UNKNOWN_SERVICE=t.INVOKE_UNKNOWN_SERVICE=t.OVERRIDE_WARNING=t.ILLEGAL_ATTACH_PARENT_STATE=t.ILLEGAL_MERGE_STATE=t.ILLEGAL_HIERARCHY_STATE=t.AMBIGUOUS_MATCH_SERVICE=t.UPDATE_HOLDER_INSTANCE=t.AMBIGUOUS_OVERRIDE_SERVICE=t.SERVICE_DECORATOR_PARAMETER_ERROR=t.MULTI_INJECT_DECORATOR_MISUSED=t.INJECT_DECORATOR_MISUSED=t.INJECT_DECORATOR_PARAMETER_ERROR=t.POST_CONSTRUCTOR_DECORATOR_MISUSED=t.DUPLICATED_METHOD_METADATA=t.DUPLICATED_PARAMETER_METADATA=t.INVALID_DECORATOR_OPERATION=void 0,t.INVALID_DECORATOR_OPERATION="Metadata must be applied to the parameters of a class constructor",t.DUPLICATED_PARAMETER_METADATA=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"Metadata key was used more than once for parameter of class "+e[0]+" in position "+e[1]+", already has metadata: ["+e[2]+"], newly add metadata: ["+e[3]+"]"},t.DUPLICATED_METHOD_METADATA=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"Metadata key "+e[0]+" was used more than once, it has already been used in method ["+e[1]+"]"},t.POST_CONSTRUCTOR_DECORATOR_MISUSED="@postConstructor: only support to be used as method decorator",t.INJECT_DECORATOR_PARAMETER_ERROR=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"inject with illegal serviceIdentifier "+e[0]+" "+e[1]+" "+e[2]},t.INJECT_DECORATOR_MISUSED="@inject: only support to be used as parameters decorator",t.MULTI_INJECT_DECORATOR_MISUSED="@inject: only support parameters injection",t.SERVICE_DECORATOR_PARAMETER_ERROR=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"use decorator @service with illegal instantiationIdentifier parameter "+e[0]},t.AMBIGUOUS_OVERRIDE_SERVICE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"Ambiguous override for serviceIdentifier: "+e[0]},t.UPDATE_HOLDER_INSTANCE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"Should not update identifier "+e[0]+" holder's descriptor, when "+e[1]+" already has a instance"},t.AMBIGUOUS_MATCH_SERVICE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"Ambiguous match found for serviceIdentifier: "+e[0]},t.ILLEGAL_HIERARCHY_STATE="Illegal hierarchy state: elder border is duplicated",t.ILLEGAL_MERGE_STATE="Illegal merge state: cannot merge a node with a parent to anther node",t.ILLEGAL_ATTACH_PARENT_STATE="Illegal parent state: there is already a parent node",t.OVERRIDE_WARNING=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"Warning: try to override service ["+e[0]+"], which with no supportsOverride options"},t.INVOKE_UNKNOWN_SERVICE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"[invokeFunction] get unknown service '"+e[0]+"'"},t.DEPEND_ON_UNKNOWN_SERVICE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"Service "+e[0]+" depends on unknown service "+e[1]},t.CREATING_UNKNOWN_SERVICE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"IllegalState: creating unknown service instance "+e[0]},t.RESOLVE_UNKNOWN_SERVICE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"IllegalState: resolve unknown service instance "+e[0]},t.SERVICES_CYCLIC_DEPENDENCY="Cyclic dependency between services",t.GRAPH_CYCLIC_DEPENDENCY="May detected cyclic dependency in graph",t.SERVICE_NAME_DECORATOR_MISUSE=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"@ServiceName decorator ["+e[0]+"] can only be used to decorate constructor parameter"},t.LOADER_BASE_ORPHAN_INSTANTIATION="Illegal state: getInstantion return orphan InstantiationService",t.LOADER_BASE_STATIC_INSTANTIATION="Illegal state: staticInstantiationService of LoaderBase can only be set once",t.CREATE_INSTANCE_NOT_REGISTERED=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"CreateInstance "+e[0]+" depends on "+e[1]+" which is NOT registered"}},57431:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.inject=void 0;var r=n(53045),o=n(30113),i=n(85109);t.inject=function(e){return function(t,n,a){if(void 0===e)throw new Error(i.INJECT_DECORATOR_PARAMETER_ERROR(t.name,n,a));if("number"!=typeof a)throw new Error(i.INJECT_DECORATOR_MISUSED);r.addTypeParameterMeta(o.CLASS_CONSTRUCTOR_DEPS,t,n,e,a)}}},75316:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.postConstructor=void 0;var r=n(30113),o=n(85109),i=n(3572);t.postConstructor=function(){return function(e,t,n){if("number"==typeof n||!e.constructor||!t)throw new Error(o.POST_CONSTRUCTOR_DECORATOR_MISUSED);i.addMethodMeta(r.POST_CONSTRUCTOR,{methodName:t},e.constructor)}}},5374:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.service=void 0;var r=n(46075),o=n(63608),i=n(85109);t.service=function(e){return function(t){if(void 0===e)throw new Error(i.SERVICE_DECORATOR_PARAMETER_ERROR(t.name));o.InstantiationFactory.getInstantiation(e).addService(t,new r.SyncDescriptor(t))}}},66624:function(e,t,n){var r=n(64387);Object.defineProperty(t,"qt",{enumerable:!0,get:function(){return r.IInstantiationHookPoint}});var o=n(18896);Object.defineProperty(t,"yh",{enumerable:!0,get:function(){return o.createDecorator}});var i=n(46075);Object.defineProperty(t,"Mj",{enumerable:!0,get:function(){return i.SyncDescriptor}});n(68925);var a=n(8613);Object.defineProperty(t,"RU",{enumerable:!0,get:function(){return a.DynamicLoader}});n(95782);var s=n(63608);Object.defineProperty(t,"Ey",{enumerable:!0,get:function(){return s.createInstantiationIdentifier}}),Object.defineProperty(t,"yB",{enumerable:!0,get:function(){return s.InstantiationFactory}});var c=n(43766);Object.defineProperty(t,"FS",{enumerable:!0,get:function(){return c.InstantiationService}});n(27132);var l=n(35371);Object.defineProperty(t,"yk",{enumerable:!0,get:function(){return l.ServiceCollection}});var u=n(31761);Object.defineProperty(t,"o5",{enumerable:!0,get:function(){return u.ServiceRegister}});var d=n(21387);Object.defineProperty(t,"uo",{enumerable:!0,get:function(){return d.transientService}});n(59803),n(57431),n(5374),n(75316),n(53045),n(78979);var p=n(24988);Object.defineProperty(t,"Bc",{enumerable:!0,get:function(){return p.DependencyResolver}});n(60125)},39042:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncLock=void 0;var n=function(){function e(){var e=this;this.isInnerOpen=!1,this.innerPromise=new Promise((function(t){e.completePromise=t}))}return e.prototype.isOpen=function(){return this.isInnerOpen},e.prototype.open=function(){this.isInnerOpen=!0,this.completePromise(!0)},e.prototype.wait=function(){return this.innerPromise},e}();t.AsyncLock=n},24988:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.DependencyResolver=void 0;var r=n(30113),o=n(51977),i=n(53045),a=function(){function e(){}return e.addServiceDependencies=function(e,t,n){i.addTypeParameterMeta(r.CLASS_CONSTRUCTOR_DEPS,e,void 0,t,n)},e.getServiceDependencies=function(e){var t=[],n=o.MetadataHandler.getDepsMetadata(r.CLASS_CONSTRUCTOR_DEPS,e);return n?(Object.keys(n).forEach((function(e){var r=n[e];r[1]?t.push({id:r[1].serviceIdentifier,index:parseInt(e,10),query:r[1]}):r[0]&&t.push({id:r[0],index:parseInt(e,10),query:{serviceIdentifier:r[0]}})})),t):t},e}();t.DependencyResolver=a},46075:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.SyncDescriptor=void 0;var r=n(30869),o=function(){function e(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=!1),void 0===r&&(r=!1),this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=n,this.supportsOverride=r}return e.prototype.isEqualWith=function(e){return this.ctor===e.ctor&&this.supportsDelayedInstantiation===e.supportsDelayedInstantiation&&this.supportsOverride===e.supportsOverride&&!!r.arrayEquals(this.staticArguments,e.staticArguments)},e}();t.SyncDescriptor=o},8613:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},a=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.DynamicLoader=void 0;var l=n(60125),u=n(64387),d=n(68925),p=n(39042),h=function(e){function t(t,n){void 0===t&&(t=[]);var r=e.call(this,n)||this;return r.disposableId="DynamicLoader",r.params=d.paramsToArray(t),r}return o(t,e),t.prototype.getInstance=function(e){return s(this,void 0,void 0,(function(){var t;return c(this,(function(n){return this.getInstancePromise||(t=new l.CancellationTokenSource,this.tokenSource=t,this.getInstancePromise=this.executor(t.token,e)),[2,this.getInstancePromise]}))}))},Object.defineProperty(t.prototype,"loadedModule",{get:function(){var e;if(null===(e=this.loadBarrier)||void 0===e?void 0:e.isOpen())return this.ctor},enumerable:!1,configurable:!0}),t.prototype.executor=function(e,t){return s(this,void 0,void 0,(function(){var n,r,o;return c(this,(function(i){switch(i.label){case 0:return[4,this.loadModule()];case 1:return n=i.sent(),e.isCancellationRequested||!n?[2]:(r=t||(this.params.length>0?this.params:[]),o=this.createInstance(n,r),this.instance=o,[2,o])}}))}))},t.prototype.loadModule=function(){var e;return s(this,void 0,void 0,(function(){var t;return c(this,(function(n){switch(n.label){case 0:return(null===(e=this.loadBarrier)||void 0===e?void 0:e.isOpen())&&this.ctor?[2,this.ctor]:this.loadBarrier?[3,2]:(this.loadBarrier=new p.AsyncLock,[4,this.getModule()]);case 1:return t=n.sent(),this.ctor=(null==t?void 0:t.default)||t,this.loadBarrier.open(),[3,4];case 2:return[4,this.loadBarrier.wait()];case 3:n.sent(),n.label=4;case 4:return this.ctor?[2,this.ctor]:[2,void 0]}}))}))},t.prototype.dispose=function(t){var n;e.prototype.dispose.call(this,t),this.instance=void 0,null===(n=this.tokenSource)||void 0===n||n.cancel(),this.tokenSource=void 0,this.getInstancePromise=void 0},t=i([a(1,u.IInstantiationService)],t)}(d.LoaderBase);t.DynamicLoader=h},99105:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.Graph=t.Node=void 0;var r=n(85109),o=function(e){this.incoming=new Map,this.outgoing=new Map,this.data=e};t.Node=o;var i=function(){function e(e){this.identifier=e,this.innerNodes=new Map}return e.prototype.roots=function(){var e=[];return this.innerNodes.forEach((function(t){0===t.outgoing.size&&e.push(t)})),e},e.prototype.insertEdge=function(e,t){var n=this.lookupOrInsertNode(e),r=this.lookupOrInsertNode(t);n.outgoing.set(this.identifier.hashId(t),r),r.incoming.set(this.identifier.hashId(e),n)},e.prototype.removeNode=function(e){var t=this.identifier.hashId(e);this.innerNodes.delete(t),this.innerNodes.forEach((function(e){e.outgoing.delete(t),e.incoming.delete(t)}))},e.prototype.lookupOrInsertNode=function(e){var t=this.identifier.hashId(e),n=this.innerNodes.get(t);return n||(n=new o(e),this.innerNodes.set(t,n)),n},e.prototype.lookup=function(e){return this.innerNodes.get(this.identifier.hashId(e))},e.prototype.isEmpty=function(){return 0===this.innerNodes.size},e.prototype.dfs=function(e,t){var n=this.clone(),o=[],i=n.innerNodes.get(n.identifier.hashId(e));if(i){o.push(i);for(var a=0;o.length;){if(a>1e4)throw new Error(r.GRAPH_CYCLIC_DEPENDENCY);a+=1;var s=o[o.length-1];s.outgoing.forEach((function(e){o.push(e)})),s.outgoing.size||(n.lookup(s.data)&&(t(s.data),n.removeNode(s.data)),o.pop())}}},e.prototype.clone=function(){var t=new e(this.identifier);return this.innerNodes.forEach((function(e){e.outgoing.forEach((function(n){t.insertEdge(e.data,n.data)}))})),t},e.prototype.toString=function(){var e=this,t=[];return this.innerNodes.forEach((function(n){var r=e.identifier.hashString(n.data),o=[];n.incoming.forEach((function(t){o.push(e.identifier.hashString(t.data))}));var i=[];n.outgoing.forEach((function(t){i.push(e.identifier.hashString(t.data))})),t.push(r+", (incoming)["+o.join(", ")+"], (outgoing)["+i.join(", ")+"]")})),t.join("\n")},e}();t.Graph=i},28922:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.HierarchyNode=void 0;var r=n(85109),o=function(){function e(e){this.children=new Set,this.isElderBrother=!1,this.self=e}return e.linkParentAndChild=function(e,t){e.addChild(t),t.attachToParent(e)},e.linkSibling=function(e,t){e.addAsRightSibling(t),t.addAsLeftSibling(e)},e.prototype.attachToParent=function(e,t){if(void 0===t&&(t=!1),this.parent&&!t)throw new Error(r.ILLEGAL_ATTACH_PARENT_STATE);this.parent=e},e.prototype.getParent=function(){return this.parent},e.prototype.addChild=function(e){this.children.has(e)||this.children.add(e)},e.prototype.walkUp=function(e){this.walkSiblings((function(t){e(t.getSelfNode())}));var t=this.getElderBrother().getParent();t&&t.walkUp(e)},e.prototype.walkDown=function(e){this.walkSiblings((function(t){e(t.getSelfNode())}));var t=this.getElderBrother().getChildren();t.size>0&&t.forEach((function(t){return t.walkDown(e)}))},e.prototype.mergeTo=function(e){if(this.getParent())throw new Error(r.ILLEGAL_MERGE_STATE);var t=e.getElderBrother();this.walkSiblings((function(e){e.setElderBrother(!1),e.getChildren().forEach((function(e){e.attachToParent(t,!0),t.addChild(e)})),e.removeChildren()}));var n=e.getRightTailSiblingNode();e.getRightTailSiblingNode().addAsRightSibling(this.getLeftHeadSiblingNode()),this.getLeftHeadSiblingNode().addAsLeftSibling(n)},e.prototype.getChildren=function(){return this.children},e.prototype.removeChildren=function(){this.children.clear()},e.prototype.addAsLeftSibling=function(e){if(this.leftSibling){var t=this.getLeftHeadSiblingNode();null==t||t.addAsLeftSibling(e)}else this.leftSibling=e},e.prototype.addAsRightSibling=function(e){this.rightSibling?this.getRightTailSiblingNode().addAsRightSibling(e):this.rightSibling=e},e.prototype.getLeftSibling=function(){return this.leftSibling},e.prototype.getRightSibling=function(){return this.rightSibling},e.prototype.isSelfElder=function(){return this.isElderBrother},e.prototype.setElderBrother=function(e){this.isElderBrother=e},e.prototype.getSelfNode=function(){return this.self},e.prototype.getLeftHeadSiblingNode=function(){var e=this.getLeftSibling();if(!e)return this;for(;null==e?void 0:e.getLeftSibling();)e=null==e?void 0:e.getLeftSibling();return e||this},e.prototype.getRightTailSiblingNode=function(){var e=this.getRightSibling();if(!e)return this;for(;null==e?void 0:e.getRightSibling();)e=null==e?void 0:e.getRightSibling();return e||this},e.prototype.getElderBrother=function(){var e;return this.walkSiblings((function(t){if(t.isSelfElder()||t.getParent()){if(e)throw new Error(r.ILLEGAL_HIERARCHY_STATE);e=t}})),e||this},e.prototype.walkSiblings=function(e){e(this);for(var t=this.leftSibling;t;)e(t),t=t.getLeftSibling();for(var n=this.rightSibling;n;)e(n),n=n.getRightSibling()},e}();t.HierarchyNode=o},95782:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},a=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.IdleLoader=void 0;var l=n(87782),u=n(60125),d=n(64387),p=n(68925),h=n(39042),f=function(e){function t(t,n){void 0===t&&(t=[]);var r=e.call(this,n)||this;return r.disposableId="IdleLoader",r.params=p.paramsToArray(t),r.task=l.scheduler.scheduleTask((function(){var e=new u.CancellationTokenSource;r.tokenSource=e,r.schedulePromise=r.executor(e.token)})),r}return o(t,e),t.prototype.getInstance=function(){return s(this,void 0,void 0,(function(){var e;return c(this,(function(t){switch(t.label){case 0:return this.schedulePromise?[4,this.schedulePromise]:[3,2];case 1:return[2,t.sent()];case 2:return this.task&&(l.scheduler.cancelTask(this.task),this.task=void 0),this.getInstancePromise||(e=new u.CancellationTokenSource,this.tokenSource=e,this.getInstancePromise=this.executor(e.token)),[2,this.getInstancePromise]}}))}))},Object.defineProperty(t.prototype,"loadedModule",{get:function(){var e;if(null===(e=this.loadBarrier)||void 0===e?void 0:e.isOpen())return this.ctor},enumerable:!1,configurable:!0}),t.prototype.dispose=function(t){var n;e.prototype.dispose.call(this,t),null===(n=this.tokenSource)||void 0===n||n.cancel(),this.tokenSource=void 0,this.schedulePromise=void 0,this.task&&(l.scheduler.cancelTask(this.task),this.task=void 0)},t.prototype.executor=function(e){return s(this,void 0,void 0,(function(){var t,n;return c(this,(function(r){switch(r.label){case 0:return[4,this.loadModule()];case 1:return t=r.sent(),e.isCancellationRequested||!t?[2]:(n=this.params.length>0?this.params:[],[2,this.createInstance(t,n)])}}))}))},t.prototype.loadModule=function(){var e;return s(this,void 0,void 0,(function(){var t;return c(this,(function(n){switch(n.label){case 0:return(null===(e=this.loadBarrier)||void 0===e?void 0:e.isOpen())&&this.ctor?[2,this.ctor]:this.loadBarrier?[3,2]:(this.loadBarrier=new h.AsyncLock,[4,this.getModule()]);case 1:return t=n.sent(),this.ctor=(null==t?void 0:t.default)||t,this.loadBarrier.open(),[3,4];case 2:return[4,this.loadBarrier.wait()];case 3:n.sent(),n.label=4;case 4:return this.ctor?[2,this.ctor]:[2,void 0]}}))}))},t=i([a(1,d.IInstantiationService)],t)}(p.LoaderBase);t.IdleLoader=f},63608:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.createInstantiationIdentifier=t.InstantiationFactory=t.instantiationIds=void 0;var r=n(43766),o=n(53208);t.instantiationIds=new Map;var i=function(){function e(e){this.id=e}return e.prototype.getId=function(){return this.id},e}(),a=function(){function e(){}return e.getInstantiation=function(e,t){var n=o.Registry.as(e.getId());return n||(t?(n=t.createChild(),o.Registry.add(e.getId(),n)):(n=new r.InstantiationService,o.Registry.add(e.getId(),n))),n},e}();t.InstantiationFactory=a,t.createInstantiationIdentifier=function(e){var n=t.instantiationIds.get(e);return n||(n=new i(e),t.instantiationIds.set(e,n)),n}},42125:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.InstantiationHook=void 0;var n=function(){function e(){this.hookRegistry=new Set}return e.prototype.addHook=function(e,t){this.hookRegistry.add({hookPoint:e,callback:t})},e.prototype.executeHooks=function(e,t){this.hookRegistry.forEach((function(n){var r=n.hookPoint,o=n.callback;r===t&&o(e)}))},e}();t.InstantiationHook=n},78979:function(e,t,n){var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a};Object.defineProperty(t,"__esModule",{value:!0}),t.InstantiationServiceBuilder=void 0;var o=n(35371),i=n(43766),a=function(){function e(e,t,n){void 0===e&&(e=new o.ServiceCollection),void 0===t&&(t=!1),this.instantiationService=new i.InstantiationService(e,t,n)}return e.prototype.serviceRegister=function(e){var t=this;return e.getServiceDescriptors().forEach((function(e){var n=r(e,2),o=n[0],i=n[1];return t.instantiationService.addService(o,i)})),e.getMulServiceDescriptor().forEach((function(e){var n=r(e,2),o=n[0],i=n[1];return t.instantiationService.addService(o,i,!0)})),this},e.prototype.build=function(){return this.instantiationService},e}();t.InstantiationServiceBuilder=a},43766:function(e,t,n){var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.InstantiationService=void 0;var a=n(60125),s=n(99105),c=n(46075),l=n(66466),u=n(64387),d=n(35371),p=n(89620),h=n(27132),f=n(24988),g=n(9777),v=n(28922),y=n(68925),m=n(85109),b=n(30869),_="function"==typeof n.g.Proxy,C=function(){function e(e,t,n){if(void 0===e&&(e=new d.ServiceCollection),void 0===t&&(t=!1),this.hookRegistry=new Map,this.commonHookList=[],this.innerService=e,this.strictMode=t,this.innerService.set(u.IInstantiationService,this),this.hierarchyNode=new v.HierarchyNode(this),n){var r=n.getHierarchyNode();v.HierarchyNode.linkParentAndChild(r,this.hierarchyNode)}}return e.prototype.getHierarchyNode=function(){return this.hierarchyNode},e.prototype.createChild=function(t){return new e(t,this.strictMode,this)},e.prototype.addChild=function(e){v.HierarchyNode.linkParentAndChild(this.hierarchyNode,e.getHierarchyNode())},e.prototype.attachToParent=function(e){v.HierarchyNode.linkParentAndChild(e.getHierarchyNode(),this.hierarchyNode)},e.prototype.getParent=function(){var e;return null===(e=this.hierarchyNode.getParent())||void 0===e?void 0:e.getSelfNode()},e.prototype.addService=function(e,t,n){n?this.innerService.setMulti(e,t):this.innerService.set(e,t)},e.prototype.createInstance=function(e){for(var t,n,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return e instanceof c.SyncDescriptor?(t=h.InstantiationTrace.traceCreation(e.ctor),n=this.resolveAndCreateInstance(e.ctor,e.staticArguments.concat(r),t)):(t=h.InstantiationTrace.traceCreation(e),n=this.resolveAndCreateInstance(e,r,t)),t.stop(),n},e.prototype.invokeFunction=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=h.InstantiationTrace.traceInvocation(e);try{var a={get:function(e){var n={serviceIdentifier:e,isMultiInject:!0},r=t.getOrCreateServiceInstance(n,i);if(!r)throw new Error(m.INVOKE_UNKNOWN_SERVICE(g.getIdentifierName(e)));return r},getAll:function(e){var n={serviceIdentifier:e,isMultiInject:!0},r=t.getOrCreateServiceInstances(n,i);if(!r)throw new Error(m.INVOKE_UNKNOWN_SERVICE(g.getIdentifierName(e)));return r}};return e.apply(void 0,o([a],n))}finally{i.stop()}},e.prototype.dispose=function(t,n){var r=this;void 0===n&&(n=!1);var o=t||a.DisposeTrace.traceRoot("IInstantiationService");this.innerService.teardown((function(t){return t&&!(t instanceof e)}),(function(e){return!(e instanceof y.LoaderBase)}),(function(t){return!(t instanceof e)}),o),n||this.hierarchyNode.walkDown((function(e){e!==r&&e.dispose(o.branch("IInstantiationService"),!0)})),this.hookRegistry.clear(),this.commonHookList=[],!t&&o&&o.stop()},e.prototype.has=function(e){var t=!1;return this.hierarchyNode.walkUp((function(n){t||(t=n.innerService.has(e))})),t},e.prototype.getClass=function(e){var t;return this.hierarchyNode.walkUp((function(n){var r;if(!t){var o=n.innerService.getHolder({serviceIdentifier:e});t=null===(r=null==o?void 0:o.descriptor)||void 0===r?void 0:r.ctor}})),t},e.prototype.addHook=function(e,t,n){return this.addServiceHook(e,t,n)},e.prototype.addCommonHook=function(e,t,n){this.commonHookList.push({hookPoint:e,callback:t,filter:n})},e.prototype.mergeTo=function(e){this.hierarchyNode.mergeTo(e.getHierarchyNode())},e.prototype.addServiceHook=function(e,t,n){var r=!1;return this.hierarchyNode.walkUp((function(o){if(!r&&o.innerService.has(t)){var i=o.innerService.getAllHolder({serviceIdentifier:t,isMultiInject:!0});null==i||i.forEach((function(t){t.instance&&b.isLoaderHolder(t.instance)&&b.addLoaderHook(t.instance,e,n)})),o.innerService.getMapping().getMapping(t).forEach((function(t){if(t&&"string"!=typeof t){var i=o.hookRegistry.get(t)||[];i.push({hookPoint:e,callback:n}),o.hookRegistry.set(t,i),r=!0}}))}})),r},e.prototype.resolveAndCreateInstance=function(e,t,n){var r,a,s;void 0===t&&(t=[]);var c=f.DependencyResolver.getServiceDependencies(e).sort((function(e,t){return e.index-t.index})),l=[];try{for(var u=i(c),d=u.next();!d.done;d=u.next()){var p=d.value,h=p.query.isMultiInject?this.getOrCreateServiceInstances(p.query,n):this.getOrCreateServiceInstance(p.query,n);if(!h&&this.strictMode&&!(null===(s=null==p?void 0:p.query)||void 0===s?void 0:s.isOption))throw new Error(m.DEPEND_ON_UNKNOWN_SERVICE(e.name,g.getIdentifierName(p.id)));l.push(h)}}catch(e){r={error:e}}finally{try{d&&!d.done&&(a=u.return)&&a.call(u)}finally{if(r)throw r.error}}var v=this.alignArgs(t,c),y=new(e.bind.apply(e,o([void 0],o(v,l))));return this.executePostDecorator(e,y),this.executePostHooks(e,y),this.executeCommonPostHooks(y),y},e.prototype.executePostHooks=function(e,t){var n=this.hookRegistry.get(e);n&&n.forEach((function(e){var n=e.hookPoint,r=e.callback;n===u.IInstantiationHookPoint.POST_CONSTRUCTOR&&(t&&b.isLoaderHolder(t)?b.addLoaderHook(t,n,r):r(t))}))},e.prototype.executeCommonPostHooks=function(e){this.hierarchyNode.walkDown((function(t){t.commonHookList.forEach((function(t){var n=t.hookPoint,r=t.callback,o=t.filter;n===u.IInstantiationHookPoint.POST_CONSTRUCTOR&&(o&&!o(e)||r(e))}))}))},e.prototype.executePostDecorator=function(e,t){var n=b.getPostConstructorMethodName(e);n&&t[n].call(t)},e.prototype.alignArgs=function(e,t){var n=e,r=t.length>0?t[0].index:e.length;if(e.length!==r){var o=r-e.length;n=o>0?e.concat(new Array(o)):e.slice(0,r)}return n},e.prototype.tryToCacheServiceInstance=function(e,t){return(null==e?void 0:e.descriptor)instanceof c.SyncDescriptor&&(e.instance=t,!0)},e.prototype.getServiceInstanceOrDescriptor=function(e){var t;return this.hierarchyNode.walkUp((function(n){t||(t=n.innerService.getHolder(e))})),t},e.prototype.getAllServiceInstanceOrDescriptors=function(e){var t;return this.hierarchyNode.walkUp((function(n){t||(t=n.innerService.getAllHolder(e))})),t},e.prototype.createAndCacheServiceInstance=function(e,t,n){var r=this.resolveDependencyGraph(e,t,n);return this.createServiceInstanceFromGraph(r)},e.prototype.resolveDependencyGraph=function(e,t,n){for(var r,o,a,c=new s.Graph({hashId:function(e){return e.query.serviceIdentifier},hashString:function(e){return g.getIdentifierName(e.query.serviceIdentifier)}}),u=0,d=[{query:e,descriptor:t,trace:n}];d.length;){var p=d.pop();if(c.lookupOrInsertNode(p),u>1e3)throw new l.CyclicDependencyError(c);u+=1;var h=f.DependencyResolver.getServiceDependencies(p.descriptor.ctor);try{for(var v=(r=void 0,i(h)),y=v.next();!y.done;y=v.next()){var b=y.value,_=this.getAllServiceInstanceOrDescriptors(b.query);_||(null===(a=null==b?void 0:b.query)||void 0===a?void 0:a.isOption)||console.warn(m.CREATE_INSTANCE_NOT_REGISTERED(g.getIdentifierName(e.serviceIdentifier),g.getIdentifierName(b.id)));var C=null==_?void 0:_.filter((function(e){return e.descriptor}));if(C&&(null==C?void 0:C.length)>0&&C[0].descriptor){var S={query:b.query,descriptor:C[0].descriptor,trace:p.trace.branch(b.id,!0)};c.insertEdge(p,S),d.push(S)}}}catch(e){r={error:e}}finally{try{y&&!y.done&&(o=v.return)&&o.call(v)}finally{if(r)throw r.error}}}return c},e.prototype.createServiceInstanceFromGraph=function(e){for(var t,n,r,o;;){var a=e.roots();if(0===a.length){if(!e.isEmpty())throw new l.CyclicDependencyError(e);break}try{for(var s=(t=void 0,i(a)),c=s.next();!c.done;c=s.next()){var u=c.value.data;o=u.descriptor.ctor,r=this.createServiceInstanceWithOwner(u.query,u.descriptor.ctor,u.descriptor.staticArguments,u.descriptor.supportsDelayedInstantiation,u.trace),e.removeNode(u)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}}if(!r)throw new Error(m.RESOLVE_UNKNOWN_SERVICE(null==o?void 0:o.name));return r},e.prototype.getOrCreateServiceInstance=function(e,t){var n,r=this.getServiceInstanceOrDescriptor(e);return!(null==r?void 0:r.instance)&&(null==r?void 0:r.descriptor)?this.createAndCacheServiceInstance(e,r.descriptor,t.branch(e.serviceIdentifier,!0)):(h.InstantiationTrace.traverse(t,e.serviceIdentifier,!1)||t.branch(e.serviceIdentifier,!1),null!==(n=null==r?void 0:r.instance)&&void 0!==n?n:void 0)},e.prototype.getOrCreateServiceInstances=function(e,t){var n=this,r=this.getAllServiceInstanceOrDescriptors(e),o=[];return null==r||r.forEach((function(r){if(r.instance)o.push(r.instance);else if(r.descriptor){var i=n.createAndCacheServiceInstance(e,r.descriptor,t.branch(e.serviceIdentifier,!0));o.push(i)}h.InstantiationTrace.traverse(t,e.serviceIdentifier,!1)||t.branch(e.serviceIdentifier,!1)})),o||void 0},e.prototype.createServiceInstanceWithOwner=function(e,t,n,r,o){var i,a=this;if(void 0===n&&(n=[]),this.hierarchyNode.walkUp((function(s){var c;if(!i){var l=s.innerService.getAllHolder(e,(function(e){var n;return(null===(n=e.descriptor)||void 0===n?void 0:n.ctor)===t})),u=null==l?void 0:l[0];(i=null!==(c=null==u?void 0:u.instance)&&void 0!==c?c:void 0)||(null==u?void 0:u.descriptor)&&(i=s.createServiceInstance(t,n,r,o),a.tryToCacheServiceInstance(u,i))}})),i)return i;throw new Error(m.CREATING_UNKNOWN_SERVICE(t.name))},e.prototype.createServiceInstance=function(e,t,n,r){var o=this;if(void 0===t&&(t=[]),!n||!_)return this.resolveAndCreateInstance(e,t,r);var i=new p.ProxyValue((function(){return o.resolveAndCreateInstance(e,t,r)}));return new Proxy(Object.create(null),{get:function(e,t){if(t in e)return e[t];var n=i.value,r=n[t];return"function"!=typeof r||(r=r.bind(n),e[t]=r),r},set:function(e,t,n){return i.value[t]=n,!0}})},e}();t.InstantiationService=C},27132:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.InstantiationTrace=t.disableInstantiationTrace=t.enableInstantiationTrace=void 0;var s=n(9777),c=!1;t.enableInstantiationTrace=function(){c=!0},t.disableInstantiationTrace=function(){c=!1};var l=function(){function e(e,t){this.type=e,this.name=t,this._start=Date.now(),this._dep=[]}return e.traceInvocation=function(t){return c?new e(1,t.name||t.toString().substring(0,42).replace(/\n/g,"")):e._None},e.traceCreation=function(t){return c?new e(0,t.name):e._None},e.traverse=function(t,n,r){if(void 0===r&&(r=!1),!c)return r;var o=r;return null==t||t._dep.forEach((function(r,a){var s=i(r,3),c=s[0],l=s[1],u=s[2];c===n?!0===o&&!0===l?t._dep[a]=[c,!1,new e(2,c.toString())]:(o=!0,(null==u?void 0:u._dep)&&(null==u?void 0:u._dep.length)>0&&(o=e.traverse(u,n,o))):(null==u?void 0:u._dep)&&(null==u?void 0:u._dep.length)>0&&(o=e.traverse(u,n,o))})),o},e.prototype.branch=function(t,n){var r=new e(2,t.toString());return this._dep.push([t,n,r]),r},e.prototype.stop=function(){var t=Date.now()-this._start;e._totals+=t;var n=!1,r=[(0===this.type?"CREATE":"CALL")+" "+this.name,""+function e(t,r){var o,c,l=[],u=new Array(t+1).join("\t");try{for(var d=a(r._dep),p=d.next();!p.done;p=d.next()){var h=i(p.value,3),f=h[0],g=h[1],v=h[2];if(g&&v){n=!0,l.push(u+"CREATES -> "+s.getIdentifierName(f));var y=e(t+1,v);y&&l.push(y)}else l.push(u+"uses -> "+s.getIdentifierName(f))}}catch(e){o={error:e}}finally{try{p&&!p.done&&(c=d.return)&&c.call(d)}finally{if(o)throw o.error}}return l.join("\n")}(1,this),"DONE, took "+t.toFixed(2)+"ms (grand total "+e._totals.toFixed(2)+"ms)"];(t>2||n)&&console.log(r.join("\n"))},e._None=new(function(e){function t(){return e.call(this,-1,null)||this}return o(t,e),t.prototype.stop=function(){},t.prototype.branch=function(){return this},t}(e)),e._totals=0,e}();t.InstantiationTrace=l},64387:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.IInstantiationService=t.IInstantiationHookPoint=void 0;var r=n(18896);!function(e){e[e.POST_CONSTRUCTOR=0]="POST_CONSTRUCTOR"}(t.IInstantiationHookPoint||(t.IInstantiationHookPoint={})),t.IInstantiationService=r.createDecorator("IInstantiationService")},11915:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.KeyMapping=void 0;var r=n(50934),o=n(85109),i=n(46075),a=n(9777),s=function(){function e(){this.identifierMap=new Map,this.serviceKeyMap=new Map}return e.prototype.getMapping=function(e){var t=this,n=this.identifierMap.get(e),r=[];return null==n||n.forEach((function(e){t.serviceKeyMap.get(e)&&r.push(e)})),void 0===n&&"function"==typeof e&&"function"!=typeof e.toLegacyString&&this.serviceKeyMap.get(e)&&r.push(e),r},e.prototype.deleteMapping=function(e){var t=this;this.identifierMap.forEach((function(n){var r=n.indexOf(e);r>=0&&(n.splice(r,1),t.serviceKeyMap.delete(e))}))},e.prototype.clear=function(){this.identifierMap.clear(),this.serviceKeyMap.clear()},e.prototype.dispose=function(){this.clear()},e.prototype.generateServiceKey=function(e,t,n){return void 0===n&&(n=!1),t instanceof i.SyncDescriptor?this.generateDescriptorKey(e,t,n):this.generateValueInstanceKey(e,t,n)},e.prototype.generateValueInstanceKey=function(e,t,n){if(void 0===n&&(n=!1),n){var r=this.createRandomValueKey(t);return this.addMapping(e,t,{valueId:r}),r}var i=this.getMapping(e);if(0===i.length)return r=this.createRandomValueKey(t),this.addMapping(e,t,{valueId:r}),r;if(1===i.length){var s=i[0],c=this.serviceKeyMap.get(s);return(null==c?void 0:c.override)?(this.deleteMappingById(e,s),r=this.createRandomValueKey(t),this.addMapping(e,t,{valueId:r}),r):i[0]}throw new Error(o.AMBIGUOUS_OVERRIDE_SERVICE(a.getIdentifierName(e)))},e.prototype.generateDescriptorKey=function(e,t,n){void 0===n&&(n=!1);var r=this.getMapping(e);if(n)return(null==r?void 0:r.includes(t))||this.addMapping(e,t.ctor),t.ctor;if(0===r.length)return this.addMapping(e,t.ctor,{override:t.supportsOverride}),t.ctor;if(1===r.length){var i=r[0],s=this.serviceKeyMap.get(i);return(null==s?void 0:s.override)&&t.ctor!==i?(this.deleteMappingById(e,i),this.addMapping(e,t.ctor,{override:t.supportsOverride}),t.ctor):r[0]}throw new Error(o.AMBIGUOUS_OVERRIDE_SERVICE(a.getIdentifierName(e)))},e.prototype.addMapping=function(e,t,n){var r=this.identifierMap.get(e);if(null==n?void 0:n.valueId){var o=n.valueId;r?r.push(o):this.identifierMap.set(e,[o]),this.serviceKeyMap.set(o,{serviceKey:o})}else r?r.push(t):this.identifierMap.set(e,[t]),this.serviceKeyMap.set(t,{serviceKey:t,override:null==n?void 0:n.override})},e.prototype.createRandomValueKey=function(e){return e.constructor.name+"@"+r.v4()},e.prototype.deleteMappingById=function(e,t){var n=0;if(this.identifierMap.forEach((function(e){e.indexOf(t)>=0&&(n+=1)})),0!==n){var r=this.identifierMap.get(e);if(r&&r.length){var o=r.indexOf(t);o>=0&&r.splice(o,1),1===n&&this.serviceKeyMap.delete(t)}}},e}();t.KeyMapping=s},18896:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.createDecorator=t.LegacyServiceIdCache=void 0;var r=n(53045),o=n(30113),i=n(85109),a=function(){function e(){}return e.has=function(e){return this.serviceIdsMap.has(e)},e.get=function(e){return this.serviceIdsMap.get(e)},e.set=function(e,t){this.serviceIdsMap.set(e,t)},e.serviceIdsMap=new Map,e}();t.LegacyServiceIdCache=a,t.createDecorator=function(e){if(a.has(e))return a.get(e);var t=function(e,n,a){if(3!==arguments.length)throw new Error(i.SERVICE_NAME_DECORATOR_MISUSE(n));r.addTypeParameterMeta(o.CLASS_CONSTRUCTOR_DEPS,e,void 0,t,a)};return t.toLegacyString=function(){return e},a.set(e,t),t}},68925:function(e,t,n){var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.LoaderBase=t.paramsToArray=void 0;var i=n(60125),a=n(85109),s=n(64387),c=n(42125);t.paramsToArray=function(e){return Array.isArray(e)?e:[e]};var l=function(){function e(e){this.instantiationHook=new c.InstantiationHook,this.selfInstantiationService=e}return e.prototype.createInstance=function(e,t){if(this.instance)return this.instance;var n=this.loaderInstantiationService(),r=n.createInstance.apply(n,o([e],t));return this.executeHooks(r,s.IInstantiationHookPoint.POST_CONSTRUCTOR),this.instance=r,i.tryToMarkDispose(r),r},e.prototype.loaderInstantiationService=function(){var t=this,n=this.getInstantion()||e.staticInstantiationService;if(n&&n!==this.selfInstantiationService){var r=!0;if(n.getHierarchyNode().walkUp((function(e){r&&e===t.selfInstantiationService&&(r=!1)})),r)throw new Error(a.LOADER_BASE_ORPHAN_INSTANTIATION)}return n||this.selfInstantiationService},e.prototype.getInstantion=function(){return null},e.prototype.addHook=function(e,t){this.instantiationHook.addHook(e,t)},e.prototype.executeHooks=function(e,t){this.instantiationHook.executeHooks(e,t)},e.initStaticInstantiationService=function(t){if(e.staticInstantiationService)throw new Error(a.LOADER_BASE_STATIC_INSTANTIATION);e.staticInstantiationService=t},e.prototype.dispose=function(e){var t,n;this.instance&&(i.isDisposable(this.instance)&&(e&&e.branch(((null===(n=null===(t=this.instance)||void 0===t?void 0:t.constructor)||void 0===n?void 0:n.name)||"")+"instance"),this.instance.dispose(e)),this.instance=null)},e}();t.LoaderBase=l},89620:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyValue=void 0;var r=n(60125),o=function(){function e(e){var t=this;this.didRun=!1,this.executor=function(){try{t.innerValue=e()}catch(e){t.innerError=e}finally{t.didRun=!0}}}return Object.defineProperty(e.prototype,"value",{get:function(){if(this.didRun||this.executor(),this.innerError)throw this.innerError;return this.innerValue},enumerable:!1,configurable:!0}),e.prototype.dispose=function(e){this.innerValue&&r.isDisposable(this.innerValue)&&this.innerValue.dispose(e)},e}();t.ProxyValue=o},53208:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Registry=void 0;var n=function(){function e(){this.data=new Map}return e.prototype.add=function(e,t){this.data.set(e,t)},e.prototype.knows=function(e){return this.data.has(e)},e.prototype.as=function(e){return this.data.get(e)||null},e}();t.Registry=new n},59803:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.appendService=void 0;var r=n(46075);t.appendService=function(e,t,n,o,i){e.addService(t,new r.SyncDescriptor(n,o,i))}},35371:function(e,t,n){var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a};Object.defineProperty(t,"__esModule",{value:!0}),t.ServiceCollection=void 0;var i=n(60125),a=n(46075),s=n(66466),c=n(9777),l=n(11915),u=n(85109),d=function(){function e(){for(var e,t,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];this.innerEntries=new Map,this.keyMapping=new l.KeyMapping;try{for(var a=r(n),s=a.next();!s.done;s=a.next()){var c=o(s.value,2),u=c[0],d=c[1];this.set(u,d)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}}return e.prototype.set=function(e,t){var n=this.keyMapping.generateServiceKey(e,t),r=this.innerEntries.get(n);r?t instanceof a.SyncDescriptor?this.overrideExistServiceHolder(e,r,t):this.setHolderInstance(n,r,t):this.createNewServiceHolder(n,t)},e.prototype.setMulti=function(e,t){var n=this.keyMapping.generateServiceKey(e,t,!0);if(!this.innerEntries.get(n)){var r=this.createNewHolderByCondition(t);this.innerEntries.set(n,r)}},e.prototype.has=function(e){var t=this;return!!this.keyMapping.getMapping(e).find((function(e){return t.innerEntries.has(e)}))},e.prototype.get=function(e){var t=this.keyMapping.getMapping(e);if(0!==t.length){if(t.length>1)throw new Error(u.AMBIGUOUS_MATCH_SERVICE(c.getIdentifierName(e)));var n=this.innerEntries.get(t[0]);return(null==n?void 0:n.instance)||(null==n?void 0:n.descriptor)||void 0}},e.prototype.getAllHolder=function(e,t){var n=this,r=this.keyMapping.getMapping(e.serviceIdentifier),o=[];return r.forEach((function(e){var t=n.innerEntries.get(e);t&&(null==o||o.push(t))})),t?null==o?void 0:o.filter((function(e,n){return t(e,n)})):o.length>0?o:void 0},e.prototype.getHolder=function(e){var t=this.keyMapping.getMapping(e.serviceIdentifier);if(0!==t.length){if(t.length>1)throw new Error(u.AMBIGUOUS_MATCH_SERVICE(c.getIdentifierName(e.serviceIdentifier)));return this.innerEntries.get(t[0])}},e.prototype.getMapping=function(){return this.keyMapping},e.prototype.teardown=function(e,t,n,r){var o=this;this.innerEntries.forEach((function(a,s){var l=a.instance,u=a.descriptor;(null==e?void 0:e(l))&&i.tryToDispose(l,null==r?void 0:r.branch(c.getIdentifierName(s))),u&&l&&(null==t?void 0:t(l))&&(a.instance=null),!u&&l&&(null==n?void 0:n(l))&&(o.innerEntries.delete(s),o.keyMapping.deleteMapping(s))}))},e.prototype.createNewServiceHolder=function(e,t){var n=this.createNewHolderByCondition(t);this.innerEntries.set(e,n)},e.prototype.overrideExistServiceHolder=function(e,t,n){var r,o,i;if(null===(r=t.descriptor)||void 0===r?void 0:r.supportsOverride){var a=this.keyMapping.generateServiceKey(e,n),s=this.createHolderInstance(null,n);this.innerEntries.set(a,s)}else{if(t.instance)throw new Error(u.UPDATE_HOLDER_INSTANCE(c.getIdentifierName(e),null===(i=t.descriptor)||void 0===i?void 0:i.ctor.name));(null===(o=t.descriptor)||void 0===o?void 0:o.isEqualWith(n))||console.warn(u.OVERRIDE_WARNING(c.getIdentifierName(e)))}},e.prototype.setHolderInstance=function(e,t,n){i.tryToMarkDispose(n),t.instance=n,this.innerEntries.set(e,t)},e.prototype.createNewHolderByCondition=function(e){return e instanceof a.SyncDescriptor?this.createHolderInstance(null,e):(i.tryToMarkDispose(e),this.createHolderInstance(e,null))},e.prototype.createHolderInstance=function(e,t){return new s.ServiceHolder(e,t)},e}();t.ServiceCollection=d},9777:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getIdentifierName=void 0,t.getIdentifierName=function(e){return"function"==typeof e?"function"==typeof e.toLegacyString?e.toLegacyString():e.name:String(e)}},31761:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.ServiceRegister=void 0;var r=n(46075),o=function(){function e(){this.innerRegistry=[],this.innerMultiRegistry=[]}return e.prototype.register=function(e,t,n,o){this.innerRegistry.push([e,new r.SyncDescriptor(t,n,o)])},e.prototype.registerValue=function(e,t){this.innerRegistry.push([e,t])},e.prototype.registerMulti=function(e,t,n,o){this.innerMultiRegistry.push([e,new r.SyncDescriptor(t,n,o)])},e.prototype.registerMultiValue=function(e,t){this.innerMultiRegistry.push([e,t])},e.prototype.getServiceDescriptors=function(){return this.innerRegistry},e.prototype.getMulServiceDescriptor=function(){return this.innerMultiRegistry},e}();t.ServiceRegister=o},21387:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},a=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},s=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},c=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(s(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.transientService=t.TransientServiceHolder=void 0;var l=n(64387),u=n(42125),d=function(){function e(e,t){void 0===e&&(e=[]),this.instantiationService=t,this.instantiationHook=new u.InstantiationHook,this.params=e}return e.prototype.getNewInstance=function(e){var t,n=e||(this.params.length>0?this.params:[]),r=this.getCtor(),o=(t=this.instantiationService).createInstance.apply(t,c([r],n));return this.executeHooks(o,l.IInstantiationHookPoint.POST_CONSTRUCTOR),o},e.prototype.addHook=function(e,t){this.instantiationHook.addHook(e,t)},e.prototype.executeHooks=function(e,t){this.instantiationHook.executeHooks(e,t)},e=i([a(1,l.IInstantiationService)],e)}();t.TransientServiceHolder=d,t.transientService=function(e){return function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t),n.prototype.getCtor=function(){return e},n}(d)}},66466:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.CyclicDependencyError=t.ServiceHolder=void 0;var i=n(85109),a=function(e,t){this.instance=e,this.descriptor=t};t.ServiceHolder=a;var s=function(e){function t(t){var n=e.call(this,i.SERVICES_CYCLIC_DEPENDENCY)||this;return n.message=t.toString(),n}return o(t,e),t}(Error);t.CyclicDependencyError=s},30869:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.addLoaderHook=t.isLoaderHolder=t.getPostConstructorMethodName=t.isPromise=t.arrayEquals=void 0;var r=n(30113),o=n(51977),i=n(68925),a=n(21387);t.arrayEquals=function(e,t,n){if(void 0===n&&(n=function(e,t){return e===t}),e===t)return!0;if(!e||!t)return!1;if(e.length!==t.length)return!1;for(var r=0,o=e.length;r<o;r++)if(!n(e[r],t[r]))return!1;return!0},t.isPromise=function(e){return("object"==typeof e&&null!==e||"function"==typeof e)&&"function"==typeof e.then},t.getPostConstructorMethodName=function(e){var t=o.MetadataHandler.getMethodMetadata(r.POST_CONSTRUCTOR,e);if(t)return t.methodName},t.isLoaderHolder=function(e){return e instanceof i.LoaderBase||e instanceof a.TransientServiceHolder},t.addLoaderHook=function(e,t,n){(e instanceof i.LoaderBase||e instanceof a.TransientServiceHolder)&&e.addHook(t,n)}},3572:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.addMethodMeta=void 0;var r=n(85109),o=n(51977);t.addMethodMeta=function(e,t,n){if(o.MetadataHandler.hasMetadata(e,n)){var i=o.MetadataHandler.getMethodMetadata(e,n);throw Error(r.DUPLICATED_METHOD_METADATA(e,null==i?void 0:i.methodName))}o.MetadataHandler.setMethodMetadata(e,t,n)}},53045:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.addTypeParameterMeta=void 0;var r=n(51977),o=n(9777),i=n(85109);t.addTypeParameterMeta=function(e,t,n,a,s){if(void 0!==n&&"number"==typeof s)throw new Error(i.INVALID_DECORATOR_OPERATION);var c=s.toString(),l=r.MetadataHandler.getDepsMetadata(e,t)||{},u=l[c];if(void 0!==(null==u?void 0:u[0])&&(null==u?void 0:u[0])!==a)throw new Error(i.DUPLICATED_PARAMETER_METADATA(t.name,c,o.getIdentifierName(u[0]),o.getIdentifierName(a)));u&&u[1]&&!u[1].serviceIdentifier?(u[0]=a,u[1].serviceIdentifier=a):void 0===u&&(l[c]=[a,{serviceIdentifier:a}],r.MetadataHandler.setDepsMetadata(e,l,t))}},51977:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MetadataHandler=void 0;var n=function(){function e(){}return e.hasMetadata=function(e,t){return!!t[e]},e.getDepsMetadata=function(e,t){return t[e]},e.setDepsMetadata=function(e,t,n){n[e]=t},e.getMethodMetadata=function(e,t){return t[e]},e.setMethodMetadata=function(e,t,n){n[e]=t},e}();t.MetadataHandler=n},30113:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.POST_CONSTRUCTOR=t.PROPS_DEPS=t.CLASS_CONSTRUCTOR_DEPS=void 0,t.CLASS_CONSTRUCTOR_DEPS="di:ctor_deps",t.PROPS_DEPS="di:props_deps",t.POST_CONSTRUCTOR="di:post_constructor"},76450:function(e,t,n){n.d(t,{Al:function(){return l},Gk:function(){return c},N9:function(){return i},VD:function(){return r},Vj:function(){return h},en:function(){return p}});var r,o,i,a=n(85556),s=function(){function e(){}return e.isMobile=function(){return/(mobile)/i.test(navigator.userAgent)},e.isAndroid=function(){return/(android)/i.test(navigator.userAgent)},e.isIOS=function(){return/(iphone|ipad|ipod)/i.test(navigator.userAgent)},e.isIPad=function(){return/(ipad)/i.test(navigator.userAgent)},e.isMac=function(){return!this.isMobile()&&/Mac OS X/i.test(navigator.userAgent)},e.isFireFox=function(){return/firefox/i.test(navigator.userAgent)},e.isChrome=function(){return/chrome/i.test(navigator.userAgent)},e}();!function(e){e[e.EMPTY=-1]="EMPTY",e[e.BREAK=3]="BREAK",e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.CLEAR=12]="CLEAR",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ALT=18]="ALT",e[e.PAUSE=19]="PAUSE",e[e.CAPS_LOCK=20]="CAPS_LOCK",e[e.ESCAPE=27]="ESCAPE",e[e.SPACE=32]="SPACE",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.ARROW_LEFT=37]="ARROW_LEFT",e[e.ARROW_UP=38]="ARROW_UP",e[e.ARROW_RIGHT=39]="ARROW_RIGHT",e[e.ARROW_DOWN=40]="ARROW_DOWN",e[e.SELECT=41]="SELECT",e[e.PRINT=42]="PRINT",e[e.EXECUTE=43]="EXECUTE",e[e.PRINT_SCREEN=44]="PRINT_SCREEN",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE",e[e.HELP=47]="HELP",e[e.NUM_0=48]="NUM_0",e[e.NUM_1=49]="NUM_1",e[e.NUM_2=50]="NUM_2",e[e.NUM_3=51]="NUM_3",e[e.NUM_4=52]="NUM_4",e[e.NUM_5=53]="NUM_5",e[e.NUM_6=54]="NUM_6",e[e.NUM_7=55]="NUM_7",e[e.NUM_8=56]="NUM_8",e[e.NUM_9=57]="NUM_9",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.META_LEFT=91]="META_LEFT",e[e.META_RIGHT=93]="META_RIGHT",e[e.NUM_TIMES=106]="NUM_TIMES",e[e.NUM_PLUS=107]="NUM_PLUS",e[e.NUM_MINUS=109]="NUM_MINUS",e[e.NUM_POINT=110]="NUM_POINT",e[e.NUM_DIVIDE=111]="NUM_DIVIDE",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.SEMI=186]="SEMI",e[e.EQUAL=187]="EQUAL",e[e.COMMA=188]="COMMA",e[e.MINUS=189]="MINUS",e[e.PERIOD=190]="PERIOD",e[e.SLASH=191]="SLASH",e[e.BACKQUOTE=192]="BACKQUOTE",e[e.BRACKET_LEFT=219]="BRACKET_LEFT",e[e.BACK_SLASH=220]="BACK_SLASH",e[e.BRACKET_RIGHT=221]="BRACKET_RIGHT"}(r||(r={})),function(e){e[e.EQUAL=61]="EQUAL",e[e.MINUS=173]="MINUS",e[e.META_FIREFOX=224]="META_FIREFOX"}(o||(o={})),function(e){e[e.SHIFT=1e3]="SHIFT",e[e.ALT=1e4]="ALT",e[e.CTRL_WIN=1e5]="CTRL_WIN",e[e.CTRL_MAC=2e5]="CTRL_MAC",e[e.WIN=1e6]="WIN",e[e.COMMAND=2e6]="COMMAND"}(i||(i={}));var c,l,u,d=1e7;!function(e){e[e.PRIMARY_BUTTON=1e7]="PRIMARY_BUTTON",e[e.SECONDARY_BUTTON=2e7]="SECONDARY_BUTTON",e[e.MIDDLE_BUTTON=4e7]="MIDDLE_BUTTON"}(c||(c={})),function(e){e[e.WHEEL_ANTICLOCKWISE=1e8]="WHEEL_ANTICLOCKWISE",e[e.WHEEL_CLOCKWISE=2e8]="WHEEL_CLOCKWISE"}(l||(l={})),function(e){e.KEY_UP="keyup",e.KEY_PRESS="keypress",e.KEY_DOWN="keydown"}(u||(u={}));var p=function(){function e(){}return e.getKeyCode=function(e){var t=e.keyCode;return s.isFireFox()&&(t===o.EQUAL?t=r.EQUAL:t===o.MINUS&&(t=r.MINUS)),t},e.getMouseCode=function(e){return e.buttons*d},e.getWheelCode=function(e){var t=0;return e.deltaY>0?t=l.WHEEL_CLOCKWISE:e.deltaY<0&&(t=l.WHEEL_ANTICLOCKWISE),t},e.getAssistKey=function(e){var t=0;return s.isMac()||s.isIPad()?(t+=e.altKey?i.ALT:0,t+=e.shiftKey?i.SHIFT:0,t+=e.ctrlKey?i.CTRL_MAC:0,t+=e.metaKey?i.COMMAND:0):(t+=e.altKey?i.ALT:0,t+=e.shiftKey?i.SHIFT:0,t+=e.ctrlKey?i.CTRL_WIN:0,t+=e.metaKey?i.WIN:0),t},e}(),h=function(){function e(e,t){void 0===t&&(t=!1);var n=this;this.keymap=new Map,this.onKeyEvent=function(e){var t=p.getKeyCode(e),r=p.getAssistKey(e)+t;n.run(r,e)},this.onMouseEvent=function(e){var t=p.getMouseCode(e),r=p.getAssistKey(e)+t;n.run(r,e)},this.onWheelEvent=function(e){var t=p.getWheelCode(e),r=p.getAssistKey(e)+t;n.run(r,e)},this.sorter=function(e,t){return(t.weight||0)-(e.weight||0)},this.useCapture=t,this.targetNode=e||document,this.targetNode.addEventListener("keydown",this.onKeyEvent,{capture:t}),this.targetNode.addEventListener("mousedown",this.onMouseEvent,{capture:t}),this.targetNode.addEventListener("wheel",this.onWheelEvent,{passive:!1})}return e.prototype.register=function(e){var t=this;if(this.isValidContributedKeyBinding(e)){var n=s.isMac()||s.isIOS()?"mac":"win";[].concat(e.keyBindings[n]).forEach((function(n){if(n!==r.EMPTY){var o=[e];if(t.keymap.has(n)){var i=t.keymap.get(n);i&&(o=o.concat(i))}t.keymap.set(n,o)}}))}},e.prototype.removeByFeature=function(e){var t=this,n=[],r=[];this.keymap.forEach((function(t,o){t.forEach((function(i){i.handler===e&&(1===t.length?n.push(o):r.push([o,i]))}))})),n.forEach((function(e){t.keymap.delete(e)})),r.forEach((function(e){var n=(0,a.__read)(e,2),r=n[0],o=n[1],i=t.keymap.get(r);t.keymap.set(r,i.filter((function(e){return e.handler!==o.handler})))}))},e.prototype.destroy=function(){this.targetNode.removeEventListener("keydown",this.onKeyEvent,{capture:this.useCapture}),this.targetNode.removeEventListener("mousedown",this.onMouseEvent,{capture:this.useCapture}),this.targetNode.removeEventListener("wheel",this.onWheelEvent)},e.prototype.remove=function(e){var t=this;if(this.isValidContributedKeyBinding(e)){var n=s.isMac()||s.isIOS()?"mac":"win";[].concat(e.keyBindings[n]).forEach((function(n){if(n!==r.EMPTY&&t.keymap.has(n)){var o=t.keymap.get(n),i=o.findIndex((function(t){return t.keyBindings.win.join("")===e.keyBindings.win.join("")&&t.keyBindings.mac.join("")===e.keyBindings.mac.join("")&&t.handler===e.handler&&t.when===e.when&&t.shouldPreventDefault===e.shouldPreventDefault&&t.weight===e.weight}));if(-1!==i){var a=o.concat();a.splice(i,1),t.keymap.set(n,a)}}}))}},e.prototype.get=function(e){var t=this;return("number"==typeof e?[e]:e[s.isMac()||s.isIOS()?"mac":"win"]).reduce((function(e,n){var r;return e.concat.apply(e,(0,a.__spreadArray)([],(0,a.__read)(null!==(r=t.keymap.get(n))&&void 0!==r?r:[]),!1))}),[])},e.prototype.isValidContributedKeyBinding=function(e){return!(!e||"function"!=typeof e.handler||e.when&&"function"!=typeof e.when||e.keyBindings.mac&&!Array.isArray(e.keyBindings.mac)||e.keyBindings.win&&!Array.isArray(e.keyBindings.win)||e.description&&!Array.isArray(e.description))},e.prototype.run=function(e,t){var n=this.keymap.get(e);null==n||n.sort(this.sorter),null==n||n.forEach((function(e){var n=e.handler,r=e.shouldPreventDefault,o=void 0===r||r,i=e.when;!(null==i?void 0:i())&&i||(o&&t&&t.preventDefault(),n(t))}))},e}()},87782:function(e,t,n){n.r(t),n.d(t,{IdleValue:function(){return h},Priority:function(){return r},createScheduler:function(){return p},defineIdleProperties:function(){return g},defineIdleProperty:function(){return f},scheduler:function(){return d}});var r,o=function(){if("object"==typeof performance&&"function"==typeof performance.now)return function(){return performance.now()};var e=Date,t=e.now();return function(){return e.now()-t}}(),i=function(){function e(){var e=this;this.isMessageLoopRunning=!1,this.performWorkUntilDeadline=function(t){var n;if(e.deadline=t,e.scheduledHostCallback){var r=o(),i=(null==t?void 0:t.didTimeout)||!1;e.scheduledHostCallback(i,r)?null===(n=window.requestIdleCallback)||void 0===n||n.call(window,e.performWorkUntilDeadline,{timeout:500}):(e.isMessageLoopRunning=!1,e.scheduledHostCallback=void 0)}else e.isMessageLoopRunning=!1}}return e.prototype.shouldYieldToHost=function(e){var t,n,r,o;void 0===e&&(e=0);var i=null===(n=null===(t=this.deadline)||void 0===t?void 0:t.timeRemaining)||void 0===n?void 0:n.call(t);if(void 0!==i&&i<e)return!0;var a=navigator;return!!(null===(o=null===(r=null==a?void 0:a.scheduling)||void 0===r?void 0:r.isInputPending)||void 0===o?void 0:o.call(r))},e.prototype.requestHostCallback=function(e){if("function"!=typeof window.requestIdleCallback)throw Error("requestIdleCallback undefined when use ExecutorIdleCallback!");this.scheduledHostCallback=e,this.isMessageLoopRunning||(this.isMessageLoopRunning=!0,window.requestIdleCallback(this.performWorkUntilDeadline,{timeout:500}))},e}(),a=function(){function e(){}return e.prototype.shouldYieldToHost=function(){return!1},e.prototype.requestHostCallback=function(e){var t=this;this.scheduledHostCallback?setTimeout((function(){return t.requestHostCallback(e)}),0):(this.scheduledHostCallback=e,setTimeout((function(){return t.flushCallback()}),0))},e.prototype.flushCallback=function(){var e=this;if(this.scheduledHostCallback)try{var t=o();this.scheduledHostCallback(!1,t),this.scheduledHostCallback=void 0}catch(t){throw setTimeout((function(){return e.flushCallback()}),0),t}},e}(),s=function(){function e(){var t=this;this.maxYieldInterval=300,this.yieldInterval=10,this.deadline=0,this.isMessageLoopRunning=!1,e.UUID+=1,this.key=""+e.UUID,c.get().onMessage(this.key,(function(){t.performWorkUntilDeadline()}))}return e.prototype.shouldYieldToHost=function(){var e,t,n=navigator;if(void 0!==(null===(e=null==n?void 0:n.scheduling)||void 0===e?void 0:e.isInputPending)){var r=n.scheduling,i=o();return i>=this.deadline&&(!!(null===(t=r.isInputPending)||void 0===t?void 0:t.call(r))||i>=this.maxYieldInterval)}return o()>=this.deadline},e.prototype.requestHostCallback=function(e){this.scheduledHostCallback=e,this.isMessageLoopRunning||(this.isMessageLoopRunning=!0,c.get().postMessage(this.key))},e.prototype.performWorkUntilDeadline=function(){if(this.scheduledHostCallback){var e=o();this.deadline=e+this.yieldInterval;var t=this.scheduledHostCallback(!1,e);try{t?c.get().postMessage(this.key):(this.isMessageLoopRunning=!1,this.scheduledHostCallback=void 0)}catch(e){throw c.get().postMessage(this.key),e}}else this.isMessageLoopRunning=!1},e.UUID=0,e}(),c=function(){function e(){var e=this;this.callbacks=new Map,this.channel=new MessageChannel,this.port=this.channel.port2,this.channel.port1.onmessage=function(t){var n=t.data,r=e.callbacks.get(n);"function"==typeof r?r():null===console||void 0===console||console.warn("non callback found by "+n)}}return e.get=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.onMessage=function(e,t){this.callbacks.set(e,t)},e.prototype.postMessage=function(e){this.port.postMessage(e)},e}(),l=function(){function e(){this.heap=[]}return e.prototype.push=function(e){var t=this.heap.length;this.heap.push(e),this.siftUp(e,t)},e.prototype.peek=function(){return this.heap[0]},e.prototype.pop=function(){var e=this.heap[0];if(void 0!==e){var t=this.heap.pop();return t&&t!==e&&(this.heap[0]=t,this.siftDown(t,0)),e}},e.prototype.size=function(){return this.heap.length},e.prototype.clear=function(){this.heap=[]},e.prototype.siftUp=function(e,t){for(var n=t;;){var r=n-1>>>1,o=this.heap[r];if(!(void 0!==o&&this.compare(o,e)>0))return;this.heap[r]=e,this.heap[n]=o,n=r}},e.prototype.siftDown=function(e,t){for(var n=t,r=this.heap.length;n<r;){var o=2*(n+1)-1,i=this.heap[o],a=o+1,s=this.heap[a];if(void 0!==i&&this.compare(i,e)<0)void 0!==s&&this.compare(s,i)<0?(this.heap[n]=s,this.heap[a]=e,n=a):(this.heap[n]=i,this.heap[o]=e,n=o);else{if(!(void 0!==s&&this.compare(s,e)<0))return;this.heap[n]=s,this.heap[a]=e,n=a}}},e.prototype.compare=function(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id},e}();!function(e){e[e.hight=1]="hight",e[e.normal=2]="normal",e[e.low=3]="low",e[e.idle=4]="idle"}(r||(r={}));var u=function(){function e(){var e=this;this.highPriorityTimeout=0,this.normalPriorityTimeout=2e3,this.lowPriorityTimeout=5e3,this.idlePriorityTimeout=1073741823,this.taskIdCounter=1,this.isSchedulerPaused=!1,this.isHostCallbackSchedule=!1,this.isPerformingWork=!1,this.flushWork=function(t,n){e.isHostCallbackSchedule=!1;try{return e.workLoop(t,n)}finally{e.currentTask=void 0,e.isPerformingWork=!1}},this.workLoop=function(t,n){var r=n;for(e.currentTask=e.taskQueue.peek();e.currentTask&&!e.isSchedulerPaused;){var o=e.currentTask,i=o.expirationTime,a=o.minTime;if(i>r&&(t||e.executor.shouldYieldToHost(a)))break;var s=e.currentTask.callback;if("function"==typeof s){e.currentTask.callback=void 0;var c=s();"function"==typeof c?e.currentTask.callback=c:e.currentTask===e.taskQueue.peek()&&e.taskQueue.pop()}else e.taskQueue.pop();e.currentTask=e.taskQueue.peek()}return!!e.currentTask},this.taskQueue=new l,this.executor=this.createHostExecutor()}return e.prototype.scheduleTask=function(e,t){var n,i=o();switch((null==t?void 0:t.priority)||r.idle){case r.hight:n=this.highPriorityTimeout;break;case r.normal:n=this.normalPriorityTimeout;break;case r.low:n=this.lowPriorityTimeout;break;case r.idle:default:n=this.idlePriorityTimeout}var a=null==t?void 0:t.minTime;void 0===a&&(a=1),this.taskIdCounter+=1;var s={id:this.taskIdCounter,expirationTime:i+n,sortIndex:i+n,minTime:a,callback:e};return this.taskQueue.push(s),this.isHostCallbackSchedule||this.isPerformingWork||(this.isHostCallbackSchedule=!0,this.executor.requestHostCallback(this.flushWork)),s},e.prototype.cancelTask=function(e){e.callback=void 0},e.prototype.clearPendingTasks=function(){this.taskQueue.clear()},e.prototype.pause=function(){this.isSchedulerPaused=!0},e.prototype.continue=function(){this.isSchedulerPaused=!1,this.isHostCallbackSchedule||this.isPerformingWork||(this.isHostCallbackSchedule=!0,this.executor.requestHostCallback(this.flushWork))},e.prototype.createHostExecutor=function(){try{if("function"==typeof(null===window||void 0===window?void 0:window.requestIdleCallback))return new i;if("undefined"!=typeof MessageChannel)return new s}catch(e){null===console||void 0===console||console.info("use polyfill executor")}return new a},e}(),d=new u;function p(){return new u}var h=function(){function e(e,t){var n=this;this.initFun=e,this.idleHandle=d.scheduleTask((function(){n.value=n.initFun()}),t)}return e.prototype.getValue=function(){return void 0===this.value&&(this.cancelIdleInit(),this.value=this.initFun()),this.value},e.prototype.setValue=function(e){this.cancelIdleInit(),this.value=e},e.prototype.cancelIdleInit=function(){this.idleHandle&&(d.cancelTask(this.idleHandle),this.idleHandle=void 0)},e}(),f=function(e,t,n){var r=new h(n);Object.defineProperty(e,t,{configurable:!0,get:r.getValue.bind(r),set:r.setValue.bind(r)})},g=function(e,t){Object.keys(t).forEach((function(n){f(e,n,t[n])}))}},3139:function(e,t,n){n.d(t,{RU:function(){return w},Ln:function(){return E},tB:function(){return O},GS:function(){return k},Am:function(){return P},aN:function(){return D},zt:function(){return m},ll:function(){return b}});var r=n(85556);function o(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}function i(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function a(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}var s,c=function(){if("object"==typeof performance&&"function"==typeof performance.now)return function(){return performance.now()};var e=Date,t=e.now();return function(){return e.now()-t}}(),l=function(){function e(){var e=this;this.isMessageLoopRunning=!1,this.performWorkUntilDeadline=function(t){var n;if(e.deadline=t,e.scheduledHostCallback){var r=c(),o=(null==t?void 0:t.didTimeout)||!1;e.scheduledHostCallback(o,r)?null===(n=window.requestIdleCallback)||void 0===n||n.call(window,e.performWorkUntilDeadline,{timeout:500}):(e.isMessageLoopRunning=!1,e.scheduledHostCallback=void 0)}else e.isMessageLoopRunning=!1}}return e.prototype.shouldYieldToHost=function(e){var t,n,r,o;void 0===e&&(e=0);var i=null===(n=null===(t=this.deadline)||void 0===t?void 0:t.timeRemaining)||void 0===n?void 0:n.call(t);if(void 0!==i&&i<e)return!0;var a=navigator;return!!(null===(o=null===(r=null==a?void 0:a.scheduling)||void 0===r?void 0:r.isInputPending)||void 0===o?void 0:o.call(r))},e.prototype.requestHostCallback=function(e){if("function"!=typeof window.requestIdleCallback)throw Error("requestIdleCallback undefined when use ExecutorIdleCallback!");this.scheduledHostCallback=e,this.isMessageLoopRunning||(this.isMessageLoopRunning=!0,window.requestIdleCallback(this.performWorkUntilDeadline,{timeout:500}))},e}(),u=function(){function e(){}return e.prototype.shouldYieldToHost=function(){return!1},e.prototype.requestHostCallback=function(e){var t=this;this.scheduledHostCallback?setTimeout((function(){return t.requestHostCallback(e)}),0):(this.scheduledHostCallback=e,setTimeout((function(){return t.flushCallback()}),0))},e.prototype.flushCallback=function(){var e=this;if(this.scheduledHostCallback)try{var t=c();this.scheduledHostCallback(!1,t),this.scheduledHostCallback=void 0}catch(t){throw setTimeout((function(){return e.flushCallback()}),0),t}},e}(),d=function(){function e(){var t=this;this.maxYieldInterval=300,this.yieldInterval=10,this.deadline=0,this.isMessageLoopRunning=!1,e.UUID+=1,this.key=""+e.UUID,p.get().onMessage(this.key,(function(){t.performWorkUntilDeadline()}))}return e.prototype.shouldYieldToHost=function(){var e,t,n=navigator;if(void 0!==(null===(e=null==n?void 0:n.scheduling)||void 0===e?void 0:e.isInputPending)){var r=n.scheduling,o=c();return o>=this.deadline&&(!!(null===(t=r.isInputPending)||void 0===t?void 0:t.call(r))||o>=this.maxYieldInterval)}return c()>=this.deadline},e.prototype.requestHostCallback=function(e){this.scheduledHostCallback=e,this.isMessageLoopRunning||(this.isMessageLoopRunning=!0,p.get().postMessage(this.key))},e.prototype.performWorkUntilDeadline=function(){if(this.scheduledHostCallback){var e=c();this.deadline=e+this.yieldInterval;var t=this.scheduledHostCallback(!1,e);try{t?p.get().postMessage(this.key):(this.isMessageLoopRunning=!1,this.scheduledHostCallback=void 0)}catch(e){throw p.get().postMessage(this.key),e}}else this.isMessageLoopRunning=!1},e.UUID=0,e}(),p=function(){function e(){var e=this;this.callbacks=new Map,this.channel=new MessageChannel,this.port=this.channel.port2,this.channel.port1.onmessage=function(t){var n=t.data,r=e.callbacks.get(n);"function"==typeof r?r():null===console||void 0===console||console.warn("non callback found by "+n)}}return e.get=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.onMessage=function(e,t){this.callbacks.set(e,t)},e.prototype.postMessage=function(e){this.port.postMessage(e)},e}(),h=function(){function e(){this.heap=[]}return e.prototype.push=function(e){var t=this.heap.length;this.heap.push(e),this.siftUp(e,t)},e.prototype.peek=function(){return this.heap[0]},e.prototype.pop=function(){var e=this.heap[0];if(void 0!==e){var t=this.heap.pop();return t&&t!==e&&(this.heap[0]=t,this.siftDown(t,0)),e}},e.prototype.size=function(){return this.heap.length},e.prototype.clear=function(){this.heap=[]},e.prototype.siftUp=function(e,t){for(var n=t;;){var r=n-1>>>1,o=this.heap[r];if(!(void 0!==o&&this.compare(o,e)>0))return;this.heap[r]=e,this.heap[n]=o,n=r}},e.prototype.siftDown=function(e,t){for(var n=t,r=this.heap.length;n<r;){var o=2*(n+1)-1,i=this.heap[o],a=o+1,s=this.heap[a];if(void 0!==i&&this.compare(i,e)<0)void 0!==s&&this.compare(s,i)<0?(this.heap[n]=s,this.heap[a]=e,n=a):(this.heap[n]=i,this.heap[o]=e,n=o);else{if(!(void 0!==s&&this.compare(s,e)<0))return;this.heap[n]=s,this.heap[a]=e,n=a}}},e.prototype.compare=function(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id},e}();!function(e){e[e.hight=1]="hight",e[e.normal=2]="normal",e[e.low=3]="low",e[e.idle=4]="idle"}(s||(s={}));var f=function(){function e(){var e=this;this.highPriorityTimeout=0,this.normalPriorityTimeout=2e3,this.lowPriorityTimeout=5e3,this.idlePriorityTimeout=1073741823,this.taskIdCounter=1,this.isSchedulerPaused=!1,this.isHostCallbackSchedule=!1,this.isPerformingWork=!1,this.flushWork=function(t,n){e.isHostCallbackSchedule=!1;try{return e.workLoop(t,n)}finally{e.currentTask=void 0,e.isPerformingWork=!1}},this.workLoop=function(t,n){var r=n;for(e.currentTask=e.taskQueue.peek();e.currentTask&&!e.isSchedulerPaused;){var o=e.currentTask,i=o.expirationTime,a=o.minTime;if(i>r&&(t||e.executor.shouldYieldToHost(a)))break;var s=e.currentTask.callback;if("function"==typeof s){e.currentTask.callback=void 0;var c=s();"function"==typeof c?e.currentTask.callback=c:e.currentTask===e.taskQueue.peek()&&e.taskQueue.pop()}else e.taskQueue.pop();e.currentTask=e.taskQueue.peek()}return!!e.currentTask},this.taskQueue=new h,this.executor=this.createHostExecutor()}return e.prototype.scheduleTask=function(e,t){var n,r=c();switch((null==t?void 0:t.priority)||s.idle){case s.hight:n=this.highPriorityTimeout;break;case s.normal:n=this.normalPriorityTimeout;break;case s.low:n=this.lowPriorityTimeout;break;case s.idle:default:n=this.idlePriorityTimeout}var o=null==t?void 0:t.minTime;void 0===o&&(o=1),this.taskIdCounter+=1;var i={id:this.taskIdCounter,expirationTime:r+n,sortIndex:r+n,minTime:o,callback:e};return this.taskQueue.push(i),this.isHostCallbackSchedule||this.isPerformingWork||(this.isHostCallbackSchedule=!0,this.executor.requestHostCallback(this.flushWork)),i},e.prototype.cancelTask=function(e){e.callback=void 0},e.prototype.clearPendingTasks=function(){this.taskQueue.clear()},e.prototype.pause=function(){this.isSchedulerPaused=!0},e.prototype.continue=function(){this.isSchedulerPaused=!1,this.isHostCallbackSchedule||this.isPerformingWork||(this.isHostCallbackSchedule=!0,this.executor.requestHostCallback(this.flushWork))},e.prototype.createHostExecutor=function(){if("function"==typeof window.requestIdleCallback)return new l;try{if("undefined"!=typeof MessageChannel)return new d}catch(e){null===console||void 0===console||console.info("use polyfill executor")}return new u},e}(),g=new f,v=function(){function e(e,t){var n=this;this.initFun=e,this.idleHandle=g.scheduleTask((function(){n.value=n.initFun()}),t)}return e.prototype.getValue=function(){return void 0===this.value&&(this.cancelIdleInit(),this.value=this.initFun()),this.value},e.prototype.setValue=function(e){this.cancelIdleInit(),this.value=e},e.prototype.cancelIdleInit=function(){this.idleHandle&&(g.cancelTask(this.idleHandle),this.idleHandle=void 0)},e}(),y=n(19082),m=function(){function e(e){this.provide=e,this._useClass=(0,y.ll)(e),this.overridable=!1}return Object.defineProperty(e.prototype,"className",{get:function(){return(0,y.FM)(this.provide)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"useClass",{get:function(){return this._useClass},set:function(e){this._useClass=e},enumerable:!1,configurable:!0}),e}();o([(0,y.NG)(),i("design:type",y.Dy)],m.prototype,"_useClass",void 0),o([(0,y.NG)(),i("design:type",Object)],m.prototype,"provide",void 0),o([(0,y.NG)(),i("design:type",Object)],m.prototype,"instance",void 0),o([(0,y.NG)(),i("design:type",String)],m.prototype,"type",void 0),o([(0,y.NG)(),i("design:type",Boolean)],m.prototype,"singleton",void 0),o([(0,y.NG)(),i("design:type",Boolean)],m.prototype,"supportDeferInvoke",void 0),o([(0,y.NG)(),i("design:type",Boolean)],m.prototype,"overridable",void 0);var b=new y.Bz(m),_=function(e){function t(){return e.call(this,b)||this}return(0,r.__extends)(t,e),t}(y.bP),C=n(66624),S=function(){function e(){var t=(0,C.Ey)(e.workbenchInstantionId);this.instantion=C.yB.getInstantiation(t)}return e.prototype.adoptBy=function(e){this.instantion.mergeTo(e)},e.prototype.invokable=function(e){y.SF.getParamTypes(e).forEach((function(t,n){try{C.Bc.addServiceDependencies(e,t,n)}catch(e){console.warn("[IOC] ".concat(e.message))}}))},e.prototype.get=function(e){return this.instantion.invokeFunction((function(t){return t.get(e)}))},e.prototype.set=function(e,t){var n,r=e;if(t.instance)this.instantion.addService(r,t.instance);else{var o=new C.Mj(null!==(n=t.useClass)&&void 0!==n?n:t.provide,[],t.supportDeferInvoke,t.overridable);this.instantion.addService(r,o)}return this},e.prototype.addHook=function(e,t,n){var r=e;this.instantion.addHook(t,r,n)},e.prototype.getServiceDependency=function(e){return C.Bc.getServiceDependencies(e).map((function(e){return e.id}))},e.prototype.getClass=function(e){return this.instantion.getClass(e)},e.prototype.has=function(e){return this.instantion.has(e)},e}();S.workbenchInstantionId="workbenchInstantion";var w=function(){function e(e){this.key=e,this.loaded=!1}return Object.defineProperty(e.prototype,"instance",{get:function(){return P.get(this.key)},enumerable:!1,configurable:!0}),e.prototype.getModule=function(){var e;return a(this,void 0,void 0,(function(){var t,n;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.useFactory()];case 1:return t=r.sent(),P.has(this.key)||(n=b.get(t),P.set(Object.assign(Object.assign({},n),{provide:this.key,useClass:t}))),this.promise=null,this.loaded=!0,null===(e=this.onModuleLoad)||void 0===e||e.call(this,t),[2,t]}}))}))},e.prototype.load=function(){return this.promise||(this.promise=this.getModule()),this.promise},e.prototype.getInstance=function(){return a(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return P.has(this.key)?[2,this.instance]:[4,this.load()];case 1:return e.sent(),[2,this.instance]}}))}))},e}(),E=new(function(e){function t(){var t=e.call(this,w)||this;return t.triggerMap=new Map,t}return(0,r.__extends)(t,e),t.prototype.merge=function(t,n){var r=this;if(e.prototype.merge.call(this,t,n),n.on){var o=this.triggerMap.get(n.on);o&&!o.resolved?o.loaders.push(t):(null==o?void 0:o.resolved)?this.get(t).load():(this.triggerMap.set(n.on,{loaders:[t],resolved:!1}),n.on((function(){return new Promise((function(e){var t=r.triggerMap.get(n.on);t.resolved=!0,Promise.all(t.loaders.map((function(e){var t;return null===(t=r.get(e))||void 0===t?void 0:t.load()}))).then((function(){return e()}))}))})))}},t}(y.Bz)),x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.setCallback=function(e,t){this.get(e)||this.set(e,[]);var n=this.get(e);null==n||n.push(t)},t}(y.zl),T=new x,R="No matching bindings found for target, Did you forget @inject for interface?",I="function"==typeof Proxy&&Proxy.toString().includes("[native code]"),P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.getServices=function(e,t,n){var r=this;return t.map((function(t,o){var i="function"==typeof t?(0,y.FM)(t):t;if(e.has(i))return e.get(i);if(e.has(t))return e.get(t);if(r.has(t))return r.get(t);if(n)throw new Error("".concat(R,", the ").concat(o," param requested by").concat(String(n)," "))}))},t.withContainer=function(e){var t=this;this.container=new S,this.container.adoptBy(e),b.forEach((function(e,n){var r;t.container.set(n,e),t.registerPostConstructorInContainer(n,t.container),null===(r=t.container)||void 0===r||r.invokable(e.useClass)})),this.aliases.forEach((function(e,n){var r=b.get(e);r?t.container.set(n,r):console.error("cannot find alias's corresponding provider in ProviderRegistry")}))},t.registerPostConstructorInContainer=function(e,t){var n=T.get(e);null==n||n.forEach((function(n){t.addHook(e,C.qt.POST_CONSTRUCTOR,n)}))},t.invoke=function(e,t,n){void 0===t&&(t=new Map),n||(n=y.SF.getParamTypes(e));var o=this.getServices(t,n,e);return new(e.bind.apply(e,(0,r.__spreadArray)([void 0],(0,r.__read)(o),!1)))},t.invokeMethod=function(e,t){var n,o,i,a=new Map;if(t instanceof Array?n=t:(n=t.designParamTypes,o=t.target,i=t.methodName,t.locals&&(a=t.locals)),a instanceof Map==0&&(a=new Map),e.$injected)return e.call(o,a);n||(n=y.SF.getParamTypes(o,i));var s=this.getServices(a,n);return e.apply(void 0,(0,r.__spreadArray)([],(0,r.__read)(s),!1))},t.invokeGetter=function(e,t){var n=y.SF.getType(e,t);if(this.has(n))return this.get(n)},t.invokeProxy=function(e,n,r){if(void 0===n&&(n=new Map),!I)return t.invoke(e,n,r);var o=new v((function(){return t.invoke(e,n,r)}),{priority:s.normal});return new Proxy(Object.create(null),{get:function(t,n){if(n in t)return t[n];if("constructor"===n)return e.constructor;if("prototype"===n)return e.prototype;var r=o.getValue(),i=r[n];return"function"!=typeof i||(i=i.bind(r),t[n]=i),i},set:function(e,t,n){return e[t]=n,o.getValue()[t]=n,!0},defineProperty:function(e,t,n){var r=o.getValue();return Object.defineProperty(r,t,n),!0},getPrototypeOf:function(){return e.prototype}})},t.set=function(e,n){var o,i;void 0===e.provide?e={provide:i=e,useClass:i,instance:n}:i=e.provide;var a=e.useClass;if(e.useClass===w){var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t}(w);a=s}if(b.merge(a,e),this.container&&this.container.set(a,e),a&&i!==a&&this.alias(i,a),E.has(e.provide)){var c=E.get(e.provide);c.loaded=!0,null===(o=c.onModuleLoad)||void 0===o||o.call(c,e.useClass)}return t},t.get=function(e){var n,r=null!==(n=this.aliases.get(e))&&void 0!==n?n:e,o=b.get(r);if(!this.has(e))throw new Error("".concat(R,":").concat(String(e)));var i=null==o?void 0:o.instance;return i||(this.container?(i=this.container.get(r),o&&(o.instance=i),i):o?(o.instance=t.invoke(o.useClass),t.runPostConstructors(e,o),i=o.instance):i)},t.runPostConstructors=function(e,t){var n=T.get(e);n&&n.forEach((function(n){try{n(t.instance)}catch(n){console.error((r=t.useClass,o=e,i=n.message,"postConstruct error in class ".concat(r.name,", with key ").concat(String(o),":").concat(i," "))),console.error(n)}var r,o,i}))},t.has=function(e){var t,n,r=null!==(t=this.aliases.get(e))&&void 0!==t?t:e;return(null===(n=this.container)||void 0===n?void 0:n.has(r))||b.has(r)},t.alias=function(e,t){this.aliases.set(e,(0,y.ll)(t));var n=b.get((0,y.ll)(t));n?this.container&&this.container.set(e,n):console.error("cannot find alias's corresponding provider in ProviderRegistry")},t.construct=function(e){var t,n=null!==(t=this.aliases.get(e))&&void 0!==t?t:e,r=b.get(n);return this.invoke(r.useClass)},t.override=function(e,t){var n,r=null!==(n=this.aliases.get(e))&&void 0!==n?n:e,o=b.get(r);o?o.overridable?(o.useClass=t,o.instance=void 0):console.warn("Original class cannot be overrided"):console.error("Original class has not been registered")},t.hasClass=function(e){var t,n=null!==(t=this.aliases.get(e))&&void 0!==t?t:e;return!!b.get(n)},t.getClass=function(e){var t,n=null!==(t=this.aliases.get(e))&&void 0!==t?t:e;return b.get(n).useClass},t.invokable=function(e){this.container&&this.container.invokable(e)},t.emit=function(e){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];return a(this,void 0,void 0,(function(){var o;return(0,r.__generator)(this,(function(i){return o=[],b.forEach((function(i){if(i.instance){var a=t.get(i.provide);if(a&&e in a)try{o.push(a[e].apply(a,(0,r.__spreadArray)([],(0,r.__read)(n),!1)))}catch(e){console.error(e)}}})),[2,Promise.all(o)]}))}))},t.emitOn=function(e,n){for(var o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];return a(this,void 0,void 0,(function(){var i,a,s;return(0,r.__generator)(this,(function(c){return i=[],a=b,s=function(e){return!0},n instanceof y.Bz?a=n:s=n,a.forEach((function(n,a){if(s(n)&&n.instance){var c=t.get(a);if(c instanceof n.useClass&&c&&e in c)try{i.push(c[e].apply(c,(0,r.__spreadArray)([],(0,r.__read)(o),!1)))}catch(e){console.error(e)}}})),[2,Promise.all(i)]}))}))},t.emitAt=function(e,n){for(var o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];return a(this,void 0,void 0,(function(){var i;return(0,r.__generator)(this,(function(a){if((i=t.get(n))&&e in i)try{return[2,new Promise((function(t){t(i[e].apply(i,(0,r.__spreadArray)([],(0,r.__read)(o),!1)))}))]}catch(e){console.error(e)}return[2,Promise.resolve(null)]}))}))},t.buildRegistry=function(e,n){var r=this;return void 0===n&&(n=function(e){return void 0===e.instance}),e.forEach((function(e){n(e)&&(r.container?e.instance=r.container.get(e.useClass):e.supportDeferInvoke?e.instance=t.invokeProxy(e.useClass):e.instance=t.invoke(e.useClass))})),e},t.service=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var o=e[e.length-1],i=e[e.length-2],a=i;3===e.length&&(a=(0,r.__read)(e,1)[0]),t.set(Object.assign(Object.assign({overridable:!1},o),{singleton:!0,provide:a,useClass:i}))},t.bind=function(e,n){var r=b.get(n);if(!r)throw new Error("target should be injectable");if(r.instance)throw new Error("target has been instantiated");var o=b.get(e);if(o||(t.set({provide:e,useClass:n,overridable:!0}),o=b.get(e)||b.get(n)),o.instance)throw new Error("token's target has been instantiated");if(!o.overridable&&this.container)throw new Error("containerized requires provider be overridable in order to bind");return o.useClass=n,this.container&&this.container.set(e,o),this},t.addPostConstructor=function(e,t){T.setCallback(e,t),this.container&&this.container.addHook(e,C.qt.POST_CONSTRUCTOR,t)},t.prototype.invoke=function(e,n,r){return void 0===n&&(n=new Map),t.invoke(e,n,r)},t.prototype.invokeMethod=function(e,n){return t.invokeMethod(e,n)},t.prototype.invokeGetter=function(e,n){return t.invokeGetter(e,n)},t.prototype.get=function(e){return t.get(e)},t.prototype.set=function(e,n){return t.set(n),this},t.prototype.has=function(e){return t.has(e)},t.prototype.construct=function(e){return t.construct(e)},t.prototype.override=function(e,n){t.override(e,n)},t.prototype.emit=function(e){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];return t.emit.apply(t,(0,r.__spreadArray)([e],(0,r.__read)(n),!1))},t.prototype.emitOn=function(e,n){for(var o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];return t.emitOn.apply(t,(0,r.__spreadArray)([e,n],(0,r.__read)(o),!1))},t.prototype.emitAt=function(e,n){for(var o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];return t.emitAt.apply(t,(0,r.__spreadArray)([e,n],(0,r.__read)(o),!1))},t}(_);function O(e){return function(t,n,r){if("number"!=typeof r){if(void 0===r&&(r=(0,y.yH)(t,n)),void 0===r)return e&&y.SF.setType(t,n,e),{get:function(){return P.invokeGetter(t,n)}};var o=r.value;return r.value=function(e){return void 0===e&&(e=new Map),e instanceof Map==0&&(e=new Map),P.invokeMethod(o.bind(this),{target:t,methodName:n,locals:e})},r.value.$injected=!0,r}if(e){var i=y.SF.getParamTypes(t,n);i[r]=e,y.SF.setParamTypes(t,n,i)}}}function k(e){return function(t){return P.set(Object.assign(Object.assign({provide:t},e),{useClass:t})),t}}function D(e){var t=Symbol.for("loader:".concat(e.toString())),n=E.createIfNotExists(e);return P.has(t)||P.factory(t,n),function(e,n,r){if("number"!=typeof r)return void 0===r&&(r=(0,y.yH)(e,n)),void 0===r?(y.SF.setType(e,n,t),{get:function(){return P.invokeGetter(e,n)}}):r;var o=y.SF.getParamTypes(e,n);o[r]=t,y.SF.setParamTypes(e,n,o)}}P.aliases=new Map,P.container=null,P.factory=function(e,t){return P.set({provide:e,useClass:(0,y.ll)(t),instance:t,singleton:!0})},P.factory(P,new P),Symbol("jest:done")},19082:function(e,t,n){n.d(t,{SF:function(){return b},NG:function(){return C},zl:function(){return E},bP:function(){return w},Bz:function(){return x},w7:function(){return I},yh:function(){return R},Dy:function(){return _},o0:function(){return p},yH:function(){return d},ll:function(){return s},Yt:function(){return T},Xy:function(){return g},tI:function(){return i},FM:function(){return u},tr:function(){return l}});var r=n(85556);function o(e){return e===Array||Array.isArray(e)}function i(e){return e===Promise||e instanceof Promise}function a(e){return function(e){return"string"==typeof e||e instanceof String||e===String}(e)||function(e){return"number"==typeof e||e instanceof Number||e===Number}(e)||function(e){return"boolean"==typeof e||e instanceof Boolean||e===Boolean}(e)}function s(e){return e.prototype?e:e.constructor}function c(e){return"symbol"==typeof e?e:s(e)}var l=function(e){var t;return"function"==typeof e?null!==(t=e.displayName)&&void 0!==t?t:e.name:l(e.constructor)},u=function(e){switch(typeof e){default:return"".concat(e);case"symbol":return e.toString().replace("Symbol(","").replace(")","");case"function":return l(e)}};function d(e,t){var n;return Object.getOwnPropertyDescriptor(null!==(n=null==e?void 0:e.prototype)&&void 0!==n?n:e,t)}function p(e,t,n){if(void 0===n&&(n={}),null==t)return t;if(a(t)||"symbol"==typeof t||"function"==typeof t)return t;e=o(t)?e||[]:e||{};var r=n.default?n.default:function(e,t){return e.push(t),e},i=function(n,r){o(t)?e.push(r):e[n]=r};return Object.keys(t).forEach((function(s){var c=t[s];if(null!=c&&(""!==c||""===e[s])){if(!a(c)&&"function"!=typeof c)return o(c)?(c=c.map((function(e){return p(void 0,e)})),void i(s,[].concat(e[s]||[],c).reduce((function(e,t){return n[s]?n[s](e,t):r(e,c)}),[]))):void(o(t)?i(s,p(void 0,c,n)):i(s,p(e[s],c,n)));i(s,c)}})),o(e)&&e.reduce((function(e,t){return r(e,t)}),[]),e}function h(e){return null===e}function f(e){return"object"==typeof e&&!h(e)}function g(e,t){try{if(e===t)return!(h(s=e)||function(e){return void 0===e}(s));if(!f(e)||!f(t))return!1;if(Array.isArray(e)||Array.isArray(t))return!(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length||e.filter((function(e,n){return!g(e,t[n])})).length>0);if(e instanceof Map||t instanceof Map){if(!(e instanceof Map&&t instanceof Map))return!1;if(e.size!==t.size)return!1;for(var n=e.entries(),o=n.next().value;o;){var i=(0,r.__read)(o,2),a=i[0];if(!g(i[1],t.get(a)))return!1;o=n.next().value}return!0}if(e instanceof Object&&t instanceof Object)return Object.keys(e).length===Object.keys(t).length&&!(Object.entries(e).filter((function(e){var n=(0,r.__read)(e,2),o=n[0];return!g(n[1],t[o])})).length>0)}catch(e){return console.error("workbench deep equal function crash",e),!1}var s;return!1}var v="design:paramtypes",y="design:type",m=new Map,b=function(){function e(){}return e.set=function(e,t,n,r){var o=m.has(e)?m.get(e):[],i=s(n);-1===o.indexOf(i)&&(o.push(i),m.set(e,o)),Reflect.defineMetadata(e,t,s(n),r)},e.getParamTypes=function(e,t){var n;return null!==(n=Reflect.getMetadata(v,e,t))&&void 0!==n?n:[]},e.setParamTypes=function(e,t,n){return this.set(v,n,s(e).prototype,t)},e.getOwn=function(e,t,n){return Reflect.getOwnMetadata(e,s(t),n)},e.hasOwn=function(e,t,n){return Reflect.hasOwnMetadata(e,s(t),n)},e}();b.get=function(e,t,n){return Reflect.getMetadata(e,s(t),n)},b.getType=function(e,t){return Reflect.getMetadata(y,e,t)},b.setType=function(e,t,n){return Reflect.defineMetadata(y,n,e,t)},b.getReturnType=function(e,t){return Reflect.getMetadata("design:returntype",e,t)},b.has=function(e,t,n){return Reflect.hasMetadata(e,s(t),n)},b.getTargetsFromPropertyKey=function(e){return m.has(e)?m.get(e):[]};var _=Function;function C(){return void 0===(e=!1)&&(e=!0),function(t,n){var r,o=d(t,n)||{writable:!0,configurable:!0};return o.enumerable=e,Object.defineProperty(null!==(r=null==t?void 0:t.prototype)&&void 0!==r?r:t,n,o),o};var e}var S=function(){function e(e,t,n){this.rawTarget=e,this.rawPropertyKey=t,"number"==typeof n&&(this.paramIndex=n),this.target=e}return Object.defineProperty(e.prototype,"index",{get:function(){return this.paramIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return s(this.rawTarget)},set:function(e){this.setTarget(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"targetName",{get:function(){return u(this.target)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"propertyKey",{get:function(){return this.rawPropertyKey},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typeName",{get:function(){return u(this.rawType)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this.rawType},set:function(e){this.rawType=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"collectionName",{get:function(){return this.collectionType?u(this.collectionType):""},enumerable:!1,configurable:!0}),e.prototype.setTarget=function(e){var t;this.rawTarget=e,function(e){return o(e)||e===Map||e instanceof Map||e===Set||e instanceof Set||e===WeakMap||e instanceof WeakMap||e===WeakSet||e instanceof WeakSet}(t="number"==typeof this.paramIndex?b.getParamTypes(this.rawTarget,this.rawPropertyKey)[this.paramIndex]:b.getType(this.rawTarget,this.rawPropertyKey))?(this.collectionType=t,this.rawType=Object):this.rawType=t,this.name=u(this.rawPropertyKey)},e}();(0,r.__decorate)([C(),(0,r.__metadata)("design:type",_)],S.prototype,"collectionType",void 0),(0,r.__decorate)([C(),(0,r.__metadata)("design:type",String)],S.prototype,"name",void 0),(0,r.__decorate)([C(),(0,r.__metadata)("design:type",_)],S.prototype,"rawType",void 0),(0,r.__decorate)([C(),(0,r.__metadata)("design:type",Number)],S.prototype,"paramIndex",void 0);var w=function(){function e(e){var t=this;this.registry=e,this.forEach=function(e,n){return t.registry.forEach(e,n)}}return e.prototype.get=function(e){return this.registry.get(e)},e.prototype.set=function(e,t){return this.registry.merge(e,t),this},e.prototype.has=function(e){return this.registry.has(e)},Object.defineProperty(e.prototype,"size",{get:function(){return this.registry.size},enumerable:!1,configurable:!0}),e}(),E=function(){function e(){this.map=new Map}return e.prototype.get=function(e){return this.map.get(e)},e.prototype.has=function(e){return this.map.has(e)},e.prototype.set=function(e,t){return this.map.set(e,t),this},e.prototype.delete=function(e){return this.map.delete(e)},e.prototype.forEach=function(e,t){return this.map.forEach(e)},e.prototype.keys=function(){return this.map.keys()},e.prototype.values=function(){return this.map.values()},e.prototype.entries=function(){return this.map.entries()},e.prototype.clear=function(){return this.map.clear()},Object.defineProperty(e.prototype,"size",{get:function(){return this.map.size},enumerable:!1,configurable:!0}),e}(),x=function(e){function t(t){var n=e.call(this)||this;return n.klass=t,n.klass=s(n.klass),n}return(0,r.__extends)(t,e),t.prototype.createIfNotExists=function(e){if(!this.has(e)){var t=new this.klass(e);this.set(e,t)}return this.get(e)},t.prototype.merge=function(e,t){var n=this.createIfNotExists(e);Object.keys(t).forEach((function(e){n[e]=t[e]})),this.set(e,n)},t.prototype.get=function(e){return this.map.get(c(e))},t.prototype.has=function(e){return this.map.has(c(e))},t.prototype.set=function(e,t){return this.map.set(c(e),t),this},t.prototype.delete=function(e){return this.map.delete(c(e))},t}(E);function T(e){var t=(0,r.__read)(e,3),n=t[1],o=t[2];return"number"==typeof o?"parameter":n&&void 0===o||o&&(o.get||o.set)?"property":(null==o?void 0:o.value)?"method":"class"}var R=function(){function e(e){var t=this,n=(0,r.__read)(e,3),o=n[0],i=n[1],a=n[2];this.map=function(){switch(T(e)){case"parameter":var n=t.storeGet("workbench:param:store",o,i);return n.has("".concat(a))||n.set("".concat(a),new Map),n.get("".concat(a));case"property":return t.storeGet("workbench:property:store",o,i);case"method":return t.storeGet("workbench:method:store",o,i);case"class":return t.storeGet("workbench:class:store",o)}}()}return e.from=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new e(t)},e.prototype.storeGet=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=b;return o.has.apply(o,(0,r.__spreadArray)([e],(0,r.__read)(t),!1))||o.set.apply(o,(0,r.__spreadArray)([e,new Map],(0,r.__read)(t),!1)),o.get.apply(o,(0,r.__spreadArray)([e],(0,r.__read)(t),!1))},e.decorate=function(t){return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var i=e.from.apply(e,(0,r.__spreadArray)([],(0,r.__read)(n),!1)),a=t(i,n);return"function"==typeof a&&a.apply(void 0,(0,r.__spreadArray)([],(0,r.__read)(n),!1)),n[2]}},e.prototype.set=function(e,t){return this.map.set(u(e),t),this},e.prototype.get=function(e){return this.map.get(u(e))},e.prototype.clear=function(){return this.map.clear()},e}(),I=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.store=new R([t,n,r]),o}return(0,r.__extends)(t,e),t}(S);(0,r.__decorate)([C(),(0,r.__metadata)("design:type",R)],I.prototype,"store",void 0)},15012:function(e,t,n){function r(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===n&&r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}n.d(t,{Z:function(){return r}})},28061:function(e,t,n){n.d(t,{l:function(){return k}});var r=n(85556),o=n(87363),i=n.n(o),a=n(83939),s=n(88560),c=n(52747),l=n(92873),u=n(4211),d=n(99779),p=n(26061),h=n(29492),f=n(15012),g="menu_workbench-menu-item-icon__JF6zh",v="menu_menu-button__1Kokg",y="menu_focus__3cChU";(0,f.Z)(".menu_icon__2DyF_,\n.menu_workbench-menu-item-icon__JF6zh {\n  background-repeat: no-repeat;\n  background-size: contain;\n}\n.menu_icon__2DyF_ > *,\n.menu_workbench-menu-item-icon__JF6zh > * {\n  width: 100%;\n  height: 100%;\n  background-size: contain;\n  display: inline-block;\n}\n.menu_menu-button__1Kokg {\n  border: none;\n  background: transparent;\n  padding: 0 5px;\n}\n.menu_menu-button__1Kokg:hover {\n  background-color: var(--workbench-theme-global-button-hover, rgba(0, 0, 0, 0.08));\n}\n.menu_menu-button__1Kokg.menu_focus__3cChU,\n.menu_menu-button__1Kokg:focus {\n  background-color: var(--workbench-theme-global-button-hover, rgba(0, 0, 0, 0.08));\n}\n.menu_workbench-menu-item-icon__JF6zh {\n  height: 20px;\n  width: 20px;\n  background-position: 50%;\n  margin-right: 8px;\n}\n");var m=n(50442),b=function(e){var t,n=e.item,r=e.badge,o=n.content;return t="function"==typeof o?o():o,i().isValidElement(t)&&"string"==typeof t.type&&(t=i().cloneElement(t,{onMouseDown:function(e){e.preventDefault()}})),r?i().createElement(m.S,null,i().createElement("div",null,null!=t?t:null,i().createElement(a.ZP,{status:"error",style:{transform:"scale(0.6)",marginLeft:4}}))):i().createElement(m.S,null,null!=t?t:null)},_=n(75611),C=n(3139),S=n(2275),w=n(70230),E=n(1205),x=n(81758),T=1/0,R=function(e){function t(){var t=e.apply(this,(0,r.__spreadArray)([],(0,r.__read)(arguments),!1))||this;return t.levelInfo={current:0},t.generateMenuTree=function(e,n){if(0===n&&t.enterMenuTree(),"divider"===e.name)return i().createElement(p.default,{key:"".concat(e.name,"-").concat(n)});T=1/0;var r=e.children.filter((function(e){return!(0,_.k)(e.shouldHide,!1)})).filter(t.removeUnnecessaryDivider);if(0===e.children.length||0===r.length&&e.onClick){var o=t.checkBadge(e.name);return t.generateMenuItem({item:e,index:n,badge:o,extraStyle:{}})}var a=r.map(t.generateMenuTree),s=Object.assign({},t.getCurrentLevelInfo());return t.leaveMenuTree(),e.children.length>0&&0===r.length&&!e.onClick?null:t.genarateSubMenu(e,n,a,s)},t.handleMenuClick=function(e){t.props.onMenuClick(e)},t.handleVisibleChange=function(e,n){e&&t.badgeTree.indexOf(n)>=0&&t.badgeService.removeBadgeOn("menu",n)},t.removeUnnecessaryDivider=function(e,t,n){if("divider"===e.name){if(t<T)return!1;var r=n[t+1];if(!r)return!1;if("divider"===r.name)return!1}else T>t&&(T=t);return!0},t}return(0,r.__extends)(t,e),t.prototype.checkBadge=function(e){return this.badgeTree.includes(e)},t.prototype.wrapWithPreventDismiss=function(e,t,n){return i().createElement(s.default.Keep,{key:"mainmenu-item-keep-".concat(e.name,"-").concat(n)},t)},t.prototype.shouldDisabled=function(e){return!!e.shouldDisabled&&(0,_.k)(e.shouldDisabled,!1)},t.prototype.shouldCheck=function(e){return!!e.shouldCheck&&(0,_.k)(e.shouldCheck,!1)},t.prototype.getDescription=function(e){return(0,_.k)(e.description,null)},t.prototype.getShortcut=function(e){var t=e.shortcut;if(t)return w.w.isMac()?t.mac:t.win},t.prototype.getBadgeIcon=function(e){return i().createElement(a.ZP,{dot:!0,style:{transform:"scale(0.6)",top:0,right:0,border:"none",transformOrigin:"top right"}},e)},t.prototype.generateMenuItem=function(e){var t=e.item,n=e.index,r=e.badge,o=e.extraStyle,a=void 0!==t.shouldCheck,s=void 0!==t.icon,c=this.shouldCheck(t);this.recordLevelInfo(a,s,c);var l=t.preventHighlight?{background:"transparent"}:{},u="function"==typeof t.style?t.style():t.style,d=this.shouldDisabled(t),p="".concat(t.name,"-").concat(n),f=i().createElement(h.default.Item,{id:this.menuService.getPathByConfig(t).join("/"),key:p,className:"mainmenu-item-".concat(t.name),disabled:d,style:Object.assign(Object.assign(Object.assign({},o),u),l),selected:this.shouldCheck(t),description:this.getDescription(t)||this.getShortcut(t)||"",icon:s?i().createElement("div",{className:g},r&&!d?this.getBadgeIcon(t.icon):t.icon):void 0,onMouseEnter:d?void 0:t.onMouseEnter,onMouseLeave:d?void 0:t.onMouseLeave},i().createElement(b,{item:t,badge:r&&!s&&!d}));return t.tooltip&&(f=i().createElement(i().Fragment,{key:p},(0,E.t)(f,t.tooltip,{style:{display:"block"}}))),t.preventDismiss&&(f=this.wrapWithPreventDismiss(t,f,n)),f},t.prototype.enterMenuTree=function(){this.levelInfo.current+=1},t.prototype.leaveMenuTree=function(){delete this.levelInfo[this.levelInfo.current],this.levelInfo.current-=1},t.prototype.recordLevelInfo=function(e,t,n){var r=this.levelInfo.current;this.levelInfo[r]?(this.levelInfo[r].needCheckPadding=this.levelInfo[r].needCheckPadding||e,this.levelInfo[r].hasIcon=this.levelInfo[r].hasIcon||t,this.levelInfo[r].childBeenChecked=this.levelInfo[r].childBeenChecked||n):this.levelInfo[r]={needCheckPadding:e,hasIcon:t,childBeenChecked:n}},t.prototype.getCurrentLevelInfo=function(){var e,t=this.levelInfo.current;return null!==(e=this.levelInfo[t])&&void 0!==e?e:{hasIcon:!1,needCheckPadding:!1,childBeenChecked:!1}},t.prototype.genarateSubMenu=function(e,t,n,r){var o=this,a="function"==typeof e.style?e.style():e.style,s="function"==typeof e.popUpStyle?e.popUpStyle():e.popUpStyle,c="function"==typeof e.popupClassName?e.popupClassName():e.popupClassName,l=this.shouldDisabled(e),u=!l&&this.checkBadge(e.name),d=void 0!==e.icon,p=this.shouldCheck(e),f=r.needCheckPadding||!!e.syncCheckStatus,v=r.childBeenChecked,y=p||v&&!!e.syncCheckStatus;this.recordLevelInfo(!!e.syncCheckStatus,d,y);var m=i().createElement(h.default.SubMenu,{id:this.menuService.getPathByConfig(e).join("/"),className:"mainmenu-submenu-".concat(e.name),title:i().createElement(b,{item:e,badge:u&&!e.icon}),icon:e.icon?i().createElement("div",{className:g},u?this.getBadgeIcon(e.icon):e.icon):void 0,key:"".concat(e.name,"-").concat(t),selectable:f,selected:y,type:d?"with-icon":"normal",disabled:l,style:a,onVisibleChange:function(t){var n;null===(n=e.onVisibleChange)||void 0===n||n.call(e,t),o.handleVisibleChange(t,e.name)},popupStyle:s,popupClassName:c},n);return e.tooltip&&(m=i().createElement(i().Fragment,{key:"".concat(e.name,"-").concat(t)},(0,E.t)(m,e.tooltip,{style:{display:"block"}}))),m},t.prototype.handleMouseDown=function(e){var t;!1===(null===(t=this.settings.accessibility)||void 0===t?void 0:t.menuClickFocus)&&e.preventDefault(),e.stopPropagation()},t.prototype.render=function(){var e=this;this.badgeTree=this.props.badgeTree;var t=this.props,n=t.itemStyle,r=void 0===n?{}:n,o=t.dropdownContentStyle,a=void 0===o?{}:o;T=1/0;var s=this.props.menu.filter((function(e){return!(0,_.k)(e.shouldHide,!1)})).filter(this.removeUnnecessaryDivider);if(!s.length)return i().createElement("div",{onMouseDown:function(t){return e.handleMouseDown(t)}});s=s.map(this.generateMenuTree);var c=this.getCurrentLevelInfo(),l=c.needCheckPadding,u=c.hasIcon;return this.leaveMenuTree(),i().createElement("div",{onMouseDown:function(t){return e.handleMouseDown(t)}},i().createElement(h.default,{itemStyle:Object.assign({minWidth:140},r),onClick:this.handleMenuClick,selectable:l,type:u?"with-icon":"normal",className:"mainmenu-menu-".concat(this.props.id),subMenuViewportMargin:32,style:Object.assign({overflow:"auto",maxHeight:"calc(100vh - 90px)"},a)},s))},t}(o.PureComponent);R.contextType=c.FN,(0,r.__decorate)([(0,C.tB)(),(0,r.__metadata)("design:type",S.A)],R.prototype,"badgeService",void 0),(0,r.__decorate)([(0,C.tB)(),(0,r.__metadata)("design:type",l.h)],R.prototype,"menuService",void 0),(0,r.__decorate)([(0,C.tB)(),(0,r.__metadata)("design:type",x.I)],R.prototype,"settings",void 0);var I=n(9771),P=n(98617),O=function(e){function t(){var t=e.apply(this,(0,r.__spreadArray)([],(0,r.__read)(arguments),!1))||this;return t.dropdownRef=i().createRef(),t.state={active:!1,isExpanded:!1,alignment:t.initAlignment(t.props.align)},t.handleMenuClick=function(e){var n,r=t.menuService.getConfigByPath(e);null===(n=null==r?void 0:r.onClick)||void 0===n||n.call(r),t.props.badge.some((function(e){return e.key===(null==r?void 0:r.name)&&"menu"===e.position}))&&t.badgeService.removeBadgeOn("menu",r.name)},t.handleClick=function(e){var n,r;null===(r=(n=t.props).onClick)||void 0===r||r.call(n,e)},t.handleKeyDown=function(e){var n,r,o=((n={})[P.jz.ENTER]=function(){var n,r;null===(r=(n=e.target).click)||void 0===r||r.call(n),t.setState({isExpanded:!t.state.isExpanded})},n),i=new Map;Object.keys(P.Bm).forEach((function(e){i.set(e,o[P.Bm[e]])}));var a=e.keyCode;null===(r=i.get(a.toString()))||void 0===r||r()},t.handleMouseEnter=function(e){var n,r;null===(r=(n=t.props).onMouseEnter)||void 0===r||r.call(n,e)},t.handleMouseLeave=function(e){var n,r;null===(r=(n=t.props).onMouseLeave)||void 0===r||r.call(n,e)},t.changeAlignment=function(e){var n,r;if(e){var o=null===(r=null===(n=t.dropdownRef.current)||void 0===n?void 0:n.dropContentRef.current)||void 0===r?void 0:r.getBoundingClientRect();o&&(o.right>document.body.offsetWidth&&"left-prefer"===t.props.align&&t.setState({alignment:"right"}),o.left<0&&"right-prefer"===t.props.align&&t.setState({alignment:"left"}))}},t.handleVisibleChange=function(e){var n,r,o,i;e?(null===(i=(o=t.props).onDropdownOpen)||void 0===i||i.call(o,t.props.name),t.props.badge.some((function(e){return e.key===t.props.name&&"menu"===e.position}))&&t.badgeService.removeBadgeOn("menu",t.props.name)):null===(r=(n=t.props).onDropdownClose)||void 0===r||r.call(n,t.props.name),t.setState({active:e},(function(){return window.requestAnimationFrame((function(){t.changeAlignment(e)}))}))},t.getBadgeTree=function(){return t.props.badge.filter((function(e){return"menu"===e.position})).map((function(e){return e.key}))},t.preventDismiss=function(e){var n=t.menuService.preventDismissSelectors,o=!1;return n.forEach((function(n){var i,a=(0,r.__read)(n,2),s=a[0],c=a[1];o=o||!!(t.menuService.path(s,t.props.name).length>0&&(null===(i=e.target)||void 0===i?void 0:i.closest(c)))})),!o},t}return(0,r.__extends)(t,e),t.prototype.initAlignment=function(e){return"left-prefer"===e?"left":"right-prefer"===e?"right":e},t.prototype.searchInMenu=function(e,t){var n,o;if(0===e.children.length)return null;var i=e.children.find((function(e){return e.name===t}));if(i)return i;try{for(var a=(0,r.__values)(e.children),s=a.next();!s.done;s=a.next()){var c=s.value,l=this.searchInMenu(c,t);if(l)return l}}catch(e){n={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}return null},t.prototype.render=function(){var e,t=this.props,n=t.name,r=t.style,o=t.menu,c=t.animated,l=void 0===c||c,u=t.mode,d=void 0===u?"dropdown-menu":u,p=t.itemStyle,h=t.dropdownContentStyle,f=t.placement,g=void 0===f?"bottom":f,m=t.ariaLabel,b=t.role,_=this.searchInMenu(o,n);if(!_||0===_.children.length)return null;var C=this.getBadgeTree(),S=i().createElement(R,{menu:_.children,onMenuClick:this.handleMenuClick,key:"mainmenu-dropdown-".concat(n),badgeTree:C,id:n,itemStyle:p,dropdownContentStyle:h});if("menu"===d)return S;var w=this.state.active;return void 0!==this.props.show&&(w=this.props.show),i().createElement(s.default,{alignment:this.state.alignment,key:_.name,dropContent:S,style:r,visible:w,animated:l,placement:g,onVisibleChange:this.handleVisibleChange,ref:this.dropdownRef,autoFocus:null===(e=this.settings.accessibility)||void 0===e?void 0:e.dropdownAutoFocus,shouldHide:w?this.preventDismiss:void 0},i().createElement("div",{id:"main-menu-".concat(n),className:"".concat(v," menu-button-").concat(n," ").concat(w?y:""),onClick:this.handleClick,style:this.props.contentStyle,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onMouseDown:function(e){e.preventDefault()},tabIndex:0,role:b,"aria-label":null!=m?m:n,"aria-expanded":this.state.isExpanded,"aria-haspopup":!0,onKeyDown:this.handleKeyDown.bind(this)},i().createElement(a.ZP,{dot:C.includes(n)},this.props.children)))},t}(o.Component);O.contextType=c.FN,(0,r.__decorate)([(0,C.tB)(),(0,r.__metadata)("design:type",l.h)],O.prototype,"menuService",void 0),(0,r.__decorate)([(0,C.tB)(I.c),(0,r.__metadata)("design:type",Object)],O.prototype,"badgeService",void 0),(0,r.__decorate)([(0,C.tB)(),(0,r.__metadata)("design:type",x.I)],O.prototype,"settings",void 0);var k=(0,d.x)([u.j.Menu,u.j.Badge])(O)},51850:function(e,t,n){n.d(t,{p:function(){return s}});var r=n(85556),o=n(87363),i=n(65419),a=n(52747);function s(e,t,n,s){void 0===n&&(n=10);var c=(0,o.useContext)(a.FN);(0,o.useEffect)((function(){c.store.has(e)||c.store.register(e,t)}),[c.store,e,t]);var l=(0,r.__read)((0,o.useState)((function(){return c.store.getValue(e)||t})),2),u=l[0],d=l[1];return(0,o.useEffect)((function(){var t=c.store.get(e).pipe((0,i.p)(n,s,{leading:!0,trailing:!0})).subscribe((function(e){d(e)}));return function(){t.unsubscribe()}}),[e,c.store,n,s]),u}},60667:function(e,t,n){n.d(t,{Tc:function(){return s},X3:function(){return i},bR:function(){return a}});var r=n(87363),o=n.n(r);function i(e){return!!e&&("string"==typeof e.content||o().isValidElement(e.content||Array.isArray(e.content)))}function a(e){return"right-prefer"===e?"right":"left-prefer"===e?"left":e}function s(e){return"start-prefer"===e?"start":"end-prefer"===e?"end":e}},1205:function(e,t,n){n.d(t,{t:function(){return u}});var r=n(37700),o=n(87363),i=n.n(o),a=n(75611),s=n(85556),c=n(60667),l=function(e){function t(t){var n=e.call(this,t)||this;return n.state={placement:(0,c.bR)(n.props.placement||"left"),alignment:(0,c.Tc)(n.props.alignment||"center")},n.safeWidth=t.safeWidth||200,n.safeHeight=t.safeHeight||0,n}return(0,s.__extends)(t,e),t.prototype.adjustLeftPreferTooltip=function(){var e;if("right"!==this.state.placement){var t=null===(e=this.tooltipRef)||void 0===e?void 0:e.rootRef.current;t&&t.getBoundingClientRect().left<=this.safeWidth&&this.setState({placement:"right"})}},t.prototype.adjustRightPreferTooltip=function(){var e;if("left"!==this.state.placement){var t=null===(e=this.tooltipRef)||void 0===e?void 0:e.rootRef.current;if(t){var n=t.clientWidth,r=t.getBoundingClientRect().left,o=document.documentElement.clientWidth;r+n+this.safeWidth>=o&&this.setState({placement:"left"})}}},t.prototype.adjustStartPreferOffsetY=function(){var e,t=null===(e=this.tooltipRef)||void 0===e?void 0:e.rootRef.current;if(t){var n=t.getBoundingClientRect().bottom,r=document.documentElement.clientHeight;n>r?this.setState({offsetY:0,alignment:"end"}):n+this.safeHeight>r?this.setState({offsetY:r-(n+this.safeHeight)}):this.setState({offsetY:0})}},t.prototype.adjustEndPreferOffsetY=function(){var e,t=null===(e=this.tooltipRef)||void 0===e?void 0:e.rootRef.current;if(t){var n=t.getBoundingClientRect().top;n<this.safeHeight?this.setState({offsetY:this.safeHeight-n}):this.setState({offsetY:0})}},t.prototype.adjustPosition=function(){var e=this;window.requestAnimationFrame((function(){"left-prefer"===e.props.placement&&e.adjustLeftPreferTooltip(),"right-prefer"===e.props.placement&&e.adjustRightPreferTooltip(),"left"!==e.state.placement&&"right"!==e.state.placement||("start-prefer"===e.props.alignment&&e.adjustStartPreferOffsetY(),"end-prefer"===e.props.alignment&&e.adjustEndPreferOffsetY())}))},t.prototype.componentDidUpdate=function(){this.adjustPosition()},t.prototype.componentDidMount=function(){this.adjustPosition()},t.prototype.render=function(){var e=this;return i().createElement(r.default,Object.assign({className:"main-menu-dropdown-tooltip",ref:function(t){return e.tooltipRef=t}},this.props,{containerOffsetY:this.state.offsetY||0,placement:this.state.placement,alignment:this.state.alignment}))},t}(i().Component);function u(e,t,n){var o=(0,a.k)(t,void 0);if(!o)return i().createElement(r.default,Object.assign({overlayHoverable:!1},n,{placement:(0,c.bR)(null==n?void 0:n.placement),alignment:(0,c.Tc)(null==n?void 0:n.alignment),title:o,disabled:!0}),e);if(!(0,c.X3)(o))return i().createElement(r.default,Object.assign({overlayHoverable:!1},n,{placement:(0,c.bR)(null==n?void 0:n.placement),alignment:(0,c.Tc)(null==n?void 0:n.alignment),title:o}),e);var s=o;return i().createElement(l,Object.assign({placement:"left",safeWidth:200,hoverDelay:400,overlayHoverable:!1},s,n,{title:s.content}),e)}},16033:function(e,t,n){n.d(t,{K:function(){return d}});var r=n(85556),o=n(87363),i=n.n(o),a=n(3139),s=n(43813),c=n(3422),l=n(51850),u=n(77947);function d(e){var t=e.name,n=e.children,o=e.simulateSpaceChange,d=(0,r.__rest)(e,["name","children","simulateSpaceChange"]),p=a.Am.get(u.O),h=a.Am.get(c.Z).get(t),f="transition.trigger.".concat(t),g=(0,l.p)(f,!0),v="".concat(t,".dom.visible"),y=function(){p.upsert(v,g)};return i().createElement(s.ZP,Object.assign({},d,{timeout:h.duration,in:g,onEnter:y,onExit:y}),(function(e){var t,a,s=h[e],c=s.height,l=s.width,u=(0,r.__rest)(s,["height","width"]),d=s.transition,p=Object.assign(Object.assign({},n.props.style),u);return o&&(p.position="absolute"),i().createElement(i().Fragment,null,i().cloneElement(n,{style:p}),i().createElement("div",{id:"transition-space",className:n.props.className,style:{opacity:0,position:o?"relative":"absolute",transition:d,border:"none",margin:0,padding:0,pointerEvents:"none",height:null!=c?c:null===(t=n.props.style)||void 0===t?void 0:t.height,width:null!=l?l:null===(a=n.props.style)||void 0===a?void 0:a.width}}))}))}},98617:function(e,t,n){n.d(t,{Bm:function(){return c},Jg:function(){return a},jz:function(){return o}});var r,o,i=n(76450);!function(e){e.ENTER="click",e.EXIT="",e.LEFT_ITEM="",e.RIGHT_ITEM="",e.DEFAULT=""}(o||(o={}));var a,s,c=((r={})[i.VD.ARROW_RIGHT]=o.RIGHT_ITEM,r[i.VD.ARROW_LEFT]=o.LEFT_ITEM,r[i.VD.ARROW_UP]=o.ENTER,r[i.VD.ARROW_DOWN]=o.ENTER,r[i.VD.SPACE]=o.ENTER,r[i.VD.ENTER]=o.ENTER,r[i.VD.ESCAPE]=o.EXIT,r);!function(e){e.LEFT="",e.RIGHT=""}(a||(a={})),function(e){e.TOOLBAR="",e.TOOLBAR_PINNED=""}(s||(s={}))},47:function(e,t,n){n.d(t,{C:function(){return r}});var r="workbench:settings"},2002:function(e,t,n){var r;n.d(t,{v:function(){return r}}),function(e){e.CONTEXT_MENU="context_menu",e.MOBILE_CONTEXT_MENU="mobile_context_menu",e.MENU="menu",e.MOBILE_MENU="mobile_menu",e.TOOLBAR="toolbar",e.MOBILE_TOOLBAR="mobile_toolbar",e.STATUSBAR="statusbar",e.TITLEBAR="titlebar",e.MOBILE_TITLEBAR="mobile_titlebar",e.KEYMAP="keymap",e.FLOAT_WIDGET="float_widget",e.EMBED_WIDGET="embed_widget",e.WRAPPED_WIDGET="wrapped_widget",e.MOBILE_ACTION_BUTTON="mobile_action_buttons"}(r||(r={}))},99521:function(e,t,n){n.d(t,{e:function(){return a},h:function(){return i}});var r,o=n(2002),i={toolbarItems:o.v.TOOLBAR,mobileToolbarItems:o.v.MOBILE_TOOLBAR,menuItems:o.v.MENU,mobileMenuItems:o.v.MOBILE_MENU,statusbarItems:o.v.STATUSBAR,contextMenuItems:o.v.CONTEXT_MENU,mobileContextMenuItems:o.v.MOBILE_CONTEXT_MENU,keymapConfigs:o.v.KEYMAP,titlebarItems:o.v.TITLEBAR,mobileTitlebarItems:o.v.MOBILE_TITLEBAR,mobileActionButtons:o.v.MOBILE_ACTION_BUTTON},a=((r={})[o.v.MOBILE_MENU]="mobileMenuItems",r[o.v.MENU]="menuItems",r[o.v.TOOLBAR]="toolbarItems",r[o.v.MOBILE_TOOLBAR]="mobileToolbarItems",r[o.v.CONTEXT_MENU]="contextMenuItems",r[o.v.MOBILE_CONTEXT_MENU]="mobileContextMenuItems",r[o.v.TITLEBAR]="titlebarItems",r[o.v.MOBILE_TITLEBAR]="mobileTitlebarItems",r[o.v.STATUSBAR]="statusbarItems",r[o.v.MOBILE_ACTION_BUTTON]="mobileActionButtons",r[o.v.KEYMAP]="keymapConfigs",r)},60238:function(e,t,n){n.d(t,{X:function(){return a}});var r=n(85556),o=n(37769),i=n(65397),a=function(){function e(e){this.surfaceService=e}return e.prototype.isAvailable=function(e,t){var n;if(!e)return!0;if(!e.adapters)return!0;var r=this.surfaceService.info.current,o=null==r?void 0:r.id;if(t&&(o=this.surfaceService.getSurfaceId(t)),!r)return!1;var i=this.surfaceService.getAdapter(o);return!!(null===(n=e.adapters)||void 0===n?void 0:n.some((function(e){return i&&i.toString()===e})))},e.prototype.matchOpenedEditors=function(e){return e&&e.adapters?this.surfaceService.editors.filter((function(t){return e.adapters.includes(t.adapter.toString())})).map((function(e){return e.editor})):[]},e}();a=(0,r.__decorate)([(0,o.t)({overridable:!0}),(0,r.__metadata)("design:paramtypes",[i.W])],a)},75611:function(e,t,n){n.d(t,{k:function(){return o}});var r=n(85556);function o(e,t){for(var n,o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];return"function"==typeof e?null!==(n=e.apply(void 0,(0,r.__spreadArray)([],(0,r.__read)(o),!1)))&&void 0!==n?n:t:null!=e?e:t}},99221:function(e,t,n){n.d(t,{C:function(){return a}});var r=n(85556),o=n(6097),i=n(47184),a=function(e){function t(){var t=e.apply(this,(0,r.__spreadArray)([],(0,r.__read)(arguments),!1))||this;return t.pathMap=new Map,t.reversedPathMap=new Map,t}return(0,r.__extends)(t,e),t.prototype.setSchema=function(e){this.schema=e,this.updateState()},t.prototype.getSchema=function(){return this.schema},t.prototype.getPathByConfig=function(e){return this.pathMap.get(e)||[]},t.prototype.getConfigByPath=function(e){return Array.isArray(e)?this.reversedPathMap.get(e.join("/")):this.reversedPathMap.get(e)},t.prototype.setPathToActionInfoInConfig=function(e,t){var n=this,o=[];t&&o.push.apply(o,(0,r.__spreadArray)([],(0,r.__read)(t),!1)),o.push(e.name),this.pathMap.set(e,o),this.reversedPathMap.set(o.join("/"),e),Object.entries(e).forEach((function(t){var o=(0,r.__read)(t,2),a=o[0],s=o[1];if(s instanceof i.r){var c=s.merge([]),l=n.getPathByConfig(e);c.point=Object.assign(Object.assign({},s.point),{path:l,name:e.name}),e[a]=c}}))},t.prototype.mergeSchema=function(e){this.mergeSchemaWithoutUpdate(e),this.updateState()},t.prototype.onUpdate=function(){this.pathMap.clear(),this.reversedPathMap.clear()},t.prototype.forceUpdateWithStore=function(e,t){var n=e.getValue(t);null!==n?Array.isArray(n)?e.get(t).next(n.slice()):"object"!=typeof n?e.get(t).next(n):e.get(t).next(Object.assign({},n)):this.onUpdate()},t}(o.V)},6097:function(e,t,n){n.d(t,{V:function(){return g}});var r=n(85556),o=n(63357),i=n(58483),a=n(19082),s=n(52571),c=n(47184),l=n(36593);function u(e){return!!e.includes(":")}var d=n(25749),p=function(){function e(){this.getMemorizedMatchPoint=(0,d.Z)(this.getMatchPoint,this.matchPointMemoizedCacheKey),this.namedPlaceholders=[]}return e.prototype.addMatchPoint=function(e){u(e)&&!this.namedPlaceholders.includes(e)&&this.namedPlaceholders.push(e)},e.prototype.getMatchPoint=function(e){var t=this.namedPlaceholders.filter((function(t){return function(e,t){var n="^".concat(e.replace(/:\w+/g,"\\w+"),"$");return new RegExp(n).test(t)}(t,e)}));if(t.length>1)throw new Error("Ambiguous match points found for key ".concat(e,", match points ").concat(t));return t[0]},e.prototype.matchPointMemoizedCacheKey=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.namedPlaceholders.length+e[0]},e}(),h=function(){function e(){this.configs=new Map,this.namedPlaceHolder=new p}return e.prototype.set=function(e,t){this.configs.set(e,t),u(e)&&this.namedPlaceHolder.addMatchPoint(e)},e.prototype.remove=function(e){this.configs.has(e)?this.configs.delete(e):s.r.warn('The config "'.concat(e,'" does not exist, thus ignored.'))},e.prototype.has=function(e){var t=this.configs.has(e);return t||(this.namedPlaceHolder.getMatchPoint(e)&&(t=!0),t)},e.prototype.get=function(e){var t=this.configs.get(e);if(t)return t;var n=this.namedPlaceHolder.getMatchPoint(e);if(n){var r=this.configs.get(n);r&&(t=Object.assign(Object.assign({},r),{name:e}))}return t},e.prototype.getAllKeys=function(){var e,t,n=[];try{for(var o=(0,r.__values)(this.configs.keys()),i=o.next();!i.done;i=o.next()){var a=i.value;n.push(a)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return n},e}(),f=function(){function e(){this.callbacks=new Map,this.namedPlaceHolder=new p}return e.prototype.getAll=function(e){var t,n,r=new Map,o=this.namedPlaceHolder.getMemorizedMatchPoint(e);return null===(t=this.callbacks.get(null!=o?o:""))||void 0===t||t.forEach((function(e,t){return r.set(t,e)})),null===(n=this.callbacks.get(e))||void 0===n||n.forEach((function(e,t){return r.set(t,e)})),r},e.prototype.get=function(e){return this.callbacks.get(e)},e.prototype.set=function(e,t){this.callbacks.set(e,t),u(e)&&this.namedPlaceHolder.addMatchPoint(e)},e.prototype.getMatchPoint=function(e){return this.namedPlaceHolder.getMatchPoint(e)},e}(),g=function(){function e(){var e=this;this.debounceTime=10,this.configs=new h,this.callbacks=new f,this.middlewares=new Map,this.subject=new o.xQ,this.subject.asObservable().pipe((0,i.b)(this.debounceTime)).subscribe((function(t){return e.onUpdate(t)}))}return e.prototype.onUpdate=function(e){},e.prototype.register=function(e,t){void 0===t&&(t=!1),this.hasConfig(e.name)&&s.r.warn('The config "'.concat(e.name,'" has already been registered, it has been replaced by new config.')),this.configs.set(e.name,e),t&&this.updateState()},e.prototype.remove=function(e){this.configs.remove(e)},e.prototype.hasConfig=function(e){return this.configs.has(e)},e.prototype.getMergedConfig=function(e){if(this.hasConfig(e)){var t=this.getUIConfig(e),n=this.callbacks.getAll(e),r={};n.forEach((function(e,t){r[t]=e})),this.middlewares.forEach((function(e,t){r[t]?r[t]=r[t].merge(e):r[t]=new c.r(e)}));var o=Object.assign(Object.assign({},t),r);return this.updateActionPoint(o),o}},e.prototype.updateActionPoint=function(e){var t,n,o=this.callbacks.getMatchPoint(e.name);try{for(var i=(0,r.__values)(Object.entries(e)),s=i.next();!s.done;s=i.next()){var l=(0,r.__read)(s.value,2),u=l[0],d=l[1];(0,c._)(d)&&(d.point=Object.assign(Object.assign({},d.point),{from:(0,a.tr)(this.constructor),name:e.name,trigger:u,matchPoint:o}))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},e.prototype.get=function(e,t){var n=this.getMergedConfig(e);return n||t},e.prototype.getUIConfig=function(e){return this.configs.get(e)},e.prototype.getConfigs=function(){var e=this,t=new Map;return this.configs.getAllKeys().forEach((function(n){var r=e.getMergedConfig(n);r&&t.set(n,r)})),t},e.prototype.updateState=function(){this.subject.next(this.getConfigs())},e.prototype.update=function(e){void 0===e&&(e=!1),e?this.$forceUpdate():this.subject.next()},e.prototype.bind=function(e,t,n,r){void 0===r&&(r=!1);var o=this.callbacks.get(e);o||(o=new Map,this.callbacks.set(e,o));var i=o.get(t);i&&s.r.warn('There is already a "'.concat(String(t),'" action point for config "').concat(e,'" and will be override by duplicate declaration. Search "@').concat(i.point.from,"('").concat(e,"', '").concat(String(t),"')\" in your codebase to find it.")),o.set(t,n),r&&this.updateState()},e.prototype.use=function(e,t){var n=l.g.from(e).build(),r=this.middlewares.get(t);r?r.unshift(n):r=[n],this.middlewares.set(t,r),this.update()},e.prototype.getCallbackConfig=function(e){return this.callbacks.get(e)},e}()},52571:function(e,t,n){n.d(t,{r:function(){return r}});var r=new(function(){function e(){}return e.prototype.dateFormat=function(e){var t=e.getFullYear(),n="".concat(e.getMonth()+1).padStart(2,"0"),r="".concat(e.getDate()).padStart(2,"0"),o="".concat(e.getHours()).padStart(2,"0"),i="".concat(e.getMinutes()).padStart(2,"0"),a="".concat(e.getSeconds()).padStart(2,"0");return"".concat(t,"/").concat(n,"/").concat(r," ").concat(o,":").concat(i,":").concat(a)},e.prototype.write=function(e,t){if(!this.use){var n="[".concat(this.dateFormat(new Date),"] [").concat(e,"] [Workbench] - ").concat(t);switch(e){case"FATAL":case"ERROR":console.error(n);break;case"WARN":console.warn(n);break;default:console.log(n)}}},e.prototype.debug=function(e){var t;null===(t=this.use)||void 0===t||t.debug(e),this.write("DEBUG",e)},e.prototype.info=function(e){var t;null===(t=this.use)||void 0===t||t.info(e),this.write("INFO",e)},e.prototype.warn=function(e){var t;null===(t=this.use)||void 0===t||t.warn(e),this.write("WARN",e)},e.prototype.error=function(e){var t;null===(t=this.use)||void 0===t||t.error(e),this.write("ERROR",e)},e.prototype.fatal=function(e){var t;null===(t=this.use)||void 0===t||t.fatal(e),this.write("FATAL",e)},e}())},52747:function(e,t,n){n.d(t,{FN:function(){return h},x9:function(){return d}});var r=n(85556),o=n(87363),i=n.n(o),a=n(3139),s=n(65397),c=n(77947),l=n(51838),u=n(84916),d=function(){function e(){}return Object.defineProperty(e.prototype,"editors",{get:function(){var e,t=a.Am.get(s.W);return(null!==(e=null==t?void 0:t.editors)&&void 0!==e?e:[]).map((function(e){return e.editor}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"editor",{get:function(){var e=a.Am.get(s.W);if(e&&this.editors.length>0){var t=e.info.current,n=null==t?void 0:t.id;return e.getEditor(n)}return null},enumerable:!1,configurable:!0}),e.prototype.isOnline=function(){return u.u.getInstance().isOnline},Object.defineProperty(e.prototype,"store",{get:function(){return a.Am.get(c.O)},enumerable:!1,configurable:!0}),e.prototype.controllerInfo=function(e){var t=e.from+e.name;return{configController:this.trackControllerService.getConfigController(t),callBackController:this.trackControllerService.getConfigController(t)}},e}();(0,r.__decorate)([(0,a.tB)(),(0,r.__metadata)("design:type",l.r)],d.prototype,"trackControllerService",void 0);var p=new(d=(0,r.__decorate)([(0,a.GS)()],d)),h=i().createContext(p)},13815:function(e,t,n){n.d(t,{K:function(){return i}});var r=n(85556),o=n(19082),i=function(e){function t(t){var n=e.call(this,t)||this;return n._store=o.yh.from(t),n}return(0,r.__extends)(t,e),Object.defineProperty(t.prototype,"useClass",{get:function(){return this._useClass||this.provide},set:function(e){this._store=o.yh.from(e),this._useClass=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"store",{get:function(){return this._store},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scope",{get:function(){return this.store.get("st ore")},set:function(e){this.store.set("store",e)},enumerable:!1,configurable:!0}),t}(n(3139).zt)},8887:function(e,t,n){n.d(t,{Q:function(){return i}});var r=n(3139),o=n(95431);function i(e,t){return void 0===e&&(e={}),void 0===t&&(t=function(){return!0}),function(n){n.prototype.toString=function(){var t;return null!==(t=e.name)&&void 0!==t?t:n.name},n.displayName=e.name,t()&&o.p.merge(n,e),r.Am.service(n,{type:"controller",overridable:!0}),r.Am.invokable(n)}}},68656:function(e,t,n){n.d(t,{L:function(){return s}});var r=n(85556),o=n(3139),i=n(81346),a=n(8746);function s(e){return void 0===e&&(e={}),function(t){t.prototype.toString=function(){var n;return null!==(n=e.name)&&void 0!==n?n:t.name},t.displayName=e.name;var n=e.provide,s=(0,r.__rest)(e,["provide"]);return a.j.merge(t,e),n?o.Am.service(n,t,Object.assign(Object.assign({},s),{type:"feature"})):o.Am.service(t,Object.assign(Object.assign({},s),{type:"feature"})),o.Am.invokable(t),o.Am.addPostConstructor(null!=n?n:t,(function(n){var r,a=o.Am.get(i.U),s=o.ll.get(t);s&&(s.instance=n,a.mount([null!==(r=e.provide)&&void 0!==r?r:t]))})),t}}},37769:function(e,t,n){n.d(t,{t:function(){return i}});var r=n(85556),o=n(3139);function i(e){return void 0===e&&(e={}),function(t){var n=e.provide,i=e.name,a=(0,r.__rest)(e,["provide","name"]);return i&&(t.displayName=i),n?o.Am.service(n,t,Object.assign(Object.assign({},a),{type:"service"})):o.Am.service(t,Object.assign(Object.assign({},a),{type:"service"})),o.Am.invokable(t),t}}},65425:function(e,t,n){n.d(t,{z:function(){return s}});var r=n(85556),o=n(19082),i=n(52571),a=n(51506);function s(e,t){return void 0===t&&(t="loader"),function(n,s,c){void 0===c&&(c=(0,o.yH)(n,s));var l=c.value;c.value=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var s=this[t];return(0,a.hQ)(s)?(0,a.hr)(s)?l.call.apply(l,(0,r.__spreadArray)([this],(0,r.__read)(n),!1)):e:(i.r.warn("".concat(t," is not DynamicLoader")),l.call.apply(l,(0,r.__spreadArray)([this],(0,r.__read)(n),!1)))}}}},46885:function(e,t,n){n.d(t,{b:function(){return s}});var r=n(19082),o=n(2002),i=n(67627),a=n(77101);function s(e,t,n){return r.yh.decorate((function(r){var s,c=null!==(s=r.get("points"))&&void 0!==s?s:[],l={from:o.v.TITLEBAR,name:e,trigger:t,path:[]};return r.set("points",c.concat([l])),(0,i.h)(l,r,n),(0,a.y)("Titlebar")}))}},67627:function(e,t,n){n.d(t,{h:function(){return o}});var r=n(19082);function o(e,t,n){var o;if(n){var i=e.from,a=e.name,s=e.trigger,c="".concat((0,r.tr)(i),".").concat(s),l=null!==(o=t.get(c))&&void 0!==o?o:{};l[a]=n,t.set(c,l)}}},77101:function(e,t,n){n.d(t,{y:function(){return a}});var r=n(19082),o=n(95431),i=n(74640);function a(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t,n,a){if("method"===(0,r.Yt)([t,n,a]))return i.q.use(t,n,e),a;o.p.merge(t,{middlewares:{use:e}})}}},84916:function(e,t,n){n.d(t,{u:function(){return a}});var r=n(58419),o=n.n(r),i=n(98975),a=function(){function e(){}return e.getInstance=function(){if(void 0===e.networkInstance){var t=o().create({autoRun:!1});e.networkInstance=(0,i.createSingleton)(t)}return e.networkInstance},e}()},29700:function(e,t,n){n.d(t,{P:function(){return i}});var r=n(85556),o=n(19082),i=function(e){function t(t,n){var r=e.call(this,t,n,Object.getOwnPropertyDescriptor(t,n))||this;return r.methodClassName=n,r.beforeMiddlewares=[],r.middlewares=[],r.afterMiddlewares=[],r.type=o.SF.getReturnType(r.rawTarget,r.methodName),r}return(0,r.__extends)(t,e),Object.defineProperty(t.prototype,"methodName",{get:function(){return this.methodClassName},enumerable:!1,configurable:!0}),t.prototype.merge=function(e){var t=e.filter((function(e){return"string"!=typeof e&&!!e}));return this.middlewares=this.middlewares.concat(t),this},t.prototype.get=function(e){var t=o.yh.from(this.target).get(e),n=(0,o.o0)(void 0,t),r=this.store.get(e);return void 0!==r&&(n=(0,o.o0)(n,r)),n},t.prototype.before=function(e){return this.beforeMiddlewares=this.beforeMiddlewares.concat(e),this},t.prototype.after=function(e){return this.afterMiddlewares=this.afterMiddlewares.concat(e),this},t}(o.w7);(0,r.__decorate)([(0,o.NG)(),(0,r.__metadata)("design:type",Array)],i.prototype,"beforeMiddlewares",void 0),(0,r.__decorate)([(0,o.NG)(),(0,r.__metadata)("design:type",Array)],i.prototype,"middlewares",void 0),(0,r.__decorate)([(0,o.NG)(),(0,r.__metadata)("design:type",Array)],i.prototype,"afterMiddlewares",void 0)},47184:function(e,t,n){n.d(t,{_:function(){return c},r:function(){return l}});var r=n(85556),o=n(3139),i=n(77947),a=n(47408),s={success:"#2e7d32",stop:"#bf360c",error:"#d32f2f",skip:"#757575"};function c(e){return!!("function"==typeof e&&e.point&&e.context&&e.hasNext&&e.stop)}var l=function(e){function t(t,n,o){void 0===o&&(o={});var i=this.constructor,a=e.call(this)||this;a.middlewares=t,a.debug=!1,a.debugInfo=[],a.runningHandlerInfo={},a.hasCalled=!1;var s=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.run.apply(s,(0,r.__spreadArray)([],(0,r.__read)(e),!1))};return s.middlewares=t,s.context={metadata:o},s.point=n||{name:"",from:"",trigger:"",path:[]},Object.setPrototypeOf(s,i.prototype)}return(0,r.__extends)(t,e),t.prototype.getNext=function(e){var t=this;void 0===e&&(e=!1);var n=function(){};if(n.hasCalled=this.hasCalled,this.hasNext()){this.index+=1;var r=this.middlewares[this.index];(n=function(){return n.hasCalled=!0,r(t,e)}).hasCalled=this.hasCalled}return this.hasCalled=!1,n},t.prototype.merge=function(e){var n=new t(e.concat(this.middlewares),this.point,this.context.metadata);return n.debug=this.debug,n},t.prototype.setOnCall=function(e){this.onCall=e},t.prototype.setContext=function(e){Object.assign(this.context,e)},t.prototype.hasNext=function(){return this.index<this.middlewares.length-1},Object.defineProperty(t.prototype,"next",{get:function(){return this.getNext()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"skip",{get:function(){return this.getNext(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this.result},enumerable:!1,configurable:!0}),t.prototype.run=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.rawArguments=e,this.index=-1,this.debugInfo=[],this.runningHandlerInfo={},this.onCall&&this.onCall(),this.next(),(this.debug||o.Am.get(i.O).getValue(a.R.DebugMode))&&this.printDebugInfo();var n=this.data;return this.cleanResult(),n},t.prototype.cleanResult=function(){this.result=void 0},t.prototype.traceStart=function(e,t){var n=Date.now();this.runningHandlerInfo[e]={start:n,type:t}},t.prototype.traceEnd=function(e,t){var n=Date.now(),r=this.runningHandlerInfo[e];r&&this.debugInfo.push([e,r.type,t,n-r.start])},t.prototype.storeData=function(e){this.result=e},t.prototype.stop=function(){this.hasCalled=!0},t.prototype.getArguments=function(){return this.rawArguments},t.prototype.printDebugInfo=function(){console.group("%c@".concat(this.point.from,"(").concat(this.point.name,", ").concat(this.point.trigger,")"),["font-family: Consolas, monospace","display: inline-block","padding: 2px","border: 1px solid #ffa000","background-color: #ffd14933"].join(";")),this.debugInfo.forEach((function(e){var t=(0,r.__read)(e,4),n=t[0],o=t[1],i=t[2],a=t[3];console.log("".concat("%c".concat(i,"%c").padEnd(14," ")," [%c").concat(o,"%c]: ").concat(a,"ms --\x3e ").concat(n),"color: white; background-color: ".concat(s[i],";"),"color: unset","color: ".concat("controller"===o?"#66bb6a":"#42a5f5"),"color: unset")})),console.groupEnd()},t}(Function)},36593:function(e,t,n){n.d(t,{g:function(){return g}});var r=n(85556),o=n(3139),i=n(19082),a=n(85585),s=n(27613),c=n(95431),l=n(41286),u=n(29700),d=n(36402),p=function(){function e(e,t){this.handler=e,this.methodKey=t,this.handlerType="function",this.injectable=!1,this.nextFunction=!1,this.resolve()}return e.prototype.resolve=function(){var e=this.handler;if(l.Q.has(this.handler)){var t=l.Q.get(this.handler);this.handlerType="middleware",this.methodKey="use",e=t.useClass}else c.p.has(this.handler)&&(this.handlerType="controller");this.methodKey&&(this.injectable=d.d.isInjectable(e,this.methodKey))},Object.defineProperty(e.prototype,"type",{get:function(){return this.handlerType},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"methodName",{get:function(){return this.methodKey},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasNextFunction",{get:function(){return this.nextFunction},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this.handler},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"services",{get:function(){return this.injectable?d.d.getParams(this.target,this.methodName):[]},enumerable:!1,configurable:!0}),e}();(0,r.__decorate)([(0,i.NG)(),(0,r.__metadata)("design:type",String)],p.prototype,"handlerType",void 0),(0,r.__decorate)([(0,i.NG)(),(0,r.__metadata)("design:type",Object)],p.prototype,"injectable",void 0),(0,r.__decorate)([(0,i.NG)(),(0,r.__metadata)("design:type",Object)],p.prototype,"nextFunction",void 0);var h=n(52571),f=n(60238),g=function(){function e(e){this.handlerMetadata=e}return e.from=function(t){return t instanceof u.P?new e(new p(t.target,t.methodName)):new e(new p(t))},e.prototype.build=function(){var e=this;return function(t,n){return e.invoke(t,n)}},e.prototype.middlewareHandler=function(){var e=l.Q.get(this.handlerMetadata.target);if(!e)throw new Error("".concat((0,i.FM)(this.handlerMetadata.target)," middleware component not found in the MiddlewareRegistry"));var t=e.instance;return t||(t=o.Am.get(e.useClass)),function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.use.bind(t),t.use.apply(t,(0,r.__spreadArray)([],(0,r.__read)(e),!1))}},e.prototype.controlHandler=function(){var e=c.p.get(this.handlerMetadata.target);if(!e)throw new Error("Controller component not found in the ControllerRegistry");var t=e.useClass;return void 0===e.instance&&(e.instance=o.Am.invoke(t)),e.instance[this.handlerMetadata.methodName].bind(e.instance)},e.prototype.getHandler=function(){if(this.handler)return this.handler;switch(this.handlerMetadata.type){default:case"function":this.handler=this.handlerMetadata.target;break;case"middleware":this.handler=this.middlewareHandler();break;case"controller":this.handler=this.controlHandler()}return this.handler},e.prototype.invoke=function(e,t){var n,o,i,a,s;void 0===t&&(t=!1);try{var c=this.handlerMetadata,u=c.target,d=c.methodName,p=c.type;if(e.traceStart("".concat(u.name," # ").concat(d),p),t)return e.traceEnd("".concat(u.name," # ").concat(d),"skip"),void(null===(n=e.skip)||void 0===n||n.call(e));var f=this.runPreHandlers(e);if("controller"===p){var g=f.findIndex((function(e){return void 0!==e})),v=e.getArguments();if(g<0)f=v;else for(var y=g-1,m=0;y>=0;y-=1,m+=1)f[y]=v[m]}var b=void 0;("middleware"!==p||this.adapterMatchService.isAvailable(l.Q.get(u),e.context.editor))&&(b=this.getHandler().apply(void 0,(0,r.__spreadArray)([],(0,r.__read)(f),!1))),void 0!==b&&"function"!==p&&e.storeData(b),e.hasCalled?(e.traceEnd("".concat(u.name," # ").concat(d),"stop"),null===(i=e.skip)||void 0===i||i.call(e)):(e.traceEnd("".concat(u.name," # ").concat(d),"success"),null===(o=e.next)||void 0===o||o.call(e))}catch(t){var _=this.handlerMetadata;u=_.target,d=_.methodName,h.r.error(null!==(a=t.stack)&&void 0!==a?a:"Error occured at ".concat(u.name," # ").concat(d,": ").concat(t)),e.traceEnd("".concat(u.name," # ").concat(d),"error"),null===(s=e.skip)||void 0===s||s.call(e)}},e.prototype.runPreHandlers=function(e){var t=o.Am.get(s.O).context;return this.handlerMetadata.services.map((function(n){var r;return null===(r=a.A.get(n.service))||void 0===r?void 0:r({context:t,runner:e,param:n})}))},e}();(0,r.__decorate)([(0,o.tB)(),(0,r.__metadata)("design:type",f.X)],g.prototype,"adapterMatchService",void 0)},74640:function(e,t,n){n.d(t,{q:function(){return i}});var r=n(19082),o=n(29700),i=function(){function e(){}return e.getActionPoints=function(t){return this.hasActionPoints(t)||r.SF.set(e.name,[],t),r.SF.getOwn(e.name,t)},e.hasActionPoints=function(t){return r.SF.hasOwn(e.name,t)},e.get=function(t,n){if(!this.has(t,n)){var i=new o.P(t,n);e.getActionPoints(t).push(i),r.SF.set(e.name,i,t,n)}return r.SF.getOwn(e.name,t,n)},e.has=function(t,n){return r.SF.hasOwn(e.name,t,n)},e.useBefore=function(e,t,n){return this.get(e,t).before(n),this},e.use=function(e,t,n){return this.get(e,t).merge(n),this},e.useAfter=function(e,t,n){return this.get(e,t).after(n),this},e.store=function(e,t){return r.yh.from(e,t,Object.getOwnPropertyDescriptor(e,t))},e.setMetadata=function(t,n,r,o){return e.store(r,o).set(t,n),e},e.getMetadata=function(t,n,r){return e.store(n,r).get(t)},e}()},95431:function(e,t,n){n.d(t,{p:function(){return c}});var r=n(19082),o=n(85556),i=n(13815),a=n(74640),s=function(e){function t(t){var n=e.call(this,t)||this;return n.controllerMiddlewares={useBefore:[],use:[],useAfter:[]},n.toolbarItems=[],n.mobileToolbarItems=[],n.menuItems=[],n.mobileMenuItems=[],n.statusbarItems=[],n.contextMenuItems=[],n.mobileContextMenuItems=[],n.keymapConfigs=[],n.titlebarItems=[],n.mobileTitlebarItems=[],n.mobileActionButtons=[],n.type="controller",n}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"middlewares",{get:function(){return this.controllerMiddlewares},set:function(e){var t=this;Object.keys(e).forEach((function(n){t.controllerMiddlewares[n]=t.controllerMiddlewares[n].concat(e[n])}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"actionPoints",{get:function(){return a.q.getActionPoints((0,r.ll)(this.provide))},enumerable:!1,configurable:!0}),t}(i.K);(0,o.__decorate)([(0,r.NG)(),(0,o.__metadata)("design:type",Object)],s.prototype,"controllerMiddlewares",void 0),(0,o.__decorate)([(0,r.NG)(),(0,o.__metadata)("design:type",String)],s.prototype,"name",void 0),(0,o.__decorate)([(0,r.NG)(),(0,o.__metadata)("design:type",Object),(0,o.__metadata)("design:paramtypes",[Object])],s.prototype,"middlewares",null),(0,o.__decorate)([(0,r.NG)(),(0,o.__metadata)("design:type",Array),(0,o.__metadata)("design:paramtypes",[])],s.prototype,"actionPoints",null);var c=new r.Bz(s)},8746:function(e,t,n){n.d(t,{j:function(){return a}});var r=n(19082),o=n(85556),i=function(e){function t(t){var n=e.call(this,t)||this;return n.adapters=[],n.mounted=!1,n.lifeCycleCount=0,n.type="feature",n}return(0,o.__extends)(t,e),t.prototype.onOpen=function(){this.lifeCycleCount+=1},t.prototype.onClose=function(){this.lifeCycleCount-=1},t.prototype.isNotClosed=function(){return 0!==this.lifeCycleCount},t}(n(13815).K);(0,o.__decorate)([(0,r.NG)(),(0,o.__metadata)("design:type",Array)],i.prototype,"adapters",void 0);var a=new r.Bz(i)},41286:function(e,t,n){n.d(t,{Q:function(){return a}});var r=n(19082),o=n(85556),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t}(n(13815).K),a=new r.Bz(i)},36402:function(e,t,n){n.d(t,{d:function(){return s}});var r=n(19082),o=n(85556),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"service",{get:function(){return this.rawService},set:function(e){this.rawService=e,this.name=(0,r.FM)(e)},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return{service:(0,r.FM)(this.rawService),name:this.name,use:this.typeName,expression:this.expression}},t}(r.w7);(0,o.__decorate)([(0,r.NG)(),(0,o.__metadata)("design:type",Object)],i.prototype,"rawService",void 0);var a="workbench:params:metadata",s=function(){function e(){}return e.get=function(e,t,n){var r=this.getParams(e,t);return r[n]=r[n]||new i(e,t,n),r[n]},e.set=function(e,t,n,o){var i=r.SF.has(a,e,t)?r.SF.get(a,e,t):[];i[n]=o,r.SF.set(a,i,e,t)},e.usePreHandler=function(t,n){var r=e.get(n.target,n.propertyKey,n.parameterIndex);return r.service=t,n.expression&&(r.expression=n.expression),n.useFunction&&(r.converter=n.useFunction),e.set(n.target,n.propertyKey,n.parameterIndex,r),this},e.decorate=function(t,n){return void 0===n&&(n={}),function(r,o,i){if("number"==typeof i){var a=Object.assign({target:r,propertyKey:o,parameterIndex:i},n);"symbol"==typeof t&&e.usePreHandler(t,a)}}},e}();s.getParams=function(e,t){return r.SF.has(a,e,t)?r.SF.get(a,e,t):[]},s.isInjectable=function(e,t){var n;return(null!==(n=r.SF.get(a,e,t))&&void 0!==n?n:[]).length>0}},85585:function(e,t,n){n.d(t,{A:function(){return r}});var r=new Map},9771:function(e,t,n){n.d(t,{c:function(){return r}});var r=Symbol("service:badge")},2275:function(e,t,n){n.d(t,{A:function(){return w}});var r=n(85556),o=n(37769),i=n(77947),a=n(4211),s=n(47408),c=n(9771),l=function(){return l=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},l.apply(this,arguments)};function u(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function d(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function p(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}var h=function(){function e(e){this.info=e,this.onUpdate=function(){},this.subBadges=new Map}return e.prototype.relatedTo=function(e,t){return this.subBadges.set(e+"-"+t,{position:e,key:t}),this.onUpdate(),this},e.prototype.removeRelatedBadge=function(e,t){var n=this.subBadges.delete(e+"-"+t);return this.onUpdate(),n},Object.defineProperty(e.prototype,"relatedBadges",{get:function(){return p([],d(this.subBadges.values()))},enumerable:!1,configurable:!0}),e}(),f=function(){function e(e){this.persistStorage=e,this.badgeList=new Map,this.subscribers=[]}return e.prototype.setPrefix=function(e){var t;null===(t=this.persistStorage)||void 0===t||t.setPrefix(e)},e.prototype.showBadgeOn=function(e,t){var n=this,r=e+"-"+t.key,o=Date.now(),i=l(l({version:1},t),{position:e}),a=new h(i);return t.expire>o&&!this.isRemoved(i)&&(this.badgeList.set(r,a),a.onUpdate=function(){n.updateBadge()},this.updateBadge()),a},e.prototype.removeBadgeOn=function(e,t){var n=this,r=e+"-"+t,o=this.badgeList.get(r),i=!1;o&&(this.badgeList.delete(r),this.setPersistStorage(o.info),i=!0,o.info.group&&this.badgeList.forEach((function(e){e.info.group===o.info.group&&(n.badgeList.delete(e.info.position+"-"+e.info.key),n.setPersistStorage(e.info),i=!0)}))),this.badgeList.forEach((function(n){i=n.removeRelatedBadge(e,t)||i})),i&&this.updateBadge()},e.prototype.getBadgesOn=function(e,t){var n,r,o;if(void 0!==t){var i=e+"-"+t;return null!==(o=this.badgeList.get(i))&&void 0!==o?o:null}var a=[];try{for(var s=u(this.badgeList.entries()),c=s.next();!c.done;c=s.next()){var l=d(c.value,2),p=l[0],h=l[1];p.startsWith(e+"-")&&a.push(h)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return a.length?a:null},e.prototype.hasBadgesOn=function(e,t){var n,r;try{for(var o=u(this.badgeList.keys()),i=o.next();!i.done;i=o.next())if(i.value.startsWith(e+"-"+(null!=t?t:"")))return!0}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!1},e.prototype.subscribe=function(e){this.subscribers.push(e)},e.prototype.unsubscribe=function(e){this.subscribers=this.subscribers.filter((function(t){return t!==e}))},e.prototype.clear=function(){this.badgeList.clear(),this.updateBadge()},e.prototype.isRemoved=function(e){return!!this.persistStorage&&this.persistStorage.isRemoved(e)},e.prototype.setPersistStorage=function(e){this.persistStorage&&this.persistStorage.setRemoved(e)},e.prototype.updateBadge=function(){var e=this,t=new Map;this.badgeList.forEach((function(e,n){t.set(n,e.info),e.relatedBadges.forEach((function(n){var r=n.position+"-"+n.key;t.has(r)||t.set(r,l(l({},n),{expire:e.info.expire}))}))}));var n=p([],d(t.values()));this.subscribers.forEach((function(){e.subscribers.forEach((function(e){return e(n)}))}))},e.prototype.getMainBadges=function(){return Array.from(this.badgeList.values())},e}(),g=function(){function e(e){void 0===e&&(e="badge-service"),this.prefix=e}return e.prototype.setPrefix=function(e){this.prefix=e},e.prototype.setRemoved=function(e){var t;try{var n=this.prefix+":badge-removed",r=JSON.parse(null!==(t=localStorage.getItem(n))&&void 0!==t?t:"[]"),o=e.position+"-"+e.key+":v"+e.version;r.push(o),localStorage.setItem(n,JSON.stringify(p([],d(new Set(r)))))}catch(e){console.error("Failed to set persist storage:\n"+e)}},e.prototype.isRemoved=function(e){var t;try{var n=this.prefix+":badge-removed",r=JSON.parse(null!==(t=localStorage.getItem(n))&&void 0!==t?t:"[]"),o=e.position+"-"+e.key+":v"+e.version;if(r.includes(o))return!0}catch(e){console.error("Failed to set persist storage:\n"+e)}return!1},e}(),v=n(42035),y=n(19082),m=n(74380),b=n(2002),_=n(3139),C=n(85814),S=n(8487);(0,o.t)()(g),y.SF.set("design:paramtypes",[g],f),(0,o.t)({provide:f})(f);var w=function(){function e(e,t,n,r){this.store=e,this.eventEmitter=t,this.badgeController=n,this.internalEventEmitter=r,this.autoRelate=!0,e.register(a.j.Badge,[]),this.badgeController.subscribe(this.update.bind(this)),this.registerSchemaChangeListener()}return e.prototype.clear=function(){this.badgeController.clear()},e.prototype.showBadgeOn=function(e,t){this.badgeController.setPrefix(this.getPrefix());var n=this.badgeController.showBadgeOn(e,t);this.autoRelate&&this.relate(n),this.eventEmitter.emit("$badge",{position:e,options:t})},e.prototype.removeBadgeOn=function(e,t){this.badgeController.removeBadgeOn(e,t)},e.prototype.updateRelation=function(e){var t=this;this.autoRelate&&this.badgeController.getMainBadges().forEach((function(n){n.info.position===e&&t.relate(n)}))},e.prototype.getBadgesOn=function(e,t){return void 0===t?this.badgeController.getBadgesOn(e):this.badgeController.getBadgesOn(e,t)},e.prototype.hasBadgesOn=function(e,t){return this.badgeController.hasBadgesOn(e,t)},e.prototype.registerSchemaChangeListener=function(){var e=this;this.internalEventEmitter.listen(S.G.SchemaRead,(function(t){var n=e.serviceNameToBadgePosition(t);n&&e.updateRelation(n)}))},e.prototype.serviceNameToBadgePosition=function(e){var t=void 0;return e===b.v.MENU&&(t="menu"),e===b.v.CONTEXT_MENU&&(t="contextMenu"),e===b.v.TOOLBAR&&(t="toolbar"),e===b.v.MOBILE_TOOLBAR&&(t="mobileToolbar"),e===b.v.MOBILE_MENU&&(t="mobileMenu"),e===b.v.MOBILE_CONTEXT_MENU&&(t="mobileContextMenu"),e===b.v.STATUSBAR&&(t="statusbar"),t},e.prototype.getPrefix=function(){var e;return null!==(e=this.store.getValue(s.R.Namespace))&&void 0!==e?e:""},e.prototype.relate=function(e){var t,n,r,o=e.info;if("menu"!==o.position)if("mobileMenu"!==o.position){var i;"contextMenu"!==o.position||null==(i=null===(r=this.serviceCollection.get(b.v.CONTEXT_MENU))||void 0===r?void 0:r.path(o.key,"root"))||i.forEach((function(t){e.relatedTo("contextMenu",t)}))}else{var a=null===(n=this.serviceCollection.get(b.v.MOBILE_MENU))||void 0===n?void 0:n.path(o.key,"root");null==a||a.forEach((function(t){e.relatedTo("mobileMenu",t)}))}else null==(i=null===(t=this.serviceCollection.get(b.v.MENU))||void 0===t?void 0:t.path(o.key,"root"))||i.forEach((function(t){e.relatedTo("menu",t)}))},e.prototype.update=function(e){this.store.update(a.j.Badge,e)},e}();(0,r.__decorate)([(0,_.tB)(),(0,r.__metadata)("design:type",m.y)],w.prototype,"serviceCollection",void 0),w=(0,r.__decorate)([(0,o.t)({overridable:!0,provide:c.c}),(0,r.__param)(3,(0,_.tB)(C._)),(0,r.__metadata)("design:paramtypes",[i.O,v.v,f,v.v])],w)},27613:function(e,t,n){n.d(t,{O:function(){return c}});var r=n(85556),o=n(52571),i=n(52747),a=n(37769),s=n(42035),c=function(){function e(e,t){this.workbenchContext=e,this.eventEmitter=t}return Object.defineProperty(e.prototype,"context",{get:function(){return this.workbenchContext},enumerable:!1,configurable:!0}),e.prototype.inject=function(e,t){if(e in i.x9.prototype)o.r.error("Duplicate injection for key: ".concat(e));else{var n=function(){return t};"function"==typeof t&&(n=t),Object.defineProperty(i.x9.prototype,e,{get:n}),this.eventEmitter.emit("$onInjectContext",{key:e,value:t})}},e}();c=(0,r.__decorate)([(0,a.t)(),(0,r.__metadata)("design:paramtypes",[i.x9,s.v])],c)},51838:function(e,t,n){n.d(t,{r:function(){return i}});var r=n(85556),o=n(37769),i=function(){function e(){this.configControllers=new Map,this.callbackControllers=new Map}return e.prototype.getConfigController=function(e){return this.configControllers.get(e)},e.prototype.getCallbackController=function(e){return this.callbackControllers.get(e)},e.prototype.setConfigController=function(e,t){this.configControllers.set(e,t)},e.prototype.setCallbackController=function(e,t){this.callbackControllers.set(e,t)},e}();i=(0,r.__decorate)([(0,o.t)({overridable:!0})],i)},82010:function(e,t,n){n.d(t,{$t:function(){return p},zv:function(){return h}});var r=n(85556),o=n(70230),i=n(77947),a=n(37769),s=n(4211),c=n(58624),l=n(42035),u=n(52571),d=n(32673),p={FLOAT:(0,c.w)("float"),PUSH:(0,c.w)("push")},h=function(){function e(e,t){var n=this;this.store=e,this.eventEmitter=t,this.leftDrawerMode="push",this.rightDrawerMode="float",this.leftDrawerInCloseAnimation=!1,this.rightDrawerInCloseAnimation=!1,this.onBeforeShowLeftDrawer=function(){n.updateLeftMargin()},this.onBeforeCloseLeftDrawer=function(){n.leftDrawerInCloseAnimation=!0,n.leftDrawerMode===p.PUSH&&n.updateLeftMargin()},this.onAfterCloseLeftDrawer=function(){n.leftDrawerInCloseAnimation&&n.store.get(s.j.LeftDrawerInfo).next({}),n.isAnimationDisabled()&&n.enableAnimation(),n.eventEmitter.emit("$leftDrawerClosed"),n.leftDrawerInCloseAnimation=!1},this.onBeforeShowRightDrawer=function(){n.updateRightMargin()},this.onBeforeCloseRightDrawer=function(){n.rightDrawerInCloseAnimation=!0,n.updateRightMargin()},this.onAfterCloseRightDrawer=function(){n.rightDrawerInCloseAnimation&&n.store.get(s.j.RightDrawerInfo).next({}),n.isAnimationDisabled()&&n.enableAnimation(),n.eventEmitter.emit("$rightDrawerClosed"),n.rightDrawerInCloseAnimation=!1},e.upsert(s.j.DisableDrawerAnimation,!1),e.upsert(s.j.LeftDrawerInfo,{}),e.upsert(s.j.RightDrawerInfo,{}),e.upsert(s.j.LeftSubDrawerInfo,[]),e.upsert(s.j.RightSubDrawerInfo,[]),e.upsert(s.j.LeftDrawerPersistContent,[]),e.upsert(s.j.RightDrawerPersistContent,[]),e.upsert(s.j.LeftDrawerHiddenContent,new Map),e.upsert(s.j.RightDrawerHiddenContent,new Map),e.upsert(s.j.LeftDrawerOpened,!1),e.upsert(s.j.RightDrawerOpened,!1),e.upsert(s.j.LeftDrawerStyle,{}),e.upsert(s.j.RightDrawerStyle,{})}return e.prototype.isLeftOpening=function(e){return!!this.isSubDrawer("left",{name:e})||this.isOpening("left",e)},e.prototype.isRightOpening=function(e){return!!this.isSubDrawer("right",{name:e})||this.isOpening("right",e)},e.prototype.isOpening=function(e,t){var n,r="left"===e?s.j.LeftDrawerInfo:s.j.RightDrawerInfo,o="left"===e?s.j.LeftDrawerOpened:s.j.RightDrawerOpened;return!(null===(n=this.store.getValue(o))||void 0===n||!n||t&&this.store.get(r).value.name!==t)},e.prototype.updateDrawerShowState=function(e,t){var n="left"===e?s.j.LeftDrawerInfo:s.j.RightDrawerInfo,r="left"===e?s.j.LeftDrawerOpened:s.j.RightDrawerOpened,o="left"===e?this.updateLeftDrawerStyle:this.updateRightDrawerStyle,i="left"===e?"$leftDrawerWillOpen":"$rightDrawerWillOpen";this.eventEmitter.emit(i,t),this.store.update(n,t),this.store.update(r,!0),"left"===e?this.leftDrawerInCloseAnimation=!1:this.rightDrawerInCloseAnimation=!1,o.bind(this)({})},e.prototype.showLeftDrawer=function(e){void 0===e&&(e={}),this.showDrawer("left",e)},e.prototype.updateLeftDrawerStyle=function(e){var t={};o.w.isIPad()&&(t={paddingTop:0,marginTop:0}),this.store.update(s.j.LeftDrawerStyle,Object.assign(Object.assign({},e),t)),this.updateLeftMargin()},e.prototype.closeLeftDrawer=function(e){this.closeDrawer("left",e)},e.prototype.hideLeftDrawer=function(e){this.hideDrawer(e,"left")},e.prototype.hideRightDrawer=function(e){this.hideDrawer(e,"right")},e.prototype.hideDrawer=function(e,t){var n=("left"===t||void 0===t)&&this.isLeftOpening(e),r=("right"===t||void 0===t)&&this.isRightOpening(e);n||r?(n&&this.hide("left",e),r&&this.hide("right",e)):u.r.info("drawerService: nothing to hide here")},e.prototype.showRightDrawer=function(e){void 0===e&&(e={}),this.showDrawer("right",e)},e.prototype.showDrawer=function(e,t){var n,o;if(void 0===t&&(t={}),t.childOf&&this.isOpening(e,t.childOf)){var i="left"===e?s.j.LeftSubDrawerInfo:s.j.RightSubDrawerInfo,a=null!==(n=this.store.getValue(i))&&void 0!==n?n:[];return t.name||(t.name=(0,d.D)()),a.push(t),void this.store.update(i,(0,r.__spreadArray)([],(0,r.__read)(a),!1))}if(this.isHidden(e,t.name)){var c=this.removeFromHidden(t.name,e);c&&this.updateDrawer(e,c)}else this.isOpening(e,null!==(o=t.name)&&void 0!==o?o:(0,d.D)())?this.updateCurrentDrawer(e,t,t.name):(this.updateDrawerShowState(e,t),this.clearSubDrawers(e))},e.prototype.toggleLeftDrawer=function(e){void 0===e&&(e={}),this.toggleDrawer("left",e)},e.prototype.toggleRightDrawer=function(e){void 0===e&&(e={}),this.toggleDrawer("right",e)},e.prototype.toggleDrawer=function(e,t){var n;void 0===t&&(t={}),this.isOpening(e,null!==(n=t.name)&&void 0!==n?n:(0,d.D)())?this.hide(e,t.name):this.isHidden(e,t.name)?this.showDrawer(e,{name:t.name}):this.showDrawer(e,t)},e.prototype.isSubDrawer=function(e,t){var n,r="left"===e?s.j.LeftSubDrawerInfo:s.j.RightSubDrawerInfo;return!!(null!==(n=this.store.getValue(r))&&void 0!==n?n:[]).find((function(e){return e.name===t.name}))},e.prototype.updateCurrentDrawer=function(e,t,n){this.isSubDrawer(e,Object.assign(Object.assign({},t),{name:n}))?this.updateSubDrawer(e,Object.assign({},t),n):this.isOpening(e,null!=n?n:(0,d.D)())&&this.updateDrawer(e,t)},e.prototype.updateDrawer=function(e,t){var n=Object.assign(Object.assign({},this.getCurrentDrawer(e)),t);this.updateDrawerShowState(e,n)},e.prototype.updateSubDrawer=function(e,t,n){var o,i="left"===e?s.j.LeftSubDrawerInfo:s.j.RightSubDrawerInfo,a=null!==(o=this.store.getValue(i))&&void 0!==o?o:[];if(n){var c=a.findIndex((function(e){return e.name===n}));a[c]=Object.assign(Object.assign({},t),{name:n}),this.store.update(i,(0,r.__spreadArray)([],(0,r.__read)(a),!1))}},e.prototype.updateRightDrawerStyle=function(e){var t={};o.w.isIPad()&&(t={paddingTop:0,marginTop:0}),this.store.update(s.j.RightDrawerStyle,Object.assign(Object.assign({},e),t)),this.updateRightMargin()},e.prototype.closeRightDrawer=function(e){this.closeDrawer("right",e)},e.prototype.closeDrawer=function(e,t){if(this.isOpening(e)){var n="left"===e?s.j.LeftDrawerOpened:s.j.RightDrawerOpened;!1===t&&this.disableAnimation();var r=this.getCurrentDrawer(e);r&&(this.isHidden(e,r.name)?this.removeFromHidden(r.name,e):this.clearSubDrawers(e),this.store.get(n).next(!1))}},e.prototype.setLeftDrawerMode=function(e){this.leftDrawerMode=e,this.updateLeftMargin()},e.prototype.addPersistContentToLeftDrawer=function(e){var t,n=(null!==(t=this.store.getValue(s.j.LeftDrawerPersistContent))&&void 0!==t?t:[]).concat([e]);this.store.update(s.j.LeftDrawerPersistContent,n)},e.prototype.addPersistContentToRightDrawer=function(e){var t,n=(null!==(t=this.store.getValue(s.j.RightDrawerPersistContent))&&void 0!==t?t:[]).concat([e]);this.store.update(s.j.RightDrawerPersistContent,n)},e.prototype.setRightDrawerMode=function(e){this.rightDrawerMode=e,this.updateRightMargin()},e.prototype.updateLeftMargin=function(){var e,t=this.store.getValue(s.j.EditorZoneMarginLeft);if(this.isLeftOpening()){var n=document.getElementById("workbench-drawer-left"),r=null!==(e=null==n?void 0:n.offsetWidth)&&void 0!==e?e:0,o=this.leftDrawerMode===p.PUSH?null!=r?r:280:0;this.store.upsert(s.j.EditorZoneMarginLeft,o),this.eventEmitter.emit("$editorZoneResize")}else t&&0!==t&&(this.store.upsert(s.j.EditorZoneMarginLeft,0),this.eventEmitter.emit("$editorZoneResize"))},e.prototype.updateRightMargin=function(){var e,t=this.store.getValue(s.j.EditorZoneMarginRight);if(this.isRightOpening()){var n=document.getElementById("workbench-drawer-right"),r=null!==(e=null==n?void 0:n.offsetWidth)&&void 0!==e?e:0,o=this.rightDrawerMode===p.PUSH?null!=r?r:280:0;this.store.upsert(s.j.EditorZoneMarginRight,o),this.eventEmitter.emit("$editorZoneResize")}else t&&0!==t&&(this.store.upsert(s.j.EditorZoneMarginRight,0),this.eventEmitter.emit("$editorZoneResize"))},e.prototype.disableAnimation=function(){this.store.get(s.j.DisableDrawerAnimation).next(!0)},e.prototype.enableAnimation=function(){this.store.get(s.j.DisableDrawerAnimation).next(!1)},e.prototype.isAnimationDisabled=function(){var e;return null!==(e=this.store.getValue(s.j.DisableDrawerAnimation))&&void 0!==e&&e},e.prototype.getCurrentDrawer=function(e){var t="left"===e?s.j.LeftDrawerInfo:s.j.RightDrawerInfo;return this.store.getValue(t)},e.prototype.hide=function(e,t){var n="left"===e?s.j.LeftDrawerHiddenContent:s.j.RightDrawerHiddenContent,r="left"===e?s.j.LeftDrawerOpened:s.j.RightDrawerOpened,o="left"===e?s.j.LeftDrawerInfo:s.j.RightDrawerInfo,i=this.getCurrentDrawer(e);if(i&&t===(null==i?void 0:i.name)){if(!this.isHidden(e,t)){this.store.get(o).next({name:""});var a=this.store.get(n);a.next(new Map(a.getValue().set(i.name,i))),this.store.get(r).next(!1)}}else u.r.warn("drawerService: current drawer mistmatched")},e.prototype.isHidden=function(e,t){var n="left"===e?s.j.LeftDrawerHiddenContent:s.j.RightDrawerHiddenContent,r=this.store.getValue(n);return!!(null==r?void 0:r.has(t))},e.prototype.removeFromHidden=function(e,t){var n="left"===t?s.j.LeftDrawerHiddenContent:s.j.RightDrawerHiddenContent,r=this.store.get(n),o=r.getValue().get(e);return null==r||r.getValue().delete(e),null==r||r.next(new Map(r.getValue())),o},e.prototype.removeLeftSubDrawer=function(e){this.removeSubDrawer("left",e)},e.prototype.removeRightSubDrawer=function(e){this.removeSubDrawer("right",e)},e.prototype.clearSubDrawers=function(e){var t="left"===e?s.j.LeftSubDrawerInfo:s.j.RightSubDrawerInfo;this.store.update(t,[])},e.prototype.removeSubDrawer=function(e,t){var n,o="left"===e?s.j.LeftSubDrawerInfo:s.j.RightSubDrawerInfo,i=null!==(n=this.store.getValue(o))&&void 0!==n?n:[];if(t){var a=i.findIndex((function(e){return e.name===t}));a>=0&&(i.splice(a,1),this.store.update(o,(0,r.__spreadArray)([],(0,r.__read)(i),!1)))}else this.clearSubDrawers(e)},e}();h=(0,r.__decorate)([(0,a.t)({overridable:!0}),(0,r.__metadata)("design:paramtypes",[i.O,l.v])],h)},34549:function(e,t,n){var r;n.d(t,{c:function(){return r}}),function(e){e.BeforeContextMenu="$beforeContextmenuShow",e.ContextMenuShowed="$contextMenuShowed",e.AfterContextMenuDismissed="$afterContextMenuDismissed",e.SurfaceSizeChanged="$surfaceSizeChanged",e.ToolbarUpdated="$toolbarUpdated",e.ToolbarShrinkUpdated="$toolbareShrinkUpdated",e.TitlebarMounted="$titlebarMounted"}(r||(r={}))},42035:function(e,t,n){n.d(t,{v:function(){return c}});var r=n(85556),o=n(63357),i=n(91301),a=n(56157),s=n(37769),c=function(){function e(){this.subjects={}}return e.prototype.listen=function(e,t){return this.subjects[e]||(this.subjects[e]=new o.xQ),this.subjects[e].subscribe(t)},e.prototype.listenOnce=function(e,t){return this.subjects[e]||(this.subjects[e]=new o.xQ),this.subjects[e].pipe((0,a.P)()).subscribe(t)},e.prototype.emit=function(e,t){this.subjects[e]||(this.subjects[e]=new o.xQ),this.subjects[e].next(t)},e.prototype.emitReplay=function(e,t){this.subjects[e]||(this.subjects[e]=new i.t(1)),this.subjects[e].next(t)},e.prototype.dispose=function(){var e=this;Object.keys(this.subjects).forEach((function(t){var n=e.subjects[t];n.complete(),n.unsubscribe(),delete e.subjects[t]}))},e}();c=(0,r.__decorate)([(0,s.t)()],c)},85814:function(e,t,n){n.d(t,{_:function(){return i}});var r=n(85556),o=n(37769),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t}(n(42035).v);i=(0,r.__decorate)([(0,o.t)()],i)},8487:function(e,t,n){var r;n.d(t,{G:function(){return r}}),function(e){e.SchemaRead="$SchemaRead",e.MinorButtonsChanged="$MinorButtonsChanged"}(r||(r={}))},46552:function(e,t,n){n.d(t,{Q:function(){return a}});var r=n(85556),o=n(37769),i=n(3139),a=function(){function e(){this.flags={}}return e.prototype.setFlag=function(e,t){this.flags[e]=t},e.prototype.getFlag=function(e){var t;return null===(t=this.flags[e])||void 0===t||t},e}();a=(0,r.__decorate)([(0,o.t)({overridable:!0})],a),i.Am.factory(a,new a)},81346:function(e,t,n){n.d(t,{U:function(){return v}});var r=n(85556),o=n(3139),i=n(19082),a=n(87782),s=n(37769),c=n(81758),l=n(8746),u=n(52571),d=n(60238),p=n(91301),h=n(77947),f=n(47408),g=n(46552),v=function(){function e(e,t,n,r){this.settings=e,this.adapterMatcher=t,this.store=n,this.featureFlagService=r,this.featuresSettingChange=new p.t,this.store.register(f.e.Features,[]).subscribe(this.featuresSettingChange)}return e.prototype.isFeatureProvider=function(e){return"feature"===(null==e?void 0:e.type)},e.prototype.subscribeToFeatureChange=function(){var e=this;this.featuresSettingChange.subscribe((function(t){t.filter((function(e){return!!e&&o.ll.has(e)})).forEach((function(t){var n=o.ll.get(t);if(!n)throw new ReferenceError("Feature ".concat((0,i.FM)(t)," is not loaded, make sure you have imported the controller code somewhere."));if(!e.isFeatureProvider(n))throw new TypeError("Provider ".concat((0,i.FM)(t)," is not a feature."));e.buildFeature(n)}))}))},e.prototype.mount=function(e,t){var n=this;e.forEach((function(e,r){if(e){var i=o.ll.get(e);n.isFeatureProvider(i)&&n.buildFeature(i,(null==t?void 0:t.idle)||n.settings.idle)}else u.r.error("The ".concat(r,"-index feature is undefined"))}))},e.prototype.buildFeature=function(e,t){var n,r=this;void 0===t&&(t=!1),this.featureFlagService.getFlag("feature.".concat(null!==(n=e.name)&&void 0!==n?n:""))&&(t?a.scheduler.scheduleTask((function(){r.mountFeature(e)}),{priority:a.Priority.normal}):this.mountFeature(e))},e.prototype.mountFeature=function(e){e.instance||(e.instance=o.Am.get(e.useClass));var t=l.j.get(e.useClass);if(!(null==t?void 0:t.mounted)){this.adapterMatcher.matchOpenedEditors(t).forEach((function(n){t.onOpen(),o.Am.emitAt("$onEditorOpen",e.useClass,n)})),t.mounted=!0;var n=o.Ln.get(e.provide);n&&(n.isReady=!0)}},e}();v=(0,r.__decorate)([(0,s.t)({overridable:!0}),(0,r.__metadata)("design:paramtypes",[c.I,d.X,h.O,g.Q])],v)},92873:function(e,t,n){n.d(t,{h:function(){return y}});var r=n(85556),o=n(3139),i=n(99221),a=n(77947),s=n(4211),c=n(37769),l=n(52571),u=n(2002),d=n(42035),p=n(85814),h=n(8487),f=n(84745),g=[{name:"divider",content:"divider"},{name:"none",content:"none"}],v=g.map((function(e){return e.name})),y=function(e){function t(t,n){var r=e.call(this)||this;return r.store=t,r.internalEventEmitter=n,r.preventDismissSelectors=[],r.schema=[],r.relations=new Map,r.store.register(s.j.Menu,{name:"root",content:"root",children:[]}),g.forEach((function(e){r.configs.set(e.name,e)})),r}return(0,r.__extends)(t,e),t.prototype.$forceUpdate=function(){this.forceUpdateWithStore(this.store,s.j.Menu)},t.prototype.onUpdate=function(){e.prototype.onUpdate.call(this);var t={name:"root",content:"root",children:[]};this.relations.clear(),this.schema.reduce(this.readSchema.bind(this,[]),t),this.store.get(s.j.Menu).next(t),this.internalEventEmitter.emit(h.G.SchemaRead,u.v.MENU)},t.prototype.mergeSchemaWithoutUpdate=function(e){this.schema=this.schema.concat(e)},t.prototype.register=function(t,n){void 0===n&&(n=!0),v.indexOf(t.name)>=0?l.r.warn('The menu config "'.concat(t.name,'" is reserved.')):(e.prototype.register.call(this,t,n),"string"==typeof t.preventDismiss&&this.preventDismissSelectors.push([t.name,t.preventDismiss]))},t.prototype.readSchema=function(e,t,n){var o=this,i=Object.assign({},t);if("root"!==i.name&&e.push(i.name),"string"==typeof n&&this.hasConfig(n)){var a=Object.assign(Object.assign({},this.get(n)),{children:[]});this.setPathToActionInfoInConfig(a,e),i.children.push(a)}else if("string"!=typeof n&&this.hasConfig(n.key)){var s=Object.assign(Object.assign({},this.get(n.key)),{children:[]});this.setPathToActionInfoInConfig(s,e),n.items.reduce((function(t,n){return o.readSchema((0,r.__spreadArray)([],(0,r.__read)(e),!1),t,n)}),s),i.children.push(s)}return this.relations.set(i.name,i.children.map((function(e){return e.name}))),i},t.prototype.get=function(t){return e.prototype.get.call(this,t,{name:"none",content:"none",onClick:function(){}})},t.prototype.path=function(e,t){if(!t)return this.relations.has(e)?[e]:[];if(!this.relations.has(t))return[];var n=[];return this.find(t,e,n),n},t.prototype.updateKeySchema=function(e,t,n){void 0===n&&(n=!1);var r=this.getSchema(),o=(0,f.O)(r,e,t);return n&&this.setSchema(o),o},t.prototype.find=function(e,t,n){var o,i,a,s=null!==(a=this.relations.get(e))&&void 0!==a?a:[];if(s.includes(t))return n.unshift(t),!0;try{for(var c=(0,r.__values)(s),l=c.next();!l.done;l=c.next()){var u=l.value;if(this.find(u,t,n))return n.unshift(u),!0}}catch(e){o={error:e}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(o)throw o.error}}return!1},t}(i.C);y=(0,r.__decorate)([(0,c.t)({overridable:!0,scope:"ui:service",name:u.v.MENU}),(0,r.__param)(1,(0,o.tB)(p._)),(0,r.__metadata)("design:paramtypes",[a.O,d.v])],y)},84745:function(e,t,n){function r(e,t){return{key:e,items:t}}function o(e,t,n){return t.map((function(t){var i=t;if("string"==typeof t)t===e&&(i=r(e,n));else if(t.key===e)i=r(e,n);else if(t.items){var a=i;"string"!=typeof a&&(a.items=o(e,t.items,n)),i=a}return i}))}function i(e,t,n){return o(t,e,n)}n.d(t,{O:function(){return i}})},74380:function(e,t,n){n.d(t,{y:function(){return c}});var r=n(85556),o=n(19082),i=n(37769),a=n(6097),s=n(99521),c=function(){function e(){for(var e,t,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];this.serviceMap=new Map,this.serviceOptions=new Map;try{for(var s=(0,r.__values)(n),c=s.next();!c.done;c=s.next()){var l=c.value;l instanceof a.V&&this.serviceMap.set((0,o.tr)(l),l)}}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}}return e.prototype.getControllerRelatedUIServices=function(){return this.serviceMap},e.prototype.has=function(e){return this.serviceMap.has((0,o.tr)(e))},e.prototype.add=function(e,t){var n=(0,o.tr)(e);this.serviceMap.set(n,e),t&&this.serviceOptions.set(n,t)},Object.defineProperty(e.prototype,"services",{get:function(){return(0,r.__spreadArray)([],(0,r.__read)(this.serviceMap.values()),!1)},enumerable:!1,configurable:!0}),e.prototype.get=function(e){return this.serviceMap.get(e)},e.prototype.getItemName=function(e){var t,n;return null!==(n=null===(t=this.serviceOptions.get(e))||void 0===t?void 0:t.itemName)&&void 0!==n?n:s.e[e]},e}();c=(0,r.__decorate)([(0,i.t)(),(0,r.__metadata)("design:paramtypes",[a.V])],c)},47408:function(e,t,n){n.d(t,{R:function(){return o},e:function(){return i}});var r=n(58624),o={DisableToolbar:(0,r.w)("toolbar.disabled"),ToolbarAlignment:(0,r.w)("toolbar.alignment"),ToolbarSchemaAnimation:(0,r.w)("toolbar.schemaAnimation"),ToolbarGridChunkSize:(0,r.w)("toolbar.gridChunkSize"),ToolbarPanelHeight:(0,r.w)("toolbar.panelHeight"),ToolbarRespectSoftKeyboard:(0,r.w)("toolbar.respectSoftKeyboard"),DisableDrawer:(0,r.w)("drawer.disabled"),DisableStatusbar:(0,r.w)("statusbar.disabled"),DisableContextMenu:(0,r.w)("contextMenu.disabled"),MultiRowsContextMenu:(0,r.w)("contextMenu.multiRows"),DisableTitlebar:(0,r.w)("titlebar.disabled"),TitlebarHeight:(0,r.w)("titlebar.height"),TitlebarHoverable:(0,r.w)("titlebar.hoverable"),TitlebarContentDefaultStyle:(0,r.w)("titlebar.contentDefaultStyle"),PaddingLeft:(0,r.w)("editorZone.paddingLeft"),PaddingRight:(0,r.w)("editorZone.paddingRight"),PaddingTop:(0,r.w)("editorZone.paddingTop"),PaddingBottom:(0,r.w)("editorZone.paddingBottom"),SupportNativeDomScrolling:(0,r.w)("editorZone.supportNativeDomScrolling"),Namespace:(0,r.w)("namespace"),DebugMode:(0,r.w)("debugMode"),SelectionThrottleTime:(0,r.w)("selectionThrottleTime"),ModelThrottleTime:(0,r.w)("modelThrottleTime"),AccessibilityDropdownAutoFocus:(0,r.w)("accessibility.dropdownAutoFocus"),AccessibilityMenuClickFocus:(0,r.w)("accessibility.menuClickFocus")},i={Controllers:(0,r.w)("controllers"),Features:(0,r.w)("features"),Services:(0,r.w)("services")}},81758:function(e,t,n){n.d(t,{I:function(){return d}});var r,o=n(85556),i=n(19082),a=n(3139),s=n(47),c=n(37769),l=n(77947),u=n(47408),d=r=function(){function e(e,t,n){this.store=e,this.map=new Map,this.platform=n,this.container=t,this.accessibility={dropdownAutoFocus:!0,menuClickFocus:!0},this.menu={schema:[]},this.contextMenu={schema:[],disabled:!1,hasOverlay:!0,multiRows:!1},this.toolbar={disabled:!1,alignment:"left",schemaAnimation:!1,gridChunkSize:5,panelHeight:290,respectSoftKeyboard:!0},this.statusbar={schema:{left:[],right:[]},disabled:!1},this.titlebar={schema:[],disabled:!1,height:48},this.actionButtons={schema:{},disabled:!1},this.mount={controllers:[],features:[],services:[]},this.editorZone={paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0},this.extensions=[],this.namespace="workbench",this.idle=!1,this.debugMode=!1}return e.getMetadata=function(e){return i.SF.getOwn(s.C,e)},e.prototype.forEach=function(e,t){return this.map.forEach(e,t)},e.prototype.set=function(e,t){var n=this;"string"==typeof e?(function(e,t,n,r){void 0===r&&(r=".");for(var o,i=e.split(r);o=i.shift(),i.length?("function"==typeof n.set?(n.has(o)||n.set(o,{}),n=n.get(o)):n=n[o]||{},1):("function"==typeof n.set?n.set(o,t):n[o]=t,0););}(e,t,this.map),Object.values(u.R).includes(e)&&this.store.upsert(e,t)):(Object.keys(e).forEach((function(t){Object.getOwnPropertyDescriptor(r.prototype,t)&&-1===["set","map","forEach","shallow"].indexOf(t)?n[t]=e[t]:n.set(t,e[t])})),this.forEach((function(e,t){["useLogger","container"].includes(t)?n[t]=e:n.map.set(t,n.resolve(e))})))},e.prototype.get=function(e){return function(e,t,n,r){void 0===r&&(r=".");for(var o,i=e.split(r);o=i.shift(),(t="function"==typeof t.get?t.get(o):t[o])&&i.length;);return void 0===t?n:t}(e,this.map)},e.prototype.resolve=function(e){var t=this;return"object"==typeof e&&Object.keys(e).forEach((function(n){e[n]=t.resolve(e[n])})),e},e.prototype.shallow=function(e,t){var n=this;Object.keys(t).forEach((function(r){n.set("".concat(e,".").concat(r),t[r])}))},Object.defineProperty(e.prototype,"platform",{get:function(){var e;return null!==(e=this.map.get("platform"))&&void 0!==e?e:"pc"},set:function(e){this.map.set("platform",e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"accessibility",{get:function(){return this.map.get("accessibility")},set:function(e){this.shallow("accessibility",e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"container",{get:function(){return this.map.get("container")},set:function(e){this.map.set("container",e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"menu",{get:function(){return this.map.get("menu")},set:function(e){this.shallow("menu",e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"contextMenu",{get:function(){return this.map.get("contextMenu")},set:function(e){this.shallow("contextMenu",e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"toolbar",{get:function(){return this.map.get("toolbar")},set:function(e){this.shallow("toolbar",e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"statusbar",{get:function(){return this.map.get("statusbar")},set:function(e){this.shallow("statusbar",e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"titlebar",{get:function(){return this.map.get("titlebar")},set:function(e){this.shallow("titlebar",e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"actionButtons",{get:function(){return this.map.get("actionButtons")},set:function(e){this.shallow("actionButtons",e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"useLogger",{get:function(){return this.map.get("useLogger")},set:function(e){this.map.set("useLogger",e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mount",{get:function(){return this.map.get("mount")},set:function(e){this.shallow("mount",e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"namespace",{get:function(){return this.map.get("namespace")},set:function(e){this.set("namespace",e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"editorZone",{get:function(){return this.map.get("editorZone")},set:function(e){this.shallow("editorZone",e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"idle",{get:function(){return this.map.get("idle")},set:function(e){this.map.set("idle",e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"debugMode",{get:function(){return this.map.get("debugMode")},set:function(e){this.set("debugMode",e)},enumerable:!1,configurable:!0}),e.prototype.addMountSettings=function(e){var t=this,n=Object.values(u.e);Object.entries(e).forEach((function(e){var r=e[0],o=e[1];n.includes(r)&&(t.store.upsert(r,o),Array.isArray(t.mount[r])&&Array.isArray(o)&&t.mount[r].concat(o))}))},Object.defineProperty(e.prototype,"extensions",{get:function(){return this.map.get("extensions")},set:function(e){this.map.set("extensions",e)},enumerable:!1,configurable:!0}),e}();d=r=(0,o.__decorate)([(0,c.t)(),(0,o.__param)(1,(0,a.tB)("container")),(0,o.__param)(2,(0,a.tB)("platform")),(0,o.__metadata)("design:paramtypes",[l.O,HTMLElement,String])],d)},4211:function(e,t,n){var r;n.d(t,{j:function(){return r}}),function(e){e.IsOnline="isOnline",e.FocusState="focusState",e.SelectionState="selectionState",e.SelectionTempState="selectionTempState",e.ModelState="modelState",e.ModelTempState="modelTempState",e.DisableDrawerAnimation="disableDrawerAnimation",e.LeftDrawerOpened="leftDrawerOpened",e.RightDrawerOpened="rightDrawerOpened",e.LeftDrawerInfo="leftDrawerInfo",e.RightDrawerInfo="rightDrawerInfo",e.LeftSubDrawerInfo="leftSubDrawerInfo",e.RightSubDrawerInfo="rightSubDrawerInfo",e.LeftDrawerStyle="leftDrawerStyle",e.RightDrawerStyle="rightDrawerStyle",e.LeftDrawerPersistContent="leftDrawerPersistContent",e.RightDrawerPersistContent="rightDrawerPersistContent",e.LeftDrawerHiddenContent="leftDrawerHiddenContent",e.RightDrawerHiddenContent="rightDrawerHiddenContent",e.EditorZoneMarginLeft="editorZoneMarginLeft",e.EditorZoneMarginRight="editorZoneMarginRight",e.Menu="menu",e.MobileMenu="mobileMenu",e.ContextMenu="contextMenu",e.ContextMenuInfo="contextMenuInfo",e.MobileContextMenu="mobileContextMenu",e.MobileContextMenuInfo="mobileContextMenuInfo",e.Toolbar="toolbar",e.ToolbarSubContainer="toolbarSubContainer",e.ToolbarEvent="toolbarEvent",e.ToolbarDropdownEvent="toolbarDropdownEvent",e.ToolbarVisible="toolbarVisible",e.FloatToolbarPosition="floatToolbarPosition",e.FloatToolbarVisible="floatToolbarVisible",e.FixToolbarShow="transition.trigger.fixed-toolbar",e.FixToolbarDOMVisible="fixed-toolbar.dom.visible",e.isFocusedByClick="isFocusedByClick",e.MultiLineToolbarContainer="multiLineToolbarContainer",e.Titlebar="titlebar",e.TitlebarCalculatedWidth="titlebarCalculatedWidth",e.MobileTitlebar="mobileTitlebar",e.TitlebarShow="transition.trigger.titlebar",e.TitlebarFocus="titlebarFocus",e.TitlebarHover="titlebarHover",e.TitlebarListenMouseMove="titlebarListenMouseMove",e.TitlebarDOMVisible="titlebar.dom.visible",e.MobileToolbar="mobileToolbar",e.ShowMobileToolbar="showMobileToolbar",e.MobileToolbarPosition="mobileToolbarPosition",e.MobileToolbarPositionTrigger="mobileToolbarPositionTrigger",e.MobileToolbarConfig="mobileToolbarConfig",e.MobilePanels="mobilePanels",e.MobileSubPanel="mobileSubPanel",e.MobilePanelHeight="mobilePanelHeight",e.MobilePanelTitle="mobilePanelTitle",e.KeyboardHeight="keyboardHeight",e.ExtraButton="extraButton",e.Statusbar="statusbar",e.Surface="surface",e.FloatSurface="floatSurface",e.FloatSurfaceStyle="floatSurfaceStyle",e.FloatWidget="floatWidget",e.EmbedWidget="embedWidget",e.WrapWidget="wrapWidget",e.EmbedWidgetContainer="embedWidgetContainer",e.ConfigStatus="configStatus",e.ControllerStatus="controllerStatus",e.FeatureStatus="featureStatus",e.ScopeStatus="scopeStatus",e.DisableExceptionScopes="disableExceptionScopes",e.DisableAll="disableAll",e.Badge="badge"}(r||(r={}))},77947:function(e,t,n){n.d(t,{O:function(){return s}});var r=n(85556),o=n(3056),i=n(52571),a=n(37769),s=function(){function e(){this.state=new Map}return e.prototype.register=function(e,t){return this.state.has(e)?i.r.warn("This key has already been registered, thus ignored."):this.state.set(e,new o.X(t)),this.get(e)},e.prototype.has=function(e){return this.state.has(e)},e.prototype.get=function(e){return this.state.get(e)},e.prototype.getValue=function(e){return this.state.has(e)?this.get(e).getValue():null},e.prototype.update=function(e,t){this.state.has(e)?this.get(e).next(t):i.r.warn('Key "'.concat(e,'" is not exists. Update ignored.'))},e.prototype.upsert=function(e,t){this.state.has(e)?this.get(e).next(t):this.register(e,t)},e.prototype.clear=function(e){this.state.delete(e)},e}();s=(0,r.__decorate)([(0,a.t)({overridable:!0})],s)},99779:function(e,t,n){n.d(t,{x:function(){return d}});var r=n(85556),o=n(87363),i=n.n(o),a=n(90447),s=n(3139),c=n(77947),l=n(60349),u=n(65419);function d(e,t,n,d){return void 0===t&&(t=!1),void 0===n&&(n=10),function(p){var h;return(h=function(o){function h(t){var n=o.call(this,t)||this;return n.observables={},n.store=s.Am.get(c.O),n.state=e.reduce((function(e,t){return e[t]=n.getObservable(t).getValue(),e}),{}),n}return(0,r.__extends)(h,o),h.prototype.getObservable=function(e){this.store.has(e)||this.store.register(e,null);var t=this.store.get(e);return this.observables[e]=t.pipe((0,l.U)((function(t){var n;return(n={})[e]=t,n}))),t},h.prototype.componentDidMount=function(){var o=this,i=a.aj.apply(void 0,(0,r.__spreadArray)([],(0,r.__read)(Object.values(this.observables)),!1));e.length>1&&!t?this.subscription=i.pipe((0,u.p)(n,d,{leading:!1,trailing:!0})).subscribe((function(e){var t=e.reduce((function(e,t){return Object.assign(Object.assign({},e),t)}),{});o.setState(t)})):this.subscription=i.subscribe((function(e){var t=e.reduce((function(e,t){return Object.assign(Object.assign({},e),t)}),{});o.setState(t)}))},h.prototype.componentWillUnmount=function(){this.subscription.unsubscribe()},h.prototype.render=function(){return i().createElement(p,Object.assign({},this.props,this.state))},h}(o.Component)).displayName=p.displayName||p.name||"WithStateComponent",h}}},65397:function(e,t,n){n.d(t,{W:function(){return x}});var r=n(85556),o=n(77947),i=n(4211),a=n(37769),s=n(32673),c=n(91301),l=n(3056),u=n(3139),d=n(92449),p=function(){function e(e,t,n){void 0===n&&(n=!1),this.accumulator=e,this.seed=t,this.hasSeed=n}return e.prototype.call=function(e,t){return t.subscribe(new h(e,this.accumulator,this.seed,this.hasSeed))},e}(),h=function(e){function t(t,n,r,o){var i=e.call(this,t)||this;return i.accumulator=n,i._seed=r,i.hasSeed=o,i.index=0,i}return r.__extends(t,e),Object.defineProperty(t.prototype,"seed",{get:function(){return this._seed},set:function(e){this.hasSeed=!0,this._seed=e},enumerable:!0,configurable:!0}),t.prototype._next=function(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)},t.prototype._tryNext=function(e){var t,n=this.index++;try{t=this.accumulator(this.seed,e,n)}catch(e){this.destination.error(e)}this.seed=t,this.destination.next(t)},t}(d.L),f=n(65419),g=n(56157),v=n(52571),y=n(27535),m=n(47408),b=n(42413),_="root",C="float";function S(){return"grid-".concat((0,s.D)())}var w=function(){function e(){this.grids=new Map}return e.prototype.initializeDefaultGrid=function(){this.grids.set(_,{id:_,current:null}),this.grids.set(C,{id:C,current:null,type:"float",grids:[]})},e.prototype.getGrid=function(e){var t;return null!==(t=this.grids.get(e))&&void 0!==t?t:void 0},e.prototype.hasGrid=function(e){return this.grids.has(e)},e.prototype.addToFloatGrid=function(e,t){var n;void 0===t&&(t=!1),t?((n=this.newGridInfo(e)).type="float",this.addSurfaceToGrid(n,e)):(n=this.getGrid(C))&&this.addSurfaceToGrid(n,e)},e.prototype.addToGrid=function(e,t,n){var r,o,i,a,s=this.grids.get(e);if(s){var c=(null!==(o=null===(r=s.grids)||void 0===r?void 0:r.length)&&void 0!==o?o:0)>0;if(!c&&!n)return this.addSurfaceToGrid(s,t),void(s.type=n);if(n!==s.type){if(s.grids=[],(null===(i=s.surfaces)||void 0===i?void 0:i.length)||(null===(a=s.grids)||void 0===a?void 0:a.length)){var l=Object.assign(Object.assign({},s),{id:S()});l.surfaces=s.surfaces,l.grids=s.grids,this.grids.set(l.id,l),this.addGridToTargetGrid(s,l)}var u=this.newGridInfo(t);return this.grids.set(u.id,u),this.addGridToTargetGrid(s,u),void(s.type=n)}n===s.type&&(c?(u=this.newGridInfo(t),this.addGridToTargetGrid(s,u)):this.addSurfaceToGrid(s,t))}else v.r.error("Target grid ".concat(e," does not exist."))},e.prototype.deleteGrid=function(e){var t,n,r=this.grids.get(e);if(r){if(e!==C&&e!==_){if(r.parent){var o=this.grids.get(r.parent),i=null===(t=null==o?void 0:o.grids)||void 0===t?void 0:t.indexOf(e);i&&-1!==i&&(null===(n=null==o?void 0:o.grids)||void 0===n||n.splice(i,1))}this.grids.delete(e)}}else v.r.error("Target grid ".concat(e," does not exist."))},e.prototype.addGridToTargetGrid=function(e,t){var n;null===(n=e.grids)||void 0===n||n.push(t.id),t.parent=e.id,"stack"===e.type&&(e.stackCurrent=t.id)},e.prototype.addSurfaceToGrid=function(e,t){var n,o=e;o.surfaces=(0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(null!==(n=null==o?void 0:o.surfaces)&&void 0!==n?n:[]),!1),[t.id],!1),t.grid=e.id,o.current=t.id},e.prototype.newGridInfo=function(e){var t={id:S(),current:null};return e&&this.addSurfaceToGrid(t,e),this.grids.set(t.id,t),t},e}();w=(0,r.__decorate)([(0,a.t)(),(0,r.__metadata)("design:paramtypes",[])],w);var E={position:"absolute",boxShadow:"0 0 4px #999",top:160,left:0,right:0,margin:"0 auto",width:600,height:340},x=function(){function e(e,t){var n,r,o=this;this.store=e,this.gridService=t,this.info={current:null,focused:!1},this.config=new Map,this.editorInfos=new Map,this.editorMap=new WeakMap,this.initializeSurfaceInDefaultGrid(),e.register(i.j.FocusState,this.info),e.register(i.j.ModelState,{editor:null}),e.register(i.j.ModelTempState,{editor:null}),e.register(i.j.SelectionState,{editor:null}),e.register(i.j.SelectionTempState,{editor:null});var a={leading:!1,trailing:!0},s=null!==(n=e.getValue(m.R.ModelThrottleTime))&&void 0!==n?n:150;e.get(i.j.ModelTempState).pipe((0,f.p)(s,void 0,a)).subscribe((function(t){e.update(i.j.ModelState,t)}));var c=null!==(r=e.getValue(m.R.SelectionThrottleTime))&&void 0!==r?r:150;e.get(i.j.SelectionTempState).pipe((0,f.p)(c,void 0,a)).subscribe((function(t){e.update(i.j.SelectionState,t)})),e.get(i.j.FocusState).pipe(function(e,t){var n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new p(e,t,n))}}((function(e,t){return Object.assign(Object.assign({},e),t)}),{})).subscribe((function(e){o.info=e}))}return e.prototype.initializeSurfaceInDefaultGrid=function(){this.gridService.initializeDefaultGrid(),this.schema=this.compose(this.gridService.getGrid(_)),this.float=this.compose(this.gridService.getGrid(C)),this.store.register(i.j.FloatSurfaceStyle,E),this.store.register(i.j.Surface,this.schema),this.store.register(i.j.FloatSurface,this.float)},e.prototype.compose=function(e){var t,n,r=this;return{id:e.id,type:e.type,grids:null===(t=e.grids)||void 0===t?void 0:t.filter((function(e){return!!r.gridService.hasGrid(e)})).map((function(e){return r.compose(r.gridService.getGrid(e))})),surfaces:null===(n=e.surfaces)||void 0===n?void 0:n.map((function(e){return r.get(e)})),current:e.current,stackCurrent:e.stackCurrent}},e.prototype.get=function(e){var t;return null!==(t=this.config.get(e))&&void 0!==t?t:null},e.prototype.getGrid=function(e){return this.gridService.getGrid(e)},e.prototype.update=function(){this.schema=this.compose(this.gridService.getGrid(_)),this.store.get(i.j.Surface).next(this.schema),this.float=this.compose(this.gridService.getGrid(C)),this.store.get(i.j.FloatSurface).next(this.float)},e.prototype.onFocus=function(e){var t=this.get(e),n=this.store.getValue(i.j.FocusState);(null==n?void 0:n.current)===t&&n.focused||(this.store.update(i.j.FocusState,{focused:!0,current:t}),this.forceUpdate())},e.prototype.getCurrent=function(){var e,t=this.store.getValue(i.j.FocusState);if(null==t?void 0:t.focused)return null!==(e=t.current)&&void 0!==e?e:void 0},e.prototype.setCurrent=function(e){var t=this;return new Promise((function(n){var r,o,i=null===(r=t.get(e))||void 0===r?void 0:r.grid;if(!i)return v.r.warn("gridId not exist"),n(void 0);var a=t.gridService.getGrid(i);if(!a)return v.r.warn("grid not exist"),n(void 0);if(a.current&&a.current!==e){var s=t.getEditor(a.current),c=t.getAdapter(a.current);null==c||c.requestBlur(s)}a.current=e,t.traverseVisibility(e),t.onFocus(e),null===(o=t.config.get(e))||void 0===o||o.stream.pipe((0,g.P)()).subscribe((function(){var r=t.getEditor(e),o=t.getAdapter(e);null==o||o.requestFocus(r),n(e)})),t.update()}))},e.prototype.traverseVisibility=function(e){var t,n,r=this,o=e,i=this.getGridOfSurface(e);null===(t=null==i?void 0:i.surfaces)||void 0===t||t.forEach((function(e){var t=r.config.get(e);t&&(t.visible=!1)}));do{(n=this.config.get(o))&&(this.changeSurfaceVisibility(!0,n),o=n.virtualParent)}while(o);this.updateStackCurrentForStackGrid(e)},e.prototype.changeSurfaceVisibility=function(e,t){var n,r=this;t.visible=e,null===(n=t.virtualSurfaces)||void 0===n||n.forEach((function(t){var n=r.config.get(t);n&&r.changeSurfaceVisibility(e,n)}))},e.prototype.updateStackCurrentForStackGrid=function(e){for(var t=this.getGridOfSurface(e),n=null==t?void 0:t.id;null==t?void 0:t.parent;){if(n=t.id,!(t=this.gridService.getGrid(null==t?void 0:t.parent)))return;t.current=e,"stack"===t.type&&(t.stackCurrent=n)}},e.prototype.onBlur=function(e){var t,n;e===(null===(t=this.info.current)||void 0===t?void 0:t.id)&&(n=e?this.get(e):this.info.current,this.store.update(i.j.FocusState,{focused:!1,current:n}))},e.prototype.newGridId=function(){return"grid-".concat((0,s.D)())},e.prototype.newSurfaceId=function(){return"surface-".concat((0,s.D)())},e.prototype.createSync=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var o,i=void 0,a={gridType:"horizontal"};if(t.length>0&&"string"==typeof t[0]){var s=(0,r.__read)(t,4),c=s[0],l=void 0===c?"horizontal":c,u=s[1],d=s[2],p=s[3];o=p,a=this.getModeOptions(l,u,d)}else t.length>0&&"object"==typeof t[0]&&(a=(e=(0,r.__read)(t,2))[0],o=e[1]);if(a&&((0,b.Y4)(a)||(0,b.D)(a)))i=this.createGridSync(a,o);else if(a&&(0,b.PQ)(a))i=this.createStackSync(a,o);else if(a&&(0,b.Qd)(a))i=this.createFloatSync(a,o);else if(a&&(0,b.jJ)(a)){var h=a;i=this.createVirtualSync(h,o)}if(i)return this.traverseVisibility(i.id),this.update(),i},e.prototype.getModeOptions=function(e,t,n){var r,o,i;return t&&(i=null===(o=null===(r=this.gridService.getGrid(t))||void 0===r?void 0:r.surfaces)||void 0===o?void 0:o[0]),"horizontal"===e||"vertical"===e?{gridType:e,target:i}:"float"===e?{gridType:"float",isNewFloat:!1,floatStyle:n}:"stack"===e?{gridType:"stack",target:i}:void 0},e.prototype.create=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return(t=this.createSync.apply(this,(0,r.__spreadArray)([],(0,r.__read)(e),!1)))?y.s?[2,Promise.resolve(Object.assign({},t))]:[4,this.waitForSurfaceRender(t)]:[2,Promise.reject()];case 1:return n.sent(),[2,Promise.resolve(t)]}}))}))},e.prototype.waitForSurfaceRender=function(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,n;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return null===(t="string"==typeof(o=e).id&&"string"==typeof o.grid&&void 0!==o.stream?e:this.get(e))?[2,Promise.reject("surface id not exist")]:[4,new Promise((function(e){return null==t?void 0:t.stream.pipe((0,g.P)()).subscribe((function(t){e(t)}))}))];case 1:return n=r.sent(),t.dom=n,[2,t]}var o}))}))},e.prototype.getGridOfSurface=function(e){var t=this.config.get(e);if(t)return this.gridService.getGrid(t.grid)},e.prototype.newSurfaceConfig=function(e,t){return{id:this.newSurfaceId(),grid:null!=e?e:this.newGridId(),stream:new c.t,ssrChildren:t,focusStream:new l.X(!1),visible:!1}},e.prototype.createGridSync=function(e,t){var n=_;if(e.target){var r=this.getGridOfSurface(e.target);if(!r)return void v.r.error("Target grid ".concat(e.target," does not exist."));n=r.id}if(this.gridService.hasGrid(n)){var o=this.newSurfaceConfig(n,t);return this.gridService.addToGrid(n,o,e.gridType),this.config.set(o.id,o),o}v.r.error("Target grid ".concat(n," does not exist."))},e.prototype.createStackSync=function(e,t){var n,r,o,i,a=this.getGridOfSurface(null!==(o=null!==(n=e.target)&&void 0!==n?n:null===(r=this.info.current)||void 0===r?void 0:r.id)&&void 0!==o?o:_);if(!e.target||a){var s=null!==(i=null==a?void 0:a.id)&&void 0!==i?i:_,c=this.newSurfaceConfig(s,t);return this.gridService.addToGrid(s,c),this.config.set(c.id,c),c}v.r.error("Target grid ".concat(e.target," does not exist."))},e.prototype.createFloatSync=function(e,t){var n,r=this.newSurfaceConfig(C,t);return this.gridService.addToFloatGrid(r,e.isNewFloat),this.config.set(r.id,r),r.grid===C&&(this.floatStyle=null!==(n=e.floatStyle)&&void 0!==n?n:{}),r},e.prototype.createVirtualSync=function(e,t){var n,r,o,i=_;e.target&&(i=null!==(n=null==(o=this.config.get(e.target))?void 0:o.grid)&&void 0!==n?n:_);var a=this.newSurfaceConfig(i,t);return this.gridService.addToGrid(i,a),a.targetDom=e.targetDom,a.virtualParent=null==o?void 0:o.id,o&&!(null==o?void 0:o.virtualSurfaces)&&(o.virtualSurfaces=[]),null===(r=null==o?void 0:o.virtualSurfaces)||void 0===r||r.push(a.id),this.config.set(a.id,a),a},Object.defineProperty(e.prototype,"floatStyle",{set:function(e){this.store.update(i.j.FloatSurfaceStyle,Object.assign(Object.assign({},E),e))},enumerable:!1,configurable:!0}),e.prototype.close=function(e){this.closeSurface(e),this.update(),this.forceUpdate()},e.prototype.closeSurface=function(e){var t,n,r,o=this.get(e);if(o){var i=this.gridService.getGrid(o.grid);if(i&&i.surfaces){if(o.virtualParent){var a=this.config.get(o.virtualParent),s=null!==(n=null===(t=null==a?void 0:a.virtualSurfaces)||void 0===t?void 0:t.indexOf(e))&&void 0!==n?n:-1;s>0&&(null===(r=null==a?void 0:a.virtualSurfaces)||void 0===r||r.splice(s,1))}var c=i.surfaces.indexOf(o.id);c>=0&&(i.surfaces.splice(c,1),i.surfaces.length>0?(i.current=i.surfaces[Math.max(0,c-1)],i.stackCurrent=i.current,o.visible&&this.traverseVisibility(i.current)):this.gridService.deleteGrid(o.grid),this.closeAllChildSurface(o),this.destroyEditor(e),this.config.delete(e))}}},e.prototype.closeAllChildSurface=function(e){var t=this,n=this.gridService.getGrid(e.grid);n&&n.surfaces&&n.surfaces.forEach((function(n){var r=t.get(n);(null==r?void 0:r.virtualParent)===e.id&&t.closeSurface(r.id)}))},e.prototype.destroyEditor=function(e){var t=this.editorInfos.get(e);t&&(this.onBlur(e),t.adapter.destroy(t.editor),this.editorMap.delete(t.editor),this.editorInfos.delete(e))},e.prototype.addEditor=function(e,t,n){this.destroyEditor(e),this.editorInfos.set(e,{editor:t,adapter:n}),"object"==typeof t&&null!==t&&this.editorMap.set(t,e)},e.prototype.getEditor=function(e){var t,n;return e&&null!==(n=null===(t=this.editorInfos.get(e))||void 0===t?void 0:t.editor)&&void 0!==n?n:null},e.prototype.getAdapter=function(e){var t,n;return e&&null!==(n=null===(t=this.editorInfos.get(e))||void 0===t?void 0:t.adapter)&&void 0!==n?n:null},e.prototype.getSurfaceId=function(e){return this.editorMap.get(e)},Object.defineProperty(e.prototype,"editors",{get:function(){return(0,r.__spreadArray)([],(0,r.__read)(this.editorInfos.values()),!1)},enumerable:!1,configurable:!0}),e.prototype.forceUpdate=function(){u.Am.emitOn("$forceUpdate",(function(e){return"service"===e.type}))},e}();x=(0,r.__decorate)([(0,a.t)({overridable:!0}),(0,r.__metadata)("design:paramtypes",[o.O,w])],x)},42413:function(e,t,n){n.d(t,{D:function(){return u},Kk:function(){return p},PQ:function(){return d},Qd:function(){return c},Y4:function(){return l},jJ:function(){return s}});var r=n(85556),o=n(87363),i=n.n(o),a=n(75611);function s(e){return"virtual"===e.surfaceType}function c(e){return"float"===e.gridType}function l(e){return"horizontal"===e.gridType}function u(e){return"vertical"===e.gridType}function d(e){return"stack"===e.gridType}var p=i().createContext({evaluateWithContext:function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return a.k.apply(void 0,(0,r.__spreadArray)([e,t],(0,r.__read)(n),!1))}})},15315:function(e,t,n){n.d(t,{M:function(){return y}});var r=n(85556),o=n(99221),i=n(52571),a=n(37769),s=n(2002),c=n(4211),l=n(77947),u=n(3056),d=n(58483),p=n(3422),h=n(47408),f=n(78963),g=[{name:"divider",content:null,priority:1/0},{name:"pusher",content:null,priority:1/0}],v=g.map((function(e){return e.name})),y=function(e){function t(t,n){var r=e.call(this)||this;return r.store=t,r.transitionService=n,r.componentsWidth=new Map,r.calculatedWidth=new Map,r.calculatedVisible=new Map,r.widthBeforeSetMax=new Map,r.totalWidth=new u.X(0),r.containerWidth=0,r.schema=[],r.store.register(c.j.Titlebar,[]),r.store.register(c.j.TitlebarCalculatedWidth,{}),r.store.register(c.j.TitlebarShow,!0),r.store.register(c.j.TitlebarHover,!1),r.store.register(c.j.TitlebarListenMouseMove,!1),r.store.register(h.R.DisableTitlebar,!1).subscribe((function(e){r.store.upsert(c.j.TitlebarDOMVisible,!e)})),g.forEach((function(e){r.configs.set(e.name,e)})),r.totalWidth.pipe((0,d.b)(r.debounceTime)).subscribe(r.calculate.bind(r)),r.transitionService.register(s.v.TITLEBAR,{duration:150,entered:{},entering:{transform:"translateY(0)",transition:"all linear 0.15s"},exited:{position:"fixed",transform:"translateY(-100%)",height:0},exiting:{height:0,transform:"translateY(-100%)",transition:"all linear 0.15s"}}),r}return(0,r.__extends)(t,e),t.prototype.updateWidth=function(e,t,n){var r=this;this.componentsWidth.set(e.name,[t,n]),this.resetLastTimeWidth(e.name);var o=this.reduceSchema().reduce((function(e,t){var n=r.componentsWidth.get(t.name);return n?e+n[0]+n[1]:e}),0);this.totalWidth.next(o)},t.prototype.updateContainerWidth=function(e){this.containerWidth=e,this.calculate()},t.prototype.$forceUpdate=function(){this.forceUpdateWithStore(this.store,c.j.Titlebar)},t.prototype.isContinuousShrinkComponent=function(e){return"continuous"===e.shrinkable&&void 0!==e.widthRange},t.prototype.isStepsShrinkComponent=function(e){var t,n;return"steps"===e.shrinkable&&(null!==(n=null===(t=e.shrinkSteps)||void 0===t?void 0:t.length)&&void 0!==n?n:0)>0},t.prototype.needToUpdateMaxWidth=function(e){var t=this.widthBeforeSetMax.get(e);if(!t)return!0;var n=t.width;if(t.count<=3)return t.count+=1,!0;var r=this.componentsWidth.get(e),o=n;return o[0]!==(null==r?void 0:r[0])||o[1]!==(null==r?void 0:r[1])},t.prototype.updateLastWidthToCurrent=function(e){var t,n;this.widthBeforeSetMax.set(e,{width:null!==(t=this.componentsWidth.get(e))&&void 0!==t?t:[0,0],count:(null===(n=this.widthBeforeSetMax.get(e))||void 0===n?void 0:n.count)||0})},t.prototype.resetLastTimeWidth=function(e){var t=this.widthBeforeSetMax.get(e);t&&(t.count=0)},t.prototype.expand=function(e){var t=this,n=this.getConfigMapDividedByGroup();if(this.calculatedWidth.size>0||this.calculatedVisible.size>0){var o=(0,r.__spreadArray)([],(0,r.__read)(this.calculatedVisible.entries()),!1).filter((function(e){return!1===(0,r.__read)(e,2)[1]})).map((function(e){var t=(0,r.__read)(e,1)[0];return n.get(t)})).sort((function(e,t){var n,r;return(null!==(n=t.priority)&&void 0!==n?n:0)-(null!==(r=e.priority)&&void 0!==r?r:0)})).reduce((function(e,n){var o;if(e===t.containerWidth)return e;var i=(0,r.__read)(null!==(o=t.componentsWidth.get(n.name))&&void 0!==o?o:[0,0],2),a=i[0]+i[1];return e+a<=t.containerWidth?(t.calculatedVisible.delete(n.name),e+a):t.containerWidth}),e);(0,r.__spreadArray)([],(0,r.__read)(this.calculatedWidth.keys()),!1).map((function(e){return n.get(e)})).sort((function(e,t){var n,r;return(null!==(n=t.priority)&&void 0!==n?n:0)-(null!==(r=e.priority)&&void 0!==r?r:0)})).reduce((function(e,n){var o,i,a;if(e===t.containerWidth)return e;if(t.isContinuousShrinkComponent(n)){if(!t.needToUpdateMaxWidth(n.name))return e;var s=(0,r.__read)(n.widthRange,2)[1],c=(0,r.__read)(null!==(o=t.componentsWidth.get(n.name))&&void 0!==o?o:[0,0],1)[0],l=s-c;return t.updateLastWidthToCurrent(n.name),e+l>t.containerWidth?(t.calculatedWidth.set(n.name,t.containerWidth-e+c),t.containerWidth):(t.calculatedWidth.delete(n.name),e+l)}if(t.isStepsShrinkComponent(n)){var u=(0,r.__read)(n.shrinkSteps,1)[0],d=n.shrinkSteps.slice(-1).pop(),p=(0,r.__read)(null!==(i=t.componentsWidth.get(n.name))&&void 0!==i?i:[0,0],1)[0],h=null!==(a=(0,r.__spreadArray)([],(0,r.__read)(n.shrinkSteps),!1).filter((function(n){return e+(n-p)<=t.containerWidth})).pop())&&void 0!==a?a:u,f=p-h;return 0===f&&d!==h?t.containerWidth:(t.calculatedWidth.set(n.name,h),e+f)}return e}),o)}this.deliver()},t.prototype.shrink=function(e){var t=this,n=this.getConfigMapDividedByGroup(),o=new Map((0,r.__spreadArray)([],(0,r.__read)(this.calculatedWidth.entries()),!1));this.calculatedWidth.clear(),this.calculatedVisible.clear();var i=(0,r.__spreadArray)([],(0,r.__read)(n.values()),!1).filter((function(e){return e.shrinkable})).sort((function(e,t){var n,r;return(null!==(n=e.priority)&&void 0!==n?n:0)-(null!==(r=t.priority)&&void 0!==r?r:0)})).reduce((function(e,n){var i,a,s;if(e<=t.containerWidth)return o.has(n.name)&&t.calculatedWidth.set(n.name,o.get(n.name)),e;if(t.isContinuousShrinkComponent(n)){var c=(0,r.__read)(n.widthRange,1)[0],l=(0,r.__read)(null!==(i=t.componentsWidth.get(n.name))&&void 0!==i?i:[0,0],1)[0],u=l-c;return e-u<=t.containerWidth?(t.calculatedWidth.set(n.name,l-(e-t.containerWidth)),t.containerWidth):(t.calculatedWidth.set(n.name,c),e-u)}if(t.isStepsShrinkComponent(n)){var d=(0,r.__read)(n.shrinkSteps,1)[0],p=(0,r.__read)(null!==(a=t.componentsWidth.get(n.name))&&void 0!==a?a:[0,0],1)[0],h=null!==(s=(0,r.__spreadArray)([],(0,r.__read)(n.shrinkSteps),!1).reverse().find((function(n){return e-(p-n)<=t.containerWidth})))&&void 0!==s?s:d,f=p-h;return t.calculatedWidth.set(n.name,h),e-f}return e}),e);(0,r.__spreadArray)([],(0,r.__read)(n.values()),!1).sort((function(e,t){var n,r;return(null!==(n=e.priority)&&void 0!==n?n:0)-(null!==(r=t.priority)&&void 0!==r?r:0)})).reduce((function(e,n){var o,i;if(e<=t.containerWidth||!1===t.calculatedVisible.get(n.name)||!0===n.preventHide)return e;var a=(0,r.__read)(null!==(o=t.componentsWidth.get(n.name))&&void 0!==o?o:[0,0],2),s=a[0],c=a[1],l=(null!==(i=t.calculatedWidth.get(n.name))&&void 0!==i?i:s)+c;return t.calculatedVisible.set(n.name,!1),e-l}),i),this.deliver()},t.prototype.calculate=function(){var e=this,t=(0,r.__spreadArray)([],(0,r.__read)(this.calculatedVisible.entries()),!1).reduce((function(t,n){var o,i=(0,r.__read)(n,2),a=i[0];if(!1===i[1]){var s=(0,r.__read)(null!==(o=e.componentsWidth.get(a))&&void 0!==o?o:[0,0],2);return t-s[0]-s[1]}return t}),this.totalWidth.getValue());0===this.containerWidth||this.containerWidth>=t?this.expand(t):this.shrink(this.totalWidth.getValue())},t.prototype.deliver=function(){var e=this,t={};this.getConfigMapDividedByGroup().forEach((function(n){var r,o=e.getMaxWidth(n),i=null===(r=e.calculatedVisible.get(n.name))||void 0===r||r;t[n.name]={width:o,visible:i}})),this.store.update(c.j.TitlebarCalculatedWidth,t)},t.prototype.convertTitlebar=function(e){var t=[],n=[];return e.forEach((function(r,o){(0,f.g)(r)||"divider"!==r.name?(n.push(r),o===e.length-1&&t.push(n)):(t.push(n),n=[])})),t},t.prototype.onUpdate=function(){e.prototype.onUpdate.call(this);var t=this.convertTitlebar(this.reduceSchema());this.store.get(c.j.Titlebar).next(t)},t.prototype.reduceSchema=function(){return this.schema.reduce(this.readSchema.bind(this),[])},t.prototype.getConfigMapDividedByGroup=function(){var e=this.reduceSchema(),t=new Map;return e.forEach((function(e){return t.set(e.name,e)})),t},t.prototype.getMaxWidth=function(e){var t,n;return this.isContinuousShrinkComponent(e)?null!==(t=this.calculatedWidth.get(e.name))&&void 0!==t?t:e.widthRange[1]:this.isStepsShrinkComponent(e)?null!==(n=this.calculatedWidth.get(e.name))&&void 0!==n?n:e.shrinkSteps.slice(-1).pop():void 0},t.prototype.readSchema=function(e,t){var n=this;if(!(0,f.H)(t)){var r=this.get(t);return e.push(r),this.setPathToActionInfoInConfig(r),e}var o=this.get(t.key),i=t.items.map((function(e){return e.map((function(e){var t=Object.assign(Object.assign({},n.get(e)),{shrinkable:"continuous",widthRange:void 0});return n.setPathToActionInfoInConfig(t),t}))})).filter((function(e){return!!e.length})).map((function(e){return n.convertTitlebar(e)})),a=Object.assign(Object.assign({},o),{name:t.key,rows:i});return a.rows.length&&e.push(a),e},t.prototype.get=function(t){return e.prototype.get.call(this,t,{content:null,name:"none"})},t.prototype.mergeSchemaWithoutUpdate=function(e){this.schema=this.schema.concat(e)},t.prototype.register=function(t,n){void 0===n&&(n=!0),v.indexOf(t.name)>=0?i.r.warn('The titlebar config "'.concat(t.name,'" is reserved.')):e.prototype.register.call(this,t,n)},t.prototype.hide=function(){this.store.update(c.j.TitlebarShow,!1)},t.prototype.show=function(){this.store.update(c.j.TitlebarShow,!0)},t.prototype.toggle=function(){this.store.update(c.j.TitlebarShow,!this.isShowing())},t.prototype.isShowing=function(){return!!this.store.getValue(c.j.TitlebarShow)},t.prototype.enterHover=function(){this.setHoverActive(!0),this.store.update(c.j.TitlebarHover,!0)},t.prototype.exitHover=function(){this.setHoverActive(!1),this.store.update(c.j.TitlebarHover,!1)},t.prototype.setHoverActive=function(e){this.store.update(c.j.TitlebarListenMouseMove,e)},t.prototype.setActive=function(e){this.store.update(c.j.TitlebarFocus,e)},t}(o.C);y=(0,r.__decorate)([(0,a.t)({name:s.v.TITLEBAR}),(0,r.__metadata)("design:paramtypes",[l.O,p.Z])],y)},78963:function(e,t,n){function r(e){var t;return!!(null===(t=e)||void 0===t?void 0:t.rows)}function o(e){return"string"!=typeof e}n.d(t,{H:function(){return o},g:function(){return r}})},580:function(e,t,n){n.d(t,{J1:function(){return a},Vi:function(){return o},fh:function(){return r}});var r,o,i=n(58624);!function(e){e.PARTIAL_TAIL="partial-group-shrink-to-tail",e.PARTIAL_DIVIDER="partial-group-shrink-to-divider",e.OVERALL_TAIL="overall-group-shrink-to-tail",e.OVERALL_DIVIDER="overall-group-shrink-to-divider"}(r||(r={})),function(e){e.DEFAULT="normal-outline",e.INPUT="input-outline"}(o||(o={}));var a={LEFT:(0,i.w)("left"),CENTER:(0,i.w)("center")}},22703:function(e,t,n){n.d(t,{O:function(){return b}});var r=n(85556),o=n(37769),i=n(99221),a=n(77947),s=n(4211),c=n(580),l=n(2002),u=n(32673),d=n(3422),p=n(15012),h={"toolbar-animation":"toolbar-animation_toolbar-animation__6_OFz","single-to-double":"toolbar-animation_single-to-double__uXtWN","double-to-single":"toolbar-animation_double-to-single__W4LyD","fixed-toolbar-animation":"toolbar-animation_fixed-toolbar-animation__3HcTl","fade-out":"toolbar-animation_fade-out__1nRb9","fade-in":"toolbar-animation_fade-in__7_2rH","single-line":"toolbar-animation_single-line__3oIXx","double-line":"toolbar-animation_double-line__1hCeu"};(0,p.Z)(".toolbar-animation_toolbar-animation__6_OFz {\n  position: relative;\n  overflow: hidden;\n  transition-duration: 0.35s !important;\n  transition-property: height !important;\n}\n.toolbar-animation_toolbar-animation__6_OFz.toolbar-animation_single-to-double__uXtWN {\n  transition-timing-function: cubic-bezier(0.25, 0.1, 0.25, 1);\n}\n.toolbar-animation_toolbar-animation__6_OFz.toolbar-animation_double-to-single__W4LyD {\n  transition-timing-function: cubic-bezier(0.42, 0, 0.58, 1);\n}\n.toolbar-animation_fixed-toolbar-animation__3HcTl {\n  position: absolute !important;\n  top: 0 !important;\n  width: 100% !important;\n  z-index: 1301 !important;\n  opacity: 1;\n  pointer-events: none !important;\n}\n.toolbar-animation_fade-out__1nRb9 {\n  opacity: 0 !important;\n  transition-duration: 0.2s !important;\n  transition-property: opacity  !important;\n  transition-timing-function: cubic-bezier(0.42, 0, 0.58, 1);\n}\n.toolbar-animation_fade-in__7_2rH {\n  opacity: 1 !important;\n  transition-delay: 0.1s !important;\n  transition-property: opacity !important;\n}\n.toolbar-animation_fade-in__7_2rH.toolbar-animation_single-line__3oIXx {\n  transition-duration: 0.2s;\n  transition-timing-function: cubic-bezier(0.42, 0, 0.58, 1);\n}\n.toolbar-animation_fade-in__7_2rH.toolbar-animation_double-line__1hCeu {\n  transition-duration: 0.3s;\n  transition-timing-function: cubic-bezier(0.42, 0, 0.58, 1);\n}\n");var f="fixed-toolbar-re-render",g="toolbar-normal",v=n(3139),y=n(81758),m=n(47408),b=function(e){function t(t,n){var r=e.call(this)||this;r.store=t,r.transitionService=n,r.isEditable=!0,r.force=0,r.ToolbarGroupToItems=new Map,r.UIToToolbarGroupItem=new Map,r.shelterToToolbarGroupItemConfig=new Map,r.store.register(s.j.FixToolbarShow,!0),r.store.register(s.j.ToolbarEvent,{target:"none",type:"dropdownClose"}),r.store.register(s.j.ToolbarDropdownEvent,{target:"none",type:"dropdownClose"}),r.store.register(s.j.isFocusedByClick,!0),r.store.register(m.R.DisableToolbar,!1).subscribe((function(e){r.store.upsert(s.j.FixToolbarDOMVisible,!e)})),r.schema={"toolbar-normal":{data:[]},"toolbar-pinned":{data:[]}};var o=r.getTakeUpSpaceHeight();return r.transitionService.register("fixed-toolbar",{duration:150,entered:{},entering:{transform:"translateY(0)",transition:"all linear 0.15s"},exited:{transition:"all linear 0.15s",position:"fixed",transform:"translateY(calc(-100% - ".concat(o,"px))"),height:o},exiting:{transform:"translateY(calc(-100% - ".concat(o,"px))"),transition:"all linear 0.15s",height:o}}),r}return(0,r.__extends)(t,e),t.prototype.onUpdate=function(){var t=this;e.prototype.onUpdate.call(this),Object.entries(this.schema).forEach((function(e){var n=(0,r.__read)(e,2),o=n[0],i=n[1];t.key=o;var a=Object.assign(Object.assign({},i),{data:i.data.reduce(t.getToolbarGroupConfigs.bind(t),[])});t.store.has(o)?t.store.get(o).next(a):t.store.register(o,a)}))},t.prototype.setSchema=function(t,n){var o=this;Object.entries(t).forEach((function(e){var t=(0,r.__read)(e,2)[1];t.data=t.data.reduce(o.amendToolbarGroupSchema.bind(o),[])}));var i=function(){e.prototype.setSchema.call(o,t)},a=function(){n&&o.settings.set("toolbar.alignment",n)};if(!this.store.getValue(m.R.ToolbarSchemaAnimation))return i(),void a();!function(e,t,n){var r,o,i=document.getElementById("fixed-toolbar-animation"),a=document.getElementById("fixed-toolbar"),c=document.getElementById("workbench-toolbar"),l=e.getValue(s.j.FixToolbarShow)&&e.getValue(s.j.FixToolbarDOMVisible);if(!(c&&a&&i&&l))return t(),void n();var u=null!==(o=null===(r=e.getValue("".concat(s.j.MultiLineToolbarContainer,"-").concat(g)))||void 0===r?void 0:r.toolbarRows)&&void 0!==o?o:1,d=a.getBoundingClientRect().height;c.style.height="".concat(d,"px"),i.style.height="".concat(d,"px"),i.classList.remove(h["fade-out"]),a.classList.remove(h["fade-in"]),c.classList.add(h["toolbar-animation"]),i.classList.add(h["fixed-toolbar-animation"]),i.innerHTML="";var p=a.children[0].cloneNode(!0),v=i.className;i.className="".concat(v," ").concat(a.className),p&&i.appendChild(p),a.style.opacity="0";var y=function(){var t,n,r=e.getValue("".concat(s.j.MultiLineToolbarContainer,"-").concat(g,"-height")),o=null!==(n=null===(t=e.getValue("".concat(s.j.MultiLineToolbarContainer,"-").concat(g)))||void 0===t?void 0:t.toolbarRows)&&void 0!==n?n:1,l=2===o?"double-line":"single-line";a.classList.add(h[l]);var d=2===o&&1===u?"double-to-single":"single-to-double";c.classList.add(h[d]),c.style.height="".concat(r,"px"),a.style.opacity="1",i.classList.add(h["fade-out"]),a.classList.add(h["fade-in"]),setTimeout((function(){c.classList.remove(h["toolbar-animation"]),c.style.height="",a.classList.remove(h["fade-in"]),a.classList.remove(h[l]),c.classList.remove(h[d]),i.innerHTML="",window.removeEventListener(f,y),i.className="",i.style.height=""}),1e3)};window.addEventListener(f,y),t(),n()}(this.store,i,a)},t.prototype.amendToolbarGroupSchema=function(e,t,n){var r="TG_".concat(n,"_").concat((0,u.D)());return this.ToolbarGroupToItems.set(r,[]),e.push(Array.isArray(t)?{key:r,items:t.reduce(this.amendToolbarGroupItemSchema.bind(this,r),[])}:Object.assign(Object.assign({},t),{key:r,items:t.items.reduce(this.amendToolbarGroupItemSchema.bind(this,r),[])})),e},t.prototype.amendToolbarGroupItemSchema=function(e,t,n,r){var o="VG_".concat(r,"_").concat((0,u.D)());return this.ToolbarGroupToItems.get(e).push(o),"string"==typeof n?t.push({key:o,shelter:null,buttons:[[n]]}):Array.isArray(n)?t.push({key:o,shelter:null,buttons:n}):t.push(Object.assign(Object.assign({},n),{key:o})),t},t.prototype.mergeSchemaWithoutUpdate=function(e){var t=this;this.schema=Object.assign({},this.schema),Object.entries(this.schema).forEach((function(n){var o=(0,r.__read)(n,2),i=o[0],a=o[1];t.schema[i]=Object.assign(Object.assign(Object.assign({},a),e[i]),{data:e[i]?a.data.concat(e[i].data.reduce(t.amendToolbarGroupSchema.bind(t),[])):(0,r.__spreadArray)([],(0,r.__read)(a.data),!1)})})),this.schema=Object.assign(Object.assign({},e),this.schema)},t.prototype.getToolbarGroupConfigs=function(e,t){var n=t.items.reduce(this.getToolbarGroupItemConfigs.bind(this),[]);if(this.checkToolbarGroupItemShelter(),n.length>0){var r=t.shelter?this.getShelter(t.shelter):null,o=t.shrinkType,i=void 0===o?c.fh.PARTIAL_TAIL:o,a=t.key,s=this.getShrinkSteps(a,i,t.shrinkSteps),l=this.getPriority(i,s,t.priority),u=Object.assign(Object.assign({key:"",shrinkType:c.fh.PARTIAL_TAIL,shouldMerge:!1},t),{shrinkSteps:s,priority:l,shelter:r,items:n});e.push(u)}return this.UIToToolbarGroupItem.clear(),this.shelterToToolbarGroupItemConfig.clear(),e},t.prototype.getToolbarGroupItemConfigs=function(e,t){var n=this,r=t.key,o=t.shelter,i=t.buttons,a=null==i?void 0:i.reduce((function(e,t){var o=t.reduce(n.getButtons.bind(n,r),[]);return o.length>0&&e.push(o),e}),[]);if((null==a?void 0:a.length)>0){var s=!o||this.UIToToolbarGroupItem.has(o)&&this.UIToToolbarGroupItem.get(o)!==o?null:this.getShelter(o),c=Object.assign(Object.assign({key:""},t),{shelter:s,buttons:a});return o&&s&&(this.UIToToolbarGroupItem.set(o,o),this.shelterToToolbarGroupItemConfig.set(o,c)),e.concat(c)}return e},t.prototype.getButtons=function(e,t,n){if(this.UIToToolbarGroupItem.set(n,e),this.hasConfig(n)){var r=this.get(n);return this.setPathToActionInfoInConfig(r,[this.key]),t.concat(r)}return t},t.prototype.getShelter=function(e){if(this.hasConfig(e)){var t=this.get(e);return this.setPathToActionInfoInConfig(t,[this.key]),t}return null},t.prototype.checkToolbarGroupItemShelter=function(){var e,t,n=(0,r.__spreadArray)([],(0,r.__read)(this.UIToToolbarGroupItem.keys()),!1),o=(0,r.__spreadArray)([],(0,r.__read)(this.UIToToolbarGroupItem.values()),!1);try{for(var i=(0,r.__values)(this.shelterToToolbarGroupItemConfig),a=i.next();!a.done;a=i.next()){var s=(0,r.__read)(a.value,2),c=s[0],l=s[1];n.includes(c)&&!o.includes(c)&&(l.shelter=null,this.shelterToToolbarGroupItemConfig.delete(c))}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},t.prototype.getShrinkSteps=function(e,t,n){var o=this,i=[this.ToolbarGroupToItems.get(e).concat((0,r.__spreadArray)([],(0,r.__read)(this.shelterToToolbarGroupItemConfig.keys()),!1))];if(t===c.fh.OVERALL_DIVIDER||t===c.fh.OVERALL_TAIL)return i;var a=this.ToolbarGroupToItems.get(e).reduce((function(e,t){return e.concat([[t]])}),[]).reverse();if(!n)return a;var s=[],l=n.map((function(e){return e.reduce((function(e,t){var n=o.UIToToolbarGroupItem.get(t);return n&&!s.includes(n)&&(e.push(n),s.push(n)),e}),[])})).filter((function(e){return e.length}));return l.length?l:a},t.prototype.getTakeUpSpaceHeight=function(){var e=this.store.getValue(m.R.TitlebarHoverable),t=this.store.getValue("titlebar.height");return e&&"boolean"!=typeof e&&e.takeUpSpace?e.takeUpSpaceHeight?e.takeUpSpaceHeight:t/3:0},t.prototype.getPriority=function(e,t,n){if(e===c.fh.OVERALL_DIVIDER||e===c.fh.OVERALL_TAIL)return null!=n?n:[0];var r=new Array(t.length).fill(0);if(!n)return r;var o=t.length-n.length;return o<=0?n.slice(0,t.length):n.concat(new Array(o).fill(0))},t.prototype.get=function(t){return e.prototype.get.call(this,t,{name:"none",type:"icon",tooltip:"",onClick:function(){}})},t.prototype.$forceUpdate=function(){this.force+=1,this.onUpdate()},t.prototype.setEditable=function(e){this.isEditable=e,this.$forceUpdate()},t.prototype.getEditable=function(){return this.isEditable},t}(i.C);(0,r.__decorate)([(0,v.tB)(),(0,r.__metadata)("design:type",y.I)],b.prototype,"settings",void 0),b=(0,r.__decorate)([(0,o.t)({overridable:!0,scope:"ui:service",name:l.v.TOOLBAR}),(0,r.__metadata)("design:paramtypes",[a.O,d.Z])],b)},3422:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(85556),o=n(37769),i=n(77947),a=function(){function e(e){this.store=e,this.transitions=new Map}return e.prototype.register=function(e,t){this.transitions.set(e,t);var n="transition.trigger.".concat(e);this.store.has(n)||this.store.register(n,!0)},e.prototype.get=function(e){var t;return null!==(t=this.transitions.get(e))&&void 0!==t?t:{entering:{},entered:{},exiting:{},exited:{},duration:0}},e.prototype.apply=function(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,n,o,i,a,s,c;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return(t=e.shift())?(n=t.name,o=t.switchTo,i=t.force,a=this.get(n),s=a.duration,c="transition.trigger.".concat(n),this.store.getValue(c)!==o||i?[3,2]:[4,this.apply(e)]):[2];case 1:case 4:return r.sent(),[2];case 2:return this.store.update(c,o),[4,new Promise((function(e){return setTimeout(e,s)}))];case 3:return r.sent(),[4,this.apply(e)]}}))}))},e}();a=(0,r.__decorate)([(0,o.t)(),(0,r.__metadata)("design:paramtypes",[i.O])],a)},27535:function(e,t,n){n.d(t,{U:function(){return o},s:function(){return r}});var r="undefined"==typeof window||window.WorkbenchSSR,o=void 0!==n.g&&n.g.Math===Math?n.g:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")()},50442:function(e,t,n){n.d(t,{S:function(){return a}});var r=n(85556),o=n(87363),i=n(52571),a=function(e){function t(){var t=e.apply(this,(0,r.__spreadArray)([],(0,r.__read)(arguments),!1))||this;return t.state={error:!1},t}return(0,r.__extends)(t,e),t.getDerivedStateFromError=function(){return{error:!0}},t.prototype.componentDidCatch=function(e){i.r.fatal(e.message)},t.prototype.render=function(){return this.state.error?null:this.props.children},t}(o.Component)},58624:function(e,t,n){n.d(t,{w:function(){return r}});var r=function(e){return e}},51506:function(e,t,n){n.d(t,{A2:function(){return s},hQ:function(){return i},hr:function(){return a}});var r=n(3139),o=n(66624);function i(e){return e instanceof r.RU||e instanceof o.RU}function a(e){return e instanceof r.RU?!!e.loaded:!!e.instance}function s(e){return e instanceof r.RU?e.load():e.getInstance()}},70230:function(e,t,n){n.d(t,{w:function(){return r}});var r=function(){function e(){}return e.isMobile=function(){return/(mobile)/i.test(navigator.userAgent)},e.isAndroid=function(){return/(android)/i.test(navigator.userAgent)},e.isIOS=function(){return/(iphone|ipad|ipod)/i.test(navigator.userAgent)},e.isIPad=function(){return/(ipad)/i.test(navigator.userAgent)},e.isMac=function(){return!this.isMobile()&&/Mac OS X/i.test(navigator.userAgent)},e.isFireFox=function(){return/firefox/i.test(navigator.userAgent)},e.isIE=function(){return/msie/i.test(navigator.userAgent)&&!this.isOpera()||/trident/i.test(navigator.userAgent)},e.isOpera=function(){return/opera/i.test(navigator.userAgent)},e.isChrome=function(){return/chrome/i.test(navigator.userAgent)},e.getChromeVersion=function(){var e=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return e?parseInt(e[2],10):0},e.isTencentDocsApp=function(){return/TencentDocs/i.test(navigator.userAgent)},e.isTencentDocsIPadApp=function(){return this.isIPad()&&this.isTencentDocsApp()},e.isMiniProgram=function(){return/miniprogram|miniapp(?!enable)/i.test(navigator.userAgent)||void 0!==window.__wxjs_environment&&"miniprogram"===window.__wxjs_environment},e.isWXMiniProgram=function(){return/MicroMessenger/i.test(navigator.userAgent)&&this.isMiniProgram()},e.isQQMiniProgram=function(){return/QQ\/|TIM/i.test(navigator.userAgent)&&this.isMiniProgram()},e}()},32673:function(e,t,n){function r(){return Math.random().toString(36).substr(2,6)}n.d(t,{D:function(){return r}})},36084:function(e,t,n){var r,o,i,a;window,e.exports=(r=n(86667),o=n(90698),i=n(5593),a=n(35831),function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t){e.exports=r},function(e,t){e.exports=o},function(e,t){e.exports=i},function(e,t){e.exports=a},function(e,t,n){n.r(t),n.d(t,"canReadPlainSilent",(function(){return ie})),n.d(t,"canReadHtmlSilent",(function(){return ae})),n.d(t,"readInClipBoard",(function(){return se})),n.d(t,"isNeedClipboardPermission",(function(){return ce})),n.d(t,"writeInClipBoard",(function(){return le})),n.d(t,"mqqCopyPaste",(function(){return m})),n.d(t,"qqminiCopyPaste",(function(){return j})),n.d(t,"wxRTFCopyPaste",(function(){return A})),n.d(t,"weWorkCopyPaste",(function(){return P})),n.d(t,"wemeetCopyPaste",(function(){return x})),n.d(t,"defaultCopyPaste",(function(){return b})),n.d(t,"plainCopyPaste",(function(){return _})),n.d(t,"readWXRTFClipboard",(function(){return L})),n.d(t,"writeWXRTFClipboard",(function(){return N})),n.d(t,"isSupportWXRTF",(function(){return D})),n.d(t,"writeWeworkClipboard",(function(){return k})),n.d(t,"readWeworkClipboard",(function(){return O})),n.d(t,"isNeedPermission",(function(){return Z})),n.d(t,"tdocsCopyPaste",(function(){return J})),n.d(t,"navClipboardCopyPaste",(function(){return Q})),n.d(t,"weDriveMiniCopyPaste",(function(){return ne})),n.d(t,"readWeDriveMiniClipboard",(function(){return re})),n.d(t,"isSupportWeDriveMini",(function(){return te}));var r,o=n(0),i=n.n(o),a=/(tencent_wemeet)/i.test(navigator.userAgent)&&i.a.isMobile,s=/(wxwork)/i.test(navigator.userAgent)&&i.a.isMobile,c=("function"!=typeof Window&&/\.js$/.test(window.location.pathname),s&&/(wdocs\/)/i.test(navigator.userAgent));!function(e){e[e.NULL=0]="NULL",e[e.TEXT_ONLY=1]="TEXT_ONLY",e[e.TEXT_HTML=2]="TEXT_HTML"}(r||(r={}));var l,u,d,p,h={};if("undefined"!=typeof document&&document.addEventListener){h={copy:function(){throw Error("Unable to copy. Perhaps it's not available in your browser?")},paste:function(){throw Error("Unable to paste. Perhaps it's not available in your browser?")}};try{h.copy=function(){function e(){t=!1,n=null,r&&window.getSelection().removeAllRanges(),r=!1}var t=!1,n=null,r=!1,o=!1;return function(i){return o||(document.addEventListener("copy",(function(e){if(t){for(var r in n)try{e.clipboardData.setData(r,n[r])}catch(r){console.error(r)}e.preventDefault()}})),o=!0),new Promise((function(o,a){t=!0,n="string"==typeof i?{"text/plain":i}:i instanceof Node?{"text/html":(new XMLSerializer).serializeToString(i)}:i;try{var s=document.getSelection();if(!document.queryCommandEnabled("copy")&&s.isCollapsed){var c=document.createRange();c.selectNodeContents(document.body),s.addRange(c),r=!0}if(!document.execCommand("copy"))throw Error("Unable to copy. Perhaps it's not available in your browser?");e(),o()}catch(t){e(),a(t)}}))}}(),h.paste=(d=!1,p=!1,function(e){return p||(document.addEventListener("paste",(function(e){if(d){d=!1,e.preventDefault();var t=l;l=null,t(e.clipboardData.getData(u))}})),p=!0),new Promise((function(t,n){d=!0,l=t,u=e||"text/plain";try{document.execCommand("paste")||(d=!1,n(Error("Unable to paste. Pasting only works in Internet Explorer at the moment.")))}catch(e){d=!1,n(Error(e))}}))}),"undefined"==typeof ClipboardEvent&&void 0!==window.clipboardData&&void 0!==window.clipboardData.setData&&(h.copy=function(e){return new Promise((function(t,n){if("string"!=typeof e&&!("text/plain"in e))throw Error("You must provide a text/plain type.");window.clipboardData.setData("Text","string"==typeof e?e:e["text/plain"])?t():n(Error("Copying was rejected."))}))},h.paste=function(){return new Promise((function(e,t){var n=window.clipboardData.getData("Text");n?e(n):t(Error("Pasting was rejected."))}))})}catch(e){console.error(e)}}else h={copy:function(){throw Error("Unable to copy. Perhaps it's not available in your browser?")},paste:function(){throw Error("Unable to paste. Perhaps it's not available in your browser?")}};var f,g=h,v=function(){function e(e,t){this.timer=e,this.done=!1,this.callback=function(){},this.frames=t/e.interval|0}return e.prototype.setFrame=function(e){this.frames=e,0!==this.frames&&(this.frames=Number.isInteger(this.frames)?this.frames:1+(0|this.frames))},e.prototype.run=function(e){return this.callback=e,this.setFrame(this.frames+this.timer.currFrame),this.timer.push(this),this},e.prototype.stop=function(){this.timer.erase(this)},e}(),y=new(function(){function e(){this.zeroFrameDone=!1,this.times=0,this.started=!1,this.interval=500,this.t=null,this.cache={},this.currFrame=0,this.maxFrame=0}return e.prototype.pause=function(){clearInterval(this.t)},e.prototype.restart=function(){this.started=!1,this.start()},e.prototype.clear=function(){this.cache={},this.started=!1,this.currFrame=0,this.maxFrame=0,clearInterval(this.t),this.t=null},e.prototype.execNextFrame=function(){var e;if(this.currFrame>this.maxFrame)return this.clear();var t=this.cache[this.currFrame];if(t){t.forEach((function(e){if(e){e.done=!0;try{e.callback&&e.callback()}catch(e){console.error(e),console.log&&console.error(e.stack)}}e=null}));var n=t.filter((function(e){return!e.done}));n.length&&(this.cache[this.currFrame+1]||(this.cache[this.currFrame+1]=[]),(e=this.cache[this.currFrame+1]).push.apply(e,n),this.maxFrame++),delete this.cache[this.currFrame]}},e.prototype.push=function(e){this.cache[e.frames]||(this.cache[e.frames]=[]),this.cache[e.frames].push(e),this.maxFrame=Math.max(this.maxFrame,e.frames),this.start()},e.prototype.erase=function(e){if(e){var t=e.frames;if(void 0!==this.cache[t]){var n=this.cache[t].indexOf(e);n>-1&&this.cache[t].splice(n,1)}}},e.prototype.wait=function(e){return new v(this,e)},e.prototype.start=function(){var e=this;if(!this.started){if(this.started=!0,this.cache[0]&&!this.zeroFrameDone)return this.zeroFrameDone=!0,setTimeout((function(){try{e.execNextFrame()}catch(e){console.error(e)}}),0),this.started=!1;this.t=setInterval((function(){try{e.execNextFrame()}catch(e){console.error(e)}e.currFrame++}),this.interval)}},e}()),m=new(function(){function e(){this.name="MqqCopyPaste"}return e.prototype.isMqqEnv=function(){return!(!window.mqq||"0"===window.mqq.clientVersion)},Object.defineProperty(e.prototype,"isSupportRead",{get:function(){return this.isMqqEnv()?r.TEXT_HTML:r.NULL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSupportWrite",{get:function(){return this.isMqqEnv()},enumerable:!1,configurable:!0}),e.prototype.read=function(){var e=window.mqq;return new Promise((function(t,n){e.invoke("docx","readSystemClipboard",{},(function(e,r){r?t(r):n({html:"",plain:""})}))}))},e.prototype.write=function(e){var t=window.mqq,n=e.plain,r=e.html;return new Promise((function(e){t.invoke("docx","writeSystemClipboard",{plain:n,html:r}),e()}))},e}()),b=new(function(){function e(){this.name="DefaultCopyPaste"}return Object.defineProperty(e.prototype,"isSupportRead",{get:function(){return r.NULL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSupportWrite",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.write=function(e){var t=e.html,n=e.plain,r=e.json,o=void 0===r?"":r;return new Promise((function(r,i){try{g.copy({"text/plain":n,"text/html":t,"text/json":o}).catch((function(e){console.error(e)})).then((function(){m.isSupportWrite&&y.wait(0).run((function(){t&&t.length>492426&&console.warn("Q"),m.write(e)})),r()}))}catch(e){console.log(e),i(e)}}))},e}()),_=new(function(){function e(){this.name="PlainCopyPaste",this.write=function(e){var t=e.plain,n=document.createElement("textarea");n.readOnly=!0,n.style.zIndex="0",n.style.opacity="0",n.style.top="-9999px",n.style.left="-9999px",n.style.position="fixed",document.body.appendChild(n),n.value=t;var r=document.createRange();return r.selectNode(n),window.getSelection().addRange(r),n.select(),document.execCommand("SelectAll"),document.execCommand("copy"),document.body.removeChild(n),Promise.resolve()}}return e.prototype.isSupportExecCommand=function(){return document.queryCommandSupported&&document.queryCommandSupported("copy")&&document.queryCommandSupported("SelectAll")},Object.defineProperty(e.prototype,"isSupportRead",{get:function(){return r.NULL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSupportWrite",{get:function(){return(i.a.isMobilePhone||i.a.isAndroidPad||i.a.isIPad)&&this.isSupportExecCommand()&&(i.a.isWeChat||i.a.isMiniProgram)},enumerable:!1,configurable:!0}),e}()),C=n(1),S=n.n(C),w=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},E=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},x=new(function(){function e(){this.name="WemeetCopyPaste"}return Object.defineProperty(e.prototype,"isSupportRead",{get:function(){return a?r.TEXT_ONLY:r.NULL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSupportWrite",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.read=function(){return w(this,void 0,void 0,(function(){return E(this,(function(e){return[2,new Promise((function(e,t){S.a.callNative("DocsWebViewPlugin","GetClipboard",void 0,(function(n){n.code&&1===n.code?e({plain:n.data,html:""}):t()}))}))]}))}))},e}()),T=n(2),R=n.n(T).a.getInstance().getConfig('npm["@tencent/clipboard"]'),I=(null==R?void 0:R.SDK_WX_URL)||"https://res.wx.qq.com/open/js/jweixin-1.6.0.js",P=new(function(){function e(){var e=this;this.jssdk=I,this.corpid="wwc031417218c8c3e1",this.hasSetted=!1,this.isNormalWebview=s&&!c,this.name="WeWorkCopyPaste",this.read=function(){return e.initWeWorkEnv().then((function(){return new Promise((function(e,t){wx.getClipboardData({success:function(t){console.log("wework getClipboardData success"),e({html:"",plain:t.data})},fail:function(e){console.error("wework getClipboardData error",e),t({html:"",plain:""})}})}))}))},this.write=function(t){var n=t.plain;return e.initWeWorkEnv().then((function(){return new Promise((function(e,t){wx.setClipboardData({data:n,success:function(){console.log("wework setClipboardData success"),e()},fail:function(e){console.error("wework setClipboardData error",e),t()}})}))}))},this.initWeWorkEnv=function(){return Promise.resolve()},this.isNormalWebview&&(console.log("WeWorkCopyPaste init"),this.initWeWorkEnv())}return Object.defineProperty(e.prototype,"isSupportRead",{get:function(){return this.isNormalWebview?r.TEXT_HTML:r.NULL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSupportWrite",{get:function(){return this.isNormalWebview},enumerable:!1,configurable:!0}),e}()),O=function(){return P.read()},k=function(e){return P.write({html:"",plain:e.plain})},D=function(){return!(!i.a.isWxMiniProgram&&!i.a.isWeChat||!(i.a.isAndroid&&i.a.isWeChatVersionAboveOrEqual("8.0.6")||i.a.isIOS&&i.a.isWeChatVersionAboveOrEqual("8.0.7")))},M=function(e){return void 0===e&&(e=""),/(fail_)|(_denied)/i.test(e)},A=new(function(){function e(){var e=this;this.jssdk=I,this.appId="wx46dfe750eef96da7",this.hasSetted=!1,this.name="WXRTFCopyPaste",this.read=function(){return e.initWeWorkEnv().then((function(){return new Promise((function(e,t){window.WeixinJSBridge.call("getClipboardData",{},(function(n){if(M(null==n?void 0:n.err_msg))return t(),void console.info("read-res: err msg "+n.err_msg);e({html:n.htmlText||"",plain:n.data||""}),console.info("read-res:"+JSON.stringify(n))}))}))}))},this.write=function(t){return e.initWeWorkEnv().then((function(){return new Promise((function(e,n){window.WeixinJSBridge.call("setClipboardData",{data:t.plain||"",htmlText:t.html||""},(function(t){if(M(null==t?void 0:t.err_msg))return n(),void console.info("write-res: err msg "+t.err_msg);e(),console.info("write-res:"+JSON.stringify(t))}))}))}))},this.initWeWorkEnv=function(){return Promise.resolve()},this.isSupportWXRTF()&&(console.log("wx-copypaste-constructor"),this.initWeWorkEnv())}return Object.defineProperty(e.prototype,"isSupportRead",{get:function(){return D()?r.TEXT_HTML:r.NULL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSupportWrite",{get:function(){return D()},enumerable:!1,configurable:!0}),e.prototype.isSupportWXRTF=function(){return D()},e}()),L=function(){return A.read()},N=function(e){return A.write(e)},B=n(3),F=n.n(B),U=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},H=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},j=new(function(){function e(){this.name="QqminiCopyPaste"}return Object.defineProperty(e.prototype,"isSupportRead",{get:function(){return i.a.isQQMiniProgram?r.TEXT_ONLY:r.NULL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSupportWrite",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.read=function(){return U(this,void 0,void 0,(function(){return H(this,(function(e){return[2,F.a.invoke("readSystemClipboard",{}).then((function(e){return{html:"",plain:e}})).catch((function(){return{html:"",plain:""}}))]}))}))},e}()),G=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},V=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},W=window;!function(e){e.TEXT="text/plain",e.HTML="text/html",e.IMAGE="image/png",e.JPEG="image/jpeg"}(f||(f={}));var z=i.a.isChromeVersionAboveOrEqual("86.0"),K=function(){return i.a.isChrome||i.a.isChromiumEdge||navigator.userAgent.includes("OPR")||navigator.userAgent.includes("Opera")};function q(){var e,t,n;return G(this,void 0,void 0,(function(){return V(this,(function(r){return(null===(e=null===navigator||void 0===navigator?void 0:navigator.clipboard)||void 0===e?void 0:e.read)&&(null===(t=null===navigator||void 0===navigator?void 0:navigator.permissions)||void 0===t?void 0:t.query)?(null===(n=null==W?void 0:W.wwapp)||void 0===n?void 0:n.invoke)?[2,null]:[2,navigator.permissions.query({name:"clipboard-read"}).then((function(e){return e.state})).catch((function(){return null}))]:[2,null]}))}))}var Y=function(){function e(){var e=this;this.name="NavClipboardCopyPaste",this.supportLevel=r.NULL,this.isNeedPermission=function(){return G(e,void 0,void 0,(function(){var e;return V(this,(function(t){switch(t.label){case 0:return[4,q()];case 1:return(e=t.sent())?[2,"denied"===e]:[2,!1]}}))}))},this.read=function(){return G(e,void 0,void 0,(function(){var e,t,n,r,o,i,a,s,c,l,u,d;return V(this,(function(p){switch(p.label){case 0:e={html:"",plain:"",type:"",blob:null,getAsFile:null},p.label=1;case 1:return p.trys.push([1,9,,10]),[4,null===(d=(u=navigator.clipboard).read)||void 0===d?void 0:d.call(u)];case 2:t=p.sent(),n=0,r=t,p.label=3;case 3:if(!(n<r.length))return[3,8];if(!(o=r[n]).types)return[3,7];i=function(t){var n,r,i;return V(this,(function(a){switch(a.label){case 0:return[4,o.getType(t)];case 1:switch(n=a.sent(),t){case f.TEXT:return[3,2];case f.HTML:return[3,4];case f.IMAGE:return[3,6];case f.JPEG:return[3,7]}return[3,8];case 2:return r=e,[4,n.text()];case 3:return r.plain=a.sent(),[3,8];case 4:return i=e,[4,n.text()];case 5:return i.html=a.sent(),[3,8];case 6:return e.type=f.IMAGE,e.blob=n,e.getAsFile=function(){return n},[3,8];case 7:return e.type=f.JPEG,e.blob=n,e.getAsFile=function(){return n},[3,8];case 8:return[2]}}))},a=0,s=o.types,p.label=4;case 4:return a<s.length?(c=s[a],[5,i(c)]):[3,7];case 5:p.sent(),p.label=6;case 6:return a++,[3,4];case 7:return n++,[3,3];case 8:return[3,10];case 9:return l=p.sent(),console.error("NavClipboardCopyPaste read error",l),[3,10];case 10:return[2,e]}}))}))},this.write=function(e){var t=e.html,n=e.plain,r=e.blob,o={};z&&(t||n)&&(o["text/html"]=new Blob([t],{type:"text/html"}),o["text/plain"]=new Blob([n],{type:"text/plain"})),r&&(o[r.type]=r);var i=[new ClipboardItem(o)];return new Promise((function(e,t){navigator.clipboard.write(i).then((function(){e()})).catch((function(e){t(e)}))}))},q().then((function(t){if(t){var n=i.a.isPC;e.supportLevel=n?"granted"===t?r.TEXT_HTML:"denied"===t?K()?r.TEXT_HTML:r.NULL:K()||i.a.isQQBrowser?r.TEXT_HTML:r.NULL:"granted"===t?r.TEXT_HTML:r.NULL}else e.supportLevel=r.NULL}))}return Object.defineProperty(e.prototype,"isSupportRead",{get:function(){return this.supportLevel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSupportWrite",{get:function(){return i.a.isChromeVersionAboveOrEqual("76.0")},enumerable:!1,configurable:!0}),e}(),Q=new Y,Z=function(){return Q.isNeedPermission()},X=window,J=new(function(){function e(){this.name="TDocsCopyPaste"}return e.prototype.isTDocsEnv=function(){return!(!X.tdocs||"function"!=typeof X.tdocs.getClipboardData||!i.a.isWxWork)},Object.defineProperty(e.prototype,"isSupportRead",{get:function(){return this.isTDocsEnv()?r.TEXT_HTML:r.NULL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSupportWrite",{get:function(){return this.isTDocsEnv()},enumerable:!1,configurable:!0}),e.prototype.read=function(){return window.tdocs.getClipboardData()},e.prototype.write=function(e){return window.tdocs.setClipboardData({html:e.html,plain:e.plain})},e}()),$=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},ee=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},te=function(e){var t=e?"from=miniprogram_wedoc":"from=miniprogram";return window.location.href.indexOf(t)>-1},ne=new(function(){function e(){this.name="WeDriveMiniCopyPaste"}return Object.defineProperty(e.prototype,"isSupportRead",{get:function(){return te()?r.TEXT_ONLY:r.NULL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSupportWrite",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.read=function(){return $(this,void 0,void 0,(function(){return ee(this,(function(e){return[2,this.getCopyDataFromServer().then((function(e){return{html:"",plain:e}}))]}))}))},e.prototype.getCopyDataFromServer=function(){var e=this,t=te(!0)?"wedoc_miniprogram_clipboard":"wedrive_miniprogram_clipboard";return new Promise((function(n,r){var o=new XMLHttpRequest;o.open("POST","/wedoc/clipboard?func=2&key="+t,!0),o.responseType="json",o.onload=function(){var t,i;if(200===o.status){var a=null===(i=null===(t=o.response)||void 0===t?void 0:t.body)||void 0===i?void 0:i.value;if(a)return console.log("wedrive mini paste success"),n(e.handleServerData(a));console.log("wedrive mini paste empty"),n("")}else console.error("wedrive mini paste error: ",o.statusText),r(o.statusText)},o.onerror=function(){r(o.statusText)},o.send()}))},e.prototype.handleServerData=function(e){var t="",n=/^(wxcp):\d{13}:/;if(e&&n.test(e)){var r=e.match(n),o=r&&r[0];t=o&&e.split(o)[1]||""}return t},e}()),re=function(){return ne.read()},oe=[j,J,Q,m,A,P,x],ie=function(){return oe.some((function(e){return e.isSupportRead}))},ae=function(){return oe.some((function(e){return e.isSupportRead===r.TEXT_HTML}))},se=function(){for(var e=0;e<oe.length;e++){var t=oe[e];if(t.isSupportRead)return console.log(t.name),t.read()}return Promise.resolve({html:"",plain:""})},ce=function(){var e=oe.filter((function(e){return e.isSupportRead}));return 1===e.length&&e[0]instanceof Y&&Z()},le=function(e){return A.isSupportWrite?(console.log(A.name),A.write(e)):J.isSupportWrite?(console.log(J.name),J.write(e)):P.isSupportWrite?(console.log(P.name),P.write(e)):_.isSupportWrite||a?(console.log(_.name),_.write(e),Promise.resolve()):(console.log(b.name),b.write(e))}}]))},60717:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isCancellationToken=t.CancellationTokenState=void 0;var n=function(){function e(){}return e.None=Object.freeze({isCancellationRequested:!1}),e.Cancelled=Object.freeze({isCancellationRequested:!0}),e}();t.CancellationTokenState=n,t.isCancellationToken=function(e){return e===n.None||e===n.Cancelled||!(!e||"object"!=typeof e)&&"boolean"==typeof e.isCancellationRequested}},28579:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.CancellationTokenSource=void 0;var r=n(60717),o=function(){function e(){this.isCancelled=!1}return e.prototype.cancel=function(){this.isCancelled||(this.isCancelled=!0)},Object.defineProperty(e.prototype,"isCancellationRequested",{get:function(){return this.isCancelled},enumerable:!1,configurable:!0}),e}(),i=function(){function e(){this.innertoken=void 0}return Object.defineProperty(e.prototype,"token",{get:function(){return this.innertoken||(this.innertoken=new o),this.innertoken},enumerable:!1,configurable:!0}),e.prototype.cancel=function(){this.innertoken?this.innertoken instanceof o&&this.innertoken.cancel():this.innertoken=r.CancellationTokenState.Cancelled},e.prototype.dispose=function(){this.cancel()},e}();t.CancellationTokenSource=i},6935:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},a=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.mixinRootDisposable=t.mixinDisposable=t.Disposable=t.RootDisposable=void 0;var s=n(94746),c=n(50575),l=n(46734),u=function(){function e(){this.disposedStore=new l.DisposableStore}return e.prototype.dispose=function(e){this.disposedStore.dispose(e)},e.prototype._register=function(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this.disposedStore.add(e)},e}(),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.dispose=function(t){var n=t,r=!1;if(!n){var o=this.constructor.name;n=s.DisposeTrace.traceRoot(o),r=!0}e.prototype.dispose.call(this,n),r&&n.stop()},t.prototype._register=function(t){return e.prototype._register.call(this,t)},t}(u);t.RootDisposable=d;var p=function(e){function t(){var t=e.call(this)||this;return c.trackDisposable(t),t}return o(t,e),t.prototype.dispose=function(t){c.markTracked(this),e.prototype.dispose.call(this,t)},t}(u);t.Disposable=p,t.mixinDisposable=function(e){return function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=e.apply(this,a(t))||this;return r.disposedStore=new l.DisposableStore,c.trackDisposable(r),r}return o(t,e),t.prototype.dispose=function(e){c.markTracked(this),this.disposedStore.dispose(e)},t.prototype._register=function(e){return this.disposedStore.add(e)},t}(e)},t.mixinRootDisposable=function(e){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.disposedStore=new l.DisposableStore,t}return o(t,e),t.prototype.dispose=function(e){c.markTracked(this);var t=e,n=!1;if(!t){var r=this.constructor.name;t=s.DisposeTrace.traceRoot(r),n=!0}this.disposedStore.dispose(t),n&&t.stop()},t.prototype._register=function(e){return this.disposedStore.add(e)},t}(e)}},46734:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.DisposableStore=void 0;var r=n(94746),o=n(50575),i=function(){function e(){this.toDisposeSet=new Set,this.isDisposeState=!1}return e.prototype.dispose=function(e){if(!this.isDisposeState)if(o.markTracked(this),this.isDisposeState=!0,e)this.clear(e);else{var t=r.DisposeTrace.traceRoot(this.constructor.name);this.clear(t),t.stop()}},e.prototype.clear=function(e){this.toDisposeSet.forEach((function(t){var n=t.disposableId||t.constructor.name;t.dispose(null==e?void 0:e.branch(n))})),this.toDisposeSet.clear()},e.prototype.add=function(t){if(!t)return t;if(t===this)throw new Error("Cannot register a disposable on itself!");return o.markTracked(t),this.isDisposeState?e.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this.toDisposeSet.add(t),t},e.DISABLE_DISPOSED_WARNING=!1,e}();t.DisposableStore=i},50575:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.trackDisposable=t.markTracked=t.disableDisposablesTrack=t.enableDisposablesTrack=void 0;var r=n(99981),o=!1,i="__is_disposable_tracked__";t.enableDisposablesTrack=function(){o=!0},t.disableDisposablesTrack=function(){o=!1},t.markTracked=function(e){if(o&&e&&e!==r.DisposableNone)try{e[i]=!0}catch(e){}},t.trackDisposable=function(e){if(!o)return e;e[i]||(e[i]=!1);var t=new Error("Potentially leaked disposable").stack;return setTimeout((function(){e[i]||console.log(t)}),3e3),e}},94746:function(e,t){var n,r=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},n(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a};Object.defineProperty(t,"__esModule",{value:!0}),t.DisposeTrace=t.disableDisposeTrace=t.enableDisposeTrace=void 0;var a=!1;t.enableDisposeTrace=function(){a=!0},t.disableDisposeTrace=function(){a=!1};var s=function(){function e(e){this.name=e,this._dep=[]}return e.traceRoot=function(t){return a?new e(t):e._None},e.prototype.branch=function(t){var n=new e(t);return this._dep.push([t,n]),n},e.prototype.stop=function(){var e=["dispose "+this.name,""+function e(t,n){var r,a,s=[],c=new Array(t+1).join("\t");try{for(var l=o(n._dep),u=l.next();!u.done;u=l.next()){var d=i(u.value,2),p=d[0],h=d[1];if(h){s.push(c+"dispose -> "+p);var f=e(t+1,h);f&&s.push(f)}else s.push(c+"dispose -> "+p)}}catch(e){r={error:e}}finally{try{u&&!u.done&&(a=l.return)&&a.call(l)}finally{if(r)throw r.error}}return s.join("\n")}(1,this)];console.log(e.join("\n"))},e._None=new(function(e){function t(){return e.call(this,null)||this}return r(t,e),t.prototype.stop=function(){},t.prototype.branch=function(){return this},t}(e)),e}();t.DisposeTrace=s},99981:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DisposableNone=void 0,t.DisposableNone=Object.freeze({dispose:function(){}})},77030:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.tryToMarkDispose=t.tryToDispose=t.toDisposable=t.combinedDisposable=t.dispose=t.isDisposable=void 0;var r=n(94746),o=n(50575);function i(e){return"function"==typeof e.dispose&&(0===e.dispose.length||1===e.dispose.length)}function a(e,t){if(Array.isArray(e)){var n=t||r.DisposeTrace.traceRoot("disposables");return e.forEach((function(e){e&&(o.markTracked(e),e.dispose(n))})),n.stop(),[]}if(e){var i=t||r.DisposeTrace.traceRoot("disposables");return o.markTracked(e),e.dispose(i),i.stop(),e}}t.isDisposable=i,t.dispose=a,t.combinedDisposable=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.forEach(o.markTracked),o.trackDisposable({dispose:function(t){return a(e,t)}})},t.toDisposable=function(e,t){void 0===t&&(t="");var n=o.trackDisposable({dispose:function(t){o.markTracked(n),e(t)},disposableId:t});return n},t.tryToDispose=function(e,t){e&&i(e)&&e.dispose(t)},t.tryToMarkDispose=function(e){i(e)&&o.markTracked(e)}},60125:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(6935);Object.defineProperty(t,"Disposable",{enumerable:!0,get:function(){return r.Disposable}}),Object.defineProperty(t,"RootDisposable",{enumerable:!0,get:function(){return r.RootDisposable}}),Object.defineProperty(t,"mixinDisposable",{enumerable:!0,get:function(){return r.mixinDisposable}}),Object.defineProperty(t,"mixinRootDisposable",{enumerable:!0,get:function(){return r.mixinRootDisposable}});var o=n(99981);Object.defineProperty(t,"DisposableNone",{enumerable:!0,get:function(){return o.DisposableNone}});var i=n(50575);Object.defineProperty(t,"markTracked",{enumerable:!0,get:function(){return i.markTracked}}),Object.defineProperty(t,"trackDisposable",{enumerable:!0,get:function(){return i.trackDisposable}}),Object.defineProperty(t,"enableDisposablesTrack",{enumerable:!0,get:function(){return i.enableDisposablesTrack}}),Object.defineProperty(t,"disableDisposablesTrack",{enumerable:!0,get:function(){return i.disableDisposablesTrack}});var a=n(94746);Object.defineProperty(t,"DisposeTrace",{enumerable:!0,get:function(){return a.DisposeTrace}}),Object.defineProperty(t,"enableDisposeTrace",{enumerable:!0,get:function(){return a.enableDisposeTrace}}),Object.defineProperty(t,"disableDisposeTrace",{enumerable:!0,get:function(){return a.disableDisposeTrace}});var s=n(77030);Object.defineProperty(t,"toDisposable",{enumerable:!0,get:function(){return s.toDisposable}}),Object.defineProperty(t,"isDisposable",{enumerable:!0,get:function(){return s.isDisposable}}),Object.defineProperty(t,"dispose",{enumerable:!0,get:function(){return s.dispose}}),Object.defineProperty(t,"combinedDisposable",{enumerable:!0,get:function(){return s.combinedDisposable}}),Object.defineProperty(t,"tryToDispose",{enumerable:!0,get:function(){return s.tryToDispose}}),Object.defineProperty(t,"tryToMarkDispose",{enumerable:!0,get:function(){return s.tryToMarkDispose}});var c=n(46734);Object.defineProperty(t,"DisposableStore",{enumerable:!0,get:function(){return c.DisposableStore}});var l=n(28579);Object.defineProperty(t,"CancellationTokenSource",{enumerable:!0,get:function(){return l.CancellationTokenSource}})},48537:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(71750),o=n(75692),i=n(52822),a=n(81008);class s{constructor(e){this.versionManager=new o.Z(e),this.taskQueueManager=new r.ZP,i.Z.debug("baseMessageCenter created")}pause(e=a.Q.ALL){i.Z.debug(`baseMessageCenter pause type:${e}`),this.taskQueueManager.pause()}resume(e=a.Q.ALL){i.Z.debug(`baseMessageCenter resume type:${e}`),this.taskQueueManager.resume()}forceResume(e=a.Q.ALL){i.Z.debug(`baseMessageCenter forceResume type:${e}`),this.taskQueueManager.forceResume()}dispose(){i.Z.debug("baseMessageCenter dispose"),this.taskQueueManager.dispose(),this.versionManager.dispose()}}},34746:function(e,t,n){n.d(t,{CONNECTION_STATE_EVENT:function(){return u},CollabCenter:function(){return v},RECEIVE_MESSAGE_EVENT:function(){return c},REPORT_EVENT:function(){return d},SEND_MESSAGE_EVENT:function(){return s},VERSION_EVENT:function(){return l}});var r=n(80177),o=n(52822);class i{constructor(e){this.collabCenter=e}handleCommitError(e){const{errorCode:t}=e;let n=`${t}`;if([r.RoomErrorCode.EXIST,r.RoomErrorCode.ROOM_CLOSE,r.RoomErrorCode.ROOM_SHUTDOWN].includes(t))return void o.Z.error(`handle commit error, code: ${t} reason: ${n}`);if([40021,40027].includes(t))return this.collabCenter.messageCenter.sendMessageManager.commitAfterUpdateVersionToLatest(void 0,0),void o.Z.error(`handle commit error, fetch miss change, code: ${t} reason: ${n}`);[1e4,10001,4e4,40002,40003,40007,40022,40023,41001,41002].includes(t)?n=`COMMIT_ERROR code=${t}`:[40001,40020].includes(t)?n=`TSSD_ERROR code=${t}`:[60007,60015].includes(t)&&(n=`COMMIT_UNAUTH code=${t}`),this.collabCenter.disconnect(n,t);const{commitingQueue:i}=e,[a]=i,s=`\n            taskId: ${a.taskId},\n            subId: ${a.subId},\n            baseRev: ${a.baseRev},\n            commands: ${a.commands}\n            changeset: ${a.changeset}\n        `;o.Z.error(`userchange commit error, code: ${t} reason: ${n} message: ${s}`),this.collabCenter.messageCenter.sendMessageManager.onCommitFailEmitter.fire(e)}}var a,s,c,l,u,d,p=n(51483),h=n(41290),f=n(81008),g=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};class v{constructor(e){this.options=e,this.init()}get version(){return this.messageCenter.versionManager.getCurrentVersion()}get connectionController(){return this.messageCenter.connectionController}get isConnected(){return this.messageCenter.isConnected()}connect(){this.messageCenter.openRoom()}disconnect(e,t){this.messageCenter.shutDown(e,t)}reconnect(e){this.messageCenter.reconnect(e)}pause(e=f.Q.ALL){this.messageCenter.pause(e)}resume(e=f.Q.ALL){this.messageCenter.resume(e)}forceResume(e=f.Q.ALL){this.messageCenter.forceResume(e)}sendUserChange(e){const{localUserChangeManager:t}=this.messageCenter;e.some((e=>t.has(e)))||this.messageCenter.addUserChange(e)}sendMessage(e){e.map((e=>this.messageCenter.sendMessage(e)))}handleServerUserChanges(e){e.forEach((e=>{this.messageCenter.receiveMessageManager.handleServerUserChange(e)}))}startGetMissChanges(e,t){this.messageCenter.startGetMissChanges(e,t)}getMissChanges(e,t){return g(this,void 0,void 0,(function*(){const{getMissChangesUrl:n}=this.options.collabCenterDelegate;if(!n)throw new Error("getMissChangesUrl is not implements!");const{globalPadId:r}=this.options.connectionOptions.serverVars;return(0,h.getMissChange)({from:e,to:t,globalPadId:r},n)}))}on(e,t){const n=Object.getOwnPropertyDescriptor(this.messageCenter.eventManager,e);return n?(0,n.value)(t):{dispose:()=>{}}}dispose(){this.messageCenter.dispose()}init(){var e,t,n,r,o,a,s;const{documentInfo:c}=null!==(e=this.options.config)&&void 0!==e?e:{},l=null!==(t=null==c?void 0:c.isCreator)&&void 0!==t?t:p.h.isCreator,u=null!==(n=null==c?void 0:c.isEditable)&&void 0!==n?n:p.h.isEditable,d=null!==(o=null===(r=this.options.config)||void 0===r?void 0:r.fullMemberInfo)&&void 0!==o?o:p.h.fullMemberInfo,f=null!==(s=null===(a=this.options.config)||void 0===a?void 0:a.hotDocsInfo)&&void 0!==s?s:p.h.hotDocsInfo;this.messageCenter=new h.MessageCenter(this.options.baseVersion,{isCreator:l,isEditable:u,hotDocsInfo:f,fullMemberInfo:d}),this.sendMessageHandler=new i(this),this.messageCenter.setGlobalVars(this.options.connectionOptions),this.messageCenter.setOptionalFunction(Object.assign(Object.assign({},this.options.collabCenterDelegate),{checkIfNeedFollow:this.options.collabCenterDelegate.shouldFollowUserChange})),this.messageCenter.eventManager.onCommitError((e=>this.sendMessageHandler.handleCommitError(e))),this.messageCenter.start()}}!function(e){e.ON_QUEUE_CHANGE="onQueueChange"}(a||(a={})),function(e){e.ON_COMMIT_FAIL="onCommitFail",e.ON_COMMIT_SUCCESS="onCommitSuccess"}(s||(s={})),function(e){e.ON_RECEIVE_MESSAGE="onReceiveOtherMessage"}(c||(c={})),function(e){e.ON_VERSION_CHANGE="onVersionChange"}(l||(l={})),function(e){e.ON_ROOM_OPEN="onRoomOpen",e.ON_ROOM_CLOSE="onClosed",e.ON_ROOM_SHUTDOWN="onShutdown",e.ON_RECONNECT_FAIL="onNetReconnectedFail",e.ON_ROOM_STATE_CHANGE="onConnectionStatusChange",e.ON_ENTER_ONLINE="onEnterOnline",e.ON_ENTER_OFFLINE="onEnterOffline"}(u||(u={})),function(e){e.ON_LOG="onLog",e.ON_REPORT="onReport"}(d||(d={}))},81008:function(e,t,n){var r;n.d(t,{Q:function(){return r}}),function(e){e.SEND="SEND",e.RECEIVE="RECEIVE",e.ALL="ALL"}(r||(r={}))},3514:function(e,t,n){var r=n(16531),o=n(52822);t.Z=class{constructor(){this._onQueueChange=new r.Q,this.onQueueChange=this._onQueueChange.event,this.waitingQueue=[],this.commitingQueue=[],o.Z.debug("LocalUserChangeManager created")}has(e){return[...this.commitingQueue,...this.waitingQueue].some((t=>t.getTaskId()===e.taskId))}pushToWaitingQueue(e){this.waitingQueue.push(...e),this.notifyQueueChange()}isCommittingEmpty(){return 0===this.commitingQueue.length}isWaitingEmpty(){return 0===this.waitingQueue.length}moveWaitingToCommiting(){this.isWaitingEmpty()||(o.Z.debug(`moveWaitingToCommiting: waitingQueue length: ${this.waitingQueue.length}`),this.commitingQueue.push(this.waitingQueue.shift()),this.notifyQueueChange())}clearUserChangeByTaskIdInQueue(e,t){this.commitingQueue=this.commitingQueue.filter((t=>t.getTaskId()!==e)),this.waitingQueue=this.waitingQueue.filter((t=>t.getTaskId()!==e)),this.updateVersion(t)}clearAllUserChangeQueue(){this.commitingQueue=[],this.waitingQueue=[],this.notifyQueueChange()}getCommitingQueue(){return this.commitingQueue}updateVersion(e){[...this.commitingQueue,...this.waitingQueue].forEach((t=>{t.updateBaseVersion(e)})),this.notifyQueueChange()}getWaitingQueue(){return this.waitingQueue}notifyQueueChange(){this._onQueueChange.fire({waitingQueue:this.waitingQueue.map((e=>e.getOriginData())),commitingQueue:this.commitingQueue.map((e=>e.getOriginData()))})}dispose(){o.Z.debug("LocalUserChangeManager dispose"),this.waitingQueue=[],this.commitingQueue=[],this._onQueueChange.dispose()}}},82255:function(e,t,n){var r=n(39055),o=n(16531),i=n(52822),a=n(18366);t.Z=class{constructor(){this.roomStatus=r.RoomState.INIT,this.errCode=null,this._onRoomOpen=new o.Q,this.onRoomOpen=this._onRoomOpen.event,this._onConnectionStatusChange=new o.Q,this.onConnectionStatusChange=this._onConnectionStatusChange.event,this._onShutdown=new o.Q,this.onShutdown=this._onShutdown.event,this._onClosed=new o.Q,this.onClosed=this._onClosed.event,this._onSwitchConnectMode=new o.Q,this.onSwitchConnectMode=this._onSwitchConnectMode.event,this._onEnterOnline=new o.Q,this.onEnterOnline=this._onEnterOnline.event,this._onEnterOffline=new o.Q,this.onEnterOffline=this._onEnterOffline.event,this._onNetReconnectedFail=new o.Q,this.onNetReconnectedFail=this._onNetReconnectedFail.event,i.Z.debug("NetworkStatusManager created")}handleOnRoomOpen(){i.Z.info("NetworkStatusManager handleOnRoomOpen"),this.roomStatus=r.RoomState.OPENED,this.errCode=null,this._onRoomOpen.fire()}handleOnRoomStateChange(e,t){i.Z.info(`NetworkStatusManager handleOnRoomStateChange, roomState=${e}, description=`,t),this.roomStatus=e,this._onConnectionStatusChange.fire({status:this.roomStatus,moreInfo:t})}handleNetReconnectedFail(){i.Z.info(`NetworkStatusManager handleNetReconnectedFail roomStatus=${this.roomStatus}`),this._onNetReconnectedFail.fire()}handleOnRoomShutDown(e){return i.Z.info("NetworkStatusManager handleOnRoomShutDown, reason=",e),this.errCode=e.errCode,e.errCode===a.RoomWebsocketErrorCode.SOCKET_SWITCH_BIG_COLLAB?(this.roomStatus=r.RoomState.INIT,void this._onSwitchConnectMode.fire(a.ConnectMode.BIG_COLLAB)):e.errCode===a.RoomErrorCode.BIG_COLLAB_CONNECT_TIMEOUT?(this.roomStatus=r.RoomState.INIT,void this._onSwitchConnectMode.fire(a.ConnectMode.WEBSOCKET_FORCED)):(this.roomStatus=r.RoomState.SHUTDOWN,void this._onShutdown.fire({reason:e,status:this.roomStatus}))}handleOnRoomClose(e){i.Z.info("NetworkStatusManager handleOnRoomClose, reason=",e),this.roomStatus=r.RoomState.RECONNECTING_IN_CLOSED,this.errCode=e.errCode,e.errCode!==a.RoomWebsocketErrorCode.SOCKET_SWITCH_BIG_COLLAB?e.errCode!==a.RoomErrorCode.BIG_COLLAB_CONNECT_TIMEOUT?e.shutDown?(this.roomStatus=r.RoomState.SHUTDOWN,this._onShutdown.fire({reason:e,status:this.roomStatus})):this._onClosed.fire({reason:e,status:this.roomStatus}):this._onSwitchConnectMode.fire(a.ConnectMode.WEBSOCKET_FORCED):this._onSwitchConnectMode.fire(a.ConnectMode.BIG_COLLAB)}getRoomStatus(){return this.roomStatus}getErrCode(){return this.errCode}handleOnEnterOnline(){this._onEnterOnline.fire()}handleOnEnterOffline(){this._onEnterOffline.fire()}dispose(){i.Z.debug("NetworkStatusManager dispose"),this.roomStatus=r.RoomState.INIT,this._onConnectionStatusChange.dispose(),this._onRoomOpen.dispose(),this._onShutdown.dispose(),this._onClosed.dispose()}}},71750:function(e,t,n){n.d(t,{ZP:function(){return d}});var r=n(16531),o=n(97275),i=n(52822);function a(e,t){if("function"==typeof(n=window.requestIdleCallback)&&n.toString().includes("[native code]")){const n=window.requestIdleCallback(e,t);return()=>window.cancelIdleCallback(n)}{const n=function(e,t){const n=performance.now();let r,o=n;const i=()=>{const a=performance.now(),s=50-(a-o),c=void 0!==(null==t?void 0:t.timeout)&&a-n>=t.timeout;if(s<=0&&!c)return o=a,void(r=setTimeout(i,1));e({didTimeout:c,timeRemaining:()=>s})};return r=setTimeout(i,1),()=>r}(e,t);return()=>window.clearTimeout(n())}var n}var s,c,l=n(13055),u=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};!function(e){e.WORKING="WORKING",e.PAUSE="PAUSE",e.IDLE="IDLE",e.SHUTDOWN="SHUTDOWN"}(s||(s={})),function(e){e.IMMEDIATELY="IMMEDIATELY",e.IDLE="IDLE"}(c||(c={}));class d{constructor(e){this.taskList=[],this.status=s.IDLE,this.checkTaskQueueTimer=0,this._onTaskError=new r.Q,this.onTaskError=this._onTaskError.event,this._onTaskDestroy=new r.Q,this.onTaskDestroy=this._onTaskDestroy.event,this._onTaskShutDown=new r.Q,this.onTaskShutDown=this._onTaskShutDown.event,this.priority=null!=e?e:c.IDLE,i.Z.info("TaskQueueManager created")}get length(){return this.taskList.length}getStatus(){return this.status}isEmpty(){return 0===this.taskList.length}isQueueWorking(){return this.status===s.WORKING}pause(){if(i.Z.info(`TaskQueueManager pause, task length = ${this.taskList.length}, current task = `,this.currentTask),this.switchStatus(s.PAUSE),this.currentTask){const e=this.currentTask.reset();this.currentTask=void 0,this.pushTask([e],0)}this.clearCheckTaskQueueTimer(),this.checkTaskQueueTimer=setTimeout((()=>{o.Z.report(l.Yo.TASK_QUEUE_NOT_RESUME_AFTER_60_SECOND)}),6e4)}resume(){this.clearCheckTaskQueueTimer(),this.status!==s.SHUTDOWN&&this.switchStatus(s.WORKING)}forceResume(){this.switchStatus(s.WORKING,!0),this.clearCheckTaskQueueTimer()}shutDown(e){i.Z.warn("TaskQueueManager shutDown, error = ",null==e?void 0:e.stack,null==e?void 0:e.message),this.switchStatus(s.SHUTDOWN),this._onTaskShutDown.fire(),this.clearCheckTaskQueueTimer()}pushTask(e,t){void 0===t&&(t=this.length),i.Z.info(`TaskQueueManager pushTask, taskQueue length = ${this.taskList.length}, index = ${t}`),Array.isArray(e)?this.taskList.splice(t,0,...e):this.taskList.splice(t,0,e),this.status===s.IDLE&&this.switchStatus(s.WORKING)}dispose(){i.Z.info("TaskQueueManager dispose"),this.status=s.SHUTDOWN,this.currentTask=void 0,this.taskList=[],this._onTaskDestroy.dispose(),this._onTaskError.dispose()}hasNext(){return!this.isEmpty()}work(){i.Z.debug("TaskQueueManager work"),this.hasNext()?this.runNext():this.switchStatus(s.IDLE)}popTask(){if(i.Z.debug("TaskQueueManager popTask"),0!==this.length)return this.taskList.shift()}runNext(){return u(this,void 0,void 0,(function*(){i.Z.debug("TaskQueueManager runNext");const e=this.popTask();if(e){this.currentTask=e,i.Z.info("TaskQueueManager runNext: run task, task=",{type:e.type,taskId:e.taskId,status:e.getCurrentStatus()});const t=yield e.run().catch((t=>{i.Z.error("TaskQueueManager runNext: run error",null==t?void 0:t.message),this._onTaskError.fire({error:t,currentTask:e})}));t&&(i.Z.debug("TaskQueueManager runNext: run task result, resultTask=",t.map((e=>({type:e.type,taskId:e.taskId,status:e.getCurrentStatus()})))),this.pushTask(t,0)),this.destroyTaskAndCheckQueueStatus(e)}}))}awaitRunByPriority(){return u(this,void 0,void 0,(function*(){switch(this.priority){case c.IDLE:return void(yield function(e={}){const{minRemaining:t=-1}=e;let{timeout:n}=e;return new Promise((e=>{let r=performance.now();const o=i=>{const{didTimeout:s}=i;if(i.timeRemaining()>t||s)return e(void 0);if(void 0!==n){const t=performance.now();if(n-=t-r,r=t,n<=0)return e(void 0)}a(o,{timeout:n})};a(o,{timeout:n})}))}({timeout:100,minRemaining:10}));case c.IMMEDIATELY:return}}))}destroyTaskAndCheckQueueStatus(e){i.Z.debug("TaskQueueManager destroyTaskAndCheckQueueStatus"),this.currentTask=void 0,this._onTaskDestroy.fire(e),this.isQueueWorking()?this.work():this.switchStatus(s.IDLE)}switchStatus(e,t=!1){if(this.status===s.SHUTDOWN&&!t)return;let n=!1;this.status!==s.WORKING&&e===s.WORKING&&(n=!0),this.status=e,n&&this.work()}clearCheckTaskQueueTimer(){this.checkTaskQueueTimer&&clearTimeout(this.checkTaskQueueTimer),this.checkTaskQueueTimer=0}}},75692:function(e,t,n){var r=n(13055),o=n(16531),i=n(52822),a=n(97275);t.Z=class{constructor(e){this._onVersionChange=new o.Q,this.onVersionChange=this._onVersionChange.event,this.currentVersion=e,i.Z.debug(`VersionManager created, baseVersion=${e}`)}getCurrentVersion(){return this.currentVersion}updateVersion(e){i.Z.info(`VersionManager updateVersion, currentVersion=${this.currentVersion}, newVersion=${e}`);const{currentVersion:t}=this;t>e?a.Z.report(r.Yo.UPDATE_VERSION_ERROR,{currentVersion:t,newVersion:e}):(this.currentVersion=e,this._onVersionChange.fire({newVersion:e,currentVersion:t}))}dispose(){i.Z.debug("VersionManager dispose"),this.currentVersion=0,this._onVersionChange.dispose()}}},41290:function(e,t,n){n.d(t,{CONNECTION_STATE_EVENT:function(){return i.CONNECTION_STATE_EVENT},CollabCenter:function(){return i.CollabCenter},Command:function(){return o.Command},DEFAULT_SEND_MESSAGE_TIMEOUT:function(){return o.DEFAULT_SEND_MESSAGE_TIMEOUT},LOG_TYPE:function(){return c.k},MessageCenter:function(){return a.p},MessagePriority:function(){return o.MessagePriority},PauseOrResumeType:function(){return s.Q},RECEIVE_MESSAGE_EVENT:function(){return i.RECEIVE_MESSAGE_EVENT},REPORT_EVENT:function(){return i.REPORT_EVENT},REPORT_MONITOR_TYPE:function(){return u.Yo},RoomWebsocketErrorCode:function(){return o.RoomWebsocketErrorCode},SEND_MESSAGE_EVENT:function(){return i.SEND_MESSAGE_EVENT},ServerUserChange:function(){return r.Z},VERSION_EVENT:function(){return i.VERSION_EVENT},generateMessageTaskId:function(){return o.generateMessageTaskId},getMissChange:function(){return l.Tn}}),n(75692),n(71750),n(82255),n(48537),n(3514);var r=n(61354),o=(n(15064),n(81240),n(31268),n(41225),n(34485),n(86246),n(18366)),i=n(34746),a=n(93403),s=n(81008),c=(n(58513),n(52822)),l=n(18561),u=(n(66545),n(13055))},51483:function(e,t,n){n.d(t,{h:function(){return r}});const r={isCreator:!1,isEditable:!1,hotDocsInfo:{enable:!1,isHotDocs:!1,isQueryData:!1},fullMemberInfo:{enable:!1,isFullMember:!1}}},93403:function(e,t,n){n.d(t,{p:function(){return q}});var r=n(18366),o=n(52822),i=n(97275),a=n(16531),s=n(13055),c=n(31268),l=n(86246);function u(e){const{result:t}=e;let n=0;return 0===t.errCode&&t.response||(n=d(e)),n}function d(e){var t,n,r,o;const{result:i}=e,a=null===(n=null===(t=i.response)||void 0===t?void 0:t.onpost)||void 0===n?void 0:n.result,s=(null===(o=null===(r=i.response)||void 0===r?void 0:r.body)||void 0===o?void 0:o.data.reason)||i.errCode;return a||s}const p=[r.RoomErrorCode.TIMEOUT,r.RoomErrorCode.ROOM_DISCONNECT,r.RoomErrorCode.ROOM_STATE_ERR,r.RoomWebsocketErrorCode.SOCKET_SWITCH_BIG_COLLAB],h=[r.RoomWebsocketErrorCode.SOCKET_DATA_SAVE_FAIL,r.RoomWebsocketErrorCode.SOCKET_SHEET_COMMIT_MIDDLE_SERVER_ERROR,r.RoomWebsocketErrorCode.SOCKET_HACKPAD_TIMEOUT,r.RoomWebsocketErrorCode.SOCKET_SERVER_WAITTING_TOO_LONG,r.RoomWebsocketErrorCode.SOCKET_SERVER_WAITTING_TIMEOUT,r.DataEngineCodes.ERR_GetDataEngineLockErr],f=[r.RoomWebsocketErrorCode.SOCKET_CLIENT_NOT_READY_ERROR,r.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_TIMEOUT,r.RoomWebsocketErrorCode.SOCKET_COLLAB_SERVER_TIMEOUT,r.RoomWebsocketErrorCode.SOCKET_SERVER_STORAGE_TIMEOUT,r.RoomWebsocketErrorCode.SOCKET_SERVER_CGI_TIMEOUT,r.RoomWebsocketErrorCode.SOCKET_FREQUENCY_LIMIT,r.RoomWebsocketErrorCode.SOCKET_AUTH_TIMEOUT,r.RoomWebsocketErrorCode.SOCKET_GET_PRIVILEGE_TIMEOUT];var g;!function(e){e.INIT="INIT",e.NEED_RETRY="NEED_RETRY",e.RETRY_ING="RETRY_ING",e.BLOCK="BLOCK"}(g||(g={}));const v=3*r.DEFAULT_SEND_MESSAGE_TIMEOUT;var y=class{constructor(e){this.retryCommitCount=0,this.retryPostCount=0,this.isPause=!1,this._onAcceptCommit=new a.Q,this.onAcceptCommit=this._onAcceptCommit.event,this._onCommitError=new a.Q,this.onCommitError=this._onCommitError.event,this._onRetryCommit=new a.Q,this.onRetryCommit=this._onRetryCommit.event,this.commitingStatus="INIT",this._onCommitBlock=new a.Q,this.onCommitBlock=this._onCommitBlock.event,this.onCommitFailEmitter=new a.Q,this.onCommitFail=this.onCommitFailEmitter.event,this._onSwitchConnectMode=new a.Q,this.onSwitchConnectMode=this._onSwitchConnectMode.event,this.lastRequestTime=0,this.dependency=e,this.loop(),o.Z.debug("SendMessageManager created")}resetRetryCount(){this.retryCommitCount=0,this.retryPostCount=0}pause(){this.isPause=!0}resume(){this.isPause=!1,this.checkAndSend()}addUserChange(e){o.Z.debug("SendMessageManager addUserChange, userChanges taskId",e.map((e=>e.getTaskId()))),this.dependency.localUserChangeManager.pushToWaitingQueue(e),this.checkAndSend()}sendMessage(e){this.isReadyToSendMessage()&&("USER_CHANGES"===e.cmd&&o.Z.info(`SendMessageManager sendMessage,cmd: USER_CHANGES, taskId:${e.taskId}`),this.dependency.connectionController.sendMessage({cmd:e.cmd,taskId:e.taskId||(0,r.generateMessageTaskId)(),data:e.data,customParam:e.customParam,onsend:e.onsend,onsendAccept:e.onsendAccept,onError:e.onError}))}acceptCommit(e,t,n){var r;o.Z.info(`SendMessageManager acceptCommit, newVersion=${e}, taskId:${t}`);const i=this.dependency.localUserChangeManager.getCommitingQueue(),a=this.dependency.localUserChangeManager.getWaitingQueue();this.dependency.localUserChangeManager.clearUserChangeByTaskIdInQueue(t,e),e>this.dependency.versionManager.getCurrentVersion()&&this.dependency.versionManager.updateVersion(e);const s=[...i,...a].find((e=>e.getTaskId()===t));this._onAcceptCommit.fire({newVersion:e,data:s.getOriginData()});const c=s.getOriginData();c.otherOptions||(c.otherOptions={}),c.otherOptions.result=n,null===(r=null==s?void 0:s.onSuccess)||void 0===r||r.call(s,e,c),this.lastRequestTime=0,this.checkAndSend()}commitAfterUpdateVersionToLatest(e,t){this.updateVersionToLatest({toVersion:e,index:t,onDestroy:()=>{this.lastRequestTime=0,this.loop(0)}})}dispose(){o.Z.debug("SendMessageManager dispose"),this.commitingStatus="INIT",this.lastRequestTime=0,this.dependency=null,this._onAcceptCommit.dispose(),this._onCommitError.dispose(),this._onRetryCommit.dispose(),this.clearLoopTimer()}updateVersionToLatest(e){var t,n;const{toVersion:r,index:i,onDestroy:a}=e,s=this.dependency.versionManager.getCurrentVersion();if(o.Z.debug(`SendMessageManager updateVersionToLatest, currentVersion=${s}, toVersion=${r}`),r&&s>=r)return;const c=new l.Z({from:s+1,to:r},{missChangeDependency:{globalPadId:null===(n=(t=this.dependency).getGlobalVars)||void 0===n?void 0:n.call(t).serverVars.globalPadId,getMissChangesUrl:this.dependency.getMissChangesUrl,sendMissChangeRequest:this.dependency.sendMissChangeRequest},versionManager:this.dependency.versionManager,acceptCommitDependency:this.dependency,onDestroy:a});this.dependency.taskQueueManager.pushTask(c,i)}checkAndSend(){if(this.isReadyToSendMessage())return this.dependency.localUserChangeManager.isCommittingEmpty()&&!this.dependency.localUserChangeManager.isWaitingEmpty()?(this.dependency.localUserChangeManager.moveWaitingToCommiting(),void this.sendUserChange()):void(this.dependency.localUserChangeManager.isCommittingEmpty()||!this.checkNeedRetry()||this.retryCommit())}sendUserChange(){if(!this.isReadyToSendMessage())return;const e=this.dependency.localUserChangeManager.getCommitingQueue();if(0!==e.length&&1===e.length){const[t]=e;return this.sendMessage({cmd:"USER_CHANGES",taskId:t.getTaskId(),data:t.getPreparedData(),customParam:{timeout:r.DEFAULT_SEND_MESSAGE_TIMEOUT,maxRetryCount:3,waitAcceptCmd:["ACCEPT_COMMIT","COMMIT_ERROR","TASK_DUPLICATE"]},onsend:this.onSend.bind(this),onsendAccept:this.onSendAccept.bind(this),onError:this.handleError.bind(this)}),i.Z.report(s.Yo.SEND_USERCHANGE,{userChange:t.getOriginData(),isFirstCommit:"NEED_RETRY"!==this.commitingStatus}),void(this.lastRequestTime=(new Date).getTime())}}checkNeedRetry(){return"NEED_RETRY"===this.commitingStatus||"BLOCK"!==this.commitingStatus&&(0===this.lastRequestTime?(this.lastRequestTime=Date.now(),!1):!this.isCommittingBlocked()&&this.isCommittingTimeout())}retryCommit(){var e;this.commitingStatus="RETRY_ING",this.sendUserChange();const t=this.dependency.localUserChangeManager.getCommitingQueue();this._onRetryCommit.fire(t.map((e=>e.getOriginData()))),i.Z.report(s.Yo.RETRY_COMMIT,{commitingQueue:null===(e=this.dependency)||void 0===e?void 0:e.localUserChangeManager.getCommitingQueue().map((e=>e.getData())),lastRequestTime:this.lastRequestTime,currentTime:(new Date).getTime()})}isCommittingTimeout(){return Date.now()-this.lastRequestTime>v&&(o.Z.info("SendMessageManager handleRetryCommit: timeout, need retry"),this.commitingStatus="NEED_RETRY",!0)}isCommittingBlocked(){var e,t;if(Date.now()-this.lastRequestTime>v&&"RETRY_ING"===this.commitingStatus){const n=this.dependency.localUserChangeManager.getCommitingQueue();return this._onCommitBlock.fire(n.map((e=>e.getOriginData()))),o.Z.error("SendMessageManager handleRetryCommit: commit block timeout multiple times"),i.Z.report(s.Yo.COMMITING_BLOCK_ERROR,{commitingQueue:null===(e=this.dependency)||void 0===e?void 0:e.localUserChangeManager.getCommitingQueue().map((e=>e.getOriginData())),waitingQueue:null===(t=this.dependency)||void 0===t?void 0:t.localUserChangeManager.getWaitingQueue().map((e=>e.getOriginData())),lastRequestTime:this.lastRequestTime,currentTime:(new Date).getTime()}),this.commitingStatus="BLOCK",!0}return!1}onSend(e,t,n,r){var a,c;o.Z.info(`SendMessageManager onSend, taskId:${e}, cmd:${t}`),this.handleError(e,t,n,r);const l=u({taskId:e,cmd:t,data:n,result:r});0!==l&&i.Z.report(s.Yo.COMMIT_REQUEST_FAIL,{errorCode:l,errorMessage:null===(c=null===(a=null==r?void 0:r.response)||void 0===a?void 0:a.onpost)||void 0===c?void 0:c.result})}handleError(e,t,n,r){const i=u({taskId:e,cmd:t,data:n,result:r});0!==i&&(o.Z.info(`SendMessageManager handleError, errorCode=${i}, taskId=${e}, cmd=${t}, result=`,r),this.handleErrorCode(i,{cmd:t,result:r,type:"ON_ERROR"}))}onSendAccept(e,t,n,a,c){var l;const u={taskId:e,cmd:t,data:n,waitCmd:a,result:c};if(o.Z.info(`SendMessageManager onSendAccept, taskId=${e}, cmd=${t}, waitCmd=${a}`),a===r.MessageWaitAcceptCmd.ACCEPT_COMMIT)this.handleAcceptCommit(null===(l=u.result.response)||void 0===l?void 0:l.new_rev,e,c),i.Z.report(s.Yo.COMMIT_REQUEST_SUCCESS);else if(a===r.MessageWaitAcceptCmd.COMMIT_ERROR){const e=d(u);o.Z.error(`SendMessageManager onSendAccept, commit error, code=${e}, message:${c.errMsg}`),this.handleErrorCode(e,{cmd:t,result:c,type:"ON_SEND_ACCEPT"}),i.Z.report(s.Yo.COMMIT_REQUEST_FAIL,{errorCode:e,errorMessage:c.errMsg})}else a===r.MessageWaitAcceptCmd.TASK_DUPLICATE&&(o.Z.error("SendMessageManager onSendAccept: task duplicate"),i.Z.report(s.Yo.ACCEPT_TASK_DUPLICATE,u),this.handleDuplicateTask(u))}handleErrorCode(e,t){if(0===e)return;o.Z.info(`SendMessageManager handleErrorCode, errorCode:${e}`);const{cmd:n,result:i,type:a="ON_ERROR"}=t||{};e===r.RoomWebsocketErrorCode.SOCKET_SWITCH_BIG_COLLAB&&this._onSwitchConnectMode.fire(r.ConnectMode.BIG_COLLAB);const s=this.dependency.localUserChangeManager.getCommitingQueue(),c=this.checkErrorCodeIfNeedRetry(e,i);if(c.needRetry)return this.commitingStatus="NEED_RETRY",this.loop(c.retryInterval);this._onCommitError.fire({errorCode:e,cmd:n,result:i,type:a,commitingQueue:s.map((e=>e.getOriginData()))}),s.forEach((t=>{var n;null===(n=t.onFailed)||void 0===n||n.call(t,e,t.getOriginData())})),this.resetCommitingStatus(),this.resetRetryCount()}handleAcceptCommit(e,t,n){var r,i;o.Z.debug(`SendMessageManager handleAcceptCommit, taskId:${t}, newVersion:${e}`);const a=new c.Z({to:e,acceptCommitDependency:this.dependency,versionManager:this.dependency.versionManager,taskId:t,missChangeDependency:{globalPadId:null===(i=(r=this.dependency).getGlobalVars)||void 0===i?void 0:i.call(r).serverVars.globalPadId,getMissChangesUrl:this.dependency.getMissChangesUrl,sendMissChangeRequest:this.dependency.sendMissChangeRequest},otherOptions:n});this.dependency.taskQueueManager.pushTask(a),this.resetCommitingStatus(),this.resetRetryCount()}loop(e){this.loopTimer&&clearTimeout(this.loopTimer),this.loopTimer=setTimeout((()=>{this.checkAndSend(),this.loop()}),void 0!==e?e:1e3)}handleDuplicateTask(e){var t,n,r,a,u;const d=e.result.response.body.data.lastRev,{taskId:p}=e,h=this.dependency.versionManager.getCurrentVersion();if(o.Z.info(`SendMessageManager handleDuplicateTask, latestVersion=${d}, currentVersion=${h}, taskId=${p}`),this.resetCommitingStatus(),d<=h+1){if(-1===this.dependency.localUserChangeManager.getCommitingQueue().map((e=>e.getTaskId())).indexOf(p))return void o.Z.warn("SendMessageManager handleDuplicateTask, task has been handled");if(d===h+1){o.Z.warn("SendMessageManager handleDuplicateTask, task covert to accept commit");const r=new c.Z({to:d,acceptCommitDependency:this.dependency,versionManager:this.dependency.versionManager,taskId:p,missChangeDependency:{globalPadId:null===(n=(t=this.dependency).getGlobalVars)||void 0===n?void 0:n.call(t).serverVars.globalPadId,getMissChangesUrl:this.dependency.getMissChangesUrl,sendMissChangeRequest:this.dependency.sendMissChangeRequest},otherOptions:e.result});return void this.dependency.taskQueueManager.pushTask(r)}null===(r=this.dependency)||void 0===r||r.shutDown(s.Yo.HANDLE_TASK_DUPLICATE_VERSION_ERROR),o.Z.error("SendMessageManager handleDuplicateTask, need to clean offline data"),i.Z.report(s.Yo.HANDLE_TASK_DUPLICATE_VERSION_ERROR,{latestVersion:d,currentVersion:h,packet:e})}else{const e=new l.Z({from:h+1,to:d},{missChangeDependency:{globalPadId:null===(u=(a=this.dependency).getGlobalVars)||void 0===u?void 0:u.call(a).serverVars.globalPadId,getMissChangesUrl:this.dependency.getMissChangesUrl,sendMissChangeRequest:this.dependency.sendMissChangeRequest},versionManager:this.dependency.versionManager,acceptCommitDependency:this.dependency});this.dependency.taskQueueManager.pushTask(e,0)}}resetCommitingStatus(){this.commitingStatus="INIT"}isReadyToSendMessage(){const e=this.dependency.connectionController.isConnected();return this.updateConnectedStatus(e),e&&!this.isPause}updateConnectedStatus(e){e!==this.isConnected&&o.Z.info(`SendMessageManager updateConnectedStatus, isConnected = ${e}`),this.isConnected=e}clearLoopTimer(){this.loopTimer&&(clearTimeout(this.loopTimer),this.loopTimer=void 0)}checkErrorCodeIfNeedRetry(e,t){var n,r,o,i,a,s,c;let l=!1,u=0;const d=null!==(c=null!==(i=null===(o=null===(r=null===(n=null==t?void 0:t.response)||void 0===n?void 0:n.body)||void 0===r?void 0:r.data)||void 0===o?void 0:o.retry_interval)&&void 0!==i?i:null===(s=null===(a=null==t?void 0:t.response)||void 0===a?void 0:a.onpost)||void 0===s?void 0:s.retry_interval)&&void 0!==c?c:5e3;return p.includes(e)?(l=!0,u=5e3):h.includes(e)&&this.retryCommitCount<3?(l=!0,u=d,this.retryCommitCount=this.retryCommitCount+1):f.includes(e)&&this.retryPostCount<3&&(l=!0,u=d,this.retryPostCount=this.retryPostCount+1),{needRetry:l,retryInterval:u}}},m=n(23742),b=n(41225),_=n(61354),C=n(34485),S=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},w=class{constructor(e){this._onReceiveOtherMessage=new a.Q,this.onReceiveOtherMessage=this._onReceiveOtherMessage.event,this._onReceiveMessage=new a.Q,this.onReceiveMessage=this._onReceiveMessage.event,this.dependency=e,o.Z.debug("ReceiveMessageManager created")}handleReceiveMessageFromServer(e){if(!(null==e?void 0:e.type)||!(0,m.isArray)(e.data))return;const{type:t,data:n}=e;if(t!==s.nn.CURSOR_MESSAGE&&o.Z.debug(`ReceiveMessageManager handleReceiveMessageFromServer, type=${t}, data=`,n),this._onReceiveMessage.fire({type:t,data:n}),t===s.nn.NEW_CHANGES)this.handleNewChange(n);else if(t===s.nn.LAST_REVERSION){const[e]=n;this.handleLastRervesion(e)}else t===s.nn.BIG_CHANGES?this.handleBigChange(n):this._onReceiveOtherMessage.fire({type:t,data:n})}handleNewChange(e){o.Z.debug("ReceiveMessageManager handleNewChange"),e.forEach((e=>{const{body:t,newRev:n,ts:r}=e,{commitId:o}=t.data,a=new _.Z(Object.assign(Object.assign({userChangesOrigin:_.P.COLLAB_CHANGE,taskId:o,time:r},t.data),{newRev:n}));i.Z.report(s.Yo.HANDLE_NEW_CHANGES,e),this.handleServerUserChange(a)}))}handleServerUserChange(e){var t,n;const r=new b.Z(e.getTaskId(),e,{missChangeDependency:{globalPadId:null===(n=(t=this.dependency).getGlobalVars)||void 0===n?void 0:n.call(t).serverVars.globalPadId,getMissChangesUrl:this.dependency.getMissChangesUrl,sendMissChangeRequest:this.dependency.sendMissChangeRequest},versionManager:this.dependency.versionManager,acceptCommitDependency:this.dependency});this.dependency.taskQueueManager.pushTask(r)}handleLastRervesion(e){var t,n,r,i;const a=this.dependency.versionManager.getCurrentVersion(),s=null===(n=null===(t=null==e?void 0:e.body)||void 0===t?void 0:t.notice)||void 0===n?void 0:n.lastRev;if(o.Z.info(`ReceiveMessageManager handleLastRervesion, lastReversion: ${s}, currentVersion: ${a}`),a>=s)return;const c=new l.Z({from:a+1,to:s},{missChangeDependency:{globalPadId:null===(i=(r=this.dependency).getGlobalVars)||void 0===i?void 0:i.call(r).serverVars.globalPadId,getMissChangesUrl:this.dependency.getMissChangesUrl,sendMissChangeRequest:this.dependency.sendMissChangeRequest},versionManager:this.dependency.versionManager,acceptCommitDependency:this.dependency});this.dependency.taskQueueManager.pushTask(c)}applyServerUserChanges(e){return S(this,void 0,void 0,(function*(){const t=this.dependency.localUserChangeManager.getCommitingQueue().map((e=>e.getTaskId())),n=this.dependency.localUserChangeManager.getWaitingQueue().map((e=>e.getTaskId())),r=new _.Z(e);return[...t,...n].indexOf(r.getTaskId())>-1?(this.dependency.acceptCommit(r.getVersion(),r.getTaskId()),!0):yield this.handleApplyServerUserChange(r)}))}dispose(){o.Z.debug("ReceiveMessageManager dispose"),this.dependency=null,this._onReceiveMessage.dispose(),this._onReceiveOtherMessage.dispose()}handleBigChange(e){e.forEach((e=>{var t,n;o.Z.info(`ReceiveMessageManager handleBigChange, newVersion:${e.newRev}`);const{newRev:r}=e,i=new C.Z({version:r,taskId:e.body.data.commitId,missChangeDependency:{globalPadId:null===(n=(t=this.dependency).getGlobalVars)||void 0===n?void 0:n.call(t).serverVars.globalPadId,getMissChangesUrl:this.dependency.getMissChangesUrl,sendMissChangeRequest:this.dependency.sendMissChangeRequest},versionManager:this.dependency.versionManager,localUserChangeManager:this.dependency.localUserChangeManager,acceptCommitDependency:this.dependency});this.dependency.taskQueueManager.pushTask(i,0)}))}handleApplyServerUserChange(e){var t,n,r;return S(this,void 0,void 0,(function*(){let a;const c=this.dependency.versionManager.getCurrentVersion(),l=e.getVersion();if(l<=c)return o.Z.warn(`ReceiveMessageManager handleApplyServerUserChange version error, currentVersion = ${c}, newVersion = ${l}`),!1;try{a=yield this.handleFollow(e)}catch(t){return o.Z.error("ReceiveMessageManager handleApplyServerUserChange handleFollow error, error = ",null==t?void 0:t.stack,null==t?void 0:t.message),i.Z.report(s.Yo.HANDLE_FOLLOW_ERROR,e.getData()),!1}try{yield null===(n=(t=this.dependency.collabDependency).applyServerUserChanges)||void 0===n?void 0:n.call(t,a.getData());const o=e.getVersion();o>this.dependency.versionManager.getCurrentVersion()&&(this.dependency.versionManager.updateVersion(o),null===(r=this.dependency)||void 0===r||r.localUserChangeManager.notifyQueueChange())}catch(t){return o.Z.error("ReceiveMessageManager handleApplyServerUserChange onApplyServerUserChanges error, error = ",null==t?void 0:t.stack,null==t?void 0:t.message),i.Z.report(s.Yo.APPLY_SERVER_USER_CHANGE_ERROR,e.getData()),!1}return!0}))}handleFollow(e){var t,n,r;return S(this,void 0,void 0,(function*(){if(o.Z.debug("ReceiveMessageManager handleFollow"),!1===(null===(n=(t=this.dependency.collabDependency).checkIfNeedFollow)||void 0===n?void 0:n.call(t,e.getData())))return e;const i=[...this.dependency.localUserChangeManager.getCommitingQueue(),...this.dependency.localUserChangeManager.getWaitingQueue()];let a,s=e.getChangeset();a=e.getBase64Commands();let c=e.changesetType;for(const t of i){const n=t.getChangeset(),o=t.getBase64Commands(),i=t.changesetType;let l,u,d;if(null===(r=this.dependency)||void 0===r?void 0:r.collabDependency.multiTypeFollow){const e=yield this.handleMultiTypeFollow({changesetType:i,changeset:n,base64Commands:o},{changesetType:c,changeset:s,base64Commands:a});({changeset:l,base64Commands:u,changesetType:d}=e.localChangeString),({changeset:s,base64Commands:a,changesetType:c}=e.serverChangeString)}else{const e=yield this.handleSingleTypeFollow(n,s);({localChangeset:l,serverChangeset:s}=e)}t.setChangeset({changeset:l,base64Commands:u,changesetType:d}),t.updateBaseVersion(e.getVersion())}return e.setChangeset({changeset:s,base64Commands:a,changesetType:c}),e}))}handleMultiTypeFollow(e,t){var n,r,o,i,a,s;return S(this,void 0,void 0,(function*(){return{localChangeString:yield null===(o=null===(n=this.dependency)||void 0===n?void 0:(r=n.collabDependency).multiTypeFollow)||void 0===o?void 0:o.call(r,t,e,!1),serverChangeString:yield null===(s=null===(i=this.dependency)||void 0===i?void 0:(a=i.collabDependency).multiTypeFollow)||void 0===s?void 0:s.call(a,e,t,!0)}}))}handleSingleTypeFollow(e,t){var n,r,o,i,a,s;return S(this,void 0,void 0,(function*(){return{localChangeset:yield null===(o=null===(n=this.dependency)||void 0===n?void 0:(r=n.collabDependency).follow)||void 0===o?void 0:o.call(r,t,e,!1),serverChangeset:yield null===(s=null===(i=this.dependency)||void 0===i?void 0:(a=i.collabDependency).follow)||void 0===s?void 0:s.call(a,e,t,!0)}}))}},E=n(15064),x=n(82255),T=n(3514),R=n(48537),I=class{constructor(){this._onRoomOpen=new a.Q,this.onRoomOpen=this._onRoomOpen.event,this._onConnectionStatusChange=new a.Q,this.onConnectionStatusChange=this._onConnectionStatusChange.event,this._onShutdown=new a.Q,this.onShutdown=this._onShutdown.event,this._onClosed=new a.Q,this.onClosed=this._onClosed.event,this._onEnterOnline=new a.Q,this.onEnterOnline=this._onEnterOnline.event,this._onEnterOffline=new a.Q,this.onEnterOffline=this._onEnterOffline.event,this._onNetReconnectedFail=new a.Q,this.onNetReconnectedFail=this._onNetReconnectedFail.event,this._onSwitchConnectMode=new a.Q,this.onSwitchConnectMode=this._onSwitchConnectMode.event,this._onQueueChange=new a.Q,this.onQueueChange=this._onQueueChange.event,this._onAcceptCommit=new a.Q,this.onAcceptCommit=this._onAcceptCommit.event,this._onCommitError=new a.Q,this.onCommitError=this._onCommitError.event,this._onRetryCommit=new a.Q,this.onRetryCommit=this._onRetryCommit.event,this._onCommitBlock=new a.Q,this.onCommitBlock=this._onCommitBlock.event,this.onCommitFailEmitter=new a.Q,this.onCommitFail=this.onCommitFailEmitter.event,this.onCommitSuccessEmitter=new a.Q,this.onCommitSuccess=this.onCommitSuccessEmitter.event,this._onReceiveOtherMessage=new a.Q,this.onReceiveOtherMessage=this._onReceiveOtherMessage.event,this._onReceiveMessage=new a.Q,this.onReceiveMessage=this._onReceiveMessage.event,this._onTaskError=new a.Q,this.onTaskError=this._onTaskError.event,this._onTaskDestroy=new a.Q,this.onTaskDestroy=this._onTaskDestroy.event,this._onTaskShutDown=new a.Q,this.onTaskShutDown=this._onTaskShutDown.event,this._onVersionChange=new a.Q,this.onVersionChange=this._onVersionChange.event,this.onLogEmitter=new a.Q,this.onLog=this.onLogEmitter.event,this._onTdw=new a.Q,this.onTdw=this._onTdw.event,this.onReportEmitter=new a.Q,this.onReport=this.onReportEmitter.event}injectDependency(e){const{networkStatusManager:t,localUserChangeManager:n,sendMessageManager:r,receiveMessageManager:o,taskQueueManager:i,versionManager:a}=e;this.networkStatusManager=t,this.localUserChangeManager=n,this.sendMessageManager=r,this.receiveMessageManager=o,this.taskQueueManager=i,this.versionManager=a,this.initEventEmitter()}dispose(){this._onRoomOpen.dispose(),this._onConnectionStatusChange.dispose(),this._onShutdown.dispose(),this._onClosed.dispose(),this._onEnterOnline.dispose(),this._onEnterOffline.dispose(),this._onNetReconnectedFail.dispose(),this._onQueueChange.dispose(),this._onAcceptCommit.dispose(),this._onCommitError.dispose(),this._onReceiveMessage.dispose(),this._onReceiveOtherMessage.dispose(),this._onTaskError.dispose(),this._onTaskDestroy.dispose(),this._onTaskShutDown.dispose(),this._onVersionChange.dispose(),this.onLogEmitter.dispose(),this._onTdw.dispose(),this.onReportEmitter.dispose(),this._onRetryCommit.dispose(),this._onCommitBlock.dispose()}initEventEmitter(){this.networkStatusManager.onRoomOpen(((...e)=>this._onRoomOpen.fire(...e))),this.networkStatusManager.onConnectionStatusChange(((...e)=>this._onConnectionStatusChange.fire(...e))),this.networkStatusManager.onShutdown(((...e)=>this._onShutdown.fire(...e))),this.networkStatusManager.onClosed(((...e)=>this._onClosed.fire(...e))),this.networkStatusManager.onEnterOnline(((...e)=>this._onEnterOnline.fire(...e))),this.networkStatusManager.onEnterOffline(((...e)=>this._onEnterOffline.fire(...e))),this.networkStatusManager.onNetReconnectedFail(((...e)=>this._onNetReconnectedFail.fire(...e))),this.networkStatusManager.onSwitchConnectMode(((...e)=>this._onSwitchConnectMode.fire(...e))),this.localUserChangeManager.onQueueChange(((...e)=>this._onQueueChange.fire(...e))),this.sendMessageManager.onAcceptCommit(((...e)=>{this._onAcceptCommit.fire(...e),this.onCommitSuccessEmitter.fire(...e)})),this.sendMessageManager.onCommitError(((...e)=>this._onCommitError.fire(...e))),this.sendMessageManager.onCommitFail(((...e)=>this.onCommitFailEmitter.fire(...e))),this.sendMessageManager.onRetryCommit(((...e)=>this._onRetryCommit.fire(...e))),this.sendMessageManager.onCommitBlock(((...e)=>this._onCommitBlock.fire(...e))),this.sendMessageManager.onSwitchConnectMode(((...e)=>this._onSwitchConnectMode.fire(...e))),this.receiveMessageManager.onReceiveMessage(((...e)=>this._onReceiveMessage.fire(...e))),this.receiveMessageManager.onReceiveOtherMessage(((...e)=>this._onReceiveOtherMessage.fire(...e))),this.taskQueueManager.onTaskError(((...e)=>this._onTaskError.fire(...e))),this.taskQueueManager.onTaskDestroy(((...e)=>this._onTaskDestroy.fire(...e))),this.taskQueueManager.onTaskShutDown(((...e)=>this._onTaskShutDown.fire(...e))),this.versionManager.onVersionChange(((...e)=>this._onVersionChange.fire(...e))),o.Z.onLog(((...e)=>this.onLogEmitter.fire(...e))),i.Z.onReport(((...e)=>this.onReportEmitter.fire(...e)))}},P=n(51483),O=n(80177);const k="";var D=n(52739);const M=10003,A="FullMemberErrorTips";var L;!function(e){e[e.normal=1]="normal",e[e.inactive=2]="inactive"}(L||(L={}));class N{static hide(){var e;null===(e=this.snackbar)||void 0===e||e.close(),this.snackbar=null}static showFullMemberTips(e,t){t===L.inactive?this.snackbar=D.default.show({id:A,message:e,style:{zIndex:M},autoClose:!1,action:[{text:"",onClick:this.onClickRefresh}]}):this.snackbar=D.default.show({message:e,id:A,style:{zIndex:M},autoClose:!1,closable:!0,onClose:()=>this.snackbar=null})}static showServerErrorTips(e){this.snackbar=D.default.show({message:e,type:"info",id:"ServerErrorTips",style:{zIndex:M},autoClose:!1,onClose:()=>!0,action:[{text:"",onClick:this.onClickRefresh},{text:"",onClick:()=>(this.onClickFeedback(),!1)}]})}}N.onClickRefresh=()=>{window.location.reload()},N.onClickFeedback=()=>{window.open("https://support.qq.com/products/28096?customInfo=N0009","_blank")};var B,F=n(90304),U=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},H=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};class j{constructor(e,t,n,r=15e3){this.getQueryDataUrl=e,this.onSuccess=t,this.onError=n,this.interval=r,this.timer=0}start(){clearInterval(this.timer),this.timer=setInterval((()=>this.queryData()),this.interval),o.Z.info("query data timer start")}stop(){clearInterval(this.timer),this.timer=0,o.Z.info("query data timer stop")}queryData(){var e,t,n;return H(this,void 0,void 0,(function*(){try{const n=this.getQueryDataUrl(),r=yield function(e){return U(this,void 0,void 0,(function*(){return F.networkRequest.get(e)}))}(n),{data:o}=r;0!==o.retcode?null===(e=this.onError)||void 0===e||e.call(this,o):null===(t=this.onSuccess)||void 0===t||t.call(this,o)}catch(e){null===(n=this.onError)||void 0===n||n.call(this)}}))}}class G{constructor(e){this.context=e,this.isFullMember=!1,this.onQueryDataSuccess=e=>{var t,n;if(!e.isOverConNum){const{hotDocsManager:t}=this.context,n=t.enableHotDocsMode&&t.isInitHotDocs;return this.existFullMemberMode(!n),n&&t.enterHotDocsMode(),void o.Z.info(`full member query data success, exist full member mode, reason: isOverConNum = ${e.isOverConNum}.`)}o.Z.info(`full member query data success, notify update data to rev: ${e.rev}.`),null===(n=(t=this.context.dependency).onReceiveQueryData)||void 0===n||n.call(t,e)},this.onQueryDataError=()=>{var e;N.showServerErrorTips(""),null===(e=this.queryDataTimer)||void 0===e||e.stop()},o.Z.info(`init full member mode, enable: ${this.enableFullMemberMode}.`,e.option);const{fullMemberInfo:t}=e.option;this.enableFullMemberMode&&(this.queryDataTimer=new j(e.dependency.getQueryDataUrl,this.onQueryDataSuccess,this.onQueryDataError),t.isFullMember&&this.enterFullMemberMode(k,L.normal))}handleShutDown(e){var t,n,r;if(!this.enableFullMemberMode)return;const i=null!==(r=null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.closeReason)||void 0===n?void 0:n.errCode)&&void 0!==r?r:0;let a,s=L.normal;O.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_MEMBER_FULL===i||O.RoomWebsocketErrorCode.SOCKET_COLLABROOM_NOT_VIP_FULL===i?(s=L.normal,a=k):O.RoomWebsocketErrorCode.INACTIVE===i&&(s=L.inactive,a=""),a&&(o.Z.info(`handle room close, enter full member mode, errorCode: ${i}.`),this.enterFullMemberMode(a,s))}get enableFullMemberMode(){const{option:e}=this.context;return!!e.fullMemberInfo.enable&&!e.isCreator}enterFullMemberMode(e,t){var n;const{option:r,dependency:i}=this.context;this.enableFullMemberMode&&(this.isFullMember||(this.isFullMember=!0,this.queryDataTimer.start(),r.isEditable&&(null===(n=i.onEditableChange)||void 0===n||n.call(i,!1),N.showFullMemberTips(e,t)),o.Z.info(`enter full member mode, isEditable: ${r.isEditable}.`)))}existFullMemberMode(e=!0){var t,n,r;const{option:i,dependency:a}=this.context;this.enableFullMemberMode&&this.isFullMember&&(N.hide(),this.isFullMember=!1,this.queryDataTimer.stop(),e&&(null===(n=(t=this.context.dependency).reconnect)||void 0===n||n.call(t)),i.isEditable&&(null===(r=a.onEditableChange)||void 0===r||r.call(a,!0)),o.Z.info(`exist full member mode, isEditable: ${i.isEditable}.`))}}class V{constructor(e){this.context=e,this.isHotDocs=!1,o.Z.info(`init disable hot docs mode, enable: ${this.enableHotDocsMode}.`,e.option);const{hotDocsInfo:t,isInitFullMember:n}=e.option;this.enableHotDocsMode&&(t.isQueryData&&(this.queryDataTimer=new j(e.dependency.getQueryDataUrl,this.onQueryDataSuccess.bind(this),this.onQueryDataError.bind(this))),this.isInitHotDocs&&!n&&this.enterHotDocsMode())}handleOnRoomOpen(){this.enableHotDocsMode&&this.isHotDocs&&(this.existHotDocsMode(),o.Z.info("handle room open, exist hot docs mode."))}get isInitHotDocs(){const{option:e}=this.context;return!!e.hotDocsInfo.isHotDocs}get enableHotDocsMode(){const{option:e}=this.context;return!!e.hotDocsInfo.enable&&!e.isCreator}enterHotDocsMode(){var e;this.enableHotDocsMode&&(this.isHotDocs||(this.isHotDocs=!0,null===(e=this.queryDataTimer)||void 0===e||e.start(),o.Z.info(`enter hot docs mode, isQueryData: ${this.context.option.hotDocsInfo.isQueryData}.`)))}existHotDocsMode(){var e;this.enableHotDocsMode&&this.isHotDocs&&(this.isHotDocs=!1,null===(e=this.queryDataTimer)||void 0===e||e.stop(),N.hide(),o.Z.info(`exist hot docs mode, isQueryData: ${this.context.option.hotDocsInfo.isQueryData}.`))}onQueryDataSuccess(e){var t,n;o.Z.info(`hot docs query data success, notify update data to rev: ${e.rev}.`),null===(n=(t=this.context.dependency).onReceiveQueryData)||void 0===n||n.call(t,e)}onQueryDataError(){var e;N.showServerErrorTips(""),null===(e=this.queryDataTimer)||void 0===e||e.stop()}}!function(e){e[e.TASK_ERROR=51001]="TASK_ERROR"}(B||(B={}));var W=n(81008),z=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},K=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};class q extends R.Z{constructor(e,t=P.h){super(e),this.messageCenterOption=t,this.globalVars={},this.eventManager=new I,o.Z.info(`MessageCenter created, baseVsersion = ${e}, option=`,t)}pause(e=W.Q.ALL){var t;const n={SEND:()=>this.sendMessageManager.pause(),RECEIVE:()=>this.taskQueueManager.pause(),ALL:()=>{this.sendMessageManager.pause(),this.taskQueueManager.pause()}};null===(t=n[e])||void 0===t||t.call(n)}resume(e=W.Q.ALL){var t;const n={SEND:()=>this.sendMessageManager.resume(),RECEIVE:()=>this.taskQueueManager.resume(),ALL:()=>{this.sendMessageManager.resume(),this.taskQueueManager.resume()}};null===(t=n[e])||void 0===t||t.call(n)}forceResume(e=W.Q.ALL){var t;const n={SEND:()=>this.sendMessageManager.resume(),RECEIVE:()=>this.taskQueueManager.resume(),ALL:()=>{this.sendMessageManager.resume(),this.taskQueueManager.forceResume()}};null===(t=n[e])||void 0===t||t.call(n)}setGlobalVars(e){o.Z.info(`MessageCenter setGlobalVars, options = ${e}`),this.globalVars=Object.assign({},e)}setOptionalFunction(e){this.initDenpendency(e)}start(){o.Z.info("MessageCenter start"),void 0===this.dependency&&this.initDenpendency(),this.localUserChangeManager=new T.Z,this.versionManager.onVersionChange((({newVersion:e})=>{var t;this.localUserChangeManager.updateVersion(e),null===(t=this.connectionController)||void 0===t||t.setVersion(e)})),this.taskQueueManager.onTaskError((()=>{this.onTaskError()})),this.networkStatusManager=new x.Z,this.receiveMessageManager=new w({collabDependency:this.dependency.collabDependency,versionManager:this.versionManager,taskQueueManager:this.taskQueueManager,localUserChangeManager:this.localUserChangeManager,acceptCommit:this.acceptCommit.bind(this),applyServerUserChanges:this.applyServerUserChanges.bind(this),composeNewChanges:this.composeNewChanges.bind(this),getGlobalVars:this.getGlobalVars.bind(this),getMissChangesUrl:this.dependency.baseConfigDependency.getMissChangesUrl,sendMissChangeRequest:this.dependency.baseConfigDependency.sendMissChangeRequest}),this.initConnectionController(),this.sendMessageManager=new y({collabDependency:this.dependency.collabDependency,versionManager:this.versionManager,taskQueueManager:this.taskQueueManager,localUserChangeManager:this.localUserChangeManager,connectionController:this.connectionController,acceptCommit:this.acceptCommit.bind(this),applyServerUserChanges:this.applyServerUserChanges.bind(this),composeNewChanges:this.composeNewChanges.bind(this),getGlobalVars:this.getGlobalVars.bind(this),getMissChangesUrl:this.dependency.baseConfigDependency.getMissChangesUrl,sendMissChangeRequest:this.dependency.baseConfigDependency.sendMissChangeRequest,shutDown:this.shutDown.bind(this)}),this.eventManager.injectDependency({networkStatusManager:this.networkStatusManager,localUserChangeManager:this.localUserChangeManager,sendMessageManager:this.sendMessageManager,receiveMessageManager:this.receiveMessageManager,versionManager:this.versionManager,taskQueueManager:this.taskQueueManager});const{fullMemberInfo:e}=this.messageCenterOption;this.hotDocsManager=new V({option:Object.assign(Object.assign({},this.messageCenterOption),{isInitFullMember:!!e.enable&&!!e.isFullMember}),dependency:Object.assign({setVersion:e=>this.versionManager.updateVersion(e)},this.dependency.queryDataDependency)}),this.fullMemberManager=new G({option:this.messageCenterOption,hotDocsManager:this.hotDocsManager,dependency:Object.assign({reconnect:()=>{var e;return null===(e=this.connectionController)||void 0===e?void 0:e.reconnect()},setVersion:e=>this.versionManager.updateVersion(e)},this.dependency.queryDataDependency)}),this.networkStatusManager.onSwitchConnectMode((e=>{var t;null===(t=this.connectionController)||void 0===t||t.reconnect(void 0,e)})),this.sendMessageManager.onSwitchConnectMode((e=>{var t;null===(t=this.connectionController)||void 0===t||t.reconnect(void 0,e)}))}addUserChange(e){var t,n;const r=this.hotDocsManager.enableHotDocsMode&&this.hotDocsManager.isHotDocs;let i;r&&!(null===(t=this.connectionController)||void 0===t?void 0:t.isConnected())&&(o.Z.warn(`start connect when isHotDocs: ${r}`),null===(n=this.connectionController)||void 0===n||n.connect()),i=e instanceof Array?e.map((e=>new E.Z(e))):[new E.Z(e)],this.sendMessageManager.addUserChange(i)}openRoom(){var e;const t=this.hotDocsManager.enableHotDocsMode&&this.hotDocsManager.isHotDocs,n=this.fullMemberManager.enableFullMemberMode&&this.fullMemberManager.isFullMember;t||n?o.Z.warn(`skip open room, isFullMember: ${n}, isHotDocs: ${t}`):null===(e=this.connectionController)||void 0===e||e.connect()}sendMessage(e){this.sendMessageManager.sendMessage(e)}shutDown(e="",t,n){var r;o.Z.info(`MessageCenter shutDown, info=${e}, errCode=${t}, description=${n}`),this.taskQueueManager.shutDown(),null===(r=this.connectionController)||void 0===r||r.disconnect({errCode:t,reason:e||"active shutdown",shutDown:!0}),this.sendMessageManager.resetRetryCount()}getIsOnline(){var e;return null===(e=this.connectionController)||void 0===e?void 0:e.isOnline()}clearAllUserChangeQueue(){this.localUserChangeManager.clearAllUserChangeQueue()}isConnected(){var e,t;return null!==(t=null===(e=this.connectionController)||void 0===e?void 0:e.isConnected())&&void 0!==t&&t}startGetMissChanges(e,t){const{globalPadId:n}=this.globalVars.serverVars,{getMissChangesUrl:r}=this.dependency.baseConfigDependency,o=new l.Z({from:e,to:t},{missChangeDependency:{globalPadId:n,getMissChangesUrl:r},versionManager:this.versionManager,acceptCommitDependency:this.acceptCommitDependency});this.taskQueueManager.pushTask(o)}dispose(){var e;super.dispose(),o.Z.debug("MessageCenter dispose"),this.taskQueueManager.dispose(),this.localUserChangeManager.dispose(),this.sendMessageManager.dispose(),this.receiveMessageManager.dispose(),this.versionManager.dispose(),null===(e=this.connectionController)||void 0===e||e.dispose(),this.networkStatusManager.dispose(),this.eventManager.dispose(),o.Z.dispose()}reconnect(e){var t;null===(t=this.connectionController)||void 0===t||t.reconnect(e)}reConnect(e){this.reconnect(e)}get connectionController(){return this.connectionControllerInstance}get acceptCommitDependency(){const{getMissChangesUrl:e}=this.dependency.baseConfigDependency;return{getMissChangesUrl:e,acceptCommit:this.acceptCommit.bind(this),applyServerUserChanges:this.applyServerUserChanges.bind(this),composeNewChanges:this.composeNewChanges.bind(this),getGlobalVars:this.getGlobalVars.bind(this)}}initDenpendency(e={}){o.Z.debug("MessageCenter initDenpendency"),this.dependency||(this.dependency={});const{follow:t,multiTypeFollow:n,applyServerUserChanges:r,composeNewChanges:i,getMissChangesUrl:a,sendMissChangeRequest:s,checkIfNeedFollow:c}=e,l=K(e,["follow","multiTypeFollow","applyServerUserChanges","composeNewChanges","getMissChangesUrl","sendMissChangeRequest","checkIfNeedFollow"]);this.setSendMissChangeRequest(s),this.setGetMissChangesUrl(a),this.setApplyServerUserChanges(r),this.setComposeNewChanges(i),this.setFollow(t),this.setMultiTypeFollow(n),this.setCheckIfNeedFollow(c),this.setFullMemberDependency(l)}getGlobalVars(){return this.globalVars}setFullMemberDependency(e){this.dependency.queryDataDependency||(this.dependency.queryDataDependency={onEditableChange:()=>{},getQueryDataUrl:()=>"",onReceiveQueryData:()=>!1}),this.dependency.queryDataDependency=Object.assign({},e)}setCheckIfNeedFollow(e){this.dependency.collabDependency||(this.dependency.collabDependency={}),this.dependency.collabDependency.checkIfNeedFollow=e||(()=>!0)}setGetMissChangesUrl(e){this.dependency.baseConfigDependency||(this.dependency.baseConfigDependency={}),this.dependency.baseConfigDependency.getMissChangesUrl=e||(()=>z(this,void 0,void 0,(function*(){return""})))}setSendMissChangeRequest(e){this.dependency.baseConfigDependency||(this.dependency.baseConfigDependency={}),this.dependency.baseConfigDependency.sendMissChangeRequest=e}setMultiTypeFollow(e){this.dependency.collabDependency||(this.dependency.collabDependency={}),this.dependency.collabDependency.multiTypeFollow=e}setFollow(e){this.dependency.collabDependency||(this.dependency.collabDependency={}),this.dependency.collabDependency.follow=e||((e,t)=>t)}setApplyServerUserChanges(e){this.dependency.collabDependency||(this.dependency.collabDependency={}),this.dependency.collabDependency.applyServerUserChanges=e||(()=>{})}setComposeNewChanges(e){this.dependency.collabDependency||(this.dependency.collabDependency={}),this.dependency.collabDependency.composeNewChanges=e}onTaskError(){o.Z.debug("MessageCenter onTaskError"),this.shutDown("TASK_ERROR",B.TASK_ERROR)}initConnectionController(){(0,r.initLogAndManager)({debug:(...e)=>{o.Z.debug(...e)},info:(...e)=>{o.Z.info(...e)},warn:(...e)=>{o.Z.warn(...e)},error:(...e)=>{o.Z.error(...e)}}),this.connectionControllerInstance=new r.ConnectionController(this.getGlobalVars()),this.connectionController.setVersion(this.versionManager.getCurrentVersion()),this.connectionController.onConnectionEvent((e=>{var t,n,r;const o=null!==(n=null===(t=e.data)||void 0===t?void 0:t.closeReason)&&void 0!==n?n:{shutDown:!0},i=new Map([["OnRoomStateChange",()=>{var t,n,r,o,i,a;return this.networkStatusManager.handleOnRoomStateChange(null!==(r=null===(n=null===(t=e.data)||void 0===t?void 0:t.roomState)||void 0===n?void 0:n.roomState)&&void 0!==r?r:"",null!==(a=null===(i=null===(o=e.data)||void 0===o?void 0:o.roomState)||void 0===i?void 0:i.description)&&void 0!==a?a:"")}],["OnRoomOpen",()=>{this.networkStatusManager.handleOnRoomOpen(),this.hotDocsManager.handleOnRoomOpen()}],["OnRoomClose",()=>{this.networkStatusManager.handleOnRoomClose(o)}],["OnRoomShutDown",()=>{this.networkStatusManager.handleOnRoomShutDown(o),this.fullMemberManager.handleShutDown(e)}],["OnReceiveMsgFromServer",()=>{var t;return this.receiveMessageManager.handleReceiveMessageFromServer(null===(t=e.data)||void 0===t?void 0:t.serverMsg)}],["OnNetReconnectedFail",()=>this.networkStatusManager.handleNetReconnectedFail()],["OnEnterOnline",()=>this.networkStatusManager.handleOnEnterOnline()],["OnEnterOffline",()=>this.networkStatusManager.handleOnEnterOffline()]]);null===(r=i.get(e.event))||void 0===r||r()})),o.Z.info("MessageCenter new ConnectionController() done")}acceptCommit(e,t,n){this.sendMessageManager.acceptCommit(e,t,n)}applyServerUserChanges(e){return z(this,void 0,void 0,(function*(){return yield this.receiveMessageManager.applyServerUserChanges(e)}))}composeNewChanges(e){var t,n;return null===(n=(t=this.dependency.collabDependency).composeNewChanges)||void 0===n?void 0:n.call(t,e)}}},27543:function(e,t,n){var r=n(64879);t.Z=class{constructor(e){const{subId:t,changesetType:n,taskId:o,time:i,changeset:a,commands:s,base64Commands:c}=e;this.subId=t,this.taskId=o||(0,r.generateMessageTaskId)(),this.time=i||(new Date).getTime(),this.changeset=a,this.commands=s,this.base64Commands=c,n&&(this.changesetType=n)}getTaskId(){return this.taskId}getTime(){return this.time}getChangeset(){return this.changeset||this.commands||""}getBase64Commands(){return this.base64Commands||""}setChangeset(e){this.base64Commands&&(this.base64Commands=e.base64Commands),this.commands?this.commands=e.changeset:this.changeset=e.changeset,e.changesetType&&(this.changesetType=e.changesetType)}}},15064:function(e,t,n){var r=n(27543);class o extends r.Z{constructor(e){super(e),this.head=!1,this.offlineMsg=!1;const{changeSetCount:t,apool:n,keydata:r,oSubId:o,head:i,isWorkbook:a,offlineMsg:s,baseRev:c,firstCommitRev:l,applied:u,otherOptions:d,wordCount:p,onFailed:h,onSuccess:f}=e;this.baseRev=c,this.offlineMsg=s||!1,this.apool=n||"",this.head=i||!1,this.keydata=r,this.oSubId=o||void 0,this.isWorkbook=a,this.firstCommitRev=l,this.changeSetCount=t||1,this.applied=u,this.wordCount=p,this.otherOptions=d,this.onFailed=h,this.onSuccess=f}getBaseVersion(){return this.baseRev}getOtherOptions(){return this.otherOptions}getPreparedData(){return this.prepareCommitMessage()}getData(){const{baseRev:e,changeset:t,changeSetCount:n,subId:r,changesetType:o,apool:i,keydata:a,oSubId:s,taskId:c,head:l,firstCommitRev:u,applied:d,isWorkbook:p,offlineMsg:h,wordCount:f,commands:g,base64Commands:v}=this;return{baseRev:e,changeset:t,changeSetCount:n,changesetType:o,apool:i,keydata:a,subId:r,oSubId:s,head:l,taskId:c,firstCommitRev:u,applied:d,isWorkbook:p,offlineMsg:h,wordCount:f,commands:g,base64Commands:v}}getOriginData(){const{baseRev:e,changeset:t,changeSetCount:n,subId:r,changesetType:o,apool:i,keydata:a,oSubId:s,taskId:c,head:l,time:u,firstCommitRev:d,applied:p,isWorkbook:h,offlineMsg:f,otherOptions:g,wordCount:v,commands:y,base64Commands:m}=this;return{baseRev:e,changeset:t,changeSetCount:n,subId:r,changesetType:o,apool:i,keydata:a,oSubId:s,taskId:c,head:l,time:u,firstCommitRev:d,applied:p,isWorkbook:h,offlineMsg:f,otherOptions:g,wordCount:v,commands:y,base64Commands:m}}updateBaseVersion(e){e>this.baseRev&&(this.baseRev=e)}prepareCommitMessage(){const e={commands:this.commands,base64Commands:this.base64Commands,wordCount:this.wordCount,baseRev:this.baseRev,changeSetCount:this.changeSetCount,changeset:this.changeset,apool:this.apool,keydata:this.keydata||!1,head:this.head,subId:this.subId,oSubId:this.oSubId||!1,taskId:this.taskId,firstCommitRev:this.firstCommitRev,offlineMsg:this.offlineMsg,applied:this.applied,isWorkbook:this.isWorkbook};return this.changesetType&&(e.changesetType=this.changesetType),e}}t.Z=o},61354:function(e,t,n){n.d(t,{P:function(){return r}});var r,o=n(27543);!function(e){e.COLLAB_CHANGE="COLLAB_CHANGE",e.MISS_CHANG="MISS_CHANG",e.BIG_CHANG="BIG_CHANG"}(r||(r={}));class i extends o.Z{constructor(e){super(e);const{apool:t,author:n,head:r,need:o,revert:i,type:a,uuId:s,uuid:c,subId:l,subid:u,newRev:d,isWorkbook:p,userChangesOrigin:h}=e;this.apool=t,this.author=n,this.head=r,this.need=o,this.revert=i,this.type=a,this.subId=null!=l?l:u,this.uuId=null!=s?s:c,this.newRev=d,this.isWorkbook=p,this.userChangesOrigin=h}getVersion(){return this.newRev}getData(){const{newRev:e,subId:t,taskId:n,type:r,uuId:o,changesetType:i,apool:a,author:s,head:c,need:l,revert:u,isWorkbook:d,userChangesOrigin:p}=this;return{changeset:this.getChangeset(),base64Commands:this.base64Commands,newRev:e,new_rev:e,subId:t,changesetType:i,commitId:n,apool:a,author:s,head:c,need:l,revert:u,isWorkbook:d,taskId:n,type:r,uuId:o,userChangesOrigin:p}}}t.Z=i},31268:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(81240),o=n(86246),i=n(52822),a=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};class s extends r.Z{constructor(e){super(e.taskId),this.type=r.U.ACCEPT_TASK;const{to:t,missChangeDependency:n,versionManager:o,acceptCommitDependency:i,otherOptions:a}=e;this.to=t,this.missChangeDependency=n,this.versionManager=o,this.acceptCommitDependency=i,this.otherOptions=a}reset(){this.destory(!1);const{versionManager:e,to:t,missChangeDependency:n,acceptCommitDependency:r,taskId:o,otherOptions:i}=this;return new s({to:t,missChangeDependency:n,versionManager:e,acceptCommitDependency:r,taskId:o,otherOptions:i})}onInit(){return a(this,void 0,void 0,(function*(){return!(this.to<=this.versionManager.getCurrentVersion())}))}onStart(){const{to:e,acceptCommitDependency:t,taskId:n,otherOptions:r}=this,o=this.handleMissChange();if(o)return o;t.acceptCommit(e,n,r)}handleMissChange(){const{to:e}=this,t=this.versionManager.getCurrentVersion();if(this.to>t+1)return i.Z.info(`AcceptTask handleMissChange: need to fetch miss changes. currentVersion = ${t}, to = ${this.to}`),this.generateMissChangeTask(t+1,e-1)}generateMissChangeTask(e,t){const{versionManager:n,missChangeDependency:r,to:i,acceptCommitDependency:a,taskId:c,otherOptions:l}=this,u=new s({to:i,missChangeDependency:r,versionManager:n,acceptCommitDependency:a,taskId:c,otherOptions:l});return[new o.Z({from:e,to:t},{missChangeDependency:r,versionManager:n,acceptCommitDependency:a}),u]}}},81240:function(e,t,n){n.d(t,{U:function(){return r},Z:function(){return s}});var r,o,i=n(52822),a=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};!function(e){e.ACCEPT_TASK="ACCEPT_TASK",e.COLLAB_TASK="COLLAB_TASK",e.MISS_CHANGE_TASK="MISS_CHANGE_TASK",e.BIG_CHANGE_TASK="BIG_CHANGE_TASK"}(r||(r={})),function(e){e.INIT="INIT",e.START="START",e.DESTORY="DESTORY"}(o||(o={}));class s{constructor(e){this.currentStatus=o.INIT,this.onDestroy=()=>{},this.taskId=e||this.getRandomId()}isDestroyed(){return this.currentStatus===o.DESTORY}destory(e,t){this.currentStatus=o.DESTORY,this.onDestroy(e,t)}run(){return a(this,void 0,void 0,(function*(){if(i.Z.info(`task ${this.taskId} run  taskType: ${this.type}`),!(yield this.init()))return void this.destory(!1);const e=yield this.start();if(e)return e;this.destory(!0)}))}break(e){this.destory(!1,e)}getCurrentStatus(){return this.currentStatus}onInit(){return a(this,void 0,void 0,(function*(){return!0}))}onStart(){}init(){return a(this,void 0,void 0,(function*(){if(this.currentStatus!==o.DESTORY)return this.currentStatus=o.INIT,yield this.onInit()}))}start(){return a(this,void 0,void 0,(function*(){if(this.currentStatus!==o.DESTORY)return this.currentStatus=o.START,yield this.onStart()}))}getRandomId(){return Number(Date.now().toString()+(100*Math.random()).toFixed(0))}}},34485:function(e,t,n){n.d(t,{Z:function(){return p}});var r=n(81240),o=n(18561),i=n(61354),a=n(13055),s=n(41225),c=n(31268),l=n(52822),u=n(97275),d=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};class p extends r.Z{constructor(e){super(e.taskId),this.type=r.U.BIG_CHANGE_TASK;const{version:t,missChangeDependency:n,versionManager:o,localUserChangeManager:i,acceptCommitDependency:a,otherOptions:s}=e;this.version=t,this.missChangeDependency=n,this.versionManager=o,this.localUserChangeManager=i,this.acceptCommitDependency=a,this.otherOptions=s,l.Z.info(`new BigChangeTask: version = ${t}`)}reset(){this.destory(!1);const{version:e,taskId:t,missChangeDependency:n,acceptCommitDependency:r,versionManager:o,localUserChangeManager:i,otherOptions:a}=this;return new p({version:e,taskId:t,missChangeDependency:n,localUserChangeManager:i,versionManager:o,acceptCommitDependency:r,otherOptions:a})}onInit(){return d(this,void 0,void 0,(function*(){const{version:e,taskId:t}=this;if(e<=this.versionManager.getCurrentVersion())return!1;if(this.isTaskDuplicate(t))return!0;try{this.userChange=yield this.fetchBigChangeFromServer(this.version)}catch(e){return l.Z.error("BigChangeTask onInit error, error=",null==e?void 0:e.stack,null==e?void 0:e.message),!1}return!0}))}onStart(){l.Z.info(`BigChangeTask onStart, taskId:${this.taskId}, version:${this.version}`);const{taskId:e,version:t,missChangeDependency:n,userChange:r,versionManager:o,acceptCommitDependency:a}=this;if(this.isTaskDuplicate(e))return[new c.Z({to:t,taskId:e,missChangeDependency:n,versionManager:o,acceptCommitDependency:a})];const{commitId:u}=r,d=new i.Z(Object.assign({userChangesOrigin:i.P.BIG_CHANG,taskId:u},r));return[new s.Z(d.getTaskId(),d,{missChangeDependency:n,versionManager:o,acceptCommitDependency:a})]}isTaskDuplicate(e){return[...this.localUserChangeManager.getCommitingQueue().map((e=>e.getTaskId())),...this.localUserChangeManager.getWaitingQueue().map((e=>e.getTaskId()))].indexOf(e)>-1}fetchBigChangeFromServer(e){return d(this,void 0,void 0,(function*(){const t=yield(0,o.Tn)({from:e,to:e,globalPadId:this.missChangeDependency.globalPadId},this.missChangeDependency.getMissChangesUrl).catch((t=>(l.Z.error("BigChangeTask getBigChange error, error=",t),u.Z.report(a.Yo.GET_BIG_CHANGE_ERROR,{version:e}),Promise.reject(t)))),n=t.filter((t=>t.data.newRev===e)).map((e=>e.data)),r=n[0].newRev,i=this.versionManager.getCurrentVersion();if(1!==n.length||r!==i+1)throw l.Z.error(`BigChangeTask getBigChange error, version not consequent, newRev = ${r}, preNewVersion = ${i}`),u.Z.report(a.Yo.BIG_CHANGE_VERSION_ERROR,{version:e,changeList:t}),new Error("MissChangeTask version error");return n[0]}))}}},41225:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(81240),o=n(86246),i=n(52822),a=n(97275),s=n(13055),c=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};class l extends r.Z{constructor(e,t,n){super(e),this.type=r.U.COLLAB_TASK;const{missChangeDependency:o,versionManager:i,acceptCommitDependency:a,otherOptions:s}=n;this.missChangeDependency=o,this.versionManager=i,this.newChange=t,this.acceptCommitDependency=a,this.otherOptions=s}reset(){this.destory(!1);const{taskId:e,missChangeDependency:t,newChange:n,versionManager:r,acceptCommitDependency:o,otherOptions:i}=this;return new l(e,n,{missChangeDependency:t,versionManager:r,acceptCommitDependency:o,otherOptions:i})}onInit(){return c(this,void 0,void 0,(function*(){return!(this.newChange.getVersion()<=this.versionManager.getCurrentVersion())}))}onStart(){return c(this,void 0,void 0,(function*(){const{taskId:e,missChangeDependency:t,newChange:n,versionManager:r,acceptCommitDependency:c,otherOptions:u}=this,d=n.getVersion(),p=this.versionManager.getCurrentVersion();if(d===p+1)yield this.acceptCommitDependency.applyServerUserChanges(n.getData());else{if(d>p+1)return i.Z.info(`CollabTask apply new changes, need MissChange: applyChangeVersion = ${d}, currentVersion = ${p}`),a.Z.report(s.Yo.APPLY_COLLAB_CHANGE_VERSION_BREAK,{currentVersion:p,newVersion:d}),[new o.Z({from:p+1,to:d-1},{missChangeDependency:t,versionManager:r,acceptCommitDependency:c}),new l(e,n,{missChangeDependency:t,versionManager:r,acceptCommitDependency:c,otherOptions:u})];d===p?(a.Z.report(s.Yo.APPLY_COLLAB_CHANGE_VERSION_REPEAT,{currentVersion:p,newVersion:d}),i.Z.info("CollabTask apply new changes, version not change.")):(a.Z.report(s.Yo.APPLY_COLLAB_CHANGE_VERSION_BELOW,{currentVersion:p,newVersion:d}),i.Z.info("CollabTask apply new changes, new version is lower than current version."))}}))}}},86246:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(81240),o=n(18561),i=n(61354),a=n(13055),s=n(52822),c=n(97275),l=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};class u extends r.Z{constructor(e,t){super(t.taskId),this.type=r.U.MISS_CHANGE_TASK;const{from:n,to:o}=e,{missChangeDependency:i,versionManager:a,acceptCommitDependency:c,onDestroy:l,otherOptions:u}=t;this.from=n,this.to=o,this.missChangeDependency=i,this.versionManager=a,this.acceptCommitDependency=c,this.otherOptions=u,l&&(this.onDestroy=l),s.Z.info(`new MissChangeTask: from = ${n}, to = ${o}`)}reset(){this.destory(!1);const{taskId:e,from:t,to:n,missChangeDependency:r,acceptCommitDependency:o,versionManager:i,onDestroy:a,otherOptions:s}=this;return new u({from:t,to:n},{taskId:e,missChangeDependency:r,versionManager:i,acceptCommitDependency:o,onDestroy:a,otherOptions:s})}onInit(){return l(this,void 0,void 0,(function*(){if(void 0!==this.to&&this.to<=this.versionManager.getCurrentVersion())return!1;this.from<=this.versionManager.getCurrentVersion()&&(this.from=this.versionManager.getCurrentVersion()+1);try{this.initTime=Date.now(),this.missChangeList=yield this.fetchMissChangeFromServer(this.from,this.to)}catch(e){return s.Z.error("MissChangeTask onInit error, error=",null==e?void 0:e.stack,null==e?void 0:e.message),Promise.reject(e)}return!0}))}onStart(){var e,t,n;return l(this,void 0,void 0,(function*(){const r=null===(e=this.missChangeList)||void 0===e?void 0:e.length;if(s.Z.info(`MissChangeTask onStart, length=${r}`),this.missChangeList){const e=Date.now();this.missChangeList=(null===(n=(t=this.acceptCommitDependency).composeNewChanges)||void 0===n?void 0:n.call(t,this.missChangeList))||this.missChangeList;for(const e of this.missChangeList){const t=Number(e.commitId);if(s.Z.info(`MissChangeTask applyServerUserChanges start, taskId=${t}`),!(yield this.acceptCommitDependency.applyServerUserChanges(Object.assign({userChangesOrigin:i.P.MISS_CHANG,taskId:t},e))))return void s.Z.error(`MissChangeTask applyServerUserChanges error, taskId=${t}, change=`,e)}const o=Date.now()-e,l=this.initTime?Date.now()-this.initTime:0;s.Z.info(`MissChangeTask cost, originLength=${r}, composedLength=${this.missChangeList.length}, cost=${o}, fullTimeCost=${l}`),c.Z.report(a.Yo.APPLY_SERVER_USER_CHANGE_COST,{length:r,timeCost:o,fullTimeCost:l})}}))}fetchMissChangeFromServer(e,t){return l(this,void 0,void 0,(function*(){const n=yield(0,o.Tn)({from:e,to:t,globalPadId:this.missChangeDependency.globalPadId,customReferUrl:this.missChangeDependency.customReferUrl},this.missChangeDependency.getMissChangesUrl,this.missChangeDependency.sendMissChangeRequest).catch((e=>{var t;return s.Z.error("MissChangeTask getMissChange error, message=",null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message,e),Promise.reject(e)}));let r=this.versionManager.getCurrentVersion();for(const o of n){const n=o.data.newRev;if(n!==r+1)throw s.Z.error(`MissChangeTask getMissChange error, version not consequent, newRev = ${n}, preNewVersion = ${r}`),c.Z.report(a.Yo.MISS_CHANGE_VERSION_ERROR,{from:e,to:t,preNewVersion:r,userChange:o}),new Error("MissChangeTask version error");r=n}return n.filter((t=>t.data.newRev>=e)).map((e=>e.data))}))}}},66545:function(e,t,n){n(52822)},13055:function(e,t,n){var r,o;n.d(t,{FI:function(){return i},Yo:function(){return o},iv:function(){return a},nn:function(){return r}}),function(e){e.NEW_CHANGES="NEW_CHANGES",e.BIG_CHANGES="BIG_CHANGES",e.USER_NEWINFO="USER_NEWINFO",e.USER_NEWINFOS="USER_NEWINFOS",e.USER_LEAVE="USER_LEAVE",e.RIGHT_MESSAGE="RIGHT_MESSAGE",e.REVERT_MESSAGE="REVERT_MESSAGE",e.LAST_REVERSION="LAST_REVERSION",e.CURSOR_MESSAGE="CURSOR_MESSAGE",e.CURSOR_MESSAGES="CURSOR_MESSAGES",e.CODEREV_NEW="CODEREV_NEW",e.TITLE_MESSAGE="TITLE_MESSAGE",e.HANDLE_DELETE="HANDLE_DELETE",e.COMM_NOTICE="COMM_NOTICE",e.MARK_MESSAGE="MARK_MESSAGE",e.LIVE_MESSAGE="LIVE_MESSAGE",e.PRESENT_INFO="PRESENT_INFO"}(r||(r={})),function(e){e.BATCH_COMMIT_ERROR="BATCH_COMMIT_ERROR",e.RETRY_COMMIT="RETRY_COMMIT",e.SEND_USERCHANGE="SEND_USERCHANGE",e.ACCEPT_TASK_DUPLICATE="ACCEPT_TASK_DUPLICATE",e.HANDLE_NEW_CHANGES="HANDLE_NEW_CHANGES",e.HANDLE_TASK_DUPLICATE_VERSION_ERROR="HANDLE_TASK_DUPLICATE_VERSION_ERROR",e.HANDLE_FOLLOW_ERROR="HANDLE_FOLLOW_ERROR",e.APPLY_SERVER_USER_CHANGE_ERROR="APPLY_SERVER_USER_CHANGE_ERROR",e.APPLY_COLLAB_CHANGE_VERSION_BREAK="APPLY_COLLAB_CHANGE_VERSION_BREAK",e.APPLY_COLLAB_CHANGE_VERSION_REPEAT="APPLY_COLLAB_CHANGE_VERSION_REPEAT",e.APPLY_COLLAB_CHANGE_VERSION_BELOW="APPLY_COLLAB_CHANGE_VERSION_BELOW",e.GET_MISS_CHANGE_ERROR="GET_MISS_CHANGE_ERROR",e.MISS_CHANGE_VERSION_ERROR="MISS_CHANGE_VERSION_ERROR",e.GET_BIG_CHANGE_ERROR="GET_BIG_CHANGE_ERROR",e.BIG_CHANGE_VERSION_ERROR="BIG_CHANGE_VERSION_ERROR",e.COMMITING_BLOCK_ERROR="COMMITING_BLOCK_ERROR",e.UPDATE_VERSION_ERROR="UPDATE_VERSION_ERROR",e.COMMIT_REQUEST_SUCCESS="COMMIT_REQUEST_SUCCESS",e.COMMIT_REQUEST_FAIL="COMMIT_REQUEST_FAIL",e.TASK_QUEUE_NOT_RESUME_AFTER_60_SECOND="TASK_QUEUE_NOT_RESUME_AFTER_60_SECOND",e.APPLY_SERVER_USER_CHANGE_COST="APPLY_SERVER_USER_CHANGE_COST"}(o||(o={}));const i={[o.BATCH_COMMIT_ERROR]:"",[o.RETRY_COMMIT]:"",[o.SEND_USERCHANGE]:" Socket ",[o.ACCEPT_TASK_DUPLICATE]:" TASK_DUPLICATE ",[o.HANDLE_NEW_CHANGES]:"",[o.HANDLE_TASK_DUPLICATE_VERSION_ERROR]:"",[o.HANDLE_FOLLOW_ERROR]:"",[o.APPLY_SERVER_USER_CHANGE_ERROR]:" ApplyServerUserChanges ",[o.APPLY_COLLAB_CHANGE_VERSION_BREAK]:"",[o.APPLY_COLLAB_CHANGE_VERSION_REPEAT]:"",[o.APPLY_COLLAB_CHANGE_VERSION_BELOW]:"",[o.GET_MISS_CHANGE_ERROR]:" CGI ",[o.MISS_CHANGE_VERSION_ERROR]:"",[o.COMMITING_BLOCK_ERROR]:"",[o.GET_BIG_CHANGE_ERROR]:" CGI ",[o.BIG_CHANGE_VERSION_ERROR]:"",[o.UPDATE_VERSION_ERROR]:"",[o.COMMIT_REQUEST_SUCCESS]:"",[o.COMMIT_REQUEST_FAIL]:"",[o.TASK_QUEUE_NOT_RESUME_AFTER_60_SECOND]:" 1 ",[o.APPLY_SERVER_USER_CHANGE_COST]:"ApplyServerUserChanges"};var a;!function(e){e.AJAX_ERROR="AJAX_ERROR",e.RESULT_DATA_UNDEFINED="RESULT_DATA_UNDEFINED",e.RETCODE_ERROR="RETCODE_ERROR",e.RESULT_CHANGES_EMPTY="RESULT_CHANGES_EMPTY",e.FROM_BELOW_TO_ERROR="FROM_BELOW_TO_ERROR",e.FETCH_CGI_ERROR="FETCH_CGI_ERROR"}(a||(a={}))},58513:function(e,t,n){var r;!function(e){e.ON_ERROR="ON_ERROR",e.ON_SEND_ACCEPT="ON_SEND_ACCEPT"}(r||(r={}))},16531:function(e,t,n){n.d(t,{Q:function(){return i}});class r{constructor(e){this.element=e,this.next=r.Undefined,this.prev=r.Undefined}}r.Undefined=new r(void 0);class o{constructor(){this._first=r.Undefined,this._last=r.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===r.Undefined}clear(){this._first=r.Undefined,this._last=r.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}shift(){if(this._first!==r.Undefined){const e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==r.Undefined){const e=this._last.element;return this._remove(this._last),e}}*[Symbol.iterator](){let e=this._first;for(;e!==r.Undefined;)yield e.element,e=e.next}toArray(){const e=[];for(let t=this._first;t!==r.Undefined;t=t.next)e.push(t.element);return e}_insert(e,t){const n=new r(e);if(this._first===r.Undefined)this._first=n,this._last=n;else if(t){const e=this._last;this._last=n,n.prev=e,e.next=n}else{const e=this._first;this._first=n,n.next=e,e.prev=n}this._size+=1;let o=!1;return()=>{o||(o=!0,this._remove(n))}}_remove(e){if(e.prev!==r.Undefined&&e.next!==r.Undefined){const t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===r.Undefined&&e.next===r.Undefined?(this._first=r.Undefined,this._last=r.Undefined):e.next===r.Undefined?(this._last=this._last.prev,this._last.next=r.Undefined):e.prev===r.Undefined&&(this._first=this._first.next,this._first.prev=r.Undefined);this._size-=1}}class i{constructor(e){this._disposed=!1,this._options=e}get event(){return this._event||(this._event=(e,t,n)=>{var r,i,a;this._listeners||(this._listeners=new o);const s=this._listeners.isEmpty();s&&(null===(r=this._options)||void 0===r?void 0:r.onFirstListenerAdd)&&this._options.onFirstListenerAdd(this);const c=this._listeners.push(t?[e,t]:e);s&&(null===(i=this._options)||void 0===i?void 0:i.onFirstListenerDidAdd)&&this._options.onFirstListenerDidAdd(this),(null===(a=this._options)||void 0===a?void 0:a.onListenerDidAdd)&&this._options.onListenerDidAdd(this,e,t);const l={dispose:()=>{var e;!this._disposed&&(c(),null===(e=this._options)||void 0===e?void 0:e.onLastListenerRemove)&&(this._listeners&&!this._listeners.isEmpty()||this._options.onLastListenerRemove(this))}};return Array.isArray(n)&&n.push(l),l}),this._event}fire(e){if(this._listeners){this._deliveryQueue||(this._deliveryQueue=new o);for(const t of this._listeners)this._deliveryQueue.push([t,e]);for(;this._deliveryQueue.size>0;){const[e,t]=this._deliveryQueue.shift();try{"function"==typeof e?e.call(void 0,t):e[0].call(e[1],t)}catch(e){console.error(e)}}}}dispose(){this._listeners&&this._listeners.clear(),this._deliveryQueue&&this._deliveryQueue.clear(),this._disposed=!0}}var a;!function(e){function t(e){return(t,n=null,r)=>{let o=!1;const i=e((e=>{if(!o)return i?i.dispose():o=!0,t.call(n,e)}),null,r);return o&&i.dispose(),i}}e.once=t,e.signal=function(e){return e},e.buffer=function(e,t=!1,n=[]){let r=n.slice(),o=e((e=>{r?r.push(e):s.fire(e)}));const a=()=>{r&&r.forEach((e=>s.fire(e))),r=null},s=new i({onFirstListenerAdd(){o||(o=e((e=>s.fire(e))))},onFirstListenerDidAdd(){r&&(t?setTimeout(a):a())},onLastListenerRemove(){o&&o.dispose(),o=null}});return s.event},e.fromPromise=function(e){const t=new i;let n=!1;return e.then(void 0,(()=>null)).then((()=>{n?t.fire(void 0):setTimeout((()=>t.fire(void 0)),0)})),n=!0,t.event},e.toPromise=function(e){return new Promise((n=>t(e)(n)))}}(a||(a={}))},18561:function(e,t,n){n.d(t,{Tn:function(){return p}});var r=n(14366),o=n(13055),i=n(52822),a=n(97275),s=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};function c(e,t){return s(this,void 0,void 0,(function*(){try{let n;return n=t?yield function(e,t){return s(this,void 0,void 0,(function*(){const n=yield fetch(e,{method:"GET",headers:{"Content-Type":"application/json"},referrer:t}),r=yield n.json();return{isSuccess:!0,data:Object.assign({data:r},r)}}))}(e,t):yield function(e){return s(this,void 0,void 0,(function*(){return{isSuccess:!0,data:yield(0,r.Z)({method:"get",url:e,responseType:"json"})}}))}(e),n}catch(e){return{isSuccess:!1,error:e,data:void 0,errorDescription:o.iv.AJAX_ERROR}}}))}function l({url:e,maxRetryCount:t=2,customReferUrl:n,retryInterval:r}){return s(this,void 0,void 0,(function*(){let o={isSuccess:!1,data:void 0},i=0;for(;i<=t;){if(o=yield c(e,n),o.isSuccess){if(!(null==o?void 0:o.data))return o;if(u(o.data).isSuccess)return o}i+=1;const t=null!=r?r:10*i*1e3;yield new Promise((e=>setTimeout(e,t)))}return o}))}function u(e){var t,n;const{data:r}=e;let i,a,s=!0;return void 0===r?(s=!1,i=o.iv.RESULT_DATA_UNDEFINED):0!==(null==r?void 0:r.retcode)?(s=!1,i=o.iv.RETCODE_ERROR,a=null==r?void 0:r.retcode):0===(null===(n=null===(t=null==r?void 0:r.result)||void 0===t?void 0:t.changes)||void 0===n?void 0:n.length)&&(s=!1,i=o.iv.RESULT_CHANGES_EMPTY),{isSuccess:s,errorDescription:i,retcode:a}}function d(e,t,n){return s(this,void 0,void 0,(function*(){if(!function(e){return!(void 0!==e.to&&e.to<e.from)}(e))return{isSuccess:!1,data:void 0,errorDescription:o.iv.FROM_BELOW_TO_ERROR};const r=yield t(e),a=yield(n||l)({url:r,customReferUrl:e.customReferUrl,retryInterval:e.retryInterval}),{data:s}=a;if(!a.isSuccess)return{isSuccess:!1,data:void 0,error:a.error,errorDescription:o.iv.FETCH_CGI_ERROR};const{isSuccess:c,errorDescription:d,retcode:p}=u(s);return i.Z.info(`getMissChangeUrl, isSuccess: ${c} retcode: ${p}, errorDescription: ${d}`),{data:null==s?void 0:s.data.result,isSuccess:c,errorDescription:d,retcode:p}}))}function p(e,t,n){return s(this,void 0,void 0,(function*(){const r=[];let i=Object.assign({},e);for(;;){const u=yield d(i,t,n);if(!u.isSuccess)return a.Z.report(o.Yo.GET_MISS_CHANGE_ERROR,{options:e,result:u}),Promise.reject(u);r.push(...u.data.changes);const p=(s=e.to,c=u.data.to,l=u.data.rev,void 0===s&&l>c?{isFinish:!1,from:c+1,to:l}:void 0!==s&&s>c&&s<=l?{isFinish:!1,from:c+1,to:s}:{isFinish:!0});if(p.isFinish)return r;i=Object.assign(e,{from:p.from,to:p.to})}var s,c,l}))}},52822:function(e,t,n){n.d(t,{k:function(){return r}});var r,o=n(16531);!function(e){e.INFO="INFO",e.ERROR="ERROR",e.WARN="WARN",e.DEBUG="DEBUG"}(r||(r={})),t.Z=new class{constructor(){this.onLogEmitter=new o.Q,this.onLog=this.onLogEmitter.event,this.initLogger()}dispose(){this.onLogEmitter.dispose()}initLogger(){this.info=(...e)=>{this.onLogEmitter.fire({type:"INFO",data:e})},this.debug=(...e)=>{this.onLogEmitter.fire({type:"DEBUG",data:e})},this.warn=(...e)=>{this.onLogEmitter.fire({type:"WARN",data:e})},this.error=(...e)=>{this.onLogEmitter.fire({type:"ERROR",data:e})}}}},97275:function(e,t,n){var r=n(16531),o=n(13055);t.Z=new class{constructor(){this.onReportEmitter=new r.Q,this.onReport=this.onReportEmitter.event,this.initReporter()}dispose(){this.onReportEmitter.dispose()}initReporter(){this.report=(e,t)=>{this.onReportEmitter.fire({type:e,remark:o.FI[e],data:t})}}}},93648:function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Command=void 0,function(e){e.UNKNOWN="UNKNOWN",e.HEART_BEAT="HEART_BEAT",e.CLIENT_READY="CLIENT_READY",e.CURSOR_MESSAGE="CURSOR_MESSAGE",e.USER_NEWINFO="USER_NEWINFO",e.USER_NEWINFOS="USER_NEWINFOS",e.USER_LEAVE="USER_LEAVE",e.USER_LEAVES="USER_LEAVES",e.QUIT_NOTICE="QUIT_NOTICE",e.USER_CHANGES="USER_CHANGES",e.NEW_CHANGES="NEW_CHANGES",e.ACCEPT_COMMIT="ACCEPT_COMMIT",e.GET_PRIVILEGE="GET_PRIVILEGE",e.BIG_COLLAB_SWITCH="BIG_COLLAB_SWITCH",e.COMMON_REQUEST="COMMON_REQUEST",e.BIND_POST="BIND_POST",e.CLIENT_DISCONNECT="CLIENT_DISCONNECT",e.LIVE_MESSAGE="LIVE_MESSAGE"}(n||(n={})),t.Command=n},36932:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},18247:function(e,t){var n,r=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},n(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.HttpError=void 0;var o=function(e){function t(t,n){var r=e.call(this,t+", statusCode:"+n+" ")||this;return r.name="HttpError",r.statusCode=n,r}return r(t,e),t}(Error);t.HttpError=o},8254:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(36932),t),o(n(93648),t),o(n(10805),t),o(n(18247),t),o(n(797),t)},797:function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.ContentTypeValue=t.ContentTypeValueMap=t.HttpStatus=t.Method=t.ContentType=void 0,function(e){e.JSON="JSON",e.FORM="FORM"}(n||(n={})),t.ContentType=n,function(e){e.JSON="application/json",e.FORM="application/x-www-form-urlencoded"}(r||(r={})),t.ContentTypeValue=r;var o,i,a=new Map([[n.JSON,r.JSON],[n.FORM,r.FORM]]);t.ContentTypeValueMap=a,function(e){e.POST="POST",e.GET="GET"}(o||(o={})),t.Method=o,function(e){e[e.SUCCESS=200]="SUCCESS",e[e.NOT_FOUND=404]="NOT_FOUND"}(i||(i={})),t.HttpStatus=i},10805:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Result=void 0;var n=function(e,t){e&&(this.error=e),void 0!==t&&(this.data=t)};t.Result=n},63817:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},5754:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},20617:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.BigDataChannel=t.BuildBigDataChannel=void 0;var a=n(74586),s=n(59041),c=n(3954),l="/dop-api/commitchanges",u=function(){function e(e,t){this.options=e,this.dependency=t}return e.prototype.dispose=function(){a.ConnectionLog.warn("BigDataChannel dispose.")},e.prototype.sendMessage=function(e){var t,n;return o(this,void 0,void 0,(function(){var r,o,s,c=this;return i(this,(function(i){switch(i.label){case 0:return 0!==(r=this.preCheck(e)).errCode||"object"!=typeof e.data?[3,2]:(o=[e.data],[4,this.bigChangesCommit(o)]);case 1:return s=i.sent(),a.ConnectionLog.info("bigChangesCommitResult : "+s.success+" retcode:"+s.retCode+" bodyLength:"+s.bodyLength),s.success?null===(t=s.data)||void 0===t||t.forEach((function(t){var n;if(t.commitId===e.taskId){var r={errCode:0,response:{new_rev:t.new_rev}};null===(n=e.onsendAccept)||void 0===n||n.call(e,t.commitId,"USER_CHANGES",e.data,"ACCEPT_COMMIT",r)}else{var o=c.createServerMessage(t);c.dependency.receiveMessageFromServer("NEW_CHANGES",[o])}})):e.onError(e.taskId,e.cmd,e.data,{errCode:null!==(n=s.retCode)&&void 0!==n?n:52e3,errMsg:s.reason}),[3,3];case 2:e.onError(e.taskId,e.cmd,e.data,r),i.label=3;case 3:return[2]}}))}))},e.prototype.batchCommitMessages=function(e,t,n){return o(this,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return r=this.packUserChanges(e,t,n),[4,this.batchChangesRequest(this.options.serverVars.globalPadId,r,n)];case 1:return o=i.sent(),[2,this.getCommitResult(o,t)]}}))}))},e.prototype.batchChangesRequest=function(e,t,n){return o(this,void 0,void 0,(function(){var r,o,c,u;return i(this,(function(i){return r=a.Cookie.getXsrf(),o=l+"?padId="+e+"&xsrf="+r+"&"+((null==n?void 0:n.urlParameter)?null==n?void 0:n.urlParameter:""),c=a.JsonUtil.jsonStringify(t),c=encodeURIComponent(c),u={url:o,method:s.Method.POST,body:"data="+c,contentType:s.ContentType.FORM},[2,(new s.Request).sendCommonRequest(u)]}))}))},e.prototype.bigChangesCommit=function(e){return o(this,void 0,void 0,(function(){var t,n,r;return i(this,(function(o){switch(o.label){case 0:return t=this.packUserChanges(e),(n=this.bigChangesRequestBody(this.options.serverVars.globalPadId,t)).length>=20971520?[2,{success:!1,retCode:52003,bodyLength:n.length,data:[]}]:[4,this.bigChangesRequest(n)];case 1:return r=o.sent(),[2,this.getCommitResult(r)]}}))}))},e.prototype.bigChangesRequest=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(n){return t={url:l,method:s.Method.POST,body:e,contentType:s.ContentType.JSON},[2,(new s.Request).sendCommonRequest(t)]}))}))},e.prototype.bigChangesRequestBody=function(e,t){var n=a.Cookie.getXsrf();return a.JsonUtil.jsonStringify({padId:e,xsrf:n,data:a.JsonUtil.jsonStringify(t)})},e.prototype.getCommitResult=function(e,t){var n,r,o={success:!1,retCode:0,data:[]};if(e.error){o.type="NetworkException";var i=null===(n=e.error)||void 0===n?void 0:n.statusCode;return 413===i&&(o.retCode=52003),a.ConnectionLog.error("batchCommitMessages: "+(null===(r=e.error)||void 0===r?void 0:r.message)+", statusCode:"+i),o}var s=a.JsonUtil.parseJson(e.data);return 0===(null==s?void 0:s.retcode)?(s.Data.respective.forEach((function(e){var n;a.ConnectionLog.info("batchCommitMessages rev:"+t+", newRev:"+e.newRev+", taskId:"+e.commitId),null===(n=o.data)||void 0===n||n.push(e)})),o.type="Success",o.success=!0):(o.retCode=s.retcode,o.type="ServerVerityException",o.reason=s.retmsg,a.ConnectionLog.error("batchCommitMessages retcode:"+(null==s?void 0:s.retcode)+" retmsg:"+(null==s?void 0:s.retmsg))),o},e.prototype.preCheck=function(e){var t={errCode:0};return e.data&&"string"!=typeof e.data||(t.errMsg="send data type is conrect.",t.errCode=52001),t},e.prototype.packUserChanges=function(e,t,n){var o,i=this,a=e[0];return{common:r(r({},null==n?void 0:n.additionalFieldsToCommon),{type:"USER_CHANGES",curRev:t,offlineMsg:!0,docid:this.options.serverVars.globalPadId,uid:this.options.uid,dver:this.options.serverVars.dver,base_rev:a.baseRev,code_ver:0,session_type:0,gray:this.options.serverVars.gray||0,generalpacket:null===(o=this.options.config)||void 0===o?void 0:o.headerGeneralPacket,pver:this.options.serverVars.pver,uuId:this.options.uuId}),respective:e.map((function(e){return i.getRespectiveItem(e)}))}},e.prototype.getRespectiveItem=function(e){var t={task_id:e.taskId,subId:e.subId,oSubId:e.oSubId||!1,head:e.head||!1,keydata:e.keydata||!1,changeSetCount:e.changeSetCount||1,changeset:e.changeset,changesetType:e.changesetType,apool:e.apool,isWorkbook:e.isWorkbook};return this.options.module===c.DOCUMENT_TYPE.DOC?(t.commands=e.base64Commands||e.changeset,t.changeset=""):t.changeset=e.changeset,t},e.prototype.createServerMessageHead=function(e){return{base_rev:e.new_rev-1,docid:this.options.serverVars.globalPadId,dver:this.options.serverVars.dver,new_rev:e.new_rev,session_type:0,type:"USER_CHANGES",uid:this.options.uid,uuid:this.options.uuId}},e.prototype.createServerMessageBody=function(e){var t;return{data:{apool:e.apool,author:e.author,changeset:e.changeset,commitId:e.commitId,head:e.head,isWorkbook:e.isWorkbook||!1,need:e.need,revert:e.revert,subId:null!==(t=e.subId)&&void 0!==t?t:e.subid,newRev:e.newRev,new_rev:e.newRev,type:e.type,uuId:this.options.uuId}}},e.prototype.createServerMessage=function(e){return{head:this.createServerMessageHead(e),body:this.createServerMessageBody(e),newRev:e.newRev,socketId:""}},e}();t.BigDataChannel=u,t.BuildBigDataChannel=function(e,t){return new u(e,t)}},63489:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(63817),t),o(n(20617),t),o(n(5754),t)},59041:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ContentType=t.Request=t.Method=void 0;var i=n(74586),a=n(8254);Object.defineProperty(t,"Method",{enumerable:!0,get:function(){return a.Method}}),Object.defineProperty(t,"ContentType",{enumerable:!0,get:function(){return a.ContentType}});var s=function(){function e(){}return e.prototype.sendCommonRequest=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){return[2,new Promise((function(t){try{var n,r=new XMLHttpRequest;r.onreadystatechange=function(){if(r.readyState===XMLHttpRequest.DONE){var e="";200===r.status?e=r.responseText:n=new a.HttpError("StatusError",r.status),t(new a.Result(n,e))}};try{r.timeout=3e4}catch(e){i.ConnectionLog.error("request error message: "+(null==e?void 0:e.message))}r.ontimeout=function(){n=new Error("TimeOutError"),t(new a.Result(n))},r.open(e.method,e.url),e.contentType===a.ContentType.JSON?(r.setRequestHeader("content-type",a.ContentTypeValue.JSON),r.setRequestHeader("content-encoding","gzip")):r.setRequestHeader("content-type",a.ContentTypeValue.FORM),r.send(e.body)}catch(e){t(new a.Result(e))}}))]}))}))},e}();t.Request=s},64033:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.RetCode=t.HttpStatus=t.Method=void 0;var r,o=n(8254);Object.defineProperty(t,"Method",{enumerable:!0,get:function(){return o.Method}}),Object.defineProperty(t,"HttpStatus",{enumerable:!0,get:function(){return o.HttpStatus}}),function(e){e[e.SUCCESS=0]="SUCCESS"}(r||(r={})),t.RetCode=r},7594:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseChannel=void 0;var i=n(58324),a=n(74586),s=function(){function e(e,t){this.options=e,this.defaultConfig=t}return e.prototype.dispose=function(){this.paramsPacker=void 0,this.responseHandler=void 0},e.prototype.sendMessage=function(e){return r(this,void 0,void 0,(function(){var t,n,r,s,c,l;return o(this,(function(o){switch(o.label){case 0:return this.paramsPacker&&this.responseHandler?(n=this.paramsPacker.pack(e,this.options),r=e.requestUrl,s=e.method,c=e.contentType,[4,(new i.Request).sendRequest(null!=r?r:this.defaultConfig.requestUrl,null!=s?s:this.defaultConfig.method,null!=c?c:this.defaultConfig.contentType,n)]):(t="Channel Error, sendMessage failed paramsPacker:"+this.paramsPacker+", responseHandler:"+this.responseHandler+" ",a.ConnectionLog.error(t),[2,{error:t}]);case 1:return l=o.sent(),[2,this.responseHandler.handle(l)]}}))}))},e}();t.BaseChannel=s},58324:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Request=void 0;var i=n(90304),a=n(74586),s=n(64033),c=n(8254),l=function(){function e(){}return e.prototype.sendRequest=function(e,t,n,l){var u,d,p;return void 0===t&&(t=s.Method.POST),void 0===n&&(n=c.ContentType.FORM),r(this,void 0,void 0,(function(){var r,h;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,5,,6]),r=void 0,t!==s.Method.GET?[3,2]:[4,i.networkRequest.get(e)];case 1:return r=o.sent(),[3,4];case 2:return[4,i.networkRequest.post(e,l,{contentType:c.ContentTypeValueMap.get(n)})];case 3:r=o.sent(),o.label=4;case 4:return[2,new c.Result(void 0,r)];case 5:return h=o.sent(),a.ConnectionLog.error("Request Failed, requestUrl:"+e+", status:"+(null===(u=null==h?void 0:h.request)||void 0===u?void 0:u.status)+", response:"+(null===(d=null==h?void 0:h.request)||void 0===d?void 0:d.response)+", responseText:"+(null===(p=null==h?void 0:h.request)||void 0===p?void 0:p.responseText)+", error stack:"+(null==h?void 0:h.stack)+", error message:"+(null==h?void 0:h.message)),[2,new c.Result(h)];case 6:return[2]}}))}))},e}();t.Request=l},14378:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},4092:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.BuildBigCollabChannel=t.BigCollabChannel=void 0;var r=n(74586),o=n(38506),i=n(38988),a=n(31078),s=function(){function e(e,t){this.tag="BigCollabChannel",this.connectStatusManager=new i.ConnectStatusManager(e,t),this.messageCenter=new a.MessageCenter(e,t,this.connectStatusManager)}return e.prototype.dispose=function(){this.connectStatusManager.dispose(),this.messageCenter.dispose()},e.prototype.connect=function(){r.ConnectionLog.info(this.tag+" connect"),this.connectStatusManager.connect()},e.prototype.isConnected=function(){return this.connectStatusManager.isConnected()},e.prototype.isDisconnected=function(){return this.connectStatusManager.isDisconnected()},e.prototype.disconnect=function(e){r.ConnectionLog.error(this.tag+" disconnect, shutdown:"+e.shutDown+", errCode:"+e.errCode+" reason:"+e.reason),this.connectStatusManager.disconnect(e)},e.prototype.sendMessage=function(e){var t,n=e.taskId,r=e.cmd,i=e.data;this.connectStatusManager.isConnected()?this.messageCenter.sendMessage(e):null===(t=e.onError)||void 0===t||t.call(e,n,r,i,{errCode:this.connectStatusManager.isDisconnected()?o.RoomErrorCode.ROOM_SHUTDOWN:o.RoomErrorCode.ROOM_STATE_ERR,errMsg:"can not send message in this room state."})},e}();t.BigCollabChannel=s,t.BuildBigCollabChannel=function(e,t){return new s(e,t)}},94937:function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectStatus=void 0,function(e){e.INIT="INIT",e.LOGIN="LOGIN",e.LOGIN_FAIL="LOGIN_FAIL",e.LOGINED="LOGINED",e.CONNECTED="CONNECTED",e.DISCONNECT="DISCONNECT",e.WAIT_RECONNECTING="WAIT_RECONNECTING"}(n||(n={})),t.ConnectStatus=n},38988:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectStatusManager=void 0;var i=n(36023),a=n(13909),s=n(94937),c=n(74586),l=o(n(39472)),u=n(38506),d=o(n(98466)),p=function(){function e(e,t){this.options=e,this.dependency=t,this.onConnectEventEmitter=new i.Emitter,this.tag="ConnectStatusManager",this.connectStatus=s.ConnectStatus.INIT,this.onConnectEvent=this.onConnectEventEmitter.event,this.bigCollabLogin=new a.BigCollabLogin(this.options,r(r({},this.dependency),{login:this.login.bind(this)})),new d.default({disconnect:this.disconnect.bind(this)})}return e.prototype.dispose=function(){this.bigCollabLogin.dispose(),this.onConnectEventEmitter.dispose()},e.prototype.connect=function(){this.needLogin()?this.bigCollabLogin.connect():c.ConnectionLog.warn(this.tag+" not connect. connectStatus:"+this.connectStatus)},e.prototype.isConnected=function(){return this.connectStatus===s.ConnectStatus.CONNECTED},e.prototype.reconnect=function(e){this.setConnnectStatus(s.ConnectStatus.WAIT_RECONNECTING),this.bigCollabLogin.reconnect(e)},e.prototype.isDisconnected=function(){return this.connectStatus===s.ConnectStatus.DISCONNECT},e.prototype.disconnect=function(e){var t,n,r,o;if(c.ConnectionLog.info(this.tag+" disconnect errorCode:"+e.errCode+", reason:"+e.reason+" shutdown:"+e.shutDown),this.bigCollabLogin.clearTimer(),e.shutDown)return this.bigCollabLogin.disconnect(),this.setConnnectStatus(s.ConnectStatus.DISCONNECT),this.dependency.disconnect(e),void l.default.shutDownReport({module:this.options.module,attrName:String(null!==(t=e.errCode)&&void 0!==t?t:0),status:1,errorMessage:null!==(n=e.reason)&&void 0!==n?n:u.RoomUtil.getWebsocketChannelErrorMessage(null!==(r=e.errCode)&&void 0!==r?r:0)});this.bigCollabLogin.disconnect(),this.dependency.disconnect(e),l.default.reconnectReport({attrName:String(null!==(o=e.errCode)&&void 0!==o?o:0),errorMessage:e.reason,status:1}),this.reconnect(e.reconnectTime)},e.prototype.onConnectSuccess=function(){this.isConnected()||(this.setConnnectStatus(s.ConnectStatus.CONNECTED),this.dependency.connected())},e.prototype.login=function(e,t,n){this.setConnnectStatus(e,t),e===s.ConnectStatus.LOGIN_FAIL&&this.disconnect(null!=n?n:{shutDown:!1})},e.prototype.needLogin=function(){return[s.ConnectStatus.INIT,s.ConnectStatus.WAIT_RECONNECTING].includes(this.connectStatus)},e.prototype.setConnnectStatus=function(e,t){c.ConnectionLog.info(this.tag+" setConnnectStatus: oldState:"+this.connectStatus+", newStatus = "+e),e!==this.connectStatus&&(this.connectStatus=e,this.onConnectEventEmitter.fire({status:e,serverRequestParams:t}))},e}();t.ConnectStatusManager=p},20141:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PAGE_UNLOAD_TIME=t.DEFAULT_MIN_TRY_COUNT=t.MAX_DELAY_TIME=t.DEFAULT_DELAY_TIME=void 0,t.DEFAULT_MIN_TRY_COUNT=1,t.DEFAULT_DELAY_TIME=0,t.PAGE_UNLOAD_TIME=2e3,t.MAX_DELAY_TIME=3e4},13909:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BigCollabLogin=void 0;var s=n(50051),c=n(8254),l=n(50252),u=n(64033),d=n(20141),p=n(38506),h=n(74586),f=a(n(39472)),g=n(94937),v=n(28859),y=function(){function e(e,t){this.options=e,this.dependency=t,this.retryCount=0,this.delayConnectTime=d.DEFAULT_DELAY_TIME,this.delayConnectTimer=0,this.setRouteKey()}return e.prototype.dispose=function(){this.clearTimer()},e.prototype.clearTimer=function(){clearTimeout(this.delayConnectTimer),this.delayConnectTimer=0},e.prototype.connect=function(){0!==this.retryCount?this.reconnect():this.sendConnectRequest()},e.prototype.disconnect=function(){if(!this.sid||!this.token)return!1;var e=(new l.Request).sendBeacon(this.getUnbindPath(),r(r({},this.createMessage("CLIENT_DISCONNECT")),{sid:this.sid,token:this.token}));return this.sid=void 0,this.token=void 0,e},e.prototype.reconnect=function(e){var t=this;if(!this.delayConnectTimer){var n=this.getDelayConnectTime(e);this.delayConnectTimer=setTimeout((function(){t.retryCount===d.DEFAULT_MIN_TRY_COUNT&&t.dependency.disconnect({shutDown:!1,reason:"big collab login timeout."}),t.retryCount=t.retryCount+1,t.sendConnectRequest(),t.clearTimer()}),n)}},e.prototype.getDelayConnectTime=function(e){return void 0===e?(this.retryCount>s.DEFAULT_RETRY_COUNTS&&this.delayConnectTime===d.DEFAULT_DELAY_TIME&&(this.delayConnectTime=d.MAX_DELAY_TIME),this.delayConnectTime):e},e.prototype.sendConnectRequest=function(){return o(this,void 0,void 0,(function(){var e,t;return i(this,(function(n){switch(n.label){case 0:return e=this.createMessage("BIND_POST"),this.dependency.login(g.ConnectStatus.LOGIN),h.ConnectionLog.info("routeKey: "+this.routeKey+", Message: "+h.JsonUtil.jsonStringify(e)),[4,(new l.Request).sendRequest(this.getBindPath(),u.Method.POST,e,{contentType:c.ContentTypeValue.JSON})];case 1:return t=n.sent(),this.handleConnectResult(t),h.ConnectionLog.info("result: "+h.JsonUtil.jsonStringify(t)),[2]}}))}))},e.prototype.createMessage=function(e){return{head:h.createMessageHead(this.options,{command:e,baseRev:this.dependency.getVersion(),getHeaderGeneralPacket:this.dependency.getHeaderGeneralPacket(),taskId:h.generateMessageTaskId()}),body:this.createPostBody()}},e.prototype.createPostBody=function(){return h.JsonUtil.jsonStringify({})},e.prototype.handleConnectResult=function(e){if(e.error)this.reconnect();else{var t=e.data.data;this.isConnectSuccess(t.retcode)?this.handleConnectSuccess(t):this.handleConnectFailed(t)}},e.prototype.isConnectSuccess=function(e){return p.SERVER_SUCCESS_CODES.includes(e)},e.prototype.handleConnectSuccess=function(e){this.resetConnect(),this.sid=e.data.sid,this.token=e.data.token;var t={sid:e.data.sid,token:e.data.token,routeKey:this.routeKey};this.dependency.login(g.ConnectStatus.LOGINED,t)},e.prototype.handleConnectFailed=function(e){var t=e.retcode,n=e.msg,r=e.data;if(this.setRouteKey(r.routeKey),h.ConnectionLog.error("connect failed, serverErrCode: "+t+", errorMessage:"+n),this.shouldReconnect(e))f.default.retryRequestReport({name:String(t),message:"login error, retcode: "+t+", msg: "+n},this.options.module),this.reconnect(this.getDelayConnectTime());else{var o={errCode:t,reason:p.RoomUtil.getWebsocketChannelErrorMessage(t,"connect failed."),shutDown:!p.NEED_RETRY_ERRCODES.includes(t)};this.dependency.login(g.ConnectStatus.LOGIN_FAIL,void 0,o)}},e.prototype.resetConnect=function(){this.clearTimer(),this.retryCount=0,this.delayConnectTime=d.DEFAULT_DELAY_TIME},e.prototype.setRouteKey=function(e){this.routeKey=null!=e?e:this.options.serverVars.globalPadId},e.prototype.shouldReconnect=function(e){var t=e.retcode,n=e.data;return!(t===p.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_MEMBER_FULL&&!n.routeKey)&&p.NEED_RETRY_ERRCODES.includes(t)&&this.retryCount<3},e.prototype.getBindPath=function(){return this.routeKey||this.setRouteKey(),v.PATH+"?routeKey="+this.routeKey},e.prototype.getUnbindPath=function(){return this.routeKey||this.setRouteKey(),"/websocket/save?routeKey="+this.routeKey},e}();t.BigCollabLogin=y},98466:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(80177),o=n(20141),i=function(){function e(e){var t=this;this.dependency=e,this.disconnect=function(){t.dependency.disconnect({reason:"close by client, beforeunload",shutDown:!1,errCode:r.RoomErrorCode.ROOM_CLOSE,reconnectTime:o.PAGE_UNLOAD_TIME})},this.addBeforeunloadListener(this.disconnect)}return e.prototype.addBeforeunloadListener=function(e){window.addEventListener("beforeunload",e)},e}();t.default=i},4530:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(14378),t),o(n(4092),t)},31078:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MessageCenter=void 0;var c=n(74586),l=n(38506),u=n(94937),d=n(69998),p=n(76271),h=n(609),f=n(47742),g=n(22226),v=n(86221),y=n(84607),m=s(n(39472)),b=function(){function e(e,t,n){var r,o,i=this;this.options=e,this.dependency=t,this.connectManager=n,this.tag="MessageCenter",this.limitFrequencyManager=new h.LimitFrequencyManager(this.dependency),null===(o=null===(r=this.options.config)||void 0===r?void 0:r.messagePriority)||void 0===o||o.forEach((function(e,t){i.limitFrequencyManager.setPriority(t,e)}));var a={getServerParams:function(){return i.serverRequestParams},reconnect:function(e){return i.reconnect(e)},disconnect:function(e){return i.connectManager.disconnect(e)},handleServerMessage:function(e){return i.handleServerMessage(e)},onConnectSuccess:function(){return i.connectManager.onConnectSuccess()}};this.sender=new p.Sender({getServerParams:function(){return i.serverRequestParams},isConnected:function(){return i.connectManager.isConnected()},onMessageSending:function(e){return i.onMessageSending(e)},onMessageWaiting:function(e){return i.onMessageWaiting(e)}}),this.receiver=new d.Receiver(a),this.messageClassification=new g.MessageClassification([["CURSOR_MESSAGE",g.MessageSendType.PARALLEL]]),this.messageSendQueue=new f.MessageSendQueue(this.messageClassification),this.timeoutChecker=new v.TimeoutChecker(this.messageSendQueue,{trySendMessage:function(){return i.trySendMessage()}}),this.initOnConnectEvent()}return e.prototype.dispose=function(){this.receiver.dispose(),this.sender.dispose(),this.timeoutChecker.dispose()},e.prototype.sendMessage=function(e){if(c.ConnectionLog.info(this.tag,"sendMessage cmd:"+e.cmd+" taskId:"+e.taskId),this.messageSendQueue.has(e.taskId))return c.ConnectionLog.warn(this.tag+" sendMessage taskId:"+e.taskId+" is sending."),void e.onError(e.taskId,e.cmd,e.data,{errCode:l.RoomErrorCode.EXIST,errMsg:"msg already exist."});var t=y.MessageCreater.createMessage(e,this.options,this.dependency);this.messageSendQueue.add(t),this.trySendMessage()},e.prototype.initOnConnectEvent=function(){var e=this;this.connectManager.onConnectEvent((function(t){var n,r=t.status,o=t.serverRequestParams;c.ConnectionLog.debug("onConnectEvent: "+r);var i=new Map([[""+u.ConnectStatus.LOGINED,function(){return e.handleLogined(o)}],[""+u.ConnectStatus.CONNECTED,function(){return e.trySendMessage()}],[""+u.ConnectStatus.DISCONNECT,function(){return e.notifyConnectClose()}],[""+u.ConnectStatus.WAIT_RECONNECTING,function(){return e.notifyConnectClose()}]]);i.has(t.status)&&(null===(n=i.get(t.status))||void 0===n||n())}))},e.prototype.trySendMessage=function(){this.trySendParallelMessage(),this.trySendSerialMessage()},e.prototype.trySendSerialMessage=function(){if(!this.messageSendQueue.isCommittingSerialMessage()){var e=this.messageSendQueue.nextSerialMessage();e&&this.sendBigCollabMessage(e)}},e.prototype.trySendParallelMessage=function(){var e=this;this.messageSendQueue.nextParallelMessages().forEach((function(t){return e.sendBigCollabMessage(t)}))},e.prototype.sendBigCollabMessage=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return this.onMessageSending(e),this.timeoutChecker.startCheckSendTimeout(),[4,this.sender.sendMessage(e)];case 1:return t=n.sent(),this.handleMessageResult(e,t),[2]}}))}))},e.prototype.onMessageSending=function(e){e.state=l.MessageState.SENDING,e.lastSendTime=Date.now(),e.retryCount+=1},e.prototype.onMessageWaiting=function(e){e.state=l.MessageState.WAITING},e.prototype.handleMessageResult=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){return t?e.syncCommit?(this.handleSyncMessage(e,t),[2]):(n={errCode:t.retcode,errMsg:t.msg,response:t.data.syncResult?c.JsonUtil.parseJson(t.data.syncResult):t},this.handleMessageResultSend(e,n),[2]):[2]}))}))},e.prototype.handleSyncMessage=function(e,t){var n=this;if(0===t.retcode)this.parseSyncMessageResult(e,t).forEach((function(e){n.handleServerMessage(e)}));else{var o={task_id:e.taskId,type:l.MessageWaitAcceptCmd.COMMIT_ERROR},i={data:r(r({},t),{reason:t.retcode})};this.handleMessageResultSendAccept(o,i)}},e.prototype.parseSyncMessageResult=function(e,t){if(!t.data.syncResult)throw Error("Save Response Error, syncResult is undefined, taskId: "+e.taskId);return t.data.syncResult.split("\r\n").map((function(e){return e.split("\n")}))},e.prototype.hasWaitAcceptCommand=function(e,t){var n;return!!(null===(n=e.waitAcceptCmd)||void 0===n?void 0:n.includes(t))},e.prototype.handleMessageResultSend=function(e,t){var n,r;return o(this,void 0,void 0,(function(){var o,a,s;return i(this,(function(i){return o=e.taskId,a=e.cmd,s=e.data,e.onpostTime=l.RoomUtil.getCurrentTime(),this.shouldReconnect(t.errCode)?(this.reconnect({attrName:String(t.errCode),reason:"save Error, retcode: "+t.errCode+", msg: "+t.errMsg}),this.messageSendQueue.remove(e.taskId),[2]):0!==t.errCode?(this.handleSendMessageError(e,t),[2]):(null===(n=e.onsend)||void 0===n||n.call(e,o,a,s,t),e.onsendAccept?(null===(r=e.waitAcceptCmd)||void 0===r?void 0:r.length)&&(e.state=l.MessageState.WAIT_ACCEPT):(this.messageSendQueue.remove(o),this.trySendMessage()),[2])}))}))},e.prototype.shouldReconnect=function(e){return l.NEED_RECONNECT_ERRCODES.includes(e)},e.prototype.handleSendMessageError=function(e,t){var n,r=e.taskId,o=e.cmd,i=e.data;null===(n=e.onError)||void 0===n||n.call(e,r,o,i,t),this.reportCommitError(e,t.errCode,"save Error, retcode: "+t.errCode+", msg: "+t.errMsg),this.messageSendQueue.remove(r),this.trySendMessage()},e.prototype.handleMessageResultSendAccept=function(e,t){var n,r,o,i,a,s;if(e.task_id){var c=this.messageSendQueue.remove(e.task_id);if(c&&this.hasWaitAcceptCommand(c,e.type)){this.reportCommitError(c,null!==(r=null===(n=t.data)||void 0===n?void 0:n.reason)&&void 0!==r?r:0);var l=c.taskId,u=c.cmd,d=c.data,p=c.onsendAccept,h=e.type,f=e.new_rev;null==p||p(l,u,d,h,{errCode:null!==(i=null===(o=null==t?void 0:t.data)||void 0===o?void 0:o.reason)&&void 0!==i?i:0,errMsg:null!==(s=null===(a=null==t?void 0:t.data)||void 0===a?void 0:a.msg)&&void 0!==s?s:"",response:{body:t,new_rev:f}}),this.trySendSerialMessage()}}},e.prototype.handleServerMessage=function(e){var t=a(e.map((function(e){return c.JsonUtil.parseJson(e)})),2),n=t[0],r=t[1];if(console.log(n),console.log(r),this.messageSendQueue.get(n.task_id))this.handleMessageResultSendAccept(n,r);else if(this.isInactiveQuitMsg(n,r))this.connectManager.disconnect({reason:"close by server, INACTIVE.",errCode:l.RoomWebsocketErrorCode.INACTIVE,shutDown:!0});else{var o={head:n,body:r,newRev:n.new_rev,ts:n.ts,needDeal:!0};this.limitFrequencyManager.handleMessage(o),o.needDeal&&this.dependency.receiveMessageFromServer(n.type,[o])}},e.prototype.isInactiveQuitMsg=function(e,t){return"QUIT_NOTICE"===(null==e?void 0:e.type)&&"INACTIVE"===(null==t?void 0:t.notice.quit_type)},e.prototype.notifyConnectClose=function(){c.ConnectionLog.info("notifyConnectClose"),this.receiver.stopToReceive(),this.sender.clearAllRetryTimer(),this.timeoutChecker.clearTimer(),this.triggerAllMessagesError()},e.prototype.reconnect=function(e){var t,n;m.default.reconnectReport({module:this.options.module,attrName:e.attrName,status:1,errorMessage:null!==(t=e.reason)&&void 0!==t?t:l.RoomUtil.getWebsocketChannelErrorMessage(null!==(n=Number(e.attrName))&&void 0!==n?n:0)}),this.connectManager.reconnect()},e.prototype.handleLogined=function(e){this.serverRequestParams=e,this.serverRequestParams.routeKey||(this.serverRequestParams.routeKey=this.options.serverVars.globalPadId),this.receiver.receive()},e.prototype.triggerAllMessagesError=function(){var e=this.messageSendQueue.filter((function(e){return!!e})),t={errCode:l.RoomErrorCode.ROOM_CLOSE,errMsg:"room close"};e.forEach((function(e){var n,r=e.taskId,o=e.cmd,i=e.data;null===(n=e.onError)||void 0===n||n.call(e,r,o,i,t)}))},e.prototype.reportCommitError=function(e,t,n){m.default.commitError({attrName:String(t),status:1,cmd:e.cmd,module:this.options.module,errorMessage:null!=n?n:l.RoomUtil.getWebsocketChannelErrorMessage(null!=t?t:0),transports:"big-collab"})},e}();t.MessageCenter=b},84607:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.MessageCreater=void 0;var o=n(50051),i=n(74586),a=n(38506),s=function(){function e(){}return e.createMessage=function(e,t,n){var s,c,l,u,d,p,h,f=this.createPostData(e,t,n),g=a.RoomUtil.createNewMessage(e.taskId||i.generateMessageTaskId(),f,null!==(c=null===(s=e.customParam)||void 0===s?void 0:s.timeout)&&void 0!==c?c:o.DEFAULT_SEND_MESSAGE_TIMEOUT,null!==(u=null===(l=e.customParam)||void 0===l?void 0:l.maxRetryCount)&&void 0!==u?u:o.DEFAULT_RETRY_COUNTS,e.cmd,e.data,null===(d=e.customParam)||void 0===d?void 0:d.waitAcceptCmd,e.onError,e.onsend,e.onsendAccept),v=!!(null===(h=null===(p=t.config)||void 0===p?void 0:p.bigCollabCommitConfig)||void 0===h?void 0:h.syncCommit)&&"USER_CHANGES"===e.cmd;return r({syncCommit:v},g)},e.createPostData=function(e,t,n){var r=o.prepareCommitMessage(e.data,t.userid,t.serverVars.pver);return{head:this.createSendHead(e,t,n),body:r}},e.createSendHead=function(e,t,n){var r=e.data;return i.createMessageHead(t,{getHeaderGeneralPacket:n.getHeaderGeneralPacket(),command:e.cmd,baseRev:"object"==typeof r&&"number"==typeof r.baseRev?r.baseRev:n.getVersion(),taskId:e.taskId||i.generateMessageTaskId(),additionalFieldsToHead:e.additionalFieldsToHead})},e}();t.MessageCreater=s},86221:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.TimeoutChecker=void 0;var r=n(74586),o=n(38506),i=function(){function e(e,t){this.messageSendQueue=e,this.dependency=t,this.sendTimeoutTimer=0}return e.prototype.dispose=function(){this.clearTimer()},e.prototype.clearTimer=function(){clearTimeout(this.sendTimeoutTimer),this.sendTimeoutTimer=0},e.prototype.startCheckSendTimeout=function(){var e=this;this.sendTimeoutTimer&&(clearTimeout(this.sendTimeoutTimer),this.sendTimeoutTimer=0),this.sendTimeoutTimer=setTimeout((function(){e.checkSendTimeout()}),1e3)},e.prototype.checkSendTimeout=function(){var e=this.messageSendQueue.filter(this.timeoutMessage);e.forEach((function(e){e.state=o.MessageState.WAITING,e.retryCount>=e.maxRetryCount&&(r.ConnectionLog.warn("timeout-checker: send message timeout, taskId = "+e.taskId+", cmd = "+e.cmd+"."),e.retryCount=0)})),e.length>0&&this.dependency.trySendMessage(),0!==this.messageSendQueue.filter((function(e){return!!e})).length&&this.startCheckSendTimeout()},e.prototype.timeoutMessage=function(e){var t=o.RoomUtil.getCurrentTime();return(e.state===o.MessageState.SENDING||e.state===o.MessageState.WAIT_ACCEPT)&&t-e.lastSendTime>e.timeout},e}();t.TimeoutChecker=i},22226:function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.MessageClassification=t.MessageSendType=void 0,function(e){e.SERIAL="SERIAL",e.PARALLEL="PARALLEL"}(n=t.MessageSendType||(t.MessageSendType={}));var r=function(){function e(e){void 0===e&&(e=[]),this.messageClassfyMap=new Map(e)}return e.prototype.setMessageSendType=function(e,t){this.messageClassfyMap.set(e,t)},e.prototype.getMessageSendType=function(e){var t;return null!==(t=this.messageClassfyMap.get(e))&&void 0!==t?t:n.SERIAL},e}();t.MessageClassification=r},47742:function(e,t,n){var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.MessageSendQueue=t.Queue=void 0;var i=n(22226),a=n(39055),s=function(){function e(){this.queue=[]}return e.prototype.get=function(e){var t=this.queue.filter((function(t){return t.taskId===e}));return 0===t.length?null:t[0]},e.prototype.has=function(e){return this.queue.some((function(t){return t.taskId===e}))},e.prototype.add=function(e){this.has(e.taskId)||this.queue.push(e)},e.prototype.remove=function(e){for(var t=0;t<this.queue.length&&this.queue[t].taskId!==e;t++);return t===this.queue.length?null:this.queue.splice(t,1)[0]},e.prototype.filter=function(e){return this.queue.filter(e)},e.prototype.some=function(e){return this.queue.some(e)},e}();t.Queue=s;var c=function(){function e(e){this.messageClassification=e,this.parallelQueue=new s,this.serialQueue=new s}return e.prototype.isCommittingSerialMessage=function(){return this.serialQueue.some((function(e){return e.state===a.MessageState.SENDING}))},e.prototype.nextSerialMessage=function(){var e=this.serialQueue.filter((function(e){return e.state===a.MessageState.WAITING}));return 0===e.length?null:e[0]},e.prototype.nextParallelMessages=function(){return this.parallelQueue.filter((function(e){return e.state===a.MessageState.WAITING}))},e.prototype.add=function(e){this.messageClassification.getMessageSendType(e.cmd)===i.MessageSendType.PARALLEL?this.parallelQueue.add(e):this.serialQueue.add(e)},e.prototype.remove=function(e){return this.parallelQueue.has(e)?this.parallelQueue.remove(e):this.serialQueue.remove(e)},e.prototype.get=function(e){return this.parallelQueue.has(e)?this.parallelQueue.get(e):this.serialQueue.get(e)},e.prototype.has=function(e){return this.serialQueue.has(e)||this.parallelQueue.has(e)},e.prototype.filter=function(e){return o(this.parallelQueue.filter(e),this.serialQueue.filter(e))},e}();t.MessageSendQueue=c},70209:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.PageVisibilityChecker=void 0;var r=n(74586),o=function(){function e(e){var t=this;this.dependency=e,this.timer=0,this.isTimeout=!1,this.needGetReceiverClient=!1,this.onVisibilitychange=function(){"hidden"===document.visibilityState?t.onPageHide():t.onPageShow()},this.onPageHide=function(){r.ConnectionLog.info("pageVisibility: pagehide"),t.clearTimeout(),t.timer=setTimeout((function(){t.isTimeout=!0}),3e4)},this.onPageShow=function(){var e,n;r.ConnectionLog.info("pageVisibility: pageshow"),t.clearTimeout(),t.isTimeout&&t.needGetReceiverClient&&(null===(n=(e=t.dependency).resumeCallback)||void 0===n||n.call(e)),t.isTimeout=!1,t.needGetReceiverClient=!1},this.addListener()}return e.prototype.dispose=function(){this.clearTimeout(),document.removeEventListener("visibilitychange",this.onVisibilitychange),window.removeEventListener("pagehide",this.onPageHide),window.removeEventListener("pageshow",this.onPageShow)},Object.defineProperty(e.prototype,"isHidden",{get:function(){return document.hidden&&this.isTimeout},enumerable:!1,configurable:!0}),e.prototype.resumeAfterVisibility=function(){this.needGetReceiverClient=!0},e.prototype.addListener=function(){document.addEventListener("visibilitychange",this.onVisibilitychange),/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&(window.addEventListener("pagehide",this.onPageHide),window.addEventListener("pageshow",this.onPageShow))},e.prototype.clearTimeout=function(){this.timer&&(clearTimeout(this.timer),this.timer=0)},e}();t.PageVisibilityChecker=o},56664:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.ReceiverClient=void 0;var r=n(74586),o=n(28859),i=n(80177),a=function(){function e(e){this.dependency=e,this.position=0,this.onceOpen=!1}return e.prototype.establishConnection=function(e){var t=this;try{!this.onceOpen&&this.checkConnectTimeoutTimer(),this.xmlHttpRequest=new XMLHttpRequest,this.position=0,this.xmlHttpRequest.onreadystatechange=function(){t.xmlHttpRequest.readyState===XMLHttpRequest.LOADING?(t.clearConnectTimoutTimer(!0),t.chunkParse(t.xmlHttpRequest.responseText)):t.xmlHttpRequest.readyState===XMLHttpRequest.DONE&&(t.clearConnectTimoutTimer(!0),t.closeConnection())},this.xmlHttpRequest.open("get",e),this.xmlHttpRequest.setRequestHeader("content-type","application/json"),this.xmlHttpRequest.send(),this.xmlHttpRequest.onerror=function(){r.ConnectionLog.info("bind/get onerror"),t.dependency.receive()}}catch(e){r.ConnectionLog.error("ReceiverClient XMLHttpRequest Error, error.message:"+(null==e?void 0:e.message)+",error.stack:"+(null==e?void 0:e.stack)),this.dependency.receive()}},e.prototype.abortConnection=function(){var e;null===(e=this.xmlHttpRequest)||void 0===e||e.abort()},e.prototype.chunkParse=function(e){for(var t=this.position,n=e.indexOf(o.DELIMITER,t);n>-1;){var r=e.substring(t,n);if(r&&(this.dependency.handleResponse(r),r.indexOf("connection closed")>-1))return void(this.position=0);t=n+o.DELIMITER.length,n=e.indexOf(o.DELIMITER,t)}this.position=t},e.prototype.closeConnection=function(){this.xmlHttpRequest.status!==XMLHttpRequest.UNSENT&&(this.xmlHttpRequest.status<200||this.xmlHttpRequest.status>=400?(console.log("closeConnection: "+this.xmlHttpRequest),this.dependency.receive()):this.chunkParse(this.xmlHttpRequest.responseText))},e.prototype.checkConnectTimeoutTimer=function(){var e=this;this.clearConnectTimoutTimer(!1),this.connectTimeoutTimer=setTimeout((function(){r.ConnectionLog.error("bind/get 12s "),e.dependency.disconnect({errCode:i.RoomErrorCode.BIG_COLLAB_CONNECT_TIMEOUT,shutDown:!0})}),12e3)},e.prototype.clearConnectTimoutTimer=function(e){e&&!this.onceOpen&&(this.onceOpen=!0),this.connectTimeoutTimer&&(window.clearTimeout(this.connectTimeoutTimer),this.connectTimeoutTimer=void 0)},e}();t.ReceiverClient=a},28859:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CONNECT_DELAY_TIME=t.DELIMITER=t.ERROR_MESSAGE_INDEX=t.MAX_SERVER_REACHABLE_TIME=t.NOOP=t.PATH=void 0,t.PATH="/websocket/bind",t.NOOP="noop",t.DELIMITER="\r\n",t.MAX_SERVER_REACHABLE_TIME=45e3,t.CONNECT_DELAY_TIME=3e3,t.ERROR_MESSAGE_INDEX=[0,-1]},69998:function(e,t,n){var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a};Object.defineProperty(t,"__esModule",{value:!0}),t.Receiver=void 0;var o=n(56664),i=n(74586),a=n(28859),s=n(38506),c=n(70209),l=function(){function e(e){var t=this;this.dependency=e,this.isConnectSuccess=!1,this.delayConnectTimer=0,this.connectionCheckTimer=0,this.retryTimes=0,this.pageVisibilityChecker=new c.PageVisibilityChecker({resumeCallback:function(){return t.receive()}})}return e.prototype.dispose=function(){this.stopToReceive(),this.receiverClientInstance=void 0},e.prototype.stopToReceive=function(){this.receiverClient.abortConnection(),this.clearTimer()},e.prototype.receive=function(){i.ConnectionLog.info("bind get receive",this.pageVisibilityChecker.isHidden,this.retryTimes),this.pageVisibilityChecker.isHidden?this.pageVisibilityChecker.resumeAfterVisibility():this.retryTimes?this.delayConnect():(this.retryTimes=this.retryTimes+1,this.isConnectSuccess=!1,this.receiverClient.establishConnection(this.getUrl()))},e.prototype.delayConnect=function(){var e=this;if(this.retryTimes>=3)return i.ConnectionLog.info("bind getpost"),this.retryTimes=0,void this.dependency.reconnect({attrName:"bind get ",reason:""});this.isConnectSuccess=!1,this.delayConnectTimer&&(clearTimeout(this.delayConnectTimer),this.delayConnectTimer=0),this.delayConnectTimer=setTimeout((function(){e.retryTimes=e.retryTimes+1,e.receiverClient.establishConnection(e.getUrl())}),a.CONNECT_DELAY_TIME)},e.prototype.getUrl=function(){var e=this.dependency.getServerParams(),t=e.token,n=e.sid,r=e.routeKey;return a.PATH+"?sid="+n+"&token="+t+"&routeKey="+r+"&taskId="+i.generateMessageTaskId()},e.prototype.handleResponse=function(e){var t=this;if(!Number.parseInt(e,16)&&0!==Number.parseInt(e,16)){var n=i.JsonUtil.parseJson(e);Array.isArray(n)&&(n.forEach((function(e){var n=r(e,2),o=n[0],i=n[1];a.ERROR_MESSAGE_INDEX.includes(o)?t.handleResponseEnd(i):i.includes(a.NOOP)||t.dependency.handleServerMessage(i)})),this.connectionIsStable())}},e.prototype.connectionIsStable=function(){var e=this;this.isConnectSuccess||(this.isConnectSuccess=!0,this.dependency.onConnectSuccess()),clearTimeout(this.connectionCheckTimer),this.connectionCheckTimer=0,this.retryTimes=0,this.connectionCheckTimer=setTimeout((function(){e.isConnectSuccess=!1,e.receive()}),a.MAX_SERVER_REACHABLE_TIME)},e.prototype.handleResponseEnd=function(e){var t=r(e,2),n=t[0],o=t[1];if(!this.notNeedToHandle(n))return n!==s.RoomWebsocketErrorCode.SOCKET_SERVER_SUCCESS?(i.ConnectionLog.info("Bind Get Error, retcode: "+n+", msg: "+o),void this.dependency.reconnect({attrName:String(null!=n?n:0),reason:"Bind Get Error, retcode: "+n+", msg: "+o})):void this.receive()},e.prototype.notNeedToHandle=function(e){return s.NOT_NEED_TO_HANDLE_ERRCODES.includes(e)},Object.defineProperty(e.prototype,"receiverClient",{get:function(){var e=this;return this.receiverClientInstance||(this.receiverClientInstance=new o.ReceiverClient({handleResponse:function(t){return e.handleResponse(t)},receive:function(){return e.receive()},disconnect:function(t){return e.dependency.disconnect(t)}})),this.receiverClientInstance},enumerable:!1,configurable:!0}),e.prototype.clearTimer=function(){this.delayConnectTimer&&(clearTimeout(this.delayConnectTimer),this.delayConnectTimer=0),this.connectionCheckTimer&&(clearTimeout(this.connectionCheckTimer),this.connectionCheckTimer=0)},e}();t.Receiver=l},76271:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.Sender=void 0;var a=n(50252),s=n(64033),c=n(8254),l=n(50051),u=function(){function e(e){this.dependency=e,this.requestId=0,this.retryTimerMap=new Map}return e.prototype.dispose=function(){this.clearAllRetryTimer()},e.prototype.sendMessage=function(e){return r(this,void 0,void 0,(function(){var t,n;return o(this,(function(r){switch(r.label){case 0:return t=this.createRequestConfig(e),[4,this.commitMessage(e,t)];case 1:return n=r.sent(),[4,this.handleCommitResult(e,n)];case 2:return[2,r.sent()]}}))}))},e.prototype.clearAllRetryTimer=function(){var e,t;try{for(var n=i(this.retryTimerMap.values()),r=n.next();!r.done;r=n.next()){var o=r.value;clearTimeout(o)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.retryTimerMap.clear()},e.prototype.createRequestConfig=function(e){return{timeout:e.timeout,maxRetry:l.DEFAULT_RETRY_COUNTS,contentType:c.ContentTypeValue.JSON}},e.prototype.commitMessage=function(e,t){return r(this,void 0,void 0,(function(){var n,r,i,c,l,u;return o(this,(function(o){switch(o.label){case 0:return n=this.dependency.getServerParams(),r=n.token,i=n.sid,c=n.routeKey,l="/websocket/save?routeKey="+c,u={routeKey:c,token:r,sid:i,syncCommit:e.syncCommit,requestId:this.requestId,head:e.postData.head,body:e.postData.body},this.requestId+=1,[4,(new a.Request).sendRequest(l,s.Method.POST,u,t)];case 1:return[2,o.sent()]}}))}))},e.prototype.handleCommitResult=function(e,t){var n;return r(this,void 0,void 0,(function(){var r;return o(this,(function(o){switch(o.label){case 0:return r=null===(n=t.data)||void 0===n?void 0:n.data,!t.error&&r?[3,2]:[4,this.retrySendMessage(e)];case 1:return[2,o.sent()];case 2:return[2,r]}}))}))},e.prototype.clearMessageRetryTimer=function(e){this.retryTimerMap.has(e.taskId)&&(clearTimeout(this.retryTimerMap.get(e.taskId)),this.retryTimerMap.delete(e.taskId))},e.prototype.retrySendMessage=function(e){return r(this,void 0,void 0,(function(){var t,n=this;return o(this,(function(i){return this.clearMessageRetryTimer(e),this.dependency.isConnected()?(t=this.getDelayDuration(e.retryCount),[2,new Promise((function(i){var a=setTimeout((function(){return r(n,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return this.dependency.onMessageSending(e),[4,this.sendMessage(e)];case 1:return t=n.sent(),i(t),[2]}}))}))}),t);n.retryTimerMap.set(e.taskId,a)}))]):(this.dependency.onMessageWaiting(e),e.retryCount=0,[2])}))}))},e.prototype.getDelayDuration=function(e){return 1e3*Math.min(2*e,30)},e}();t.Sender=u},87713:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},37122:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.buildCommonRequestChannel=void 0;var i=n(7594),a=n(38817),s=n(75509),c=n(64033),l=n(8254),u=function(e){function t(t){var n=e.call(this,t,{requestUrl:"/dop-api/commitchanges",method:c.Method.POST,contentType:l.ContentType.JSON})||this;return n.options=t,n.init(),n}return o(t,e),t.prototype.init=function(){this.paramsPacker=new a.CommonRequestParamsPacker,this.responseHandler=new s.CommonResponseHandler},t}(i.BaseChannel);t.buildCommonRequestChannel=function(e){return new u(e)}},38817:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.CommonRequestParamsPacker=void 0;var r=n(74586),o=function(){function e(){}return e.prototype.pack=function(e,t){var n,o={common:{type:e.data.type,docid:t.serverVars.globalPadId,uid:t.uid,session_type:0,uuId:t.uuId,padType:null!==(n=t.module)&&void 0!==n?n:"",padSubType:e.data.padSubType},respective:e.data.changeset},i=t.serverVars.globalPadId,a=r.Cookie.getXsrf();return r.JsonUtil.jsonStringify({padId:i,xsrf:a,data:r.JsonUtil.jsonStringify(o)})},e}();t.CommonRequestParamsPacker=o},75509:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CommonResponseHandler=void 0;var n=function(){function e(){}return e.prototype.handle=function(e){if(e.error)return{error:e.error};var t=e.data,n=t.status,r=t.data;return{status:n,retcode:null==r?void 0:r.retcode,message:null==r?void 0:r.retmsg,data:null==r?void 0:r.Data}},e}();t.CommonResponseHandler=n},86692:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(87713),t),o(n(37122),t)},30101:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},24321:function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.DOCUMENT_TYPE=void 0,function(e){e.DOC="doc",e.SHEET="sheet",e.FORM="form",e.SLIDE="slide",e.SMARTSHEET="smartSheet",e.SMARTCANVAS="smartCanvas",e.FLOWCHART="flowchart",e.MIND="mind",e.PDF="pdf"}(n||(n={})),t.DOCUMENT_TYPE=n},27946:function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectMode=void 0,function(e){e.WEBSOCKET="WEBSOCKET",e.BIG_COLLAB="BIG_COLLAB",e.WEBSOCKET_FORCED="WEBSOCKET_FORCED"}(n||(n={})),t.ConnectMode=n},46588:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionController=void 0;var i=n(73557),a=n(23742),s=n(36023),c=n(63489),l=n(74586),u=n(50051),d=n(27946),p=n(38506),h=n(86692),f=n(4530),g=n(609),v=function(){function e(e){var t,n=this;this.onConnectionEventEmitter=new s.Emitter,this.middleWareCenter=new g.MiddleWareCenter,this.connectionFireEvent=function(e,t){n.onConnectionEventEmitter.fire({event:e,data:t})},this.options=e,this.setConnectMode((null===(t=this.options.config)||void 0===t?void 0:t.connectMode)||d.ConnectMode.WEBSOCKET),this.onConnectionEvent=this.onConnectionEventEmitter.event,this.initDependencyEvent(),i.network.changeEnd(this.handleNetWorkChangeCallback.bind(this))}return e.prototype.dispose=function(){i.network.remove(this.handleNetWorkChangeCallback.bind(this)),this.onConnectionEventEmitter.dispose(),this.destoryChannel()},e.prototype.useMiddleWare=function(e,t){this.middleWareCenter.useMiddleWare(e,t)},e.prototype.connect=function(e){void 0===e&&(e=d.ConnectMode.WEBSOCKET),l.ConnectionLog.info("connect mode:"+e),this.setConnectMode(e),this.connectChannel(e)},e.prototype.reConnect=function(e,t){void 0===t&&(t=d.ConnectMode.WEBSOCKET),this.reconnect(e,t)},e.prototype.reconnect=function(e,t){void 0===t&&(t=d.ConnectMode.WEBSOCKET),l.ConnectionLog.warn("reconnect mode:"+t),e&&(this.options=e),this.destoryChannel(),this.setConnectMode(t),this.connectChannel(t)},e.prototype.isConnecting=function(){return this.isConnected()},e.prototype.isConnected=function(){return this.isWebsocketRoomState(p.RoomState.OPENED)||this.isUseBigCollabChannel()&&this.bigCollabChannel.isConnected()},e.prototype.isDisconnect=function(){return this.isDisconnected()},e.prototype.isDisconnected=function(){return this.isWebsocketRoomState(p.RoomState.SHUTDOWN)||this.isUseBigCollabChannel()&&this.bigCollabChannel.isDisconnected()},e.prototype.disconnect=function(e){var t,n;this.isDisconnected()?l.ConnectionLog.warn("was disconnect, please do not disconnect. new errCode:"+e.errCode):this.isUseBigCollabChannel()?null===(t=this.bigCollabChannelInstance)||void 0===t||t.disconnect(e):null===(n=this.websocketChannelInstance)||void 0===n||n.disconnect(e)},e.prototype.isOnline=function(){return i.network.isOnline},e.prototype.setVersion=function(e){a.isNumber(e)?this.version=e:l.ConnectionLog.error("setVersion version is not number")},e.prototype.sendMessage=function(e){var t,n;if(l.isInvalidMessage(e))return l.ConnectionLog.warn("sendMessage fail: params invalid!"),void e.onError(e.taskId,e.cmd,e.data,{errCode:p.RoomErrorCode.PARA_ERROR,errMsg:"msg param invalid."});e.customParam?((null===(t=e.customParam)||void 0===t?void 0:t.timeout)&&(e.customParam.timeout=Math.min(e.customParam.timeout,3e4)),(null===(n=e.customParam)||void 0===n?void 0:n.maxRetryCount)&&(e.customParam.maxRetryCount=Math.min(e.customParam.maxRetryCount,u.DEFAULT_RETRY_COUNTS))):e.customParam={timeout:u.DEFAULT_SEND_MESSAGE_TIMEOUT,maxRetryCount:u.DEFAULT_RETRY_COUNTS},this.isUseBigDataChannel(e)?this.bigDataChannel.sendMessage(e):this.isUseBigCollabChannel()?this.bigCollabChannel.sendMessage(e):this.websocketChannel.sendMessage(e)},e.prototype.sendCommonRequest=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,this.commonRequestChannel.sendMessage(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.batchCommitMessages=function(e,t,n){return r(this,void 0,void 0,(function(){return o(this,(function(r){return(null==e?void 0:e.length)?[2,this.bigDataChannel.batchCommitMessages(e,t,n)]:[2,this.handleMessagesError()]}))}))},e.prototype.cancelMessageBySeq=function(e){this.websocketChannel.cancelMessageBySeq(e)},e.prototype.handleMessagesError=function(){var e="batchCommitMessages message is null!";return l.ConnectionLog.warn(e),{success:!1,retCode:52001,reason:e}},Object.defineProperty(e.prototype,"bigDataChannel",{get:function(){return this.bigDataChannelInstance||(this.bigDataChannelInstance=c.BuildBigDataChannel(this.options,this.dependency)),this.bigDataChannelInstance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bigCollabChannel",{get:function(){return this.bigCollabChannelInstance||(this.bigCollabChannelInstance=f.BuildBigCollabChannel(this.options,this.dependency)),this.bigCollabChannelInstance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"websocketChannel",{get:function(){return this.websocketChannelInstance||(this.websocketChannelInstance=p.BuildRoomWebsocketChannel(this.options,this.dependency,this.middleWareCenter)),this.websocketChannelInstance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"commonRequestChannel",{get:function(){return this.commonRequestChannelInstance||(this.commonRequestChannelInstance=h.buildCommonRequestChannel(this.options)),this.commonRequestChannelInstance},enumerable:!1,configurable:!0}),e.prototype.handleNetWorkChangeCallback=function(e){var t,n,r,o;"online"===e?null===(n=(t=this.dependency).enterOnline)||void 0===n||n.call(t):null===(o=(r=this.dependency).enterOffline)||void 0===o||o.call(r)},e.prototype.isUseBigCollabChannel=function(){var e;return(null===(e=this.options.config)||void 0===e?void 0:e.connectMode)===d.ConnectMode.BIG_COLLAB},e.prototype.isUseBigDataChannel=function(e){var t,n=null===(t=this.options.config)||void 0===t?void 0:t.bigDataCommitConfig;if("USER_CHANGES"===e.cmd&&!0===(null==n?void 0:n.isSupportBigDataCommit)){var r=u.getMessageDataLength(e.data);if(r>((null==n?void 0:n.minContentLength)||5242880))return l.ConnectionLog.info("sendMessage BigData, length:"+r),!0}return!1},e.prototype.initDependencyEvent=function(){var e=this;this.dependency={enterOnline:function(){e.connectionFireEvent("OnEnterOnline")},enterOffline:function(){e.connectionFireEvent("OnEnterOffline")},connected:function(){e.connectionFireEvent("OnRoomOpen")},connectedStateChange:function(t,n){e.connectionFireEvent("OnRoomStateChange",{roomState:{roomState:t,description:n}})},receiveMessageFromServer:function(t,n){e.connectionFireEvent("OnReceiveMsgFromServer",{serverMsg:{type:t,data:n}})},networkReconnectedFail:function(){e.connectionFireEvent("OnNetReconnectedFail")},getHeaderGeneralPacket:function(){var t,n;return null!==(n=null===(t=e.options.config)||void 0===t?void 0:t.headerGeneralPacket)&&void 0!==n?n:{}},getVersion:function(){return e.version},disconnect:function(t){t.shutDown?e.connectionFireEvent("OnRoomShutDown",{closeReason:t}):e.connectionFireEvent("OnRoomClose",{closeReason:t})}}},e.prototype.isWebsocketRoomState=function(e){return!!this.websocketChannelInstance&&this.websocketChannel.getRoomState()===e},e.prototype.connectChannel=function(e){e!==d.ConnectMode.BIG_COLLAB?this.websocketChannel.connect():this.bigCollabChannel.connect()},e.prototype.destoryChannel=function(){var e,t,n,r;null===(e=this.websocketChannelInstance)||void 0===e||e.dispose(),this.websocketChannelInstance=void 0,null===(t=this.bigDataChannelInstance)||void 0===t||t.dispose(),this.bigDataChannelInstance=void 0,null===(n=this.commonRequestChannelInstance)||void 0===n||n.dispose(),this.commonRequestChannelInstance=void 0,null===(r=this.bigCollabChannelInstance)||void 0===r||r.dispose(),this.bigCollabChannelInstance=void 0},e.prototype.setConnectMode=function(e){this.options.config?this.options.config.connectMode=e:this.options.config={connectMode:e}},e}();t.ConnectionController=v},31875:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionCallBackEvent=void 0,function(e){e.onEnterOnline="OnEnterOnline",e.onEnterOffline="OnEnterOffline",e.onRoomOpen="OnRoomOpen",e.onRoomClose="OnRoomClose",e.onRoomShutDown="OnRoomShutDown",e.onRoomStateChange="OnRoomStateChange",e.onReceiveMsgFromServer="OnReceiveMsgFromServer",e.onNetReconnectedFail="OnNetReconnectedFail"}(t.ConnectionCallBackEvent||(t.ConnectionCallBackEvent={}))},3954:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(24321),t),o(n(30101),t),o(n(46588),t),o(n(27946),t),o(n(31875),t)},63536:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.FeatureMessageCenter=void 0;var r=n(36023),o=n(33390),i=n(18366),a=n(74586),s=n(21949),c=function(){function e(){this.onFeatureMessageEventEmitter=new r.Emitter,this.uid=e.configs.uid||o.getUid();var t=e.configs.userId||"p."+this.uid;this.userId=""+t,this.gtag="main_page_"+this.userId,this.onFeatureMessageEvent=this.onFeatureMessageEventEmitter.event}return e.config=function(t){e.configs=Object.assign(e.configs,t)},e.getInstance=function(){if(!n.g.featureMessageCenterInstance){var t=new e;n.g.featureMessageCenterInstance=t,t.connect()}return e.instance||(e.instance=n.g.featureMessageCenterInstance),e.instance},e.prototype.isConnecting=function(){return!!this.socketManager},e.prototype.connect=function(){this.isConnecting()||this.websocketConnect()},e.prototype.disConnect=function(e){var t;null===(t=this.socketManager)||void 0===t||t.disConnect(null!=e?e:"")},e.prototype.dispose=function(){var e;this.onFeatureMessageEventEmitter.dispose(),null===(e=this.socketManager)||void 0===e||e.dispose()},e.prototype.onConnect=function(){this.sendClientReady()},e.prototype.onConnectFail=function(){var e=this;if(!this.websocketDelayConnectTimer){this.socketManager=void 0;var t=1e3*Math.max(Math.floor(20*Math.random()),2);this.websocketDelayConnectTimer=setTimeout((function(){e.websocketConnect()}),t)}},e.prototype.onGetMessageFromServer=function(e){this.onFeatureMessageEventEmitter.fire({data:e})},e.prototype.onPostFromServer=function(){},e.prototype.websocketConnect=function(){this.uid&&(this.resetWebsocketDelayConnectTimer(),this.socketManager=new s.WebsocketManager({userId:this.userId,gtag:this.gtag,host:window.location.host,featureMessageCenterReceiver:this}),this.socketManager.connect())},e.prototype.sendClientReady=function(){var e,t={type:"CLIENT_READY",uid:this.userId,gtag:this.gtag,cookie:a.getCookieForMessage()},n=i.generateMessageTaskId()+"="+a.JsonUtil.jsonStringify(t);null===(e=this.socketManager)||void 0===e||e.sendMessage(n)},e.prototype.resetWebsocketDelayConnectTimer=function(){this.websocketDelayConnectTimer&&(clearTimeout(this.websocketDelayConnectTimer),this.websocketDelayConnectTimer=0)},e.configs={},e}();t.FeatureMessageCenter=c},31665:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(63536);Object.defineProperty(t,"FeatureMessageCenter",{enumerable:!0,get:function(){return r.FeatureMessageCenter}})},21949:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.WebsocketManager=void 0;var a=i(n(10274)),s=n(74586),c=n(83561),l=function(){function e(e){var t=this;this.options=e,this.socket=null,this.socketStatus=0,this.handleConnect=function(){c.ConnectionLog.info("socket io connect readyState: "+t.socket.io.readyState+", id:"+t.socket.id),t.options.featureMessageCenterReceiver.onConnect()},this.handleError=function(e){c.ConnectionLog.info("socket io error, type:"+(null==e?void 0:e.type)+", message:"+(null==e?void 0:e.message)+", description:"+(null==e?void 0:e.description)),t.disConnect(s.JsonUtil.jsonStringify(e)+" socket io error Closed by client.")},this.handleReconnectFailed=function(e){c.ConnectionLog.info("socket io reconnect_failed"),t.disConnect(s.JsonUtil.jsonStringify(e)+" reconnect_failed Closed by client.")},this.handleConnectFailed=function(e){c.ConnectionLog.info("socket io connect_failed"),t.disConnect(s.JsonUtil.jsonStringify(e)+"  connect_failed Closed by client.")},this.handleGet=function(e){t.options.featureMessageCenterReceiver.onGetMessageFromServer(e)},this.handlePost=function(e){t.options.featureMessageCenterReceiver.onPostFromServer(e)}}return e.prototype.dispose=function(){this.disConnectSocket()},e.prototype.connect=function(){var e=a.default("wss://"+this.options.host,{query:{gtag:this.options.gtag},transports:a.DEFAULT_TRANSPORT_MODE,reconnection:!0,reconnectionAttempts:10,reconnectionDelay:a.WEBSOCKET_CONFIG.reconnectionDelay,reconnectionDelayMax:a.WEBSOCKET_CONFIG.reconnectionDelayMax,randomizationFactor:a.WEBSOCKET_CONFIG.randomizationFactor,timeout:a.WEBSOCKET_CONFIG.connectTimeout,path:"/socket.io"});this.socket=e,this.socket?(this.socket.on("get",this.handleGet),this.socket.on("post",this.handlePost),this.socket.on("connect",this.handleConnect),this.socket.on("connect_failed",this.handleConnectFailed),this.socket.on("error",this.handleError),this.socket.on("reconnect_failed",this.handleReconnectFailed)):c.ConnectionLog.warn("socket is null")},e.prototype.disConnect=function(e){c.ConnectionLog.info("socket io disconnect reason: "+e),this.disConnectSocket(),this.options.featureMessageCenterReceiver.onConnectFail()},e.prototype.sendMessage=function(e){e&&this.socket&&this.socket.emit("post",e)},e.prototype.disConnectSocket=function(){this.socket&&(this.socket.disconnect(),this.socket=null)},e}();t.WebsocketManager=l},609:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(14179),t),o(n(87950),t)},87950:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(53730),t),o(n(40692),t),o(n(96373),t),o(n(10481),t)},10481:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},96373:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.LimitFrequencyManager=void 0;var r=n(74586),o=n(53730),i=n(40692),a=n(46249),s=function(){function e(e){this.dependency=e,this.limitFrequencyMessageMap=new Map,this.limitFrequencyMessageMap.set(a.USER_INOUT_TYPE,new a.UserInoutMessage(a.USER_INOUT_TYPE,i.MessagePriority.MIDDLE,this.dependency))}return e.prototype.dispose=function(){this.limitFrequencyMessageMap.clear(),this.reset()},e.prototype.reset=function(){this.memberCount=0},e.prototype.setPriority=function(e,t){this.limitFrequencyMessageMap.get(e)&&r.ConnectionLog.warn("LimitFrequencyManager type:"+e+" is exit."),this.limitFrequencyMessageMap.set(e,new o.LimitFrequencyMessage(e,t,this.dependency))},e.prototype.handleMessage=function(e){var t=this;this.updateMemberCount(e),this.limitFrequencyMessageMap.forEach((function(n){var r=e.head.type;n.shouldLimit(r)&&(null==n||n.handleMessage(e,t.getLimitFrequencyLevel(),t.memberCount))}))},e.prototype.updateMemberCount=function(e){var t,n,r,o,i;if(["USER_NEWINFO","USER_NEWINFOS","USER_LEAVE","USER_LEAVES"].includes(e.head.type)){var a=null!==(i=null!==(r=null===(n=null===(t=e.body)||void 0===t?void 0:t.notice)||void 0===n?void 0:n.mem_count)&&void 0!==r?r:null===(o=e.body)||void 0===o?void 0:o.mem_count)&&void 0!==i?i:0;this.memberCount=a}},e.prototype.getLimitFrequencyLevel=function(){return this.memberCount<=i.MIN_THRESHOLD?i.LimitFrequencyLevel.LOW:this.memberCount<=i.MIDDLE_THRESHOLD?i.LimitFrequencyLevel.MIDDLE:this.memberCount<=i.MAX_THRESHOLD?i.LimitFrequencyLevel.HIGH:i.LimitFrequencyLevel.HIGHEST},e}();t.LimitFrequencyManager=s},53730:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.LimitFrequencyMessage=void 0;var r=n(74586),o=n(40692),i=function(){function e(e,t,n){this.type=e,this.priority=t,this.dependency=n,this.duration=o.NOT_LIMIT_FREQUENCY,this.messages=[]}return e.prototype.shouldLimit=function(e){return this.type===e},e.prototype.handleMessage=function(e,t,n){var r=this;this.memberCount=n;var i=this.calculateLimitDuration(t);i!==o.NOT_LIMIT_FREQUENCY?(e.needDeal=!1,i!==o.FOREVER_LIMIT_FREQUENCY?(this.pushMessage(e),i!==this.duration&&(this.reset(),this.duration=i,this.transferTimer=setInterval((function(){r.transfer()}),this.duration))):this.duration=i):i!==this.duration&&(this.transfer(),this.reset())},e.prototype.pushMessage=function(e){this.messages.push(e)},e.prototype.transfer=function(){this.messages.length&&(r.ConnectionLog.info("transfer memberCount:"+this.memberCount+", type:"+this.type+", duration:"+this.duration),this.transferToBusiness(this.type,this.messages),this.messages.splice(0,this.messages.length))},e.prototype.transferToBusiness=function(e,t){this.dependency.receiveMessageFromServer(e,t)},e.prototype.reset=function(){clearInterval(this.transferTimer),this.transferTimer=0,this.duration=o.NOT_LIMIT_FREQUENCY},e.prototype.calculateLimitDuration=function(e){try{return this.priority===o.MessagePriority.HIGH?o.NOT_LIMIT_FREQUENCY:o.LIMIT_FREQUENCY_STRAGEGY[this.priority][e]}catch(e){return o.NOT_LIMIT_FREQUENCY}},e}();t.LimitFrequencyMessage=i},40692:function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.FOREVER_LIMIT_FREQUENCY=t.NOT_LIMIT_FREQUENCY=t.LIMIT_FREQUENCY_STRAGEGY=t.MAX_THRESHOLD=t.MIDDLE_THRESHOLD=t.MIN_THRESHOLD=t.LimitFrequencyLevel=t.MessagePriority=void 0,function(e){e[e.HIGH=0]="HIGH",e[e.MIDDLE=1]="MIDDLE",e[e.LOW=2]="LOW"}(n||(n={})),t.MessagePriority=n,function(e){e[e.LOW=0]="LOW",e[e.MIDDLE=1]="MIDDLE",e[e.HIGH=2]="HIGH",e[e.HIGHEST=3]="HIGHEST"}(r||(r={})),t.LimitFrequencyLevel=r,t.MIN_THRESHOLD=20,t.MIDDLE_THRESHOLD=50,t.MAX_THRESHOLD=100,t.NOT_LIMIT_FREQUENCY=0;var o=Number.MAX_SAFE_INTEGER;t.FOREVER_LIMIT_FREQUENCY=o;var i=[[0,0,0,0],[0,5e3,1e4,2e4],[0,1e4,2e4,o]];t.LIMIT_FREQUENCY_STRAGEGY=i},46249:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.USER_INOUT_TYPE=t.UserInoutMessage=void 0;var i=n(74586),a=n(53730),s="USER_INOUT_TYPE";t.USER_INOUT_TYPE=s;var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.userNewInfos=new Map,t.userLeaves=new Map,t}return o(t,e),t.prototype.shouldLimit=function(e){return["USER_NEWINFO","USER_LEAVE"].includes(e)},t.prototype.pushMessage=function(e){var t=e.body.notice;"USER_NEWINFO"===e.head.type&&this.pushUserNewInfo(t),"USER_LEAVE"===e.head.type&&this.pushUserLeave(t)},t.prototype.transfer=function(){var e;(this.userNewInfos.size||(null===(e=this.userLeaves)||void 0===e?void 0:e.size))&&(i.ConnectionLog.info("transfer memberCount:"+this.memberCount+", type:USER_INOUT_TYPE, duration:"+this.duration),this.transferUserNewInfo(),this.transferUserLeave(),this.userNewInfos.clear(),this.userLeaves.clear())},t.prototype.transferUserNewInfo=function(){if(this.userNewInfos.size){var e=Array.from(this.userNewInfos.values());this.userNewInfos.clear();var t={head:{type:"USER_NEWINFOS"},body:{mem_count:this.memberCount,notices:e}};this.transferToBusiness("USER_NEWINFOS",[t])}},t.prototype.transferUserLeave=function(){var e;if(null===(e=this.userLeaves)||void 0===e?void 0:e.size){var t=Array.from(this.userLeaves.values());this.userLeaves.clear();var n={head:{type:"USER_LEAVES"},body:{mem_count:this.memberCount,notices:t}};this.transferToBusiness("USER_LEAVES",[n])}},t.prototype.pushUserNewInfo=function(e){e&&e.uuId&&(this.userLeaves.has(e.uuId)?this.userLeaves.delete(e.uuId):this.userNewInfos.set(e.uuId,e))},t.prototype.pushUserLeave=function(e){e&&e.uuId&&(this.userNewInfos.has(e.uuId)?this.userNewInfos.delete(e.uuId):this.userLeaves.set(e.uuId,e))},t}(a.LimitFrequencyMessage);t.UserInoutMessage=c},14179:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(42707),t)},42707:function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.MiddleWareCenter=t.MiddleWareType=void 0,function(e){e.RECEIVE_MESSAGE_FROM_SERVER="RECEIVE_MESSAGE_FROM_SERVER"}(n||(n={})),t.MiddleWareType=n;var r=function(){function e(){this.middleWares=new Map}return e.prototype.useMiddleWare=function(e,t){if(e&&t){var n=this.getMiddleWares(e);n.push(t),this.middleWares.set(e,n)}},e.prototype.run=function(e,t){var n=this.getMiddleWares(e);this.compose(n,t)},e.prototype.getMiddleWares=function(e){var t;return null!==(t=this.middleWares.get(e))&&void 0!==t?t:[]},e.prototype.compose=function(e,t){var n=-1;return function r(o){if(o<=n)throw new Error("next only called once");if(n=o,o===e.length)return t;var i=e[o];return null==i?void 0:i(t,r.bind(null,o+1))}(0)},e}();t.MiddleWareCenter=r},18366:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(8254);Object.defineProperty(t,"Command",{enumerable:!0,get:function(){return r.Command}}),Object.defineProperty(t,"Result",{enumerable:!0,get:function(){return r.Result}});var o=n(74586);Object.defineProperty(t,"generateUuid",{enumerable:!0,get:function(){return o.generateUuid}}),Object.defineProperty(t,"generateMessageTaskId",{enumerable:!0,get:function(){return o.generateMessageTaskId}}),Object.defineProperty(t,"initLogAndManager",{enumerable:!0,get:function(){return o.initLogAndManager}}),Object.defineProperty(t,"initReportManager",{enumerable:!0,get:function(){return o.initReportManager}});var i=n(609);Object.defineProperty(t,"MiddleWareType",{enumerable:!0,get:function(){return i.MiddleWareType}}),Object.defineProperty(t,"MiddleWareCenter",{enumerable:!0,get:function(){return i.MiddleWareCenter}}),Object.defineProperty(t,"MessagePriority",{enumerable:!0,get:function(){return i.MessagePriority}});var a=n(38506);Object.defineProperty(t,"RoomState",{enumerable:!0,get:function(){return a.RoomState}}),Object.defineProperty(t,"MessageWaitAcceptCmd",{enumerable:!0,get:function(){return a.MessageWaitAcceptCmd}}),Object.defineProperty(t,"RoomErrorCode",{enumerable:!0,get:function(){return a.RoomErrorCode}}),Object.defineProperty(t,"RoomWebsocketErrorCode",{enumerable:!0,get:function(){return a.RoomWebsocketErrorCode}});var s=n(3954);Object.defineProperty(t,"ConnectionController",{enumerable:!0,get:function(){return s.ConnectionController}}),Object.defineProperty(t,"ConnectionCallBackEvent",{enumerable:!0,get:function(){return s.ConnectionCallBackEvent}}),Object.defineProperty(t,"DOCUMENT_TYPE",{enumerable:!0,get:function(){return s.DOCUMENT_TYPE}}),Object.defineProperty(t,"ConnectMode",{enumerable:!0,get:function(){return s.ConnectMode}});var c=n(50051);Object.defineProperty(t,"NewChangeCommandsType",{enumerable:!0,get:function(){return c.NewChangeCommandsType}}),Object.defineProperty(t,"BatchCommitFailReason",{enumerable:!0,get:function(){return c.BatchCommitFailReason}}),Object.defineProperty(t,"CHANGESET_TYPE",{enumerable:!0,get:function(){return c.CHANGESET_TYPE}}),Object.defineProperty(t,"IBatchCommitChangesResultRetcode",{enumerable:!0,get:function(){return c.IBatchCommitChangesResultRetcode}}),Object.defineProperty(t,"DEFAULT_SEND_MESSAGE_TIMEOUT",{enumerable:!0,get:function(){return c.DEFAULT_SEND_MESSAGE_TIMEOUT}}),Object.defineProperty(t,"DEFAULT_RETRY_COUNTS",{enumerable:!0,get:function(){return c.DEFAULT_RETRY_COUNTS}}),Object.defineProperty(t,"DataEngineCodes",{enumerable:!0,get:function(){return c.DataEngineCodes}}),Object.defineProperty(t,"DocEditorError",{enumerable:!0,get:function(){return c.DocEditorError}});var l=n(31665);Object.defineProperty(t,"FeatureMessageCenter",{enumerable:!0,get:function(){return l.FeatureMessageCenter}})},40529:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},4077:function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.IBatchCommitChangesResultRetcode=t.BatchCommitFailReason=void 0,function(e){e.UNKNOW="Unknow",e.SUCCESS="Success",e.NETWORK_EXCEPTION="NetworkException",e.SERVER_VERITY_EXCEPTION="ServerVerityException"}(n||(n={})),t.BatchCommitFailReason=n,function(e){e[e.SUCCESS=0]="SUCCESS",e[e.ServerTimeout=101]="ServerTimeout",e[e.ServerInvalidParam=10001]="ServerInvalidParam",e[e.UNKNOWN_ERROR=52e3]="UNKNOWN_ERROR",e[e.USER_PRIVILEGE_FAILED=200111]="USER_PRIVILEGE_FAILED",e[e.PARAMETER_WRONG=52001]="PARAMETER_WRONG",e[e.WEBSOCKET_UNSUPPORT_BATCH_COMMIT=52002]="WEBSOCKET_UNSUPPORT_BATCH_COMMIT",e[e.CONTENT_LENGTH_EXCEED_LIMIT=52003]="CONTENT_LENGTH_EXCEED_LIMIT"}(r||(r={})),t.IBatchCommitChangesResultRetcode=r},72336:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},91917:function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.DocEditorError=t.DataEngineCodes=void 0,function(e){e[e.ERR_OK=0]="ERR_OK",e[e.ERR_UNSPECIFIED=601900]="ERR_UNSPECIFIED",e[e.ERR_TABLEKV_FAILED=601901]="ERR_TABLEKV_FAILED",e[e.ERR_DUPLICATED_KEY=601902]="ERR_DUPLICATED_KEY",e[e.ERR_OIDB=601903]="ERR_OIDB",e[e.ERR_CollabRevisionStoreErr=50001]="ERR_CollabRevisionStoreErr",e[e.ERR_GetRevisionFromSQLErr=50002]="ERR_GetRevisionFromSQLErr",e[e.ERR_BatchGetRevisionFromSQLErr=50003]="ERR_BatchGetRevisionFromSQLErr",e[e.ERR_COSPutObjectErr=50004]="ERR_COSPutObjectErr",e[e.ERR_COSGetObjectErr=50005]="ERR_COSGetObjectErr",e[e.ERR_CollabRevisionRecordStoreErr=50006]="ERR_CollabRevisionRecordStoreErr",e[e.ERR_DataEngineMetaStoreErr=50007]="ERR_DataEngineMetaStoreErr",e[e.ERR_GetMetaFromSQLErr=50008]="ERR_GetMetaFromSQLErr",e[e.ERR_GetRevisionRecordFromSQLErr=50009]="ERR_GetRevisionRecordFromSQLErr",e[e.ERR_DataEngineServerStopExpired=50010]="ERR_DataEngineServerStopExpired",e[e.ERR_RangeRevisionFromSQLErr=50011]="ERR_RangeRevisionFromSQLErr",e[e.ERR_GetDataEngineLockErr=50012]="ERR_GetDataEngineLockErr",e[e.ERR_EditBaseVersionWrongErr=50013]="ERR_EditBaseVersionWrongErr",e[e.ERR_DataEngineGetFileWrongVersion=50014]="ERR_DataEngineGetFileWrongVersion",e[e.ERR_GetRevisionRecordCountFromSQLErr=50015]="ERR_GetRevisionRecordCountFromSQLErr",e[e.ERR_SaveWatermarkToSQLErr=50016]="ERR_SaveWatermarkToSQLErr",e[e.ERR_GetWatermarkFromSQLErr=50017]="ERR_GetWatermarkFromSQLErr",e[e.ERR_RevisionRangeInvalidAttrs=50018]="ERR_RevisionRangeInvalidAttrs",e[e.ERR_GetRevisionsInvalidAttrs=50019]="ERR_GetRevisionsInvalidAttrs",e[e.ERR_DeduplicateRevisionsFail=50020]="ERR_DeduplicateRevisionsFail",e[e.ERR_CollabChangeRptMsgHpReqBodyEmpty=50021]="ERR_CollabChangeRptMsgHpReqBodyEmpty",e[e.ERR_DeduplicateCommitErr=50022]="ERR_DeduplicateCommitErr",e[e.ERR_DataEngineBrokenData=50023]="ERR_DataEngineBrokenData",e[e.ERR_GetMaxRevisionVersionFromSQLErr=50024]="ERR_GetMaxRevisionVersionFromSQLErr",e[e.ERR_SaveRevisionToSQLDuplicateErr=50025]="ERR_SaveRevisionToSQLDuplicateErr",e[e.ERR_NoCollabChangePrivilege=50026]="ERR_NoCollabChangePrivilege",e[e.ERR_NoAnnotatePrivilege=50027]="ERR_NoAnnotatePrivilege",e[e.ERR_COSGetPreSignedURLErr=50028]="ERR_COSGetPreSignedURLErr",e[e.ERR_DataEngineWrongTextType=50029]="ERR_DataEngineWrongTextType",e[e.ERR_DataEngineEmptyData=50030]="ERR_DataEngineEmptyData",e[e.ERR_ExecuteTimeOutErr=50031]="ERR_ExecuteTimeOutErr",e[e.ERR_DataEngineCgoCacheMiss=50032]="ERR_DataEngineCgoCacheMiss",e[e.ERR_CgoProtoToJSONErr=50033]="ERR_CgoProtoToJSONErr",e[e.ERR_CgoJSONToProtoErr=50034]="ERR_CgoJSONToProtoErr",e[e.ERR_CgoTransformErr=50035]="ERR_CgoTransformErr",e[e.ERR_MarshalPbLenZeroErr=50036]="ERR_MarshalPbLenZeroErr",e[e.ERR_CgoSetMaxCacheSizeErr=50037]="ERR_CgoSetMaxCacheSizeErr",e[e.ERR_CgoApplyRevisionsErr=50038]="ERR_CgoApplyRevisionsErr",e[e.ERR_CgoApplyRevisionsToSpecificKFErr=50039]="ERR_CgoApplyRevisionsToSpecificKFErr",e[e.ERR_CgoGetKeyframeErr=50040]="ERR_CgoGetKeyframeErr",e[e.ERR_CgoGetSpecificKeyframeErr=50041]="ERR_CgoGetSpecificKeyframeErr",e[e.ERR_MarshalPbErr=50042]="ERR_MarshalPbErr",e[e.ERR_CallCgoErr=50043]="ERR_CallCgoErr",e[e.ERR_DataEngineCtxCanceledErr=50044]="ERR_DataEngineCtxCanceledErr",e[e.ERR_UnmarshalPbErr=50045]="ERR_UnmarshalPbErr",e[e.ERR_CreateEmptyKeyframe=50046]="ERR_CreateEmptyKeyframe",e[e.ERR_CgoGetCacheSizeErr=50047]="ERR_CgoGetCacheSizeErr",e[e.ERR_TableKVGetWatermarkErr=50048]="ERR_TableKVGetWatermarkErr",e[e.ERR_TableKVSaveWatermarkErr=50049]="ERR_TableKVSaveWatermarkErr",e[e.ERR_TableKVSaveRevisionRecordErr=50050]="ERR_TableKVSaveRevisionRecordErr",e[e.ERR_TableKVGetRevisionRecordErr=50051]="ERR_TableKVGetRevisionRecordErr",e[e.ERR_TableKVBatchGetRevisionRecordErr=50052]="ERR_TableKVBatchGetRevisionRecordErr",e[e.ERR_TableKVCountRevisionRecordErr=50053]="ERR_TableKVCountRevisionRecordErr",e[e.ERR_TableKVSaveMetaErr=50054]="ERR_TableKVSaveMetaErr",e[e.ERR_TableKVGetMetaErr=50055]="ERR_TableKVGetMetaErr",e[e.ERR_TableKVMetaUpdateVersionInfoErr=50056]="ERR_TableKVMetaUpdateVersionInfoErr",e[e.ERR_TableKVMetaAddKeyFrameErr=50057]="ERR_TableKVMetaAddKeyFrameErr",e[e.ERR_TableKVBatchGetMetaErr=50058]="ERR_TableKVBatchGetMetaErr",e[e.ERR_TableKVSaveRevisionErr=50059]="ERR_TableKVSaveRevisionErr",e[e.ERR_TableKVGetRevisionErr=50060]="ERR_TableKVGetRevisionErr",e[e.ERR_TableKVGetRevisionRangeErr=50061]="ERR_TableKVGetRevisionRangeErr",e[e.ERR_TableKVBatchGetRevisionErr=50062]="ERR_TableKVBatchGetRevisionErr",e[e.ERR_TableKVGetRevisionMaxVerErr=50063]="ERR_TableKVGetRevisionMaxVerErr",e[e.ERR_TableKVBatchSaveRevisionErr=50064]="ERR_TableKVBatchSaveRevisionErr",e[e.ERR_CgoBuildCommandErr=50065]="ERR_CgoBuildCommandErr",e[e.ERR_CgoGetJSONFullTextErr=50066]="ERR_CgoGetJSONFullTextErr",e[e.ERR_DocVersionErr=50067]="ERR_DocVersionErr",e[e.ERR_CgoClearAllSensitiveDataErr=50068]="ERR_CgoClearAllSensitiveDataErr",e[e.ERR_TableKVGetSliceCountErr=50069]="ERR_TableKVGetSliceCountErr",e[e.ERR_FileHasAlreadyEdited=50070]="ERR_FileHasAlreadyEdited",e[e.ERR_SaveRevisionToTableKVDuplicateErr=50071]="ERR_SaveRevisionToTableKVDuplicateErr",e[e.ERR_CgoReplaceMentionErr=50072]="ERR_CgoReplaceMentionErr",e[e.ERR_CgoReplaceDocLinkErr=50073]="ERR_CgoReplaceDocLinkErr",e[e.ERR_CgoReplaceHyperlinkErr=50074]="ERR_CgoReplaceHyperlinkErr",e[e.ERR_CgoInsertCommentErr=50075]="ERR_CgoInsertCommentErr",e[e.ERR_CgoReplaceImageURLErr=50076]="ERR_CgoReplaceImageURLErr",e[e.ERR_CgoGetReplaceContentErr=50077]="ERR_CgoGetReplaceContentErr",e[e.ERR_OverSizeDoc=50078]="ERR_OverSizeDoc",e[e.ERR_RollbackToMeloDocErr=50079]="ERR_RollbackToMeloDocErr",e[e.ERR_EmptyMetaVersionInfo=50080]="ERR_EmptyMetaVersionInfo",e[e.ERR_InvalidGetHistoryRsp=50081]="ERR_InvalidGetHistoryRsp",e[e.ERR_OOXMLDocNoNeedToUpgrade=50082]="ERR_OOXMLDocNoNeedToUpgrade",e[e.ERR_ParaQuoteDoc=50083]="ERR_ParaQuoteDoc",e[e.ERR_IllegalCopy=50084]="ERR_IllegalCopy",e[e.ERR_UIDToTinyIDErr=50085]="ERR_UIDToTinyIDErr",e[e.ERR_InvalidUpgradeTinyID=50086]="ERR_InvalidUpgradeTinyID",e[e.ERR_COSDeleteObjectErr=50087]="ERR_COSDeleteObjectErr",e[e.ERR_UpgradeFileError=50088]="ERR_UpgradeFileError",e[e.ERR_TableKVGetMetaEmpty=50089]="ERR_TableKVGetMetaEmpty",e[e.ERR_DocDataCannotClone=50090]="ERR_DocDataCannotClone",e[e.ERR_DataEngineRangeStoreErr=50091]="ERR_DataEngineRangeStoreErr",e[e.ERR_CheckUserRangePrivilegeRspNil=50092]="ERR_CheckUserRangePrivilegeRspNil",e[e.ERR_CloneMetaFailedError=50093]="ERR_CloneMetaFailedError",e[e.ERR_CannotEditRangeError=50094]="ERR_CannotEditRangeError",e[e.ERR_CommitMissChangesContainRevert=50095]="ERR_CommitMissChangesContainRevert",e[e.ERR_PermissionRangeLengthZeroError=50096]="ERR_PermissionRangeLengthZeroError",e[e.ERR_GetRangePrivilegeRspNil=50097]="ERR_GetRangePrivilegeRspNil",e[e.ERR_TableKVNonLoginUserTicketErr=50098]="ERR_TableKVNonLoginUserTicketErr",e[e.ERR_InvalidVersion=50099]="ERR_InvalidVersion",e[e.ERR_EditValidateErr=50100]="ERR_EditValidateErr",e[e.ERR_TableKVSaveUpgradeVersionErr=50101]="ERR_TableKVSaveUpgradeVersionErr",e[e.ERR_TableKVGetUpgradeVersionErr=50102]="ERR_TableKVGetUpgradeVersionErr",e[e.ERR_TableKVGetUpgradeVersionEmpty=50103]="ERR_TableKVGetUpgradeVersionEmpty",e[e.ERR_TableKVDeleteMetaErr=50104]="ERR_TableKVDeleteMetaErr",e[e.ERR_TableKVDeleteRevisionErr=50105]="ERR_TableKVDeleteRevisionErr",e[e.ERR_TableKVDeleteRevisionRecordErr=50106]="ERR_TableKVDeleteRevisionRecordErr",e[e.ERR_TableKVDeleteWatermarkErr=50107]="ERR_TableKVDeleteWatermarkErr",e[e.ERR_TableKVDeleteUpgradeVersionErr=50108]="ERR_TableKVDeleteUpgradeVersionErr",e[e.ERR_GetRevisionRecordNotFound=502001]="ERR_GetRevisionRecordNotFound",e[e.ERR_GetRevisionRecordCountNotFound=502002]="ERR_GetRevisionRecordCountNotFound",e[e.ERR_GetWatermarkNotFound=502003]="ERR_GetWatermarkNotFound",e[e.ERR_GetChunkMetaNotFound=502004]="ERR_GetChunkMetaNotFound",e[e.ERR_GetChunksNotFound=502005]="ERR_GetChunksNotFound",e[e.ERR_GetTextAndLinksNotFound=502006]="ERR_GetTextAndLinksNotFound",e[e.ERR_InvalidRevertVersion=502007]="ERR_InvalidRevertVersion"}(n||(n={})),t.DataEngineCodes=n,function(e){e[e.DocEditorErrorPlaceholder=0]="DocEditorErrorPlaceholder",e[e.DocEditorErrorServerError=1e4]="DocEditorErrorServerError",e[e.DocEditorErrorMissParam=10001]="DocEditorErrorMissParam",e[e.DocEditorErrordVerNotSupport=10002]="DocEditorErrordVerNotSupport",e[e.BodyTooLargeError=60100]="BodyTooLargeError"}(r||(r={})),t.DocEditorError=r},47197:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},50051:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(72336),t),o(n(53231),t),o(n(40529),t),o(n(4077),t),o(n(32728),t),o(n(10912),t),o(n(65540),t),o(n(47197),t),o(n(39507),t),o(n(84098),t),o(n(93634),t),o(n(19612),t),o(n(7513),t),o(n(91917),t)},7513:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},65540:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.prepareCommitMessage=t.getMessageDataLength=t.CHANGESET_TYPE=void 0;var o,i=n(74586);!function(e){e.SMARTSHEET="smartsheet",e.SMARTCANVAS="smartcanvas"}(o||(o={})),t.CHANGESET_TYPE=o,t.getMessageDataLength=function(e){var t;return e?e instanceof Object?(null===(t=e.changeset)||void 0===t?void 0:t.length)||0:e.length||0:0},t.prepareCommitMessage=function(e,t,n){if("string"==typeof e)return e;var o=r(r({},e),{type:"USER_CHANGES",baseRev:e.baseRev,changeSetCount:e.changeSetCount,changeset:e.changeset,apool:e.apool,isWorkbook:e.isWorkbook,keydata:e.keydata||!1,head:e.head,subId:e.subId,changesetType:e.changesetType,oSubId:e.oSubId||!1,uuId:t,offlineMsg:e.offlineMsg,pver:n});return i.JsonUtil.jsonStringify(o)}},39507:function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.NewChangeCommandsType=void 0,function(e){e.JSON="JSON",e.BASE64="BASE64"}(n||(n={})),t.NewChangeCommandsType=n},32728:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_RETRY_COUNTS=t.DEFAULT_SEND_MESSAGE_TIMEOUT=void 0,t.DEFAULT_SEND_MESSAGE_TIMEOUT=25e3,t.DEFAULT_RETRY_COUNTS=3},10912:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},19612:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},93634:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},84098:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},53231:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},39472:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(38298),i="big-collab",a=function(){function e(){}return e.prototype.loginRoomError=function(e){this.NeedToResetLastErrorCode(e)?this.resetLastErrorCode():(this.lastAttrName=e.attrName,this.reportToServer(r(r({},e),{source:"loginRoom"})))},e.prototype.commitError=function(e){this.NeedToResetLastErrorCode(e)?this.resetLastErrorCode():(this.lastAttrName=e.attrName,this.reportToServer(r(r({},e),{source:"commitError"})))},e.prototype.serverNotice=function(e){this.NeedToResetLastErrorCode(e)?this.resetLastErrorCode():(this.lastAttrName=e.attrName,this.reportToServer(r(r({},e),{source:"serverNotice"})))},e.prototype.shutDownReport=function(e){this.NeedToResetLastErrorCode(e)||e.attrName===this.lastAttrName?this.resetLastErrorCode():this.reportToServer(r(r({},e),{source:"shutDown"}))},e.prototype.reconnectReport=function(e){this.reportToServer(r(r({},e),{source:"reconnect",transports:i}))},e.prototype.retryRequestReport=function(e,t){this.reportToServer({attrName:e.name,module:t,errorMessage:e.message,status:1,source:"retryRequest",transports:i})},e.prototype.receiverParseError=function(e,t){this.reportToServer({attrName:"receiver-parse-error",module:t,errorMessage:e,status:1,source:"receiver-parse-error",transports:i})},e.prototype.reportSocketConnect=function(e){this.reportToServer(r(r({},e),{source:"socketConnect"}))},e.prototype.reportToServer=function(e){var t=e.module,n=void 0===t?"unkown":t,r=e.source,i=void 0===r?"":r,a=e.transports,s=void 0===a?"":a;o.zzsStatus({attrid:e.attrName,status:e.status,errmsg:e.errorMessage,dimensions:[n,i,s],project:"collab"})},e.prototype.resetLastErrorCode=function(){this.lastAttrName=""},e.prototype.NeedToResetLastErrorCode=function(e){return!(null==e?void 0:e.attrName)||"0"===(null==e?void 0:e.attrName)},e}();t.default=new a},84572:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_WMODE=t.TRANSPOET_MODE_MAP=t.DEFAULT_ATTEMPT_TRANSPORT_MODE=t.DEFAULT_TRANSPORT_MODE=t.WEBSOCKET_CONFIG=void 0,t.WEBSOCKET_CONFIG={reconnectMaxTimes:3,connectTimeout:5e3,reconnectionDelay:3e3,reconnectionDelayMax:5e3,randomizationFactor:1,pollingReopenCount:0,pollingAttemptCount:3};var n=["websocket"];t.DEFAULT_TRANSPORT_MODE=n;var r=["polling","websocket"];t.DEFAULT_ATTEMPT_TRANSPORT_MODE=r;var o=new Map([["w",n],["l",["polling"]],["b",r]]);t.TRANSPOET_MODE_MAP=o,t.DEFAULT_WMODE="ww"},10274:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(96993));o(n(84572),t),o(n(76864),t),t.default=a.default},76864:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},96993:function(e,t,n){var r=n(33634).Buffer;e.exports=function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){function r(e,t){"object"===(void 0===e?"undefined":o(e))&&(t=e,e=void 0),t=t||{};var n,r=i(e),a=r.source,u=r.id,d=r.path,p=l[u]&&d in l[u].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||p?(c("ignoring socket cache for %s",a),n=s(a,t)):(l[u]||(c("new io instance for %s",a),l[u]=s(a,t)),n=l[u]),r.query&&!t.query&&(t.query=r.query),n.socket(r.path,t)}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(1),a=n(7),s=n(12),c=n(3)("socket.io-client");e.exports=t=r;var l=t.managers={};t.protocol=a.protocol,t.connect=r,t.Manager=n(12),t.Socket=n(36)},function(e,t,n){function r(e,t){var n=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(i("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),i("parse %s",e),n=o(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var r=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+r+":"+n.port,n.href=n.protocol+"://"+r+(t&&t.port===n.port?"":":"+n.port),n}var o=n(2),i=n(3)("socket.io-client:url");e.exports=r},function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,o=e.indexOf("["),i=e.indexOf("]");-1!=o&&-1!=i&&(e=e.substring(0,o)+e.substring(o,i).replace(/:/g,";")+e.substring(i,e.length));for(var a=n.exec(e||""),s={},c=14;c--;)s[r[c]]=a[c]||"";return-1!=o&&-1!=i&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s}},function(e,t,n){(function(r){function o(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function i(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))})),e.splice(i,0,r)}}function a(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}}function c(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e}function l(){try{return window.localStorage}catch(e){}}(t=e.exports=n(5)).log=a,t.formatArgs=i,t.save=s,t.load=c,t.useColors=o,t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:l(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(c())}).call(t,n(4))},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(u===setTimeout)return setTimeout(e,0);if((u===n||!u)&&setTimeout)return u=setTimeout,setTimeout(e,0);try{return u(e,0)}catch(t){try{return u.call(null,e,0)}catch(t){return u.call(this,e,0)}}}function i(e){if(d===clearTimeout)return clearTimeout(e);if((d===r||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(e);try{return d(e)}catch(t){try{return d.call(null,e)}catch(t){return d.call(this,e)}}}function a(){g&&h&&(g=!1,h.length?f=h.concat(f):v=-1,f.length&&s())}function s(){if(!g){var e=o(a);g=!0;for(var t=f.length;t;){for(h=f,f=[];++v<t;)h&&h[v].run();v=-1,t=f.length}h=null,g=!1,i(e)}}function c(e,t){this.fun=e,this.array=t}function l(){}var u,d,p=e.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:n}catch(e){u=n}try{d="function"==typeof clearTimeout?clearTimeout:r}catch(e){d=r}}();var h,f=[],g=!1,v=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];f.push(new c(e,t)),1!==f.length||g||o(s)},c.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=l,p.addListener=l,p.once=l,p.off=l,p.removeListener=l,p.removeAllListeners=l,p.emit=l,p.prependListener=l,p.prependOnceListener=l,p.listeners=function(e){return[]},p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(e,t,n){function r(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}function o(e){function n(){if(n.enabled){var e=n,r=+new Date,i=r-(o||r);e.diff=i,e.prev=o,e.curr=r,o=r;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var c=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;c++;var o=t.formatters[r];if("function"==typeof o){var i=a[c];n=o.call(e,i),a.splice(c,1),c--}return n})),t.formatArgs.call(e,a),(n.log||t.log||console.log.bind(console)).apply(e,a)}}var o;return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=r(e),n.destroy=i,"function"==typeof t.init&&t.init(n),t.instances.push(n),n}function i(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}function a(e){t.save(e),t.names=[],t.skips=[];var n,r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var i=t.instances[n];i.enabled=t.enabled(i.namespace)}}function s(){t.enable("")}function c(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1}function l(e){return e instanceof Error?e.stack||e.message:e}(t=e.exports=o.debug=o.default=o).coerce=l,t.disable=s,t.enable=a,t.enabled=c,t.humanize=n(6),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t){function n(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*u;case"days":case"day":case"d":return n*l;case"hours":case"hour":case"hrs":case"hr":case"h":return n*c;case"minutes":case"minute":case"mins":case"min":case"m":return n*s;case"seconds":case"second":case"secs":case"sec":case"s":return n*a;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function r(e){return e>=l?Math.round(e/l)+"d":e>=c?Math.round(e/c)+"h":e>=s?Math.round(e/s)+"m":e>=a?Math.round(e/a)+"s":e+"ms"}function o(e){return i(e,l,"day")||i(e,c,"hour")||i(e,s,"minute")||i(e,a,"second")||e+" ms"}function i(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var a=1e3,s=60*a,c=60*s,l=24*c,u=365.25*l;e.exports=function(e,t){t=t||{};var i=typeof e;if("string"===i&&e.length>0)return n(e);if("number"===i&&!1===isNaN(e))return t.long?o(e):r(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){function r(){}function o(e){var n=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(n+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(n+=e.nsp+","),null!=e.id&&(n+=e.id),null!=e.data){var r=i(e.data);if(!1===r)return y;n+=r}return p("encoded %j as %s",e,n),n}function i(e){try{return JSON.stringify(e)}catch(e){return!1}}function a(e,t){function n(e){var n=f.deconstructPacket(e),r=o(n.packet),i=n.buffers;i.unshift(r),t(i)}f.removeBlobs(e,n)}function s(){this.reconstructor=null}function c(e){var n=0,r={type:Number(e.charAt(0))};if(null==t.types[r.type])return d("unknown packet type "+r.type);if(t.BINARY_EVENT===r.type||t.BINARY_ACK===r.type){for(var o="";"-"!==e.charAt(++n)&&(o+=e.charAt(n),n!=e.length););if(o!=Number(o)||"-"!==e.charAt(n))throw new Error("Illegal attachments");r.attachments=Number(o)}if("/"===e.charAt(n+1))for(r.nsp="";++n&&","!==(a=e.charAt(n))&&(r.nsp+=a,n!==e.length););else r.nsp="/";var i=e.charAt(n+1);if(""!==i&&Number(i)==i){for(r.id="";++n;){var a;if(null==(a=e.charAt(n))||Number(a)!=a){--n;break}if(r.id+=e.charAt(n),n===e.length)break}r.id=Number(r.id)}if(e.charAt(++n)){var s=l(e.substr(n));if(!1===s||r.type!==t.ERROR&&!g(s))return d("invalid payload");r.data=s}return p("decoded %s as %j",e,r),r}function l(e){try{return JSON.parse(e)}catch(e){return!1}}function u(e){this.reconPack=e,this.buffers=[]}function d(e){return{type:t.ERROR,data:"parser error: "+e}}var p=n(3)("socket.io-parser"),h=n(8),f=n(9),g=n(10),v=n(11);t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=r,t.Decoder=s;var y=t.ERROR+'"encode error"';r.prototype.encode=function(e,n){p("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type?a(e,n):n([o(e)])},h(s.prototype),s.prototype.add=function(e){var n;if("string"==typeof e)n=c(e),t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type?(this.reconstructor=new u(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!v(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",n))}},s.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},u.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=f.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},u.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t,n){function r(e){if(e)return o(e)}function o(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,o=0;o<n.length;o++)if((r=n[o])===t||r.fn===t){n.splice(o,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var r=0,o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t);return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){function r(e,t){if(!e)return e;if(a(e)){var n={_placeholder:!0,num:t.length};return t.push(e),n}if(i(e)){for(var o=new Array(e.length),s=0;s<e.length;s++)o[s]=r(e[s],t);return o}if("object"==typeof e&&!(e instanceof Date)){for(var c in o={},e)o[c]=r(e[c],t);return o}return e}function o(e,t){if(!e)return e;if(e&&e._placeholder)return t[e.num];if(i(e))for(var n=0;n<e.length;n++)e[n]=o(e[n],t);else if("object"==typeof e)for(var r in e)e[r]=o(e[r],t);return e}var i=n(10),a=n(11),s=Object.prototype.toString,c="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===s.call(Blob),l="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===s.call(File);t.deconstructPacket=function(e){var t=[],n=e.data,o=e;return o.data=r(n,t),o.attachments=t.length,{packet:o,buffers:t}},t.reconstructPacket=function(e,t){return e.data=o(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){function n(e,s,u){if(!e)return e;if(c&&e instanceof Blob||l&&e instanceof File){r++;var d=new FileReader;d.onload=function(){u?u[s]=this.result:o=this.result,--r||t(o)},d.readAsArrayBuffer(e)}else if(i(e))for(var p=0;p<e.length;p++)n(e[p],p,e);else if("object"==typeof e&&!a(e))for(var h in e)n(e[h],h,e)}var r=0,o=e;n(o),r||t(o)}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){function n(e){return o&&r.isBuffer(e)||i&&(e instanceof ArrayBuffer||a(e))}e.exports=n;var o="function"==typeof r&&"function"==typeof r.isBuffer,i="function"==typeof ArrayBuffer,a=function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}},function(e,t,n){function r(e,t){if(!(this instanceof r))return new r(e,t);e&&"object"===(void 0===e?"undefined":o(e))&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new h({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||c;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(13),a=n(36),s=n(8),c=n(7),l=n(38),u=n(39),d=n(3)("socket.io-client:manager"),p=n(35),h=n(40),f=Object.prototype.hasOwnProperty;e.exports=r,r.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)f.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},r.prototype.updateSocketIds=function(){for(var e in this.nsps)f.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},r.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},s(r.prototype),r.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},r.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},r.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},r.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},r.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},r.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},r.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},r.prototype.open=r.prototype.connect=function(e,t){if(d("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;d("opening %s",this.uri),this.engine=i(this.uri,this.opts);var n=this.engine,r=this;this.readyState="opening",this.skipReconnect=!1;var o=l(n,"open",(function(){r.onopen(),e&&e()})),a=l(n,"error",(function(t){if(d("connect_error"),r.cleanup(),r.readyState="closed",r.emitAll("connect_error",t),e){var n=new Error("Connection error");n.data=t,e(n)}else r.maybeReconnectOnOpen()}));if(!1!==this._timeout){var s=this._timeout;d("connect attempt will timeout after %d",s);var c=setTimeout((function(){d("connect attempt timed out after %d",s),o.destroy(),n.close(),n.emit("error","timeout"),r.emitAll("connect_timeout",s)}),s);this.subs.push({destroy:function(){clearTimeout(c)}})}return this.subs.push(o),this.subs.push(a),this},r.prototype.onopen=function(){d("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(l(e,"data",u(this,"ondata"))),this.subs.push(l(e,"ping",u(this,"onping"))),this.subs.push(l(e,"pong",u(this,"onpong"))),this.subs.push(l(e,"error",u(this,"onerror"))),this.subs.push(l(e,"close",u(this,"onclose"))),this.subs.push(l(this.decoder,"decoded",u(this,"ondecoded")))},r.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},r.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},r.prototype.ondata=function(e){this.decoder.add(e)},r.prototype.ondecoded=function(e){this.emit("packet",e)},r.prototype.onerror=function(e){d("error",e),this.emitAll("error",e)},r.prototype.socket=function(e,t){function n(){~p(o.connecting,r)||o.connecting.push(r)}var r=this.nsps[e];if(!r){r=new a(this,e,t),this.nsps[e]=r;var o=this;r.on("connecting",n),r.on("connect",(function(){r.id=o.generateId(e)})),this.autoConnect&&n()}return r},r.prototype.destroy=function(e){var t=p(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},r.prototype.packet=function(e){d("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,(function(n){for(var r=0;r<n.length;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()})))},r.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},r.prototype.cleanup=function(){d("cleanup");for(var e=this.subs.length,t=0;t<e;t++)this.subs.shift().destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},r.prototype.close=r.prototype.disconnect=function(){d("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},r.prototype.onclose=function(e){d("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},r.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)d("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();d("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout((function(){e.skipReconnect||(d("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open((function(t){t?(d("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(d("reconnect success"),e.onreconnect())})))}),t);this.subs.push({destroy:function(){clearTimeout(n)}})}},r.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,n){e.exports=n(14),e.exports.parser=n(21)},function(e,t,n){function r(e,t){return this instanceof r?(t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=u(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=u(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=d.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,void this.open()):new r(e,t)}function o(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var i=n(15),a=n(8),s=n(3)("engine.io-client:socket"),c=n(35),l=n(21),u=n(2),d=n(29);e.exports=r,r.priorWebsocketSuccess=!1,a(r.prototype),r.protocol=l.protocol,r.Socket=r,r.Transport=n(20),r.transports=n(15),r.parser=n(21),r.prototype.createTransport=function(e){s('creating transport "%s"',e);var t=o(this.query);t.EIO=l.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new i[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},r.prototype.open=function(){var e;if(this.rememberUpgrade&&r.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout((function(){t.emit("error","No transports available")}),0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},r.prototype.setTransport=function(e){s("setting transport %s",e.name);var t=this;this.transport&&(s("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",(function(){t.onDrain()})).on("packet",(function(e){t.onPacket(e)})).on("error",(function(e){t.onError(e)})).on("close",(function(){t.onClose("transport close")}))},r.prototype.probe=function(e){function t(){if(p.onlyBinaryUpgrades){var t=!this.supportsBinary&&p.transport.supportsBinary;d=d||t}d||(s('probe transport "%s" opened',e),u.send([{type:"ping",data:"probe"}]),u.once("packet",(function(t){if(!d)if("pong"===t.type&&"probe"===t.data){if(s('probe transport "%s" pong',e),p.upgrading=!0,p.emit("upgrading",u),!u)return;r.priorWebsocketSuccess="websocket"===u.name,s('pausing current transport "%s"',p.transport.name),p.transport.pause((function(){d||"closed"!==p.readyState&&(s("changing transport and sending upgrade packet"),l(),p.setTransport(u),u.send([{type:"upgrade"}]),p.emit("upgrade",u),u=null,p.upgrading=!1,p.flush())}))}else{s('probe transport "%s" failed',e);var n=new Error("probe error");n.transport=u.name,p.emit("upgradeError",n)}})))}function n(){d||(d=!0,l(),u.close(),u=null)}function o(t){var r=new Error("probe error: "+t);r.transport=u.name,n(),s('probe transport "%s" failed because of error: %s',e,t),p.emit("upgradeError",r)}function i(){o("transport closed")}function a(){o("socket closed")}function c(e){u&&e.name!==u.name&&(s('"%s" works - aborting "%s"',e.name,u.name),n())}function l(){u.removeListener("open",t),u.removeListener("error",o),u.removeListener("close",i),p.removeListener("close",a),p.removeListener("upgrading",c)}s('probing transport "%s"',e);var u=this.createTransport(e,{probe:1}),d=!1,p=this;r.priorWebsocketSuccess=!1,u.once("open",t),u.once("error",o),u.once("close",i),this.once("close",a),this.once("upgrading",c),u.open()},r.prototype.onOpen=function(){if(s("socket open"),this.readyState="open",r.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){s("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},r.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(s('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else s('packet received with socket readyState "%s"',this.readyState)},r.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},r.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout((function(){"closed"!==t.readyState&&t.onClose("ping timeout")}),e||t.pingInterval+t.pingTimeout)},r.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout((function(){s("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)}),e.pingInterval)},r.prototype.ping=function(){var e=this;this.sendPacket("ping",(function(){e.emit("ping")}))},r.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},r.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(s("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},r.prototype.write=r.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},r.prototype.sendPacket=function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var o={type:e,data:t,options:n};this.emit("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}},r.prototype.close=function(){function e(){r.onClose("forced close"),s("socket closing - telling transport to close"),r.transport.close()}function t(){r.removeListener("upgrade",t),r.removeListener("upgradeError",t),e()}function n(){r.once("upgrade",t),r.once("upgradeError",t)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var r=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?n():e()})):this.upgrading?n():e()}return this},r.prototype.onError=function(e){s("socket error %j",e),r.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},r.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){s('socket close with reason: "%s"',e);var n=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),n.writeBuffer=[],n.prevBufferLen=0}},r.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~c(this.transports,e[n])&&t.push(e[n]);return t}},function(e,t,n){function r(e){var t=!1,n=!1,r=!1!==e.jsonp;if("undefined"!=typeof location){var s="https:"===location.protocol,c=location.port;c||(c=s?443:80),t=e.hostname!==location.hostname||c!==e.port,n=e.secure!==s}if(e.xdomain=t,e.xscheme=n,"open"in new o(e)&&!e.forceJSONP)return new i(e);if(!r)throw new Error("JSONP disabled");return new a(e)}var o=n(16),i=n(18),a=n(32),s=n(33);t.polling=r,t.websocket=s},function(e,t,n){var r=n(17);e.exports=function(e){var t=e.xdomain,n=e.xscheme,o=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||r))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&o)return new XDomainRequest}catch(e){}if(!t)try{return new(self[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}},function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},function(e,t,n){function r(){}function o(e){if(c.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!=typeof location){var t="https:"===location.protocol,n=location.port;n||(n=t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t}}function i(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function a(){for(var e in i.requests)i.requests.hasOwnProperty(e)&&i.requests[e].abort()}var s=n(16),c=n(19),l=n(8),u=n(30),d=n(3)("engine.io-client:polling-xhr");if(e.exports=o,e.exports.Request=i,u(o,c),o.prototype.supportsBinary=!0,o.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new i(e)},o.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),o=this;r.on("success",t),r.on("error",(function(e){o.onError("xhr post error",e)})),this.sendXhr=r},o.prototype.doPoll=function(){d("xhr poll");var e=this.request(),t=this;e.on("data",(function(e){t.onData(e)})),e.on("error",(function(e){t.onError("xhr poll error",e)})),this.pollXhr=e},l(i.prototype),i.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new s(e),n=this;try{d("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var r in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(r)&&t.setRequestHeader(r,this.extraHeaders[r])}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=!0),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");n.supportsBinary&&"application/octet-stream"===e&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout((function(){n.onError(t.status)}),0))},d("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout((function(){n.onError(e)}),0)}"undefined"!=typeof document&&(this.index=i.requestsCount++,i.requests[this.index]=this)},i.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},i.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},i.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},i.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=r:this.xhr.onreadystatechange=r,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete i.requests[this.index],this.xhr=null}},i.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e="application/octet-stream"===t&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},i.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},i.prototype.abort=function(){this.cleanup()},i.requestsCount=0,i.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",a);else if("function"==typeof addEventListener){var p="onpagehide"in self?"pagehide":"unload";addEventListener(p,a,!1)}},function(e,t,n){function r(e){var t=e&&e.forceBase64;u&&!t||(this.supportsBinary=!1),o.call(this,e)}var o=n(20),i=n(29),a=n(21),s=n(30),c=n(31),l=n(3)("engine.io-client:polling");e.exports=r;var u=null!=new(n(16))({xdomain:!1}).responseType;s(r,o),r.prototype.name="polling",r.prototype.doOpen=function(){this.poll()},r.prototype.pause=function(e){function t(){l("paused"),n.readyState="paused",e()}var n=this;if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(l("we are currently polling - waiting to pause"),r++,this.once("pollComplete",(function(){l("pre-pause polling complete"),--r||t()}))),this.writable||(l("we are currently writing - waiting to pause"),r++,this.once("drain",(function(){l("pre-pause writing complete"),--r||t()})))}else t()},r.prototype.poll=function(){l("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},r.prototype.onData=function(e){var t=this;l("polling got data %s",e);var n=function(e,n,r){return"opening"===t.readyState&&t.onOpen(),"close"===e.type?(t.onClose(),!1):void t.onPacket(e)};a.decodePayload(e,this.socket.binaryType,n),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():l('ignoring poll - transport state "%s"',this.readyState))},r.prototype.doClose=function(){function e(){l("writing close packet"),t.write([{type:"close"}])}var t=this;"open"===this.readyState?(l("transport open - closing"),e()):(l("transport not open - deferring close"),this.once("open",e))},r.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};a.encodePayload(e,this.supportsBinary,(function(e){t.doWrite(e,n)}))},r.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=c()),this.supportsBinary||e.sid||(e.b64=1),e=i.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e}},function(e,t,n){function r(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}var o=n(21),i=n(8);e.exports=r,i(r.prototype),r.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},r.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},r.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},r.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},r.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},r.prototype.onData=function(e){var t=o.decodePacket(e,this.socket.binaryType);this.onPacket(t)},r.prototype.onPacket=function(e){this.emit("packet",e)},r.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,n){function r(e,n){return n("b"+t.packets[e.type]+e.data.data)}function o(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var o=e.data,i=new Uint8Array(o),a=new Uint8Array(1+o.byteLength);a[0]=m[e.type];for(var s=0;s<i.length;s++)a[s+1]=i[s];return r(a.buffer)}function i(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var o=new FileReader;return o.onload=function(){t.encodePacket({type:e.type,data:o.result},n,!0,r)},o.readAsArrayBuffer(e.data)}function a(e,n,r){if(!n)return t.encodeBase64Packet(e,r);if(y)return i(e,n,r);var o=new Uint8Array(1);return o[0]=m[e.type],r(new C([o.buffer,e.data]))}function s(e){try{e=f.decode(e,{strict:!1})}catch(e){return!1}return e}function c(e,t,n){for(var r=new Array(e.length),o=h(e.length,n),i=function(e,n,o){t(n,(function(t,n){r[e]=n,o(t,r)}))},a=0;a<e.length;a++)i(a,e[a],o)}var l,u=n(22),d=n(23),p=n(24),h=n(25),f=n(26);"undefined"!=typeof ArrayBuffer&&(l=n(27));var g="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),v="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),y=g||v;t.protocol=3;var m=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},b=u(m),_={type:"error",data:"parser error"},C=n(28);t.encodePacket=function(e,t,n,i){"function"==typeof t&&(i=t,t=!1),"function"==typeof n&&(i=n,n=null);var s=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!=typeof ArrayBuffer&&s instanceof ArrayBuffer)return o(e,t,i);if(void 0!==C&&s instanceof C)return a(e,t,i);if(s&&s.base64)return r(e,i);var c=m[e.type];return void 0!==e.data&&(c+=n?f.encode(String(e.data),{strict:!1}):String(e.data)),i(""+c)},t.encodeBase64Packet=function(e,n){var r,o="b"+t.packets[e.type];if(void 0!==C&&e.data instanceof C){var i=new FileReader;return i.onload=function(){var e=i.result.split(",")[1];n(o+e)},i.readAsDataURL(e.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var a=new Uint8Array(e.data),s=new Array(a.length),c=0;c<a.length;c++)s[c]=a[c];r=String.fromCharCode.apply(null,s)}return o+=btoa(r),n(o)},t.decodePacket=function(e,n,r){if(void 0===e)return _;if("string"==typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(r&&!1===(e=s(e)))return _;var o=e.charAt(0);return Number(o)==o&&b[o]?e.length>1?{type:b[o],data:e.substring(1)}:{type:b[o]}:_}o=new Uint8Array(e)[0];var i=p(e,1);return C&&"blob"===n&&(i=new C([i])),{type:b[o],data:i}},t.decodeBase64Packet=function(e,t){var n=b[e.charAt(0)];if(!l)return{type:n,data:{base64:!0,data:e.substr(1)}};var r=l.decode(e.substr(1));return"blob"===t&&C&&(r=new C([r])),{type:n,data:r}},t.encodePayload=function(e,n,r){function o(e){return e.length+":"+e}function i(e,r){t.encodePacket(e,!!a&&n,!1,(function(e){r(null,o(e))}))}"function"==typeof n&&(r=n,n=null);var a=d(e);return n&&a?C&&!y?t.encodePayloadAsBlob(e,r):t.encodePayloadAsArrayBuffer(e,r):e.length?void c(e,i,(function(e,t){return r(t.join(""))})):r("0:")},t.decodePayload=function(e,n,r){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,r);var o;if("function"==typeof n&&(r=n,n=null),""===e)return r(_,0,1);for(var i,a,s="",c=0,l=e.length;c<l;c++){var u=e.charAt(c);if(":"===u){if(""===s||s!=(i=Number(s)))return r(_,0,1);if(s!=(a=e.substr(c+1,i)).length)return r(_,0,1);if(a.length){if(o=t.decodePacket(a,n,!1),_.type===o.type&&_.data===o.data)return r(_,0,1);if(!1===r(o,c+i,l))return}c+=i,s=""}else s+=u}return""!==s?r(_,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){function r(e,n){t.encodePacket(e,!0,!0,(function(e){return n(null,e)}))}return e.length?void c(e,r,(function(e,t){var r=t.reduce((function(e,t){var n;return e+(n="string"==typeof t?t.length:t.byteLength).toString().length+n+2}),0),o=new Uint8Array(r),i=0;return t.forEach((function(e){var t="string"==typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),a=0;a<e.length;a++)r[a]=e.charCodeAt(a);n=r.buffer}o[i++]=t?0:1;var s=n.byteLength.toString();for(a=0;a<s.length;a++)o[i++]=parseInt(s[a]);for(o[i++]=255,r=new Uint8Array(n),a=0;a<r.length;a++)o[i++]=r[a]})),n(o.buffer)})):n(new ArrayBuffer(0))},t.encodePayloadAsBlob=function(e,n){function r(e,n){t.encodePacket(e,!0,!0,(function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);e=r.buffer,t[0]=0}var i=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),a=new Uint8Array(i.length+1);for(o=0;o<i.length;o++)a[o]=parseInt(i[o]);if(a[i.length]=255,C){var s=new C([t.buffer,a.buffer,e]);n(null,s)}}))}c(e,r,(function(e,t){return n(new C(t))}))},t.decodePayloadAsBinary=function(e,n,r){"function"==typeof n&&(r=n,n=null);for(var o=e,i=[];o.byteLength>0;){for(var a=new Uint8Array(o),s=0===a[0],c="",l=1;255!==a[l];l++){if(c.length>310)return r(_,0,1);c+=a[l]}o=p(o,2+c.length),c=parseInt(c);var u=p(o,0,c);if(s)try{u=String.fromCharCode.apply(null,new Uint8Array(u))}catch(e){var d=new Uint8Array(u);for(u="",l=0;l<d.length;l++)u+=String.fromCharCode(d[l])}i.push(u),o=p(o,c)}var h=i.length;i.forEach((function(e,o){r(t.decodePacket(e,n,!0),o,h)}))}},function(e,t){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t}},function(e,t,n){function o(e){if(!e||"object"!=typeof e)return!1;if(i(e)){for(var t=0,n=e.length;t<n;t++)if(o(e[t]))return!0;return!1}if("function"==typeof r&&r.isBuffer&&r.isBuffer(e)||"function"==typeof ArrayBuffer&&e instanceof ArrayBuffer||s&&e instanceof Blob||c&&e instanceof File)return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return o(e.toJSON(),!0);for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)&&o(e[a]))return!0;return!1}var i=n(10),a=Object.prototype.toString,s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===a.call(Blob),c="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===a.call(File);e.exports=o},function(e,t){e.exports=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);for(var o=new Uint8Array(e),i=new Uint8Array(n-t),a=t,s=0;a<n;a++,s++)i[s]=o[a];return i.buffer}},function(e,t){function n(e,t,n){function o(e,r){if(o.count<=0)throw new Error("after called too many times");--o.count,e?(i=!0,t(e),t=n):0!==o.count||i||t(null,r)}var i=!1;return n=n||r,o.count=e,0===e?t():o}function r(){}e.exports=n},function(e,t){function n(e){for(var t,n,r=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function r(e){for(var t,n=e.length,r=-1,o="";++r<n;)(t=e[r])>65535&&(o+=f((t-=65536)>>>10&1023|55296),t=56320|1023&t),o+=f(t);return o}function o(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function i(e,t){return f(e>>t&63|128)}function a(e,t){if(0==(4294967168&e))return f(e);var n="";return 0==(4294965248&e)?n=f(e>>6&31|192):0==(4294901760&e)?(o(e,t)||(e=65533),n=f(e>>12&15|224),n+=i(e,6)):0==(4292870144&e)&&(n=f(e>>18&7|240),n+=i(e,12),n+=i(e,6)),n+f(63&e|128)}function s(e,t){for(var r=!1!==(t=t||{}).strict,o=n(e),i=o.length,s=-1,c="";++s<i;)c+=a(o[s],r);return c}function c(){if(h>=p)throw Error("Invalid byte index");var e=255&d[h];if(h++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function l(e){var t,n;if(h>p)throw Error("Invalid byte index");if(h==p)return!1;if(t=255&d[h],h++,0==(128&t))return t;if(192==(224&t)){if((n=(31&t)<<6|c())>=128)return n;throw Error("Invalid continuation byte")}if(224==(240&t)){if((n=(15&t)<<12|c()<<6|c())>=2048)return o(n,e)?n:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(n=(7&t)<<18|c()<<12|c()<<6|c())>=65536&&n<=1114111)return n;throw Error("Invalid UTF-8 detected")}function u(e,t){var o=!1!==(t=t||{}).strict;d=n(e),p=d.length,h=0;for(var i,a=[];!1!==(i=l(o));)a.push(i);return r(a)}var d,p,h,f=String.fromCharCode;e.exports={version:"2.1.2",encode:s,decode:u}},function(e,t){!function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),r=0;r<e.length;r++)n[e.charCodeAt(r)]=r;t.encode=function(t){var n,r=new Uint8Array(t),o=r.length,i="";for(n=0;n<o;n+=3)i+=e[r[n]>>2],i+=e[(3&r[n])<<4|r[n+1]>>4],i+=e[(15&r[n+1])<<2|r[n+2]>>6],i+=e[63&r[n+2]];return o%3==2?i=i.substring(0,i.length-1)+"=":o%3==1&&(i=i.substring(0,i.length-2)+"=="),i},t.decode=function(e){var t,r,o,i,a,s=.75*e.length,c=e.length,l=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var u=new ArrayBuffer(s),d=new Uint8Array(u);for(t=0;t<c;t+=4)r=n[e.charCodeAt(t)],o=n[e.charCodeAt(t+1)],i=n[e.charCodeAt(t+2)],a=n[e.charCodeAt(t+3)],d[l++]=r<<2|o>>4,d[l++]=(15&o)<<4|i>>2,d[l++]=(3&i)<<6|63&a;return u}}()},function(e,t){function n(e){return e.map((function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var n=new Uint8Array(e.byteLength);n.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=n.buffer}return t}return e}))}function r(e,t){t=t||{};var r=new i;return n(e).forEach((function(e){r.append(e)})),t.type?r.getBlob(t.type):r.getBlob()}function o(e,t){return new Blob(n(e),t||{})}var i=void 0!==i?i:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,a=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),s=a&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),c=i&&i.prototype.append&&i.prototype.getBlob;"undefined"!=typeof Blob&&(r.prototype=Blob.prototype,o.prototype=Blob.prototype),e.exports=a?s?Blob:o:c?r:void 0},function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),r=0,o=n.length;r<o;r++){var i=n[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}},function(e,t){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t){function n(e){var t="";do{t=a[e%s]+t,e=Math.floor(e/s)}while(e>0);return t}function r(e){var t=0;for(u=0;u<e.length;u++)t=t*s+c[e.charAt(u)];return t}function o(){var e=n(+new Date);return e!==i?(l=0,i=e):e+"."+n(l++)}for(var i,a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),s=64,c={},l=0,u=0;u<s;u++)c[a[u]]=u;o.encode=n,o.decode=r,e.exports=o},function(e,t,n){(function(t){function r(){}function o(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{}}function i(e){if(a.call(this,e),this.query=this.query||{},!c){var t=o();c=t.___eio=t.___eio||[]}this.index=c.length;var n=this;c.push((function(e){n.onData(e)})),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",(function(){n.script&&(n.script.onerror=r)}),!1)}var a=n(19),s=n(30);e.exports=i;var c,l=/\n/g,u=/\\n/g;s(i,a),i.prototype.supportsBinary=!1,i.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),a.prototype.doClose.call(this)},i.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)}),100)},i.prototype.doWrite=function(e,t){function n(){r(),t()}function r(){if(o.iframe)try{o.form.removeChild(o.iframe)}catch(e){o.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+o.iframeId+'">';i=document.createElement(e)}catch(e){(i=document.createElement("iframe")).name=o.iframeId,i.src="javascript:0"}i.id=o.iframeId,o.form.appendChild(i),o.iframe=i}var o=this;if(!this.form){var i,a=document.createElement("form"),s=document.createElement("textarea"),c=this.iframeId="eio_iframe_"+this.index;a.className="socketio",a.style.position="absolute",a.style.top="-1000px",a.style.left="-1000px",a.target=c,a.method="POST",a.setAttribute("accept-charset","utf-8"),s.name="d",a.appendChild(s),document.body.appendChild(a),this.form=a,this.area=s}this.form.action=this.uri(),r(),e=e.replace(u,"\\\n"),this.area.value=e.replace(l,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===o.iframe.readyState&&n()}:this.iframe.onload=n}}).call(t,function(){return this}())},function(e,t,n){function o(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=i&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(h=a),s.call(this,e)}var i,a,s=n(20),c=n(21),l=n(29),u=n(30),d=n(31),p=n(3)("engine.io-client:websocket");if("undefined"==typeof self)try{a=n(34)}catch(e){}else i=self.WebSocket||self.MozWebSocket;var h=i||a;e.exports=o,u(o,s),o.prototype.name="websocket",o.prototype.supportsBinary=!0,o.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new h(e,t):new h(e):new h(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},o.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},o.prototype.write=function(e){function t(){n.emit("flush"),setTimeout((function(){n.writable=!0,n.emit("drain")}),0)}var n=this;this.writable=!1;for(var o=e.length,i=0,a=o;i<a;i++)!function(e){c.encodePacket(e,n.supportsBinary,(function(i){if(!n.usingBrowserWebSocket){var a={};e.options&&(a.compress=e.options.compress),n.perMessageDeflate&&("string"==typeof i?r.byteLength(i):i.length)<n.perMessageDeflate.threshold&&(a.compress=!1)}try{n.usingBrowserWebSocket?n.ws.send(i):n.ws.send(i,a)}catch(e){p("websocket closed before onclose event")}--o||t()}))}(e[i])},o.prototype.onClose=function(){s.prototype.onClose.call(this)},o.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},o.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=d()),this.supportsBinary||(e.b64=1),(e=l.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},o.prototype.check=function(){return!(!h||"__initialize"in h&&this.name===o.prototype.name)}},function(e,t){},function(e,t){var n=[].indexOf;e.exports=function(e,t){if(n)return e.indexOf(t);for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}},function(e,t,n){function r(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(7),a=n(8),s=n(37),c=n(38),l=n(39),u=n(3)("socket.io-client:socket"),d=n(29),p=n(23);e.exports=r;var h={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},f=a.prototype.emit;a(r.prototype),r.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[c(e,"open",l(this,"onopen")),c(e,"packet",l(this,"onpacket")),c(e,"close",l(this,"onclose"))]}},r.prototype.open=r.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},r.prototype.send=function(){var e=s(arguments);return e.unshift("message"),this.emit.apply(this,e),this},r.prototype.emit=function(e){if(h.hasOwnProperty(e))return f.apply(this,arguments),this;var t=s(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:p(t))?i.BINARY_EVENT:i.EVENT,data:t,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(u("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},r.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},r.prototype.onopen=function(){if(u("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"===o(this.query)?d.encode(this.query):this.query;u("sending connect packet with query %s",e),this.packet({type:i.CONNECT,query:e})}else this.packet({type:i.CONNECT})},r.prototype.onclose=function(e){u("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},r.prototype.onpacket=function(e){var t=e.nsp===this.nsp,n=e.type===i.ERROR&&"/"===e.nsp;if(t||n)switch(e.type){case i.CONNECT:this.onconnect();break;case i.EVENT:case i.BINARY_EVENT:this.onevent(e);break;case i.ACK:case i.BINARY_ACK:this.onack(e);break;case i.DISCONNECT:this.ondisconnect();break;case i.ERROR:this.emit("error",e.data)}},r.prototype.onevent=function(e){var t=e.data||[];u("emitting event %j",t),null!=e.id&&(u("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?f.apply(this,t):this.receiveBuffer.push(t)},r.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var r=s(arguments);u("sending ack %j",r),t.packet({type:p(r)?i.BINARY_ACK:i.ACK,id:e,data:r})}}},r.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(u("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):u("bad ack %s",e.id)},r.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},r.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)f.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},r.prototype.ondisconnect=function(){u("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},r.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},r.prototype.close=r.prototype.disconnect=function(){return this.connected&&(u("performing disconnect (%s)",this.nsp),this.packet({type:i.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},r.prototype.compress=function(e){return this.flags.compress=e,this},r.prototype.binary=function(e){return this.flags.binary=e,this}},function(e,t){function n(e,t){for(var n=[],r=(t=t||0)||0;r<e.length;r++)n[r-t]=e[r];return n}e.exports=n},function(e,t){function n(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}e.exports=n},function(e,t){var n=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var r=n.call(arguments,2);return function(){return t.apply(e,r.concat(n.call(arguments)))}}},function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}}])},89636:function(e,t){var n=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a};Object.defineProperty(t,"__esModule",{value:!0}),t.getDecodeURIComponentValue=t.getCookieForMessage=t.Cookie=void 0;var r=function(e){try{return decodeURIComponent(e)}catch(t){return e}};t.getDecodeURIComponentValue=r;var o={get:function(e){var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return t?r(t[2]):""},getXsrf:function(){return o.get("TOK")||""}};t.Cookie=o,t.getCookieForMessage=function(){return document.cookie.split(";").map((function(e){var t=n(/(\w+)=(.*)/.exec(e.trim())||[],3),o=t[0],i=t[1],a=t[2];return i?i+"="+r(a):o})).join(";")}},7455:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageHead=void 0;var r=n(89636),o=n(54925);t.createMessageHead=function(e,t){var n,i,a=t.baseRev,s=t.taskId,c=t.command,l=t.additionalFieldsToHead,u=t.getHeaderGeneralPacket,d=e.serverVars,p=e.nowUserIndex,h=(e.config,Number(e.userid.startsWith("g"))),f={type:c,uid:e.uid||e.userid.replace("p.","").replace("g.",""),task_id:s,session_type:h,u:null!=p?p:window.nowUserIndex,base_rev:a,generalpacket:u,apid:d.apid,docid:d.globalPadId,code_ver:null!==(n=d.pver)&&void 0!==n?n:0,gray:null!==(i=d.gray)&&void 0!==i?i:0,dver:d.dver,docs_type:d.padType,wl:r.Cookie.get("wl"),cookie:r.getCookieForMessage()};return f=Object.assign(null!=l?l:{},f),o.JsonUtil.jsonStringify(f)}},74586:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(89636),t),o(n(83561),t),o(n(44629),t),o(n(64879),t),o(n(54925),t),o(n(7455),t),o(n(50252),t),o(n(63948),t)},63948:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isInvalidWaitAcceptCmd=t.isInvalidMessage=void 0;var n=function(e){var t;return!(!e.onsendAccept||(null===(t=e.customParam)||void 0===t?void 0:t.waitAcceptCmd)&&"[object Array]"===Object.prototype.toString.call(e.customParam.waitAcceptCmd)&&0!==e.customParam.waitAcceptCmd.length)};t.isInvalidWaitAcceptCmd=n,t.isInvalidMessage=function(e){return function(e){return"USER_CHANGES"===e.cmd&&!e.onsendAccept}(e)||n(e)}},54925:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.JsonUtil=void 0;var r=n(83561),o=function(){function e(){}return e.parseJson=function(e){var t;try{t=JSON.parse(e)}catch(e){r.ConnectionLog.error("parseJson: error = "+e+".")}return t},e.jsonStringify=function(e){var t="";try{t=JSON.stringify(e)}catch(e){r.ConnectionLog.error("jsonStringify: error = "+e+".")}return t},e}();t.JsonUtil=o},83561:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.initLogAndManager=t.ConnectionLog=void 0;var n={ConnectionLogModule:"ConnectionLog ",liteReconnects:0,needSaveLog:function(){return n.liteReconnects<5},debug:function(){},info:function(){},warn:function(){},error:function(){}};t.ConnectionLog=n,t.initLogAndManager=function(e){e&&(n.debug=function(t){var r;n.needSaveLog()&&(null===(r=e.debug)||void 0===r||r.call(e,n.ConnectionLogModule,t))},n.info=function(t){var r;n.needSaveLog()&&(null===(r=e.info)||void 0===r||r.call(e,n.ConnectionLogModule,t))},n.warn=function(t){var r;n.needSaveLog()&&(null===(r=e.warn)||void 0===r||r.call(e,n.ConnectionLogModule,t))},n.error=function(t){var r;n.needSaveLog()&&(null===(r=e.error)||void 0===r||r.call(e,n.ConnectionLogModule,t))})}},44629:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.initReportManager=t.ReportManager=void 0;var n={tdw:function(e){console.log("report.tdw: ",e)},monitor:function(e){console.log("report.monitor: ",e)}};t.ReportManager=n,t.initReportManager=function(e){e&&(n.tdw=function(t){var n;null===(n=e.tdw)||void 0===n||n.call(e,t)},n.monitor=function(t){var n;null===(n=e.monitor)||void 0===n||n.call(e,t)})}},69953:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.RequestBackOff=void 0;var i=n(90304),a=function(e){function t(){return e.call(this,0)||this}return o(t,e),t.prototype.next=function(e){var t=e.result,n=e.attempt;if(t&&"error"in t)return t.error.code===i.REQUEST_ERROR_CODE.timeout?(this.duration=0,this):(this.duration=1e3*Math.min(2*n,30),this)},t}(i.BaseBackoff);t.RequestBackOff=a},50252:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Request=void 0;var a=n(90304),s=n(74586),c=n(64033),l=n(8254),u=n(69953),d=a.createNetworkRequestInstance(),p=function(e){var t,n,r=null!==(t=e.code)&&void 0!==t?t:"";return!![a.REQUEST_ERROR_CODE.network,a.REQUEST_ERROR_CODE.timeout].includes(r)||200!==(null===(n=e.response)||void 0===n?void 0:n.status)},h=function(){function e(){}return e.prototype.sendRequest=function(e,t,n,a){return o(this,void 0,void 0,(function(){var o,h,f,g;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),o=void 0,h=new u.RequestBackOff,f=r(r({},a),{errorFilter:p,backoffFactory:h}),t!==c.Method.GET?[3,2]:[4,d.get(e,f)];case 1:return o=i.sent(),[3,4];case 2:return[4,d.post(e,n,f)];case 3:o=i.sent(),i.label=4;case 4:return[2,new l.Result(void 0,o)];case 5:return g=i.sent(),s.ConnectionLog.error("Request Failed, url:"+e+", stack: "+(null==g?void 0:g.stack)+", message: "+(null==g?void 0:g.message)+", code: "+(null==g?void 0:g.code)),[2,new l.Result(g)];case 6:return[2]}}))}))},e.prototype.sendBeacon=function(e,t,n){try{var r=null!=n?n:l.ContentTypeValue.JSON,o=new Blob([s.JsonUtil.jsonStringify(t)],{type:r});return navigator.sendBeacon(e,o)}catch(t){return s.ConnectionLog.error("sendBeacon Failed, url:"+e+", stack: "+(null==t?void 0:t.stack)+", message: "+(null==t?void 0:t.message)+", code: "+(null==t?void 0:t.code)),!1}},e}();t.Request=h},64879:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.generateMessageTaskId=t.generateUuid=void 0,t.generateUuid=function(e,t){return t?e+t.slice(0,5):e},t.generateMessageTaskId=function(){return Math.ceil(0x4189374bc6a7f0*Math.random())}},38506:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(39055),t),o(n(29430),t),o(n(86494),t),o(n(70334),t),o(n(80177),t),o(n(86264),t),o(n(84572),t),o(n(35661),t)},39055:function(e,t){var n,r,o,i;Object.defineProperty(t,"__esModule",{value:!0}),t.MessageState=t.MessageWaitAcceptCmd=t.MessageResultEvent=t.RoomState=void 0,function(e){e.INIT="INIT",e.CONNECTING="CONNECTING",e.OPENED="OPENED",e.RECONNECTING_IN_CLOSED="RECONNECTING_In_CLOSED",e.SHUTDOWN="SHUTDOWN"}(n||(n={})),t.RoomState=n,function(e){e.ON_POST="onpost",e.NET_STATUS_CHANGE="netStatusChange",e.ON_SEND_ACCEPT="onsendAccept"}(r||(r={})),t.MessageResultEvent=r,function(e){e.ACCEPT_COMMIT="ACCEPT_COMMIT",e.COMMIT_ERROR="COMMIT_ERROR",e.TASK_DUPLICATE="TASK_DUPLICATE"}(o||(o={})),t.MessageWaitAcceptCmd=o,function(e){e.UNKNOWN="unknown",e.SENDING="sending",e.WAITING="waiting",e.WAIT_ACCEPT="waitAccept"}(i||(i={})),t.MessageState=i},80177:function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.NEED_RECONNECT_ERRCODES=t.NOT_NEED_TO_HANDLE_ERRCODES=t.SERVER_SUCCESS_CODES=t.NEED_RETRY_ERRCODES=t.RoomWebsocketErrorCode=t.RoomErrorCode=void 0,function(e){e[e.SUCCESS=0]="SUCCESS",e[e.TIMEOUT=101]="TIMEOUT",e[e.PARA_ERROR=102]="PARA_ERROR",e[e.EXIST=103]="EXIST",e[e.ROOM_DISCONNECT=104]="ROOM_DISCONNECT",e[e.ROOM_CLOSE=105]="ROOM_CLOSE",e[e.ROOM_STATE_ERR=106]="ROOM_STATE_ERR",e[e.ROOM_SHUTDOWN=107]="ROOM_SHUTDOWN",e[e.STATUS_ERR=108]="STATUS_ERR",e[e.BIG_COLLAB_CONNECT_TIMEOUT=109]="BIG_COLLAB_CONNECT_TIMEOUT"}(n||(n={})),t.RoomErrorCode=n,function(e){e[e.SOCKET_SERVER_SUCCESS=0]="SOCKET_SERVER_SUCCESS",e[e.SOCKET_DATA_SERVER_UNKNOWN_ERROR=1e4]="SOCKET_DATA_SERVER_UNKNOWN_ERROR",e[e.SOCKET_DATA_PROTOCOL_FIELD_LACK=10001]="SOCKET_DATA_PROTOCOL_FIELD_LACK",e[e.SOCKET_DATA_SERVER_ERROR=4e4]="SOCKET_DATA_SERVER_ERROR",e[e.SOCKET_DATA_DOC_NOT_EXIST=40001]="SOCKET_DATA_DOC_NOT_EXIST",e[e.SOCKET_DATA_SUBID_ERROR=40002]="SOCKET_DATA_SUBID_ERROR",e[e.SOCKET_DATA_ACTION_LENGTH=40003]="SOCKET_DATA_ACTION_LENGTH",e[e.SOCKET_DATA_CHANGESET_EASYSYNC=40005]="SOCKET_DATA_CHANGESET_EASYSYNC",e[e.SOCKET_DATA_SAVE_FAIL=40006]="SOCKET_DATA_SAVE_FAIL",e[e.SOCKET_DATA_READ_FAIL=40020]="SOCKET_DATA_READ_FAIL",e[e.SOCKET_DATA_BASEREV_ERROR=40021]="SOCKET_DATA_BASEREV_ERROR",e[e.SOCKET_DATA_NOT_SUPPORTED_TYPE=40022]="SOCKET_DATA_NOT_SUPPORTED_TYPE",e[e.SOCKET_DATA_NOT_SUPPORTED_PROTO=40023]="SOCKET_DATA_NOT_SUPPORTED_PROTO",e[e.SOCKET_GRAY_VERSION_INCONFORMITY=40024]="SOCKET_GRAY_VERSION_INCONFORMITY",e[e.SOCKET_DOCUMENT_EDIT_COLLAB_LIMIT=40025]="SOCKET_DOCUMENT_EDIT_COLLAB_LIMIT",e[e.SOCKET_DATA_CONTENT_LIMIT=40026]="SOCKET_DATA_CONTENT_LIMIT",e[e.SOCKET_DATA_REV_DIFF_UPPER_TEN=40027]="SOCKET_DATA_REV_DIFF_UPPER_TEN",e[e.SOCKET_DATA_EASYSYNC_TIMEOUT=40028]="SOCKET_DATA_EASYSYNC_TIMEOUT",e[e.SOCKET_CLIENT_VERSION_TOO_OLD=40029]="SOCKET_CLIENT_VERSION_TOO_OLD",e[e.SOCKET_JS_TOO_OLD=40030]="SOCKET_JS_TOO_OLD",e[e.SOCKET_NOT_CONFILCT_TO_COMMIT=40031]="SOCKET_NOT_CONFILCT_TO_COMMIT",e[e.SOCKET_COMMIT_QUEUE_NORMAL_LOCK=40032]="SOCKET_COMMIT_QUEUE_NORMAL_LOCK",e[e.SOCKET_COMMIT_QUEUE_OFFLINE_LOCK=40033]="SOCKET_COMMIT_QUEUE_OFFLINE_LOCK",e[e.SOCKET_COMMIT_DVER_INCONFORMITY=40034]="SOCKET_COMMIT_DVER_INCONFORMITY",e[e.SOCKET_SHEET_COMMIT_MIDDLE_SERVER_ERROR=40035]="SOCKET_SHEET_COMMIT_MIDDLE_SERVER_ERROR",e[e.SOCKET_SHEET_COMMIT_MUTATION_FORMAT_ERROR=40036]="SOCKET_SHEET_COMMIT_MUTATION_FORMAT_ERROR",e[e.SOCKET_SHEET_COMMIT_MUTATION_APPLY_ERROR=40037]="SOCKET_SHEET_COMMIT_MUTATION_APPLY_ERROR",e[e.SOCKET_WEB_VERSION_GREATER_SERVER_VERSION=40038]="SOCKET_WEB_VERSION_GREATER_SERVER_VERSION",e[e.SOCKET_SHEET_ROW_COL_NUMBER_LIIMT=40039]="SOCKET_SHEET_ROW_COL_NUMBER_LIIMT",e[e.SOCKET_DATA_DOCID_ERROR=41001]="SOCKET_DATA_DOCID_ERROR",e[e.SOCKET_DATA_PROTOCOL_TYPE_ERROR=41002]="SOCKET_DATA_PROTOCOL_TYPE_ERROR",e[e.COMMIT_CHANGES_CONTAIN_REVERT=50095]="COMMIT_CHANGES_CONTAIN_REVERT",e[e.SOCKET_SERVER_ERROR=6e4]="SOCKET_SERVER_ERROR",e[e.SOCKET_LAYER_ERROR=60001]="SOCKET_LAYER_ERROR",e[e.SOCKET_CLIENT_NOT_READY_ERROR=60002]="SOCKET_CLIENT_NOT_READY_ERROR",e[e.SOCKET_CLIENT_DATA_ERROR=60003]="SOCKET_CLIENT_DATA_ERROR",e[e.SOCKET_COLLAB_ROOM_TIMEOUT=60004]="SOCKET_COLLAB_ROOM_TIMEOUT",e[e.SOCKET_COLLAB_SERVER_TIMEOUT=60005]="SOCKET_COLLAB_SERVER_TIMEOUT",e[e.SOCKET_USER_AUTH_FAILED=60006]="SOCKET_USER_AUTH_FAILED",e[e.SOCKET_DOC_PRIVILEGE_FAILED=60007]="SOCKET_DOC_PRIVILEGE_FAILED",e[e.SOCKET_PACKAGE_SIZE_TOO_LARGE=60008]="SOCKET_PACKAGE_SIZE_TOO_LARGE",e[e.SOCKET_COLLAB_ROOM_ALREADY_EXIST=60009]="SOCKET_COLLAB_ROOM_ALREADY_EXIST",e[e.SOCKET_COLLAB_ROOM_MEMBER_FULL=60010]="SOCKET_COLLAB_ROOM_MEMBER_FULL",e[e.SOCKET_SERVER_STORAGE_TIMEOUT=60011]="SOCKET_SERVER_STORAGE_TIMEOUT",e[e.SOCKET_SERVER_CGI_TIMEOUT=60013]="SOCKET_SERVER_CGI_TIMEOUT",e[e.SOCKET_FREQUENCY_LIMIT=60014]="SOCKET_FREQUENCY_LIMIT",e[e.SOCKET_USER_DOC_NOPRIVILEGE=60015]="SOCKET_USER_DOC_NOPRIVILEGE",e[e.SOCKET_USER_CHANGE_PARAM_ERROR=60016]="SOCKET_USER_CHANGE_PARAM_ERROR",e[e.SOCKET_COMMAND_NOT_SUPPORTED=60017]="SOCKET_COMMAND_NOT_SUPPORTED",e[e.SOCKET_HACKPAD_TIMEOUT=60018]="SOCKET_HACKPAD_TIMEOUT",e[e.SOCKET_SERVER_WAITTING_TOO_LONG=60019]="SOCKET_SERVER_WAITTING_TOO_LONG",e[e.SOCKET_SERVER_WAITTING_TIMEOUT=60020]="SOCKET_SERVER_WAITTING_TIMEOUT",e[e.SOCKET_AUTH_TIMEOUT=60021]="SOCKET_AUTH_TIMEOUT",e[e.SOCKET_GET_PRIVILEGE_TIMEOUT=60022]="SOCKET_GET_PRIVILEGE_TIMEOUT",e[e.SOCKET_IP_BLACK_LIST=60030]="SOCKET_IP_BLACK_LIST",e[e.SOCKET_USER_BLACK_LIST=60031]="SOCKET_USER_BLACK_LIST",e[e.SOCKET_DOCMENT_BLACK_LIST=60032]="SOCKET_DOCMENT_BLACK_LIST",e[e.SOCKET_USERAGENT_BLACK_LIST=60033]="SOCKET_USERAGENT_BLACK_LIST",e[e.SOCKET_SWITCH_BIG_COLLAB=60034]="SOCKET_SWITCH_BIG_COLLAB",e[e.EXIT_BIG_COLLAB=60035]="EXIT_BIG_COLLAB",e[e.CLIENT_NOT_EXIST=62e3]="CLIENT_NOT_EXIST",e[e.WRITER_IS_EXIST=62001]="WRITER_IS_EXIST",e[e.SOCKET_UNKNOWN_ERROR=-1]="SOCKET_UNKNOWN_ERROR",e[e.SOCKET_COLLABROOM_GET_VIP_FAIL=7e4]="SOCKET_COLLABROOM_GET_VIP_FAIL",e[e.SOCKET_COLLABROOM_NOT_VIP_FULL=70001]="SOCKET_COLLABROOM_NOT_VIP_FULL",e[e.SOCKET_COLLABROOM_DOC_DELETED=70002]="SOCKET_COLLABROOM_DOC_DELETED",e[e.ROOM_WEBSOCKET_DISPOSE_SHUTDOWN=1000001]="ROOM_WEBSOCKET_DISPOSE_SHUTDOWN",e[e.INACTIVE=1000002]="INACTIVE",e[e.CODEREV_NEW=1000003]="CODEREV_NEW",e[e.SOCKET_SEND_MESSAGE_TIMEOUT=1000004]="SOCKET_SEND_MESSAGE_TIMEOUT"}(r||(r={})),t.RoomWebsocketErrorCode=r;var o=[r.SOCKET_COLLAB_ROOM_TIMEOUT,r.SOCKET_COLLAB_SERVER_TIMEOUT,r.SOCKET_SERVER_STORAGE_TIMEOUT,r.SOCKET_SERVER_CGI_TIMEOUT,r.SOCKET_FREQUENCY_LIMIT,r.SOCKET_LAYER_ERROR,r.SOCKET_CLIENT_NOT_READY_ERROR,r.SOCKET_COLLAB_ROOM_MEMBER_FULL];t.NEED_RETRY_ERRCODES=o;var i=[r.SOCKET_SERVER_SUCCESS,r.SOCKET_COLLAB_ROOM_ALREADY_EXIST];t.SERVER_SUCCESS_CODES=i;var a=[r.WRITER_IS_EXIST];t.NOT_NEED_TO_HANDLE_ERRCODES=a;var s=[r.CLIENT_NOT_EXIST,r.SOCKET_USER_AUTH_FAILED,r.SOCKET_DOC_PRIVILEGE_FAILED];t.NEED_RECONNECT_ERRCODES=s},84570:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.RoomHeartBeat=void 0;var r=n(74586),o=n(39055),i=function(){function e(e,t,n){this.heartBeatInterval=15e3,this.messageSender=e,this.channelOption=t,this.roomStatusDependency=n}return e.prototype.dispose=function(){this.clearHeartBeatTimer()},e.prototype.startHeartBeatOnTimer=function(e){var t=this;e&&e!==this.heartBeatInterval&&(this.heartBeatInterval=e),this.heartBeatTimer||(this.heartBeatTimer=setTimeout((function(){t.sendHeartBeat()}),this.heartBeatInterval))},e.prototype.onHeartBeatResponse=function(e,t){var n;this.heartBeatCount=0;var r=(null===(n=null==t?void 0:t.onpost)||void 0===n?void 0:n.heartbeat_interval)||this.heartBeatInterval;this.startHeartBeatOnTimer(r)},e.prototype.resetHeartBeat=function(){this.clearHeartBeatTimer(),this.heartBeatCount=0,this.heartBeatInterval=15e3},e.prototype.clearHeartBeatTimer=function(){this.heartBeatTimer&&(clearTimeout(this.heartBeatTimer),this.heartBeatTimer=0)},e.prototype.sendHeartBeat=function(){var e;this.clearHeartBeatTimer();var t=null===(e=this.roomStatusDependency)||void 0===e?void 0:e.getRoomState();if(t===o.RoomState.OPENED&&this.messageSender){if(this.heartBeatCount>0&&r.ConnectionLog.warn("sendHeartBeat: heart beat count over 1, count = "+this.heartBeatCount),this.heartBeatCount>3)return r.ConnectionLog.warn("sendHeartBeat: max heart beat count reached, the connection will be close."),void this.messageSender.closeAndDelayReopen({reason:"closed by heart beat error.",shutDown:!1},0);this.heartBeatCount+=1;var n=r.JsonUtil.jsonStringify(this.heartBeatHead)+"\n";this.messageSender.postMessageWithWebsocket(n),this.startHeartBeatOnTimer(this.heartBeatInterval)}else r.ConnectionLog.warn("sendHeartBeat: room state error, state = "+t)},Object.defineProperty(e.prototype,"heartBeatHead",{get:function(){var e,t,n={type:"HEART_BEAT",task_id:r.generateMessageTaskId(),docid:this.channelOption.globalPadId,uid:this.channelOption.uid||this.channelOption.userId.replace("p.","").replace("g.","")};return Object.assign(null!==(t=null===(e=this.channelOption.config)||void 0===e?void 0:e.heartBeatAdditionalHead)&&void 0!==t?t:{},n)},enumerable:!1,configurable:!0}),e}();t.RoomHeartBeat=i},47627:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RoomLogin=void 0;var o=n(74586),i=n(70334),a=n(39055),s=n(80177),c=r(n(39472)),l=[s.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_TIMEOUT,s.RoomWebsocketErrorCode.SOCKET_COLLAB_SERVER_TIMEOUT,s.RoomWebsocketErrorCode.SOCKET_SERVER_STORAGE_TIMEOUT,s.RoomWebsocketErrorCode.SOCKET_SERVER_CGI_TIMEOUT,s.RoomWebsocketErrorCode.SOCKET_FREQUENCY_LIMIT,s.RoomWebsocketErrorCode.SOCKET_GET_PRIVILEGE_TIMEOUT],u=[s.RoomWebsocketErrorCode.SOCKET_LAYER_ERROR,s.RoomWebsocketErrorCode.SOCKET_CLIENT_NOT_READY_ERROR],d=function(){function e(e,t,n){this.loginCount=0,this.delayLoginTimer=0,this.loginSeq=0,this.loginTimeout=0,this.loginTime=0,this.messageSender=e,this.channelOption=t,this.roomStatusDependency=n}return e.prototype.dispose=function(){this.resetLogin()},e.prototype.login=function(){this.isConnected()?this.loginInternal():o.ConnectionLog.error("loginRoom: not connected!")},e.prototype.resetLogin=function(){this.loginCount=0,this.loginSeq=0,this.loginTimeout&&(clearTimeout(this.loginTimeout),this.loginTimeout=0),this.delayLoginTimer&&(clearTimeout(this.delayLoginTimer),this.delayLoginTimer=0)},e.prototype.onLoginResponse=function(e,t){if("CLIENT_READY"===e.type){var n={errCode:s.RoomErrorCode.SUCCESS,errMsg:"",response:t};this.handleLoginResponse(e.task_id,e.type,n)}},e.prototype.isConnected=function(){return this.messageSender.isConnected()},e.prototype.loginInternal=function(){var e,t,n,r,a=this;this.loginTimeout&&(clearTimeout(this.loginTimeout),this.loginTimeout=0),this.loginCount+=1,this.loginSeq=o.generateMessageTaskId();var c={roomType:"padpage",roomName:"padpage/"+this.channelOption.globalPadId,upid:null!==(e=this.channelOption.upid)&&void 0!==e?e:"",gid:this.channelOption.globalPadId,sid:this.channelOption.sid,tid:this.channelOption.tid,sig:this.channelOption.sig,data:{stats:this.getStats()}};o.ConnectionLog.info("loginRoom: CLIENT_READY, taskId: "+this.loginSeq);var l=null!==(n=null===(t=this.channelOption.config)||void 0===t?void 0:t.customLoginMsgOptions)&&void 0!==n?n:c;this.loginPostData=this.messageSender.createPostData("CLIENT_READY",this.loginSeq,o.JsonUtil.jsonStringify(l),null===(r=this.channelOption.config)||void 0===r?void 0:r.loginAdditionalHead),this.messageSender.postMessageWithWebsocket(this.loginPostData),this.loginTime=i.RoomUtil.getCurrentTime(),this.loginTimeout=setTimeout((function(){o.ConnectionLog.warn("loginRoom: time out, seq = "+a.loginSeq);var e={errCode:s.RoomErrorCode.TIMEOUT,errMsg:"login room time out."};a.handleLoginResponse(a.loginSeq,"CLIENT_READY",e)}),3e3)},e.prototype.handleLoginResponse=function(e,t,n){this.loginTimeout&&(clearTimeout(this.loginTimeout),this.loginTimeout=0);var r={errCode:0,errMsg:"",event:a.MessageResultEvent.ON_POST,needRetry:!1};if(this.checkLoginResult(n)?(this.roomStatusDependency.notifyRoomOpened(n),r.errCode=n.response.onpost.result):this.handleLoginResponseFail(n,r),0!==r.errCode){r.errMsg=i.RoomUtil.getWebsocketChannelErrorMessage(r.errCode);var o={module:this.channelOption.module,cmd:"CLIENT_READY",attrName:String(n.errCode||n.response.onpost.result),status:1,errorMessage:r.errMsg};c.default.loginRoomError(o)}},e.prototype.checkLoginResult=function(e){var t,n;return 0===e.errCode&&(0===(null===(n=null===(t=e.response)||void 0===t?void 0:t.onpost)||void 0===n?void 0:n.result)||e.response.onpost.result===s.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_ALREADY_EXIST)},e.prototype.handleLoginResponseFail=function(e,t){0!==e.errCode?(o.ConnectionLog.error("handleLoginFailed: client error, code = "+e.errCode+"."),this.loginCount>=3?(o.ConnectionLog.error("handleLoginFailed: login count = "+this.loginCount+"."),this.resetLogin(),this.messageSender.closeAndDelayReopen({reason:i.RoomUtil.getWebsocketChannelErrorMessage(e.errCode),shutDown:!1},0),t.needRetry=!1):(this.delayLogin(1500),t.needRetry=!0),t.errCode=e.errCode,t.event=a.MessageResultEvent.NET_STATUS_CHANGE):this.handleLoginResponseServerFail(e,t)},e.prototype.handleLoginResponseServerFail=function(e,t){var n=e.response.onpost.result;t.errCode=n;var r={errCode:n,reason:i.RoomUtil.getWebsocketChannelErrorMessage(n,"login failed."),shutDown:!1};l.includes(n)?this.handleLoginRetry(e,t):u.includes(n)?this.messageSender.closeAndDelayReopen(r,0):this.shutdownByServerFailure(r,t),o.ConnectionLog.error("handleLoginResponseSvrFail: errCode = "+n)},e.prototype.shutdownByServerFailure=function(e,t){e.shutDown=!0,this.messageSender.shutDown(e),t.needRetry=!1},e.prototype.handleLoginRetry=function(e,t){var n,r,o,a=e.response.onpost.result,c={errCode:a,reason:i.RoomUtil.getWebsocketChannelErrorMessage(a,"login failed."),shutDown:!1};if(this.loginCount>=3)this.resetLogin(),a===s.RoomWebsocketErrorCode.SOCKET_AUTH_TIMEOUT&&this.messageSender.closeAndDelayReopen(c,0),t.needRetry=!1;else{var l=null!==(o=null===(r=null===(n=null==e?void 0:e.response)||void 0===n?void 0:n.onpost)||void 0===r?void 0:r.retry_interval)&&void 0!==o?o:this.delayLoginTime;this.delayLogin(l),t.needRetry=!0}},e.prototype.delayLogin=function(e){var t=this;this.delayLoginTimer=setTimeout((function(){t.login()}),e)},e.prototype.getStats=function(){return{screen:""}},e}();t.RoomLogin=d},82545:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.RoomStatus=void 0;var r=n(47627),o=n(84570),i=n(74586),a=n(39055),s=function(){function e(e,t,n){this.roomState=a.RoomState.INIT,this.channelOption=t,this.connectionControllerDependency=n,this.messageSender=e,this.roomLogin=new r.RoomLogin(e,t,this),this.roomHeartBeat=new o.RoomHeartBeat(e,this.channelOption,this)}return Object.defineProperty(e.prototype,"state",{get:function(){return this.roomState},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this.roomState=a.RoomState.INIT,this.roomHeartBeat.dispose(),this.roomLogin.dispose()},e.prototype.openRoom=function(){this.checkRoomState()&&(this.messageSender.openWebsocketConnection(),this.roomState===a.RoomState.INIT?this.setRoomState(a.RoomState.CONNECTING):this.setRoomState(a.RoomState.RECONNECTING_IN_CLOSED))},e.prototype.onRoomClosed=function(e){e.shutDown?this.handleShutDown(e):this.handleRoomClose(e)},e.prototype.loginRoom=function(){this.roomLogin.login()},e.prototype.resetLogin=function(){this.roomLogin.resetLogin()},e.prototype.onLoginResponse=function(e,t){this.roomLogin.onLoginResponse(e,t)},e.prototype.resetHeartBeat=function(){this.roomHeartBeat.resetHeartBeat()},e.prototype.onHeartBeatResponse=function(e,t){this.roomHeartBeat.onHeartBeatResponse(e,t)},e.prototype.roomStateReconnecting=function(){this.setRoomState(a.RoomState.CONNECTING)},e.prototype.getRoomState=function(){return this.state},e.prototype.notifyRoomOpened=function(e){this.setRoomState(a.RoomState.OPENED),this.resetLogin(),this.roomHeartBeat.resetHeartBeat();var t=e.response;this.roomHeartBeat.startHeartBeatOnTimer(t.onpost.heartbeat_interval),this.messageSender.startMessageSending(),this.messageSender.notifyRoomOpened(),this.connectionControllerDependency.connected()},e.prototype.checkRoomState=function(){return this.state!==a.RoomState.OPENED&&this.state!==a.RoomState.SHUTDOWN||(i.ConnectionLog.warn("checkRoomState:state is "+this.state+"!"),!1)},e.prototype.setRoomState=function(e,t){void 0===t&&(t=""),e!==this.roomState&&(this.roomState=e,i.ConnectionLog.info("setRoomState:set new state = "+e),this.connectionControllerDependency.connectedStateChange(this.roomState,t))},e.prototype.handleShutDown=function(e){var t=this.roomState;this.setRoomState(a.RoomState.SHUTDOWN,e.reason),t!==a.RoomState.SHUTDOWN&&this.connectionControllerDependency.disconnect(e)},e.prototype.handleRoomClose=function(e){var t=this.roomState;this.setRoomState(a.RoomState.RECONNECTING_IN_CLOSED,e.reason),t!==a.RoomState.RECONNECTING_IN_CLOSED&&this.connectionControllerDependency.disconnect(e)},e}();t.RoomStatus=s},70334:function(e,t,n){var r;Object.defineProperty(t,"__esModule",{value:!0}),t.RoomUtil=void 0;var o=n(38506),i=n(80177),a=((r={})[i.RoomWebsocketErrorCode.SOCKET_SERVER_ERROR]="Server internal error, code = "+i.RoomWebsocketErrorCode.SOCKET_SERVER_ERROR,r[i.RoomWebsocketErrorCode.SOCKET_LAYER_ERROR]="Connection not exist, code = "+i.RoomWebsocketErrorCode.SOCKET_LAYER_ERROR,r[i.RoomWebsocketErrorCode.SOCKET_USER_AUTH_FAILED]="TX-LOGIN-PSKEY-EXPIRED , code = "+i.RoomWebsocketErrorCode.SOCKET_USER_AUTH_FAILED,r[i.RoomWebsocketErrorCode.SOCKET_CLIENT_DATA_ERROR]=", code = "+i.RoomWebsocketErrorCode.SOCKET_CLIENT_DATA_ERROR,r[i.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_TIMEOUT]=", code = "+i.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_TIMEOUT,r[i.RoomWebsocketErrorCode.SOCKET_COLLAB_SERVER_TIMEOUT]=", code = "+i.RoomWebsocketErrorCode.SOCKET_COLLAB_SERVER_TIMEOUT,r[i.RoomWebsocketErrorCode.SOCKET_SERVER_STORAGE_TIMEOUT]=", code = "+i.RoomWebsocketErrorCode.SOCKET_SERVER_STORAGE_TIMEOUT,r[i.RoomWebsocketErrorCode.SOCKET_SERVER_CGI_TIMEOUT]="CGI, code = "+i.RoomWebsocketErrorCode.SOCKET_SERVER_CGI_TIMEOUT,r[i.RoomWebsocketErrorCode.SOCKET_DOC_PRIVILEGE_FAILED]=", code = "+i.RoomWebsocketErrorCode.SOCKET_DOC_PRIVILEGE_FAILED,r[i.RoomWebsocketErrorCode.SOCKET_USER_DOC_NOPRIVILEGE]=", code = "+i.RoomWebsocketErrorCode.SOCKET_USER_DOC_NOPRIVILEGE,r[i.RoomWebsocketErrorCode.SOCKET_PACKAGE_SIZE_TOO_LARGE]=", code = "+i.RoomWebsocketErrorCode.SOCKET_PACKAGE_SIZE_TOO_LARGE,r[i.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_MEMBER_FULL]="Member full, code = "+i.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_MEMBER_FULL,r[i.RoomWebsocketErrorCode.SOCKET_COLLABROOM_NOT_VIP_FULL]="Member full, code = "+i.RoomWebsocketErrorCode.SOCKET_COLLABROOM_NOT_VIP_FULL,r[i.RoomWebsocketErrorCode.SOCKET_FREQUENCY_LIMIT]=", code = "+i.RoomWebsocketErrorCode.SOCKET_FREQUENCY_LIMIT,r[i.RoomWebsocketErrorCode.SOCKET_AUTH_TIMEOUT]="TX-LOGIN-PSKEY-EXPIRED , code = "+i.RoomWebsocketErrorCode.SOCKET_AUTH_TIMEOUT,r[i.RoomWebsocketErrorCode.SOCKET_GET_PRIVILEGE_TIMEOUT]=", code = "+i.RoomWebsocketErrorCode.SOCKET_GET_PRIVILEGE_TIMEOUT,r[i.RoomWebsocketErrorCode.SOCKET_DATA_SERVER_UNKNOWN_ERROR]=", code = "+i.RoomWebsocketErrorCode.SOCKET_DATA_SERVER_UNKNOWN_ERROR,r[i.RoomWebsocketErrorCode.SOCKET_DATA_PROTOCOL_FIELD_LACK]=", code = "+i.RoomWebsocketErrorCode.SOCKET_DATA_PROTOCOL_FIELD_LACK,r[i.RoomWebsocketErrorCode.SOCKET_DATA_DOC_NOT_EXIST]=", code = "+i.RoomWebsocketErrorCode.SOCKET_DATA_DOC_NOT_EXIST,r[i.RoomWebsocketErrorCode.SOCKET_DATA_SUBID_ERROR]="subId, code = "+i.RoomWebsocketErrorCode.SOCKET_DATA_SUBID_ERROR,r[i.RoomWebsocketErrorCode.SOCKET_DATA_ACTION_LENGTH]=" action, code = "+i.RoomWebsocketErrorCode.SOCKET_DATA_ACTION_LENGTH,r[i.RoomWebsocketErrorCode.SOCKET_DATA_CHANGESET_EASYSYNC]="changeset easysync , code = "+i.RoomWebsocketErrorCode.SOCKET_DATA_CHANGESET_EASYSYNC,r[i.RoomWebsocketErrorCode.SOCKET_DATA_SAVE_FAIL]=", code = "+i.RoomWebsocketErrorCode.SOCKET_DATA_SAVE_FAIL,r[i.RoomWebsocketErrorCode.SOCKET_DATA_READ_FAIL]=", code = "+i.RoomWebsocketErrorCode.SOCKET_DATA_READ_FAIL,r[i.RoomWebsocketErrorCode.SOCKET_DATA_BASEREV_ERROR]="baseRev, code = "+i.RoomWebsocketErrorCode.SOCKET_DATA_BASEREV_ERROR,r[i.RoomWebsocketErrorCode.SOCKET_DATA_NOT_SUPPORTED_TYPE]=", code = "+i.RoomWebsocketErrorCode.SOCKET_DATA_NOT_SUPPORTED_TYPE,r[i.RoomWebsocketErrorCode.SOCKET_DATA_NOT_SUPPORTED_PROTO]=", code = "+i.RoomWebsocketErrorCode.SOCKET_DATA_NOT_SUPPORTED_PROTO,r[i.RoomWebsocketErrorCode.SOCKET_GRAY_VERSION_INCONFORMITY]=", code = "+i.RoomWebsocketErrorCode.SOCKET_GRAY_VERSION_INCONFORMITY,r[i.RoomWebsocketErrorCode.SOCKET_DOCUMENT_EDIT_COLLAB_LIMIT]=", code = "+i.RoomWebsocketErrorCode.SOCKET_DOCUMENT_EDIT_COLLAB_LIMIT,r[i.RoomWebsocketErrorCode.SOCKET_DATA_CONTENT_LIMIT]=" , code = "+i.RoomWebsocketErrorCode.SOCKET_DATA_CONTENT_LIMIT,r[i.RoomWebsocketErrorCode.SOCKET_DATA_REV_DIFF_UPPER_TEN]="base10, code = "+i.RoomWebsocketErrorCode.SOCKET_DATA_REV_DIFF_UPPER_TEN,r[i.RoomWebsocketErrorCode.SOCKET_DATA_EASYSYNC_TIMEOUT]=", code = "+i.RoomWebsocketErrorCode.SOCKET_DATA_EASYSYNC_TIMEOUT,r[i.RoomWebsocketErrorCode.SOCKET_CLIENT_VERSION_TOO_OLD]="CLIENT_READY , code = "+i.RoomWebsocketErrorCode.SOCKET_CLIENT_VERSION_TOO_OLD,r[i.RoomWebsocketErrorCode.SOCKET_JS_TOO_OLD]="USER_CHANGES , code = "+i.RoomWebsocketErrorCode.SOCKET_JS_TOO_OLD,r[i.RoomWebsocketErrorCode.SOCKET_NOT_CONFILCT_TO_COMMIT]=", code = "+i.RoomWebsocketErrorCode.SOCKET_NOT_CONFILCT_TO_COMMIT,r[i.RoomWebsocketErrorCode.SOCKET_COMMIT_QUEUE_NORMAL_LOCK]=", code = "+i.RoomWebsocketErrorCode.SOCKET_COMMIT_QUEUE_NORMAL_LOCK,r[i.RoomWebsocketErrorCode.SOCKET_COMMIT_QUEUE_OFFLINE_LOCK]=", code = "+i.RoomWebsocketErrorCode.SOCKET_COMMIT_QUEUE_OFFLINE_LOCK,r[i.RoomWebsocketErrorCode.SOCKET_COMMIT_DVER_INCONFORMITY]="dver , code = "+i.RoomWebsocketErrorCode.SOCKET_COMMIT_DVER_INCONFORMITY,r[i.RoomWebsocketErrorCode.SOCKET_SHEET_COMMIT_MIDDLE_SERVER_ERROR]=", code = "+i.RoomWebsocketErrorCode.SOCKET_SHEET_COMMIT_MIDDLE_SERVER_ERROR,r[i.RoomWebsocketErrorCode.SOCKET_SHEET_COMMIT_MUTATION_FORMAT_ERROR]="mutaton, code = "+i.RoomWebsocketErrorCode.SOCKET_SHEET_COMMIT_MUTATION_FORMAT_ERROR,r[i.RoomWebsocketErrorCode.SOCKET_SHEET_COMMIT_MUTATION_APPLY_ERROR]="mutaton apply, code = "+i.RoomWebsocketErrorCode.SOCKET_SHEET_COMMIT_MUTATION_APPLY_ERROR,r[i.RoomWebsocketErrorCode.SOCKET_WEB_VERSION_GREATER_SERVER_VERSION]=", code = "+i.RoomWebsocketErrorCode.SOCKET_WEB_VERSION_GREATER_SERVER_VERSION,r[i.RoomWebsocketErrorCode.SOCKET_SHEET_ROW_COL_NUMBER_LIIMT]=", code = "+i.RoomWebsocketErrorCode.SOCKET_SHEET_ROW_COL_NUMBER_LIIMT,r[i.RoomWebsocketErrorCode.SOCKET_DATA_DOCID_ERROR]="docid, code = "+i.RoomWebsocketErrorCode.SOCKET_DATA_DOCID_ERROR,r[i.RoomWebsocketErrorCode.SOCKET_DATA_PROTOCOL_TYPE_ERROR]=", code = "+i.RoomWebsocketErrorCode.SOCKET_DATA_PROTOCOL_TYPE_ERROR,r[i.RoomWebsocketErrorCode.SOCKET_USER_CHANGE_PARAM_ERROR]="userchange , code = "+i.RoomWebsocketErrorCode.SOCKET_USER_CHANGE_PARAM_ERROR,r[i.RoomWebsocketErrorCode.SOCKET_COMMAND_NOT_SUPPORTED]=", code = "+i.RoomWebsocketErrorCode.SOCKET_COMMAND_NOT_SUPPORTED,r[i.RoomWebsocketErrorCode.SOCKET_HACKPAD_TIMEOUT]="commit errorHackpad, code = "+i.RoomWebsocketErrorCode.SOCKET_HACKPAD_TIMEOUT,r[i.RoomWebsocketErrorCode.SOCKET_SERVER_WAITTING_TOO_LONG]="onpost, code = "+i.RoomWebsocketErrorCode.SOCKET_SERVER_WAITTING_TOO_LONG,r[i.RoomWebsocketErrorCode.SOCKET_SERVER_WAITTING_TIMEOUT]="commit error, code = "+i.RoomWebsocketErrorCode.SOCKET_SERVER_WAITTING_TIMEOUT,r[i.RoomWebsocketErrorCode.SOCKET_DATA_DOCID_ERROR]="docid, code = "+i.RoomWebsocketErrorCode.SOCKET_DATA_DOCID_ERROR,r[i.RoomWebsocketErrorCode.SOCKET_DATA_PROTOCOL_TYPE_ERROR]=", code = "+i.RoomWebsocketErrorCode.SOCKET_DATA_PROTOCOL_TYPE_ERROR,r[i.RoomWebsocketErrorCode.SOCKET_COLLABROOM_GET_VIP_FAIL]=", code = "+i.RoomWebsocketErrorCode.SOCKET_COLLABROOM_GET_VIP_FAIL,r[i.RoomWebsocketErrorCode.SOCKET_COLLABROOM_NOT_VIP_FULL]=", code = "+i.RoomWebsocketErrorCode.SOCKET_COLLABROOM_NOT_VIP_FULL,r[i.RoomWebsocketErrorCode.SOCKET_COLLABROOM_DOC_DELETED]=", code = "+i.RoomWebsocketErrorCode.SOCKET_COLLABROOM_DOC_DELETED,r[i.RoomWebsocketErrorCode.ROOM_WEBSOCKET_DISPOSE_SHUTDOWN]=" dispose , code = "+i.RoomWebsocketErrorCode.ROOM_WEBSOCKET_DISPOSE_SHUTDOWN,r[i.RoomWebsocketErrorCode.INACTIVE]=", code = "+i.RoomWebsocketErrorCode.INACTIVE,r[i.RoomWebsocketErrorCode.CODEREV_NEW]=" dverpver, code = "+i.RoomWebsocketErrorCode.CODEREV_NEW,r[i.RoomWebsocketErrorCode.SOCKET_SEND_MESSAGE_TIMEOUT]="Websocket , code = "+i.RoomWebsocketErrorCode.SOCKET_SEND_MESSAGE_TIMEOUT,r),s=function(){function e(){}return e.getWebsocketChannelErrorMessage=function(e,t){var n;void 0===t&&(t="");var r=null!==(n=a[e])&&void 0!==n?n:"error msg, code = "+e;return t&&(r=t+" "+r),r},e.getCurrentTime=function(){return(new Date).getTime()},e.createNewMessage=function(e,t,n,r,i,a,s,c,l,u){return{taskId:e,postData:t,timeout:n,maxRetryCount:r,cmd:i,data:a,waitAcceptCmd:s,onError:c,onsend:l,onsendAccept:u,retryCount:0,lastSendTime:0,onpostTime:0,firstSendTime:0,state:o.MessageState.WAITING}},e.delay=function(e){return void 0===e&&(e=0),new Promise((function(t){return setTimeout(t,e)}))},e}();t.RoomUtil=s},86264:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},29430:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BuildRoomWebsocketChannel=t.RoomWebsocketChannel=void 0;var s=n(82545),c=n(94013),l=n(70334),u=a(n(39472)),d=n(84572),p=function(){function e(e,t){this.padInfo=e,this.roomDependency=t,this.websocketMessageSender=new c.RoomWebsocketMessageSender(this.padInfo,this.roomDependency,this),this.roomStatus=new s.RoomStatus(this.websocketMessageSender,r({},this.padInfo),this.roomDependency)}return e.prototype.connect=function(){this.websocketMessageSender.openWebsocketConnection()},e.prototype.disconnect=function(e){var t,n,r={module:this.padInfo.module,attrName:String(null!==(t=e.errCode)&&void 0!==t?t:0),status:1,errorMessage:l.RoomUtil.getWebsocketChannelErrorMessage(null!==(n=e.errCode)&&void 0!==n?n:0)};this.websocketMessageSender.shutDown(e),u.default.shutDownReport(r)},e.prototype.dispose=function(){this.websocketMessageSender.dispose(),this.roomStatus.dispose()},e.prototype.sendMessage=function(e){this.websocketMessageSender.sendMessage(e)},e.prototype.batchCommitMessages=function(e){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,{success:!1,retCode:52002,reason:"websocket not support batch commit."}]}))}))},e.prototype.cancelMessageBySeq=function(e){this.websocketMessageSender.cancelMessageBySeq(e)},e.prototype.openRoom=function(){this.roomStatus.openRoom()},e.prototype.onRoomClosed=function(e){this.roomStatus.onRoomClosed(e)},e.prototype.roomStateReconnecting=function(){this.roomStatus.roomStateReconnecting()},e.prototype.getRoomState=function(){return this.roomStatus.getRoomState()},e.prototype.loginRoom=function(){this.roomStatus.loginRoom()},e.prototype.onLoginResponse=function(e,t){this.roomStatus.onLoginResponse(e,t)},e.prototype.resetLogin=function(){this.roomStatus.resetLogin()},e.prototype.onHeartBeatResponse=function(e,t){this.roomStatus.onHeartBeatResponse(e,t)},e.prototype.resetHeartBeat=function(){this.roomStatus.resetHeartBeat()},e}();t.RoomWebsocketChannel=p,t.BuildRoomWebsocketChannel=function(e,t,n){var r,o,i,a,s,c,l={module:e.module,padId:e.serverVars.padId,globalPadId:e.serverVars.globalPadId,codeVer:null!==(r=e.serverVars.pver)&&void 0!==r?r:0,gray:null!==(o=e.serverVars.gray)&&void 0!==o?o:0,dver:e.serverVars.dver,pver:e.serverVars.pver,apId:e.serverVars.apid,wmode:null!==(i=e.serverVars.wmode)&&void 0!==i?i:d.DEFAULT_WMODE,padType:e.serverVars.padType,websocketReopenCount:null!==(a=e.serverVars.websocketReopenCount)&&void 0!==a?a:d.WEBSOCKET_CONFIG.pollingReopenCount,pollingAttemptNumber:null!==(s=e.serverVars.pollingAttemptNumber)&&void 0!==s?s:d.WEBSOCKET_CONFIG.pollingAttemptCount,upid:e.serverVars.client.upid,sid:e.serverVars.client.sid,tid:e.serverVars.client.tid,sig:e.serverVars.client.sig,uid:e.uid,uuId:e.userid,userId:e.userid,nowUserIndex:null!==(c=e.nowUserIndex)&&void 0!==c?c:window.nowUserIndex,middleWareCenter:n,config:e.config};return new p(l,t)}},98375:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.RoomWebsocketMessageQueue=void 0;var r=n(38506),o=n(74586),i=n(80177),a=function(){function e(e){this.messageWaittingQueue=[],this.messageFinishQueue=[],this.messageSenderDependency=e}return e.prototype.dispose=function(){this.messageWaittingQueue=[],this.messageFinishQueue=[]},e.prototype.messageCount=function(){return this.messageWaittingQueue.length},e.prototype.messageAlreadyExist=function(e){var t=this.getMessageByTaskId(e.taskId);return(null==t?void 0:t.cmd)===e.cmd},e.prototype.getMessageByTaskId=function(e){return this.messageWaittingQueue.find((function(t){return t.taskId===e}))},e.prototype.getFinishedMessageByTaskId=function(e){return this.messageFinishQueue.find((function(t){return t.taskId===e}))},e.prototype.readyToSendMessage=function(){if(0===this.messageWaittingQueue.length)return o.ConnectionLog.info("readyToSendMessage: empty messageQueue"),!1;var e=this.messageWaittingQueue.find((function(e){return e.state===r.MessageState.SENDING}));return!e||(o.ConnectionLog.info("readyToSendMessage: message is sending, taskId = "+e.taskId),!1)},e.prototype.addWaittingMessage=function(e){this.messageWaittingQueue.push(e)},e.prototype.addFinishMessage=function(e,t){void 0===t&&(t=-1),this.removeMessageFromQueue(e,t),this.messageFinishQueue.push(e)},e.prototype.removeMessageFromQueue=function(e,t){void 0===t&&(t=-1);var n=t>=0&&t<this.messageWaittingQueue.length?t:this.getIndexOfMessage(e);this.messageWaittingQueue.splice(n,1)},e.prototype.handleMessageQueueByRoomClose=function(e){for(var t=0;t<this.messageWaittingQueue.length;){var n=this.messageWaittingQueue[t];this.handleMessageByRoomClose(n,e),t+=1}},e.prototype.handleMessageByRoomClose=function(e,t){this.messageSenderDependency.doErrorCallback(e,{errCode:t?i.RoomErrorCode.ROOM_SHUTDOWN:i.RoomErrorCode.ROOM_CLOSE,errMsg:"room "+(t?"shutDown":"close")})},e.prototype.handleMsgBySocketDisconnect=function(){for(var e=0;e<this.messageWaittingQueue.length;){var t=this.messageWaittingQueue[e];t.retryCount>=t.maxRetryCount?(this.handleRetryCountLimitedMessageBySocketDisconnect(t),this.removeMessageFromQueue(t,e)):(this.handleMesageBySocketDisconnect(t),e+=1)}},e.prototype.getFirstWaittingMessage=function(){return this.messageWaittingQueue.find((function(e){return e.state===r.MessageState.WAITING}))},e.prototype.processMessageQueue=function(){for(var e=!1,t=!1,n=!1,o=0;o<this.messageWaittingQueue.length;){var i=this.messageWaittingQueue[o];this.sendingMsgIsTimeout(i)?(e=!0,i.retryCount<i.maxRetryCount?(this.retryMessageByTimeout(i),o+=1):this.handleRetryCountLimitedMessageByTimeout(i)):(t=i.state===r.MessageState.SENDING,n=i.state===r.MessageState.WAITING,o+=1)}return this.clearFinishQueueIfNeed(),!t&&n&&(e=!0),e},e.prototype.cancelMessage=function(e){for(var t=0;t<this.messageWaittingQueue.length;){var n=this.messageWaittingQueue[t];if(n.taskId===e)return o.ConnectionLog.info("cancelMessageBySeq: seq = "+e),this.addFinishMessage(n),n;t+=1}},e.prototype.clearFinishQueueIfNeed=function(){this.messageFinishQueue.length>50&&this.messageFinishQueue.splice(0,this.messageFinishQueue.length-50)},e.prototype.sendingMsgIsTimeout=function(e){var t=r.RoomUtil.getCurrentTime();return(e.state===r.MessageState.SENDING||e.state===r.MessageState.WAIT_ACCEPT)&&t>e.lastSendTime&&t-e.lastSendTime>e.timeout},e.prototype.handleRetryCountLimitedMessageBySocketDisconnect=function(e){this.messageIsSendingOrWaitAccept(e)&&this.messageSenderDependency.doErrorCallback(e,{errCode:i.RoomErrorCode.ROOM_DISCONNECT,errMsg:"room disconnect"})},e.prototype.handleMesageBySocketDisconnect=function(e){this.messageIsSendingOrWaitAccept(e)&&(e.state=r.MessageState.WAITING)},e.prototype.messageIsSendingOrWaitAccept=function(e){return e.state===r.MessageState.SENDING||e.state===r.MessageState.WAIT_ACCEPT},e.prototype.handleRetryCountLimitedMessageByTimeout=function(e){o.ConnectionLog.warn("send message timeout, taskId = "+e.taskId+", cmd = "+e.cmd+"."),e.retryCount=0,this.messageSenderDependency.closeAndDelayReopen({reason:"websocket send message timeout.",errCode:r.RoomWebsocketErrorCode.SOCKET_SEND_MESSAGE_TIMEOUT,shutDown:!1},0)},e.prototype.retryMessageByTimeout=function(e){o.ConnectionLog.warn("send message timeout, try again, taskId = "+e.taskId+",\n        cmd = "+e.cmd+", retryCount = "+e.retryCount+", maxRetryCount = "+e.maxRetryCount+", state = "+e.state),e.state=r.MessageState.WAITING},e.prototype.getIndexOfMessage=function(e){return this.messageWaittingQueue.findIndex((function(t){return t.taskId===e.taskId}))},e}();t.RoomWebsocketMessageQueue=a},94013:function(e,t,n){var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RoomWebsocketMessageSender=void 0;var i=n(54221),a=n(74586),s=n(39055),c=n(70334),l=n(80177),u=n(3954),d=o(n(39472)),p=n(50051),h=n(98375),f=n(609),g=function(){function e(e,t,n){var r,o,i=this;this.reconnectTimes=[],this.liteReconnects=0,this.socketDisconnectTimer=0,this.reopenDelayTimer=0,this.websocketDisconneted=!1,this.hasSocketReconnected=!1,this.firstConnect=!0,this.messageSenderTimer=0,this.channelOption=e,this.roomControllerDependency=t,this.roomChannelDependency=n,this.roomMsgQueue=new h.RoomWebsocketMessageQueue(this),this.limitFrequencyManager=new f.LimitFrequencyManager(this.roomControllerDependency),null===(o=null===(r=this.channelOption.config)||void 0===r?void 0:r.messagePriority)||void 0===o||o.forEach((function(e,t){i.limitFrequencyManager.setPriority(t,e)}))}return e.prototype.dispose=function(){var e,t;null===(e=this.roomWebsocket)||void 0===e||e.dispose(),this.roomMsgQueue.dispose(),this.clearSocket(),null===(t=this.limitFrequencyManager)||void 0===t||t.dispose()},e.prototype.openWebsocketConnection=function(){this.isConnected()?a.ConnectionLog.warn("openWebsocketConnection: already exist."):this.roomChannelDependency.getRoomState()!==s.RoomState.SHUTDOWN?this.createWebsocketAndConnect():a.ConnectionLog.error("openWebsocketConnection: room state shut down.")},e.prototype.isConnected=function(){var e,t;return!this.websocketDisconneted&&null!==(t=null===(e=this.roomWebsocket)||void 0===e?void 0:e.isConnected())&&void 0!==t&&t},e.prototype.shutDown=function(e){var t;a.ConnectionLog.error("shutDown, close reason: "+e.reason+", errCode:"+e.errCode),e.reason=null!==(t=e.reason)&&void 0!==t?t:"close by client.",this.clearSocket(),e.shutDown=!0,this.notifyRoomClosed(e,0)},e.prototype.sendMessage=function(e){if(a.isInvalidWaitAcceptCmd(e))a.ConnectionLog.error("sendMessage: waitAcceptCmd params invalid!"),this.doErrorCallback(e,{errCode:l.RoomErrorCode.PARA_ERROR,errMsg:"msg param invalid."});else if(this.roomChannelDependency.getRoomState()!==s.RoomState.OPENED){var t=this.roomChannelDependency.getRoomState();a.ConnectionLog.warn("sendMessage: room state error, state = "+t+"!"),this.needReopen()&&this.reopen(),this.doErrorCallback(e,{errCode:t===s.RoomState.SHUTDOWN?l.RoomErrorCode.ROOM_SHUTDOWN:l.RoomErrorCode.ROOM_STATE_ERR,errMsg:"can not send message in this room state."})}else this.sendMessageInternal(e)},e.prototype.cancelMessageBySeq=function(e){var t=this.roomMsgQueue.cancelMessage(e);(null==t?void 0:t.state)===s.MessageState.SENDING&&this.startMessageSending()},e.prototype.postMessageWithWebsocket=function(e){var t;null===(t=this.roomWebsocket)||void 0===t||t.postMessageForWebSocket(e)},e.prototype.createPostData=function(e,t,n,r){var o,i,s=Number(this.channelOption.userId.startsWith("g")),c=this.channelOption.uid||this.channelOption.userId.replace("p.","").replace("g.",""),l={apid:this.channelOption.apId,type:e,task_id:t,docid:this.channelOption.globalPadId,uid:c,cookie:a.getCookieForMessage(),base_rev:"object"==typeof n&&"number"==typeof n.baseRev?n.baseRev:this.roomControllerDependency.getVersion(),code_ver:this.channelOption.codeVer,session_type:s,gray:this.channelOption.gray,dver:this.channelOption.dver,wl:a.Cookie.get("wl"),u:this.channelOption.nowUserIndex,generalpacket:this.roomControllerDependency.getHeaderGeneralPacket(),docs_type:this.channelOption.padType};(null===(o=this.channelOption.config)||void 0===o?void 0:o.connectMode)===u.ConnectMode.WEBSOCKET_FORCED&&(l.model="websocket"),l=Object.assign(null!=r?r:{},l);var d=a.JsonUtil.jsonStringify(l)+"\n";return d+=null!==(i=p.prepareCommitMessage(n,this.channelOption.uuId,this.channelOption.pver))&&void 0!==i?i:""},e.prototype.startMessageSending=function(){this.roomMsgQueue.messageCount()>0&&this.trySendPendingMessage()},e.prototype.notifyRoomOpened=function(){this.firstConnect=!1,this.limitFrequencyManager.reset()},e.prototype.closeAndDelayReopen=function(e,t){var n;e.reason=null!==(n=e.reason)&&void 0!==n?n:"close by client.",a.ConnectionLog.info("closeAndDelayReopen: close reason = "+e.reason+", delay time = "+t),this.clearSocket(),e.shutDown=!1,this.notifyRoomClosed(e,t)},e.prototype.onSocketStatusChanged=function(e){e.event?("open"!==e.event&&this.roomChannelDependency.getRoomState()!==s.RoomState.SHUTDOWN&&this.roomChannelDependency.roomStateReconnecting(),this.handleSocketStatusChangeEvent(e)):a.ConnectionLog.warn("onSocketStatusChanged: channel info error.")},e.prototype.onGetMessageFromServer=function(e){var t=e.split("\r\n");t instanceof Array?this.parseGetMsgDataList(t):a.ConnectionLog.error("onGetMessageFromServer: message data error.")},e.prototype.onPostFromServer=function(e){var t=e.split("\n"),n=r(t.map((function(e){return a.JsonUtil.parseJson(e)})),2),o=n[0],i=n[1];o&&i?"HEART_BEAT"!==o.type?"CLIENT_READY"!==o.type?this.parsePostCommonMessageFromServer(o,i):this.roomChannelDependency.onLoginResponse(o,i):this.roomChannelDependency.onHeartBeatResponse(o,i):a.ConnectionLog.error("onPostFromServer: message data parsed error.")},e.prototype.onSocketOpen=function(){this.liteReconnects=0,this.reconnectTimes=[],this.websocketDisconneted=!1,this.hasSocketReconnected=!1,a.ConnectionLog.info("onSocketOpenEvent"),this.clearDisconnectTimer(),this.clearReopenDelayTimer(),this.roomChannelDependency.resetHeartBeat(),this.roomChannelDependency.resetLogin(),this.roomChannelDependency.loginRoom()},e.prototype.onSocketClosed=function(e){a.ConnectionLog.info("onSocketClosedEvent: socket closed!"),this.roomWebsocket=null,this.notifyRoomClosed({reason:e,shutDown:!1},0),this.hasSocketReconnected&&this.roomControllerDependency.networkReconnectedFail()},e.prototype.onReopenCount=function(){return this.liteReconnects},e.prototype.doErrorCallback=function(e,t){e.onError(e.taskId,e.cmd,e.data,t)},e.prototype.reportMessage=function(e,t){var n={cmd:e.cmd,attrName:String(t.errCode),status:1,module:this.channelOption.module,errorMessage:t.errMsg,waitAcceptCmd:t.waitAcceptCmd};d.default.commitError(n)},e.prototype.sendMessageInternal=function(e){var t,n,r,o,i,s;if(this.roomMsgQueue.messageAlreadyExist(e))this.doErrorCallback(e,{errCode:l.RoomErrorCode.EXIST,errMsg:"msg already exist."});else{var u,d=e.taskId||a.generateMessageTaskId(),h=this.createPostData(e.cmd,d,e.data,e.additionalFieldsToHead);(null===(t=e.customParam)||void 0===t?void 0:t.waitAcceptCmd)&&(u=null===(n=e.customParam)||void 0===n?void 0:n.waitAcceptCmd);var f=c.RoomUtil.createNewMessage(d,h,null!==(o=null===(r=e.customParam)||void 0===r?void 0:r.timeout)&&void 0!==o?o:p.DEFAULT_SEND_MESSAGE_TIMEOUT,null!==(s=null===(i=e.customParam)||void 0===i?void 0:i.maxRetryCount)&&void 0!==s?s:p.DEFAULT_RETRY_COUNTS,e.cmd,e.data,u,e.onError,e.onsend,e.onsendAccept);this.roomMsgQueue.addWaittingMessage(f),this.startMessageSending(),this.startMessageTimer()}},e.prototype.handleSocketStatusChangeEvent=function(e){var t;a.ConnectionLog.info("handleSocketStatusChangeEvent: "+e.event+" reason: "+(null!==(t=e.disconnectReason)&&void 0!==t?t:e.failReason)),"reconnecting"===e.event?this.hasSocketReconnected=!0:"disconnect"===e.event&&this.handleDisconnectEvent(e)},e.prototype.createWebsocketAndConnect=function(){if(this.roomWebsocket)a.ConnectionLog.warn("createWebsocketAndConnect:socket has exist");else{var e={padId:this.channelOption.padId,roomWebSocketDependency:this,tag:this.channelOption.padId,gid:this.channelOption.globalPadId,upid:this.channelOption.upid||"",sig:this.channelOption.sig,uid:this.channelOption.uid,uidKey:a.Cookie.get("uid_key"),wmode:this.channelOption.wmode,websocketReopenCount:this.channelOption.websocketReopenCount,pollingAttemptNumber:this.channelOption.pollingAttemptNumber,nowUserIndex:this.channelOption.nowUserIndex,module:this.channelOption.module,config:this.channelOption.config};this.roomWebsocket=new i.RoomWebsocket(e),this.roomWebsocket.connect(),this.setupSocketTime=c.RoomUtil.getCurrentTime()}},e.prototype.clearSocket=function(){this.roomWebsocket&&(this.roomWebsocket.disconnect(""),this.clearDisconnectTimer()),this.roomWebsocket=null},e.prototype.reopen=function(){a.ConnectionLog.info("reopen: socket reopen."),this.clearSocket(),this.roomChannelDependency.resetHeartBeat(),this.roomChannelDependency.resetLogin(),this.openWebsocketConnection()},e.prototype.needReopen=function(){var e=this.roomChannelDependency.getRoomState();if(e===s.RoomState.CONNECTING||e===s.RoomState.RECONNECTING_IN_CLOSED){var t=c.RoomUtil.getCurrentTime();if(this.setupSocketTime&&t>this.setupSocketTime&&t-this.setupSocketTime>5e4)return!0}return!1},e.prototype.notifyRoomClosed=function(e,t){a.ConnectionLog.info("notifyRoomClosed: reason = "+e.reason+", shutdown = "+e.shutDown),this.clearDisconnectTimer(),this.websocketDisconneted=!0,this.roomChannelDependency.resetHeartBeat(),this.roomChannelDependency.resetLogin(),this.firstConnect=!1,this.roomChannelDependency.onRoomClosed(e),this.roomMsgQueue.handleMessageQueueByRoomClose(e.shutDown),e.shutDown?this.reset():this.delayReopen(t)},e.prototype.delayReopen=function(e){var t=this;if(!this.reopenDelayTimer){this.reconnectTimes.push(c.RoomUtil.getCurrentTime()),this.liteReconnects+=1;var n=e;e||(n=Math.min(3e4,1e3*Math.pow(2,this.liteReconnects+1)),n=this.generateFuzzyInterval(n,.4*n)),this.reopenDelayTimer=setTimeout((function(){t.clearReopenDelayTimer(),t.roomChannelDependency.openRoom()}),n)}},e.prototype.generateFuzzyInterval=function(e,t){return e+Math.floor(Math.random()*(2*t+1)-t)},e.prototype.reset=function(){this.roomWebsocket=null,this.liteReconnects=0,this.reconnectTimes=[],this.clearDisconnectTimer(),this.clearReopenDelayTimer(),this.roomChannelDependency.resetLogin(),this.roomChannelDependency.resetHeartBeat()},e.prototype.parsePostCommonMessageFromServer=function(e,t){var n=this.roomMsgQueue.getMessageByTaskId(e.task_id);n&&n.cmd===e.type?(this.handleCommonMessage(n,t),this.finishParseMessage(n,t)):this.roomMsgQueue.getFinishedMessageByTaskId(e.task_id)||a.ConnectionLog.warn("parsePostCommonMessageFromServer: msg not found! seq = "+e.task_id+", cmd = "+e.type),this.startMessageSending(),this.roomMsgQueue.clearFinishQueueIfNeed()},e.prototype.finishParseMessage=function(e,t){var n,r=t.onpost.result;(null===(n=e.waitAcceptCmd)||void 0===n?void 0:n.length)&&0===r?e.state=s.MessageState.WAIT_ACCEPT:this.roomMsgQueue.addFinishMessage(e),this.startMessageSending()},e.prototype.handleCommonMessage=function(e,t){e.onpostTime=c.RoomUtil.getCurrentTime();var n=t.onpost.result,r=t.onpost.retry_interval;if(n!==l.RoomWebsocketErrorCode.SOCKET_SERVER_SUCCESS&&a.ConnectionLog.error("handleCommonMessage: server response error, code = "+n),this.reportMsgParseErrorIfNeed(n,e,t),n!==l.RoomWebsocketErrorCode.SOCKET_SERVER_ERROR&&n!==l.RoomWebsocketErrorCode.SOCKET_USER_AUTH_FAILED)if(n!==l.RoomWebsocketErrorCode.SOCKET_LAYER_ERROR){var o={errCode:n,errMsg:"",response:t};n===l.RoomWebsocketErrorCode.SOCKET_SERVER_SUCCESS?this.doMsgOnSendSuccessCallback(e,o):this.doErrorCallback(e,o)}else this.closeAndDelayReopen({errCode:n,reason:c.RoomUtil.getWebsocketChannelErrorMessage(n),shutDown:!1},r);else this.shutDown({errCode:n,reason:c.RoomUtil.getWebsocketChannelErrorMessage(n),shutDown:!0})},e.prototype.reportMsgParseErrorIfNeed=function(e,t,n){if(e!==l.RoomWebsocketErrorCode.SOCKET_SERVER_SUCCESS){var r={errCode:e,errMsg:c.RoomUtil.getWebsocketChannelErrorMessage(e),event:s.MessageResultEvent.ON_POST,response:n,needRetry:!1};this.reportMessage(t,r)}},e.prototype.trySendPendingMessage=function(){this.needReopen()?this.reopen():this.readyToSendMessage()&&this.sendWaitingMessage()},e.prototype.sendWaitingMessage=function(){var e=this.roomMsgQueue.getFirstWaittingMessage();e&&(this.postOneMessage(e),this.startMessageTimer())},e.prototype.postOneMessage=function(e){this.preparePostMessage(e),this.postMessageWithWebsocket(e.postData)},e.prototype.preparePostMessage=function(e){0!==e.retryCount&&e.firstSendTime||(e.firstSendTime=c.RoomUtil.getCurrentTime()),e.retryCount+=1,e.lastSendTime=c.RoomUtil.getCurrentTime(),e.onpostTime=0,e.state=s.MessageState.SENDING},e.prototype.startMessageTimer=function(){var e=this;this.messageSenderTimer||(this.messageSenderTimer=setTimeout((function(){e.handleMessageTimer()}),1e3))},e.prototype.handleMessageTimer=function(){this.messageSenderTimer&&(clearTimeout(this.messageSenderTimer),this.messageSenderTimer=0);var e=this.roomMsgQueue.processMessageQueue();this.roomMsgQueue.messageCount()>0&&(e&&this.startMessageSending(),this.startMessageTimer())},e.prototype.readyToSendMessage=function(){return this.roomChannelDependency.getRoomState()===s.RoomState.OPENED&&this.isConnected()?this.roomMsgQueue.readyToSendMessage():(a.ConnectionLog.warn("readyToSendMessage: roomstate = "+this.roomChannelDependency.getRoomState()+", websocket connected = "+this.isConnected()),!1)},e.prototype.handleInactiveQuit=function(){var e={attrName:String(l.RoomWebsocketErrorCode.INACTIVE),status:1,module:this.channelOption.module,errorMessage:c.RoomUtil.getWebsocketChannelErrorMessage(l.RoomWebsocketErrorCode.INACTIVE)};this.shutDown({reason:"close by server, INACTIVE.",errCode:l.RoomWebsocketErrorCode.INACTIVE,shutDown:!0}),d.default.shutDownReport(e)},e.prototype.receiveMessageFromServer=function(e,t){var n,r={head:e,body:t,newRev:e.new_rev,ts:e.ts,socketId:(null===(n=this.roomWebsocket)||void 0===n?void 0:n.socketId)||"",needDeal:!0};this.limitFrequencyManager.handleMessage(r),r.needDeal&&this.roomControllerDependency.receiveMessageFromServer(e.type,[r])},e.prototype.handleWaitAcceptMessage=function(e,t){var n=this.roomMsgQueue.getMessageByTaskId(e.task_id);n?this.processWaitAcceptMessage(n,e,t)?this.roomMsgQueue.addFinishMessage(n):a.ConnectionLog.error("processWaitAcceptMessage: msg found but waitcmd not match. seq = "+n.taskId+", cmd = "+n.cmd+", wait cmd = "+e.type):(n=this.roomMsgQueue.getFinishedMessageByTaskId(e.task_id))||this.receiveMessageFromServer(e,t)},e.prototype.hasWaitAcceptCommand=function(e,t){var n;return!!(null===(n=e.waitAcceptCmd)||void 0===n?void 0:n.includes(t))},e.prototype.processWaitAcceptMessage=function(e,t,n){var r,o,i,a;if(this.hasWaitAcceptCommand(e,t.type)){this.doMsgOnSendAcceptSuccessCallback(e,t,n);var l={errCode:null!==(o=null===(r=n.data)||void 0===r?void 0:r.reason)&&void 0!==o?o:0,errMsg:c.RoomUtil.getWebsocketChannelErrorMessage(null!==(a=null===(i=n.data)||void 0===i?void 0:i.reason)&&void 0!==a?a:0),waitAcceptCmd:t.type,event:s.MessageResultEvent.ON_SEND_ACCEPT,response:n,needRetry:!1};return this.reportMessage(e,l),!0}return!1},e.prototype.parseGetMsgDataList=function(e){for(var t=0;t<e.length;t++){var n=e[t].split("\n");if(n.length<2)return void a.ConnectionLog.error("onGetMessageFromServer: message data error.");this.parseGetMsgList(n)}},e.prototype.parseGetMsgList=function(e){var t=r(e.map((function(e){return a.JsonUtil.parseJson(e)})),2),n=t[0],o=t[1];this.isInactiveQuitMsg(n,o)?this.handleInactiveQuit():0!==this.roomMsgQueue.messageCount()?this.handleWaitAcceptMessage(n,o):this.processFinishedGetMsg(n,o)},e.prototype.isInactiveQuitMsg=function(e,t){return"QUIT_NOTICE"===(null==e?void 0:e.type)&&"INACTIVE"===(null==t?void 0:t.notice.quit_type)},e.prototype.processFinishedGetMsg=function(e,t){this.roomMsgQueue.getFinishedMessageByTaskId(e.task_id)||this.receiveMessageFromServer(e,t)},e.prototype.handleDisconnectEvent=function(e){var t=this;e.event&&(this.websocketDisconneted=!0,this.socketDisconnectTimer||(this.roomChannelDependency.resetLogin(),this.roomChannelDependency.resetHeartBeat(),this.roomMsgQueue.handleMsgBySocketDisconnect(),this.socketDisconnectTimer=setTimeout((function(){var n,r;e.socketId||e.socketId!==(null===(n=t.roomWebsocket)||void 0===n?void 0:n.socketId)||t.disConnect(null!==(r=e.disconnectReason)&&void 0!==r?r:"")}),25e3)))},e.prototype.clearDisconnectTimer=function(){this.socketDisconnectTimer&&(clearTimeout(this.socketDisconnectTimer),this.socketDisconnectTimer=0)},e.prototype.clearReopenDelayTimer=function(){this.reopenDelayTimer&&(clearTimeout(this.reopenDelayTimer),this.reopenDelayTimer=0)},e.prototype.disConnect=function(e){a.ConnectionLog.info("disConnect, reason:"+e),this.roomChannelDependency.getRoomState()!==s.RoomState.SHUTDOWN&&(this.clearSocket(),this.notifyRoomClosed({reason:"close by disconnect, reason "+e,shutDown:!1},0))},e.prototype.doMsgOnSendAcceptSuccessCallback=function(e,t,n){var r,o,i,a,s;null===(r=e.onsendAccept)||void 0===r||r.call(e,e.taskId,e.cmd,e.data,t.type,{errCode:null!==(i=null===(o=null==n?void 0:n.data)||void 0===o?void 0:o.reason)&&void 0!==i?i:0,errMsg:null!==(s=null===(a=null==n?void 0:n.data)||void 0===a?void 0:a.msg)&&void 0!==s?s:"",response:{body:n,new_rev:t.new_rev}})},e.prototype.doMsgOnSendSuccessCallback=function(e,t){var n;null===(n=e.onsend)||void 0===n||n.call(e,e.taskId,e.cmd,e.data,t)},e}();t.RoomWebsocketMessageSender=g},86494:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},35661:function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.RoomWebsocketEvent=void 0,function(e){e.open="open",e.close="close",e.connect="connect",e.connectFail="connectfail",e.reconnecting="reconnecting",e.disconnect="disconnect",e.connectTimeout="connect_timeout",e.connectError="connect_error"}(n||(n={})),t.RoomWebsocketEvent=n},54221:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RoomWebsocket=void 0;var o=n(73557),i=n(84572),a=r(n(96993)),s=n(74586),c=r(n(39472)),l=function(){function e(e){var t=this;this.option=e,this.socketId=String(Math.floor(1e12*Math.random())),this.isWebSocketOpen=!1,this.socketChannel=null,this.socketAttempts=0,this.handleReconnectAttempt=function(){t.socketChannel.io.opts.transports=t.attemptTransports},this.handleConnectError=function(e){var n,r,i;if(s.ConnectionLog.info("socket io connect_error, isOnline:"+o.network.isOnline+", type:"+(null==e?void 0:e.type)+", code:"+(null==e?void 0:e.code)+",\n      message:"+(null==e?void 0:e.message)+", description:"+(null==e?void 0:e.description)),o.network.isOnline){var a="number"==typeof(null==e?void 0:e.description)?null==e?void 0:e.description:void 0;c.default.reportSocketConnect({attrName:"SocketConnect",status:1,module:null===(n=t.option)||void 0===n?void 0:n.module,errorMessage:(null==e?void 0:e.message)+", status:"+a,transports:null===(i=null===(r=t.socketChannel)||void 0===r?void 0:r.io.opts.transports)||void 0===i?void 0:i[0]})}var l=t.getSocketChannelInfo();l.event="connect_error",l.failReason="io connect_error unknown",(null==e?void 0:e.type)&&(l.failReason=e.type),t.option.roomWebSocketDependency.onSocketStatusChanged(l)},this.handleConnectTimeout=function(e){var n=t.getSocketChannelInfo();n.event="connect_timeout",n.failReason="connect_timeout timeout:"+e,t.option.roomWebSocketDependency.onSocketStatusChanged(n)},this.handleGet=function(e){t.option.roomWebSocketDependency.onGetMessageFromServer(e)},this.handlePost=function(e){t.option.roomWebSocketDependency.onPostFromServer(e)},this.handleConnect=function(){var e,n,r,o,i;s.ConnectionLog.info("socket io connect readyState: "+(null===(e=t.socketChannel)||void 0===e?void 0:e.io.readyState)+", id:"+(null===(n=t.socketChannel)||void 0===n?void 0:n.id)),c.default.reportSocketConnect({module:null===(r=t.option)||void 0===r?void 0:r.module,attrName:"SocketConnect",status:0,errorMessage:"Success",transports:null===(i=null===(o=t.socketChannel)||void 0===o?void 0:o.io.opts.transports)||void 0===i?void 0:i[0]}),t.isWebSocketOpen=!0,t.option.roomWebSocketDependency.onSocketOpen()},this.handleReconnect=function(e){s.ConnectionLog.info("socket io reconnect number: "+e+" channel.readyState: "+t.socketChannel.io.readyState),t.socketAttempts=0},this.handleReconnecting=function(e){t.socketAttempts=e,t.socketChannel.io.opts.transports=t.initTransports,t.option.roomWebSocketDependency.onReopenCount()>=t.option.websocketReopenCount&&e>=t.option.pollingAttemptNumber&&(t.socketChannel.io.opts.transports=t.attemptTransports),s.ConnectionLog.info("socket io reconnecting number:"+e+" readyState: "+t.socketChannel.io.readyState+", transports:"+t.socketChannel.io.opts.transports);var n=t.getSocketChannelInfo();n.event="reconnecting",t.option.roomWebSocketDependency.onSocketStatusChanged(n)},this.handleRetry=function(e){s.ConnectionLog.info("socket io retry, msg:"+e),t.doDisconnect("Server restarted or socket timed out on server. serverRetry offlineEdit")},this.handleDisconnect=function(e){var n;s.ConnectionLog.info("socket io disconnect, msg: "+s.JsonUtil.jsonStringify(e)+" channel.readyState: "+(null===(n=t.socketChannel)||void 0===n?void 0:n.io.readyState));var r=s.JsonUtil.jsonStringify(e)+"ClosedByOthers.",o=t.getSocketChannelInfo();o.event="disconnect",o.disconnectReason=""+r,o.socketId=t.socketId,t.option.roomWebSocketDependency.onSocketStatusChanged(o),t.socketAttempts=0},this.handleConnectFailed=function(e){s.ConnectionLog.info("socket io connect_failed"),t.socketAttempts=0,t.doDisconnect(s.JsonUtil.jsonStringify(e)+"  connect_failed Closed by client.")},this.handleError=function(e){s.ConnectionLog.info("socket io error, type:"+(null==e?void 0:e.type)+", code:"+(null==e?void 0:e.code)+",\n     message:"+(null==e?void 0:e.message)+", description:",null==e?void 0:e.description),t.doDisconnect(s.JsonUtil.jsonStringify(e)+" socket io error Closed by client.")},this.handleReconnectFailed=function(e){s.ConnectionLog.info("socket io reconnect_failed"),t.socketAttempts=0,t.doDisconnect(s.JsonUtil.jsonStringify(e)+" reconnect_failed Closed by client.")},this.initTransports=this.getTransports(e.wmode),this.attemptTransports=this.getAttemptTransports(e.wmode)}return e.prototype.dispose=function(){this.disconnect("socket io dispose")},e.prototype.isConnected=function(){return this.isWebSocketOpen},e.prototype.connect=function(){var e,t,n,r,o,c,l="wss://"+(null!==(n=null===(t=null===(e=this.option.config)||void 0===e?void 0:e.location)||void 0===t?void 0:t.host)&&void 0!==n?n:window.location.host),u=a.default(l,{query:{tag:this.option.tag,gtag:this.option.gid,utag:this.option.upid,sig:this.option.sig,uid:this.option.uid,uid_key:this.option.uidKey,u:this.option.nowUserIndex,padid:this.option.padId},transports:this.initTransports,reconnection:!0,reconnectionAttempts:i.WEBSOCKET_CONFIG.reconnectMaxTimes,reconnectionDelay:i.WEBSOCKET_CONFIG.reconnectionDelay,reconnectionDelayMax:i.WEBSOCKET_CONFIG.reconnectionDelayMax,randomizationFactor:i.WEBSOCKET_CONFIG.randomizationFactor,timeout:i.WEBSOCKET_CONFIG.connectTimeout,path:null!==(c=null===(o=null===(r=this.option.config)||void 0===r?void 0:r.location)||void 0===o?void 0:o.path)&&void 0!==c?c:"/websocket"});this.socketChannel=u,s.ConnectionLog.info("socket io new channel transports: "+u.io.opts.transports+", pollingReopenCount =\n      "+this.option.websocketReopenCount+", pollingAttemptNumber= "+this.option.pollingAttemptNumber),u.on("reconnect_attempt",this.handleReconnectAttempt),u.on("connect_error",this.handleConnectError),u.on("connect_timeout",this.handleConnectTimeout),u.on("get",this.handleGet),u.on("post",this.handlePost),u.on("connect",this.handleConnect),u.on("reconnect",this.handleReconnect),u.on("reconnecting",this.handleReconnecting),u.on("retry",this.handleRetry),u.on("disconnect",this.handleDisconnect),u.on("connect_failed",this.handleConnectFailed),u.on("error",this.handleError),u.on("reconnect_failed",this.handleReconnectFailed)},e.prototype.postMessageForWebSocket=function(e){this.socketChannel&&this.socketChannel.emit("post",e)},e.prototype.getSocketConnectCount=function(){return this.socketAttempts},e.prototype.getSocketChannelInfo=function(){var e={};return this.socketChannel&&(e.connected=this.socketChannel.connected,e.disconnected=this.socketChannel.disconnected,this.socketChannel.io&&(e.readyState=this.socketChannel.io.readyState,e.reconnecting=this.socketChannel.io.reconnecting)),e},e.prototype.disconnect=function(e){s.ConnectionLog.info("socket io disconnect reason: "+e),this.socketChannel&&(this.socketChannel.disconnect(),this.socketChannel=null),this.isWebSocketOpen=!1},e.prototype.getTransports=function(e){return i.TRANSPOET_MODE_MAP.get(e.charAt(0))||i.DEFAULT_TRANSPORT_MODE},e.prototype.getAttemptTransports=function(e){return i.TRANSPOET_MODE_MAP.get(e.charAt(1))||i.DEFAULT_ATTEMPT_TRANSPORT_MODE},e.prototype.doDisconnect=function(e){this.disconnect("socket io doDisconnect reason: "+e),this.option.roomWebSocketDependency.onSocketClosed(e)},e}();t.RoomWebsocket=l},6711:function(e,t,n){var r,o,i=((r=n(5593))&&r.__esModule?r:{default:r}).default.getInstance().getConfig('npm["@tencent/docs-design-resources"]');t.Z=(o=(null==i?void 0:i.CDN_ORIGIN)||"https://docs.gtimg.com/docs-design-resources",{"application-pdf":(o+="/document-management/miniprogram/share-placeholder/")+"application-pdf@3x.png","application-vnd.ms-excel":o+"application-vnd.ms-excel@3x.png","application-vnd.ms-powerpoint":o+"application-vnd.ms-powerpoint@3x.png","application-vnd.ms-word":o+"application-vnd.ms-word@3x.png","application-vnd.tdocs-apps-addon":o+"application-vnd.tdocs-apps-addon@3x.png","application-vnd.tdocs-apps.default":o+"application-vnd.tdocs-apps.default@3x.png","application-vnd.tdocs-apps.doc":o+"application-vnd.tdocs-apps.doc@3x.png","application-vnd.tdocs-apps.flowchart":o+"application-vnd.tdocs-apps.flowchart@3x.png","application-vnd.tdocs-apps.form":o+"application-vnd.tdocs-apps.form@3x.png","application-vnd.tdocs-apps.mind":o+"application-vnd.tdocs-apps.mind@3x.png","application-vnd.tdocs-apps.rec":o+"application-vnd.tdocs-apps.rec@3x.png","application-vnd.tdocs-apps.sheet":o+"application-vnd.tdocs-apps.sheet@3x.png","application-vnd.tdocs-apps.slide":o+"application-vnd.tdocs-apps.slide@3x.png","application-vnd.tdocs-apps.smartcanvas":o+"application-vnd.tdocs-apps.smartcanvas@3x.png","application-vnd.tdocs-apps.smartsheet":o+"application-vnd.tdocs-apps.smartsheet@3x.png",audio:o+"audio@3x.png",image:o+"image@3x.png",video:o+"video@3x.png"})},49215:function(e,t,n){var r,o,i=((r=n(5593))&&r.__esModule?r:{default:r}).default.getInstance().getConfig('npm["@tencent/docs-design-resources"]');t.Z=(o=(null==i?void 0:i.CDN_ORIGIN)||"https://docs.gtimg.com/docs-design-resources",{"application-pdf":(o+="/document-management/miniprogram/structured-cover/")+"application-pdf@3x.png","application-vnd.ms-excel":o+"application-vnd.ms-excel@3x.png","application-vnd.ms-powerpoint":o+"application-vnd.ms-powerpoint@3x.png","application-vnd.ms-word":o+"application-vnd.ms-word@3x.png","application-vnd.tdocs-addon-image.236b7f64e91e40b584f2aae0517ee1ed":o+"application-vnd.tdocs-addon-image.236b7f64e91e40b584f2aae0517ee1ed@3x.png","application-vnd.tdocs-addon-image.84e7b8f3a6b542b380cd984b94b1752c":o+"application-vnd.tdocs-addon-image.84e7b8f3a6b542b380cd984b94b1752c@3x.png","application-vnd.tdocs-addon-image.9e2c26161b684629a9bf29e52efa6c60":o+"application-vnd.tdocs-addon-image.9e2c26161b684629a9bf29e52efa6c60@3x.png","application-vnd.tdocs-addon-image.e3e96c1968114db986a9229003965853":o+"application-vnd.tdocs-addon-image.e3e96c1968114db986a9229003965853@3x.png","application-vnd.tdocs-addon-image.f87386fee10348178ee65f8eedc4b2f3":o+"application-vnd.tdocs-addon-image.f87386fee10348178ee65f8eedc4b2f3@3x.png","application-vnd.tdocs-apps.collaboration-space":o+"application-vnd.tdocs-apps.collaboration-space@3x.png","application-vnd.tdocs-apps.default":o+"application-vnd.tdocs-apps.default@3x.png","application-vnd.tdocs-apps.doc":o+"application-vnd.tdocs-apps.doc@3x.png","application-vnd.tdocs-apps.flowchart":o+"application-vnd.tdocs-apps.flowchart@3x.png","application-vnd.tdocs-apps.folder":o+"application-vnd.tdocs-apps.folder@3x.png","application-vnd.tdocs-apps.form":o+"application-vnd.tdocs-apps.form@3x.png","application-vnd.tdocs-apps.mind":o+"application-vnd.tdocs-apps.mind@3x.png","application-vnd.tdocs-apps.rec":o+"application-vnd.tdocs-apps.rec@3x.png","application-vnd.tdocs-apps.sheet":o+"application-vnd.tdocs-apps.sheet@3x.png","application-vnd.tdocs-apps.slide":o+"application-vnd.tdocs-apps.slide@3x.png","application-vnd.tdocs-apps.smartcanvas":o+"application-vnd.tdocs-apps.smartcanvas@3x.png","application-vnd.tdocs-apps.smartsheet":o+"application-vnd.tdocs-apps.smartsheet@3x.png",audio:o+"audio@3x.png",code:o+"code@3x.png",image:o+"image@3x.png",text:o+"text@3x.png",video:o+"video@3x.png"})},42432:function(e,t,n){var r,o,i=((r=n(5593))&&r.__esModule?r:{default:r}).default.getInstance().getConfig('npm["@tencent/docs-design-resources"]');t.Z=(o=(null==i?void 0:i.CDN_ORIGIN)||"https://docs.gtimg.com/docs-design-resources",{"application-pdf":(o+="/document-management/miniprogram/structured-message/")+"application-pdf@3x.png","application-vnd.ms-excel":o+"application-vnd.ms-excel@3x.png","application-vnd.ms-powerpoint":o+"application-vnd.ms-powerpoint@3x.png","application-vnd.ms-word":o+"application-vnd.ms-word@3x.png","application-vnd.tdocs-addon-image.236b7f64e91e40b584f2aae0517ee1ed":o+"application-vnd.tdocs-addon-image.236b7f64e91e40b584f2aae0517ee1ed@3x.png","application-vnd.tdocs-addon-image.84e7b8f3a6b542b380cd984b94b1752c":o+"application-vnd.tdocs-addon-image.84e7b8f3a6b542b380cd984b94b1752c@3x.png","application-vnd.tdocs-addon-image.9e2c26161b684629a9bf29e52efa6c60":o+"application-vnd.tdocs-addon-image.9e2c26161b684629a9bf29e52efa6c60@3x.png","application-vnd.tdocs-addon-image.e3e96c1968114db986a9229003965853":o+"application-vnd.tdocs-addon-image.e3e96c1968114db986a9229003965853@3x.png","application-vnd.tdocs-addon-image.f87386fee10348178ee65f8eedc4b2f3":o+"application-vnd.tdocs-addon-image.f87386fee10348178ee65f8eedc4b2f3@3x.png","application-vnd.tdocs-apps.collaboration-space":o+"application-vnd.tdocs-apps.collaboration-space@3x.png","application-vnd.tdocs-apps.default":o+"application-vnd.tdocs-apps.default@3x.png","application-vnd.tdocs-apps.doc":o+"application-vnd.tdocs-apps.doc@3x.png","application-vnd.tdocs-apps.flowchart":o+"application-vnd.tdocs-apps.flowchart@3x.png","application-vnd.tdocs-apps.folder":o+"application-vnd.tdocs-apps.folder@3x.png","application-vnd.tdocs-apps.form":o+"application-vnd.tdocs-apps.form@3x.png","application-vnd.tdocs-apps.mind":o+"application-vnd.tdocs-apps.mind@3x.png","application-vnd.tdocs-apps.rec":o+"application-vnd.tdocs-apps.rec@3x.png","application-vnd.tdocs-apps.sheet":o+"application-vnd.tdocs-apps.sheet@3x.png","application-vnd.tdocs-apps.slide":o+"application-vnd.tdocs-apps.slide@3x.png","application-vnd.tdocs-apps.smartcanvas":o+"application-vnd.tdocs-apps.smartcanvas@3x.png","application-vnd.tdocs-apps.smartsheet":o+"application-vnd.tdocs-apps.smartsheet@3x.png",audio:o+"audio@3x.png",code:o+"code@3x.png",image:o+"image@3x.png",text:o+"text@3x.png",video:o+"video@3x.png"})},84029:function(e,t,n){var r,o,i=((r=n(5593))&&r.__esModule?r:{default:r}).default.getInstance().getConfig('npm["@tencent/docs-design-resources"]');t.Z=(o=(null==i?void 0:i.CDN_ORIGIN)||"https://docs.gtimg.com/docs-design-resources",{"application-json":(o+="/document-management/tencent-docs/favicon/")+"application-json.png","application-pdf":o+"application-pdf.png","application-vnd.ms-excel":o+"application-vnd.ms-excel.png","application-vnd.ms-powerpoint":o+"application-vnd.ms-powerpoint.png","application-vnd.ms-word":o+"application-vnd.ms-word.png","application-vnd.tdocs-addon-image.84e7b8f3a6b542b380cd984b94b1752c":o+"application-vnd.tdocs-addon-image.84e7b8f3a6b542b380cd984b94b1752c.png","application-vnd.tdocs-addon-image.f87386fee10348178ee65f8eedc4b2f3":o+"application-vnd.tdocs-addon-image.f87386fee10348178ee65f8eedc4b2f3.png","application-vnd.tdocs-apps.collaboration-space":o+"application-vnd.tdocs-apps.collaboration-space.png","application-vnd.tdocs-apps.default":o+"application-vnd.tdocs-apps.default.png","application-vnd.tdocs-apps.doc":o+"application-vnd.tdocs-apps.doc.png","application-vnd.tdocs-apps.flowchart":o+"application-vnd.tdocs-apps.flowchart.png","application-vnd.tdocs-apps.folder":o+"application-vnd.tdocs-apps.folder.png","application-vnd.tdocs-apps.form":o+"application-vnd.tdocs-apps.form.png","application-vnd.tdocs-apps.mind":o+"application-vnd.tdocs-apps.mind.png","application-vnd.tdocs-apps.rec":o+"application-vnd.tdocs-apps.rec.png","application-vnd.tdocs-apps.share-folder":o+"application-vnd.tdocs-apps.share-folder.png","application-vnd.tdocs-apps.shared-folder":o+"application-vnd.tdocs-apps.shared-folder.png","application-vnd.tdocs-apps.sheet":o+"application-vnd.tdocs-apps.sheet.png","application-vnd.tdocs-apps.slide":o+"application-vnd.tdocs-apps.slide.png","application-vnd.tdocs-apps.smartcanvas":o+"application-vnd.tdocs-apps.smartcanvas.png","application-vnd.tdocs-apps.smartsheet":o+"application-vnd.tdocs-apps.smartsheet.png","application-zip":o+"application-zip.png",audio:o+"audio.png",code:o+"code.png","drive-excel":o+"drive-excel.png","drive-powerpoint":o+"drive-powerpoint.png","drive-word":o+"drive-word.png",image:o+"image.png",text:o+"text.png",video:o+"video.png"})},6175:function(e,t,n){var r,o,i=((r=n(5593))&&r.__esModule?r:{default:r}).default.getInstance().getConfig('npm["@tencent/docs-design-resources"]');t.Z=(o=(null==i?void 0:i.CDN_ORIGIN)||"https://docs.gtimg.com/docs-design-resources",{"application-json":(o+="/document-management/tencent-docs/png-200px/")+"application-json.png","application-pdf":o+"application-pdf.png","application-vnd.ms-excel":o+"application-vnd.ms-excel.png","application-vnd.ms-powerpoint":o+"application-vnd.ms-powerpoint.png","application-vnd.ms-word":o+"application-vnd.ms-word.png","application-vnd.tdocs-addon-image.236b7f64e91e40b584f2aae0517ee1ed":o+"application-vnd.tdocs-addon-image.236b7f64e91e40b584f2aae0517ee1ed.png","application-vnd.tdocs-addon-image.84e7b8f3a6b542b380cd984b94b1752c":o+"application-vnd.tdocs-addon-image.84e7b8f3a6b542b380cd984b94b1752c.png","application-vnd.tdocs-addon-image.9e2c26161b684629a9bf29e52efa6c60":o+"application-vnd.tdocs-addon-image.9e2c26161b684629a9bf29e52efa6c60.png","application-vnd.tdocs-addon-image.e3e96c1968114db986a9229003965853":o+"application-vnd.tdocs-addon-image.e3e96c1968114db986a9229003965853.png","application-vnd.tdocs-addon-image.f87386fee10348178ee65f8eedc4b2f3":o+"application-vnd.tdocs-addon-image.f87386fee10348178ee65f8eedc4b2f3.png","application-vnd.tdocs-apps.collaboration-space":o+"application-vnd.tdocs-apps.collaboration-space.png","application-vnd.tdocs-apps.cooperation-space":o+"application-vnd.tdocs-apps.cooperation-space.png","application-vnd.tdocs-apps.default":o+"application-vnd.tdocs-apps.default.png","application-vnd.tdocs-apps.doc":o+"application-vnd.tdocs-apps.doc.png","application-vnd.tdocs-apps.flowchart":o+"application-vnd.tdocs-apps.flowchart.png","application-vnd.tdocs-apps.folder":o+"application-vnd.tdocs-apps.folder.png","application-vnd.tdocs-apps.form":o+"application-vnd.tdocs-apps.form.png","application-vnd.tdocs-apps.mind":o+"application-vnd.tdocs-apps.mind.png","application-vnd.tdocs-apps.rec":o+"application-vnd.tdocs-apps.rec.png","application-vnd.tdocs-apps.share-folder":o+"application-vnd.tdocs-apps.share-folder.png","application-vnd.tdocs-apps.shared-folder":o+"application-vnd.tdocs-apps.shared-folder.png","application-vnd.tdocs-apps.sheet":o+"application-vnd.tdocs-apps.sheet.png","application-vnd.tdocs-apps.slide":o+"application-vnd.tdocs-apps.slide.png","application-vnd.tdocs-apps.smartcanvas":o+"application-vnd.tdocs-apps.smartcanvas.png","application-vnd.tdocs-apps.smartsheet":o+"application-vnd.tdocs-apps.smartsheet.png","application-zip":o+"application-zip.png",audio:o+"audio.png",code:o+"code.png","drive-excel":o+"drive-excel.png","drive-powerpoint":o+"drive-powerpoint.png","drive-word":o+"drive-word.png",image:o+"image.png",text:o+"text.png",video:o+"video.png"})},97020:function(e,t,n){var r,o,i=((r=n(5593))&&r.__esModule?r:{default:r}).default.getInstance().getConfig('npm["@tencent/docs-design-resources"]');t.Z=(o=(null==i?void 0:i.CDN_ORIGIN)||"https://docs.gtimg.com/docs-design-resources",{"application-json":(o+="/document-management/tencent-docs/svg/")+"application-json.svg","application-pdf":o+"application-pdf.svg","application-vnd.ms-excel":o+"application-vnd.ms-excel.svg","application-vnd.ms-powerpoint":o+"application-vnd.ms-powerpoint.svg","application-vnd.ms-word":o+"application-vnd.ms-word.svg","application-vnd.tdocs-addon-image.236b7f64e91e40b584f2aae0517ee1ed":o+"application-vnd.tdocs-addon-image.236b7f64e91e40b584f2aae0517ee1ed.svg","application-vnd.tdocs-addon-image.84e7b8f3a6b542b380cd984b94b1752c":o+"application-vnd.tdocs-addon-image.84e7b8f3a6b542b380cd984b94b1752c.svg","application-vnd.tdocs-addon-image.9e2c26161b684629a9bf29e52efa6c60":o+"application-vnd.tdocs-addon-image.9e2c26161b684629a9bf29e52efa6c60.svg","application-vnd.tdocs-addon-image.e3e96c1968114db986a9229003965853":o+"application-vnd.tdocs-addon-image.e3e96c1968114db986a9229003965853.svg","application-vnd.tdocs-addon-image.f87386fee10348178ee65f8eedc4b2f3":o+"application-vnd.tdocs-addon-image.f87386fee10348178ee65f8eedc4b2f3.svg","application-vnd.tdocs-apps.collaboration-space":o+"application-vnd.tdocs-apps.collaboration-space.svg","application-vnd.tdocs-apps.cooperation-space":o+"application-vnd.tdocs-apps.cooperation-space.svg","application-vnd.tdocs-apps.default":o+"application-vnd.tdocs-apps.default.svg","application-vnd.tdocs-apps.doc":o+"application-vnd.tdocs-apps.doc.svg","application-vnd.tdocs-apps.flowchart":o+"application-vnd.tdocs-apps.flowchart.svg","application-vnd.tdocs-apps.folder":o+"application-vnd.tdocs-apps.folder.svg","application-vnd.tdocs-apps.form":o+"application-vnd.tdocs-apps.form.svg","application-vnd.tdocs-apps.mind":o+"application-vnd.tdocs-apps.mind.svg","application-vnd.tdocs-apps.rec":o+"application-vnd.tdocs-apps.rec.svg","application-vnd.tdocs-apps.share-folder":o+"application-vnd.tdocs-apps.share-folder.svg","application-vnd.tdocs-apps.shared-folder":o+"application-vnd.tdocs-apps.shared-folder.svg","application-vnd.tdocs-apps.sheet":o+"application-vnd.tdocs-apps.sheet.svg","application-vnd.tdocs-apps.slide":o+"application-vnd.tdocs-apps.slide.svg","application-vnd.tdocs-apps.smartcanvas":o+"application-vnd.tdocs-apps.smartcanvas.svg","application-vnd.tdocs-apps.smartsheet":o+"application-vnd.tdocs-apps.smartsheet.svg","application-zip":o+"application-zip.svg",audio:o+"audio.svg",code:o+"code.svg","drive-excel":o+"drive-excel.svg","drive-powerpoint":o+"drive-powerpoint.svg","drive-word":o+"drive-word.svg","icon-test-app":o+"icon-test-app.svg",icon_quick:o+"icon_quick.svg",image:o+"image.svg",text:o+"text.svg",video:o+"video.svg"})},35831:function(e,t,n){var r;window,e.exports=(r=n(5593),function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=56)}([function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){var r=n(15)("wks"),o=n(16),i=n(0).Symbol,a="function"==typeof i;(e.exports=function(e){return r[e]||(r[e]=a&&i[e]||(a?i:o)("Symbol."+e))}).store=r},function(e,t,n){var r=n(4);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t){var n=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=n)},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){var r=n(6);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var r=n(10),o=n(1)("toStringTag"),i="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),o))?n:i?r(t):"Object"==(a=r(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t,n){e.exports=!n(13)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(0),o=n(11),i=n(19),a=n(16)("src"),s=n(29),c=(""+s).split("toString");n(3).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var l="function"==typeof n;l&&(i(n,"name")||o(n,"name",t)),e[t]!==n&&(l&&(i(n,a)||o(n,a,e[t]?""+e[t]:c.join(String(t)))),e===r?e[t]=n:s?e[t]?e[t]=n:o(e,t,n):(delete e[t],o(e,t,n)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[a]||s.call(this)}))},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var r=n(12),o=n(28);e.exports=n(8)?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(2),o=n(26),i=n(27),a=Object.defineProperty;t.f=n(8)?Object.defineProperty:function(e,t,n){if(r(e),t=i(t,!0),r(n),o)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){e.exports=!1},function(e,t,n){var r=n(3),o=n(0),i=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(14)?"pure":"global",copyright:" 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t,n){var r=n(0),o=n(3),i=n(11),a=n(9),s=n(5),c=function(e,t,n){var l,u,d,p,h=e&c.F,f=e&c.G,g=e&c.S,v=e&c.P,y=e&c.B,m=f?r:g?r[t]||(r[t]={}):(r[t]||{}).prototype,b=f?o:o[t]||(o[t]={}),_=b.prototype||(b.prototype={});for(l in f&&(n=t),n)d=((u=!h&&m&&void 0!==m[l])?m:n)[l],p=y&&u?s(d,r):v&&"function"==typeof d?s(Function.call,d):d,m&&a(m,l,d,e&c.U),b[l]!=d&&i(b,l,p),v&&_[l]!=d&&(_[l]=d)};r.core=o,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,t,n){var r=n(4),o=n(0).document,i=r(o)&&r(o.createElement);e.exports=function(e){return i?o.createElement(e):{}}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t){e.exports={}},function(e,t,n){var r,o,i,a=n(5),s=n(38),c=n(39),l=n(18),u=n(0),d=u.process,p=u.setImmediate,h=u.clearImmediate,f=u.MessageChannel,g=u.Dispatch,v=0,y={},m=function(){var e=+this;if(y.hasOwnProperty(e)){var t=y[e];delete y[e],t()}},b=function(e){m.call(e.data)};p&&h||(p=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return y[++v]=function(){s("function"==typeof e?e:Function(e),t)},r(v),v},h=function(e){delete y[e]},"process"==n(10)(d)?r=function(e){d.nextTick(a(m,e,1))}:g&&g.now?r=function(e){g.now(a(m,e,1))}:f?(i=(o=new f).port2,o.port1.onmessage=b,r=a(i.postMessage,i,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(r=function(e){u.postMessage(e+"","*")},u.addEventListener("message",b,!1)):r="onreadystatechange"in l("script")?function(e){c.appendChild(l("script")).onreadystatechange=function(){c.removeChild(this),m.call(e)}}:function(e){setTimeout(a(m,e,1),0)}),e.exports={set:p,clear:h}},function(e,t,n){var r=n(6);function o(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)}e.exports.f=function(e){return new o(e)}},function(e,t,n){var r,o,i=n(54),a=RegExp.prototype.exec,s=String.prototype.replace,c=a,l=(r=/a/,o=/b*/g,a.call(r,"a"),a.call(o,"a"),0!==r.lastIndex||0!==o.lastIndex),u=void 0!==/()??/.exec("")[1];(l||u)&&(c=function(e){var t,n,r,o,c=this;return u&&(n=new RegExp("^"+c.source+"$(?!\\s)",i.call(c))),l&&(t=c.lastIndex),r=a.call(c,e),l&&r&&(c.lastIndex=c.global?r.index+r[0].length:t),u&&r&&r.length>1&&s.call(r[0],n,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(r[o]=void 0)})),r}),e.exports=c},function(e,t){e.exports=r},function(e,t,n){var r,o,i,a,s=n(14),c=n(0),l=n(5),u=n(7),d=n(17),p=n(4),h=n(6),f=n(30),g=n(31),v=n(37),y=n(21).set,m=n(40)(),b=n(22),_=n(41),C=n(42),S=n(43),w=c.TypeError,E=c.process,x=E&&E.versions,T=x&&x.v8||"",R=c.Promise,I="process"==u(E),P=function(){},O=o=b.f,k=!!function(){try{var e=R.resolve(1),t=(e.constructor={})[n(1)("species")]=function(e){e(P,P)};return(I||"function"==typeof PromiseRejectionEvent)&&e.then(P)instanceof t&&0!==T.indexOf("6.6")&&-1===C.indexOf("Chrome/66")}catch(e){}}(),D=function(e){var t;return!(!p(e)||"function"!=typeof(t=e.then))&&t},M=function(e,t){if(!e._n){e._n=!0;var n=e._c;m((function(){for(var r=e._v,o=1==e._s,i=0,a=function(t){var n,i,a,s=o?t.ok:t.fail,c=t.resolve,l=t.reject,u=t.domain;try{s?(o||(2==e._h&&N(e),e._h=1),!0===s?n=r:(u&&u.enter(),n=s(r),u&&(u.exit(),a=!0)),n===t.promise?l(w("Promise-chain cycle")):(i=D(n))?i.call(n,c,l):c(n)):l(r)}catch(e){u&&!a&&u.exit(),l(e)}};n.length>i;)a(n[i++]);e._c=[],e._n=!1,t&&!e._h&&A(e)}))}},A=function(e){y.call(c,(function(){var t,n,r,o=e._v,i=L(e);if(i&&(t=_((function(){I?E.emit("unhandledRejection",o,e):(n=c.onunhandledrejection)?n({promise:e,reason:o}):(r=c.console)&&r.error&&r.error("Unhandled promise rejection",o)})),e._h=I||L(e)?2:1),e._a=void 0,i&&t.e)throw t.v}))},L=function(e){return 1!==e._h&&0===(e._a||e._c).length},N=function(e){y.call(c,(function(){var t;I?E.emit("rejectionHandled",e):(t=c.onrejectionhandled)&&t({promise:e,reason:e._v})}))},B=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),M(t,!0))},F=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw w("Promise can't be resolved itself");(t=D(e))?m((function(){var r={_w:n,_d:!1};try{t.call(e,l(F,r,1),l(B,r,1))}catch(e){B.call(r,e)}})):(n._v=e,n._s=1,M(n,!1))}catch(e){B.call({_w:n,_d:!1},e)}}};k||(R=function(e){f(this,R,"Promise","_h"),h(e),r.call(this);try{e(l(F,this,1),l(B,this,1))}catch(e){B.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(44)(R.prototype,{then:function(e,t){var n=O(v(this,R));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=I?E.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&M(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new r;this.promise=e,this.resolve=l(F,e,1),this.reject=l(B,e,1)},b.f=O=function(e){return e===R||e===a?new i(e):o(e)}),d(d.G+d.W+d.F*!k,{Promise:R}),n(45)(R,"Promise"),n(46)("Promise"),a=n(3).Promise,d(d.S+d.F*!k,"Promise",{reject:function(e){var t=O(this);return(0,t.reject)(e),t.promise}}),d(d.S+d.F*(s||!k),"Promise",{resolve:function(e){return S(s&&this===a?R:this,e)}}),d(d.S+d.F*!(k&&n(47)((function(e){R.all(e).catch(P)}))),"Promise",{all:function(e){var t=this,n=O(t),r=n.resolve,o=n.reject,i=_((function(){var n=[],i=0,a=1;g(e,!1,(function(e){var s=i++,c=!1;n.push(void 0),a++,t.resolve(e).then((function(e){c||(c=!0,n[s]=e,--a||r(n))}),o)})),--a||r(n)}));return i.e&&o(i.v),n.promise},race:function(e){var t=this,n=O(t),r=n.reject,o=_((function(){g(e,!1,(function(e){t.resolve(e).then(n.resolve,r)}))}));return o.e&&r(o.v),n.promise}})},function(e,t,n){e.exports=!n(8)&&!n(13)((function(){return 7!=Object.defineProperty(n(18)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(4);e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){e.exports=n(15)("native-function-to-string",Function.toString)},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(5),o=n(32),i=n(33),a=n(2),s=n(34),c=n(36),l={},u={};(t=e.exports=function(e,t,n,d,p){var h,f,g,v,y=p?function(){return e}:c(e),m=r(n,d,t?2:1),b=0;if("function"!=typeof y)throw TypeError(e+" is not iterable!");if(i(y)){for(h=s(e.length);h>b;b++)if((v=t?m(a(f=e[b])[0],f[1]):m(e[b]))===l||v===u)return v}else for(g=y.call(e);!(f=g.next()).done;)if((v=o(g,m,f.value,t))===l||v===u)return v}).BREAK=l,t.RETURN=u},function(e,t,n){var r=n(2);e.exports=function(e,t,n,o){try{return o?t(r(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&r(i.call(e)),t}}},function(e,t,n){var r=n(20),o=n(1)("iterator"),i=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||i[o]===e)}},function(e,t,n){var r=n(35),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(7),o=n(1)("iterator"),i=n(20);e.exports=n(3).getIteratorMethod=function(e){if(null!=e)return e[o]||e["@@iterator"]||i[r(e)]}},function(e,t,n){var r=n(2),o=n(6),i=n(1)("species");e.exports=function(e,t){var n,a=r(e).constructor;return void 0===a||null==(n=r(a)[i])?t:o(n)}},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(0).document;e.exports=r&&r.documentElement},function(e,t,n){var r=n(0),o=n(21).set,i=r.MutationObserver||r.WebKitMutationObserver,a=r.process,s=r.Promise,c="process"==n(10)(a);e.exports=function(){var e,t,n,l=function(){var r,o;for(c&&(r=a.domain)&&r.exit();e;){o=e.fn,e=e.next;try{o()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(c)n=function(){a.nextTick(l)};else if(!i||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var u=s.resolve(void 0);n=function(){u.then(l)}}else n=function(){o.call(r,l)};else{var d=!0,p=document.createTextNode("");new i(l).observe(p,{characterData:!0}),n=function(){p.data=d=!d}}return function(r){var o={fn:r,next:void 0};t&&(t.next=o),e||(e=o,n()),t=o}}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){var r=n(0).navigator;e.exports=r&&r.userAgent||""},function(e,t,n){var r=n(2),o=n(4),i=n(22);e.exports=function(e,t){if(r(e),o(t)&&t.constructor===e)return t;var n=i.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){var r=n(9);e.exports=function(e,t,n){for(var o in t)r(e,o,t[o],n);return e}},function(e,t,n){var r=n(12).f,o=n(19),i=n(1)("toStringTag");e.exports=function(e,t,n){e&&!o(e=n?e:e.prototype,i)&&r(e,i,{configurable:!0,value:t})}},function(e,t,n){var r=n(0),o=n(12),i=n(8),a=n(1)("species");e.exports=function(e){var t=r[e];i&&t&&!t[a]&&o.f(t,a,{configurable:!0,get:function(){return this}})}},function(e,t,n){var r=n(1)("iterator"),o=!1;try{var i=[7][r]();i.return=function(){o=!0},Array.from(i,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!o)return!1;var n=!1;try{var i=[7],a=i[r]();a.next=function(){return{done:n=!0}},i[r]=function(){return a},e(i)}catch(e){}return n}},function(e,t,n){var r=n(7),o={};o[n(1)("toStringTag")]="z",o+""!="[object z]"&&n(9)(Object.prototype,"toString",(function(){return"[object "+r(this)+"]"}),!0)},function(e,t,n){var r=n(2),o=n(50),i=n(51);n(52)("search",1,(function(e,t,n,a){return[function(n){var r=e(this),o=null==n?void 0:n[t];return void 0!==o?o.call(n,r):new RegExp(n)[t](String(r))},function(e){var t=a(n,e,this);if(t.done)return t.value;var s=r(e),c=String(this),l=s.lastIndex;o(l,0)||(s.lastIndex=0);var u=i(s,c);return o(s.lastIndex,l)||(s.lastIndex=l),null===u?-1:u.index}]}))},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},function(e,t,n){var r=n(7),o=RegExp.prototype.exec;e.exports=function(e,t){var n=e.exec;if("function"==typeof n){var i=n.call(e,t);if("object"!=typeof i)throw new TypeError("RegExp exec method returned something other than an Object or null");return i}if("RegExp"!==r(e))throw new TypeError("RegExp#exec called on incompatible receiver");return o.call(e,t)}},function(e,t,n){n(53);var r=n(9),o=n(11),i=n(13),a=n(55),s=n(1),c=n(23),l=s("species"),u=!i((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),d=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();e.exports=function(e,t,n){var p=s(e),h=!i((function(){var t={};return t[p]=function(){return 7},7!=""[e](t)})),f=h?!i((function(){var t=!1,n=/a/;return n.exec=function(){return t=!0,null},"split"===e&&(n.constructor={},n.constructor[l]=function(){return n}),n[p](""),!t})):void 0;if(!h||!f||"replace"===e&&!u||"split"===e&&!d){var g=/./[p],v=n(a,p,""[e],(function(e,t,n,r,o){return t.exec===c?h&&!o?{done:!0,value:g.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}})),y=v[0],m=v[1];r(String.prototype,e,y),o(RegExp.prototype,p,2==t?function(e,t){return m.call(e,this,t)}:function(e){return m.call(e,this)})}}},function(e,t,n){var r=n(23);n(17)({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},function(e,t,n){var r=n(2);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){n.r(t),n(25),n(48),n(49);var r=n(24),o=n.n(r).a.getInstance().getConfig('npm["@tencent/docs-miniapp-sdk"]'),i=(null==o?void 0:o.TOC_ORIGIN)||"https://docs.qq.com",a={invokeJSBridge:function(e,t){var n,r=null!==(n=window.top)&&void 0!==n?n:window;if(/miniprogram|miniapp(?!enable)/i.test(r.navigator.userAgent)||"undefined"!=typeof __wxjs_environment&&"miniprogram"===__wxjs_environment){var o=function(){try{r.WeixinJSBridge.invoke("invokeMiniProgramAPI",{name:e,arg:t})}catch(e){console.warn("miniApp sdk WeixinJSBridge invocation failed",e)}};if(r.WeixinJSBridge)return o();console.warn("miniApp sdk WeixinJSBridge is not ready, waiting");var i=function e(){o(),r.document.removeEventListener("WeixinJSBridgeReady",e,!1),r.document.removeEventListener("QQJSBridgeReady",e,!1)};r.document.addEventListener("WeixinJSBridgeReady",i,!1),r.document.addEventListener("QQJSBridgeReady",i,!1)}else console.warn("miniApp sdk not in MiniProgram environment, ignoring")},navigateTo:function(e){a.invokeJSBridge("navigateTo",e)},navigateBack:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a.invokeJSBridge("navigateBack",e)},switchTab:function(e){a.invokeJSBridge("switchTab",e)},reLaunch:function(e){a.invokeJSBridge("reLaunch",e)},redirectTo:function(e){a.invokeJSBridge("redirectTo",e)},postMessage:function(e){a.invokeJSBridge("postMessage",e)},reLaunchToListPage:function(){a.reLaunch({url:"/pages/list/list"})},navigateToEditPage:function(e){a.navigateTo({url:"/pages/detail/detail?url=".concat(encodeURIComponent(e))})},navigateToWebView:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a.navigateTo({url:"/pages/webview/webview?url=".concat(encodeURIComponent(e),"&shareable=").concat(t||"")})},reLogin:function(e){e?a.reLaunch({url:"/pages/detail/detail?reason=pskey_error&url=".concat(encodeURIComponent(e))}):a.reLaunch({url:"/pages/list/list?reason=pskey_error"})},invoke:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(null!==(t=/[?&]applet_id=([^&#]+)/.exec(location.search))&&void 0!==t?t:[])[1];if(!r)throw Error("miniApp sdk invoke miniApi fail: no applet_id in url param");return new Promise((function(t){var o=new XMLHttpRequest;o.open("POST","".concat(i,"/sdc/getappletdata"),!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.responseType="json",o.onload=function(){return t(o.response)},o.send("cmd=".concat(encodeURIComponent(e),"&param=").concat(encodeURIComponent(JSON.stringify(n)||"{}"),"&appletid=").concat(r))})).then((function(e){var t=JSON.parse(e.result.data);if(!t.success)throw Error("miniApp sdk invoke miniApi fail: Error: ".concat(t.errMsg||"unknown error"));return t.data}),(function(e){throw Error("miniApp sdk invoke miniApi fail: Error: ".concat(e.message||"unknown error"))}))}};t.default=a}]))},33390:function(e,t,n){var r,o;window,e.exports=(r=n(96716),o=n(5593),function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t){e.exports=r},function(e,t,n){var r,o,i;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),function(e){e.DOC_SID="DOC_SID",e.SID="SID",e.UID="uid",e.UID_KEY="uid_key",e.USER_TYPE="utype"}(r||(r={})),function(e){e.P_LONG_UIN="p_luin",e.P_LONG_SKEY="p_lskey",e.P_UIN="p_uin",e.P_SKEY="p_skey"}(o||(o={})),function(e){e.UID="tdoc_uid",e.SKEY="wedoc_skey"}(i||(i={}))},function(e,t,n){n.d(t,"b",(function(){return a}));var r=n(4),o=n.n(r),i=null===o.a||void 0===o.a?void 0:o.a.getInstance(),a=null==i?void 0:i.getConfig('npm["@tencent/docs-scenario-components"]');t.a=i},,function(e,t){e.exports=o},function(e,t,n){n.r(t),n.d(t,"getUid",(function(){return s})),n.d(t,"getNowUserId",(function(){return c})),n.d(t,"isLogin",(function(){return l})),n.d(t,"getSid",(function(){return u})),n.d(t,"loginType",(function(){return d})),n.d(t,"checkWeWork",(function(){return p}));var r=n(2),o=n(0),i=n(1);function a(){return location.hostname===(null===r.b||void 0===r.b?void 0:r.b.WECOM_DOMAIN)||"doc.weixin.qq.com"}function s(){var e,t,n;return(null===(e=window.global_multi_user)||void 0===e?void 0:e.uid)||(null===(n=null===(t=window.clientVars)||void 0===t?void 0:t.userInfo)||void 0===n?void 0:n.uid)||Object(o.getCookie)("tdoc_uid")||Object(o.getCookie)("uid")||(a()?Object(o.getCookie)(i.a.UID):"")}function c(){return window.nowUserIndex||s()}function l(){return!!(Object(o.getCookie)(i.c.UID)&&Object(o.getCookie)(i.c.UID_KEY)||Object(o.getCookie)(i.c.DOC_SID)||Object(o.getCookie)(i.c.SID)||Object(o.getCookie)(i.b.P_UIN)&&Object(o.getCookie)(i.b.P_SKEY)||Object(o.getCookie)(i.b.P_LONG_UIN)&&Object(o.getCookie)(i.b.P_LONG_SKEY))||!(!a()||!Object(o.getCookie)(i.a.SKEY))}function u(){var e,t;return null!==(t=null!==(e=Object(o.getCookie)(i.c.DOC_SID))&&void 0!==e?e:Object(o.getCookie)(i.c.SID))&&void 0!==t?t:""}function d(){var e,t=Object(o.getCookie)(i.c.USER_TYPE);return(null===(e=window.global_multi_user)||void 0===e?void 0:e.utype)||t}function p(){return"ww"===d()}}]))},90049:function(e,t,n){n.d(t,{a:function(){return M},c:function(){return R}});var r,o=n(67975),i=n(87363),a=n.n(i),s=n(32230),c=n.n(s),l={position:"relative",boxSizing:"border-box",flex:"none"},u={backgroundSize:"cover",height:"100%",width:"100%"},d={position:"absolute",left:"0",bottom:"0",width:"50%",height:"50%",backgroundSize:"cover",backgroundImage:"url('https://docs.gtimg.com/docs-design-resources/document-management/tencent-docs/svg/icon_quick.svg')"},p={position:"absolute",left:0,right:0,top:0,bottom:0,margin:"auto",width:"50%",height:"50%",backgroundSize:"cover",backgroundImage:"url('')"};!function(e){e[e.Small=16]="Small",e[e.Default=32]="Default",e[e.Large=64]="Large"}(r||(r={}));var h=function(e){var t=e.src,n=e.size,i=void 0===n?r.Default:n,s=e.className,h=e.style,f=e.stickerConfig,g=void 0===f?{shortcut:!1,playButton:!1}:f,v=e.children,y=e.onClick,m={height:"".concat(i,"px"),width:"".concat(i,"px")};return a().createElement("div",{className:c()("sc-file-icon-container",s),style:(0,o.Z)((0,o.Z)((0,o.Z)({},l),m),h),onClick:y},a().createElement("div",{className:"sc-file-icon",style:(0,o.Z)((0,o.Z)({},u),{},{backgroundImage:"url(".concat(t,")")})}),g.playButton&&a().createElement("div",{style:(0,o.Z)({},p)}),g.shortcut&&a().createElement("div",{style:(0,o.Z)({},d)}),v)},f=n(75624),g=n(39584),v=n(13967),y=n(27505),m=n(85556);function b(e,t,n){void 0===t&&(t=[]),void 0===n&&(n={loading:!1});var r,o,a=(0,i.useRef)(0),s=(r=(0,i.useRef)(!1),o=(0,i.useCallback)((function(){return r.current}),[]),(0,i.useEffect)((function(){return r.current=!0,function(){r.current=!1}}),[]),o),c=(0,i.useState)(n),l=c[0],u=c[1],d=(0,i.useCallback)((function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=++a.current;return l.loading||u((function(e){return(0,m.__assign)((0,m.__assign)({},e),{loading:!0})})),e.apply(void 0,t).then((function(e){return s()&&r===a.current&&u({value:e,loading:!1}),e}),(function(e){return s()&&r===a.current&&u({error:e,loading:!1}),e}))}),t);return[l,d]}var _,C=n(59834),S=n(90476),w=n(87675);!function(e){e.Success="success",e.Fail="fail"}(_||(_={}));var E=function(){function e(){(0,C.Z)(this,e)}return(0,S.Z)(e,null,[{key:"get",value:function(e){return this.cache[e]}},{key:"set",value:function(e,t){this.cache[e]=t}}]),e}();function x(e){var t=E.get(e);return t?t===_.Success?Promise.resolve(!0):Promise.resolve(!1):new Promise((function(t,n){var r=new Image;r.onload=function(){E.set(e,_.Success),t(!0)},r.onerror=function(){E.set(e,_.Fail),n(!1)},r.src=e}))}function T(e){var t=e.mimeType,n=e.thumbnail,r=e.libIconUrl,a=e.concatUrl,s=function(e,t){void 0===t&&(t=[]);var n=b(e,t,{loading:!0}),r=n[0],o=n[1];return(0,i.useEffect)((function(){o()}),[o]),r}((0,y.Z)((0,v.Z)().mark((function e(){var t,o,i;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=!!n,t=r){e.next=15;break}return e.prev=3,e.next=6,x(a);case 6:i=e.sent,t=i?a:g.bE,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),t=g.bE;case 13:e.next=17;break;case 15:return e.next=17,x(t);case 17:if(!o){e.next=27;break}return e.prev=18,e.next=21,x(n);case 21:o=e.sent,e.next=27;break;case 24:e.prev=24,e.t1=e.catch(18),o=!1;case 27:return e.abrupt("return",{iconURL:t,isThumbnail:o});case 28:case"end":return e.stop()}}),e,null,[[3,10],[18,24]])}))),[t,n]);return s.loading||!s.value?{}:(0,o.Z)({},s.value)}(0,w.Z)(E,"cache",{});var R,I=n(61293),P=n(34938),O=n(70006);!function(e){e.SVG="svg",e.PNG="png"}(R||(R={}));var k=new P.b(O.dJ,g.hX),D=new P.b(O.PP,g.t_),M=function(e){var t=e.size,n=void 0===t?r.Default:t,o=e.mimeType,i=e.extensionName,s=e.docType,c=e.padType,l=e.docThumbnail,u=e.isCollaboration,d=e.className,p=e.style,h=e.stickerConfig,g=void 0===h?{shortcut:!1,playButton:!1}:h,v=e.children,y=e.onClick,m=e.format,b=void 0===m?R.SVG:m,C=(0,f.I8)({mimeType:o,docType:s,isCollaboration:u,padType:c,extensionName:i});if(!C){var S="__fileIconException_".concat(n,"_").concat(o,"_").concat(s,"_").concat(u,"_").concat(c,"_").concat(i,"_").concat(b);return a().createElement(A,{libIconUrl:S,concatUrl:S,size:n,className:d,style:p,stickerConfig:g,onClick:y,children:v})}var w=b===R.PNG?D.run(C):k.run(C),x=(0,f.H5)(C,b);return w&&E.get(w)===_.Success||E.get(x)===_.Success?a().createElement(A,{libIconUrl:w,concatUrl:x,size:n,className:d,style:p,stickerConfig:g,onClick:y,children:v}):a().createElement(L,{libIconUrl:w,concatUrl:x,size:n,className:d,style:p,stickerConfig:g,onClick:y,children:v,docThumbnail:l,mimeType:C})},A=function(e){var t=e.libIconUrl,n=e.concatUrl,r=e.size,o=e.className,i=e.style,s=e.stickerConfig,c=e.onClick,l=e.children;return a().createElement(h,{src:null!=t?t:n,size:r,className:o,style:i,stickerConfig:s,onClick:c},l)},L=function(e){var t=e.mimeType,n=e.docThumbnail,i=e.libIconUrl,s=e.concatUrl,c=e.size,l=void 0===c?r.Default:c,u=e.className,d=e.style,p=e.stickerConfig,f=e.onClick,v=e.children,y=T({mimeType:t,thumbnail:n,libIconUrl:i,concatUrl:s}),m=y.iconURL,b=y.isThumbnail,_={padding:"".concat(l*g.oO,"px"),borderRadius:g.yS};return a().createElement(h,{src:b?n:m,size:l,className:u,style:b?(0,o.Z)((0,o.Z)({},d),_):(0,o.Z)({},d),stickerConfig:p,onClick:f},v)};M.defaultProps={format:!I.t&&navigator&&/(iphone|ipad|ipod)/i.test(navigator.userAgent)||!I.t&&navigator&&/Version\/\S+( Mobile\S*)? Safari\/\S+$/i.test(navigator.userAgent)?R.PNG:R.SVG}},39584:function(e,t,n){n.d(t,{JB:function(){return p},KK:function(){return g},NK:function(){return C},RS:function(){return v},Tb:function(){return S},X$:function(){return d},ZX:function(){return m},bE:function(){return b},hX:function(){return h},kx:function(){return u},nn:function(){return _},oO:function(){return E},pA:function(){return w},t_:function(){return y},ul:function(){return a},yN:function(){return f},yS:function(){return x}});var r,o,i,a,s=n(87675),c=n(70006),l=n(67190);!function(e){e.Doc="application/vnd.tdocs-apps.doc",e.Sheet="application/vnd.tdocs-apps.sheet",e.Form="application/vnd.tdocs-apps.form",e.Folder="application/vnd.tdocs-apps.folder",e.CollaborationSpace="application/vnd.tdocs-apps.collaboration-space",e.Share="application/vnd.tdocs-apps.share-folder",e.Slide="application/vnd.tdocs-apps.slide",e.Pdf="application/pdf",e.Aio="application/vnd.tdocs-apps.aio",e.SmartCanvas="application/vnd.tdocs-apps.smartcanvas",e.SmartSheet="application/vnd.tdocs-apps.smartsheet",e.Mind="application/vnd.tdocs-apps.mind",e.FlowChart="application/vnd.tdocs-apps.flowchart",e.Rec="application/vnd.tdocs-apps.rec",e.Word="application/vnd.ms-word",e.Excel="application/vnd.ms-excel",e.Powerpoint="application/vnd.ms-powerpoint",e.Txt="text/plain",e.Pixso="application/vnd.tdocs-addon-image.236b7f64e91e40b584f2aae0517ee1ed",e.Boardmix="application/vnd.tdocs-addon-image.e3e96c1968114db986a9229003965853",e.Zhiying="application/vnd.tdocs-addon-image.9e2c26161b684629a9bf29e52efa6c60",e.Code="code",e.Default="application/vnd.tdocs-apps.default",e.Image="image",e.Audio="audio",e.Video="video",e.Zip="application/zip"}(a||(a={}));var u=(r={},(0,s.Z)(r,l.e8.Doc,a.Doc),(0,s.Z)(r,l.e8.Sheet,a.Sheet),(0,s.Z)(r,l.e8.Form,a.Form),(0,s.Z)(r,l.e8.Folder,a.Folder),(0,s.Z)(r,l.e8.Slide,a.Slide),(0,s.Z)(r,l.e8.Pdf,a.Pdf),(0,s.Z)(r,l.e8.Aio,a.Aio),(0,s.Z)(r,l.e8.SmartCanvas,a.SmartCanvas),(0,s.Z)(r,l.e8.SmartSheet,a.SmartSheet),(0,s.Z)(r,l.e8.Mind,a.Mind),(0,s.Z)(r,l.e8.FlowChart,a.FlowChart),(0,s.Z)(r,l.e8.Rec,a.Rec),r),d=(o={},(0,s.Z)(o,l.rf.Doc,a.Doc),(0,s.Z)(o,l.rf.Sheet,a.Sheet),(0,s.Z)(o,l.rf.Form,a.Form),(0,s.Z)(o,l.rf.Folder,a.Folder),(0,s.Z)(o,l.rf.Slide,a.Slide),(0,s.Z)(o,l.rf.Pdf,a.Pdf),(0,s.Z)(o,l.rf.Aio,a.Aio),(0,s.Z)(o,l.rf.SmartCanvas,a.SmartCanvas),(0,s.Z)(o,l.rf.FlowChart,a.FlowChart),(0,s.Z)(o,l.rf.SmartSheet,a.SmartSheet),(0,s.Z)(o,l.rf.Mind,a.Mind),o),p=[{reg:/doc|dot|wps|wpt|docx|dotx|docm|dotm/,result:a.Word},{reg:/xls|xlt|xlsx|xltx|csv|xlsb|xlsm|xltm|et|ett|ets/,result:a.Excel},{reg:/pptx|ppt|pot|potx|pps|ppsx|dps|dpt|pptm|potm|ppsm/,result:a.Powerpoint},{reg:/lrc|asp|bat|bas|prg|cmd|rtf|txt|log|xml|htm|html/,result:a.Txt},{reg:/^(raw|bmp|pcx|tiff|gif|exif|jpeg|jpg|fpx|svg|psd|cdr|pcd|dxf|ufo|eps|png|wmf|webp|tga)/,result:a.Image},{reg:/^(mp3|acc|flac|amr|m4a|m4b|wma|wav|cd|wave|aiff|midi|ra|vqf|ogg|ape|weba|aac|flac|mpeg-4|mpeg)/,result:a.Audio},{reg:/^(mp4|3gp|asf|avi|dv|flv|f4v|m3u8|mkv|qt|mov|mpg|mpeg|mts|vob|wmv|rm|m4v|asx|dat|rmvb)/,result:a.Video},{reg:/^(c|cpp|h|asm|s|java|js|jsx|ts|tsx|go|py|md|sh|asp|jsp|php|sql|json|kt|yaml|rust|rs|swift|dart|cs)/,result:a.Code},{reg:/pdf/,result:a.Pdf},{reg:/zip/,result:a.Zip}],h=[{mimeTypes:l.vY,result:c.dJ["application-vnd.ms-word"]},{mimeTypes:l.J_,result:c.dJ["application-vnd.ms-excel"]},{mimeTypes:l.k6,result:c.dJ["application-vnd.ms-powerpoint"]},{mimeTypes:l.lX,result:c.dJ.code},{mimeTypes:l.t5,result:c.dJ.image},{mimeTypes:l._1,result:c.dJ.audio},{mimeTypes:l.uF,result:c.dJ.video},{mimeTypes:l.JH,result:c.dJ.text},{mimeTypes:[a.Folder],result:c.dJ["application-vnd.tdocs-apps.folder"]},{mimeTypes:l.hP,result:c.dJ["application-zip"]}],f=[{mimeTypes:l.t5,result:c.go.image},{mimeTypes:l._1,result:c.go.audio},{mimeTypes:l.uF,result:c.go.video},{mimeTypes:l.JH,result:c.go.text},{mimeTypes:[a.Folder],result:c.go["application-vnd.tdocs-apps.folder"]},{mimeTypes:l.vY,result:c.go["application-vnd.ms-word"]},{mimeTypes:l.J_,result:c.go["application-vnd.ms-excel"]},{mimeTypes:l.k6,result:c.go["application-vnd.ms-powerpoint"]}],g=[{mimeTypes:l.t5,result:c.Is.image},{mimeTypes:l._1,result:c.Is.audio},{mimeTypes:l.uF,result:c.Is.video},{mimeTypes:l.JH,result:c.Is.text},{mimeTypes:[a.Folder],result:c.Is["application-vnd.tdocs-apps.folder"]},{mimeTypes:l.vY,result:c.Is["application-vnd.ms-word"]},{mimeTypes:l.J_,result:c.Is["application-vnd.ms-excel"]},{mimeTypes:l.k6,result:c.Is["application-vnd.ms-powerpoint"]}],v=[{reg:/addon/i,result:c.Tn["application-vnd.tdocs-apps-addon"]},{mimeTypes:l.t5,result:c.Tn.image},{mimeTypes:l._1,result:c.Tn.audio},{mimeTypes:l.uF,result:c.Tn.video},{mimeTypes:l.JH,result:c.Tn["application-vnd.ms-word"]},{mimeTypes:l.vY,result:c.Tn["application-vnd.ms-word"]},{mimeTypes:l.J_,result:c.Tn["application-vnd.ms-excel"]},{mimeTypes:l.k6,result:c.Tn["application-vnd.ms-powerpoint"]}],y=[{mimeTypes:l.t5,result:c.PP.image},{mimeTypes:l._1,result:c.PP.audio},{mimeTypes:l.uF,result:c.PP.video},{mimeTypes:l.JH,result:c.PP.text},{mimeTypes:l.lX,result:c.PP.code},{mimeTypes:[a.Folder],result:c.PP["application-vnd.tdocs-apps.folder"]},{mimeTypes:l.vY,result:c.PP["application-vnd.ms-word"]},{mimeTypes:l.J_,result:c.PP["application-vnd.ms-excel"]},{mimeTypes:l.k6,result:c.PP["application-vnd.ms-powerpoint"]},{mimeTypes:l.hP,result:c.PP["application-zip"]}],m=[{mimeTypes:l.t5,result:c.kz.image},{mimeTypes:l._1,result:c.kz.audio},{mimeTypes:l.uF,result:c.kz.video},{mimeTypes:l.JH,result:c.kz.text},{mimeTypes:l.lX,result:c.kz.code},{mimeTypes:l.vY,result:c.kz["application-vnd.ms-word"]},{mimeTypes:l.J_,result:c.kz["application-vnd.ms-excel"]},{mimeTypes:l.k6,result:c.kz["application-vnd.ms-powerpoint"]},{mimeTypes:[a.Doc],result:c.kz["application-vnd.tdocs-apps.doc"]},{mimeTypes:[a.Sheet],result:c.kz["application-vnd.tdocs-apps.sheet"]},{mimeTypes:[a.Slide],result:c.kz["application-vnd.tdocs-apps.slide"]},{mimeTypes:[a.Pdf],result:c.kz["application-pdf"]},{mimeTypes:[a.Mind],result:c.kz["application-vnd.tdocs-apps.mind"]},{mimeTypes:[a.FlowChart],result:c.kz["application-vnd.tdocs-apps.flowchart"]},{mimeTypes:l.hP,result:c.kz["application-zip"]}],b=c.dJ["application-vnd.tdocs-apps.default"],_=(c.PP["application-vnd.tdocs-apps.default"],c.dJ["application-vnd.tdocs-apps.folder"],c.go["application-vnd.tdocs-apps.default"],c.Is["application-vnd.tdocs-apps.default"],c.Tn["application-vnd.tdocs-apps.default"],c.Tn["application-vnd.tdocs-apps-addon"],c.kz["application-vnd.tdocs-apps.default"]),C="https://docs.gtimg.com/docs-design-resources/document-management/",S="tencent-docs/svg/",w="tencent-docs/png-200px/",E=(i={},(0,s.Z)(i,a.Doc,c.dx.doc),(0,s.Z)(i,a.Sheet,c.dx.sheet),(0,s.Z)(i,a.Slide,c.dx.slide),(0,s.Z)(i,a.Form,c.dx.form),(0,s.Z)(i,a.Folder,c.dx.folder),(0,s.Z)(i,a.CollaborationSpace,c.dx.collaborationSpace),(0,s.Z)(i,a.Share,c.dx.shareFolder),(0,s.Z)(i,a.Pdf,c.dx.pdf),(0,s.Z)(i,a.Aio,c.dx.aio),(0,s.Z)(i,a.SmartCanvas,c.dx.smartCanvas),(0,s.Z)(i,a.Mind,c.dx.mind),(0,s.Z)(i,a.FlowChart,c.dx.flowchart),(0,s.Z)(i,a.Rec,c.dx.rec),(0,s.Z)(i,a.Word,c.dx.word),(0,s.Z)(i,a.Excel,c.dx.excel),(0,s.Z)(i,a.Powerpoint,c.dx.ppt),(0,s.Z)(i,a.Txt,c.dx.txt),(0,s.Z)(i,a.Pixso,c.dx.pixso),(0,s.Z)(i,a.Boardmix,c.dx.boardmix),(0,s.Z)(i,a.Zhiying,c.dx.zhiying),l.t5,c.dx.image,l._1,c.dx.audio,l.uF,c.dx.video,l.JH,c.dx.text,a.Folder,c.dx.folder,.125),x=.06},70006:function(e,t,n){n.d(t,{Is:function(){return h},PP:function(){return g},Tn:function(){return p},dJ:function(){return d},dx:function(){return u},go:function(){return f},kz:function(){return v}});var r=n(97020),o=n(6711),i=n(49215),a=n(42432),s=n(6175),c=n(84029),l=n(61293),u={doc:l.t?"":n(33781),sheet:l.t?"":n(19317),slide:l.t?"":n(1611),form:l.t?"":n(63134),folder:l.t?"":n(65678),collaborationSpace:l.t?"":n(36938),shareFolder:l.t?"":n(40194),pdf:l.t?"":n(8884),aio:l.t?"":n(67146),smartCanvas:l.t?"":n(67146),mind:l.t?"":n(42914),flowchart:l.t?"":n(94312),rec:l.t?"":n(33824),word:l.t?"":n(22787),excel:l.t?"":n(45665),ppt:l.t?"":n(37561),txt:l.t?"":n(42944),pixso:l.t?"":n(12780),boardmix:l.t?"":n(49691),zhiying:l.t?"":n(71579),image:l.t?"":n(9235),audio:l.t?"":n(27614),video:l.t?"":n(69546),text:l.t?"":n(42944),code:l.t?"":n(13713),defaultIcon:l.t?"":n(61385)},d=r.Z,p=o.Z,h=i.Z,f=a.Z,g=s.Z,v=c.Z},61293:function(e,t,n){n.d(t,{t:function(){return r}});var r="number"!=typeof setTimeout((function(){}),0)},34938:function(e,t,n){n.d(t,{b:function(){return i}});var r=n(59834),o=n(90476),i=function(){function e(t,n){(0,r.Z)(this,e),this.preciseMatchMap=t,this.fuzzyMatchRules=n}return(0,o.Z)(e,[{key:"run",value:function(e){if("string"==typeof e){var t=this.preciseMatchMap[e.replace("/","-")];if(t)return t;var n=this.fuzzyMatchRules.find((function(t){return t.mimeTypes?t.mimeTypes.includes(e):t.reg?t.reg.test(e):void 0}));return null==n?void 0:n.result}console.warn("file-icon match with none-string parameter")}}]),e}()},75624:function(e,t,n){n.d(t,{H5:function(){return l},I8:function(){return s}});var r=n(39584),o=n(67190),i=n(34938),a=n(90049);function s(e){var t,n=e.docType,a=e.mimeType,s=e.isCollaboration,l=void 0!==s&&s,u=e.extensionName,d=e.padType,p=null==u?void 0:u.toLocaleLowerCase(),h=(void 0!==(t={docType:n,mimeType:a,extensionName:p,padType:d}).docType&&t.docType!==o.e8.Unknown||t.padType||t.mimeType)&&(!c(t.docType,t.padType)||t.extensionName||t.mimeType)?t.mimeType:r.ul.Default;return h||(h=function(e,t,n){var o;return c(e,t)&&n?("."===(null===(o=n)||void 0===o?void 0:o.charAt(0))&&(n=n.substring(1)),new i.b({},r.JB).run(n)||r.ul.Default):r.kx[e]||r.X$[t]}(n,d,p)),h===r.ul.Folder&&(h=function(e){return e?r.ul.CollaborationSpace:r.ul.Folder}(l)),h}function c(e,t){return e?e===o.e8.Drive:!!t&&t.indexOf(o.rf.Drive)>-1}var l=function(e,t){return t===a.c.PNG?r.NK+r.pA+e.replace("/","-")+".png":r.NK+r.Tb+e.replace("/","-")+".svg"}},64335:function(e,t,n){var r,o,i;window,e.exports=(r=n(86667),o=n(55466),i=n(26711),function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t){e.exports=r},function(e,t){e.exports={"en-US":{sc:{"":"Cancel","":"OK","":"This Folder","":"This Document","":"Folder","":"Document","":"Move","":"Add","":"Add a shortcut to","":"Save","":"Log in","":"Log in to edit the file, you can only view it if not logged in","":"All members of the shared folder can see","":"Permissions are merged with the permissions on the shared folder.","":"Generate a copy and move to","":"Move to Collaboration Space","":"After moving, the collaboration space admin can manage this document, including changing permissions of the creator. Move it?","":"New Folder","":"Move To","":"My Documents","":"Shared with Me","":"Add to","":"The folder name cannot be empty.","{{$1}}":"The folder name cannot include the following characters{{$1}}","":"The folder name is too long.","":"Failed to create a folder.","":"The content","":"View","":"You have no permission to perform this operation.","":"Move to Shared Folder","":"Failed to move the folder. Try again later.","":"Remove from Collaboration Space","":"Once removed, the file cannot be viewed by members in the collaboration space. Remove it?","":"Remove Shared Content","":"Add to Shared Folder","":"Sheet","":"Form","":"Edit","":"Copied","":"Unable to copy this text:","":"Remind the creator to process the request."," ":"Creator","":"Please accept my permission request for ","":"","":"Permission","":"Reminder text copied. Paste it to the creator.","":"Remind","":"Untitled Document","":"Failed to redirect to Mini Program for verification. Refresh the page and try again.","":"Camera","":"Problems turning up the camera?","":"Insert Local Image","":"All Documents","":"Refreshed successfully.","":"Release to Refresh","":"Pull Down to Refresh","":"Refreshing...","":"For the PC version, visit","ICON//":"Icon/Title Bar/Find Members","ICON//@3x":"Icon/Accessibility Small Icon/Clear @3x","":"Back","":"Select Tencent Docs","":"Insert","":"Upload","":"Failed to load the file. Try again later.","":"Failed to search for the file. Enter and try again.","":"Failed to get document permission","":"Plead click the save button in the upper right corner, and re-operate after saving.","":"Failed to obtain document link permissions.","":"Insert Tencent Docs","":'This is a private document. Do you want to change the permission to "Anyone Can View"??',"":"This is a private folder. Do you want to change it to a shared folder?","":"Change","":"Cancel","":"Search Title","":"Recent","":"Search Results","":"Me"," | ":"Create |","":"Create","":"No result found","":"Change to Viewable","":"One","":"Two","":"Three","":"Four","":"Five","":"Six","":"Week","":"Week"," ":"Today","":"Delete","":"Share","":"More","":"Permission Settings","":"Share","":"Rename","":"Move","":"All shared members can see","":"Sub-folder","":"You have no access to this folder.","":"Network error. Tap the screen to load again.","":"The folder is empty.","":"Share Folder with Me","":"Click here to move the document.","":"The folder name is invalid.","":"List page in the mobile version: Folder created successfully","":"List page in the mobile version: Failed to create the folder","":"The folder name cannot be empty.","-":"Tencent Docs - Online Docs","-":"Tencent Docs - Online Sheets","":"Claimed","":"Claimed to my folders","":"Network error. Try again later.","":"Delete Permanently","":"You have no permission to perform this operation."," ":"Created on","":"Tencent Docs","":"Restore","":"List page in the mobile version: Share Docs","":"Note","":"List page in the mobile version: Open Permission Component","":"Add to My Docs","":"Unstar","":"Star","":"Remove from Top","":"Sticky on Top","30":"VIPs are privileged to restore documents that have been deleted in the last 30 days.","7":"Documents deleted in the last 7 days can be restored.","30":"Extend to 30 days","":"No more","...":"Loading... Please wait.","30":"Files deleted more than 30 days ago cannot be restored.","":"by","":"From:","":"Share","":"The folder name is invalid.","":"The document name is invalid.","":"The document name is too long.","":"Failed to rename.","":"The folder name cannot be empty.","":"The document name cannot be empty.","":"Move to Shared Folder","":"Failed to create folder.","":"Enter","":"Dialog Box Title","":"Dialog Box Tooltip","":"Placeholder in Input Box","":"Open Dialog Box","":"Read only","":"Creator: Me","Excel":"Export as Excel File","":"Generate Copy","":"Send to PC","":"Find and replace","":"Find","":"Find and replace","":"Browsing History","":"No click state","":"Create Form","":"Help & Feedback","":"An error occurred while obtaining folder information. Refresh and try again.","":"Refresh","":"The document has multiple shortcuts. Go to the homepage to manage them.","":"The document has multiple shortcuts.","":"Manage","":"Syncing the data in the shared document. Try again later.","":"Done","":"Recently used","":"Custom color","":"Recent","_/Icon/":"_Icon/Icon/Close","":"Search Online Docs","":"Enter a file name and search for it.","":"Clear Search History","":"Loading...","...":"Loading...","":"Permissions modified successfully.","":"Failed to modify permission","":"Cancel permission modification","":"Operation failed. Try again later.","":"Document starred","":"Unstarred","":"Document unstarred","":"Star Document","":"You can only view this document. Log in to perform more operations.","":"Log In Now","":"Starring failed:","":"Starring failed.","":"New Version"," ":"Tencent Docs","":"No more prompts in this version","":"Update","":"Not Now","":"Link copied.","":"Copy failed.","APP":"Download the latest version of the app","":"Will open a browser for downloading","":"If you have opened a browser for downloading, close this window.","":"If no browser is opened for downloading","":"Copy Link","APP":"Paste and open the link in the browser to download the latest version of the app.","":"Test Account","200":"Members can increase the number of collaborators for one document to 200.","20":"Collaborator limit of 20 for one document","200":"Increase to 200","":"people are viewing","":"No result found","":"Created by Me","":"Export","":"Search","":"Exporting","":"No folder yet. Go to the homepage to create one.","":"Cannot generate file collections for folders shared by others.","":"Cannot access the document because it has been reported.","":"The folder contains documents created by others. These documents cannot be claimed.","100":"Cannot generate a file collection for the folder because the folder contains over 100 documents.","":"This folder already has a file collection.","":"Documents created by others in the folder cannot be claimed.","":"No collaborator.","":"etc.","":"people","":"and","":"Collaborate","":"The document name cannot contain any of the following characters","128":"Document name cannot exceed 128 characters.","":"Play","":"The document is view-only. Click to request the edit permission.","":"View only. Send a request to the creator for more permissions.","":"The document is view-only.","":"View Only","":"Click to copy the reminder link and send it to the creator.","":"Edit Document","":"Request Edit Permission","":"You are editing offline. Edits will be saved locally and synced when you are online.","":"Editing offline","":"The network is disconnected. Edited content has been saved locally and will be synced to the cloud upon network recovery.","":"All edits will be automatically saved to the cloud.","":"Saved successfully.","":"Last modification was made","":"just now","":"At","":"minutes ago","":"hours ago","":"days ago","":"ongoing","":"Viewers are not allowed to copy and generate copies.","":"Viewers are not allowed to copy, download, and generate copies.","":"Back to Home","":"Owner:","{{ownerNickName}}":"Owner: {{ownerNickName}}","":"Creation time:","{{year}}-{{month}}-{{day}}":"Creation time: {{year}}-{{month}}-{{day}}","":"View Doc Info","":"New","":"Online Docs","":"Online Sheet","":"Online PPT","":"Online Form","":"Import Local File","":"Help Center","":"Restricted Document Appeal","":"Feature Description","":"Document Operations","":"Version Info","":"You are in offline mode.","":"Failed to import the document.","":"Document imported successfully.","":"Temporarily switched to the WeCom account.","200":"Unable to join the collaboration. View only now. Notify the creator to activate membership to increase the number of collaborators to 200.","20200":"The limit of 20 collaborators is reached. You cannot join the collaboration. View only now. Notify the creator to activate membership to increase the number of collaborators to 200.","":"The available space is","MB10GB":"MB only. Activate membership to increase the space to 10 GB.","7":"The folder was deleted more than 7 days ago.","7":"The document was deleted more than 7 days ago.","MB10GB":"MB only. Activate membership to increase the space to 10 GB.","":"Activate Membership","":"Notification sent to the owner. View only.","iPad":". Membership activation is not available on iPad.","":"Set successfully.","":"Modify Watermark","":"Document Watermark","":"Watermark Content","":"Text Watermark","":"Enter watermark text, such as a company name or reminder.","15":"Do not exceed 15 characters.","":"Visitor Watermark","":'For example, if Sam accesses the document, the user name "Sam" is displayed.',"":"Watermark Style","":"Document activities","":"Edit","":"Tight","":"Loose","":"Watermark hidden to me","":"Confirm","":"Microsoft YaHei","":"Visitor watermarks have been added to the document to ensure content security.","":"Contact Tencent Docs Assistant","3s":"Open Now (3s)","":"Copied successfully.","":"Open Now (","":"Close","":"Exported successfully.","":"If no browser is opened automatically for downloading","":"Paste and open the link in the browser to download the exported document.","":"Open","":"No redirection required. You can view the document immediately after you export it.","PDF":"Export as PDF","PDF":"Online PDF","":"Export as online documents. You can share links and set view permissions.","":"Download to Local Device","":"Download after exporting it as a local file","":"Conversion failed. Try again later.","":"Data error. Refresh the page and try again.","":"You're offline. Connect to the network and try again.","PDF":"Exporting PDF... Please wait.","":"Share Now","":"Menu","":"Disabled state","":"Toolbar in the App","":"Palette","":"Half-Screen Panel","":"Content Area (AutoFit Height)","[@]":"[You were @mentioned]",":":"Shared By:",":":"Creator:","":"What's new in this version:","":"Presentation","":"Associated collection form","":"Add collection","":"Cancel collection","":"Added to collection","":"Collection cancelled ","{{userStr}}":"The last modification was just made by {{userStr}}","{{userStr}}{{time}}":"The last modification was made by {{userStr}} {{time}} minutes ago","{{userStr}}{{time}}":"The last modification was made by {{userStr}} {{time}} hours ago","{{userStr}}{{time}}":"The last modification was made by {{userStr}} {{time}} days ago","{{userStr}}{{time}}":"The last modification was made by {{userStr}} at {{time}}","":"Year","":"Month","":"Day"," {{date}}":"Recently Saved {{date}}","":"Forward","{{len}}":"{{len}} contacts selected","":"Please select the contact you want to add","":"Choose a contact","":"Also notify added members","":"Invite others to collaborate","":"Designated person can fill in","":"Anyone can fill in","":"Anyone Can Edit","":"Private to Only Me","":"Specified People","":"Anyone Can View","{{memNames}}{{listLength}}":"Collaborate with {{memNames}} etc. ({{listLength}} in total)","{{memNames}}":"Collaborate with {{memNames}}","({{key}}+F1)":"Show Toolbar({{key}}+F1)","":"Toolbar Display Options","":"Simplified Toolbar","":"Classic Toolbar","":"Hide Toolbar","":"External","":"Personal","":"Enterprise","":"WeChat","":"Click for Edit Permission","":"Save as template","":"Please enter the template name","":"Save as my template","128":"Template name cannot exceed 128 characters","":"Illegal template name","":"The template could not be saved temporarily. Please try again later.","100KB":"If the file is larger than 100KB, it does not support saving as a template.","":"The template has reached the upper limit. Failed to save the template.","":"There is no permission to access the document. Failed to save the template.","":"The title is not compliant, please rename it.","":"The network is abnormal and the template saving fails.","":"Saved to my template","PDF":"Failed to export PDF document","PDF":"Failed to cancel exporting PDF document","":"Sharing failed","PDF":"Exported PDF document","PDF":"Successfully exported the local PDF document","PDF":"Exported online PDF documents","":"View now"," ({{counterSecond}}s":"Open now ({{counterSecond}}s","":"Log in","{{$1}}":"Tourist {{$1}}"," {{$1}}":"Today {{$1}}","{{$1}":"{{$1}Create","...":"Exporting...","{{$1}}":"Select at most {{$1}} files","{{$1}}":"{{$1}} Export failed","":"Please click the copy link","":"Open the browser to download the file","":"Click the share button at the bottom to share","":"The link is only valid on the day","":"System resolution timed out, please try again later","":"Conversion abnormal, please try again later","":"The system is abnormal, please try again later","":"The system is busy, please try again later","":"Export failed, please try again later","":"Insufficient permissions","":"Download","":"Feedback","":"Cloud backup","":"Cloud backup needs to be transferred to Tencent Documents. Do you want to continue?","":"Failed to save the document","":"The file has been saved to Weiyun","{{docTitle}}{{isEdit}}":'Please help me to activate the {{isEdit}} permission of "{{docTitle}}"',"":"The text has been successfully copied to the clipboard","":"You can only view this document. To edit the document, please log in and edit.","\n":'The current document permission is "view only",\nyou can get more operation permissions after logging in.',", ":"You can only view this document, and you can get more operation permissions after logging in."," {{name}} ":"Editing permission has been requested. Please wait for the review of the creator {{name}}.","":"Editing permission has been requested. Please wait for the review","":'The permission request failed, and the document "can only be viewed".',"":'The document permission is "View Only".',"{{name}}":"You can only view this document. If you want to edit the document, please apply for editing permission from the document creator {{name}} or make a copy for editing.","{{name}}":"You can only view this document. If you want to edit the document, please apply for editing permission from the document creator {{name}}.","":"You can only view this document. If you want to edit the document, please apply for editing permission or make a copy for editing.","":"You can only view this document. If you want to edit the document, please apply for editing permission.","\n":'The current document permission is "view only",\nclick to apply for editing permission or make a copy.',"\n":'The current document permission is "view only",\nclick to apply for editing permission.',"":'The current document permission is "View Only".',"":"Viewing offline","":"To online document editing","":"Convert to online editing","":"Send reminder","":"Reminder","":"Off the net","":"Untitled document","":"Untitled sheet","":"Untitled slide","":"Untitled mind","":"Untitled flowchart","":"Untitled smart canvas","":"Untitled small app","":"Owner","{{$1}}":"Current version: {{$1}}","{{realMaxSize}}MB":"Import failed because the file size exceeds {{realMaxSize}}MB.","":"Double speed","":"Original painting","{{$1}} ":"{{$1}} Transcoding","{{$1}} ":"{{$1}} Failed to transcode","":"Retry","":"Replay","":"Video finished","":"Video transcoding, please wait","{{$1}}":"Internet speed is slow, whether to switch the resolution to {{$1}}","{{$1}}":"Switch to {{$1}}","":"Internet speed is slow, whether to switch the resolution to","":"Switch to","20":"The number of collaborations has reached 20","10MB":"Picture size exceeds 10MB","":"Restore version exceeds time limit","530":"Free users can only restore the version within 5 days, active members can restore the version within 30 days","":"The paid template is for members only, click to activate membership","30":"Open document membership can extend the number of days to 30 days","":"The number of collaborators is full and cannot be edited","20":"Collaborate with up to 20 people, currently only available for viewing, it is recommended to notify the creator of the document membership.","20MB":"Open document membership can increase the upper limit to 20MB","530":"Free users can only restore the version within 5 days, and active members can restore the version within 30 days.","{{$1}}MB10GB":"There is only {{$1}}MB left in the current space, and the active member can get 10GB of space.","":"Not available for non-members","~":"This template is a member template and can be used after opening a member. Come and experience the membership template~","":"Understood","{{content}}{{limit}}iPad":"{{content}}{{limit}} iPad does not support membership activation","{{content}}{{limit}}/APP":"{{content}}{{limit}} Please open Tencent document web version/APP payment activation","{{content}}{{limit}}":"{{content}}{{limit}}According to the platform specifications, the mini program does not support membership activation at the moment","{{content}}{{limit}}":"{{content}}{{limit}} This version does not support membership activation","{{content}}{{limit}}APP":"{{content}}{{limit}}This version does not support membership activation, please upgrade the APP","{{content}}{{limit}}":"{{content}}{{limit}} This version does not support membership activation, please upgrade or activate via web version payment","":"Notify creator","":"The notification failed, please resend the reminder","{{$1}}iPad":"{{$1}}, iPad does not support membership activation","":"Dense watermark","":"Loose watermark","":"The watermark cannot have only spaces","":"Watermark is not compliant","":"Watermark content is a security risk","":"Watermark setting failed, please try again later.","":"The folder name cannot be repeated.","":"Contains sensitive words, please rename.","":"The number of folders exceeds the limit, and the creation fails.","{{type}}":"{{type}} This folder already exists, no need to move.","{{parentFolderName}}''":'It has been moved to the shared folder "{{parentFolderName}}", and all shared members can see the "folder".',"{{$1}}{{$2}}":'It has been moved to the shared folder "{{$1}}", and all shared members can see the {{$2}}.',"{{parentFolderName}}":'Moved to folder "{{parentFolderName}}"',"{{parentFolderName}}":'Move to "{{parentFolderName}}"',"{{docDesc}}":"{{docDesc}} The move failed, please try again later.","":"Too many folder levels, the move failed.","":"The number of folders exceeds the limit, and the move fails.","":"Shared folders and collaboration spaces cannot be moved between each other","{{docDesc}}":"The {{docDesc}} already exists in the target folder, and the move failed.","{{docDesc}}":"Cannot move into {{docDesc}} of non-shared folder collaborating member.","":"The shared folder has been deleted and the move failed.","{{$1}}":"You moved {{$1}} items out of the shared folder, and others will not be able to use them. Are you sure you want to move them out?","{{parentFolderName}}":'Added to "{{parentFolderName}}", shared members can see the folder',"{{$1}}{{$2}}":'Added to "{{$1}}", shared members can see this {{$2}}',"{{parentFolderName}}":'Added to "{{parentFolderName}}".',"{{$1}}":"{{$1}} failed to add, please try again later.","{{$1}}":"Cannot add {{$1}} who is not a member of the shared folder.","":"The shared folder has been deleted and failed to add.","{{title}}{{permissionType}} {{urgeUrl}}":'Please help me to activate the {{permissionType}} permission {{urgeUrl}} of "{{title}}"',"":"Remake","":"The document has been inserted, and anyone with the link can view it.","":"Permission modification failed","":"The folder has been upgraded to a collaboration space and inserted, and anyone who gets the link can view it.","":"Failed to upgrade collaboration space","":"The current folder is a private folder, is it upgraded to a collaborative space?","{{fileType}}":"A {{fileType}} is about to be permanently deleted. After deletion, it cannot be restored. Are you sure you want to delete it?","{{docType}}{{docType}}":"{{DocType}} in the recycle bin cannot be edited. If you want to use it, please restore {{docType}} first.","":"The folder in the recycle bin cannot be opened. If you open it, please restore the folder first.","{{$1}}{{$2}}":'The target directory already contains a folder named "{{$1}}". If you continue to rename the current folder to "{{$2}}", do you want to restore it?',"{{parentFolderName}}":'Restored to folder "{{parentFolderName}}".',"{{title}}":'Failed to restore the file "{{title}}".',"{{title}}":'Failed to restore folder "{{title}}".',"{{$1}}":"View association{{$1}}","{{editCount}}":"{{editCount}} members can edit","{{viewCount}}":"{{viewCount}} members can view","":"Anyone can edit","{{remainDays}}":"Deleted {{remainDays}} days ago"," ":" Delete today","{{action}}{{scenes}}{{content}}":"{{action}} After {{scenes}} members can see {{content}}","{{scnensName}}":"{{scnensName}}","-":"Tencent Document-Online Collection Form","-":"Tencent Documents-Online Slides","-PDF":"Tencent Document-PDF Document","{{$1}}":"The {{$1}} already exists, no need to add it again.","{{$1}}{{$2}}":'The target directory already contains a folder named "{{$1}}". If you continue to move, rename the current folder to "{{$2}}". Do you want to move it?',"{{$1}}":"{{$1}} The move failed, please try again later.","{{$1}}":"The {{$1}} already exists in the target folder, and the move failed.","":"Cannot move into folders of non-shared folder collaborators.","{{$1}}":"Cannot move into {{$1}} of non-shared folder collaborators.","":"Move to collaboration space","/":"Only you can view/edit","":"Share with designated person","":"Get the link to view","{{$1}}":"Get the link available {{$1}}","":"Start demo","":"Failed to add favorites","{{$1}}{{$2}}":"{{$1}} {{$2}}","":"All subscribers","...":"Select from Contacts...",";":"All;","":"Set timed reminders","":"Time","":"Remind","":"Repeat","":"Be reminded","":"Note reminder content","":"Remove","":"Date","":"All day","":"Specified time","":"Reminder time","":"Not set","":"Note","":"Add note","":"Save reminder","":"Remind everyone","":"Reminder only the designated person","":"The following people will be reminded","":"Add a reminder","":"That day","":"Local files","{{num}} ":"{{num}} days ago","{{num}} ":"{{num}} weeks ago","":"Begin"," {{num}} ":"{{num}} minutes before"," {{num}} ":"{{num}} hours before"," {{num}} ":"{{num}} days before","":"No repeat","":"Every day","":"Work day","":"Every week","":"Every two week","":"Every Month","":"Set reminder","{{num}}  {{date}} ":"{{date}} reminders after {{num}} days","yyyyMMdd":"yyyy/MM/dd","":"Verification","":"Verification Type:","":"Entity:","":"Provided by","":"not verified","":"government","":"media","":"company media","recently-used":"Recently used","all-fonts":"All fonts",error:"Font download error! Please try again later.","is-downloading-one":"Downloading {{font}}","is-downloading-multiple":"Downloading {{firstFont}} and {{fontNumEN}} other fonts","vip-description":"(this document was created by a VIP user, please enjoy VIP privileges)","download-success-one":"1 font successfully downloaded","download-success":"{{num}} fonts successfully downloaded",cancel:"cancel","vip-custom-fonts":"styled fonts","no-vip-fonts":"no styled fonts available","add-styled-fonts":"add styled fonts","cannot-use-vip-font":"Cannot use VIP font","collaborator-no-vip-privilege":"This document was created by non-vip user, and collaborators don't have VIP privileges","vip-document-has-privilege":"Document created by VIP users can share VIP privileges.","vip-can-share-privilege":"VIP users enjoy all premium fonts, and can share with all collaborators.","cannot-clone":"Cannot generate copy","buy-vip-to-clone":"become a VIP to generate copy of document with VIP fonts","buy-vip":"buy VIP","expired-vip-prompt":"VIP expired, editing in VIP fonts will be downgraded to default font","can-use-all-font":"Document created by VIP user can share VIP fonts","normal-user-cannot-use-vip-font":"Non-VIP user cannot use VIP fonts","vip-expired-cannot-use-vip-font":"Expired VIP cannot use VIP fonts","non-owner-vip-prompt":"Doc owner's VIP has expired. Editing in VIP fonts will be changed to default fonts.","only-vip-can-use-font-modal-content":"Your VIP has expired. Buy VIP to use VIP fonts again."}},"zh-CN":{sc:{"":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",":*\\\\/<>?|":":*\\\\/<>?|","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""," ":" ","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","ICON//":"ICON//","ICON//@3x":"ICON//@3x","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""," | ":" | ","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""," ":" ","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","[@]":"[@]","":"","":"","":"","":"","-":"-","-":"-","":"","":"","":"","":"","":""," ":" ","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","30":"30","7":"7","30":"30","":"","":"","30":"30",":":":",":":":","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","Excel":"Excel","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","_/Icon/":"_/Icon/","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""," ":" ","":"","":"","":"","":"","":"","":"","APP":"APP","":"","":"","":"","":"","APP":"APP","":"","200":"200","20":"20","200":"200","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","100":"100","":"","":"","":"","":"","":"","":"","":"","":"","128":"128","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{ownerNickName}}":"{{ownerNickName}}","":"","{{year}}-{{month}}-{{day}}":"{{year}}-{{month}}-{{day}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","200":"200","20200":"20200","":"","MB10GB":"MB10GB","7":"7","7":"7","MB10GB":"MB10GB","":"","":"","iPad":"iPad","":"","":"","":"","":"","":"","":"","15":"15","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","3s":"3s","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","PDF":"PDF","PDF":"PDF","":"","":"","":"","":"","":"","":"","PDF":"PDF","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{userStr}}":"{{userStr}}","{{userStr}}{{time}}":"{{userStr}}{{time}}","{{userStr}}{{time}}":"{{userStr}}{{time}}","{{userStr}}{{time}}":"{{userStr}}{{time}}","{{userStr}}{{time}}":"{{userStr}}{{time}}","":"","":"","":""," {{date}}":" {{date}}","":"","{{len}}":"{{len}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{memNames}}{{listLength}}":"{{memNames}}{{listLength}}","{{memNames}}":"{{memNames}}","({{key}}+F1)":"({{key}}+F1)","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","128":"128","":"","":"","100KB":"100KB","":"","":"","":"","":"","":"","PDF":"PDF","PDF":"PDF","":"","PDF":"PDF","PDF":"PDF","PDF":"PDF","":""," ({{counterSecond}}s":" ({{counterSecond}}s","{{$1}}":"{{$1}}"," {{$1}}":" {{$1}}","{{$1}":"{{$1}","...":"...","{{$1}}":"{{$1}}","{{$1}}":"{{$1}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{docTitle}}{{isEdit}}":"{{docTitle}}{{isEdit}}","":"","\n":"\n","":"",", ":", "," {{name}} ":" {{name}} "," {{name}} ":" {{name}} ","":"","":"","":"","{{name}}":"{{name}}","{{name}}":"{{name}}","":"","":"","\n":"\n","\n":"\n","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{$1}}":"{{$1}}","{{realMaxSize}}MB":"{{realMaxSize}}MB","":"","":"","{{$1}} ":"{{$1}} ","{{$1}} ":"{{$1}} ","":"","":"","":"","":"","{{$1}}":"{{$1}}","{{$1}}":"{{$1}}","":"","":"","20":"20","10MB":"10MB","":"","530":"530","":"","30":"30","":"","20":"20","20MB":"20MB","530":"530","{{$1}}MB10GB":"{{$1}}MB10GB","":"","~":"~","":"","{{content}}{{limit}}iPad":"{{content}}{{limit}}iPad","{{content}}{{limit}}/APP":"{{content}}{{limit}}/APP","{{content}}{{limit}}":"{{content}}{{limit}}","{{content}}{{limit}}":"{{content}}{{limit}}","{{content}}{{limit}}APP":"{{content}}{{limit}}APP","{{content}}{{limit}}":"{{content}}{{limit}}","":"","":"","{{$1}}iPad":"{{$1}}iPad","":"","":"","":"","":"","":"","":"","":"","...":"...",";":";","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{num}} ":"{{num}} ","{{num}} ":"{{num}} ","":""," {{num}} ":" {{num}} "," {{num}} ":" {{num}} "," {{num}} ":" {{num}} ","":"","":"","":"","":"","":"","":"","":"","{{num}}  {{date}} ":"{{num}}  {{date}} ","yyyyMMdd":"yyyyMMdd","":"","":"","":"","{{parentFolderName}}":"{{parentFolderName}}","{{parentFolderName}}":"{{parentFolderName}}","":"","":"","":"","":"","":"","recently-used":"","all-fonts":"",error:"","is-downloading-one":" {{font}}","is-downloading-multiple":" {{firstFont}} {{fontNumCN}}","vip-description":"","download-success-one":"1","download-success":"{{num}}",cancel:"","vip-custom-fonts":"","no-vip-fonts":"","add-styled-fonts":"","cannot-use-vip-font":"","collaborator-no-vip-privilege":"","vip-document-has-privilege":"","vip-can-share-privilege":"","cannot-clone":"","buy-vip-to-clone":"","buy-vip":"","expired-vip-prompt":"","can-use-all-font":"","normal-user-cannot-use-vip-font":"","vip-expired-cannot-use-vip-font":"","non-owner-vip-prompt":"","only-vip-can-use-font-modal-content":""}},"zh-HK":{sc:{"":"","ICON//":"ICON//","ICON//@3x":"ICON//@3x","MB10GB":"MB10GB","MB10GB":"MB10GB","PDF":"PDF","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","_/Icon/":"_/Icon/","":"","":"","":"","":"","":"","APP":"APP","":"","":"","":"","":"","":"","":"","":""," ":" ","":"","30":"30","200":"200","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",":":":","":"","":"","":"","":"","":"","":""," | ":" | "," ":" "," ":" ",":":":","":"","":"","":"","{{year}}-{{month}}-{{day}}":"{{year}}-{{month}}-{{day}}","":"","":"","":"","":"","":"","":"","":"","20200":"20200","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","7":"7","20":"20","":"","":"","":"","":"","":"","APP":"APP","PDF":"PDF","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","Excel":"Excel","PDF":"PDF","":"","":"","":"","":"","":"","30":"30","":"","":"","":"","":"","":"","":"","":"","":"","":"","30":"30","":"","":"","":"","":"","":"","200":"200","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{ownerNickName}}":"{{ownerNickName}}","":"","":"","":"","200":"200","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","7":"7","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","7":"7","":"","128":"128","":"","":"","":"","":"","100":"100","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","@":"[@]","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","3s":"3s","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""," ":" ","-":"-","-":"-","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","15":"15","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","iPad":"iPad","{{$1}}":"{{$1}}","":"","":"","":"","":"","":"","{{userStr}}":"{{userStr}}","{{userStr}}{{time}}":"{{userStr}}{{time}}","{{userStr}}{{time}}":"{{userStr}}{{time}}","{{userStr}}{{time}}":"{{userStr}}{{time}}","{{userStr}}{{time}}":"{{userStr}}{{time}}","":"","":"","":""," {{date}}":" {{date}}","{{len}}":"{{len}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{memNames}}{{listLength}}":"{{memNames}}{{listLength}}","{{memNames}}":"{{memNames}}","({{key}}+F1)":"({{key}}+F1)","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","128":"128","":"","":"","100KB":"100KB","":"","":"","":"","":"","":"","PDF":"PDF","PDF":"PDF","":"","PDF":"PDF","PDF":"PDF","PDF":"PDF","":""," ({{counterSecond}}s":" ({{counterSecond}}s","{{$1}}":"{{$1}}"," {{$1}}":" {{$1}}","{{$1}":"{{$1}","...":"...","{{$1}}":"{{$1}}","{{$1}}":"{{$1}}","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{docTitle}}{{isEdit}}":"{{docTitle}}{{isEdit}}","":"","":"","\n":"\n",", ":", "," {{name}} ":" {{name}} "," {{name}} ":" {{name}} ","":"","":"","":"","{{name}}":"{{name}}","{{name}}":"{{name}}","":"","":"","\n":"\n","\n":"\n","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{$1}}":"{{$1}}","{{realMaxSize}}MB":"{{realMaxSize}}MB","":"","":"","{{$1}} ":"{{$1}} ","{{$1}} ":"{{$1}} ","":"","":"","":"","":"","{{$1}}":"{{$1}}","{{$1}}":"{{$1}}","":"","":"","20":"20","10MB":"10MB","":"","530":"530","":"","30":"30","":"","20":"20","20MB":"20MB","530":"530","{{$1}}MB10GB":"{{$1}}MB10GB","":"","~":"~","":"","{{content}}{{limit}}iPad":"{{content}}{{limit}}iPad","{{content}}{{limit}}/APP":"{{content}}{{limit}}/APP","{{content}}{{limit}}":"{{content}}{{limit}}","{{content}}{{limit}}":"{{content}}{{limit}}","{{content}}{{limit}}APP":"{{content}}{{limit}}APP","{{content}}{{limit}}":"{{content}}{{limit}}","":"","":"","{{$1}}iPad":"{{$1}}iPad","":"","":"","":"","":"","":"","":"","":"","[@]":"[@]","":"","":"","":"","":"","":"","{{type}}":"{{type}}","{{parentFolderName}}''":"{{parentFolderName}}''","{{$1}}{{$2}}":"{{$1}}{{$2}}","{{parentFolderName}}":"{{parentFolderName}}","{{parentFolderName}}":"{{parentFolderName}}","{{docDesc}}":"{{docDesc}}","":"","":"","":"","{{docDesc}}":"{{docDesc}}","{{docDesc}}":"{{docDesc}}","":"","{{$1}}":"{{$1}}","{{parentFolderName}}":"{{parentFolderName}}","{{$1}}{{$2}}":"{{$1}}{{$2}}","{{parentFolderName}}":"{{parentFolderName}}","{{$1}}":"{{$1}}","{{$1}}":"{{$1}}","":"","{{title}}{{permissionType}} {{urgeUrl}}":"{{title}}{{permissionType}} {{urgeUrl}}","":"","":"","":"","":"","":"","":"","{{fileType}}":"{{fileType}}","{{docType}}{{docType}}":"{{docType}}{{docType}}","":"","{{$1}}{{$2}}":"{{$1}}{{$2}}","{{parentFolderName}}":"{{parentFolderName}}","{{title}}":"{{title}}","{{title}}":"{{title}}","{{$1}}":"{{$1}}","{{editCount}}":"{{editCount}}","{{viewCount}}":"{{viewCount}}","":"","{{remainDays}}":"{{remainDays}}"," ":" ","{{action}}{{scenes}}{{content}}":"{{action}}{{scenes}}{{content}}","{{scnensName}}":"{{scnensName}}","-":"-","-":"-","-PDF":"-PDF","{{$1}}":"{{$1}}","{{$1}}{{$2}}":"{{$1}}{{$2}}","{{$1}}":"{{$1}}","{{$1}}":"{{$1}}","":"","{{$1}}":"{{$1}}","":"","/":"/","":"","":"","{{$1}}":"{{$1}}","":"","":"","":"","{{$1}}{{$2}}":"{{$1}}{{$2}}","":"","...":"...",";":";","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","{{num}} ":"{{num}} ","{{num}} ":"{{num}} ","":""," {{num}} ":" {{num}} "," {{num}} ":" {{num}} "," {{num}} ":" {{num}} ","":"","":"","":"","":"","":"","":"","":"","{{num}}  {{date}} ":"{{num}}  {{date}} ","yyyyMMdd":"yyyyMMdd","":"","":"","":"","":"","":"","":"","":"","":"","recently-used":"","all-fonts":"",error:"","is-downloading-one":" {{font}}","is-downloading-multiple":" {{firstFont}} {{fontNumCN}}","vip-description":"","download-success-one":"1","download-success":"{{num}}",cancel:"","vip-custom-fonts":"","no-vip-fonts":"","add-styled-fonts":"","cannot-use-vip-font":"","collaborator-no-vip-privilege":"","vip-document-has-privilege":"","vip-can-share-privilege":"","cannot-clone":"","buy-vip-to-clone":"","buy-vip":"","expired-vip-prompt":"","normal-user-cannot-use-vip-font":"","can-use-all-font":"","non-owner-vip-prompt":"","vip-expired-cannot-use-vip-font":"","only-vip-can-use-font-modal-content":""}}}},function(e,t){e.exports=o},function(e,t){e.exports=i},function(e,t,n){n.r(t),n.d(t,"SupportedLanguages",(function(){return r})),n.d(t,"scL10nIniter",(function(){return v})),n.d(t,"$t",(function(){return y})),n.d(t,"detectors",(function(){return d})),n.d(t,"interpolation",(function(){return h})),n.d(t,"detection",(function(){return f})),n.d(t,"fallbackLng",(function(){return p}));var r,o=n(1),i=n(2),a=n.n(i),s=n(3),c=n.n(s),l=n(0),u=n.n(l);!function(e){e.enUS="en-US",e.zhCN="zh-CN",e.zhHK="zh-HK"}(r||(r={}));var d=new c.a;d.addDetector({name:"userAgent",lookup:function(){var e=navigator.userAgent.match(/language\/([a-zA-Z'-_]+)/i);if(e)return e[1].replace("_","-")}}),d.addDetector({name:"toggle",lookup:function(){if(u.a.isTencentDocsApp&&!u.a.isTencentDocsAppVersionAboveOrEqual("2.16.0"))return"zh-CN"}});var p={default:[r.zhCN],en:[r.enUS],zh:[r.zhCN],"zh-TW":[r.zhHK],"en-US":[r.zhCN],"zh-HK":[r.zhCN]},h={escapeValue:!1},f={order:["querystring","toggle","userAgent","cookie"],lookupCookie:"language",lookupQuerystring:"lng",caches:[]},g=a.a.createInstance();function v(){g.use(d).init({resources:o,defaultNS:"sc",fallbackLng:p,interpolation:h,detection:f})}var y=function(){return g.t.apply(g,arguments)||(arguments.length<=0?void 0:arguments[0])}}]))},48295:function(e,t,n){n.d(t,{QW:function(){return Qn},zW:function(){return se},z_:function(){return r},j9:function(){return j},rX:function(){return Me}});var r,o,i=n(13980),a=n(69438),s=n(87363),c=n.n(s),l=n(32230),u=n.n(l),d=n(26061),p=n(68656),h=n(15315),f=n(3139),g=n(42035),v=n(82010),y=n(28061),m=n(46885),b=n(8887),_=n(65425),C=n(16033),S=n(3422),w=n(34549),E=n(73557),x=n(27379),T=n(37700),R=n(64335),I=n(38298),P=n(87404),O=n(60608),k=n(86667),D=n.n(k),M=n(52739),A=n(83939),L=n(5593),N=n(90049),B=n(67190),F=n(66240),U=n(88560),H=n(14366);(o=r||(r={})).FILE="file",o.EDIT="edit",o.TOOLBAR_MODE="toolbar-mode";var j,G,V,W="POLICY_INFO_CHANGE",z="ACTIVE_MENU_CHANGE",K="HIDE_MENU",q="FILE_MENU_RED_DOT_CHANGE",Y="TITLE_CHANGE",Q="TITLE_CHANGE_WITH_REQUEST",Z="TITLE_EDITABLE_CHANGE",X="UPDATE_SAVE_TIPS",J="UPDATE_SAVE_TIPS_OFFLINE_TEXT",$="SHOW_COOPERATION",ee="HIDE_COOPERATION",te="COOPERATION_LOADED",ne="EDIT_VERSION_CHANGE",re="PERMISSION_CHANGE",oe="LOCAL_EDIT_CHANGED",ie="LOCAL_EDIT_SAVED",ae="AFTER_TITLE_CHANGED",se=Object.freeze({__proto__:null,POLICY_INFO_CHANGE:W,ACTIVE_MENU_CHANGE:z,HIDE_MENU:K,FILE_MENU_RED_DOT_CHANGE:q,TITLE_CHANGE:Y,TITLE_CHANGE_WITH_REQUEST:Q,TITLE_EDITABLE_CHANGE:Z,UPDATE_SAVE_TIPS:X,UPDATE_SAVE_TIPS_OFFLINE_TEXT:J,SHOW_COOPERATION:$,HIDE_COOPERATION:ee,COOPERATION_LOADED:te,EDIT_VERSION_CHANGE:ne,PERMISSION_CHANGE:re,LOCAL_EDIT_CHANGED:oe,LOCAL_EDIT_SAVED:ie,AFTER_TITLE_CHANGED:ae});!function(e){e.HOME="logo",e.BRAND="brand",e.TITLE="title",e.TITLE_BADGE="title-badge",e.EXTERNAL="external",e.LOCAL_FILE_LOGO="local-file-logo",e.LOCAL_FILE_SAVE="local-file-save",e.LOCAL_LOGIN_TIP="local-login-tip",e.LOCAL_FILE_TAG="local-file-tag",e.LOCAL_FILE_TRANSFER="local-file-transfer",e.LOCAL_FILE_UPLOAD="local-file-upload",e.LOCAL_TITLE="local-title",e.LOCAL_SAVE_TIPS="local-save-tips",e.LOCAL_LOGIN_BUTTON="local-login-button",e.TENCENT_MEETING="tencent-meeting-presentation",e.LOGIN_TIP="login-tip",e.CERTIFICATION="certification",e.SUBSCRIBE="subscribe",e.SUBSCRIPTION_NOTIFICATION="subscription-notification",e.READONLY_TIPS="readonly-tips",e.BADGE="badge",e.COLLECT="collect",e.MOVE="move",e.SAVE_TIPS="save-tips",e.COLLABORATION="collaboration",e.QQ_GROUP_AIO="qq-group-aio",e.ADD_MEMBER="add-member",e.ALL_MEMBERS="all-members",e.DISCUSSION="discussion",e.FILE_MENU="file-menu",e.EDIT_MENU="edit-menu",e.RELATE_FORM_MENU="relate-form-menu",e.PRESENTATION="presentation",e.ADDON="addon",e.AUTH="auth",e.SHARE="share",e.CONVERT_TO_ONLINE_DOCS="convert-to-online-docs",e.FILE_TYPE_ICON="file_type_icon",e.GENERATE_FORM="generate_form",e.PLAY_PRESENTATION="play-presentation",e.EXPORT_TO_LOCAL="export-to-local",e.SHOW_SEARCH_REPLACE="show-search-replace",e.EXPORT_TO_DRIVE="export-to-drive",e.TRANSFER_TO_IMAGE="transfer-to-image",e.TRANSFER_TO_PDF="transfer-to-pdf",e.TRANSFER_TO_WORD="transfer-to-word",e.TRANSFER_TO_ONLINE_DOCS="transfer-to-online-docs",e.ACCOUNT_AVATAR="account-avatar",e.LOGIN="login",e.TOOLBAR_MODE="toobar-mode",e.DIVIDER="divider",e.PUSHER="pusher",e.EXPORT_RESUME="export-resume",e.RESUME_VIP_TIPS="resume-vip-tips"}(j||(j={})),function(e){e.PLATFORM_B="doc.weixin.qq.com",e.PLATFORM_C="docs.qq.com"}(G||(G={})),function(e){e.QQ="qq",e.WX="wx",e.WX_WORK="wx-work",e.WW="ww",e.QFYF="qfyf"}(V||(V={}));var ce,le,ue=function(){var e=(0,i.getLoginType)();return e===V.WW||e===V.WX_WORK},de=window.location.hostname===G.PLATFORM_B,pe=window.location.hostname===G.PLATFORM_C,he=function(){return ue()&&pe},fe={name:"docs-component-account-avatar",loadType:a.LoadType.EAGER},ge={name:"docs-component-collaboration",loadType:a.LoadType.ON_DEMAND},ve={name:"docs-component-collect",loadType:a.LoadType.ON_DEMAND,containerId:"docs-component-collect"},ye={name:"docs-component-convert-to-online-docs",loadType:a.LoadType.ON_DEMAND},me={name:"docs-component-cooperation-permission",loadType:a.LoadType.ON_DEMAND},be={name:"docs-component-group-tips",loadType:a.LoadType.ON_DEMAND,containerId:"docs-component-group-tips"},_e={name:"docs-component-import",loadType:a.LoadType.ON_DEMAND};!function(e){e[e.Unknown=0]="Unknown",e[e.DocList=1]="DocList",e[e.DetailPage=2]="DetailPage",e[e.CloudService=3]="CloudService"}(ce||(ce={})),function(e){e[e.UPLOAD_TO_CLOUD=101]="UPLOAD_TO_CLOUD",e[e.PERSONALIZED_DRESS=102]="PERSONALIZED_DRESS",e[e.CONVERT_TO_ONLINE=103]="CONVERT_TO_ONLINE"}(le||(le={}));var Ce={name:"docs-component-login",loadType:a.LoadType.ON_DEMAND},Se={name:"docs-component-mini-list",loadType:a.LoadType.ON_DEMAND,containerId:"docs-component-mini-list"},we={name:"docs-component-readonly-tips",loadType:a.LoadType.ON_DEMAND,containerId:"titlebar-readonly-tip"},Ee={name:"docs-component-save-tips",loadType:a.LoadType.ON_DEMAND,containerId:"docs-component-save-tips"},xe={name:"docs-component-share",loadType:a.LoadType.ON_DEMAND},Te={name:"docs-component-subscribe",loadType:a.LoadType.ON_DEMAND},Re={name:"docs-component-subscription-notification",loadType:a.LoadType.ON_DEMAND},Ie={name:"docs-component-title",loadType:a.LoadType.EAGER,containerId:"docs-component-title"},Pe={name:"docs-component-wedrive-file-selector",loadType:a.LoadType.EAGER,containerId:"docs-component-wedrive-file-selector"},Oe=[ve,Se,Re,Ie,Pe],ke=[fe,ge,ye,me,be,Ce,Se,we,Te,_e,Ee,xe,Ie],De=function(){function e(){this.extensionService={},this.domainService={},this.applicationService={}}return e.prototype.updateExtensionService=function(e){this.extensionService=e,this.scanAndHandleExtensions()},e.prototype.updateDomainService=function(e){this.domainService=e},e.prototype.updateApplicationService=function(e){this.applicationService=e},e.prototype.scanAndHandleExtensions=function(){var e,t=de?Oe:ke;null===(e=this.extensionService)||void 0===e||e.scanAndHandleExtensions(t)},e}(),Me=new De,Ae=function(){function e(){this.rangeAuthApi={}}return e.prototype.setProps=function(e){var t=e.rangeAuthApi,n=e.shareConfig;void 0!==t&&(this.rangeAuthApi=t),void 0!==n&&(this.shareConfig=n)},e}(),Le=new Ae,Ne=[j.HOME,j.DIVIDER,j.TITLE,j.BADGE,j.PUSHER,j.COLLABORATION,j.QQ_GROUP_AIO,j.FILE_MENU,j.AUTH,j.ADDON,j.CONVERT_TO_ONLINE_DOCS,j.SHARE,j.ACCOUNT_AVATAR],Be=[j.FILE_TYPE_ICON,j.TITLE,j.PUSHER,j.GENERATE_FORM,j.PLAY_PRESENTATION,j.EXPORT_TO_LOCAL,j.SHOW_SEARCH_REPLACE,j.EXPORT_TO_DRIVE,j.TRANSFER_TO_IMAGE,j.TRANSFER_TO_PDF,j.TRANSFER_TO_WORD,j.TRANSFER_TO_ONLINE_DOCS],Fe=function(e,t){return Fe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},Fe(e,t)};function Ue(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Fe(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var He=function(){return He=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},He.apply(this,arguments)};function je(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}function Ge(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function Ve(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function We(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}}var ze,Ke,qe=function(){function e(e){var t=this;this.titlebarService=e,this.loadAccountAvatar=function(e){return Ve(t,void 0,void 0,(function(){var t;return We(this,(function(n){switch(n.label){case 0:return t=document.getElementById(e),[4,Me.extensionService.getExtension(fe.name)];case 1:return n.sent().show({container:t,isSquare:!0}),this.titlebarService.setHoverActive(!1),[2]}}))}))}}return e=je([(0,p.L)(),Ge("design:paramtypes",[h.M])],e)}(),Ye="self-info",Qe=function(e){function t(t){var n=e.call(this,t)||this;return n.networkChange=function(e){"online"===e?!n.state.online&&n.setState({online:!0}):n.state.online&&n.setState({online:!1})},n.state={online:E.network.isOnline},n.avatarFeature=f.Am.get(qe),n}return Ue(t,e),t.prototype.componentDidMount=function(){E.network.changeEnd(this.networkChange),this.avatarFeature.loadAccountAvatar(Ye)},t.prototype.componentWillUnmount=function(){E.network.remove(this.networkChange)},t.prototype.render=function(){var e,t;this.state.online;var n=(0,x.isLogin)(),r=null===(t=null===(e=Me.applicationService.accountApplication)||void 0===e?void 0:e.userInfo)||void 0===t?void 0:t.userPic,o=r?{backgroundImage:"url(".concat(r,")"),backgroundSize:"28px 28px"}:{},i=u()({"user-info-wrap":!de,"user-info-ent-wrap":de});return c().createElement(c().Fragment,null,n?c().createElement(c().Fragment,null,c().createElement(d.default,{style:{margin:"2px 12px 2px -4px",height:"24px",width:"1px",opacity:.06,boxSizing:"border-box",borderRight:"1px solid rgb(0, 0, 0)",verticalAlign:"top",display:"inline-block"}}),c().createElement("div",{className:i},c().createElement("div",{className:"user-info-fake",style:o},c().createElement("div",{className:"user-info-container",id:Ye})))):c().createElement("div",{id:Ye,className:"login-btn-container"},c().createElement("div",{style:{width:"108px"}})))},t}(c().Component),Ze={name:j.ACCOUNT_AVATAR,content:c().createElement(Qe,null),preventHide:!0,shouldDisableWhenPrinting:!0,style:{marginRight:12}};!function(e){e[e.SELF=0]="SELF",e[e.COOPERATION=1]="COOPERATION",e[e.VIEWABLE=2]="VIEWABLE",e[e.EDITABLE=3]="EDITABLE"}(ze||(ze={})),function(e){e.DOC="doc",e.SHEET="sheet",e.SLIDE="slide",e.FORM="form",e.PDF="pdf",e.MIND="mind",e.FLOWCHART="flowchart",e.DRIVE="drive",e.REC="rec",e.SMARTCANVAS="smartcanvas"}(Ke||(Ke={}));var Xe,Je=[Ke.DRIVE,Ke.PDF,Ke.REC],$e=function(){function e(){var e=this;this.updatePolicyInfo=function(t,n){e.updatePolicyAndMemberList(t,n)},this.registerListener=function(){var t;null===(t=window.SLR)||void 0===t||t.listen("TX-AUTH-UPDATED",e.refreshPolicy),e.onAuthChanged(),Me.domainService.docMetaDomain.docMetaEntity.padInfo.padType===Ke.DOC&&e.eventEmitter.listen("$policyUpdated",(function(){var e;null===(e=window.SLR)||void 0===e||e.dispatch("TX-AUTH-UPDATED")}))},this.onAuthChanged=function(){Me.domainService.authDomain.authAggregate.authInfoEntity.onAuthChanged(e.refreshPolicy)},this.getAuthInfo=function(){return Ve(e,void 0,void 0,(function(){var e,t,n,r,o,i;return We(this,(function(a){switch(a.label){case 0:return e=Me.domainService.docMetaDomain.docMetaEntity.userAuthInfo,t=e.isOwner,n=e.isAdmin,t||n?[4,Me.domainService.authDomain.authAggregate.authInfoEntity.fetchAuthInfo()]:[2,{memberList:[],policy:ze.SELF}];case 1:return 0!==(null==(r=a.sent().resData)?void 0:r.retcode)?[2,{memberList:[],policy:ze.SELF}]:(o=r.data.policy,i=r.data.memlist||r.data.memberList||[],[2,{policy:o,memberList:i}])}}))}))},this.refreshPolicy=function(){return Ve(e,void 0,void 0,(function(){var e,t,n;return We(this,(function(r){switch(r.label){case 0:return[4,this.getAuthInfo()];case 1:return e=r.sent(),t=e.policy,n=e.memberList,this.updatePolicyAndMemberList(t,n),[2]}}))}))},this.policy=Me.domainService.authDomain.authAggregate.authInfoEntity.documentPrivilege,this.memberList=[],this.registerListener(),this.refreshPolicy()}return e.prototype.getPolicyAndMemberList=function(){return{policy:this.policy,memberList:this.memberList}},e.prototype.onPolicyInfoChange=function(e){return this.eventEmitter.listen(W,e)},e.prototype.updatePolicyAndMemberList=function(e,t){this.policy=e,this.memberList=t,this.eventEmitter.emit(W,{policy:e,memberList:t})},je([(0,f.tB)(),Ge("design:type",g.v)],e.prototype,"eventEmitter",void 0),e=je([(0,p.L)(),Ge("design:paramtypes",[])],e)}(),et=function(e){return Ve(void 0,void 0,void 0,(function(){var t,r,o,i,a,s,c,l,u,d,p,h,f,g,v,y,m,b;return We(this,(function(_){switch(_.label){case 0:return[4,Me.extensionService.getExtension(xe.name)];case 1:return t=_.sent(),r=Me.domainService.docMetaDomain.docMetaEntity,o=r.padInfo,i=o.domainId,a=o.padId,s=o.padType,c=r.createInfo.creatorDomain,l=r.userAuthInfo,u=l.isAdmin,d=l.isCreator,p=(n.g.clientVars||{}).concretPadType,h=s===Ke.DRIVE?p:s,f=function(){return Me.domainService.docMetaDomain.docMetaEntity.titleInfo.title},g=function(){var e,t;return null===(t=null===(e=Me.domainService.fileInfoDomain)||void 0===e?void 0:e.fileMetaEntity)||void 0===t?void 0:t.mimeType},v=d||u,y=function(){var e=window.clientVars.shortLink||window.location.href.split("#")[0];if(-1===e.indexOf("?"))return e;var t=e.split("?")[1],n=e.split("?")[0];return t?n:e}(),m={mind:(0,R.$t)(""),flowchart:(0,R.$t)(""),drive:(0,R.$t)("")},b={mind:!1,flowchart:!1,drive:!0},t.show(He({invokeFrom:"detail",padId:a,shareLink:y,shareTitle:f,shareDocType:h,domainId:i,creatorDomain:c,havePermission:v,canAuthAdmin:s===Ke.FORM?d||u:void 0,advLinkText:m[s],showTransfer:b[s],mimeType:g(),onAuthUpdated:function(t){null==e||e(t)},onClose:function(){},isToBGrayUser:ue(),rangeAuthApi:Le.rangeAuthApi},Le.shareConfig)),[2]}}))}))},tt=function(e){return Ve(void 0,void 0,void 0,(function(){return We(this,(function(t){return[2,et(e)]}))}))};function nt(e){var t=new RegExp("(?:^|;+|\\s+)".concat(e,"=([^;]*)")),r="";return n.g.document&&(r=n.g.document.cookie.match(t)),r?decodeURIComponent(r[1]):""}function rt(e){if(!window)return"";var t,n=window.location;return n&&(t=n.search.match(new RegExp("(\\?|&)".concat(e,"=([^&]*)(#|&|$)")))),t?decodeURIComponent(t[2]):""}function ot(){var e=nt("dev_route_id"),t=rt("magic");return!(!e||!t)}function it(e){void 0===e&&(e={}),function(e,t){var n,r,o;void 0===e&&(e={});var i=e.entry,a=e.from,s=e.title;delete e.entry,delete e.from,delete e.title;var c={dev_route_id:nt("dev_route_id")||""},l=(null===(n=window.__DWS_INFO__)||void 0===n?void 0:n.releaseVersion)||window.__globalReleaseVersion;l&&(c.version=l);var u=Object.assign({table:"dc03111",report_type:101,source2:i,source3:a,obj2:s,ver8:JSON.stringify(c)},e);u.source3&&""!==u.source3&&void 0!==u.source3||(u.source3=null!==(r=localStorage.getItem("tdsourcetag"))&&void 0!==r?r:null!==(o=nt("adtag"))&&void 0!==o?o:""),(0,I.tdw)(u,{showLog:ot(),immediate:t})}(e,!1)}!function(e){e.ROOT="Root",e.SHARE="Share"}(Xe||(Xe={}));var at,st={paddingTop:0,height:"100%"},ct=function(){function e(e){var t=this;this.policyInfoFeature=e,this.isAuthDrawerOpened=!1,this.handleAuthBtnClick=function(){it({module:"cooperation_button",opername:"doc_menubar",action:"click",ver12:"new"}),t.isDrawerOpen?t.handleAuthHide():t.handleAuthShow({invokeFrom:Xe.ROOT})},this.registerListener=function(){window.addEventListener("changePermission",t.handleChangePermission),t.showCooperationEvent=t.eventEmitter.listen($,(function(){return t.onShowCooperation()})),t.hideCooperationEvent=t.eventEmitter.listen(ee,(function(){return t.handleAuthHide()}))},this.unregisterListener=function(){var e,n;window.removeEventListener("changePermission",t.handleChangePermission),null===(e=t.showCooperationEvent)||void 0===e||e.unsubscribe(),null===(n=t.hideCooperationEvent)||void 0===n||n.unsubscribe()},this.handleChangePermission=function(){return Ve(t,void 0,void 0,(function(){return We(this,(function(e){switch(e.label){case 0:return[4,Me.extensionService.getExtension(xe.name)];case 1:return e.sent().hide(),this.handleAuthShow({invokeFrom:Xe.SHARE}),[2]}}))}))},this.onShowCooperation=function(){t.isDrawerOpen?t.eventEmitter.emit(te):t.handleAuthShow({invokeFrom:Xe.ROOT})},this.handleAuthShow=function(e){var n=e.invokeFrom,r=Me.domainService.docMetaDomain.docMetaEntity,o=r.padInfo.padType,i=r.userAuthInfo,a=i.isCreator,s=i.isAdmin;t.getCooperationPermission(),t.drawerService.setRightDrawerMode(v.$t.FLOAT),t.drawerService.showRightDrawer({name:me.name,usePersistContent:me.name,style:st,onOpen:function(){return Ve(t,void 0,void 0,(function(){var e,t,r=this;return We(this,(function(i){switch(i.label){case 0:return[4,this.getCooperationPermission()];case 1:return[4,i.sent().show({container:document.getElementById(me.name),invokeFrom:n,updatePolicyInfo:this.policyInfoFeature.updatePolicyInfo,mimeType:null===(t=null===(e=Me.domainService.fileInfoDomain)||void 0===e?void 0:e.fileMetaEntity)||void 0===t?void 0:t.mimeType,showTransfer:o===Ke.FORM?a:void 0,canAuthAdmin:o===Ke.FORM?a||s:void 0,shareDocType:o,onShare:function(){return tt()},onClose:function(){r.handleAuthHide()},rangeAuthApi:Le.rangeAuthApi})];case 2:return i.sent(),this.eventEmitter.emit(te),[2]}}))}))}}),t.isAuthDrawerOpened=!0},this.getCooperationPermission=function(){return Ve(t,void 0,void 0,(function(){return We(this,(function(e){switch(e.label){case 0:return[4,Me.extensionService.getExtension(me.name)];case 1:return[2,e.sent()]}}))}))},this.handleAuthHide=function(){t.drawerService.closeRightDrawer(),t.isAuthDrawerOpened=!1}}return Object.defineProperty(e.prototype,"isDrawerOpen",{get:function(){return this.drawerService.isRightOpening(me.name)},enumerable:!1,configurable:!0}),je([(0,f.tB)(),Ge("design:type",v.zv)],e.prototype,"drawerService",void 0),je([(0,f.tB)(),Ge("design:type",g.v)],e.prototype,"eventEmitter",void 0),e=je([(0,p.L)(),Ge("design:paramtypes",[$e])],e)}(),lt=function(e){function t(t){var n=e.call(this,t)||this;n.initDrawerServiceContent=function(){n.drawerService.addPersistContentToRightDrawer({name:me.name,content:c().createElement("div",{id:me.name,style:{height:"100%",overflow:"hidden"}})})},n.networkChange=function(e){"online"===e?!n.state.online&&n.setState({online:!0}):n.state.online&&n.setState({online:!1})},n.updatePolicyInfo=function(e,t){n.setState({policy:e,memberList:t})},n.getAuthIcon=function(){var e="tip-lock";switch(n.state.policy){case ze.SELF:e="tip-lock";break;case ze.COOPERATION:e="tip-cooperation";break;case ze.VIEWABLE:e="tip-eye";break;case ze.EDITABLE:e="tip-edit";break;default:e="tip-lock"}return e},n.getAuthHoverText=function(){var e="";if(Me.domainService.docMetaDomain.docMetaEntity.padInfo.padType===Ke.FORM)return n.getFormAuthHoverText();switch(n.state.policy){case ze.SELF:e=(0,R.$t)("");break;case ze.COOPERATION:e=n.getSummary();break;case ze.VIEWABLE:e=(0,R.$t)("");break;case ze.EDITABLE:e=(0,R.$t)("");break;default:return""}return e},n.getFormAuthHoverText=function(){var e;return((e={})[ze.COOPERATION]=(0,R.$t)(""),e[ze.EDITABLE]=(0,R.$t)(""),e)[n.state.policy]||""},n.getSummary=function(){var e=(0,R.$t)("");try{var t=n.state.memberList;if((null==t?void 0:t.length)>0){var r=t[0].nick||"";r.length>8&&(r=r.substr(0,8),r+="..."),e=t.length>1?(0,R.$t)("{{memNames}}{{listLength}}",{memNames:r,listLength:t.length}):(0,R.$t)("{{memNames}}",{memNames:r})}}catch(e){console.error("getSummary",e)}finally{return e}},n.drawerService=f.Am.get(v.zv),n.authBtnFeature=f.Am.get(ct),n.initDrawerServiceContent();var r=f.Am.get($e);n.authBtnFeature.registerListener(),n.onPolicyInfoChange=r.onPolicyInfoChange((function(e){var t=e.policy,r=e.memberList;n.updatePolicyInfo(t,r)}));var o=r.getPolicyAndMemberList(),i=o.policy,a=o.memberList;return n.state={online:E.network.isOnline,policy:i,memberList:a},n}return Ue(t,e),t.prototype.componentDidMount=function(){E.network.changeEnd(this.networkChange)},t.prototype.componentWillUnmount=function(){this.authBtnFeature.unregisterListener(),this.onPolicyInfoChange.unsubscribe(),E.network.remove(this.networkChange)},t.prototype.render=function(){var e=this.getAuthIcon(),t=this.getAuthHoverText();return c().createElement(T.default,{placement:"bottom",title:t},c().createElement("button",{disabled:!1===this.state.online,id:"header-btn-auth",className:"auth-btn btn-normal",onClick:this.authBtnFeature.handleAuthBtnClick},c().createElement("div",{className:e})))},t}(c().Component),ut={name:j.AUTH,content:c().createElement(lt,null),preventHide:!0,shouldDisableWhenPrinting:!0,style:{fontSize:0}};!function(e){e.OPEN_LOGIN_BOX="OPEN_LOGIN_BOX",e.OPEN_LOGIN_BOX_FOR_QQ_QUICK_LOGIN="OPEN_LOGIN_BOX_FOR_QQ_QUICK_LOGIN"}(at||(at={})),function(e){function t(t){var n=e.call(this,t)||this;return n.networkChange=function(e){"online"===e?!n.state.online&&n.setState({online:!0}):n.state.online&&n.setState({online:!1})},n.handleLogin=function(){return Ve(n,void 0,void 0,(function(){return We(this,(function(e){switch(e.label){case 0:return[4,Me.extensionService.getExtension(Ce.name)];case 1:return e.sent().show({usageScenario:at.OPEN_LOGIN_BOX}),[2]}}))}))},n.state={online:E.network.isOnline},n}Ue(t,e),t.prototype.componentDidMount=function(){E.network.changeEnd(this.networkChange)},t.prototype.componentWillUnmount=function(){E.network.remove(this.networkChange)},t.prototype.render=function(){return c().createElement(c().Fragment,null,c().createElement(P.default,{type:"primary",disabled:!1===this.state.online,id:"header-login-btn",className:"header-login-button",onClick:this.handleLogin},(0,R.$t)("")))}}(c().Component);var dt,pt=(0,s.lazy)((function(){return n.e(7709).then(n.bind(n,57709))})),ht={name:j.BADGE,content:c().createElement((function(){var e=this,t=Me.domainService.docMetaDomain.docMetaEntity,n=t.padInfo,r=n.domainId,o=n.padId,i=n.padType,a=t.createInfo.isCreator,s=t.titleInfo.title,l=Me.domainService.accountDomain.accountAggregate.userInfo,u=Me.domainService.authDomain.authAggregate.authInfoEntity.isOwner,d=(0,x.isLogin)();return c().createElement("div",{className:"badge-container"},c().createElement(c().Suspense,{fallback:c().createElement("div",null)},c().createElement(pt,{domainId:r,localPadId:o,isCreator:a,padType:i,padTitle:s,isLogin:d,isOwner:u,doLogin:function(){return Ve(e,void 0,void 0,(function(){return We(this,(function(e){switch(e.label){case 0:return[4,Me.extensionService.getExtension(Ce.name)];case 1:return e.sent().show({usageScenario:at.OPEN_LOGIN_BOX}),[2]}}))}))},user:l,isToBUser:he()})))}),null),preventHide:!0,shouldDisableWhenPrinting:!1},ft=function(){if((0,i.getLoginType)()!==V.QQ)return!1;var e=rt("groupUin")||rt("group_code"),t=rt("friendUin");return!!e||!!t},gt=function(){function e(e){var t=this;this.policyInfoFeature=e,this.init=function(){var e=document.getElementById("otherusersComponent"),n=document.getElementById("otherusersDivider");e&&n&&(t.container=e,t.divider=n,t.initCollaboration(),t.initEvent())},this.fixWidth=function(e){var n,r;null===(n=t.collabListInterfaces)||void 0===n||n.fixWidth(e),null===(r=t.collabListInterfaces)||void 0===r||r.hideMore()},this.initCollaboration=function(){return Ve(t,void 0,void 0,(function(){var e,t,n,r,o=this;return We(this,(function(i){return this.isInit||!function(){var e,t;return(null===(t=null===(e=Me.domainService)||void 0===e?void 0:e.authDomain)||void 0===t?void 0:t.authAggregate.authInfoEntity.documentPrivilege)!==ze.SELF}()?[2]:(e=(null!==(r=Me.domainService.collaborateDomain)&&void 0!==r?r:Me.extensionService.dependentServiceCombinder.collaborateDomain).collaborateAggregate,t=e.collabAllInfoList,n=e.onCollabAllInfoListUpdated,t.length>1?(this.showCollaboration(),[2]):(n((function(){o.showCollaboration()})),[2]))}))}))},this.showCollaboration=function(){return Ve(t,void 0,void 0,(function(){var e;return We(this,(function(t){switch(t.label){case 0:return this.isInit?[2]:[4,Me.extensionService.getExtension(ge.name)];case 1:return(e=t.sent()).show({container:this.container,getClientVars:function(){return n.g.clientVars},onRenderContent:this.onRenderContent,onDestroyContent:this.onDestroyContent,getInterfaces:this.getCollabListInterfaces,eventNotice:this.eventNotice}),this.isInit=!!e,[2]}}))}))},this.onRenderContent=function(){t.divider&&(t.divider.style.display="inline-block")},this.onDestroyContent=function(){t.divider&&(t.divider.style.display="none")},this.getCollabListInterfaces=function(e){t.collabListInterfaces=e,t.containerShow(),t.bindEvent()}}return e.prototype.initEvent=function(){var e=this;this.policyInfoFeature.onPolicyInfoChange((function(){e.initCollaboration()}))},e.prototype.containerShow=function(){this.container&&(this.container.style.display="inline-block")},e.prototype.bindEvent=function(){var e=this;window.addEventListener("resize",(function(){var t;null===(t=e.collabListInterfaces)||void 0===t||t.hideMore()}))},e.prototype.eventNotice=function(){},e=je([(0,p.L)(),Ge("design:paramtypes",[$e])],e)}(),vt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ue(t,e),t.prototype.componentDidMount=function(){this.userLineFeature=f.Am.get(gt),this.userLineFeature.init()},t.prototype.render=function(){return c().createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"}},c().createElement("div",{style:{marginRight:8},id:"otherusersComponent",className:"other-users-component"}),c().createElement("div",{id:"otherusersDivider",style:{display:"none"}},c().createElement(d.default,{style:{margin:"0px 4px",height:"24px",width:"1px",opacity:.06,borderRight:"1px solid rgb(0, 0, 0)",verticalAlign:"top",display:"inline-block"}})))},t}(c().Component),yt={name:j.COLLABORATION,content:c().createElement(vt,null),preventHide:!0,shouldDisableWhenPrinting:!0,style:{marginLeft:0,marginRight:0}};function mt(){return!(!rt("local_edit")||!D().isElectronTencentDocsClient)}function bt(){return!!rt("localFilePath")||(M.default.show({message:(0,R.$t)(""),type:"info",duration:3e3,closable:!0}),!1)}function _t(){var e;return null!==(e=new URL(location.href).searchParams.get("localFilePath"))&&void 0!==e?e:""}!function(e){e.ONLINE="online",e.OFFLINE="offline"}(dt||(dt={}));var Ct,St=function(){var e=(0,s.useState)(E.network.isOnline),t=e[0],n=e[1];return(0,s.useEffect)((function(){var e=function(e){e===dt.ONLINE?n(!0):n(!1)};return E.network.changeEnd(e),function(){E.network.remove(e)}}),[]),{isOnline:t}};!function(e){e.detail="detail"}(Ct||(Ct={}));var wt,Et=function(){var e=(0,O.default)((function(){return Ve(void 0,void 0,void 0,(function(){return We(this,(function(e){switch(e.label){case 0:return mt()&&bt()?[4,Me.extensionService.getExtension(_e.name)]:[2];case 1:return e.sent().import({localFilePath:_t(),properties:{guideCloudPreDialog:le.CONVERT_TO_ONLINE},report:{ver7:ce.DetailPage,aidPosition:Ct.detail}}),[2]}}))}))}),300,{leading:!0,trailing:!1}),t=St().isOnline;return c().createElement(P.Button,{type:"default",size:"small",className:"convert-to-online-btn",onClick:e,disabled:!t},(0,R.$t)(""))},xt={name:j.CONVERT_TO_ONLINE_DOCS,content:c().createElement(Et,null),preventHide:!0,shouldDisableWhenPrinting:!0,style:{marginLeft:4,marginRight:8}},Tt={width:28,height:28,padding:2,boxSizing:"border-box",fontSize:0,borderRadius:"2px"},Rt={width:28,height:28,boxSizing:"border-box",fontSize:0,borderRadius:2,display:"flex",justifyContent:"center",alignItems:"center",marginRight:8,marginLeft:8,marginTop:2};!function(e){e.ADD_MEMBER="ADD_MEMBER",e.ALL_MEMBER="ALL_MEMBER",e.DISCUSSION="DISCUSSION",e.FILE="FILE",e.EDIT="EDIT",e.PRESENTATION="PRESENTATION",e.RELATE_FORM="RELATE_FORM"}(wt||(wt={}));var It,Pt,Ot=function(){function e(){var e=this;this.onActiveMenuChange=function(t){return e.eventEmitter.listen(z,t)},this.onFileMenuRedDotChange=function(t){return e.eventEmitter.listen(q,t)},this.updateActiveMenu=function(t){e.activeMenu=t,e.eventEmitter.emit(z,t)},this.getActiveMenu=function(){return e.activeMenu},this.mouseEnter=function(t){e.isAutoExpandDropdown&&e.updateActiveMenu(t)},this.registerHideMenu()}return e.prototype.toggleAutoExpandDropdownStatus=function(e){this.isAutoExpandDropdown=e},e.prototype.registerHideMenu=function(){var e=this;return this.eventEmitter.listen(K,(function(){return e.hideMenu()}))},e.prototype.hideMenu=function(){this.toggleAutoExpandDropdownStatus(!1),this.updateActiveMenu(void 0)},je([(0,f.tB)(),Ge("design:type",g.v)],e.prototype,"eventEmitter",void 0),e=je([(0,p.L)(),Ge("design:paramtypes",[])],e)}(),kt=function(e){function t(t){var n=e.call(this,t)||this;return n.initInjectService=function(){var e=f.Am.get(Ot);n.menuBarFeature=e},n.getFileBtn=function(){var e=n.state.activeMenu===wt.FILE,t=u()("titlebar-icon",{"titlebar-icon-more":!de,"titlebar-icon-wework-more":de});return c().createElement("div",{className:"titlebar-btn-container",ref:n.fileBtn},c().createElement(y.l,{align:"right",name:r.FILE,animated:!1,show:e,contentStyle:de?Rt:Tt,onClick:function(){n.menuBarFeature.toggleAutoExpandDropdownStatus(!0),n.menuBarFeature.updateActiveMenu(wt.FILE)},onMouseEnter:function(){n.menuBarFeature.mouseEnter(wt.FILE)},onDropdownClose:function(){n.menuBarFeature.toggleAutoExpandDropdownStatus(!1),n.menuBarFeature.updateActiveMenu(void 0)}},c().createElement(T.default,{disabled:e,title:(0,R.$t)(""),trigger:"hover"},c().createElement(A.ZP,{dot:n.state.showRedDot,offsetX:0,offsetY:0},c().createElement("div",{className:t})))))},n.initInjectService(),n.state={activeMenu:void 0,showRedDot:!1},n.fileBtn=c().createRef(),n}return Ue(t,e),t.prototype.componentDidMount=function(){var e=this;this.onActiveMenuChange=this.menuBarFeature.onActiveMenuChange((function(t){e.setState({activeMenu:t})})),this.onFileMenuRedDotChange=this.menuBarFeature.onFileMenuRedDotChange((function(t){e.setState({showRedDot:t})}))},t.prototype.componentWillUnmount=function(){this.onActiveMenuChange.unsubscribe(),this.onFileMenuRedDotChange.unsubscribe()},t.prototype.render=function(){return c().createElement("div",{className:"menubar-component"},this.getFileBtn())},t}(c().Component),Dt={name:j.FILE_MENU,content:c().createElement(kt,null),preventHide:!0,shouldDisableWhenPrinting:!0},Mt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.initMiniList=function(){return Ve(t,void 0,void 0,(function(){var e,t=this;return We(this,(function(n){switch(n.label){case 0:return[4,Me.extensionService.getExtension(Se.name)];case 1:return[4,(e=n.sent()).show({show:!0,isToC:pe,weworkTimelineGray:de,container:document.getElementById(Se.containerId)})];case 2:return n.sent(),e.onListVisibilityChange((function(e){e.currentVisibility?t.titlebarService.setHoverActive(!1):t.titlebarService.setHoverActive(!0)})),[2,e]}}))}))},t.handleMouseEnterHomeIcon=function(){return Ve(t,void 0,void 0,(function(){var e;return We(this,(function(t){switch(t.label){case 0:return this.miniListExtension||he()?[2]:(e=this,[4,this.initMiniList()]);case 1:return e.miniListExtension=t.sent(),[2]}}))}))},t.handleMouseEnterArrow=function(){return Ve(t,void 0,void 0,(function(){var e,t,n,r=this;return We(this,(function(o){switch(o.label){case 0:return this.miniListExtension?[2]:(e=this,[4,this.initMiniList()]);case 1:return e.miniListExtension=o.sent(),null===(n=null===(t=this.miniListExtension)||void 0===t?void 0:t.onListInited)||void 0===n||n.call(t,(function(){var e,t;null===(t=null===(e=r.miniListExtension)||void 0===e?void 0:e.showMiniList)||void 0===t||t.call(e)})),[2]}}))}))},t}return Ue(t,e),t.prototype.render=function(){return c().createElement(c().Fragment,null,c().createElement("div",null,c().createElement("div",{className:"pre-titlebar-mini-list",id:Se.containerId},c().createElement("div",{className:"titlebar-home".concat(de?"-enterprise":""),onMouseEnter:this.handleMouseEnterHomeIcon}),!he()&&c().createElement("div",{className:"titlebar-home-arrow",onMouseEnter:this.handleMouseEnterArrow}))))},je([(0,f.tB)(h.M),Ge("design:type",h.M)],t.prototype,"titlebarService",void 0),t}(s.Component),At={name:j.HOME,content:c().createElement(Mt,null),preventHide:!0,shouldDisableWhenPrinting:!1},Lt=function(e){function t(t){var n=e.call(this,{})||this;return n.state={online:!1,isShow:!1},n}return Ue(t,e),t.prototype.componentDidMount=function(){var e=this;ft()&&Me.extensionService.getExtension(be.name).then((function(t){return Ve(e,void 0,void 0,(function(){var e,n;return We(this,(function(r){switch(r.label){case 0:return(e=document.getElementById(be.containerId))&&t?[4,t.show({container:e})]:[2];case 1:return n=r.sent(),this.setState({isShow:n}),[2]}}))}))}))},t.prototype.render=function(){return c().createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},c().createElement("span",{style:{width:8,display:this.state.isShow?"flex":"none"}}),c().createElement("div",{id:be.containerId,className:"goto-group-aio"}),c().createElement("div",{style:{display:this.state.isShow?"flex":"none"},id:"qqgroup-info-divider"},c().createElement(d.default,{style:{margin:"6px 4px 6px 12px",height:"24px",width:"1px",opacity:.06,borderRight:"1px solid rgb(0, 0, 0)",verticalAlign:"top",display:"inline-block"}})))},t}(c().Component),Nt={name:j.QQ_GROUP_AIO,content:c().createElement(Lt,null),preventHide:!0,shouldDisableWhenPrinting:!0,style:{marginLeft:0,marginRight:0}},Bt=function(e){function t(t){var n=e.call(this,t)||this;return n.networkChange=function(e){"online"===e?!n.state.online&&n.setState({online:!0}):n.state.online&&n.setState({online:!1})},n.handleShare=function(){var e,t;if(it({opername:"doc_share",module:"share",action:"clk",ver6:"detail"}),null===(e=window.document.activeElement)||void 0===e||e.blur(),D().isMiniProgram){var n="/pages/sharePanel/sharePanel?url=".concat(encodeURIComponent(location.origin+location.pathname));null===(t=window.wx)||void 0===t||t.miniProgram.navigateTo({url:n})}else tt()},n.state={online:E.network.isOnline},n}return Ue(t,e),t.prototype.componentDidMount=function(){E.network.changeEnd(this.networkChange)},t.prototype.componentWillUnmount=function(){E.network.remove(this.networkChange)},t.prototype.render=function(){var e=this,t=u()({"titlebar-icon":!0,"titlebar-icon-wework-share":de});return c().createElement(c().Fragment,null,de?c().createElement("div",{className:"titlebar-btn-container",onClick:this.handleShare},c().createElement(T.default,{title:(0,R.$t)(""),trigger:"hover"},c().createElement("div",{className:t}))):c().createElement(P.default,{type:"primary",disabled:!1===this.state.online,className:"share-button",onClick:function(){e.handleShare()}},(0,R.$t)("")))},t}(c().Component),Ft={name:j.SHARE,content:c().createElement(Bt,null),preventHide:!0,shouldDisableWhenPrinting:!0,style:{marginLeft:4}},Ut=((It={})[Ke.DOC]=(0,R.$t)(""),It[Ke.SHEET]=(0,R.$t)(""),It[Ke.SLIDE]=(0,R.$t)(""),It[Ke.MIND]=(0,R.$t)(""),It[Ke.FLOWCHART]=(0,R.$t)(""),It[Ke.SMARTCANVAS]=(0,R.$t)(""),It),Ht=((Pt={})[Ke.DOC]=".docx",Pt[Ke.SHEET]=".xlsx",Pt[Ke.SLIDE]=".pptx",Pt[Ke.PDF]=".pdf",Pt),jt=function(){function e(){var e=this;this.onTitleChange=function(t){return e.eventEmitter.listen(Y,t)},this.onTitleChangeWithRequest=function(t){return e.eventEmitter.listen(Q,t)},this.onTitleEditableChange=function(t){return e.eventEmitter.listen(Z,t)},this.onDocFeatureLoaded=function(t){return e.eventEmitter.listenOnce("$featureLoaded",t)}}return je([(0,f.tB)(),Ge("design:type",g.v)],e.prototype,"eventEmitter",void 0),e=je([(0,p.L)()],e)}();function Gt(){var e,t;return(null===(t=null===(e=function(){var e,t,n;return(null===(t=null===(e=null===window||void 0===window?void 0:window.basicClientVars)||void 0===e?void 0:e.docInfo)||void 0===t?void 0:t.personalizeInfo)||(null===(n=null===window||void 0===window?void 0:window.clientVars)||void 0===n?void 0:n.personalizeInfo)||null}())||void 0===e?void 0:e.titleColor)||void 0===t?void 0:t.color)||void 0}var Vt,Wt,zt=function(){return Me.domainService.docMetaDomain.docMetaEntity.padInfo.padType},Kt=function(){var e=rt("localFilePath");return e&&e.includes(".")?".".concat(e.split(".").pop()):Ht[zt()]},qt=[Ke.DRIVE,Ke.PDF],Yt={name:j.TITLE,content:c().createElement((function(){var e=this,t=(0,s.useRef)(null),n=(0,s.useRef)(null),r=(0,s.useState)(0),o=r[0],i=r[1],a=(0,s.useState)(!0),l=a[0],d=a[1],p=Gt(),h=(0,s.useMemo)((function(){return function(){var e=Me.domainService.docMetaDomain.docMetaEntity.titleInfo.title,t=zt();return e||Ut[t]}()}),[]),v=zt(),y=function(){var e,t,n,r,o,i;if(mt())return Kt();var a=null!==(n=null===(t=null===(e=Me.domainService.fileInfoDomain)||void 0===e?void 0:e.fileMetaEntity)||void 0===t?void 0:t.ext)&&void 0!==n?n:"";return!(null===(i=null===(o=null===(r=Me.domainService.fileInfoDomain)||void 0===r?void 0:r.fileMetaEntity)||void 0===o?void 0:o.mimeType)||void 0===i?void 0:i.includes("addon"))&&a?".".concat(a):""}(),m=(mt()||qt.includes(v))&&!!y,b=function(e){var n,r;null===(n=t.current)||void 0===n||n.setCurTitle(e),null===(r=t.current)||void 0===r||r.updateFileExt()},_=function(e){var n;null===(n=t.current)||void 0===n||n.changeTitle({title:e,wait:!0}),S(e)},C=function(e){d(e)},S=function(e){document.title=e,f.Am.get(g.v).emit(ae)};(0,s.useEffect)((function(){var e,t=0;h&&(t=(null===(e=n.current)||void 0===e?void 0:e.getBoundingClientRect().width)||0,i(t)),w(t)}),[h,n]),(0,s.useEffect)((function(){var e=f.Am.get(jt),t=e.onTitleChange(b),n=e.onTitleChangeWithRequest(_),r=e.onTitleEditableChange(C);return function(){t.unsubscribe(),n.unsubscribe(),r.unsubscribe()}}),[]);var w=function(n){return Ve(e,void 0,void 0,(function(){var e;return We(this,(function(r){switch(r.label){case 0:return t.current?(E(),[2]):[4,Me.extensionService.getExtension(Ie.name)];case 1:return[4,(e=r.sent()).show({initialWidth:n,container:document.getElementById(Ie.containerId),afterTitleChanged:S,shouldShowSuffix:m})];case 2:return r.sent(),t.current=e,E(),[2]}}))}))},E=function(){var e,n,r;v===Ke.DOC&&window.isPublishedURL&&(f.Am.get(jt).onDocFeatureLoaded((function(){var e,n,r;null===(n=null===(e=t.current)||void 0===e?void 0:e.setCurTitle)||void 0===n||n.call(e,null===(r=window.clientVars)||void 0===r?void 0:r.padTitle)})),null===(n=null===(e=t.current)||void 0===e?void 0:e.setCurTitle)||void 0===n||n.call(e,null===(r=window.clientVars)||void 0===r?void 0:r.padTitle))};return c().createElement("div",{id:Ie.containerId,className:u()("titlebar-input-title",{disabled:!l})},c().createElement("div",{className:"pre-title-container"},c().createElement("div",{className:"input-title-wrapper"},c().createElement("input",{"aria-autocomplete":"none",autoComplete:"off",className:u()("input-title",{"show-suffix":m}),disabled:!0,value:h,style:{width:o,color:p}}),c().createElement("span",{className:u()("fake-title",{"show-suffix":m}),style:{color:p},ref:n},h)),m&&c().createElement("div",{className:"title-suffix",style:{color:p}},y)))}),null),shrinkable:"continuous",preventHide:!0,priority:2,shouldDisableWhenPrinting:!1,style:{marginLeft:mt()?0:"8px",marginRight:0,fontSize:0}},Qt=[At,Yt,ht,yt,Nt,Dt,ut,xt,Ft,Ze],Zt=[{name:r.FILE,content:""}],Xt=function(){function e(){this.titlebarService=f.Am.get(h.M),this.canEdit=Me.domainService.authDomain.authAggregate.authInfoEntity.selfDocPrivilege.canEdit,this.canRead=Me.domainService.authDomain.authAggregate.authInfoEntity.selfDocPrivilege.canRead,this.officialAuthInfo=Me.domainService.docMetaDomain.docMetaEntity.ownerInfo.officialAuthInfo,this.registerOfficialAuthInfoChange(),this.registerPermissionChange()}return Object.defineProperty(e.prototype,"isLogin",{get:function(){return(0,x.isLogin)()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPcLocalEdit",{get:function(){return mt()},enumerable:!1,configurable:!0}),e.prototype.shouldHideHome=function(){return this.isPcLocalEdit},e.prototype.shouldHideTitleBadge=function(){if(!this.isLogin)return!0;var e=this.officialAuthInfo;return!!((null==e?void 0:e.nick)||(null==e?void 0:e.principal)||(null==e?void 0:e.credential))||!(!Me.domainService.docMetaDomain.docMetaEntity.createInfo.creatorCorpId&&he())},e.prototype.shouldHideReadonlyTips=function(){return!(!this.isPcLocalEdit&&this.canRead&&!this.canEdit)},e.prototype.shouldHideBadge=function(){return de||this.isPcLocalEdit},e.prototype.shouldHideCertification=function(){var e=this.officialAuthInfo;return this.isLogin?!((null==e?void 0:e.nick)||(null==e?void 0:e.principal)||(null==e?void 0:e.credential)):!(null==e?void 0:e.nick)},e.prototype.shouldHideSaveTips=function(){return this.canRead&&!this.canEdit},e.prototype.shouldHideCollaboration=function(){return this.isPcLocalEdit},e.prototype.shouldHideGroupTips=function(){return this.isPcLocalEdit},e.prototype.shouldHideAuthBtn=function(){var e=Me.domainService.authDomain.authAggregate.authInfoEntity,t=e.selfRole,n=e.isOwner,r=4294967295===t||2048===t;return!this.isLogin||de||!r&&!n||this.isPcLocalEdit},e.prototype.shouldHideFileMenu=function(){return!this.isLogin},e.prototype.shouldHideEditMenu=function(){return!this.isLogin||!this.canEdit},e.prototype.shouldHideShareBtn=function(){return!this.isLogin||this.isPcLocalEdit},e.prototype.shouldHideSubscribe=function(){return this.isPcLocalEdit},e.prototype.shouldHideLocalFileTag=function(){return!this.isPcLocalEdit},e.prototype.shouldHideLocalFileLogo=function(){return!this.isPcLocalEdit},e.prototype.shouldHideLocalFileSave=function(){return!this.isPcLocalEdit||!this.isLogin},e.prototype.shouldHideLocalLoginTip=function(){return!this.isPcLocalEdit||this.isLogin},e.prototype.shouldHideLocalFileTransfer=function(){return!this.isPcLocalEdit||!this.isLogin},e.prototype.shouldHideLocalFileUpload=function(){return!this.isPcLocalEdit||!this.isLogin},e.prototype.registerOfficialAuthInfoChange=function(){var e=this;Me.domainService.docMetaDomain.docMetaEntity.onOfficialAuthInfoChange((function(){e.officialAuthInfo=Me.domainService.docMetaDomain.docMetaEntity.ownerInfo.officialAuthInfo,e.titlebarService.$forceUpdate()}))},e.prototype.registerPermissionChange=function(){var e=this;f.Am.get(g.v).listen(re,(function(t){var n=t.canEdit,r=t.canRead;void 0!==n&&(e.canEdit=n),void 0!==r&&(e.canRead=r),e.titlebarService.$forceUpdate()}))},e}(),Jt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ue(t,e),t.prototype.shouldHideBadge=function(){return e.prototype.shouldHideBadge.call(this)},t.prototype.shouldHideSaveTips=function(){return e.prototype.shouldHideSaveTips.call(this)},t.prototype.shouldHideAuthBtn=function(){return e.prototype.shouldHideAuthBtn.call(this)},t.prototype.shouldHideFileMenu=function(){return e.prototype.shouldHideFileMenu.call(this)},t.prototype.shouldHideShareBtn=function(){return e.prototype.shouldHideShareBtn.call(this)},t.prototype.shouldHideConvertToOnlineBtn=function(){var e,t;return!this.isLogin||!(null===(t=null===(e=Me.domainService.fileInfoDomain)||void 0===e?void 0:e.fileMetaEntity)||void 0===t?void 0:t.canBeConvertedToOnlineDocs())||!this.getCanCopyDoc()},t.prototype.getCanCopyDoc=function(){return Me.domainService.authDomain.authAggregate.authInfoEntity.selfDocPrivilege.canCopyDoc},je([(0,m.b)(j.BADGE,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideBadge",null),je([(0,m.b)(j.SAVE_TIPS,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideSaveTips",null),je([(0,m.b)(j.AUTH,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideAuthBtn",null),je([(0,m.b)(j.FILE_MENU,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideFileMenu",null),je([(0,m.b)(j.SHARE,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideShareBtn",null),je([(0,m.b)(j.CONVERT_TO_ONLINE_DOCS,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideConvertToOnlineBtn",null),t=je([(0,b.Q)({titlebarItems:Qt,menuItems:Zt})],t)}(Xt),$t=(Object.freeze({__proto__:null,TITLEBAR_SCHEMA:Ne,TITLEBAR_SCHEMA_QQ_FILES:Be,TITLEBAR_CONFIGS:Qt,TitlebarController:Jt}),[j.HOME,j.DIVIDER,j.TITLE,j.READONLY_TIPS,j.BADGE,j.SAVE_TIPS,j.PUSHER,j.COLLABORATION,j.QQ_GROUP_AIO,j.FILE_MENU,j.PRESENTATION,j.AUTH,j.SHARE,j.ACCOUNT_AVATAR]),en=function(e){function t(t){var n=e.call(this,t)||this;return n.initInjectService=function(){var e=f.Am.get(Ot);n.menuBarFeature=e},n.getMoreBtn=function(){var e=n.state.activeMenu===wt.EDIT,t=u()("titlebar-icon",{"titlebar-icon-edit":!de,"titlebar-icon-wework-edit":de});return c().createElement("div",{className:"titlebar-btn-container",ref:n.moreBtn},c().createElement(y.l,{align:"right",name:r.EDIT,animated:!1,show:e,contentStyle:de?Rt:Tt,onClick:function(){n.menuBarFeature.toggleAutoExpandDropdownStatus(!0),n.menuBarFeature.updateActiveMenu(wt.EDIT)},onMouseEnter:function(){n.menuBarFeature.mouseEnter(wt.EDIT)},onDropdownClose:function(){n.menuBarFeature.toggleAutoExpandDropdownStatus(!1),n.menuBarFeature.updateActiveMenu(void 0)}},c().createElement(T.default,{disabled:e,title:(0,R.$t)(""),trigger:"hover"},c().createElement("div",{className:t}))))},n.initInjectService(),n.state={activeMenu:void 0},n.moreBtn=c().createRef(),n}return Ue(t,e),t.prototype.componentDidMount=function(){var e=this;this.onActiveMenuChange=this.menuBarFeature.onActiveMenuChange((function(t){e.setState({activeMenu:t})}))},t.prototype.componentWillUnmount=function(){this.onActiveMenuChange.unsubscribe()},t.prototype.render=function(){return c().createElement("div",{className:"menubar-component"},this.getMoreBtn())},t}(c().Component),tn={name:j.EDIT_MENU,content:c().createElement(en,null),preventHide:!0,shouldDisableWhenPrinting:!0},nn={name:j.READONLY_TIPS,content:c().createElement((function(){var e=this;(0,s.useEffect)((function(){t()}),[]);var t=function(){return Ve(e,void 0,void 0,(function(){var e;return We(this,(function(t){switch(t.label){case 0:return[4,Me.extensionService.getExtension(we.name)];case 1:return[4,(e=t.sent()).show({container:document.getElementById(we.containerId)})];case 2:return t.sent(),[2,e]}}))}))};return c().createElement("div",{id:we.containerId},c().createElement("div",{className:"readonly-container"},c().createElement("button",{type:"button",className:"readonly-button",disabled:!navigator.onLine},c().createElement("div",{className:"readonly-text"},(0,R.$t)("")),c().createElement("div",{className:"readonly-arrow"}))))}),null),preventHide:!0,shouldDisableWhenPrinting:!1,style:{marginRight:0}},rn=function(){function e(){var e=this;this.onUpdateSaveTips=function(t){return e.eventEmitter.listen(X,t)},this.onUpdateSaveTipsOfflineText=function(t){return e.eventEmitter.listen(J,t)},this.onLocalEditChanged=function(t){return e.eventEmitter.listen(oe,t)},this.onLocalEditSaved=function(t){return e.eventEmitter.listen(ie,t)}}return je([(0,f.tB)(),Ge("design:type",g.v)],e.prototype,"eventEmitter",void 0),e=je([(0,p.L)()],e)}(),on={name:j.SAVE_TIPS,content:c().createElement((function(){var e=this,t=(0,s.useRef)(null),n=Me.domainService.docMetaDomain.docMetaEntity.padInfo.padType,r=function(){return Ve(e,void 0,void 0,(function(){var e;return We(this,(function(t){switch(t.label){case 0:return[4,Me.extensionService.getExtension(Ee.name)];case 1:return[4,(e=t.sent()).show({container:document.getElementById(Ee.containerId),isReadableDoc:Je.includes(n)})];case 2:return t.sent(),[2,e]}}))}))},o=function(){var e;null===(e=t.current)||void 0===e||e.handleUpdate({isModifiedByUser:!0})},i=function(e){var n,r;null===(r=null===(n=t.current)||void 0===n?void 0:n.updateOfflineText)||void 0===r||r.call(n,e)},a=function(){var e;null===(e=t.current)||void 0===e||e.hideSaveTips()},l=function(){var e;null===(e=t.current)||void 0===e||e.showSaveTips()};return(0,s.useEffect)((function(){Ve(e,void 0,void 0,(function(){var e;return We(this,(function(n){switch(n.label){case 0:return e=t,[4,r()];case 1:return e.current=n.sent(),[2]}}))}))}),[]),(0,s.useEffect)((function(){var e=f.Am.get(rn),n=e.onUpdateSaveTips(o),r=e.onUpdateSaveTipsOfflineText(i),s=e.onLocalEditChanged(a),c=e.onLocalEditSaved(l);return function(){var e;n.unsubscribe(),r.unsubscribe(),s.unsubscribe(),c.unsubscribe(),null===(e=t.current)||void 0===e||e.clearHandleUpdate()}}),[]),c().createElement("div",{id:Ee.containerId},c().createElement("div",{style:{width:mt()?"57px":"350px"}}))}),null),preventHide:!0,shrinkable:"continuous",widthRange:[38,350],priority:1,shouldDisableWhenPrinting:!1,style:{marginLeft:0}},an=[At,Yt,nn,ht,on,yt,Nt,Dt,tn,ut,Ft,Ze],sn=[{name:r.FILE,content:""},{name:r.EDIT,content:""}],cn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ue(t,e),t.prototype.shouldHideReadonlyTips=function(){return e.prototype.shouldHideReadonlyTips.call(this)},t.prototype.shouldHideBadge=function(){return e.prototype.shouldHideBadge.call(this)},t.prototype.shouldHideSaveTips=function(){return e.prototype.shouldHideSaveTips.call(this)},t.prototype.shouldHideAuthBtn=function(){return e.prototype.shouldHideAuthBtn.call(this)},t.prototype.shouldHideFileMenu=function(){return e.prototype.shouldHideFileMenu.call(this)},t.prototype.shouldHideEditMenu=function(){return e.prototype.shouldHideEditMenu.call(this)},t.prototype.shouldHideShareBtn=function(){return e.prototype.shouldHideShareBtn.call(this)},je([(0,m.b)(j.READONLY_TIPS,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideReadonlyTips",null),je([(0,m.b)(j.BADGE,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideBadge",null),je([(0,m.b)(j.SAVE_TIPS,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideSaveTips",null),je([(0,m.b)(j.AUTH,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideAuthBtn",null),je([(0,m.b)(j.FILE_MENU,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideFileMenu",null),je([(0,m.b)(j.EDIT_MENU,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideEditMenu",null),je([(0,m.b)(j.SHARE,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideShareBtn",null),t=je([(0,b.Q)({titlebarItems:an,menuItems:sn})],t)}(Xt);Object.freeze({__proto__:null,TITLEBAR_SCHEMA:$t,TITLEBAR_CONFIGS:an,TitlebarController:cn}),function(e){e.titlebar="titlebar",e.back="back",e.logo="logo",e.verticalLine="verticalLine",e.certification="certification",e.presentation="presentation",e.title="title",e.collect="collect",e.move="move",e.collaborators="collaborators",e.auth="auth",e.readOnly="readOnly",e.rename="rename",e.saveTip="saveTip",e.share="share",e.saveState="saveState",e.playAction="playAction",e.remotePlay="remotePlay",e.account="account",e.login="login",e.mainMenu="mainMenu",e.fileMenu="fileMenu",e.customLogo="customLogo",e.collapseMenu="collapseMenu",e.notification="notification",e.external="external",e.layout="layout",e.relateFormMenu="relateFormMenu",e.localFileTag="localFileTag",e.localFileLogo="localFileLogo",e.localFileSave="localFileSave",e.localLoginTip="localLoginTip",e.localFileTransfer="localFileTransfer",e.localFileUpload="localFileUpload"}(Vt||(Vt={}));var ln=L.default.getInstance();function un(e){return e.filter((function(e){if(!pn[e])return!0;var t="titlebar.".concat(pn[e]);return!!ln.getConfig(t)}))}var dn,pn=((Wt={})[j.BRAND]=Vt.logo,Wt[j.HOME]=Vt.logo,Wt[j.TITLE]=Vt.title,Wt[j.EXTERNAL]=Vt.external,Wt[j.READONLY_TIPS]=Vt.readOnly,Wt[j.SAVE_TIPS]=Vt.saveState,Wt[j.COLLABORATION]=Vt.collaborators,Wt[j.FILE_MENU]=Vt.fileMenu,Wt[j.EDIT_MENU]=Vt.collapseMenu,Wt[j.RELATE_FORM_MENU]=Vt.relateFormMenu,Wt[j.PRESENTATION]=Vt.playAction,Wt[j.AUTH]=Vt.auth,Wt[j.SHARE]=Vt.share,Wt[j.ACCOUNT_AVATAR]=Vt.account,Wt[j.LOGIN]=Vt.login,Wt[j.LOCAL_FILE_TAG]=Vt.localFileTag,Wt[j.LOCAL_FILE_LOGO]=Vt.localFileLogo,Wt[j.LOCAL_FILE_SAVE]=Vt.localFileSave,Wt[j.LOCAL_LOGIN_TIP]=Vt.localLoginTip,Wt[j.LOCAL_FILE_TRANSFER]=Vt.localFileTransfer,Wt[j.LOCAL_FILE_UPLOAD]=Vt.localFileUpload,Wt),hn=un([j.HOME,j.DIVIDER,j.LOCAL_FILE_LOGO,j.TITLE,j.LOCAL_FILE_TAG,j.TITLE_BADGE,j.CERTIFICATION,j.BADGE,j.SAVE_TIPS,j.PUSHER,j.LOCAL_LOGIN_TIP,j.COLLABORATION,j.QQ_GROUP_AIO,j.FILE_MENU,j.PRESENTATION,j.AUTH,j.LOCAL_FILE_UPLOAD,j.SHARE,j.ACCOUNT_AVATAR]),fn=(0,s.lazy)((function(){return n.e(2362).then(n.t.bind(n,12362,23))})),gn=function(e){function t(t){var n=e.call(this,t)||this,r=Me.domainService.docMetaDomain.docMetaEntity.ownerInfo.officialAuthInfo;return n.state={officialAuthInfo:r},n}return Ue(t,e),t.prototype.renderNoLogin=function(){var e=this.state.officialAuthInfo;return e.nick?c().createElement(c().Suspense,{fallback:c().createElement("div",null)},c().createElement(fn,He({},e))):null},t.prototype.renderIsLogin=function(){var e=this.state.officialAuthInfo,t=!!((null==e?void 0:e.nick)||(null==e?void 0:e.principal)||(null==e?void 0:e.credential));return t?c().createElement(c().Suspense,{fallback:c().createElement("div",null)},c().createElement(fn,He({isCertification:t},e))):null},t.prototype.render=function(){return(0,x.isLogin)()?this.renderIsLogin():this.renderNoLogin()},t}(c().Component),vn={name:j.CERTIFICATION,content:c().createElement(gn,null),preventHide:!0,shouldDisableWhenPrinting:!1,style:{fontSize:0}},yn={name:j.LOCAL_FILE_LOGO,content:c().createElement((function(){var e=Me.domainService.docMetaDomain.docMetaEntity.padInfo.padType,t=(0,B.z$)(e,e!==Ke.PDF);return c().createElement(N.a,{mimeType:t,size:26})}),null),preventHide:!0,style:{marginRight:0}},mn={name:j.LOCAL_FILE_TAG,content:c().createElement((function(){return c().createElement("div",{className:"local-file-tag"},(0,R.$t)(""))}),null),preventHide:!0,style:{marginRight:"10px"}},bn={name:j.LOCAL_FILE_UPLOAD,content:c().createElement((function(){var e=St().isOnline,t=(0,O.default)((function(){return Ve(void 0,void 0,void 0,(function(){return We(this,(function(e){switch(e.label){case 0:return[4,Me.extensionService.getExtension(_e.name)];case 1:return e.sent().upload({localFilePath:_t(),properties:{guideCloudPreDialog:le.UPLOAD_TO_CLOUD},report:{ver7:ce.DetailPage,aidPosition:Ct.detail}}),[2]}}))}))}),300,{leading:!0,trailing:!1});return c().createElement(T.default,{placement:"bottom",title:(0,R.$t)(""),className:"local-file-upload-tooltip"},c().createElement("div",{className:u()("local-file-upload",{"local-file-upload-notOnline":!e}),onClick:function(){return Ve(void 0,void 0,void 0,(function(){return We(this,(function(n){return e&&bt()?(t(),[2]):[2]}))}))}},c().createElement("img",{src:"data:image/svg+xml,%3csvg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M16.4781 9.22937L16.5933 10.4511L17.7347 10.9019C19.0346 11.4153 20 12.7383 20 14.3333C20 16.3574 18.4627 17.915 16.654 17.9965L16.4801 18H15V20H16.5L16.716 19.9957C19.6534 19.8789 22 17.3884 22 14.3333C22 11.919 20.5345 9.85729 18.4693 9.04169C18.1497 5.65059 15.3753 3 12 3C8.62474 3 5.85035 5.65059 5.52998 9.04101C3.46549 9.85729 2 11.919 2 14.3333C2 17.4629 4.46243 20 7.5 20H9V18H7.5C5.62286 18 4 16.4151 4 14.3333C4 12.7383 4.96544 11.4149 6.26536 10.9009L7.40575 10.45L7.52111 9.22916C7.75 6.80683 9.71464 5 12 5C14.2853 5 16.2498 6.8067 16.4781 9.22937ZM11.0356 11L12.0355 10.0001L13.4497 11.4143L15.5711 13.5356L14.1569 14.9499L13 13.793V21H11V13.8641L9.91421 14.9499L8.5 13.5356L10.6213 11.4143L11 11.0356V11H11.0356Z' fill='%23454D5A'/%3e %3c/svg%3e"})))}),null),preventHide:!0};!function(e){e.SINGLE="single",e.DOUBLE="double"}(dn||(dn={}));var _n={name:j.LOCAL_LOGIN_TIP,content:c().createElement((function(){var e,t,n,r=Me.domainService.docMetaDomain.docMetaEntity.padInfo.padType,o=(null===(n=null===(t=null===(e=window.basicClientVars)||void 0===e?void 0:e.userInfo)||void 0===t?void 0:t.settings)||void 0===n?void 0:n.toolbarMode)===dn.DOUBLE||r===Ke.SLIDE;return c().createElement(F.ZP,{className:u()("local-login-tip",{"is-double-toolbar":o}),action:(0,R.$t)(""),onClickAction:function(){window.mqq.invoke("docx","loginToOpenUrl",{file:_t(),close:!0})}},(0,R.$t)(""))}),null),preventHide:!0,style:{marginRight:0}},Cn={PERSON:(0,R.$t)(""),CORP:(0,R.$t)(""),OUTER:(0,R.$t)("")},Sn={name:j.TITLE_BADGE,content:c().createElement((function(){return s.createElement("div",{className:"titlebar_title-badge"},he()?Cn.PERSON:"")}),null),preventHide:!0,shouldDisableWhenPrinting:!1,style:{marginRight:0}},wn=[At,yn,Yt,Sn,mn,vn,ht,on,_n,yt,Nt,Dt,ut,bn,Ft,Ze],En=[{name:r.FILE,content:""}],xn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ue(t,e),t.prototype.shouldHideHome=function(){return e.prototype.shouldHideHome.call(this)},t.prototype.shouldHideCertification=function(){return e.prototype.shouldHideCertification.call(this)},t.prototype.shouldHideBadge=function(){return e.prototype.shouldHideBadge.call(this)},t.prototype.shouldHideTitleBadge=function(){return e.prototype.shouldHideTitleBadge.call(this)},t.prototype.shouldHideSaveTips=function(){return e.prototype.shouldHideSaveTips.call(this)},t.prototype.shouldHideCollaboration=function(){return e.prototype.shouldHideCollaboration.call(this)},t.prototype.shouldHideGroupTips=function(){return e.prototype.shouldHideGroupTips.call(this)},t.prototype.shouldHideAuthBtn=function(){return e.prototype.shouldHideAuthBtn.call(this)},t.prototype.shouldHideFileMenu=function(){return e.prototype.shouldHideFileMenu.call(this)},t.prototype.shouldHideShareBtn=function(){return e.prototype.shouldHideShareBtn.call(this)},t.prototype.shouldHideLocalFileTag=function(){return e.prototype.shouldHideLocalFileTag.call(this)},t.prototype.shouldHideLocalFileLogo=function(){return e.prototype.shouldHideLocalFileLogo.call(this)},t.prototype.shouldHideLocalLoginTip=function(){return e.prototype.shouldHideLocalLoginTip.call(this)},t.prototype.shouldHideLocalFileUpload=function(){return e.prototype.shouldHideLocalFileUpload.call(this)},je([(0,m.b)(j.HOME,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideHome",null),je([(0,m.b)(j.CERTIFICATION,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideCertification",null),je([(0,m.b)(j.BADGE,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideBadge",null),je([(0,m.b)(j.TITLE_BADGE,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideTitleBadge",null),je([(0,m.b)(j.SAVE_TIPS,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideSaveTips",null),je([(0,m.b)(j.COLLABORATION,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideCollaboration",null),je([(0,m.b)(j.QQ_GROUP_AIO,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideGroupTips",null),je([(0,m.b)(j.AUTH,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideAuthBtn",null),je([(0,m.b)(j.FILE_MENU,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideFileMenu",null),je([(0,m.b)(j.SHARE,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideShareBtn",null),je([(0,m.b)(j.LOCAL_FILE_TAG,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideLocalFileTag",null),je([(0,m.b)(j.LOCAL_FILE_LOGO,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideLocalFileLogo",null),je([(0,m.b)(j.LOCAL_LOGIN_TIP,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideLocalLoginTip",null),je([(0,m.b)(j.LOCAL_FILE_UPLOAD,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideLocalFileUpload",null),t=je([(0,b.Q)({titlebarItems:wn,menuItems:En})],t)}(Xt),Tn=(Object.freeze({__proto__:null,TITLEBAR_SCHEMA:hn,TITLEBAR_CONFIGS:wn,TitlebarController:xn}),un([j.HOME,j.DIVIDER,j.LOCAL_FILE_LOGO,j.TITLE,j.LOCAL_FILE_TAG,j.TITLE_BADGE,j.CERTIFICATION,j.READONLY_TIPS,j.BADGE,j.SAVE_TIPS,j.PUSHER,j.LOCAL_LOGIN_TIP,j.COLLABORATION,j.QQ_GROUP_AIO,j.FILE_MENU,j.EDIT_MENU,j.PRESENTATION,j.TENCENT_MEETING,j.AUTH,j.LOCAL_FILE_UPLOAD,j.LOCAL_FILE_TRANSFER,j.LOCAL_FILE_SAVE,j.SHARE,j.ACCOUNT_AVATAR,j.TOOLBAR_MODE]));function Rn(){var e=function(){var e=rt("client"),t=nt("open_theme_id"),n=nt("third_appid");return e||t||n||""}(),t="tencent_meeting"===e,n="true"===localStorage.getItem("meetingDev");return t||n}var In=function(e){function t(t){var n=e.call(this,t)||this,r=n.isShowDivider?48:40;return n.transitionService.register("titlebar-unfold",{duration:350,entered:{width:r,visibility:"visible",transition:"width 0.35s ease-out"},entering:{width:r,visibility:"visible",transition:"width 0.35s ease-out"},exited:{width:"0px",visibility:"hidden",transition:"width 0.35s ease-out"},exiting:{width:"0px",visibility:"hidden",transition:"width 0.35s ease-out"}}),n}return Ue(t,e),Object.defineProperty(t.prototype,"isLogin",{get:function(){return(0,x.isLogin)()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isShowDivider",{get:function(){return this.isLogin&&!Rn()},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=c().createElement(y.l,{align:"left",name:r.TOOLBAR_MODE,mode:"menu"});return c().createElement(U.default,{dropContent:e,placement:"bottom"},c().createElement(T.default,{title:(0,R.$t)(""),alignment:"end",placement:"bottom"},c().createElement(C.K,{name:"titlebar-unfold",simulateSpaceChange:!0},c().createElement("div",{className:"titlebar-unfold"},this.isShowDivider&&c().createElement(d.default,{className:"titlbar-unfold-divider",orientation:"vertical"}),c().createElement("div",{className:"titlebar-toolbar-mode-wrap"},c().createElement("div",{className:"titlebar-toolbar-mode"},c().createElement("div",{className:"icon-svg-toolbar_fold"})))))))},je([(0,f.tB)(),Ge("design:type",S.Z)],t.prototype,"transitionService",void 0),t}(c().PureComponent),Pn={name:j.TOOLBAR_MODE,content:c().createElement(In,null),preventHide:!0,shouldDisableWhenPrinting:!0,style:{marginLeft:0,marginRight:0}},On={name:j.LOCAL_FILE_SAVE,content:c().createElement((function(){return c().createElement(P.default,{type:"primary",size:"small",className:"local-file-save"},(0,R.$t)(""))}),null),preventHide:!0,style:{marginLeft:0}},kn={name:j.LOCAL_FILE_TRANSFER,content:c().createElement(Et,null),preventHide:!0,style:{marginLeft:4}},Dn=[At,yn,Yt,Sn,mn,vn,nn,ht,on,_n,yt,Nt,Dt,tn,ut,bn,kn,On,Ft,Ze,Pn],Mn=[{name:r.FILE,content:""},{name:r.EDIT,content:""}],An=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ue(t,e),t.prototype.shouldHideTitleBadge=function(){return e.prototype.shouldHideTitleBadge.call(this)},t.prototype.shouldHideCertification=function(){return e.prototype.shouldHideCertification.call(this)},t.prototype.shouldHideReadonlyTips=function(){return e.prototype.shouldHideReadonlyTips.call(this)},t.prototype.shouldHideBadge=function(){return e.prototype.shouldHideBadge.call(this)},t.prototype.shouldHideSaveTips=function(){return e.prototype.shouldHideSaveTips.call(this)},t.prototype.shouldHideCollaboration=function(){return e.prototype.shouldHideCollaboration.call(this)},t.prototype.shouldHideGroupTips=function(){return e.prototype.shouldHideGroupTips.call(this)},t.prototype.shouldHideAuthBtn=function(){return e.prototype.shouldHideAuthBtn.call(this)},t.prototype.shouldHideFileMenu=function(){return e.prototype.shouldHideFileMenu.call(this)},t.prototype.shouldHideEditMenu=function(){return e.prototype.shouldHideEditMenu.call(this)},t.prototype.shouldHideShareBtn=function(){return e.prototype.shouldHideShareBtn.call(this)},t.prototype.shouldHideToolbarMode=function(){return!0},t.prototype.shouldHideLocalFileTag=function(){return e.prototype.shouldHideLocalFileTag.call(this)},t.prototype.shouldHideLocalFileLogo=function(){return e.prototype.shouldHideLocalFileLogo.call(this)},t.prototype.shouldHideLocalFileSave=function(){return e.prototype.shouldHideLocalFileSave.call(this)},t.prototype.shouldHideLocalLoginTip=function(){return e.prototype.shouldHideLocalLoginTip.call(this)},t.prototype.shouldHideLocalFileTransfer=function(){return e.prototype.shouldHideLocalFileTransfer.call(this)},t.prototype.shouldHideLocalFileUpload=function(){return e.prototype.shouldHideLocalFileUpload.call(this)},je([(0,m.b)(j.TITLE_BADGE,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideTitleBadge",null),je([(0,m.b)(j.CERTIFICATION,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideCertification",null),je([(0,m.b)(j.READONLY_TIPS,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideReadonlyTips",null),je([(0,m.b)(j.BADGE,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideBadge",null),je([(0,m.b)(j.SAVE_TIPS,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideSaveTips",null),je([(0,m.b)(j.COLLABORATION,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideCollaboration",null),je([(0,m.b)(j.QQ_GROUP_AIO,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideGroupTips",null),je([(0,m.b)(j.AUTH,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideAuthBtn",null),je([(0,m.b)(j.FILE_MENU,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideFileMenu",null),je([(0,m.b)(j.EDIT_MENU,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideEditMenu",null),je([(0,m.b)(j.SHARE,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideShareBtn",null),je([(0,m.b)(j.TOOLBAR_MODE,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideToolbarMode",null),je([(0,m.b)(j.LOCAL_FILE_TAG,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideLocalFileTag",null),je([(0,m.b)(j.LOCAL_FILE_LOGO,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideLocalFileLogo",null),je([(0,m.b)(j.LOCAL_FILE_SAVE,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideLocalFileSave",null),je([(0,m.b)(j.LOCAL_LOGIN_TIP,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideLocalLoginTip",null),je([(0,m.b)(j.LOCAL_FILE_TRANSFER,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideLocalFileTransfer",null),je([(0,m.b)(j.LOCAL_FILE_UPLOAD,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideLocalFileUpload",null),t=je([(0,b.Q)({titlebarItems:Dn,menuItems:Mn})],t)}(Xt),Ln=(Object.freeze({__proto__:null,TITLEBAR_SCHEMA:Tn,TITLEBAR_CONFIGS:Dn,TitlebarController:An}),un([j.HOME,j.DIVIDER,j.LOCAL_FILE_LOGO,j.TITLE,j.LOCAL_FILE_TAG,j.TITLE_BADGE,j.CERTIFICATION,j.READONLY_TIPS,j.BADGE,j.SUBSCRIBE,j.SAVE_TIPS,j.PUSHER,j.LOCAL_LOGIN_TIP,j.COLLABORATION,j.QQ_GROUP_AIO,j.RELATE_FORM_MENU,j.FILE_MENU,j.EDIT_MENU,j.AUTH,j.LOCAL_FILE_UPLOAD,j.LOCAL_FILE_TRANSFER,j.LOCAL_FILE_SAVE,j.SHARE,j.ACCOUNT_AVATAR,j.TOOLBAR_MODE])),Nn=function(){function e(){var e=this;this.onEditVersionChange=function(t){return e.eventEmitter.listen(ne,t)}}return je([(0,f.tB)(),Ge("design:type",g.v)],e.prototype,"eventEmitter",void 0),e=je([(0,p.L)()],e)}(),Bn=function(e){return Ve(void 0,void 0,void 0,(function(){var t,n,r;return We(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,(0,H.Z)({method:"POST",url:"/v2/extra/gray/query",data:{type:"subscribe",xsrf:nt("TOK")||"",file_id:e}})];case 1:return t=o.sent(),0!==(n=t.data).retcode||0!==n.cgicode?(console.error("GrayService","getIsInGray subscribe: ".concat(n)),[2]):[2,n.result.exist];case 2:return r=o.sent(),console.error("GrayService","getIsInGray subscribe: ".concat(r)),[3,3];case 3:return[2]}}))}))},Fn=function(e){function t(t){var r=e.call(this,t)||this;return r.wrapperRef=c().createRef(),r.initSubscribeExtension=function(){return Ve(r,void 0,void 0,(function(){var e,t,r,o,i=this;return We(this,(function(a){switch(a.label){case 0:return e=Me.domainService.docMetaDomain.docMetaEntity.padInfo,t=e.padId,r=e.lastModifyTime,[4,Bn(t)];case 1:return a.sent()?[4,Me.extensionService.getExtension(Te.name)]:[2];case 2:return a.sent().show({container:document.getElementById("subscribe-extension-container"),padId:t,lastModifyTime:0===(null===(o=n.g.clientVars)||void 0===o?void 0:o.collab_client_vars.rev)?0:r,addEditListener:function(e){i.editAction=e}}),[2]}}))}))},r.subscribeFeature=f.Am.get(Nn),r}return Ue(t,e),t.prototype.componentDidMount=function(){var e=this;this.initSubscribeExtension(),this.onEditVersionChange=this.subscribeFeature.onEditVersionChange((function(){var t;return null===(t=e.editAction)||void 0===t?void 0:t.call(e)}))},t.prototype.componentWillUnmount=function(){var e;null===(e=this.onEditVersionChange)||void 0===e||e.unsubscribe()},t.prototype.render=function(){return c().createElement("div",{ref:this.wrapperRef,id:"subscribe-extension-container",className:"subscribe-extension-container"})},t}(c().Component),Un={name:j.SUBSCRIBE,content:c().createElement(Fn,null),preventHide:!0,shouldDisableWhenPrinting:!1,style:{marginLeft:0,marginRight:0}},Hn=[{name:r.FILE,content:""},{name:r.EDIT,content:""}],jn=[At,yn,Yt,Sn,mn,nn,vn,ht,Un,on,_n,yt,Nt,Dt,tn,ut,bn,kn,On,Ft,Ze,Pn],Gn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ue(t,e),t.prototype.shouldHideHome=function(){return e.prototype.shouldHideHome.call(this)},t.prototype.shouldHideTitleBadge=function(){return e.prototype.shouldHideTitleBadge.call(this)},t.prototype.shouldHideCertification=function(){return e.prototype.shouldHideCertification.call(this)},t.prototype.shouldHideReadonlyTips=function(){return e.prototype.shouldHideReadonlyTips.call(this)},t.prototype.shouldHideBadge=function(){return e.prototype.shouldHideBadge.call(this)},t.prototype.shouldHideSaveTips=function(){return e.prototype.shouldHideSaveTips.call(this)},t.prototype.shouldHideSubscribe=function(){return e.prototype.shouldHideSubscribe.call(this)},t.prototype.shouldHideCollaboration=function(){return e.prototype.shouldHideCollaboration.call(this)},t.prototype.shouldHideGroupTips=function(){return e.prototype.shouldHideGroupTips.call(this)},t.prototype.shouldHideAuthBtn=function(){return e.prototype.shouldHideAuthBtn.call(this)},t.prototype.shouldHideFileMenu=function(){return e.prototype.shouldHideFileMenu.call(this)},t.prototype.shouldHideEditMenu=function(){return e.prototype.shouldHideEditMenu.call(this)},t.prototype.shouldHideShareBtn=function(){return e.prototype.shouldHideShareBtn.call(this)},t.prototype.shouldHideToolbarMode=function(){return!0},t.prototype.shouldHideLocalFileTag=function(){return e.prototype.shouldHideLocalFileTag.call(this)},t.prototype.shouldHideLocalFileLogo=function(){return e.prototype.shouldHideLocalFileLogo.call(this)},t.prototype.shouldHideLocalFileSave=function(){return e.prototype.shouldHideLocalFileSave.call(this)},t.prototype.shouldHideLocalLoginTip=function(){return e.prototype.shouldHideLocalLoginTip.call(this)},t.prototype.shouldHideLocalFileTransfer=function(){return e.prototype.shouldHideLocalFileTransfer.call(this)},t.prototype.shouldHideLocalFileUpload=function(){return e.prototype.shouldHideLocalFileUpload.call(this)},je([(0,m.b)(j.HOME,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideHome",null),je([(0,m.b)(j.TITLE_BADGE,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideTitleBadge",null),je([(0,m.b)(j.CERTIFICATION,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideCertification",null),je([(0,m.b)(j.READONLY_TIPS,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideReadonlyTips",null),je([(0,m.b)(j.BADGE,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideBadge",null),je([(0,m.b)(j.SAVE_TIPS,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideSaveTips",null),je([(0,m.b)(j.SUBSCRIBE,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideSubscribe",null),je([(0,m.b)(j.COLLABORATION,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideCollaboration",null),je([(0,m.b)(j.QQ_GROUP_AIO,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideGroupTips",null),je([(0,m.b)(j.AUTH,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideAuthBtn",null),je([(0,m.b)(j.FILE_MENU,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideFileMenu",null),je([(0,m.b)(j.EDIT_MENU,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideEditMenu",null),je([(0,m.b)(j.SHARE,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideShareBtn",null),je([(0,m.b)(j.TOOLBAR_MODE,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideToolbarMode",null),je([(0,m.b)(j.LOCAL_FILE_TAG,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideLocalFileTag",null),je([(0,m.b)(j.LOCAL_FILE_LOGO,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideLocalFileLogo",null),je([(0,m.b)(j.LOCAL_FILE_SAVE,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideLocalFileSave",null),je([(0,m.b)(j.LOCAL_LOGIN_TIP,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideLocalLoginTip",null),je([(0,m.b)(j.LOCAL_FILE_TRANSFER,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideLocalFileTransfer",null),je([(0,m.b)(j.LOCAL_FILE_UPLOAD,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideLocalFileUpload",null),t=je([(0,b.Q)({titlebarItems:jn,menuItems:Hn})],t)}(Xt),Vn=(Object.freeze({__proto__:null,TITLEBAR_SCHEMA:Ln,TITLEBAR_CONFIGS:jn,TitlebarController:Gn}),[j.HOME,j.DIVIDER,j.LOCAL_FILE_LOGO,j.TITLE,j.LOCAL_FILE_TAG,j.TITLE_BADGE,j.CERTIFICATION,j.READONLY_TIPS,j.BADGE,j.SUBSCRIBE,j.SAVE_TIPS,j.PUSHER,j.LOCAL_LOGIN_TIP,j.COLLABORATION,j.QQ_GROUP_AIO,j.FILE_MENU,j.EDIT_MENU,j.PRESENTATION,j.AUTH,j.LOCAL_FILE_UPLOAD,j.LOCAL_FILE_TRANSFER,j.LOCAL_FILE_SAVE,j.SHARE,j.ACCOUNT_AVATAR,j.TOOLBAR_MODE]),Wn=[j.BRAND,j.DIVIDER,j.TITLE,j.PUSHER,j.FILE_MENU],zn=un(window.isPublishedURL?Wn:Vn),Kn=[{name:r.FILE,content:""},{name:r.EDIT,content:""}],qn=[At,yn,Yt,Sn,mn,nn,vn,ht,Un,on,_n,yt,Nt,Dt,tn,ut,bn,kn,On,Ft,Ze,Pn],Yn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ue(t,e),t.prototype.shouldHideHome=function(){return e.prototype.shouldHideHome.call(this)},t.prototype.shouldHideTitleBadge=function(){return e.prototype.shouldHideTitleBadge.call(this)},t.prototype.shouldHideCertification=function(){return e.prototype.shouldHideCertification.call(this)},t.prototype.shouldHideReadonlyTips=function(){return e.prototype.shouldHideReadonlyTips.call(this)},t.prototype.shouldHideBadge=function(){return e.prototype.shouldHideBadge.call(this)},t.prototype.shouldHideSaveTips=function(){return e.prototype.shouldHideSaveTips.call(this)},t.prototype.shouldHideCollaboration=function(){return e.prototype.shouldHideCollaboration.call(this)},t.prototype.shouldHideGroupTips=function(){return e.prototype.shouldHideGroupTips.call(this)},t.prototype.shouldHideAuthBtn=function(){return e.prototype.shouldHideAuthBtn.call(this)},t.prototype.shouldHideFileMenu=function(){return e.prototype.shouldHideFileMenu.call(this)},t.prototype.shouldHideEditMenu=function(){return e.prototype.shouldHideEditMenu.call(this)},t.prototype.shouldHideShareBtn=function(){return e.prototype.shouldHideShareBtn.call(this)},t.prototype.shouldHideSubscribe=function(){return e.prototype.shouldHideSubscribe.call(this)},t.prototype.shouldHideToolbarMode=function(){return!0},t.prototype.shouldHideLocalFileTag=function(){return e.prototype.shouldHideLocalFileTag.call(this)},t.prototype.shouldHideLocalFileLogo=function(){return e.prototype.shouldHideLocalFileLogo.call(this)},t.prototype.shouldHideLocalFileSave=function(){return e.prototype.shouldHideLocalFileSave.call(this)},t.prototype.shouldHideLocalLoginTip=function(){return e.prototype.shouldHideLocalLoginTip.call(this)},t.prototype.shouldHideLocalFileTransfer=function(){return e.prototype.shouldHideLocalFileTransfer.call(this)},t.prototype.shouldHideLocalFileUpload=function(){return e.prototype.shouldHideLocalFileUpload.call(this)},je([(0,m.b)(j.HOME,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideHome",null),je([(0,m.b)(j.TITLE_BADGE,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideTitleBadge",null),je([(0,m.b)(j.CERTIFICATION,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideCertification",null),je([(0,m.b)(j.READONLY_TIPS,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideReadonlyTips",null),je([(0,m.b)(j.BADGE,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideBadge",null),je([(0,m.b)(j.SAVE_TIPS,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideSaveTips",null),je([(0,m.b)(j.COLLABORATION,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideCollaboration",null),je([(0,m.b)(j.QQ_GROUP_AIO,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideGroupTips",null),je([(0,m.b)(j.AUTH,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideAuthBtn",null),je([(0,m.b)(j.FILE_MENU,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideFileMenu",null),je([(0,m.b)(j.EDIT_MENU,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideEditMenu",null),je([(0,m.b)(j.SHARE,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideShareBtn",null),je([(0,m.b)(j.SUBSCRIBE,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideSubscribe",null),je([(0,m.b)(j.TOOLBAR_MODE,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideToolbarMode",null),je([(0,m.b)(j.LOCAL_FILE_TAG,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideLocalFileTag",null),je([(0,m.b)(j.LOCAL_FILE_LOGO,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideLocalFileLogo",null),je([(0,m.b)(j.LOCAL_FILE_SAVE,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideLocalFileSave",null),je([(0,m.b)(j.LOCAL_LOGIN_TIP,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideLocalLoginTip",null),je([(0,m.b)(j.LOCAL_FILE_TRANSFER,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideLocalFileTransfer",null),je([(0,m.b)(j.LOCAL_FILE_UPLOAD,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideLocalFileUpload",null),t=je([(0,b.Q)({titlebarItems:qn,menuItems:Kn})],t)}(Xt),Qn=Object.freeze({__proto__:null,TITLEBAR_SCHEMA:zn,TITLEBAR_CONFIGS:qn,TitlebarController:Yn}),Zn=un([j.HOME,j.DIVIDER,j.TITLE,j.CERTIFICATION,j.BADGE,j.SAVE_TIPS,j.PUSHER,j.QQ_GROUP_AIO,j.FILE_MENU,j.AUTH,j.SHARE,j.LOGIN_TIP,j.ACCOUNT_AVATAR]),Xn=[At,Yt,vn,ht,on,Nt,Dt,ut,Ft,Ze],Jn=[{name:r.FILE,content:""}];function $n(e){return void 0===e&&(e="f33b8e0054674e6c9b33f18178bb6a6c"),rt("clientid")===e}var er=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ue(t,e),t.prototype.hideHomeBtn=function(){return $n()},t.prototype.shouldHideCertification=function(){return e.prototype.shouldHideCertification.call(this)},t.prototype.shouldHideBadge=function(){return e.prototype.shouldHideBadge.call(this)||$n()},t.prototype.shouldHideSaveTips=function(){return e.prototype.shouldHideSaveTips.call(this)},t.prototype.shouldHideAuthBtn=function(){return e.prototype.shouldHideAuthBtn.call(this)||/fill\//.test(location.hash)},t.prototype.shouldHideFileMenu=function(){return e.prototype.shouldHideFileMenu.call(this)||$n()},t.prototype.shouldHideShareBtn=function(){return e.prototype.shouldHideShareBtn.call(this)||"#/edit"===location.hash||"#/preview"===location.hash||"#/edit-closing-remark"===location.hash||$n()},je([(0,m.b)(j.HOME,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"hideHomeBtn",null),je([(0,m.b)(j.CERTIFICATION,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideCertification",null),je([(0,m.b)(j.BADGE,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideBadge",null),je([(0,m.b)(j.SAVE_TIPS,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideSaveTips",null),je([(0,m.b)(j.AUTH,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideAuthBtn",null),je([(0,m.b)(j.FILE_MENU,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideFileMenu",null),je([(0,m.b)(j.SHARE,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideShareBtn",null),t=je([(0,b.Q)({titlebarItems:Xn,menuItems:Jn})],t)}(Xt),tr=(Object.freeze({__proto__:null,TITLEBAR_SCHEMA:Zn,TITLEBAR_CONFIGS:Xn,TitlebarController:er}),[j.HOME,j.DIVIDER,j.TITLE,j.SAVE_TIPS,j.PUSHER,j.RESUME_VIP_TIPS,j.FILE_MENU,j.EXPORT_RESUME,j.ACCOUNT_AVATAR]),nr=[Yt,on,Dt,Ze],rr=[{name:r.FILE,content:""}],or=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ue(t,e),t.prototype.shouldHideSaveTips=function(){return e.prototype.shouldHideSaveTips.call(this)},t.prototype.shouldHideFileMenu=function(){return e.prototype.shouldHideFileMenu.call(this)},je([(0,m.b)(j.SAVE_TIPS,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideSaveTips",null),je([(0,m.b)(j.FILE_MENU,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideFileMenu",null),t=je([(0,b.Q)({titlebarItems:nr,menuItems:rr})],t)}(Xt),ir=(Object.freeze({__proto__:null,TITLEBAR_SCHEMA:tr,TITLEBAR_CONFIGS:nr,TitlebarController:or}),un([j.HOME,j.DIVIDER,j.TITLE,j.TITLE_BADGE,j.CERTIFICATION,j.READONLY_TIPS,j.BADGE,j.SAVE_TIPS,j.PUSHER,j.COLLABORATION,j.QQ_GROUP_AIO,j.FILE_MENU,j.AUTH,j.SHARE,j.ACCOUNT_AVATAR,j.TOOLBAR_MODE]));r.FILE;var ar=[At,Yt,Sn,nn,vn,ht,on,yt,Nt,Dt,ut,Ft,Ze,Pn],sr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ue(t,e),t.prototype.shouldHideTitleBadge=function(){return e.prototype.shouldHideTitleBadge.call(this)},t.prototype.shouldHideCertification=function(){return e.prototype.shouldHideCertification.call(this)},t.prototype.shouldHideReadonlyTips=function(){return e.prototype.shouldHideReadonlyTips.call(this)},t.prototype.shouldHideBadge=function(){return e.prototype.shouldHideBadge.call(this)},t.prototype.shouldHideSaveTips=function(){return e.prototype.shouldHideSaveTips.call(this)},t.prototype.shouldHideAuthBtn=function(){return e.prototype.shouldHideAuthBtn.call(this)},t.prototype.shouldHideFileMenu=function(){return e.prototype.shouldHideFileMenu.call(this)},t.prototype.shouldHideShareBtn=function(){return e.prototype.shouldHideShareBtn.call(this)},t.prototype.shouldHideToolbarMode=function(){return!0},je([(0,m.b)(j.TITLE_BADGE,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideTitleBadge",null),je([(0,m.b)(j.CERTIFICATION,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideCertification",null),je([(0,m.b)(j.READONLY_TIPS,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideReadonlyTips",null),je([(0,m.b)(j.BADGE,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideBadge",null),je([(0,m.b)(j.SAVE_TIPS,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideSaveTips",null),je([(0,m.b)(j.AUTH,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideAuthBtn",null),je([(0,m.b)(j.FILE_MENU,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideFileMenu",null),je([(0,m.b)(j.SHARE,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideShareBtn",null),je([(0,m.b)(j.TOOLBAR_MODE,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideToolbarMode",null),t=je([(0,b.Q)({titlebarItems:jn,menuItems:Hn})],t)}(Xt),cr=(Object.freeze({__proto__:null,TITLEBAR_SCHEMA:ir,TITLEBAR_CONFIGS:ar,TitlebarController:sr}),un([j.HOME,j.DIVIDER,j.TITLE,j.TITLE_BADGE,j.CERTIFICATION,j.READONLY_TIPS,j.BADGE,j.SAVE_TIPS,j.PUSHER,j.COLLABORATION,j.QQ_GROUP_AIO,j.FILE_MENU,j.AUTH,j.SHARE,j.ACCOUNT_AVATAR,j.TOOLBAR_MODE]));r.FILE;var lr=[At,Yt,Sn,nn,vn,ht,on,yt,Nt,Dt,ut,Ft,Ze,Pn],ur=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ue(t,e),t.prototype.shouldHideTitleBadge=function(){return e.prototype.shouldHideTitleBadge.call(this)},t.prototype.shouldHideCertification=function(){return e.prototype.shouldHideCertification.call(this)},t.prototype.shouldHideReadonlyTips=function(){return e.prototype.shouldHideReadonlyTips.call(this)},t.prototype.shouldHideBadge=function(){return e.prototype.shouldHideBadge.call(this)},t.prototype.shouldHideSaveTips=function(){return e.prototype.shouldHideSaveTips.call(this)},t.prototype.shouldHideAuthBtn=function(){return e.prototype.shouldHideAuthBtn.call(this)},t.prototype.shouldHideFileMenu=function(){return e.prototype.shouldHideFileMenu.call(this)},t.prototype.shouldHideShareBtn=function(){return e.prototype.shouldHideShareBtn.call(this)},t.prototype.shouldHideToolbarMode=function(){return!0},je([(0,m.b)(j.TITLE_BADGE,"shouldHide"),(0,_.z)(!0),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideTitleBadge",null),je([(0,m.b)(j.CERTIFICATION,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideCertification",null),je([(0,m.b)(j.READONLY_TIPS,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideReadonlyTips",null),je([(0,m.b)(j.BADGE,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideBadge",null),je([(0,m.b)(j.SAVE_TIPS,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideSaveTips",null),je([(0,m.b)(j.AUTH,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideAuthBtn",null),je([(0,m.b)(j.FILE_MENU,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideFileMenu",null),je([(0,m.b)(j.SHARE,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideShareBtn",null),je([(0,m.b)(j.TOOLBAR_MODE,"shouldHide"),Ge("design:type",Function),Ge("design:paramtypes",[]),Ge("design:returntype",void 0)],t.prototype,"shouldHideToolbarMode",null),t=je([(0,b.Q)({titlebarItems:jn,menuItems:Hn})],t)}(Xt);function dr(e){e&&function(e,t,n,r){var o=0,i=0,a=function(){if(i){if(!(+new Date-i<n))return o=0,void(i=0);if(o>=t-1)return r(),o=0,void(i=0)}i=+new Date,o+=1};e.addEventListener("click",a)}(e,10,500,(function(){var e;null===(e=window.log)||void 0===e||e.loadAsset("WL_REPORT_DIALOG")}))}Object.freeze({__proto__:null,TITLEBAR_SCHEMA:cr,TITLEBAR_CONFIGS:lr,TitlebarController:ur});var pr={init:function(){var e=document.getElementById("workbench-titlebar");e?dr(e):f.Am.get(g.v).listen(w.c.TitlebarMounted,(function(e){dr(e)}))}};(0,R.scL10nIniter)(),pr.init()},50603:function(e,t,n){var r,o,i;n.d(t,{$e:function(){return o},H4:function(){return a},eM:function(){return c},kd:function(){return s},me:function(){return r},tA:function(){return i}}),function(e){e.OFFLINE_DATA="OfflineData",e.DOCUMENT_DATA="DocumentData",e.PAD_INFO="PadInfo",e.NEW_DOCUMENT_ID="NewDocumentIds",e.FOLDER_INFO="FolderInfo",e.USER_INFO="UserInfo",e.DOCUMENT_STATUS="DocumentStatus",e.LIST_TYPE="ListType",e.DATA_CHANGE="DataChange",e.QUICK_LOOK_WORD="QuickLookWord",e.USERS="Users",e.DocumentEntities="DocumentEntities"}(r||(r={})),function(e){e.EXCEL="EXCEL",e.WORD="WORD",e.SLIDE="SLIDE"}(o||(o={})),function(e){e.GLOBAL="globalPadId",e.SECRET="secretId"}(i||(i={}));var a="TencentDocs",s=4,c="true"===localStorage.getItem("isOfflineModuleDebug")||!1},36445:function(e,t,n){n.d(t,{f:function(){return o}});var r=n(5593).default.getInstance().getConfig('npm["@tencent/docs_offline"]'),o=(null==r?void 0:r.TOC_ORIGIN)||"https://docs.qq.com"},69989:function(e,t,n){n.d(t,{dd:function(){return I},us:function(){return R}});var r=n(26914),o=n(50603),i=function(e){this.uid=e.uid,this.globalPadId=e.globalPadId,this.secretId=e.secretId,this.lastSyncTime=e.lastSyncTime||Date.now(),this.lastErrorTime=e.lastErrorTime},a=n(17242),s=n(84425),c=n(77914),l=n(71314),u=n(74762),d=n(51015),p=n(81405),h=n(26516),f=n(49790),g=n(7386),v=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},y=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},m=function(){function e(){this.tag="OfflineEditBackUp"}return e.prototype.init=function(){return v(this,void 0,void 0,(function(){var e,t;return y(this,(function(n){switch(n.label){case 0:return e={databaseName:g.DB_NAME_BACKUP,type:(0,h.N1)()?g.DBEngineType.nativeDB:g.DBEngineType.indexDB},this.storageManager=new g.StorageManager(e),[4,this.storageManager.init()];case 1:return t=n.sent(),this.isStorageAvailable=t,t?(d.C.info(this.tag,"init finish. isStorageAvailable:"+this.isStorageAvailable),[2,!0]):(d.C.error(this.tag,"init error. open database fail"),[2,!1])}}))}))},e.prototype.dispose=function(){return v(this,void 0,void 0,(function(){return y(this,(function(e){return this.storageManager.dispose(),[2,!0]}))}))},e.prototype.upsertChanges=function(e){return v(this,void 0,void 0,(function(){var t;return y(this,(function(n){switch(n.label){case 0:return[4,this.isDatabaseAvailable()];case 1:if(!n.sent())return d.C.warn(this.tag,"upsertChanges can not write."),[2,!1];n.label=2;case 2:return n.trys.push([2,4,,5]),[4,new g.OfflineDataStorage(this.storageManager.storage.collection(f.OfflineData)).upsertChanges(e)];case 3:return n.sent(),[2,!0];case 4:return t=n.sent(),d.C.error(this.tag,"upsertChanges error: "+t.message+", , "+t.stack+"."),this.isStorageAvailable=!1,[2,!1];case 5:return[2]}}))}))},e.prototype.isDatabaseAvailable=function(){return this.isStorageAvailable},e}(),b=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},_=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function C(e){return b(this,void 0,void 0,(function(){var t,n,r;return _(this,(function(o){switch(o.label){case 0:return[4,(t=new m).init()];case 1:return(n=o.sent())?[4,t.upsertChanges(e)]:(d.C.error("init backup database error!",n),[2,!1]);case 2:return(r=o.sent())?[4,t.dispose()]:(d.C.error("upsert backup changes error!",r,r),[2,!1]);case 3:return o.sent(),d.C.info("backup changes success!",e),[2,!0]}}))}))}var S=function(){return S=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},S.apply(this,arguments)},w=function(){return w=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},w.apply(this,arguments)},E=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},x=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},T=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r};(0,h.N1)()&&!(0,h.kK)()?u.Z:p.Z;var R=10,I=function(){function e(e){this.defaultCodeVersion=new Map,this.parent=e.parent,this.database=e.database,this.setDefaultCodeVersion("doc","2.1.0"),this.setDefaultCodeVersion("sheet","2.4.0"),this.setDefaultCodeVersion("slide","1.0.0")}return e.prototype.filterUncommitedPadId=function(e){return E(this,void 0,void 0,(function(){var t,n,i,a;return x(this,(function(c){switch(c.label){case 0:return e&&0===e.length?[2,new r.x4(new r.ir(r.r8.ILLEGAL_ARGUMENT,"Id0"))]:(t=r.he.newInstance().addCondition("type",r.E1.IN,[s.N.COMMITING,s.N.WATTING,s.N.QUEUE]).addCondition("uid",r.E1.ONLY,this.parent.user.getUserId()),e&&t.addCondition("globalPadId",r.E1.IN,e),[4,this.database.getAll(o.me.OFFLINE_DATA,t)]);case 1:return(n=c.sent()).error?(d.C.error("",n.error),[2,n]):(i=n.data,a=i.map((function(e){return e.globalPadId})).reduce((function(e,t){return e.includes(t)?e:T(e,[t])}),new Array),[2,new r.x4(void 0,a)])}}))}))},e.prototype.filterNeedUpdateCachePadId=function(e){return E(this,void 0,void 0,(function(){var t,n,i,a,s,c,l,u;return x(this,(function(p){switch(p.label){case 0:return e&&0===e.length?[2,new r.x4(new r.ir(r.r8.ILLEGAL_ARGUMENT,"Id0"))]:(t=r.he.newInstance().addCondition("uid",r.E1.ONLY,this.parent.user.getUserId()),e&&t.addCondition("globalPadId",r.E1.IN,e),[4,this.database.getAll(o.me.DOCUMENT_DATA,t)]);case 1:if((n=p.sent()).error)return d.C.error("",n.error),[2,n];for(i=n.data,a=new Map,s=new Array,c=0;c<i.length;c++)l=i[c],u=a.get(l.globalPadId)||0,a.set(l.globalPadId,u+1),u+1===10&&s.push(l.globalPadId);return[2,new r.x4(void 0,s)]}}))}))},e.prototype.getUncommitedOfflineData=function(){return E(this,void 0,void 0,(function(){var e,t;return x(this,(function(n){switch(n.label){case 0:return e=r.he.newInstance().addCondition("type",r.E1.IN,[s.N.COMMITING,s.N.WATTING,s.N.QUEUE]).addCondition("uid",r.E1.ONLY,this.parent.user.getUserId()),[4,this.database.getAll(o.me.OFFLINE_DATA,e)];case 1:return(t=n.sent()).error?(d.C.error("",t.error),[2,t]):[2,t]}}))}))},e.prototype.syncOfflineData=function(e){return E(this,void 0,void 0,(function(){var t,n,r,o,i,s,c,l,f,g,v,y,m,b,_,C,S;return x(this,(function(w){switch(w.label){case 0:return d.C.log("call SyncOfflineData()",e),t=e.padId,n=e.secretId,r=e.padType,o=e.onCommiting,i=e.onCommitFinished,s=e.source,c=void 0===s?"list":s,l=e.force,f=void 0!==l&&l,[4,this.checkUpdateInterval(e)];case 1:return(g=w.sent()).resultCode!==a.D.Success?[2,g]:[4,(v=(0,h.N1)()&&!(0,h.kK)()?new u.Z(E):new p.Z(E)).lock("offline_"+n,{source:c})];case 2:if(!(y=w.sent()).isSuccess)return d.C.warn("SyncOfflineData. ",t,n,c,f,r,y),[2,{resultCode:a.D.GetDocLockError,subResultCode:-1,message:""}];w.label=3;case 3:return w.trys.push([3,8,9,11]),o&&o(t),d.C.log("SyncOfflineData. ",t,n,c,f,r),[4,this.commitLocalFile(e)];case 4:return(b=w.sent()).resultCode!==a.D.Success?(i&&i(!1,t),[2,b]):(d.C.log("SyncOfflineData. ",t,n,c,f,r),[4,this.commitUncommitData(e)]);case 5:return(_=w.sent()).resultCode!==a.D.Success?(i&&i(!1,t),[2,_]):(i&&i(!0,t),d.C.log("SyncOfflineData. ",t,n,c,f,r),[4,this.checkVersionUpdate(r,t)]);case 6:return w.sent(),d.C.log("SyncOfflineData. ",t,n,c,f,r),[4,this.fetchAndStoreDocumentCache(e)];case 7:return(C=w.sent()).resultCode!==a.D.Success?[2,C]:(m=C.data,[3,11]);case 8:return S=w.sent(),d.C.error("SyncOfflineData. ",null==S?void 0:S.stack),[2,{resultCode:a.D.SyncOfflineDataUnknownError,subResultCode:-1,message:"SyncOfflineDataUnknownError  catch",error:S||new Error("SyncOfflineDataUnknownError")}];case 9:return[4,v.release("offline_"+n)];case 10:return w.sent(),[7];case 11:return d.C.log("SyncOfflineData. ",t,n,c,f,r),[2,{resultCode:a.D.Success,subResultCode:0,message:"Success",data:m}]}var E}))}))},e.prototype.checkUpdateInterval=function(e){return E(this,void 0,void 0,(function(){var t,n,i,s,c,l,u,p,h,f;return x(this,(function(g){switch(g.label){case 0:return t=e.padId,n=e.secretId,i=e.padType,s=e.source,c=void 0===s?"list":s,l=e.force,(u=void 0!==l&&l)?[3,2]:(p=r.he.newInstance().addCondition("globalPadId",r.E1.ONLY,t).addCondition("uid",r.E1.ONLY,this.parent.user.getUserId()),[4,this.database.get(o.me.DOCUMENT_STATUS,p)]);case 1:if((h=g.sent()).error&&!(0,r.FG)(h.error))return d.C.warn("SyncOfflineData. DocumentStatus",t,n,c,u,i,h.error),[2,{resultCode:a.D.GetDocumentStatusError,subResultCode:-1,message:"DocumentStatus",error:h.error}];if(!h.error&&(f=h.data,Date.now()-f.lastSyncTime<6e5))return d.C.warn("SyncOfflineData. RejcectByThrottle",t,n,c,u,i),[2,{resultCode:a.D.RejcectByThrottleError,subResultCode:-1,message:"10 "+new Date(f.lastSyncTime)}];g.label=2;case 2:return[2,{resultCode:a.D.Success,subResultCode:-1,message:""}]}}))}))},e.prototype.commitLocalFile=function(e){return E(this,void 0,void 0,(function(){var t,n,r,o,i,s,l;return x(this,(function(u){switch(u.label){case 0:return t=e.padId,n=e.secretId,r=e.source,o=e.force,i=e.padType,[4,this.getPadInfo(t)];case 1:return(s=u.sent())?!s||s.status!==c.DL.NEW&&s.status!==c.DL.LOCAL?[3,3]:[4,this.createFileWithData(t,i,s.folder)]:(d.C.error("commitLocalFile. getPadInfoError. ",t,n,r,o,i),[2,{resultCode:a.D.CreateFileError,subResultCode:-1e3,message:"commitLocalFile PadInfoPadInfo"}]);case 2:if((l=u.sent()).error)return d.C.error("commitLocalFile ",t,n,r,o,i,l.error),[2,{resultCode:a.D.CreateFileError,subResultCode:-2e3,message:"commitLocalFile ",error:l.error}];u.label=3;case 3:return[2,{resultCode:a.D.Success,subResultCode:-1,message:"commitLocalFile "}]}}))}))},e.prototype.commitUncommitData=function(e){var t;return E(this,void 0,void 0,(function(){var n,r,o,i,s,c,l,u,p,h;return x(this,(function(f){switch(f.label){case 0:return n=e.padId,r=e.secretId,o=e.source,i=e.force,s=e.padType,[4,this.getUnCommitedData(n)];case 1:return(c=f.sent()).error?(d.C.error(c.error),[2,{resultCode:a.D.GetUncommitDataError,subResultCode:-1,message:"commitUncommitData ",error:c.error}]):(d.C.log("commitUncommitData. ",n,r,o,i,s,c.data.length),(l=c.data).length>0?[4,this.batchCommitOfflineData(n,r,l)]:[3,4]);case 2:return(u=f.sent()).resultCode!==a.D.Success?(d.C.error("commitUncommitData. ",n,r,o,i,s),[2,u]):(p=u.data).length>0?[4,this.updateDocUncommitedData(n,p)]:[3,4];case 3:if((h=f.sent()).error)return d.C.error("SyncOfflineData. ",n,r,o,i,s,h.error,null===(t=h.error)||void 0===t?void 0:t.stack),[2,{resultCode:a.D.UpdateUnCommitedDataError,subResultCode:-1,message:"commitUncommitData ",error:h.error}];f.label=4;case 4:return[2,{resultCode:a.D.Success,subResultCode:-1,message:"commitUncommitData "}]}}))}))},e.prototype.fetchAndStoreDocumentCache=function(e){var t,n,r,o;return E(this,void 0,void 0,(function(){var s,c,l,u,p,f,g,v,y,m,b,_,C,S,w,E,T,R,I,P,O,k,D=this;return x(this,(function(x){switch(x.label){case 0:return s=e.padId,c=e.secretId,l=e.source,u=e.force,p=e.padType,f=e.deleteOldCache,g=void 0===f||f,v=e.rev,y=e.isManualOffline,[4,this.preFetchDocData(s,c,v)];case 1:return(m=x.sent()).resultCode!==a.D.Success?(d.C.error("SyncOfflineData. , ",s,c,l,u,p,(0,h.Ei)(m)),[2,m]):(b=m.data,_=b.dver,C=b.allBlockData,S=b.rangePrivilege,d.C.log("SyncOfflineData. &",s,c,l,u,p),w=C.map((function(e){return D.blockData2OfflineData(e,_)})),[4,this.updateDocOfflineData(s,w,g,v)]);case 2:return(E=x.sent()).error?(d.C.error("SyncOfflineData. .",s,c,l,u,p,v,_,w.length,E.error,null===(t=E.error)||void 0===t?void 0:t.stack),[2,{resultCode:a.D.UpdatePreFetchOfflienDataError,subResultCode:-1,message:"updateDocOfflineData ",error:E.error}]):[4,this.getManualPadInfo(c)];case 3:return(!(T=x.sent()).error&&T.data||y)&&C.forEach((function(e){D.cacheImageData(e)})),S?[4,this.cacheRangePrivilege(s,S)]:[3,5];case 4:(R=x.sent())&&R.error&&d.C.error("cacheRangePrivilege. .",null===(n=R.error)||void 0===n?void 0:n.stack),x.label=5;case 5:return I=void 0!==y?{dver:_,isOfflineCache:!0,isManualOffline:y}:{dver:_,isOfflineCache:!0},[4,this.updatePadInfo(s,I)];case 6:return(P=x.sent()).error?(d.C.error("SyncOfflineData. padInfo.",s,c,l,u,p,v,_,P.error,null===(r=P.error)||void 0===r?void 0:r.stack),[2,{resultCode:a.D.UpdatePadInfoError,subResultCode:-1,message:"updatePadInfo PadInfo",error:P.error}]):(O=new i({uid:this.parent.user.getUserId(),globalPadId:s,secretId:c,lastSyncTime:Date.now()}),[4,this.updateDocumentStatus(O)]);case 7:return(k=x.sent()).error&&d.C.error("SyncOfflineData. Status.",s,c,l,u,p,v,_,k.error,null===(o=k.error)||void 0===o?void 0:o.stack),this.parent.mapDocumentVersion(_,(0,h.KW)(p,c)),[2,{resultCode:a.D.Success,subResultCode:0,message:"fetchAndStoreDocumentCache Success",data:P.data[0]}]}}))}))},e.prototype.updateDocumentStatus=function(e){return E(this,void 0,void 0,(function(){return x(this,(function(t){switch(t.label){case 0:return[4,this.database.update(o.me.DOCUMENT_STATUS,e)];case 1:return[2,t.sent()]}}))}))},e.prototype.updatePadInfo=function(e,t){return E(this,void 0,void 0,(function(){var n;return x(this,(function(i){switch(i.label){case 0:return n=(new r.he).addCondition("globalPadId",r.E1.ONLY,e).addCondition("uid",r.E1.ONLY,this.parent.user.getUserId()),[4,this.database.updateField(o.me.PAD_INFO,n,t)];case 1:return[2,i.sent()]}}))}))},e.prototype.getUnCommitedData=function(e){return E(this,void 0,void 0,(function(){var t;return x(this,(function(n){switch(n.label){case 0:return t=r.he.newInstance().addCondition("globalPadId",r.E1.ONLY,e).addCondition("type",r.E1.IN,[s.N.COMMITING,s.N.WATTING,s.N.QUEUE]).addCondition("uid",r.E1.ONLY,this.parent.user.getUserId()),[4,this.database.getAll(o.me.OFFLINE_DATA,t)];case 1:return[2,n.sent()]}}))}))},e.prototype.clearDocOfflineData=function(e,t){return void 0===t&&(t=!0),E(this,void 0,void 0,(function(){var n,i;return x(this,(function(a){switch(a.label){case 0:return n=r.he.newInstance().addCondition("globalPadId",r.E1.ONLY,e).addCondition("uid",r.E1.ONLY,this.parent.user.getUserId()),[4,this.database.delete(o.me.OFFLINE_DATA,n)];case 1:return i=a.sent(),t?i.error?[3,3]:[4,this.database.delete(o.me.DOCUMENT_DATA,n)]:[3,8];case 2:i=a.sent(),a.label=3;case 3:return i.error?[3,5]:[4,this.database.delete(o.me.DOCUMENT_STATUS,n)];case 4:i=a.sent(),a.label=5;case 5:return i.error?[3,7]:[4,this.database.updateField(o.me.PAD_INFO,n,{isOfflineCache:!1})];case 6:i=a.sent(),a.label=7;case 7:a.label=8;case 8:return[2,i]}}))}))},e.prototype.updateDocOfflineData=function(e,t,n,i){return E(this,void 0,void 0,(function(){var a,s;return x(this,(function(c){switch(c.label){case 0:return a=r.he.newInstance().addCondition("globalPadId",r.E1.ONLY,e).addCondition("uid",r.E1.ONLY,this.parent.user.getUserId()),void 0!==i&&a.addCondition("version",r.E1.UPPER_BOUND,{upper:i,open:!1}),n?[4,this.database.deleteAndWrite(o.me.DOCUMENT_DATA,a,t)]:[3,2];case 1:case 3:return[2,c.sent()];case 2:return s=t.map((function(e){return{tableName:o.me.DOCUMENT_DATA,data:e}})),[4,this.database.updateMultiTableData(s)]}}))}))},e.prototype.composeOfflineData=function(e,t){var n=this.parent.user.getUserId(),r=t[0];return{common:{type:"USER_CHANGES",offlineMsg:!0,docid:e,uid:n,dver:r.dver,base_rev:r.type===s.N.INIT?r.version:r.data.baseVersion,code_ver:r.docType===c.Gk.EXCEL?1:0,session_type:0,gray:window._grayVersion?window._grayVersion:0,generalpacket:this.getHeaderGeneralPacket(),pver:r.docType===c.Gk.WORD?2:1,uuId:r.type===s.N.INIT?this.parent.user.getUserId():r.data.data.uuId},respective:t.filter((function(e){if(e.type!==s.N.INIT)return e})).map((function(e){var t=e.data.data,n={task_id:t.taskId,subId:t.subId,oSubId:t.oSubId||!1,head:t.head,keydata:t.keyData||!1,changeSetCount:t.changeData?1:void 0!==t.changeSetCount?t.changeSetCount:t.mutations.length,changeset:t.changeset?t.changeset:JSON.stringify(t.changeData||t.mutations||"[]"),apool:t.apool};return r.docType===c.Gk.EXCEL&&(n.changeset=n.changeset+"\n"),n}))}},e.prototype.batchCommitOfflineData=function(e,t,n){return E(this,void 0,void 0,(function(){var r,o,s,c,l,u,p;return x(this,(function(h){switch(h.label){case 0:return 0===(r=n).length?[2,{resultCode:a.D.CommitOfflineDataError,subResultCode:-1e3,message:"batchCommitOfflineData OfflineData0"}]:[4,this.isCommitFailedBefore(e,n)];case 1:return h.sent()?[2,{resultCode:a.D.CommitOfflineDataError,subResultCode:-1001,message:"batchCommitOfflineData "}]:(r=this.offlineDataSort(r),o=this.composeOfflineData(e,n),[4,this.commitOfflineData(e,o)]);case 2:return(s=h.sent()).error?(d.C.error(s.error),[2,{resultCode:a.D.CommitOfflineDataError,subResultCode:-2e3,message:"batchCommitOfflineData ",error:s.error}]):(c=s.data,0===(l=c.retcode)?(u=this.createMisschangeData(e,t,c.Data),[2,{resultCode:a.D.Success,subResultCode:-1,data:u,message:"batchCommitOfflineData "}]):(d.C.error("batchCommitOfflineData retcode:"+l),[40005,40003,40034].indexOf(l)>=0&&(p=new i({uid:this.parent.user.getUserId(),globalPadId:e,secretId:t,lastSyncTime:Date.now(),lastErrorTime:Date.now()}),this.updateDocumentStatus(p)),[2,{resultCode:a.D.CommitOfflineDataError,subResultCode:-2001,message:"batchCommitOfflineData retCode0 retCode="+l}]))}}))}))},e.prototype.isCommitFailedBefore=function(e,t){return E(this,void 0,void 0,(function(){var n,i,a;return x(this,(function(s){switch(s.label){case 0:return n=r.he.newInstance().addCondition("globalPadId",r.E1.ONLY,e).addCondition("uid",r.E1.ONLY,this.parent.user.getUserId()),[4,this.database.get(o.me.DOCUMENT_STATUS,n)];case 1:return(i=s.sent()).error?[2,!1]:i.data&&i.data.lastErrorTime&&(a=i.data.lastErrorTime,!t.some((function(e){return e.createTime>a})))?[2,!0]:[2,!1]}}))}))},e.prototype.getHeaderGeneralPacket=function(){var e={};return window.__globalReleaseVersion&&(e.rel_rev=window.__globalReleaseVersion),e},e.prototype.commitOfflineData=function(e,t){return E(this,void 0,void 0,(function(){var n,r;return x(this,(function(o){return n="/dop-api/commitchanges?padId="+e+"&xsrf="+(0,h.fM)(),r=JSON.stringify(t),r=encodeURIComponent(r),[2,l.hS.sendCommonRequest(n,l.n$.POST,"data="+r)]}))}))},e.prototype.getGlobalPadIdBySecretId=function(e,t,n){return void 0===n&&(n=!0),E(this,void 0,void 0,(function(){var r,i;return x(this,(function(a){switch(a.label){case 0:return[4,this.getPadInfo(e,o.tA.SECRET)];case 1:return(r=a.sent())?[2,r.globalPadId]:[4,this.getClientVarsBySecretId(e,t,n)];case 2:return(i=a.sent()).error?[2,void 0]:[2,i.data.globalPadId]}}))}))},e.prototype.getClientVarsBySecretId=function(e,t,n){return void 0===n&&(n=!0),E(this,void 0,void 0,(function(){var o,i,a,s;return x(this,(function(c){switch(c.label){case 0:return[4,l.hS.fetchDocData(e,t,n)];case 1:if((o=c.sent()).error)return[2,new r.x4(o.error)];i=o.data,c.label=2;case 2:return c.trys.push([2,4,,5]),"blankpage"===(a=this.convertDataToClientVars(i)).padType||!0===a.isBlankPage?(d.C.error(""),[2,new r.x4(new Error("FileNotExsit"))]):[4,this.createPadInfoFromClientVars(a)];case 3:return c.sent(),[2,new r.x4(void 0,a)];case 4:return s=c.sent(),d.C.error("",s),[2,new r.x4(s||new Error("ParseResponseError"))];case 5:return[2]}}))}))},e.prototype.convertDataToClientVars=function(e){var t=this.unpackEjsData(e);if(t){var n=t.head.value;if(t.text&&t.text.value){var r=n.needEscape?escape(t.text.value):t.text.value;n.clientVars.collab_client_vars.initialAttributedText.text=r,n.clientVars.collab_client_vars.initialAttributedText.attribs=t.attribs.value}return n.clientVars}},e.prototype.unpackEjsData=function(e){for(var t=0,n=e||"",r=n.length,o={text:{type:"",value:null},attribs:{type:"",value:null},head:{type:"",value:null}};t<r;){var i=n.slice(t,t+50).split("\n");if(!(i&&i.length>=3))break;var a=i[0],s=i[1],c=parseInt(i[2],10);t+=i[0].length+i[1].length+i[2].length+3;var l=n.slice(t,t+c);t+=c+1,"text"===a?(o.text.type=s,o.text.value="json"===s?JSON.parse(l):l):"head"===a?(o.head.type=s,o.head.value="json"===s?JSON.parse(l):l):"attribs"===a&&(o.attribs.type=s,o.attribs.value="json"===s?JSON.parse(l):l)}return o},e.prototype.checkVersionUpdate=function(e,t){return E(this,void 0,void 0,(function(){var n,r,o;return x(this,(function(i){switch(i.label){case 0:return n=this.getTypeStringWithPadType(e),r="https://docs.qq.com/cgi/gateway/dver/gray?padId="+t+"&type="+n,[4,l.hS.sendCommonRequest(r,l.n$.GET,void 0,"custom")];case 1:return(o=i.sent()).error&&d.C.error("checkVersionUpdate error.",o.error),d.C.log("checkVersionUpdate. response=",o.data),[2,o]}}))}))},e.prototype.preFetchDocData=function(e,t,n){return E(this,void 0,void 0,(function(){var r,o,i;return x(this,(function(a){switch(a.label){case 0:return r=this.getFetchUrl(e,t,n),[4,l.hS.sendCommonRequest(r,l.n$.GET,void 0,"custom")];case 1:return(o=a.sent()).error?[2,this.handleCommonRequestError(o)]:(i=o.data,[2,this.handlePreFetchDocData(e,i)])}}))}))},e.prototype.handleCommonRequestError=function(e){return"HttpError"===e.error.errorType?{resultCode:a.D.PreFetchDocDataError,subResultCode:e.error.statusCode,message:"Prefetch DataHttpError",error:e.error}:"TimeOutError"===e.error.message?{resultCode:a.D.PreFetchDocDataError,subResultCode:-200801,message:"Prefetch Data",error:e.error}:{resultCode:a.D.PreFetchDocDataError,subResultCode:-200802,message:"Prefetch Data",error:e.error}},e.prototype.getSubBlockList=function(e){return this.parseHeadersFromClientVars(e)},e.prototype.pushState=function(e,t){var n=window.history;try{t?n.replaceState(null,"",e):n.pushState(null,"",e)}catch(n){window.location[t?"replace":"assign"](e)}},e.prototype.isFileCreated=function(e){return E(this,void 0,void 0,(function(){var t;return x(this,(function(n){switch(n.label){case 0:return[4,this.getPadInfo(e,o.tA.GLOBAL)];case 1:return(t=n.sent())?t.status===c.DL.NORMAL?[2,new r.x4(void 0,!0)]:[2,new r.x4(void 0,!1)]:(d.C.error(""),[2,new r.x4(new Error("FileNotExsit"))])}}))}))},e.prototype.createFileWithData=function(e,t,n){return void 0===t&&(t=c.Gk.EXCEL),void 0===n&&(n="/"),E(this,void 0,void 0,(function(){return x(this,(function(r){return[2,this.createFile(e,t,!0,n)]}))}))},e.prototype.createFile=function(e,t,n,i){var a;return void 0===t&&(t=c.Gk.EXCEL),void 0===n&&(n=!0),E(this,void 0,void 0,(function(){var s,u,p,h,g,v,y,m,b,_,w,E,T,R,I,P,O;return x(this,(function(x){switch(x.label){case 0:return s=t,[4,this.getPadInfo(e,o.tA.GLOBAL)];case 1:return(u=x.sent())?u.status===c.DL.NORMAL?(d.C.error("",e),[2,new r.x4(new Error("AlreadyCreatedError"))]):[4,this.getLocalCreateFileData(e,n)]:(d.C.error("padInfo",e),[2,new r.x4(new Error("NoPadInfoError"))]);case 2:return(p=x.sent()).error?(d.C.error(p.error,""),[2,p]):(h=p.data,g=this.generateCreateFileBody({globalPadId:e,docType:s,folderId:i,withData:n},u,h),[4,l.hS.sendCommonRequest("/cgi-bin/online_docs/createdoc_new",l.n$.POST,g)]);case 3:return(v=x.sent()).error?(d.C.error(v.error,""),[2,v]):(y=v.data,d.C.info("create file response:",JSON.stringify(y)),0!==y.retcode?(d.C.error(""),[2,new r.x4(new Error("CreatFileError"),y)]):!0!==y.is_doc_id_dup?[3,10]:y.is_dup_id_owner?(d.C.error(" id  id "),[2,new r.x4(new r.oo(0,10034,"DocumentIdDuplicated"),{retcode:10033,url:y.doc_url})]):[4,this.getUncommitedOfflineData()]);case 4:return(m=x.sent()).error?(d.C.error(" id "),[2,new r.x4(new Error("DocumentIdDuplicated : "+(null===(a=m.error)||void 0===a?void 0:a.message)),{retcode:10033,url:y.doc_url})]):[4,C(function(e){return e.map((function(e){return new f.OfflineData(S(S({},e),{data:e.data,subId:e.subSheetId,dataVersion:e.dver,type:e.type,docType:e.docType,docStatus:e.padStatus,createTimestamp:e.createTime,isDefaultChunk:e.default}))}))}(m.data))];case 5:return b=x.sent(),d.C.info(" id , result = "+b),_=r.he.newInstance().addCondition("globalPadId",r.E1.ONLY,e).addCondition("uid",r.E1.ONLY,this.parent.user.getUserId()),[4,this.database.delete(o.me.PAD_INFO,_)];case 6:return x.sent(),[4,this.database.delete(o.me.OFFLINE_DATA,_)];case 7:return x.sent(),[4,this.database.delete(o.me.DOCUMENT_DATA,_)];case 8:return x.sent(),[4,this.database.delete(o.me.DOCUMENT_STATUS,_)];case 9:return x.sent(),[2,new r.x4(new r.oo(0,10033,"DocumentIdDuplicated"),{retcode:10033,url:y.doc_url})];case 10:return w=Date.now(),u.status=c.DL.NORMAL,u.last_modify_ts=w,u.lastSyncTime=w,[4,this.getDefaultDocData(e,o.tA.GLOBAL)];case 11:return(E=x.sent()).error?[2,E]:(T=E.data.data,y.miss_changes&&(t===c.Gk.EXCEL||t===c.Gk.WORD&&n)&&(R=this.createMisschangeData(e,u.secretId||T.data.collab_client_vars.client.upid,JSON.parse(y.miss_changes))).length>0?[4,this.updateDocUncommitedData(e,R)]:[3,13]);case 12:if((I=x.sent()).error)return d.C.error(I.error),[2,I];x.label=13;case 13:return T.isTemp=!1,[4,this.updateClientVarsSocketInfo(e,T)];case 14:return(P=x.sent()).error?[2,P]:(t===c.Gk.WORD&&(P.data.collab_client_vars.rev=0),P.data.isLocalDoc=!1,P.data.padStatus=c.DL.NORMAL,O=this.clientVars2OfflineData(e,P.data,!0),[4,this.database.updateMultiTableData([{tableName:o.me.PAD_INFO,data:u},{tableName:o.me.DOCUMENT_DATA,data:O}])]);case 15:return x.sent(),[2,new r.x4(void 0,{retcode:0,data:P.data})]}}))}))},e.prototype.generateCreateFileBody=function(e,t,n){var r,o,i=e.globalPadId,a=e.docType,l=e.folderId,u=e.withData;if(d.C.info("generateCreateFileBody"),n.length>0&&a===c.Gk.WORD){var p=n[0];if(p.type===s.N.INIT){var f=p.data.collab_client_vars;d.C.info("generateCreateFileBody before:",JSON.stringify(f)),f.dver.startsWith("3.0.")&&!f.initialAttributedText.text&&(f.initialAttributedText.text="%7B%22commands%22%3A%5B%7B%22type%22%3A%22kDocExtracCmdFromDoc%22%2C%22mutations%22%3A%5B%7B%22ty%22%3A%22is%22%2C%22bi%22%3A0%2C%22s%22%3A%22%5Cr%5Cr%5Cu000f%5Cu001e%5Cu001e%5Cu001e%5Cu001e%5Cu001e%5Cu001e%5Cu001e%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A0%2C%22ei%22%3A1%2C%22pr%22%3A%7B%22run%22%3A%7B%22author%22%3A%22p.833496%22%2C%22isPlaceholder%22%3Atrue%7D%7D%2C%22mt%22%3A%22run%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A1%2C%22ei%22%3A2%2C%22pr%22%3A%7B%22run%22%3A%7B%22isPlaceholder%22%3Atrue%7D%7D%2C%22mt%22%3A%22run%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A2%2C%22ei%22%3A3%2C%22pr%22%3A%7B%22run%22%3A%7B%22isPlaceholder%22%3Atrue%7D%7D%2C%22mt%22%3A%22run%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A3%2C%22ei%22%3A4%2C%22pr%22%3A%7B%22run%22%3A%7B%22isPlaceholder%22%3Atrue%7D%7D%2C%22mt%22%3A%22run%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A4%2C%22ei%22%3A5%2C%22pr%22%3A%7B%22run%22%3A%7B%22isPlaceholder%22%3Atrue%7D%7D%2C%22mt%22%3A%22run%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A5%2C%22ei%22%3A6%2C%22pr%22%3A%7B%22run%22%3A%7B%22isPlaceholder%22%3Atrue%7D%7D%2C%22mt%22%3A%22run%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A6%2C%22ei%22%3A7%2C%22pr%22%3A%7B%22run%22%3A%7B%22isPlaceholder%22%3Atrue%7D%7D%2C%22mt%22%3A%22run%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A7%2C%22ei%22%3A8%2C%22pr%22%3A%7B%22run%22%3A%7B%22isPlaceholder%22%3Atrue%7D%7D%2C%22mt%22%3A%22run%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A8%2C%22ei%22%3A9%2C%22pr%22%3A%7B%22run%22%3A%7B%22isPlaceholder%22%3Atrue%7D%7D%2C%22mt%22%3A%22run%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A9%2C%22ei%22%3A10%2C%22pr%22%3A%7B%22run%22%3A%7B%22isPlaceholder%22%3Atrue%7D%7D%2C%22mt%22%3A%22run%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A0%2C%22ei%22%3A1%2C%22pr%22%3A%7B%22paragraph%22%3A%7B%22pStyle%22%3A%7B%22val%22%3A%22rdbvau%22%7D%2C%22numPr%22%3A%7B%7D%2C%22jc%22%3A%7B%22val%22%3A%22STJcWml_left%22%7D%2C%22rPr%22%3A%7B%7D%7D%7D%2C%22mt%22%3A%22paragraph%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A1%2C%22ei%22%3A2%2C%22pr%22%3A%7B%22paragraph%22%3A%7B%22pStyle%22%3A%7B%22val%22%3A%22ablt93%22%7D%2C%22taskPr%22%3A%7B%7D%2C%22rPr%22%3A%7B%7D%7D%7D%2C%22mt%22%3A%22paragraph%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A2%2C%22ei%22%3A3%2C%22pr%22%3A%7B%22paragraph%22%3A%7B%22isPlaceholder%22%3Atrue%7D%7D%2C%22mt%22%3A%22paragraph%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A3%2C%22ei%22%3A4%2C%22pr%22%3A%7B%22paragraph%22%3A%7B%22isPlaceholder%22%3Atrue%7D%7D%2C%22mt%22%3A%22paragraph%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A4%2C%22ei%22%3A5%2C%22pr%22%3A%7B%22paragraph%22%3A%7B%22isPlaceholder%22%3Atrue%7D%7D%2C%22mt%22%3A%22paragraph%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A5%2C%22ei%22%3A6%2C%22pr%22%3A%7B%22paragraph%22%3A%7B%22isPlaceholder%22%3Atrue%7D%7D%2C%22mt%22%3A%22paragraph%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A6%2C%22ei%22%3A7%2C%22pr%22%3A%7B%22paragraph%22%3A%7B%22isPlaceholder%22%3Atrue%7D%7D%2C%22mt%22%3A%22paragraph%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A7%2C%22ei%22%3A8%2C%22pr%22%3A%7B%22paragraph%22%3A%7B%22isPlaceholder%22%3Atrue%7D%7D%2C%22mt%22%3A%22paragraph%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A8%2C%22ei%22%3A9%2C%22pr%22%3A%7B%22paragraph%22%3A%7B%22isPlaceholder%22%3Atrue%7D%7D%2C%22mt%22%3A%22paragraph%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A9%2C%22ei%22%3A10%2C%22pr%22%3A%7B%22paragraph%22%3A%7B%22isPlaceholder%22%3Atrue%7D%7D%2C%22mt%22%3A%22paragraph%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A2%2C%22ei%22%3A3%2C%22pr%22%3A%7B%22section%22%3A%7B%22pgSz%22%3A%7B%22w%22%3A11905%2C%22h%22%3A16838%7D%2C%22pgMar%22%3A%7B%22top%22%3A1361%2C%22right%22%3A1417%2C%22bottom%22%3A1361%2C%22left%22%3A1417%7D%7D%7D%2C%22mt%22%3A%22section%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A3%2C%22ei%22%3A4%2C%22pr%22%3A%7B%22story%22%3A%7B%22storyType%22%3A%22STStoryType_mainDocument%22%7D%7D%2C%22mt%22%3A%22story%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A4%2C%22ei%22%3A5%2C%22pr%22%3A%7B%22story%22%3A%7B%22storyType%22%3A%22STStoryType_headerContent%22%7D%7D%2C%22mt%22%3A%22story%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A5%2C%22ei%22%3A6%2C%22pr%22%3A%7B%22story%22%3A%7B%22storyType%22%3A%22STStoryType_footerContent%22%7D%7D%2C%22mt%22%3A%22story%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A6%2C%22ei%22%3A7%2C%22pr%22%3A%7B%22story%22%3A%7B%22storyType%22%3A%22STStoryType_footnoteContent%22%7D%7D%2C%22mt%22%3A%22story%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A7%2C%22ei%22%3A8%2C%22pr%22%3A%7B%22story%22%3A%7B%22storyType%22%3A%22STStoryType_endnoteContent%22%7D%7D%2C%22mt%22%3A%22story%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A8%2C%22ei%22%3A9%2C%22pr%22%3A%7B%22story%22%3A%7B%22storyType%22%3A%22STStoryType_commentContent%22%7D%7D%2C%22mt%22%3A%22story%22%7D%2C%7B%22ty%22%3A%22mp%22%2C%22bi%22%3A9%2C%22ei%22%3A10%2C%22pr%22%3A%7B%22story%22%3A%7B%22storyType%22%3A%22STStoryType_textboxContent%22%7D%7D%2C%22mt%22%3A%22story%22%7D%2C%7B%22ty%22%3A%22ms%22%2C%22pr%22%3A%7B%22numbering%22%3A%7B%7D%7D%2C%22mt%22%3A%22numbering%22%7D%2C%7B%22ty%22%3A%22ms%22%2C%22pr%22%3A%7B%22background%22%3A%7B%7D%7D%2C%22mt%22%3A%22background%22%7D%2C%7B%22ty%22%3A%22ms%22%2C%22pr%22%3A%7B%22themes%22%3A%7B%7D%7D%2C%22mt%22%3A%22themes%22%7D%2C%7B%22ty%22%3A%22ms%22%2C%22pr%22%3A%7B%22fonts%22%3A%7B%7D%7D%2C%22mt%22%3A%22fonts%22%7D%2C%7B%22ty%22%3A%22ms%22%2C%22pr%22%3A%7B%22styles%22%3A%7B%22style%22%3A%7B%22ablt93%22%3A%7B%22name%22%3A%7B%22val%22%3A%22Normal%22%7D%2C%22basedOn%22%3A%7B%22val%22%3A%22%22%7D%2C%22next%22%3A%7B%22val%22%3A%22%22%7D%2C%22pPr%22%3A%7B%22widowControl%22%3A%7B%22val%22%3Afalse%7D%2C%22jc%22%3A%7B%22val%22%3A%22STJcWml_left%22%7D%7D%2C%22type%22%3A%22STStyleType_paragraph%22%2C%22styleId%22%3A%22ablt93%22%2C%22defaultKeyword%22%3Atrue%7D%2C%22rdbvau%22%3A%7B%22name%22%3A%7B%22val%22%3A%22Title%22%7D%2C%22basedOn%22%3A%7B%22val%22%3A%22vevutl%22%7D%2C%22next%22%3A%7B%22val%22%3A%22ablt93%22%7D%2C%22uiPriority%22%3A%7B%22val%22%3A9%7D%2C%22qFormat%22%3A%7B%22val%22%3Atrue%7D%2C%22pPr%22%3A%7B%22keepNext%22%3A%7B%22val%22%3Atrue%7D%2C%22keepLines%22%3A%7B%22val%22%3Atrue%7D%2C%22spacing%22%3A%7B%22before%22%3A0%2C%22after%22%3A0%2C%22line%22%3A408%2C%22lineRule%22%3A%22STLineSpacingRule_auto%22%7D%2C%22jc%22%3A%7B%22val%22%3A%22STJcWml_center%22%7D%2C%22outlineLvl%22%3A%7B%22val%22%3A0%7D%7D%2C%22rPr%22%3A%7B%22b%22%3A%7B%22val%22%3Atrue%7D%2C%22bCs%22%3A%7B%22val%22%3Atrue%7D%2C%22color%22%3A%7B%22val%22%3A%221A1A1A%22%7D%2C%22sz%22%3A%7B%22val%22%3A480%7D%2C%22szCs%22%3A%7B%22val%22%3A480%7D%7D%2C%22type%22%3A%22STStyleType_paragraph%22%2C%22styleId%22%3A%22rdbvau%22%7D%2C%22vevutl%22%3A%7B%22name%22%3A%7B%22val%22%3A%22Normal%22%7D%2C%22basedOn%22%3A%7B%22val%22%3A%22%22%7D%2C%22next%22%3A%7B%22val%22%3A%22%22%7D%2C%22pPr%22%3A%7B%22widowControl%22%3A%7B%22val%22%3Afalse%7D%2C%22jc%22%3A%7B%22val%22%3A%22STJcWml_left%22%7D%7D%2C%22type%22%3A%22STStyleType_paragraph%22%2C%22styleId%22%3A%22vevutl%22%2C%22defaultKeyword%22%3Atrue%7D%7D%7D%7D%2C%22mt%22%3A%22styles%22%7D%2C%7B%22ty%22%3A%22ms%22%2C%22pr%22%3A%7B%22settings%22%3A%7B%7D%7D%2C%22mt%22%3A%22settings%22%7D%2C%7B%22ty%22%3A%22ms%22%2C%22pr%22%3A%7B%22webSettings%22%3A%7B%7D%7D%2C%22mt%22%3A%22webSettings%22%7D%5D%7D%5D%7D"),d.C.info("generateCreateFileBody after:",JSON.stringify(f)),r=encodeURIComponent(JSON.stringify(w(w({},f.initialAttributedText),{text:JSON.parse(unescape(f.initialAttributedText.text))}))),o=JSON.stringify(f.apool)}}var g,v=Math.max.apply(Math,n.map((function(e){return e.createTime}))),y=Math.floor(v/1e3);if(n.length>0){var m=this.offlineDataSort(n),b=this.composeOfflineData(i,u?m:[m[0]]);g=encodeURIComponent(JSON.stringify(b))}var _=l||t.folder||"/";d.C.log("createFile folder_id:",_);var C="string"==typeof i?i.split("$")[0]:"";return"create_type=11&pad_id="+("string"==typeof i?i.split("$")[1]:"")+"&domain_id="+C+"&doc_type="+a+"&templateId=0&xsrf="+(0,h.fM)()+"&version=2.0.0&folder_id="+_+"&title="+t.title+"&last_browse_ts="+y+(t.isUserChangeTitle?"&disable_auto_rename=1":"")+(r?"&atext="+r:"")+(o?"&apool="+o:"")+(g?"&data="+g:"")},e.prototype.updateOfflineDataBaseVersion=function(e,t,n){},e.prototype.updateClientVarsSocketInfo=function(e,t){return E(this,void 0,void 0,(function(){var n,o,i,a,s,c;return x(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),n=t.collab_client_vars.rev,o=t.collab_client_vars.padSubId,i=t.collab_client_vars.client.upid,[4,this.preFetchSingleSubBlockData(e,i,o,n)];case 1:return(a=l.sent()).error?[2,a]:(s=a.data.data,t.collab_client_vars.client=Object.assign(s.collab_client_vars.client,{upid:i}),t.collab_client_vars.pver=s.collab_client_vars.pver,t.collab_client_vars.apid=s.collab_client_vars.apid,t.collab_client_vars.wmode=s.collab_client_vars.wmode,t.collab_client_vars.websocketReopenCount=s.collab_client_vars.websocketReopenCount,t.collab_client_vars.pollingAttemptNumber=s.collab_client_vars.pollingAttemptNumber,t.userInfo=s.userInfo,[2,new r.x4(void 0,t)]);case 2:return c=l.sent(),[2,new r.x4(c)];case 3:return[2]}}))}))},e.prototype.getPadInfo=function(e,t){return void 0===t&&(t=o.tA.GLOBAL),E(this,void 0,void 0,(function(){var n,i;return x(this,(function(a){switch(a.label){case 0:switch(n=r.he.newInstance().addCondition("uid",r.E1.ONLY,this.parent.user.getUserId()),t){case o.tA.GLOBAL:n.addCondition("globalPadId",r.E1.ONLY,e);break;case o.tA.SECRET:n.addCondition("secretId",r.E1.ONLY,e)}return[4,this.database.get(o.me.PAD_INFO,n)];case 1:return(i=a.sent()).error?(d.C.error(i.error),[2,null]):[2,i.data]}}))}))},e.prototype.storeNewDocData=function(e,t,n,r,i,a){var s;return void 0===a&&(a=!1),E(this,void 0,void 0,(function(){var l,u,p,h,f,g,v;return x(this,(function(y){switch(y.label){case 0:return l=Date.now()/1e3,u=i.isManualOffline,p=i.isUserChangeTitle,(h=this.generatorPadInfo({globalPadId:n,localPadId:i.localPadId,secretId:r,padType:e,folder:t,dver:i.collab_client_vars.dver,initTitle:i.padTitle,time:l,isShareme:a,isManualOffline:u,isUserChangeTitle:p>0,status:c.DL.LOCAL})).creator_domain=this.getDomainId(n),(f=this.clientVars2OfflineData(n,i,!0)).padStatus=c.DL.LOCAL,g={globalPadId:n,secretId:r,uid:h.uid,lastSyncTime:l},[4,this.database.updateMultiTableData([{tableName:o.me.PAD_INFO,data:h},{tableName:o.me.DOCUMENT_DATA,data:f},{tableName:o.me.DOCUMENT_STATUS,data:g}])];case 1:return(v=y.sent()).error?(d.C.error("storeNewDocData ",null===(s=v.error)||void 0===s?void 0:s.stack),[2,v]):[2,v]}}))}))},e.prototype.preCreateDoc=function(){return E(this,void 0,void 0,(function(){var e,t,n,i;return x(this,(function(a){switch(a.label){case 0:return(e=r.he.newInstance()).addCondition("isCreated",r.E1.ONLY,!1),[4,this.database.getAll(o.me.NEW_DOCUMENT_ID,e)];case 1:return(t=a.sent()).error&&!(0,r.FG)(t.error)?[2,t]:(n=t.data)&&n.length>R?[2,this.preCreateDefaultClientVars(n)]:[4,this.parent.preFetchDocIds()];case 2:return(i=a.sent()).error?(d.C.error(i.error,""),[2,null]):[2,this.preCreateDoc()]}}))}))},e.prototype.updatePreFetchIdInfo=function(e){return E(this,void 0,void 0,(function(){return x(this,(function(t){switch(t.label){case 0:return(new r.he).addCondition("globalPadId",r.E1.ONLY,e.globalPadId),[4,this.database.updateMultiTableData([{tableName:o.me.NEW_DOCUMENT_ID,data:e}])];case 1:return t.sent(),[2]}}))}))},e.prototype.checkLocalClientVars=function(){return E(this,void 0,void 0,(function(){var e,t,n,i;return x(this,(function(a){switch(a.label){case 0:return e=[c.Gk.WORD,c.Gk.EXCEL,c.Gk.SLIDE],t=r.he.newInstance().addCondition("docType",r.E1.IN,e).addCondition("padStatus",r.E1.ONLY,c.DL.NEW).addCondition("uid",r.E1.ONLY,this.parent.user.getUserId()),n=new r.x4(void 0,{DocNum:0,ExcelNum:0,SlideNum:0}),[4,this.database.getAll(o.me.DOCUMENT_DATA,t)];case 1:return(i=a.sent()).error?(d.C.error(i.error,""),n.error=i.error,[2,n]):(i&&i.data&&i.data.forEach((function(e){e.docType===c.Gk.EXCEL?n.data.ExcelNum=n.data.ExcelNum+1:e.docType===c.Gk.WORD?n.data.DocNum=n.data.DocNum+1:e.docType===c.Gk.SLIDE&&(n.data.SlideNum=n.data.SlideNum+1)})),[2,n])}}))}))},e.prototype.updateFolderChildren=function(e,t){var n;return void 0===e&&(e="/"),E(this,void 0,void 0,(function(){var i,a;return x(this,(function(s){switch(s.label){case 0:return(i=new r.he).addCondition("key",r.E1.IN,[this.parent.user.getUserId()+e]),[4,this.database.get(o.me.FOLDER_INFO,i)];case 1:return(a=s.sent()).error?(d.C.error("updateFolderChildren() getPadInfo error",null===(n=a.error)||void 0===n?void 0:n.stack),[2,new r.x4(new Error("GetPadInfoError"))]):(a.data.childrenKey||(a.data.childrenKey=[]),a.data.childrenKey.push(t),[2,this.database.update(o.me.FOLDER_INFO,a.data)])}}))}))},e.prototype.getDomainId=function(e){return e.split("$")&&e.split("$").length?e.split("$")[0]:""},e.prototype.getDefaultInitTitle=function(e){var t="";switch(e){case c.Gk.WORD:t="";break;case c.Gk.EXCEL:t="";break;case c.Gk.SLIDE:t=""}return t},e.prototype.generatorPadInfo=function(e){var t=e.globalPadId,n=e.secretId,r=e.localPadId,o=e.padType,i=e.folder,a=e.dver,s=e.time,l=void 0===s?Date.now()/1e3:s,u=e.isShareme,d=void 0!==u&&u,p=e.status,h=e.isManualOffline,f=void 0!==h&&h,g=e.isUserChangeTitle,v=void 0!==g&&g,y=new c.BG(this.parent.user),m=this.parent.user.getUserId()+t,b=this.getDomainId(t);return w(w({},y),{key:m,type:o,uid:this.parent.user.getUserId(),globalPadId:t,domain_id:b,secretId:n,title:e.initTitle||this.getDefaultInitTitle(o),pad_id:r,status:p||c.DL.NEW,creator:this.parent.user.getUserId(),create_ts:l,doc_type:o,isMydoc:!0,isMyCreated:!0,isRencent:!0,isShareme:!0===d,isOfflineCache:!0,isManualOffline:f,isUserChangeTitle:v,dver:a,doc_type_desc:c.Yk[o],doc_url:"//docs.qq.com/"+c.Yk[o]+"/"+n,folder:i,privilege:0,last_modify_ts:l,last_browse_ts:l})},e.prototype.createPadInfo=function(e,t,n){return E(this,void 0,void 0,(function(){var i,a,s,c,l,u;return x(this,(function(p){switch(p.label){case 0:return(i=r.he.newInstance()).addCondition("isCreated",r.E1.IN,[!0]),i.addCondition("padType",r.E1.ONLY,e),[4,this.database.get(o.me.NEW_DOCUMENT_ID,i)];case 1:return(a=p.sent()).error?((i=r.he.newInstance()).addCondition("isCreated",r.E1.ONLY,!1),[4,this.database.get(o.me.NEW_DOCUMENT_ID,i)]):[3,6];case 2:return(a=p.sent()).error?[4,this.preCreateDoc()]:[3,5];case 3:return p.sent(),(i=r.he.newInstance()).addCondition("isCreated",r.E1.IN,[!0]),i.addCondition("padType",r.E1.ONLY,e),[4,this.database.get(o.me.NEW_DOCUMENT_ID,i)];case 4:return[2,a=p.sent()];case 5:a.data&&this.createDefaultClientVarsAndWriteDB(a.data),p.label=6;case 6:return this.parent.user&&this.parent.user.getUserId()?(s=a.data)?(c=this.getDverWithPadType(e),l=Date.now()/1e3,u=this.generatorPadInfo({globalPadId:s.globalPadId,secretId:s.secretId,localPadId:s.localPadId,padType:e,folder:t,dver:c,time:l,isShareme:n}),i=r.he.newInstance().addCondition("globalPadId",r.E1.ONLY,s.globalPadId),[4,this.database.delete(o.me.NEW_DOCUMENT_ID,i)]):(d.C.error({retcode:-1,reason:"indexDB has not NewDocumentIds!"}),[2,new r.x4(new Error("NoAvaliableIdError"))]):[2,new r.x4(new Error("UidError"))];case 7:return p.sent(),[4,this.database.set(o.me.PAD_INFO,u)];case 8:return p.sent(),[4,this.updateFolderChildren(t,u.key)];case 9:return p.sent(),this.preCreateDoc(),[2,new r.x4(void 0,u)]}}))}))},e.prototype.createPadInfoFromClientVars=function(e){return E(this,void 0,void 0,(function(){var t,n;return x(this,(function(r){switch(r.label){case 0:return t=e.globalPadId,[4,this.getPadInfo(t)];case 1:return r.sent()||(n=this.buildPadInfo(e))&&(d.C.log("padInfo",n),this.database.set(o.me.PAD_INFO,n)),[2]}}))}))},e.prototype.getManualPadInfo=function(e){return E(this,void 0,void 0,(function(){var t,n,i;return x(this,(function(a){switch(a.label){case 0:return t=this.parent.user.getUserId(),n=r.he.newInstance().addCondition("uid",r.E1.ONLY,t).addCondition("isManualOffline",r.E1.ONLY,!0).addCondition("secretId",r.E1.ONLY,e),[4,this.database.get(o.me.PAD_INFO,n)];case 1:return(i=a.sent()).error&&d.C.error("",i.error),[2,i]}}))}))},e.prototype.setDefaultCodeVersion=function(e,t){this.defaultCodeVersion.set(e,t),localStorage.setItem(e+"_code_version",t)},e.prototype.getCodeVersion=function(e){return this.defaultCodeVersion.get(e)||localStorage.getItem(e+"_code_version")||""},e.prototype.getDverWithPadType=function(e){return e===c.Gk.EXCEL?this.getCodeVersion("sheet"):e===c.Gk.WORD?this.getCodeVersion("doc"):e===c.Gk.SLIDE?this.getCodeVersion("slide"):void 0},e.prototype.getTypeStringWithPadType=function(e){return e===c.Gk.EXCEL?"sheet":e===c.Gk.WORD?"word":e===c.Gk.SLIDE?"slide":void 0},e}()},81814:function(e,t,n){n.d(t,{l6:function(){return o},GU:function(){return i.GU},hS:function(){return d.hS},H4:function(){return a.H4},Gk:function(){return c.Gk},RR:function(){return i.RR},Zb:function(){return p.Z},Nt:function(){return s.N},TU:function(){return s.T},Sg:function(){return v},DL:function(){return c.DL},E1:function(){return i.E1},he:function(){return i.he},x4:function(){return i.x4},me:function(){return a.me},ao:function(){return l},ej:function(){return u.ej},Tf:function(){return u.Tf}});var r,o,i=n(26914),a=n(50603),s=n(84425),c=n(77914),l=function(){function e(e){this.uid=e.uid||"",this.uin=e.uin?e.uin:"",this.loginTime=(new Date).getTime()}return e.prototype.getUserId=function(){return this.uid},e.prototype.setUserId=function(e){this.uid=e},e}(),u=(n(69989),function(){function e(){}e.convertData2ClientVars=function(e){},e.unpackEjsData=function(e){for(var t=0,n=e||"",r=n.length,o={};t<r;){var i=n.slice(t,t+50).split("\n");if(!(i&&i.length>=3))break;var a=i[0],s=i[1],c=parseInt(i[2]);t+=i[0].length+i[1].length+i[2].length+3;var l=n.slice(t,t+c);t+=c+1,o[a]={type:s},o[a].value="json"===s?JSON.parse(l):l}return o},e.updateClientVarsByEditPadInfo=function(e,t){e&&e.globalPadId===t.padInfo.globalPadId&&(t.privilegeAttribute&&(e.privilegeAttribute=t.privilegeAttribute),t.advPolicy&&(e.advPolicy=t.advPolicy),t.title&&(e.padTitle=t.title))}}(),n(26516)),d=n(71314),p=(n(74762),n(81405),n(3578),n(51015)),h=function(){return h=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},h.apply(this,arguments)},f=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},g=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},v=function(){function e(e){this.options=e,e&&void 0!==e.businessType&&(this.businessType=e.businessType);var t=(0,u.n5)();e&&e.user?this.user=e.user:this.user=new l(t?{uid:t}:{uid:"guest"}),e&&(this.isSupportClientDB=e.isSupportClientDB),p.C.log("OfflineDataManager",this.user.getUserId())}return e.prototype.init=function(){return f(this,void 0,void 0,(function(){var e,t,n,r,o,s,l,d,h,f;return g(this,(function(g){switch(g.label){case 0:return e=this.isSupportClientDB?this.isSupportClientDB():!!(0,u.N1)(),t=e&&!(0,u.kK)(),n=new i.ZP(a.H4,[{tableName:a.me.DOCUMENT_DATA,keyName:"key",indexs:["globalPadId","secretId","type","version","uid","subId","chunkId"]},{tableName:a.me.OFFLINE_DATA,keyName:"key",indexs:["globalPadId","secretId","type","version","uid","subId","chunkId"]},{tableName:a.me.PAD_INFO,keyName:"key",indexs:["globalPadId","secretId","uid"]},{tableName:a.me.NEW_DOCUMENT_ID,keyName:"globalPadId"},{tableName:a.me.FOLDER_INFO,keyName:"key"},{tableName:a.me.USER_INFO,keyName:"uid"},{tableName:a.me.DOCUMENT_STATUS,keyName:"globalPadId",indexs:["globalPadId","secretId","uid"]},{tableName:a.me.DATA_CHANGE,keyName:"key"},{tableName:a.me.DocumentEntities,keyName:"key"},{tableName:a.me.USERS,keyName:"key",indexs:["tinyId","nowUserIndex","docId","pageType"]}],t?i.XT.ClientDB:i.XT.IndexDB,a.kd),this.database=n.database,[4,this.database.init()];case 1:return(r=g.sent()).error?(p.C.error(r.error),[2,r]):(p.C.log("init IndexedDB success"),this.businessType!==c.Gk.EXCEL?[3,3]:(o=this,[4,this.createHelper(c.Gk.EXCEL)]));case 2:return o.excelHelper=g.sent(),[3,11];case 3:return this.businessType!==c.Gk.WORD?[3,5]:(s=this,[4,this.createHelper(c.Gk.WORD)]);case 4:return s.wordHelper=g.sent(),[3,11];case 5:return this.businessType!==c.Gk.SLIDE?[3,7]:(l=this,[4,this.createHelper(c.Gk.SLIDE)]);case 6:return l.slideHelper=g.sent(),[3,11];case 7:return d=this,[4,this.createHelper(c.Gk.EXCEL)];case 8:return d.excelHelper=g.sent(),h=this,[4,this.createHelper(c.Gk.WORD)];case 9:return h.wordHelper=g.sent(),f=this,[4,this.createHelper(c.Gk.SLIDE)];case 10:f.slideHelper=g.sent(),g.label=11;case 11:return[2,new i.x4(void 0,!0)]}}))}))},e.prototype.getHelper=function(e){var t;if(void 0===e&&(e=this.businessType),e===c.Gk.EXCEL)t=this.excelHelper;else if(e===c.Gk.WORD)t=this.wordHelper;else{if(e!==c.Gk.SLIDE)throw new Error("businessType getHeplerFILE_TYPEhelper.");t=this.slideHelper}return t},e.prototype.getDatabase=function(){return this.database},e.prototype.popDocumentId=function(){return f(this,void 0,void 0,(function(){var e,t,n;return g(this,(function(r){switch(r.label){case 0:return this.user&&this.user.getUserId()?[4,this.getDocumentId()]:[2,new i.x4(new Error("UidError"))];case 1:return(e=r.sent()).error?[4,this.preFetchDocIds()]:[3,4];case 2:return r.sent(),[4,this.getDocumentId()];case 3:e=r.sent(),r.label=4;case 4:return(t=e.data)?(n=i.he.newInstance().addCondition("globalPadId",i.E1.ONLY,t.globalPadId),[4,this.database.delete(a.me.NEW_DOCUMENT_ID,n)]):(p.C.error({retcode:-1,reason:"indexDB has not NewDocumentIds!"}),[2,new i.x4(new Error("NoAvaliableIdError"))]);case 5:return r.sent(),this.preFetchDocIds(),[2,new i.x4(void 0,t)]}}))}))},e.prototype.preFetchDocIds=function(){return f(this,void 0,void 0,(function(){var e,t,n,r,o,s,l,u,h;return g(this,(function(f){switch(f.label){case 0:return(e=i.he.newInstance()).addCondition("isCreated",i.E1.ONLY,!1),[4,this.database.getAll(a.me.NEW_DOCUMENT_ID,e)];case 1:return(t=f.sent()).error?[2,t]:(n=t.data)&&n.length>25?[2,new i.x4(new Error("ID"),{count:n.length})]:[4,d.hS.sendCommonRequest("https://docs.qq.com/cgi-bin/online_docs/predocid_get")];case 2:if((r=f.sent()).error)return[2,r];o=r.data,f.label=3;case 3:return f.trys.push([3,6,,7]),0!==o.retcode?[3,5]:(s=o.doc_id_list.splice(0,50),l=s.map((function(e){return{globalPadId:e.domain_id+"$"+e.pad_id,localPadId:""+e.pad_id,secretId:""+e.encoded_doc_id,isCreated:!1,padType:c.Gk.UNKNOWN}})),u=l.map((function(e){return{tableName:a.me.NEW_DOCUMENT_ID,data:e}})),[4,this.database.updateMultiTableData(u)]);case 4:return[2,f.sent()];case 5:return p.C.error("retCode0"),[2,new i.x4(new Error(""))];case 6:return h=f.sent(),p.C.error(h,""),[2,new i.x4(h)];case 7:return[2]}}))}))},e.prototype.checkEvn=function(){return f(this,void 0,void 0,(function(){var e,t,n,r;return g(this,(function(o){return e=localStorage.getItem("last_dev_route_id"),t=localStorage.getItem("last_fd"),n=(0,u.ej)("dev_route_id"),r=(0,u.ej)("fd"),e!==n||t!==r?(this.setEvn(n,r),[2,!0]):(this.setEvn(n,r),[2,!1])}))}))},e.prototype.setEvn=function(e,t){localStorage.setItem("last_dev_route_id",e),localStorage.setItem("last_fd",t)},e.prototype.mapDocumentVersion=function(e,t){var r,o;p.C.debug("mapDocumentVersion  "+t+":"+e);var i={url:t,dver:e},a=function(e){p.C.info("mapDocumentVersion "+JSON.stringify(e))};u.Zp.isDesktop?this.sendCommandToSW({type:"preload-map-document-version",data:i}):(null===(r=n.g.tdocs)||void 0===r?void 0:r.mapDocumentVersion)?n.g.tdocs.mapDocumentVersion(h(h({},i),{success:a})):null===(o=window.mqq)||void 0===o||o.invoke("docx","mapDocumentVersion",i,a)},e.prototype.removeDocumentVersion=function(e){var t,r;p.C.debug("removeDocumentVersion "+e);var o=function(e){p.C.info("removeDocumentVersion "+JSON.stringify(e))};u.Zp.isDesktop?this.sendCommandToSW({type:"preload-remove-document-version",data:e}):(null===(t=n.g.tdocs)||void 0===t?void 0:t.removeDocumentVersion)?n.g.tdocs.removeDocumentVersion({url:e,success:o}):null===(r=window.mqq)||void 0===r||r.invoke("docx","removeDocumentVersion",{url:e},o)},e.prototype.sendCommandToSW=function(e){navigator.serviceWorker.controller?(p.C.debug("send command to service worker "+JSON.stringify(e)),navigator.serviceWorker.controller.postMessage(e)):p.C.error("service worker is not available")},e.prototype.createHelper=function(e){return f(this,void 0,void 0,(function(){var t;return g(this,(function(r){switch(r.label){case 0:switch(t={parent:this,database:this.database},e){case c.Gk.WORD:return[3,1];case c.Gk.EXCEL:return[3,3];case c.Gk.SLIDE:return[3,5]}return[3,7];case 1:return[4,n.e(6140).then(n.bind(n,76863))];case 2:return[2,new(0,r.sent().WordHelper)(t)];case 3:return[4,n.e(4053).then(n.bind(n,98014))];case 4:return[2,new(0,r.sent().ExcelHelper)(t)];case 5:return[4,n.e(8810).then(n.bind(n,55363))];case 6:return[2,new(0,r.sent().SlideHelper)(t)];case 7:return[2,void 0]}}))}))},e.prototype.getDocumentId=function(){return f(this,void 0,void 0,(function(){var e;return g(this,(function(t){return(e=i.he.newInstance()).addCondition("isCreated",i.E1.ONLY,!1),[2,this.database.get(a.me.NEW_DOCUMENT_ID,e)]}))}))},e}();!function(e){e.rename="rename",e.delete="delete"}(r||(r={})),r.rename,r.delete,function(e){e[e.listTypeOffline=-1]="listTypeOffline",e[e.listTypeAll=1]="listTypeAll",e[e.listTypeCreated=2]="listTypeCreated",e[e.listTypeTrash=3]="listTypeTrash",e[e.listTypeShared=4]="listTypeShared",e[e.listTypeMyDoc=5]="listTypeMyDoc",e[e.listTypeRecent=6]="listTypeRecent",e[e.listTypeStared=7]="listTypeStared",e[e.listTypeInSharedFolder=9]="listTypeInSharedFolder"}(o||(o={}));var y,m=!1,b=(function(){function e(){}e.setForceRefresh=function(e){m=e},e.isForceRefresh=function(){return m}}(),function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}),_=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};!function(e){e.SNAP_SHOT="SNAP_SHOT",e.CHUNK="CHUNK",e.VERSION_DATA="VERSION_DATA"}(y||(y={}));var C,S={data:{startRow:-1,endRow:-1,data:[[]]}};!function(){function e(){}e.getDatabaseInstance=function(){return b(this,void 0,void 0,(function(){var e,t,n;return _(this,(function(r){switch(r.label){case 0:if(this.dbInstance)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,(e=new v({businessType:c.Gk.EXCEL,user:new l({uid:this.uid})})).init()];case 2:return(t=r.sent()).error?(p.C.error("getDatabaseInstance() init error",t.error),this._offlineDataManager=null,this.dbInstance=null,[2,null]):(this._offlineDataManager=e,this.dbInstance=e.database,[3,4]);case 3:return n=r.sent(),p.C.error("getDatabaseInstance",n),[3,4];case 4:return[2,this.dbInstance]}}))}))},Object.defineProperty(e,"offlineDataManager",{get:function(){return e._offlineDataManager||null},enumerable:!1,configurable:!0}),e.loadDocumentData=function(e){var t,n;return b(this,void 0,void 0,(function(){var r,o,c,l,u,d,h,f,g,v,m,b,C,w,E,x,T,R,I,P,O,k,D,M,A,L,N,B,F,U=this;return _(this,(function(_){switch(_.label){case 0:return r=Date.now(),o=e.id,c=e.subId,l=e.onSuccess,u=e.onFail,[4,this.getDatabaseInstance()];case 1:return d=_.sent(),h=i.he.newInstance().addCondition("type",i.E1.IN,[s.N.DOCUMENT,"ducument"]).orderby("version",i.Rs.DECREASE).addCondition("uid",i.E1.ONLY,this.uid).addCondition("secretId",i.E1.ONLY,o),[4,d.get(a.me.DOCUMENT_DATA,h)];case 2:return(f=_.sent()).error?(u&&u(new Error("document "+f.error)),[2]):(g=f.data,v=Date.now(),m=c&&g&&g.data&&g.data.collab_client_vars.header[0].d.filter((function(e){return e.id===c}))||[],c&&0!==m.length||(c=g&&g.data&&g.data.collab_client_vars.header[0].d[0].id||""),(b=g.data).collab_client_vars.padSubId=c,C=b.collab_client_vars.rev||0,"new"===b.padStatus?[3,5]:(x=i.he.newInstance().addCondition("type",i.E1.IN,[s.N.ACCEPTED,s.N.MISS_CHANGE,s.N.NEW_CHANGE]).addCondition("uid",i.E1.ONLY,this.uid).addCondition("secretId",i.E1.ONLY,o).orderby("version",i.Rs.DECREASE).limit(0,1),[4,d.get(a.me.DOCUMENT_DATA,x)]));case 3:return(T=_.sent()).error&&!(0,i.FG)(T.error)?(p.C.error("",T.error),u&&u(new Error("")),[2]):(!T.error&&T.data&&(R=Math.max(C,T.data.version),b.collab_client_vars.rev=R),I=i.he.newInstance().addCondition("type",i.E1.IN,[s.N.WORKBOOK,s.N.CHUNK]).addCondition("uid",i.E1.ONLY,this.uid).addCondition("subSheetId",i.E1.IN,["workbook",c]).addCondition("chunkId",i.E1.ONLY,0).addCondition("secretId",i.E1.ONLY,o),[4,d.getAll(a.me.DOCUMENT_DATA,I)]);case 4:if((P=_.sent()).error)return u&&u(new Error("documentData "+P.error)),[2];w=P.data.filter((function(e){return"workbook"===e.type}))[0],E=P.data.filter((function(e){return"chunk"===e.type}))[0],_.label=5;case 5:return E&&0!==(null===(t=E.data)||void 0===t?void 0:t.length)||(E={data:{startRow:0,endRow:200,data:null===(n=b.collab_client_vars)||void 0===n?void 0:n.initialAttributedText.text[0]}}),O=Date.now(),p.C.log(". document:"+(v-r)+"ms  workbook&subDocument: "+(O-v)+"ms"),l&&l({dataType:y.SNAP_SHOT,subId:c,clientVars:b,workbookData:w&&w.data||S.data,chunkData:E&&E.data||S.data}),k=Date.now(),p.C.log(":"+(k-r)+"ms"),D=i.he.newInstance().addCondition("type",i.E1.ONLY,s.N.CHUNK).addCondition("uid",i.E1.ONLY,this.uid).addCondition("subSheetId",i.E1.ONLY,c).addCondition("version",i.E1.ONLY,C).addCondition("secretId",i.E1.ONLY,o).orderby("chunkId",i.Rs.INCREASE),[4,d.getAll(a.me.DOCUMENT_DATA,D)];case 6:return(M=_.sent()).error?(u&&u(new Error("otherSubDocumentData "+M.error)),[2]):(M.data.filter((function(e){return e.chunkId>=1})).forEach((function(e){l&&l({subId:c,dataType:y.CHUNK,chunkData:e.data})})),A=i.he.newInstance().addCondition("type",i.E1.IN,[s.N.ACCEPTED,s.N.MISS_CHANGE,s.N.NEW_CHANGE]).addCondition("uid",i.E1.ONLY,this.uid).addCondition("secretId",i.E1.ONLY,o).orderby("version",i.Rs.INCREASE),[4,d.getAll(a.me.DOCUMENT_DATA,A)]);case 7:return(L=_.sent()).error?(u&&u(new Error("breakVersionData "+L.error)),[2]):(N=L.data,B=N.map((function(e){return U.breakVersionDataParse(e)})).filter((function(e){return e.version>C})).sort((function(e,t){return e.version-t.version})),l&&l({subId:c,dataType:y.VERSION_DATA,chunkData:B,isFinished:!0}),F=Date.now(),p.C.log(":"+(Date.now()-r)+"ms   breakVersion: "+(F-k)+"ms"),[2])}}))}))},e.loadBreakVersions=function(e,t,n){return b(this,void 0,void 0,(function(){var r,o,c,l,u,d=this;return _(this,(function(p){switch(p.label){case 0:return console.time("loadBreakVersions"),[4,this.getDatabaseInstance()];case 1:return r=p.sent(),o=i.he.newInstance().addCondition("type",i.E1.IN,[s.N.ACCEPTED,s.N.MISS_CHANGE,s.N.NEW_CHANGE]).addCondition("uid",i.E1.ONLY,this.uid).addCondition("secretId",i.E1.ONLY,e).orderby("version",i.Rs.INCREASE),[4,r.getAll(a.me.DOCUMENT_DATA,o)];case 2:return(c=p.sent()).error?(Promise.reject(new Error("breakVersionData "+c.error)),[2]):(l=c.data,u=l.map((function(e){return d.breakVersionDataParse(e)})).filter((function(e){return e.version>=t&&(void 0===n||e.version<=n)})),console.timeEnd("loadBreakVersions"),[2,Promise.resolve(u)])}}))}))},e.loadSubDocumentData=function(e){return b(this,void 0,void 0,(function(){var t,n,r,o,c,l,u,d,h,f,g,v,m,b,C,w,E,x,T,R,I,P,O,k,D=this;return _(this,(function(_){switch(_.label){case 0:return t=Date.now(),n=e.id,r=e.subId,o=e.baseVersion,c=e.onSuccess,l=e.onFail,void 0===n||void 0===r||void 0===o?(l&&l(new Error("loadSubDocumentData"+JSON.stringify(e))),[2]):[4,this.getDatabaseInstance()];case 1:return u=_.sent(),d=i.he.newInstance().addCondition("uid",i.E1.ONLY,this.uid).addCondition("secretId",i.E1.ONLY,n).orderby("version",i.Rs.DECREASE).limit(0,1),[4,u.get(a.me.DOCUMENT_DATA,d)];case 2:return(h=_.sent()).error?(l&&l(new Error(" "+h.error)),[2]):(f=h.data.version)<o?(l&&l(new Error(""+o+"  maxVersion="+f)),[2]):(g=i.he.newInstance().addCondition("type",i.E1.ONLY,s.N.CHUNK).addCondition("uid",i.E1.ONLY,this.uid).addCondition("subSheetId",i.E1.ONLY,r).addCondition("secretId",i.E1.ONLY,n).orderby("chunkId",i.Rs.INCREASE),[4,u.getAll(a.me.DOCUMENT_DATA,g)]);case 3:return(v=_.sent()).error?(l&&l(new Error("subDocumentData "+v.error)),[2]):(m=v.data,b=[],C=0,m.filter((function(e){return e.version<=o})).forEach((function(e){b.push(e),C=Math.max(C,e.version)})),0!==(b=b.filter((function(e){return e.version===C}))).length?[3,5]:(w=i.he.newInstance().addCondition("type",i.E1.IN,[s.N.DOCUMENT,"ducument"]).addCondition("uid",i.E1.ONLY,this.uid).addCondition("secretId",i.E1.ONLY,n),[4,u.get(a.me.DOCUMENT_DATA,w)]));case 4:if((E=_.sent()).error)return l&&l(new Error(" "+E.error)),[2];b=[S],_.label=5;case 5:return x=Date.now(),p.C.log("keyfrme:"+(x-t)+"ms"),c&&c({dataType:y.SNAP_SHOT,subId:r,chunkData:b}),T=Date.now(),p.C.log("keyframe:"+(T-x)+"ms"),R=i.he.newInstance().addCondition("type",i.E1.IN,[s.N.ACCEPTED,s.N.MISS_CHANGE,s.N.NEW_CHANGE]).addCondition("uid",i.E1.ONLY,this.uid).addCondition("secretId",i.E1.ONLY,n).addCondition("subSheetId",i.E1.ONLY,r).orderby("version",i.Rs.INCREASE),[4,u.getAll(a.me.DOCUMENT_DATA,R)];case 6:return(I=_.sent()).error?(l&&l(new Error("breakVersionData "+I.error)),[2]):(P=I.data,O=P.map((function(e){return D.breakVersionDataParse(e)})).filter((function(e){return e.version>C&&e.version<=o})).sort((function(e,t){return e.version-t.version})),k=Date.now(),p.C.log(":"+(k-T)+"ms"),c&&c({dataType:y.VERSION_DATA,subId:r,chunkData:O,isFinished:!0}),p.C.log(":"+(Date.now()-k)+"ms"),[2])}}))}))},e.clearDocumentCache=function(e,t){return b(this,void 0,void 0,(function(){var n,r,o;return _(this,(function(s){switch(s.label){case 0:return[4,this.getDatabaseInstance()];case 1:return n=s.sent(),r=i.he.newInstance().addCondition("secretId",i.E1.ONLY,e).addCondition("uid",i.E1.ONLY,t),[4,n.delete(a.me.DOCUMENT_DATA,r)];case 2:return(o=s.sent()).error?[3,4]:[4,n.delete(a.me.DOCUMENT_STATUS,r)];case 3:o=s.sent(),s.label=4;case 4:return o.error?[3,6]:[4,n.updateField(a.me.PAD_INFO,r,{isOfflineCache:!1})];case 5:o=s.sent(),s.label=6;case 6:return[2,o]}}))}))},e.breakVersionDataParse=function(e){return e.type===s.N.ACCEPTED?{version:e.version,subId:e.data.data.subId,keyframe:e.data.data.keyData||void 0,data:e.data.data.mutations||e.data.data.changeData,changesetType:e.data.data.changesetType}:{version:e.data.newVersion,subId:e.data.sheetId,data:JSON.parse(e.data.changeset),changesetType:e.data.changesetType}},e.uid=(0,u.n5)()}(),function(e){e[e.downloadStart=0]="downloadStart",e[e.downloadEnd=1]="downloadEnd",e[e.downloadCancel=2]="downloadCancel",e[e.uploadStart=3]="uploadStart",e[e.uploadEnd=4]="uploadEnd"}(C||(C={})),function(){function e(){}e.notifyNative=function(t){i.RR.invokeNative("docx","notifyNative",t,(function(){p.Z.debug(e.TAG,"notifyNative ",t)}))},e.callClient=function(t,n){i.RR.invokeNative("docx","callClient",{method:t,data:n},(function(){p.Z.debug(e.TAG,"callClient method:"+t+" data:"+n)}))},e.TAG="BridgeHelper"}(),n(17242)},17242:function(e,t,n){var r;n.d(t,{D:function(){return r}}),function(e){e[e.UnknownError=-1]="UnknownError",e[e.Success=0]="Success",e[e.NoGlobalPadIdError=-1001]="NoGlobalPadIdError",e[e.InvalidFileTypeError=-1002]="InvalidFileTypeError",e[e.InvalidUrlError=-1003]="InvalidUrlError",e[e.PreloadParseError=-1004]="PreloadParseError",e[e.AIOUrlTypeError=-1005]="AIOUrlTypeError",e[e.GetDocumentStatusError=-2001]="GetDocumentStatusError",e[e.RejcectByThrottleError=-2002]="RejcectByThrottleError",e[e.GetDocLockError=-2003]="GetDocLockError",e[e.GetUncommitDataError=-2004]="GetUncommitDataError",e[e.CreateFileError=-2005]="CreateFileError",e[e.CommitOfflineDataError=-2006]="CommitOfflineDataError",e[e.UpdateUnCommitedDataError=-2007]="UpdateUnCommitedDataError",e[e.PreFetchDocDataError=-2008]="PreFetchDocDataError",e[e.UpdatePreFetchOfflienDataError=-2009]="UpdatePreFetchOfflienDataError",e[e.UpdatePadInfoError=-2010]="UpdatePadInfoError",e[e.SyncOfflineDataUnknownError=-2011]="SyncOfflineDataUnknownError",e[e.PadInfoNotExistError=-2012]="PadInfoNotExistError",e[e.FileNotExsitError=-2013]="FileNotExsitError",e[e.HttpStatusError=-2014]="HttpStatusError",e[e.DocumentBlankPageError=-2015]="DocumentBlankPageError"}(r||(r={}))},84425:function(e,t,n){n.d(t,{N:function(){return r},T:function(){return a}});var r,o=n(77914),i=n(51015);!function(e){e.INIT="init",e.DOCUMENT="document",e.WORKBOOK="workbook",e.CHUNK="chunk",e.ACCEPTED="accepted",e.MISS_CHANGE="misschange",e.NEW_CHANGE="newchange",e.COMMITING="commiting",e.WATTING="watting",e.QUEUE="queue"}(r||(r={}));var a=function(){function e(t){this.chunkId=0,this.default=!1,t.taskId||(t.taskId=e.createMessageSeq()),t.key||(t.chunkId=t.chunkId||0,t.type===r.INIT?t.key=t.globalPadId+"_"+t.subSheetId+"_"+t.uid:t.type===r.DOCUMENT?t.key=t.globalPadId+"_"+t.uid+"_version_"+t.version:t.type===r.WORKBOOK?t.key=t.globalPadId+"_"+t.subSheetId+"_"+t.uid+"_version_"+t.version:t.type===r.CHUNK?t.key=t.globalPadId+"_"+t.subSheetId+"_"+t.chunkId+"_"+t.uid+"_version_"+t.version:t.key=t.globalPadId+"_"+t.subSheetId+"_"+t.uid+"_taskId_"+t.taskId),t.default=t.default||!1,this.key=t.key,this.uid=t.uid,this.globalPadId=t.globalPadId,this.secretId=t.secretId,this.subSheetId=t.subSheetId,this.chunkId=t.chunkId,this.type=t.type,this.docType=t.docType,this.padStatus=t.padStatus,this.taskId=t.taskId,this.version=t.version,this.data=t.data||t._data,this.default=t.default,this.createTime=t.createTime,this.dver=t.dver}return e.createMessageSeq=function(){return Math.ceil(2147483648*Math.random())},e.prototype.disableConvert=function(){return this.docType===o.Gk.WORD&&"BB08J2"!==this.subSheetId},Object.defineProperty(e.prototype,"data",{get:function(){if("string"==typeof this._data&&!this.disableConvert()){var e=this._data;try{e=JSON.parse(this._data)}catch(e){i.Z.error(e)}return e}return this._data},set:function(e){this._data="string"!=typeof e?JSON.stringify(e):e},enumerable:!1,configurable:!0}),e}()},77914:function(e,t,n){var r,o,i,a;n.d(t,{BG:function(){return u},DL:function(){return i},Gk:function(){return o},Yk:function(){return l},w1:function(){return a}}),function(e){e[e.UNKNOWN=-1]="UNKNOWN",e[e.WORD=0]="WORD",e[e.EXCEL=1]="EXCEL",e[e.SLIDE=4]="SLIDE"}(o||(o={})),function(e){e.NEW="new",e.LOCAL="local",e.DELETED="deleted",e.NORMAL="normal"}(i||(i={})),function(e){e.SHEET="sheet",e.WORD="doc",e.FORM="form",e.SLIDE="slide"}(a||(a={}));var s,c,l=((r={})[o.EXCEL]=a.SHEET,r[o.WORD]=a.WORD,r[o.SLIDE]=a.SLIDE,r);!function(e){e[e.MY_DOC=5]="MY_DOC",e[e.RECENT=6]="RECENT",e[e.SHARE=4]="SHARE",e[e.STAR=7]="STAR",e[e.TRASH=3]="TRASH"}(s||(s={})),function(e){e[e.FILE=1]="FILE",e[e.FOLDER=2]="FOLDER"}(c||(c={}));var u=function(e,t,n){this.folder_id="",this.attribute=null,this.parents=[],this.isOfflineCache=!1,this.isSnapShot=!1,this.doc_policy=0,this.folder_policy=0,this.doc_privilege=null,this.folder_privilege=null,this.is_added_my=0,this.is_collected=0,this.is_owner=1,this.is_pinned=0,this.is_shortcut=0,this.isManualOffline=!1,this.isUserChangeTitle=!1,this.add_list_ts=0,this.last_collect_ts=0,this.last_delete_ts=0,this.last_pinned_ts=null;var r=(new Date).getTime()/1e3;this.last_browse_ts=r,this.last_modify_ts=r,this.create_ts=r,this.list_type=s.MY_DOC,this.list_info_type=c.FILE,this.owner_uid=e.getUserId(),this.owner_nick=e.getUserId(),this.uid=e.getUserId(),this.last_modify_nick=e.getUserId(),this.last_modify_uid=e.getUserId(),void 0!==t&&(this.isMydoc=t),void 0!==n&&(this.isRencent=n)}},71314:function(e,t,n){n.d(t,{hS:function(){return d},n$:function(){return r}});var r,o,i=n(26516),a=n(26914),s=n(51015),c=n(36445),l=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},u=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};!function(e){e.POST="POST",e.GET="GET"}(r||(r={})),function(e){e[e.privilegeAttribute=1]="privilegeAttribute",e[e.title=2]="title"}(o||(o={}));var d=function(){function e(){}return e.transferHide2Normal=function(e){return l(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return t="'encrypted_doc_id="+e,[4,this.sendCommonRequest("/cgi-bin/online_docs/doc_transferhidetonormal",r.POST,t)];case 1:return[2,n.sent()]}}))}))},e.notifyOpenDoc=function(e){return l(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return t="'encrypted_doc_id="+e,[4,this.sendCommonRequest("/cgi-bin/online_docs/doc_broselistadd?t=1",r.POST,t)];case 1:return[2,n.sent()]}}))}))},e.fetchDocDataSlide=function(e,t){return void 0===t&&(t=!1),l(this,void 0,void 0,(function(){var n;return u(this,(function(o){switch(o.label){case 0:return n=c.f+"/dop-api/slide/data/get?id="+e+"&normal=1&prefetch=1&offline=1",[4,this.sendCommonRequest(n,r.GET,"",t?void 0:"custom")];case 1:return[2,o.sent()]}}))}))},e.fetchDocData=function(e,t,n,o){return void 0===n&&(n=!0),void 0===o&&(o=!1),l(this,void 0,void 0,(function(){var a,s;return u(this,(function(c){switch(c.label){case 0:return t&&t.indexOf("?")>-1||(t+="?"),a=(0,i.ej)("preview_token"),s="/dop-api/opendoc"+t+(n&&"&prefetch=1")+(o?"&outformat=1":"")+"&normal=1&id="+e+"&key="+a+"&xsrf="+(0,i.fM)(),[4,this.sendCommonRequest(s,r.GET,"",o?void 0:"custom")];case 1:return[2,c.sent()]}}))}))},e.getPadInfo=function(e,t){return l(this,void 0,void 0,(function(){var n;return u(this,(function(o){switch(o.label){case 0:return n="/cgi-go/padinfo/getpadinfo?encodePadId="+e+(t?"&infoKeys=["+t+"]":"")+"&xsrf="+(0,i.fM)(),[4,this.sendCommonRequest(n,r.GET)];case 1:return[2,o.sent()]}}))}))},e.sendCommonRequest=function(e,t,n,o){return void 0===t&&(t=r.GET),l(this,void 0,void 0,(function(){return u(this,(function(r){return[2,new Promise((function(r,i){try{var c,l=new XMLHttpRequest;l.onreadystatechange=function(){if(l.readyState===XMLHttpRequest.DONE){var t="";if(200===l.status)try{t=o&&"custom"===o?l.responseText:JSON.parse(l.responseText)}catch(t){s.C.error("sendCommonRequest failed: query:"+e+", responseText:"+l.responseText+" error:"+t),c=t}else c=new a.oo(l.status,0,"StatusError");r(new a.x4(c,t))}};try{l.timeout=3e4}catch(e){}l.ontimeout=function(){c=new Error("TimeOutError"),r(new a.x4(c))},l.open(t,e),l.setRequestHeader("content-type","application/x-www-form-urlencoded"),l.send(n)}catch(e){r(new a.x4(e))}}))]}))}))},e}()},74762:function(e,t,n){var r,o=n(3578),i=n(50603),a=n(26914),s=(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=function(){return c=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},c.apply(this,arguments)},l=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},u=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.getDefaultConfig=function(){return{strategy:o.I.ONCE,period:-1,autoRenewal:!0}},t.prototype.lock=function(e,t){return l(this,void 0,void 0,(function(){var n,r,o,i=this;return u(this,(function(s){switch(s.label){case 0:return n={tabId:this.tabId,expire:-1===this.period?-1:Date.now()+this.period,optional:t},r={command:"lock",key:e,item:n},this.logRequest(r),[4,new Promise((function(e){i.getClientMutexLock(r,(function(t){if(i.logResponse(t),t.err_msg||t.err_code){var n=new Error(t.err_msg||t.err_code);e(new a.x4(n))}else e(new a.x4(void 0,t.result))}))}))];case 1:return(o=s.sent()).error?[2,{isSuccess:!1,data:o.data}]:o.data.tabId===this.tabId?[2,{isSuccess:!0,data:o.data}]:[2,{isSuccess:!1,data:o.data}]}}))}))},t.prototype.detectKey=function(e){return l(this,void 0,void 0,(function(){var t,n,r,o=this;return u(this,(function(i){switch(i.label){case 0:return t={command:"detectKey",key:e},this.logRequest(t),[4,new Promise((function(e){o.getClientMutexLock(t,(function(t){o.logResponse(t),e(t)}))}))];case 1:return n=i.sent(),r=new a.x4(void 0,n.result),n.err_code?(r.error=new a.GU(""+n.err_code),[2,r]):[2,r]}}))}))},t.prototype.release=function(e){return l(this,void 0,void 0,(function(){var t,n=this;return u(this,(function(r){switch(r.label){case 0:return t={command:"release",key:e},this.logRequest(t),[4,new Promise((function(e){n.getClientMutexLock(t,(function(t){if(n.logResponse(t),t.err_msg||t.err_code){var r=new Error(t.err_msg||t.err_code);e(new a.x4(r))}else e(new a.x4(void 0,t.result))}))}))];case 1:return r.sent().error?[2,!1]:[2,!0]}}))}))},t.prototype.getClientMutexLock=function(e,t){var r;(null===(r=n.g.tdocs)||void 0===r?void 0:r.getClientMutexLock)?n.g.tdocs.getClientMutexLock(c(c({},e),{success:t})):a.RR.invokeNative("docx","clientMutexLock",e,t)},t.prototype.logRequest=function(e){i.eM&&console.log("-----ClientMutexLockReqeust",e)},t.prototype.logResponse=function(e){i.eM&&console.log("-----ClientMutexLockReqeust",e)},t}(o.w);t.Z=d},51015:function(e,t,n){n.d(t,{Z:function(){return o}});var r=window,o=function(){function e(){}return e.debug=function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];try{r.log?(t=r.log).debug.apply(t,n):console.debug.apply(console,n)}catch(t){e.error("","debug",n)}},e.log=function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];try{r.log?(t=r.log).info.apply(t,n):console.log.apply(console,n)}catch(t){e.error("","log",n)}},e.info=function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];try{r.log?(t=r.log).info.apply(t,n):console.info.apply(console,n)}catch(t){e.error("","info",n)}},e.warn=function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];try{r.log?(t=r.log).warn.apply(t,n):console.warn.apply(console,n)}catch(t){e.error("","warn",n)}},e.error=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{r.log?(e=r.log).error.apply(e,t):console.error.apply(console,t)}catch(e){console.error("","error",t)}},e.time=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r={time:Date.now(),options:t};this.sTimeLableMap.set(e,r)},e.timeEnd=function(t){var n=Date.now(),r=e.sTimeLableMap.get(t);if(void 0!==r){var o=r.time,i=r.options&&r.options.map((function(e){return JSON.stringify(e)})).join("-")||"";e.debug("label: "+t+": "+(n-o)+"ms. "+i),this.sTimeLableMap.delete(t)}},e.sTimeLableMap=new Map,e}();t.C=o},81405:function(e,t,n){var r,o=n(3578),i=n(51015),a=n(26914),s=(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=function(){return c=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},c.apply(this,arguments)},l=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},u=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.getDefaultConfig=function(){return{strategy:o.I.ONCE,period:3e5,autoRenewal:!0}},t.prototype.getXKey=function(e){return t.PREFIX_LOCK_X+"_"+e},t.prototype.getYKey=function(e){return t.PREFIX_LOCK_Y+"_"+e},t.prototype.tryToLockKey=function(e,n,r,a){var s=this,c=this.getXKey(e),l=this.getYKey(e);t.DEBUG&&i.C.log("tryToLockKey(). strategy="+this.strategy+" lockX="+c+" lockY="+l),localStorage.setItem(c,this.tabId);var u=localStorage.getItem(l);if(t.DEBUG&&i.C.log("tryToLockKey(). strategy="+this.strategy+" lockX="+c+" lockY="+l+" valueY="+u),u){var d=JSON.parse(u);if(d.expire>Date.now())return t.DEBUG&&i.C.log("tryToLockKey(). tabY strategy="+this.strategy+" lockX="+c+" lockY="+l+" valueY="+u),i.C.log("tabY"),void(this.strategy===o.I.ONCE?a(d):setTimeout((function(){return s.tryToLockKey(e,n,r,a)})))}var p={tabId:this.tabId,expire:Date.now()+this.period,optional:n};localStorage.setItem(l,JSON.stringify(p)),t.DEBUG&&i.C.log("tryToLockKey(). Y. strategy="+this.strategy+" lockX="+c+" lockY="+l+" valueY="+u+" lockItemY="+p);var h=localStorage.getItem(c);t.DEBUG&&i.C.log("tryToLockKey(). X. strategy="+this.strategy+" lockX="+c+" lockY="+l+" valueY="+u+" valueX="+h),h!==this.tabId?setTimeout((function(){var d=!1;u=localStorage.getItem(l);var p=JSON.parse(u||"{}");t.DEBUG&&i.C.log("tryToLockKey(). Y. strategy="+s.strategy+" lockX="+c+" lockY="+l+" valueY="+u+" valueX="+h),u&&p.tabId===s.tabId&&p.expire>Date.now()&&(d=!0),d?(t.DEBUG&&i.C.log("tryToLockKey(). . strategy="+s.strategy+" lockX="+c+" lockY="+l),r(p)):s.strategy===o.I.ONCE?(t.DEBUG&&i.C.log("tryToLockKey(). . strategy="+s.strategy+" lockX="+c+" lockY="+l),a(p)):(t.DEBUG&&i.C.log("tryToLockKey(). . strategy="+s.strategy+" lockX="+c+" lockY="+l),setTimeout((function(){return s.tryToLockKey(e,n,r,a)})))})):(t.DEBUG&&i.C.log("tryToLockKey(). . strategy="+this.strategy+" lockX="+c+" lockY="+l),r(p))},t.prototype.lock=function(e,t){return l(this,void 0,void 0,(function(){var n=this;return u(this,(function(r){switch(r.label){case 0:return[4,new Promise((function(r,o){n.tryToLockKey(e,t,r,o)})).then((function(t){return n.autoRenewal&&n.renewal(e,n.period),{isSuccess:!0,data:t}}),(function(t){var r=n.getXKey(e);return localStorage.getItem(r)===n.tabId&&localStorage.removeItem(r),{isSuccess:!1,data:t}}))];case 1:return[2,r.sent()]}}))}))},t.prototype.detectKey=function(e){return l(this,void 0,void 0,(function(){var t,n,r,o;return u(this,(function(i){return t=this.getYKey(e),n=new a.x4(void 0,void 0),(r=localStorage.getItem(t))&&(o=JSON.parse(r)).expire>Date.now()&&(n.data=o),[2,n]}))}))},t.prototype.release=function(e){return l(this,void 0,void 0,(function(){var n,r,o,a;return u(this,(function(s){return n=this.getXKey(e),r=this.getYKey(e),(o=localStorage.getItem(r))&&JSON.parse(o).tabId===this.tabId&&(t.DEBUG&&i.C.log("releaseKey(). . strategy="+this.strategy+" key="+e),localStorage.removeItem(r),localStorage.getItem(n)===this.tabId&&localStorage.removeItem(n)),(a=t.renewalHanlder.get(e))&&(clearTimeout(a),t.renewalHanlder.delete(e)),[2,!0]}))}))},t.prototype.renewal=function(e,n){var r=this,o=t.renewalHanlder.get(e);o&&clearTimeout(o);var a=setTimeout((function(){t.DEBUG&&i.C.log("renewal(). . strategy="+r.strategy+" key="+e+" period="+n);var o=r.getYKey(e),a=localStorage.getItem(o);if(a){var s=JSON.parse(a);if(s.tabId===r.tabId){var l=c(c({},s),{expire:Date.now()+r.period});localStorage.setItem(r.getYKey(e),JSON.stringify(l)),r.renewal(e,n)}else i.C.error("Y",s)}else i.C.error("Y")}),.85*n);return t.renewalHanlder.set(e,a),a},t.PREFIX_LOCK_X="prefix_lock_x",t.PREFIX_LOCK_Y="prefix_lock_y",t}(o.w);t.Z=d},3578:function(e,t,n){n.d(t,{I:function(){return r},w:function(){return i}});var r,o=function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o.apply(this,arguments)};!function(e){e[e.ONCE=0]="ONCE",e[e.RETRY=1]="RETRY"}(r||(r={}));var i=function(){function e(e){this.tabId=this.getTabID(),e=e?o(o({},this.getDefaultConfig()),e):this.getDefaultConfig(),this.strategy=e.strategy,this.period=e.period,this.autoRenewal=e.autoRenewal}return e.prototype.getTabID=function(){var e=new Date;return 1+e.getMonth()+"-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()+":"+e.getMilliseconds()+" "+Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)},e.prototype.renewal=function(e,t){},e.DEBUG=!1,e.DEFAULT_CONFIG={strategy:r.ONCE,period:3e5,autoRenewal:!0},e.renewalHanlder=new Map,e}()},26516:function(e,t,n){n.d(t,{Ei:function(){return _},KW:function(){return b},N1:function(){return d},SV:function(){return f},Tf:function(){return h},Zp:function(){return u},ej:function(){return a},fM:function(){return s},kK:function(){return p},n5:function(){return C},ws:function(){return m}});var r=n(77914),o=n(36445),i=window;function a(e){var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return t?decodeURIComponent(t[2]):""}function s(){return a("TOK")||""}var c,l,u=(c=navigator.userAgent.toLowerCase(),{isPad:l=/(ipad)/i.test(c),isMobile:/(mobile)/i.test(c)&&!l,isDesktop:/(TDAppDesktop)/.test(navigator.userAgent)});function d(){if("0"===localStorage.getItem("OFFLINE_DB_SWITCH"))return!1;var e=navigator.userAgent.match(/_tdocFlag\/(\d+)/);return!(!e||!e[1])&&2&parseInt(e[1])}function p(){var e,t;return"1"===(e="offline-debug",(t=window.location.search.match(new RegExp("(\\?|&)"+e+"=([^&]*)(&|$)")))?decodeURIComponent(t[2]):"")}function h(){return!!(i.App&&i.App.GlobalConfig&&i.App.GlobalConfig.IsSupportStore)}function f(){return i.App&&i.App.GlobalConfig&&i.App.GlobalConfig.globalCodeVersion?i.App.GlobalConfig.globalCodeVersion:""}function g(e){return"string"==typeof e?g(JSON.parse(e)):e}function v(e){var t=[];if(e.v>=5){var n=e.c;("IMAGE"===n[0]||"string"==typeof n[2]&&-1!==n[2].indexOf("attachment-"))&&t.push(e.c[3])}return t}function y(e){var t,n=[];return"string"==typeof e&&(t=JSON.parse(e)),Array.isArray(t)&&t.forEach((function(e){e&&e.v&&(n=n.concat(v(e)))})),n}function m(e){for(var t=[],n=0,r=e.length;n<r;n++)for(var o=g(e[n]),i=0,a=o.length;i<a;i++){var s=o[i];t=s.v?t.concat(v(s)):t.concat(y(s))}return t}var b=function(e,t){var n=function(e){var t;return e===r.Gk.WORD?t="doc":e===r.Gk.EXCEL?t="sheet":e===r.Gk.SLIDE&&(t="slide"),t}(e);return o.f+"/"+n+"/"+t};function _(e){var t;return e?"result is { resultCode: "+e.resultCode+" subResultCode: "+e.subResultCode+" message: "+e.message+" dataUndefinedCheck: "+(void 0===e.data)+" error: "+(null===(t=e.error)||void 0===t?void 0:t.stack)+"}":"result is undefine!!!"}var C=function(){var e,t;return a("uid")||(null===(t=null===(e=n.g.basicClientVars)||void 0===e?void 0:e.userInfo)||void 0===t?void 0:t.tinyId)||""}},84502:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(85556).__importDefault(n(6991));t.default="data-dui-"+r.default.replace(/\./g,"-")},57945:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.i18n=void 0;var r=n(85556),o=r.__importDefault(n(77546)),i=r.__importDefault(n(66336)),a=r.__importDefault(n(55466)),s=new(r.__importDefault(n(26711)).default);"undefined"==typeof window||s.addDetector({name:"userAgent",lookup:function(){var e=navigator.userAgent.match(/language\/([a-zA-Z'-_]+)/i);if(e)return e[1].replace("_","-")}});var c={avatar:["Avatar",""],ok:["OK",""],cancel:["Cancel",""],select:["Select",""],search:["Search",""],hour:["H",""],minute:["M",""],second:["S",""],now:["Now",""],inputHour:["Input Hour",""],inputMinute:["Input Minute",""],inputSecond:["Input Second",""],close:["Close",""],loadingFailed:["Loading Failed",""],noOptions:["No Options",""],copySuccessed:["Copy Succeeded",""],copyFailed:["Copy Failed",""],eyedropper:["Eyedropper",""],eyedropperFailedSafari:["Eyedropper is not supported by this browser. Please open it in Chrome",",  Chrome "],eyedropperFailedEdge:["Eyedropper is not supported by this browser. Please open it in Chrome",",  Chrome "]},l={};["en","zh-CN"].forEach((function(e,t){var n=o.default({},c,(function(e,n){return n[t]}));i.default(l,[e,"translation"],n)}));var u=a.default.createInstance();u.use(s).init({resources:l,fallbackLng:{"zh-TW":["zh-HK","zh-CN"],default:["zh-CN"]},detection:{order:["querystring","userAgent","cookie"],lookupCookie:"language",caches:[]}}),t.i18n=function(e){return u.t(e)}},6991:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default="0.134.2"},90665:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(85556),o=n(56630).h,i=r.__importStar(n(87363)),a=n(68848),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.themedRender=function(e){var n,i=t.props,a=i.count,s=i.prefixCls,c=i.style,l=i.status,u=i.showZero,d=i.text,p=i.dot,h=i.children,f=i.className,g=i.overflowCount,v=i.offsetX,y=i.offsetY,m=a;Number(a)>g?m=g+"+":!a&&u&&(m="0");var b=e(s+"-status",((n={})[s+"-status-"+(l||"default")]=l,n)),_={marginRight:-v+"px",marginTop:y+"px"};if(l){var C=e(s,f,s+"-standalone"),S=e(s+"-status-text");return o("span",{className:C,style:c},o("span",{className:b}),d&&o("span",{className:S},d))}if(!h){var w=e(s,f,s+"-standalone",s+"-count",s+"-count-standalone");return m&&o("span",{className:w,style:c},m)}var E=e(s,f);if(p){var x=e(s+"-dot");return o("span",{className:E},h,o("sup",{className:x,style:r.__assign(r.__assign({},c),_)}))}var T=e(s+"-count",s+"-count-attach");return o("span",{className:E},h,m?o("sup",{className:T,style:r.__assign(r.__assign({},c),_)},m):null)},t}return r.__extends(t,e),t.prototype.render=function(){return a.consumeTheme(this.themedRender)},t}(i.Component);t.default=s,s.defaultProps={prefixCls:"dui-badge",showZero:!1,text:"",dot:!1,overflowCount:99,offsetX:0,offsetY:0}},83939:function(e,t,n){var r=n(85556);n(36226).D("components/Badge/style/index.css",'[data-dui-0-134-2~="dui-badge"]{-webkit-box-sizing:border-box;box-sizing:border-box;margin:0;padding:0;position:relative;display:inline-block}[data-dui-0-134-2~="dui-badge-standalone"]{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center}[data-dui-0-134-2~="dui-badge-count"],[data-dui-0-134-2~="dui-badge-dot"]{position:absolute;z-index:2;-webkit-box-sizing:border-box;box-sizing:border-box;right:0;border:1px solid #fff}[data-dui-0-134-2~="dui-badge-count"]{display:inline-block;height:18px;min-width:18px;line-height:16px;border-radius:9px;padding:0 4px;font-size:12px;text-align:center;font-weight:500;white-space:nowrap;color:#fff;background:var(--critical-default,#ff4747)}[data-dui-0-134-2~="dui-badge-count-attach"]{top:-9px;-webkit-transform:translateX(50%);transform:translateX(50%)}[data-dui-0-134-2~="dui-badge-count-standalone"]{position:relative}[data-dui-0-134-2~="dui-badge-dot"]{top:-5px;background:var(--critical-default,#ff4747);-webkit-transform:translateX(50%);transform:translateX(50%)}[data-dui-0-134-2~="dui-badge-dot"],[data-dui-0-134-2~="dui-badge-status"]{border-radius:50%;width:10px;height:10px}[data-dui-0-134-2~="dui-badge-status"]{display:inline-block}[data-dui-0-134-2~="dui-badge-status-default"]{background:#d9d9d9}[data-dui-0-134-2~="dui-badge-status-success"]{background:#1890ff}[data-dui-0-134-2~="dui-badge-status-error"]{background:var(--critical-default,#ff4747)}[data-dui-0-134-2~="dui-badge-status-warning"]{background:#faad14}[data-dui-0-134-2~="dui-badge-status-text"]{color:rgba(0,0,0,.65);font-size:14px;margin-left:8px}');var o=r.__importDefault(n(90665));o.default,t.ZP=o.default},84882:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(85556),o=n(56630).h,i=r.__importStar(n(87363)),a=n(68848),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.themedRender=function(e){var n,i=t.props,a=i.prefixCls,s=i.className,c=i.style,l=i.type,u=i.size,d=i.disabled,p=i.icon,h=i.testId,f=r.__rest(i,["prefixCls","className","style","type","size","disabled","icon","testId"]),g=e(a,s,((n={})[a+"-type-"+l]=l,n[a+"-size-"+u]=u,n[a+"-with-icon"]=p,n[a+"-type-"+l+"-disabled"]=d,n)),v=e(a+"-container"),y=e(a+"-icon");return o("button",r.__assign({},f,{className:g,style:c,disabled:d,"data-testid":h}),o("div",{className:v},p?"string"==typeof p?o("span",{className:y,style:{backgroundImage:'url("'+p+'")'}}):p:null,t.props.children))},t}return r.__extends(t,e),t.prototype.render=function(){return a.consumeTheme(this.themedRender)},t}(i.Component);t.default=s,s.defaultProps={prefixCls:"dui-button",type:"default",size:"default"}},87404:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.Button=void 0;var r=n(85556).__importDefault(n(84882));t.Button=r.default,n(36226).D("components/Button/style/index.css",'[data-dui-0-134-2~="dui-button"]{outline:none;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-box-sizing:border-box;box-sizing:border-box;display:inline-block;white-space:nowrap;border-radius:4px;border:1px solid transparent;font-size:14px;padding:0 29px;-webkit-tap-highlight-color:transparent}[data-dui-0-134-2~="dui-button-container"]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}[data-dui-0-134-2~="dui-button-type-default"]{background:var(--tsp-fill-medium,rgba(51,77,102,.08));color:var(--text-ultrastrong,rgba(0,0,0,.88))}[data-dui-0-134-2~="dui-button-type-default"]:hover{background:var(--tsp-fill-strong,rgba(61,82,102,.12))}[data-dui-0-134-2~="dui-button-type-default"]:active{background:var(--tsp-fill-ultrastrong,rgba(61,82,102,.16))}[data-dui-0-134-2~="dui-button-type-primary"]{background:var(--accent-default,#1e6fff);color:var(--text-white,#fff)}[data-dui-0-134-2~="dui-button-type-primary"]:hover{background:var(--accent-hover,#175ceb)}[data-dui-0-134-2~="dui-button-type-primary"]:active{background:var(--accent-pressed,#134ae0)}[data-dui-0-134-2~="dui-button-type-warning"]{background:var(--critical-default,#ff4747);color:#fff}[data-dui-0-134-2~="dui-button-type-warning"]:hover{background:var(--critical-hover,#eb3639)}[data-dui-0-134-2~="dui-button-type-warning"]:active{background:var(--critical-pressed,#e02424)}[data-dui-0-134-2~="dui-button-type-plain"]{background:var(--bg-lv1-default,#fff);color:var(--text-link,#175ceb)}[data-dui-0-134-2~="dui-button-type-plain"]:hover{background:var(--bg-lv1-weak,#f9fafb)}[data-dui-0-134-2~="dui-button-type-plain"]:active{background:var(--bg-lv1-medium,#f3f5f7)}[data-dui-0-134-2~="dui-button-type-golden"]{background:-webkit-linear-gradient(335deg,#f6ddb1,#e4bd80);background:linear-gradient(115deg,#f6ddb1,#e4bd80);border:none;color:#865812}[data-dui-0-134-2~="dui-button-type-golden"] [data-dui-0-134-2~="dui-button-container"]{margin:0 1px}[data-dui-0-134-2~="dui-button-type-golden"]:hover{background:-webkit-linear-gradient(335deg,#edce98,#dbaa5e);background:linear-gradient(115deg,#edce98,#dbaa5e)}[data-dui-0-134-2~="dui-button-type-golden"]:active{background:-webkit-linear-gradient(335deg,#daba81,#d49d48);background:linear-gradient(115deg,#daba81,#d49d48)}[data-dui-0-134-2~="dui-button-type-golden-dark"]{background:-webkit-linear-gradient(336.31deg,#454952 15.25%,#272a33 84.75%);background:linear-gradient(113.69deg,#454952 15.25%,#272a33 84.75%);border:none;color:#fae0a5}[data-dui-0-134-2~="dui-button-type-golden-dark"] [data-dui-0-134-2~="dui-button-container"]{margin:0 1px}[data-dui-0-134-2~="dui-button-type-golden-dark"]:hover{background:-webkit-linear-gradient(bottom,rgba(0,0,0,.16),rgba(0,0,0,.16)),-webkit-linear-gradient(336.31deg,#454952 15.25%,#272a33 84.75%);background:linear-gradient(0deg,rgba(0,0,0,.16),rgba(0,0,0,.16)),linear-gradient(113.69deg,#454952 15.25%,#272a33 84.75%)}[data-dui-0-134-2~="dui-button-type-golden-dark"]:active{background:-webkit-linear-gradient(bottom,rgba(0,0,0,.32),rgba(0,0,0,.32)),-webkit-linear-gradient(336.31deg,#454952 15.25%,#272a33 84.75%);background:linear-gradient(0deg,rgba(0,0,0,.32),rgba(0,0,0,.32)),linear-gradient(113.69deg,#454952 15.25%,#272a33 84.75%)}[data-dui-0-134-2~="dui-button-type-golden-outline"]{border-color:#db8f1c;color:#db8f1c;background:#fff}[data-dui-0-134-2~="dui-button-type-golden-outline"]:hover{background:rgba(219,143,28,.1)}[data-dui-0-134-2~="dui-button-type-golden-outline"]:active{background:rgba(219,143,28,.2)}[data-dui-0-134-2~="dui-button"]:disabled{border-color:transparent;pointer-events:none;cursor:auto}[data-dui-0-134-2~="dui-button"]:disabled,[data-dui-0-134-2~="dui-button"]:disabled:active,[data-dui-0-134-2~="dui-button"]:disabled:hover{color:var(--text-weak,rgba(0,0,0,.24));background:var(--tsp-fill-weak,rgba(51,77,102,.06))}[data-dui-0-134-2~="dui-button-size-large"]{height:36px;min-width:156px;font-size:16px}[data-dui-0-134-2~="dui-button-size-default"]{height:36px}[data-dui-0-134-2~="dui-button-size-small"]{height:28px;padding:0 17px;font-size:12px}[data-dui-0-134-2~="dui-button-size-small"] [data-dui-0-134-2~="dui-button-container"]{line-height:26px}[data-dui-0-134-2~="dui-button-with-icon"]{padding:0 9px}[data-dui-0-134-2~="dui-button-icon"]{display:inline-block;width:18px;height:18px;background-size:contain;background-repeat:no-repeat;background-position:50%;margin-right:4px}'),t.default=r.default},59454:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(85556),o=n(56630).h,i=r.__importStar(n(87363)),a=r.__importStar(n(53211)),s=n(89746),c=n(68848),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.themedRender=function(e){var n=t.props,r=n.prefixCls,i=n.className,a=n.style,c=n.dashed,l=n.children,u=n.orientation,d=n.textPosition,p=n.textStyle,h=n.textClassName,f=l&&"horizontal"===u;return o(s.SubMenuContext.Consumer,null,(function(t){var n,s,g="with-icon"!==t.type,v=e(r,i,r+"-"+u+(c?"-dashed":""),((n={})[r+"-with-text"]=f,n[r+"-compact"]=g,n)),y=e(r+"-text",h,r+"-text-"+d,((s={})[r+"-text-compact"]=g,s));return o("div",{className:v,style:a},f?o("span",{className:y,style:p},l):null)}))},t}return r.__extends(t,e),t.prototype.render=function(){return c.consumeTheme(this.themedRender)},t}(i.Component);t.default=l,l.defaultProps={prefixCls:"dui-divider",dashed:!1,orientation:"horizontal",textPosition:"center"},l.propTypes={prefixCls:a.string,style:a.object,className:a.string,dashed:a.bool,orientation:a.string,textPosition:a.string,textStyle:a.object,textClassName:a.string}},26061:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.Divider=void 0;var r=n(85556).__importDefault(n(59454));t.Divider=r.default,n(36226).D("components/Divider/style/index.css",'[data-dui-0-134-2~="dui-divider"]{border:1px solid var(--border-weak,rgba(0,0,0,.04));position:relative;pointer-events:none}[data-dui-0-134-2~="dui-divider-horizontal"],[data-dui-0-134-2~="dui-divider-horizontal-dashed"]{display:block;width:100%;border-top:none;border-left:none;border-right:none;margin:8px 0}[data-dui-0-134-2~="dui-divider-horizontal-dashed"]{border-bottom-style:dashed}[data-dui-0-134-2~="dui-divider-compact"][data-dui-0-134-2~="dui-divider-horizontal"]{margin:4px 0}[data-dui-0-134-2~="dui-divider-vertical"],[data-dui-0-134-2~="dui-divider-vertical-dashed"]{display:inline-block;border-left:none;border-top:none;border-bottom:none;margin:0 12px;height:1em}[data-dui-0-134-2~="dui-divider-vertical-dashed"]{border-right-style:dashed}[data-dui-0-134-2~="dui-divider-compact"][data-dui-0-134-2~="dui-divider-vertical"]{margin:0 6px}[data-dui-0-134-2~="dui-divider-with-text"]{margin:15px 0}[data-dui-0-134-2~="dui-divider-compact"][data-dui-0-134-2~="dui-divider-with-text"]{margin:10px 0}[data-dui-0-134-2~="dui-divider-text"]{position:absolute;background:#fff;font-size:14px;color:#d0d0d0;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);padding:0 6px}[data-dui-0-134-2~="dui-divider-text-compact"]{font-size:12px}[data-dui-0-134-2~="dui-divider-text-center"]{left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}[data-dui-0-134-2~="dui-divider-text-left"]{left:24px}[data-dui-0-134-2~="dui-divider-text-right"]{right:24px}'),t.default=r.default},80084:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(85556),o=n(56630).h,i=r.__importStar(n(87363)),a=r.__importDefault(n(61533)),s=n(80328),c=r.__importDefault(n(4339)),l=n(40782),u=n(68848),d=n(25944),p=n(89805),h=n(26276),f=n(259),g=r.__importDefault(n(62249)),v=r.__importDefault(n(86667)),y=n(36321),m={left:"0",top:"0"},b=["auto-outer","left-outer","right-outer"],_=v.default.isIOS||v.default.isIPadEmulatedMac||v.default.isIPad,C=100,S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rootDomRef=i.createRef(),t.dropContentRef=i.createRef(),t.forceRenderDom=!1,t.cancelPositionChangeChecker=null,t.resizeObserver=null,t.isInAnimation=!1,t.dropContentObserver=new MutationObserver((function(e){e.some((function(e){var t=e.addedNodes,n=e.removedNodes;return t.length||n.length}))&&t.refreshDropContentMetric()})),t.state={visible:!1,dropContentMetrics:r.__assign({},m),actualPlacement:"bottom",actualAlignment:t.isOuterAlignment?"left-outer":"left"},t.refreshDropContentMetric=g.default((function(){t.removePreviousClampedSize(t.updateDropContentMetric)}),20),t.updateDropContentMetric=function(){var e=t.rootDomRef.current,n=t.dropContentRef.current;if(e&&n){var o=e.getBoundingClientRect(),i=n.getBoundingClientRect(),a=t.calcHorizontalMetric(o,i),s=a.actualAlignment,c=a.metric,l=t.calcVerticalMetric(o,i),u=l.actualPlacement,d=l.metric,p=r.__assign(r.__assign({},c),d);t.setState({dropContentMetrics:p,actualPlacement:u,actualAlignment:s})}},t.hide=function(e){e&&t.consumeKeep(e)||t.isVisible()&&(t.isControlled||t.restorePreviousFocus(),t.setStateVisible(!1))},t.show=function(e){t.forceRenderDom=!0,t.removePreviousClampedSize((function(){requestAnimationFrame((function(){t.forceRenderDom=!1,t.updateDropContentMetric(),!e&&t.setStateVisible(!0)}))}))},t.toggle=function(){t.props.disabled||(t.isVisible()?t.hide():t.show())},t.handleMouseEnter=function(){t.props.disabled||(clearTimeout(t.hideTimeout),clearTimeout(t.showTimeout),t.isVisible()||(t.showTimeout=setTimeout(t.show,C)))},t.handleMouseLeave=function(){t.props.disabled||t.isInAnimation||(clearTimeout(t.showTimeout),t.hideTimeout=setTimeout((function(){return!t.isInAnimation&&t.hide()}),C))},t.handleKeydown=function(e){"Escape"===e.key?t.hide():"Tab"===e.key&&t.traverseFocus(e)},t.themedRender=function(e){var n,i,s,u=t.props,d=u.prefixCls,f=u.className,g=u.style,v=u.children,y=u.dropContent,m=u.disabled,b=u.dropContentStyle,_=u.dropContentClassName,C=u.zIndex,S=u.animated,w=u.trigger,E=u.destroyOnClose,x=u.containerDom,T=u.testId,R=u.dropContentTestId,I=u.containerFollowVisible,P=u.containerClassName,O=u.containerStyle,k=u.shouldHide,D=t.state,M=D.dropContentMetrics,A=D.actualPlacement,L=D.actualAlignment,N=t.isVisible(),B=t.context.zIndex,F=C||B,U=e(d,f,d+"-"+(N?"visible":"hidden"),((n={})[d+"-disabled"]=m,n)),H=e(d+"-content",_,d+"-content-"+A,d+"-content-"+L,d+"-content-"+(N?"visible":"hidden"),d+"-content-"+(t.isOuterAlignment?"outer":"inner"),((i={})[d+"-content-no-animation"]=!S,i)),j=e(d+"-container",P,((s={})[d+"-container-"+(N?"visible":"hidden")]=I,s)),G=!t.forceRenderDom&&E&&!p.decideKeepDom.call(t,120,N);return o(c.default,{action:t.hide,disabled:!N,className:U,style:g,domRef:t.rootDomRef,testId:T,shouldTriggerAction:k},o("div",{onMouseEnter:"hover"===w?t.handleMouseEnter:void 0,onMouseLeave:"hover"===w?t.handleMouseLeave:void 0},o("div",{className:j,style:O,onClick:"click"===w?t.toggle:void 0},v),o(l.DropdownContext.Provider,{value:l.getDropdownContext({visible:N,zIndex:F+1})},o(h.DocumentDomContext.Consumer,null,(function(e){return G?null:a.default.createPortal(o("div",{className:H,style:r.__assign(r.__assign({zIndex:F},M),b),onClick:t.hide,ref:t.dropContentRef,onKeyDown:t.handleKeydown,tabIndex:-1,"data-testid":R},y),x||(null==e?void 0:e.body)||document.body)})))))},t}return r.__extends(t,e),t.getDerivedStateFromProps=function(e,t){return e.disabled?{visible:!1}:null},Object.defineProperty(t.prototype,"isOuterAlignment",{get:function(){return b.includes(this.props.alignment)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isControlled",{get:function(){return"boolean"==typeof this.props.visible},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this.forceUpdate(),"function"==typeof ResizeObserver&&(this.resizeObserver=new ResizeObserver(this.refreshDropContentMetric))},t.prototype.componentDidUpdate=function(e,t,n){var r=this,o=this.props.visible,i=this.isVisible(),a=this.prevVisible;this.prevVisible=i,!a&&i&&(o&&d.triggerMicroTask((function(){return r.show(!0)})),this.focusSelf(),this.handleEnteringAnimation(),this.addListeners()),a&&!i&&(this.isControlled&&this.restorePreviousFocus(),this.clearListeners())},t.prototype.addListeners=function(){var e,t,n;null===(e=this.resizeObserver)||void 0===e||e.observe(this.rootDomRef.current),null===(t=this.resizeObserver)||void 0===t||t.observe(this.dropContentRef.current),null===(n=this.cancelPositionChangeChecker)||void 0===n||n.call(this),this.props.disableScrollHide||(this.cancelPositionChangeChecker=y.checkPositionChange(this.rootDomRef.current,this.hide)),this.dropContentObserver.observe(this.dropContentRef.current,{subtree:!0,childList:!0})},t.prototype.clearListeners=function(){var e,t;null===(e=this.resizeObserver)||void 0===e||e.disconnect(),null===(t=this.cancelPositionChangeChecker)||void 0===t||t.call(this),this.dropContentObserver.disconnect()},t.prototype.componentWillUnmount=function(){this.clearListeners()},t.prototype.getSnapshotBeforeUpdate=function(){return this.dropContentRef.current},t.prototype.handleEnteringAnimation=function(){this.fixAnimationFlickeringOnIOS(),this.blockPointerEventsDuringAnimation()},t.prototype.blockPointerEventsDuringAnimation=function(){var e=this;this.isInAnimation=!0;var t=this.dropContentRef.current.style,n=t.pointerEvents;t.pointerEvents="none",setTimeout((function(){t.pointerEvents=n,e.isInAnimation=!1}),240)},t.prototype.fixAnimationFlickeringOnIOS=function(){if(_){var e=this.dropContentRef.current.style;setTimeout((function(){var t=e.opacity,n=e.transform,r=e.transition;e.opacity="0.99",e.transform="translate(0)",e.transition="none",setTimeout((function(){e.opacity=t,e.transform=n,e.transition=r}),0)}),240)}},t.prototype.isVisible=function(){var e=this.props,t=e.visible;if(e.disabled)return!1;var n=this.state.visible;return"boolean"==typeof t?t:n},t.prototype.traverseFocus=function(e){var t=this.dropContentRef.current;t&&f.traverseFocusIn(t,e)},t.prototype.isFocusInside=function(){var e;return null===(e=this.dropContentRef.current)||void 0===e?void 0:e.contains(document.activeElement)},t.prototype.focusSelf=function(){var e=this;this.props.autoFocus&&this.isVisible()&&!this.isFocusInside()&&(f.saveFocus(),setTimeout((function(){var t;!e.isFocusInside()&&(null===(t=e.dropContentRef.current)||void 0===t||t.focus())}),240))},t.prototype.restorePreviousFocus=function(){var e=this.props,t=e.autoFocus,n=e.onRestoreFocus;t&&!1!==(null==n?void 0:n())&&f.restoreFocus()},t.prototype.removePreviousClampedSize=function(e){this.setState({dropContentMetrics:r.__assign(r.__assign({},this.state.dropContentMetrics),{height:void 0,width:void 0})},e)},t.prototype.calcHorizontalMetric=function(e,t){var n=this.props,r=n.alignment,o=n.matchWidth,i=n.viewportMargin,a=e.width,s=e.left,c=e.right,l=t.width,u=window.innerWidth,d=i,p=u-d,h=r;if("auto"===r){var f=p-s;h=l>f?f>=c-d?"left":"right":"left"}else"auto-outer"===r&&(h=s-l-d<0?"right-outer":"left-outer");var g={actualAlignment:h,metric:{}};if(o&&!this.isOuterAlignment)return g.metric.left=s,g.metric.width=a,g;var v=u-2*d;return"left"===h?(l>v?(g.metric.left=d,g.metric.width=v):g.metric.left=s+l>p?p-l:s,g):"right"===h?(l>v?(g.metric.left=d,g.metric.width=v):g.metric.left=c-l<d?d:c-l,g):("center"===h?g.metric.left=s+(a-l)/2:"left-outer"===h?g.metric.left=s-l:"right-outer"===h&&(g.metric.left=c),g)},t.prototype.calcVerticalMetric=function(e,t){var n,r=this.props,o=r.placement,i=r.viewportMargin,a=e.bottom,s=e.top,c=t.height,l=i,u=0,d="bottom",p=this.isOuterAlignment,h=function(){var e=p?a:s;return u=Math.max(l,e-c),d="top",n=e-u},f=function(){return u=p?s:a,n=Math.min(c,window.innerHeight-l-u),d="bottom",n};return"top"===o?h():"bottom"===o?f():"auto"===o&&(f()===c||h()===c||(f()>=h()?f():h())),{metric:{top:u+"px",height:n&&n+"px"},actualPlacement:d}},t.prototype.setStateVisible=function(e){this.setState({visible:e}),this.props.onVisibleChange(e)},t.prototype.consumeKeep=function(e){var t=e.nativeEvent,n=Boolean(t._dui_dropdown_keep);return delete t._dui_dropdown_keep,n},t.prototype.render=function(){return u.consumeTheme(this.themedRender)},t.contextType=l.DropdownContext,t}(i.Component);t.default=S,S.defaultProps={prefixCls:"dui-dropdown",alignment:"auto",matchWidth:!1,disabled:!1,onVisibleChange:s.emptyFn,placement:"auto",animated:!0,trigger:"click",destroyOnClose:!0,autoFocus:!0,viewportMargin:2,shouldHide:s.trueFn}},62997:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(85556),o=n(56630).h,i=r.__importStar(n(87363)),a=n(68848),s=n(4339),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleMouseUp=function(e){setTimeout((function(){t.context(!1)}),0)},t.handleClick=function(e){var n=t.props,r=n.onClick,o=n.disabled;null==r||r(e);var i=e.nativeEvent;!0===o||"function"==typeof o&&o(e)||i._dui_bypass_dropdown_keep||(i._dui_dropdown_keep=!0)},t.handleMouseDown=function(e){t.context(!0)},t.themedRender=function(e){var n=t.props,i=n.prefixCls,a=n.className,s=n.style,c=n.children,l=(n.disabled,n.domRef),u=r.__rest(n,["prefixCls","className","style","children","disabled","domRef"]),d=e(i,a);return o("div",r.__assign({},u,{className:d,style:s,ref:l,onClick:t.handleClick,onMouseDown:t.handleMouseDown}),c)},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){document.addEventListener("mouseup",this.handleMouseUp)},t.prototype.componentWillUnmount=function(){document.removeEventListener("mouseup",this.handleMouseUp)},t.prototype.render=function(){return a.consumeTheme(this.themedRender)},t.contextType=s.TriggerContext,t}(i.Component);t.default=c,c.defaultProps={prefixCls:"dui-dropdown-keep",disabled:!1}},40782:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.getDropdownContext=t.DropdownContext=void 0;var r=n(85556).__importStar(n(87363)),o=n(80328);t.DropdownContext=r.createContext({visible:!0,zIndex:9999}),t.getDropdownContext=o.createContextValueGetter()},88560:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.Dropdown=void 0;var r=n(85556),o=r.__importDefault(n(80084));t.Dropdown=o.default,n(36226).D("components/Dropdown/style/index.css",'[data-dui-0-134-2~="dui-dropdown-disabled"]{opacity:.6}@-webkit-keyframes dui-dropdown-slide-in-bottom{0%{opacity:0;-webkit-transform:scaleX(1) translateY(-20px);transform:scaleX(1) translateY(-20px)}to{opacity:1;-webkit-transform:scaleX(1) translate(0);transform:scaleX(1) translate(0)}}@keyframes dui-dropdown-slide-in-bottom{0%{opacity:0;-webkit-transform:scaleX(1) translateY(-20px);transform:scaleX(1) translateY(-20px)}to{opacity:1;-webkit-transform:scaleX(1) translate(0);transform:scaleX(1) translate(0)}}@-webkit-keyframes dui-dropdown-slide-in-top{0%{opacity:0;-webkit-transform:scaleX(1) translateY(20px);transform:scaleX(1) translateY(20px)}to{opacity:1;-webkit-transform:scaleX(1) translate(0);transform:scaleX(1) translate(0)}}@keyframes dui-dropdown-slide-in-top{0%{opacity:0;-webkit-transform:scaleX(1) translateY(20px);transform:scaleX(1) translateY(20px)}to{opacity:1;-webkit-transform:scaleX(1) translate(0);transform:scaleX(1) translate(0)}}[data-dui-0-134-2~="dui-dropdown"]{-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:inline-block;-webkit-tap-highlight-color:transparent}[data-dui-0-134-2~="dui-dropdown-container"]{border-radius:2px}[data-dui-0-134-2~="dui-dropdown-container-visible"]{background:var(--tsp-fill-medium,rgba(51,77,102,.08))}[data-dui-0-134-2~="dui-dropdown-content"]{-webkit-box-sizing:border-box;box-sizing:border-box;position:fixed;z-index:9999;-webkit-transition-property:opacity,visibility,-webkit-transform;transition-property:opacity,visibility,-webkit-transform;transition-property:opacity,transform,visibility;transition-property:opacity,transform,visibility,-webkit-transform;-webkit-transition-timing-function:cubic-bezier(.4,0,.2,1);transition-timing-function:cubic-bezier(.4,0,.2,1);-webkit-tap-highlight-color:transparent;-webkit-animation-timing-function:cubic-bezier(.4,0,.2,1);animation-timing-function:cubic-bezier(.4,0,.2,1);-webkit-animation-duration:.24s;animation-duration:.24s}[data-dui-0-134-2~="dui-dropdown-content-bottom"]{-webkit-animation-name:dui-dropdown-slide-in-bottom;animation-name:dui-dropdown-slide-in-bottom}[data-dui-0-134-2~="dui-dropdown-content-top"]{-webkit-animation-name:dui-dropdown-slide-in-top;animation-name:dui-dropdown-slide-in-top}[data-dui-0-134-2~="dui-dropdown-content-left-outer"]{padding-right:5px}[data-dui-0-134-2~="dui-dropdown-content-right-outer"]{padding-left:5px}[data-dui-0-134-2~="dui-dropdown-content-inner"][data-dui-0-134-2~="dui-dropdown-content-bottom"]{padding-top:5px}[data-dui-0-134-2~="dui-dropdown-content-inner"][data-dui-0-134-2~="dui-dropdown-content-top"]{padding-bottom:5px}[data-dui-0-134-2~="dui-dropdown-content-visible"]{-webkit-transition-duration:.24s;transition-duration:.24s;visibility:visible;opacity:1;-webkit-transform:scaleX(1) translate(0);transform:scaleX(1) translate(0)}[data-dui-0-134-2~="dui-dropdown-content-hidden"]{-webkit-transition-duration:.12s;transition-duration:.12s;visibility:hidden;pointer-events:none}[data-dui-0-134-2~="dui-dropdown-content-hidden"][data-dui-0-134-2~="dui-dropdown-content-bottom"]{opacity:0;-webkit-transform:scaleX(1) translateY(-20px);transform:scaleX(1) translateY(-20px)}[data-dui-0-134-2~="dui-dropdown-content-hidden"][data-dui-0-134-2~="dui-dropdown-content-top"]{opacity:0;-webkit-transform:scaleX(1) translateY(20px);transform:scaleX(1) translateY(20px)}[data-dui-0-134-2~="dui-dropdown-content-no-animation"]{-webkit-transition-duration:0s;transition-duration:0s;-webkit-animation-duration:0s;animation-duration:0s}');var i=r.__importDefault(n(62997));o.default.Keep=i.default,t.default=o.default},77898:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.FormItemContext=void 0;var r=n(85556).__importStar(n(87363));t.FormItemContext=r.createContext({status:"default"})},58694:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(85556),o=n(56630).h,i=r.__importStar(n(87363)),a=n(80328),s=n(77898),c=n(68848),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.leftIconRef=i.createRef(),t.rightIconsRef=i.createRef(),t.state={value:t.props.defaultValue},t.handleChange=function(e){if(!t.props.disabled){var n=e.target.value;t.props.onChange(n,e),t.setState({value:n})}},t.preventLoseFocus=function(e){e.preventDefault()},t.handleClear=function(){t.setState({value:""},(function(){t.props.onChange("")}))},t.handleIconKeyDown=function(e){return function(n){!t.props.disabled&&e&&[" ","Enter"].includes(n.key)&&(n.preventDefault(),e())}},t.themedRender=function(e){var n,i,a=t.props,s=a.prefixCls,c=a.className,l=a.style,u=a.disabled,d=a.underline,p=(a.icon,a.leftIcon),h=(a.onClickIcon,a.onClickLeftIcon),f=(a.onChange,a.inputStyle),g=(a.showClear,a.value),v=(a.defaultValue,a.inputRef),y=a.inputClassName,m=a.testId,b=a.errorTip,_=r.__rest(a,["prefixCls","className","style","disabled","underline","icon","leftIcon","onClickIcon","onClickLeftIcon","onChange","inputStyle","showClear","value","defaultValue","inputRef","inputClassName","testId","errorTip"]),C=t.state.value,S=t.status,w="string"==typeof g?g:C,E=e(s,c,((n={})[s+"-disabled"]=u,n)),x=e(s+"-input",y,s+"-input-"+S,((i={})[s+"-input-underline"]=d,i)),T=e(s+"-error-text"),R=!(!w||u);return o("div",{className:E,style:l,"data-testid":m},t.renderSingleIcon({prop:p,description:"left",handler:h,ref:t.leftIconRef},e),o("input",r.__assign({className:x,style:r.__assign(r.__assign({},t.getIconPaddings()),f),onChange:t.handleChange,value:w,disabled:u,ref:v},_)),t.renderRightIcons(R,e),b&&o("div",{className:T},b))},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.forceUpdate()},Object.defineProperty(t.prototype,"status",{get:function(){return this.props.errorTip?"error":this.context.status},enumerable:!1,configurable:!0}),t.prototype.getIconPaddings=function(){var e=this.leftIconRef.current,t=this.rightIconsRef.current,n={};return e&&(n.paddingLeft=e.getBoundingClientRect().width+2+"px"),t&&(n.paddingRight=t.getBoundingClientRect().width+2+"px"),n},t.prototype.renderSingleIcon=function(e,t){var n,r=e.prop,i=e.description,a=e.handler,s=e.ref,c=this.props,l=c.prefixCls,u=c.underline,d=t(l+"-icon",((n={})[l+"-icon-"+i]=i,n[l+"-icon-clickable"]=a,n[l+"-icon-underline"]=u,n));return r?o("div",{className:d,onMouseDown:this.preventLoseFocus,onClick:a,ref:s,tabIndex:a?0:-1,onKeyDown:a?this.handleIconKeyDown(a):void 0,role:"button"},"string"==typeof r?o("span",{className:t(l+"-icon-img"),style:{backgroundImage:'url("'+r+'")'}}):r):null},t.prototype.renderRightIcons=function(e,t){var n,r,i=this.props,a=i.prefixCls,s=i.showClear,c=i.icon,l=i.onClickIcon,u=i.underline,d=t(a+"-clear",((n={})[a+"-clear-visible"]=e,n[a+"-icon"]=!u,n[a+"-clear-underline"]=u,n)),p=t(a+"-icon-container",((r={})[a+"-icon-container-underline"]=u,r));return s||c?o("div",{className:p,ref:this.rightIconsRef},s?o("button",{className:d,onMouseDown:this.preventLoseFocus,onClick:this.handleClear}):null,this.renderSingleIcon({prop:c,handler:l},t)):null},t.prototype.render=function(){return c.consumeTheme(this.themedRender)},t.contextType=s.FormItemContext,t}(i.Component);t.default=l,l.defaultProps={prefixCls:"dui-input",onChange:a.emptyFn,showClear:!1,defaultValue:""}},52965:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(85556),o=n(56630).h,i=r.__importDefault(n(87363)),a=r.__importDefault(n(58694)),s=n(68848),c="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIiBvcGFjaXR5PSIuNjM3Ij48cGF0aCBzdHJva2U9IiMwMDAiIHN0cm9rZS13aWR0aD0iMS4yNSIgZD0iTTE1Ljk0NiA5LjIyOEE3LjcyIDcuNzIgMCAwIDAgMi4zNTEgOS4xM2E3LjcxNyA3LjcxNyAwIDAgMCAxMy41OTUuMDk4eiIvPjxwYXRoIHN0cm9rZT0iI2ZmZiIgZD0iTTkuMTUgMTIuMjAyYTMgMyAwIDEgMCAwLTYgMyAzIDAgMCAwIDAgNnoiLz48L3N2Zz4=",l="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCI+PHBhdGggZD0iTTEuODU2IDEwLjc5NGwyLjIxMy0zLjMzTTYuNDE3IDEzbC45MTItMy43NDNtOC44NjcgMS41ODVsLTIuMDYtMy40MjdtLTIuNTcyIDUuNTkzbC0uOTM0LTMuNzZNMS44NTYgNmMyLjAzIDIuMzkzIDQuMzc0IDMuNjQ0IDcuMDMgMy43NTRzNS4wOS0xLjE0MiA3LjMxLTMuNzU0IiBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAiIHN0cm9rZS13aWR0aD0iMS4yNSIgb3BhY2l0eT0iLjY0MiIvPjwvc3ZnPg==",u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.inputRef=i.default.createRef(),t.state={passwordVisible:!1},t.refDom=function(e){t.inputRef.current=e;var n=t.props.inputRef;n&&("function"==typeof n?n(e):n.current=e)},t.togglePasswordVisibility=function(){var e=t.inputRef.current,n=e.selectionStart,r=e.selectionEnd;t.setState((function(e){return{passwordVisible:!e.passwordVisible}}),(function(){setTimeout((function(){e.setSelectionRange(n,r)}),0)}))},t.themedRender=function(e){var n=t.props,i=n.showToggle,s=r.__rest(n,["showToggle"]),u=t.state.passwordVisible,d=u?c:l;return o(a.default,r.__assign({icon:i?d:void 0,inputStyle:{letterSpacing:u?"2px":"4px"},onClickIcon:t.togglePasswordVisibility,type:u?"text":"password",inputRef:t.refDom},s))},t}return r.__extends(t,e),t.prototype.render=function(){return s.consumeTheme(this.themedRender)},t}(i.default.Component);t.default=u,u.defaultProps={showToggle:!0}},19955:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.Input=void 0;var r=n(85556),o=r.__importDefault(n(58694));t.Input=o.default,n(36226).D("components/Input/style/index.css",'[data-dui-0-134-2~="dui-input"]{-webkit-tap-highlight-color:transparent;position:relative}[data-dui-0-134-2~="dui-input-disabled"]{pointer-events:none}[data-dui-0-134-2~="dui-input-input"]{display:block;outline:none;font-size:14px;height:36px;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;padding:7px 11px;border:1px solid var(--border-medium,rgba(0,0,0,.08));border-radius:4px;-webkit-appearance:none;-moz-appearance:none;appearance:none;margin:0;color:var(--text-ultrastrong,rgba(0,0,0,.88));background:transparent}[data-dui-0-134-2~="dui-input-input"]:not([data-dui-0-134-2~="dui-input-input-underline"]):disabled{color:var(--text-weak,rgba(0,0,0,.24));border-color:var(--border-weak,rgba(0,0,0,.04))}[data-dui-0-134-2~="dui-input-input"]::-webkit-input-placeholder{color:var(--text-weak,rgba(0,0,0,.24));letter-spacing:normal}[data-dui-0-134-2~="dui-input-input"]::-moz-placeholder{color:var(--text-weak,rgba(0,0,0,.24));letter-spacing:normal}[data-dui-0-134-2~="dui-input-input"]:-ms-input-placeholder{color:var(--text-weak,rgba(0,0,0,.24));letter-spacing:normal}[data-dui-0-134-2~="dui-input-input"]::-ms-input-placeholder{color:var(--text-weak,rgba(0,0,0,.24));letter-spacing:normal}[data-dui-0-134-2~="dui-input-input"]::placeholder{color:var(--text-weak,rgba(0,0,0,.24));letter-spacing:normal}[data-dui-0-134-2~="dui-input-input"]:hover{border-color:var(--border-strong,rgba(0,0,0,.12))}[data-dui-0-134-2~="dui-input-input"]:focus{border-color:var(--accent-default,#1e6fff)}[data-dui-0-134-2~="dui-input-input-underline"]{padding:6px 0;border-color:transparent;border-bottom-color:var(--border-medium,rgba(0,0,0,.08));border-radius:0}[data-dui-0-134-2~="dui-input-input-underline"]:hover{border-color:transparent;border-bottom-color:var(--border-strong,rgba(0,0,0,.12))}[data-dui-0-134-2~="dui-input-input-underline"]:focus{border-color:transparent;border-bottom-color:var(--accent-default,#1e6fff)}[data-dui-0-134-2~="dui-input-input-underline"]:disabled{color:var(--text-weak,rgba(0,0,0,.24));border-bottom-color:var(--border-weak,rgba(0,0,0,.04))}[data-dui-0-134-2~="dui-input-input-error"],[data-dui-0-134-2~="dui-input-input-error"]:focus,[data-dui-0-134-2~="dui-input-input-error"]:hover{border-color:var(--critical-default,#ff4747)}[data-dui-0-134-2~="dui-input-input-error"][data-dui-0-134-2~="dui-input-input-underline"]{border-color:transparent;border-bottom-color:var(--critical-default,#ff4747)}[data-dui-0-134-2~="dui-input-clear"],[data-dui-0-134-2~="dui-input-icon"]{border:none;margin:0;padding:0;background:transparent;-webkit-tap-highlight-color:transparent}[data-dui-0-134-2~="dui-input-clear"]{display:inline-block;width:16px;height:16px;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'16\' height=\'16\' fill=\'none\'%3E%3Ccircle cx=\'8\' cy=\'8\' r=\'8\' fill=\'%233d5266\' fill-opacity=\'.16\'/%3E%3Cpath fill-rule=\'evenodd\' d=\'M10.833 10.832a.584.584 0 00.004-.814L8.822 8.002l2.015-2.02a.584.584 0 00-.004-.814.58.58 0 00-.814-.004L7.999 7.18l-2.02-2.02c-.209-.209-.592-.218-.814.004s-.218.605-.004.818l2.02 2.02-2.02 2.02a.59.59 0 00.004.814.593.593 0 00.814.004l2.02-2.02 2.02 2.015a.58.58 0 00.814-.004z\' fill=\'%23fff\'/%3E%3C/svg%3E");background-position:50%;background-repeat:no-repeat;visibility:hidden;cursor:pointer}[data-dui-0-134-2~="dui-input-clear-visible"]{visibility:visible}[data-dui-0-134-2~="dui-input-clear"]:hover{opacity:.5}[data-dui-0-134-2~="dui-input"]:not(:focus-within) [data-dui-0-134-2~="dui-input-clear"]{visibility:hidden}[data-dui-0-134-2~="dui-input-icon-container"],[data-dui-0-134-2~="dui-input-icon-left"]{position:absolute;height:100%;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%)}[data-dui-0-134-2~="dui-input-icon"],[data-dui-0-134-2~="dui-input-icon-container"]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}[data-dui-0-134-2~="dui-input-icon"]{width:39px;height:100%;border-radius:3px}[data-dui-0-134-2~="dui-input-icon-container"]{right:0}[data-dui-0-134-2~="dui-input-icon-container-underline"]>:not(:last-child){margin-right:7px}[data-dui-0-134-2~="dui-input-icon-underline"]{width:auto;height:auto}[data-dui-0-134-2~="dui-input-icon-clickable"]{cursor:pointer}[data-dui-0-134-2~="dui-input-icon-clickable"]:not([data-dui-0-134-2~="dui-input-icon-underline"]):not([data-dui-0-134-2~="dui-input-clear-underline"]):hover{background-color:rgba(0,0,0,.04)}[data-dui-0-134-2~="dui-input-icon-clickable"]:not([data-dui-0-134-2~="dui-input-icon-underline"]):not([data-dui-0-134-2~="dui-input-clear-underline"]):active{background-color:rgba(0,0,0,.08)}[data-dui-0-134-2~="dui-input-icon-img"]{display:inline-block;width:16px;height:16px;background-size:cover;background-position:50%;background-repeat:no-repeat}[data-dui-0-134-2~="dui-input-icon-left"]{left:0}[data-dui-0-134-2~="dui-input-icon-right"]{height:100%;right:0}[data-dui-0-134-2~="dui-input-error-text"]{color:var(--text-error,#eb3639);font-size:12px;line-height:16px;position:absolute;top:100%;left:0;margin-top:4px}');var i=r.__importDefault(n(52965));o.default.Password=i.default,t.default=o.default},93397:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.LOADING_TRANSITION_DURATION=void 0;var r=n(85556),o=n(56630).h,i=r.__importStar(n(87363)),a=r.__importDefault(n(61533)),s=r.__importStar(n(53211)),c=r.__importDefault(n(89640)),l=n(89805),u=n(68848),d=n(37216);t.LOADING_TRANSITION_DURATION=200;var p=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.themedRender=function(e){var i,s,u=n.props,p=u.prefixCls,h=u.className,f=u.style,g=u.tip,v=u.visible,y=u.children,m=u.embedded,b=u.tipStyle,_=u.zIndex,C=u.tipClassName,S=u.maskClassName,w=u.maskStyle,E=u.spinType,x=y?"wrap":m?"embedded":"fixed",T=e(p,h,p+"-"+x,((i={})[p+"-hidden"]=!v&&!m,i)),R=e(p+"-mask",p+"-mask-"+x,S,((s={})[p+"-mask-hidden"]=!v,s)),I=e(p+"-container",p+"-container-"+x),P={width:"48px",height:"48px"},O=g?o("div",{className:e(p+"-tip",C),style:b},g):null;return"wrap"===x?o("div",{className:I},y,o("div",{className:R,style:w,"aria-hidden":!v},o("div",{className:T,style:f},o(c.default,{style:P,type:E||"dark"}),O))):"embedded"===x?o("div",{className:T,style:r.__assign(r.__assign({},P),f)},o(c.default,{type:E||"dark"})):l.decideKeepDom.call(n,t.LOADING_TRANSITION_DURATION,v)?a.default.createPortal(o(d.PreventScrollPenetrateContainer,{className:I,style:{zIndex:_},"aria-hidden":!v},o("div",{className:R,style:w}),o("div",{className:T,style:f},o(c.default,{style:P,type:E||"light"}),O)),document.body):null},n}return r.__extends(n,e),n.prototype.render=function(){return u.consumeTheme(this.themedRender)},n}(i.Component);t.default=p,p.defaultProps={prefixCls:"dui-loading",embedded:!0},p.propTypes={prefixCls:s.string,style:s.object,className:s.string,tip:s.any,visible:s.bool,tipStyle:s.object,tipClassName:s.string,embedded:s.bool,zIndex:s.number,maskClassName:s.string,maskStyle:s.object,spinType:s.oneOf(["light","dark","primary"])}},89640:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(85556),o=n(56630).h,i=r.__importStar(n(87363)),a=r.__importStar(n(53211));n(36226).D("components/Loading/style/spin.css",'[data-dui-0-134-2~="dui-spin"]{position:relative;width:100%;height:100%}[data-dui-0-134-2~="dui-spin-container"]{position:absolute;left:50%;top:50%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;width:48px;height:48px}[data-dui-0-134-2~="dui-spin-circle"]{border-radius:50%;width:100%;height:100%;-webkit-animation:dui-spin-rotate .8s linear infinite;animation:dui-spin-rotate .8s linear infinite;-webkit-box-sizing:border-box;box-sizing:border-box}[data-dui-0-134-2~="dui-spin-circle-light"]{border:4px solid hsla(0,0%,100%,.4);border-top-color:#fff}[data-dui-0-134-2~="dui-spin-circle-dark"]{border:4px solid rgba(0,0,0,.12);border-top-color:rgba(0,0,0,.32)}[data-dui-0-134-2~="dui-spin-circle-primary"]{border:4px solid rgba(30,111,255,.24);border-top:4px solid var(--accent-default,#1e6fff)}@-webkit-keyframes dui-spin-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes dui-spin-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}');var s=n(68848),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rootRef=i.createRef(),t.themedRender=function(e){var n=t.props,r=n.prefixCls,i=n.className,a=n.style,s=n.type,c=n.circleClassName,l=n.circleStyle,u=e(r,i),d=e(r+"-circle",r+"-circle-"+s,c);return o("div",{className:u,style:a,ref:t.rootRef},o("div",{className:e(r+"-container"),style:t.calcContainerTransform()},o("div",{className:d,style:l})))},t}return r.__extends(t,e),t.prototype.calcContainerTransform=function(){var e=this.rootRef.current;if(e){var t=e.clientWidth,n=e.clientHeight;return{transform:"translate(-50%,-50%) scale("+Math.min(t,n)/48+")"}}},t.prototype.componentDidMount=function(){this.forceUpdate()},t.prototype.render=function(){return s.consumeTheme(this.themedRender)},t}(i.PureComponent);t.default=c,c.defaultProps={prefixCls:"dui-spin",type:"dark"},c.propTypes={prefixCls:a.string,style:a.object,className:a.string,type:a.oneOf(["light","dark","primary"]),circleClassName:a.string,circleStyle:a.object}},35776:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.Loading=void 0;var r=n(85556);n(36226).D("components/Loading/style/index.css",'@-webkit-keyframes dui-loading-fade-in{0%{opacity:0}to{opacity:1}}@keyframes dui-loading-fade-in{0%{opacity:0}to{opacity:1}}@-webkit-keyframes dui-loading-rotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes dui-loading-rotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@-webkit-keyframes dui-loading-pop-up{0%{opacity:0;-webkit-transform:scale3d(.9,.9,1);transform:scale3d(.9,.9,1)}to{opacity:1;-webkit-transform:scaleX(1);transform:scaleX(1)}}@keyframes dui-loading-pop-up{0%{opacity:0;-webkit-transform:scale3d(.9,.9,1);transform:scale3d(.9,.9,1)}to{opacity:1;-webkit-transform:scaleX(1);transform:scaleX(1)}}[data-dui-0-134-2~="dui-loading-wrap"] [data-dui-0-134-2~="dui-loading-tip"]{color:rgba(0,0,0,.8)}[data-dui-0-134-2~="dui-loading-fixed"]{background:rgba(0,0,0,.8);-webkit-animation:dui-loading-pop-up .2s ease-out;animation:dui-loading-pop-up .2s ease-out;-webkit-transition:all .2s ease-out;transition:all .2s ease-out}[data-dui-0-134-2~="dui-loading-fixed"],[data-dui-0-134-2~="dui-loading-wrap"]{-webkit-box-sizing:border-box;box-sizing:border-box;min-width:130px;min-height:130px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-flow:column nowrap;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;padding:26px 21px 22px;border-radius:4px}[data-dui-0-134-2~="dui-loading-hidden"]{opacity:0;-webkit-transform:scale3d(.9,.9,1);transform:scale3d(.9,.9,1);visibility:hidden}[data-dui-0-134-2~="dui-loading-container"]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}[data-dui-0-134-2~="dui-loading-container-fixed"]{position:fixed;z-index:9999;top:0;left:0;right:0;bottom:0}[data-dui-0-134-2~="dui-loading-container-wrap"]{position:relative}[data-dui-0-134-2~="dui-loading-mask"]{position:absolute;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;left:0;top:0;width:100%;height:100%;background-color:hsla(0,0%,100%,.65);-webkit-transition:all .2s ease-out;transition:all .2s ease-out}[data-dui-0-134-2~="dui-loading-mask-fixed"]{z-index:-1;-webkit-animation:dui-loading-fade-in .2s ease-out;animation:dui-loading-fade-in .2s ease-out}[data-dui-0-134-2~="dui-loading-mask-hidden"]{opacity:0;visibility:hidden}[data-dui-0-134-2~="dui-loading-tip"]{color:#fff;font-size:14px;margin-top:18px;line-height:16px}');var o=r.__importDefault(n(73106)),i=r.__importDefault(n(93397));t.Loading=i.default,i.default.show=o.default,t.default=i.default},73106:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(85556).__importStar(n(93397)),o=n(92437),i=n(80328);t.default=i.wrapWithConfigDefaults((function(e){return void 0===e&&(e={}),o.showWithTransition({Component:r.default,transitionDuration:r.LOADING_TRANSITION_DURATION,autoClose:!1,forcedProps:{embedded:!1},props:e,contexts:e.contexts})}))},61499:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(85556),o=n(56630).h,i=r.__importStar(n(87363)),a=r.__importDefault(n(61533)),s=r.__importStar(n(53211)),c=r.__importDefault(n(4339)),l=n(80328),u=n(68848),d=n(89746),p=r.__importDefault(n(62249)),h={horizontal:"right",vertical:"bottom",height:0},f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.popupRef=i.createRef(),t.anchorRef=i.createRef(),t.state={visible:!1,menu:null,location:{left:0,top:0},metrics:r.__assign({},h)},t.handleScroll=p.default((function(e){var n;(null===(n=t.popupRef.current)||void 0===n?void 0:n.contains(e.target))||t.hide()}),30),t.handleContextMenu=function(e){e.preventDefault();var n=t.props,o=n.menu,i=n.disabled,a=n.onVisibleChange;i||t.setState({menu:"function"==typeof o?o(e):o,visible:!1,location:{left:e.pageX,top:e.pageY},metrics:r.__assign(r.__assign({},t.state.metrics),{height:0})},(function(){t.updatePopoutMetrics(),t.setState({visible:!0},(function(){a(!0)}))}))},t.hide=function(){t.isVisible()&&t.setState({visible:!1},(function(){t.props.onVisibleChange(!1)}))},t.themedRender=function(e){var n,i=t.props,s=i.prefixCls,l=i.className,u=i.style,p=i.children,h=i.disabled,f=i.popupStyle,g=i.zIndex,v=i.popupClassName,y=t.isVisible(),m=e(s,l,((n={})[s+"-disabled"]=h,n)),b=t.state,_=b.location,C=_.left,S=_.top,w=b.menu,E=b.metrics,x=E.height,T=E.vertical,R=e(s+"-popup",v,s+"-popup-"+E.horizontal+"-"+T,s+"-popup-"+(y?"visible":"hidden"));return o(c.default,{action:t.hide},o("div",{className:m,style:u,onContextMenu:t.handleContextMenu,ref:t.anchorRef},p),a.default.createPortal(o(c.default,{className:R,style:r.__assign({left:C+"px",top:S+"px",height:x?x+"px":void 0,zIndex:g},f),action:t.hide,domRef:t.popupRef,disableContextMenu:!0},o(d.ContextMenuContext.Provider,{value:d.getContextMenuContext({visible:y,onClick:t.hide})},w)),document.body))},t}return r.__extends(t,e),t.getDerivedStateFromProps=function(e,t){return e.disabled?{visible:!1}:null},t.prototype.componentDidMount=function(){document.addEventListener("scroll",this.handleScroll,{passive:!0,capture:!0}),document.addEventListener("wheel",this.handleScroll)},t.prototype.componentWillUnmount=function(){document.removeEventListener("scroll",this.handleScroll),document.removeEventListener("wheel",this.handleScroll)},t.prototype.isVisible=function(){var e=this.props,t=e.visible;if(e.disabled)return!1;var n=this.state.visible;return"boolean"==typeof t?t:n},t.prototype.updatePopoutMetrics=function(){var e=this.props,t=e.popupBoundary,n=e.popupMargin,r=this.anchorRef.current,o=this.popupRef.current;if(o&&r){var i=this.state.location,a=i.left,s=i.top,c=a-window.pageXOffset,l=s-window.pageYOffset,u=0,d=window.innerWidth,p=0,h=window.innerHeight,f=r.getBoundingClientRect(),g=f.left,v=f.right,y=f.top,m=f.bottom;"container"===t&&(u=Math.max(u,g),d=Math.min(d,v),p=Math.max(p,y),h=Math.min(h,m)),u+=n,d-=n,p+=n,h-=n;var b=o.getBoundingClientRect(),_=b.width,C=b.height,S=h-l,w=l-p,E="bottom",x=0;C>S?C>w?S>=w?(E="bottom",x=S):(E="top",x=w):E="top":E="bottom";var T={horizontal:c+_<=d||c<=(d+u)/2?"right":"left",vertical:E,height:x};this.setState({metrics:T})}},t.prototype.render=function(){return u.consumeTheme(this.themedRender)},t}(i.Component);t.default=f,f.defaultProps={prefixCls:"dui-menu-contextmenu",disabled:!1,popupBoundary:"viewport",popupMargin:0,onVisibleChange:l.emptyFn},f.propTypes={prefixCls:s.string,style:s.object,className:s.string,menu:s.any,disabled:s.bool,popupStyle:s.object,popupClassName:s.string,visible:s.bool,popupBoundary:s.oneOf(["container","viewport"]),popupMargin:s.number,onVisibleChange:s.func,zIndex:s.number}},92059:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(85556),o=n(56630).h,i=r.__importDefault(n(87363)),a=n(68848),s=r.__importDefault(n(19955)),c=r.__importDefault(n(62997)),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.themedRender=function(e){var n=t.props,i=n.className,a=n.inputClassName,l=n.prefixCls,u=n.containerClassName,d=n.containerStyle,p=n.prefix,h=n.postfix,f=r.__rest(n,["className","inputClassName","prefixCls","containerClassName","containerStyle","prefix","postfix"]),g=e(l,i),v=e(l+"-input",a),y=e(l+"-container",u),m=e(l+"-prefix"),b=e(l+"-postfix");return o(c.default,{className:y,style:d},p&&o("div",{className:m},p),o(s.default,r.__assign({className:g,inputClassName:v},f)),h&&o("div",{className:b},h))},t}return r.__extends(t,e),t.prototype.render=function(){return a.consumeTheme(this.themedRender)},t}(i.default.Component);t.default=l,l.defaultProps={prefixCls:"dui-menu-input"}},63748:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(85556),o=n(56630).h,i=r.__importStar(n(87363)),a=n(80328),s=n(89746),c=r.__importDefault(n(62997)),l=n(68848),u=r.__importDefault(n(88560)),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.domRef=i.createRef(),t.state={actionActive:!1},t.refDom=function(e){t.domRef.current=e;var n=t.props.domRef,r=t.context.selectedItemDoms;t.isSelected()?null==r||r.add(e):null==r||r.delete(e),n&&("function"==typeof n?n(e):n.current=e)},t.handleClick=function(e){var n,r=t.context.clickHandler,o=t.props,i=o.disabled,a=o.onClick;e.detail&&(null===(n=t.domRef.current)||void 0===n||n.blur()),i||e.nativeEvent._dui_menu_item_action||!1!==a(e)&&(e.isPropagationStopped()||r(t.props.id))},t.handleKeyDown=function(e){var n,r=t.props,o=r.disabled,i=r.onKeyDown;o||!1!==i(e)&&[" ","Enter"].includes(e.key)&&(e.preventDefault(),null===(n=t.domRef.current)||void 0===n||n.click())},t.handleActionClick=function(e){e.nativeEvent._dui_menu_item_action=!0},t.handleToggleAction=function(e){t.setState({actionActive:e})},t.handleMouseEnter=function(e){var n=t.props,r=n.disabled,o=n.onMouseEnter;r||o(e)},t.handleMouseLeave=function(e){var n=t.props,r=n.disabled,o=n.onMouseLeave;r||o(e)},t.themedRender=function(e){var n,i=t.props,a=i.prefixCls,s=i.className,l=i.style,u=i.disabled,d=i.description,p=i.htmlId,h=i.containerClassName,f=i.containerStyle,g=i.testId,v=i.action,y=(i.id,i.children,i.icon,i.onClick,i.onKeyDown,i.selected,i.domRef,i.actionTriggersDropdownHide,i.onMouseEnter,i.onMouseLeave,r.__rest(i,["prefixCls","className","style","disabled","description","htmlId","containerClassName","containerStyle","testId","action","id","children","icon","onClick","onKeyDown","selected","domRef","actionTriggersDropdownHide","onMouseEnter","onMouseLeave"])),m=t.state.actionActive,b=t.context,_=b.itemStyle,C=b.itemClassName,S=t.isSelected(),w=e(a,s,C,((n={})[a+"-disabled"]=u,n[a+"-selected"]=S,n[a+"-with-action"]=v,n[a+"-with-action-active"]=m,n)),E=e(a+"-container",h);return o(c.default,{disabled:!u,className:E,style:f},o("li",r.__assign({className:w,style:r.__assign(r.__assign({},_),l),onClick:t.handleClick,ref:t.refDom,onMouseEnter:t.handleMouseEnter,onMouseLeave:t.handleMouseLeave,role:"menuitem","aria-disabled":u,"aria-checked":S,tabIndex:u?-1:0,onKeyDown:t.handleKeyDown,id:p,"data-testid":g},y),t.renderChildren(e),d?o("span",{className:e(a+"-description")},d):null,t.renderAdditionalAction(e)))},t}return r.__extends(t,e),t.prototype.isSelected=function(){return"boolean"==typeof this.props.selected?this.props.selected:-1!==this.context.selectedIds.indexOf(this.props.id)},t.prototype.renderChildren=function(e){var t=this.props,n=t.prefixCls,r=t.children,i=t.icon,a=i?"string"==typeof i?o("div",{className:e(n+"-icon"),style:{backgroundImage:'url("'+i+'")'}}):i:null,s="string"==typeof r?o("div",{className:e(n+"-text-container")},r):r;return a?o("div",{className:e(n+"-icon-container")},a,s):s},t.prototype.renderAdditionalAction=function(e){var t,n,r=this.props,i=r.prefixCls,a=r.action,s=r.actionTriggersDropdownHide,c=this.state.actionActive;if(!a)return null;var l=e(i+"-action-wrapper",((t={})[i+"-action-wrapper-active"]=c,t)),d=e(i+"-action",((n={})[i+"-action-active"]=c,n));return o(u.default.Keep,{className:l,onClick:this.handleActionClick,disabled:s},o(u.default,{dropContent:a,alignment:"right-outer",dropContentClassName:e(i+"-action-content"),visible:c,onVisibleChange:this.handleToggleAction},o(u.default.Keep,{className:d})))},t.prototype.componentWillUnmount=function(){var e=this.context.selectedItemDoms,t=this.domRef.current;null==e||e.delete(t)},t.prototype.render=function(){return l.consumeTheme(this.themedRender)},t.contextType=s.MenuItemContext,t}(i.Component);t.default=d,d.defaultProps={prefixCls:"dui-menu-item",id:"",onMouseEnter:a.emptyFn,onMouseLeave:a.emptyFn,onClick:a.emptyFn,disabled:!1,onKeyDown:a.emptyFn,actionTriggersDropdownHide:!0}},44722:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(85556),o=n(56630).h,i=r.__importStar(n(87363)),a=n(80328),s=n(40782),c=n(89746),l=n(68848),u=n(259),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.listRef=i.createRef(),t.clickedIds=[],t.selectedItemDoms=new Set,t.handleClick=function(e){if(0!==t.clickedIds.length){var n=t.clickedIds.shift();t.clickedIds=[],t.props.onClick(n,e),t.context.onClick()}},t.handleItemClick=function(e){t.clickedIds.push(e)},t.handleContextMenu=function(e){e.preventDefault()},t.handleKeyDown=function(e){if(t.isVisible()){var n=t.listRef.current;"ArrowDown"===e.key?u.traverseFocusIn(n,e,!1):"ArrowUp"===e.key&&u.traverseFocusIn(n,e,!0)}},t.themedRender=function(e){var n,i=t.props,a=i.prefixCls,l=i.className,u=i.style,d=i.children,p=i.itemStyle,h=i.selectedIds,f=i.type,g=i.itemClassName,v=i.selectable,y=i.subMenuViewportMargin,m=i.testId,b=(i.onClick,i.visible,i.keyDownEventDom,r.__rest(i,["prefixCls","className","style","children","itemStyle","selectedIds","type","itemClassName","selectable","subMenuViewportMargin","testId","onClick","visible","keyDownEventDom"])),_=t.isVisible(),C=e(a,a+"-"+f,l,((n={})[a+"-hidden"]=!_,n[a+"-non-selectable"]=!v,n));return o(s.DropdownContext.Consumer,null,(function(e){var n=e.visible;return o(c.MenuItemContext.Provider,{value:c.getMenuItemContext({itemStyle:p,itemClassName:g,clickHandler:t.handleItemClick,selectedIds:h,selectedItemDoms:t.selectedItemDoms})},o(c.SubMenuContext.Provider,{value:c.getSubMenuContext({zIndex:1e4,visible:n&&_,type:f,horizontalPlacement:"right",viewportMargin:y})},o("ul",r.__assign({className:C,style:u,onClick:t.handleClick,onContextMenu:t.handleContextMenu,role:"menu","aria-haspopup":!0,ref:t.listRef,"data-testid":m},b),d)))}))},t}return r.__extends(t,e),Object.defineProperty(t.prototype,"keyDownDom",{get:function(){return void 0===this.props.keyDownEventDom?document:this.props.keyDownEventDom},enumerable:!1,configurable:!0}),t.prototype.isVisible=function(){return this.context.visible&&this.props.visible},t.prototype.scrollToSelected=function(){var e;null===(e=Array.from(this.selectedItemDoms.values())[0])||void 0===e||e.scrollIntoView()},t.prototype.componentDidMount=function(){var e;this.forceUpdate(),null===(e=this.keyDownDom)||void 0===e||e.addEventListener("keydown",this.handleKeyDown)},t.prototype.componentWillUnmount=function(){var e;null===(e=this.keyDownDom)||void 0===e||e.removeEventListener("keydown",this.handleKeyDown)},t.prototype.render=function(){return l.consumeTheme(this.themedRender)},t.contextType=c.ContextMenuContext,t}(i.Component);t.default=d,d.defaultProps={prefixCls:"dui-menu",onClick:a.emptyFn,selectedIds:[],visible:!0,type:"normal",selectable:!0,subMenuViewportMargin:2}},55418:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(85556),o=n(56630).h,i=r.__importStar(n(87363)),a=r.__importDefault(n(61533)),s=r.__importDefault(n(63748)),c=n(89746),l=r.__importDefault(n(62997)),u=n(68848),d=n(80328),p=n(259),h={verticalPlacement:"bottom",horizontalPlacement:"right",location:{left:"0px",top:"0px"},forcedHeight:0},f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemRef=i.createRef(),t.popupWrapperRef=i.createRef(),t.popupContentRef=i.createRef(),t.state={visible:!1,metrics:r.__assign({},h)},t.handleMouseEnter=function(){clearTimeout(t.hideTimeout),t.props.disabled||t.isVisible()||(clearTimeout(t.showTimeout),t.showTimeout=setTimeout((function(){t.setState({metrics:r.__assign(r.__assign({},t.state.metrics),{forcedHeight:0})},(function(){t.updatePopoutMetrics(),t.setStateVisible(!0)}))}),t.props.hoverDelay))},t.handleMouseLeave=function(e){!t.props.disabled&&e.relatedTarget&&(clearTimeout(t.showTimeout),t.hideTimeout=setTimeout((function(){return t.setStateVisible(!1)}),t.props.hoverDelay))},t.handleLeavePage=function(){t.props.disabled||"hidden"!==document.visibilityState||t.setStateVisible(!1)},t.handleSubmenuClick=function(e){var n=t.props.onClick;return n?(!1!==n(e)&&(e.nativeEvent._dui_bypass_dropdown_keep=!0),!0):(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),!1)},t.handleSubMenuItemKeyDown=function(e){return t.props.disabled||[" ","Enter","ArrowRight"].includes(e.key)&&(t.handleMouseEnter(),e.preventDefault(),setTimeout((function(){var e=t.popupContentRef.current;e&&p.traverseFocusIn(e,null,!1)}),50)),!1},t.handleContentKeyDown=function(e){var n;if(!t.props.disabled){var r=t.popupContentRef.current;e.stopPropagation(),["ArrowDown","ArrowUp"].includes(e.key)&&(e.nativeEvent.stopImmediatePropagation(),p.traverseFocusIn(r,e,"ArrowUp"===e.key)),"ArrowLeft"===e.key&&(t.setStateVisible(!1),null===(n=t.itemDom)||void 0===n||n.focus())}},t.themedRender=function(e){var n,i,u=t.props,d=u.prefixCls,p=u.className,h=u.style,f=u.children,g=u.id,v=u.title,y=u.disabled,m=u.popupStyle,b=u.popupClassName,_=u.zIndex,C=u.icon,S=u.selectable,w=u.type,E=u.description,x=u.selected,T=u.testId,R=u.popupTestId,I=u.onClick,P=u.containerDom,O=t.context,k=O.zIndex,D=O.type,M=t.state.metrics,A=M.location,L=M.verticalPlacement,N=M.forcedHeight,B=M.horizontalPlacement,F=_||k,U=t.isVisible(),H=e(d,p,((n={})[d+"-disabled"]=y,n[d+"-with-desc"]=E,n[d+"-clickable"]=I,n[d+"-visible"]=U,n)),j=e(d+"-wrapper",d+"-wrapper-"+(U?"visible":"hidden-"+L)),G=w||D,V=e(d+"-content",b,d+"-content-"+G,((i={})[d+"-content-non-selectable"]=!S,i));return o(c.SubMenuContext.Provider,{value:c.getSubMenuContext({zIndex:F+1,visible:U,type:G,horizontalPlacement:B,viewportMargin:t.context.viewportMargin})},o("div",{onMouseEnter:t.handleMouseEnter,onMouseLeave:t.handleMouseLeave},o(l.default,null,o(s.default,{id:g,className:H,style:h,ref:t.itemRef,disabled:y,onClick:t.handleSubmenuClick,onKeyDown:t.handleSubMenuItemKeyDown,icon:C,description:E,selected:x,"data-testid":T},v||g)),a.default.createPortal(o("div",{className:j,ref:t.popupWrapperRef,style:r.__assign(r.__assign({},A),{zIndex:F})},o("ul",{className:V,style:r.__assign({height:N?N+"px":void 0},m),ref:t.popupContentRef,role:"menu","aria-haspopup":!0,"aria-expanded":U,onKeyDown:t.handleContentKeyDown,"data-testid":R},f)),P||document.body)))},t}return r.__extends(t,e),t.getDerivedStateFromProps=function(e,t){return e.disabled?{visible:!1}:null},Object.defineProperty(t.prototype,"itemDom",{get:function(){var e;return null===(e=this.itemRef.current)||void 0===e?void 0:e.domRef.current},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){document.addEventListener("visibilitychange",this.handleLeavePage)},t.prototype.componentWillUnmount=function(){document.removeEventListener("visibilitychange",this.handleLeavePage),clearTimeout(this.hideTimeout),clearTimeout(this.showTimeout)},t.prototype.updatePopoutMetrics=function(){var e=this.itemDom;if(e){var t=this.popupWrapperRef.current;if(t){var n=window.innerWidth,r=window.innerHeight,o=e.getBoundingClientRect(),i=o.right,a=o.left,s=o.top,c=o.bottom,l=t.getBoundingClientRect(),u=l.width,d=l.height,p=this.context,h=p.horizontalPlacement,f=p.viewportMargin,g=[];i+u<n&&g.push("right"),a-u>0&&g.push("left");var v=g.includes(h)?h:g[0]||"right",y=r-s-f,m=c-f,b="bottom",_=0;d>=y?d>=m?y>=m?(b="bottom",_=y):(b="top",_=m):b="top":b="bottom";var C={verticalPlacement:b,horizontalPlacement:v,location:{left:window.pageXOffset+("right"===v?i+-2:a-u- -2)+"px",top:window.pageYOffset+("bottom"===b?s:c-(_||d))+"px"},forcedHeight:_};this.setState({metrics:C})}}},t.prototype.isVisible=function(){var e=this.state.visible,t=this.context.visible,n=this.props.disabled;return t&&e&&!n},t.prototype.setStateVisible=function(e){var t=this;this.setState({visible:e},(function(){t.props.onVisibleChange(e)}))},t.prototype.render=function(){return u.consumeTheme(this.themedRender)},t.contextType=c.SubMenuContext,t}(i.Component);t.default=f,f.defaultProps={prefixCls:"dui-menu-submenu",id:"",disabled:!1,onVisibleChange:d.emptyFn,selectable:!0,hoverDelay:100}},89746:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.getContextMenuContext=t.ContextMenuContext=t.getSubMenuContext=t.SubMenuContext=t.getMenuItemContext=t.MenuItemContext=void 0;var r=n(85556).__importStar(n(87363)),o=n(80328);t.MenuItemContext=r.createContext({itemStyle:void 0,clickHandler:o.emptyFn,selectedIds:[]}),t.getMenuItemContext=o.createContextValueGetter(),t.SubMenuContext=r.createContext({zIndex:1e4,visible:!0,type:"normal",horizontalPlacement:"right",viewportMargin:2}),t.getSubMenuContext=o.createContextValueGetter(),t.ContextMenuContext=r.createContext({visible:!0,onClick:o.emptyFn}),t.getContextMenuContext=o.createContextValueGetter()},29492:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.Menu=void 0;var r=n(85556),o=r.__importDefault(n(44722));t.Menu=o.default;var i=r.__importDefault(n(63748)),a=r.__importDefault(n(55418)),s=r.__importDefault(n(61499)),c=r.__importDefault(n(92059));n(36226).D("components/Menu/style/index.css",'[data-dui-0-134-2~="dui-menu"],[data-dui-0-134-2~="dui-menu-submenu-content"]{-webkit-box-shadow:0 2px 12px 2px rgba(68,73,77,.16);box-shadow:0 2px 12px 2px rgba(68,73,77,.16);list-style:none;padding:8px 0;margin:0;border:1px solid rgba(0,0,0,.12);border-radius:4px;-webkit-tap-highlight-color:transparent;overflow-y:auto;overflow-x:hidden;-webkit-box-sizing:border-box;box-sizing:border-box;height:100%;background-color:#fff}@supports ((-webkit-backdrop-filter:blur(1px)) or (backdrop-filter:blur(1px))){[data-dui-0-134-2~="dui-menu"],[data-dui-0-134-2~="dui-menu-submenu-content"]{background-color:hsla(0,0%,100%,.92);-webkit-backdrop-filter:blur(16px);backdrop-filter:blur(16px)}}[data-dui-0-134-2~="dui-menu-hidden"]{visibility:hidden}[data-dui-0-134-2~="dui-menu-item"]{position:relative;-webkit-box-sizing:content-box;box-sizing:content-box;white-space:nowrap;-webkit-transition:background-color .1s linear;transition:background-color .1s linear;padding:9px 16px 9px 28px;font-size:12px;height:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;color:var(--text-ultrastrong,rgba(0,0,0,.88));cursor:pointer}[data-dui-0-134-2~="dui-menu-item-disabled"]{opacity:.3;pointer-events:none}[data-dui-0-134-2~="dui-menu-item-icon-container"]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center}[data-dui-0-134-2~="dui-menu-item-with-action-active"] [data-dui-0-134-2~="dui-menu-item-icon-container"],[data-dui-0-134-2~="dui-menu-item-with-action"]:hover [data-dui-0-134-2~="dui-menu-item-icon-container"]{max-width:calc(100% - 24px)}[data-dui-0-134-2~="dui-menu-item-text-container"]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}[data-dui-0-134-2~="dui-menu-item-icon"]{width:20px;height:20px;background-repeat:no-repeat;background-size:contain;background-position:50%;margin-right:8px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0}[data-dui-0-134-2~="dui-menu-item-description"]{font-size:12px;color:var(--text-medium,rgba(0,0,0,.4));margin-left:10px}[data-dui-0-134-2~="dui-menu-item-disabled"] [data-dui-0-134-2~="dui-menu-item-description"]{color:rgba(0,0,0,.8)}[data-dui-0-134-2~="dui-menu-item-selected"]:before{content:"";position:absolute;display:inline-block;width:16px;height:16px;left:8px;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);background-repeat:no-repeat;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'16\' height=\'16\'%3E%3Cpath d=\'M12.5 3l1.5.944L5.671 13l-.885-.957L2 9l1.5-1 2.215 2.22z\' fill=\'%231e6fff\' fill-rule=\'evenodd\'/%3E%3C/svg%3E");background-size:contain;background-position:50%}:not([data-dui-0-134-2~="dui-menu-item-disabled"])[data-dui-0-134-2~="dui-menu-item"]:focus,:not([data-dui-0-134-2~="dui-menu-item-disabled"])[data-dui-0-134-2~="dui-menu-item"]:hover{background-color:var(--feedback-hover,rgba(51,77,102,.06))}:not([data-dui-0-134-2~="dui-menu-item-disabled"])[data-dui-0-134-2~="dui-menu-item"]:active{background-color:var(--feedback-active,rgba(51,77,102,.08))}[data-dui-0-134-2~="dui-menu-item-action"]{width:24px;height:24px;border-radius:2px;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'24\' height=\'24\'%3E%3Cpath d=\'M7 11v2H5v-2h2zm6 0v2h-2v-2h2zm6 0v2h-2v-2h2z\' fill=\'%23464d5a\'/%3E%3C/svg%3E");background-position:50%;background-repeat:no-repeat;background-size:contain}[data-dui-0-134-2~="dui-menu-item-action-active"],[data-dui-0-134-2~="dui-menu-item-action"]:hover{background-color:rgba(0,0,0,.08)}[data-dui-0-134-2~="dui-menu-item-action-content"]{margin-top:-4px;margin-left:10px}[data-dui-0-134-2~="dui-menu-item-action-wrapper"]{height:24px;visibility:hidden}[data-dui-0-134-2~="dui-menu-item-action-wrapper-active"],[data-dui-0-134-2~="dui-menu-item"]:hover [data-dui-0-134-2~="dui-menu-item-action-wrapper"]{visibility:visible}[data-dui-0-134-2~="dui-menu-submenu"]:after{content:"";background:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'4\' height=\'6\'%3E%3Cpath d=\'M3.936 3.123L.374 5.95a.261.261 0 01-.31 0A.158.158 0 010 5.826V.174C0 .078.098 0 .22 0a.25.25 0 01.154.05l3.562 2.827a.15.15 0 010 .246z\' opacity=\'.4\'/%3E%3C/svg%3E");display:inline-block;width:4px;height:6px;background-position:50%;background-size:cover;margin-left:24px}[data-dui-0-134-2~="dui-menu-submenu-visible"]{background-color:var(--feedback-hover,rgba(51,77,102,.06))}[data-dui-0-134-2~="dui-menu-submenu-with-desc"]:after{position:absolute;right:16px;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);margin-left:0}[data-dui-0-134-2~="dui-menu-submenu-with-desc"] [data-dui-0-134-2~="dui-menu-item-description"]{margin-right:16px}:not([data-dui-0-134-2~="dui-menu-submenu-clickable"])[data-dui-0-134-2~="dui-menu-submenu"]:active{background-color:var(--feedback-hover,rgba(51,77,102,.06))}[data-dui-0-134-2~="dui-menu-submenu-wrapper"]{padding:0;background:transparent;position:absolute;-webkit-transition-property:visibility,opacity,-webkit-transform;transition-property:visibility,opacity,-webkit-transform;transition-property:visibility,opacity,transform;transition-property:visibility,opacity,transform,-webkit-transform;-webkit-transition-timing-function:cubic-bezier(.4,0,.2,1);transition-timing-function:cubic-bezier(.4,0,.2,1)}[data-dui-0-134-2~="dui-menu-submenu-wrapper-visible"]{visibility:visible;-webkit-transition-duration:.16s;transition-duration:.16s;opacity:1;-webkit-transform:scaleX(1) translate(0);transform:scaleX(1) translate(0)}[data-dui-0-134-2~="dui-menu-submenu-wrapper-hidden-bottom"],[data-dui-0-134-2~="dui-menu-submenu-wrapper-hidden-top"]{visibility:hidden;-webkit-transition-duration:.12s;transition-duration:.12s}[data-dui-0-134-2~="dui-menu-submenu-wrapper-hidden-bottom"]{opacity:0;-webkit-transform:scaleX(1) translateY(-5px);transform:scaleX(1) translateY(-5px)}[data-dui-0-134-2~="dui-menu-submenu-wrapper-hidden-top"]{opacity:0;-webkit-transform:scaleX(1) translateY(5px);transform:scaleX(1) translateY(5px)}[data-dui-0-134-2~="dui-menu-contextmenu-popup"]{position:absolute;z-index:9999;overflow-y:auto;overflow-x:hidden;-webkit-box-shadow:0 2px 12px 2px rgba(68,73,77,.16);box-shadow:0 2px 12px 2px rgba(68,73,77,.16)}[data-dui-0-134-2~="dui-menu-contextmenu-popup-hidden"]{visibility:hidden}[data-dui-0-134-2~="dui-menu-contextmenu-popup-left-top"]{-webkit-transform:translate(-100%,-100%);transform:translate(-100%,-100%)}[data-dui-0-134-2~="dui-menu-contextmenu-popup-left-bottom"]{-webkit-transform:translateX(-100%);transform:translateX(-100%)}[data-dui-0-134-2~="dui-menu-contextmenu-popup-right-top"]{-webkit-transform:translateY(-100%);transform:translateY(-100%)}[data-dui-0-134-2~="dui-menu-input-container"]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;color:var(--text-ultrastrong,rgba(0,0,0,.88))}[data-dui-0-134-2~="dui-menu-input-postfix"]{margin-left:4px}[data-dui-0-134-2~="dui-menu-input-prefix"]{margin-right:4px}[data-dui-0-134-2~="dui-menu-input-input"]{width:32px;height:20px;font-size:12px;padding:2px;text-align:center;border-radius:2px;border-color:var(--border-medium,rgba(0,0,0,.08))}[data-dui-0-134-2~="dui-menu-compact"],[data-dui-0-134-2~="dui-menu-submenu-content-compact"]{padding:6px 0;border:1px solid rgba(0,0,0,.12);-webkit-box-shadow:0 2px 12px 2px rgba(68,73,77,.16);box-shadow:0 2px 12px 2px rgba(68,73,77,.16)}[data-dui-0-134-2~="dui-menu-compact"] [data-dui-0-134-2~="dui-menu-item"],[data-dui-0-134-2~="dui-menu-submenu-content-compact"] [data-dui-0-134-2~="dui-menu-item"]{font-size:12px;height:12px;padding:8px 12px 8px 28px}[data-dui-0-134-2~="dui-menu-non-selectable"] [data-dui-0-134-2~="dui-menu-item"],[data-dui-0-134-2~="dui-menu-submenu-content-non-selectable"] [data-dui-0-134-2~="dui-menu-item"]{padding-left:16px}[data-dui-0-134-2~="dui-menu-non-selectable"] [data-dui-0-134-2~="dui-menu-item-selected"]:before,[data-dui-0-134-2~="dui-menu-submenu-content-non-selectable"] [data-dui-0-134-2~="dui-menu-item-selected"]:before{display:none}[data-dui-0-134-2~="dui-menu-submenu-content-with-icon"] [data-dui-0-134-2~="dui-menu-item"],[data-dui-0-134-2~="dui-menu-with-icon"] [data-dui-0-134-2~="dui-menu-item"]{height:12px}[data-dui-0-134-2~="dui-menu"]>[data-dui-0-134-2~="dui-tooltip-wrapper"]{display:block}'),o.default.Item=i.default,o.default.SubMenu=a.default,o.default.ContextMenu=s.default,o.default.Input=c.default,t.default=o.default},24033:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(85556),o=n(56630).h,i=r.__importStar(n(87363)),a=n(80328),s=n(68848),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ref=null,t.minLeft=0,t.minTop=0,t.setRef=function(e){t.ref=e},t.onMouseDown=function(e){if(t.props.draggable&&t.ref&&!t.isFromInnerInput(e)){t.mouse=!0;var n=t.ref.getBoundingClientRect(),r=n.left,o=n.top,i=n.width,a=n.height,s=e.clientX,c=e.clientY;t.startLeft=r,t.startTop=o,t.startX=s,t.startY=c,t.maxLeft=window.innerWidth-i,t.maxTop=window.innerHeight-a,t.ref.style.userSelect="none",t.ref.parentElement.style.pointerEvents="auto"}},t.onMouseMove=function(e){if(t.mouse&&t.ref){var n=e.clientX,r=e.clientY,o=t.startLeft+n-t.startX,i=t.startTop+r-t.startY;o=Math.min(Math.max(t.minLeft,o),t.maxLeft),i=Math.min(Math.max(t.minTop,i),t.maxTop),t.ref.style.position="absolute",t.ref.style.left=o+"px",t.ref.style.top=i+"px"}},t.onMouseUp=function(e){if(t.ref){t.mouse=!1,t.ref.style.userSelect="auto",t.ref.parentElement.style.pointerEvents="";var n=t.props,r=n.onDragEnd;!0===n.draggable&&r(e)}},t.themedRender=function(e){var n=t.props,i=n.children,a=n.className,s=n.prefixCls,c=n.style,l=(n.onDragEnd,n.draggable,r.__rest(n,["children","className","prefixCls","style","onDragEnd","draggable"])),u=e(s,a);return o("div",r.__assign({},l,{className:u,style:c,ref:t.setRef,onMouseDown:t.onMouseDown,tabIndex:-1}),i)},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){document.body.addEventListener("mousemove",this.onMouseMove),document.body.addEventListener("mouseup",this.onMouseUp)},t.prototype.componentWillUnmount=function(){document.body.removeEventListener("mousemove",this.onMouseMove),document.body.removeEventListener("mouseup",this.onMouseUp)},t.prototype.isFromInnerInput=function(e){var t,n=e.target;return Boolean(/input|textarea/i.test(n.tagName)&&(null===(t=this.ref)||void 0===t?void 0:t.contains(n)))},t.prototype.render=function(){return s.consumeTheme(this.themedRender)},t}(i.Component);t.default=c,c.defaultProps={prefixCls:"dui-dragger",onDragEnd:a.emptyFn,onClick:a.emptyFn,draggable:!1}},67796:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.MODAL_TRANSITION_OUT_DURATION=void 0;var r=n(85556),o=n(56630).h,i=r.__importStar(n(87363)),a=r.__importDefault(n(61533)),s=n(80328),c=r.__importDefault(n(87404)),l=r.__importDefault(n(24033)),u=n(89805),d=n(56199),p=n(68848),h=n(37216),f=n(7919),g=n(259),v=n(57945);t.MODAL_TRANSITION_OUT_DURATION=240;var y=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.draggerRef=i.createRef(),n.footerRef=i.createRef(),n.isComposing=!1,n.handleClose=function(e){var t=n.props,r=t.onClose,o=t.onCancel;t.visible&&(r||o)(e)},n.handleMaskClick=function(e){var t=n.props,r=t.maskClosable,o=t.onClickMask;!0===r&&n.handleClose(e),o(e)},n.handleDraggerClick=function(e){e.stopPropagation()},n.handleCompositionStart=function(){n.isComposing=!0},n.handleCompositionEnd=function(){n.isComposing=!1},n.handleKeyDown=function(e){var t,r=n.props,o=r.visible,i=r.footer,a=r.okDisabled;o&&!n.isComposing&&("Tab"!==e.key?i||null===i||(a||"Enter"!==e.key||(null===(t=n.footerRef.current)||void 0===t?void 0:t.contains(document.activeElement))?"Escape"===e.key&&n.handleClickCancel():n.handleClickOk()):n.traverseFocus(e))},n.handleClickOk=function(e){var t=n.props,r=t.visible,o=t.onOk,i=t.okDisabled;r&&!i&&o(e)},n.handleClickCancel=function(e){var t=n.props,r=t.visible,o=t.onCancel;r&&o(e)},n.handleClickAction=function(e){var t=n.props,r=t.visible,o=t.onClickAction;r&&o(e)},n.themedRender=function(e){var i,s,c=n.props,p=c.prefixCls,f=c.className,g=c.style,v=c.title,y=c.visible,m=c.maskStyle,b=c.maskClassName,_=c.mask,C=c.draggable,S=c.onDragEnd,w=c.destroyOnClose,E=c.zIndex,x=c.containerDom,T=c.header,R=c.testId,I=e(p,f,p+"-"+(y?"visible":"hidden"),((i={})[p+"-basic"]=n.isBasic,i)),P=e(p+"-mask",b,p+"-mask-"+(y?"visible":"hidden"),((s={})[p+"-mask-display"]=_,s[p+"-mask-in-container"]=x!==document.body,s));return!x||w&&!u.decideKeepDom.call(n,t.MODAL_TRANSITION_OUT_DURATION,y)?null:a.default.createPortal(o(d.ContainerContext.Provider,{value:n.draggerDom},o(h.PreventScrollPenetrateContainer,{className:P,style:r.__assign({zIndex:E},m),onClick:n.handleMaskClick,"aria-hidden":!y},o(l.default,{className:I,style:g,draggable:C,onDragEnd:S,onClick:n.handleDraggerClick,ref:n.draggerRef,onKeyDown:n.handleKeyDown,onCompositionStart:n.handleCompositionStart,onCompositionEnd:n.handleCompositionEnd,"data-testid":R},n.renderClose(e),T?o("div",{className:e(p+"-header")},T):null,null!==v?o("div",{className:e(p+"-title")},v):null,n.renderContent(e),n.renderFooter(e)))),x)},n}return r.__extends(n,e),Object.defineProperty(n.prototype,"draggerDom",{get:function(){var e;return null===(e=this.draggerRef.current)||void 0===e?void 0:e.ref},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isBasic",{get:function(){return"basic"===this.props.type},enumerable:!1,configurable:!0}),n.prototype.isFocusInside=function(){var e;return null===(e=this.draggerDom)||void 0===e?void 0:e.contains(document.activeElement)},n.prototype.focusSelf=function(){var e=this;this.props.visible&&!this.isFocusInside()&&(g.saveFocus(),setTimeout((function(){var t;!e.isFocusInside()&&(null===(t=e.draggerDom)||void 0===t||t.focus())}),300))},n.prototype.restorePreviousFocus=function(){this.props.visible||g.restoreFocus()},n.prototype.traverseFocus=function(e){var t=this.draggerDom;t&&g.traverseFocusIn(t,e)},n.prototype.componentDidMount=function(){this.forceUpdate(),this.focusSelf();var e=this.props,t=e.visible,n=e.mask;h.toggleGlobalScrollEvents(Boolean(t&&n))},n.prototype.componentDidUpdate=function(e){e.visible?this.restorePreviousFocus():this.focusSelf();var t=this.props,n=t.visible,r=t.mask;h.toggleGlobalScrollEvents(Boolean(n&&r))},n.prototype.componentWillUnmount=function(){h.toggleGlobalScrollEvents(!1)},n.prototype.renderAction=function(e){var t,n,r=this.props,a=r.prefixCls,s=r.action;return s?(null!==s&&"object"==typeof s?i.isValidElement(s)?t=s:("text"in s&&(t=s.text),"icon"in s&&(n=s.icon)):t=s,o(f.WithStylusClick,{clickHandler:this.handleClickAction},this.isBasic?o(c.default,{icon:n},t):o("button",{className:e(a+"-footer-action")},n?"string"==typeof n?o("div",{className:e(a+"-footer-action-icon"),style:{backgroundImage:'url("'+n+'")'}}):n:null,t?"string"==typeof t?o("div",{className:e(a+"-footer-action-text")},t):t:null))):null},n.prototype.renderFooter=function(e){var t,n=this.props,r=n.prefixCls,i=n.footer,a=n.okText,s=n.cancelText,l=n.okDisabled,u=n.okButtonType;if(null===i)return null;if(i)return i;var d=s?o(f.WithStylusClick,{clickHandler:this.handleClickCancel},o(c.default,null,s)):null,p=o(f.WithStylusClick,{clickHandler:this.handleClickOk},o(c.default,{className:e(r+"-footer-ok"),type:u,disabled:l},a)),h=this.renderAction(e),g=e(r+"-footer",((t={})[r+"-footer-column"]=h&&this.isBasic,t));return o("div",{className:g,ref:this.footerRef},d,h,p)},n.prototype.renderContent=function(e){var t,n=this.props,r=n.prefixCls,i=n.title,a=n.content,c=n.children,l=e(r+"-content",((t={})[r+"-content-empty-title"]=""===i,t)),u=a||c,d=u;return s.isIE()&&"string"==typeof u&&(d=o("span",{style:{maxWidth:"100%"}},u)),s.isIE()?o("div",{style:{display:"flex",flexDirection:"column"}},o("div",{className:l},d)):o("div",{className:l},d)},n.prototype.renderClose=function(e){var t=this.props,n=t.prefixCls,r=t.closable,i=t.close;return r?o(f.WithStylusClick,{clickHandler:this.handleClose},i?o("div",{className:e(n+"-close-container")},i):o("div",{className:e(n+"-close")})):null},n.prototype.render=function(){return p.consumeTheme(this.themedRender)},n}(i.Component);t.default=y,y.defaultProps={prefixCls:"dui-modal",title:"",content:"",footer:"",onCancel:s.emptyFn,onOk:s.emptyFn,cancelText:v.i18n("cancel"),okText:v.i18n("ok"),mask:!0,maskClosable:!1,closable:!0,onDragEnd:s.emptyFn,destroyOnClose:!1,onClickMask:s.emptyFn,action:"",onClickAction:s.emptyFn,containerDom:"undefined"!=typeof document?document.body:void 0,okDisabled:!1,type:"editable",okButtonType:"primary"}},99286:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(85556).__importStar(n(67796)),o=n(92437),i=n(80328);t.default=i.wrapWithConfigDefaults((function(e){return e.onClose=e.onClose||e.onCancel,o.showWithTransition({Component:r.default,transitionDuration:r.MODAL_TRANSITION_OUT_DURATION,autoClose:!1,props:e,forcedProps:{destroyOnClose:!0},injectClosePropNames:["onOk","onCancel","onClickAction","onClose"],contexts:e.contexts})}))},75906:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.Modal=void 0;var r=n(85556),o=r.__importDefault(n(67796));t.Modal=o.default;var i=r.__importDefault(n(99286));n(36226).D("components/Modal/style/index.css",'@-webkit-keyframes dui-modal-fade-in{0%{opacity:0}to{opacity:1}}@keyframes dui-modal-fade-in{0%{opacity:0}to{opacity:1}}@-webkit-keyframes dui-modal-pop-up{0%{opacity:0;-webkit-transform:scale3d(.9,.9,1);transform:scale3d(.9,.9,1)}to{opacity:1;-webkit-transform:scaleX(1);transform:scaleX(1)}}@keyframes dui-modal-pop-up{0%{opacity:0;-webkit-transform:scale3d(.9,.9,1);transform:scale3d(.9,.9,1)}to{opacity:1;-webkit-transform:scaleX(1);transform:scaleX(1)}}[data-dui-0-134-2~="dui-modal"]{position:relative;width:400px;-webkit-box-sizing:border-box;box-sizing:border-box;padding:24px;border-radius:8px;pointer-events:auto;-webkit-animation:dui-modal-pop-up .3s cubic-bezier(.4,0,.2,1);animation:dui-modal-pop-up .3s cubic-bezier(.4,0,.2,1);-webkit-tap-highlight-color:transparent;-webkit-box-shadow:0 6px 32px 2px rgba(68,73,77,.16),0 0 0 1px rgba(0,0,0,.04),0 4px 6px 2px rgba(0,0,0,.04);box-shadow:0 6px 32px 2px rgba(68,73,77,.16),0 0 0 1px rgba(0,0,0,.04),0 4px 6px 2px rgba(0,0,0,.04);background-color:var(--bg-lv4-default,#fff)}[data-dui-0-134-2~="dui-modal-hidden"],[data-dui-0-134-2~="dui-modal-visible"]{-webkit-transition-timing-function:cubic-bezier(.4,0,.2,1);transition-timing-function:cubic-bezier(.4,0,.2,1);-webkit-transition-property:opacity,visibility,-webkit-transform;transition-property:opacity,visibility,-webkit-transform;transition-property:opacity,transform,visibility;transition-property:opacity,transform,visibility,-webkit-transform}[data-dui-0-134-2~="dui-modal-visible"]{opacity:1;-webkit-transform:scaleX(1);transform:scaleX(1);-webkit-transition-duration:.3s;transition-duration:.3s}[data-dui-0-134-2~="dui-modal-hidden"]{opacity:0;-webkit-transform:scale3d(.9,.9,1);transform:scale3d(.9,.9,1);-webkit-transition-duration:.24s;transition-duration:.24s}[data-dui-0-134-2~="dui-modal-mask"]{position:fixed;z-index:9998;top:0;left:0;right:0;bottom:0;opacity:1;pointer-events:none;-webkit-animation:dui-modal-fade-in .3s cubic-bezier(.4,0,.2,1);animation:dui-modal-fade-in .3s cubic-bezier(.4,0,.2,1);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}[data-dui-0-134-2~="dui-modal-mask-in-container"]{position:absolute}[data-dui-0-134-2~="dui-modal-mask-display"]{pointer-events:auto;background-color:hsla(0,0%,100%,.65)}[data-dui-0-134-2~="dui-modal-mask-visible"]{opacity:1;visibility:visible;-webkit-transition:all .3s cubic-bezier(.4,0,.2,1);transition:all .3s cubic-bezier(.4,0,.2,1)}[data-dui-0-134-2~="dui-modal-mask-hidden"]{opacity:0;visibility:hidden;-webkit-transition:all .24s cubic-bezier(.4,0,.2,1);transition:all .24s cubic-bezier(.4,0,.2,1)}[data-dui-0-134-2~="dui-modal-close"]{background-size:contain;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'24\' height=\'24\'%3E%3Cpath fill=\'%23464d5a\' d=\'M17 7.714L12.714 12 17 16.286l-.714.714L12 12.714 7.714 17 7 16.286 11.286 12 7 7.714 7.714 7 12 11.286 16.286 7z\'/%3E%3C/svg%3E");background-position:50%;background-repeat:no-repeat;border-radius:2px;cursor:pointer}[data-dui-0-134-2~="dui-modal-close"]:hover{background-color:rgba(0,0,0,.04)}[data-dui-0-134-2~="dui-modal-close"]:active{background-color:rgba(0,0,0,.08)}[data-dui-0-134-2~="dui-modal-close"],[data-dui-0-134-2~="dui-modal-close-container"]{position:absolute;z-index:1;width:24px;height:24px;top:25px;right:24px}[data-dui-0-134-2~="dui-modal-header"]{margin-bottom:16px}[data-dui-0-134-2~="dui-modal-title"]{font-weight:500;font-size:16px;margin-bottom:20px;line-height:26px;padding-right:24px}[data-dui-0-134-2~="dui-modal-content"],[data-dui-0-134-2~="dui-modal-title"]{color:var(--text-ultrastrong,rgba(0,0,0,.88))}[data-dui-0-134-2~="dui-modal-content"]{font-size:14px;height:-webkit-max-content;height:-moz-max-content;height:max-content;min-height:88px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-flow:column nowrap;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start;word-break:break-word}[data-dui-0-134-2~="dui-modal-content-empty-title"]{margin-top:28px;min-height:60px}[data-dui-0-134-2~="dui-modal-footer"]{-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;margin-top:24px;position:relative}[data-dui-0-134-2~="dui-modal-footer"],[data-dui-0-134-2~="dui-modal-footer-action"]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}[data-dui-0-134-2~="dui-modal-footer-action"]{border:none;margin:0;padding:0;background:transparent;-webkit-tap-highlight-color:transparent;position:absolute;left:0;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);cursor:pointer;font-size:12px;color:var(--text-strong,rgba(0,0,0,.64));-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}[data-dui-0-134-2~="dui-modal-footer-action-icon"]{display:inline-block;width:16px;height:16px;margin-right:6px;background-size:contain;background-position:50%;background-repeat:no-repeat}[data-dui-0-134-2~="dui-modal-footer-action-text"]{border-top:1px solid transparent;border-bottom:1px solid transparent}[data-dui-0-134-2~="dui-modal-footer-action"]:hover [data-dui-0-134-2~="dui-modal-footer-action-text"]{border-bottom-color:var(--text-strong,rgba(0,0,0,.64))}[data-dui-0-134-2~="dui-modal-footer-ok"]{margin-left:16px}[data-dui-0-134-2~="dui-modal-basic"]{width:340px;padding-top:40px}[data-dui-0-134-2~="dui-modal-basic"] [data-dui-0-134-2~="dui-modal-title"]{text-align:center;font-weight:600;margin-bottom:16px}[data-dui-0-134-2~="dui-modal-basic"] [data-dui-0-134-2~="dui-modal-content"]{font-size:16px;min-height:auto;line-height:24px;text-align:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}[data-dui-0-134-2~="dui-modal-basic"] [data-dui-0-134-2~="dui-modal-footer"]{margin-top:44px}[data-dui-0-134-2~="dui-modal-basic"] [data-dui-0-134-2~="dui-modal-footer"]>[data-dui-0-134-2~="dui-button"]{-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1}[data-dui-0-134-2~="dui-modal-basic"] [data-dui-0-134-2~="dui-modal-footer-column"]{-webkit-box-orient:vertical;-webkit-box-direction:reverse;-webkit-flex-direction:column-reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}[data-dui-0-134-2~="dui-modal-basic"] [data-dui-0-134-2~="dui-modal-footer-column"] [data-dui-0-134-2~="dui-modal-footer-ok"]{margin-left:0}[data-dui-0-134-2~="dui-modal-basic"] [data-dui-0-134-2~="dui-modal-footer-column"]>[data-dui-0-134-2~="dui-button"]{-webkit-box-flex:0;-webkit-flex:none;-ms-flex:none;flex:none;height:40px}[data-dui-0-134-2~="dui-modal-basic"] [data-dui-0-134-2~="dui-modal-footer-column"]>[data-dui-0-134-2~="dui-button"]:not(:last-child){margin-top:12px}'),o.default.confirm=i.default,t.default=o.default},12806:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(85556),o=n(56630).h,i=r.__importStar(n(87363)),a=r.__importStar(n(53211)),s=n(80328),c=n(68848),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.themedRender=function(e){var n=t.props,r=n.prefixCls,i=n.className,a=n.style,s=n.children,c=n.action,l=n.onClickAction,u="info",d=e(r,i,r+"-"+u),p=e(r+"-icon",r+"-icon-"+u),h=e(r+"-message"),f=e(r+"-action");return o("div",{className:d,style:a},o("div",{className:p}),o("div",{className:h},s),c?o("button",{className:f,onClick:l},c):null)},t}return r.__extends(t,e),t.prototype.render=function(){return c.consumeTheme(this.themedRender)},t}(i.Component);t.default=l,l.defaultProps={prefixCls:"dui-notetip",onClickAction:s.emptyFn},l.propTypes={prefixCls:a.string,style:a.object,className:a.string,action:a.node,onClickAction:a.func}},66240:function(e,t,n){var r=n(85556).__importDefault(n(12806));r.default,n(36226).D("components/Notetip/style/index.css",'[data-dui-0-134-2~="dui-notetip"]{-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start;padding:9px 17px 9px 8px;width:100%;font-size:12px}[data-dui-0-134-2~="dui-notetip-info"]{background:var(--bg-lv4-medium,#f3f5f7)}[data-dui-0-134-2~="dui-notetip-icon"]{height:17px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}[data-dui-0-134-2~="dui-notetip-icon"]:after{content:"";display:inline-block;width:12px;min-width:12px;height:12px;margin-right:6px;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'14\' height=\'14\'%3E%3Cpath fill=\'%231E6FFF\' d=\'M7 14A7 7 0 117 0a7 7 0 010 14zm-1-4h-.5a.5.5 0 000 1h3a.5.5 0 000-1H8V6.5a.5.5 0 00-.5-.5h-2a.5.5 0 000 1H6v3zm.5-7a.5.5 0 00-.5.5v1a.5.5 0 00.5.5h1a.5.5 0 00.5-.5v-1a.5.5 0 00-.5-.5h-1z\'/%3E%3C/svg%3E");background-size:contain;background-position:50%;background-repeat:no-repeat}[data-dui-0-134-2~="dui-notetip-message"]{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;color:var(--text-strong,rgba(0,0,0,.64))}[data-dui-0-134-2~="dui-notetip-action"]{border:none;background:transparent;color:var(--text-link,#175ceb);white-space:nowrap;font-weight:500;border-radius:2px;padding:0 4px;margin:0 -4px 0 45px;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent}[data-dui-0-134-2~="dui-notetip-action"]:hover{background:var(--feedback-hover,rgba(51,77,102,.06))}[data-dui-0-134-2~="dui-notetip-action"]:active{background:var(--feedback-active,rgba(51,77,102,.08))}'),t.ZP=r.default},40527:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(85556),o=n(56630).h,i=r.__importStar(n(87363)),a=r.__importStar(n(53211)),s=n(56199),c=n(68848),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ref=i.createRef(),t.themedRender=function(e){var n=t.props,i=n.prefixCls,a=n.className,c=n.style,l=n.children,u=e(i,a);return o("div",{className:u,style:r.__assign({position:"relative"},c),ref:t.ref},o(s.ContainerContext.Provider,{value:t.ref.current},l))},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.forceUpdate()},t.prototype.render=function(){return c.consumeTheme(this.themedRender)},t}(i.Component);t.default=l,l.defaultProps={prefixCls:"dui-snackbar-container"},l.propTypes={prefixCls:a.string,style:a.object,className:a.string}},39299:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(85556),o=n(56630).h,i=r.__importStar(n(87363)),a=r.__importDefault(n(61533)),s=n(80328),c=n(89805),l=r.__importDefault(n(89640)),u=n(56199),d=n(68848),p=n(19913),h=n(94516),f=n(57945),g=function(e){function t(){var t,n=e.apply(this,arguments)||this;return n.selfRef=i.createRef(),n.disableAutoFocus=s.isBrowser&&(null===(t=window.__dui_disable_auto_focus_map__)||void 0===t?void 0:t.Snackbar),n.handleClickAction=function(){n.props.onClickAction(),n.handleClose()},n.handleClose=function(){n.props.onClose()},n.themedRender=function(e){var t,i=n.props,s=i.prefixCls,l=i.className,u=i.style,d=i.action,g=i.children,v=i.message,y=i.visible,m=i.closable,b=i.type,_=i.zIndex,C=i.showIcon,S=i.testId,w=e(s+"-message");if(!c.decideKeepDom.call(n,h.SNACKBAR_LEAVING_TRANSITION_DURATION,y))return null;var E=n.getContainerDom(),x=e(s,l,s+"-top",s+"-"+b,((t={})[s+"-with-icon"]=C&&!n.renderUserSetIcon(e),t[s+"-hidden"]=!y,t[s+"-in-container"]=E!==document.body,t));return a.default.createPortal(o("div",{className:x,style:r.__assign({zIndex:_,marginTop:p.getMarginTop(n)+"px"},u),ref:n.selfRef,role:"alert","aria-live":"assertive","aria-atomic":!0,"data-testid":S},n.renderIcon(e),o("span",{className:w},g||v),d||m?o("span",{className:e(s+"-controls")},n.renderAction(e),m?o("button",{className:e(s+"-close"),onClick:n.handleClose,"aria-label":f.i18n("close")}):null):null),E)},n}return r.__extends(t,e),t.prototype.getContainerDom=function(){return s.isDom(this.context)?this.context:this.props.containerDom},t.prototype.componentDidMount=function(){this.handleEffect()},t.prototype.componentDidUpdate=function(){this.handleEffect()},t.prototype.handleEffect=function(){this.fixShrinkedWidthForIE(),p.updateVisibleSnackbars(this)},t.prototype.fixShrinkedWidthForIE=function(){var e=this.props,t=e.visible,n=e.style;if(t&&s.isIE()){var r=this.selfRef.current;if(r&&(!n||!("width"in n))){var o=r.style.left;r.style.left="-9999px";var i=r.getBoundingClientRect().width;r.style.width=i+"px",r.style.left=o}}},t.prototype.renderUserSetIcon=function(e){var t=this.props,n=t.prefixCls,r=t.type,a=t.showIcon,s=t.icon;return a&&s?i.isValidElement(s)?o("div",{className:e(n+"-icon-container")},s):"object"==typeof s&&s[r]?o("div",{className:e(n+"-icon-container")},s[r]):null:null},t.prototype.renderAction=function(e){var t=this,n=this.props,r=n.prefixCls,i=n.action;return i?Array.isArray(i)&&i.length>0&&i[0].text?o("span",{className:e(r+"-actions")},i.map((function(n,i){return o("button",{key:i,className:e(r+"-action"),onClick:function(){var e;null===(e=n.onClick)||void 0===e||e.call(n),t.handleClose()},autoFocus:!t.disableAutoFocus&&0===i},n.text)}))):o("button",{className:e(r+"-action"),onClick:this.handleClickAction,autoFocus:!this.disableAutoFocus},i):null},t.prototype.renderIcon=function(e){var t=this.props,n=t.prefixCls,r=t.spinType,i=t.type;if(!t.showIcon)return null;var a=this.renderUserSetIcon(e);return a||("loading"===i?o(l.default,{type:r,className:e(n+"-loading-indicator"),circleClassName:e(n+"-loading-indicator-circle")}):null)},t.prototype.render=function(){return d.consumeTheme(this.themedRender)},t.contextType=u.ContainerContext,t}(i.Component);t.default=g,g.defaultProps={prefixCls:"dui-snackbar",onClickAction:s.emptyFn,closable:!1,type:"info",onClose:s.emptyFn,showIcon:!0,containerDom:"undefined"!=typeof document?document.body:void 0,spinType:"primary"}},94516:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SNACKBAR_LEAVING_TRANSITION_DURATION=void 0,t.SNACKBAR_LEAVING_TRANSITION_DURATION=200},56199:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.ContainerContext=void 0;var r=n(85556).__importStar(n(87363));t.ContainerContext=r.createContext(null)},52739:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.Snackbar=void 0;var r=n(85556),o=r.__importDefault(n(39299));t.Snackbar=o.default,n(36226).D("components/Snackbar/style/index.css",'@-webkit-keyframes dui-snackbar-slide-in{0%{opacity:0;-webkit-transform:translate(-50%,-20px);transform:translate(-50%,-20px)}to{opacity:1;-webkit-transform:translate(-50%);transform:translate(-50%)}}@keyframes dui-snackbar-slide-in{0%{opacity:0;-webkit-transform:translate(-50%,-20px);transform:translate(-50%,-20px)}to{opacity:1;-webkit-transform:translate(-50%);transform:translate(-50%)}}@-webkit-keyframes dui-snackbar-slide-in-container{0%{opacity:0;-webkit-transform:translate(-50%,-10px);transform:translate(-50%,-10px)}to{opacity:1;-webkit-transform:translate(-50%);transform:translate(-50%)}}@keyframes dui-snackbar-slide-in-container{0%{opacity:0;-webkit-transform:translate(-50%,-10px);transform:translate(-50%,-10px)}to{opacity:1;-webkit-transform:translate(-50%);transform:translate(-50%)}}[data-dui-0-134-2~="dui-snackbar"]{-webkit-box-sizing:border-box;box-sizing:border-box;position:fixed;z-index:10000;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;left:50%;height:40px;border-radius:4px;padding:10px 10px 10px 12px;-webkit-box-shadow:0 4px 20px 0 rgba(0,0,0,.08);box-shadow:0 4px 20px 0 rgba(0,0,0,.08);border:1px solid rgba(0,0,0,.08);background-color:var(--bg-lv4-default,#fff);color:var(--text-ultrastrong,rgba(0,0,0,.88));font-size:14px;white-space:nowrap;-webkit-transform:translateX(-50%);transform:translateX(-50%);-webkit-animation:dui-snackbar-slide-in .4s cubic-bezier(.4,0,.2,1);animation:dui-snackbar-slide-in .4s cubic-bezier(.4,0,.2,1);-webkit-transition-property:opacity,-webkit-transform;transition-property:opacity,-webkit-transform;transition-property:opacity,transform;transition-property:opacity,transform,-webkit-transform;-webkit-transition-duration:.2s;transition-duration:.2s;-webkit-transition-timing-function:cubic-bezier(.4,0,.2,1);transition-timing-function:cubic-bezier(.4,0,.2,1)}[data-dui-0-134-2~="dui-snackbar-with-icon"]:before{content:"";display:inline-block;background-position:50%;background-repeat:no-repeat;background-size:contain}[data-dui-0-134-2~="dui-snackbar-icon-container"],[data-dui-0-134-2~="dui-snackbar-with-icon"]:before{width:20px;height:20px;margin-right:8px}[data-dui-0-134-2~="dui-snackbar-info"]:before{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'20\' height=\'20\' fill-rule=\'evenodd\'%3E%3Ccircle cx=\'10\' cy=\'10\' r=\'8\' fill=\'%231e6fff\'/%3E%3Cg fill=\'%23fff\'%3E%3Cpath d=\'M11.778 14.89V14h-.9V8.668H8.223v.89h.888V14h-.89v.89h3.556z\'/%3E%3Ccircle cx=\'10\' cy=\'6.444\' r=\'1.333\'/%3E%3C/g%3E%3C/svg%3E")}[data-dui-0-134-2~="dui-snackbar-error"]:before{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'20\' height=\'20\'%3E%3Cpath fill=\'%23fff\' d=\'M10 2a8 8 0 110 16 8 8 0 110-16zm0 10.222a1.333 1.333 0 100 2.665 1.333 1.333 0 000-2.664zm1.333-7.1H8.667l.444 6.22h1.778l.444-6.222z\' fill-rule=\'evenodd\'/%3E%3C/svg%3E")}[data-dui-0-134-2~="dui-snackbar-success"]:before{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'20\' height=\'20\' fill-rule=\'evenodd\'%3E%3Ccircle cx=\'10\' cy=\'10\' r=\'8\' fill=\'%2308ea86\'/%3E%3Cpath fill=\'%23fff\' d=\'M7.47 9.167l1.645 1.646 4.126-4.125 1.178 1.178-5.303 5.303-2.824-2.824L7.47 9.167z\'/%3E%3C/svg%3E")}[data-dui-0-134-2~="dui-snackbar-warning"]:before{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'20\' height=\'20\'%3E%3Cpath fill=\'%23ff4747\' d=\'M10 2a8 8 0 110 16 8 8 0 110-16zm0 10.222a1.333 1.333 0 100 2.665 1.333 1.333 0 000-2.664zm1.333-7.1H8.667l.444 6.22h1.778l.444-6.222z\' fill-rule=\'evenodd\'/%3E%3C/svg%3E")}[data-dui-0-134-2~="dui-snackbar-error"]{background-color:var(--critical-default,#ff4747);border-color:transparent;color:var(--bg-lv1-default,#fff)}[data-dui-0-134-2~="dui-snackbar-loading"]:before{content:none}[data-dui-0-134-2~="dui-snackbar-loading-indicator"]{width:16px;height:16px;margin:0 10px 0 2px}[data-dui-0-134-2~="dui-snackbar-loading-indicator-circle"]{border-width:6px}[data-dui-0-134-2~="dui-snackbar-hidden"]{opacity:0;-webkit-transform:translateX(-50%) translateY(-20px);transform:translateX(-50%) translateY(-20px)}[data-dui-0-134-2~="dui-snackbar-top"]{top:105px}[data-dui-0-134-2~="dui-snackbar-bottom"]{bottom:105px}[data-dui-0-134-2~="dui-snackbar-in-container"]{-webkit-animation-name:dui-snackbar-slide-in-container;animation-name:dui-snackbar-slide-in-container;position:absolute;top:14px}[data-dui-0-134-2~="dui-snackbar-in-container"][data-dui-0-134-2~="dui-snackbar-hidden"]{-webkit-transform:translate(-50%,-10px);transform:translate(-50%,-10px)}[data-dui-0-134-2~="dui-snackbar-message"]{color:inherit}[data-dui-0-134-2~="dui-snackbar-controls"]{margin-left:12px;line-height:20px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center}[data-dui-0-134-2~="dui-snackbar-controls"]>:not(:last-child){margin-right:10px}[data-dui-0-134-2~="dui-snackbar-action"],[data-dui-0-134-2~="dui-snackbar-close"]{display:inline-block;border-radius:2px;cursor:pointer;border:none;margin:0;padding:0;background:transparent;-webkit-tap-highlight-color:transparent}[data-dui-0-134-2~="dui-snackbar-action"]:hover,[data-dui-0-134-2~="dui-snackbar-close"]:hover{background-color:var(--feedback-hover,rgba(51,77,102,.06))}[data-dui-0-134-2~="dui-snackbar-action"]:active,[data-dui-0-134-2~="dui-snackbar-close"]:active{background-color:var(--feedback-active,rgba(51,77,102,.08))}[data-dui-0-134-2~="dui-snackbar-actions"]>:not(:first-child){margin-left:7px}[data-dui-0-134-2~="dui-snackbar-action"]{color:var(--text-link,#175ceb);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding:0 4px;font-weight:500;font-size:14px}[data-dui-0-134-2~="dui-snackbar-error"] [data-dui-0-134-2~="dui-snackbar-action"],[data-dui-0-134-2~="dui-snackbar-error"] [data-dui-0-134-2~="dui-snackbar-close"]{color:var(--bg-lv1-default,#fff)}[data-dui-0-134-2~="dui-snackbar-error"] [data-dui-0-134-2~="dui-snackbar-action"]:hover,[data-dui-0-134-2~="dui-snackbar-error"] [data-dui-0-134-2~="dui-snackbar-close"]:hover{background-color:hsla(0,0%,100%,.24)}[data-dui-0-134-2~="dui-snackbar-error"] [data-dui-0-134-2~="dui-snackbar-action"]:active,[data-dui-0-134-2~="dui-snackbar-error"] [data-dui-0-134-2~="dui-snackbar-close"]:active{background-color:hsla(0,0%,100%,.4)}[data-dui-0-134-2~="dui-snackbar-close"]{width:20px;height:20px;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'16\' height=\'16\'%3E%3Cpath fill=\'%2381868f\' fill-rule=\'evenodd\' d=\'M8.63 8L13 12.368l-.632.632L8 8.63 3.632 13 3 12.368 7.368 8 3 3.632 3.632 3 8 7.368 12.368 3l.632.632L8.63 8z\'/%3E%3C/svg%3E");background-position:50%;background-size:16px;background-repeat:no-repeat}[data-dui-0-134-2~="dui-snackbar-error"] [data-dui-0-134-2~="dui-snackbar-close"]{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'16\' height=\'16\'%3E%3Cpath fill=\'%23fff\' fill-rule=\'evenodd\' d=\'M8.63 8L13 12.368l-.632.632L8 8.63 3.632 13 3 12.368 7.368 8 3 3.632 3.632 3 8 7.368 12.368 3l.632.632L8.63 8z\'/%3E%3C/svg%3E")}');var i=r.__importDefault(n(46874)),a=r.__importDefault(n(40527)),s=n(19913);o.default.show=i.default,o.default.closeAll=s.closeAll,o.default.closeById=s.closeById,o.default.Container=a.default,t.default=o.default},19913:function(e,t){function n(e){var t=e.getContainerDom();return t.__dui_visible_snackbars__=t.__dui_visible_snackbars__||[],t.__dui_visible_snackbars__}function r(e){return n(e).findIndex((function(t){return t.instance===e}))}function o(e){var t=n(e),r=e.props.id;if(r){var o=t.findIndex((function(e){return e.instance.props.id===r}));if(o>=0)return t[o]}var i=t.findIndex((function(e){return e.instance.props.autoClose}));return i>=0?t[i]:null}function i(e){var t=o(e);if(t)return t.marginTop;var r=n(e).map((function(e){return e.marginTop})).sort((function(e,t){return e-t}));if(0===r.length)return 0;for(var i=0;i<r.length;i++){var a=50*i;if(a!==r[i])return a}return r[r.length-1]+50}Object.defineProperty(t,"__esModule",{value:!0}),t.closeById=t.closeAll=t.getMarginTop=t.updateVisibleSnackbars=void 0,t.updateVisibleSnackbars=function(e){var t=e.props.visible,a=r(e),s=n(e);if(t&&-1===a){var c=o(e);null==c||c.instance.handleClose(),s.push({instance:e,marginTop:i(e)})}t||-1===a||s.splice(a,1)},t.getMarginTop=function(e){var t=r(e),o=n(e);return-1!==t?o[t].marginTop:i(e)},t.closeAll=function(e){var t=document.body.__dui_visible_snackbars__;null==t||t.filter((function(t){var n=t.instance.props,r=n.autoClose,o=n.closable;return e||r||o})).forEach((function(e){return e.instance.handleClose()}))},t.closeById=function(e){var t=document.body.__dui_visible_snackbars__;null==t||t.filter((function(t){return t.instance.props.id===e})).forEach((function(e){return e.instance.handleClose()}))}},46874:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(85556).__importDefault(n(39299)),o=n(92437),i=n(80328),a=n(94516);t.default=i.wrapWithConfigDefaults((function(e){var t=e.autoClose,n=void 0===t||t;return e.autoClose=n,o.showWithTransition({Component:r.default,transitionDuration:a.SNACKBAR_LEAVING_TRANSITION_DURATION,autoClose:n,props:e,injectClosePropNames:["onClose"],contexts:e.contexts})}))},14236:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(85556),o=n(56630).h,i=r.__importStar(n(87363)),a=r.__importDefault(n(61533)),s=n(80328),c=r.__importDefault(n(4339)),l=n(68848),u=n(89805),d=n(36321),p={left:"0px",top:"0px"},h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rootRef=i.createRef(),t.overlayContainerRef=i.createRef(),t.forceRenderDom=!1,t.cancelPositionChangeChecker=null,t.state={currentVisible:!!t.props.defaultVisible,position:p},t.show=function(){t.props.disabled||(t.forceRenderDom=!0,t.setState({position:p},(function(){t.runVisibleEffects(),t.setStateVisible(!0),t.forceRenderDom=!1})))},t.hide=function(){clearTimeout(t.showTimeout),t.isVisible()&&t.setStateVisible(!1)},t.toggle=function(){t.props.disabled||(t.isVisible()?t.hide():t.show())},t.handleClickAnchor=function(){var e=t.props,n=e.trigger,r=e.hideOnClick;"click"===n?t.toggle():"hover"===n&&r&&t.hide()},t.handleMouseDownAnchor=function(){var e=t.props,n=e.trigger;e.hideOnMouseDown&&"hover"===n&&t.hide()},t.handleMouseEnter=function(){clearTimeout(t.hideTimeout),clearTimeout(t.showTimeout),t.showTimeout=setTimeout(t.show,t.props.hoverDelay)},t.handleMouseLeave=function(){clearTimeout(t.showTimeout),t.hideTimeout=setTimeout(t.hide,t.props.hoverDelay)},t.themedRender=function(e){var n,i=t.props,s=i.className,l=i.style,d=i.prefixCls,p=i.placement,h=i.children,f=i.overlayClassName,g=i.overlayStyle,v=i.trigger,y=i.offset,m=i.zIndex,b=i.containerClassName,_=i.containerStyle,C=i.destroyOnClose,S=i.overlayHoverable,w=i.containerDom,E=e(d,s,d+"-wrapper"),x=e(d+"-content",f),T=r.__assign(r.__assign({},g),{transform:"translate"+("top"===p||"bottom"===p?"X":"Y")+"("+y+"px)"}),R=t.isVisible(),I=e(d+"-container",b,((n={})[d+"-container-visible"]=R,n)),P=!t.forceRenderDom&&C&&!u.decideKeepDom.call(t,200,R),O="";return"hover"===v&&(O=S?"outer":"inner"),o(c.default,{className:E,style:l,action:t.hide,disabled:"click"!==v},o("div",{onMouseEnter:"outer"===O?t.handleMouseEnter:void 0,onMouseLeave:"outer"===O?t.handleMouseLeave:void 0,ref:t.rootRef},o("div",{onClick:t.handleClickAnchor,onMouseDown:t.handleMouseDownAnchor,onMouseEnter:"inner"===O?t.handleMouseEnter:void 0,onMouseLeave:"inner"===O?t.handleMouseLeave:void 0},h),P?null:a.default.createPortal(o("div",{className:I,ref:t.overlayContainerRef,style:r.__assign(r.__assign({zIndex:m},_),t.state.position)},o("div",{className:x,style:T,"aria-atomic":!0,"aria-live":"assertive"},t.renderTitle(e))),w||document.body)))},t}return r.__extends(t,e),t.getDerivedStateFromProps=function(e,t){return e.disabled?{currentVisible:!1}:null},t.prototype.componentDidMount=function(){this.isVisible()&&this.runVisibleEffects()},t.prototype.componentWillUnmount=function(){var e;null===(e=this.cancelPositionChangeChecker)||void 0===e||e.call(this),clearTimeout(this.showTimeout),clearTimeout(this.hideTimeout)},t.prototype.componentDidUpdate=function(e){var t;!e.visible&&this.props.visible&&this.runVisibleEffects(),this.isVisible()||null===(t=this.cancelPositionChangeChecker)||void 0===t||t.call(this)},t.prototype.isVisible=function(){var e=this.props,t=e.visible;if(e.disabled)return!1;var n=this.state.currentVisible;return"boolean"==typeof t?t:n},t.prototype.setStateVisible=function(e){this.setState({currentVisible:e}),this.props.onVisibleChange(e)},t.prototype.runVisibleEffects=function(){var e=this;this.setState({position:this.calcOverlayPosition()},(function(){requestAnimationFrame((function(){var t;null===(t=e.cancelPositionChangeChecker)||void 0===t||t.call(e),e.cancelPositionChangeChecker=d.checkPositionChange(e.rootRef.current,e.hide)}))}))},t.prototype.calcStartPositionByAlignment=function(e,t,n){switch(this.props.alignment){case"start":return e;case"center":return(e+t-n)/2;case"end":return t-n;default:return 0}},t.prototype.calcOverlayPosition=function(){var e=this.rootRef.current,t=this.overlayContainerRef.current;if(!e||!t)return{left:"0px",top:"0px"};var n=e.getBoundingClientRect(),r=t.getBoundingClientRect(),o=this.props.placement;if("string"==typeof o)return this.calcOverlayPositionByPlacement(n,r,o).position;for(var i=0,a=o;i<a.length;i++){var s=a[i],c=this.calcOverlayPositionByPlacement(n,r,s),l=c.position;if(c.canFitIn)return l}return this.calcOverlayPositionByPlacement(n,r,o[0]).position},t.prototype.calcOverlayPositionByPlacement=function(e,t,n){var r=e.left,o=e.right,i=e.top,a=e.bottom,c=t.width,l=t.height,u=this.props,d=u.containerOffsetX,p=u.containerOffsetY;"bottom"!==n&&"top"!==n||(d+=this.calcStartPositionByAlignment(r,o,c)),"left"===n&&(d+=r-4-c),"right"===n&&(d+=o+4);var h=s.castInto(d,[2,innerWidth-c-2]);"left"!==n&&"right"!==n||(p+=this.calcStartPositionByAlignment(i,a,l)),"top"===n&&(p+=i-8-l),"bottom"===n&&(p+=a+8);var f=s.castInto(p,[2,innerHeight-l-2]);return{position:{left:h+"px",top:f+"px"},canFitIn:h===d&&f===p}},t.prototype.renderTitle=function(e){var t=this.props,n=t.prefixCls,r=t.title;return Array.isArray(r)&&r.every((function(e){return"string"==typeof e}))?o("div",{className:e(n+"-title-multiline")},r.map((function(e,t){return o("div",{key:t},e)}))):r},t.prototype.render=function(){return l.consumeTheme(this.themedRender)},t}(i.Component);t.default=h,h.defaultProps={prefixCls:"dui-tooltip",title:"",placement:"bottom",trigger:"hover",onVisibleChange:s.emptyFn,disabled:!1,offset:0,containerOffsetX:0,containerOffsetY:0,destroyOnClose:!0,alignment:"center",hoverDelay:400,hideOnClick:!1,hideOnMouseDown:!1,overlayHoverable:!0}},37700:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.Tooltip=void 0;var r=n(85556);n(36226).D("components/Tooltip/style/index.css",'@-webkit-keyframes dui-tooltip-fade-in{0%{opacity:0}to{opacity:1}}@keyframes dui-tooltip-fade-in{0%{opacity:0}to{opacity:1}}[data-dui-0-134-2~="dui-tooltip-wrapper"]{display:inline-block;position:relative}[data-dui-0-134-2~="dui-tooltip-container"]{position:fixed;visibility:hidden;-webkit-transition-property:opacity,visibility;transition-property:opacity,visibility;-webkit-transition-duration:.2s;transition-duration:.2s;-webkit-transition-timing-function:linear;transition-timing-function:linear;z-index:10002;opacity:0;-webkit-animation:dui-tooltip-fade-in .2s linear;animation:dui-tooltip-fade-in .2s linear;font-size:medium}[data-dui-0-134-2~="dui-tooltip-container-visible"]{visibility:visible;opacity:1}[data-dui-0-134-2~="dui-tooltip-content"]{display:inline-block;padding:7px 12px;font-size:12px;line-height:18px;border:1px solid rgba(0,0,0,.1);border-radius:4px;color:var(--text-ultrastrong,rgba(0,0,0,.88));-webkit-box-shadow:0 6px 32px 2px rgba(68,73,77,.16),0 4px 6px 2px rgba(0,0,0,.04);box-shadow:0 6px 32px 2px rgba(68,73,77,.16),0 4px 6px 2px rgba(0,0,0,.04);word-break:break-word;background-color:var(--bg-lv4-default,#fff)}[data-dui-0-134-2~="dui-tooltip-title-multiline"]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-flow:column nowrap;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;line-height:16px}');var o=r.__importDefault(n(14236));t.Tooltip=o.default,t.default=o.default},4339:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.TriggerContext=void 0;var r=n(85556),o=n(56630).h,i=r.__importStar(n(87363)),a=n(80328),s=r.__importDefault(n(32230)),c=n(26276),l=r.__importDefault(n(5125));t.TriggerContext=i.createContext(a.emptyFn);var u=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.shouldCancel=!1,t.captureTrigger=function(e){t.props.disabled||setTimeout((function(){t.trigger(e)}),0)},t.cancel=function(e){if(!t.props.disabled){var n=e.nativeEvent;n._dui_trigger_instances?n._dui_trigger_instances.push(t):n._dui_trigger_instances=[t]}},t.generateCancelSetter=l.default((function(e){return function(n){e(n),t.shouldCancel=n}})),t}return r.__extends(n,e),n.prototype.componentDidMount=function(){this.doc.addEventListener("click",this.captureTrigger,!0),this.props.disableContextMenu||this.doc.addEventListener("contextmenu",this.captureTrigger,!0)},n.prototype.componentWillUnmount=function(){this.doc.removeEventListener("click",this.captureTrigger,!0),this.props.disableContextMenu||this.doc.removeEventListener("contextmenu",this.captureTrigger,!0)},Object.defineProperty(n.prototype,"doc",{get:function(){return this.context||document},enumerable:!1,configurable:!0}),n.prototype.trigger=function(e){var t=this.props,n=t.disabled,r=t.action,o=t.shouldTriggerAction;if(!n&&!this.shouldCancel){if(e._dui_trigger_instances){var i=e._dui_trigger_instances.indexOf(this);if(-1!==i)return e._dui_trigger_instances.splice(i,1),void(0===e._dui_trigger_instances.length&&delete e._dui_trigger_instances)}o(e)&&r()}},n.prototype.render=function(){var e=this,n=this.props,r=n.prefixCls,i=n.className,a=n.style,c=n.children,l=n.domRef,u=n.disableContextMenu,d=n.testId,p=s.default(r,i);return o(t.TriggerContext.Consumer,null,(function(n){return o(t.TriggerContext.Provider,{value:e.generateCancelSetter(n)},o("div",{className:p,style:a,onClickCapture:e.cancel,onContextMenuCapture:u?void 0:e.cancel,ref:l,"data-testid":d},c))}))},n.contextType=c.DocumentDomContext,n}(i.Component);t.default=u,u.defaultProps={prefixCls:"dui-trigger",action:a.emptyFn,shouldTriggerAction:a.trueFn,disabled:!1,disableContextMenu:!1}},36321:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.checkPositionChange=void 0;var r=n(80328);t.checkPositionChange=function(e,t){if(!e)return r.emptyFn;var n=e.getBoundingClientRect(),o=setInterval((function(){var r=e.getBoundingClientRect();(Math.abs(n.left-r.left)>1||Math.abs(n.top-r.top)>1)&&t(),n=r}),100);return function(){return clearInterval(o)}}},56630:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.h=t.isScopedAttributeDisabled=void 0;var r,o,i=n(85556),a=n(87363),s=i.__importDefault(n(84502)),c=n(80328);t.isScopedAttributeDisabled=("object"==typeof window&&(r=window.__dui_disable_scoped_attribute__),"object"==typeof n.g&&(o=n.g.__dui_disable_scoped_attribute__),Boolean(r||o)),c.isBrowser&&(window.__dui_disable_auto_focus_map__=window.__dui_disable_auto_focus_map__||{}),t.h=function(e,n){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var c=n;return(null==n?void 0:n.className)&&"string"==typeof e&&!t.isScopedAttributeDisabled&&(c[s.default]=n.className),a.createElement.apply(void 0,i.__spreadArray([e,c],r))}},26276:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentDomContext=void 0;var r=n(85556).__importStar(n(87363));t.DocumentDomContext=r.createContext(null)},259:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.restoreFocus=t.saveFocus=t.traverseFocusIn=void 0;var n=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'];t.traverseFocusIn=function(e,t,r){void 0===r&&(r=null==t?void 0:t.shiftKey);var o=function(e){return Array.prototype.slice.call(e.querySelectorAll(n))}(e);if(0!==o.length){var i,a=o.indexOf(document.activeElement);(i=a<0?o[0]:o[(a+(r?-1:1)+o.length)%o.length]).focus(),i.scrollIntoView(),null==t||t.preventDefault()}};var r=null;function o(){null==r||r.focus(),r=null}t.saveFocus=function(){r=document.activeElement},t.restoreFocus=function(){r&&("BUTTON"===r.tagName?setTimeout(o,0):o())}},80328:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.createContextValueGetter=t.shallowEqual=t.isBrowser=t.isDom=t.wrapWithConfigDefaults=t.inject=t.assert=t.isIE=t.createStringParamFunc=t.canBeDivided=t.roundByStep=t.castInto=t.nullFn=t.trueFn=t.falseFn=t.emptyFn=void 0;var r,o=n(85556),i=o.__importDefault(n(5125));function a(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);return n.length===r.length&&n.every((function(n){return e[n]===t[n]}))}t.emptyFn=function(){},t.falseFn=function(){return!1},t.trueFn=function(){return!0},t.nullFn=function(){return null},t.castInto=function(e,t){return e>t[1]?t[1]:e<t[0]?t[0]:e},t.roundByStep=function e(t,n){if(t<0)return-e(-t,n);var r=t%n;return r<n/2?t-r:t-r+n},t.canBeDivided=function(e,t){var n=e/t;return n>>0===n},t.createStringParamFunc=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=t.map((function(e){return Number(e)}));return e.apply(void 0,r)}},t.isIE=function(){if("boolean"==typeof r)return r;var e=navigator.userAgent;return r=!(!/compatible/.test(e)||!/MSIE/.test(e))||!(!/Trident/.test(e)||!/rv:11\.0/.test(e))},t.assert=function(e,t){e||console.error(t)},t.inject=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=e.apply(null,n);return!1!==o&&t(),o}},t.wrapWithConfigDefaults=function(e){var t={},n=function(n){var r=o.__assign(o.__assign({},t),n);return e(r)};return n.configDefaults=function(e){t=e},n},t.isDom=function(e){return e&&"object"==typeof e&&1===e.nodeType},t.isBrowser="undefined"!=typeof window&&"undefined"!=typeof document,t.shallowEqual=a,t.createContextValueGetter=function(){return i.default((function(e){return e}),(function(e,t){return a(e[0],t[0])}))}},89805:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.decideKeepDom=void 0,t.decideKeepDom=function(e,t){var n=this,r=!t&&this._ALC_HELPER_prevVisible;return this._ALC_HELPER_prevVisible=t,!!t||!!r&&(setTimeout((function(){n.forceUpdate()}),e),!0)}},25944:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.triggerMicroTask=void 0;var n=null,r=null,o=1;if("undefined"!=typeof document){var i=new MutationObserver((function(){null==n||n(),n=null}));r=document.createElement("div"),i.observe(r,{attributes:!0})}t.triggerMicroTask=function(e){r?(n=e,r.setAttribute("data-dui-micro-task",String(o++))):Promise.resolve().then(e)}},55610:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),"function"!=typeof String.prototype.repeat&&(String.prototype.repeat=function(e){if(null==this)throw new TypeError("can't convert "+this+" to object");var t=""+this;if((e=+e)!=e&&(e=0),e<0)throw new RangeError("repeat count must be non-negative");if(e==1/0)throw new RangeError("repeat count must be less than infinity");if(e=Math.floor(e),0==t.length||0==e)return"";if(t.length*e>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");var n=t.length*e;for(e=Math.floor(Math.log(e)/Math.log(2));e;)t+=t,e--;return t+=t.substring(0,n-t.length)}),"function"!=typeof String.prototype.padStart&&(String.prototype.padStart=function(e,t){return e>>=0,t=String(void 0!==t?t:" "),this.length>e?String(this):((e-=this.length)>t.length&&(t+=t.repeat(e/t.length)),t.slice(0,e)+String(this))}),"function"!=typeof Array.prototype.fill&&(Array.prototype.fill=function(e){if(null==this)throw new TypeError("this is null or not defined");for(var t=Object(this),n=t.length>>>0,r=arguments[1],o=r>>0,i=o<0?Math.max(n+o,0):Math.min(o,n),a=arguments[2],s=void 0===a?n:a>>0,c=s<0?Math.max(n+s,0):Math.min(s,n);i<c;)t[i]=e,i++;return t}),"undefined"!=typeof Element&&"function"!=typeof Element.prototype.remove&&(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),Array.prototype.findIndex||(Array.prototype.findIndex=function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var r=arguments[1],o=0;o<n;){var i=t[o];if(e.call(r,i,o,t))return o;o++}return-1}),Array.prototype.includes||(Array.prototype.includes=function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),r=n.length>>>0;if(0===r)return!1;for(var o,i,a=0|t,s=Math.max(a>=0?a:r-Math.abs(a),0);s<r;){if((o=n[s])===(i=e)||"number"==typeof o&&"number"==typeof i&&isNaN(o)&&isNaN(i))return!0;s++}return!1})},37216:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.toggleGlobalScrollEvents=t.PreventScrollPenetrateContainer=t.preventSelfScrollPenetrate=void 0;var r=n(85556),o=n(56630).h,i=r.__importStar(n(87363));function a(e,t,n){if(void 0===t&&(t="y"),void 0===n&&(n=null),e&&!e.__preventSelfScrollPenetrate){var r,o,i=null;e.addEventListener("touchstart",(function(e){i=null;var t=e.touches[0];r=t.screenX,o=t.screenY})),e.addEventListener("touchmove",(function(a){var s=a.touches[0],c=s.screenX-r,l=s.screenY-o,u="x"===t&&0===e.scrollLeft,d="x"===t&&e.scrollLeft===e.scrollWidth-e.offsetWidth,p="y"===t&&0===e.scrollTop,h="y"===t&&e.scrollTop===e.scrollHeight-e.offsetHeight,f=u||p?"lower":d||h?"upper":null;("x"===t?c>0&&u||c<0&&d:l>0&&p||l<0&&h)?(a.cancelable&&a.preventDefault(),i!==f&&(e.dispatchEvent(new TouchEvent("touchstart",a)),i=f),n===f&&a.stopPropagation()):a.stopPropagation()}),{passive:!1}),e.__preventSelfScrollPenetrate=!0}}t.preventSelfScrollPenetrate=a;var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.domRef=i.createRef(),t.isInnerScroll=!1,t.startScreenX=-1,t.startScreenY=-1,t.handleTouchStart=function(e){var n=t.domRef.current,r=e.composedPath(),o=e.touches[0];t.startScreenX=o.screenX,t.startScreenY=o.screenY;for(var i=0,s=r;i<s.length;i++){var c=s[i];if(!n.contains(c))return void(t.isInnerScroll=!1);if(c.scrollHeight>c.clientHeight)return t.isInnerScroll=!0,void a(c)}t.isInnerScroll=!1},t.handleTouchMove=function(e){if(!t.isInnerScroll){var n=e.touches[0];"stylus"===n.touchType&&c(t.startScreenX,t.startScreenY,n.screenX,n.screenY)<10||e.cancelable&&e.preventDefault()}},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){var e=this.domRef.current;e.addEventListener("touchstart",this.handleTouchStart),e.addEventListener("touchmove",this.handleTouchMove,{passive:!1})},t.prototype.render=function(){return o("div",r.__assign({},this.props,{ref:this.domRef}),this.props.children)},t}(i.Component);function c(e,t,n,r){return Math.sqrt(Math.pow(e-n,2)+Math.pow(t-r,2))}t.PreventScrollPenetrateContainer=s;var l="";t.toggleGlobalScrollEvents=function(e){e&&!l&&(l=document.documentElement.style.overflow||"initial",document.documentElement.style.overflow="hidden"),!e&&l&&(document.documentElement.style.overflow=l,l="")}},92437:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.showWithTransition=void 0;var r=n(85556),o=n(56630).h,i=r.__importDefault(n(61533)),a=n(80328);t.showWithTransition=function(e){var t,n=e.Component,s=e.transitionDuration,c=e.autoClose,l=e.props,u=e.forcedProps,d=e.injectClosePropNames,p=void 0===d?[]:d,h=e.deepInjectClose,f=void 0===h?[]:h,g=e.contexts,v=document.createElement("div");document.body.appendChild(v);var y=!1;p.forEach((function(e){b(l,e)})),f.forEach((function(e){var t=e[0],n=e[1];Array.isArray(t)?t.forEach((function(e){return b(e,n)})):b(t,n)}));var m=r.__assign(r.__assign(r.__assign({},l),u),{visible:!0});function b(e,t){var n=e[t]||a.emptyFn;e[t]=a.inject(n,_)}function _(){y||(y=!0,clearTimeout(t),C(m=r.__assign(r.__assign({},m),{visible:!1})),setTimeout((function(){i.default.unmountComponentAtNode(v),v.remove()}),s+20))}function C(e){var t=(null==g?void 0:g.length)?function(e,t){return e.reduce((function(e,t){var n=t.provider,r=t.value;return o(n,{value:r},e)}),t)}(g,o(n,r.__assign({},e))):o(n,r.__assign({},e));i.default.render(t,v)}return C(m),c&&(t=setTimeout(_,l.duration||2e3)),{update:function(e){y||C(m=r.__assign(r.__assign(r.__assign(r.__assign({},m),e),u),{visible:!0}))},close:_}}},36226:function(e,t,n){t.D=void 0;var r=n(85556).__importDefault(n(6991)),o=n(56630),i=n(80328),a=function(){function e(){var e=i.isBrowser?window:n.g;e.__dui_style_registry__=e.__dui_style_registry__||{},this.registry=e.__dui_style_registry__}return Object.defineProperty(e.prototype,"length",{get:function(){return Object.keys(this.registry).length},enumerable:!1,configurable:!0}),e.prototype.set=function(e,t){this.registry[e]=t},e.prototype.get=function(e){return this.registry[e]},e.prototype.add=function(e,t){this.registry[e]||(this.registry[e]=[]),this.registry[e].push(t)},e}(),s=new a;t.D=function(e,t){var n=r.default+"-"+e,a=o.isScopedAttributeDisabled?e:n,u=Boolean(i.isBrowser&&document.querySelector('style[data-dui-key="'+a+'"]')||!i.isBrowser);if(Array.isArray(s.get(n))&&u)return s.add(n,"1"),void function(e){if(i.isBrowser&&s.length&&Array.isArray(s.get(e))){var t=s.get(e).length;setTimeout((function(){s.get(e).length>t||console.warn("[DUI] "+e+"  "+t+" ")}),c)}}(n);s.set(n,["1"]);var d=l(e);if(d.length>1&&function(e,t){i.isBrowser&&setTimeout((function(){l(e).length>t.length||console.warn("[DUI] "+e+" :  "+t.join("  "))}),c)}(e,d),i.isBrowser)(p=document.createElement("style")).setAttribute("type","text/css"),p.setAttribute("data-dui-key",a),p.innerText=t,document.head.appendChild(p);else if("function"==typeof injectContentBeforeRoot){var p='<style type="text/css" data-dui-key="'+a+'">'+t+"</style>";injectContentBeforeRoot(p)}};var c=3e3;function l(e){return s.length?Object.getOwnPropertyNames(s.registry).filter((function(t){return-1!==t.indexOf(e)})).map((function(e){return e.split("-")[0]})):[]}},7919:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.WithStylusClick=t.StylusAdapter=void 0;var r,o=n(85556),i=o.__importDefault(n(87363)),a=o.__importDefault(n(86667));!function(e){e.direct="direct",e.stylus="stylus"}(r||(r={}));var s=function(){function e(){}return e.supportStylus=function(e,t){if(this.isIPadStylusTouch(e))if("touchstart"!==e.nativeEvent.type){if("touchend"===e.nativeEvent.type){var n=[e.changedTouches[0].clientX,e.changedTouches[0].clientY];this.isEqualPos(this.startPos,n)&&t&&t(),e.preventDefault()}}else this.startPos=[e.changedTouches[0].clientX,e.changedTouches[0].clientY]},e.startPos=[0,0],e.isIPadStylusTouch=function(e){return a.default.isIPad&&e.changedTouches[0]&&e.changedTouches[0].touchType===r.stylus},e.isEqualPos=function(e,t){return Math.abs(e[0]-t[0])<10&&Math.abs(e[1]-t[1])<10},e}();t.StylusAdapter=s,t.WithStylusClick=function(e){var t=e.children,n=e.clickHandler;return i.default.cloneElement(t,{onClick:n,onTouchStart:function(e){return s.supportStylus(e,n)},onTouchEnd:function(e){return s.supportStylus(e,n)}})}},68848:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.createThemedClassNames=t.consumeTheme=void 0;var r=n(85556),o=n(56630).h,i=r.__importStar(n(87363)),a=r.__importDefault(n(32230)),s=r.__importDefault(n(86667));n(55610),n(36226).D("common/global.css","[data-dui-0-134-2]{font-family:-apple-system,PingFang SC,Microsoft YaHei,Source Han Sans SC,Noto Sans CJK SC,WenQuanYi Micro Hei,sans-serif}[data-dui-0-134-2]:focus{outline:none}"),s.default.isMac&&!s.default.isIPadEmulatedMac&&!s.default.isFirefox&&n(36226).D("common/anti-alias.css",'[data-dui-0-134-2]{-webkit-font-smoothing:antialiased}[data-dui-0-134-2~="dui-button"]{font-weight:500}');var c=i.createContext(null);function l(e,t){if(!t||!e)return t;var n=t.split(/\s+/);return n.concat.apply(n,n.map((function(t){return e[t]})).filter((function(e){return e}))).join(" ")}function u(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return l(e,a.default.apply(void 0,t))}}t.consumeTheme=function(e){return o(c.Consumer,null,(function(t){var n=u(t);return e(n)}))},t.createThemedClassNames=u,t.default=c},54464:function(e,t,n){n.d(t,{Yd:function(){return E}});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};function a(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}function s(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function c(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}var l=new Map;function u(e){return function(t){t.prototype.appenderOptions=e,l.set(e.name,{provide:t})}}var d=new Map,p=function(){function e(){}return e.get=function(e,t){var n=e;return d.has(e)||(n="basic",console.warn("".concat(e," layout doesn't exists"))),new(d.get(n).provide)(null!=t?t:{})},e}(),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.write=function(e){var t=e.level;return t.isGreaterThanOrEqualTo("ERROR")?console.error.apply(console,c([],s(this.layout(e)),!1)):t.isEqualTo("WARN")?console.warn.apply(console,c([],s(this.layout(e)),!1)):t.isEqualTo("INFO")?console.info.apply(console,c([],s(this.layout(e)),!1)):console.log.apply(console,c([],s(this.layout(e)),!1))},t=a([u({name:"console"})],t)}(function(){function e(){this.config={},this.appenderOptions={name:""},this.configure({})}return e.prototype.configure=function(e){var t;Object.assign(this.config,e),e.layout?this.useLayout=p.get(e.layout.type,e.layout):this.useLayout=p.get(null!==(t=this.appenderOptions.defaultLayout)&&void 0!==t?t:"basic")},e.prototype.layout=function(e){return this.useLayout.transform(e)},e}());function f(e){return function(t){d.set(e.name,{provide:t})}}var g=function(e){var t=/(%?)(%([jds]))/g,n=Array.prototype.slice.call(arguments,1);return n.length&&(e=e.replace(t,(function(e,t,r,o){var i=n.shift();switch(o){case"s":i=""+i;break;case"d":i=Number(i);break;case"j":i=JSON.stringify(i)}return t?(n.unshift(i),e):i}))),n.length&&(e+=" "+n.join(" ")),""+(e=e.replace(/%{2,2}/g,"%"))};function v(e,t){void 0===t&&(t="yyyy-MM-ddThh:mm:ss.SSS");var n,r,o,i,a="".concat(e.getDate()).padStart(2,"0"),s="".concat(e.getMonth()+1).padStart(2,"0"),c="".concat(e.getFullYear()).padStart(2,"0"),l="".concat(c).substring(2,4),u=t.indexOf("yyyy")>-1?c:l,d="".concat(e.getHours()).padStart(2,"0"),p="".concat(e.getMinutes()).padStart(2,"0"),h="".concat(e.getSeconds()).padStart(2,"0"),f="".concat(e.getMilliseconds()).padStart(3,"0"),g=(n=e.getTimezoneOffset(),r=Math.abs(n),o=String(Math.floor(r/60)),i=String(r%60),1===o.length&&(o="0".concat(o)),1===i.length&&(i="0".concat(i)),n<0?"+".concat(o).concat(i):"-".concat(o).concat(i));return t.replace(/dd/g,a).replace(/MM/g,s).replace(/y{1,4}/g,u).replace(/hh/g,d).replace(/mm/g,p).replace(/ss/g,h).replace(/SSS/g,f).replace(/O/g,g)}var y,m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.transform=function(e){var t=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=e;return Array.isArray(r)||(r=c([r],s(t),!1)),g.apply(void 0,c([],s(r),!1))}("[%s] [%s] [%s] - ",v(e.startTime),e.formatedLevel,e.categoryName);return"string"==typeof e.data?[t+e.data]:[t,e.data]},t=a([f({name:"basic"})],t)}((function(){})),b=function(){function e(e,t,n,r){this._categoryName=e,this._level=t,this._data=n,this._context=r,this._startTime=new Date}return Object.defineProperty(e.prototype,"startTime",{get:function(){return this._startTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"categoryName",{get:function(){return this._categoryName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return this._level},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formatedLevel",{get:function(){return this.level.toString().padEnd(5," ")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data.length>1?this._data:this._data[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){return this._context},enumerable:!1,configurable:!0}),e}(),_=function(){function e(e,t){this.level=e,this.levelStr=t,this.level=e,this.levelStr=t}return e.getLevel=function(t,n){return t instanceof e?t:"string"==typeof t?y[t.toUpperCase()]||n:this.getLevel(t.toString())},e.prototype.toString=function(){return this.levelStr},e.prototype.isLessThanOrEqualTo=function(t){return this.level<=e.getLevel(t).level},e.prototype.isGreaterThanOrEqualTo=function(t){return this.level>=e.getLevel(t).level},e.prototype.isEqualTo=function(t){return this.level===e.getLevel(t).level},e}();function C(){return y}y={ALL:new _(Number.MIN_VALUE,"ALL"),TRACE:new _(5e3,"TRACE"),DEBUG:new _(1e4,"DEBUG"),INFO:new _(2e4,"INFO"),WARN:new _(3e4,"WARN"),ERROR:new _(4e4,"ERROR"),FATAL:new _(5e4,"FATAL"),MARK:new _(9007199254740992,"MARK"),OFF:new _(Number.MAX_VALUE,"OFF")};var S=function(){function e(){this.appenders=new Map,this.levels=new Map}return Object.defineProperty(e.prototype,"size",{get:function(){return this.appenders.size},enumerable:!1,configurable:!0}),e.prototype.has=function(e){return this.appenders.has(e)},e.prototype.get=function(e){return this.appenders.get(e)},e.prototype.set=function(e,t){if(!l.has(e)){var n=new Error("Appender ".concat(e," doesn't exists. Check your configuration:\n").concat(JSON.stringify(t),"\n"));throw n.name="UNKNOW_APPENDER",n}var r=new(0,l.get(e).provide)(t);return this.appenders.set(e,{instance:r,config:t}),this.levels.clear(),this},e.prototype.delete=function(e){var t=this.appenders.delete(e);return t&&this.levels.clear(),t},e.prototype.clear=function(){this.appenders.clear(),this.levels.clear()},e.prototype.forEach=function(e,t){this.appenders.forEach(e,t)},e.prototype.byLogLevel=function(e){var t=e.toString();if(this.levels.has(t))return this.levels.get(t);var n=this.toArray().filter((function(t){return!t.config.levels||t.config.levels.find((function(t){return t.toUpperCase()===e.toString()}))})).map((function(e){return e.instance}));return this.levels.set(e.toString(),n),n},e.prototype.toArray=function(){var e=[];return this.appenders.forEach((function(t){return e.push(t)})),e},e}(),w="ALL",E=function(){function e(e){this.name=e,this.appenders=new S}return e.createStack=function(){var e,t=(null!==(e=(new Error).stack)&&void 0!==e?e:"").replace("Error\n","").split("\n");return t[0].indexOf("Logger.")>-1&&t.splice(0,1),t[0].indexOf("Logger.")>-1&&t.splice(0,1),t.join("\n")},Object.defineProperty(e.prototype,"level",{get:function(){return this.currentLevel?this.currentLevel.toString():_.getLevel(w).toString()},set:function(e){this.currentLevel=_.getLevel(e,w)},enumerable:!1,configurable:!0}),e.prototype.use=function(e,t){return this.appenders.set(e,i({layout:{type:"basic"},levels:["trace","debug","info","warn","error","fatal"]},t)),this},e.prototype.isLevelEnabled=function(e){return this.currentLevel?this.currentLevel.isLessThanOrEqualTo(e):_.getLevel(w).isLessThanOrEqualTo(e)},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.write(C().DEBUG,e)},e.prototype.trace=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r="\n".concat(e.createStack(),"\n");return t.push(r),this.write(C().TRACE,t)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.write(C().INFO,e)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.write(C().WARN,e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.write(C().ERROR,e)},e.prototype.fatal=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.write(C().FATAL,e)},e.prototype.write=function(e,t){if(!this.isLevelEnabled(e))return this;var n=new b(this.name,e,t,this.context);return this.appenders.byLogLevel(e).forEach((function(e){e.write(n)})),this},e}();u({name:"console"})(h),f({name:"basic"})(m)},24282:function(e,t,n){n.d(t,{KU:function(){return l},b$:function(){return u}});var r=n(85235);const o=()=>window[r.LH];var i=n(85556),a=class{constructor(e){this.handlers=new Map,this.closed=!1,this.subscribe=(e,t)=>{if(this.isClosed())throw new Error("channel is closed");this.handlers.set(e,t)},this.publish=(e,...t)=>{if(this.isClosed())throw new Error("channel is closed");o().transport.publish({token:this.token,eventName:e,args:t})},this.fire=(e,...t)=>{var n;null===(n=this.handlers.get(e))||void 0===n||n(...t)},this.close=()=>{this.unsubscribe(),this.handlers.clear(),this.closed=!0},this.isClosed=()=>this.closed,this.unsubscribe=()=>{},this.token=e,this.unsubscribe=o().transport.subscribe(e,(({eventName:e,args:t})=>this.fire(e,...t)))}},s=class{constructor(e){this.closed=!1,this.subscribe=(e,t)=>{if(this.isClosed())throw new Error("channel is closed");o().transport.subscribe(this.token,e,t)},this.publish=(e,...t)=>{if(this.isClosed())throw new Error("channel is closed");o().transport.publish({token:this.token,eventName:e,args:t})},this.fire=()=>{},this.close=()=>{this.unsubscribe(),this.closed=!0},this.isClosed=()=>this.closed,this.unsubscribe=()=>{o().transport.unsubscribe(this.token)},this.token=e}};class c{constructor(e){this.protocols=e}static create(e,t){const n=new c(e);return n.init(t),n}init(e){const t=this;for(const n of Object.keys(this.protocols))try{this.registerServiceBroker(n,e)}catch(e){t[n]={version:0}}}registerServiceBroker(e,t){const n=this,r=o();if(!r)throw new Error("missing mega broker in global context");const{protocol:c,broker:l}=r.loadProtocol(e),{apis:u,channels:d,version:p}=c;n[e]={version:p};for(const t of u)n[e][t]=l[t];for(const r of d)n[e][r]=(...e)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const{token:n}=yield l[r](...e);return t?new s(n):new a(n)}))}}var l=c,u=function(e={}){return Object.assign({},e)}},85235:function(e,t,n){n.d(t,{LH:function(){return r}});const r="__MEGA_BROKER__";["__MEGA_INTERNAL_API__","loadProtocol"].join(":")},3474:function(e,t,n){var r,o,i,a;n.d(t,{Xz:function(){return C},DB:function(){return O},Cz:function(){return R},J_:function(){return k},SZ:function(){return i},rP:function(){return w},GM:function(){return y},SH:function(){return m},t6:function(){return _},lG:function(){return p},xn:function(){return h},CV:function(){return S},U9:function(){return T},iP:function(){return x},Lb:function(){return I},V4:function(){return r},Qg:function(){return b}}),function(e){e.Save="SAVE",e.SaveAs="SAVE_AS",e.SaveByE2E="SAVE_BY_E2E",e.AutoSave="AUTO_SAVE",e.Rename="RENAME"}(r||(r={})),function(e){e.ConvertOnlineSave="convertOnlineSave",e.LocalSave="localSave",e.Save4Close="save4Close"}(o||(o={})),function(e){e.CloseTab="close-tab",e.ContentModified="content-modified",e.UpdateTitle="update-title",e.TimeTrack="time-track",e.Save="save"}(i||(i={})),function(e){e.Current="current",e.AutoSave="auto-save",e.Origin="origin"}(a||(a={}));var s,c,l,u,d,p,h,f,g,v,y,m,b,_,C,S,w,E=n(85235);!function(e){e.Play="play",e.Pause="pause",e.Stop="stop",e.Close="close",e.TogglePause="toggle-pause",e.ToggleMute="toggle-mute",e.SetVolume="set-volume",e.SetPosition="set-position",e.SetRate="set-rate",e.SetTime="set-time",e.SetPixelFormat="set-pixel-format",e.SetMute="set-mute",e.FrameSetup="frame-setup",e.FrameReady="frame-ready",e.TimeChanged="time-changed",e.LengthChanged="length-changed",e.PositionChanged="position-changed",e.Opening="opening",e.Playing="playing",e.Paused="paused",e.Stopped="stopped",e.Backward="backward",e.Buffering="buffering",e.EncounteredError="encountered-error",e.EndReached="end-reached",e.Forward="forward",e.FrameCleanup="frame-cleanup",e.MediaChanged="media-changed",e.NothingSpecial="nothing-special",e.PausableChanged="pausable-changed",e.SeekableChanged="seekable-changed",e.LogMessage="log-message"}(s||(s={})),E.LH,function(e){e.Head="head",e.Chunk="chunk",e.End="end",e.Abort="abort",e.FatalError="fatal-error",e.CaptureError="capture-error",e.RequestAbort="abort"}(c||(c={})),function(e){e.ReadCache="read-cache"}(l||(l={})),function(e){e.JSONSaved="json-saved",e.DocumentSaved="document-saved",e.Cancel="cancel",e.Abort="abort",e.FatalError="fatal-error",e.CaptureError="capture-error"}(u||(u={})),function(e){e[e.None=0]="None",e[e.IOShareViolationError=4003]="IOShareViolationError",e[e.IONotFoundError=4004]="IONotFoundError",e[e.IOUnauthorizedAccessError=4005]="IOUnauthorizedAccessError",e[e.IOUnavailableError=4006]="IOUnavailableError",e[e.DocumentEncryptedError=4001]="DocumentEncryptedError",e[e.DocumentBrokenPackageError=4021]="DocumentBrokenPackageError",e[e.DocumentBrokenOOXMLError=4022]="DocumentBrokenOOXMLError",e[e.OutOfSpaceError=4013]="OutOfSpaceError",e[e.MissingConverterError=5e3]="MissingConverterError",e[e.UnsupportedSystemEnvironmentError=5001]="UnsupportedSystemEnvironmentError",e[e.ComponentFetchError=5002]="ComponentFetchError",e[e.ComponentExecuteError=5003]="ComponentExecuteError",e[e.UnexpectedFormatConvertError=5004]="UnexpectedFormatConvertError",e[e.UnexpectedProcessKilledError=5005]="UnexpectedProcessKilledError",e[e.UnexpectedOutputFormatError=5006]="UnexpectedOutputFormatError",e[e.UIModelError=5007]="UIModelError",e[e.UnexpectedInputIOError=5008]="UnexpectedInputIOError",e[e.UnexpectedInputFormatError=5009]="UnexpectedInputFormatError",e[e.UnexpectedFormatConvertNoEndError=5010]="UnexpectedFormatConvertNoEndError",e[e.UnsupportedAppEnvironmentError=5011]="UnsupportedAppEnvironmentError",e[e.CacheDataIOError=5012]="CacheDataIOError",e[e.UnknownError=5120]="UnknownError"}(d||(d={})),function(e){e[e.ErrorUnknown=23e3]="ErrorUnknown",e[e.ImageUploadError=23005]="ImageUploadError",e[e.ImageDownloadError=23006]="ImageDownloadError"}(p||(p={})),function(e){e.UploadImageData="upload-image-data",e.DownloadImageData="download-image-data",e.MediaError="media-error"}(h||(h={})),function(e){e.InstallProgress="install-progress",e.InstallError="install-error",e.Installed="installed",e.Uninstalled="uninstalled",e.UninstallError="uninstall-error"}(f||(f={})),function(e){e.WillRetrieveManifest="will-retrieve-manifest",e.WillDownload="will-download",e.WillValidate="will-validate",e.WillUnarchive="will-unarchive",e.WillInstall="will-install",e.DidInstall="did-install"}(g||(g={})),function(e){e.DLL="dll",e.Executable="executable",e.Asset="asset",e.Addon="addon"}(v||(v={})),function(e){e.Next="next",e.Chunk="chunk",e.End="end",e.Error="error"}(y||(y={})),function(e){e.Saved="saved",e.Cancel="cancel",e.Error="error"}(m||(m={})),function(e){e.NotSupported="not-supported",e.StatError="stat-error"}(b||(b={})),function(e){e[e.kUnknownDocsType=14001]="kUnknownDocsType",e[e.kFileNotExist=14002]="kFileNotExist",e[e.kInvalidFilesystem=14003]="kInvalidFilesystem",e[e.kFilesystemEmitError=14004]="kFilesystemEmitError",e[e.kTreewalkerEmitError=14005]="kTreewalkerEmitError",e[e.kInvalidRefResolver=14006]="kInvalidRefResolver",e[e.kInvalidPackageContext=14007]="kInvalidPackageContext",e[e.kInvalidPartContext=14008]="kInvalidPartContext",e[e.kInvalidPackageDescriptor=14009]="kInvalidPackageDescriptor",e[e.kInvalidPartDescriptor=14010]="kInvalidPartDescriptor",e[e.kInvalidPackageStrategy=14011]="kInvalidPackageStrategy",e[e.kInvalidPartStrategy=14012]="kInvalidPartStrategy",e[e.kInvalidAssetPart=14013]="kInvalidAssetPart",e[e.kPasswordRequired=14014]="kPasswordRequired",e[e.kInvalidPassword=14015]="kInvalidPassword",e[e.kInvalidEncryptionContext=14016]="kInvalidEncryptionContext",e[e.kInvalidImportConfig=14017]="kInvalidImportConfig",e[e.kInvalidNamespaceWhenSeekSectpr=14018]="kInvalidNamespaceWhenSeekSectpr",e[e.kImportCancel=14019]="kImportCancel",e[e.kNotSupported=14020]="kNotSupported",e[e.kInvalidImportCache=14021]="kInvalidImportCache",e[e.kInvalidSheetRef=14022]="kInvalidSheetRef",e[e.kInvalidDrawRef=14023]="kInvalidDrawRef",e[e.kInvalidChartRef=14024]="kInvalidChartRef",e[e.kLostRequiredData=14025]="kLostRequiredData",e[e.kInvalidPivotTableRef=14026]="kInvalidPivotTableRef",e[e.kEmptySheetCell=14027]="kEmptySheetCell",e[e.kInvalidSheetId=14028]="kInvalidSheetId",e[e.kSheetDimensionLimited=14029]="kSheetDimensionLimited",e[e.kPresentationPrNotEnough=14030]="kPresentationPrNotEnough",e[e.kSlideMasterNotFound=14031]="kSlideMasterNotFound",e[e.kSlideChunkPageEmptyError=1077]="kSlideChunkPageEmptyError"}(_||(_={})),function(e){e[e.ErrorUnknown=23e3]="ErrorUnknown",e[e.ErrorBusy=23001]="ErrorBusy",e[e.ErrorNotEntity=23002]="ErrorNotEntity",e[e.ErrorPermittion=23003]="ErrorPermittion",e[e.ErrorConverterInstall=23090]="ErrorConverterInstall"}(C||(C={})),function(e){e[e.ErrorUnknown=23e3]="ErrorUnknown",e[e.DomainError=23001]="DomainError",e[e.RequestParseError=23002]="RequestParseError",e[e.IOResultParseError=23003]="IOResultParseError",e[e.FileNoExist=23004]="FileNoExist",e[e.ImageUploadError=23005]="ImageUploadError",e[e.ImageDownloadError=23006]="ImageDownloadError",e[e.FileReadFailed=23007]="FileReadFailed",e[e.NotImplemented=23999]="NotImplemented"}(S||(S={})),function(e){e[e.kUnknownDocsType=15001]="kUnknownDocsType",e[e.kInvalidFileHandle=15002]="kInvalidFileHandle",e[e.kRequiredVisitor=15003]="kRequiredVisitor",e[e.kInvalidPartStrategy=15004]="kInvalidPartStrategy",e[e.kEmptyDataContent=15005]="kEmptyDataContent",e[e.kLostPartVisitor=15006]="kLostPartVisitor",e[e.kExportPBToXFailed=15007]="kExportPBToXFailed",e[e.kEmbedFontFileNotExist=15008]="kEmbedFontFileNotExist",e[e.kEmbedFontOriginFileOpenError=15009]="kEmbedFontOriginFileOpenError",e[e.kEmbedFontDstFileOpenError=15010]="kEmbedFontDstFileOpenError",e[e.kInvalidOOXMLNode=15011]="kInvalidOOXMLNode",e[e.kEncryptFileFailed=15012]="kEncryptFileFailed",e[e.kExportCancel=15013]="kExportCancel",e[e.kInvalidSheetModel=15014]="kInvalidSheetModel",e[e.kInvalidWorksheetId=15015]="kInvalidWorksheetId",e[e.kInvalidWorksheetChartData=15016]="kInvalidWorksheetChartData",e[e.kInvalidPivotTable=15017]="kInvalidPivotTable",e[e.kInvalidPivotCacheDefinitions=15018]="kInvalidPivotCacheDefinitions",e[e.kInvalidPivotCacheRecords=15019]="kInvalidPivotCacheRecords",e[e.kInvalidSheetPivotTable=15020]="kInvalidSheetPivotTable",e[e.kInvalidSheetSharedStringCache=15021]="kInvalidSheetSharedStringCache",e[e.kInvalidSheetFrozenProperty=15022]="kInvalidSheetFrozenProperty",e[e.kInvalidSheetChart=15023]="kInvalidSheetChart",e[e.kInvalidSheetComment=15024]="kInvalidSheetComment",e[e.kAllWorksheetAreHidden=15025]="kAllWorksheetAreHidden",e[e.kInvalidSlideModel=15026]="kInvalidSlideModel",e[e.kEmptySlideViewPr=15027]="kEmptySlideViewPr",e[e.kEmptyTableStyleList=15028]="kEmptyTableStyleList",e[e.kEmptyPresPros=15029]="kEmptyPresPros",e[e.kInvalidSlideId=15030]="kInvalidSlideId",e[e.kInvalidSlideMasterId=15031]="kInvalidSlideMasterId",e[e.kInvalidNotesSlideId=15032]="kInvalidNotesSlideId",e[e.kNotesMasterNotFound=15033]="kNotesMasterNotFound",e[e.kInvalidSlideSection=15034]="kInvalidSlideSection",e[e.kSlideTableNotFound=15035]="kSlideTableNotFound"}(w||(w={}));const x=Object.assign(Object.assign({},_),S),T=Object.assign(Object.assign({},w),S);var R,I,P,O,k;!function(e){e.FINISH_LOAD="FINISH_LOAD",e.FINISH_DISPLAY="FINISH_DISPLAY",e.BEGIN_DUMP="BEGIN_DUMP",e.MOBILE_PERFERMANCE="MOBILE_PERFERMANCE"}(R||(R={})),function(e){e.CAN_VIEW="can_view",e.CAN_INTERACT="can_interact",e.CAN_EDIT="can_edit"}(I||(I={})),function(e){e.Complete="complete",e.ReadCache="read-cache"}(P||(P={})),function(e){e.Data="data",e.Abort="abort",e.ConverterError="converter-error",e.ContinueWithPassword="continue-with-password",e.DesktopError="desktop-error",e.MobileError="mobile-error",e.NextChunkData="next-chunk-data",e.ChunkData="chunk-data"}(O||(O={})),function(e){e.JSONSaved="json-saved",e.DocumentSaved="document-saved",e.Cancel="cancel",e.Abort="abort",e.ConverterError="converter-error",e.DesktopError="desktop-error",e.MobileError="mobile-error"}(k||(k={}))},5358:function(e,t,n){var r,o;n.d(t,{cg:function(){return o},zU:function(){return d},uZ:function(){return u},O3:function(){return a},yE:function(){return c},Kl:function(){return s},g6:function(){return r},Ze:function(){return m},As:function(){return l},pF:function(){return v},q9:function(){return p},qW:function(){return i},IA:function(){return g},zV:function(){return f},ot:function(){return h}}),function(e){e.CreateCollection="create-collection",e.DropCollection="drop-collection",e.CreateIndex="create-index",e.DropIndex="drop-index"}(r||(r={})),function(e){e.MoveProperty="move-property",e.DropProperty="drop-property",e.ReplaceProperty="replace-property",e.ClearData="clear-data",e.ReplaceData="replace-data"}(o||(o={}));var i,a={name:"alloy_db_schema_table",indices:[],key:{path:"name"},properties:[]};!function(e){e.Equals="=",e.NotEquals="!=",e.GreaterThan=">",e.GreaterOrEqualThan=">=",e.LessThan="<",e.LessOrEqualThan="<=",e.In="in",e.NotIn="nin"}(i||(i={}));var s,c,l,u,d,p=void 0;function h(e){return"number"==typeof e&&!Number.isNaN(e)||"string"==typeof e||e instanceof Date&&!Number.isNaN(e.getTime())||e instanceof ArrayBuffer||ArrayBuffer.isView(e)||Array.isArray(e)&&e.every(h)}function f(e,t){var n=e;return Array.isArray(t)?t.map((function(e){return n[e]})):n[t]}function g(e,t){return Array.isArray(e)?Array.isArray(t)&&e.length===t.length&&e.every((function(e,n){return g(e,t[n])})):e===t}!function(e){e.OR="or",e.AND="and",e.FILTER="filter",e.NONE="none",e.ALL="all"}(s||(s={})),function(e){e.ENTRIES="entries",e.VALUES="values",e.KEYS="keys",e.COUNT="count"}(c||(c={})),function(e){e.DESCENDING="desc",e.ASCENDING="asc"}(l||(l={})),function(e){e.AutoIncrement="auto-increment"}(u||(u={})),function(e){e.Equals="=",e.GreaterThan=">",e.GreaterOrEqualThan=">=",e.LessThan="<",e.LessOrEqualThan="<="}(d||(d={}));var v,y=n(85556),m=function(){function e(){}return e.collectionDiff=function(e,t){if(e.name!==t.name)throw new Error("can not compare collection schema with different name");var n={collection:e.name},r=t.indices.filter((function(t){return!e.indices.some((function(e){return e.name===t.name}))})),o=e.indices.filter((function(e){return!t.indices.some((function(t){return t.name===e.name}))}));return(r.length||o.length)&&(n.index={added:(0,y.__spreadArray)([],(0,y.__read)(r)),deleted:(0,y.__spreadArray)([],(0,y.__read)(o))}),n},e.databaseDiff=function(e,t){var n,r,o=this.getCompareMap(e,t),i={added:[],deleted:[],different:[]};try{for(var a=(0,y.__values)(o.values()),s=a.next();!s.done;s=a.next()){var c=s.value;if(!c.oldValue||c.newValue)if(c.oldValue||!c.newValue){if(c.oldValue&&c.newValue){var l=this.collectionDiff(c.oldValue,c.newValue);if(!l.index)continue;i.different.push(l)}}else i.added.push(c.newValue);else i.deleted.push(c.oldValue)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i},e.getCompareMap=function(e,t){var n,r,o,i,a=new Map;try{for(var s=(0,y.__values)(t.collections),c=s.next();!c.done;c=s.next()){var l=c.value;(p=a.get(l.name)||{}).newValue=l,a.set(l.name,p)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}try{for(var u=(0,y.__values)(e.collections),d=u.next();!d.done;d=u.next()){var p;l=d.value,(p=a.get(l.name)||{}).oldValue=l,a.set(l.name,p)}}catch(e){o={error:e}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(o)throw o.error}}return a},e}();!function(e){e.READ_ONLY="readonly",e.READ_WRITE="readwrite",e.VERSION_CHANGE="versionchange"}(v||(v={}))},26660:function(e,t,n){n.d(t,{sH:function(){return i},zF:function(){return a},ZK:function(){return s}});var r=n(85556),o=function(e){function t(t,n){for(var r=this,o=t,i={cause:n};i.cause&&i.cause instanceof Error;)o=t+"\n\t "+n,i=i.cause;return(r=e.call(this,o)||this).cause=n,r.name=r.constructor.name,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(r,r.constructor):r.stack=(new Error).stack,Object.setPrototypeOf(r,r.constructor.prototype),r}return(0,r.__extends)(t,e),t}(Error),i={withDefaultMessage:function(e,t){return function(n){function o(r,o){var i=n.call(this,r||t||"",o)||this;return i.name=e,Object.setPrototypeOf(i,i.constructor.prototype),i}return(0,r.__extends)(o,n),o}(o)},withMessageCreator:function(e,t){return function(n){function o(r,o){var i=n.call(this,t(r),o)||this;return i.name=e,Object.setPrototypeOf(i,i.constructor.prototype),i}return(0,r.__extends)(o,n),o}(o)}},a=(i.withDefaultMessage("AssertionError","the asserted condition is invalid"),i.withMessageCreator("UnimplementedError",(function(e){return e?"called with arguments: "+JSON.stringify(e):"called with nothing"}))),s=function(e){}},95809:function(e,t,n){n.r(t),n.d(t,{default:function(){return F}});var r,o,i=n(85556),a=n(87675),s=n(27505),c=n(5450),l=n.n(c),u=new WeakMap,d=new WeakMap,p=new WeakMap,h=new WeakMap,f=new WeakMap,g={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return d.get(e);if("objectStoreNames"===t)return e.objectStoreNames||p.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return m(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function v(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(o||(o=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(b(this),n),m(u.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return m(e.apply(b(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=e.call.apply(e,[b(this),t].concat(r));return p.set(i,t.sort?t.sort():[t]),m(i)}}function y(e){return"function"==typeof e?v(e):(e instanceof IDBTransaction&&function(e){if(!d.has(e)){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("complete",o),e.removeEventListener("error",i),e.removeEventListener("abort",i)},o=function(){t(),r()},i=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",o),e.addEventListener("error",i),e.addEventListener("abort",i)}));d.set(e,t)}}(e),t=e,(r||(r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((function(e){return t instanceof e}))?new Proxy(e,g):e);var t}function m(e){if(e instanceof IDBRequest)return t=e,(n=new Promise((function(e,n){var r=function(){t.removeEventListener("success",o),t.removeEventListener("error",i)},o=function(){e(m(t.result)),r()},i=function(){n(t.error),r()};t.addEventListener("success",o),t.addEventListener("error",i)}))).then((function(e){e instanceof IDBCursor&&u.set(e,t)})).catch((function(){})),f.set(n,t),n;var t,n;if(h.has(e))return h.get(e);var r=y(e);return r!==e&&(h.set(e,r),f.set(r,e)),r}var b=function(e){return f.get(e)};function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,o=n.upgrade,i=n.blocking,a=n.terminated,s=indexedDB.open(e,t),c=m(s);return o&&s.addEventListener("upgradeneeded",(function(e){o(m(s.result),e.oldVersion,e.newVersion,m(s.transaction))})),r&&s.addEventListener("blocked",(function(){return r()})),c.then((function(e){a&&e.addEventListener("close",(function(){return a()})),i&&e.addEventListener("versionchange",(function(){return i()}))})).catch((function(){})),c}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.blocked,r=indexedDB.deleteDatabase(e);return n&&r.addEventListener("blocked",(function(){return n()})),m(r).then((function(){}))}var E,x=["get","getKey","getAll","getAllKeys","count"],T=["put","add","delete","clear"],R=new Map;function I(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t){if(R.get(t))return R.get(t);var n=t.replace(/FromIndex$/,""),r=t!==n,o=T.includes(n);if(n in(r?IDBIndex:IDBObjectStore).prototype&&(o||x.includes(n))){var i=function(){var e=(0,s.Z)(l().mark((function e(t){var i,a,s,c,u,d,p=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=this.transaction(t,o?"readwrite":"readonly"),s=a.store,c=p.length,u=new Array(c>1?c-1:0),d=1;d<c;d++)u[d-1]=p[d];return r&&(s=s.index(u.shift())),e.next=6,Promise.all([(i=s)[n].apply(i,u),o&&a.done]);case 6:return e.abrupt("return",e.sent[0]);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}();return R.set(t,i),i}}}g=C(C({},E=g),{},{get:function(e,t,n){return I(e,t)||E.get(e,t,n)},has:function(e,t){return!!I(e,t)||E.has(e,t)}});var P=n(5358),O=function(){function e(e,t,n,r){var o,i=this;this.mode=e,this.proxyCursor=t,this.direction=n,this.engineAspects=r,this.delete=void 0,this.update=void 0,e!==P.pF.READ_ONLY&&(this.delete=function(){return i.getProxyCursorWithMode().delete()},this.update=function(e){return i.getProxyCursorWithMode().update(e)}),(null===(o=this.engineAspects)||void 0===o?void 0:o.cursor)&&this.applyAspectPatch()}return e.prototype[Symbol.asyncIterator]=function(){return new k(this)},e.prototype.next=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.proxyCursor.continue()];case 1:return(e=t.sent())?(this.proxyCursor=e,[2,this]):[2,null]}}))}))},e.prototype.value=function(){return this.proxyCursor.value},e.prototype.getProxyCursorWithMode=function(){return this.proxyCursor},e.prototype.applyAspectPatch=function(){var e,t=null===(e=this.engineAspects)||void 0===e?void 0:e.cursor;this.mode!==P.pF.READ_ONLY&&(null==t||t.delete.patch(this,"delete"),null==t||t.update.patch(this,"update")),null==t||t.next.patch(this,"next"),null==t||t.value.patch(this,"value")},e}(),k=function(){function e(e){this.currentCursor=e}return e.prototype[Symbol.asyncIterator]=function(){return this},e.prototype.next=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,t;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return this.currentCursor?(e=this.currentCursor.value(),t=this,[4,this.currentCursor.next()]):[2,{value:void 0,done:!0}];case 1:return t.currentCursor=n.sent(),[2,{value:e,done:!1}]}}))}))},e}(),D=function(){function e(e,t,n,r){this.table=e,this.proxyIndex=t,this.mode=n,this.engineAspects=r,this.name=t.name,this.keyPath=t.keyPath,this.unique=t.unique,(null==r?void 0:r.index)&&this.applyAspectPatch()}return e.prototype.getAll=function(e){return this.proxyIndex.getAll(e)},e.prototype.getAllKeys=function(e,t){return this.proxyIndex.getAllKeys(e,t)},e.prototype.get=function(e){return this.proxyIndex.get(e)},e.prototype.openCursor=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.proxyIndex.openCursor(e,t)];case 1:return(n=r.sent())?[2,new O(this.mode,n,null!=t?t:"next")]:[2,null]}}))}))},e.prototype.applyAspectPatch=function(){var e,t=null===(e=this.engineAspects)||void 0===e?void 0:e.index,n=this;null==t||t.get.patch(n,"get"),null==t||t.getAll.patch(n,"getAll"),null==t||t.getAllKeys.patch(n,"getAllKeys"),null==t||t.openCursor.patch(n,"openCursor")},e}(),M=function(){function e(e,t,n,r){this.mode=e,this.objectStore=t,this.engineAspects=n,this.transaction=r,this.createIndex=void 0,this.delete=void 0,this.bulkDelete=void 0,this.clear=void 0,this.insert=void 0,this.upsert=void 0,this.deleteIndex=void 0,this.bulkUpsert=void 0,this.keyPath=t.keyPath,this.autoIncrement=t.autoIncrement,this.tableName=t.name,this.indexNames=(0,i.__spreadArray)([],(0,i.__read)(t.indexNames)),this.initWriteFun(e),(null==n?void 0:n.table)&&this.applyAspectPatch()}return e.prototype.query=function(){throw new Error("query Method is not support for IDB.")},e.prototype.supports=function(e){return!["query","bulkDelete"].includes(e)},e.prototype.index=function(e){var t=this.objectStore.index(e);return new D(this,t,this.mode,this.engineAspects)},e.prototype.getAll=function(e){return this.objectStore.getAll(e)},e.prototype.getAllKeys=function(e,t){return this.objectStore.getAllKeys(e,t)},e.prototype.get=function(e){var t;return null!==(t=this.objectStore.get(e))&&void 0!==t?t:null},e.prototype.openCursor=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.objectStore.openCursor(e,t)];case 1:return(n=r.sent())?[2,new O(this.mode,n,null!=t?t:"next")]:[2,null]}}))}))},e.prototype.initWriteFun=function(e){var t=this;e===P.pF.VERSION_CHANGE&&(this.createIndex=this.createIndexFun,this.deleteIndex=function(e){return t.getProxyObjectStoreWithMode().deleteIndex(e)}),e!==P.pF.READ_ONLY&&(this.delete=function(e){return t.getProxyObjectStoreWithMode().delete(e)},this.bulkDelete=function(e){throw new Error("bulkDelete Method is not support for IDB.")},this.clear=function(){return t.getProxyObjectStoreWithMode().clear()},this.insert=function(e){return t.getProxyObjectStoreWithMode().add(e)},this.upsert=function(e){return t.getProxyObjectStoreWithMode().put(e)},this.bulkUpsert=function(e){var n=t.getProxyObjectStoreWithMode(),r=e.reduce((function(e,t){return e.push(n.put(t)),e}),[]);return Promise.all(r)})},e.prototype.createIndexFun=function(e,t,n){var r=this.getProxyObjectStoreWithMode();return new D(this,r.createIndex(e,t,n),this.mode)},e.prototype.getProxyObjectStoreWithMode=function(){return this.objectStore},e.prototype.applyAspectPatch=function(){var e,t=null===(e=this.engineAspects)||void 0===e?void 0:e.table;if(this.mode===P.pF.READ_ONLY)return null==t||t.get.patch(this,"get"),null==t||t.getAll.patch(this,"getAll"),null==t||t.getAllKeys.patch(this,"getAllKeys"),null==t||t.index.patch(this,"index"),void(null==t||t.openCursor.patch(this,"openCursor"));this.mode===P.pF.VERSION_CHANGE&&(null==t||t.createIndex.patch(this,"createIndex"),null==t||t.deleteIndex.patch(this,"deleteIndex")),null==t||t.delete.patch(this,"delete"),null==t||t.insert.patch(this,"insert"),null==t||t.upsert.patch(this,"upsert"),null==t||t.bulkUpsert.patch(this,"bulkUpsert"),null==t||t.clear.patch(this,"clear")},e}(),A=function(){function e(e,t){this.proxyTransaction=e,this.engineAspects=t,this.tables=e.objectStoreNames,this.mode=e.mode,(null==t?void 0:t.transaction)&&this.applyAspectPatch()}return e.prototype.table=function(e){var t=this.proxyTransaction.objectStore(e);return new M(this.mode,t,this.engineAspects,this)},e.prototype.commit=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.proxyTransaction.done];case 1:return e.sent(),[3,3];case 2:return e.sent(),[2,!1];case 3:return[2,!0]}}))}))},e.prototype.rollback=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return e.trys.push([0,1,,6]),this.proxyTransaction.abort(),[3,6];case 1:e.sent(),e.label=2;case 2:return e.trys.push([2,4,,5]),[4,this.proxyTransaction.done];case 3:return e.sent(),[3,5];case 4:return e.sent(),[2,!0];case 5:return[2,!1];case 6:return[2,!0]}}))}))},e.prototype.applyAspectPatch=function(){var e,t=null===(e=this.engineAspects)||void 0===e?void 0:e.transaction,n=this;null==t||t.commit.patch(n,"commit"),null==t||t.rollback.patch(n,"rollback"),null==t||t.table.patch(n,"table")},e}(),L=function(){function e(e,t){this.idbDatabase=e,this.engineAspect=t,this.name=e.name,this.version=e.version,this.tableNames=(0,i.__spreadArray)([],(0,i.__read)(e.objectStoreNames)),this.engineAspect&&this.applyAspectPatch()}return e.prototype.setVersionChangeListener=function(e){this.idbDatabase.addEventListener("versionchange",(function(t){e(t.oldVersion,t.newVersion)}))},e.prototype.close=function(){this.idbDatabase.close()},e.prototype.createTable=function(e,t){var n=this.idbDatabase.createObjectStore(e,t);return new M(P.pF.VERSION_CHANGE,n)},e.prototype.deleteTable=function(e){this.idbDatabase.deleteObjectStore(e)},e.prototype.transaction=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n;return(0,i.__generator)(this,(function(r){return n=this.idbDatabase.transaction(e,t),[2,new A(n,this.engineAspect)]}))}))},e.prototype.table=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o;return(0,i.__generator)(this,(function(i){return n=this.idbDatabase.transaction([e],t),r=new A(n),o=n.objectStore(e),[2,new M(t,o,this.engineAspect,r)]}))}))},e.prototype.applyAspectPatch=function(){var e,t=null===(e=this.engineAspect)||void 0===e?void 0:e.database;null==t||t.deleteTable.patch(this,"deleteTable"),null==t||t.createTable.patch(this,"createTable"),null==t||t.transaction.patch(this,"transaction"),null==t||t.table.patch(this,"table"),null==t||t.close.patch(this,"close")},e}(),N=function(e,t){var n=typeof e,r=typeof t;if(isNaN(e)||isNaN(t))return indexedDB.cmp(e,t);if(n===r){if("number"===n||"bigint"===n)return e-t;if("string"===n)return function(e,t){return e<t?-1:+(e>t)}(e,t)}return e instanceof Date&&t instanceof Date?e.getTime()-t.getTime():indexedDB.cmp(e,t)},B=n(26660).sH.withDefaultMessage("IndexedDB is missing in global context. Consider using `indexeddbshim` for better compatibility or `fake-indexeddb` in your test environment."),F=function(){function e(){if("undefined"==typeof indexedDB)throw new B;this.cmp=N}return e.prototype.deleteDB=function(e){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){return[2,w(e)]}))}))},e.prototype.setAspects=function(e){this.engineAspects=e,this.engineAspects.openDB.patch(this,"openDB"),this.engineAspects.deleteDB.patch(this,"deleteDB")},e.prototype.openDB=function(e,t,n,r){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,o=this;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,S(e,n,{upgrade:function(e,t,n,i){var a;null===(a=null==r?void 0:r.upgrade)||void 0===a||a.call(r,new L(e,o.engineAspects),t,n,new A(i))},blocked:function(){var e;return null===(e=null==r?void 0:r.blocked)||void 0===e?void 0:e.call(r)},blocking:function(){var e;return null===(e=null==r?void 0:r.blocking)||void 0===e?void 0:e.call(r)},terminated:function(){var e;return null===(e=null==r?void 0:r.terminated)||void 0===e?void 0:e.call(r)}})];case 1:return t=i.sent(),[2,new L(t,this.engineAspects)]}}))}))},e}()},53581:function(e,t,n){n.r(t),n.d(t,{DataActionType:function(){return s.cg},KeyCompareOp:function(){return s.zU},KeyGenerator:function(){return s.uZ},MIGRATION_ASSIST_TABLE_SCHEMA:function(){return s.O3},Model:function(){return L},QueryAggregateType:function(){return s.yE},QueryExpType:function(){return s.Kl},SchemaActionType:function(){return s.g6},SchemaDiffUtils:function(){return s.Ze},SortOrder:function(){return s.As},StorageError:function(){return r},StorageEvent:function(){return o},TransactionMode:function(){return s.pF},UNLIMITED:function(){return s.q9},WhereOperator:function(){return s.qW},default:function(){return Tt},equalsKeyPaths:function(){return s.IA},field:function(){return I},getKeyByPath:function(){return s.zV},index:function(){return O},isKey:function(){return s.ot},primary:function(){return k},table:function(){return P}});var r={};n.r(r),n.d(r,{CollectionNotFoundError:function(){return u},DataMigrationError:function(){return d},DatabaseConnectError:function(){return l},DatabaseInternalError:function(){return m},DatabaseUnexpectedClosedError:function(){return E},EmptyTableInfoError:function(){return f},ExecuteDataUpgradeError:function(){return w},IncorrectTransactionModeError:function(){return p},InvalidWhereInValueError:function(){return g},NoTableInfoError:function(){return h},OrderByKeyError:function(){return y},PluginError:function(){return _},QueryJobError:function(){return b},TransactionCommitError:function(){return C},UnsupportedWhereOperatorError:function(){return v},UpdateMigrationChangeInfoError:function(){return S}});var o,i,a=n(85556),s=n(5358),c=n(26660),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.isQuotaExceeded=function(){return this.message.includes("QuotaExceededError")},t}(c.sH.withMessageCreator("DatabaseConnectError",(function(e){return"failed to connect to database '"+e+"'."}))),u=c.sH.withMessageCreator("CollectionNotFoundError",(function(e){return"model '"+e+"' is not registered, please register it before use it."})),d=c.sH.withMessageCreator("DataMigrationError",(function(e){return"failed to perform data migration, versionChange: "+e.oldVersion+" -> "+e.newVersion+"."})),p=c.sH.withMessageCreator("IncorrectTransactionModeError",(function(e){return"use error transaction type["+e+"]."})),h=c.sH.withMessageCreator("NoTableInfoError",(function(e){return"'"+e+"' is not a valid model with table info injected, please ensure the model class is decorated by @table(), @field() etc."})),f=c.sH.withDefaultMessage("EmptyTableInfoError","table without any field declare, please define model use [field] decorator."),g=c.sH.withMessageCreator("InvalidWhereInValueError",(function(e){return"there is an error in your where clause of field '"+e.path+"'."+e.op+", the value must be an array."})),v=c.sH.withMessageCreator("UnsupportedWhereOperatorError",(function(e){return"unsupported where operator '"+e+"', current supported operators are >, >=, <, <=, =, !=, in, nin."})),y=c.sH.withDefaultMessage("OrderByKeyError","can not order value that is not Key: 'Key = number | string | Date | BufferSource | Key[]'."),m=c.sH.withMessageCreator("DatabaseInternalError",(function(e){return"there is an internal error of database, reason: "+e+"."})),b=c.sH.withMessageCreator("QueryJobError",(function(e){return"failed to execute query job, reason: "+e+"."})),_=c.sH.withMessageCreator("PluginError",(function(e){return'an error has occurred on plugin "'+e.name+'"": '+e.message+"."})),C=c.sH.withDefaultMessage("TransactionCommitError","failed to commit transaction."),S=c.sH.withDefaultMessage("UpdateMigrationChangeInfoError","failed to update migration change info"),w=c.sH.withMessageCreator("ExecuteDataUpgradeError",(function(e){return"failed to execute data upgrade on collection '"+e+"'."})),E=c.sH.withMessageCreator("UnexpectedClosedError",(function(e){return"database "+e+" is unexpectedly closed by browser, this could happen when disk is unavailable or the page is shutdown."})),x=Symbol.for("TABLE_KEY"),T=function(){function e(){}return e.saveTableInfo=function(e,t){Object.defineProperty(t,x,{configurable:!0,value:(0,a.__assign)({},e)})},e.getTableInfo=function(e){return e[x]},e.getFirstTableInfoAlongPrototypeChain=function(e){var t=this.getTableInfo(e),n=Object.assign({},t);return n.properties=new Map(n.properties),n},e.getTableName=function(e){var t=this.getTableInfo(e.prototype);if(!(null==t?void 0:t.tableName))throw new h(e.name);return t.tableName},e.addTablePropertyInfo=function(t,n){var r=e.getOrCreateTableInfo(t);if(r.properties.has(n.name)){var o=r.properties.get(n.name);Object.assign(n,o)}r.properties.set(n.name,n),this.saveTableInfo(r,t)},e.createPropertyInfo=function(e,t){return{name:e,alias:t,isUnionKey:!1}},e.convertTableInfoToSchema=function(e){if(!e.tableName)return null;var t,n=(0,a.__spreadArray)([],(0,a.__read)(e.properties.values())),r=n.filter((function(e){return e.isIndex})).map((function(e){var t,n;return{name:null!==(t=e.alias)&&void 0!==t?t:e.name,path:null!==(n=e.alias)&&void 0!==n?n:e.name,unique:e.isUnique}}));return t=!e.autoIncrement&&e.keyPath?{path:1===e.keyPath.length?e.keyPath[0]:e.keyPath}:{generator:s.uZ.AutoIncrement},{properties:n.map((function(e){var t;return null!==(t=e.alias)&&void 0!==t?t:e.name})),indices:r,key:t,name:e.tableName}},e.createDefaultTableInfo=function(){return{tableName:null,autoIncrement:!0,properties:new Map}},e.getOrCreateTableInfo=function(t){if(Object.prototype.hasOwnProperty.call(t,x))return t[x];var n=e.createDefaultTableInfo(),r=t[x];return r&&(n.properties=new Map((0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(r.properties)),(0,a.__read)(n.properties)))),e.saveTableInfo(n,t),n},e}(),R=T,I=function(e){return function(t,n){var r=R.createPropertyInfo(n,e);R.addTablePropertyInfo(t,r)}},P=function(e,t){return function(n){var r=R.getFirstTableInfoAlongPrototypeChain(n.prototype);if(!r)throw new f;r.tableName=e;var o=(0,a.__spreadArray)([],(0,a.__read)(r.properties.values())),i=function(e,t){if(null==e?void 0:e.key)return"string"==typeof e.key?[e.key]:e.key;var n=t.filter((function(e){return e.isPrimaryKey})).map((function(e){var t;return null!==(t=e.alias)&&void 0!==t?t:e.name}));return n.length>0?n:void 0}(t,o);r.keyPath=i,r.autoIncrement=void 0===r.keyPath,R.saveTableInfo(r,n.prototype)}},O=function(e){return function(t,n){var r=R.createPropertyInfo(n);r.isIndex=!0,r.isUnique=!!(null==e?void 0:e.unique),R.addTablePropertyInfo(t,r)}},k=function(){return function(e,t){var n=R.createPropertyInfo(t);n.isPrimaryKey=!0,R.addTablePropertyInfo(e,n)}},D=n(13861);!function(e){e.Ready="Ready",e.Fetal="Fetal",e.Closed="Closed",e.Destroyed="Destroyed",e.Error="Error",e.RegisterModel="RegisterModel",e.RegisterPlugin="RegisterPlugin",e.BootstrapStart="BootstrapStart",e.BootstrapEnd="BootstrapEnd",e.SchemaMigrationStart="SchemaMigrationStart",e.SchemaMigrationEnd="SchemaMigrationEnd",e.VersionChange="VersionChange"}(o||(o={})),function(e){e.CollectionCreated="CollectionCreated",e.ModelLazyMigrationEnd="ModelLazyMigrationEnd",e.PrepareAutoUpgradeEnd="PrepareAutoUpgradeEnd",e.UpdateMigrationChangeInfo="UpdateMigrationChangeInfoEnd",e.StartTransaction="StartTransaction"}(i||(i={}));var M,A=function(){function e(e){var t=this;this.onClosed=function(e){t.eventBus.on(o.Closed,e)},this.eventBus=e}return e.prototype.onReady=function(e){this.eventBus.on(o.Ready,e)},e.prototype.onFetal=function(e){this.eventBus.on(o.Fetal,e)},e.prototype.onError=function(e){this.eventBus.on(o.Error,e)},e.prototype.onRegisterModel=function(e){this.eventBus.on(o.RegisterModel,e)},e.prototype.onRegisterPlugin=function(e){this.eventBus.on(o.RegisterPlugin,e)},e.prototype.onBootstrapStart=function(e){this.eventBus.on(o.BootstrapStart,e)},e.prototype.onBootstrapEnd=function(e){this.eventBus.on(o.BootstrapEnd,e)},e.prototype.onSchemaMigrationStart=function(e){this.eventBus.on(o.SchemaMigrationStart,e)},e.prototype.onSchemaMigrationEnd=function(e){this.eventBus.on(o.SchemaMigrationEnd,e)},e.prototype.onVersionChange=function(e){this.eventBus.on(o.VersionChange,e)},e.prototype.emitError=function(e){this.eventBus.emit(o.Error,e)},e}(),L=function(){function e(){}return e.revealSchema=function(e){var t=R.getTableInfo(e.prototype);return t?R.convertTableInfoToSchema(t):null},e}(),N=function(){function e(e){this.models=[],this.eventBus=e}return e.prototype.register=function(e){if(!this.models.includes(e)){var t=this.getSchema(e);this.models.push(e),this.eventBus.emit(o.RegisterModel,{class:e,schema:t})}},e.prototype.getSchema=function(e){var t=L.revealSchema(e);if(!t){var n=new h(e.name);throw this.eventBus.emit(o.Error,n),new h(e.name)}return t},e.prototype.getSchemaAndRegisterModelIfNeed=function(e){return this.register(e),this.getSchema(e)},e}();function B(e){var t,n,r,o=R.getTableInfo(Object.getPrototypeOf(e));if(!o)return e;var i={};try{for(var s=(0,a.__values)(o.properties.values()),c=s.next();!c.done;c=s.next()){var l=c.value;i[null!==(r=l.alias)&&void 0!==r?r:l.name]=e[l.name]}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return i}function F(e,t){var n,r;if(null==e)return null;var o=R.getTableInfo(t.prototype);if(!o)return e;var i=function(e,t){var n,r,o,i={};try{for(var s=(0,a.__values)(t.properties.values()),c=s.next();!c.done;c=s.next()){var l=c.value,u=null!==(o=l.alias)&&void 0!==o?o:l.name;i[l.name]=e[u]}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return i}(e,o),s=new t(i);try{for(var c=(0,a.__values)(Object.keys(i)),l=c.next();!l.done;l=c.next()){var u=l.value;void 0!==i[u]&&(s[u]=i[u])}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return s}!function(e){e.FILL="fill",e.HYDRATE="hydrate",e.PAGINATE="paginate",e.FILTER="filter",e.SORT="sort",e.SCAN="scan",e.SCAN_ALL="scan-all",e.INDEX_SCAN="index-scan",e.UNION="union",e.DISTINCT="distinct",e.INTERSECT="intersect"}(M||(M={}));var U=function(){function e(e,t){this.node=e,this.parent=t,this.context=ie(e)}return e.prototype.perform=function(e){return(0,a.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o,i;return(0,a.__generator)(this,(function(s){try{for(t=(0,a.__values)(this.node.inputs),n=t.next();!n.done;n=t.next())r=n.value,e.push(r)}catch(e){o={error:e}}finally{try{n&&!n.done&&(i=t.return)&&i.call(t)}finally{if(o)throw o.error}}return[2]}))}))},e}(),H=function(){function e(e){this.comparer=e}return e.prototype.has=function(e,t){return-1!==this.getOrder(e,t)},e.prototype.getOrder=function(e,t){for(var n=0,r=e.length;n<r;){var o=n+Math.floor((r-n)/2),i=e[o],a=this.comparer.cmp(t,i);if(0===a)return o;a>0?n=o+1:r=o}return-1},e}(),j=function(){function e(e,t){this.node=e,this.parent=t,this.context=ie(e)}return e.prototype.perform=function(e){return(0,a.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o,i,s,c,l,u,d,p,h,f,g,v,y,m;return(0,a.__generator)(this,(function(b){t=new H(this.node.comparer);try{for(n=(0,a.__values)(this.context.inputs),r=n.next();!r.done;r=n.next()){o=r.value,i=new Map,s=o.map((function(e){return(0,a.__read)(e,1)[0]})).sort(this.node.comparer.cmp),c=[];try{for(y=void 0,l=(0,a.__values)(o),u=l.next();!u.done;u=l.next())d=u.value,p=(0,a.__read)(d,1),h=p[0],f=t.getOrder(s,h),i.has(f)||(i.set(f,!0),c.push(d))}catch(e){y={error:e}}finally{try{u&&!u.done&&(m=l.return)&&m.call(l)}finally{if(y)throw y.error}}e.push(c)}}catch(e){g={error:e}}finally{try{r&&!r.done&&(v=n.return)&&v.call(n)}finally{if(g)throw g.error}}return[2]}))}))},e}(),G=j,V=Symbol("-"),W=Symbol("+"),z=function(){function e(e){var t=this;this.contains=function(e,n){var r=t,o=r.cmp,i=r.lowerOf,a=r.upperOf;if(!t.isValid(e))return!1;var s=e.lowerOpen,c=e.upperOpen,l=o(i(e),n),u=o(a(e),n);return 0===l&&!s||l<0&&u>0||0===u&&!c},this.union=function(e){if(e.length<=1)return e;t.sort(e);for(var n=[],r=e[0],o=1;o<e.length;o++){var i=e[o];t.isOverlapped(r,i)?r=t.wrap(r,i):(n.push(r),r=i)}return n.push(r),n},this.intersect=function(e){var n,r;if(e.length<=1)return e;t.sort(e);var o=e[0];try{for(var i=(0,a.__values)(e),s=i.next();!s.done;s=i.next()){var c=s.value;if(!t.isOverlapped(o,c))return[];o=t.overlap(o,c)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return[o]},this.isValid=function(e){var n=t,r=n.cmp,o=n.lowerOf,i=n.upperOf,a=r(o(e),i(e));return a<0||0===a&&!e.lowerOpen&&!e.upperOpen},this.cmp=function(e,n){return e!==V&&e!==W&&n!==V&&n!==W?t.comparer.cmp(e,n):e===n?0:e===V||n===W?-1:1},this.lowerOf=function(e){return void 0===e.lower?V:e.lower},this.upperOf=function(e){return void 0===e.upper?W:e.upper},this.comparer=e}return e.prototype.isOverlapped=function(e,t){var n,r=this,o=r.cmp,i=r.lowerOf,s=r.upperOf,c=(0,a.__read)([e,t],2),l=c[0],u=c[1],d=o(i(l),i(u));(d>0||0===d&&!l.lowerOpen&&u.lowerOpen)&&(l=(n=(0,a.__read)([u,l],2))[0],u=n[1]);var p=o(s(l),i(u));return p>0||0===p&&!l.upperOpen&&!u.lowerOpen},e.prototype.sort=function(e){var t=this.cmp,n=this.lowerOf;return e.sort((function(e,r){var o=t(n(e),n(r));return 0!==o||e.lowerOpen===r.lowerOpen?o:e.lowerOpen?-1:1}))},e.prototype.wrap=function(e,t){var n=this,r=n.cmp,o=n.lowerOf,i=n.upperOf,s=(0,a.__assign)({},e),c=r(o(e),o(t)),l=r(i(e),i(t));return(c>0||0===c&&!t.lowerOpen)&&(s.lower=t.lower,s.lowerOpen=t.lowerOpen),(l<0||0===l&&!t.upperOpen)&&(s.upper=t.upper,s.upperOpen=t.upperOpen),s},e.prototype.overlap=function(e,t){var n=this,r=n.cmp,o=n.lowerOf,i=n.upperOf,s=(0,a.__assign)({},e),c=r(o(e),o(t)),l=r(i(e),i(t));return(c<0||0===c&&!e.lowerOpen)&&(s.lower=t.lower,s.lowerOpen=t.lowerOpen),(l>0||0===l&&!e.upperOpen)&&(s.upper=t.upper,s.upperOpen=t.upperOpen),s},e}(),K=function(){function e(e,t){this.node=e,this.parent=t,this.context=ie(e)}return e.prototype.perform=function(e){return(0,a.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o,i,s,c,l,u;return(0,a.__generator)(this,(function(d){for(t=[],n=this.node,r=[t];n;)n.regroup&&(t=[],r.push(t)),t.push(this.createFilter(n)),n=n.nextFilter;o=function(e){var t=(0,a.__read)(e,2)[1];return r.some((function(e){return e.every((function(e){return e(t)}))}))};try{for(i=(0,a.__values)(this.context.inputs),s=i.next();!s.done;s=i.next())c=s.value,e.push(c.filter(o))}catch(e){l={error:e}}finally{try{s&&!s.done&&(u=i.return)&&u.call(i)}finally{if(l)throw l.error}}return[2]}))}))},e.prototype.createFilter=function(e){var t=new z(e.comparer);return function(n){return e.intervals.some((function(r){if(void 0===n)throw new m("can not do filter on non-hydrated data");var o=(0,s.zV)(n,e.path);return(0,s.ot)(o)&&t.contains(r,o)}))}},e}(),q=function(){function e(e,t,n){this.node=e,this.parent=t,this.transaction=n,this.context=ie(e)}return e.prototype.perform=function(e){return(0,a.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o,i,s,c,l,u=this;return(0,a.__generator)(this,(function(d){switch(d.label){case 0:t=this.transaction.table(this.node.collectionSchema.name),n=function(n){var r;return(0,a.__generator)(this,(function(o){switch(o.label){case 0:return r=n.filter((function(e){return!function(e){return!!(0,a.__read)(e,2)[1]}(e)})),[4,Promise.all(r.map((function(e,n){var o=(0,a.__read)(e,1)[0];return(0,a.__awaiter)(u,void 0,void 0,(function(){var e;return(0,a.__generator)(this,(function(i){switch(i.label){case 0:return[4,t.get(o)];case 1:return e=i.sent(),r[n][1]=e,[2]}}))}))})))];case 1:return o.sent(),e.push(n),[2]}}))},d.label=1;case 1:d.trys.push([1,6,7,8]),r=(0,a.__values)(this.context.inputs),o=r.next(),d.label=2;case 2:return o.done?[3,5]:(i=o.value,[5,n(i)]);case 3:d.sent(),d.label=4;case 4:return o=r.next(),[3,2];case 5:return[3,8];case 6:return s=d.sent(),c={error:s},[3,8];case 7:try{o&&!o.done&&(l=r.return)&&l.call(r)}finally{if(c)throw c.error}return[7];case 8:return[2]}}))}))},e}(),Y=function(){function e(e,t,n,r){this.lower=e,this.upper=t,this.lowerOpen=n,this.upperOpen=r}return e.getKeyRange=function(e,t){if(void 0!==t){if(!e.isValid(t))throw new Error("invalid key interval");var n=t.lower,r=t.upper,o=t.lowerOpen,i=t.upperOpen;return n===r?n:void 0!==n&&void 0!==r?IDBKeyRange.bound(n,r,o,i):void 0!==n?IDBKeyRange.lowerBound(n,o):IDBKeyRange.upperBound(r,i)}},e}(),Q=function(){function e(e,t){var n=this;this.comparer=t,this.math=new z(t),this.intervals=e.filter((function(e){return n.math.isValid(e)}))}return e.fromWherePredicate=function(t,n){var r,o,i;try{for(var s=(0,a.__values)(Object.keys(t)),c=s.next();!c.done;c=s.next()){var l=c.value,u=t[l];if(void 0!==u){var d=e.fromWhereExp(l,u,n);i=i?i.intersect(d):d}}}catch(e){r={error:e}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}return i||this.createFullGroup(n)},e.fromWhereExp=function(t,n,r){var o;if(t===s.qW.In||t===s.qW.NotIn){if(!Array.isArray(n))throw new g({op:t});var i=n;return t===s.qW.In?i.reduce((function(t,n){return t.union(e.fromWhereExp(s.qW.Equals,n,r))}),this.createEmptyGroup(r)):i.reduce((function(t,n,o){var i=e.fromWhereExp(s.qW.NotEquals,n,r);return o?t.intersect(i):i}),this.createFullGroup(r))}switch(t){case s.qW.Equals:o=[new Y(n,n,!1,!1)];break;case s.qW.NotEquals:o=[new Y(void 0,n,!0,!0),new Y(n,void 0,!0,!0)];break;case s.qW.GreaterThan:o=[new Y(n,void 0,!0,!0)];break;case s.qW.GreaterOrEqualThan:o=[new Y(n,void 0,!1,!0)];break;case s.qW.LessThan:o=[new Y(void 0,n,!0,!0)];break;case s.qW.LessOrEqualThan:o=[new Y(void 0,n,!0,!1)];break;default:throw new v(t)}return new e(o,r)},e.prototype.union=function(t){return new e(this.math.union((0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(this.intervals)),(0,a.__read)(t.intervals))),this.comparer)},e.prototype.intersect=function(t){for(var n=this.math,r=n.cmp,o=n.upperOf,i=n.lowerOf,s=n.intersect,c=(0,a.__read)([this.intervals,t.intervals],2),l=c[0],u=c[1],d=(0,a.__read)([0,0],2),p=d[0],h=d[1],f=[];p<l.length;){for(;h<u.length&&r(o(l[p]),i(u[h]))>=0;){var g=s([l[p],u[h]]);f.push.apply(f,(0,a.__spreadArray)([],(0,a.__read)(g))),h+=1}h-=1,p+=1}return new e(f,this.comparer)},e.prototype.contains=function(e){var t=this;return!!this.intervals.find((function(n){return t.math.contains(n,e)}))},e.prototype.isEmpty=function(){return 0===this.intervals.length},e.prototype.isFull=function(){return!!this.intervals.length&&void 0===this.intervals[0].lower&&void 0===this.intervals[0].upper},e.createFullGroup=function(t){return new e([new Y(void 0,void 0,!0,!0)],t)},e.createEmptyGroup=function(t){return new e([],t)},e}(),Z=Y,X=function(){function e(e,t,n){this.node=e,this.parent=t,this.transaction=n,this.context=ie(e)}return e.prototype.perform=function(e){return(0,a.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o,i;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return this.node.hydrate?[3,2]:[4,this.scanKeys()];case 1:return t=a.sent(),e.push(t.map((function(e){return[e,void 0]}))),[2];case 2:return(n=this.node.collectionSchema.key.path)?[4,this.scanValues()]:[3,4];case 3:return r=a.sent(),e.push(r.map((function(e){return[(0,s.zV)(e,n),e]}))),[2];case 4:return[4,this.scanKeys()];case 5:return o=a.sent(),[4,this.scanValues()];case 6:return i=a.sent(),e.push(o.map((function(e,t){return[e,i[t]]}))),[2]}}))}))},e.prototype.scanKeys=function(){return(0,a.__awaiter)(this,void 0,void 0,(function(){var e,t;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return e=this.getKeyQueries(),t=this.getIndex(),[4,Promise.all(e.map((function(e){return t.getAllKeys(e)})))];case 1:return[2,n.sent().reduce((function(e,t){return e.push.apply(e,(0,a.__spreadArray)([],(0,a.__read)(t))),e}),[])]}}))}))},e.prototype.scanValues=function(){return(0,a.__awaiter)(this,void 0,void 0,(function(){var e,t;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return e=this.getKeyQueries(),t=this.getIndex(),[4,Promise.all(e.map((function(e){return t.getAll(e)})))];case 1:return[2,n.sent().reduce((function(e,t){return e.push.apply(e,(0,a.__spreadArray)([],(0,a.__read)(t))),e}),[])]}}))}))},e.prototype.getKeyQueries=function(){var e=new z(this.node.comparer);return this.node.intervals.map((function(t){return Z.getKeyRange(e,t)}))},e.prototype.getIndex=function(){var e=this.node,t=e.collectionSchema,n=e.index;return this.transaction.table(t.name).index(n.name)},e}(),J=X,$=function(){function e(e,t){this.node=e,this.parent=t,this.context=ie(e)}return e.prototype.perform=function(e){return(0,a.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o,i,s,c,l,u,d,p,h,f;return(0,a.__generator)(this,(function(g){if(n=(t=this).context,r=t.node,!(o=n.inputs).length)return[2];if(1===o.length)return e.push(o[0]),[2];i=function(e,t){var n=(0,a.__read)(e,1)[0],o=(0,a.__read)(t,1)[0];return r.comparer.cmp(n,o)},s=new H({cmp:i}),c=this.getSmallestPointers(o).slice();try{for(l=(0,a.__values)(o),u=l.next();!u.done;u=l.next())u.value.sort(i)}catch(e){h={error:e}}finally{try{u&&!u.done&&(f=l.return)&&f.call(l)}finally{if(h)throw h.error}}return d=function(e){return o.every((function(t){return s.has(t,e)}))},p=c.filter(d),e.push(p),[2]}))}))},e.prototype.getSmallestPointers=function(e){return e.reduce((function(e,t){return e.length<t.length?e:t}),this.context.inputs[0])},e}(),ee=function(){function e(e,t){this.node=e,this.parent=t,this.context=ie(e)}return e.prototype.perform=function(e){return(0,a.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o,i,s,c,l;return(0,a.__generator)(this,(function(u){t=this.node,n=t.offset,r=t.limit;try{for(o=(0,a.__values)(this.context.inputs),i=o.next();!i.done;i=o.next())s=i.value,e.push(s.slice(n,!r||isNaN(r)?void 0:n+r))}catch(e){c={error:e}}finally{try{i&&!i.done&&(l=o.return)&&l.call(o)}finally{if(c)throw c.error}}return[2]}))}))},e}(),te=function(){function e(e,t,n){this.node=e,this.parent=t,this.transaction=n,this.context=ie(e)}return e.prototype.perform=function(e){return(0,a.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o,i;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return this.node.hydrate?[3,2]:[4,this.scanKeys()];case 1:return t=a.sent(),e.push(t.map((function(e){return[e,void 0]}))),[2];case 2:return(n=this.node.collectionSchema.key.path)?[4,this.scanValues()]:[3,4];case 3:return r=a.sent(),e.push(r.map((function(e){return[(0,s.zV)(e,n),e]}))),[2];case 4:return[4,this.scanKeys()];case 5:return o=a.sent(),[4,this.scanValues()];case 6:return i=a.sent(),e.push(o.map((function(e,t){return[e,i[t]]}))),[2]}}))}))},e.prototype.scanKeys=function(){return(0,a.__awaiter)(this,void 0,void 0,(function(){var e,t;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return e=this.getKeyQueries(),t=this.getTable(),[4,Promise.all(e.map((function(e){return t.getAllKeys(e)})))];case 1:return[2,n.sent().reduce((function(e,t){return e.push.apply(e,(0,a.__spreadArray)([],(0,a.__read)(t))),e}),[])]}}))}))},e.prototype.scanValues=function(){return(0,a.__awaiter)(this,void 0,void 0,(function(){var e,t;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return e=this.getKeyQueries(),t=this.getTable(),[4,Promise.all(e.map((function(e){return t.getAll(e)})))];case 1:return[2,n.sent().reduce((function(e,t){return e.push.apply(e,(0,a.__spreadArray)([],(0,a.__read)(t))),e}),[])]}}))}))},e.prototype.getKeyQueries=function(){var e=new z(this.node.comparer);return this.node.type===M.SCAN_ALL?[void 0]:this.node.intervals.map((function(t){return Z.getKeyRange(e,t)}))},e.prototype.getTable=function(){var e=this.node.collectionSchema;return this.transaction.table(e.name)},e}(),ne=te,re=function(){function e(e,t){this.node=e,this.parent=t,this.context=ie(e)}return e.prototype.perform=function(e){return(0,a.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o,i,c,l,u,d,p=this;return(0,a.__generator)(this,(function(h){t=this.node,n=t.comparer,r=t.path,o=t.order;try{for(i=(0,a.__values)(this.context.inputs),c=i.next();!c.done;c=i.next())(l=c.value).sort((function(e,t){var i=(0,a.__read)(e,2)[1],c=(0,a.__read)(t,2)[1],l=(0,s.zV)(i,r),u=(0,s.zV)(c,r),d=p.getComparerByType(n,o);if((0,s.ot)(l)&&(0,s.ot)(u))return d(l,u);throw new y})),e.push(l)}catch(e){u={error:e}}finally{try{c&&!c.done&&(d=i.return)&&d.call(i)}finally{if(u)throw u.error}}return[2]}))}))},e.prototype.getComparerByType=function(e,t){return t===s.As.ASCENDING?function(t,n){return e.cmp(t,n)}:function(t,n){return-e.cmp(t,n)}},e}(),oe=function(){function e(e,t){this.node=e,this.parent=t,this.context=ie(e)}return e.prototype.perform=function(e){return(0,a.__awaiter)(this,void 0,void 0,(function(){return(0,a.__generator)(this,(function(t){return e.push(this.context.inputs.reduce((function(e,t){return e.push.apply(e,(0,a.__spreadArray)([],(0,a.__read)(t))),e}),[])),[2]}))}))},e}();function ie(e){return{total:e.children.length,done:0,inputs:[]}}var ae=function(){function e(e,t){this.onRequestSuccess=function(){},this.onRequestFailed=function(){},this.request=e,this.transaction=t,this.jobs=new Map}return e.prototype.exec=function(){return(0,a.__awaiter)(this,void 0,void 0,(function(){var e=this;return(0,a.__generator)(this,(function(t){return this.task||(this.task=new Promise((function(t,n){e.onRequestSuccess=function(n){e.reset(),t(n)},e.onRequestFailed=function(t){return(0,a.__awaiter)(e,void 0,void 0,(function(){return(0,a.__generator)(this,(function(e){return this.reset(),n(t),[2]}))}))},e.traverse(e.request.root,(function(t,n){var r=function(e,t,n){var r;return(r={},r[M.FILL]=function(){return new U(e,t)},r[M.DISTINCT]=function(){return new G(e,t)},r[M.FILTER]=function(){return new K(e,t)},r[M.HYDRATE]=function(){return new q(e,t,n)},r[M.INDEX_SCAN]=function(){return new J(e,t,n)},r[M.INTERSECT]=function(){return new $(e,t)},r[M.PAGINATE]=function(){return new ee(e,t)},r[M.SCAN]=function(){return new ne(e,t,n)},r[M.SCAN_ALL]=function(){return new ne(e,t,n)},r[M.SORT]=function(){return new re(e,t)},r[M.UNION]=function(){return new oe(e,t)},r)[e.type]()}(t,n&&e.jobs.get(n)||null,e.transaction);e.jobs.set(t,r),t.children.length||e.beginJob(r).catch((function(t){e.onRequestFailed(t)}))}))}))),[2,this.task]}))}))},e.prototype.beginJob=function(e){var t;return(0,a.__awaiter)(this,void 0,void 0,(function(){var n,r,o=this;return(0,a.__generator)(this,(function(i){switch(i.label){case 0:n=(null===(t=e.parent)||void 0===t?void 0:t.context.inputs)||[],i.label=1;case 1:return i.trys.push([1,3,,4]),[4,e.perform(n)];case 2:return i.sent(),this.finishJob(e,n).catch((function(e){o.onRequestFailed(e)})),[3,4];case 3:return r=i.sent(),this.onRequestFailed(r),[3,4];case 4:return[2]}}))}))},e.prototype.finishJob=function(e,t){return(0,a.__awaiter)(this,void 0,void 0,(function(){var n,r=this;return(0,a.__generator)(this,(function(o){return e.parent&&((n=e.parent.context).done+=1,n.done===n.total&&this.beginJob(e.parent).catch((function(e){r.onRequestFailed(e)}))),e.node===this.request.root&&this.onRequestSuccess(t),[2]}))}))},e.prototype.reset=function(){this.jobs=new Map,this.task=void 0,this.onRequestSuccess=function(){},this.onRequestFailed=function(){}},e.prototype.traverse=function(e,t,n){var r,o;t(e,n);try{for(var i=(0,a.__values)(e.children),s=i.next();!s.done;s=i.next()){var c=s.value;this.traverse(c,t,e)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}},e}(),se=function(){function e(e){this.comparer=e}return e.prototype.rewrite=function(e){return{offset:e.offset,limit:e.limit,order:e.order&&(0,a.__assign)({},e.order),exp:this.rewriteWhereClauses(e.whereClauses)}},e.prototype.rewriteWhereClauses=function(e){var t,n,r,o,i;if(!e.length)return{type:s.Kl.ALL};var c={type:s.Kl.OR,exps:[]};try{for(var l=(0,a.__values)(e),u=l.next();!u.done;u=l.next()){var d=u.value,p={type:s.Kl.AND,exps:[]};try{for(var h=(r=void 0,(0,a.__values)(Object.entries(d))),f=h.next();!f.done;f=h.next()){var g=(0,a.__read)(f.value,2),v=g[0],y=g[1];if(void 0!==y){var m=(0,s.ot)(y)?((i={})[s.qW.Equals]=y,i):y;this.isEmptyPredicate(m)||p.exps.push({type:s.Kl.FILTER,predicate:m,path:v,hints:{intervalGroup:Q.fromWherePredicate(m,this.comparer),isKey:!1,indices:[]}})}}}catch(e){r={error:e}}finally{try{f&&!f.done&&(o=h.return)&&o.call(h)}finally{if(r)throw r.error}}c.exps.push(p)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}return c},e.prototype.isEmptyPredicate=function(e){return Object.values(e).every((function(e){return void 0===e}))},e}(),ce=function(){function e(e){this.schema=e,this.indicesMap=new Map,this.warmupIndicesMap()}return e.prototype.bind=function(e){return this.bindQueryHints(e.exp),e},e.prototype.bindQueryHints=function(e){var t,n=this,r=e;r.type!==s.Kl.AND&&r.type!==s.Kl.OR?r.type===s.Kl.FILTER&&(r.hints.isKey=this.schema.key&&(0,s.IA)(this.schema.key.path,r.path),r.hints.indices=null!==(t=this.indicesMap.get(r.path))&&void 0!==t?t:[]):r.exps.forEach((function(e){return n.bindQueryHints(e)}))},e.prototype.warmupIndicesMap=function(){var e,t,n,r,o;try{for(var i=(0,a.__values)(this.schema.indices.entries()),s=i.next();!s.done;s=i.next()){var c=(0,a.__read)(s.value,2),l=c[0],u=c[1];u.priority=null!==(o=u.priority)&&void 0!==o?o:-(l+1);var d=Array.isArray(u.path)?u.path:[u.path];try{for(var p=(n=void 0,(0,a.__values)(d)),h=p.next();!h.done;h=p.next()){var f=h.value,g=this.indicesMap.get(f)||[];g.push(u),this.indicesMap.set(f,g)}}catch(e){n={error:e}}finally{try{h&&!h.done&&(r=p.return)&&r.call(p)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},e}(),le=ce,ue=function(){function e(e,t){this.collectionSchema=e,this.comparer=t}return e.prototype.plan=function(e,t){return{root:this.getRootNode(e,t),aggregate:t}},e.prototype.getRootNode=function(e,t){if(e.exp.type===s.Kl.NONE)return this.getSkipNode();var n=this.getBaseNode(e.exp);return(t===s.yE.ENTRIES||t===s.yE.VALUES||e.order)&&(n=this.getHydrateNode([n])),e.order&&(n=this.getSortNode(e.order.path,e.order.type,[n])),(e.offset||e.limit!==s.q9)&&(n=this.getPaginateNode(e.offset,e.limit,[n])),n=this.getDistinctNode([n])},e.prototype.getBaseNode=function(e){return e.type===s.Kl.ALL?this.getScanAllNode():e.type===s.Kl.NONE?this.getSkipNode():e.type===s.Kl.FILTER?this.getFilterNode(e):this.getLogicExpNode(e)},e.prototype.getLogicExpNode=function(e){var t,n,r=[];try{for(var o=(0,a.__values)(e.exps),i=o.next();!i.done;i=o.next()){var c=i.value;r.push(c.type===s.Kl.FILTER?this.getFilterNode(c):this.getLogicExpNode(c))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return e.type===s.Kl.AND?this.getIntersectNode(r):this.getUnionNode(r)},e.prototype.getFilterNode=function(e){if(!e.path||e.hints.isKey)return this.getScanNode(e.hints.intervalGroup.intervals);var t=e.hints.indices.find((function(t){return(0,s.IA)(t.path,e.path)}));return t?this.getIndexScanNode(e.hints.intervalGroup.intervals,t):this.getMemFilterNode(e.hints.intervalGroup.intervals,e.path)},e.prototype.getIntersectNode=function(e){return{type:M.INTERSECT,comparer:this.comparer,children:e}},e.prototype.getDistinctNode=function(e){return void 0===e&&(e=[]),{type:M.DISTINCT,comparer:this.comparer,children:e}},e.prototype.getUnionNode=function(e){return void 0===e&&(e=[]),{type:M.UNION,children:e}},e.prototype.getHydrateNode=function(e){return void 0===e&&(e=[]),{type:M.HYDRATE,collectionSchema:this.collectionSchema,children:e}},e.prototype.getPaginateNode=function(e,t,n){return void 0===n&&(n=[]),{type:M.PAGINATE,offset:e,limit:t,children:n}},e.prototype.getSortNode=function(e,t,n){return void 0===n&&(n=[]),{type:M.SORT,path:e,order:t,comparer:this.comparer,children:n}},e.prototype.getMemFilterNode=function(e,t,n){return{type:M.FILTER,comparer:this.comparer,path:t,intervals:e,regroup:!1,children:[{type:M.HYDRATE,collectionSchema:this.collectionSchema,children:n||[this.getScanAllNode()]}]}},e.prototype.getIndexScanNode=function(e,t){return{type:M.INDEX_SCAN,collectionSchema:this.collectionSchema,index:t,intervals:e,comparer:this.comparer,children:[]}},e.prototype.getScanNode=function(e){return{type:M.SCAN,collectionSchema:this.collectionSchema,intervals:e,comparer:this.comparer,children:[]}},e.prototype.getScanAllNode=function(){return{type:M.SCAN_ALL,collectionSchema:this.collectionSchema,comparer:this.comparer,children:[]}},e.prototype.getSkipNode=function(){return{type:M.FILL,inputs:[[]],children:[]}},e}(),de=ue,pe=function(){function e(){}return e.prototype.eliminate=function(e){var t=e;return t.exp=this.eliminateExp(e.exp),t},e.prototype.eliminateExp=function(e){return e.type===s.Kl.AND?this.eliminateAndExp(e):e.type===s.Kl.OR?this.eliminateOrExp(e):e.type===s.Kl.FILTER?this.eliminateFilterExp(e):e},e.prototype.eliminateAndExp=function(e){var t,n,r={type:s.Kl.AND,exps:[]};try{for(var o=(0,a.__values)(e.exps),i=o.next();!i.done;i=o.next()){var c=i.value,l=this.eliminateExp(c);if(l.type===s.Kl.NONE)return{type:s.Kl.NONE};l.type!==s.Kl.ALL&&r.exps.push(l)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r.exps.length?1===r.exps.length?r.exps[0]:r:{type:s.Kl.ALL}},e.prototype.eliminateOrExp=function(e){var t,n,r={type:s.Kl.OR,exps:[]};try{for(var o=(0,a.__values)(e.exps),i=o.next();!i.done;i=o.next()){var c=i.value,l=this.eliminateExp(c);if(l.type===s.Kl.ALL)return{type:s.Kl.ALL};l.type!==s.Kl.NONE&&r.exps.push(l)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r.exps.length?1===r.exps.length?e.exps[0]:r:{type:s.Kl.NONE}},e.prototype.eliminateFilterExp=function(e){return e.hints.intervalGroup.isEmpty()?{type:s.Kl.NONE}:e.hints.intervalGroup.isFull()?{type:s.Kl.ALL}:e},e}(),he=function(){var e,t=!1;return function(n,r){if("function"!=typeof n[r])throw new Error("memo() must be decorated on one of function properties of target");Object.defineProperty(n,r,(0,a.__assign)((0,a.__assign)({},Object.getOwnPropertyDescriptor(n,r)),{value:function(){return t||(e=n[r](),t=!0),e}}))}},fe=M.UNION,ge=M.INTERSECT,ve=M.HYDRATE,ye=M.INDEX_SCAN,me=M.SCAN,be=M.SCAN_ALL,_e=M.FILTER;function Ce(e){return Se(e.root),e}function Se(e){var t,n,r=e.children;try{for(var o=(0,a.__values)(r.entries()),i=o.next();!i.done;i=o.next()){var s=(0,a.__read)(i.value,2),c=s[0],l=s[1];if(Se(l),[ge,fe].includes(l.type)&&1===l.children.length){var u=l.children[0];r[c]=u}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}}function we(e){return Ee(e.root),e}function Ee(e){var t,n,r,o,i=e.children;try{for(var s=(0,a.__values)(i.entries()),c=s.next();!c.done;c=s.next()){var l=(0,a.__read)(c.value,2),u=l[0],d=l[1];if(Ee(d),d.type===ve){var p=!1;try{for(var h=(r=void 0,(0,a.__values)(d.children)),f=h.next();!f.done;f=h.next())(g=f.value).type!==me&&g.type!==ye&&g.type!==be||(p=!0,g.hydrate=!0)}catch(e){r={error:e}}finally{try{f&&!f.done&&(o=h.return)&&o.call(h)}finally{if(r)throw r.error}}if(p&&1===d.children.length){var g=d.children[0];i[u]=g}}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}}function xe(e){return e}function Te(e){return Re(e.root),e}function Re(e){var t,n;Ie(e.children,(function(r){if(Re(r),r.type!==_e||!r.children.some((function(e){return e.type===be})))return!0;if(n){var o=r;!function(e,t){for(var n=e;e.nextFilter;)n=e.nextFilter;n.nextFilter=t}(n,o),o.regroup=e.type===fe}else t=r;return n=r,!1})),t&&e.children.push(t)}function Ie(e,t){for(var n=e,r=0,o=n.length-1;r<=o;){var i=n[r];t(i)?r+=1:(n[r]=n[o],n[o]=i,o-=1)}return n.splice(o+1)}function Pe(e){return Oe(e.root),e}function Oe(e){var t,n,r=e.children;try{for(var o=(0,a.__values)(r.entries()),i=o.next();!i.done;i=o.next()){var s=(0,a.__read)(i.value,2),c=s[0],l=s[1];if(Oe(l),l.type===ge){var u=l.children.find((function(e){var t=e.type;return[me,ye].includes(t)}));if(u){var d=Ie(l.children,(function(e){return e.type!==_e}));if(d.length){var p={type:ve,collectionSchema:u.collectionSchema,children:[]};r[c]=Le.apply(void 0,(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(d)),[p,l]))}}}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}}function ke(e){return[s.yE.COUNT,s.yE.KEYS].includes(e.aggregate)||Ae((function(e){e.type!==me&&e.type!==ye||(e.hydrate=!0)}),e.root),e}function De(e){return Ae((function(e){var t,n,r,o,i;if(e.type===ge){var s=Number.MIN_SAFE_INTEGER;try{for(var c=(0,a.__values)(e.children),l=c.next();!l.done;l=c.next()){var u=l.value,d=Number.MIN_SAFE_INTEGER;u.type===me&&(d=0),u.type===ye&&u.index.priority&&(d=u.index.priority),s=Math.max(s,d)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}var p=e.children;try{for(var h=(0,a.__values)(p.entries()),f=h.next();!f.done;f=h.next()){var g=(0,a.__read)(f.value,2),v=g[0];(u=g[1]).type===ye&&(d=null!==(i=u.index.priority)&&void 0!==i?i:Number.MIN_SAFE_INTEGER)<s&&(p[v]=Me(u))}}catch(e){r={error:e}}finally{try{f&&!f.done&&(o=h.return)&&o.call(h)}finally{if(r)throw r.error}}}}),e.root),e}function Me(e){return{path:e.index.path,intervals:e.intervals,comparer:e.comparer,type:M.FILTER,regroup:!1,children:[{type:M.SCAN_ALL,collectionSchema:e.collectionSchema,comparer:e.comparer,hydrate:!0,children:[]}]}}function Ae(e,t,n,r){var o,i;void 0===n&&(n=null),void 0===r&&(r=-1);var s=t.children;try{for(var c=(0,a.__values)(s.entries()),l=c.next();!l.done;l=c.next()){var u=(0,a.__read)(l.value,2),d=u[0];Ae(e,u[1],t,d)}}catch(e){o={error:e}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(o)throw o.error}}e(t,n,r)}function Le(){for(var e,t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=(0,a.__read)(n),i=o[0],s=o.slice(1),c=i;try{for(var l=(0,a.__values)(s),u=l.next();!u.done;u=l.next()){var d=u.value;c.children=[d],c=d}}catch(t){e={error:t}}finally{try{u&&!u.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}return i}var Ne,Be=function(){function e(){}return e.prototype.optimize=function(e){var t=[De,we,Te,Ce,Pe,xe,Ce,we,ke];return this.applyAllRules(t,e)},e.prototype.applyAllRules=function(e,t){return e.reduce((function(e,t){return t(e)}),t)},e}(),Fe=function(){function e(e){void 0===e&&(e=new Map),this.query={offset:0,limit:void 0,order:void 0,whereClauses:[]},this.aliasMap=e}return e.fromRawQuery=function(t,n){var r,o;void 0===n&&(n=new Map);var i=new e(n),s=t.offset,c=t.limit,l=t.order,u=t.whereClauses;i.setOffset(s),i.setLimit(c),l&&i.setOrderBy(l.path,l.type);try{for(var d=(0,a.__values)(u),p=d.next();!p.done;p=d.next()){var h=p.value;i.addWhereClause(h)}}catch(e){r={error:e}}finally{try{p&&!p.done&&(o=d.return)&&o.call(d)}finally{if(r)throw r.error}}return i},e.prototype.setOffset=function(e){this.query.offset=e},e.prototype.setLimit=function(e){this.query.limit=e},e.prototype.setRange=function(e,t){void 0===e&&(e=0),this.query.offset=e,this.query.limit=t!==s.q9?Math.max(0,t-e):s.q9},e.prototype.setOrderBy=function(e,t){this.query.order={path:e,type:t||s.As.ASCENDING}},e.prototype.addWhereClause=function(e){var t,n,r;if(this.isValidWhereClause(e)){var o={};try{for(var i=(0,a.__values)(Object.entries(e)),s=i.next();!s.done;s=i.next()){var c=(0,a.__read)(s.value,2),l=c[0],u=c[1];void 0!==u&&(o[null!==(r=this.aliasMap.get(l))&&void 0!==r?r:l]=u)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}this.query.whereClauses.push(o)}},e.prototype.clone=function(t){return void 0===t&&(t=this.aliasMap),e.fromRawQuery(this.query,t)},e.prototype.build=function(){return this.query},e.prototype.isValidWhereClause=function(e){return!!e&&Object.keys(e).length>=0},e}(),Ue=Fe;!function(e){e.DISABLED="disabled",e.ALL="all"}(Ne||(Ne={}));var He,je=function(){function e(e,t){this.collectionName=e,this.context=t.context}return e.toggleOptimization=function(t){e.optimization=t?Ne.ALL:Ne.DISABLED},e.getOptimizationMode=function(){return e.optimization},e.prototype.exec=function(e,t){return(0,a.__awaiter)(this,void 0,void 0,(function(){var n,r,o,i,c,l,u,d;return(0,a.__generator)(this,(function(p){switch(p.label){case 0:return[4,this.context.getTransaction([this.collectionName],s.pF.READ_ONLY)];case 1:return n=p.sent(),[4,this.getModel()];case 2:return r=p.sent(),o=this.getAliasMap(r.class),i=Ue.fromRawQuery(e,o).build(),(c=n.table(this.collectionName)).supports("query")&&i.whereClauses.length<=1?t!==s.yE.VALUES?[3,4]:[4,c.query(i,t)]:[3,7];case 3:return[2,p.sent().map((function(e){var t;return null!==(t=F(e,r.class))&&void 0!==t?t:void 0}))];case 4:return t!==s.yE.ENTRIES?[3,6]:[4,c.query(i,t)];case 5:return[2,p.sent().map((function(e){var t,n=(0,a.__read)(e,2);return[n[0],null!==(t=F(n[1],r.class))&&void 0!==t?t:void 0]}))];case 6:return[2,c.query(i,t)];case 7:return[4,this.getQueryPlan(i,t)];case 8:return l=p.sent(),[4,new ae(l,n).exec()];case 9:return u=a.__read.apply(void 0,[p.sent(),1]),d=u[0],t===s.yE.COUNT?[2,d.length]:t===s.yE.KEYS?[2,d.map((function(e){return(0,a.__read)(e,1)[0]}))]:t===s.yE.VALUES?[2,d.map((function(e){var t;return null!==(t=F((0,a.__read)(e,2)[1],r.class))&&void 0!==t?t:void 0}))]:[2,d.map((function(e){var t,n=(0,a.__read)(e,2);return[n[0],null!==(t=F(n[1],r.class))&&void 0!==t?t:void 0]}))]}}))}))},e.prototype.conditions=function(e){return this.getRewriter().rewrite(e)},e.prototype.explain=function(e,t){return(0,a.__awaiter)(this,void 0,void 0,(function(){return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getQueryPlan(e,t)];case 1:return[2,n.sent()]}}))}))},e.prototype.getQueryPlan=function(t,n){return(0,a.__awaiter)(this,void 0,void 0,(function(){var r,o,i,s,c,l,u;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return[4,this.getRewriter()];case 1:return r=a.sent(),[4,this.getEliminator()];case 2:return o=a.sent(),[4,this.getPlanner()];case 3:return i=a.sent(),[4,this.getBinder()];case 4:return s=a.sent(),[4,this.getOptimizer()];case 5:return c=a.sent(),l=r.rewrite(t),l=s.bind(l),l=o.eliminate(l),u=i.plan(l,n),[2,e.optimization===Ne.DISABLED?u:c.optimize(u)]}}))}))},e.prototype.getAliasMap=function(e){var t,n,r=new Map,o=R.getTableInfo(e.prototype);if(!o)return r;try{for(var i=(0,a.__values)(o.properties.values()),s=i.next();!s.done;s=i.next()){var c=s.value;c.alias&&r.set(c.name,c.alias)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r},e.prototype.getModel=function(){return(0,a.__awaiter)(this,void 0,void 0,(function(){return(0,a.__generator)(this,(function(e){return[2,this.context.waitForModelRegistered(this.collectionName)]}))}))},e.prototype.getPlanner=function(){return(0,a.__awaiter)(this,void 0,void 0,(function(){var e;return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.getModel()];case 1:return e=t.sent(),[2,new de(e.schema,this.context.comparer)]}}))}))},e.prototype.getRewriter=function(){return new se(this.context.comparer)},e.prototype.getEliminator=function(){return new pe},e.prototype.getBinder=function(){return(0,a.__awaiter)(this,void 0,void 0,(function(){var e;return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.getModel()];case 1:return e=t.sent(),[2,new le(e.schema)]}}))}))},e.prototype.getOptimizer=function(){return new Be},e.optimization=Ne.ALL,(0,a.__decorate)([he()],e.prototype,"getModel",null),(0,a.__decorate)([he()],e.prototype,"getPlanner",null),(0,a.__decorate)([he()],e.prototype,"getRewriter",null),(0,a.__decorate)([he()],e.prototype,"getEliminator",null),(0,a.__decorate)([he()],e.prototype,"getBinder",null),(0,a.__decorate)([he()],e.prototype,"getOptimizer",null),e}(),Ge=je,Ve=function(){function e(e,t){this.name=e,this.options=t,this.contextGenerator=t.contextGenerator,this.queryBuilder=new Ue,this.patch()}return e.toggleOptimization=function(e){return Ge.toggleOptimization(e)},e.prototype.skip=function(e){return this.queryBuilder.setOffset(e),this},e.prototype.take=function(e){return this.queryBuilder.setLimit(e),this},e.prototype.slice=function(e,t){return this.queryBuilder.setRange(e,t),this},e.prototype.orderBy=function(e,t){return this.queryBuilder.setOrderBy(e,t),this},e.prototype.where=function(e){return this.queryBuilder.addWhereClause(e),this},e.prototype.or=function(e){return this.queryBuilder.addWhereClause(e),this},e.prototype.conditions=function(){var e=this.contextGenerator.spawnContext();return new Ge(this.name,{context:e}).conditions(this.queryBuilder.build())},e.prototype.clone=function(){var t=new e(this.name,this.options);return t.queryBuilder=this.queryBuilder.clone(),t},e.prototype.explain=function(e){return(0,a.__awaiter)(this,void 0,void 0,(function(){var t;return(0,a.__generator)(this,(function(n){return t=this.contextGenerator.spawnContext(),[2,new Ge(this.name,{context:t}).explain(this.queryBuilder.build(),e)]}))}))},e.prototype.count=function(){return(0,a.__awaiter)(this,void 0,void 0,(function(){var e,t=this;return(0,a.__generator)(this,(function(n){return[2,(e=this.contextGenerator.spawnContext()).perform((function(){return(0,a.__awaiter)(t,void 0,void 0,(function(){return(0,a.__generator)(this,(function(t){return[2,new Ge(this.name,{context:e}).exec(this.queryBuilder.build(),s.yE.COUNT)]}))}))}))]}))}))},e.prototype.entries=function(){return(0,a.__awaiter)(this,void 0,void 0,(function(){var e,t=this;return(0,a.__generator)(this,(function(n){return[2,(e=this.contextGenerator.spawnContext()).perform((function(){return(0,a.__awaiter)(t,void 0,void 0,(function(){return(0,a.__generator)(this,(function(t){return[2,new Ge(this.name,{context:e}).exec(this.queryBuilder.build(),s.yE.ENTRIES)]}))}))}))]}))}))},e.prototype.keys=function(){return(0,a.__awaiter)(this,void 0,void 0,(function(){var e,t=this;return(0,a.__generator)(this,(function(n){return[2,(e=this.contextGenerator.spawnContext()).perform((function(){return(0,a.__awaiter)(t,void 0,void 0,(function(){return(0,a.__generator)(this,(function(t){return[2,new Ge(this.name,{context:e}).exec(this.queryBuilder.build(),s.yE.KEYS)]}))}))}))]}))}))},e.prototype.values=function(){return(0,a.__awaiter)(this,void 0,void 0,(function(){var e,t=this;return(0,a.__generator)(this,(function(n){return[2,(e=this.contextGenerator.spawnContext()).perform((function(){return(0,a.__awaiter)(t,void 0,void 0,(function(){return(0,a.__generator)(this,(function(t){return[2,new Ge(this.name,{context:e}).exec(this.queryBuilder.build(),s.yE.VALUES)]}))}))}))]}))}))},e.prototype.first=function(){return(0,a.__awaiter)(this,void 0,void 0,(function(){var e,t=this;return(0,a.__generator)(this,(function(n){return[2,(e=this.contextGenerator.spawnContext()).perform((function(){return(0,a.__awaiter)(t,void 0,void 0,(function(){var t,n;return(0,a.__generator)(this,(function(r){switch(r.label){case 0:return[4,new Ge(this.name,{context:e}).exec(this.queryBuilder.build(),s.yE.VALUES)];case 1:return t=r.sent(),[2,null!==(n=t[0])&&void 0!==n?n:null]}}))}))}))]}))}))},e.prototype.last=function(){return(0,a.__awaiter)(this,void 0,void 0,(function(){var e,t=this;return(0,a.__generator)(this,(function(n){return[2,(e=this.contextGenerator.spawnContext()).perform((function(){return(0,a.__awaiter)(t,void 0,void 0,(function(){var t,n;return(0,a.__generator)(this,(function(r){switch(r.label){case 0:return[4,new Ge(this.name,{context:e}).exec(this.queryBuilder.build(),s.yE.VALUES)];case 1:return t=r.sent(),[2,null!==(n=t[t.length-1])&&void 0!==n?n:null]}}))}))}))]}))}))},e.prototype.update=function(e){return(0,a.__awaiter)(this,void 0,void 0,(function(){var t,n,r=this;return(0,a.__generator)(this,(function(o){switch(o.label){case 0:return[4,this.entries()];case 1:return t=o.sent(),[2,(n=this.contextGenerator.spawnContext()).perform((function(){return(0,a.__awaiter)(r,void 0,void 0,(function(){var r,o,i,c,l,u,d,p,h,f,g,v,y;return(0,a.__generator)(this,(function(m){switch(m.label){case 0:return r=[],[4,n.getTransaction([this.name],s.pF.READ_WRITE)];case 1:o=m.sent(),i=o.table(this.name),m.label=2;case 2:m.trys.push([2,8,9,10]),c=(0,a.__values)(t),l=c.next(),m.label=3;case 3:return l.done?[3,7]:(u=(0,a.__read)(l.value,2),d=u[0],p=u[1],[4,i.openCursor(d)]);case 4:return(h=m.sent())?(f=e(p),[4,h.update(B(f))]):[3,6];case 5:m.sent(),r.push(d),m.label=6;case 6:return l=c.next(),[3,3];case 7:return[3,10];case 8:return g=m.sent(),v={error:g},[3,10];case 9:try{l&&!l.done&&(y=c.return)&&y.call(c)}finally{if(v)throw v.error}return[7];case 10:return[2,r]}}))}))}))]}}))}))},e.prototype.clear=function(){return(0,a.__awaiter)(this,void 0,void 0,(function(){var e,t,n=this;return(0,a.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.keys()];case 1:return e=r.sent(),[2,(t=this.contextGenerator.spawnContext()).perform((function(){return(0,a.__awaiter)(n,void 0,void 0,(function(){var n,r,o,i,c,l,u,d,p,h;return(0,a.__generator)(this,(function(f){switch(f.label){case 0:return n=[],[4,t.getTransaction([this.name],s.pF.READ_WRITE)];case 1:return r=f.sent(),(o=r.table(this.name)).supports("bulkDelete")?[4,o.bulkDelete(e)]:[3,3];case 2:return f.sent(),[2,e];case 3:f.trys.push([3,9,10,11]),i=(0,a.__values)(e),c=i.next(),f.label=4;case 4:return c.done?[3,8]:(l=c.value,[4,o.openCursor(l)]);case 5:return(u=f.sent())?[4,u.delete()]:[3,7];case 6:f.sent(),n.push(l),f.label=7;case 7:return c=i.next(),[3,4];case 8:return[3,11];case 9:return d=f.sent(),p={error:d},[3,11];case 10:try{c&&!c.done&&(h=i.return)&&h.call(i)}finally{if(p)throw p.error}return[7];case 11:return[2,n]}}))}))}))]}}))}))},e.prototype.patch=function(){var e=this.options.aspects;e.update.patch(this,"update"),e.clear.patch(this,"clear"),e.count.patch(this,"count"),e.entries.patch(this,"entries"),e.keys.patch(this,"keys"),e.values.patch(this,"values"),e.first.patch(this,"first"),e.last.patch(this,"last"),e.skip.patch(this,"skip"),e.take.patch(this,"take"),e.slice.patch(this,"slice"),e.orderBy.patch(this,"orderBy"),e.where.patch(this,"where"),e.or.patch(this,"or")},e}(),We=function(){function e(e,t){this.name=e,this.aspects=t.aspects,this.contextGenerator=t.contextGenerator,this.unsliced=new Ve(e,t),this.patch()}return e.prototype.skip=function(e){return this.unsliced.clone().skip(e)},e.prototype.take=function(e){return this.unsliced.clone().take(e)},e.prototype.slice=function(e,t){return this.unsliced.clone().slice(e,t)},e.prototype.orderBy=function(e,t){return this.unsliced.clone().orderBy(e,t)},e.prototype.where=function(e){return this.unsliced.clone().where(e)},e.prototype.or=function(e){return this.unsliced.clone().or(e)},e.prototype.update=function(e){return this.unsliced.update(e)},e.prototype.clear=function(){return this.unsliced.clear()},e.prototype.count=function(){return this.unsliced.count()},e.prototype.entries=function(){return this.unsliced.entries()},e.prototype.keys=function(){return this.unsliced.keys()},e.prototype.values=function(){return this.unsliced.values()},e.prototype.first=function(){return this.unsliced.first()},e.prototype.last=function(){return this.unsliced.last()},e.prototype.get=function(e){return(0,a.__awaiter)(this,void 0,void 0,(function(){var t,n=this;return(0,a.__generator)(this,(function(r){return[2,(t=this.contextGenerator.spawnContext()).perform((function(){return(0,a.__awaiter)(n,void 0,void 0,(function(){var n,r,o;return(0,a.__generator)(this,(function(i){switch(i.label){case 0:return[4,t.getTransaction([this.name],s.pF.READ_ONLY)];case 1:return n=i.sent(),[4,t.waitForModelRegistered(this.name)];case 2:return r=i.sent(),[4,n.table(this.name).get(e)];case 3:return[2,(o=i.sent())?F(o,r.class):null]}}))}))}))]}))}))},e.prototype.has=function(e){return(0,a.__awaiter)(this,void 0,void 0,(function(){var t,n=this;return(0,a.__generator)(this,(function(r){return[2,(t=this.contextGenerator.spawnContext()).perform((function(){return(0,a.__awaiter)(n,void 0,void 0,(function(){return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return[4,t.getTransaction([this.name],s.pF.READ_ONLY)];case 1:return[4,n.sent().table(this.name).openCursor(e)];case 2:return[2,!!n.sent()]}}))}))}))]}))}))},e.prototype.delete=function(e){return(0,a.__awaiter)(this,void 0,void 0,(function(){var t,n=this;return(0,a.__generator)(this,(function(r){return[2,(t=this.contextGenerator.spawnContext()).perform((function(){return(0,a.__awaiter)(n,void 0,void 0,(function(){var n,r,o;return(0,a.__generator)(this,(function(i){switch(i.label){case 0:return[4,t.getTransaction([this.name],s.pF.READ_WRITE)];case 1:return n=i.sent(),[4,(r=n.table(this.name)).openCursor(e)];case 2:return o=i.sent(),[4,r.delete(e)];case 3:return i.sent(),[2,o?e:null]}}))}))}))]}))}))},e.prototype.insert=function(e){return(0,a.__awaiter)(this,void 0,void 0,(function(){var t,n=this;return(0,a.__generator)(this,(function(r){return[2,(t=this.contextGenerator.spawnContext()).perform((function(){return(0,a.__awaiter)(n,void 0,void 0,(function(){return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return[4,t.getTransaction([this.name],s.pF.READ_WRITE)];case 1:return[4,n.sent().table(this.name).insert(B(e))];case 2:return[2,n.sent()]}}))}))}))]}))}))},e.prototype.upsert=function(e){return(0,a.__awaiter)(this,void 0,void 0,(function(){var t,n=this;return(0,a.__generator)(this,(function(r){return[2,(t=this.contextGenerator.spawnContext()).perform((function(){return(0,a.__awaiter)(n,void 0,void 0,(function(){return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return[4,t.getTransaction([this.name],s.pF.READ_WRITE)];case 1:return[4,n.sent().table(this.name).upsert(B(e))];case 2:return[2,n.sent()]}}))}))}))]}))}))},e.prototype.bulkInsert=function(e){return(0,a.__awaiter)(this,void 0,void 0,(function(){var t,n=this;return(0,a.__generator)(this,(function(r){return[2,(t=this.contextGenerator.spawnContext()).perform((function(){return(0,a.__awaiter)(n,void 0,void 0,(function(){var n,r,o,i,c,l,u,d,p,h;return(0,a.__generator)(this,(function(f){switch(f.label){case 0:return[4,t.getTransaction([this.name],s.pF.READ_WRITE)];case 1:n=f.sent(),r=[],o=n.table(this.name),f.label=2;case 2:f.trys.push([2,7,8,9]),i=(0,a.__values)(e),c=i.next(),f.label=3;case 3:return c.done?[3,6]:(l=c.value,[4,o.insert(B(l))]);case 4:u=f.sent(),r.push(u),f.label=5;case 5:return c=i.next(),[3,3];case 6:return[3,9];case 7:return d=f.sent(),p={error:d},[3,9];case 8:try{c&&!c.done&&(h=i.return)&&h.call(i)}finally{if(p)throw p.error}return[7];case 9:return[2,r]}}))}))}))]}))}))},e.prototype.bulkUpsert=function(e){return(0,a.__awaiter)(this,void 0,void 0,(function(){var t,n=this;return(0,a.__generator)(this,(function(r){return[2,(t=this.contextGenerator.spawnContext()).perform((function(){return(0,a.__awaiter)(n,void 0,void 0,(function(){return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return[4,t.getTransaction([this.name],s.pF.READ_WRITE)];case 1:return[2,n.sent().table(this.name).bulkUpsert(e.map((function(e){return B(e)})))]}}))}))}))]}))}))},e.prototype.conditions=function(){return this.unsliced.conditions()},e.prototype.patch=function(){this.aspects.get.patch(this,"get"),this.aspects.has.patch(this,"has"),this.aspects.delete.patch(this,"delete"),this.aspects.insert.patch(this,"insert"),this.aspects.upsert.patch(this,"upsert"),this.aspects.bulkInsert.patch(this,"bulkInsert"),this.aspects.bulkUpsert.patch(this,"bulkUpsert")},e}(),ze=We,Ke=function(){function e(e,t){this.collectionMap=new Map,this.storage=e,this.eventBus=t}return e.prototype.getCollection=function(e,t){if(this.collectionMap.has(e))return this.collectionMap.get(e);var n=this.createCollection(e,t);return this.collectionMap.set(e,n),this.eventBus.emit(i.CollectionCreated,{collectionName:e,context:t.spawnContext()}),n},e.prototype.createCollection=function(e,t){var n=this.storage.aspects.collection;return new ze(e,{contextGenerator:t,aspects:n})},e}(),qe=c.sH.withMessageCreator("UnexpectedModifierError",(function(e){return'unexpected error occurred at the "'+e+'" stage of the plugable function, there may be a bug in your modifiers.'})),Ye=c.sH.withMessageCreator("InvalidPatchedFunctionError",(function(e){return'patched target is not a function, patched key is "'+e+'"'}));!function(e){e.before="before",e.around="around",e.return="return",e.throw="throw",e.after="after",e.protect="protect"}(He||(He={}));var Qe=function(){function e(e){this.modifiers={before:[],around:[],return:[],throw:[],after:[],protect:[]},this.createContext=e}return e.prototype.before=function(e){return this.modifiers.before.push(e),this},e.prototype.around=function(e){return this.modifiers.around.push(e),this},e.prototype.throw=function(e){return this.modifiers.throw.push(e),this},e.prototype.return=function(e){return this.modifiers.return.push(e),this},e.prototype.after=function(e){return this.modifiers.after.push(e),this},e.prototype.protect=function(e){return this.modifiers.protect.push(e),this},e.prototype.patch=function(e,t){Object.defineProperty(e,t,{enumerable:!1,value:this.compile(e,t),writable:!0,configurable:!0})},e.prototype.dirty=function(){return Object.values(this.modifiers).some((function(e){return e.length}))},e.prototype.compile=function(e,t){var n=e[t];if("function"!=typeof n)throw new Ye(t);var r=this.invoke.bind(this);return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r(n,this,e)}},e}(),Ze=Qe,Xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.create=function(){return new t((function(){return{}}))},t.withContext=function(e){return new t(e)},t.prototype.invoke=function(e,t,n){var r;if(!this.dirty())return e.call.apply(e,(0,a.__spreadArray)([t],(0,a.__read)(n)));var o=Object.assign(this.createContext(),{args:n,this:t,callee:e,return:void 0,error:void 0});try{this.trigger(He.before,o,this.modifiers.protect),this.modifiers.around.length?this.trigger(He.around,o,this.modifiers.protect):o.return=(r=o.callee).call.apply(r,(0,a.__spreadArray)([o.this],(0,a.__read)(o.args))),this.trigger(He.return,o,this.modifiers.protect)}catch(e){throw this.modifiers.throw.length&&(Object.assign(o,{error:e}),this.trigger(He.throw,o,this.modifiers.protect)),e}finally{this.trigger(He.after,o,this.modifiers.protect)}return o.return},t.prototype.trigger=function(e,t,n){var r,o,i,s;try{for(var l=(0,a.__values)(this.modifiers[e]),u=l.next();!u.done;u=l.next()){var d=u.value;try{d.call(t.this,t)}catch(r){if(!n.length){(0,c.ZK)(new qe(e,r));continue}try{for(var p=(i=void 0,(0,a.__values)(n)),h=p.next();!h.done;h=p.next()){var f=h.value;Object.assign(t,{error:r}),f.call(t.this,t)}}catch(e){i={error:e}}finally{try{h&&!h.done&&(s=p.return)&&s.call(p)}finally{if(i)throw i.error}}}}}catch(e){r={error:e}}finally{try{u&&!u.done&&(o=l.return)&&o.call(l)}finally{if(r)throw r.error}}},t}(Ze),Je=Xe,$e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.create=function(){return new t((function(){return{}}))},t.withContext=function(e){return new t(e)},t.prototype.invoke=function(e,t,n){var r=this;if(!this.dirty())return e.call.apply(e,(0,a.__spreadArray)([t],(0,a.__read)(n)));var o=Object.assign(this.createContext(),{args:n,this:t,callee:e,return:void 0,error:void 0});return new Promise((function(e,t){(0,a.__awaiter)(r,void 0,void 0,(function(){var e,t,n,r;return(0,a.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,7,10,12]),[4,this.trigger(He.before,o,this.modifiers.protect)];case 1:return i.sent(),this.modifiers.around.length?[3,3]:(e=(r=o.callee).call.apply(r,(0,a.__spreadArray)([o.this],(0,a.__read)(o.args))),t=o,[4,e]);case 2:return t.return=i.sent(),[3,5];case 3:return[4,this.trigger(He.around,o,this.modifiers.protect)];case 4:i.sent(),i.label=5;case 5:return[4,this.trigger(He.return,o,this.modifiers.protect)];case 6:return i.sent(),[3,12];case 7:return n=i.sent(),Object.assign(o,{error:n}),this.modifiers.throw.length?[4,this.trigger(He.throw,o,this.modifiers.protect)]:[3,9];case 8:i.sent(),i.label=9;case 9:throw n;case 10:return[4,this.trigger(He.after,o,this.modifiers.protect)];case 11:return i.sent(),[7];case 12:return[2]}}))})).then((function(){e(o.return)})).catch((function(e){t(e)}))}))},t.prototype.trigger=function(e,t,n){return(0,a.__awaiter)(this,void 0,void 0,(function(){var r,o,i,s,l,u,d,p,h,f,g,v,y;return(0,a.__generator)(this,(function(m){switch(m.label){case 0:m.trys.push([0,15,16,17]),r=(0,a.__values)(this.modifiers[e]),o=r.next(),m.label=1;case 1:if(o.done)return[3,14];i=o.value,m.label=2;case 2:return m.trys.push([2,4,,13]),[4,i.call(t.this,t)];case 3:return m.sent(),[3,13];case 4:if(s=m.sent(),!n.length)return(0,c.ZK)(new qe(e,s)),[3,13];m.label=5;case 5:m.trys.push([5,10,11,12]),v=void 0,l=(0,a.__values)(n),u=l.next(),m.label=6;case 6:return u.done?[3,9]:(d=u.value,Object.assign(t,{error:s}),[4,d.call(t.this,t)]);case 7:m.sent(),m.label=8;case 8:return u=l.next(),[3,6];case 9:return[3,12];case 10:return p=m.sent(),v={error:p},[3,12];case 11:try{u&&!u.done&&(y=l.return)&&y.call(l)}finally{if(v)throw v.error}return[7];case 12:return[3,13];case 13:return o=r.next(),[3,1];case 14:return[3,17];case 15:return h=m.sent(),f={error:h},[3,17];case 16:try{o&&!o.done&&(g=r.return)&&g.call(r)}finally{if(f)throw f.error}return[7];case 17:return[2]}}))}))},t}(Ze),et=$e;function tt(){return{timings:new Map,counters:new Map,messages:new Map,errors:new Map,flags:new Map,data:new Map}}var nt,rt=function(){function e(e,t){this.storage=e,this.eventBus=t,this.plugins=[]}return e.prototype.add=function(){for(var e,t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];try{for(var i=(0,a.__values)(n),s=i.next();!s.done;s=i.next()){var c=s.value;this.plugins.push(c),c.register(this.storage),this.eventBus.emit(o.RegisterPlugin,c)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},e}(),ot=rt,it=c.sH.withMessageCreator("UnexpectedOutsideMigrationActionError",(function(e){return e+" outside ensure(callback) is not allowed, please wrap your migration actions inside a ensure callback"})),at=function(){function e(e,t){this.name=e,this.context=t}return e.create=function(t){return{index:function(n){return new e(n,t)}}},e.prototype.create=function(e){var t=this.context.scope.collection;if(!t)throw new it("CreateIndex");return this.context.actions.schema.push({type:s.g6.CreateIndex,name:this.name,attributes:(0,a.__assign)({},e),collection:t}),this},e.prototype.drop=function(){var e=this.context.scope.collection;if(!e)throw new it("DropIndex");this.context.actions.schema.push({type:s.g6.DropIndex,name:this.name,collection:e})},e.prototype.alter=function(e){var t=this.context.scope.collection;if(!t)throw new it("AlterIndex");return this.context.actions.schema.push({type:s.g6.DropIndex,name:this.name,collection:t},{type:s.g6.CreateIndex,name:this.name,attributes:(0,a.__assign)({},e),collection:t}),this},e.prototype.rename=function(e){var t=this.context.scope.collection;if(!t)throw new it("RenameIndex");this.context.actions.schema.push({type:s.g6.DropIndex,name:this.name,collection:t},{type:s.g6.CreateIndex,name:e,attributes:{path:""},collection:t})},e.prototype.ensure=function(){throw new c.zF},e}(),st=function(){function e(e,t){this.name=e,this.context=t}return e.create=function(t){return{collection:function(n){return new e(n,t)}}},e.prototype.create=function(e){return this.context.actions.schema.push({type:s.g6.CreateCollection,name:this.name,attributes:(0,a.__assign)({},e)}),this},e.prototype.drop=function(){this.context.actions.schema.push({type:s.g6.DropCollection,name:this.name})},e.prototype.alter=function(e){return this.context.actions.schema.push({type:s.g6.DropCollection,name:this.name},{type:s.g6.CreateCollection,name:this.name,attributes:(0,a.__assign)({},e)}),this},e.prototype.rename=function(e){this.context.actions.schema.push({type:s.g6.DropCollection,name:this.name},{type:s.g6.CreateCollection,name:e,attributes:{key:{generator:s.uZ.AutoIncrement},properties:[]}})},e.prototype.ensure=function(e){var t=this.context,n=(0,a.__assign)({},at.create(t));this.context.scope.collection=this.name,e(n),this.context.scope.collection=null},e}(),ct=function(){function e(){this.context={actions:{schema:[],data:[]},scope:{database:null,collection:null}},this.builder=st.create(this.context)}return e.prototype.init=function(e){this.state=e,this.build()},e.prototype.plan=function(){return this.context.actions.schema.length||this.context.actions.data.length?[{schema:{actions:this.context.actions.schema.slice()},data:{actions:this.context.actions.data.slice()}}]:[]},e.prototype.handleDropCollection=function(e){var t,n;try{for(var r=(0,a.__values)(e),o=r.next();!o.done;o=r.next()){var i=o.value;this.builder.collection(i.name).drop()}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e.prototype.handleCreateCollection=function(e){var t,n,r=function(e){o.builder.collection(e.name).create(e).ensure((function(t){var n,r;try{for(var o=(n=void 0,(0,a.__values)(e.indices)),i=o.next();!i.done;i=o.next()){var s=i.value;t.index(s.name).create(s)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}))},o=this;try{for(var i=(0,a.__values)(e),s=i.next();!s.done;s=i.next())r(s.value)}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},e.prototype.handleIndexChange=function(e){var t,n,r=function(e){o.builder.collection(e.collection).ensure((function(t){var n,r,o,i,s,c;try{for(var l=(n=void 0,(0,a.__values)((null===(s=e.index)||void 0===s?void 0:s.added)||[])),u=l.next();!u.done;u=l.next()){var d=u.value;t.index(d.name).create(d)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}try{for(var p=(o=void 0,(0,a.__values)((null===(c=e.index)||void 0===c?void 0:c.deleted)||[])),h=p.next();!h.done;h=p.next())d=h.value,t.index(d.name).drop()}catch(e){o={error:e}}finally{try{h&&!h.done&&(i=p.return)&&i.call(p)}finally{if(o)throw o.error}}}))},o=this;try{for(var i=(0,a.__values)(e),s=i.next();!s.done;s=i.next())r(s.value)}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},e.prototype.build=function(){if(!this.state)throw new Error("Migration state is undefined, must init before!");var e=this.state.schema,t=e.expect,n=e.actual,r=s.Ze.databaseDiff(n,t);this.handleCreateCollection(r.added),this.handleDropCollection(r.deleted),this.handleIndexChange(r.different)},e}(),lt=s.O3.name;!function(e){e.SYSTEM_TABLE="system_table",e.SCAN_EXISTING_TABLE="scan_exists_table"}(nt||(nt={}));var ut=function(){function e(){}return e.hasSystemTable=function(e){return e.tableNames.includes(lt)},e.getDatabaseSchema=function(t,n,r){return(0,a.__awaiter)(this,void 0,void 0,(function(){var o,i,c,l,u;return(0,a.__generator)(this,(function(d){switch(d.label){case 0:return[4,n.openDB(t,{name:t,collections:[s.O3]})];case 1:o=d.sent(),i=!1,d.label=2;case 2:return d.trys.push([2,,10,11]),o.tableNames.length?[3,4]:(o.close(),i=!0,[4,n.deleteDB(t)]);case 3:return d.sent(),[2,{schema:{name:this.name,version:0,collections:[]},from:"scan_exists_table"}];case 4:return this.hasSystemTable(o)?[3,6]:[4,e.getDatabaseSchemaByScanningTableStructure(r.collections.map((function(e){return e.name})),o)];case 5:return[2,{schema:d.sent(),from:"scan_exists_table"}];case 6:return[4,o.transaction([lt],s.pF.READ_ONLY)];case 7:return[4,(c=d.sent()).table(lt).getAll()];case 8:return l=d.sent()||[],u={name:this.name,version:o.version,collections:(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(l)),[this.getSystemTableSchema()])},[4,c.commit()];case 9:return d.sent(),[2,{schema:u,from:"system_table"}];case 10:return i||o.close(),[7];case 11:return[2]}}))}))},e.getSystemTableSchema=function(){return s.O3},e.updateSchemaChange=function(e,t,n,r){return(0,a.__awaiter)(this,void 0,void 0,(function(){var o,i,c,l,u,d,p,h,f,g,v,y,m,b,_,S,w,E,x,T,R,I,P;return(0,a.__generator)(this,(function(O){switch(O.label){case 0:return o=t.table(lt),r?[4,o.bulkUpsert(n.schema.expect.collections.filter((function(e){return e.name!==lt})))]:[3,2];case 1:return O.sent(),[2];case 2:O.trys.push([2,27,,29]),i=s.Ze.databaseDiff(n.schema.actual,n.schema.expect),c=i.added.filter((function(e){return e.name!==lt})),O.label=3;case 3:O.trys.push([3,8,9,10]),l=(0,a.__values)(c),u=l.next(),O.label=4;case 4:return u.done?[3,7]:((f=u.value).dataVersion=e,[4,o.upsert(f)]);case 5:O.sent(),O.label=6;case 6:return u=l.next(),[3,4];case 7:return[3,10];case 8:return d=O.sent(),E={error:d},[3,10];case 9:try{u&&!u.done&&(x=l.return)&&x.call(l)}finally{if(E)throw E.error}return[7];case 10:O.trys.push([10,15,16,17]),p=(0,a.__values)(i.deleted),h=p.next(),O.label=11;case 11:return h.done?[3,14]:(f=h.value,[4,o.delete(f.name)]);case 12:O.sent(),O.label=13;case 13:return h=p.next(),[3,11];case 14:return[3,17];case 15:return g=O.sent(),T={error:g},[3,17];case 16:try{h&&!h.done&&(R=p.return)&&R.call(p)}finally{if(T)throw T.error}return[7];case 17:v=i.different.filter((function(e){return!!e.index})),y=function(e){var t,n,r;return(0,a.__generator)(this,(function(i){switch(i.label){case 0:return[4,o.get(e.collection)];case 1:return t=i.sent(),n=[],r=t.indices.filter((function(t){return!e.index.deleted.some((function(e){return e.name===t.name}))})),n.push.apply(n,(0,a.__spreadArray)([],(0,a.__read)(e.index.added))),n.push.apply(n,(0,a.__spreadArray)([],(0,a.__read)(r))),t.index=n,[4,o.upsert(t)];case 2:return i.sent(),[2]}}))},O.label=18;case 18:O.trys.push([18,23,24,25]),m=(0,a.__values)(v),b=m.next(),O.label=19;case 19:return b.done?[3,22]:(_=b.value,[5,y(_)]);case 20:O.sent(),O.label=21;case 21:return b=m.next(),[3,19];case 22:return[3,25];case 23:return S=O.sent(),I={error:S},[3,25];case 24:try{b&&!b.done&&(P=m.return)&&P.call(m)}finally{if(I)throw I.error}return[7];case 25:return[4,t.commit()];case 26:if(!O.sent())throw new C;return[3,29];case 27:return w=O.sent(),[4,t.rollback()];case 28:throw O.sent(),w;case 29:return[2]}}))}))},e.updateCollectionDataVersion=function(e,t,n){return(0,a.__awaiter)(this,void 0,void 0,(function(){var r,o,i;return(0,a.__generator)(this,(function(s){switch(s.label){case 0:return[4,(r=t.table(lt)).get(R.getTableName(n))];case 1:if(o=s.sent(),i=R.getTableInfo(n.prototype),!o)throw new Error("get target table system info error!");if(!i)throw new h(n.name);return o.dataVersion=e,o.properties=(0,a.__spreadArray)([],(0,a.__read)(i.properties.values())).map((function(e){return e.name})),[4,r.upsert(o)];case 2:return s.sent(),[2]}}))}))},e.getTableDataVersion=function(e,t){return(0,a.__awaiter)(this,void 0,void 0,(function(){return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return[4,t.table(lt).get(e)];case 1:return[2,n.sent().dataVersion]}}))}))},e.getDatabaseSchemaByScanningTableStructure=function(e,t){return(0,a.__awaiter)(this,void 0,void 0,(function(){var n,r,o,i,c,l,u,d,p,h,f,g,v,y,m,b;return(0,a.__generator)(this,(function(_){switch(_.label){case 0:n=t.tableNames.filter((function(t){return e.includes(t)})),r=[],_.label=1;case 1:_.trys.push([1,6,7,8]),o=(0,a.__values)(n),i=o.next(),_.label=2;case 2:return i.done?[3,5]:(c=i.value,[4,t.table(c,s.pF.READ_ONLY)]);case 3:l=_.sent(),u={name:c,key:l.autoIncrement?{generator:s.uZ.AutoIncrement}:{path:l.keyPath},indices:[],properties:[]};try{for(m=void 0,d=(0,a.__values)(l.indexNames),p=d.next();!p.done;p=d.next())h=p.value,f=l.index(h),u.indices.push({name:h,path:f.keyPath,unique:f.unique})}catch(e){m={error:e}}finally{try{p&&!p.done&&(b=d.return)&&b.call(d)}finally{if(m)throw m.error}}r.push(u),_.label=4;case 4:return i=o.next(),[3,2];case 5:return[3,8];case 6:return g=_.sent(),v={error:g},[3,8];case 7:try{i&&!i.done&&(y=o.return)&&y.call(o)}finally{if(v)throw v.error}return[7];case 8:return[2,{name:t.name,version:t.version,collections:r}]}}))}))},e}(),dt=function(){function e(e){this.schemaActionHandlerMap=new Map,this.dataActionHandlerMap=new Map,this.schemaActionHandlerMap.set(s.g6.CreateCollection,this.performCreateCollectionAction.bind(this)),this.schemaActionHandlerMap.set(s.g6.DropCollection,this.performDropCollectionAction.bind(this)),this.schemaActionHandlerMap.set(s.g6.CreateIndex,this.performCreateIndexAction.bind(this)),this.schemaActionHandlerMap.set(s.g6.DropIndex,this.performDropIndexAction.bind(this)),this.dataActionHandlerMap.set(s.cg.DropProperty,this.performDropPropertyAction.bind(this)),this.dataActionHandlerMap.set(s.cg.ClearData,this.performClearDataAction.bind(this)),this.dataActionHandlerMap.set(s.cg.ReplaceData,this.performReplaceDataAction.bind(this)),e.executeDataAction.patch(this,"executeDataAction"),e.executeSchemaAction.patch(this,"executeSchemaAction")}return e.prototype.executeSchemaAction=function(e,t,n){var r=this.schemaActionHandlerMap.get(n.type);if(r){if(t.mode!==s.pF.VERSION_CHANGE)throw new p(n.type);return r(e,t,n)}},e.prototype.executeDataAction=function(e,t,n){return(0,a.__awaiter)(this,void 0,void 0,(function(){var r;return(0,a.__generator)(this,(function(o){return(r=this.dataActionHandlerMap.get(n.type))?[2,r(e,t,n)]:[2]}))}))},e.prototype.performCreateIndexAction=function(e,t,n){t.table(n.collection).createIndex(n.name,n.attributes.path,{unique:n.attributes.unique})},e.prototype.performDropIndexAction=function(e,t,n){t.table(n.collection).deleteIndex(n.name)},e.prototype.performDropCollectionAction=function(e,t,n){e.deleteTable(n.name)},e.prototype.performCreateCollectionAction=function(e,t,n){var r,o;e.createTable(n.name,{keyPath:null===(r=n.attributes.key)||void 0===r?void 0:r.path,autoIncrement:(null===(o=n.attributes.key)||void 0===o?void 0:o.generator)===s.uZ.AutoIncrement})},e.prototype.performClearDataAction=function(e,t,n){return(0,a.__awaiter)(this,void 0,void 0,(function(){var e,r;return(0,a.__generator)(this,(function(o){switch(o.label){case 0:return e=t.table(n.collection),n.filter?[3,2]:[4,e.clear()];case 1:return o.sent(),[2];case 2:return[4,e.openCursor()];case 3:r=o.sent(),o.label=4;case 4:return r?n.filter(r.value())?[4,r.delete()]:[3,6]:[3,8];case 5:o.sent(),o.label=6;case 6:return[4,r.next()];case 7:return r=o.sent(),[3,4];case 8:return[2]}}))}))},e.prototype.performDropPropertyAction=function(e,t,n){return(0,a.__awaiter)(this,void 0,void 0,(function(){var e,r;return(0,a.__generator)(this,(function(o){switch(o.label){case 0:return[4,t.table(n.collection).openCursor()];case 1:e=o.sent(),o.label=2;case 2:return e?((r=e.value())[n.path]=void 0,[4,e.update(r)]):[3,5];case 3:return o.sent(),[4,e.next()];case 4:return e=o.sent(),[3,2];case 5:return[2]}}))}))},e.prototype.performReplaceDataAction=function(e,t,n){var r;return(0,a.__awaiter)(this,void 0,void 0,(function(){var e,o;return(0,a.__generator)(this,(function(i){switch(i.label){case 0:return[4,t.table(n.collection).openCursor()];case 1:e=i.sent(),i.label=2;case 2:return e?(o=e.value(),n.filter&&!(null===(r=n.filter)||void 0===r?void 0:r.call(this,o))?[3,4]:[4,e.update(n.replacer(o))]):[3,6];case 3:i.sent(),i.label=4;case 4:return[4,e.next()];case 5:return e=i.sent(),[3,2];case 6:return[2]}}))}))},e}(),pt=function(){function e(e){this.collection=e,this.versionActionsMap=new Map}return e.prototype.getVersionActionsMap=function(){return this.versionActionsMap},e.prototype.version=function(e){var t=this,n={update:function(r){return t.pushAction(e,{type:s.cg.ReplaceData,replacer:r,collection:t.collection}),n},delete:function(r){return t.pushAction(e,{filter:r,type:s.cg.ClearData,collection:t.collection}),n}};return n},e.prototype.pushAction=function(e,t){var n=this.versionActionsMap.get(e)||[];n.push(t),this.versionActionsMap.set(e,n)},e}(),ht=function(){function e(e,t,n){this.expectedSchema=e,this.actualSchema=t,this.modelClass=n}return e.prototype.plan=function(){var e=this.actualSchema.dataVersion||0,t=this.expectedSchema.dataVersion||1;if(e===t)return[];var n=[],r=this.getManualMigrationActions(e,t);n.push.apply(n,(0,a.__spreadArray)([],(0,a.__read)(r)));var o=this.getAutoMigrationActions();return n.push.apply(n,(0,a.__spreadArray)([],(0,a.__read)(o))),[{schema:{actions:[]},data:{actions:n}}]},e.prototype.getManualMigrationActions=function(e,t){var n,r,o=new pt(R.getTableName(this.modelClass));return null===(r=(n=this.modelClass).onDataUpgrade)||void 0===r||r.call(n,e,t,o),this.getRangeDataAction(e,t,o.getVersionActionsMap())},e.prototype.getAutoMigrationActions=function(){var e,t,n=this,r=[],o=this.actualSchema.properties.filter((function(e){return!n.expectedSchema.properties.includes(e)}));try{for(var i=(0,a.__values)(o),c=i.next();!c.done;c=i.next()){var l=c.value;r.push({type:s.cg.DropProperty,collection:R.getTableName(this.modelClass),path:l})}}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return r},e.prototype.getRangeDataAction=function(e,t,n){for(var r=[],o=e;o<=t;o++)r.push.apply(r,(0,a.__spreadArray)([],(0,a.__read)(n.get(o)||[])));return r},e}(),ft=function(){function e(e){this.migrationManager=e,this.upgradedFlag=new Map}return e.prototype.executeDataUpgrade=function(e,t,n,r){return void 0===r&&(r=function(){}),(0,a.__awaiter)(this,void 0,void 0,(function(){var o,i;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return o=R.getTableName(e),this.upgradedFlag.get(o)?[2]:(i=this.getCollectionSchema(o,n),this.isNeedExecuteDataUpgrade(i.expect,i.actual)?[4,this.executeUpgrade(o,t,n,i.expect,i.actual,e)]:(this.upgradedFlag.set(o,!0),[2,r()]));case 1:return a.sent(),this.upgradedFlag.set(o,!0),[2,r()]}}))}))},e.prototype.isNeedExecuteDataUpgrade=function(e,t){return!(!(null==t?void 0:t.dataVersion)||e.dataVersion===t.dataVersion)},e.prototype.executeUpgrade=function(e,t,n,r,o,i){return(0,a.__awaiter)(this,void 0,void 0,(function(){var c,l,u,p,h,f;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return c=new ht(r,o,i),this.migrationManager.use(c),l=this.migrationManager.buildMigration(n),[4,t.transaction([e,ut.getSystemTableSchema().name],s.pF.READ_WRITE)];case 1:u=a.sent(),p=!1,a.label=2;case 2:return a.trys.push([2,6,8,11]),h=n.schema.expect.version||1,[4,ut.getTableDataVersion(R.getTableName(i),u)];case 3:return a.sent()===h?[2]:[4,this.migrationManager.executeDataMigration(t,l,u)];case 4:return a.sent(),[4,ut.updateCollectionDataVersion(h,u,i)];case 5:return a.sent(),[3,11];case 6:return f=a.sent(),p=!0,[4,u.rollback()];case 7:throw a.sent(),new d({oldVersion:o.dataVersion,newVersion:r.dataVersion},f);case 8:return p?[3,10]:[4,u.commit()];case 9:a.sent(),a.label=10;case 10:return[7];case 11:return[2]}}))}))},e.prototype.getCollectionSchema=function(e,t){var n=t.schema,r=n.expect,o=n.actual,i=r.collections.filter((function(t){return t.name===e})),a=o.collections.filter((function(t){return t.name===e}));if(1!==i.length)throw new u(e);return{expect:i[0],actual:a.length?a[0]:void 0}},e}(),gt=function(){function e(e,t,n){var r=this;this.planner=new ct,this.actualDBSchema=null,this.actualDBSchemaFrom=null,this.lazyMigrationProcessor=new ft(this),this.handleCollectionCreated=function(e){var t=e.collectionName,n=e.context;r.safeExecuteDataUpgrade(n,t)},this.handleStartTransaction=function(e){var t,n,o=e.collectionNames,i=e.context;try{for(var s=(0,a.__values)(o),c=s.next();!c.done;c=s.next()){var l=c.value;r.safeExecuteDataUpgrade(i,l)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}},this.eventBus=e,this.eventBus.on(i.CollectionCreated,this.handleCollectionCreated),this.eventBus.on(i.StartTransaction,this.handleStartTransaction),this.schemaProvider=t,this.actionExecutor=new dt(n.actionExecutor),this.applyAspectPatch(n)}return e.prototype.use=function(e){this.planner=e},e.prototype.prepareAutoUpgradeHandler=function(e,t){return(0,a.__awaiter)(this,void 0,void 0,(function(){var n,r,i,s,c,l=this;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return n=this.schemaProvider.getDatabaseSchema(),[4,ut.getDatabaseSchema(e,t,n)];case 1:return r=a.sent(),i=r.schema,s=r.from,this.actualDBSchema=i,this.actualDBSchemaFrom=s,this.log("getDatabaseSchema",this.actualDBSchema),c=this.buildMigration({schema:{expect:n,actual:this.actualDBSchema}}),[2,function(e,t,n,r){l.eventBus.emit(o.SchemaMigrationStart),l.executeSchemaMigration(e,c,r),l.updateMigrationChangeInfo(r).catch((function(e){l.emitError(new S(e))})),l.eventBus.emit(o.SchemaMigrationEnd)}]}}))}))},e.prototype.buildMigration=function(e){var t,n,r,o,i,a,s=e.schema,c=s.actual,l=s.expect;null===(n=null===(t=this.planner)||void 0===t?void 0:t.init)||void 0===n||n.call(t,e);var u=null!==(r=c.version)&&void 0!==r?r:0,d=null!==(o=l.version)&&void 0!==o?o:1;return null!==(a=null===(i=this.planner)||void 0===i?void 0:i.plan(u,d))&&void 0!==a?a:[]},e.prototype.executeSchemaMigration=function(e,t,n){var r,o,i,s;if(t)try{for(var c=(0,a.__values)(t),l=c.next();!l.done;l=c.next()){var u=l.value;try{for(var d=(i=void 0,(0,a.__values)(u.schema.actions)),p=d.next();!p.done;p=d.next()){var h=p.value;this.actionExecutor.executeSchemaAction(e,n,h)}}catch(e){i={error:e}}finally{try{p&&!p.done&&(s=d.return)&&s.call(d)}finally{if(i)throw i.error}}}}catch(e){r={error:e}}finally{try{l&&!l.done&&(o=c.return)&&o.call(c)}finally{if(r)throw r.error}}},e.prototype.executeDataMigration=function(e,t,n){return(0,a.__awaiter)(this,void 0,void 0,(function(){var r,o,i,s,c,l,u,d,p,h,f,g;return(0,a.__generator)(this,(function(v){switch(v.label){case 0:if(!t)return[2];v.label=1;case 1:v.trys.push([1,12,13,14]),r=(0,a.__values)(t),o=r.next(),v.label=2;case 2:if(o.done)return[3,11];i=o.value,v.label=3;case 3:v.trys.push([3,8,9,10]),f=void 0,s=(0,a.__values)(i.data.actions),c=s.next(),v.label=4;case 4:return c.done?[3,7]:(l=c.value,[4,this.actionExecutor.executeDataAction(e,n,l)]);case 5:v.sent(),v.label=6;case 6:return c=s.next(),[3,4];case 7:return[3,10];case 8:return u=v.sent(),f={error:u},[3,10];case 9:try{c&&!c.done&&(g=s.return)&&g.call(s)}finally{if(f)throw f.error}return[7];case 10:return o=r.next(),[3,2];case 11:return[3,14];case 12:return d=v.sent(),p={error:d},[3,14];case 13:try{o&&!o.done&&(h=r.return)&&h.call(r)}finally{if(p)throw p.error}return[7];case 14:return[2]}}))}))},e.prototype.updateMigrationChangeInfo=function(e){var t,n;return(0,a.__awaiter)(this,void 0,void 0,(function(){var r,o;return(0,a.__generator)(this,(function(i){return r=this.schemaProvider.getDatabaseSchema(),o=null!==(t=r.version)&&void 0!==t?t:1,[2,ut.updateSchemaChange(o,e,{schema:{expect:r,actual:null!==(n=this.actualDBSchema)&&void 0!==n?n:{name:r.name,collections:[]}}},"scan_exists_table"===this.actualDBSchemaFrom)]}))}))},e.prototype.log=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]},e.prototype.executeDataUpgradeIfNeed=function(e,t){var n;return(0,a.__awaiter)(this,void 0,void 0,(function(){var r,o,s=this;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return this.log("executeDataUpgradeIfNeed",e.name),r=this.schemaProvider.getDatabaseSchema(),o={name:r.name,collections:[]},[4,this.lazyMigrationProcessor.executeDataUpgrade(e,t,{schema:{expect:r,actual:null!==(n=this.actualDBSchema)&&void 0!==n?n:o}},(function(){s.eventBus.emit(i.ModelLazyMigrationEnd,R.getTableName(e))}))];case 1:return a.sent(),[2]}}))}))},e.prototype.safeExecuteDataUpgrade=function(e,t){var n=this;Promise.all([e.waitForModelRegistered(t),e.waitForDBReady()]).then((function(e){var r=(0,a.__read)(e,2),o=r[0],i=r[1];n.executeDataUpgradeIfNeed(o.class,i).catch((function(e){n.emitError(new w(t,e))}))})).catch((function(){}))},e.prototype.emitError=function(e){this.eventBus.emit(o.Error,e)},e.prototype.applyAspectPatch=function(e){e.buildMigration.patch(this,"buildMigration"),e.executeDataMigration.patch(this,"executeDataMigration"),e.executeSchemaMigration.patch(this,"executeSchemaMigration"),e.prepareAutoUpgradeHandler.patch(this,"prepareAutoUpgradeHandler"),e.log.patch(this,"log"),e.updateMigrationChangeInfo.patch(this,"updateMigrationChangeInfo")},e}(),vt=gt,yt=function(){var e;return{lock:function(t){return e||(e=t()),e.finally((function(){e=void 0}))}}},mt=function(){function e(e,t){var n,r=this;if(this.openingMutex=yt(),this.closingMutex=yt(),this.destroyingMutex=yt(),this.openDatabase=function(){return(0,a.__awaiter)(r,void 0,void 0,(function(){var e=this;return(0,a.__generator)(this,(function(t){return[2,this.openingMutex.lock((function(){return(0,a.__awaiter)(e,void 0,void 0,(function(){var e,t,n,r,i,s,c,u,d,p,h,f=this;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:if(this.db)return[2];e=this.storage,t=e.name,n=e.version,a.label=1;case 1:return a.trys.push([1,8,,9]),this.eventBus.emit(o.BootstrapStart),r=this.getDatabaseSchema(),[4,this.migrationManager.prepareAutoUpgradeHandler(t,this.engine)];case 2:i=a.sent(),s=function(){f.eventBus.emit(o.Fetal,new E(t))},a.label=3;case 3:return a.trys.push([3,5,,7]),c=this,[4,this.engine.openDB(t,r,n,{upgrade:i,terminated:s})];case 4:return c.db=a.sent(),[3,7];case 5:if("VersionError"!==(u=a.sent()).name||!this.supportCompatibleOpen)throw u;return d=this,[4,this.engine.openDB(t,r,void 0,{upgrade:i,terminated:s})];case 6:return d.db=a.sent(),[3,7];case 7:return this.db.setVersionChangeListener((function(e,t){f.eventBus.emit(o.VersionChange,{oldVersion:e,newVersion:t})})),this.eventBus.emit(o.BootstrapEnd),this.eventBus.emit(o.Ready,this.db),[3,9];case 8:throw p=a.sent(),this.reset(),h=new l(t,p),this.eventBus.emit(o.Error,h),this.eventBus.emit(o.Fetal,h),h;case 9:return[2]}}))}))}))]}))}))},this.handleModelRegistered=function(e){if(!r.schemas.some((function(t){return t.name===e.schema.name}))){var t=e.schema;t.dataVersion=r.storage.version,r.schemas.push(t)}},this.handleFetal=function(){r.reset()},this.storage=e,this.engine=t.engine,this.eventBus=t.eventBus,this.supportCompatibleOpen=t.supportCompatibleOpen,this.engine.setAspects(e.aspects.engine),this.schemas=[ut.getSystemTableSchema()],t.databaseSchema){var i=JSON.parse(t.databaseSchema).collections.map((function(e){return(0,a.__assign)((0,a.__assign)({},e),{dataVersion:r.storage.version})}));(n=this.schemas).push.apply(n,(0,a.__spreadArray)([],(0,a.__read)(i)))}this.migrationManager=new vt(this.eventBus,this,e.aspects.migration),this.eventBus.on(o.RegisterModel,this.handleModelRegistered),this.eventBus.on(o.Fetal,this.handleFetal)}return e.prototype.getDatabaseEngine=function(){return this.engine},e.prototype.getDatabaseSchema=function(){if(!this.storage.name||!this.storage.version)throw new Error("The database name and version are required for generating dbSchema");return{name:this.storage.name,version:this.storage.version,collections:this.schemas}},e.prototype.closeDatabase=function(){return(0,a.__awaiter)(this,void 0,void 0,(function(){var e=this;return(0,a.__generator)(this,(function(t){return[2,this.closingMutex.lock((function(){return(0,a.__awaiter)(e,void 0,void 0,(function(){return(0,a.__generator)(this,(function(e){switch(e.label){case 0:return this.db?[4,this.db.close()]:[2];case 1:return e.sent(),this.reset(),this.eventBus.emit(o.Closed),[2]}}))}))}))]}))}))},e.prototype.destroyDatabase=function(){var e=this;return this.destroyingMutex.lock((function(){return(0,a.__awaiter)(e,void 0,void 0,(function(){return(0,a.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.engine.deleteDB(this.storage.name)];case 1:return e.sent(),this.reset(),this.eventBus.emit(o.Destroyed),[2]}}))}))}))},e.prototype.reset=function(){this.db=void 0},e}(),bt=mt,_t=function(e){return setTimeout(e)},Ct=function(){function e(e){var t=e.keepActive,n=e.comparer,r=e.channelDB,o=e.channelModel,i=e.channelLazyMigration;this.keepActive=t,this.comparer=n,this.channelDB=r,this.channelModel=o,this.channelLazyMigration=i}return e.fromTransactionManager=function(t,n){return void 0===n&&(n=!1),new e({keepActive:n,comparer:t.comparer,channelDB:t.channelDB,channelModel:t.channelModel,channelLazyMigration:t.channelLazyMigration})},e.prototype.openTransaction=function(e,t){return(0,a.__awaiter)(this,void 0,void 0,(function(){var n=this;return(0,a.__generator)(this,(function(r){return this.transactionPromise=(0,a.__awaiter)(n,void 0,void 0,(function(){var n,r,o=this;return(0,a.__generator)(this,(function(i){switch(i.label){case 0:return[4,Promise.all(e.map((function(e){return o.waitForModelRegistered(e)})))];case 1:return i.sent(),[4,Promise.all(e.map((function(e){return o.waitForMigrationReady(e)})))];case 2:return i.sent(),[4,this.waitForDBReady()];case 3:return n=i.sent(),r=this,[4,n.transaction(e,t)];case 4:return r.transaction=i.sent(),[2,this.transaction]}}))})),[2,this.transactionPromise]}))}))},e.prototype.getTransaction=function(e,t){return(0,a.__awaiter)(this,void 0,void 0,(function(){return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return this.transactionPromise?[3,2]:[4,this.openTransaction(e,t)];case 1:n.sent(),n.label=2;case 2:return[4,this.transactionPromise];case 3:return[2,n.sent()]}}))}))},e.prototype.waitForDBReady=function(){return(0,a.__awaiter)(this,void 0,void 0,(function(){return(0,a.__generator)(this,(function(e){return[2,this.channelDB.pick()]}))}))},e.prototype.waitForModelRegistered=function(e){return(0,a.__awaiter)(this,void 0,void 0,(function(){return(0,a.__generator)(this,(function(t){return[2,this.channelModel.pick(e)]}))}))},e.prototype.waitForMigrationReady=function(e){return(0,a.__awaiter)(this,void 0,void 0,(function(){return(0,a.__generator)(this,(function(t){return[2,this.channelLazyMigration.pick(e)]}))}))},e.prototype.perform=function(e){return this.keepActive?e():this.autoCommitOrRollback(e)},e.prototype.autoCommitOrRollback=function(e){var t,n;return(0,a.__awaiter)(this,void 0,void 0,(function(){var r,o;return(0,a.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,5]),[4,e()];case 1:return r=i.sent(),[4,null===(t=this.transaction)||void 0===t?void 0:t.commit()];case 2:return i.sent(),[2,r];case 3:return o=i.sent(),[4,null===(n=this.transaction)||void 0===n?void 0:n.rollback()];case 4:throw i.sent(),o;case 5:return[2]}}))}))},e}(),St=Symbol("channel"),wt=function(e){var t;void 0===e&&(e=function(){return St});var n=new Map,r=new Map;function o(e,t){var n;null===(n=r.get(e))||void 0===n||n.reject(t),r.delete(e)}function i(e,t){void 0===t&&(t=St),r.has(t)?function(e,t){var n;null===(n=r.get(e))||void 0===n||n.resolve(t),r.delete(e)}(t,e):n.set(t,Promise.resolve(e))}return{send:function(n){t||i(n,e(n))},pick:function(e){return void 0===e&&(e=St),t?Promise.reject(t):(n.has(e)||n.set(e,new Promise((function(t,n){r.set(e,{resolve:t,reject:n})}))),n.get(e))},open:function(){t=void 0},close:function(e,i){var s,c;void 0===i&&(i=!1),t=e;try{for(var l=(0,a.__values)(r.keys()),u=l.next();!u.done;u=l.next())o(u.value,e)}catch(e){s={error:e}}finally{try{u&&!u.done&&(c=l.return)&&c.call(l)}finally{if(s)throw s.error}}i&&(n.clear(),r.clear())}}},Et=function(){function e(e,t){var n=this;this.handleFetalError=function(e){n.channelDB.close(e,!0),n.channelModel.close(e),n.channelLazyMigration.close(e)},this.eventBus=e,this.channelDB=wt(),this.channelModel=wt((function(e){return e.schema.name})),this.channelLazyMigration=wt((function(e){return e})),this.comparer=t,this.eventBus.on(o.Fetal,this.handleFetalError),this.eventBus.on(o.Ready,this.channelDB.send),this.eventBus.on(o.RegisterModel,this.channelModel.send),this.eventBus.on(i.ModelLazyMigrationEnd,this.channelLazyMigration.send)}return e.prototype.spawnAutoCommitContext=function(){return Ct.fromTransactionManager(this,!1)},e.prototype.spawnKeepAliveContext=function(){return Ct.fromTransactionManager(this,!0)},e.prototype.openChannels=function(){this.channelDB.open(),this.channelModel.open(),this.channelLazyMigration.open()},e}(),xt=function(){function e(e){var t,n=this,r=e.name,o=e.engine,s=e.version,c=void 0===s?1:s,l=e.plugins,u=void 0===l?[]:l,d=e.disableAutoOpen,p=void 0!==d&&d,h=e.databaseSchema,f=e.supportCompatibleOpen,g=void 0!==f&&f;this.aspects={collection:{get:et.withContext(tt),has:et.withContext(tt),delete:et.withContext(tt),insert:et.withContext(tt),upsert:et.withContext(tt),bulkInsert:et.withContext(tt),bulkUpsert:et.withContext(tt),update:et.withContext(tt),clear:et.withContext(tt),count:et.withContext(tt),entries:et.withContext(tt),keys:et.withContext(tt),values:et.withContext(tt),first:et.withContext(tt),last:et.withContext(tt),skip:Je.withContext(tt),take:Je.withContext(tt),slice:Je.withContext(tt),orderBy:Je.withContext(tt),where:Je.withContext(tt),or:Je.withContext(tt)},query:{},model:{},migration:{prepareAutoUpgradeHandler:et.withContext(tt),buildMigration:Je.withContext(tt),executeDataMigration:et.withContext(tt),executeSchemaMigration:Je.withContext(tt),updateMigrationChangeInfo:et.withContext(tt),log:Je.withContext(tt),actionExecutor:{executeSchemaAction:Je.withContext(tt),executeDataAction:et.withContext(tt)}},engine:{deleteDB:et.withContext(tt),openDB:et.withContext(tt),database:{createTable:Je.withContext(tt),deleteTable:Je.withContext(tt),close:Je.withContext(tt),table:et.withContext(tt),transaction:et.withContext(tt)},table:{createIndex:et.withContext(tt),deleteIndex:et.withContext(tt),delete:et.withContext(tt),get:et.withContext(tt),getAll:et.withContext(tt),getAllKeys:et.withContext(tt),index:Je.withContext(tt),insert:et.withContext(tt),query:et.withContext(tt),openCursor:et.withContext(tt),upsert:et.withContext(tt),bulkUpsert:et.withContext(tt),clear:et.withContext(tt),bulkDelete:et.withContext(tt)},index:{get:et.withContext(tt),getAll:et.withContext(tt),getAllKeys:et.withContext(tt),openCursor:et.withContext(tt)},cursor:{delete:et.withContext(tt),update:et.withContext(tt),next:et.withContext(tt),value:Je.withContext(tt)},transaction:{commit:et.withContext(tt),rollback:et.withContext(tt),table:Je.withContext(tt)}}},this.eventBus=(0,D.i)(),this.open=function(){return n.transactionManager.openChannels(),n.databaseManager.openDatabase()},this.close=function(){return n.databaseManager.closeDatabase()},this.destroy=function(){return n.databaseManager.destroyDatabase()},this.register=function(e){n.modelManager.register(e)},this.collection=function(e){var t=n.modelManager.getSchemaAndRegisterModelIfNeed(e);return n.collectionManager.getCollection(t.name,{spawnContext:function(){return n.transactionManager.spawnAutoCommitContext()}})},this.transaction=function(e,t,r){return(0,a.__awaiter)(n,void 0,void 0,(function(){var n,o,s,c=this;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return n=this.transactionManager,o=e.map((function(e){return c.modelManager.getSchemaAndRegisterModelIfNeed(e).name})),s=n.spawnKeepAliveContext(),this.eventBus.emit(i.StartTransaction,{collectionNames:o,context:s}),[4,s.openTransaction(o,t)];case 1:return a.sent(),[2,s.autoCommitOrRollback((function(){return r(c.createStorageTransaction(s))}))]}}))}))},this.name=r,this.version=c,this.events=new A(this.eventBus),this.modelManager=new N(this.eventBus),this.databaseManager=new bt(this,{engine:o,eventBus:this.eventBus,databaseSchema:h,supportCompatibleOpen:g}),this.pluginManager=new ot(this,this.eventBus),this.collectionManager=new Ke(this,this.eventBus),this.transactionManager=new Et(this.eventBus,{cmp:this.databaseManager.getDatabaseEngine().cmp}),(t=this.pluginManager).add.apply(t,(0,a.__spreadArray)([],(0,a.__read)(u))),p||_t((function(){return n.open().catch((function(e){throw e}))}))}return e.prototype.createStorageTransaction=function(e){var t=this.modelManager,n=new Ke(this,this.eventBus);return{collection:function(r){var o=t.getSchemaAndRegisterModelIfNeed(r);return n.getCollection(o.name,{spawnContext:function(){return e}})}}},e}(),Tt=xt},96860:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r={version:6,autoRun:!0,ignoreDefaultSources:!0,cdnSources:n(88834).cdnSources,duration:6e4};t.default=r},88834:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.cdnSources=void 0;var o=r(n(5593)).default.getInstance().getConfig('npm["@tencent/netcheck"]');t.cdnSources=Object.values((null==o?void 0:o.cdnSources)||["https://docs.qq.com/net-check/img","https://docs.gtimg.com/components/img/1px.gif","https://docs2.gtimg.com/components/img/1px.gif"])},98975:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.promiseAny=t.createSingleton=void 0,t.createSingleton=function(e){if(window.tdocsNetcheck){var t=window.tdocsNetcheck.getVersion();e.getVersion()>t&&(e.extendCallbacks(window.tdocsNetcheck.getCallbacks()),window.tdocsNetcheck.destory(),window.tdocsNetcheck=e,window.tdocsNetcheck.init())}else window.tdocsNetcheck=e,window.tdocsNetcheck.init();return window.tdocsNetcheck},t.promiseAny=function(e){return new Promise((function(t,n){var r=e.length;r||n(new AggregateError("null"));var o=[];e.forEach((function(e){e.then((function(e){return t(e)})).catch((function(e){r-=1,o.push(e),r||n(new AggregateError(o))}))}))}))}},73557:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.network=void 0;var o=n(98975),i=r(n(58419)).default.create({autoRun:!1}),a=o.createSingleton(i);t.network=a},58419:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a,s,c=i(n(86667)),l=i(n(96860)),u=n(98975);!function(e){e.OFF_LINE="offline",e.ON_LINE="online"}(a||(a={})),window.__offlinetest=!1,void 0!==document.hidden?s="visibilitychange":void 0!==document.mozHidden?s="mozvisibilitychange":void 0!==document.msHidden?s="msvisibilitychange":void 0!==document.webkitHidden&&(s="webkitvisibilitychange");var d=function(){function e(e){var t=this;this.cdnSources=l.default.cdnSources,this.autoRun=l.default.autoRun,this.duration=l.default.duration,this.counter=0,this.handleVisibility=function(){document.hidden||document.webkitHidden||document.msHidden||document.mozHidden?(t.duration=3e5,t.pause(),t.startCheck()):(t.duration=6e4,t.pause(),t.startCheck())},this.handleNetstatus=function(){return r(t,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:return e=this,[4,this.netcheck()];case 1:return e.status=t.sent(),this.handleCalback(),[2]}}))}))},this.setConfig(e),this.status=this.navigatorOnlineStatus,this.netchecksource=this.cdnSources[0],this.callbacks=[],this.autoRun&&this.init()}return e.create=function(t){return new e(t)},e.getInstance=function(t){return e.instance||(e.instance=e.create(t)),e.instance},e.prototype.setConfig=function(e){var t=e.cdnSources,n=void 0===t?this.cdnSources:t,r=e.ignoreDefaultSources,o=void 0===r?l.default.ignoreDefaultSources:r,i=e.autoRun,a=void 0===i?this.autoRun:i,s=e.duration,c=void 0===s?this.duration:s;Array.isArray(n)&&(this.cdnSources=o?n:this.cdnSources.concat(n)),this.autoRun=!!a,Number.isInteger(c)&&(this.duration=c)},e.prototype.getVersion=function(){return e.version},e.prototype.init=function(){return r(this,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:return[4,this.preNetCheck()];case 1:return e=t.sent(),this.status=e,this.bindVisibility(),this.bindNetStatus(),this.startCheck(),[2]}}))}))},Object.defineProperty(e.prototype,"isOnline",{get:function(){return!window.__offlinetest&&this.status===a.ON_LINE},enumerable:!1,configurable:!0}),e.prototype.changeEnd=function(e){this.callbacks.push(e)},e.prototype.extendCallbacks=function(e){this.callbacks=this.callbacks.concat(e.slice())},e.prototype.getCallbacks=function(){return this.callbacks},e.prototype.remove=function(e){for(var t=this.callbacks.slice(0,this.callbacks.length),n=0;n<t.length;n++)t[n]===e&&(t.splice(n,1),this.callbacks=t)},e.prototype.handleCalback=function(){var e=this;this.callbacks.forEach((function(t){t(e.status)}))},e.prototype.destory=function(){window.mqq&&c.default.isAndroid&&(c.default.isTencentDocsApp||c.default.isTimOrQQ)&&!c.default.isQQMiniProgram?window.mqq.removeEventListener("qbrowserVisibilityChange",this.handleVisibility):document.removeEventListener(s,this.handleVisibility),this.pause(),window.removeEventListener(a.ON_LINE,this.handleNetstatus),window.removeEventListener(a.OFF_LINE,this.handleNetstatus)},e.prototype.bindNetStatus=function(){window.addEventListener(a.ON_LINE,this.handleNetstatus),window.addEventListener(a.OFF_LINE,this.handleNetstatus)},e.prototype.bindVisibility=function(){window.mqq&&c.default.isAndroid&&(c.default.isTencentDocsApp||c.default.isTimOrQQ)&&!c.default.isQQMiniProgram?window.mqq.addEventListener("qbrowserVisibilityChange",this.handleVisibility):document.addEventListener(s,this.handleVisibility)},e.prototype.pause=function(){clearInterval(this.Timer),this.Timer=null},e.prototype.startCheck=function(){var e=this;this.Timer=window.setInterval((function(){return r(e,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,this.polling()];case 1:return e.sent(),[2]}}))}))}),this.duration)},e.prototype.polling=function(){return r(this,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:return this.preCheckOnlineStatus?[3,1]:(this.status=this.navigatorOnlineStatus,[3,3]);case 1:return e=this,[4,this.netcheck()];case 2:e.status=t.sent(),t.label=3;case 3:return this.counter>=15?[4,this.preNetCheck()]:[3,5];case 4:return t.sent(),this.counter=0,[3,6];case 5:this.counter+=1,t.label=6;case 6:return this.handleCalback(),[2]}}))}))},Object.defineProperty(e.prototype,"navigatorOnlineStatus",{get:function(){return window.navigator.onLine?a.ON_LINE:a.OFF_LINE},enumerable:!1,configurable:!0}),e.prototype.preNetCheck=function(){return r(this,void 0,void 0,(function(){var e=this;return o(this,(function(t){return[2,new Promise((function(t){var n=e.cdnSources.map((function(t){return e.sourceCheck(t)}));u.promiseAny(n).then((function(n){e.preCheckOnlineStatus=!0,e.netchecksource=n,t(a.ON_LINE)})).catch((function(){e.preCheckOnlineStatus=!1,t(a.OFF_LINE)}))}))]}))}))},e.prototype.sourceCheck=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){return t=new Image,[2,new Promise((function(n,r){t.onload=function(){n(e)},t.onerror=function(){r(e+" load fail")},t.src=e+"?t="+Date.now()}))]}))}))},e.prototype.netcheck=function(){return r(this,void 0,void 0,(function(){var e=this;return o(this,(function(t){return this.netcheckImage||(this.netcheckImage=new Image),[2,new Promise((function(t){e.netcheckImage.onload=function(){t(a.ON_LINE)},e.netcheckImage.onerror=function(){t(a.OFF_LINE)},e.netcheckImage.src=e.netchecksource+"?t="+Date.now()}))]}))}))},e.version=l.default.version,e}();t.default=d},26914:function(e,t,n){var r,o,i;n.d(t,{ir:function(){return Z},r8:function(){return Y},GU:function(){return u},XT:function(){return r},oo:function(){return J},Rs:function(){return i},RR:function(){return T},E1:function(){return o},he:function(){return a},x4:function(){return p},ZP:function(){return te},FG:function(){return R}}),function(e){e[e.ClientDB=0]="ClientDB",e[e.IndexDB=1]="IndexDB"}(r||(r={})),function(e){e[e.IN=0]="IN",e[e.LOWER_BOUND=1]="LOWER_BOUND",e[e.UPPER_BOUND=2]="UPPER_BOUND",e[e.BOUND=3]="BOUND",e[e.ONLY=4]="ONLY",e[e.NOT_IN=5]="NOT_IN"}(o||(o={})),function(e){e[e.INCREASE=0]="INCREASE",e[e.DECREASE=1]="DECREASE",e[e.INCREASE_BY_TEXT=2]="INCREASE_BY_TEXT",e[e.DECREASE_BY_TEXT=3]="DECREASE_BY_TEXT"}(i||(i={}));var a=function(){function e(){this._conditions=new Array,this._limitCount=Number.MAX_VALUE,this._offsetCount=0,this._orders=[]}return e.newInstance=function(){return new e},e.prototype.addCondition=function(e,t,n){var r=n;if(t===o.LOWER_BOUND)(i=n).open=void 0===i.open||i.open,r=i;else if(t===o.UPPER_BOUND)(i=n).open=void 0===i.open||i.open,r=i;else if(t===o.BOUND){var i;(i=n).lowerOpen=void 0===i.lowerOpen||i.lowerOpen,i.upperOpen=void 0===i.upperOpen||i.upperOpen,r=i}return this._conditions.push({type:t,column:e,value:r}),this},e.prototype.index=function(e){this._index=e},e.prototype.getIndexKey=function(){return this._index},e.prototype.limit=function(e,t){if(void 0===t?this._limitCount=e:(this._limitCount=t,this._offsetCount=e),this._limitCount<=0)throw new Error("limit size must be opposite value.");return this},e.prototype.offset=function(e){if(e<0)throw new Error("offset size must be opposite value or zero.");return this._offsetCount=e,this},e.prototype.orderby=function(e,t){return this._orders.push({key:e,type:t}),this},e.prototype.hasOrder=function(){return this._orders.length>0},e.prototype.getOrders=function(){return this._orders},e.prototype.hasIndex=function(){return void 0!==this._index},e.prototype.limitSize=function(){return this._limitCount},e.prototype.offsetCount=function(){return this._offsetCount},Object.defineProperty(e.prototype,"conditions",{get:function(){return this._conditions},enumerable:!1,configurable:!0}),e}();window.QueryCondition=a,window.QUERY_CONDITION_TYPE=o;var s,c,l=(s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},s(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),u=function(e){function t(t){var n=e.call(this,t)||this;return n.errorType="BaseError",n}return l(t,e),t.copyFrom=function(e){var n=new t(e.message);return n.name=e.name,n.stack=e.stack,n},t}(Error),d=u,p=function(e,t){void 0!==e&&(void 0===e.errorType?this.error=d.copyFrom(e):this.error=e),void 0!==t&&(this.data=t)},h=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(e){e.NO_RESULT_ERROR="noResultError"}(c||(c={}));var f,g,v,y=function(e){function t(t,n){var r=e.call(this,n)||this;return r.name="DataError",r.errorType=t,r}return h(t,e),t}(d),m=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},b=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},_=function(){function e(e){this._canAutoResume=!0,this._dbName=e.databaseName,this._dbVersion=e.version,this._tables=e.tables}return e.prototype.setAutoResume=function(e){void 0===e&&(e=!0),this._canAutoResume=e},e.prototype.disConnect=function(e){return void 0===e&&(e=!0),m(this,void 0,void 0,(function(){return b(this,(function(e){return[2,Promise.resolve(new p(void 0,!0))]}))}))},e}(),C=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r},S=window,w=function(){function e(){}return e.debug=function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];try{S.log?(t=S.log).debug.apply(t,n):console.debug.apply(console,n)}catch(t){e.error("","debug",n)}},e.log=function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];try{S.log?(t=S.log).info.apply(t,n):console.log.apply(console,n)}catch(t){e.error("","log",n)}},e.warn=function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];try{S.log?(t=S.log).warn.apply(t,n):console.warn.apply(console,n)}catch(t){e.error("","warn",n)}},e.error=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{S.log?(e=S.log).error.apply(e,t):console.error.apply(console,t)}catch(e){console.error("","error",t)}},e.time=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r={time:Date.now(),options:t};this.sTimeLableMap.set(e,r)},e.timeEnd=function(t){var n=Date.now(),r=e.sTimeLableMap.get(t);if(void 0!==r){var o=n-r.time,i="";r.options&&3===r.options.length&&"clientDatabaseRequest"===r.options[1]&&(i=r.options[2]),e.log.apply(e,C(["label: "+t+": "+o+"ms."],r.options)),e.speedReport(o,i),this.sTimeLableMap.delete(t)}},e.speedReport=function(e,t){t&&S.dbjsApiSpeedReport&&S.dbjsApiSpeedReport(e,t)},e.sTimeLableMap=new Map,e}(),E=w,x=function(){function e(){this.canUseNativeAndroid=window.mqq&&window.mqq.android&&window._mqqWebViewJSInterface&&window._mqqWebViewJSInterface.invoke,this.currentSeqId=0,this.reqCallbacks=new Map}return e.prototype.JSApiCallback=function(e){var t=this.reqCallbacks.get(e.callbackId);if(t){var n=t.callback,r=t.command,o=t.startTime;n&&(E.debug("callback invokeNative-"+e.callbackId+"-"+r+"-"+(Date.now()-o)+"ms",this.canUseNativeAndroid,"response="+JSON.stringify(e)),n(e))}else E.warn("callback invokeNative-"+e.callbackId+" reqCallback not found")},e.prototype.createReqSeq=function(){return this.currentSeqId++},e.prototype.invokeNative=function(e,t,n,r){var o=this.createReqSeq(),i=n.command;this.reqCallbacks.set(o,{callback:r,command:i,startTime:Date.now()}),E.debug("start call invokeNative-"+o+"-"+i,e,t,i,this.canUseNativeAndroid,"request="+JSON.stringify(n)),n.callbackId=o,this.canUseNativeAndroid?this.invokeNativeAndroid(e,t,n):window.mqq&&window.mqq.invoke(e,t,n)},e.prototype.invokeNativeAndroid=function(e,t,n){var r="jsbridge://"+encodeURIComponent(e)+"/"+encodeURIComponent(t);n&&(r+="?p="+encodeURIComponent(JSON.stringify(n))),window._mqqWebViewJSInterface.invoke(r)},e.prototype.defaultOfflineCodeVersion=function(e,t){E.debug("defaultOfflineCodeVersion-"+e),window.mqq&&window.mqq.invoke("docx","defaultOfflineCodeVersion",{type:e},(function(n){E.debug("defaultOfflineCodeVersion-"+e),t&&t(n)}))},e}(),T=window.jsApi;function R(e){return e.errorType===c.NO_RESULT_ERROR}function I(e,t){return Array.isArray(e)?e.map((function(e){return new t.prototype.constructor(e)})):new t.prototype.constructor(e)}function P(e,t){return function(n,r,o){var i=o.value;o.value=function(){var n=i.apply(this,arguments);return arguments[0]===t?n.then((function(t){return t.error||(t.data=I(t.data,e)),t})):n}}}function O(e,t,n){return void 0===n&&(n=!0),n?e<t:e<=t}window.jsApi||(T=new x,window.jsApi=T,window.JSApiCallback||(window.JSApiCallback=T.JSApiCallback.bind(T))),window,function(e){e[e.EXCEL=1]="EXCEL",e[e.WORD=0]="WORD"}(f||(f={})),function(e){e.NEW="new",e.LOCAL="local",e.DELETED="deleted",e.NORMAL="normal"}(g||(g={})),function(e){e.INIT="init",e.DOCUMENT="document",e.WORKBOOK="workbook",e.CHUNK="chunk",e.ACCEPTED="accepted",e.MISS_CHANGE="misschange",e.NEW_CHANGE="newchange",e.COMMITING="commiting",e.WATTING="watting",e.QUEUE="queue"}(v||(v={}));var k,D=function(){function e(t){this.chunkId=0,this.default=!1,t.taskId||(t.taskId=e.createMessageSeq()),t.key||(t.chunkId=t.chunkId||0,t.type===v.INIT?t.key=t.globalPadId+"_"+t.subSheetId+"_"+t.uid:t.type===v.DOCUMENT?t.key=t.globalPadId+"_"+t.uid+"_version_"+t.version:t.type===v.WORKBOOK?t.key=t.globalPadId+"_"+t.subSheetId+"_"+t.uid+"_version_"+t.version:t.type===v.CHUNK?t.key=t.globalPadId+"_"+t.subSheetId+"_"+t.chunkId+"_"+t.uid+"_version_"+t.version:t.key=t.globalPadId+"_"+t.subSheetId+"_"+t.uid+"_taskId_"+t.taskId),t.default=t.default||!1,this.key=t.key,this.uid=t.uid,this.globalPadId=t.globalPadId,this.secretId=t.secretId,this.subSheetId=t.subSheetId,this.chunkId=t.chunkId,this.type=t.type,this.docType=t.docType,this.padStatus=t.padStatus,this.taskId=t.taskId,this.version=t.version,this.data=t.data||t._data,this.default=t.default,this.createTime=t.createTime,this.dver=t.dver}return e.createMessageSeq=function(){return Math.ceil(2147483648*Math.random())},e.prototype.disableConvert=function(){return this.docType===f.WORD&&"BB08J2"!==this.subSheetId},Object.defineProperty(e.prototype,"data",{get:function(){if("string"==typeof this._data&&!this.disableConvert()){var e=this._data;try{e=JSON.parse(this._data)}catch(e){w.error(e)}return e}return this._data},set:function(e){this._data="string"!=typeof e?JSON.stringify(e):e},enumerable:!1,configurable:!0}),e}(),M=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),A=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},L=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},N=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},B=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},F="client_data_base_performance",U=function(e){function t(t){return e.call(this,t)||this}return M(t,e),t.isValidResponse=function(e){return"object"==typeof e},t.prototype.init=function(){var e=this;return new Promise((function(t,n){var r=Date.now(),o={command:"init",table:e._tables,dbName:e._dbName};e.clientDatabaseRequest(o,(function(n){if(n.err_msg||n.err_code){var i=new Error(n.err_msg||n.err_code);t(new p(i))}else t(new p(void 0,void 0));e.reportBeacon(F,r,o,n)}))}))},t.prototype.set=function(e,t){var n=this;return new Promise((function(r,o){var i=Date.now(),a={command:"set",tableName:e,data:t,dbName:n._dbName};n.clientDatabaseRequest(a,(function(e){if(e.err_msg||e.err_code){var t=new Error(e.err_msg||e.err_code);r(new p(t))}else r(new p(void 0,e.result));n.reportBeacon(F,i,a,e)}))}))},t.prototype.update=function(e,t){var n=this;return new Promise((function(r,o){var i=Date.now(),a={command:"update",tableName:e,data:t,dbName:n._dbName};n.clientDatabaseRequest(a,(function(e){if(e.err_msg||e.err_code){var t=new Error(e.err_msg||e.err_code);r(new p(t))}else r(new p(void 0,e.result));n.reportBeacon(F,i,a,e)}))}))},t.prototype.updateField=function(e,t,n){var r=this;return new Promise((function(o,i){var a=Date.now(),s={command:"updateField",tableName:e,where:t,toBeUpdated:n,dbName:r._dbName};r.clientDatabaseRequest(s,(function(e){if(e.err_msg||e.err_code){var t=new Error(e.err_msg||e.err_code);o(new p(t))}else o(new p(void 0,e.result));r.reportBeacon(F,a,s,e)}))}))},t.prototype.updateMultiTableData=function(e){var t=this;return new Promise((function(n,r){var o=Date.now(),i={command:"updateMultiTableData",multiData:e,dbName:t._dbName};t.clientDatabaseRequest(i,(function(e){if(e.err_msg||e.err_code){var r=new Error(e.err_msg||e.err_code);n(new p(r))}else n(new p(void 0,e.result));t.reportBeacon(F,o,i,e)}))}))},t.prototype.delete=function(e,t){var n=this;return new Promise((function(r,o){var i=Date.now(),a={command:"delete",tableName:e,where:t,dbName:n._dbName};n.clientDatabaseRequest(a,(function(e){if(e.err_msg||e.err_code){var t=new Error(e.err_msg||e.err_code);r(new p(t))}else r(new p(void 0,e.result));n.reportBeacon(F,i,a,e)}))}))},t.prototype.deleteAndWrite=function(e,t,n){var r=this;return new Promise((function(o,i){var a=Date.now(),s={command:"deleteAndWrite",tableName:e,where:t,newData:n,dbName:r._dbName};r.clientDatabaseRequest(s,(function(e){if(e.err_msg||e.err_code){var t=new Error(e.err_msg||e.err_code);o(new p(t))}else o(new p(void 0,e.result));r.reportBeacon(F,a,s,e)}))}))},t.prototype.get=function(e,t){return N(this,void 0,void 0,(function(){var n=this;return B(this,(function(r){return[2,new Promise((function(r,o){var i=Date.now(),a={command:"get",tableName:e,where:t,dbName:n._dbName};n.clientDatabaseRequest(a,(function(e){if(e.err_msg||e.err_code){var t=new Error(e.err_msg||e.err_code);r(new p(t))}else e.result?r(new p(void 0,e.result)):r(new p(new y(c.NO_RESULT_ERROR,"")));n.reportBeacon(F,i,a,e)}))}))]}))}))},t.prototype.getAll=function(e,t){var n=this;return new Promise((function(r,o){var i=Date.now(),a={command:"getAll",tableName:e,where:t,dbName:n._dbName};n.clientDatabaseRequest(a,(function(e){if(e.err_msg||e.err_code){var t=new Error(e.err_msg||e.err_code);r(new p(t))}else r(new p(void 0,e.result||[]));n.reportBeacon(F,i,a,e)}))}))},t.prototype.reportBeacon=function(e,t,n,r){try{window.beaconHandler&&window.beaconHandler.onUserAction(e,{tableName:n.tableName||"",command:n.command||"",dbName:n.dbName||"",error_msg:r.err_msg||"",consume_time:Date.now()-t,event_result:r.err_code||0,cost:Date.now()-t,resultCode:r.err_code||0})}catch(e){w.error(e)}},t.prototype.clientDatabaseRequest=function(e,t){var n;(null===(n=window.tdocs)||void 0===n?void 0:n.clientDatabaseRequest)?window.tdocs.clientDatabaseRequest(e).then(t):T.invokeNative("docx","clientDatabaseRequest",e,t)},A([P(D,"OfflineData"),P(D,"DocumentData"),L("design:type",Function),L("design:paramtypes",[String,a]),L("design:returntype",Promise)],t.prototype,"get",null),A([P(D,"OfflineData"),P(D,"DocumentData"),L("design:type",Function),L("design:paramtypes",[String,a]),L("design:returntype",void 0)],t.prototype,"getAll",null),t}(_),H=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(e){e.NOT_SUPPORT_INDEXEDDB="notSupportIndexedDB",e.OPEN_FAIL="openFail",e.TRANSACTION_FAIL="transactionFail",e.DB_BLOCKED="DBBlocked",e.CHECK_FAIL="checkFail",e.REQUEST_ERROR="requestError"}(k||(k={}));var j=function(e){function t(t,n){var r=e.call(this,n)||this;return r.name="DBError",r.errorType=t,r}return H(t,e),t}(d),G=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),V=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},W=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},z=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},K=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},q=function(e){function t(t){var n=e.call(this,t)||this;return n.openErrorCount=0,n}return G(t,e),t.prototype.init=function(e){return z(this,void 0,void 0,(function(){var t=this;return K(this,(function(n){return[2,new Promise((function(n,r){return z(t,void 0,void 0,(function(){var t,r,o,i;return K(this,(function(a){switch(a.label){case 0:return E.time("IndexedDatabaseInit"),(t=this)._indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,t._indexedDB?e?[4,this.deleteDB()]:[3,2]:(E.error("IndexedDatabase","NOT_SUPPORT_INDEXEDDB"),t.database=null,r=new j(k.NOT_SUPPORT_INDEXEDDB),n(new p(r)),[2]);case 1:(o=a.sent()).error&&E.error(o.error),a.label=2;case 2:try{i=t._indexedDB.open(t._dbName,t._dbVersion)}catch(e){return E.error("IndexedDatabase","open() error",e),t.database=null,r=new j(k.OPEN_FAIL,e.name||e.message||""),n(new p(r)),[2]}return i.onerror=function(e){return z(this,void 0,void 0,(function(){var o,a,s,c;return K(this,(function(l){switch(l.label){case 0:return t.openErrorCount++,i.error&&"InvalidStateError"===i.error.name&&e.preventDefault(),E.error("IndexedDatabase","init() onerror()",e),t.database=null,t.openErrorCount<2&&e&&e.target&&e.target.error&&"VersionError"===e.target.error.name?(o=t._dbVersion+1,a=e.target.error.message,(s=/\((\d+)\).*\((\d+)\)/.exec(a))&&(o=Number(s[2])),t._dbVersion=o,[4,t.init()]):[3,2];case 1:return c=l.sent(),n(c),[2];case 2:return r=new j(k.REQUEST_ERROR,e),n(new p(r)),[2]}}))}))},i.onsuccess=function(e){E.timeEnd("IndexedDatabaseInit"),t.database=i.result,t.database.onversionchange=function(){window.dispatchEvent(new Event("OnTencentDocsDBVersionChanged"))},n(new p(void 0,i.result))},i.onblocked=function(e){E.error("IndexedDatabase","init() onblocked()",e),t.database=null,r=new j(k.DB_BLOCKED),n(new p(r,e))},i.onupgradeneeded=function(e){E.warn("IndexedDatabase","init() onupgradeneeded()",e);var n=e.target.result;n.objectStoreNames&&t._tables.forEach((function(e){var t;n.objectStoreNames.contains(e.tableName)||(t=e.keyName?n.createObjectStore(e.tableName,{keyPath:e.keyName}):n.createObjectStore(e.tableName,{autoIncrement:!0}),e.indexs&&e.indexs.forEach((function(e){t.createIndex(e,e,{unique:!1})})))}))},[2]}}))}))}))]}))}))},t.prototype.deleteDB=function(){return z(this,void 0,void 0,(function(){var e=this;return K(this,(function(t){return[2,new Promise((function(t){var n,r=e._indexedDB.deleteDatabase(e._dbName);r.onsuccess=function(){t(new p(n,!0))},r.onerror=function(e){n=new j(k.REQUEST_ERROR,e),t(new p(n))}}))]}))}))},t.prototype.bindCommonEvent=function(e,t,n,r){t.onabort=function(){E.error("IndexedDatabase","bindCommonEvent() onabort","TransactionAbortError");var e=new Error("TransactionAbortError");window.dispatchEvent(new Event("OnDBTransactionAbort")),n(new p(e))},t.onerror=function(){E.error("IndexedDatabase","bindCommonEvent() onerror","UnKnownTransactionError");var e=new Error("UnKnownTransactionError");window.dispatchEvent(new Event("OnDBTransactionError")),n(new p(e))}},t.prototype.getDBConnection=function(e,t,n,r,i){var a,s,c;try{if(c=(s=this.database.transaction([e],n)).objectStore(e),t&&t.hasIndex()){var l=t.getIndexKey(),u=c.index(l),d=void 0,h=-1;if(t)for(var f=0;f<t.conditions.length;f++){var g=t.conditions[f];if(g.column===l){switch(g.type){case o.ONLY:d=IDBKeyRange.only(g.value),h=f;break;case o.LOWER_BOUND:var v=g.value;d=IDBKeyRange.lowerBound(v.lower,v.open),h=f;break;case o.UPPER_BOUND:var y=g.value;d=IDBKeyRange.upperBound(y.upper,y.open),h=f;break;case o.BOUND:var m=g.value;d=IDBKeyRange.bound(m.lower,m.upper,m.lowerOpen,m.upperOpen),h=f}if(-1!==h){t.conditions.splice(h,1);break}}}a=u.openCursor(d)}else a=c.openCursor();this.bindCommonEvent(a,s,r,1e4)}catch(e){return E.error("IndexedDatabase","getDBConnection() error",e),new p(e)}return E.debug("IndexedDatabase","getDBConnection() done."),new p(void 0,{request:a,transaction:s,objectStore:c})},t.prototype.set=function(e,t){return E.time("IndexedDatabaseSet",e,t),this.setOrUpdate("Set",e,t)},t.prototype.update=function(e,t){return E.time("IndexedDatabaseUpdate",e,t),this.setOrUpdate("Update",e,t)},t.prototype.setOrUpdate=function(e,t,n){return z(this,void 0,void 0,(function(){var r=this;return K(this,(function(o){return[2,new Promise((function(o,i){return z(r,void 0,void 0,(function(){var r,a,s,c,l;return K(this,(function(u){switch(u.label){case 0:return[4,this.checkAndOpenTable(t)];case 1:if(u.sent().error)return r=new j(k.CHECK_FAIL),o(new p(r)),[2];if((a=this.getDBConnection(t,void 0,"readwrite",o,i)).error)return o(new p(a.error)),[2];if(s=a.data.objectStore,c=a.data.transaction,"set"===e)l=s.add(n);else try{l=s.put(n,n.__primaryKey)}catch(e){l=s.put(n)}return l.onerror=function(e){r=new j(k.REQUEST_ERROR,e)},c.oncomplete=function(){E.timeEnd("IndexedDatabase"+e),o(new p(r,!0))},[2]}}))}))}))]}))}))},t.prototype.updateField=function(e,t,n){var r=this;return E.time("IndexedDatabaseUpdateField",e,t,n),new Promise((function(o,i){return z(r,void 0,void 0,(function(){var r,a,s,c,l,u;return K(this,(function(d){switch(d.label){case 0:return r=this,[4,this.checkAndOpenTable(e)];case 1:return d.sent().error?(a=new j(k.CHECK_FAIL),o(new p(a)),[2]):(s=this.getDBConnection(e,t,"readwrite",o,i)).error?(o(new p(s.error)),[2]):(c=s.data.request,l=s.data.transaction,c.onerror=function(e){a=new j(k.REQUEST_ERROR,e)},u=new Array,c.onsuccess=function(e){var o=e.target.result;if(o){var i=o.value;if(r.checkCondition(i,t)){var s=Object.assign(i,n);o.update(s).onerror=function(e){a=new j(k.REQUEST_ERROR,e)},u.push(s)}o.continue()}},l.oncomplete=function(){E.timeEnd("IndexedDatabaseUpdateField"),o(new p(a,u))},[2])}}))}))}))},t.prototype.updateMultiTableData=function(e){var t=this;return E.time("IndexedDatabaseUpdateMultiTableData",e),new Promise((function(n,r){return z(t,void 0,void 0,(function(){var t,r,o,i,a,s,c,l,u,d=this;return K(this,(function(h){switch(h.label){case 0:r=0,o=e,h.label=1;case 1:return r<o.length?(i=o[r],[4,this.checkAndOpenTable(i.tableName)]):[3,4];case 2:if(h.sent().error)return t=new j(k.CHECK_FAIL),n(new p(t)),[2];h.label=3;case 3:return r++,[3,1];case 4:a=e.map((function(e){return e.tableName}));try{s=this.database.transaction(a,"readwrite"),c=e.length,l=0,u=0,e.forEach((function(e){var t,r=s.objectStore(e.tableName);try{t=r.put(e.data,e.data.__primaryKey)}catch(n){t=r.put(e.data)}t.onsuccess=function(e){l++},t.onerror=function(e){u++,E.error(e)},d.bindCommonEvent(t,s,n,1e4)})),s.oncomplete=function(){E.timeEnd("IndexedDatabaseUpdateMultiTableData"),u>0?(E.error("IndexedDatabaseUpdateMultiTableData","errorCount=",u),t=new j(k.REQUEST_ERROR),n(new p(t,{totalCount:c,successCount:l,errorCount:u}))):n(new p(void 0,{totalCount:c,successCount:l,errorCount:u}))}}catch(e){return E.error("IndexedDatabase","updateMultiTableData() onError",e),n(new p(e)),[2]}return[2]}}))}))}))},t.prototype.delete=function(e,t){var n=this;return E.time("IndexedDatabaseDelete",e,t),new Promise((function(r,o){return z(n,void 0,void 0,(function(){var n,i,a,s,c,l;return K(this,(function(u){switch(u.label){case 0:return n=this,[4,this.checkAndOpenTable(e)];case 1:return u.sent().error?(i=new j(k.CHECK_FAIL),r(new p(i)),[2]):(a=this.getDBConnection(e,t,"readwrite",r,o)).error?(r(new p(a.error)),[2]):(s=a.data.request,c=a.data.transaction,s.onerror=function(e){i=new j(k.REQUEST_ERROR,e)},l=new Array,s.onsuccess=function(e){var r=e.target.result;if(r){var o=r.value;n.checkCondition(o,t)&&(r.delete(),l.push(o)),r.continue()}},c.oncomplete=function(){E.timeEnd("IndexedDatabaseDelete"),r(new p(i,l))},[2])}}))}))}))},t.prototype.deleteAndWrite=function(e,t,n){var r=this;return E.time("IndexedDatabaseDeleteAndWrite",e,t),new Promise((function(o,i){return z(r,void 0,void 0,(function(){var r,a,s,c,l,u,d,h;return K(this,(function(f){switch(f.label){case 0:return r=this,[4,this.checkAndOpenTable(e)];case 1:return f.sent().error?(a=new j(k.CHECK_FAIL),o(new p(a)),[2]):(s=this.getDBConnection(e,t,"readwrite",o,i)).error?(o(new p(s.error)),[2]):(c=s.data.request,l=s.data.objectStore,u=s.data.transaction,c.onerror=function(e){a=new j(k.REQUEST_ERROR,e)},d=0,h=0,c.onsuccess=function(e){var o=e.target.result;if(o){var i=o.value;r.checkCondition(i,t)&&(o.delete(),d++),o.continue()}else n.forEach((function(e){l.put(e).onsuccess=function(e){h++}}))},u.oncomplete=function(){E.timeEnd("IndexedDatabaseDeleteAndWrite"),E.log("IndexedDatabaseDeleteAndWrite",d,h),o(new p(a,{deleteCount:d,writeCount:h}))},[2])}}))}))}))},t.prototype.get=function(e,t){return z(this,void 0,void 0,(function(){var n,r;return K(this,(function(o){switch(o.label){case 0:return t.limit(1),[4,this.getAll(e,t)];case 1:return(n=o.sent()).error?[2,new p(n.error)]:0===(r=n.data).length?[2,new p(new y(c.NO_RESULT_ERROR,""))]:[2,new p(void 0,r[0])]}}))}))},t.prototype.getAll=function(e,t){var n=this;return E.time("IndexedDatabaseGetAll",e,t),new Promise((function(r,o){return z(n,void 0,void 0,(function(){var n,i,a,s,c,l;return K(this,(function(u){switch(u.label){case 0:return n=this,[4,this.checkAndOpenTable(e)];case 1:return u.sent().error?(i=new j(k.CHECK_FAIL),r(new p(i)),[2]):(a=this.getDBConnection(e,t,"readonly",r,o)).error?(r(new p(a.error)),[2]):(s=a.data.request,c=a.data.transaction,s.onerror=function(e){i=new j(k.REQUEST_ERROR,e)},l=new Array,s.onsuccess=function(e){var r=e.target.result;if(r){var o=r.value;if(n.checkCondition(o,t)&&(o.__primaryKey=r.primaryKey,l.push(o)),!t.hasOrder()&&l.length>=t.limitSize()+t.offsetCount())return;r.continue()}},c.oncomplete=function(){l.length>0&&t.hasOrder()&&(l=n.sortResult(l,t.getOrders()));var e=t.offsetCount(),o=e+t.limitSize();l=l.slice(e,o),E.timeEnd("IndexedDatabaseGetAll"),r(new p(i,l))},[2])}}))}))}))},t.prototype.sortResult=function(e,t){return t.reverse().forEach((function(t,n){e.sort((function(e,n){var r=0;switch(t.type){case i.INCREASE:r=e[t.key]>n[t.key]?1:e[t.key]===n[t.key]?0:-1;break;case i.DECREASE:r=e[t.key]>n[t.key]?-1:e[t.key]===n[t.key]?0:1;break;case i.INCREASE_BY_TEXT:r=e[t.key].localeCompare(n[t.key]);break;case i.DECREASE_BY_TEXT:r=n[t.key].localeCompare(e[t.key])}return r}))})),e},t.prototype.checkCondition=function(e,t){for(var n=!0,r=0;r<t.conditions.length;r++){var i=t.conditions[r];switch(i.type){case o.ONLY:e[i.column]!==i.value&&(n=!1);break;case o.LOWER_BOUND:var a=i.value;O(e[i.column],a.lower,!a.open)&&(n=!1);break;case o.UPPER_BOUND:var s=i.value;O(s.upper,e[i.column],!s.open)&&(n=!1);break;case o.IN:-1===i.value.indexOf(e[i.column])&&(n=!1);break;case o.BOUND:var c=i.value;(O(e[i.column],c.lower,!c.lowerOpen)||O(c.upper,e[i.column],!c.upperOpen))&&(n=!1);break;case o.NOT_IN:-1!==i.value.indexOf(e[i.column])&&(n=!1)}if(!n)break}return n},t.prototype.checkAndOpenTable=function(e){return z(this,void 0,void 0,(function(){var t,n,r;return K(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),(t=this).database||!t._canAutoResume?[3,2]:[4,this.init()];case 1:if((n=o.sent()).error)return E.error("IndexedDatabase","checkAndOpenTable()",e,n.error),[2,new p(new j(k.CHECK_FAIL,"database is not available."))];o.label=2;case 2:return t.database?t.database.objectStoreNames.contains(e)?[2,new p(void 0,!0)]:(E.error("IndexedDatabase","checkAndOpenTable()",e,"table "+e+" is not available."),[2,new p(new j(k.CHECK_FAIL,"table "+e+" is not available."))]):(E.error("IndexedDatabase","checkAndOpenTable()",e,"database is not available."),[2,new p(new j(k.CHECK_FAIL,"database is not available."))]);case 3:return r=o.sent(),E.error("IndexedDatabase","checkAndOpenTable()",e,"UnknownError"),[2,new p(r,!1)];case 4:return[2]}}))}))},t.prototype.setAutoResume=function(e){void 0===e&&(e=!0),this._canAutoResume=e},t.prototype.disConnect=function(e){return void 0===e&&(e=!0),z(this,void 0,void 0,(function(){var t;return K(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),E.log("IndexedDatabase","disConnect()",e,this.database),this._canAutoResume=e,this.database?[4,this.database.close()]:[3,2];case 1:n.sent(),n.label=2;case 2:return this.database=void 0,[2,Promise.resolve(new p(void 0,!0))];case 3:return t=n.sent(),E.error("IndexedDatabase","disConnect() Error.",t),[2,Promise.resolve(new p(void 0,!1))];case 4:return[2]}}))}))},t._uuid=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(),V([P(D,"OfflineData"),P(D,"DocumentData"),W("design:type",Function),W("design:paramtypes",[String,a]),W("design:returntype",void 0)],t.prototype,"getAll",null),t}(_);"undefined"!=typeof localStorage&&localStorage.getItem("isOfflineModuleDebug");var Y,Q=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(e){e.ILLEGAL_ARGUMENT="IllegalArgument"}(Y||(Y={}));var Z=function(e){function t(t,n){var r=e.call(this,n)||this;return r.name="ArgumentError",r.errorType=t,r}return Q(t,e),t}(d),X=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),J=function(e){function t(t,n,r){var o=e.call(this,r)||this;return o.name="HttpError",o.errorType="HttpError",o.statusCode=t,o.errorCode=n,o}return X(t,e),t}(d),$=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},ee=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},te=function(){function e(e,t,n,o){void 0===n&&(n=r.IndexDB),void 0===o&&(o=1),n===r.ClientDB?this.database=new U({databaseName:e,version:o,tables:t}):this.database=new q({databaseName:e,version:o,tables:t})}return e.prototype.init=function(){return $(this,void 0,void 0,(function(){var e;return ee(this,(function(t){switch(t.label){case 0:return[4,this.database.init(!1)];case 1:return(e=t.sent()).error?[2,e]:[2,new p(void 0,!0)]}}))}))},e}()},95303:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(17612),t),o(n(94094),t)},49846:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.toCodePoints=t.getFirstCodePointAsNumber=t.getFirstCodePointAsString=void 0;const r=n(26589);t.getFirstCodePointAsString=function(e){return"string"==typeof e?String.fromCodePoint(e.codePointAt(0)):String.fromCodePoint(e)},t.getFirstCodePointAsNumber=function(e){return"string"==typeof e?e.codePointAt(0):e},t.toCodePoints=function(e){const t=[];for(let n=0;n<e.length;n++){const o=e.charCodeAt(n),i=e.charCodeAt(n+1);(0,r.isLeadingSurrogate)(o)&&(0,r.isTailingSurrogate)(i)?(t.push(e.codePointAt(n)),n+=1):t.push(e.codePointAt(n))}return t}},26589:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isTailingSurrogate=t.isLeadingSurrogate=void 0,t.isLeadingSurrogate=function(e){return 55296<=e&&e<=56319},t.isTailingSurrogate=function(e){return 56320<=e&&e<=57343}},45900:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.isSymbolCategory=t.isMarkCategory=t.isSeparatorCategory=t.isPunctuationCategory=t.isNumberCategory=t.isDigitCategory=t.isTitleCaseLetterCategory=t.isUpperCaseLetterCategory=t.isLowerCaseLetterCategory=t.getCategory=t.createGetCategoryFunctionRegExp=void 0;const r=n(20113),o=n(49846),i=n(11211);function a(){const e=i.categoryPropertyValueList.map((e=>`(\\p{${e}}?)`)).join("");return new RegExp(e,"u")}t.createGetCategoryFunctionRegExp=a,t.getCategory=function(e){try{const t=(0,o.getFirstCodePointAsString)(e).match(a());if(!t)return i.CategoryPropertyValue.Any;for(let e=1;e<=i.categoryPropertyValueList.length;e++)if(void 0!==t[e]&&""!==t[e])return i.categoryPropertyValueList[e-1];return i.CategoryPropertyValue.Any}catch(t){return(0,r.getCategory)((0,o.getFirstCodePointAsNumber)(e))}},t.isLowerCaseLetterCategory=function(e){try{return Boolean((0,o.getFirstCodePointAsString)(e).match(/\p{Ll}/gu))}catch(t){return(0,r.isLowerCase)((0,o.getFirstCodePointAsNumber)(e))}},t.isUpperCaseLetterCategory=function(e){try{return Boolean((0,o.getFirstCodePointAsString)(e).match(/\p{Lu}/gu))}catch(t){return(0,r.isUpperCase)((0,o.getFirstCodePointAsNumber)(e))}},t.isTitleCaseLetterCategory=function(e){try{return Boolean((0,o.getFirstCodePointAsString)(e).match(/\p{Lt}/gu))}catch(t){return(0,r.isTitleCase)((0,o.getFirstCodePointAsNumber)(e))}},t.isDigitCategory=function(e){try{return Boolean((0,o.getFirstCodePointAsString)(e).match(/\p{Nd}/gu))}catch(t){return(0,r.isDigit)((0,o.getFirstCodePointAsNumber)(e))}},t.isNumberCategory=function(e){try{return Boolean((0,o.getFirstCodePointAsString)(e).match(/\p{N}/gu))}catch(t){return"N"===(0,r.getCategory)((0,o.getFirstCodePointAsNumber)(e))}},t.isPunctuationCategory=function(e){try{return Boolean((0,o.getFirstCodePointAsString)(e).match(/\p{P}/gu))}catch(t){return(0,r.isPunctuation)((0,o.getFirstCodePointAsNumber)(e))}},t.isSeparatorCategory=function(e){try{return Boolean((0,o.getFirstCodePointAsString)(e).match(/\p{Z}/gu))}catch(t){(0,r.isWhiteSpace)((0,o.getFirstCodePointAsNumber)(e))}},t.isMarkCategory=function(e){try{return Boolean((0,o.getFirstCodePointAsString)(e).match(/\p{M}/gu))}catch(t){return"M"===(0,r.getCategory)((0,o.getFirstCodePointAsNumber)(e))}},t.isSymbolCategory=function(e){try{return Boolean((0,o.getFirstCodePointAsString)(e).match(/\p{S}/gu))}catch(t){return"S"===(0,r.getCategory)((0,o.getFirstCodePointAsNumber)(e))}}},52415:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.getEastAsianWidth=void 0;const r=n(49846);t.getEastAsianWidth=function(e){"number"==typeof e&&(e=(0,r.getFirstCodePointAsString)(e));let t=e.charCodeAt(0),n=2==e.length?e.charCodeAt(1):0,o=t;return 55296<=t&&t<=56319&&56320<=n&&n<=57343&&(t&=1023,n&=1023,o=t<<10|n,o+=65536),12288==o||65281<=o&&o<=65376||65504<=o&&o<=65510?"F":8361==o||65377<=o&&o<=65470||65474<=o&&o<=65479||65482<=o&&o<=65487||65490<=o&&o<=65495||65498<=o&&o<=65500||65512<=o&&o<=65518?"H":4352<=o&&o<=4447||4515<=o&&o<=4519||4602<=o&&o<=4607||9001<=o&&o<=9002||11904<=o&&o<=11929||11931<=o&&o<=12019||12032<=o&&o<=12245||12272<=o&&o<=12283||12289<=o&&o<=12350||12353<=o&&o<=12438||12441<=o&&o<=12543||12549<=o&&o<=12589||12593<=o&&o<=12686||12688<=o&&o<=12730||12736<=o&&o<=12771||12784<=o&&o<=12830||12832<=o&&o<=12871||12880<=o&&o<=13054||13056<=o&&o<=19903||19968<=o&&o<=42124||42128<=o&&o<=42182||43360<=o&&o<=43388||44032<=o&&o<=55203||55216<=o&&o<=55238||55243<=o&&o<=55291||63744<=o&&o<=64255||65040<=o&&o<=65049||65072<=o&&o<=65106||65108<=o&&o<=65126||65128<=o&&o<=65131||110592<=o&&o<=110593||127488<=o&&o<=127490||127504<=o&&o<=127546||127552<=o&&o<=127560||127568<=o&&o<=127569||131072<=o&&o<=194367||177984<=o&&o<=196605||196608<=o&&o<=262141?"W":32<=o&&o<=126||162<=o&&o<=163||165<=o&&o<=166||172==o||175==o||10214<=o&&o<=10221||10629<=o&&o<=10630?"Na":161==o||164==o||167<=o&&o<=168||170==o||173<=o&&o<=174||176<=o&&o<=180||182<=o&&o<=186||188<=o&&o<=191||198==o||208==o||215<=o&&o<=216||222<=o&&o<=225||230==o||232<=o&&o<=234||236<=o&&o<=237||240==o||242<=o&&o<=243||247<=o&&o<=250||252==o||254==o||257==o||273==o||275==o||283==o||294<=o&&o<=295||299==o||305<=o&&o<=307||312==o||319<=o&&o<=322||324==o||328<=o&&o<=331||333==o||338<=o&&o<=339||358<=o&&o<=359||363==o||462==o||464==o||466==o||468==o||470==o||472==o||474==o||476==o||593==o||609==o||708==o||711==o||713<=o&&o<=715||717==o||720==o||728<=o&&o<=731||733==o||735==o||768<=o&&o<=879||913<=o&&o<=929||931<=o&&o<=937||945<=o&&o<=961||963<=o&&o<=969||1025==o||1040<=o&&o<=1103||1105==o||8208==o||8211<=o&&o<=8214||8216<=o&&o<=8217||8220<=o&&o<=8221||8224<=o&&o<=8226||8228<=o&&o<=8231||8240==o||8242<=o&&o<=8243||8245==o||8251==o||8254==o||8308==o||8319==o||8321<=o&&o<=8324||8364==o||8451==o||8453==o||8457==o||8467==o||8470==o||8481<=o&&o<=8482||8486==o||8491==o||8531<=o&&o<=8532||8539<=o&&o<=8542||8544<=o&&o<=8555||8560<=o&&o<=8569||8585==o||8592<=o&&o<=8601||8632<=o&&o<=8633||8658==o||8660==o||8679==o||8704==o||8706<=o&&o<=8707||8711<=o&&o<=8712||8715==o||8719==o||8721==o||8725==o||8730==o||8733<=o&&o<=8736||8739==o||8741==o||8743<=o&&o<=8748||8750==o||8756<=o&&o<=8759||8764<=o&&o<=8765||8776==o||8780==o||8786==o||8800<=o&&o<=8801||8804<=o&&o<=8807||8810<=o&&o<=8811||8814<=o&&o<=8815||8834<=o&&o<=8835||8838<=o&&o<=8839||8853==o||8857==o||8869==o||8895==o||8978==o||9312<=o&&o<=9449||9451<=o&&o<=9547||9552<=o&&o<=9587||9600<=o&&o<=9615||9618<=o&&o<=9621||9632<=o&&o<=9633||9635<=o&&o<=9641||9650<=o&&o<=9651||9654<=o&&o<=9655||9660<=o&&o<=9661||9664<=o&&o<=9665||9670<=o&&o<=9672||9675==o||9678<=o&&o<=9681||9698<=o&&o<=9701||9711==o||9733<=o&&o<=9734||9737==o||9742<=o&&o<=9743||9748<=o&&o<=9749||9756==o||9758==o||9792==o||9794==o||9824<=o&&o<=9825||9827<=o&&o<=9829||9831<=o&&o<=9834||9836<=o&&o<=9837||9839==o||9886<=o&&o<=9887||9918<=o&&o<=9919||9924<=o&&o<=9933||9935<=o&&o<=9953||9955==o||9960<=o&&o<=9983||10045==o||10071==o||10102<=o&&o<=10111||11093<=o&&o<=11097||12872<=o&&o<=12879||57344<=o&&o<=63743||65024<=o&&o<=65039||65533==o||127232<=o&&o<=127242||127248<=o&&o<=127277||127280<=o&&o<=127337||127344<=o&&o<=127386||917760<=o&&o<=917999||983040<=o&&o<=1048573||1048576<=o&&o<=1114109?"A":"N"}},39116:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.isExtendedPictographic=t.isEmojiComponent=t.isEmojiModifierBase=t.isEmojiModifier=t.isEmojiPresentation=t.isEmoji=void 0;const r=n(20113),o=n(49846);t.isEmoji=function(e){try{return Boolean((0,o.getFirstCodePointAsString)(e).match(/\p{Emoji}/gu))}catch(t){return(0,r.isEmoji)((0,o.getFirstCodePointAsNumber)(e))}},t.isEmojiPresentation=function(e){try{return Boolean((0,o.getFirstCodePointAsString)(e).match(/\p{Emoji_Presentation}/gu))}catch(t){return(0,r.isEmojiPresentation)((0,o.getFirstCodePointAsNumber)(e))}},t.isEmojiModifier=function(e){try{return Boolean((0,o.getFirstCodePointAsString)(e).match(/\p{Emoji_Modifier}/gu))}catch(t){return(0,r.isEmojiModifier)((0,o.getFirstCodePointAsNumber)(e))}},t.isEmojiModifierBase=function(e){try{return Boolean((0,o.getFirstCodePointAsString)(e).match(/\p{Emoji_Modifier_Base}/gu))}catch(t){return(0,r.isEmojiModifierBase)((0,o.getFirstCodePointAsNumber)(e))}},t.isEmojiComponent=function(e){try{return Boolean((0,o.getFirstCodePointAsString)(e).match(/\p{Emoji_Component}/gu))}catch(t){return(0,r.isEmojiComponent)((0,o.getFirstCodePointAsNumber)(e))}},t.isExtendedPictographic=function(e){try{return Boolean((0,o.getFirstCodePointAsString)(e).match(/\p{Extended_Pictographic}/gu))}catch(t){return(0,r.isExtPictographic)((0,o.getFirstCodePointAsNumber)(e))}}},11211:function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.categoryPropertyValueList=t.CategoryPropertyValue=void 0,function(e){e.UppercaseLetter="Lu",e.LowercaseLetter="Ll",e.TitlecaseLetter="Lt",e.ModifierLetter="Lm",e.OtherLetter="Lo",e.NonSpacingMark="Mn",e.SpacingCombiningMark="Mc",e.EnclosingMark="Me",e.DecimalDigitNumber="Nd",e.LetterNumber="Nl",e.OtherNumber="No",e.MathSymbol="Sm",e.CurrencySymbol="Sc",e.ModifierSymbol="Sk",e.OtherSymbol="So",e.ConnectorPunctuation="Pc",e.DashPunctuation="Pd",e.OpenPunctuation="Ps",e.ClosePunctuation="Pe",e.InitialPunctuation="Pi",e.FinalPunctuation="Pf",e.OtherPunctuation="Po",e.SpaceSeparator="Zs",e.LineSeparator="Zl",e.ParagraphSeparator="Zp",e.Control="Cc",e.Format="Cf",e.Surrogate="Cs",e.PrivateUse="Co",e.Unassigned="Cn",e.Any="Any",e.Assigned="Assigned",e.ASCII="ASCII"}(n=t.CategoryPropertyValue||(t.CategoryPropertyValue={})),t.categoryPropertyValueList=[n.UppercaseLetter,n.LowercaseLetter,n.TitlecaseLetter,n.ModifierLetter,n.OtherLetter,n.NonSpacingMark,n.SpacingCombiningMark,n.EnclosingMark,n.DecimalDigitNumber,n.LetterNumber,n.OtherNumber,n.MathSymbol,n.CurrencySymbol,n.ModifierSymbol,n.OtherSymbol,n.ConnectorPunctuation,n.DashPunctuation,n.OpenPunctuation,n.ClosePunctuation,n.InitialPunctuation,n.FinalPunctuation,n.OtherPunctuation,n.SpaceSeparator,n.LineSeparator,n.ParagraphSeparator,n.Control,n.Format,n.Surrogate,n.PrivateUse,n.Unassigned,n.Any,n.Assigned,n.ASCII]},17612:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(45900),t),o(n(56497),t),o(n(39116),t),o(n(11211),t),o(n(52415),t)},56497:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.isCommonScript=t.isLatinScript=t.isHanScript=void 0;const r=n(20113),o=n(49846);t.isHanScript=function(e){try{return Boolean((0,o.getFirstCodePointAsString)(e).match(/\p{Script=Han}/gu))}catch(t){return"Han"===(0,r.getScript)((0,o.getFirstCodePointAsNumber)(e))}},t.isLatinScript=function(e){try{return Boolean((0,o.getFirstCodePointAsString)(e).match(/\p{Script=Latin}/gu))}catch(t){return"Latin"===(0,r.getScript)((0,o.getFirstCodePointAsNumber)(e))}},t.isCommonScript=function(e){try{return Boolean((0,o.getFirstCodePointAsString)(e).match(/\p{Script=Common}/gu))}catch(t){return"Common"===(0,r.getScript)((0,o.getFirstCodePointAsNumber)(e))}}},88201:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Grapheme=void 0,t.Grapheme=class{constructor(e,t,n,r){this.startIndex=e,this.endIndex=t,this.codePoints=n,this._text=r}get text(){return this._text||(this._text=String.fromCodePoint(...this.codePoints)),this._text}toString(){return this.text}}},10895:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.GraphemeBreakIteratorES=void 0;const r=n(49846),o=n(88201);t.GraphemeBreakIteratorES=class{constructor(e){this.text=e,this.segmentor=new Intl.Segmenter,this.offset=0,this.iter=this.segmentor.segment(e)[Symbol.iterator]()}setOffset(e){this.offset=e,this.iter=this.segmentor.segment(this.text.slice(e))[Symbol.iterator]()}next(){let{done:e,value:t}=this.iter.next();if(e)return{done:!0,value:null};const{segment:n,index:i}=t,a=i+this.offset,s=a+n.length;return{done:!1,value:new o.Grapheme(a,s,(0,r.toCodePoints)(n),n)}}}},65761:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.GraphemeBreakIteratorGoogleV8=void 0;const r=n(49846),o=n(88201);t.GraphemeBreakIteratorGoogleV8=class{constructor(e){this.text=e,this.iter=new Intl.v8BreakIterator("en",{type:"character"}),this.lastPos=0,this.offset=0,this.iter.adoptText(e)}setOffset(e){this.iter.adoptText(this.text.slice(e)),this.offset=e,this.lastPos=0}next(){let e=this.iter.next();if(-1===e)return{done:!0,value:null};const t=this.offset+this.lastPos,n=this.offset+e,i=this.text.slice(t,n),a=new o.Grapheme(t,n,(0,r.toCodePoints)(i),i);return this.lastPos=n,{done:!1,value:a}}}},87364:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.GraphemeBreakIteratorLegacy=void 0;const r=n(49846),o=n(20113),i=n(88201);t.GraphemeBreakIteratorLegacy=class{constructor(e){this.text=e,this.lastPos=0}setOffset(e){this.lastPos=e}next(){const e=(0,o.nextBreak)(this.text,this.lastPos);if(e===this.lastPos)return{done:!0,value:null};const t=this.text.slice(this.lastPos,e),n=new i.Grapheme(this.lastPos,e,(0,r.toCodePoints)(t),t);return this.lastPos=e,{done:!1,value:n}}}},4738:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.getGraphemeBreakIterator=t.setDefaultGraphemeBreakIteratorImpl=void 0;const i=n(10895),a=n(65761),s=n(87364),c=n(24102);let l=c.GraphemeBreakerIteratorImplements.Auto;t.setDefaultGraphemeBreakIteratorImpl=function(e){l=e},t.getGraphemeBreakIterator=function(e=l){return e===c.GraphemeBreakerIteratorImplements.GoogleV8||e===c.GraphemeBreakerIteratorImplements.Auto&&"v8BreakIterator"in globalThis.Intl?a.GraphemeBreakIteratorGoogleV8:e===c.GraphemeBreakerIteratorImplements.ECMAScript||e===c.GraphemeBreakerIteratorImplements.Auto&&"Segmenter"in globalThis.Intl?i.GraphemeBreakIteratorES:s.GraphemeBreakIteratorLegacy},o(n(24102),t),o(n(88201),t)},24102:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.GraphemeBreakerIteratorImplements=void 0,function(e){e.TencentDocLegacy="TencentDocLegacy",e.GoogleV8="GoogleV8",e.ECMAScript="ECMAScript",e.Auto="Auto"}(t.GraphemeBreakerIteratorImplements||(t.GraphemeBreakerIteratorImplements={}))},94094:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeString=void 0;const i=n(49846),a=n(48782),s=n(4738),c=n(78504);class l{constructor(e){if("string"!=typeof e)throw Error("UnicodeString ");this.noWordWrapSlicesCacheStopIndex=0,this.noWordWrapSlices=[],this.text=e}get length(){return this.text.length}getCharCodeCount(){return this.text.length}getCodePointCount(){return this.getCodePoints().length}getGraphemeCount(){return this.getAllGraphemes().length}toString(){return this.text}toSlice(){return new c.NoWordWrapSlice(0,this.text.length,this.text)}getCodePoints(){return this.codePoints||(this.codePoints=(0,i.toCodePoints)(this.text)),this.codePoints}getAllGraphemes(e=0){if(0===e&&this.graphemes)return this.graphemes;if(!this.graphemeBreakerIterator){const e=(0,s.getGraphemeBreakIterator)();this.graphemeBreakerIterator=new e(this.text)}this.graphemeBreakerIterator.setOffset(e);const t=[];let n=this.graphemeBreakerIterator.next();for(;!n.done;)t.push(n.value),n=this.graphemeBreakerIterator.next();return 0===e&&(this.graphemes=t),t}getNextGrapheme(e=0,t=!1){if(!this.graphemeBreakerIterator){const e=(0,s.getGraphemeBreakIterator)();this.graphemeBreakerIterator=new e(this.text)}this.graphemeBreakerIterator.setOffset(e);const n=this.graphemeBreakerIterator.next().value;if(!t||0===e)return n;const r=this.getPreviousGrapheme(e);return null!==r&&r.endIndex===(null==n?void 0:n.endIndex)?r:n}getPreviousGrapheme(e=this.text.length){if(0===e)return null;if(!this.graphemeBreakerIterator){const e=(0,s.getGraphemeBreakIterator)();this.graphemeBreakerIterator=new e(this.text)}let t=e-1,n=null;for(;t>=0;){this.graphemeBreakerIterator.setOffset(t);const e=this.graphemeBreakerIterator.next().value;if(null!==n&&(null==e?void 0:e.startIndex)!==(null==n?void 0:n.startIndex)&&(null==e?void 0:e.endIndex)!==(null==n?void 0:n.endIndex))return n;t-=1,n=e}return n}getAllNoWordWrapSlice(e=0,t=this.text.length){if(0===e&&this.noWordWrapSlicesCacheStopIndex>=t)return this.noWordWrapSlices.filter((({endIndex:e})=>e<=t));this.lineBreakerIterator||(this.lineBreakerIterator=new a.LineBreakIterator(this.text)),this.lineBreakerIterator.setOffset(e);let n=[],r=this.lineBreakerIterator.next();for(;!r.done;)n.push(r.value),r=this.lineBreakerIterator.next();return 0===e&&(this.noWordWrapSlices=n),n}getNextNoWordWrapSlice(e=0,t=!1){this.lineBreakerIterator||(this.lineBreakerIterator=new a.LineBreakIterator(this.text)),this.lineBreakerIterator.setOffset(e);const n=this.lineBreakerIterator.next().value;if(!t||0===e)return n;const r=this.getPreviousNoWordWrapSlice(e);return null!==r&&r.endIndex===(null==n?void 0:n.endIndex)?r:n}getPreviousNoWordWrapSlice(e=this.text.length){if(0===e)return null;this.lineBreakerIterator||(this.lineBreakerIterator=new a.LineBreakIterator(this.text));let t=e-1,n=null;for(;t>=0;){this.lineBreakerIterator.setOffset(t);const e=this.lineBreakerIterator.next().value;if(null!==n&&(null==e?void 0:e.startIndex)!==(null==n?void 0:n.startIndex)&&(null==e?void 0:e.endIndex)!==(null==n?void 0:n.endIndex))return n;t-=1,n=e}return n}sliceByGrapheme(e,t){const n=void 0===t?this.getGraphemeCount():t,r=this.getAllGraphemes()[e].startIndex,o=this.getAllGraphemes()[n-1].endIndex;return new l(this.text.slice(r,o))}getGraphemeByCharIndex(e){const t=this.getAllGraphemes();for(const n of t)if(n.startIndex<=e&&n.endIndex>e)return n}}t.UnicodeString=l,o(n(4738),t),o(n(48782),t),o(n(28605),t)},28605:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},48782:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.LineBreakIterator=void 0;const r=n(25142),o=n(78504);t.LineBreakIterator=class{constructor(e){this.text=e,this.lineBreakRegex=new RegExp(r.wordClusterRegexString,"gm"),this.lineBreakRegex.lastIndex=0}setOffset(e){this.lineBreakRegex.lastIndex=e}next(){const e=this.lineBreakRegex.exec(this.text);if(!e||e.index===this.text.length)return{done:!0,value:null};const[t]=e;return{done:!1,value:new o.NoWordWrapSlice(e.index,e.index+t.length,t)}}}},78504:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.NoWordWrapSlice=void 0;const r=n(49846);t.NoWordWrapSlice=class{constructor(e,t,n,r){this.startIndex=e,this.endIndex=t,this.text=n,this._codePoints=r}get codePoints(){return this._codePoints||(this._codePoints=(0,r.toCodePoints)(this.text)),this._codePoints}get isHardBreak(){return/[\u000a\u000b\u000c\u000d\u0085]/g.test(this.text)}toString(){return this.text}}},25142:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.wordClusterRegexString=void 0,t.wordClusterRegexString="[\n\v\f\r\t]|[\\u0028\\u005B\\u00AB\\u2018\\u201C\\u3008\\u300A\\u300C\\u300E\\u3010\\u3014\\u3016\\u3018\\u301D\\uFF08\\uFF3B\\uFF5F\\uFF5B]*[\\u2F00-\\u30FF\\u3190-\\u319F\\u31C0-\\u33FF\\u3400-\\u4DBF\\u4E00-\\u9FFF\\uF900-\\uFAFF\\uFE10-\\uFE1F\\uFE30-\\uFE4F\\uFF00-\\uFFEF][\\u002C\\u0029\\u005D\\u00BB\\u2019\\u201D\\u3001\\u3009\\u300B\\u300D\\u300F\\u3011\\u3015\\u3017\\u3019\\u301F\\u3005\\u303B\\u30FC\\u30FD\\u30FE\\u30A1\\u30A3\\u30A5\\u30A7\\u30A9\\u30C3\\u30E3\\u30E5\\u30E7\\u30EE\\u30F5\\u30F6\\u3041\\u3043\\u3045\\u3047\\u3049\\u3063\\u3083\\u3085\\u3087\\u308E\\u3095\\u3096\\u31F0\\u31F1\\u31F2\\u31F3\\u31F4\\u31F5\\u31F6\\u31F7\\u31F8\\u31F9\\u31FA\\u31FB\\u31FC\\u31FD\\u31FE\\u31FF\\u2010\\u2013\\u301C\\u30A0\\u0021\\u002E\\u003A\\u003B\\u003F\\u203C\\u2047\\u2048\\u2049\\u3001\\u3002\\u30FB\\uFF01\\uFF1F\\uFF09\\uFF0C\\uFF3D\\uFF5D\\uFF60]*|[\\u0F00-\\u0F0A\\u0F13\\u0F15-\\u0F7E\\u0F80-\\u0FFF]+([\\u0F0B-\\u0F0C\\u0F0D-\\u0F12\\u0F14\\u0F7F])*|( +)|[^\\u2F00-\\u30FF\\u3190-\\u319F\\u31C0-\\u33FF\\u3400-\\u4DBF\\u4E00-\\u9FFF\\uF900-\\uFAFF\\uFE10-\\uFE1F\\uFE30-\\uFE4F\\uFF00-\\uFFEF\\u0F00-\\u0F0A\\u0F13\\u0F15-\\u0F7E\\u0F80-\\u0FFF\n\v\f\r\t ]+"},73695:function(e,t,n){n.d(t,{i4:function(){return h},es:function(){return M},wV:function(){return D},JH:function(){return P},fF:function(){return I},SZ:function(){return R}});var r=n(87675),o=(n(5450),n(79707)),i=n(59834),a=n(90476);function s(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}n(38298),"function"==typeof Symbol&&Symbol.observable;var c=function(){return Math.random().toString(36).substring(7).split("").join(".")},l={INIT:"@@redux/INIT"+c(),REPLACE:"@@redux/REPLACE"+c(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+c()}};function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p,h,f,g,v={commentAnchors:[]},y={commentPanel:d({},v),archivedCommentPanel:d({},v)},m=function(e){return e.reduce((function(e,t){return e&&(r=(n=t).readTime,o=n.editTime,void 0===r||void 0===o||r>0&&r>=o);var n,r,o}),!0)};function b(e,t){var n=t.anchorId;if(n){var r=e.commentAnchors.findIndex((function(e){return e.anchorId===n}));return r>=0?{anchor:e.commentAnchors[r],anchorIndex:r}:void 0}}function _(e,t){var n=t.anchorId,r=t.commentId,o=b(e,{anchorId:n});if(o){var i=o.anchor,a=o.anchorIndex,s=i.commentList.findIndex((function(e){return e.commentId===r}));return{anchor:i,anchorIndex:a,commentIndex:s}}}!function(e){e[e.UNARCHIVED=0]="UNARCHIVED",e[e.ARCHIVED=1]="ARCHIVED"}(p||(p={})),function(e){e[e.kTopicWedocWord=0]="kTopicWedocWord",e[e.kTopicWedocExcel=1]="kTopicWedocExcel",e[e.kTopicWedrive=2]="kTopicWedrive",e[e.kTopicBlackBoard=3]="kTopicBlackBoard",e[e.kTopicSmartSheet=9]="kTopicSmartSheet",e[e.kTopicWedocMind=10]="kTopicWedocMind",e[e.kTopicWedocFlow=11]="kTopicWedocFlow"}(h||(h={})),function(e){e[e.NORMAL=1]="NORMAL",e[e.ARCHIVE=2]="ARCHIVE"}(f||(f={})),function(e){e[e.ArchiveCommentAnchor=0]="ArchiveCommentAnchor",e[e.UnArchiveCommentAnchor=1]="UnArchiveCommentAnchor",e[e.AddComment=2]="AddComment",e[e.EditComment=3]="EditComment",e[e.DeleteComment=4]="DeleteComment",e[e.AddCommentAnchorAction=5]="AddCommentAnchorAction",e[e.LikeCommentAction=6]="LikeCommentAction",e[e.UpdateCommentAnchors=7]="UpdateCommentAnchors",e[e.UpdateCommentAnchor=8]="UpdateCommentAnchor",e[e.UpdateArchivedCommentAnchors=9]="UpdateArchivedCommentAnchors",e[e.UpdateArchivedCommentAnchor=10]="UpdateArchivedCommentAnchor",e[e.DeleteCommentAnchor=11]="DeleteCommentAnchor"}(g||(g={}));var C,S,w={"<":"&lt;",">":"&gt;","`":"&#x60;",'"':"&quot;","'":"&#x27;","/":"&#x2f;","\n":"<br>"};function E(e){return e.replace(/[<>`"'/\n]/g,(function(e){return w[e]}))}function x(){var e,t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx".replace(/[xy]/g,(function(n){return e=(t+16*Math.random())%16|0,t=Math.floor(t/16),("x"==n?e:3&e|8).toString(16)})).substring(0,8)}function T(e,t,n){return'<span contenteditable="false" class="comment-content-atTarget" data-personvid="'.concat(e,'" data-iscollaborator="1" data-atid="').concat(n,'">@').concat(t,"</span>")}function R(e){var t=e.comments;return e.persons.length>0&&e.persons.forEach((function(e){var n=new RegExp("".concat("").concat(e.vid).concat(""),"g");t=t.replace(n,T(e.vid,e.name,x()))})),t}function I(e){var t=function(e){var t=/<span contenteditable="false" class="comment-content-atTarget" data-personvid="\d+" data-iscollaborator="1"(?: data-atid="\w*")>@[^<]*<\/span>/g,n=/<span contenteditable="false" class="comment-content-atTarget" data-personvid="(\d+)" data-iscollaborator="1"( data-atid="\w*"){0,1}>@([^<]*)<\/span>/,r=e.match(t),o=e.split(t),i=t.exec(e);i&&0===i.index&&o.push("");var a=[];return o.forEach((function(e,t){if(e&&a.push({text:e}),null!=r&&r[t]){var o=r[t].match(n);o&&o.length>=3&&a.push({text:"@".concat(o[o.length-1]),data:{mentionUserID:o[1]}})}})),a}(e),n="",r=[];return t.forEach((function(e){e.data?(n+="".concat("").concat(e.data.mentionUserID).concat(""),r.push({vid:e.data.mentionUserID,name:e.text.slice(1)})):n+=e.text})),{comments:n=function(e){var t=e;for(var n in w){var r=new RegExp("".concat(w[n]),"gm");t=t.replace(r,n)}return t.replace(/&nbsp;/g," ")}(n),persons:r}}function P(e){for(var t=0,n="";t>=0;){var r=e.indexOf("<span",t),o=e.indexOf("</span>",t);if(n+=E(r>=0?e.substring(t,r):e.substring(t)),r>=0&&o>=0){var i=e.substring(r,o+7),a=/^<span contenteditable="false" class="comment-content-atTarget" data-personvid="\d+" data-iscollaborator="[01]{1}"( data-userid="\w*"){0,1}( data-atid="\w*"){0,1}>/.exec(i);n+=a?"".concat(a[0]).concat(E(i.slice(a[0].length,-7)),"</span>"):E(i)}t=o>=0?o+7:o}return n}!function(e){e.NativeAddComment="NativeAddComment",e.NativeEditComment="NativeEditComment",e.NativeEditCommentContent="NativeEditCommentContent",e.NativeAddCommentAnchor="NativeAddCommentAnchor",e.NativeLikeComment="NativeLikeComment",e.NativeDeleteComment="NativeDeleteComment",e.NativeDeleteCommentAnchor="NativeDeleteCommentAnchor",e.NativeArchiveComment="NativeArchiveComment",e.NativeUnArchiveComment="NativeUnArchiveComment",e.NativeError="NativeError"}(C||(C={})),function(e){e.H5AddComment="H5AddComment",e.H5EditComment="H5EditComment",e.H5DeleteComment="H5DeleteComment",e.H5LikeComment="H5LikeComment",e.H5HighlightAnchor="H5HighlightAnchor",e.H5ArchiveComment="H5ArchiveComment",e.H5UnArchiveComment="H5UnArchiveComment"}(S||(S={}));var O,k,D=function(){function e(){(0,i.Z)(this,e)}return(0,a.Z)(e,null,[{key:"isMobile",value:function(){var e=/(wxdrive)/i.test(navigator.userAgent);return!(!/(mobile)/i.test(navigator.userAgent)||e)||!(!/(pad)/i.test(navigator.userAgent)||e)}},{key:"isIPad",value:function(){return/(ipad)/i.test(navigator.userAgent)}},{key:"isIOS",value:function(){return/(iphone|ipad|ipod)/i.test(navigator.userAgent)}},{key:"isMac",value:function(){return!e.isMobile()&&/Mac OS X/i.test(navigator.userAgent)}},{key:"isWeChat",value:function(){return/MicroMessenger/i.test(navigator.userAgent)&&!/wxwork/i.test(navigator.userAgent)}},{key:"isWXMiniProgram",value:function(){return!(!/miniProgram/i.test(navigator.userAgent)&&"miniprogram"!==window.__wxjs_environment)||window.location.href.indexOf("from=miniprogram")>-1}},{key:"isWxWork",value:function(){return/wxwork/i.test(navigator.userAgent)}},{key:"isExcel",value:function(){var e;return"sheet"===(null===(e=window.clientVars)||void 0===e?void 0:e.padType)}},{key:"supportNativeComment",value:function(){var t,n,r,o;return e.isMobile()&&e.isWxWork()&&(null===(t=window.tdocs)||void 0===t?void 0:t.showNativeAllCommentPanel)&&(null===(n=window.tdocs)||void 0===n?void 0:n.addEventListener)&&(null===(r=window.tdocs)||void 0===r?void 0:r.notifyCommentActionToNative)&&(null===(o=window.tdocs)||void 0===o?void 0:o.launchCommentInput)}},{key:"supportNativeEmojiPanel",value:function(){var t,n;return e.supportEmojiComment()&&e.isMobile()&&e.isWxWork()&&(null===(t=window.tdocs)||void 0===t?void 0:t.showEmojiActionPanel)&&(null===(n=window.tdocs)||void 0===n?void 0:n.addEventListener)}},{key:"supportEmojiComment",value:function(){return!e.isExcel()}}]),e}();!function(e){e[e.kCommentAdd=1]="kCommentAdd",e[e.kCommentEdit=2]="kCommentEdit",e[e.kCommentDel=3]="kCommentDel",e[e.kCommentRead=4]="kCommentRead",e[e.kCommentLike=5]="kCommentLike",e[e.kCommentUnlike=6]="kCommentUnlike",e[e.kCommentArchive=7]="kCommentArchive",e[e.kCommentUnarchive=8]="kCommentUnarchive",e[e.kCommentUnread=9]="kCommentUnread",e[e.kCommentCount=10]="kCommentCount"}(O||(O={})),function(e){e[e.kListAll=2]="kListAll",e[e.kListOneGroup=3]="kListOneGroup"}(k||(k={}));var M="4294967304";function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var N=function(e,t){var n,o,i=(n={},(0,r.Z)(n,g.AddComment,(function(){var n=t.tempAnchorId,r=t.tempCommentId,o=t.commentText,i=t.authorId,a=t.name,s=t.avatar,c=t.corpName,l=t.corpId,u=b(e,{anchorId:n});if(u){var d=u.anchor,p=Number(new Date);d.commentList.push({anchorId:d.anchorId,commentId:r,content:o,authorId:i,name:a,avatar:s,corpName:c,commentLikes:[],editTime:p,publishTime:p,corpId:l})}return B(e)})),(0,r.Z)(n,g.DeleteComment,(function(){var n=_(e,t);if(n&&n.commentIndex>=0){var r=n.anchor,o=n.commentIndex;return r.commentList.splice(o,1),r.commentList.length||e.commentAnchors.splice(n.anchorIndex,1),B(e)}})),(0,r.Z)(n,g.EditComment,(function(){var n=t.commentId,r=t.anchorId,o=t.respAnchorId,i=t.respCommentId,a=t.commentText,s=_(e,{anchorId:r,commentId:n});if(s&&s.commentIndex>=0){var c=s.anchor,l=s.commentIndex,u=c.commentList[l];if(u.content=a,u.anchorId=o||u.anchorId,u.commentId=i||u.commentId,c.anchorId=o||c.anchorId,!o&&!i){var d=Date.now();u.editTime=d,c.isRead=!0}return B(e)}})),n);return(null===(o=i[t.type])||void 0===o?void 0:o.call(i))||e},B=(function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var o=t[r];"function"==typeof e[o]&&(n[o]=e[o])}Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if(void 0===n(void 0,{type:l.INIT}))throw new Error(s(12));if(void 0===n(void 0,{type:l.PROBE_UNKNOWN_ACTION()}))throw new Error(s(13))}))}(n)}catch(e){e}}({commentPanel:function(e,t){var n,o;if(!e)return y.commentPanel;var i=(n={},(0,r.Z)(n,g.ArchiveCommentAnchor,(function(){var n=_(e,t);if(n&&n.anchorIndex>=0){var r=n.anchorIndex;return e.commentAnchors.splice(r,1),L({},e)}})),(0,r.Z)(n,g.DeleteCommentAnchor,(function(){var n=_(e,t);if(null!=n&&n.anchor){var r=e.commentAnchors.filter((function(e){return e.anchorId!==n.anchor.anchorId}));return L(L({},e),{},{commentAnchors:r})}})),(0,r.Z)(n,g.AddCommentAnchorAction,(function(){var n=t.anchor,r=t.index;return e.commentAnchors.splice(r,0,n),L({},e)})),(0,r.Z)(n,g.LikeCommentAction,(function(){var n=t.anchorId,r=t.commentId,o=t.authorId,i=t.name,a=t.isLike,s=_(e,{anchorId:n,commentId:r});if(s&&s.commentIndex>=0){var c=s.anchor,l=s.commentIndex,u=c.commentList[l];if(a)u.commentLikes.push({authorId:o,name:i});else{var d=u.commentLikes.findIndex((function(e){return e.authorId===o}));d>=0&&u.commentLikes.splice(d,1)}return F(e)}return L({},e)})),(0,r.Z)(n,g.UpdateCommentAnchors,(function(){var n=t.anchors;return L(L({},e),{},{commentAnchors:n})})),(0,r.Z)(n,g.UpdateCommentAnchor,(function(){var n=t.anchorId,r=t.commentList,o=b(e,{anchorId:n});if(null!=o&&o.anchor){var i=o.anchor;return i.commentList=r,i.isRead=m(r),B(e)}})),n);return(null===(o=i[t.type])||void 0===o?void 0:o.call(i))||N(e,t)},archivedCommentPanel:function(e,t){var n,o;if(!e)return y.archivedCommentPanel;var i=(n={},(0,r.Z)(n,g.UpdateArchivedCommentAnchor,(function(){var n=t.anchorId,r=t.commentList,o=t.archivedUser,i=t.archivedTime,a=b(e,{anchorId:n});if(null!=a&&a.anchor){var s=a.anchor;return s.commentList=r,o&&(s.archivedUser=o),void 0!==i&&(s.archivedTime=i),B(e)}})),(0,r.Z)(n,g.UpdateArchivedCommentAnchors,(function(){var n=t.commentAnchors;return L(L({},e),{},{commentAnchors:n})})),(0,r.Z)(n,g.UnArchiveCommentAnchor,(function(){var n=t.anchorId,r=b(e,{anchorId:n});if(r){var o=r.anchorIndex;e.commentAnchors.splice(o,1)}return L({},e)})),n);return(null===(o=i[t.type])||void 0===o?void 0:o.call(i))||N(e,t)}}),function(e){return L(L({},e),{},{commentAnchors:(0,o.Z)(e.commentAnchors.map((function(e){return L({},e)})))})}),F=function(e){return L(L({},e),{},{commentAnchors:(0,o.Z)(e.commentAnchors.map((function(e){return L(L({},e),{},{commentList:(0,o.Z)(e.commentList.map((function(e){return L({},e)})))})})))})}},20797:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.GLOBAL_VAR=t.STORAGE_KEY_PREFIX=t.CDN_PATH_PREFIX=void 0,t.CDN_PATH_PREFIX="https://weblog.cdn-go.cn/sdk/latest/",t.STORAGE_KEY_PREFIX="wl",t.GLOBAL_VAR="log"},18464:function(e,t,n){var r=n(91494);t.Z=r.configSDK("https://weblog.cdn-go.cn/sdk/latest/browser/browser.js")},91494:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.configSDK=t.initGlobalSingle=t.ProxyBrowserClient=t.LOADER_KEY=void 0;var r=n(85556),o=n(16871),i=n(20797),a=n(57822);t.LOADER_KEY="loader";var s=function(){function e(e){this.isProxy=!0,this.inited=!1,this.buffers=[],this.sdkUrl=e,this.namespace=t.LOADER_KEY}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.invoke("debug",e,!0)},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.invoke("log",e,!0)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.invoke("info",e,!0)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.invoke("warn",e,!0)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.invoke("error",e,!0)},e.prototype.init=function(e,t){var n=this;return void 0===t&&(t={}),new Promise((function(o,s){if(n.inited)return s();n.inited=!0;var c=(null==t?void 0:t.sdkUrl)||n.sdkUrl;a.injectScript(c,i.GLOBAL_VAR).then((function(i){var a,s,c;if("boolean"!=typeof(null==i?void 0:i.isProxy)||!i.isProxy){n.realSdk=i,i.init(e,t),o(i);try{for(var l=r.__values(n.buffers),u=l.next();!u.done;u=l.next()){var d=u.value,p=i.getLogger(d.n),h=p[d.f].apply(p,r.__spread(JSON.parse(d.a)));null===(c=d.r)||void 0===c||c.call(d,h)}}catch(e){a={error:e}}finally{try{u&&!u.done&&(s=l.return)&&s.call(l)}finally{if(a)throw a.error}}}}))}))},e.prototype.identify=function(e,t){this.invoke("identify",[e,t])},e.prototype.report=function(e,t,n){return this.invokePromise("report",[e,t,n])},e.prototype.query=function(e){return this.invokePromise("query",[e])},e.prototype.loadAsset=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.invoke("loadAsset",e)},e.prototype.getLogger=function(e){return Object.create(this,{namespace:{value:t.LOADER_KEY+"_"+e}})},e.prototype.invoke=function(e,t,n,i){try{if(n&&t.push(Date.now()),this.realSdk){var a=this.realSdk.getLogger(this.namespace),s=a[e].apply(a,r.__spread(t));null==i||i(s)}this.buffers.push({f:e,n:this.namespace,a:o.safeStringify(t),r:i})}catch(e){console.error(e)}},e.prototype.invokePromise=function(e,t,n){var r=this;return new Promise((function(o){r.invoke(e,t,n,o)}))},e}();function c(e,t){var n,r=null!==(n=window[e])&&void 0!==n?n:t();return window[e]=r,r}t.ProxyBrowserClient=s,t.initGlobalSingle=c,t.configSDK=function(e){return c(i.GLOBAL_VAR,(function(){return new s(e)}))}},57822:function(e,t,n){var r=this;Object.defineProperty(t,"__esModule",{value:!0}),t.injectScript=t.getBrowserRemotePlugin=t.REMOTE_PLUGINS_URL=void 0;var o,i=n(85556),a=n(20797);function s(e,t){return new Promise((function(n){var r=document.createElement("script");r.async=!0,r.src=e,r.setAttribute("retry-when-error","true"),r.onload=function(){var e=t.split(".").reduce((function(e,t){return e[t]}),window);n(e)},(document.head||document.body).appendChild(r)}))}t.REMOTE_PLUGINS_URL=a.CDN_PATH_PREFIX+"browser-remote-plugins/browser-remote-plugins.js",t.getBrowserRemotePlugin=function(e){return i.__awaiter(r,void 0,void 0,(function(){var n;return i.__generator(this,(function(r){switch(r.label){case 0:return o?[2,o]:[4,s(t.REMOTE_PLUGINS_URL,"window.WebLog.BrowserRemotePlugins")];case 1:return n=r.sent(),[2,o=o||n&&new n(e)]}}))}))},t.injectScript=s},3715:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EventName=void 0,function(e){e.INSERT_LOG="insert_log",e.GET_CONFIG="get_config"}(t.EventName||(t.EventName={}))},13204:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.IntegrationsHook=void 0,function(e){e[e.BeforeInvokeLog=0]="BeforeInvokeLog"}(t.IntegrationsHook||(t.IntegrationsHook={}))},15806:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.LogLevel=void 0,function(e){e[e.DEBUG=1]="DEBUG",e[e.LOG=1]="LOG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.FATAL=5]="FATAL"}(t.LogLevel||(t.LogLevel={}))},99510:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.IntegrationsHook=t.LogLevel=t.EventName=void 0;var r=n(3715);Object.defineProperty(t,"EventName",{enumerable:!0,get:function(){return r.EventName}});var o=n(15806);Object.defineProperty(t,"LogLevel",{enumerable:!0,get:function(){return o.LogLevel}});var i=n(13204);Object.defineProperty(t,"IntegrationsHook",{enumerable:!0,get:function(){return i.IntegrationsHook}})},97202:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ajaxPost=t.ajaxGet=t.ajax=void 0;var n=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n+"="+encodeURIComponent(e[n]));return t.join("&")};function r(e,t,n){if(void 0===n&&(n="GET"),e.setRequestHeader)for(var r in"GET"!==n&&"POST"!==n||e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t=t||{})t.hasOwnProperty(r)&&e.setRequestHeader(r,t[r])}var o=function(e,t){void 0===t&&(t={withCredentials:!1}),e.withCredentials=!!t.withCredentials};function i(e){return new Promise((function(t,i){var a=n(e.param||{}),c=e.url;c+=(c.indexOf("?")>=0?"&":"?")+a;var l=s(e,{success:function(e){t(e)},error:function(e){i(e)}});l&&(l.open("GET",c,!0),o(l,e.xhrFields),r(l,e.headers||{},"GET"),l.send())}))}function a(e){return new Promise((function(t,i){var a=e.url,c="",l=s(e,{success:function(e){t(e)},error:function(e){i(e)}});l&&(l.open("POST",a,!0),"json"===e.contentType?(c=JSON.stringify(e.param),l.setRequestHeader("Content-Type","application/json")):(c=n(e.param||{}),o(l,e.xhrFields),r(l,e.headers||{},"POST")),l.send(c))}))}function s(e,t){var n=new XMLHttpRequest;if(!n)throw new Error("XMLHttp is not defined");var r=e.timeout,o=e.dataType,i=void 0===o?"json":o;try{r&&(n.timeout=r)}catch(e){console.log(e)}return n.onreadystatechange=function(){var e,r;if(4===n.readyState)if(200===n.status){var o=n.responseText;"json"===i&&(o=JSON.parse(n.responseText)),null===(e=null==t?void 0:t.success)||void 0===e||e.call(t,o)}else null===(r=null==t?void 0:t.error)||void 0===r||r.call(t,{errCode:n.status})},n.onerror=function(){var e;null===(e=null==t?void 0:t.error)||void 0===e||e.call(t,{errCode:-1})},n.ontimeout=function(){var e;null===(e=null==t?void 0:t.error)||void 0===e||e.call(t,{errCode:-2})},n}t.ajaxGet=i,t.ajaxPost=a,t.ajax=function(e){switch(e.ajaxType){case"GET":i(e);break;case"POST":a(e)}}},16871:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(85556);r.__exportStar(n(29938),t),r.__exportStar(n(97202),t),r.__exportStar(n(13413),t)},29938:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.getUUID=t.safeStringify=t.isObject=t.isType=t.getGlobalObject=void 0;var r={};function o(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"}function i(e){return o("Object",e)}t.getGlobalObject=function(){return"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)?n.g:"undefined"!=typeof window?window:"undefined"!=typeof self?self:r},t.isType=o,t.isObject=i,t.safeStringify=function(e){var t=new Set,n="Circular";try{return JSON.stringify(e,(function(e,n){if(i(n)||Array.isArray(n)){if(t.has(n))return'["Circular"]';t.add(n)}return n}))}catch(t){return console.error(t),i(e)?'{Object:["Circular"]}':Array.isArray(e)?'["Circular"]':n}},t.getUUID=function(){if("undefined"==typeof crypto&&"undefined"==typeof msCrypto)return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}));var e=new Uint16Array(8);crypto.getRandomValues(e),e[3]=4095&e[3]|16384,e[4]=16383&e[4]|32768;var t=function(e){for(var t=e.toString(16);t.length<4;)t="0"+t;return t};return t(e[0])+t(e[1])+t(e[2])+t(e[3])+t(e[4])+t(e[5])+t(e[6])+t(e[7])}},13413:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.queryAndListenCurrentSessionInsertLog=void 0;var r=n(85556),o=n(99510);t.queryAndListenCurrentSessionInsertLog=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,i;return r.__generator(this,(function(r){switch(r.label){case 0:return n=[],i=e.on(o.EventName.INSERT_LOG,(function(e){n.push(e)})),[4,e.query()];case 1:return r.sent().concat(n).forEach(t),i(),n=[],[2,e.on(o.EventName.INSERT_LOG,t)]}}))}))}},68808:function(e,t,n){var r=n(87363),o=n(56757),i={tag:"svg",attrs:{fill:"none",viewBox:"0 0 24 24",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.5 10c0-.28.22-.5.5-.5h6.5a.5.5 0 010 1H9a.5.5 0 01-.5-.5zM9 12.5a.5.5 0 000 1h4a.5.5 0 000-1H9z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4 6.5C4 5.67 4.67 5 5.5 5h13c.83 0 1.5.67 1.5 1.5v10c0 .83-.67 1.5-1.5 1.5h-5.31l-3.53 3.09a.7.7 0 01-1.16-.53V18h-3A1.5 1.5 0 014 16.5v-10zM5.5 6a.5.5 0 00-.5.5v10c0 .28.22.5.5.5h3.3c.39 0 .7.31.7.7v2.2l3.06-2.68a.9.9 0 01.59-.22h5.35a.5.5 0 00.5-.5v-10a.5.5 0 00-.5-.5h-13z",fillRule:"evenodd",clipRule:"evenodd"}}]},a=(0,r.forwardRef)((function(e,t){return(0,r.createElement)(o.A,Object.assign({},e,{id:"wecom-titlebar-discussion",ref:t,icon:i}))}));a.displayName="WecomTitlebarDiscussion",t.Z=a},56757:function(e,t,n){n.d(t,{A:function(){return a}});var r=n(87363),o=function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o.apply(this,arguments)},i=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},a=(0,r.forwardRef)((function(e,t){var n=e.icon,a=e.id,c=e.className,l=i(e,["icon","id","className"]),u=("wedocs-icon wedocs-icon-"+a+" "+(c||"")).trim(),d=(0,r.useRef)("_"+Math.random().toString(36).substring(2,8));return s(n,""+a,{defIds:n.defIds,idSuffix:d.current},o({ref:t,className:u},l))}));function s(e,t,n,i){return(0,r.createElement)(e.tag,o(o({key:t},function(e,t){var n=t.defIds;if(!n||0===n.length)return e.attrs;var r=o({},e.attrs);return"use"===e.tag&&r["xlink:href"]&&(r["xlink:href"]=r["xlink:href"]+t.idSuffix),Object.entries(r).forEach((function(e){var n=e[0],o=e[1];"string"==typeof o&&(r[n]=o.replace(/url\(#(.*)\)/,"url(#$1"+t.idSuffix+")"))})),r}(e,n)),i),(function(e,t){var n,r=t.defIds;return r&&0!==r.length&&"defs"===e.tag&&(null===(n=e.children)||void 0===n?void 0:n.length)?o(o({},e),{children:e.children.map((function(e){return"string"==typeof e.attrs.id&&r&&r.indexOf(e.attrs.id)>-1?o(o({},e),{attrs:o(o({},e.attrs),{id:e.attrs.id+t.idSuffix})}):e}))}):e}(e,n).children||[]).map((function(r,o){return s(r,t+"-"+e.tag+"-"+o,n)})))}a.displayName="WefeIcon"},90698:function(e){window,e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){n.r(t),n.d(t,"OS_TYPE",(function(){return r})),n.d(t,"getOSType",(function(){return a})),n.d(t,"callNative",(function(){return c})),n.d(t,"freeCallback",(function(){return l})),n.d(t,"registMethod",(function(){return u})),n.d(t,"unregistMethod",(function(){return d})),n.d(t,"version",(function(){return p}));var r,o="__wmJSCallNativeTemp";!function(e){e.MAC="MAC",e.WIN="WIN",e.LINUX="LINUX",e.IOS="IOS",e.ANDROID="ANDROID",e.UNKNOW="UNKNOW"}(r||(r={}));var i={module:"",method:"",param:{},callback:"",callId:""},a=function(){var e=navigator.userAgent,t=navigator.platform,n=r.UNKNOW;return["Macintosh","MacIntel","MacPPC","Mac68K"].includes(t)?n=r.MAC:["iPhone","iPad","iPod"].includes(t)?n=r.IOS:["Win32","Win64","Windows","WinCE"].includes(t)?n=r.WIN:e.includes("Android")?n=r.ANDROID:n!==r.UNKNOW&&t.includes("Linux")&&(n=r.LINUX),n},s=function(){var e,t=window[o];if(t)return t;var n={callbacks:{},registers:(e={},e.BASIC_MODULE={},e),execCallback:function(e){void 0===e&&(e=""),console.log("Recive Callback From Native",e);var t=window[o];if(t){var n={};try{n=JSON.parse(e)}catch(e){console.error(e)}var r=n.callId;r?t.callbacks[r]?t.callbacks[r](n):console.error("Ignore If Callback With The CallId Has Deleted"):console.error("Ignore If Response Has No CallId")}},sendMessage:function(e){void 0===e&&(e=""),console.log("Recive Message From Native",e);var t={module:"BASIC_MODULE",method:""};try{var n=JSON.parse(e);t=Object.assign(t,n)}catch(e){console.error(e)}var r=t.module,i=t.method,a=t.param;if(i){var s=window[o];if(s){s.registers[r]||(s.registers[r]={});var c=s.registers[r];c[i]||(c[i]=[]),c[i].forEach((function(e){if("function"==typeof e)try{e(a)}catch(e){console.error("Register Method "+i+" Execute Failed",e)}}))}}else console.error("method Not Correct")}};return window[o]=n,n},c=function(e,t,n,c){var l=window[o];l||(l=s());var u=l.callbacks,d="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})),p=c;return p="function"!=typeof p?function(){delete u[d]}:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];c.apply(void 0,e),delete u[d]},u[d]=p,function(e,t){switch(void 0===t&&(t=i),console.log(e,JSON.stringify(t)),a()){case r.MAC:case r.IOS:var n=window.webkit&&window.webkit.messageHandlers;(o=n&&n[e])&&o.postMessage?o.postMessage(JSON.stringify(t)):console.warn("Not A WeMeet Webview");break;case r.WIN:var o=window.external&&window.external.nativeCall,s=t.module,c=t.method,l=t.param,u=t.callback,d=t.callId;o?o(e,[s,c,l,u,d],(function(){})):console.warn("Not A WeMeet Webview");break;case r.ANDROID:case r.LINUX:window.JSCallJavaMgr&&window.JSCallJavaMgr[e]?window.JSCallJavaMgr[e](JSON.stringify(t)):console.warn("Not A WeMeet Webview");break;default:console.error("UNKNOW OS"),console.log("UA: "+navigator.userAgent+", Platform: "+navigator.platform)}}("JSCallNative",{callback:"window.__wmJSCallNativeTemp.execCallback",module:e,method:t,param:n,callId:d}),d},l=function(e){var t=window[o];t||(t=s());var n=t.callbacks;e&&n[e]&&delete n[e]},u=function(e,t,n){if(void 0===n&&(n="BASIC_MODULE"),e&&"function"==typeof t){var r=window[o];r||(r=s()),r.registers[n]||(r.registers[n]={});var i=r.registers[n];i[e]||(i[e]=[]),i[e].push(t)}else console.error("methodName And callback Not Correct")},d=function(e,t,n){if(void 0===n&&(n="BASIC_MODULE"),e&&"function"==typeof t){var r=window[o];r||(r=s()),r.registers[n]||(r.registers[n]={});var i=r.registers[n];i[e]||(i[e]=[]);var a=i[e].indexOf(t);a>-1&&i[e].splice(a,1)}else console.error("methodName And callback Not Correct")},p="1.1.5",h={version:p,registMethod:u,unregistMethod:d,callNative:c,freeCallback:l};t.default=h}])},32230:function(e,t){var n;!function(){var r={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var i=typeof n;if("string"===i||"number"===i)e.push(n);else if(Array.isArray(n)){if(n.length){var a=o.apply(null,n);a&&e.push(a)}}else if("object"===i){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var s in n)r.call(n,s)&&n[s]&&e.push(s)}}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(n=function(){return o}.apply(t,[]))||(e.exports=n)}()},26711:function(e,t,n){var r=n(59325),o=n(70274);function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=i(r),s=i(o),c=[],l=c.forEach,u=c.slice;function d(e){return l.call(u.call(arguments,1),(function(t){if(t)for(var n in t)void 0===e[n]&&(e[n]=t[n])})),e}var p=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,h=function(e,t,n){var r=n||{};r.path=r.path||"/";var o=encodeURIComponent(t),i="".concat(e,"=").concat(o);if(r.maxAge>0){var a=r.maxAge-0;if(Number.isNaN(a))throw new Error("maxAge should be a Number");i+="; Max-Age=".concat(Math.floor(a))}if(r.domain){if(!p.test(r.domain))throw new TypeError("option domain is invalid");i+="; Domain=".concat(r.domain)}if(r.path){if(!p.test(r.path))throw new TypeError("option path is invalid");i+="; Path=".concat(r.path)}if(r.expires){if("function"!=typeof r.expires.toUTCString)throw new TypeError("option expires is invalid");i+="; Expires=".concat(r.expires.toUTCString())}if(r.httpOnly&&(i+="; HttpOnly"),r.secure&&(i+="; Secure"),r.sameSite)switch("string"==typeof r.sameSite?r.sameSite.toLowerCase():r.sameSite){case!0:i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"strict":i+="; SameSite=Strict";break;case"none":i+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return i},f=function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{path:"/",sameSite:"strict"};n&&(o.expires=new Date,o.expires.setTime(o.expires.getTime()+60*n*1e3)),r&&(o.domain=r),document.cookie=h(e,encodeURIComponent(t),o)},g=function(e){for(var t="".concat(e,"="),n=document.cookie.split(";"),r=0;r<n.length;r++){for(var o=n[r];" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return null},v={name:"cookie",lookup:function(e){var t;if(e.lookupCookie&&"undefined"!=typeof document){var n=g(e.lookupCookie);n&&(t=n)}return t},cacheUserLanguage:function(e,t){t.lookupCookie&&"undefined"!=typeof document&&f(t.lookupCookie,e,t.cookieMinutes,t.cookieDomain,t.cookieOptions)}},y={name:"querystring",lookup:function(e){var t;if("undefined"!=typeof window){var n=window.location.search;!window.location.search&&window.location.hash&&window.location.hash.indexOf("?")>-1&&(n=window.location.hash.substring(window.location.hash.indexOf("?")));for(var r=n.substring(1).split("&"),o=0;o<r.length;o++){var i=r[o].indexOf("=");i>0&&r[o].substring(0,i)===e.lookupQuerystring&&(t=r[o].substring(i+1))}}return t}},m=null,b=function(){if(null!==m)return m;try{m="undefined"!==window&&null!==window.localStorage;var e="i18next.translate.boo";window.localStorage.setItem(e,"foo"),window.localStorage.removeItem(e)}catch(e){m=!1}return m},_={name:"localStorage",lookup:function(e){var t;if(e.lookupLocalStorage&&b()){var n=window.localStorage.getItem(e.lookupLocalStorage);n&&(t=n)}return t},cacheUserLanguage:function(e,t){t.lookupLocalStorage&&b()&&window.localStorage.setItem(t.lookupLocalStorage,e)}},C=null,S=function(){if(null!==C)return C;try{C="undefined"!==window&&null!==window.sessionStorage;var e="i18next.translate.boo";window.sessionStorage.setItem(e,"foo"),window.sessionStorage.removeItem(e)}catch(e){C=!1}return C},w={name:"sessionStorage",lookup:function(e){var t;if(e.lookupSessionStorage&&S()){var n=window.sessionStorage.getItem(e.lookupSessionStorage);n&&(t=n)}return t},cacheUserLanguage:function(e,t){t.lookupSessionStorage&&S()&&window.sessionStorage.setItem(t.lookupSessionStorage,e)}},E={name:"navigator",lookup:function(e){var t=[];if("undefined"!=typeof navigator){if(navigator.languages)for(var n=0;n<navigator.languages.length;n++)t.push(navigator.languages[n]);navigator.userLanguage&&t.push(navigator.userLanguage),navigator.language&&t.push(navigator.language)}return t.length>0?t:void 0}},x={name:"htmlTag",lookup:function(e){var t,n=e.htmlTag||("undefined"!=typeof document?document.documentElement:null);return n&&"function"==typeof n.getAttribute&&(t=n.getAttribute("lang")),t}},T={name:"path",lookup:function(e){var t;if("undefined"!=typeof window){var n=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(n instanceof Array)if("number"==typeof e.lookupFromPathIndex){if("string"!=typeof n[e.lookupFromPathIndex])return;t=n[e.lookupFromPathIndex].replace("/","")}else t=n[0].replace("/","")}return t}},R={name:"subdomain",lookup:function(e){var t="number"==typeof e.lookupFromSubdomainIndex?e.lookupFromSubdomainIndex+1:1,n="undefined"!=typeof window&&window.location&&window.location.hostname&&window.location.hostname.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i);if(n)return n[t]}},I=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a.default(this,e),this.type="languageDetector",this.detectors={},this.init(t,n)}return s.default(e,[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.services=e,this.options=d(t,this.options||{},{order:["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"]}),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=n,this.addDetector(v),this.addDetector(y),this.addDetector(_),this.addDetector(w),this.addDetector(E),this.addDetector(x),this.addDetector(T),this.addDetector(R)}},{key:"addDetector",value:function(e){this.detectors[e.name]=e}},{key:"detect",value:function(e){var t=this;e||(e=this.options.order);var n=[];return e.forEach((function(e){if(t.detectors[e]){var r=t.detectors[e].lookup(t.options);r&&"string"==typeof r&&(r=[r]),r&&(n=n.concat(r))}})),this.services.languageUtils.getBestMatchFromCodes?n:n.length>0?n[0]:null}},{key:"cacheUserLanguage",value:function(e,t){var n=this;t||(t=this.options.caches),t&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(e)>-1||t.forEach((function(t){n.detectors[t]&&n.detectors[t].cacheUserLanguage(e,n.options)})))}}]),e}();I.type="languageDetector",e.exports=I},92655:function(e,t,n){n.d(t,{Z:function(){return x}});var r=n(59834),o=n(90476),i=[],a=i.forEach,s=i.slice;function c(e){return a.call(s.call(arguments,1),(function(t){if(t)for(var n in t)void 0===e[n]&&(e[n]=t[n])})),e}var l=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,u=function(e,t,n){var r=n||{};r.path=r.path||"/";var o=encodeURIComponent(t),i="".concat(e,"=").concat(o);if(r.maxAge>0){var a=r.maxAge-0;if(Number.isNaN(a))throw new Error("maxAge should be a Number");i+="; Max-Age=".concat(Math.floor(a))}if(r.domain){if(!l.test(r.domain))throw new TypeError("option domain is invalid");i+="; Domain=".concat(r.domain)}if(r.path){if(!l.test(r.path))throw new TypeError("option path is invalid");i+="; Path=".concat(r.path)}if(r.expires){if("function"!=typeof r.expires.toUTCString)throw new TypeError("option expires is invalid");i+="; Expires=".concat(r.expires.toUTCString())}if(r.httpOnly&&(i+="; HttpOnly"),r.secure&&(i+="; Secure"),r.sameSite)switch("string"==typeof r.sameSite?r.sameSite.toLowerCase():r.sameSite){case!0:i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"strict":i+="; SameSite=Strict";break;case"none":i+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return i},d=function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{path:"/",sameSite:"strict"};n&&(o.expires=new Date,o.expires.setTime(o.expires.getTime()+60*n*1e3)),r&&(o.domain=r),document.cookie=u(e,encodeURIComponent(t),o)},p=function(e){for(var t="".concat(e,"="),n=document.cookie.split(";"),r=0;r<n.length;r++){for(var o=n[r];" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return null},h={name:"cookie",lookup:function(e){var t;if(e.lookupCookie&&"undefined"!=typeof document){var n=p(e.lookupCookie);n&&(t=n)}return t},cacheUserLanguage:function(e,t){t.lookupCookie&&"undefined"!=typeof document&&d(t.lookupCookie,e,t.cookieMinutes,t.cookieDomain,t.cookieOptions)}},f={name:"querystring",lookup:function(e){var t;if("undefined"!=typeof window){var n=window.location.search;!window.location.search&&window.location.hash&&window.location.hash.indexOf("?")>-1&&(n=window.location.hash.substring(window.location.hash.indexOf("?")));for(var r=n.substring(1).split("&"),o=0;o<r.length;o++){var i=r[o].indexOf("=");i>0&&r[o].substring(0,i)===e.lookupQuerystring&&(t=r[o].substring(i+1))}}return t}},g=null,v=function(){if(null!==g)return g;try{g="undefined"!==window&&null!==window.localStorage;var e="i18next.translate.boo";window.localStorage.setItem(e,"foo"),window.localStorage.removeItem(e)}catch(e){g=!1}return g},y={name:"localStorage",lookup:function(e){var t;if(e.lookupLocalStorage&&v()){var n=window.localStorage.getItem(e.lookupLocalStorage);n&&(t=n)}return t},cacheUserLanguage:function(e,t){t.lookupLocalStorage&&v()&&window.localStorage.setItem(t.lookupLocalStorage,e)}},m=null,b=function(){if(null!==m)return m;try{m="undefined"!==window&&null!==window.sessionStorage;var e="i18next.translate.boo";window.sessionStorage.setItem(e,"foo"),window.sessionStorage.removeItem(e)}catch(e){m=!1}return m},_={name:"sessionStorage",lookup:function(e){var t;if(e.lookupSessionStorage&&b()){var n=window.sessionStorage.getItem(e.lookupSessionStorage);n&&(t=n)}return t},cacheUserLanguage:function(e,t){t.lookupSessionStorage&&b()&&window.sessionStorage.setItem(t.lookupSessionStorage,e)}},C={name:"navigator",lookup:function(e){var t=[];if("undefined"!=typeof navigator){if(navigator.languages)for(var n=0;n<navigator.languages.length;n++)t.push(navigator.languages[n]);navigator.userLanguage&&t.push(navigator.userLanguage),navigator.language&&t.push(navigator.language)}return t.length>0?t:void 0}},S={name:"htmlTag",lookup:function(e){var t,n=e.htmlTag||("undefined"!=typeof document?document.documentElement:null);return n&&"function"==typeof n.getAttribute&&(t=n.getAttribute("lang")),t}},w={name:"path",lookup:function(e){var t;if("undefined"!=typeof window){var n=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(n instanceof Array)if("number"==typeof e.lookupFromPathIndex){if("string"!=typeof n[e.lookupFromPathIndex])return;t=n[e.lookupFromPathIndex].replace("/","")}else t=n[0].replace("/","")}return t}},E={name:"subdomain",lookup:function(e){var t="number"==typeof e.lookupFromSubdomainIndex?e.lookupFromSubdomainIndex+1:1,n="undefined"!=typeof window&&window.location&&window.location.hostname&&window.location.hostname.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i);if(n)return n[t]}},x=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,r.Z)(this,e),this.type="languageDetector",this.detectors={},this.init(t,n)}return(0,o.Z)(e,[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.services=e,this.options=c(t,this.options||{},{order:["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"]}),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=n,this.addDetector(h),this.addDetector(f),this.addDetector(y),this.addDetector(_),this.addDetector(C),this.addDetector(S),this.addDetector(w),this.addDetector(E)}},{key:"addDetector",value:function(e){this.detectors[e.name]=e}},{key:"detect",value:function(e){var t=this;e||(e=this.options.order);var n=[];return e.forEach((function(e){if(t.detectors[e]){var r=t.detectors[e].lookup(t.options);r&&"string"==typeof r&&(r=[r]),r&&(n=n.concat(r))}})),this.services.languageUtils.getBestMatchFromCodes?n:n.length>0?n[0]:null}},{key:"cacheUserLanguage",value:function(e,t){var n=this;t||(t=this.options.caches),t&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(e)>-1||t.forEach((function(t){n.detectors[t]&&n.detectors[t].cacheUserLanguage(e,n.options)})))}}]),e}();x.type="languageDetector"},55466:function(e,t,n){var r=n(73462),o=n(59325),i=n(70274),a=n(8443),s=n(4836),c=n(58613),l=n(85754),u=n(53589),d=n(71115);function p(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var h=p(r),f=p(o),g=p(i),v=p(a),y=p(s),m=p(c),b=p(l),_=p(u),C=p(d);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){_.default(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E={type:"logger",log:function(e){this.output("log",e)},warn:function(e){this.output("warn",e)},error:function(e){this.output("error",e)},output:function(e,t){console&&console[e]&&console[e].apply(console,t)}},x=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};f.default(this,e),this.init(t,n)}return g.default(e,[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||E,this.options=t,this.debug=t.debug}},{key:"setDebug",value:function(e){this.debug=e}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"log","",!0)}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","",!0)}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"error","")}},{key:"deprecate",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(e,t,n,r){return r&&!this.debug?null:("string"==typeof e[0]&&(e[0]="".concat(n).concat(this.prefix," ").concat(e[0])),this.logger[t](e))}},{key:"create",value:function(t){return new e(this.logger,w(w({},{prefix:"".concat(this.prefix,":").concat(t,":")}),this.options))}},{key:"clone",value:function(t){return(t=t||this.options).prefix=t.prefix||this.prefix,new e(this.logger,t)}}]),e}(),T=new x,R=function(){function e(){f.default(this,e),this.observers={}}return g.default(e,[{key:"on",value:function(e,t){var n=this;return e.split(" ").forEach((function(e){n.observers[e]=n.observers[e]||[],n.observers[e].push(t)})),this}},{key:"off",value:function(e,t){this.observers[e]&&(t?this.observers[e]=this.observers[e].filter((function(e){return e!==t})):delete this.observers[e])}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(this.observers[e]){var o=[].concat(this.observers[e]);o.forEach((function(e){e.apply(void 0,n)}))}if(this.observers["*"]){var i=[].concat(this.observers["*"]);i.forEach((function(t){t.apply(t,[e].concat(n))}))}}}]),e}();function I(){var e,t,n=new Promise((function(n,r){e=n,t=r}));return n.resolve=e,n.reject=t,n}function P(e){return null==e?"":""+e}function O(e,t,n){e.forEach((function(e){t[e]&&(n[e]=t[e])}))}function k(e,t,n){function r(e){return e&&e.indexOf("###")>-1?e.replace(/###/g,"."):e}function o(){return!e||"string"==typeof e}for(var i="string"!=typeof t?[].concat(t):t.split(".");i.length>1;){if(o())return{};var a=r(i.shift());!e[a]&&n&&(e[a]=new n),e=Object.prototype.hasOwnProperty.call(e,a)?e[a]:{}}return o()?{}:{obj:e,k:r(i.shift())}}function D(e,t,n){var r=k(e,t,Object);r.obj[r.k]=n}function M(e,t){var n=k(e,t),r=n.obj,o=n.k;if(r)return r[o]}function A(e,t,n){var r=M(e,n);return void 0!==r?r:M(t,n)}function L(e,t,n){for(var r in t)"__proto__"!==r&&"constructor"!==r&&(r in e?"string"==typeof e[r]||e[r]instanceof String||"string"==typeof t[r]||t[r]instanceof String?n&&(e[r]=t[r]):L(e[r],t[r],n):e[r]=t[r]);return e}function N(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var B={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function F(e){return"string"==typeof e?e.replace(/[&<>"'\/]/g,(function(e){return B[e]})):e}var U="undefined"!=typeof window&&window.navigator&&void 0===window.navigator.userAgentData&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1,H=[" ",",","?","!",";"];function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){_.default(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b.default(e);if(t){var o=b.default(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return m.default(this,n)}}function W(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(e){if(e[t])return e[t];for(var r=t.split(n),o=e,i=0;i<r.length;++i){if(!o)return;if("string"==typeof o[r[i]]&&i+1<r.length)return;if(void 0===o[r[i]]){for(var a=2,s=r.slice(i,i+a).join(n),c=o[s];void 0===c&&r.length>i+a;)a++,c=o[s=r.slice(i,i+a).join(n)];if(void 0===c)return;if(null===c)return null;if(t.endsWith(s)){if("string"==typeof c)return c;if(s&&"string"==typeof c[s])return c[s]}var l=r.slice(i+a).join(n);return l?W(c,l,n):void 0}o=o[r[i]]}return o}}var z=function(e){y.default(n,e);var t=V(n);function n(e){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};return f.default(this,n),r=t.call(this),U&&R.call(v.default(r)),r.data=e||{},r.options=o,void 0===r.options.keySeparator&&(r.options.keySeparator="."),void 0===r.options.ignoreJSONStructure&&(r.options.ignoreJSONStructure=!0),r}return g.default(n,[{key:"addNamespaces",value:function(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}},{key:"removeNamespaces",value:function(e){var t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}},{key:"getResource",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=void 0!==r.keySeparator?r.keySeparator:this.options.keySeparator,i=void 0!==r.ignoreJSONStructure?r.ignoreJSONStructure:this.options.ignoreJSONStructure,a=[e,t];n&&"string"!=typeof n&&(a=a.concat(n)),n&&"string"==typeof n&&(a=a.concat(o?n.split(o):n)),e.indexOf(".")>-1&&(a=e.split("."));var s=M(this.data,a);return s||!i||"string"!=typeof n?s:W(this.data&&this.data[e]&&this.data[e][t],n,o)}},{key:"addResource",value:function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1},i=this.options.keySeparator;void 0===i&&(i=".");var a=[e,t];n&&(a=a.concat(i?n.split(i):n)),e.indexOf(".")>-1&&(r=t,t=(a=e.split("."))[1]),this.addNamespaces(t),D(this.data,a,r),o.silent||this.emit("added",e,t,n,r)}},{key:"addResources",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(var o in n)"string"!=typeof n[o]&&"[object Array]"!==Object.prototype.toString.apply(n[o])||this.addResource(e,t,o,n[o],{silent:!0});r.silent||this.emit("added",e,t,n)}},{key:"addResourceBundle",value:function(e,t,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1},a=[e,t];e.indexOf(".")>-1&&(r=n,n=t,t=(a=e.split("."))[1]),this.addNamespaces(t);var s=M(this.data,a)||{};r?L(s,n,o):s=G(G({},s),n),D(this.data,a,s),i.silent||this.emit("added",e,t,n)}},{key:"removeResourceBundle",value:function(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}},{key:"hasResourceBundle",value:function(e,t){return void 0!==this.getResource(e,t)}},{key:"getResourceBundle",value:function(e,t){return t||(t=this.options.defaultNS),"v1"===this.options.compatibilityAPI?G(G({},{}),this.getResource(e,t)):this.getResource(e,t)}},{key:"getDataByLanguage",value:function(e){return this.data[e]}},{key:"hasLanguageSomeTranslations",value:function(e){var t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find((function(e){return t[e]&&Object.keys(t[e]).length>0}))}},{key:"toJSON",value:function(){return this.data}}]),n}(R),K={processors:{},addPostProcessor:function(e){this.processors[e.name]=e},handle:function(e,t,n,r,o){var i=this;return e.forEach((function(e){i.processors[e]&&(t=i.processors[e].process(t,n,r,o))})),t}};function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){_.default(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b.default(e);if(t){var o=b.default(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return m.default(this,n)}}var Z={},X=function(e){y.default(n,e);var t=Q(n);function n(e){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return f.default(this,n),r=t.call(this),U&&R.call(v.default(r)),O(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,v.default(r)),r.options=o,void 0===r.options.keySeparator&&(r.options.keySeparator="."),r.logger=T.create("translator"),r}return g.default(n,[{key:"changeLanguage",value:function(e){e&&(this.language=e)}},{key:"exists",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(null==e)return!1;var n=this.resolve(e,t);return n&&void 0!==n.res}},{key:"extractFromKey",value:function(e,t){var n=void 0!==t.nsSeparator?t.nsSeparator:this.options.nsSeparator;void 0===n&&(n=":");var r=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,o=t.ns||this.options.defaultNS||[],i=n&&e.indexOf(n)>-1,a=!(this.options.userDefinedKeySeparator||t.keySeparator||this.options.userDefinedNsSeparator||t.nsSeparator||function(e,t,n){t=t||"",n=n||"";var r=H.filter((function(e){return t.indexOf(e)<0&&n.indexOf(e)<0}));if(0===r.length)return!0;var o=new RegExp("(".concat(r.map((function(e){return"?"===e?"\\?":e})).join("|"),")")),i=!o.test(e);if(!i){var a=e.indexOf(n);a>0&&!o.test(e.substring(0,a))&&(i=!0)}return i}(e,n,r));if(i&&!a){var s=e.match(this.interpolator.nestingRegexp);if(s&&s.length>0)return{key:e,namespaces:o};var c=e.split(n);(n!==r||n===r&&this.options.ns.indexOf(c[0])>-1)&&(o=c.shift()),e=c.join(r)}return"string"==typeof o&&(o=[o]),{key:e,namespaces:o}}},{key:"translate",value:function(e,t,r){var o=this;if("object"!==h.default(t)&&this.options.overloadTranslationOptionHandler&&(t=this.options.overloadTranslationOptionHandler(arguments)),t||(t={}),null==e)return"";Array.isArray(e)||(e=[String(e)]);var i=void 0!==t.returnDetails?t.returnDetails:this.options.returnDetails,a=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,s=this.extractFromKey(e[e.length-1],t),c=s.key,l=s.namespaces,u=l[l.length-1],d=t.lng||this.language,p=t.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(d&&"cimode"===d.toLowerCase()){if(p){var f=t.nsSeparator||this.options.nsSeparator;return i?(g.res="".concat(u).concat(f).concat(c),g):"".concat(u).concat(f).concat(c)}return i?(g.res=c,g):c}var g=this.resolve(e,t),v=g&&g.res,y=g&&g.usedKey||c,m=g&&g.exactUsedKey||c,b=Object.prototype.toString.apply(v),_=["[object Number]","[object Function]","[object RegExp]"],C=void 0!==t.joinArrays?t.joinArrays:this.options.joinArrays,S=!this.i18nFormat||this.i18nFormat.handleAsObject,w="string"!=typeof v&&"boolean"!=typeof v&&"number"!=typeof v;if(S&&v&&w&&_.indexOf(b)<0&&("string"!=typeof C||"[object Array]"!==b)){if(!t.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");var E=this.options.returnedObjectHandler?this.options.returnedObjectHandler(y,v,Y(Y({},t),{},{ns:l})):"key '".concat(c," (").concat(this.language,")' returned an object instead of string.");return i?(g.res=E,g):E}if(a){var x="[object Array]"===b,T=x?[]:{},R=x?m:y;for(var I in v)if(Object.prototype.hasOwnProperty.call(v,I)){var P="".concat(R).concat(a).concat(I);T[I]=this.translate(P,Y(Y({},t),{joinArrays:!1,ns:l})),T[I]===P&&(T[I]=v[I])}v=T}}else if(S&&"string"==typeof C&&"[object Array]"===b)(v=v.join(C))&&(v=this.extendTranslation(v,e,t,r));else{var O=!1,k=!1,D=void 0!==t.count&&"string"!=typeof t.count,M=n.hasDefaultValue(t),A=D?this.pluralResolver.getSuffix(d,t.count,t):"",L=t["defaultValue".concat(A)]||t.defaultValue;!this.isValidLookup(v)&&M&&(O=!0,v=L),this.isValidLookup(v)||(k=!0,v=c);var N=t.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey,B=N&&k?void 0:v,F=M&&L!==v&&this.options.updateMissing;if(k||O||F){if(this.logger.log(F?"updateKey":"missingKey",d,u,c,F?L:v),a){var U=this.resolve(c,Y(Y({},t),{},{keySeparator:!1}));U&&U.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}var H=[],j=this.languageUtils.getFallbackCodes(this.options.fallbackLng,t.lng||this.language);if("fallback"===this.options.saveMissingTo&&j&&j[0])for(var G=0;G<j.length;G++)H.push(j[G]);else"all"===this.options.saveMissingTo?H=this.languageUtils.toResolveHierarchy(t.lng||this.language):H.push(t.lng||this.language);var V=function(e,n,r){var i=M&&r!==v?r:B;o.options.missingKeyHandler?o.options.missingKeyHandler(e,u,n,i,F,t):o.backendConnector&&o.backendConnector.saveMissing&&o.backendConnector.saveMissing(e,u,n,i,F,t),o.emit("missingKey",e,u,n,v)};this.options.saveMissing&&(this.options.saveMissingPlurals&&D?H.forEach((function(e){o.pluralResolver.getSuffixes(e,t).forEach((function(n){V([e],c+n,t["defaultValue".concat(n)]||L)}))})):V(H,c,L))}v=this.extendTranslation(v,e,t,g,r),k&&v===c&&this.options.appendNamespaceToMissingKey&&(v="".concat(u,":").concat(c)),(k||O)&&this.options.parseMissingKeyHandler&&(v="v1"!==this.options.compatibilityAPI?this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?"".concat(u,":").concat(c):c,O?v:void 0):this.options.parseMissingKeyHandler(v))}return i?(g.res=v,g):v}},{key:"extendTranslation",value:function(e,t,n,r,o){var i=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,Y(Y({},this.options.interpolation.defaultVariables),n),r.usedLng,r.usedNS,r.usedKey,{resolved:r});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init(Y(Y({},n),{interpolation:Y(Y({},this.options.interpolation),n.interpolation)}));var a,s="string"==typeof e&&(n&&n.interpolation&&void 0!==n.interpolation.skipOnVariables?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);if(s){var c=e.match(this.interpolator.nestingRegexp);a=c&&c.length}var l=n.replace&&"string"!=typeof n.replace?n.replace:n;if(this.options.interpolation.defaultVariables&&(l=Y(Y({},this.options.interpolation.defaultVariables),l)),e=this.interpolator.interpolate(e,l,n.lng||this.language,n),s){var u=e.match(this.interpolator.nestingRegexp);a<(u&&u.length)&&(n.nest=!1)}!1!==n.nest&&(e=this.interpolator.nest(e,(function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return o&&o[0]===r[0]&&!n.context?(i.logger.warn("It seems you are nesting recursively key: ".concat(r[0]," in key: ").concat(t[0])),null):i.translate.apply(i,r.concat([t]))}),n)),n.interpolation&&this.interpolator.reset()}var d=n.postProcess||this.options.postProcess,p="string"==typeof d?[d]:d;return null!=e&&p&&p.length&&!1!==n.applyPostProcessor&&(e=K.handle(p,e,t,this.options&&this.options.postProcessPassResolved?Y({i18nResolved:r},n):n,this)),e}},{key:"resolve",value:function(e){var t,n,r,o,i,a=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof e&&(e=[e]),e.forEach((function(e){if(!a.isValidLookup(t)){var c=a.extractFromKey(e,s),l=c.key;n=l;var u=c.namespaces;a.options.fallbackNS&&(u=u.concat(a.options.fallbackNS));var d=void 0!==s.count&&"string"!=typeof s.count,p=d&&!s.ordinal&&0===s.count&&a.pluralResolver.shouldUseIntlApi(),h=void 0!==s.context&&("string"==typeof s.context||"number"==typeof s.context)&&""!==s.context,f=s.lngs?s.lngs:a.languageUtils.toResolveHierarchy(s.lng||a.language,s.fallbackLng);u.forEach((function(e){a.isValidLookup(t)||(i=e,!Z["".concat(f[0],"-").concat(e)]&&a.utils&&a.utils.hasLoadedNamespace&&!a.utils.hasLoadedNamespace(i)&&(Z["".concat(f[0],"-").concat(e)]=!0,a.logger.warn('key "'.concat(n,'" for languages "').concat(f.join(", "),'" won\'t get resolved as namespace "').concat(i,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),f.forEach((function(n){if(!a.isValidLookup(t)){o=n;var i,c=[l];if(a.i18nFormat&&a.i18nFormat.addLookupKeys)a.i18nFormat.addLookupKeys(c,l,n,e,s);else{var u;d&&(u=a.pluralResolver.getSuffix(n,s.count,s));var f="".concat(a.options.pluralSeparator,"zero");if(d&&(c.push(l+u),p&&c.push(l+f)),h){var g="".concat(l).concat(a.options.contextSeparator).concat(s.context);c.push(g),d&&(c.push(g+u),p&&c.push(g+f))}}for(;i=c.pop();)a.isValidLookup(t)||(r=i,t=a.getResource(n,e,i,s))}})))}))}})),{res:t,usedKey:n,exactUsedKey:r,usedLng:o,usedNS:i}}},{key:"isValidLookup",value:function(e){return!(void 0===e||!this.options.returnNull&&null===e||!this.options.returnEmptyString&&""===e)}},{key:"getResource",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,t,n,r):this.resourceStore.getResource(e,t,n,r)}}],[{key:"hasDefaultValue",value:function(e){var t="defaultValue";for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t===n.substring(0,t.length)&&void 0!==e[n])return!0;return!1}}]),n}(R);function J(e){return e.charAt(0).toUpperCase()+e.slice(1)}var $=function(){function e(t){f.default(this,e),this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=T.create("languageUtils")}return g.default(e,[{key:"getScriptPartFromCode",value:function(e){if(!e||e.indexOf("-")<0)return null;var t=e.split("-");return 2===t.length?null:(t.pop(),"x"===t[t.length-1].toLowerCase()?null:this.formatLanguageCode(t.join("-")))}},{key:"getLanguagePartFromCode",value:function(e){if(!e||e.indexOf("-")<0)return e;var t=e.split("-");return this.formatLanguageCode(t[0])}},{key:"formatLanguageCode",value:function(e){if("string"==typeof e&&e.indexOf("-")>-1){var t=["hans","hant","latn","cyrl","cans","mong","arab"],n=e.split("-");return this.options.lowerCaseLng?n=n.map((function(e){return e.toLowerCase()})):2===n.length?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),t.indexOf(n[1].toLowerCase())>-1&&(n[1]=J(n[1].toLowerCase()))):3===n.length&&(n[0]=n[0].toLowerCase(),2===n[1].length&&(n[1]=n[1].toUpperCase()),"sgn"!==n[0]&&2===n[2].length&&(n[2]=n[2].toUpperCase()),t.indexOf(n[1].toLowerCase())>-1&&(n[1]=J(n[1].toLowerCase())),t.indexOf(n[2].toLowerCase())>-1&&(n[2]=J(n[2].toLowerCase()))),n.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}},{key:"isSupportedCode",value:function(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}},{key:"getBestMatchFromCodes",value:function(e){var t,n=this;return e?(e.forEach((function(e){if(!t){var r=n.formatLanguageCode(e);n.options.supportedLngs&&!n.isSupportedCode(r)||(t=r)}})),!t&&this.options.supportedLngs&&e.forEach((function(e){if(!t){var r=n.getLanguagePartFromCode(e);if(n.isSupportedCode(r))return t=r;t=n.options.supportedLngs.find((function(e){if(0===e.indexOf(r))return e}))}})),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t):null}},{key:"getFallbackCodes",value:function(e,t){if(!e)return[];if("function"==typeof e&&(e=e(t)),"string"==typeof e&&(e=[e]),"[object Array]"===Object.prototype.toString.apply(e))return e;if(!t)return e.default||[];var n=e[t];return n||(n=e[this.getScriptPartFromCode(t)]),n||(n=e[this.formatLanguageCode(t)]),n||(n=e[this.getLanguagePartFromCode(t)]),n||(n=e.default),n||[]}},{key:"toResolveHierarchy",value:function(e,t){var n=this,r=this.getFallbackCodes(t||this.options.fallbackLng||[],e),o=[],i=function(e){e&&(n.isSupportedCode(e)?o.push(e):n.logger.warn("rejecting language code not found in supportedLngs: ".concat(e)))};return"string"==typeof e&&e.indexOf("-")>-1?("languageOnly"!==this.options.load&&i(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&i(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&i(this.getLanguagePartFromCode(e))):"string"==typeof e&&i(this.formatLanguageCode(e)),r.forEach((function(e){o.indexOf(e)<0&&i(n.formatLanguageCode(e))})),o}}]),e}(),ee=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],te={1:function(e){return Number(e>1)},2:function(e){return Number(1!=e)},3:function(e){return 0},4:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},5:function(e){return Number(0==e?0:1==e?1:2==e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5)},6:function(e){return Number(1==e?0:e>=2&&e<=4?1:2)},7:function(e){return Number(1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},8:function(e){return Number(1==e?0:2==e?1:8!=e&&11!=e?2:3)},9:function(e){return Number(e>=2)},10:function(e){return Number(1==e?0:2==e?1:e<7?2:e<11?3:4)},11:function(e){return Number(1==e||11==e?0:2==e||12==e?1:e>2&&e<20?2:3)},12:function(e){return Number(e%10!=1||e%100==11)},13:function(e){return Number(0!==e)},14:function(e){return Number(1==e?0:2==e?1:3==e?2:3)},15:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2)},16:function(e){return Number(e%10==1&&e%100!=11?0:0!==e?1:2)},17:function(e){return Number(1==e||e%10==1&&e%100!=11?0:1)},18:function(e){return Number(0==e?0:1==e?1:2)},19:function(e){return Number(1==e?0:0==e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3)},20:function(e){return Number(1==e?0:0==e||e%100>0&&e%100<20?1:2)},21:function(e){return Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0)},22:function(e){return Number(1==e?0:2==e?1:(e<0||e>10)&&e%10==0?2:3)}},ne=["v1","v2","v3"],re={zero:0,one:1,two:2,few:3,many:4,other:5};function oe(){var e={};return ee.forEach((function(t){t.lngs.forEach((function(n){e[n]={numbers:t.nr,plurals:te[t.fc]}}))})),e}var ie=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};f.default(this,e),this.languageUtils=t,this.options=n,this.logger=T.create("pluralResolver"),this.options.compatibilityJSON&&"v4"!==this.options.compatibilityJSON||"undefined"!=typeof Intl&&Intl.PluralRules||(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=oe()}return g.default(e,[{key:"addRule",value:function(e,t){this.rules[e]=t}},{key:"getRule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(e,{type:t.ordinal?"ordinal":"cardinal"})}catch(e){return}return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}},{key:"needsPlural",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getRule(e,t);return this.shouldUseIntlApi()?n&&n.resolvedOptions().pluralCategories.length>1:n&&n.numbers.length>1}},{key:"getPluralFormsOfKey",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getSuffixes(e,n).map((function(e){return"".concat(t).concat(e)}))}},{key:"getSuffixes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.getRule(e,n);return r?this.shouldUseIntlApi()?r.resolvedOptions().pluralCategories.sort((function(e,t){return re[e]-re[t]})).map((function(e){return"".concat(t.options.prepend).concat(e)})):r.numbers.map((function(r){return t.getSuffix(e,r,n)})):[]}},{key:"getSuffix",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.getRule(e,n);return r?this.shouldUseIntlApi()?"".concat(this.options.prepend).concat(r.select(t)):this.getSuffixRetroCompatible(r,t):(this.logger.warn("no plural rule found for: ".concat(e)),"")}},{key:"getSuffixRetroCompatible",value:function(e,t){var n=this,r=e.noAbs?e.plurals(t):e.plurals(Math.abs(t)),o=e.numbers[r];this.options.simplifyPluralSuffix&&2===e.numbers.length&&1===e.numbers[0]&&(2===o?o="plural":1===o&&(o=""));var i=function(){return n.options.prepend&&o.toString()?n.options.prepend+o.toString():o.toString()};return"v1"===this.options.compatibilityJSON?1===o?"":"number"==typeof o?"_plural_".concat(o.toString()):i():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===e.numbers.length&&1===e.numbers[0]?i():this.options.prepend&&r.toString()?this.options.prepend+r.toString():r.toString()}},{key:"shouldUseIntlApi",value:function(){return!ne.includes(this.options.compatibilityJSON)}}]),e}();function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(n),!0).forEach((function(t){_.default(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ce=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};f.default(this,e),this.logger=T.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||function(e){return e},this.init(t)}return g.default(e,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});var t=e.interpolation;this.escape=void 0!==t.escape?t.escape:F,this.escapeValue=void 0===t.escapeValue||t.escapeValue,this.useRawValueToEscape=void 0!==t.useRawValueToEscape&&t.useRawValueToEscape,this.prefix=t.prefix?N(t.prefix):t.prefixEscaped||"{{",this.suffix=t.suffix?N(t.suffix):t.suffixEscaped||"}}",this.formatSeparator=t.formatSeparator?t.formatSeparator:t.formatSeparator||",",this.unescapePrefix=t.unescapeSuffix?"":t.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":t.unescapeSuffix||"",this.nestingPrefix=t.nestingPrefix?N(t.nestingPrefix):t.nestingPrefixEscaped||N("$t("),this.nestingSuffix=t.nestingSuffix?N(t.nestingSuffix):t.nestingSuffixEscaped||N(")"),this.nestingOptionsSeparator=t.nestingOptionsSeparator?t.nestingOptionsSeparator:t.nestingOptionsSeparator||",",this.maxReplaces=t.maxReplaces?t.maxReplaces:1e3,this.alwaysFormat=void 0!==t.alwaysFormat&&t.alwaysFormat,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var e="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(e,"g");var t="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(t,"g");var n="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(n,"g")}},{key:"interpolate",value:function(e,t,n,r){var o,i,a,s=this,c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function l(e){return e.replace(/\$/g,"$$$$")}var u=function(e){if(e.indexOf(s.formatSeparator)<0){var o=A(t,c,e);return s.alwaysFormat?s.format(o,void 0,n,se(se(se({},r),t),{},{interpolationkey:e})):o}var i=e.split(s.formatSeparator),a=i.shift().trim(),l=i.join(s.formatSeparator).trim();return s.format(A(t,c,a),l,n,se(se(se({},r),t),{},{interpolationkey:a}))};this.resetRegExp();var d=r&&r.missingInterpolationHandler||this.options.missingInterpolationHandler,p=r&&r.interpolation&&void 0!==r.interpolation.skipOnVariables?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:function(e){return l(e)}},{regex:this.regexp,safeValue:function(e){return s.escapeValue?l(s.escape(e)):l(e)}}].forEach((function(t){for(a=0;o=t.regex.exec(e);){var n=o[1].trim();if(void 0===(i=u(n)))if("function"==typeof d){var c=d(e,o,r);i="string"==typeof c?c:""}else if(r&&r.hasOwnProperty(n))i="";else{if(p){i=o[0];continue}s.logger.warn("missed to pass in variable ".concat(n," for interpolating ").concat(e)),i=""}else"string"==typeof i||s.useRawValueToEscape||(i=P(i));var l=t.safeValue(i);if(e=e.replace(o[0],l),p?(t.regex.lastIndex+=i.length,t.regex.lastIndex-=o[0].length):t.regex.lastIndex=0,++a>=s.maxReplaces)break}})),e}},{key:"nest",value:function(e,t){var n,r,o=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=se({},i);function s(e,t){var n=this.nestingOptionsSeparator;if(e.indexOf(n)<0)return e;var r=e.split(new RegExp("".concat(n,"[ ]*{"))),o="{".concat(r[1]);e=r[0];var i=(o=this.interpolate(o,a)).match(/'/g),s=o.match(/"/g);(i&&i.length%2==0&&!s||s.length%2!=0)&&(o=o.replace(/'/g,'"'));try{a=JSON.parse(o),t&&(a=se(se({},t),a))}catch(t){return this.logger.warn("failed parsing options string in nesting for key ".concat(e),t),"".concat(e).concat(n).concat(o)}return delete a.defaultValue,e}for(a.applyPostProcessor=!1,delete a.defaultValue;n=this.nestingRegexp.exec(e);){var c=[],l=!1;if(-1!==n[0].indexOf(this.formatSeparator)&&!/{.*}/.test(n[1])){var u=n[1].split(this.formatSeparator).map((function(e){return e.trim()}));n[1]=u.shift(),c=u,l=!0}if((r=t(s.call(this,n[1].trim(),a),a))&&n[0]===e&&"string"!=typeof r)return r;"string"!=typeof r&&(r=P(r)),r||(this.logger.warn("missed to resolve ".concat(n[1]," for nesting ").concat(e)),r=""),l&&(r=c.reduce((function(e,t){return o.format(e,t,i.lng,se(se({},i),{},{interpolationkey:n[1].trim()}))}),r.trim())),e=e.replace(n[0],r),this.regexp.lastIndex=0}return e}}]),e}();function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){_.default(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function de(e){var t={};return function(n,r,o){var i=r+JSON.stringify(o),a=t[i];return a||(a=e(r,o),t[i]=a),a(n)}}var pe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};f.default(this,e),this.logger=T.create("formatter"),this.options=t,this.formats={number:de((function(e,t){var n=new Intl.NumberFormat(e,t);return function(e){return n.format(e)}})),currency:de((function(e,t){var n=new Intl.NumberFormat(e,ue(ue({},t),{},{style:"currency"}));return function(e){return n.format(e)}})),datetime:de((function(e,t){var n=new Intl.DateTimeFormat(e,ue({},t));return function(e){return n.format(e)}})),relativetime:de((function(e,t){var n=new Intl.RelativeTimeFormat(e,ue({},t));return function(e){return n.format(e,t.range||"day")}})),list:de((function(e,t){var n=new Intl.ListFormat(e,ue({},t));return function(e){return n.format(e)}}))},this.init(t)}return g.default(e,[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}},n=t.interpolation;this.formatSeparator=n.formatSeparator?n.formatSeparator:n.formatSeparator||","}},{key:"add",value:function(e,t){this.formats[e.toLowerCase().trim()]=t}},{key:"addCached",value:function(e,t){this.formats[e.toLowerCase().trim()]=de(t)}},{key:"format",value:function(e,t,n,r){var o=this;return t.split(this.formatSeparator).reduce((function(e,t){var i=function(e){var t=e.toLowerCase().trim(),n={};if(e.indexOf("(")>-1){var r=e.split("(");t=r[0].toLowerCase().trim();var o=r[1].substring(0,r[1].length-1);"currency"===t&&o.indexOf(":")<0?n.currency||(n.currency=o.trim()):"relativetime"===t&&o.indexOf(":")<0?n.range||(n.range=o.trim()):o.split(";").forEach((function(e){if(e){var t=e.split(":"),r=C.default(t),o=r[0],i=r.slice(1).join(":").trim().replace(/^'+|'+$/g,"");n[o.trim()]||(n[o.trim()]=i),"false"===i&&(n[o.trim()]=!1),"true"===i&&(n[o.trim()]=!0),isNaN(i)||(n[o.trim()]=parseInt(i,10))}}))}return{formatName:t,formatOptions:n}}(t),a=i.formatName,s=i.formatOptions;if(o.formats[a]){var c=e;try{var l=r&&r.formatParams&&r.formatParams[r.interpolationkey]||{},u=l.locale||l.lng||r.locale||r.lng||n;c=o.formats[a](e,u,ue(ue(ue({},s),r),l))}catch(e){o.logger.warn(e)}return c}return o.logger.warn("there was no format function for ".concat(a)),e}),e)}}]),e}();function he(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?he(Object(n),!0).forEach((function(t){_.default(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):he(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b.default(e);if(t){var o=b.default(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return m.default(this,n)}}var ve=function(e){y.default(n,e);var t=ge(n);function n(e,r,o){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return f.default(this,n),i=t.call(this),U&&R.call(v.default(i)),i.backend=e,i.store=r,i.services=o,i.languageUtils=o.languageUtils,i.options=a,i.logger=T.create("backendConnector"),i.waitingReads=[],i.maxParallelReads=a.maxParallelReads||10,i.readingCalls=0,i.maxRetries=a.maxRetries>=0?a.maxRetries:5,i.retryTimeout=a.retryTimeout>=1?a.retryTimeout:350,i.state={},i.queue=[],i.backend&&i.backend.init&&i.backend.init(o,a.backend,a),i}return g.default(n,[{key:"queueLoad",value:function(e,t,n,r){var o=this,i={},a={},s={},c={};return e.forEach((function(e){var r=!0;t.forEach((function(t){var s="".concat(e,"|").concat(t);!n.reload&&o.store.hasResourceBundle(e,t)?o.state[s]=2:o.state[s]<0||(1===o.state[s]?void 0===a[s]&&(a[s]=!0):(o.state[s]=1,r=!1,void 0===a[s]&&(a[s]=!0),void 0===i[s]&&(i[s]=!0),void 0===c[t]&&(c[t]=!0)))})),r||(s[e]=!0)})),(Object.keys(i).length||Object.keys(a).length)&&this.queue.push({pending:a,pendingCount:Object.keys(a).length,loaded:{},errors:[],callback:r}),{toLoad:Object.keys(i),pending:Object.keys(a),toLoadLanguages:Object.keys(s),toLoadNamespaces:Object.keys(c)}}},{key:"loaded",value:function(e,t,n){var r=e.split("|"),o=r[0],i=r[1];t&&this.emit("failedLoading",o,i,t),n&&this.store.addResourceBundle(o,i,n),this.state[e]=t?-1:2;var a={};this.queue.forEach((function(n){var r,s,c,l,u,d;r=n.loaded,s=i,l=k(r,[o],Object),u=l.obj,d=l.k,u[d]=u[d]||[],c&&(u[d]=u[d].concat(s)),c||u[d].push(s),function(e,t){void 0!==e.pending[t]&&(delete e.pending[t],e.pendingCount--)}(n,e),t&&n.errors.push(t),0!==n.pendingCount||n.done||(Object.keys(n.loaded).forEach((function(e){a[e]||(a[e]={});var t=n.loaded[e];t.length&&t.forEach((function(t){void 0===a[e][t]&&(a[e][t]=!0)}))})),n.done=!0,n.errors.length?n.callback(n.errors):n.callback())})),this.emit("loaded",a),this.queue=this.queue.filter((function(e){return!e.done}))}},{key:"read",value:function(e,t,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.retryTimeout,a=arguments.length>5?arguments[5]:void 0;return e.length?this.readingCalls>=this.maxParallelReads?void this.waitingReads.push({lng:e,ns:t,fcName:n,tried:o,wait:i,callback:a}):(this.readingCalls++,this.backend[n](e,t,(function(s,c){if(r.readingCalls--,r.waitingReads.length>0){var l=r.waitingReads.shift();r.read(l.lng,l.ns,l.fcName,l.tried,l.wait,l.callback)}s&&c&&o<r.maxRetries?setTimeout((function(){r.read.call(r,e,t,n,o+1,2*i,a)}),i):a(s,c)}))):a(null,{})}},{key:"prepareLoading",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),o&&o();"string"==typeof e&&(e=this.languageUtils.toResolveHierarchy(e)),"string"==typeof t&&(t=[t]);var i=this.queueLoad(e,t,r,o);if(!i.toLoad.length)return i.pending.length||o(),null;i.toLoad.forEach((function(e){n.loadOne(e)}))}},{key:"load",value:function(e,t,n){this.prepareLoading(e,t,{},n)}},{key:"reload",value:function(e,t,n){this.prepareLoading(e,t,{reload:!0},n)}},{key:"loadOne",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=e.split("|"),o=r[0],i=r[1];this.read(o,i,"read",void 0,void 0,(function(r,a){r&&t.logger.warn("".concat(n,"loading namespace ").concat(i," for language ").concat(o," failed"),r),!r&&a&&t.logger.log("".concat(n,"loaded namespace ").concat(i," for language ").concat(o),a),t.loaded(e,r,a)}))}},{key:"saveMissing",value:function(e,t,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(t)?this.logger.warn('did not save key "'.concat(n,'" as the namespace "').concat(t,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!"):null!=n&&""!==n&&(this.backend&&this.backend.create&&this.backend.create(e,t,n,r,null,fe(fe({},i),{},{isUpdate:o})),e&&e[0]&&this.store.addResource(e[0],t,n,r))}}]),n}(R);function ye(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(e){var t={};if("object"===h.default(e[1])&&(t=e[1]),"string"==typeof e[1]&&(t.defaultValue=e[1]),"string"==typeof e[2]&&(t.tDescription=e[2]),"object"===h.default(e[2])||"object"===h.default(e[3])){var n=e[3]||e[2];Object.keys(n).forEach((function(e){t[e]=n[e]}))}return t},interpolation:{escapeValue:!0,format:function(e,t,n,r){return e},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}}function me(e){return"string"==typeof e.ns&&(e.ns=[e.ns]),"string"==typeof e.fallbackLng&&(e.fallbackLng=[e.fallbackLng]),"string"==typeof e.fallbackNS&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs&&e.supportedLngs.indexOf("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),e}function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach((function(t){_.default(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b.default(e);if(t){var o=b.default(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return m.default(this,n)}}function Se(){}function we(e){Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach((function(t){"function"==typeof e[t]&&(e[t]=e[t].bind(e))}))}var Ee=function(e){y.default(n,e);var t=Ce(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0;if(f.default(this,n),e=t.call(this),U&&R.call(v.default(e)),e.options=me(r),e.services={},e.logger=T,e.modules={external:[]},we(v.default(e)),o&&!e.isInitialized&&!r.isClone){if(!e.options.initImmediate)return e.init(r,o),m.default(e,v.default(e));setTimeout((function(){e.init(r,o)}),0)}return e}return g.default(n,[{key:"init",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;"function"==typeof t&&(n=t,t={}),!t.defaultNS&&!1!==t.defaultNS&&t.ns&&("string"==typeof t.ns?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));var r=ye();function o(e){return e?"function"==typeof e?new e:e:null}if(this.options=_e(_e(_e({},r),this.options),me(t)),"v1"!==this.options.compatibilityAPI&&(this.options.interpolation=_e(_e({},r.interpolation),this.options.interpolation)),void 0!==t.keySeparator&&(this.options.userDefinedKeySeparator=t.keySeparator),void 0!==t.nsSeparator&&(this.options.userDefinedNsSeparator=t.nsSeparator),!this.options.isClone){var i;this.modules.logger?T.init(o(this.modules.logger),this.options):T.init(null,this.options),this.modules.formatter?i=this.modules.formatter:"undefined"!=typeof Intl&&(i=pe);var a=new $(this.options);this.store=new z(this.options.resources,this.options);var s=this.services;s.logger=T,s.resourceStore=this.store,s.languageUtils=a,s.pluralResolver=new ie(a,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),!i||this.options.interpolation.format&&this.options.interpolation.format!==r.interpolation.format||(s.formatter=o(i),s.formatter.init(s,this.options),this.options.interpolation.format=s.formatter.format.bind(s.formatter)),s.interpolator=new ce(this.options),s.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},s.backendConnector=new ve(o(this.modules.backend),s.resourceStore,s,this.options),s.backendConnector.on("*",(function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];e.emit.apply(e,[t].concat(r))})),this.modules.languageDetector&&(s.languageDetector=o(this.modules.languageDetector),s.languageDetector.init(s,this.options.detection,this.options)),this.modules.i18nFormat&&(s.i18nFormat=o(this.modules.i18nFormat),s.i18nFormat.init&&s.i18nFormat.init(this)),this.translator=new X(this.services,this.options),this.translator.on("*",(function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];e.emit.apply(e,[t].concat(r))})),this.modules.external.forEach((function(t){t.init&&t.init(e)}))}if(this.format=this.options.interpolation.format,n||(n=Se),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){var c=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);c.length>0&&"dev"!==c[0]&&(this.options.lng=c[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined");var l=["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"];l.forEach((function(t){e[t]=function(){var n;return(n=e.store)[t].apply(n,arguments)}}));var u=["addResource","addResources","addResourceBundle","removeResourceBundle"];u.forEach((function(t){e[t]=function(){var n;return(n=e.store)[t].apply(n,arguments),e}}));var d=I(),p=function(){var t=function(t,r){e.isInitialized&&!e.initializedStoreOnce&&e.logger.warn("init: i18next is already initialized. You should call init just once!"),e.isInitialized=!0,e.options.isClone||e.logger.log("initialized",e.options),e.emit("initialized",e.options),d.resolve(r),n(t,r)};if(e.languages&&"v1"!==e.options.compatibilityAPI&&!e.isInitialized)return t(null,e.t.bind(e));e.changeLanguage(e.options.lng,t)};return this.options.resources||!this.options.initImmediate?p():setTimeout(p,0),d}},{key:"loadResources",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Se,r=n,o="string"==typeof e?e:this.language;if("function"==typeof e&&(r=e),!this.options.resources||this.options.partialBundledLanguages){if(o&&"cimode"===o.toLowerCase())return r();var i=[],a=function(e){e&&t.services.languageUtils.toResolveHierarchy(e).forEach((function(e){i.indexOf(e)<0&&i.push(e)}))};if(o)a(o);else{var s=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);s.forEach((function(e){return a(e)}))}this.options.preload&&this.options.preload.forEach((function(e){return a(e)})),this.services.backendConnector.load(i,this.options.ns,(function(e){e||t.resolvedLanguage||!t.language||t.setResolvedLanguage(t.language),r(e)}))}else r(null)}},{key:"reloadResources",value:function(e,t,n){var r=I();return e||(e=this.languages),t||(t=this.options.ns),n||(n=Se),this.services.backendConnector.reload(e,t,(function(e){r.resolve(),n(e)})),r}},{key:"use",value:function(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&K.addPostProcessor(e),"formatter"===e.type&&(this.modules.formatter=e),"3rdParty"===e.type&&this.modules.external.push(e),this}},{key:"setResolvedLanguage",value:function(e){if(e&&this.languages&&!(["cimode","dev"].indexOf(e)>-1))for(var t=0;t<this.languages.length;t++){var n=this.languages[t];if(!(["cimode","dev"].indexOf(n)>-1)&&this.store.hasLanguageSomeTranslations(n)){this.resolvedLanguage=n;break}}}},{key:"changeLanguage",value:function(e,t){var n=this;this.isLanguageChangingTo=e;var r=I();this.emit("languageChanging",e);var o=function(e){n.language=e,n.languages=n.services.languageUtils.toResolveHierarchy(e),n.resolvedLanguage=void 0,n.setResolvedLanguage(e)},i=function(i){e||i||!n.services.languageDetector||(i=[]);var a="string"==typeof i?i:n.services.languageUtils.getBestMatchFromCodes(i);a&&(n.language||o(a),n.translator.language||n.translator.changeLanguage(a),n.services.languageDetector&&n.services.languageDetector.cacheUserLanguage(a)),n.loadResources(a,(function(e){!function(e,i){i?(o(i),n.translator.changeLanguage(i),n.isLanguageChangingTo=void 0,n.emit("languageChanged",i),n.logger.log("languageChanged",i)):n.isLanguageChangingTo=void 0,r.resolve((function(){return n.t.apply(n,arguments)})),t&&t(e,(function(){return n.t.apply(n,arguments)}))}(e,a)}))};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect(i):i(e):i(this.services.languageDetector.detect()),r}},{key:"getFixedT",value:function(e,t,n){var r=this,o=function e(t,o){var i;if("object"!==h.default(o)){for(var a=arguments.length,s=new Array(a>2?a-2:0),c=2;c<a;c++)s[c-2]=arguments[c];i=r.options.overloadTranslationOptionHandler([t,o].concat(s))}else i=_e({},o);i.lng=i.lng||e.lng,i.lngs=i.lngs||e.lngs,i.ns=i.ns||e.ns,i.keyPrefix=i.keyPrefix||n||e.keyPrefix;var l=r.options.keySeparator||".",u=i.keyPrefix?"".concat(i.keyPrefix).concat(l).concat(t):t;return r.t(u,i)};return"string"==typeof e?o.lng=e:o.lngs=e,o.ns=t,o.keyPrefix=n,o}},{key:"t",value:function(){var e;return this.translator&&(e=this.translator).translate.apply(e,arguments)}},{key:"exists",value:function(){var e;return this.translator&&(e=this.translator).exists.apply(e,arguments)}},{key:"setDefaultNamespace",value:function(e){this.options.defaultNS=e}},{key:"hasLoadedNamespace",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var r=this.resolvedLanguage||this.languages[0],o=!!this.options&&this.options.fallbackLng,i=this.languages[this.languages.length-1];if("cimode"===r.toLowerCase())return!0;var a=function(e,n){var r=t.services.backendConnector.state["".concat(e,"|").concat(n)];return-1===r||2===r};if(n.precheck){var s=n.precheck(this,a);if(void 0!==s)return s}return!(!this.hasResourceBundle(r,e)&&this.services.backendConnector.backend&&(!this.options.resources||this.options.partialBundledLanguages)&&(!a(r,e)||o&&!a(i,e)))}},{key:"loadNamespaces",value:function(e,t){var n=this,r=I();return this.options.ns?("string"==typeof e&&(e=[e]),e.forEach((function(e){n.options.ns.indexOf(e)<0&&n.options.ns.push(e)})),this.loadResources((function(e){r.resolve(),t&&t(e)})),r):(t&&t(),Promise.resolve())}},{key:"loadLanguages",value:function(e,t){var n=I();"string"==typeof e&&(e=[e]);var r=this.options.preload||[],o=e.filter((function(e){return r.indexOf(e)<0}));return o.length?(this.options.preload=r.concat(o),this.loadResources((function(e){n.resolve(),t&&t(e)})),n):(t&&t(),Promise.resolve())}},{key:"dir",value:function(e){return e||(e=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),e?["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(this.services.languageUtils.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr":"rtl"}},{key:"cloneInstance",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Se,o=_e(_e(_e({},this.options),t),{isClone:!0}),i=new n(o);void 0===t.debug&&void 0===t.prefix||(i.logger=i.logger.clone(t));var a=["store","services","language"];return a.forEach((function(t){i[t]=e[t]})),i.services=_e({},this.services),i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i.translator=new X(i.services,i.options),i.translator.on("*",(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];i.emit.apply(i,[e].concat(n))})),i.init(o,r),i.translator.options=i.options,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}},{key:"toJSON",value:function(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}]),n}(R);_.default(Ee,"createInstance",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return new Ee(e,t)}));var xe=Ee.createInstance();xe.createInstance=Ee.createInstance,e.exports=xe},44057:function(e,t,n){var r,o,i;i=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(r){function o(){}function i(t,n,i){if("undefined"!=typeof document){"number"==typeof(i=e({path:"/"},o.defaults,i)).expires&&(i.expires=new Date(1*new Date+864e5*i.expires)),i.expires=i.expires?i.expires.toUTCString():"";try{var a=JSON.stringify(n);/^[\{\[]/.test(a)&&(n=a)}catch(e){}n=r.write?r.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var c in i)i[c]&&(s+="; "+c,!0!==i[c]&&(s+="="+i[c].split(";")[0]));return document.cookie=t+"="+n+s}}function a(e,n){if("undefined"!=typeof document){for(var o={},i=document.cookie?document.cookie.split("; "):[],a=0;a<i.length;a++){var s=i[a].split("="),c=s.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var l=t(s[0]);if(c=(r.read||r)(c,l)||t(c),n)try{c=JSON.parse(c)}catch(e){}if(o[l]=c,e===l)break}catch(e){}}return e?o[e]:o}}return o.set=i,o.get=function(e){return a(e,!1)},o.getJSON=function(e){return a(e,!0)},o.remove=function(t,n){i(t,"",e(n,{expires:-1}))},o.defaults={},o.withConverter=n,o}((function(){}))},void 0===(o="function"==typeof(r=i)?r.call(t,n,t,e):r)||(e.exports=o),e.exports=i()},5125:function(e,t,n){n.r(t);var r=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function o(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(o=e[n],i=t[n],!(o===i||r(o)&&r(i)))return!1;var o,i;return!0}t.default=function(e,t){var n;void 0===t&&(t=o);var r,i=[],a=!1;return function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];return a&&n===this&&t(o,i)||(r=e.apply(this,o),a=!0,n=this,i=o),r}}},90464:function(e,t,n){var r=n(33174);function o(){}function i(){}i.resetWarningCache=o,e.exports=function(){function e(e,t,n,o,i,a){if(a!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:o};return n.PropTypes=n,n}},53211:function(e,t,n){e.exports=n(90464)()},33174:function(e){e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},43813:function(e,t,n){n.d(t,{ZP:function(){return b}});var r=n(26150),o=n(74687),i=n(87363),a=n.n(i),s=n(61533),c=n.n(s),l=!1,u=n(86429),d=n(98219),p="unmounted",h="exited",f="entering",g="entered",v="exiting",y=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var o,i=n&&!n.isMounting?t.enter:t.appear;return r.appearStatus=null,t.in?i?(o=h,r.appearStatus=f):o=g:o=t.unmountOnExit||t.mountOnEnter?p:h,r.state={status:o},r.nextCallback=null,r}(0,o.Z)(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===p?{status:h}:null};var n=t.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==f&&n!==g&&(t=f):n!==f&&n!==g||(t=v)}this.updateStatus(!1,t)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var e,t,n,r=this.props.timeout;return e=t=n=r,null!=r&&"number"!=typeof r&&(e=r.exit,t=r.enter,n=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:n}},n.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===f){if(this.props.unmountOnExit||this.props.mountOnEnter){var n=this.props.nodeRef?this.props.nodeRef.current:c().findDOMNode(this);n&&(0,d.Q)(n)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===h&&this.setState({status:p})},n.performEnter=function(e){var t=this,n=this.props.enter,r=this.context?this.context.isMounting:e,o=this.props.nodeRef?[r]:[c().findDOMNode(this),r],i=o[0],a=o[1],s=this.getTimeouts(),u=r?s.appear:s.enter;!e&&!n||l?this.safeSetState({status:g},(function(){t.props.onEntered(i)})):(this.props.onEnter(i,a),this.safeSetState({status:f},(function(){t.props.onEntering(i,a),t.onTransitionEnd(u,(function(){t.safeSetState({status:g},(function(){t.props.onEntered(i,a)}))}))})))},n.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),r=this.props.nodeRef?void 0:c().findDOMNode(this);t&&!l?(this.props.onExit(r),this.safeSetState({status:v},(function(){e.props.onExiting(r),e.onTransitionEnd(n.exit,(function(){e.safeSetState({status:h},(function(){e.props.onExited(r)}))}))}))):this.safeSetState({status:h},(function(){e.props.onExited(r)}))},n.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},n.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(r){n&&(n=!1,t.nextCallback=null,e(r))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},n.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:c().findDOMNode(this),r=null==e&&!this.props.addEndListener;if(n&&!r){if(this.props.addEndListener){var o=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],i=o[0],a=o[1];this.props.addEndListener(i,a)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},n.render=function(){var e=this.state.status;if(e===p)return null;var t=this.props,n=t.children,o=(t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef,(0,r.Z)(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return a().createElement(u.Z.Provider,{value:null},"function"==typeof n?n(e,o):a().cloneElement(a().Children.only(n),o))},t}(a().Component);function m(){}y.contextType=u.Z,y.propTypes={},y.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:m,onEntering:m,onEntered:m,onExit:m,onExiting:m,onExited:m},y.UNMOUNTED=p,y.EXITED=h,y.ENTERING=f,y.ENTERED=g,y.EXITING=v;var b=y},86429:function(e,t,n){var r=n(87363),o=n.n(r);t.Z=o().createContext(null)},98219:function(e,t,n){n.d(t,{Q:function(){return r}});var r=function(e){return e.scrollTop}},3056:function(e,t,n){n.d(t,{X:function(){return a}});var r=n(85556),o=n(63357),i=n(98926),a=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return r.__extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return n&&!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new i.N;return this._value},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(o.xQ)},77452:function(e,t,n){n.d(t,{y:function(){return u}});var r=n(92449),o=n(66236),i=n(97345),a=n(93360),s=n(33494);function c(e){return 0===e.length?s.y:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var l=n(49348),u=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var a=this.operator,s=function(e,t,n){if(e){if(e instanceof r.L)return e;if(e[o.b])return e[o.b]()}return e||t||n?new r.L(e,t,n):new r.L(i.c)}(e,t,n);if(a?s.add(a.call(s,this.source)):s.add(this.source||l.v.useDeprecatedSynchronousErrorHandling&&!s.syncErrorThrowable?this._subscribe(s):this._trySubscribe(s)),l.v.useDeprecatedSynchronousErrorHandling&&s.syncErrorThrowable&&(s.syncErrorThrowable=!1,s.syncErrorThrown))throw s.syncErrorValue;return s},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){l.v.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){var t=e,n=t.closed,o=t.destination,i=t.isStopped;if(n||i)return!1;e=o&&o instanceof r.L?o:null}return!0}(e)?e.error(t):console.warn(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=d(t))((function(t,r){var o;o=n.subscribe((function(t){try{e(t)}catch(e){r(e),o&&o.unsubscribe()}}),r,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[a.L]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:c(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=d(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function d(e){if(e||(e=l.v.Promise||Promise),!e)throw new Error("no Promise impl found");return e}},97345:function(e,t,n){n.d(t,{c:function(){return i}});var r=n(49348),o=n(4e3),i={closed:!0,next:function(e){},error:function(e){if(r.v.useDeprecatedSynchronousErrorHandling)throw e;(0,o.z)(e)},complete:function(){}}},91301:function(e,t,n){n.d(t,{t:function(){return S}});var r,o=n(85556),i=n(63357),a=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return o.__extends(t,e),t.prototype.schedule=function(t,n){return void 0===n&&(n=0),n>0?e.prototype.schedule.call(this,t,n):(this.delay=n,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,n){return n>0||this.closed?e.prototype.execute.call(this,t,n):this._execute(t,n)},t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0?e.prototype.requestAsyncId.call(this,t,n,r):t.flush(this)},t}(n(93765).o),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t}(n(83081).v),c=new s(a),l=n(66653),u=n(92449),d=n(54070),p=n(97293),h=n(99137),f=n(88813),g=n(77452);function v(e){var t=e.error;e.subscriber.error(t)}r||(r={});var y=function(){function e(e,t,n){this.kind=e,this.value=t,this.error=n,this.hasValue="N"===e}return e.prototype.observe=function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}},e.prototype.do=function(e,t,n){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return n&&n()}},e.prototype.accept=function(e,t,n){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,n)},e.prototype.toObservable=function(){switch(this.kind){case"N":return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[e.length-1];return(0,p.K)(n)?(e.pop(),(0,f.r)(e,n)):(0,h.n)(e)}(this.value);case"E":return function(e,t){return t?new g.y((function(n){return t.schedule(v,0,{error:e,subscriber:n})})):new g.y((function(t){return t.error(e)}))}(this.error);case"C":return(0,d.c)()}throw new Error("unexpected notification kind value")},e.createNext=function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification},e.createError=function(t){return new e("E",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e}(),m=function(e){function t(t,n,r){void 0===r&&(r=0);var o=e.call(this,t)||this;return o.scheduler=n,o.delay=r,o}return o.__extends(t,e),t.dispatch=function(e){var t=e.notification,n=e.destination;t.observe(n),this.unsubscribe()},t.prototype.scheduleMessage=function(e){this.destination.add(this.scheduler.schedule(t.dispatch,this.delay,new b(e,this.destination)))},t.prototype._next=function(e){this.scheduleMessage(y.createNext(e))},t.prototype._error=function(e){this.scheduleMessage(y.createError(e)),this.unsubscribe()},t.prototype._complete=function(){this.scheduleMessage(y.createComplete()),this.unsubscribe()},t}(u.L),b=function(){return function(e,t){this.notification=e,this.destination=t}}(),_=n(98926),C=n(48077),S=function(e){function t(t,n,r){void 0===t&&(t=Number.POSITIVE_INFINITY),void 0===n&&(n=Number.POSITIVE_INFINITY);var o=e.call(this)||this;return o.scheduler=r,o._events=[],o._infiniteTimeWindow=!1,o._bufferSize=t<1?1:t,o._windowTime=n<1?1:n,n===Number.POSITIVE_INFINITY?(o._infiniteTimeWindow=!0,o.next=o.nextInfiniteTimeWindow):o.next=o.nextTimeWindow,o}return o.__extends(t,e),t.prototype.nextInfiniteTimeWindow=function(t){if(!this.isStopped){var n=this._events;n.push(t),n.length>this._bufferSize&&n.shift()}e.prototype.next.call(this,t)},t.prototype.nextTimeWindow=function(t){this.isStopped||(this._events.push(new w(this._getNow(),t)),this._trimBufferThenGetEvents()),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){var t,n=this._infiniteTimeWindow,r=n?this._events:this._trimBufferThenGetEvents(),o=this.scheduler,i=r.length;if(this.closed)throw new _.N;if(this.isStopped||this.hasError?t=l.w.EMPTY:(this.observers.push(e),t=new C.W(this,e)),o&&e.add(e=new m(e,o)),n)for(var a=0;a<i&&!e.closed;a++)e.next(r[a]);else for(a=0;a<i&&!e.closed;a++)e.next(r[a].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),t},t.prototype._getNow=function(){return(this.scheduler||c).now()},t.prototype._trimBufferThenGetEvents=function(){for(var e=this._getNow(),t=this._bufferSize,n=this._windowTime,r=this._events,o=r.length,i=0;i<o&&!(e-r[i].time<n);)i++;return o>t&&(i=Math.max(i,o-t)),i>0&&r.splice(0,i),r},t}(i.xQ),w=function(){return function(e,t){this.time=e,this.value=t}}()},63357:function(e,t,n){n.d(t,{xQ:function(){return d}});var r=n(85556),o=n(77452),i=n(92449),a=n(66653),s=n(98926),c=n(48077),l=n(66236),u=function(e){function t(t){var n=e.call(this,t)||this;return n.destination=t,n}return r.__extends(t,e),t}(i.L),d=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return r.__extends(t,e),t.prototype[l.b]=function(){return new u(this)},t.prototype.lift=function(e){var t=new p(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new s.N;if(!this.isStopped)for(var t=this.observers,n=t.length,r=t.slice(),o=0;o<n;o++)r[o].next(e)},t.prototype.error=function(e){if(this.closed)throw new s.N;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,r=t.slice(),o=0;o<n;o++)r[o].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new s.N;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),r=0;r<t;r++)n[r].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new s.N;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new s.N;return this.hasError?(e.error(this.thrownError),a.w.EMPTY):this.isStopped?(e.complete(),a.w.EMPTY):(this.observers.push(e),new c.W(this,e))},t.prototype.asObservable=function(){var e=new o.y;return e.source=this,e},t.create=function(e,t){return new p(e,t)},t}(o.y),p=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return r.__extends(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):a.w.EMPTY},t}(d)},48077:function(e,t,n){n.d(t,{W:function(){return o}});var r=n(85556),o=function(e){function t(t,n){var r=e.call(this)||this;return r.subject=t,r.subscriber=n,r.closed=!1,r}return r.__extends(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}},t}(n(66653).w)},92449:function(e,t,n){n.d(t,{L:function(){return u}});var r=n(85556),o=n(85638),i=n(97345),a=n(66653),s=n(66236),c=n(49348),l=n(4e3),u=function(e){function t(n,r,o){var a=e.call(this)||this;switch(a.syncErrorValue=null,a.syncErrorThrown=!1,a.syncErrorThrowable=!1,a.isStopped=!1,arguments.length){case 0:a.destination=i.c;break;case 1:if(!n){a.destination=i.c;break}if("object"==typeof n){n instanceof t?(a.syncErrorThrowable=n.syncErrorThrowable,a.destination=n,n.add(a)):(a.syncErrorThrowable=!0,a.destination=new d(a,n));break}default:a.syncErrorThrowable=!0,a.destination=new d(a,n,r,o)}return a}return r.__extends(t,e),t.prototype[s.b]=function(){return this},t.create=function(e,n,r){var o=new t(e,n,r);return o.syncErrorThrowable=!1,o},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(a.w),d=function(e){function t(t,n,r,a){var s,c=e.call(this)||this;c._parentSubscriber=t;var l=c;return(0,o.m)(n)?s=n:n&&(s=n.next,r=n.error,a=n.complete,n!==i.c&&(l=Object.create(n),(0,o.m)(l.unsubscribe)&&c.add(l.unsubscribe.bind(l)),l.unsubscribe=c.unsubscribe.bind(c))),c._context=l,c._next=s,c._error=r,c._complete=a,c}return r.__extends(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;c.v.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,n=c.v.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):(0,l.z)(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;(0,l.z)(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};c.v.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),c.v.useDeprecatedSynchronousErrorHandling)throw e;(0,l.z)(e)}},t.prototype.__tryOrSetError=function(e,t,n){if(!c.v.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(t){return c.v.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):((0,l.z)(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(u)},66653:function(e,t,n){n.d(t,{w:function(){return s}});var r=n(45568),o=n(11886),i=n(85638),a=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),s=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}var t;return e.prototype.unsubscribe=function(){var t;if(!this.closed){var n=this,s=n._parentOrParents,l=n._ctorUnsubscribe,u=n._unsubscribe,d=n._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,s instanceof e)s.remove(this);else if(null!==s)for(var p=0;p<s.length;++p)s[p].remove(this);if((0,i.m)(u)){l&&(this._unsubscribe=void 0);try{u.call(this)}catch(e){t=e instanceof a?c(e.errors):[e]}}if((0,r.k)(d)){p=-1;for(var h=d.length;++p<h;){var f=d[p];if((0,o.K)(f))try{f.unsubscribe()}catch(e){t=t||[],e instanceof a?t=t.concat(c(e.errors)):t.push(e)}}}if(t)throw new a(t)}},e.prototype.add=function(t){var n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var r=n;(n=new e)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var o=n._parentOrParents;if(null===o)n._parentOrParents=this;else if(o instanceof e){if(o===this)return n;n._parentOrParents=[o,this]}else{if(-1!==o.indexOf(this))return n;o.push(this)}var i=this._subscriptions;return null===i?this._subscriptions=[n]:i.push(n),n},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},e.EMPTY=((t=new e).closed=!0,t),e}();function c(e){return e.reduce((function(e,t){return e.concat(t instanceof a?t.errors:t)}),[])}},49348:function(e,t,n){n.d(t,{v:function(){return o}});var r=!1,o={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){e&&(new Error).stack,r=e},get useDeprecatedSynchronousErrorHandling(){return r}}},97396:function(e,t,n){n.d(t,{Ds:function(){return c},IY:function(){return s},ft:function(){return l}});var r=n(85556),o=n(92449),i=n(77452),a=n(93123),s=function(e){function t(t){var n=e.call(this)||this;return n.parent=t,n}return r.__extends(t,e),t.prototype._next=function(e){this.parent.notifyNext(e)},t.prototype._error=function(e){this.parent.notifyError(e),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},t}(o.L),c=(o.L,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(){this.destination.complete()},t}(o.L));function l(e,t){if(!t.closed){if(e instanceof i.y)return e.subscribe(t);var n;try{n=(0,a.s)(e)(t)}catch(e){t.error(e)}return n}}o.L},90447:function(e,t,n){n.d(t,{aj:function(){return f}});var r=n(85556),o=n(97293),i=n(45568),a=n(92449),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.notifyNext=function(e,t,n,r,o){this.destination.next(t)},t.prototype.notifyError=function(e,t){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(a.L),c=function(e){function t(t,n,r){var o=e.call(this)||this;return o.parent=t,o.outerValue=n,o.outerIndex=r,o.index=0,o}return r.__extends(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(a.L),l=n(93123),u=n(77452);function d(e,t,n,r,o){if(void 0===o&&(o=new c(e,n,r)),!o.closed)return t instanceof u.y?t.subscribe(o):(0,l.s)(t)(o)}var p=n(99137),h={};function f(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=void 0,r=void 0;return(0,o.K)(e[e.length-1])&&(r=e.pop()),"function"==typeof e[e.length-1]&&(n=e.pop()),1===e.length&&(0,i.k)(e[0])&&(e=e[0]),(0,p.n)(e,r).lift(new g(n))}var g=function(){function e(e){this.resultSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new v(e,this.resultSelector))},e}(),v=function(e){function t(t,n){var r=e.call(this,t)||this;return r.resultSelector=n,r.active=0,r.values=[],r.observables=[],r}return r.__extends(t,e),t.prototype._next=function(e){this.values.push(h),this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(var n=0;n<t;n++){var r=e[n];this.add(d(this,r,void 0,n))}}},t.prototype.notifyComplete=function(e){0==(this.active-=1)&&this.destination.complete()},t.prototype.notifyNext=function(e,t,n){var r=this.values,o=r[n],i=this.toRespond?o===h?--this.toRespond:this.toRespond:0;r[n]=t,0===i&&(this.resultSelector?this._tryResultSelector(r):this.destination.next(r.slice()))},t.prototype._tryResultSelector=function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(s)},54070:function(e,t,n){n.d(t,{c:function(){return i}});var r=n(77452),o=new r.y((function(e){return e.complete()}));function i(e){return e?function(e){return new r.y((function(t){return e.schedule((function(){return t.complete()}))}))}(e):o}},99137:function(e,t,n){n.d(t,{n:function(){return a}});var r=n(77452),o=n(717),i=n(88813);function a(e,t){return t?(0,i.r)(e,t):new r.y((0,o.V)(e))}},58483:function(e,t,n){n.d(t,{b:function(){return a}});var r=n(85556),o=n(92449),i=n(31602);function a(e,t){return void 0===t&&(t=i.P),function(n){return n.lift(new s(e,t))}}var s=function(){function e(e,t){this.dueTime=e,this.scheduler=t}return e.prototype.call=function(e,t){return t.subscribe(new c(e,this.dueTime,this.scheduler))},e}(),c=function(e){function t(t,n,r){var o=e.call(this,t)||this;return o.dueTime=n,o.scheduler=r,o.debouncedSubscription=null,o.lastValue=null,o.hasValue=!1,o}return r.__extends(t,e),t.prototype._next=function(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(l,this.dueTime,this))},t.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},t.prototype.debouncedNext=function(){if(this.clearDebounce(),this.hasValue){var e=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}},t.prototype.clearDebounce=function(){var e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)},t}(o.L);function l(e){e.debouncedNext()}},16377:function(e,t,n){n.d(t,{h:function(){return i}});var r=n(85556),o=n(92449);function i(e,t){return function(n){return n.lift(new a(e,t))}}var a=function(){function e(e,t){this.predicate=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.predicate,this.thisArg))},e}(),s=function(e){function t(t,n,r){var o=e.call(this,t)||this;return o.predicate=n,o.thisArg=r,o.count=0,o}return r.__extends(t,e),t.prototype._next=function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}t&&this.destination.next(e)},t}(o.L)},56157:function(e,t,n){n.d(t,{P:function(){return v}});var r=function(){function e(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return e.prototype=Object.create(Error.prototype),e}(),o=n(16377),i=n(22290),a=n(85556),s=n(92449);function c(e){return void 0===e&&(e=null),function(t){return t.lift(new l(e))}}var l=function(){function e(e){this.defaultValue=e}return e.prototype.call=function(e,t){return t.subscribe(new u(e,this.defaultValue))},e}(),u=function(e){function t(t,n){var r=e.call(this,t)||this;return r.defaultValue=n,r.isEmpty=!0,r}return a.__extends(t,e),t.prototype._next=function(e){this.isEmpty=!1,this.destination.next(e)},t.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},t}(s.L);function d(e){return void 0===e&&(e=f),function(t){return t.lift(new p(e))}}var p=function(){function e(e){this.errorFactory=e}return e.prototype.call=function(e,t){return t.subscribe(new h(e,this.errorFactory))},e}(),h=function(e){function t(t,n){var r=e.call(this,t)||this;return r.errorFactory=n,r.hasValue=!1,r}return a.__extends(t,e),t.prototype._next=function(e){this.hasValue=!0,this.destination.next(e)},t.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var e=void 0;try{e=this.errorFactory()}catch(t){e=t}this.destination.error(e)},t}(s.L);function f(){return new r}var g=n(33494);function v(e,t){var n=arguments.length>=2;return function(a){return a.pipe(e?(0,o.h)((function(t,n){return e(t,n,a)})):g.y,(0,i.q)(1),n?c(t):d((function(){return new r})))}}},60349:function(e,t,n){n.d(t,{U:function(){return i}});var r=n(85556),o=n(92449);function i(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new a(e,t))}}var a=function(){function e(e,t){this.project=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.project,this.thisArg))},e}(),s=function(e){function t(t,n,r){var o=e.call(this,t)||this;return o.project=n,o.count=0,o.thisArg=r||o,o}return r.__extends(t,e),t.prototype._next=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(o.L)},22290:function(e,t,n){n.d(t,{q:function(){return s}});var r=n(85556),o=n(92449),i=function(){function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e}(),a=n(54070);function s(e){return function(t){return 0===e?(0,a.c)():t.lift(new c(e))}}var c=function(){function e(e){if(this.total=e,this.total<0)throw new i}return e.prototype.call=function(e,t){return t.subscribe(new l(e,this.total))},e}(),l=function(e){function t(t,n){var r=e.call(this,t)||this;return r.total=n,r.count=0,r}return r.__extends(t,e),t.prototype._next=function(e){var t=this.total,n=++this.count;n<=t&&(this.destination.next(e),n===t&&(this.destination.complete(),this.unsubscribe()))},t}(o.L)},65419:function(e,t,n){n.d(t,{p:function(){return c}});var r=n(85556),o=n(92449),i=n(31602),a=n(97396),s={leading:!0,trailing:!1};function c(e,t,n){return void 0===t&&(t=i.P),void 0===n&&(n=s),function(r){return r.lift(new l(e,t,n.leading,n.trailing))}}a.Ds;var l=function(){function e(e,t,n,r){this.duration=e,this.scheduler=t,this.leading=n,this.trailing=r}return e.prototype.call=function(e,t){return t.subscribe(new u(e,this.duration,this.scheduler,this.leading,this.trailing))},e}(),u=function(e){function t(t,n,r,o,i){var a=e.call(this,t)||this;return a.duration=n,a.scheduler=r,a.leading=o,a.trailing=i,a._hasTrailingValue=!1,a._trailingValue=null,a}return r.__extends(t,e),t.prototype._next=function(e){this.throttled?this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(d,this.duration,{subscriber:this})),this.leading?this.destination.next(e):this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0))},t.prototype._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},t.prototype.clearThrottle=function(){var e=this.throttled;e&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),e.unsubscribe(),this.remove(e),this.throttled=null)},t}(o.L);function d(e){e.subscriber.clearThrottle()}},88813:function(e,t,n){n.d(t,{r:function(){return i}});var r=n(77452),o=n(66653);function i(e,t){return new r.y((function(n){var r=new o.w,i=0;return r.add(t.schedule((function(){i!==e.length?(n.next(e[i++]),n.closed||r.add(this.schedule())):n.complete()}))),r}))}},93765:function(e,t,n){n.d(t,{o:function(){return o}});var r=n(85556),o=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return r.__extends(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n=!1,r=void 0;try{this.work(e)}catch(e){n=!0,r=!!e&&e||new Error(e)}if(n)return this.unsubscribe(),r},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(function(e){function t(t,n){return e.call(this)||this}return r.__extends(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(n(66653).w))},83081:function(e,t,n){n.d(t,{v:function(){return i}});var r=n(85556),o=function(){function e(t,n){void 0===n&&(n=e.now),this.SchedulerAction=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(n,t)},e.now=function(){return Date.now()},e}(),i=function(e){function t(n,r){void 0===r&&(r=o.now);var i=e.call(this,n,(function(){return t.delegate&&t.delegate!==i?t.delegate.now():r()}))||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return r.__extends(t,e),t.prototype.schedule=function(n,r,o){return void 0===r&&(r=0),t.delegate&&t.delegate!==this?t.delegate.schedule(n,r,o):e.prototype.schedule.call(this,n,r,o)},t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(o)},31602:function(e,t,n){n.d(t,{P:function(){return o}});var r=n(93765),o=new(n(83081).v)(r.o)},29064:function(e,t,n){function r(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}n.d(t,{hZ:function(){return o}});var o=r()},93360:function(e,t,n){n.d(t,{L:function(){return r}});var r=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}()},66236:function(e,t,n){n.d(t,{b:function(){return r}});var r=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}()},98926:function(e,t,n){n.d(t,{N:function(){return r}});var r=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}()},4e3:function(e,t,n){function r(e){setTimeout((function(){throw e}),0)}n.d(t,{z:function(){return r}})},33494:function(e,t,n){function r(e){return e}n.d(t,{y:function(){return r}})},45568:function(e,t,n){n.d(t,{k:function(){return r}});var r=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}()},16977:function(e,t,n){n.d(t,{z:function(){return r}});var r=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e}},85638:function(e,t,n){function r(e){return"function"==typeof e}n.d(t,{m:function(){return r}})},11886:function(e,t,n){function r(e){return null!==e&&"object"==typeof e}n.d(t,{K:function(){return r}})},31074:function(e,t,n){function r(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}n.d(t,{t:function(){return r}})},97293:function(e,t,n){function r(e){return e&&"function"==typeof e.schedule}n.d(t,{K:function(){return r}})},93123:function(e,t,n){n.d(t,{s:function(){return u}});var r=n(717),o=n(4e3),i=n(29064),a=n(93360),s=n(16977),c=n(31074),l=n(11886),u=function(e){if(e&&"function"==typeof e[a.L])return u=e,function(e){var t=u[a.L]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if((0,s.z)(e))return(0,r.V)(e);if((0,c.t)(e))return n=e,function(e){return n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,o.z),e};if(e&&"function"==typeof e[i.hZ])return t=e,function(e){for(var n=t[i.hZ]();;){var r=void 0;try{r=n.next()}catch(t){return e.error(t),e}if(r.done){e.complete();break}if(e.next(r.value),e.closed)break}return"function"==typeof n.return&&e.add((function(){n.return&&n.return()})),e};var t,n,u,d=(0,l.K)(e)?"an invalid object":"'"+e+"'";throw new TypeError("You provided "+d+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")}},717:function(e,t,n){n.d(t,{V:function(){return r}});var r=function(e){return function(t){for(var n=0,r=e.length;n<r&&!t.closed;n++)t.next(e[n]);t.complete()}}},50934:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NIL",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"v1",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"v3",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"v4",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"v5",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"validate",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return c.default}});var r=p(n(29566)),o=p(n(43753)),i=p(n(73750)),a=p(n(89264)),s=p(n(83053)),c=p(n(1675)),l=p(n(54642)),u=p(n(96444)),d=p(n(58959));function p(e){return e&&e.__esModule?e:{default:e}}},39639:function(e,t){function n(e){return 14+(e+64>>>9<<4)+1}function r(e,t){const n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function o(e,t,n,o,i,a){return r((s=r(r(t,e),r(o,a)))<<(c=i)|s>>>32-c,n);var s,c}function i(e,t,n,r,i,a,s){return o(t&n|~t&r,e,t,i,a,s)}function a(e,t,n,r,i,a,s){return o(t&r|n&~r,e,t,i,a,s)}function s(e,t,n,r,i,a,s){return o(t^n^r,e,t,i,a,s)}function c(e,t,n,r,i,a,s){return o(n^(t|~r),e,t,i,a,s)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=function(e){if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let n=0;n<t.length;++n)e[n]=t.charCodeAt(n)}return function(e){const t=[],n=32*e.length,r="0123456789abcdef";for(let o=0;o<n;o+=8){const n=e[o>>5]>>>o%32&255,i=parseInt(r.charAt(n>>>4&15)+r.charAt(15&n),16);t.push(i)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[n(t)-1]=t;let o=1732584193,l=-271733879,u=-1732584194,d=271733878;for(let t=0;t<e.length;t+=16){const n=o,p=l,h=u,f=d;o=i(o,l,u,d,e[t],7,-680876936),d=i(d,o,l,u,e[t+1],12,-389564586),u=i(u,d,o,l,e[t+2],17,606105819),l=i(l,u,d,o,e[t+3],22,-1044525330),o=i(o,l,u,d,e[t+4],7,-176418897),d=i(d,o,l,u,e[t+5],12,1200080426),u=i(u,d,o,l,e[t+6],17,-1473231341),l=i(l,u,d,o,e[t+7],22,-45705983),o=i(o,l,u,d,e[t+8],7,1770035416),d=i(d,o,l,u,e[t+9],12,-1958414417),u=i(u,d,o,l,e[t+10],17,-42063),l=i(l,u,d,o,e[t+11],22,-1990404162),o=i(o,l,u,d,e[t+12],7,1804603682),d=i(d,o,l,u,e[t+13],12,-40341101),u=i(u,d,o,l,e[t+14],17,-1502002290),l=i(l,u,d,o,e[t+15],22,1236535329),o=a(o,l,u,d,e[t+1],5,-165796510),d=a(d,o,l,u,e[t+6],9,-1069501632),u=a(u,d,o,l,e[t+11],14,643717713),l=a(l,u,d,o,e[t],20,-373897302),o=a(o,l,u,d,e[t+5],5,-701558691),d=a(d,o,l,u,e[t+10],9,38016083),u=a(u,d,o,l,e[t+15],14,-660478335),l=a(l,u,d,o,e[t+4],20,-405537848),o=a(o,l,u,d,e[t+9],5,568446438),d=a(d,o,l,u,e[t+14],9,-1019803690),u=a(u,d,o,l,e[t+3],14,-187363961),l=a(l,u,d,o,e[t+8],20,1163531501),o=a(o,l,u,d,e[t+13],5,-1444681467),d=a(d,o,l,u,e[t+2],9,-51403784),u=a(u,d,o,l,e[t+7],14,1735328473),l=a(l,u,d,o,e[t+12],20,-1926607734),o=s(o,l,u,d,e[t+5],4,-378558),d=s(d,o,l,u,e[t+8],11,-2022574463),u=s(u,d,o,l,e[t+11],16,1839030562),l=s(l,u,d,o,e[t+14],23,-35309556),o=s(o,l,u,d,e[t+1],4,-1530992060),d=s(d,o,l,u,e[t+4],11,1272893353),u=s(u,d,o,l,e[t+7],16,-155497632),l=s(l,u,d,o,e[t+10],23,-1094730640),o=s(o,l,u,d,e[t+13],4,681279174),d=s(d,o,l,u,e[t],11,-358537222),u=s(u,d,o,l,e[t+3],16,-722521979),l=s(l,u,d,o,e[t+6],23,76029189),o=s(o,l,u,d,e[t+9],4,-640364487),d=s(d,o,l,u,e[t+12],11,-421815835),u=s(u,d,o,l,e[t+15],16,530742520),l=s(l,u,d,o,e[t+2],23,-995338651),o=c(o,l,u,d,e[t],6,-198630844),d=c(d,o,l,u,e[t+7],10,1126891415),u=c(u,d,o,l,e[t+14],15,-1416354905),l=c(l,u,d,o,e[t+5],21,-57434055),o=c(o,l,u,d,e[t+12],6,1700485571),d=c(d,o,l,u,e[t+3],10,-1894986606),u=c(u,d,o,l,e[t+10],15,-1051523),l=c(l,u,d,o,e[t+1],21,-2054922799),o=c(o,l,u,d,e[t+8],6,1873313359),d=c(d,o,l,u,e[t+15],10,-30611744),u=c(u,d,o,l,e[t+6],15,-1560198380),l=c(l,u,d,o,e[t+13],21,1309151649),o=c(o,l,u,d,e[t+4],6,-145523070),d=c(d,o,l,u,e[t+11],10,-1120210379),u=c(u,d,o,l,e[t+2],15,718787259),l=c(l,u,d,o,e[t+9],21,-343485551),o=r(o,n),l=r(l,p),u=r(u,h),d=r(d,f)}return[o,l,u,d]}(function(e){if(0===e.length)return[];const t=8*e.length,r=new Uint32Array(n(t));for(let n=0;n<t;n+=8)r[n>>5]|=(255&e[n/8])<<n%32;return r}(e),8*e.length))};t.default=l},77311:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};t.default=n},83053:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default="00000000-0000-0000-0000-000000000000"},58959:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=(r=n(54642))&&r.__esModule?r:{default:r},i=function(e){if(!(0,o.default)(e))throw TypeError("Invalid UUID");let t;const n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n};t.default=i},64518:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},74702:function(e,t){let n;Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if(!n&&(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!n))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(r)};const r=new Uint8Array(16)},74477:function(e,t){function n(e,t,n,r){switch(e){case 0:return t&n^~t&r;case 1:case 3:return t^n^r;case 2:return t&n^t&r^n&r}}function r(e,t){return e<<t|e>>>32-t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(e){const t=[1518500249,1859775393,2400959708,3395469782],o=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=[];for(let n=0;n<t.length;++n)e.push(t.charCodeAt(n))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const i=e.length/4+2,a=Math.ceil(i/16),s=new Array(a);for(let t=0;t<a;++t){const n=new Uint32Array(16);for(let r=0;r<16;++r)n[r]=e[64*t+4*r]<<24|e[64*t+4*r+1]<<16|e[64*t+4*r+2]<<8|e[64*t+4*r+3];s[t]=n}s[a-1][14]=8*(e.length-1)/Math.pow(2,32),s[a-1][14]=Math.floor(s[a-1][14]),s[a-1][15]=8*(e.length-1)&4294967295;for(let e=0;e<a;++e){const i=new Uint32Array(80);for(let t=0;t<16;++t)i[t]=s[e][t];for(let e=16;e<80;++e)i[e]=r(i[e-3]^i[e-8]^i[e-14]^i[e-16],1);let a=o[0],c=o[1],l=o[2],u=o[3],d=o[4];for(let e=0;e<80;++e){const o=Math.floor(e/20),s=r(a,5)+n(o,c,l,u)+d+t[o]+i[e]>>>0;d=u,u=l,l=r(c,30)>>>0,c=a,a=s}o[0]=o[0]+a>>>0,o[1]=o[1]+c>>>0,o[2]=o[2]+l>>>0,o[3]=o[3]+u>>>0,o[4]=o[4]+d>>>0}return[o[0]>>24&255,o[0]>>16&255,o[0]>>8&255,255&o[0],o[1]>>24&255,o[1]>>16&255,o[1]>>8&255,255&o[1],o[2]>>24&255,o[2]>>16&255,o[2]>>8&255,255&o[2],o[3]>>24&255,o[3]>>16&255,o[3]>>8&255,255&o[3],o[4]>>24&255,o[4]>>16&255,o[4]>>8&255,255&o[4]]};t.default=o},96444:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.unsafeStringify=a;var r,o=(r=n(54642))&&r.__esModule?r:{default:r};const i=[];for(let e=0;e<256;++e)i.push((e+256).toString(16).slice(1));function a(e,t=0){return(i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]).toLowerCase()}var s=function(e,t=0){const n=a(e,t);if(!(0,o.default)(n))throw TypeError("Stringified UUID is invalid");return n};t.default=s},29566:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=(r=n(74702))&&r.__esModule?r:{default:r},i=n(96444);let a,s,c=0,l=0;var u=function(e,t,n){let r=t&&n||0;const u=t||new Array(16);let d=(e=e||{}).node||a,p=void 0!==e.clockseq?e.clockseq:s;if(null==d||null==p){const t=e.random||(e.rng||o.default)();null==d&&(d=a=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==p&&(p=s=16383&(t[6]<<8|t[7]))}let h=void 0!==e.msecs?e.msecs:Date.now(),f=void 0!==e.nsecs?e.nsecs:l+1;const g=h-c+(f-l)/1e4;if(g<0&&void 0===e.clockseq&&(p=p+1&16383),(g<0||h>c)&&void 0===e.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");c=h,l=f,s=p,h+=122192928e5;const v=(1e4*(268435455&h)+f)%4294967296;u[r++]=v>>>24&255,u[r++]=v>>>16&255,u[r++]=v>>>8&255,u[r++]=255&v;const y=h/4294967296*1e4&268435455;u[r++]=y>>>8&255,u[r++]=255&y,u[r++]=y>>>24&15|16,u[r++]=y>>>16&255,u[r++]=p>>>8|128,u[r++]=255&p;for(let e=0;e<6;++e)u[r+e]=d[e];return t||(0,i.unsafeStringify)(u)};t.default=u},43753:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(89284)),o=i(n(39639));function i(e){return e&&e.__esModule?e:{default:e}}var a=(0,r.default)("v3",48,o.default);t.default=a},89284:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=void 0,t.default=function(e,t,n){function r(e,r,a,s){var c;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof r&&(r=(0,i.default)(r)),16!==(null===(c=r)||void 0===c?void 0:c.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let l=new Uint8Array(16+e.length);if(l.set(r),l.set(e,r.length),l=n(l),l[6]=15&l[6]|t,l[8]=63&l[8]|128,a){s=s||0;for(let e=0;e<16;++e)a[s+e]=l[e];return a}return(0,o.unsafeStringify)(l)}try{r.name=e}catch(e){}return r.DNS=a,r.URL=s,r};var r,o=n(96444),i=(r=n(58959))&&r.__esModule?r:{default:r};const a="6ba7b810-9dad-11d1-80b4-00c04fd430c8";t.DNS=a;const s="6ba7b811-9dad-11d1-80b4-00c04fd430c8";t.URL=s},73750:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(77311)),o=a(n(74702)),i=n(96444);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e,t,n){if(r.default.randomUUID&&!t&&!e)return r.default.randomUUID();const a=(e=e||{}).random||(e.rng||o.default)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=a[e];return t}return(0,i.unsafeStringify)(a)};t.default=s},89264:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(89284)),o=i(n(74477));function i(e){return e&&e.__esModule?e:{default:e}}var a=(0,r.default)("v5",80,o.default);t.default=a},54642:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=(r=n(64518))&&r.__esModule?r:{default:r},i=function(e){return"string"==typeof e&&o.default.test(e)};t.default=i},1675:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=(r=n(54642))&&r.__esModule?r:{default:r},i=function(e){if(!(0,o.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)};t.default=i},23336:function(e){e.exports=$},87363:function(e){e.exports=React},61533:function(e){e.exports=ReactDOM},96553:function(){},87231:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.__esModule=!0,e.exports.default=e.exports},52041:function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},48272:function(e){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},43843:function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},71115:function(e,t,n){var r=n(52041),o=n(48272),i=n(68306),a=n(43843);e.exports=function(e){return r(e)||o(e)||i(e)||a()},e.exports.__esModule=!0,e.exports.default=e.exports},68306:function(e,t,n){var r=n(87231);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},13861:function(e,t,n){n.d(t,{i:function(){return o}});var r=n(85556),o=function(){return{events:{},emit:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var o=this.events[e]||[],i=0,a=o.length;i<a;i++)o[i].apply(o,(0,r.__spreadArray)([],(0,r.__read)(t),!1))},on:function(e,t){var n,r=this;return(null===(n=this.events[e])||void 0===n?void 0:n.push(t))||(this.events[e]=[t]),function(){var n;r.events[e]=null===(n=r.events[e])||void 0===n?void 0:n.filter((function(e){return t!==e}))}}}}},94780:function(e,t,n){function r(e){if(Array.isArray(e))return e}n.d(t,{Z:function(){return r}})},14227:function(e,t,n){function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,{Z:function(){return r}})},1039:function(e,t,n){function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}n.d(t,{Z:function(){return r}})},3382:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(10482);function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(0,r.Z)(e,t)}},74687:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(10482);function o(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,(0,r.Z)(e,t)}},89997:function(e,t,n){function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(t,{Z:function(){return r}})},26150:function(e,t,n){function r(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}n.d(t,{Z:function(){return r}})},80812:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(11466),o=n(14227);function i(e,t){if(t&&("object"===(0,r.Z)(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,o.Z)(e)}},10482:function(e,t,n){function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}n.d(t,{Z:function(){return r}})},14366:function(e,t,n){function r(e,t){return function(){return e.apply(t,arguments)}}n.d(t,{Z:function(){return je}});const{toString:o}=Object.prototype,{getPrototypeOf:i}=Object,a=(s=Object.create(null),e=>{const t=o.call(e);return s[t]||(s[t]=t.slice(8,-1).toLowerCase())});var s;const c=e=>(e=e.toLowerCase(),t=>a(t)===e),l=e=>t=>typeof t===e,{isArray:u}=Array,d=l("undefined"),p=c("ArrayBuffer"),h=l("string"),f=l("function"),g=l("number"),v=e=>null!==e&&"object"==typeof e,y=e=>{if("object"!==a(e))return!1;const t=i(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)},m=c("Date"),b=c("File"),_=c("Blob"),C=c("FileList"),S=c("URLSearchParams");function w(e,t,{allOwnKeys:n=!1}={}){if(null==e)return;let r,o;if("object"!=typeof e&&(e=[e]),u(e))for(r=0,o=e.length;r<o;r++)t.call(null,e[r],r,e);else{const o=n?Object.getOwnPropertyNames(e):Object.keys(e),i=o.length;let a;for(r=0;r<i;r++)a=o[r],t.call(null,e[a],a,e)}}function E(e,t){t=t.toLowerCase();const n=Object.keys(e);let r,o=n.length;for(;o-- >0;)if(r=n[o],t===r.toLowerCase())return r;return null}const x="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,T=e=>!d(e)&&e!==x,R=(I="undefined"!=typeof Uint8Array&&i(Uint8Array),e=>I&&e instanceof I);var I;const P=c("HTMLFormElement"),O=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),k=c("RegExp"),D=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};w(n,((n,o)=>{!1!==t(n,o,e)&&(r[o]=n)})),Object.defineProperties(e,r)},M="abcdefghijklmnopqrstuvwxyz",A="0123456789",L={DIGIT:A,ALPHA:M,ALPHA_DIGIT:M+M.toUpperCase()+A},N=c("AsyncFunction");var B={isArray:u,isArrayBuffer:p,isBuffer:function(e){return null!==e&&!d(e)&&null!==e.constructor&&!d(e.constructor)&&f(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||f(e.append)&&("formdata"===(t=a(e))||"object"===t&&f(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&p(e.buffer),t},isString:h,isNumber:g,isBoolean:e=>!0===e||!1===e,isObject:v,isPlainObject:y,isUndefined:d,isDate:m,isFile:b,isBlob:_,isRegExp:k,isFunction:f,isStream:e=>v(e)&&f(e.pipe),isURLSearchParams:S,isTypedArray:R,isFileList:C,forEach:w,merge:function e(){const{caseless:t}=T(this)&&this||{},n={},r=(r,o)=>{const i=t&&E(n,o)||o;y(n[i])&&y(r)?n[i]=e(n[i],r):y(r)?n[i]=e({},r):u(r)?n[i]=r.slice():n[i]=r};for(let e=0,t=arguments.length;e<t;e++)arguments[e]&&w(arguments[e],r);return n},extend:(e,t,n,{allOwnKeys:o}={})=>(w(t,((t,o)=>{n&&f(t)?e[o]=r(t,n):e[o]=t}),{allOwnKeys:o}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,r)=>{let o,a,s;const c={};if(t=t||{},null==e)return t;do{for(o=Object.getOwnPropertyNames(e),a=o.length;a-- >0;)s=o[a],r&&!r(s,e,t)||c[s]||(t[s]=e[s],c[s]=!0);e=!1!==n&&i(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:a,kindOfTest:c,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return-1!==r&&r===n},toArray:e=>{if(!e)return null;if(u(e))return e;let t=e.length;if(!g(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let r;for(;(r=n.next())&&!r.done;){const n=r.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const r=[];for(;null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:P,hasOwnProperty:O,hasOwnProp:O,reduceDescriptors:D,freezeMethods:e=>{D(e,((t,n)=>{if(f(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=e[n];f(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:(e,t)=>{const n={},r=e=>{e.forEach((e=>{n[e]=!0}))};return u(e)?r(e):r(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n})),noop:()=>{},toFiniteNumber:(e,t)=>(e=+e,Number.isFinite(e)?e:t),findKey:E,global:x,isContextDefined:T,ALPHABET:L,generateString:(e=16,t=L.ALPHA_DIGIT)=>{let n="";const{length:r}=t;for(;e--;)n+=t[Math.random()*r|0];return n},isSpecCompliantForm:function(e){return!!(e&&f(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),n=(e,r)=>{if(v(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[r]=e;const o=u(e)?[]:{};return w(e,((e,t)=>{const i=n(e,r+1);!d(i)&&(o[t]=i)})),t[r]=void 0,o}}return e};return n(e,0)},isAsyncFn:N,isThenable:e=>e&&(v(e)||f(e))&&f(e.then)&&f(e.catch)};function F(e,t,n,r,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),o&&(this.response=o)}B.inherits(F,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:B.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const U=F.prototype,H={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{H[e]={value:e}})),Object.defineProperties(F,H),Object.defineProperty(U,"isAxiosError",{value:!0}),F.from=(e,t,n,r,o,i)=>{const a=Object.create(U);return B.toFlatObject(e,a,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),F.call(a,e.message,t,n,r,o),a.cause=e,a.name=e.name,i&&Object.assign(a,i),a};var j=F,G=n(33634).Buffer;function V(e){return B.isPlainObject(e)||B.isArray(e)}function W(e){return B.endsWith(e,"[]")?e.slice(0,-2):e}function z(e,t,n){return e?e.concat(t).map((function(e,t){return e=W(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}const K=B.toFlatObject(B,{},null,(function(e){return/^is[A-Z]/.test(e)}));var q=function(e,t,n){if(!B.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const r=(n=B.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!B.isUndefined(t[e])}))).metaTokens,o=n.visitor||l,i=n.dots,a=n.indexes,s=(n.Blob||"undefined"!=typeof Blob&&Blob)&&B.isSpecCompliantForm(t);if(!B.isFunction(o))throw new TypeError("visitor must be a function");function c(e){if(null===e)return"";if(B.isDate(e))return e.toISOString();if(!s&&B.isBlob(e))throw new j("Blob is not supported. Use a Buffer instead.");return B.isArrayBuffer(e)||B.isTypedArray(e)?s&&"function"==typeof Blob?new Blob([e]):G.from(e):e}function l(e,n,o){let s=e;if(e&&!o&&"object"==typeof e)if(B.endsWith(n,"{}"))n=r?n:n.slice(0,-2),e=JSON.stringify(e);else if(B.isArray(e)&&function(e){return B.isArray(e)&&!e.some(V)}(e)||(B.isFileList(e)||B.endsWith(n,"[]"))&&(s=B.toArray(e)))return n=W(n),s.forEach((function(e,r){!B.isUndefined(e)&&null!==e&&t.append(!0===a?z([n],r,i):null===a?n:n+"[]",c(e))})),!1;return!!V(e)||(t.append(z(o,n,i),c(e)),!1)}const u=[],d=Object.assign(K,{defaultVisitor:l,convertValue:c,isVisitable:V});if(!B.isObject(e))throw new TypeError("data must be an object");return function e(n,r){if(!B.isUndefined(n)){if(-1!==u.indexOf(n))throw Error("Circular reference detected in "+r.join("."));u.push(n),B.forEach(n,(function(n,i){!0===(!(B.isUndefined(n)||null===n)&&o.call(t,n,B.isString(i)?i.trim():i,r,d))&&e(n,r?r.concat(i):[i])})),u.pop()}}(e),t};function Y(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function Q(e,t){this._pairs=[],e&&q(e,this,t)}const Z=Q.prototype;Z.append=function(e,t){this._pairs.push([e,t])},Z.toString=function(e){const t=e?function(t){return e.call(this,t,Y)}:Y;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};var X=Q;function J(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function $(e,t,n){if(!t)return e;const r=n&&n.encode||J,o=n&&n.serialize;let i;if(i=o?o(t,n):B.isURLSearchParams(t)?t.toString():new X(t,n).toString(r),i){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}var ee=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){B.forEach(this.handlers,(function(t){null!==t&&e(t)}))}},te={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ne={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:X,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},isStandardBrowserEnv:(()=>{let e;return("undefined"==typeof navigator||"ReactNative"!==(e=navigator.product)&&"NativeScript"!==e&&"NS"!==e)&&"undefined"!=typeof window&&"undefined"!=typeof document})(),isStandardBrowserWebWorkerEnv:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,protocols:["http","https","file","blob","url","data"]},re=function(e){function t(e,n,r,o){let i=e[o++];const a=Number.isFinite(+i),s=o>=e.length;return i=!i&&B.isArray(r)?r.length:i,s?(B.hasOwnProp(r,i)?r[i]=[r[i],n]:r[i]=n,!a):(r[i]&&B.isObject(r[i])||(r[i]=[]),t(e,n,r[i],o)&&B.isArray(r[i])&&(r[i]=function(e){const t={},n=Object.keys(e);let r;const o=n.length;let i;for(r=0;r<o;r++)i=n[r],t[i]=e[i];return t}(r[i])),!a)}if(B.isFormData(e)&&B.isFunction(e.entries)){const n={};return B.forEachEntry(e,((e,r)=>{t(function(e){return B.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),r,n,0)})),n}return null};const oe={"Content-Type":void 0},ie={transitional:te,adapter:["xhr","http"],transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,o=B.isObject(e);if(o&&B.isHTMLForm(e)&&(e=new FormData(e)),B.isFormData(e))return r&&r?JSON.stringify(re(e)):e;if(B.isArrayBuffer(e)||B.isBuffer(e)||B.isStream(e)||B.isFile(e)||B.isBlob(e))return e;if(B.isArrayBufferView(e))return e.buffer;if(B.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let i;if(o){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return q(e,new ne.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,r){return ne.isNode&&B.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((i=B.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return q(i?{"files[]":e}:e,t&&new t,this.formSerializer)}}return o||r?(t.setContentType("application/json",!1),function(e,t,n){if(B.isString(e))try{return(t||JSON.parse)(e),B.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||ie.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(e&&B.isString(e)&&(n&&!this.responseType||r)){const n=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(e){if(n){if("SyntaxError"===e.name)throw j.from(e,j.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ne.classes.FormData,Blob:ne.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};B.forEach(["delete","get","head"],(function(e){ie.headers[e]={}})),B.forEach(["post","put","patch"],(function(e){ie.headers[e]=B.merge(oe)}));var ae=ie;const se=B.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ce=Symbol("internals");function le(e){return e&&String(e).trim().toLowerCase()}function ue(e){return!1===e||null==e?e:B.isArray(e)?e.map(ue):String(e)}function de(e,t,n,r,o){return B.isFunction(r)?r.call(this,t,n):(o&&(t=n),B.isString(t)?B.isString(r)?-1!==t.indexOf(r):B.isRegExp(r)?r.test(t):void 0:void 0)}class pe{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function o(e,t,n){const o=le(t);if(!o)throw new Error("header name must be a non-empty string");const i=B.findKey(r,o);(!i||void 0===r[i]||!0===n||void 0===n&&!1!==r[i])&&(r[i||t]=ue(e))}const i=(e,t)=>B.forEach(e,((e,n)=>o(e,n,t)));return B.isPlainObject(e)||e instanceof this.constructor?i(e,t):B.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim())?i((e=>{const t={};let n,r,o;return e&&e.split("\n").forEach((function(e){o=e.indexOf(":"),n=e.substring(0,o).trim().toLowerCase(),r=e.substring(o+1).trim(),!n||t[n]&&se[n]||("set-cookie"===n?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)})),t})(e),t):null!=e&&o(t,e,n),this}get(e,t){if(e=le(e)){const n=B.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}(e);if(B.isFunction(t))return t.call(this,e,n);if(B.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=le(e)){const n=B.findKey(this,e);return!(!n||void 0===this[n]||t&&!de(0,this[n],n,t))}return!1}delete(e,t){const n=this;let r=!1;function o(e){if(e=le(e)){const o=B.findKey(n,e);!o||t&&!de(0,n[o],o,t)||(delete n[o],r=!0)}}return B.isArray(e)?e.forEach(o):o(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const o=t[n];e&&!de(0,this[o],o,e,!0)||(delete this[o],r=!0)}return r}normalize(e){const t=this,n={};return B.forEach(this,((r,o)=>{const i=B.findKey(n,o);if(i)return t[i]=ue(r),void delete t[o];const a=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,n)=>t.toUpperCase()+n))}(o):String(o).trim();a!==o&&delete t[o],t[a]=ue(r),n[a]=!0})),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return B.forEach(this,((n,r)=>{null!=n&&!1!==n&&(t[r]=e&&B.isArray(n)?n.join(", "):n)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([e,t])=>e+": "+t)).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach((e=>n.set(e))),n}static accessor(e){const t=(this[ce]=this[ce]={accessors:{}}).accessors,n=this.prototype;function r(e){const r=le(e);t[r]||(function(e,t){const n=B.toCamelCase(" "+t);["get","set","has"].forEach((r=>{Object.defineProperty(e,r+n,{value:function(e,n,o){return this[r].call(this,t,e,n,o)},configurable:!0})}))}(n,e),t[r]=!0)}return B.isArray(e)?e.forEach(r):r(e),this}}pe.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),B.freezeMethods(pe.prototype),B.freezeMethods(pe);var he=pe;function fe(e,t){const n=this||ae,r=t||n,o=he.from(r.headers);let i=r.data;return B.forEach(e,(function(e){i=e.call(n,i,o.normalize(),t?t.status:void 0)})),o.normalize(),i}function ge(e){return!(!e||!e.__CANCEL__)}function ve(e,t,n){j.call(this,null==e?"canceled":e,j.ERR_CANCELED,t,n),this.name="CanceledError"}B.inherits(ve,j,{__CANCEL__:!0});var ye=ve,me=ne.isStandardBrowserEnv?{write:function(e,t,n,r,o,i){const a=[];a.push(e+"="+encodeURIComponent(t)),B.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),B.isString(r)&&a.push("path="+r),B.isString(o)&&a.push("domain="+o),!0===i&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}};function be(e,t){return e&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)?function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}var _e=ne.isStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");let n;function r(n){let r=n;return e&&(t.setAttribute("href",r),r=t.href),t.setAttribute("href",r),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:"/"===t.pathname.charAt(0)?t.pathname:"/"+t.pathname}}return n=r(window.location.href),function(e){const t=B.isString(e)?r(e):e;return t.protocol===n.protocol&&t.host===n.host}}():function(){return!0},Ce=function(e,t){e=e||10;const n=new Array(e),r=new Array(e);let o,i=0,a=0;return t=void 0!==t?t:1e3,function(s){const c=Date.now(),l=r[a];o||(o=c),n[i]=s,r[i]=c;let u=a,d=0;for(;u!==i;)d+=n[u++],u%=e;if(i=(i+1)%e,i===a&&(a=(a+1)%e),c-o<t)return;const p=l&&c-l;return p?Math.round(1e3*d/p):void 0}};function Se(e,t){let n=0;const r=Ce(50,250);return o=>{const i=o.loaded,a=o.lengthComputable?o.total:void 0,s=i-n,c=r(s);n=i;const l={loaded:i,total:a,progress:a?i/a:void 0,bytes:s,rate:c||void 0,estimated:c&&a&&i<=a?(a-i)/c:void 0,event:o};l[t?"download":"upload"]=!0,e(l)}}const we={http:null,xhr:"undefined"!=typeof XMLHttpRequest&&function(e){return new Promise((function(t,n){let r=e.data;const o=he.from(e.headers).normalize(),i=e.responseType;let a;function s(){e.cancelToken&&e.cancelToken.unsubscribe(a),e.signal&&e.signal.removeEventListener("abort",a)}B.isFormData(r)&&(ne.isStandardBrowserEnv||ne.isStandardBrowserWebWorkerEnv?o.setContentType(!1):o.setContentType("multipart/form-data;",!1));let c=new XMLHttpRequest;if(e.auth){const t=e.auth.username||"",n=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";o.set("Authorization","Basic "+btoa(t+":"+n))}const l=be(e.baseURL,e.url);function u(){if(!c)return;const r=he.from("getAllResponseHeaders"in c&&c.getAllResponseHeaders());!function(e,t,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new j("Request failed with status code "+n.status,[j.ERR_BAD_REQUEST,j.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}((function(e){t(e),s()}),(function(e){n(e),s()}),{data:i&&"text"!==i&&"json"!==i?c.response:c.responseText,status:c.status,statusText:c.statusText,headers:r,config:e,request:c}),c=null}if(c.open(e.method.toUpperCase(),$(l,e.params,e.paramsSerializer),!0),c.timeout=e.timeout,"onloadend"in c?c.onloadend=u:c.onreadystatechange=function(){c&&4===c.readyState&&(0!==c.status||c.responseURL&&0===c.responseURL.indexOf("file:"))&&setTimeout(u)},c.onabort=function(){c&&(n(new j("Request aborted",j.ECONNABORTED,e,c)),c=null)},c.onerror=function(){n(new j("Network Error",j.ERR_NETWORK,e,c)),c=null},c.ontimeout=function(){let t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const r=e.transitional||te;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(new j(t,r.clarifyTimeoutError?j.ETIMEDOUT:j.ECONNABORTED,e,c)),c=null},ne.isStandardBrowserEnv){const t=(e.withCredentials||_e(l))&&e.xsrfCookieName&&me.read(e.xsrfCookieName);t&&o.set(e.xsrfHeaderName,t)}void 0===r&&o.setContentType(null),"setRequestHeader"in c&&B.forEach(o.toJSON(),(function(e,t){c.setRequestHeader(t,e)})),B.isUndefined(e.withCredentials)||(c.withCredentials=!!e.withCredentials),i&&"json"!==i&&(c.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&c.addEventListener("progress",Se(e.onDownloadProgress,!0)),"function"==typeof e.onUploadProgress&&c.upload&&c.upload.addEventListener("progress",Se(e.onUploadProgress)),(e.cancelToken||e.signal)&&(a=t=>{c&&(n(!t||t.type?new ye(null,e,c):t),c.abort(),c=null)},e.cancelToken&&e.cancelToken.subscribe(a),e.signal&&(e.signal.aborted?a():e.signal.addEventListener("abort",a)));const d=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(l);d&&-1===ne.protocols.indexOf(d)?n(new j("Unsupported protocol "+d+":",j.ERR_BAD_REQUEST,e)):c.send(r||null)}))}};B.forEach(we,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(e){}Object.defineProperty(e,"adapterName",{value:t})}}));var Ee=e=>{e=B.isArray(e)?e:[e];const{length:t}=e;let n,r;for(let o=0;o<t&&(n=e[o],!(r=B.isString(n)?we[n.toLowerCase()]:n));o++);if(!r){if(!1===r)throw new j(`Adapter ${n} is not supported by the environment`,"ERR_NOT_SUPPORT");throw new Error(B.hasOwnProp(we,n)?`Adapter '${n}' is not available in the build`:`Unknown adapter '${n}'`)}if(!B.isFunction(r))throw new TypeError("adapter is not a function");return r};function xe(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ye(null,e)}function Te(e){return xe(e),e.headers=he.from(e.headers),e.data=fe.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Ee(e.adapter||ae.adapter)(e).then((function(t){return xe(e),t.data=fe.call(e,e.transformResponse,t),t.headers=he.from(t.headers),t}),(function(t){return ge(t)||(xe(e),t&&t.response&&(t.response.data=fe.call(e,e.transformResponse,t.response),t.response.headers=he.from(t.response.headers))),Promise.reject(t)}))}const Re=e=>e instanceof he?e.toJSON():e;function Ie(e,t){t=t||{};const n={};function r(e,t,n){return B.isPlainObject(e)&&B.isPlainObject(t)?B.merge.call({caseless:n},e,t):B.isPlainObject(t)?B.merge({},t):B.isArray(t)?t.slice():t}function o(e,t,n){return B.isUndefined(t)?B.isUndefined(e)?void 0:r(void 0,e,n):r(e,t,n)}function i(e,t){if(!B.isUndefined(t))return r(void 0,t)}function a(e,t){return B.isUndefined(t)?B.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function s(n,o,i){return i in t?r(n,o):i in e?r(void 0,n):void 0}const c={url:i,method:i,data:i,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:s,headers:(e,t)=>o(Re(e),Re(t),!0)};return B.forEach(Object.keys(Object.assign({},e,t)),(function(r){const i=c[r]||o,a=i(e[r],t[r],r);B.isUndefined(a)&&i!==s||(n[r]=a)})),n}const Pe="1.4.0",Oe={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{Oe[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));const ke={};Oe.transitional=function(e,t,n){function r(e,t){return"[Axios v1.4.0] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,o,i)=>{if(!1===e)throw new j(r(o," has been removed"+(t?" in "+t:"")),j.ERR_DEPRECATED);return t&&!ke[o]&&(ke[o]=!0,console.warn(r(o," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,o,i)}};var De={assertOptions:function(e,t,n){if("object"!=typeof e)throw new j("options must be an object",j.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let o=r.length;for(;o-- >0;){const i=r[o],a=t[i];if(a){const t=e[i],n=void 0===t||a(t,i,e);if(!0!==n)throw new j("option "+i+" must be "+n,j.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new j("Unknown option "+i,j.ERR_BAD_OPTION)}},validators:Oe};const Me=De.validators;class Ae{constructor(e){this.defaults=e,this.interceptors={request:new ee,response:new ee}}request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=Ie(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:o}=t;let i;void 0!==n&&De.assertOptions(n,{silentJSONParsing:Me.transitional(Me.boolean),forcedJSONParsing:Me.transitional(Me.boolean),clarifyTimeoutError:Me.transitional(Me.boolean)},!1),null!=r&&(B.isFunction(r)?t.paramsSerializer={serialize:r}:De.assertOptions(r,{encode:Me.function,serialize:Me.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase(),i=o&&B.merge(o.common,o[t.method]),i&&B.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete o[e]})),t.headers=he.concat(i,o);const a=[];let s=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(s=s&&e.synchronous,a.unshift(e.fulfilled,e.rejected))}));const c=[];let l;this.interceptors.response.forEach((function(e){c.push(e.fulfilled,e.rejected)}));let u,d=0;if(!s){const e=[Te.bind(this),void 0];for(e.unshift.apply(e,a),e.push.apply(e,c),u=e.length,l=Promise.resolve(t);d<u;)l=l.then(e[d++],e[d++]);return l}u=a.length;let p=t;for(d=0;d<u;){const e=a[d++],t=a[d++];try{p=e(p)}catch(e){t.call(this,e);break}}try{l=Te.call(this,p)}catch(e){return Promise.reject(e)}for(d=0,u=c.length;d<u;)l=l.then(c[d++],c[d++]);return l}getUri(e){return $(be((e=Ie(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}}B.forEach(["delete","get","head","options"],(function(e){Ae.prototype[e]=function(t,n){return this.request(Ie(n||{},{method:e,url:t,data:(n||{}).data}))}})),B.forEach(["post","put","patch"],(function(e){function t(t){return function(n,r,o){return this.request(Ie(o||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}Ae.prototype[e]=t(),Ae.prototype[e+"Form"]=t(!0)}));var Le=Ae;class Ne{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const n=this;this.promise.then((e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null})),this.promise.then=e=>{let t;const r=new Promise((e=>{n.subscribe(e),t=e})).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e((function(e,r,o){n.reason||(n.reason=new ye(e,r,o),t(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}static source(){let e;return{token:new Ne((function(t){e=t})),cancel:e}}}var Be=Ne;const Fe={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Fe).forEach((([e,t])=>{Fe[t]=e}));var Ue=Fe;const He=function e(t){const n=new Le(t),o=r(Le.prototype.request,n);return B.extend(o,Le.prototype,n,{allOwnKeys:!0}),B.extend(o,n,null,{allOwnKeys:!0}),o.create=function(n){return e(Ie(t,n))},o}(ae);He.Axios=Le,He.CanceledError=ye,He.CancelToken=Be,He.isCancel=ge,He.VERSION=Pe,He.toFormData=q,He.AxiosError=j,He.Cancel=He.CanceledError,He.all=function(e){return Promise.all(e)},He.spread=function(e){return function(t){return e.apply(null,t)}},He.isAxiosError=function(e){return B.isObject(e)&&!0===e.isAxiosError},He.mergeConfig=Ie,He.AxiosHeaders=he,He.formToJSON=e=>re(B.isHTMLForm(e)?new FormData(e):e),He.HttpStatusCode=Ue,He.default=He;var je=He},915:function(e,t,n){n.d(t,{ZP:function(){return _e}});var r=n(11466),o=n(59834),i=n(90476),a=n(14227),s=n(3382),c=n(80812),l=n(1039),u=n(87675),d=n(94780),p=n(33086),h=n(24227),f=n(89997);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y={type:"logger",log:function(e){this.output("log",e)},warn:function(e){this.output("warn",e)},error:function(e){this.output("error",e)},output:function(e,t){console&&console[e]&&console[e].apply(console,t)}},m=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,o.Z)(this,e),this.init(t,n)}return(0,i.Z)(e,[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||y,this.options=t,this.debug=t.debug}},{key:"setDebug",value:function(e){this.debug=e}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"log","",!0)}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","",!0)}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"error","")}},{key:"deprecate",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(e,t,n,r){return r&&!this.debug?null:("string"==typeof e[0]&&(e[0]="".concat(n).concat(this.prefix," ").concat(e[0])),this.logger[t](e))}},{key:"create",value:function(t){return new e(this.logger,v(v({},{prefix:"".concat(this.prefix,":").concat(t,":")}),this.options))}},{key:"clone",value:function(t){return(t=t||this.options).prefix=t.prefix||this.prefix,new e(this.logger,t)}}]),e}(),b=new m,_=function(){function e(){(0,o.Z)(this,e),this.observers={}}return(0,i.Z)(e,[{key:"on",value:function(e,t){var n=this;return e.split(" ").forEach((function(e){n.observers[e]=n.observers[e]||[],n.observers[e].push(t)})),this}},{key:"off",value:function(e,t){this.observers[e]&&(t?this.observers[e]=this.observers[e].filter((function(e){return e!==t})):delete this.observers[e])}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(this.observers[e]){var o=[].concat(this.observers[e]);o.forEach((function(e){e.apply(void 0,n)}))}if(this.observers["*"]){var i=[].concat(this.observers["*"]);i.forEach((function(t){t.apply(t,[e].concat(n))}))}}}]),e}();function C(){var e,t,n=new Promise((function(n,r){e=n,t=r}));return n.resolve=e,n.reject=t,n}function S(e){return null==e?"":""+e}function w(e,t,n){e.forEach((function(e){t[e]&&(n[e]=t[e])}))}function E(e,t,n){function r(e){return e&&e.indexOf("###")>-1?e.replace(/###/g,"."):e}function o(){return!e||"string"==typeof e}for(var i="string"!=typeof t?[].concat(t):t.split(".");i.length>1;){if(o())return{};var a=r(i.shift());!e[a]&&n&&(e[a]=new n),e=Object.prototype.hasOwnProperty.call(e,a)?e[a]:{}}return o()?{}:{obj:e,k:r(i.shift())}}function x(e,t,n){var r=E(e,t,Object);r.obj[r.k]=n}function T(e,t){var n=E(e,t),r=n.obj,o=n.k;if(r)return r[o]}function R(e,t,n){var r=T(e,n);return void 0!==r?r:T(t,n)}function I(e,t,n){for(var r in t)"__proto__"!==r&&"constructor"!==r&&(r in e?"string"==typeof e[r]||e[r]instanceof String||"string"==typeof t[r]||t[r]instanceof String?n&&(e[r]=t[r]):I(e[r],t[r],n):e[r]=t[r]);return e}function P(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var O={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function k(e){return"string"==typeof e?e.replace(/[&<>"'\/]/g,(function(e){return O[e]})):e}var D="undefined"!=typeof window&&window.navigator&&void 0===window.navigator.userAgentData&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1,M=[" ",",","?","!",";"];function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,l.Z)(e);if(t){var o=(0,l.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,c.Z)(this,n)}}function B(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(e){if(e[t])return e[t];for(var r=t.split(n),o=e,i=0;i<r.length;++i){if(!o)return;if("string"==typeof o[r[i]]&&i+1<r.length)return;if(void 0===o[r[i]]){for(var a=2,s=r.slice(i,i+a).join(n),c=o[s];void 0===c&&r.length>i+a;)a++,c=o[s=r.slice(i,i+a).join(n)];if(void 0===c)return;if(null===c)return null;if(t.endsWith(s)){if("string"==typeof c)return c;if(s&&"string"==typeof c[s])return c[s]}var l=r.slice(i+a).join(n);return l?B(c,l,n):void 0}o=o[r[i]]}return o}}var F=function(e){(0,s.Z)(n,e);var t=N(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};return(0,o.Z)(this,n),r=t.call(this),D&&_.call((0,a.Z)(r)),r.data=e||{},r.options=i,void 0===r.options.keySeparator&&(r.options.keySeparator="."),void 0===r.options.ignoreJSONStructure&&(r.options.ignoreJSONStructure=!0),r}return(0,i.Z)(n,[{key:"addNamespaces",value:function(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}},{key:"removeNamespaces",value:function(e){var t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}},{key:"getResource",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=void 0!==r.keySeparator?r.keySeparator:this.options.keySeparator,i=void 0!==r.ignoreJSONStructure?r.ignoreJSONStructure:this.options.ignoreJSONStructure,a=[e,t];n&&"string"!=typeof n&&(a=a.concat(n)),n&&"string"==typeof n&&(a=a.concat(o?n.split(o):n)),e.indexOf(".")>-1&&(a=e.split("."));var s=T(this.data,a);return s||!i||"string"!=typeof n?s:B(this.data&&this.data[e]&&this.data[e][t],n,o)}},{key:"addResource",value:function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1},i=this.options.keySeparator;void 0===i&&(i=".");var a=[e,t];n&&(a=a.concat(i?n.split(i):n)),e.indexOf(".")>-1&&(r=t,t=(a=e.split("."))[1]),this.addNamespaces(t),x(this.data,a,r),o.silent||this.emit("added",e,t,n,r)}},{key:"addResources",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(var o in n)"string"!=typeof n[o]&&"[object Array]"!==Object.prototype.toString.apply(n[o])||this.addResource(e,t,o,n[o],{silent:!0});r.silent||this.emit("added",e,t,n)}},{key:"addResourceBundle",value:function(e,t,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1},a=[e,t];e.indexOf(".")>-1&&(r=n,n=t,t=(a=e.split("."))[1]),this.addNamespaces(t);var s=T(this.data,a)||{};r?I(s,n,o):s=L(L({},s),n),x(this.data,a,s),i.silent||this.emit("added",e,t,n)}},{key:"removeResourceBundle",value:function(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}},{key:"hasResourceBundle",value:function(e,t){return void 0!==this.getResource(e,t)}},{key:"getResourceBundle",value:function(e,t){return t||(t=this.options.defaultNS),"v1"===this.options.compatibilityAPI?L(L({},{}),this.getResource(e,t)):this.getResource(e,t)}},{key:"getDataByLanguage",value:function(e){return this.data[e]}},{key:"hasLanguageSomeTranslations",value:function(e){var t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find((function(e){return t[e]&&Object.keys(t[e]).length>0}))}},{key:"toJSON",value:function(){return this.data}}]),n}(_),U={processors:{},addPostProcessor:function(e){this.processors[e.name]=e},handle:function(e,t,n,r,o){var i=this;return e.forEach((function(e){i.processors[e]&&(t=i.processors[e].process(t,n,r,o))})),t}};function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function G(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,l.Z)(e);if(t){var o=(0,l.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,c.Z)(this,n)}}var V={},W=function(e){(0,s.Z)(n,e);var t=G(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,o.Z)(this,n),r=t.call(this),D&&_.call((0,a.Z)(r)),w(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,(0,a.Z)(r)),r.options=i,void 0===r.options.keySeparator&&(r.options.keySeparator="."),r.logger=b.create("translator"),r}return(0,i.Z)(n,[{key:"changeLanguage",value:function(e){e&&(this.language=e)}},{key:"exists",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(null==e)return!1;var n=this.resolve(e,t);return n&&void 0!==n.res}},{key:"extractFromKey",value:function(e,t){var n=void 0!==t.nsSeparator?t.nsSeparator:this.options.nsSeparator;void 0===n&&(n=":");var r=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,o=t.ns||this.options.defaultNS||[],i=n&&e.indexOf(n)>-1,a=!(this.options.userDefinedKeySeparator||t.keySeparator||this.options.userDefinedNsSeparator||t.nsSeparator||function(e,t,n){t=t||"",n=n||"";var r=M.filter((function(e){return t.indexOf(e)<0&&n.indexOf(e)<0}));if(0===r.length)return!0;var o=new RegExp("(".concat(r.map((function(e){return"?"===e?"\\?":e})).join("|"),")")),i=!o.test(e);if(!i){var a=e.indexOf(n);a>0&&!o.test(e.substring(0,a))&&(i=!0)}return i}(e,n,r));if(i&&!a){var s=e.match(this.interpolator.nestingRegexp);if(s&&s.length>0)return{key:e,namespaces:o};var c=e.split(n);(n!==r||n===r&&this.options.ns.indexOf(c[0])>-1)&&(o=c.shift()),e=c.join(r)}return"string"==typeof o&&(o=[o]),{key:e,namespaces:o}}},{key:"translate",value:function(e,t,o){var i=this;if("object"!==(0,r.Z)(t)&&this.options.overloadTranslationOptionHandler&&(t=this.options.overloadTranslationOptionHandler(arguments)),t||(t={}),null==e)return"";Array.isArray(e)||(e=[String(e)]);var a=void 0!==t.returnDetails?t.returnDetails:this.options.returnDetails,s=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,c=this.extractFromKey(e[e.length-1],t),l=c.key,u=c.namespaces,d=u[u.length-1],p=t.lng||this.language,h=t.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(p&&"cimode"===p.toLowerCase()){if(h){var f=t.nsSeparator||this.options.nsSeparator;return a?(g.res="".concat(d).concat(f).concat(l),g):"".concat(d).concat(f).concat(l)}return a?(g.res=l,g):l}var g=this.resolve(e,t),v=g&&g.res,y=g&&g.usedKey||l,m=g&&g.exactUsedKey||l,b=Object.prototype.toString.apply(v),_=["[object Number]","[object Function]","[object RegExp]"],C=void 0!==t.joinArrays?t.joinArrays:this.options.joinArrays,S=!this.i18nFormat||this.i18nFormat.handleAsObject,w="string"!=typeof v&&"boolean"!=typeof v&&"number"!=typeof v;if(S&&v&&w&&_.indexOf(b)<0&&("string"!=typeof C||"[object Array]"!==b)){if(!t.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");var E=this.options.returnedObjectHandler?this.options.returnedObjectHandler(y,v,j(j({},t),{},{ns:u})):"key '".concat(l," (").concat(this.language,")' returned an object instead of string.");return a?(g.res=E,g):E}if(s){var x="[object Array]"===b,T=x?[]:{},R=x?m:y;for(var I in v)if(Object.prototype.hasOwnProperty.call(v,I)){var P="".concat(R).concat(s).concat(I);T[I]=this.translate(P,j(j({},t),{joinArrays:!1,ns:u})),T[I]===P&&(T[I]=v[I])}v=T}}else if(S&&"string"==typeof C&&"[object Array]"===b)(v=v.join(C))&&(v=this.extendTranslation(v,e,t,o));else{var O=!1,k=!1,D=void 0!==t.count&&"string"!=typeof t.count,M=n.hasDefaultValue(t),A=D?this.pluralResolver.getSuffix(p,t.count,t):"",L=t["defaultValue".concat(A)]||t.defaultValue;!this.isValidLookup(v)&&M&&(O=!0,v=L),this.isValidLookup(v)||(k=!0,v=l);var N=t.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey,B=N&&k?void 0:v,F=M&&L!==v&&this.options.updateMissing;if(k||O||F){if(this.logger.log(F?"updateKey":"missingKey",p,d,l,F?L:v),s){var U=this.resolve(l,j(j({},t),{},{keySeparator:!1}));U&&U.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}var H=[],G=this.languageUtils.getFallbackCodes(this.options.fallbackLng,t.lng||this.language);if("fallback"===this.options.saveMissingTo&&G&&G[0])for(var V=0;V<G.length;V++)H.push(G[V]);else"all"===this.options.saveMissingTo?H=this.languageUtils.toResolveHierarchy(t.lng||this.language):H.push(t.lng||this.language);var W=function(e,n,r){var o=M&&r!==v?r:B;i.options.missingKeyHandler?i.options.missingKeyHandler(e,d,n,o,F,t):i.backendConnector&&i.backendConnector.saveMissing&&i.backendConnector.saveMissing(e,d,n,o,F,t),i.emit("missingKey",e,d,n,v)};this.options.saveMissing&&(this.options.saveMissingPlurals&&D?H.forEach((function(e){i.pluralResolver.getSuffixes(e,t).forEach((function(n){W([e],l+n,t["defaultValue".concat(n)]||L)}))})):W(H,l,L))}v=this.extendTranslation(v,e,t,g,o),k&&v===l&&this.options.appendNamespaceToMissingKey&&(v="".concat(d,":").concat(l)),(k||O)&&this.options.parseMissingKeyHandler&&(v="v1"!==this.options.compatibilityAPI?this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?"".concat(d,":").concat(l):l,O?v:void 0):this.options.parseMissingKeyHandler(v))}return a?(g.res=v,g):v}},{key:"extendTranslation",value:function(e,t,n,r,o){var i=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,j(j({},this.options.interpolation.defaultVariables),n),r.usedLng,r.usedNS,r.usedKey,{resolved:r});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init(j(j({},n),{interpolation:j(j({},this.options.interpolation),n.interpolation)}));var a,s="string"==typeof e&&(n&&n.interpolation&&void 0!==n.interpolation.skipOnVariables?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);if(s){var c=e.match(this.interpolator.nestingRegexp);a=c&&c.length}var l=n.replace&&"string"!=typeof n.replace?n.replace:n;if(this.options.interpolation.defaultVariables&&(l=j(j({},this.options.interpolation.defaultVariables),l)),e=this.interpolator.interpolate(e,l,n.lng||this.language,n),s){var u=e.match(this.interpolator.nestingRegexp);a<(u&&u.length)&&(n.nest=!1)}!1!==n.nest&&(e=this.interpolator.nest(e,(function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return o&&o[0]===r[0]&&!n.context?(i.logger.warn("It seems you are nesting recursively key: ".concat(r[0]," in key: ").concat(t[0])),null):i.translate.apply(i,r.concat([t]))}),n)),n.interpolation&&this.interpolator.reset()}var d=n.postProcess||this.options.postProcess,p="string"==typeof d?[d]:d;return null!=e&&p&&p.length&&!1!==n.applyPostProcessor&&(e=U.handle(p,e,t,this.options&&this.options.postProcessPassResolved?j({i18nResolved:r},n):n,this)),e}},{key:"resolve",value:function(e){var t,n,r,o,i,a=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof e&&(e=[e]),e.forEach((function(e){if(!a.isValidLookup(t)){var c=a.extractFromKey(e,s),l=c.key;n=l;var u=c.namespaces;a.options.fallbackNS&&(u=u.concat(a.options.fallbackNS));var d=void 0!==s.count&&"string"!=typeof s.count,p=d&&!s.ordinal&&0===s.count&&a.pluralResolver.shouldUseIntlApi(),h=void 0!==s.context&&("string"==typeof s.context||"number"==typeof s.context)&&""!==s.context,f=s.lngs?s.lngs:a.languageUtils.toResolveHierarchy(s.lng||a.language,s.fallbackLng);u.forEach((function(e){a.isValidLookup(t)||(i=e,!V["".concat(f[0],"-").concat(e)]&&a.utils&&a.utils.hasLoadedNamespace&&!a.utils.hasLoadedNamespace(i)&&(V["".concat(f[0],"-").concat(e)]=!0,a.logger.warn('key "'.concat(n,'" for languages "').concat(f.join(", "),'" won\'t get resolved as namespace "').concat(i,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),f.forEach((function(n){if(!a.isValidLookup(t)){o=n;var i,c=[l];if(a.i18nFormat&&a.i18nFormat.addLookupKeys)a.i18nFormat.addLookupKeys(c,l,n,e,s);else{var u;d&&(u=a.pluralResolver.getSuffix(n,s.count,s));var f="".concat(a.options.pluralSeparator,"zero");if(d&&(c.push(l+u),p&&c.push(l+f)),h){var g="".concat(l).concat(a.options.contextSeparator).concat(s.context);c.push(g),d&&(c.push(g+u),p&&c.push(g+f))}}for(;i=c.pop();)a.isValidLookup(t)||(r=i,t=a.getResource(n,e,i,s))}})))}))}})),{res:t,usedKey:n,exactUsedKey:r,usedLng:o,usedNS:i}}},{key:"isValidLookup",value:function(e){return!(void 0===e||!this.options.returnNull&&null===e||!this.options.returnEmptyString&&""===e)}},{key:"getResource",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,t,n,r):this.resourceStore.getResource(e,t,n,r)}}],[{key:"hasDefaultValue",value:function(e){var t="defaultValue";for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t===n.substring(0,t.length)&&void 0!==e[n])return!0;return!1}}]),n}(_);function z(e){return e.charAt(0).toUpperCase()+e.slice(1)}var K=function(){function e(t){(0,o.Z)(this,e),this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=b.create("languageUtils")}return(0,i.Z)(e,[{key:"getScriptPartFromCode",value:function(e){if(!e||e.indexOf("-")<0)return null;var t=e.split("-");return 2===t.length?null:(t.pop(),"x"===t[t.length-1].toLowerCase()?null:this.formatLanguageCode(t.join("-")))}},{key:"getLanguagePartFromCode",value:function(e){if(!e||e.indexOf("-")<0)return e;var t=e.split("-");return this.formatLanguageCode(t[0])}},{key:"formatLanguageCode",value:function(e){if("string"==typeof e&&e.indexOf("-")>-1){var t=["hans","hant","latn","cyrl","cans","mong","arab"],n=e.split("-");return this.options.lowerCaseLng?n=n.map((function(e){return e.toLowerCase()})):2===n.length?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),t.indexOf(n[1].toLowerCase())>-1&&(n[1]=z(n[1].toLowerCase()))):3===n.length&&(n[0]=n[0].toLowerCase(),2===n[1].length&&(n[1]=n[1].toUpperCase()),"sgn"!==n[0]&&2===n[2].length&&(n[2]=n[2].toUpperCase()),t.indexOf(n[1].toLowerCase())>-1&&(n[1]=z(n[1].toLowerCase())),t.indexOf(n[2].toLowerCase())>-1&&(n[2]=z(n[2].toLowerCase()))),n.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}},{key:"isSupportedCode",value:function(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}},{key:"getBestMatchFromCodes",value:function(e){var t,n=this;return e?(e.forEach((function(e){if(!t){var r=n.formatLanguageCode(e);n.options.supportedLngs&&!n.isSupportedCode(r)||(t=r)}})),!t&&this.options.supportedLngs&&e.forEach((function(e){if(!t){var r=n.getLanguagePartFromCode(e);if(n.isSupportedCode(r))return t=r;t=n.options.supportedLngs.find((function(e){if(0===e.indexOf(r))return e}))}})),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t):null}},{key:"getFallbackCodes",value:function(e,t){if(!e)return[];if("function"==typeof e&&(e=e(t)),"string"==typeof e&&(e=[e]),"[object Array]"===Object.prototype.toString.apply(e))return e;if(!t)return e.default||[];var n=e[t];return n||(n=e[this.getScriptPartFromCode(t)]),n||(n=e[this.formatLanguageCode(t)]),n||(n=e[this.getLanguagePartFromCode(t)]),n||(n=e.default),n||[]}},{key:"toResolveHierarchy",value:function(e,t){var n=this,r=this.getFallbackCodes(t||this.options.fallbackLng||[],e),o=[],i=function(e){e&&(n.isSupportedCode(e)?o.push(e):n.logger.warn("rejecting language code not found in supportedLngs: ".concat(e)))};return"string"==typeof e&&e.indexOf("-")>-1?("languageOnly"!==this.options.load&&i(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&i(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&i(this.getLanguagePartFromCode(e))):"string"==typeof e&&i(this.formatLanguageCode(e)),r.forEach((function(e){o.indexOf(e)<0&&i(n.formatLanguageCode(e))})),o}}]),e}(),q=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],Y={1:function(e){return Number(e>1)},2:function(e){return Number(1!=e)},3:function(e){return 0},4:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},5:function(e){return Number(0==e?0:1==e?1:2==e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5)},6:function(e){return Number(1==e?0:e>=2&&e<=4?1:2)},7:function(e){return Number(1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},8:function(e){return Number(1==e?0:2==e?1:8!=e&&11!=e?2:3)},9:function(e){return Number(e>=2)},10:function(e){return Number(1==e?0:2==e?1:e<7?2:e<11?3:4)},11:function(e){return Number(1==e||11==e?0:2==e||12==e?1:e>2&&e<20?2:3)},12:function(e){return Number(e%10!=1||e%100==11)},13:function(e){return Number(0!==e)},14:function(e){return Number(1==e?0:2==e?1:3==e?2:3)},15:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2)},16:function(e){return Number(e%10==1&&e%100!=11?0:0!==e?1:2)},17:function(e){return Number(1==e||e%10==1&&e%100!=11?0:1)},18:function(e){return Number(0==e?0:1==e?1:2)},19:function(e){return Number(1==e?0:0==e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3)},20:function(e){return Number(1==e?0:0==e||e%100>0&&e%100<20?1:2)},21:function(e){return Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0)},22:function(e){return Number(1==e?0:2==e?1:(e<0||e>10)&&e%10==0?2:3)}},Q=["v1","v2","v3"],Z={zero:0,one:1,two:2,few:3,many:4,other:5};function X(){var e={};return q.forEach((function(t){t.lngs.forEach((function(n){e[n]={numbers:t.nr,plurals:Y[t.fc]}}))})),e}var J=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,o.Z)(this,e),this.languageUtils=t,this.options=n,this.logger=b.create("pluralResolver"),this.options.compatibilityJSON&&"v4"!==this.options.compatibilityJSON||"undefined"!=typeof Intl&&Intl.PluralRules||(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=X()}return(0,i.Z)(e,[{key:"addRule",value:function(e,t){this.rules[e]=t}},{key:"getRule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(e,{type:t.ordinal?"ordinal":"cardinal"})}catch(e){return}return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}},{key:"needsPlural",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getRule(e,t);return this.shouldUseIntlApi()?n&&n.resolvedOptions().pluralCategories.length>1:n&&n.numbers.length>1}},{key:"getPluralFormsOfKey",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getSuffixes(e,n).map((function(e){return"".concat(t).concat(e)}))}},{key:"getSuffixes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.getRule(e,n);return r?this.shouldUseIntlApi()?r.resolvedOptions().pluralCategories.sort((function(e,t){return Z[e]-Z[t]})).map((function(e){return"".concat(t.options.prepend).concat(e)})):r.numbers.map((function(r){return t.getSuffix(e,r,n)})):[]}},{key:"getSuffix",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.getRule(e,n);return r?this.shouldUseIntlApi()?"".concat(this.options.prepend).concat(r.select(t)):this.getSuffixRetroCompatible(r,t):(this.logger.warn("no plural rule found for: ".concat(e)),"")}},{key:"getSuffixRetroCompatible",value:function(e,t){var n=this,r=e.noAbs?e.plurals(t):e.plurals(Math.abs(t)),o=e.numbers[r];this.options.simplifyPluralSuffix&&2===e.numbers.length&&1===e.numbers[0]&&(2===o?o="plural":1===o&&(o=""));var i=function(){return n.options.prepend&&o.toString()?n.options.prepend+o.toString():o.toString()};return"v1"===this.options.compatibilityJSON?1===o?"":"number"==typeof o?"_plural_".concat(o.toString()):i():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===e.numbers.length&&1===e.numbers[0]?i():this.options.prepend&&r.toString()?this.options.prepend+r.toString():r.toString()}},{key:"shouldUseIntlApi",value:function(){return!Q.includes(this.options.compatibilityJSON)}}]),e}();function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var te=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,o.Z)(this,e),this.logger=b.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||function(e){return e},this.init(t)}return(0,i.Z)(e,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});var t=e.interpolation;this.escape=void 0!==t.escape?t.escape:k,this.escapeValue=void 0===t.escapeValue||t.escapeValue,this.useRawValueToEscape=void 0!==t.useRawValueToEscape&&t.useRawValueToEscape,this.prefix=t.prefix?P(t.prefix):t.prefixEscaped||"{{",this.suffix=t.suffix?P(t.suffix):t.suffixEscaped||"}}",this.formatSeparator=t.formatSeparator?t.formatSeparator:t.formatSeparator||",",this.unescapePrefix=t.unescapeSuffix?"":t.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":t.unescapeSuffix||"",this.nestingPrefix=t.nestingPrefix?P(t.nestingPrefix):t.nestingPrefixEscaped||P("$t("),this.nestingSuffix=t.nestingSuffix?P(t.nestingSuffix):t.nestingSuffixEscaped||P(")"),this.nestingOptionsSeparator=t.nestingOptionsSeparator?t.nestingOptionsSeparator:t.nestingOptionsSeparator||",",this.maxReplaces=t.maxReplaces?t.maxReplaces:1e3,this.alwaysFormat=void 0!==t.alwaysFormat&&t.alwaysFormat,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var e="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(e,"g");var t="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(t,"g");var n="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(n,"g")}},{key:"interpolate",value:function(e,t,n,r){var o,i,a,s=this,c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function l(e){return e.replace(/\$/g,"$$$$")}var u=function(e){if(e.indexOf(s.formatSeparator)<0){var o=R(t,c,e);return s.alwaysFormat?s.format(o,void 0,n,ee(ee(ee({},r),t),{},{interpolationkey:e})):o}var i=e.split(s.formatSeparator),a=i.shift().trim(),l=i.join(s.formatSeparator).trim();return s.format(R(t,c,a),l,n,ee(ee(ee({},r),t),{},{interpolationkey:a}))};this.resetRegExp();var d=r&&r.missingInterpolationHandler||this.options.missingInterpolationHandler,p=r&&r.interpolation&&void 0!==r.interpolation.skipOnVariables?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:function(e){return l(e)}},{regex:this.regexp,safeValue:function(e){return s.escapeValue?l(s.escape(e)):l(e)}}].forEach((function(t){for(a=0;o=t.regex.exec(e);){var n=o[1].trim();if(void 0===(i=u(n)))if("function"==typeof d){var c=d(e,o,r);i="string"==typeof c?c:""}else if(r&&r.hasOwnProperty(n))i="";else{if(p){i=o[0];continue}s.logger.warn("missed to pass in variable ".concat(n," for interpolating ").concat(e)),i=""}else"string"==typeof i||s.useRawValueToEscape||(i=S(i));var l=t.safeValue(i);if(e=e.replace(o[0],l),p?(t.regex.lastIndex+=i.length,t.regex.lastIndex-=o[0].length):t.regex.lastIndex=0,++a>=s.maxReplaces)break}})),e}},{key:"nest",value:function(e,t){var n,r,o=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=ee({},i);function s(e,t){var n=this.nestingOptionsSeparator;if(e.indexOf(n)<0)return e;var r=e.split(new RegExp("".concat(n,"[ ]*{"))),o="{".concat(r[1]);e=r[0];var i=(o=this.interpolate(o,a)).match(/'/g),s=o.match(/"/g);(i&&i.length%2==0&&!s||s.length%2!=0)&&(o=o.replace(/'/g,'"'));try{a=JSON.parse(o),t&&(a=ee(ee({},t),a))}catch(t){return this.logger.warn("failed parsing options string in nesting for key ".concat(e),t),"".concat(e).concat(n).concat(o)}return delete a.defaultValue,e}for(a.applyPostProcessor=!1,delete a.defaultValue;n=this.nestingRegexp.exec(e);){var c=[],l=!1;if(-1!==n[0].indexOf(this.formatSeparator)&&!/{.*}/.test(n[1])){var u=n[1].split(this.formatSeparator).map((function(e){return e.trim()}));n[1]=u.shift(),c=u,l=!0}if((r=t(s.call(this,n[1].trim(),a),a))&&n[0]===e&&"string"!=typeof r)return r;"string"!=typeof r&&(r=S(r)),r||(this.logger.warn("missed to resolve ".concat(n[1]," for nesting ").concat(e)),r=""),l&&(r=c.reduce((function(e,t){return o.format(e,t,i.lng,ee(ee({},i),{},{interpolationkey:n[1].trim()}))}),r.trim())),e=e.replace(n[0],r),this.regexp.lastIndex=0}return e}}]),e}();function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function oe(e){var t=e.toLowerCase().trim(),n={};if(e.indexOf("(")>-1){var r=e.split("(");t=r[0].toLowerCase().trim();var o=r[1].substring(0,r[1].length-1);"currency"===t&&o.indexOf(":")<0?n.currency||(n.currency=o.trim()):"relativetime"===t&&o.indexOf(":")<0?n.range||(n.range=o.trim()):o.split(";").forEach((function(e){if(e){var t,r=e.split(":"),o=(t=r,(0,d.Z)(t)||(0,p.Z)(t)||(0,h.Z)(t)||(0,f.Z)()),i=o[0],a=o.slice(1).join(":").trim().replace(/^'+|'+$/g,"");n[i.trim()]||(n[i.trim()]=a),"false"===a&&(n[i.trim()]=!1),"true"===a&&(n[i.trim()]=!0),isNaN(a)||(n[i.trim()]=parseInt(a,10))}}))}return{formatName:t,formatOptions:n}}function ie(e){var t={};return function(n,r,o){var i=r+JSON.stringify(o),a=t[i];return a||(a=e(r,o),t[i]=a),a(n)}}var ae=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,o.Z)(this,e),this.logger=b.create("formatter"),this.options=t,this.formats={number:ie((function(e,t){var n=new Intl.NumberFormat(e,t);return function(e){return n.format(e)}})),currency:ie((function(e,t){var n=new Intl.NumberFormat(e,re(re({},t),{},{style:"currency"}));return function(e){return n.format(e)}})),datetime:ie((function(e,t){var n=new Intl.DateTimeFormat(e,re({},t));return function(e){return n.format(e)}})),relativetime:ie((function(e,t){var n=new Intl.RelativeTimeFormat(e,re({},t));return function(e){return n.format(e,t.range||"day")}})),list:ie((function(e,t){var n=new Intl.ListFormat(e,re({},t));return function(e){return n.format(e)}}))},this.init(t)}return(0,i.Z)(e,[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}},n=t.interpolation;this.formatSeparator=n.formatSeparator?n.formatSeparator:n.formatSeparator||","}},{key:"add",value:function(e,t){this.formats[e.toLowerCase().trim()]=t}},{key:"addCached",value:function(e,t){this.formats[e.toLowerCase().trim()]=ie(t)}},{key:"format",value:function(e,t,n,r){var o=this;return t.split(this.formatSeparator).reduce((function(e,t){var i=oe(t),a=i.formatName,s=i.formatOptions;if(o.formats[a]){var c=e;try{var l=r&&r.formatParams&&r.formatParams[r.interpolationkey]||{},u=l.locale||l.lng||r.locale||r.lng||n;c=o.formats[a](e,u,re(re(re({},s),r),l))}catch(e){o.logger.warn(e)}return c}return o.logger.warn("there was no format function for ".concat(a)),e}),e)}}]),e}();function se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?se(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,l.Z)(e);if(t){var o=(0,l.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,c.Z)(this,n)}}var ue=function(e){(0,s.Z)(n,e);var t=le(n);function n(e,r,i){var s,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return(0,o.Z)(this,n),s=t.call(this),D&&_.call((0,a.Z)(s)),s.backend=e,s.store=r,s.services=i,s.languageUtils=i.languageUtils,s.options=c,s.logger=b.create("backendConnector"),s.waitingReads=[],s.maxParallelReads=c.maxParallelReads||10,s.readingCalls=0,s.maxRetries=c.maxRetries>=0?c.maxRetries:5,s.retryTimeout=c.retryTimeout>=1?c.retryTimeout:350,s.state={},s.queue=[],s.backend&&s.backend.init&&s.backend.init(i,c.backend,c),s}return(0,i.Z)(n,[{key:"queueLoad",value:function(e,t,n,r){var o=this,i={},a={},s={},c={};return e.forEach((function(e){var r=!0;t.forEach((function(t){var s="".concat(e,"|").concat(t);!n.reload&&o.store.hasResourceBundle(e,t)?o.state[s]=2:o.state[s]<0||(1===o.state[s]?void 0===a[s]&&(a[s]=!0):(o.state[s]=1,r=!1,void 0===a[s]&&(a[s]=!0),void 0===i[s]&&(i[s]=!0),void 0===c[t]&&(c[t]=!0)))})),r||(s[e]=!0)})),(Object.keys(i).length||Object.keys(a).length)&&this.queue.push({pending:a,pendingCount:Object.keys(a).length,loaded:{},errors:[],callback:r}),{toLoad:Object.keys(i),pending:Object.keys(a),toLoadLanguages:Object.keys(s),toLoadNamespaces:Object.keys(c)}}},{key:"loaded",value:function(e,t,n){var r=e.split("|"),o=r[0],i=r[1];t&&this.emit("failedLoading",o,i,t),n&&this.store.addResourceBundle(o,i,n),this.state[e]=t?-1:2;var a={};this.queue.forEach((function(n){var r,s,c,l,u,d;r=n.loaded,s=i,l=E(r,[o],Object),u=l.obj,d=l.k,u[d]=u[d]||[],c&&(u[d]=u[d].concat(s)),c||u[d].push(s),function(e,t){void 0!==e.pending[t]&&(delete e.pending[t],e.pendingCount--)}(n,e),t&&n.errors.push(t),0!==n.pendingCount||n.done||(Object.keys(n.loaded).forEach((function(e){a[e]||(a[e]={});var t=n.loaded[e];t.length&&t.forEach((function(t){void 0===a[e][t]&&(a[e][t]=!0)}))})),n.done=!0,n.errors.length?n.callback(n.errors):n.callback())})),this.emit("loaded",a),this.queue=this.queue.filter((function(e){return!e.done}))}},{key:"read",value:function(e,t,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.retryTimeout,a=arguments.length>5?arguments[5]:void 0;return e.length?this.readingCalls>=this.maxParallelReads?void this.waitingReads.push({lng:e,ns:t,fcName:n,tried:o,wait:i,callback:a}):(this.readingCalls++,this.backend[n](e,t,(function(s,c){if(r.readingCalls--,r.waitingReads.length>0){var l=r.waitingReads.shift();r.read(l.lng,l.ns,l.fcName,l.tried,l.wait,l.callback)}s&&c&&o<r.maxRetries?setTimeout((function(){r.read.call(r,e,t,n,o+1,2*i,a)}),i):a(s,c)}))):a(null,{})}},{key:"prepareLoading",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),o&&o();"string"==typeof e&&(e=this.languageUtils.toResolveHierarchy(e)),"string"==typeof t&&(t=[t]);var i=this.queueLoad(e,t,r,o);if(!i.toLoad.length)return i.pending.length||o(),null;i.toLoad.forEach((function(e){n.loadOne(e)}))}},{key:"load",value:function(e,t,n){this.prepareLoading(e,t,{},n)}},{key:"reload",value:function(e,t,n){this.prepareLoading(e,t,{reload:!0},n)}},{key:"loadOne",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=e.split("|"),o=r[0],i=r[1];this.read(o,i,"read",void 0,void 0,(function(r,a){r&&t.logger.warn("".concat(n,"loading namespace ").concat(i," for language ").concat(o," failed"),r),!r&&a&&t.logger.log("".concat(n,"loaded namespace ").concat(i," for language ").concat(o),a),t.loaded(e,r,a)}))}},{key:"saveMissing",value:function(e,t,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(t)?this.logger.warn('did not save key "'.concat(n,'" as the namespace "').concat(t,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!"):null!=n&&""!==n&&(this.backend&&this.backend.create&&this.backend.create(e,t,n,r,null,ce(ce({},i),{},{isUpdate:o})),e&&e[0]&&this.store.addResource(e[0],t,n,r))}}]),n}(_);function de(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(e){var t={};if("object"===(0,r.Z)(e[1])&&(t=e[1]),"string"==typeof e[1]&&(t.defaultValue=e[1]),"string"==typeof e[2]&&(t.tDescription=e[2]),"object"===(0,r.Z)(e[2])||"object"===(0,r.Z)(e[3])){var n=e[3]||e[2];Object.keys(n).forEach((function(e){t[e]=n[e]}))}return t},interpolation:{escapeValue:!0,format:function(e,t,n,r){return e},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}}function pe(e){return"string"==typeof e.ns&&(e.ns=[e.ns]),"string"==typeof e.fallbackLng&&(e.fallbackLng=[e.fallbackLng]),"string"==typeof e.fallbackNS&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs&&e.supportedLngs.indexOf("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),e}function he(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?he(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):he(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,l.Z)(e);if(t){var o=(0,l.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,c.Z)(this,n)}}function ve(){}function ye(e){Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach((function(t){"function"==typeof e[t]&&(e[t]=e[t].bind(e))}))}var me=function(e){(0,s.Z)(n,e);var t=ge(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;if((0,o.Z)(this,n),e=t.call(this),D&&_.call((0,a.Z)(e)),e.options=pe(r),e.services={},e.logger=b,e.modules={external:[]},ye((0,a.Z)(e)),i&&!e.isInitialized&&!r.isClone){if(!e.options.initImmediate)return e.init(r,i),(0,c.Z)(e,(0,a.Z)(e));setTimeout((function(){e.init(r,i)}),0)}return e}return(0,i.Z)(n,[{key:"init",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;"function"==typeof t&&(n=t,t={}),!t.defaultNS&&!1!==t.defaultNS&&t.ns&&("string"==typeof t.ns?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));var r=de();function o(e){return e?"function"==typeof e?new e:e:null}if(this.options=fe(fe(fe({},r),this.options),pe(t)),"v1"!==this.options.compatibilityAPI&&(this.options.interpolation=fe(fe({},r.interpolation),this.options.interpolation)),void 0!==t.keySeparator&&(this.options.userDefinedKeySeparator=t.keySeparator),void 0!==t.nsSeparator&&(this.options.userDefinedNsSeparator=t.nsSeparator),!this.options.isClone){var i;this.modules.logger?b.init(o(this.modules.logger),this.options):b.init(null,this.options),this.modules.formatter?i=this.modules.formatter:"undefined"!=typeof Intl&&(i=ae);var a=new K(this.options);this.store=new F(this.options.resources,this.options);var s=this.services;s.logger=b,s.resourceStore=this.store,s.languageUtils=a,s.pluralResolver=new J(a,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),!i||this.options.interpolation.format&&this.options.interpolation.format!==r.interpolation.format||(s.formatter=o(i),s.formatter.init(s,this.options),this.options.interpolation.format=s.formatter.format.bind(s.formatter)),s.interpolator=new te(this.options),s.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},s.backendConnector=new ue(o(this.modules.backend),s.resourceStore,s,this.options),s.backendConnector.on("*",(function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];e.emit.apply(e,[t].concat(r))})),this.modules.languageDetector&&(s.languageDetector=o(this.modules.languageDetector),s.languageDetector.init(s,this.options.detection,this.options)),this.modules.i18nFormat&&(s.i18nFormat=o(this.modules.i18nFormat),s.i18nFormat.init&&s.i18nFormat.init(this)),this.translator=new W(this.services,this.options),this.translator.on("*",(function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];e.emit.apply(e,[t].concat(r))})),this.modules.external.forEach((function(t){t.init&&t.init(e)}))}if(this.format=this.options.interpolation.format,n||(n=ve),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){var c=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);c.length>0&&"dev"!==c[0]&&(this.options.lng=c[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined");var l=["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"];l.forEach((function(t){e[t]=function(){var n;return(n=e.store)[t].apply(n,arguments)}}));var u=["addResource","addResources","addResourceBundle","removeResourceBundle"];u.forEach((function(t){e[t]=function(){var n;return(n=e.store)[t].apply(n,arguments),e}}));var d=C(),p=function(){var t=function(t,r){e.isInitialized&&!e.initializedStoreOnce&&e.logger.warn("init: i18next is already initialized. You should call init just once!"),e.isInitialized=!0,e.options.isClone||e.logger.log("initialized",e.options),e.emit("initialized",e.options),d.resolve(r),n(t,r)};if(e.languages&&"v1"!==e.options.compatibilityAPI&&!e.isInitialized)return t(null,e.t.bind(e));e.changeLanguage(e.options.lng,t)};return this.options.resources||!this.options.initImmediate?p():setTimeout(p,0),d}},{key:"loadResources",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ve,r=n,o="string"==typeof e?e:this.language;if("function"==typeof e&&(r=e),!this.options.resources||this.options.partialBundledLanguages){if(o&&"cimode"===o.toLowerCase())return r();var i=[],a=function(e){e&&t.services.languageUtils.toResolveHierarchy(e).forEach((function(e){i.indexOf(e)<0&&i.push(e)}))};if(o)a(o);else{var s=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);s.forEach((function(e){return a(e)}))}this.options.preload&&this.options.preload.forEach((function(e){return a(e)})),this.services.backendConnector.load(i,this.options.ns,(function(e){e||t.resolvedLanguage||!t.language||t.setResolvedLanguage(t.language),r(e)}))}else r(null)}},{key:"reloadResources",value:function(e,t,n){var r=C();return e||(e=this.languages),t||(t=this.options.ns),n||(n=ve),this.services.backendConnector.reload(e,t,(function(e){r.resolve(),n(e)})),r}},{key:"use",value:function(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&U.addPostProcessor(e),"formatter"===e.type&&(this.modules.formatter=e),"3rdParty"===e.type&&this.modules.external.push(e),this}},{key:"setResolvedLanguage",value:function(e){if(e&&this.languages&&!(["cimode","dev"].indexOf(e)>-1))for(var t=0;t<this.languages.length;t++){var n=this.languages[t];if(!(["cimode","dev"].indexOf(n)>-1)&&this.store.hasLanguageSomeTranslations(n)){this.resolvedLanguage=n;break}}}},{key:"changeLanguage",value:function(e,t){var n=this;this.isLanguageChangingTo=e;var r=C();this.emit("languageChanging",e);var o=function(e){n.language=e,n.languages=n.services.languageUtils.toResolveHierarchy(e),n.resolvedLanguage=void 0,n.setResolvedLanguage(e)},i=function(i){e||i||!n.services.languageDetector||(i=[]);var a="string"==typeof i?i:n.services.languageUtils.getBestMatchFromCodes(i);a&&(n.language||o(a),n.translator.language||n.translator.changeLanguage(a),n.services.languageDetector&&n.services.languageDetector.cacheUserLanguage(a)),n.loadResources(a,(function(e){!function(e,i){i?(o(i),n.translator.changeLanguage(i),n.isLanguageChangingTo=void 0,n.emit("languageChanged",i),n.logger.log("languageChanged",i)):n.isLanguageChangingTo=void 0,r.resolve((function(){return n.t.apply(n,arguments)})),t&&t(e,(function(){return n.t.apply(n,arguments)}))}(e,a)}))};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect(i):i(e):i(this.services.languageDetector.detect()),r}},{key:"getFixedT",value:function(e,t,n){var o=this,i=function e(t,i){var a;if("object"!==(0,r.Z)(i)){for(var s=arguments.length,c=new Array(s>2?s-2:0),l=2;l<s;l++)c[l-2]=arguments[l];a=o.options.overloadTranslationOptionHandler([t,i].concat(c))}else a=fe({},i);a.lng=a.lng||e.lng,a.lngs=a.lngs||e.lngs,a.ns=a.ns||e.ns,a.keyPrefix=a.keyPrefix||n||e.keyPrefix;var u=o.options.keySeparator||".",d=a.keyPrefix?"".concat(a.keyPrefix).concat(u).concat(t):t;return o.t(d,a)};return"string"==typeof e?i.lng=e:i.lngs=e,i.ns=t,i.keyPrefix=n,i}},{key:"t",value:function(){var e;return this.translator&&(e=this.translator).translate.apply(e,arguments)}},{key:"exists",value:function(){var e;return this.translator&&(e=this.translator).exists.apply(e,arguments)}},{key:"setDefaultNamespace",value:function(e){this.options.defaultNS=e}},{key:"hasLoadedNamespace",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var r=this.resolvedLanguage||this.languages[0],o=!!this.options&&this.options.fallbackLng,i=this.languages[this.languages.length-1];if("cimode"===r.toLowerCase())return!0;var a=function(e,n){var r=t.services.backendConnector.state["".concat(e,"|").concat(n)];return-1===r||2===r};if(n.precheck){var s=n.precheck(this,a);if(void 0!==s)return s}return!(!this.hasResourceBundle(r,e)&&this.services.backendConnector.backend&&(!this.options.resources||this.options.partialBundledLanguages)&&(!a(r,e)||o&&!a(i,e)))}},{key:"loadNamespaces",value:function(e,t){var n=this,r=C();return this.options.ns?("string"==typeof e&&(e=[e]),e.forEach((function(e){n.options.ns.indexOf(e)<0&&n.options.ns.push(e)})),this.loadResources((function(e){r.resolve(),t&&t(e)})),r):(t&&t(),Promise.resolve())}},{key:"loadLanguages",value:function(e,t){var n=C();"string"==typeof e&&(e=[e]);var r=this.options.preload||[],o=e.filter((function(e){return r.indexOf(e)<0}));return o.length?(this.options.preload=r.concat(o),this.loadResources((function(e){n.resolve(),t&&t(e)})),n):(t&&t(),Promise.resolve())}},{key:"dir",value:function(e){return e||(e=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),e?["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(this.services.languageUtils.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr":"rtl"}},{key:"cloneInstance",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ve,o=fe(fe(fe({},this.options),t),{isClone:!0}),i=new n(o);void 0===t.debug&&void 0===t.prefix||(i.logger=i.logger.clone(t));var a=["store","services","language"];return a.forEach((function(t){i[t]=e[t]})),i.services=fe({},this.services),i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i.translator=new W(i.services,i.options),i.translator.on("*",(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];i.emit.apply(i,[e].concat(n))})),i.init(o,r),i.translator.options=i.options,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}},{key:"toJSON",value:function(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}]),n}(_);(0,u.Z)(me,"createInstance",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return new me(e,t)}));var be=me.createInstance();be.createInstance=me.createInstance,be.createInstance,be.init,be.loadResources,be.reloadResources,be.use,be.changeLanguage,be.getFixedT,be.t,be.exists,be.setDefaultNamespace,be.hasLoadedNamespace,be.loadNamespaces,be.loadLanguages;var _e=be},12422:function(e,t,n){var r=n(69958);t.Z=function(e,t,n){for(var o=-1,i=e.length;++o<i;){var a=e[o],s=t(a);if(null!=s&&(void 0===c?s==s&&!(0,r.Z)(s):n(s,c)))var c=s,l=a}return l}},92999:function(e,t){t.Z=function(e,t){return e>t}},89178:function(e,t,n){var r=n(30515),o=n(44473),i=n(36140),a=n(61452),s=n(45485);t.Z=function(e,t,n,c){if(!(0,a.Z)(e))return e;for(var l=-1,u=(t=(0,o.Z)(t,e)).length,d=u-1,p=e;null!=p&&++l<u;){var h=(0,s.Z)(t[l]),f=n;if("__proto__"===h||"constructor"===h||"prototype"===h)return e;if(l!=d){var g=p[h];void 0===(f=c?c(g,h,p):void 0)&&(f=(0,a.Z)(g)?g:(0,i.Z)(t[l+1])?[]:{})}(0,r.Z)(p,h,f),p=p[h]}return e}},30157:function(e,t,n){var r=n(9190),o=/^\s+/;t.Z=function(e){return e?e.slice(0,(0,r.Z)(e)+1).replace(o,""):e}},9190:function(e,t){var n=/\s/;t.Z=function(e){for(var t=e.length;t--&&n.test(e.charAt(t)););return t}},77546:function(e,t,n){n.r(t);var r=n(22734),o=n(59681),i=n(84634),a=(0,o.Z)((function(e,t,n,o){(0,r.Z)(t,(0,i.Z)(t),e,o)}));t.default=a},60608:function(e,t,n){n.r(t);var r=n(61452),o=n(88143),i=n(47243),a=Math.max,s=Math.min;t.default=function(e,t,n){var c,l,u,d,p,h,f=0,g=!1,v=!1,y=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function m(t){var n=c,r=l;return c=l=void 0,f=t,d=e.apply(r,n)}function b(e){return f=e,p=setTimeout(C,t),g?m(e):d}function _(e){var n=e-h;return void 0===h||n>=t||n<0||v&&e-f>=u}function C(){var e=(0,o.Z)();if(_(e))return S(e);p=setTimeout(C,function(e){var n=t-(e-h);return v?s(n,u-(e-f)):n}(e))}function S(e){return p=void 0,y&&c?m(e):(c=l=void 0,d)}function w(){var e=(0,o.Z)(),n=_(e);if(c=arguments,l=this,h=e,n){if(void 0===p)return b(h);if(v)return clearTimeout(p),p=setTimeout(C,t),m(h)}return void 0===p&&(p=setTimeout(C,t)),d}return t=(0,i.Z)(t)||0,(0,r.Z)(n)&&(g=!!n.leading,u=(v="maxWait"in n)?a((0,i.Z)(n.maxWait)||0,t):u,y="trailing"in n?!!n.trailing:y),w.cancel=function(){void 0!==p&&clearTimeout(p),f=0,c=h=l=p=void 0},w.flush=function(){return void 0===p?d:S((0,o.Z)())},w}},47300:function(e,t,n){var r=n(12422),o=n(92999),i=n(29459);t.Z=function(e){return e&&e.length?(0,r.Z)(e,i.Z,o.Z):void 0}},88143:function(e,t,n){var r=n(87995);t.Z=function(){return r.Z.Date.now()}},66336:function(e,t,n){n.r(t);var r=n(89178);t.default=function(e,t,n){return null==e?e:(0,r.Z)(e,t,n)}},62249:function(e,t,n){n.r(t);var r=n(60608),o=n(61452);t.default=function(e,t,n){var i=!0,a=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return(0,o.Z)(n)&&(i="leading"in n?!!n.leading:i,a="trailing"in n?!!n.trailing:a),(0,r.default)(e,t,{leading:i,maxWait:t,trailing:a})}},47243:function(e,t,n){var r=n(30157),o=n(61452),i=n(69958),a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt;t.Z=function(e){if("number"==typeof e)return e;if((0,i.Z)(e))return NaN;if((0,o.Z)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=(0,o.Z)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=(0,r.Z)(e);var n=s.test(e);return n||c.test(e)?l(e.slice(2),n?2:8):a.test(e)?NaN:+e}}},function(e){e.O(0,[8487,1146,8681,5949,8040,7354,7568],(function(){return t=67551,e(e.s=t);var t})),e.O()}]),"object"==typeof globalThis&&(globalThis.jsExecEndTimeStamp=Date.now(),globalThis.cachedPerformanceEntries||(globalThis.cachedPerformanceEntries=[]),globalThis.cachedPerformanceEntries.push({name:"jsExec: js/public-firstload-pc-cfc5938d.js",entryType:"jsExec",startTime:globalThis.jsExecStartTimeStamp,endTime:globalThis.jsExecEndTimeStamp}));
//# sourceMappingURL=public-firstload-pc-cfc5938d.js.map