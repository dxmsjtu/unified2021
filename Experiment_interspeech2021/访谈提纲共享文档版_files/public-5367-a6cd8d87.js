"object"==typeof globalThis&&(globalThis.jsExecStartTimeStamp=Date.now()),(self.webpackChunkuni=self.webpackChunkuni||[]).push([[5367],{95367:function(e,t,o){o.r(t),o.d(t,{getModules:function(){return Vt}});var n=o(61251),r=o(46016),i=o(47176),a=o(85556),s=o(87363),l=o.n(s),c=o(30479),p="HIDE_SCROLLBAR",h=2;function d(e,t){return e-t>0}var u=function(e){return function(t){function o(e){var o=t.call(this,e)||this;o.mousedownInner=!1,o.scrollerRef=l().createRef(),o.onSelectionChange=function(e){var t,n=o.props.cbKey;(null===(t=o.props)||void 0===t?void 0:t.onSelectionChange)&&o.props.onSelectionChange(e,o.scrollerRef,n,(function(e,t){o.onUpdateRenderInfo(n,e,t)}))},o.onSelectionEnd=function(e){var t,n=e.viewRange,r=n.start,i=n.end;r.gcp===i.gcp&&(null===(t=o.props)||void 0===t?void 0:t.onSelectionEnd)&&o.props.onSelectionEnd(r,o.scrollerRef,(function(e,t,n){o.onUpdateRenderInfo(e,t,n)}))},o.onScroll=function(){o.scrollerRef&&o.scrollerRef.current&&o.onUpdateRenderInfo(o.props.cbKey,o.scrollerRef.current.scrollLeft,o.scrollerRef.current.scrollTop),o.props.onScroll&&o.props.onScroll(o.scrollerRef),o.hideTableBubbleReminder()},o.onMousedownOuter=function(e){o.mousedownInner||e.stopPropagation(),o.mousedownInner=!1,o.hideTableBubbleReminder()},o.onMouseMoveOnWrapper=function(e){o.props.isTable&&(-1!==e.nativeEvent.srcElement.className.indexOf("scroller-default-wrapper")?o.showTableBubbleReminder(e.clientX):o.hideTableBubbleReminder())},o.showTableBubbleReminder=function(e){var t=o.getBubbleReminderPosInfo(e);t&&o.state.enableHScroll&&o.props.context.fire(new r.PvE(t.left,t.top,t.scrollerWidth))},o.hideTableBubbleReminder=function(){o.props.isTable&&o.props.context.fire(new r.ajJ)},o.onMouseMoveLeave=function(){o.hideTableBubbleReminder()},o.onMousedownInner=function(){o.mousedownInner=!0},o.getBubbleReminderPosInfo=function(e){var t;if(!(null===(t=o.scrollerRef)||void 0===t?void 0:t.current))return null;var n=o.props.context,i=n.zoom,a=n.view,s=o.scrollerRef.current.scrollLeft,l=o.scrollerRef.current.getBoundingClientRect(),c=o.props,p=c.rectSize,h=c.contentSize,d=p.width/h.width*p.width,u=s/h.width*p.width,f=(e-l.x)/i;if(f<u||f>u+d)return null;var g=p.height-r.AOE-r.qv2,v=a.getExtendedDom();if(!v)return null;var y=v.getBoundingClientRect();return{scrollerWidth:d,left:(l.left-y.left)/i+u,top:(l.top-y.top)/i+g}};var n=e.scrollLeft,i=e.scrollTop,a=e.hiddenVScroll,s=e.hiddenHScroll;return o.state={left:n,top:i,enableVScroll:!a&&d(o.props.contentSize.height,o.props.rectSize.height),enableHScroll:!s&&d(o.props.contentSize.width,o.props.rectSize.width)},o}return(0,a.__extends)(o,t),o.prototype.onUpdateRenderInfo=function(e,t,o){var n=this.props,i=n.rectSize,a=n.contentSize,s=this.props.shares.renderState,l=s.getScrollerInfo(this.props.cbKey)||{left:0,top:0};l.left=Math.min(t,Math.ceil(a.width-i.width)+h),l.top=Math.min(o,Math.ceil(a.height-i.height)+h),s.setScrollerInfo(e,l),this.props.context.fire(new r.kv7(!1)),this.props.onWheel&&this.props.onWheel(this.props.cbKey,t,o)},o.getDerivedStateFromProps=function(e){var t=e.scrollLeft,o=e.scrollTop,n=e.hiddenHScroll;return{left:t,top:o,enableVScroll:!e.hiddenVScroll&&d(e.contentSize.height,e.rectSize.height),enableHScroll:!n&&d(e.contentSize.width,e.rectSize.width)}},o.prototype.componentDidUpdate=function(){this.updateScrollInfo()},o.prototype.componentDidMount=function(){this.updateScrollInfo(),this.props.onDidMount&&this.props.onDidMount(this.scrollerRef),this.props.context.on(r.kgn.SELECTION_CHANGE,this.onSelectionChange),this.props.context.on(r.kgn.SELECTION_END,this.onSelectionEnd)},o.prototype.componentWillUnmount=function(){this.props.context.removeCallBack(r.kgn.SELECTION_CHANGE,this.onSelectionChange),this.props.context.removeCallBack(r.kgn.SELECTION_END,this.onSelectionEnd)},o.prototype.updateScrollInfo=function(){this.scrollerRef&&this.scrollerRef.current&&(this.scrollerRef.current.scrollLeft=(0,c.twipsToPx)(this.props.scrollLeft),this.scrollerRef.current.scrollTop=(0,c.twipsToPx)(this.props.scrollTop))},o.prototype.render=function(){var t=this.props,o=t.rectSize,n=t.contentSize,i=t.layoutBox,s=(0,c.twipsToPx)(i.edge.border.width.left),p=(0,c.twipsToPx)(i.edge.border.width.top),d=this.getScrollOverflowStyle(),u={overflowX:d.overflowX,overflowY:d.overflowY,width:"".concat(o.width+s+(this.state.enableVScroll?8:0),"px"),height:"".concat(o.height+p+(this.state.enableHScroll?8:0),"px")},f=n.width+(this.state.enableHScroll?h:0),g=n.height+(this.state.enableVScroll?h:0);return l().createElement("div",{key:"".concat(this.props.cbKey,"-wrapper"),style:u,className:"".concat(r.F51.scrollerDefaultWrapper," ").concat(this.sideClassName()," ").concat(this.scrollbarClassName()),onMouseDown:this.onMousedownOuter,onMouseMove:this.onMouseMoveOnWrapper,onMouseLeave:this.onMouseMoveLeave,onScroll:this.onScroll,ref:this.scrollerRef},l().createElement("div",{onMouseDown:this.onMousedownInner},l().createElement(e,(0,a.__assign)({},this.props,{contentSize:{width:f,height:g},scrollLeft:this.state.left,scrollTop:this.state.top}))))},o.prototype.getScrollOverflowStyle=function(){var e={overflowX:"hidden",overflowY:"hidden"};return this.state.enableHScroll&&(e.overflowX="auto"),this.state.enableVScroll&&(e.overflowY="auto"),e},o.prototype.scrollbarClassName=function(){var e="";return this.props.isTable&&!this.props.isTableActivited&&(e=p),e},o.prototype.sideClassName=function(){var e="",t=this.props,o=t.rectSize,n=t.contentSize;if(!this.state.enableHScroll||!this.props.isTable)return e;var i=Math.round((0,c.twipsToPx)(this.props.scrollLeft));return Math.round(n.width-o.width)-i>0&&(e="".concat(r.F51.tableScrollerRightShadow," ").concat(e)),0!==i&&(e="".concat(r.F51.tableScrollerLeftShadow," ").concat(e)),e},o}(l().Component)},f=o(82487),g=o(46708);function v(e,t){for(var o=Object.keys(t),n=0;n<o.length;n++)e=e.replace(new RegExp("\\{".concat(o[n],"\\}"),"gi"),t[o[n]]);return e}function y(e){if(!e)throw new Error("cannot create a random attribute name for an undefined object");var t="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",o="";do{o="";for(var n=0;n<12;n++)o+=t[Math.floor(Math.random()*t.length)]}while(e[o]);return o}function x(e){var t={alphabetic:"alphabetic",hanging:"hanging",top:"text-before-edge",bottom:"text-after-edge",middle:"central"};return t[e]||t.alphabetic}function w(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]);return[e[0]/t,e[1]/t]}var m=function(e,t){var o={},n=e.split(",");t=t||10;for(var r=0;r<n.length;r+=2){var i="&".concat(n[r+1],";"),a=parseInt(n[r],t);o[i]="&#".concat(a,";")}return o["\\xa0"]="&#160;",o}("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),S={strokeStyle:{svgAttr:"stroke",canvas:"#000000",svg:"none",apply:"stroke"},fillStyle:{svgAttr:"fill",canvas:"#000000",svg:null,apply:"fill"},lineCap:{svgAttr:"stroke-linecap",canvas:"butt",svg:"butt",apply:"stroke"},lineJoin:{svgAttr:"stroke-linejoin",canvas:"miter",svg:"miter",apply:"stroke"},miterLimit:{svgAttr:"stroke-miterlimit",canvas:10,svg:4,apply:"stroke"},lineWidth:{svgAttr:"stroke-width",canvas:1,svg:1,apply:"stroke"},globalAlpha:{svgAttr:"opacity",canvas:1,svg:1,apply:"fill stroke"},font:{canvas:"10px sans-serif"},shadowColor:{canvas:"#000000"},shadowOffsetX:{canvas:0},shadowOffsetY:{canvas:0},shadowBlur:{canvas:0},textAlign:{canvas:"start"},textBaseline:{canvas:"alphabetic"},lineDash:{svgAttr:"stroke-dasharray",canvas:"",svg:null,apply:"stroke"}},b=function(){function e(e,t){this.root=e,this.ctx=t}return e.prototype.setTransform=function(e){},e}(),C=function(){function e(e,t){this.root=e,this.ctx=t}return e.prototype.addColorStop=function(e,t){},e}(),T=function(){function e(e,t,o,n){var r=500,i=500;this.width=t||r,this.height=o||i,this._document=n||document,this.canvas=this._document.createElement("canvas"),this._ctx=this.canvas.getContext("2d"),this._setDefaultStyles(),this._stack=[this._getStyleState()],this._groupStack=[],e?this._root=e:(this._root=this._document.createElementNS("http://www.w3.org/2000/svg","svg"),this._root.setAttribute("version","1.1"),this._root.setAttribute("xmlns","http://www.w3.org/2000/svg"),this._root.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this._root.setAttribute("width","".concat(this.width)),this._root.setAttribute("height","".concat(this.height))),this._ids={},this._defs=this._document.createElementNS("http://www.w3.org/2000/svg","defs"),this._root.appendChild(this._defs),this._currentElement=this._document.createElementNS("http://www.w3.org/2000/svg","g"),this._root.appendChild(this._currentElement),this._clipPathMap=new Map}return Object.defineProperty(e.prototype,"fontProp",{get:function(){return(0,a.__assign)({},this._fontProp)},set:function(e){this._fontProp=(0,a.__assign)({},e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"strokeStyle",{get:function(){return this._strokeStyle},set:function(e){this._strokeStyle="auto"!==e?e:"rgb(0, 0, 0)"},enumerable:!1,configurable:!0}),e.prototype.ellipse=function(e,t,o,n,r,i,a,s){throw new Error("Method not implemented.")},e.prototype.getTransform=function(){throw new Error("Method not implemented.")},e.prototype.resetTransform=function(){throw new Error("Method not implemented.")},e.prototype.setTransform=function(e,t,o,n,r,i){throw new Error("Method not implemented.")},e.prototype.drawFocusIfNeeded=function(e,t){throw new Error("Method not implemented.")},e.prototype.scrollPathIntoView=function(e){throw new Error("Method not implemented.")},e.prototype._createElement=function(e,t,o){void 0===t&&(t={});var n=this._document.createElementNS("http://www.w3.org/2000/svg",e),r=Object.keys(t);o&&(n.setAttribute("fill","none"),n.setAttribute("stroke","none"));for(var i=0;i<r.length;i++){var a=r[i];n.setAttribute(a,t[a])}return n},e.prototype._setDefaultStyles=function(){for(var e=Object.keys(S),t=0;t<e.length;t++){var o=e[t];this[o]=S[o].canvas}},e.prototype._applyStyleState=function(e){for(var t=Object.keys(e),o=0;o<t.length;o++){var n=t[o];this[n]=e[n]}},e.prototype._getStyleState=function(){for(var e={},t=Object.keys(S),o=0;o<t.length;o++){var n=t[o];e[n]=this[n]}return e},e.prototype._applyStyleToCurrentElement=function(e){var t=this._currentElement,o=this._currentElementsToStyle;if(o&&(null==t||t.setAttribute(e,""),t=o.element,o.children.forEach((function(t){t.setAttribute(e,"")}))),t)for(var n=Object.keys(S),r=0;r<n.length;r++){var i=S[n[r]],a=this[n[r]];if(i.apply)if(a instanceof b){if(a.ctx)for(;a.ctx._defs.childNodes.length;){var s=a.ctx._defs.childNodes[0].getAttribute("id");s&&(this._ids[s]=s,this._defs.appendChild(a.ctx._defs.childNodes[0]),a.ctx._defs.removeChild(a.ctx._defs.childNodes[0]))}t.setAttribute(i.apply,v("url(#{id})",{id:a.root.getAttribute("id")}))}else if(a instanceof C)t.setAttribute(i.apply,v("url(#{id})",{id:a.root.getAttribute("id")}));else if(-1!==i.apply.indexOf(e)&&i.svg!==a)if("stroke"!==i.svgAttr&&"fill"!==i.svgAttr||-1===a.indexOf("rgba")){var l=i.svgAttr;if("globalAlpha"===n[r]&&(l="".concat(e,"-").concat(i.svgAttr),t.getAttribute(l)))continue;t.setAttribute(l,a)}else{var c=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi.exec(a);if(c){t.setAttribute(i.svgAttr,v("rgb({r},{g},{b})",{r:c[1],g:c[2],b:c[3]}));var p=parseFloat(c[4]),h=this.globalAlpha;null!==h&&(p*=h),t.setAttribute("".concat(i.svgAttr,"-opacity"),"".concat(p))}}}},e.prototype._closestGroupOrSvg=function(e){return"g"===(null==(e=e||this._currentElement)?void 0:e.nodeName)||"svg"===(null==e?void 0:e.nodeName)?e:this._closestGroupOrSvg(null==e?void 0:e.parentNode)},e.prototype.getSerializedSvg=function(e){var t=(new XMLSerializer).serializeToString(this._root);if(/xmlns="http:\/\/www\.w3\.org\/2000\/svg".+xmlns="http:\/\/www\.w3\.org\/2000\/svg/gi.test(t)&&(t=t.replace('xmlns="http://www.w3.org/2000/svg','xmlns:xlink="http://www.w3.org/1999/xlink')),e)for(var o=Object.keys(m),n=0;n<o.length;n++){var r=o[n],i=m[r],a=new RegExp(r,"gi");a.test(t)&&(t=t.replace(a,i))}return t},e.prototype.getSvg=function(){return this._root},e.prototype.save=function(){var e=this._createElement("g"),t=this._closestGroupOrSvg();this._groupStack.push(t),t.appendChild(e),this._currentElement=e,this._stack.push(this._getStyleState())},e.prototype.restore=function(){this._currentElement=this._groupStack.pop(),this._currentElementsToStyle=null,this._currentElement||(this._currentElement=this._root.childNodes[1]);var e=this._stack.pop();this._applyStyleState(e)},e.prototype._addTransform=function(e){var t,o,n,r=this._closestGroupOrSvg();if(r.childNodes.length>0){"path"===(null===(t=this._currentElement)||void 0===t?void 0:t.nodeName)&&(this._currentElementsToStyle||(this._currentElementsToStyle={element:r,children:[]}),this._currentElementsToStyle.children.push(this._currentElement),this._applyCurrentDefaultPath());var i=this._createElement("g");r.appendChild(i),this._currentElement=i}var a=null===(o=this._currentElement)||void 0===o?void 0:o.getAttribute("transform");a?a+=" ":a="",a+=e,null===(n=this._currentElement)||void 0===n||n.setAttribute("transform",a)},e.prototype.scale=function(e,t){void 0===t&&(t=e),this._addTransform(v("scale({x},{y})",{x:e,y:t}))},e.prototype.rotate=function(e){if(0!==e){var t=180*e/Math.PI;this._addTransform(v("rotate({angle},{cx},{cy})",{angle:t,cx:0,cy:0}))}},e.prototype.translate=function(e,t){0===e&&0===t||this._addTransform(v("translate({x},{y})",{x:e,y:t}))},e.prototype.transform=function(e,t,o,n,r,i){this._addTransform(v("matrix({a},{b},{c},{d},{e},{f})",{a:e,b:t,c:o,d:n,e:r,f:i}))},e.prototype.beginPath=function(){this._currentDefaultPath="",this._currentPosition={x:0,y:0};var e=this._createElement("path",{},!0);this._closestGroupOrSvg().appendChild(e),this._currentElement=e},e.prototype._applyCurrentDefaultPath=function(){var e=this._currentElement;"path"===(null==e?void 0:e.nodeName)?e.setAttribute("d",this._currentDefaultPath):console.error("Attempted to apply path command to node",null==e?void 0:e.nodeName)},e.prototype._addPathCommand=function(e){this._currentDefaultPath+=" ",this._currentDefaultPath+=e},e.prototype.moveTo=function(e,t){var o;"path"!==(null===(o=this._currentElement)||void 0===o?void 0:o.nodeName)&&this.beginPath(),this._currentPosition={x:e,y:t},this._addPathCommand(v("M {x} {y}",{x:e,y:t}))},e.prototype.closePath=function(){this._currentDefaultPath&&this._addPathCommand("Z")},e.prototype.lineTo=function(e,t){this._currentPosition={x:e,y:t},this._currentDefaultPath.indexOf("M")>-1?this._addPathCommand(v("L {x} {y}",{x:e,y:t})):this._addPathCommand(v("M {x} {y}",{x:e,y:t}))},e.prototype.bezierCurveTo=function(e,t,o,n,r,i){this._currentPosition={x:r,y:i},this._addPathCommand(v("C {cp1x} {cp1y} {cp2x} {cp2y} {x} {y}",{cp1x:e,cp1y:t,cp2x:o,cp2y:n,x:r,y:i}))},e.prototype.quadraticCurveTo=function(e,t,o,n){this._currentPosition={x:o,y:n},this._addPathCommand(v("Q {cpx} {cpy} {x} {y}",{cpx:e,cpy:t,x:o,y:n}))},e.prototype.arcTo=function(e,t,o,n,r){var i=this._currentPosition&&this._currentPosition.x,s=this._currentPosition&&this._currentPosition.y;if(void 0!==i&&void 0!==s){if(r<0)throw new Error("IndexSizeError: The radius provided (".concat(r,") is negative."));if(i===e&&s===t||e===o&&t===n||0===r)this.lineTo(e,t);else{var l=w([i-e,s-t]),c=w([o-e,n-t]);if(l[0]*c[1]!=l[1]*c[0]){var p=l[0]*c[0]+l[1]*c[1],h=Math.acos(Math.abs(p)),d=w([l[0]+c[0],l[1]+c[1]]),u=r/Math.sin(h/2),f=e+u*d[0],g=t+u*d[1],v=[-l[1],l[0]],y=[c[1],-c[0]],x=S(v),m=S(y);this.lineTo(f+v[0]*r,g+v[1]*r),this.arc(f,g,r,x,m)}else this.lineTo(e,t)}}function S(e){var t=(0,a.__read)(e,2),o=t[0];return t[1]>=0?Math.acos(o):-Math.acos(o)}},e.prototype.stroke=function(){var e;"path"===(null===(e=this._currentElement)||void 0===e?void 0:e.nodeName)&&this._currentElement.setAttribute("paint-order","fill stroke markers"),this._applyCurrentDefaultPath(),this._applyStyleToCurrentElement("stroke")},e.prototype.fill=function(){var e;"path"===(null===(e=this._currentElement)||void 0===e?void 0:e.nodeName)&&this._currentElement.setAttribute("paint-order","stroke fill markers"),this._applyCurrentDefaultPath(),this._applyStyleToCurrentElement("fill")},e.prototype.rect=function(e,t,o,n){var r;"path"!==(null===(r=this._currentElement)||void 0===r?void 0:r.nodeName)&&this.beginPath(),this.moveTo(e,t),this.lineTo(e+o,t),this.lineTo(e+o,t+n),this.lineTo(e,t+n),this.lineTo(e,t),this.closePath()},e.prototype.fillRect=function(e,t,o,n){var r=this._createElement("rect",{x:e,y:t,width:o,height:n},!0);this._closestGroupOrSvg().appendChild(r),this._currentElement=r,this._applyStyleToCurrentElement("fill")},e.prototype.strokeRect=function(e,t,o,n){var r=this._createElement("rect",{x:e,y:t,width:o,height:n},!0);this._closestGroupOrSvg().appendChild(r),this._currentElement=r,this._applyStyleToCurrentElement("stroke")},e.prototype._clearCanvas=function(){for(var e=this._closestGroupOrSvg().getAttribute("transform"),t=this._root.childNodes[1],o=t.childNodes,n=o.length-1;n>=0;n--)o[n]&&t.removeChild(o[n]);this._currentElement=t,this._groupStack=[],e&&this._addTransform(e)},e.prototype.clearRect=function(e,t,o,n){if(0!==e||0!==t||o!==this.width||n!==this.height){var r=this._closestGroupOrSvg(),i=this._createElement("rect",{x:e,y:t,width:o,height:n,fill:"#FFFFFF"},!0);r.appendChild(i)}else this._clearCanvas()},e.prototype.createLinearGradient=function(e,t,o,n){var r=this._createElement("linearGradient",{id:y(this._ids),x1:"".concat(e,"px"),x2:"".concat(o,"px"),y1:"".concat(t,"px"),y2:"".concat(n,"px"),gradientUnits:"userSpaceOnUse"},!1);return this._defs.appendChild(r),new C(r,this)},e.prototype.createRadialGradient=function(e,t,o,n,r,i){var a=this._createElement("radialGradient",{id:y(this._ids),cx:"".concat(n,"px"),cy:"".concat(r,"px"),r:"".concat(i,"px"),fx:"".concat(e,"px"),fy:"".concat(t,"px"),gradientUnits:"userSpaceOnUse"},!1);return this._defs.appendChild(a),new C(a,this)},e.prototype._applyText=function(e,t,o,n){var r,i,a=this._closestGroupOrSvg(),s=this._createElement("text",{"font-family":this.fontProp.fontFamily,"font-size":this.fontProp.fontSize,"font-style":this.fontProp.fontStyle,"font-weight":this.fontProp.fontWeight,"letter-spacing":this.fontProp.letterSpacing,"font-scaling":this.fontProp.fontScaling,x:t,y:o,"text-anchor":(r=this.textAlign,i={left:"start",right:"end",center:"middle",start:"start",end:"end"},i[r]||i.start),"dominant-baseline":x(this.textBaseline)},!0);s.innerHTML=this.replaceText(e),this._currentElement=s,this._applyStyleToCurrentElement(n),a.appendChild(s)},e.prototype.replaceText=function(e){return(0,c.escapeHTML)(e).replace(/\s/g,"&nbsp;")},e.prototype.fillText=function(e,t,o){this._applyText(e,t,o,"fill")},e.prototype.strokeText=function(e,t,o){this._applyText(e,t,o,"stroke")},e.prototype.measureText=function(e){return this._ctx.font=this.font,this._ctx.measureText(e)},e.prototype.arc=function(e,t,o,n,r,i){if(n!==r){(n%=2*Math.PI)==(r%=2*Math.PI)&&(r=(r+2*Math.PI-.001*(i?-1:1))%(2*Math.PI));var a=e+o*Math.cos(r),s=t+o*Math.sin(r),l=e+o*Math.cos(n),c=t+o*Math.sin(n),p=i?0:1,h=0,d=r-n;d<0&&(d+=2*Math.PI),h=i?d>Math.PI?0:1:d>Math.PI?1:0,this.lineTo(l,c),this._addPathCommand(v("A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}",{rx:o,ry:o,xAxisRotation:0,largeArcFlag:h,sweepFlag:p,endX:a,endY:s})),this._currentPosition={x:a,y:s}}},e.prototype.clip=function(){if(this._currentElement&&"path"===this._currentElement.nodeName){this._applyCurrentDefaultPath();var e=this._closestGroupOrSvg();e.removeChild(this._currentElement);var t=this._clipPathMap.get(this._currentElement.outerHTML);if(!t){var o=this._createElement("clipPath");t=y(this._ids),o.setAttribute("id",t),o.appendChild(this._currentElement),this._defs.appendChild(o),this._clipPathMap.set(o.innerHTML,t)}e.setAttribute("clip-path",v("url(#{id})",{id:t}));var n=this._createElement("g");e.appendChild(n),this._currentElement=n}},e.prototype.drawImage=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];var n,r,i,s,l,c,p=(0,a.__read)(t,1),h=p[0],d=0,u=0;if(3===t.length)n=t[1],r=t[2],i=l=h.width,s=c=h.height;else if(5===t.length)n=t[1],r=t[2],i=t[3],s=t[4],l=h.width,c=h.height;else{if(9!==t.length)throw new Error("Invalid number of arguments passed to drawImage: ".concat(arguments.length));d=t[1],u=t[2],l=t[3],c=t[4],n=t[5],r=t[6],i=t[7],s=t[8]}var f=this._closestGroupOrSvg(),g="translate(".concat(n,", ").concat(r,")");if(h instanceof e){var v=h.getSvg().cloneNode(!0);if(v.childNodes&&v.childNodes.length>1){for(var y=v.childNodes[0];y.childNodes.length;){var x=y.childNodes[0],w=x.getAttribute("id");w&&(this._ids[w]=w),this._defs.appendChild(x)}var m=v.childNodes[1];if(m){var S=m.getAttribute("transform"),b=void 0;b=S?"".concat(S," ").concat(g):g,m.setAttribute("transform",b),f.appendChild(m)}}}else if("CANVAS"===h.nodeName||"IMG"===h.nodeName){var C=this._createElement("image");if(C.setAttribute("width","".concat(i)),C.setAttribute("height","".concat(s)),C.setAttribute("preserveAspectRatio","none"),d||u||l!==h.width||c!==h.height){var T=this._document.createElement("canvas");if(T){T.width=i,T.height=s;var _=T.getContext("2d");_&&_.drawImage(h,d,u,l,c,0,0,i,s),h=T}}C.setAttribute("transform",g),C.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","CANVAS"===h.nodeName?h.toDataURL():h.getAttribute("src")),f.appendChild(C)}else"image"===h.nodeName&&(h.setAttribute("transform",g),f.appendChild(h))},e.prototype.createPattern=function(t,o){var n,r=this._document.createElementNS("http://www.w3.org/2000/svg","pattern"),i=y(this._ids);return r.setAttribute("id",i),r.setAttribute("width","".concat(t.width)),r.setAttribute("height","".concat(t.height)),"CANVAS"===t.nodeName&&"IMG"===t.nodeName?((n=this._document.createElementNS("http://www.w3.org/2000/svg","image")).setAttribute("width","".concat(t.width)),n.setAttribute("height","".concat(t.height)),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","CANVAS"===t.nodeName?t.toDataURL():t.getAttribute("src")),r.appendChild(n),this._defs.appendChild(r)):t instanceof e&&(r.appendChild(t._root.childNodes[1]),this._defs.appendChild(r)),new b(r,this)},Object.defineProperty(e.prototype,"lineDash",{get:function(){var e;return(null===(e=this._lineDash)||void 0===e?void 0:e.length)>0?this._lineDash.join(","):""},set:function(e){e&&(this._lineDash=e.split(",").map((function(e){return Number(e)})))},enumerable:!1,configurable:!0}),e.prototype.getLineDash=function(){return(0,a.__spreadArray)([],(0,a.__read)(this._lineDash),!1)},e.prototype.setLineDash=function(e){this._lineDash=(0,a.__spreadArray)([],(0,a.__read)(e),!1)},e}(),_=function(){function e(e){this.renderCtx=e}return e.canvasContext=function(e,t){if(!e)return null;if(t===n.Lg.Canvas)return e.getContext("2d");if(t===n.Lg.Svg){var o=e.__context__;return o||(o=new T(e),e.__context__=o),o}return null},e.prototype.clearRenderer=function(e,t,o,n){},e.prototype.render=function(e){var t=this,o=e.collector,n=e.priority,r=e.context;if(o.hasRenderInfo(n)){var i=this.renderingContext2D;if(i){var a=o.renderInfos(n);Object.keys(a).sort().forEach((function(e){var o,n=a[e];0!==n.length&&(t.setContextClipInfo(i,null===(o=n[0].contextState)||void 0===o?void 0:o.clipInfo),t.startRenderViews(i,n),n.forEach((function(e){t.renderView(i,e,r),e.recycle()})),t.finishRenderViews(i,n))}))}}},e.prototype.resetRenderContext=function(e,t){void 0===t&&(t={}),e.fillStyle=t.defultFillStyle||"rgb(0, 0, 0)",e.strokeStyle="rgb(0, 0, 0)",t.defaultFont&&e.font!==t.defaultFont&&(e.font=t.defaultFont),e.lineWidth=1,e.globalAlpha=1},e.prototype.startRenderViews=function(e,t){this.resetRenderContext(e)},e.prototype.finishRenderViews=function(e,t){},e.prototype.setContextClipInfo=function(e,t){var o=this.lastClipInfo;this.needClip(t,o)&&(o&&e.restore(),e.save(),this.lastClipInfo=t,t&&(e.beginPath(),e.rect((0,c.twipsToPx)(t.x),(0,c.twipsToPx)(t.y),(0,c.twipsToPx)(t.width),(0,c.twipsToPx)(t.height)),e.clip())),!t&&o&&(this.lastClipInfo=void 0,e.restore())},e.prototype.needClip=function(e,t){return!(!e||t===e||t&&(0,r.B8I)(e,t))},Object.defineProperty(e.prototype,"renderingContext2D",{get:function(){return e.canvasContext(this.renderCtx.mainView,this.renderCtx.renderDevice)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"contextState",{get:function(){return this.renderCtx.mainCtxState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastClipInfo",{get:function(){return this.contextState.clipInfo},set:function(e){this.contextState.clipInfo=e},enumerable:!1,configurable:!0}),e}(),P=_,R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.computeClippedStyles=function(e,t,o,n){var r,i,a=this.getClipPath(e,o),s=this.props.zoom||1,l=(0,c.twipsToPx)(o?o.width:e.width),p=(0,c.twipsToPx)(e.height),h={overflow:a?"hidden":"visible",top:(0,c.twipsToPx)(e.y+t.y),left:(0,c.twipsToPx)((o?o.x:e.x)+t.x),width:"".concat(l,"px"),height:"".concat(p,"px"),clipPath:a};return"MENTION_QQ"===(null===(i=null===(r=null==n?void 0:n.props)||void 0===r?void 0:r.layoutBox)||void 0===i?void 0:i.subType)&&(h.overflow="visible"),{style:h,marginStyle:{marginTop:0,marginLeft:o?-(0,c.twipsToPx)(Math.abs(o.x-e.x))*s:0}}},t.prototype.updateViewMap=function(e){this.setState({viewMap:new Map((0,a.__spreadArray)([],(0,a.__read)(e),!1).sort((function(e,t){return e[0]-t[0]})))})},t.prototype.getViewMap=function(){var e;return new Map(null===(e=this.state)||void 0===e?void 0:e.viewMap)},t.prototype.render=function(){var e;return l().createElement("div",null,this.componentElements(null===(e=this.state)||void 0===e?void 0:e.viewMap))},t.prototype.getClipPath=function(e,t){if(!t)return"";var o=(0,c.twipsToPx)(t.y-e.y),n=(0,c.twipsToPx)(e.height-t.height),r=(0,c.twipsToPx)(t.x-e.x),i=(0,c.twipsToPx)(e.width-t.width),a="inset(".concat(o,"px 0 ").concat(n-o,"px 0)");return o<.01&&n<.01&&r<.01&&i<.01?void 0:a},t.prototype.componentElement=function(e){var t=e.frame,o=e.content,n=e.offset,i=e.key,s=e.style,c=e.contextState,p=this.computeClippedStyles(t,n,null==c?void 0:c.clipInfo,o),h=p.style,d=p.marginStyle;return l().createElement("div",{key:i,style:(0,a.__assign)((0,a.__assign)({position:"absolute",pointerEvents:this.props.disabled?"none":"auto"},r.vW8.cssPropsToStyle(s)),h)},l().createElement("div",{style:(0,a.__assign)((0,a.__assign)({},d),{height:"100%"})},o))},t.prototype.componentElementLayer=function(e,t){var o=this,n=(0,a.__spreadArray)([],(0,a.__read)(e.values()),!1).map((function(e){return o.componentElement(e)}));return l().createElement("div",{className:"render-priority-".concat(t),key:t},n)},t.prototype.componentElements=function(e){var t=this;if(!e)return[];var o=[];return e.forEach((function(e,n){o.push(t.componentElementLayer(e,n))})),o},t}(l().Component),I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.updateAddonViewOffset=function(e){var t,o,s;if(null===(s=this.state)||void 0===s?void 0:s.viewMap){var l=this.state.viewMap,c=l.get(r._AL.componentElement);if(c){try{for(var p=(0,a.__values)(c),h=p.next();!h.done;h=p.next()){var d=(0,a.__read)(h.value,2),u=d[0],f=d[1],g=f.content.props.layoutBox,v=g.edge.margin,y=g.getAncestorOf(n.uO.Page);if(y&&e.includes(y.getSiblingIndex())){var x=i.MM.getOffsetPoint(g,n.uO.Document),w=x.x,m=x.y;w+=v.left,m+=v.top,f.frame.x=w,f.frame.y=m,c.set(u,f)}}}catch(e){t={error:e}}finally{try{h&&!h.done&&(o=p.return)&&o.call(p)}finally{if(t)throw t.error}}l.set(r._AL.componentElement,c),this.setState({viewMap:l})}}},t.prototype.render=function(){var e,t;return l().createElement("div",null,(null===(e=this.state)||void 0===e?void 0:e.viewMap)?this.addonComponentElements(null===(t=this.state)||void 0===t?void 0:t.viewMap):"")},t.prototype.addonComponentElements=function(e){var t=this,o=e.get(r._AL.componentElement);return o?(0,a.__spreadArray)([],(0,a.__read)(o.values()),!1).map((function(e){return t.componentElement(e)})):[]},t}(R),B=function(e){function t(t){var o=e.call(this,t)||this;return o.pageComponentViewMap=new Map,o.addonViewMap=new Map,o.pageAddonViewMap=new Map,o}return(0,a.__extends)(t,e),t.prototype.render=function(e){var t,o,n=e.collector,r=e.priority,i=e.pageIndex,a=e.lastPageIndex,s=e.isLastRenderPage,l=e.isSubPageRender,c=e.collectRect;if(this.needUpdate=this.updateComponentElement({collector:n,priority:r,pageIndex:i,isSubPageRender:l,collectRect:c})||this.needUpdate,g.nU.getHighestPrioritys()===r){var p=null===(t=this.renderCtx.containerLayer)||void 0===t?void 0:t.rootElements[i],h=null===(o=this.renderCtx.addonViewLayer)||void 0===o?void 0:o.rootElements[0];if(!this.needUpdate)return;if(p instanceof R){var d=this.pageComponentViewMap.get(i);p.updateViewMap(new Map(d))}h instanceof R&&s&&(this.mergeAddonViewMap(a||0),h.updateViewMap(new Map(this.addonViewMap))),this.needUpdate=!1}},t.prototype.updateComponentElement=function(e){var t,o=e.collector,n=e.priority,i=e.behind,a=e.pageIndex,s=e.isSubPageRender,l=e.collectRect,c=o.renderInfos(n),p=Object.keys(c),h=p&&p.length>0?c[p[0]]:[];h=this.getFilteredComponentViews({componentViews:h,behind:i});var d=new Map;if(n===r._AL.componentElement){this.filterAddonComponentViews(h).forEach((function(e){d.has(e.key)||d.set(e.key,e)}));var u=new Map;if(s&&l){var f=null===(t=this.pageAddonViewMap.get(a))||void 0===t?void 0:t.get(n);this.saveReusedViews(d,l,f)}u.set(n,d),this.pageAddonViewMap.set(a,u)}var g=new Map,v=this.getContainerViews({priority:n,pageIndex:a});return null==v||v.forEach((function(e){g.set(e.key,e)})),h.forEach((function(e){d.has(e.key)||g.set(e.key,e)})),this.setContainerViews({priority:n,views:g,pageIndex:a,behind:i}),!0},t.prototype.clearRenderer=function(e,t,o,n){var r=new Map;if(n&&o){var i=this.getContainerViews({pageIndex:t,priority:e});this.saveReusedViews(r,o,i)}this.setContainerViews({priority:e,pageIndex:t,views:r})},t.prototype.getContainerViews=function(e){var t,o=e.priority,n=e.pageIndex;return null===(t=this.pageComponentViewMap.get(n))||void 0===t?void 0:t.get(o)},t.prototype.setContainerViews=function(e){var t,o=e.priority,n=e.views,r=e.pageIndex;if(this.pageComponentViewMap.has(r))null===(t=this.pageComponentViewMap.get(r))||void 0===t||t.set(o,n);else{var i=new Map;i.set(o,n),this.pageComponentViewMap.set(r,i)}},t.prototype.getFilteredComponentViews=function(e){return e.componentViews},t.prototype.saveReusedViews=function(e,t,o){null==o||o.forEach((function(o){var n,i=null===(n=null==o?void 0:o.contextState)||void 0===n?void 0:n.clipInfo,a={x:(i?i.x:o.frame.x)+o.offset.x,y:(i?i.y:o.frame.y)+o.offset.y,width:i?i.width:o.frame.width,height:i?i.height:o.frame.height};(0,r.UHV)((0,r.Aa5)(t,a))||e.set(o.key,o)}))},t.prototype.filterAddonComponentViews=function(e){return e.filter((function(e){var t,o=null===(t=e.content.props)||void 0===t?void 0:t.layoutBox;return(0,n.eJ)(o)&&o.independentRender}))},t.prototype.mergeAddonViewMap=function(e){var t,o,n=new Map;try{for(var i=(0,a.__values)(this.pageAddonViewMap),s=i.next();!s.done;s=i.next()){var l=(0,a.__read)(s.value,2),c=l[0],p=l[1];if(c>e)this.pageAddonViewMap.delete(c);else{var h=p.get(r._AL.componentElement);h&&h.forEach((function(e){n.has(e.key)||n.set(e.key,e)}))}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(t)throw t.error}}this.setAddonViews({priority:r._AL.componentElement,views:n})},t.prototype.setAddonViews=function(e){var t=e.priority,o=e.views;this.addonViewMap.set(t,o)},t.prototype.renderView=function(e,t){throw new Error("Method not implemented.")},t}(P),E=B,M=o(53211),L=o.n(M),O=function(e){var t=e.views,o=e.componentElement,n=(0,a.__spreadArray)([],(0,a.__read)(t.values()),!1)[0];if(!n||!n.pagesInfo)return l().createElement(l().Fragment,null);var r=n.pagesInfo,i=r.pageSize,s=r.pageIndex,c=[];t.forEach((function(e){var t=o(e);c.push(t)}));var p=function(e,t,o){return l().createElement("div",{key:o,style:{width:"".concat(t.width,"px"),height:"".concat(t.height,"px"),background:"rgba(0, 0, 0, 0)",position:"relative",pointerEvents:"none"}},e)}(c,i,"page-container-".concat(s));return l().createElement("div",{style:{position:"absolute",pointerEvents:"none"}},p)};O.propTypes={views:L().instanceOf(Map).isRequired,componentElement:L().func.isRequired};var A,k,V=O,F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.componentElementLayer=function(e){return l().createElement(V,{views:e,componentElement:this.componentElement.bind(this)})},t.prototype.render=function(){var e;return l().createElement(l().Fragment,null,l().createElement("div",null,this.componentElements(null===(e=this.state)||void 0===e?void 0:e.viewMap)))},t}(R),z=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pageUpperViewMap=new Map,t.pageLowerViewMap=new Map,t}return(0,a.__extends)(t,e),t.prototype.getContainerViews=function(e){var t,o,n=e.priority,r=e.behind,i=e.pageIndex;return r?null===(t=this.pageLowerViewMap.get(i))||void 0===t?void 0:t.get(n):null===(o=this.pageUpperViewMap.get(i))||void 0===o?void 0:o.get(n)},t.prototype.setContainerViews=function(e){var t,o=e.priority,n=e.views,r=e.behind,i=e.pageIndex,a=r?this.pageLowerViewMap:this.pageUpperViewMap;if(a.has(i))null===(t=a.get(i))||void 0===t||t.set(o,n);else{var s=new Map;s.set(o,n),a.set(i,s)}},t.prototype.getFilteredComponentViews=function(e){var t=e.componentViews,o=e.behind;return t.filter((function(e){return Boolean(e.behindDoc)===Boolean(o)}))},t.prototype.updateComponentElement=function(t){return t.priority===r.Ypk.UpperDefault&&e.prototype.updateComponentElement.call(this,t)},t.prototype.render=function(e){var t,o,n=e.collector,r=e.priority,i=e.pageIndex;this.needUpdateUpper=this.updateComponentElement({pageIndex:i,collector:n,priority:r})||this.needUpdateUpper,this.needUpdateLower=this.updateComponentElement({pageIndex:i,collector:n,priority:r,behind:!0})||this.needUpdateLower;var a=null===(t=this.renderCtx.upperAnchorLayer)||void 0===t?void 0:t.rootElements[i],s=null===(o=this.renderCtx.lowerAnchorLayer)||void 0===o?void 0:o.rootElements[i];if(a instanceof F&&this.needUpdateUpper){var l=this.pageUpperViewMap.get(i);a.updateViewMap(new Map(l)),this.needUpdateUpper=!1}if(s instanceof F&&this.needUpdateLower){var c=this.pageLowerViewMap.get(i);s.updateViewMap(new Map(c)),this.needUpdateLower=!1}},t}(E),D=z,W=function(){function e(){}return e.canvasScaleRatio=function(e){return(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)},e}(),H=function(){function e(e,t,o,n){void 0===n&&(n=1),this.width=e,this.style=t,this.color=o,this.opacity=n}return e.newInstance=function(t){var o=t.style,n=t.width,r=t.color,i=t.opacity,a=this.pool.shift(),s="";return(null==r?void 0:r.hex)?s=r.hex:(null==r?void 0:r.rgba)&&(s="rgba(".concat(null==r?void 0:r.rgba.red,",").concat(null==r?void 0:r.rgba.green,",").concat(null==r?void 0:r.rgba.blue,",").concat(null==r?void 0:r.rgba.alpha,")")),a?(a.width=n,a.style=o,a.color=s,a.opacity=i||1):a=new e(n,o,s,i),a},e.destroyInstance=function(e){this.pool.push(e)},e.prototype.getDashSegments=function(e){var t;switch(this.style){case n.TD.dotted:t=[1,1];break;case n.TD.dashed:t=[3.75,3.75];break;case n.TD.dotDash:t=[6,2,2,2];break;case n.TD.dotDotDash:t=[5,2,1.5,2,1.5,2];break;case n.TD.dashSmallGap:t=[4,1];break;default:t=[]}var o=[];return t.forEach((function(t){o.push(t*e)})),o},e.prototype.getStyle=function(){return this.style},e.prototype.getWidth=function(){return this.width},e.prototype.getColor=function(){return this.color},e.prototype.getOpacity=function(){return this.opacity},e.pool=[],e}(),j=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.startRenderViews=function(t,o){var n;e.prototype.startRenderViews.call(this,t,o),t.globalAlpha=null!==(n=o[0].lineProp.opacity)&&void 0!==n?n:1},t.prototype.renderView=function(e,t){var o=H.newInstance(t.lineProp),r=t.line;if(t.lineProp.style===n.TD.double)this.drawLine({ctx:e,line:r,lineProp:o,nOffsetY:-1}),this.drawLine({ctx:e,line:r,lineProp:o,nOffsetY:1});else if(t.lineProp.style===n.TD.triple)this.drawLine({ctx:e,line:r,lineProp:o,nOffsetY:-2}),this.drawLine({ctx:e,line:r,lineProp:o}),this.drawLine({ctx:e,line:r,lineProp:o,nOffsetY:2});else if(t.lineProp.style===n.TD.wave)this.drawWave({ctx:e,line:r,lineProp:o,yPx:(0,c.twipsToPx)(r.start.y)});else if(t.lineProp.style===n.TD.doubleWave)this.drawWave({ctx:e,line:r,lineProp:o,yPx:(0,c.twipsToPx)(r.start.y-1.5*o.getWidth())}),this.drawWave({ctx:e,line:r,lineProp:o,yPx:(0,c.twipsToPx)(r.start.y+1.5*o.getWidth())});else if(t.lineProp.style===n.TD.thinThickSmallGap)this.drawLine({ctx:e,line:r,lineProp:o,nOffsetY:-1,nWidth:2}),this.drawLine({ctx:e,line:r,lineProp:o,nOffsetY:1.35,nWidth:.7});else if(t.lineProp.style===n.TD.thickThinSmallGap)this.drawLine({ctx:e,line:r,lineProp:o,nOffsetY:-1,nWidth:.7}),this.drawLine({ctx:e,line:r,lineProp:o,nOffsetY:1.35,nWidth:2});else if(t.lineProp.style===n.TD.thinThickThinSmallGap)this.drawLine({ctx:e,line:r,lineProp:o,nWidth:.7,nOffsetY:-2}),this.drawLine({ctx:e,line:r,lineProp:o,nWidth:2,nOffsetY:.35}),this.drawLine({ctx:e,line:r,lineProp:o,nWidth:.7,nOffsetY:2.7});else if(t.lineProp.style===n.TD.thinThickMediumGap)this.drawLine({ctx:e,line:r,lineProp:o,nWidth:1.33,nOffsetY:-1}),this.drawLine({ctx:e,line:r,lineProp:o,nWidth:.7,nOffsetY:1});else if(t.lineProp.style===n.TD.thickThinMediumGap)this.drawLine({ctx:e,line:r,lineProp:o,nWidth:.7,nOffsetY:-1}),this.drawLine({ctx:e,line:r,lineProp:o,nWidth:1.33,nOffsetY:1});else if(t.lineProp.style===n.TD.thinThickThinMediumGap)this.drawLine({ctx:e,line:r,lineProp:o,nWidth:.7,nOffsetY:-2}),this.drawLine({ctx:e,line:r,lineProp:o,nWidth:1.33}),this.drawLine({ctx:e,line:r,lineProp:o,nWidth:.7,nOffsetY:2});else if(t.lineProp.style===n.TD.thinThickLargeGap)this.drawLine({ctx:e,line:r,lineProp:o,nOffsetY:-1.5,nWidth:1.75}),this.drawLine({ctx:e,line:r,lineProp:o,nOffsetY:1.85});else if(t.lineProp.style===n.TD.thickThinLargeGap)this.drawLine({ctx:e,line:r,lineProp:o,nOffsetY:-1.5}),this.drawLine({ctx:e,line:r,lineProp:o,nWidth:1.75,nOffsetY:1.85});else if(t.lineProp.style===n.TD.thinThickThinLargeGap)this.drawLine({ctx:e,line:r,lineProp:o,nOffsetY:-3}),this.drawLine({ctx:e,line:r,lineProp:o,nWidth:1.75,nOffsetY:.35}),this.drawLine({ctx:e,line:r,lineProp:o,nOffsetY:3.7});else if(t.lineProp.style===n.TD.inset)this.drawLine({ctx:e,line:r,lineProp:o,nWidth:1.33});else if(t.lineProp.style===n.TD.outset)this.drawLine({ctx:e,line:r,lineProp:o,nWidth:1.33,nOffsetY:2.3});else if(t.lineProp.style===n.TD.threeDEmboss){var i=this.getThreeStepColor(o.getColor());this.drawLine({ctx:e,line:r,lineProp:o,nWidth:1,nOffsetY:-1.5,color:i[0]}),this.drawLine({ctx:e,line:r,lineProp:o,nWidth:2,color:i[1]}),this.drawLine({ctx:e,line:r,lineProp:o,nWidth:1,nOffsetY:1.5,color:i[2]})}else t.lineProp.style===n.TD.threeDEngrave?(i=this.getThreeStepColor(o.getColor()),this.drawLine({ctx:e,line:r,lineProp:o,nWidth:1,nOffsetY:-1.5,color:i[2]}),this.drawLine({ctx:e,line:r,lineProp:o,nWidth:2,color:i[1]}),this.drawLine({ctx:e,line:r,lineProp:o,nWidth:1,nOffsetY:1.5,color:i[0]})):t.lineProp.style===n.TD.dashDotStroked?this.drawDashDotStrokeLine({ctx:e,line:r,lineProp:o}):this.drawLine({ctx:e,line:r,lineProp:o,nWidth:1.33})},t.prototype.drawLine=function(e){var t=e.ctx,o=e.line,n=e.lineProp,r=e.nOffsetY,i=void 0===r?0:r,a=e.nWidth,s=void 0===a?1:a,l=e.color,p=.75*(0,c.twipsToPx)(n.getWidth());t.lineWidth=p*s,t.setLineDash(n.getDashSegments(t.lineWidth)),t.beginPath();var h=o.start,d=o.end,u=(0,c.twipsToPx)(h.x),f=(0,c.twipsToPx)(h.y)+i*p,g=(0,c.twipsToPx)(d.x),v=(0,c.twipsToPx)(d.y)+i*p;t.strokeStyle=null!=l?l:n.getColor(),t.moveTo(u,f),t.lineTo(g,v),t.stroke()},t.prototype.getThreeStepColor=function(e){var t=function(e,t){var o=e;"#"===o[0]&&(o=o.slice(1));var n=parseInt(o,16),r=function(e){var t=Math.floor(e),o=Math.min(Math.max(t,0),255).toString(16);return 1===o.length?"0".concat(o):o},i=r((n>>16)*(3-t)/3),a=r((n>>8&255)*(3-t)/3),s=r((255&n)*(3-t)/3);return"#".concat(i).concat(a).concat(s)},o=e;return function(e){var t=e;"#"===t[0]&&(t=t.slice(1));var o=parseInt(t,16);return o>>16<50&&(o>>8&255)<50&&(255&o)<50}(o)&&(o="#c0c0c0"),[t(o,0),t(o,1),t(o,2)]},t.prototype.drawWave=function(e){var t=e.ctx,o=e.line,n=e.lineProp,r=e.yPx,i=(0,c.twipsToPx)(n.getWidth());t.save(),t.beginPath(),t.lineCap="round",t.strokeStyle=n.getColor(),t.lineWidth=i;for(var a=10*t.lineWidth,s=Math.ceil(((0,c.twipsToPx)(o.end.x)-(0,c.twipsToPx)(o.start.x))/a),l=0;l<s;l++){var p=(0,c.twipsToPx)(o.start.x)+a*l,h=r;0===l&&t.moveTo(p,h+1.5*i),t.lineTo(p+3*i,h-1.5*i),t.quadraticCurveTo(p+4*i,h-2.5*i,p+5*i,h-1.5*i),t.lineTo(p+8*i,h+1.5*i),t.quadraticCurveTo(p+9*i,h+2.5*i,p+10*i,h+1.5*i)}t.stroke(),t.restore()},t.prototype.drawDashDotStrokeLine=function(e){var t=e.ctx,o=e.line,n=e.lineProp,r=(0,c.twipsToPx)(n.getWidth()),i=(0,c.twipsToPx)(o.start.x),a=(0,c.twipsToPx)(o.end.x),s=(0,c.twipsToPx)(o.start.y);t.save();var l=document.createElement("canvas"),p=l.getContext("2d");l.width=6*r,l.height=4*r,p.fillStyle=n.getColor(),p.fillRect(0,0,4*l.width/6,l.height),p.lineWidth=r,p.strokeStyle=n.getColor(),p.moveTo(5*r,0),p.lineTo(5*r,l.height),p.stroke();var h=t.createPattern(l,"repeat");h.setTransform(new DOMMatrix([1,1,-.7,1,0,0])),t.fillStyle=h,t.fillRect(i,s-l.height/2,a-i,l.height),t.restore()},t}(P),N=j,G=100,Y=function(e){function t(t,o){var n=e.call(this)||this;return n.frame=t,n.contextState=o,n}return(0,a.__extends)(t,e),t.prototype.hash=function(){var e,t=this.constructor.name,o=null===(e=this.contextState)||void 0===e?void 0:e.clipInfo;return o&&(t+="-clipInfo-".concat(o.x,"-").concat(o.y,"-").concat(o.width,"-").concat(o.height)),t},Object.defineProperty(t.prototype,"offset",{get:function(){return this._offset?this._offset:{x:0,y:0}},set:function(e){this._offset=e},enumerable:!1,configurable:!0}),t}(c.PoolNode),U=function(e){function t(t,o,n,r,i){var a=e.call(this,t,i)||this;return a.frame=t,a.text=o,a.textInfo=n,a.textProps=r,a.contextState=i,a}var o,i,s,l,p;return(0,a.__extends)(t,e),o=t,t.prototype.hash=function(){var t,o="".concat(e.prototype.hash.call(this),"-").concat(r.vW8.styleHash(this.textProps)||e.prototype.hash.call(this)),n=null===(t=this.contextState)||void 0===t?void 0:t.textTransform;return n&&(o+="-transform-".concat(n.scaleX,"-").concat(n.rotateX,"-").concat(n.rotateY,"-").concat(n.scaleY,"-").concat(n.translateX,"-").concat(n.translateY)),o},t.obtain=function(e,t,n,r,i){var a=o.sPool.obtain();return a?(a.frame=e,a.text=t,a.textInfo=n,a.textProps=r,a.contextState=i):a=new o(e,t,n,r,i),a},t.prototype.recycle=function(){o.sPool.recycle(this)},t.percentToPoint=function(e){var t=e.replace("%","");return Number(t)/100},t.sPool=new c.ObjectPool(G),t=o=(0,a.__decorate)([(0,g.B7)(n.mu),(0,a.__metadata)("design:paramtypes",["function"==typeof(i=void 0!==n.IRect&&n.IRect)?i:Object,String,"function"==typeof(s=void 0!==n.ITextInfo&&n.ITextInfo)?s:Object,"function"==typeof(l=void 0!==r.CssProperties&&r.CssProperties)?l:Object,"function"==typeof(p=void 0!==n.IContextState&&n.IContextState)?p:Object])],t)}(Y),X=o(95303),q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.renderView=function(e,t){var o,n=this,r=t.textProps,i="string"==typeof r.letterSpacing?Number.parseFloat(r.letterSpacing):r.letterSpacing,s=U.percentToPoint(null!==(o=t.textProps.fontScaling)&&void 0!==o?o:"".concat(100,"%"));if(i&&0!==(0,c.ptToTwips)(i)){var l=t.frame.x;new X.UnicodeString(t.text).getAllGraphemes().forEach((function(o){var r=o.toString(),p=(0,c.pxToTwips)(e.measureText(r).width*s)+(0,c.ptToTwips)(i),h=U.obtain((0,a.__assign)((0,a.__assign)({},t.frame),{x:l,width:p}),r,t.textInfo,t.textProps,t.contextState);n.renderTextAll(e,h),l+=p>0?p:0}))}else this.renderTextAll(e,t)},t.prototype.startRenderViews=function(e,t){var o,n,r,i,a,s=t[0].textProps;this.resetRenderContext(e,{defaultFont:"".concat(s.fontStyle," ").concat(s.fontWeight," ").concat(s.fontSize," ").concat(f.keb.fontFamily)}),s.color&&(e.fillStyle=s.color,e.strokeStyle=s.color);var l="".concat(s.fontStyle," ").concat(s.fontWeight," ").concat(s.fontSize," ").concat(null!==(n=null===(o=s.fontFamily)||void 0===o?void 0:o.stringValue)&&void 0!==n?n:"");e.font!==l&&(e.font=l),e instanceof T&&(e.fontProp={fontStyle:s.fontStyle,fontWeight:s.fontWeight,fontSize:s.fontSize,fontFamily:null!==(i=null===(r=s.fontFamily)||void 0===r?void 0:r.stringValue)&&void 0!==i?i:"",letterSpacing:s.letterSpacing,fontScaling:s.fontScaling});var p=this.getLineWidth(parseInt("".concat(s.fontSize),10));p&&(e.lineWidth=Math.max(1,p)),void 0!==s.opacity&&(e.globalAlpha=s.opacity);var h=null===(a=t[0].contextState)||void 0===a?void 0:a.textTransform;h&&(e.save(),e.transform(h.scaleX,h.rotateX,h.rotateY,h.scaleY,(0,c.twipsToPx)(h.translateX),(0,c.twipsToPx)(h.translateY)))},t.prototype.finishRenderViews=function(e,t){var o;(null===(o=t[0].contextState)||void 0===o?void 0:o.textTransform)&&e.restore()},t.prototype.getLineWidth=function(e){return e?Math.round(e/15):0},t.prototype.renderTextAll=function(e,t){this.renderText(e,t),this.renderUnderlineAndStrikethrough(e,t)},t.prototype.renderText=function(e,t){var o,n=U.percentToPoint(null!==(o=t.textProps.fontScaling)&&void 0!==o?o:"".concat(100,"%"));1===n?e.fillText(t.text,(0,c.twipsToPx)(t.frame.x),(0,c.twipsToPx)(t.frame.y)):(e.save(),e.transform(n,0,0,1,(0,c.twipsToPx)(t.frame.x)*(1-n),0),e.fillText(t.text,(0,c.twipsToPx)(t.frame.x),(0,c.twipsToPx)(t.frame.y)),e.restore())},t.prototype.renderUnderlineAndStrikethrough=function(e,t){var o=t.textProps,n=t.textInfo,r=t.frame,i=this.getUnderlineInfo(o);(null==i?void 0:i.show)&&this.renderUnderline(e,r,null==i?void 0:i.color);var a=this.getStrikeThroughInfo(o,n.diffThrough,n.isTaskDone);(null==a?void 0:a.show)&&this.renderStrikethroughline(e,r,null==a?void 0:a.color)},t.prototype.renderUnderline=function(e,t,o){var n=Math.round(t.height/8),i={line:(0,r.L9X)(t.x,t.y+n,t.x+t.width,t.y+n),color:o};this.renderLine(e,i)},t.prototype.renderStrikethroughline=function(e,t,o){var n=Math.round(t.height/4),i={line:(0,r.L9X)(t.x,t.y-n,t.x+t.width,t.y-n),color:o};this.renderLine(e,i)},t.prototype.renderLine=function(e,t){t.color&&(e.strokeStyle=t.color),e.beginPath(),e.moveTo((0,c.twipsToPx)(t.line.start.x),(0,c.twipsToPx)(t.line.start.y)),e.lineTo((0,c.twipsToPx)(t.line.end.x),(0,c.twipsToPx)(t.line.end.y)),e.stroke()},t.prototype.getUnderlineInfo=function(e){if(e.textDecoration&&e.textDecoration.indexOf("underline")>=0)return{show:!0,color:e.textDecorationColor&&"auto"!==e.textDecorationColor?e.textDecorationColor:e.color}},t.prototype.getStrikeThroughInfo=function(e,t,o){if(e.textDecoration&&e.textDecoration.indexOf("line-through")>=0||t||o)return{show:!0,color:o?"rgba(0,0,0,0.3)":e.color}},t}(P),K=q,J=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.resetRenderContext=function(t){e.prototype.resetRenderContext.call(this,t,{defultFillStyle:"rgba(0, 0, 0, 0)"})},t.prototype.renderView=function(e,t){var o=t.path,n=t.frame,r=t.color,i=t.isFill;if(o.points.length>0){var s=(0,a.__read)(o.points,1)[0];e.beginPath(),e.moveTo((0,c.twipsToPx)(s.x+n.x),(0,c.twipsToPx)(s.y+n.y));for(var l=1;l<o.points.length;l++){var p=o.points[l];e.lineTo((0,c.twipsToPx)(p.x+n.x),(0,c.twipsToPx)(p.y+n.y))}i?(e.fillStyle=r,e.fill()):(e.strokeStyle=r,e.stroke()),e.closePath()}},t.prototype.startRenderViews=function(t,o){e.prototype.startRenderViews.call(this,t,o);var n=o[0].color;t.fillStyle=n&&"initial"!==n?n:"rgba(0, 0, 0, 0)"},t}(P),Z=J,Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.renderView=function(e,t){void 0!==t.dstSize&&void 0!==t.srcPos&&void 0!==t.srcSize?e.drawImage(t.image,(0,c.twipsToPx)(t.dstPos.x),(0,c.twipsToPx)(t.dstPos.y),(0,c.twipsToPx)(t.dstSize.width),(0,c.twipsToPx)(t.dstSize.height),(0,c.twipsToPx)(t.srcPos.x),(0,c.twipsToPx)(t.srcPos.y),(0,c.twipsToPx)(t.srcSize.width),(0,c.twipsToPx)(t.srcSize.height)):void 0!==t.dstSize?e.drawImage(t.image,(0,c.twipsToPx)(t.dstPos.x),(0,c.twipsToPx)(t.dstPos.y),(0,c.twipsToPx)(t.dstSize.width),(0,c.twipsToPx)(t.dstSize.height)):e.drawImage(t.image,(0,c.twipsToPx)(t.dstPos.x),(0,c.twipsToPx)(t.dstPos.y))},t}(P),$=Q,ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.startRenderViews=function(t,o){e.prototype.startRenderViews.call(this,t,o);var n=o[0].roundRectProp;t.lineWidth=n.borderWidth||1,n.fillColor&&(t.fillStyle=n.fillColor),n.strokeColor&&(t.strokeStyle=n.strokeColor),void 0!==n.opacity&&(t.globalAlpha=n.opacity)},t.prototype.renderView=function(e,t){var o=t.frame,n=t.roundRectProp,r=n.radius,i=[(0,c.twipsToPx)(o.x)+r,(0,c.twipsToPx)(o.y)],a=[(0,c.twipsToPx)(o.x+o.width),(0,c.twipsToPx)(o.y)],s=[(0,c.twipsToPx)(o.x+o.width),(0,c.twipsToPx)(o.y+o.height)],l=[(0,c.twipsToPx)(o.x),(0,c.twipsToPx)(o.y+o.height)],p=[(0,c.twipsToPx)(o.x),(0,c.twipsToPx)(o.y)];e.beginPath(),e.moveTo(i[0],i[1]),e.arcTo(a[0],a[1],s[0],s[1],r),e.arcTo(s[0],s[1],l[0],l[1],r),e.arcTo(l[0],l[1],p[0],p[1],r),e.arcTo(p[0],p[1],i[0],i[1],r),n.strokeColor&&e.stroke(),n.shadowInfo&&(n.shadowInfo.shadowColor&&(e.shadowColor=n.shadowInfo.shadowColor),n.shadowInfo.shadowOffsetX&&(e.shadowOffsetX=n.shadowInfo.shadowOffsetX),n.shadowInfo.shadowOffsetY&&(e.shadowOffsetY=n.shadowInfo.shadowOffsetY),n.shadowInfo.shadowBlur&&(e.shadowBlur=n.shadowInfo.shadowBlur),e.stroke(),e.shadowColor="",e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=0);var h=n.image;if(h&&this.isUsableImage(h))try{e.drawImage(h,(0,c.twipsToPx)(o.x),(0,c.twipsToPx)(o.y),(0,c.twipsToPx)(o.width),(0,c.twipsToPx)(o.height))}catch(e){c.Logger.error(e)}else n.fillColor&&e.fill()},t.prototype.isUsableImage=function(e){return!(e instanceof HTMLImageElement)||Boolean(e.complete&&e.naturalHeight&&e.naturalWidth)},t}(P),te=ee,oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.resetRenderContext=function(t){e.prototype.resetRenderContext.call(this,t,{defultFillStyle:"rgba(0, 0, 0, 0)"})},t.prototype.startRenderViews=function(t,o){var n;e.prototype.startRenderViews.call(this,t,o);var r=o[0].roundRectProp.fillColor;t.fillStyle=r&&"initial"!==r?r:"rgba(0, 0, 0, 0)";var i=null===(n=o[0].contextState)||void 0===n?void 0:n.textTransform;i&&(t.save(),t.transform(i.scaleX,i.rotateX,i.rotateY,i.scaleY,(0,c.twipsToPx)(i.translateX),(0,c.twipsToPx)(i.translateY)))},t.prototype.finishRenderViews=function(e,t){var o;(null===(o=t[0].contextState)||void 0===o?void 0:o.textTransform)&&e.restore()},t}(te),ne=oe;!function(e){e[e.GraphicsRender=0]="GraphicsRender",e[e.DrawingRender=1]="DrawingRender",e[e.RoundRectRenderer=2]="RoundRectRenderer",e[e.LineRenderer=3]="LineRenderer",e[e.TextRenderer=4]="TextRenderer",e[e.BitmapRenderer=5]="BitmapRenderer",e[e.ComponentRenderer=6]="ComponentRenderer",e[e.AnchorRenderer=7]="AnchorRenderer",e[e.OverlayRenderer=8]="OverlayRenderer"}(k||(k={}));var re,ie=((A={})[k.GraphicsRender]=0,A[k.DrawingRender]=0,A[k.RoundRectRenderer]=10,A[k.OverlayRenderer]=20,A[k.TextRenderer]=30,A[k.LineRenderer]=40,A[k.BitmapRenderer]=50,A[k.ComponentRenderer]=60,A);!function(e){e[e.Line=0]="Line",e[e.Text=1]="Text",e[e.Graphics=2]="Graphics",e[e.Drawing=3]="Drawing",e[e.Container=4]="Container",e[e.Bitmap=5]="Bitmap",e[e.RoundRect=6]="RoundRect",e[e.Overlay=7]="Overlay",e[e.Component=8]="Component",e[e.Anchor=9]="Anchor"}(re||(re={}));var ae,se=o(27623),le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.renderObjectType=function(){return re.Graphics},t.prototype.renderView=function(e,t,o){var n;return(0,a.__awaiter)(this,void 0,void 0,(function(){var r,i,s,l,p,h,d,u,f,g,v,y,x,w,m,S;return(0,a.__generator)(this,(function(b){switch(b.label){case 0:r=t.path,i=t.drawingFrame,s=t.fillStyle,l=t.strokeStyle,p=t.filter,h=t.effectExtent,d=t.placeholderImageSrc,u=t.containerWidth,f=t.containerHeight,g=window.devicePixelRatio;try{g=e.getTransform().a}catch(e){}return v=g/Math.ceil(window.devicePixelRatio),y={frame:(0,a.__assign)((0,a.__assign)({},i),{left:(0,c.twipsToPx)(i.left)*v,top:(0,c.twipsToPx)(i.top)*v,width:(0,c.twipsToPx)(i.width)*v,height:(0,c.twipsToPx)(i.height)*v}),path:r,fillStyle:s,strokeStyle:l,filter:p},u=(0,c.twipsToPx)(null!=u?u:i.width)*v,f=(0,c.twipsToPx)(null!=f?f:i.height)*v,e instanceof T?(this.renderDrawingSvg(y,e,h,u,f),[3,3]):[3,1];case 1:return(x=new se.TC(y)).isImageLoaded?(e.save(),x.syncRender(e),e.restore(),[2]):(d&&(w=(0,c.deepClone)(y),(null==(m=null===(n=w.fillStyle)||void 0===n?void 0:n.imageFill)?void 0:m.src)&&(m.src=d,S=new se.TC(w),this.renderGraphics(e,S,o))),[4,this.renderGraphics(e,x,o)]);case 2:b.sent(),b.label=3;case 3:return[2]}}))}))},t.prototype.renderDrawingSvg=function(e,t,o,n,r){var i=o.l,s=o.r,l=o.t,p=o.b;i=Math.max(i,0),s=Math.max(s,0),l=Math.max(l,0),p=Math.max(p,0);var h=2*(0,c.emuToPx)(l),d=2*(0,c.emuToPx)(i),u=2*(0,c.emuToPx)(p),f=2*(0,c.emuToPx)(s),g=(0,a.__assign)((0,a.__assign)({},e.frame),{left:(n-e.frame.width)/2+d,top:(r-e.frame.height)/2+h}),v=(0,a.__assign)((0,a.__assign)({},e),{frame:g}),y=e.frame,x=y.left,w=y.top,m=new se.TC(v),S=document.createElement("canvas"),b=S.getContext("2d");S.width=(n+d+f)*window.devicePixelRatio,S.height=(r+h+u)*window.devicePixelRatio,document.body.appendChild(S),b&&(m.syncRender(b),t.drawImage(S,x-(n-e.frame.width)/2-d,w-(r-e.frame.height)/2-h,S.width/window.devicePixelRatio,S.height/window.devicePixelRatio))},t.prototype.renderGraphics=function(e,t,o){return(0,a.__awaiter)(this,void 0,void 0,(function(){return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return e.save(),t.syncRender(e),e.restore(),t.isImageLoaded?[3,2]:[4,t.promiseImageLoaded()];case 1:n.sent(),o.fire(new r.kv7(!1)),n.label=2;case 2:return[2]}}))}))},t}(P),ce=le,pe=function(){function e(e){this.renders=new Map,this._renderCtx=e,this.renders.set(re.Line,new N(this._renderCtx)),this.renders.set(re.Text,new K(this._renderCtx)),this.renders.set(re.Graphics,new Z(this._renderCtx)),this.renders.set(re.Drawing,new ce(this._renderCtx)),this.renders.set(re.Bitmap,new $(this._renderCtx)),this.renders.set(re.RoundRect,new te(this._renderCtx)),this.renders.set(re.Component,new E(this._renderCtx)),this.renders.set(re.Overlay,new ne(this._renderCtx)),this.renders.set(re.Anchor,new D(this._renderCtx))}return e.prototype.resetCanvasNode=function(e){this._renderCtx.mainView=e},e.prototype.render=function(e,t){var o=this;g.nU.getRenderPrioritys().forEach((function(n){o.renderOnPriority(e,n,t)})),this.resetContextState()},e.prototype.clearComponentView=function(e){var t=g.nU.getRenderPrioritys(),o=this.renders.get(re.Component),n=this.renders.get(re.Anchor);t.forEach((function(t){null==o||o.clearRenderer(t,e),null==n||n.clearRenderer(t,e)}))},e.prototype.renderOnPriority=function(e,t,o){var n=this,r=o.subPageIndex,i=o.options,a=o.pageIndex,s=o.collectRect,l=o.lastPageIndex,c=o.isLastRenderPage,p=o.context,h=void 0!==r;e.forEach((function(e){var o=n.renders.get(e.renderObjectType());i.documentUpdated&&(null==o||o.clearRenderer(t,a,s,h)),null==o||o.render({collector:e,priority:t,context:p,pageIndex:a,lastPageIndex:l,isLastRenderPage:c,isSubPageRender:h,collectRect:s})}))},e.prototype.resetContextState=function(){if(this._renderCtx.mainCtxState.clipInfo||this._renderCtx.mainCtxState.textTransform){var e=P.canvasContext(this._renderCtx.mainView,this._renderCtx.renderDevice);e&&e.restore(),this._renderCtx.mainCtxState.clipInfo=void 0,this._renderCtx.mainCtxState.textTransform=void 0}},e}(),he=function(){function e(e){this.level=e,this.renderInfoMap=new Map}return Object.defineProperty(e.prototype,"infoMap",{get:function(){return this.renderInfoMap},enumerable:!1,configurable:!0}),e.prototype.compare=function(e){return this.level>e.level?1:-1},e.prototype.hasRenderInfo=function(e){var t=this.renderInfoMap.get(e);return!!t&&Object.keys(t).length>0},e.prototype.renderInfos=function(e){var t=this.renderInfoMap.get(e);return t||(t={},this.renderInfoMap.set(e,t)),t},e.prototype.collect=function(e,t){void 0===t&&(t=r.Ypk.UpperDefault);var o=this.renderInfos(t),n=e.hash();Object.prototype.hasOwnProperty.call(o,n)||(o[n]=[]),o[n].push(e)},e.prototype.clear=function(){this.renderInfoMap.clear()},e}(),de=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._propsMap=new Map,t}return(0,a.__extends)(t,e),Object.defineProperty(t.prototype,"propsMap",{get:function(){return this._propsMap},enumerable:!1,configurable:!0}),t.prototype.collect=function(e,t){void 0===t&&(t=r._AL.mainText);var o=this.renderInfos(t),n=e.hash();Object.prototype.hasOwnProperty.call(o,n)||(o[n]=[],this._propsMap.set(n,e.textProps)),o[n].push(e)},t.prototype.renderObjectType=function(){return re.Text},t}(he),ue=de,fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.collect=function(t,o){t.lineProp.style!==n.TD.none&&e.prototype.collect.call(this,t,o)},t.prototype.renderObjectType=function(){return re.Line},t}(he),ge=fe,ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.collect=function(t,o){e.prototype.collect.call(this,t,o)},t.prototype.renderObjectType=function(){return re.Graphics},t}(he),ye=ve,xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.collect=function(t,o){e.prototype.collect.call(this,t,o)},t.prototype.renderObjectType=function(){return re.Bitmap},t}(he),we=xe,me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.collect=function(t,o){e.prototype.collect.call(this,t,o)},t.prototype.renderObjectType=function(){return re.RoundRect},t}(he),Se=me,be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.collect=function(t,o){e.prototype.collect.call(this,t,o)},t.prototype.renderObjectType=function(){return re.Component},t}(he),Ce=be,Te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.collect=function(t,o){e.prototype.collect.call(this,t,o)},t.prototype.renderObjectType=function(){return re.Overlay},t}(he),_e=Te,Pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.renderObjectType=function(){return re.Anchor},t.prototype.collect=function(t,o){e.prototype.collect.call(this,t,o)},t}(he),Re=Pe,Ie=function(e){function t(t,o,n,r,i,a){var s=e.call(this,{x:o.x,y:o.y,width:(null==n?void 0:n.width)||0,height:(null==n?void 0:n.height)||0},a)||this;return s.image=t,s.dstPos=o,s.dstSize=n,s.srcPos=r,s.srcSize=i,s.contextState=a,s}var o,r,i,s,l,p,h;return(0,a.__extends)(t,e),o=t,t.obtain=function(e,t,n,r,i,a){var s=o.sPool.obtain();return s?(s.image=e,s.dstPos=t,s.dstSize=n,s.srcPos=r,s.srcSize=i,s.contextState=a):s=new o(e,t,n,r,i,a),s},t.prototype.recycle=function(){o.sPool.recycle(this)},t.sPool=new c.ObjectPool(G),t=o=(0,a.__decorate)([(0,g.B7)(n.To),(0,a.__metadata)("design:paramtypes",["function"==typeof(r="undefined"!=typeof CanvasImageSource&&CanvasImageSource)?r:Object,"function"==typeof(i=void 0!==n.IPoint&&n.IPoint)?i:Object,"function"==typeof(s=void 0!==n.ISize&&n.ISize)?s:Object,"function"==typeof(l=void 0!==n.IPoint&&n.IPoint)?l:Object,"function"==typeof(p=void 0!==n.ISize&&n.ISize)?p:Object,"function"==typeof(h=void 0!==n.IContextState&&n.IContextState)?h:Object])],t)}(Y),Be=function(e){function t(t,o,n,r){var i=e.call(this,o,r)||this;return i.key=t,i.frame=o,i.contentSize=n,i.contextState=r,i._subViews=[],i}var o,r,i;return(0,a.__extends)(t,e),t.prototype.addSubview=function(e){this._subViews.push(e)},Object.defineProperty(t.prototype,"subViews",{get:function(){return this._subViews},enumerable:!1,configurable:!0}),t.prototype.recycle=function(){},t=(0,a.__decorate)([(0,g.B7)(n.Sy),(0,a.__metadata)("design:paramtypes",[String,"function"==typeof(o=void 0!==n.IRect&&n.IRect)?o:Object,"function"==typeof(r=void 0!==n.ISize&&n.ISize)?r:Object,"function"==typeof(i=void 0!==n.IContextState&&n.IContextState)?i:Object])],t)}(Y),Ee=(function(e){function t(t,o,n,r){var i=e.call(this,t,o,r.contentSize)||this;return i.key=t,i.frame=o,i.componentClass=n,i.props=r,i}var o,r;(0,a.__extends)(t,e),o=t,t.obtain=function(e,t,n,r){var i=o.sPool.obtain();return i?(i.key=e,i.frame=t,i.componentClass=n,i.props=r):i=new o(e,t,n,r),i},t.prototype.recycle=function(){o.sPool.recycle(this)},t.sPool=new c.ObjectPool(G),t=o=(0,a.__decorate)([(0,g.B7)(n.fo),(0,a.__metadata)("design:paramtypes",[String,"function"==typeof(r=void 0!==n.IRect&&n.IRect)?r:Object,Object,Object])],t)}(Be),function(e){function t(t,o,n,r,i){var a=e.call(this,t,r)||this;return a.frame=t,a.color=o,a.path=n,a.contextState=r,a.isFill=i,a}var o,r,i,s;return(0,a.__extends)(t,e),o=t,t.prototype.hash=function(){return"".concat(e.prototype.hash.call(this),"-").concat(this.color)},t.obtain=function(e,t,n,r,i){var a=o.sPool.obtain();return a?(a.frame=e,a.color=t,a.path=n,a.contextState=r,a.isFill=i):a=new o(e,t,n,r),a},t.prototype.recycle=function(){o.sPool.recycle(this)},t.sPool=new c.ObjectPool(G),t=o=(0,a.__decorate)([(0,g.B7)(n.Zi),(0,a.__metadata)("design:paramtypes",["function"==typeof(r=void 0!==n.IRect&&n.IRect)?r:Object,String,"function"==typeof(i=void 0!==n.IPath&&n.IPath)?i:Object,"function"==typeof(s=void 0!==n.IContextState&&n.IContextState)?s:Object,Boolean])],t)}(Y)),Me=function(e){function t(t,o,r){var i=e.call(this,n.rG,r)||this;return i.line=t,i.lineProp=o,i.contextState=r,i}var o,r,i,s;return(0,a.__extends)(t,e),o=t,t.prototype.hash=function(){var t=this.lineProp,o=t.style,n=t.width,r=t.color;return"".concat(e.prototype.hash.call(this),"-").concat(o,"-").concat(n,"-").concat(r?r.hex:"#000000")},t.obtain=function(e,t,n){var r=o.sPool.obtain();return r?(r.line=e,r.lineProp=t,r.contextState=n):r=new o(e,t,n),r},t.prototype.recycle=function(){o.sPool.recycle(this)},t.sPool=new c.ObjectPool(G),t=o=(0,a.__decorate)([(0,g.B7)(n.bJ),(0,a.__metadata)("design:paramtypes",["function"==typeof(r=void 0!==n.ILine&&n.ILine)?r:Object,"function"==typeof(i=void 0!==n.ILineProp&&n.ILineProp)?i:Object,"function"==typeof(s=void 0!==n.IContextState&&n.IContextState)?s:Object])],t)}(Y),Le=function(e){function t(t,o,n){var r=e.call(this,t,n)||this;return r.frame=t,r.roundRectProp=o,r.contextState=n,r}var o,r,i,s;return(0,a.__extends)(t,e),o=t,t.prototype.computePaintHash=function(){var e=this.roundRectProp,t=e.shadowInfo,o=e.fillColor,n=e.strokeColor,r=e.radius,i=e.borderWidth,a="fill:".concat(o||"rgba(0,0,0,0)",";radius:").concat(r,";");if(t){var s=t.shadowOffsetY,l=t.shadowOffsetX,c=t.shadowColor,p=t.shadowBlur;a+="shadow:".concat(l," ").concat(s," ").concat(p," ").concat(c,";")}return n&&i&&(a+="stroke:".concat(n,";")),i&&(a+="border:".concat(i)),a},t.prototype.hash=function(){var t=this.frame,o=t.x,n=t.y,r=t.width,i=t.height,a="".concat(o,"-").concat(n,"-").concat(r,"-").concat(i),s=this.computePaintHash();return"".concat(e.prototype.hash.call(this),"-").concat(a,"-").concat(s)},t.obtain=function(e,t,n){var r,i=o.sPool.obtain();return r=t&&"string"!=typeof t?t:{fillColor:t,radius:0},i?(i.frame=e,i.roundRectProp=r,i.contextState=n):i=new o(e,r,n),i},t.prototype.recycle=function(){o.sPool.recycle(this)},t.sPool=new c.ObjectPool(G),t=o=(0,a.__decorate)([(0,g.B7)(n.iW),(0,a.__metadata)("design:paramtypes",["function"==typeof(r=void 0!==n.IRect&&n.IRect)?r:Object,"function"==typeof(i=void 0!==n.IRoundRectProp&&n.IRoundRectProp)?i:Object,"function"==typeof(s=void 0!==n.IContextState&&n.IContextState)?s:Object])],t)}(Y),Oe=function(e){function t(t,o,n,r){var i=e.call(this,t,r)||this;return i.frame=t,i.type=o,i.roundRectProp=n,i.contextState=r,i}var o,r,i,s;return(0,a.__extends)(t,e),o=t,t.prototype.hash=function(){var t=this.roundRectProp,o=t.shadowInfo,n=t.fillColor,r=t.strokeColor,i=t.image,a=i instanceof SVGImageElement?i.href.baseVal:null==i?void 0:i.src;return"".concat(e.prototype.hash.call(this),"-").concat(this.type,"-").concat(n,"-").concat(r,"-").concat(null==o?void 0:o.shadowBlur,"-").concat(null==o?void 0:o.shadowColor,"-").concat(null==o?void 0:o.shadowOffsetX,"-").concat(null==o?void 0:o.shadowOffsetY,"-").concat(a)},t.obtain=function(e,t,n,r){var i=o.sPool.obtain();return i?(i.frame=e,i.type=t,i.roundRectProp=n,i.contextState=r):i=new o(e,t,n,r),i},t.prototype.recycle=function(){o.sPool.recycle(this)},t.sPool=new c.ObjectPool(G),t=o=(0,a.__decorate)([(0,g.B7)(n.fp),(0,a.__metadata)("design:paramtypes",["function"==typeof(r=void 0!==n.IRect&&n.IRect)?r:Object,String,"function"==typeof(i=void 0!==n.IRoundRectProp&&n.IRoundRectProp)?i:Object,"function"==typeof(s=void 0!==n.IContextState&&n.IContextState)?s:Object])],t)}(Y),Ae=function(e){function t(t,o,n,r,i){var a=e.call(this,o,i)||this;return a.key=t,a.frame=o,a.content=n,a.style=r,a.contextState=i,a}var o,i,s,l,p;return(0,a.__extends)(t,e),o=t,t.computeContainerStyles=function(e,t,o,n,i){return r.vW8.computeContainerStyles(e,t,o,n,i)},t.obtain=function(e,t,n,r,i){var a=o.sPool.obtain();return a?(a.key=e,a.frame=t,a.content=n,a.style=r,a.contextState=i):a=new o(e,t,n,r,i),a},t.prototype.recycle=function(){o.sPool.recycle(this)},t.prototype.hash=function(){return this.constructor.name},t.sPool=new c.ObjectPool(G),t=o=(0,a.__decorate)([(0,g.B7)(n.MJ),(0,a.__metadata)("design:paramtypes",[String,"function"==typeof(i=void 0!==n.IRect&&n.IRect)?i:Object,"function"==typeof(s="undefined"!=typeof JSX&&JSX.Element)?s:Object,"function"==typeof(l=void 0!==r.CssProperties&&r.CssProperties)?l:Object,"function"==typeof(p=void 0!==n.IContextState&&n.IContextState)?p:Object])],t)}(Y),ke=function(e){function t(t,o,n,r,i,a,s){var l=e.call(this,t,o,n,r,i)||this;return l.behindDoc=a,l.pagesInfo=s,l}var o,i,s,l,p;return(0,a.__extends)(t,e),o=t,t.obtain=function(e,t,n,r,i,a,s){var l=o.anchorPool.obtain();return l?(l.key=e,l.frame=t,l.content=n,l.style=r,l.contextState=i,l.behindDoc=a,l.pagesInfo=s):l=new o(e,t,n,r,i,a,s),l},t.prototype.recycle=function(){o.anchorPool.recycle(this)},t.anchorPool=new c.ObjectPool(G),t=o=(0,a.__decorate)([(0,g.B7)(n.lc),(0,a.__metadata)("design:paramtypes",[String,"function"==typeof(i=void 0!==n.IRect&&n.IRect)?i:Object,"function"==typeof(s="undefined"!=typeof JSX&&JSX.Element)?s:Object,"function"==typeof(l=void 0!==r.CssProperties&&r.CssProperties)?l:Object,"function"==typeof(p=void 0!==n.IContextState&&n.IContextState)?p:Object,Boolean,Object])],t)}(Ae),Ve=function(e){function t(t,o,n,r,i,a,s,l,c,p){var h=e.call(this,{x:t.left,y:t.top,width:t.width,height:t.height})||this;return h.drawingFrame=t,h.path=o,h.effectExtent=n,h.fillStyle=r,h.strokeStyle=i,h.filter=a,h.contextState=s,h.placeholderImageSrc=l,h.containerWidth=c,h.containerHeight=p,h}var o,r,i,s,l,p,h,d;return(0,a.__extends)(t,e),o=t,t.obtain=function(e){var t=e.frame,n=e.path,r=e.effectExtent,i=e.fillStyle,a=e.strokeStyle,s=e.filter,l=e.contextState,c=e.placeholderImageSrc,p=e.containerWidth,h=e.containerHeight,d=o.sPool.obtain();return d?(d.drawingFrame=t,d.path=n,d.effectExtent=r,d.fillStyle=i,d.strokeStyle=a,d.filter=s,d.contextState=l,d.placeholderImageSrc=c,d.containerWidth=p,d.containerHeight=h):d=new o(t,n,r,i,a,s,l,c,p,h),d},t.prototype.recycle=function(){o.sPool.recycle(this)},t.sPool=new c.ObjectPool(G),t=o=(0,a.__decorate)([(0,g.B7)(n.Se),(0,a.__metadata)("design:paramtypes",["function"==typeof(r=void 0!==se.IFrame&&se.IFrame)?r:Object,"function"==typeof(i=void 0!==n.DrawingPath&&n.DrawingPath)?i:Object,"function"==typeof(s=void 0!==f.F8o&&f.F8o)?s:Object,"function"==typeof(l=void 0!==se.IFillStyle&&se.IFillStyle)?l:Object,"function"==typeof(p=void 0!==se.IStrokeStyle&&se.IStrokeStyle)?p:Object,"function"==typeof(h=void 0!==se.IFilter&&se.IFilter)?h:Object,"function"==typeof(d=void 0!==n.IContextState&&n.IContextState)?d:Object,String,Number,Number])],t)}(Y),Fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.collect=function(t,o){e.prototype.collect.call(this,t,o)},t.prototype.renderObjectType=function(){return re.Drawing},t}(he),ze=Fe,De=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.collect=function(t,o){e.prototype.collect.call(this,t,o)},t.prototype.renderObjectType=function(){return re.Container},t}(he),We=De;!function(e){e.Text="DefaultText",e.Line="DefaultLine",e.Graphics="DefaultGraphics",e.Drawing="DefaultDrawing",e.Container="DefaultContainer",e.Bitmap="DefaultBitmap",e.RoundRect="DefaultRoundRect",e.Component="DefaultComponent",e.Anchor="DefaultAnchor",e.Overlay="DefaultOverlay"}(ae||(ae={}));var He,je=function(){function e(){this._viewCount=0,this._collectorVector=[],this._collectorMap=new Map,this.zIndex=g.aP,this._textCollector=new ue(ie[k.TextRenderer]),this._lineCollector=new ge(ie[k.LineRenderer]),this._graphicsCollector=new ye(ie[k.GraphicsRender]),this.drawingCollector=new ze(ie[k.DrawingRender]),this.containerCollector=new We(ie[k.DrawingRender]),this._bitmapCollector=new we(ie[k.BitmapRenderer]),this._roundRectCollector=new Se(ie[k.RoundRectRenderer]),this._componentCollector=new Ce(ie[k.ComponentRenderer]),this._anchorCollector=new Re(ie[k.AnchorRenderer]),this._overlayCollector=new _e(ie[k.OverlayRenderer]),this._collectorVector=[this._textCollector,this._lineCollector,this._graphicsCollector,this.drawingCollector,this.containerCollector,this._bitmapCollector,this._roundRectCollector,this._componentCollector,this._overlayCollector,this._anchorCollector],this._sort(),this._collectorMap.set(ae.Text,this._textCollector),this._collectorMap.set(ae.Line,this._lineCollector),this._collectorMap.set(ae.Graphics,this._graphicsCollector),this._collectorMap.set(ae.Drawing,this.drawingCollector),this._collectorMap.set(ae.Container,this.containerCollector),this._collectorMap.set(ae.Bitmap,this._bitmapCollector),this._collectorMap.set(ae.RoundRect,this._roundRectCollector),this._collectorMap.set(ae.Component,this._componentCollector),this._collectorMap.set(ae.Anchor,this._anchorCollector),this._collectorMap.set(ae.Overlay,this._overlayCollector)}return e.prototype._sort=function(){this._collectorVector.sort((function(e,t){return e.compare(t)}))},e.prototype.collect=function(e,t){var o="";e instanceof U?o=ae.Text:e instanceof Me?o=ae.Line:e instanceof Ee?o=ae.Graphics:e instanceof Ve?o=ae.Drawing:e instanceof Be?o=ae.Container:e instanceof Ie?o=ae.Bitmap:e instanceof Oe?o=ae.RoundRect:e instanceof Ae?o=e instanceof ke?ae.Anchor:ae.Component:e instanceof Le&&(o=ae.Overlay),this.collectCustomView(o,e,t)},e.prototype.collectCustomView=function(e,t,o){if(!(e.length<0)){var n=this.get(e);if(n){var i=g.nU.generatePriority(null!=o?o:r.Ypk.UpperDefault,this.zIndex);n.collect(t,i),this._viewCount=this._viewCount+1}}},Object.defineProperty(e.prototype,"collectors",{get:function(){return this._collectorVector},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewCount",{get:function(){return this._viewCount},enumerable:!1,configurable:!0}),e.prototype.add=function(e,t){if(this._collectorMap.has(e))throw new Error("收集器重名，请检查");this._collectorMap.set(e,t),this._collectorVector.push(t),this._sort()},e.prototype.get=function(e){return this._collectorMap.get(e)},e.prototype.clear=function(){this._collectorVector.forEach((function(e){e.clear()})),this._viewCount=0},e.prototype.generateCollector=function(e,t){switch(e){case k.LineRenderer:return new ge(t);case k.TextRenderer:return new ue(t);case k.BitmapRenderer:return new we(t);case k.GraphicsRender:return new ye(t);case k.DrawingRender:return new ze(t);case k.RoundRectRenderer:return new Se(t);case k.ComponentRenderer:return new Ce(t);case k.OverlayRenderer:return new _e(t);default:throw new Error("Error-RenderCollector: generateCollector")}},e}(),Ne=function(){function e(){this.collectEngine=new je,this.zoom=1,this.addonViewLayer=null,this.containerLayer=null,this.upperAnchorLayer=null,this.lowerAnchorLayer=null}return Object.defineProperty(e.prototype,"renderContext",{get:function(){return{renderDevice:this.renderDevice,mainView:this.mainRenderView,mainCtxState:{},addonViewLayer:this.addonViewLayer,containerLayer:this.containerLayer,upperAnchorLayer:this.upperAnchorLayer,lowerAnchorLayer:this.lowerAnchorLayer}},enumerable:!1,configurable:!0}),e.prototype.doRender=function(e){var t=this.collectEngine.collectors;this.renderEngine.render(t,e),this.collectEngine.clear()},e.prototype.initRenderViews=function(e,t,o,n){this.addonViewLayer={rootElements:e},this.containerLayer={rootElements:t},this.upperAnchorLayer={rootElements:o},this.lowerAnchorLayer={rootElements:n},this.renderEngine=new pe(this.renderContext)},e}(),Ge=(0,c.twipsToPx)(16830),Ye=function(e){function t(t){var o=e.call(this)||this;return o.mainCanvasRefs=[],o.currentMainCanvasRef=l().createRef(),o.prevPagesInRenderRect=[],o.prevPagesOutside=[],o.subCanvasCache=new Map,o.prevRenderedSubCanvasCache=new Map,o.layoutController=t,o}return(0,a.__extends)(t,e),Object.defineProperty(t.prototype,"mainRenderView",{get:function(){return this.getCanvasRenderRef().current},enumerable:!1,configurable:!0}),t.prototype.getRenderViewComponent=function(e,t,o,n){return this.createMainCanvasComponent(e,t,o,n)},t.prototype.render=function(e){var t,o=this,n=e.options,r=e.zoom,i=e.layoutBox,a=e.renderPages,s=e.doCollect,l=e.context,c=n.documentUpdated,p=n.dirtyPageIndexes;this.zoom=r,this.lastPageIndex=(null===(t=null==i?void 0:i.lastChild)||void 0===t?void 0:t.getSiblingIndex())||0,this.limitSubCanvasHeight=this.calcLimitSubCanvasHeight(r);var h=a.pagesInRenderRect,d=a.pagesOutside,u=this.calcToRenderPages(h,n);this.prevPagesInRenderRect=h,this.prevPagesOutside=d||[],Array.isArray(d)&&d.forEach((function(e){o.releaseCanvas(e),o.prevRenderedSubCanvasCache.delete(e)})),c&&p&&p.forEach((function(e){o.renderEngine.clearComponentView(e)})),this.clearSubCanvasCache(u),this.renderPages(u,i,s,n,l),c&&this.updateAddonViewInRenderRect(u,h)},Object.defineProperty(t.prototype,"renderDevice",{get:function(){return n.Lg.Canvas},enumerable:!1,configurable:!0}),t.prototype.renderPages=function(e,t,o,n,r){var i=this,a=n.renderWithReused;e.forEach((function(s,l){var c=l===e.length-1,p=t.children[s];if(p){var h=i.subCanvasCache.get(s);if(!h)return o({collectEngine:i.collectEngine,pageIndex:s}),i.renderByPage({pageBox:p,pageIndex:s,options:n,isLastRenderPage:c,context:r}),void i.prevRenderedSubCanvasCache.delete(s);var d=i.prevRenderedSubCanvasCache.get(s),u=[],f=i.generateSubIndexes(h),g=f.inRenderRectSubIndexes;f.outRenderRectSubIndexes.forEach((function(e){i.releaseCanvas(s,e)}));var v=g.length;g.forEach((function(e,t){var l=c&&t===v-1;if(u.push(e),!a||!i.canSubCanvasReuse(d,e)){var h=o({pageIndex:s,subPageIndex:e,collectEngine:i.collectEngine,limitSubCanvasHeight:i.limitSubCanvasHeight});i.renderByPage({pageBox:p,pageIndex:s,options:n,context:r,collectRect:h,subPageIndex:e,isLastRenderPage:l})}})),i.prevRenderedSubCanvasCache.set(s,u)}}))},t.prototype.generateSubIndexes=function(e){var t=[],o=[];return e.isInRenderRectList.forEach((function(e,n){e?t.push(n):o.push(n)})),{inRenderRectSubIndexes:t,outRenderRectSubIndexes:o}},t.prototype.canSubCanvasReuse=function(e,t){return e&&e.includes(t)},t.prototype.renderByPage=function(e){var t=e.pageBox,o=e.pageIndex,n=e.subPageIndex,r=e.context;this.resetPageCanvas(t,o,n),this.doRender((0,a.__assign)((0,a.__assign)({},e),{lastPageIndex:this.lastPageIndex,context:r}))},t.prototype.calcToRenderPages=function(e,t){var o=this,n=t.renderWithReused,r=t.dirtyPageIndexes,i=this.prevPagesOutside.filter((function(t){return e.includes(t)}));if(r&&r.length>0){var s=r.filter((function(t){return e.includes(t)}));return Array.from(new Set((0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(s),!1),(0,a.__read)(i),!1)))}var l=[];if(n){var c=e.filter((function(e){return!o.prevPagesInRenderRect.includes(e)||o.subCanvasCache.has(e)}));l=Array.from(new Set((0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(c),!1),(0,a.__read)(i),!1)))}else l=(0,a.__spreadArray)([],(0,a.__read)(e),!1);return l},t.prototype.updateAddonViewInRenderRect=function(e,t){var o=this,n=t.filter((function(t){return!e.includes(t)}));window.requestAnimationFrame((function(){var e,t,r=null===(t=null===(e=o.renderContext)||void 0===e?void 0:e.addonViewLayer)||void 0===t?void 0:t.rootElements[0];r&&r.updateAddonViewOffset(n)}))},t.prototype.releaseCanvas=function(e,t){var o,n=this.mainCanvasRefs[e];(o=Array.isArray(n)&&void 0!==t&&n[t]?n[t].current:n.current)&&(o.width=1,o.height=1)},t.prototype.resetPageCanvas=function(e,t,o){var n=this.mainCanvasRefs[t];if(Array.isArray(n)&&void 0!==o&&n[o]?this.currentMainCanvasRef=n[o]:this.currentMainCanvasRef=n,this.currentMainCanvasRef){var r=this.getPageBoxPaddingBoxSize(e),i=r.width,a=r.height,s=(0,c.twipsToPx)(i*this.zoom),l=(0,c.twipsToPx)(a*this.zoom),p=Math.round(this.devicePixelRatio*s),h=Math.round(this.devicePixelRatio*l),d=0;if(void 0!==o){var u=this.calcSubCanvasVerticalInfo(o,a).subCanvasRectHeight,f=this.zoom*this.devicePixelRatio;d=Math.round((0,c.twipsToPx)(this.limitSubCanvasHeight)*f)*o,h=Math.round((0,c.twipsToPx)(u)*f)}this.reflashCurrentCanvasView(p,h,d),this.renderEngine.resetCanvasNode(this.mainRenderView)}},t.prototype.getCanvasRenderRef=function(){return this.currentMainCanvasRef},Object.defineProperty(t.prototype,"devicePixelRatio",{get:function(){var e=this.currentMainCanvasRef.current,t=null==e?void 0:e.getContext("2d");return t?W.canvasScaleRatio(t):window.devicePixelRatio||1},enumerable:!1,configurable:!0}),t.prototype.reflashCurrentCanvasView=function(e,t,o){var n=this.devicePixelRatio*this.zoom,r=e/this.devicePixelRatio,i=t/this.devicePixelRatio,a=o/this.devicePixelRatio,s=this.currentMainCanvasRef.current;if(s){var l=s.getContext("2d");l&&(l.clearRect(0,0,s.width,s.height),s.style.top="".concat(a,"px"),s.style.width="".concat(r,"px"),s.style.height="".concat(i,"px"),s.width=e,s.height=t,l.imageSmoothingEnabled=!0,l.setTransform(n,0,0,n,0,0))}},t.prototype.createMainCanvasComponent=function(e,t,o,n){return void 0===n&&(n=1),t.height<=0?null:(this.mainCanvasRefs[e]||(this.mainCanvasRefs[e]=l().createRef()),this.subCanvasCache.delete(e),this.exceedLimitCanvasHeight(o,n)?(this.limitSubCanvasHeight=this.calcLimitSubCanvasHeight(n),this.updateSubCanvasCache(e,t,o),this.generateSubCanvasElements(e)):this.generateCanvasElement(e,this.mainCanvasRefs[e]))},t.prototype.exceedLimitCanvasHeight=function(e,t){return this.devicePixelRatio*(0,c.twipsToPx)(e.totalBoxSize.height*t)/Ge>4},t.prototype.calcLimitSubCanvasHeight=function(e){return 16830/e/this.devicePixelRatio},t.prototype.updateSubCanvasCache=function(e,t,o){for(var n=this.getPageBoxPaddingBoxSize(o),r=n.width,i=n.height,a=Math.ceil(i/this.limitSubCanvasHeight),s=[],l=0;l<a;l++){var p=this.calcSubCanvasVerticalInfo(l,i),h=p.subCanvasRectHeight,d=p.subCanvasRectTop,u=new c.MeloRect({x:0,y:o.getOuterPoint().y+d,width:r,height:h});s.push(null==t?void 0:t.intersect(u))}this.subCanvasCache.set(e,{isInRenderRectList:s})},t.prototype.calcSubCanvasVerticalInfo=function(e,t){return{subCanvasRectHeight:Math.min(this.limitSubCanvasHeight,t-this.limitSubCanvasHeight*e),subCanvasRectTop:this.limitSubCanvasHeight*e}},t.prototype.generateSubCanvasElements=function(e){var t=this,o=this.subCanvasCache.get(e),n=null==o?void 0:o.isInRenderRectList;return Array.isArray(n)?(this.mainCanvasRefs[e]=[],n.map((function(o,n){var r=l().createRef();return t.mainCanvasRefs[e].push(r),t.generateCanvasElement(e,r,n)}))):null},t.prototype.generateCanvasElement=function(e,t,o){var n=void 0!==o?"".concat(e,"-").concat(o):"".concat(e),r="page-".concat(n);return l().createElement("canvas",{className:"melo-page-main-view ".concat(r),key:n,style:{position:"absolute"},ref:t})},t.prototype.clearSubCanvasCache=function(e){var t,o;try{for(var n=(0,a.__values)(this.prevRenderedSubCanvasCache.keys()),r=n.next();!r.done;r=n.next()){var i=r.value;e.includes(i)||this.prevRenderedSubCanvasCache.delete(i)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(o=n.return)&&o.call(n)}finally{if(t)throw t.error}}},t.prototype.getPageBoxPaddingBoxSize=function(e){return e.paddingBoxSize},t}(Ne),Ue=function(e){function t(){var t=e.call(this)||this;return t.mainSvgRefs=[],t.currentMainSvgRef=l().createRef(),t}return(0,a.__extends)(t,e),t.prototype.updateSVGView=function(e,t,o){this.currentMainSvgRef=this.mainSvgRefs[t];var n=new c.MeloSize({width:e.totalBoxSize.width*o,height:e.totalBoxSize.height*o});this.initViewNode(this.currentMainSvgRef,n),this.renderEngine.resetCanvasNode(this.mainRenderView)},t.prototype.initViewNode=function(e,t){var o=e.current;o&&(o.style.width="".concat((0,c.twipsToPx)(t.width),"px"),o.style.height="".concat((0,c.twipsToPx)(t.height),"px"),o.innerHTML="",o.__context__=void 0)},t.prototype.mainSvgViewComponent=function(e){return this.mainSvgRefs[e]||(this.mainSvgRefs[e]=l().createRef()),l().createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",className:"melo-page-main-view",style:{position:"absolute"},ref:this.mainSvgRefs[e]})},Object.defineProperty(t.prototype,"renderDevice",{get:function(){return n.Lg.Svg},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mainRenderView",{get:function(){return this.currentMainSvgRef.current},enumerable:!1,configurable:!0}),t.prototype.getRenderViewComponent=function(e){return l().createElement(l().Fragment,null,this.mainSvgViewComponent(e))},t.prototype.render=function(e){var t,o=this,n=e.options,r=e.zoom,i=e.layoutBox,s=e.renderPages,l=e.doCollect,c=e.context,p=s.pagesNewRender,h=s.pagesInRenderRect;this.zoom=r;var d=(0,a.__spreadArray)([],(0,a.__read)(h),!1);Array.isArray(p)&&p.length>0&&(d=(0,a.__spreadArray)([],(0,a.__read)(p),!1));var u=d.length,f=(null===(t=null==i?void 0:i.lastChild)||void 0===t?void 0:t.getSiblingIndex())||0;d.forEach((function(e,t){var a=i.children[e],s=t===u-1;o.updateSVGView(a,e,r),l({collectEngine:o.collectEngine,pageIndex:e}),o.doRender({pageBox:a,options:n,pageIndex:e,context:c,lastPageIndex:f,isLastRenderPage:s})}))},t}(Ne),Xe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rootRef=l().createRef(),t}return(0,a.__extends)(t,e),t.prototype.componentDidMount=function(){this.attachBox(),this.lastBoxId=this.props.layoutBox.uuid},t.prototype.componentWillUnmount=function(){this.detachBox()},t.prototype.componentDidUpdate=function(){this.attachBox(),this.lastBoxId=this.props.layoutBox.uuid},t.prototype.attachBox=function(){var e=this.rootRef.current;if(e){var t=this.props.layoutBox;t.__node__&&(t.__node__.__vm__=null),e.__vm__&&(e.__vm__.__node__=null),e.__vm__=t,e.__type__=t.constructor.name,t.__node__=e}},t.prototype.detachBox=function(){var e=this.rootRef.current;if(e){var t=this.props.layoutBox;e.__vm__=null,e.__type__=null,t.__node__=null}},t}(s.Component);!function(e){e[e.Ignore=0]="Ignore",e[e.Render=1]="Render",e[e.Break=2]="Break"}(He||(He={}));var qe=function(){function e(){this._viewRegion={x:0,y:0,width:0,height:0},this._incRegion={x:0,y:0,width:0,height:0}}return Object.defineProperty(e.prototype,"viewRegion",{get:function(){return this._viewRegion},set:function(e){this._viewRegion=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"incRegion",{get:function(){return this._incRegion},set:function(e){this._incRegion=e},enumerable:!1,configurable:!0}),e.prototype.shouldRender=function(e){var t={start:this._incRegion.y,end:this._incRegion.y+this._incRegion.height},o=g.bV.relationBetween(t,e);return o===g.cR.DESC?He.Ignore:o===g.cR.ASC?He.Break:He.Render},e}(),Ke=function(){function e(e,t){this.context=e,this.shares=t}return e.prototype.skipRender=function(e){return!e.onlyAnchors&&(0,n.vv)(e.layoutBox)},e.prototype.renderRectBorder=function(e,t,o,n){var i=Oe.obtain((0,r.SsA)(e.x,e.y-o.incRegion.y,e.width,e.height),"preview-diff",{radius:0},null==n?void 0:n.contextState);t.collect(i)},e}(),Je=o(31518),Ze=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.render=function(){return l().createElement("table",{style:{width:this.props.contentSize.width,height:this.props.contentSize.height},className:r.F51.scrollerDefaultContent,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,onMouseMove:this.props.onMouseMove,onTouchEnd:this.props.onTouchEnd})},t}(l().Component),Qe=236,$e=(0,c.pxToTwips)(3.5),et=function(){function e(e){this.tableBox=e}return e.prototype.autoAdjustCol=function(e,t){var o=this.locateBoxOfDistance(e),n=o.matchCellBoxes,r=o.acrossCellBoxes;if(0!==n.length){var i=n[0].getRangeBegin();if(-1!==i){var a=this.resolveExpandWidth(n);if(a<0)t(i,a=Math.max(a,-this.maxShrinkWidth(r)));else{var s=this.getRightSpaceOfTable();s<Qe||t(i,a=Math.min(s,a))}}}},e.prototype.autoAdjustAllCols=function(e){var t=this.computeRegularCols();t&&e(t)},e.prototype.locateBoxOfDistance=function(e){var t,o,n,r,i=[],s=[],l=e-$e,c=e+$e;try{for(var p=(0,a.__values)(this.tableBox.children),h=p.next();!h.done;h=p.next()){var d=h.value,u=0;try{for(var f=(n=void 0,(0,a.__values)(d.children)),g=f.next();!g.done;g=f.next()){var v=g.value,y=u+v.totalWidth;if(y>l&&y<c){i.push(v);break}if(e>u&&e<y){s.push(v);break}u=y}}catch(e){n={error:e}}finally{try{g&&!g.done&&(r=f.return)&&r.call(f)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{h&&!h.done&&(o=p.return)&&o.call(p)}finally{if(t)throw t.error}}return{matchCellBoxes:i,acrossCellBoxes:s}},e.prototype.resolveExpandWidth=function(e){var t=this;return e.reduce((function(e,o){var n=t.maxContentWidth(o);return n?Math.max(e,t.straightenContentWidth(o)-n):e}),Number.MIN_SAFE_INTEGER)},e.prototype.maxContentWidth=function(e){var t,o=null===(t=e.firstChild)||void 0===t?void 0:t.edge.padding;return o?e.paddingBoxSize.width-o.left-o.right:0},e.prototype.maxShrinkWidth=function(e){var t=this;return e.reduce((function(e,o){var n=t.maxContentWidth(o)-Qe;return Math.min(n,e)}),Number.MAX_SAFE_INTEGER)},e.prototype.straightenContentWidth=function(e){var t,o=this,n=null===(t=e.firstChild)||void 0===t?void 0:t.children;return n&&0!==n.length?n.reduce((function(e,t){return Math.max(e,o.getParaContentWidth(t))}),0):0},e.prototype.computeRegularCols=function(){var e=this.getColCount();if(e){for(var t=new Map,o=new Map,n=new Map,r=new Map,i=this.tableBox.totalWidth,a=0,s=0;s<e;s++){var l=this.colInfo(this.getColCells(s));l.isBlankCol?(t.set(s,l.width),r.set(s,l.minWidth),i-=l.width,a+=l.width-l.minWidth):l.canAccommodate?(o.set(s,l.flatContentWidth),o[s]=l.flatContentWidth,i-=l.flatContentWidth):(n.set(s,l.flatContentWidth),i-=l.flatContentWidth)}var c=this.getRightSpaceOfTable();if(!(n.size>0?a+c<=15:Math.abs(i-c)<=15)){if(i>=0)return this.toCols([o,t,n]);var p=a+i;return this.apportionWidth(p>0?r:n,p),this.toCols([o,r,n])}}},e.prototype.getColCells=function(e){var t,o,n=[];try{for(var r=(0,a.__values)(this.tableBox.children),i=r.next();!i.done;i=r.next()){var s=i.value;s.children[e]&&n.push(s.children[e])}}catch(e){t={error:e}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(t)throw t.error}}return n},e.prototype.apportionWidth=function(e,t){var o,n,r,i;if(0!==e.size){var s=0;try{for(var l=(0,a.__values)(e),c=l.next();!c.done;c=l.next())s+=f=(0,a.__read)(c.value,2)[1]}catch(e){o={error:e}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(o)throw o.error}}try{for(var p=(0,a.__values)(e),h=p.next();!h.done;h=p.next()){var d=(0,a.__read)(h.value,2),u=d[0],f=d[1];e.set(u,f+Math.floor(f/s*t))}}catch(e){r={error:e}}finally{try{h&&!h.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}}},e.prototype.toCols=function(e){var t,o,n,r,i=[];try{for(var s=(0,a.__values)(e),l=s.next();!l.done;l=s.next()){var c=l.value;try{for(var p=(n=void 0,(0,a.__values)(c)),h=p.next();!h.done;h=p.next()){var d=(0,a.__read)(h.value,2),u=d[0],f=d[1];i[u]=f}}catch(e){n={error:e}}finally{try{h&&!h.done&&(r=p.return)&&r.call(p)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(t)throw t.error}}return i},e.prototype.colInfo=function(e){var t=this,o=!0,n=0,r=0,i=Qe,a=!0;return e.forEach((function(e){var s;if(void 0===e.mergedType){o=o&&t.isBlankCell(e);var l=null===(s=e.firstChild)||void 0===s?void 0:s.edge.padding,c=((null==l?void 0:l.left)||0)+((null==l?void 0:l.right)||0);n=Math.max(t.straightenContentWidth(e)+c,n),r=Math.max(e.totalWidth,r),i=Math.max(c+Qe,i),a=a&&e.totalWidth>=n}})),{flatContentWidth:n,isBlankCol:o,minWidth:i,width:r,canAccommodate:a}},e.prototype.getColCount=function(){return this.tableBox.children.reduce((function(e,t){return Math.max(e,t.children.length)}),0)},e.prototype.getParaContentWidth=function(e){var t;return(0,n.YP)(e)?e.contentSize.width:e.children.reduce((function(e,t,o){var n,r,a,s,l,c=t.totalWidth-(null!==(r=null===(n=t.edge)||void 0===n?void 0:n.width)&&void 0!==r?r:0);return 0===o&&(c+=null!==(s=null===(a=t.edge.margin)||void 0===a?void 0:a.left)&&void 0!==s?s:0),t instanceof i.vm&&(c+=(null===(l=t.listMark)||void 0===l?void 0:l.totalWidth)||0),Math.ceil(c)+e}),null!==(t=e.edge.width)&&void 0!==t?t:0)},e.prototype.isBlankCell=function(e){var t,o=null===(t=e.firstChild)||void 0===t?void 0:t.children;return!o||0===o.length||o.every((function(e){var t=e.getFirstDescendantOf(n.uO.Text);return!t||t instanceof i.w8}))},e.prototype.getRightSpaceOfTable=function(){return this.tableBox.totalWidth-Math.max.apply(Math,(0,a.__spreadArray)([],(0,a.__read)(this.tableBox.children.map((function(e){return e.totalWidth}))),!1))},e}();function tt(e,t){var o=t.children.findIndex((function(t){return t===e}));return-1===o?0:t.children.slice(0,o).reduce((function(e,t){return e+t.totalWidth}),0)}var ot,nt=u(Ze),rt=(0,c.pxToTwips)(4),it=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={draggerInfo:{scrollLeft:0,edge:"none",top:0,left:0,width:0,height:0,colDraggerShow:!1,rowDraggerShow:!1},colGuiderShow:!1,rowGuiderShow:!1,colGuiderLeftPos:0,rowGuiderTopPos:0,showTableHeader:!1,showColAddIcon:!1,showRowAddIcon:!1,isTableActivited:!1,selectedRange:null,selectedCellRanges:[]},t.refTable=l().createRef(),t.tableScrollLeft=0,t.tableScrollWidth=Number.MAX_SAFE_INTEGER,t.selectionChange=function(e){if(!t.isSelectionInCurrentTable(e.range.begin()))return t.resetHeader(),void t.hideIcon(i.s9.getFirstTableBox(t.props.layoutBox));t.showIcon(i.s9.getFirstTableBox(t.props.layoutBox),!0);var o=e.cellRange,n=e.range,r=t.props.shares.state.selection.tableSelectionArea;t.setState({isTableActivited:!0,showTableHeader:t.isEnableTableShortCuts,selectedRange:n,selectedCellRanges:(null==o?void 0:o.cellRanges)||(null==r?void 0:r.cellRanges)})},t.onMouseEnter=function(){t.setState({isTableActivited:!0})},t.onMouseLeave=function(){t.setState({isTableActivited:!1})},t.onApplyDrag=function(e,o,n){var r=e.getRangeBegin();if(-1!==r){var i=t.state.draggerInfo,a=i.edge,s=i.rowHeight,l=i.colWidth,p=(0,c.pxToTwips)(o);"top"===a||"bottom"===a?t.modifyRowHeight(r,s,p,a):"left"!==a&&"right"!==a||t.modifyColWidth(r,l,p,a,e.getSiblingIndex(),n)}},t.onFinishDrag=function(e,o){var n=t.state.draggerInfo,r=n.box,i=n.rowHeight,a=n.colWidth;r&&0!==e&&r&&i&&a&&t.onApplyDrag(r,e,o)},t.onFinishResizeDrag=function(e,o){var n=(0,c.pxToTwips)(e),i=(0,c.pxToTwips)(o);if(n||i){var a=t.props.layoutBox,s=a.firstChild,l=a.children;if(s){var p=l.reduce((function(e,t){return e+t.totalHeight}),0),h=(p+i)/p,d=(t.props.layoutBox.totalWidth+n)/t.props.layoutBox.totalWidth,u=[];1!==h&&(u=l.map((function(e){return h*e.totalHeight}))),t.props.context.fire(new r.LB5(d,u,t.props.layoutBox.getRangeBegin(),s.getRangeBegin(),t.props.layoutBox.nestingLevel))}}},t.onMouseMove=function(e){var o;if(t.refTable.current){var n=e.clientX,r=e.clientY,i=null===(o=t.refTable.current)||void 0===o?void 0:o.getBoundingClientRect(),a=(0,c.pxToTwips)(n-i.left)/t.zoom+t.props.scrollLeft,s=(0,c.pxToTwips)(r-i.top)/t.zoom,l=t.findCellBoxForPos(t.props.layoutBox,{x:a,y:s}),p=l.box,h=l.offset,d=l.edge;p&&t.moveDraggerToBox(p,h,d)}},t.handleColAdjust=function(e){var o=t.getDistanceToTableLeft(e);void 0!==o&&(o>-$e&&o<$e?t.adjustAllColsWidth():t.adjustColWidth(o))},t.adjustColWidth=function(e){new et(t.props.layoutBox).autoAdjustCol(e,(function(e,o){t.props.context.fire(new r.jcg(e,Math.floor(o),t.nestingLevel))}))},t.adjustAllColsWidth=function(){new et(t.props.layoutBox).autoAdjustAllCols((function(e){t.props.context.fire(new r.XNP(t.props.layoutBox.getRangeBegin(),e,t.nestingLevel))}))},t.handleEnterColOrRowDragger=function(e){t.setState({draggerInfo:(0,a.__assign)((0,a.__assign)({},t.state.draggerInfo),{colDraggerShow:e===r.n0j.Col,rowDraggerShow:e===r.n0j.Row})})},t.handleLeaveColOrRowDragger=function(){t.setState({draggerInfo:(0,a.__assign)((0,a.__assign)({},t.state.draggerInfo),{colDraggerShow:!1,rowDraggerShow:!1})})},t}return(0,a.__extends)(t,e),Object.defineProperty(t.prototype,"isEnableTableShortCuts",{get:function(){return this.props.layoutBox.isRootNesting},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nestingLevel",{get:function(){return this.props.layoutBox.nestingLevel},enumerable:!1,configurable:!0}),t.prototype.renderIconLayer=function(){var e=this;return l().createElement("div",{style:{position:"absolute",top:0,left:"-97px",width:"calc(100% + 194px)",height:"100%",zIndex:-1},onMouseEnter:function(t){var o=i.s9.getFirstTableBox(e.props.layoutBox);e.showIcon(o);var n=t.currentTarget.getBoundingClientRect(),r=n.left,a=n.top,s=n.width,l=n.height,p=(0,c.throttle)((function(t){var n=t.clientX,i=t.clientY;(n<Math.floor(r)||n>Math.ceil(r+s)||i<Math.floor(a)||i>Math.ceil(a+l))&&(e.hideIcon(o),window.removeEventListener("mousemove",p))}),50);window.removeEventListener("mousemove",p),window.addEventListener("mousemove",p)}})},t.prototype.componentDidMount=function(){this.initHeaderState(),this.selectionChangeFn=this.selectionChange.bind(this),this.isEnableTableShortCuts&&this.props.context.on(Je.at.CoreSelectionChange,this.selectionChangeFn,this)},t.prototype.componentWillUnmount=function(){this.props.context.removeCallBack(Je.at.CoreSelectionChange,this.selectionChangeFn)},t.prototype.shouldComponentUpdate=function(e,t){return this.shouldTableElementUpdate(t)||t.colGuiderLeftPos!==this.state.colGuiderLeftPos||t.rowGuiderTopPos!==this.state.rowGuiderTopPos||!(0,g.vZ)(t.draggerInfo,this.state.draggerInfo)||!(0,g.vZ)(t.selectedRange,this.state.selectedRange)||!(0,g.vZ)(t.selectedCellRanges,this.state.selectedCellRanges)||!(0,g.vZ)(this.props,e)},t.prototype.onScroll=function(e){var t;this.tableScrollLeft=(null===(t=null==e?void 0:e.current)||void 0===t?void 0:t.scrollLeft)||0,this.props.context.fire(new r.Vpn(this.props.layoutBox.getRangeBegin()))},t.prototype.render=function(){return l().createElement("div",{style:{position:"relative",overflow:"visible",width:"100%"},className:"".concat(r.F51.meloTableWrapper," ").concat(this.props.cbKey),onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,ref:this.refTable},this.renderColRowDragger(),this.props.layoutBox.isRootNesting?l().createElement(nt,(0,a.__assign)({},this.props,{onDidMount:this.onScrollerDidMount.bind(this),onSelectionEnd:this.onSelectionEnd.bind(this),onScroll:this.onScroll.bind(this),onMouseMove:this.onMouseMove.bind(this),isTableActivited:this.state.isTableActivited,isTable:!0})):l().createElement("div",{style:{width:this.props.rectSize.width,height:this.props.rectSize.height},onMouseMove:this.onMouseMove}),this.isLastTableBox()?this.renderTableScaleDragger():"",this.renderTableHeader())},t.prototype.renderColRowDragger=function(){return this.props.shares.isEditable()?l().createElement(r.Oy7,(0,a.__assign)({},(0,a.__assign)((0,a.__assign)({},this.state.draggerInfo),{context:this.props.context,layoutBox:this.props.layoutBox,cbKey:this.props.cbKey,colGuiderShow:this.state.colGuiderShow,rowGuiderShow:this.state.rowGuiderShow,showTableHeader:this.state.showTableHeader,colGuiderLeftPos:this.state.colGuiderLeftPos,rowGuiderTopPos:this.state.rowGuiderTopPos,onFinish:this.onFinishDrag,zoom:this.zoom,width:this.props.rectSize.width,height:this.props.rectSize.height,onColAdjust:this.handleColAdjust,scrollLeft:-(0,c.twipsToPx)(this.props.scrollLeft)*this.zoom,onEnterDragger:this.handleEnterColOrRowDragger.bind(this),onLeaveDragger:this.handleLeaveColOrRowDragger.bind(this)}))):null},t.prototype.renderTableScaleDragger=function(){var e=this.props.layoutBox.edge,t=(0,c.twipsToPx)(e.border.width.left);return this.props.shares.isEditable()&&(this.state.isTableActivited||this.state.showTableHeader)&&this.isEnableTableShortCuts?l().createElement(r.M5B,(0,a.__assign)({},{onFinish:this.onFinishResizeDrag,selTable:this.selTable.bind(this),zoom:this.zoom,width:this.props.rectSize.width+t,height:this.props.rectSize.height,nestingLevel:this.props.layoutBox.nestingLevel})):null},t.prototype.onSelectionEnd=function(e,t,o){var n=this.getRelativeBoxesOnSelectionEnd(e),i=function(e){var t=e.getRoot();if(!t)return null;var o=t.getElementsByClassName(r.F51.meloDocView);return 0===o.length?null:o[0]}(this.props.context);if(n&&(null==t?void 0:t.current)&&i){var a=n.cellBox,s=n.rowBox,l=t.current.getBoundingClientRect(),p=i.getBoundingClientRect(),h=l.left-p.left,d=e.clone().getDocumentOffset().x*this.zoom,u=this.tableScrollLeft+d-h,f=void 0;if(d<h){var g=u-this.props.rectSize.width+5;f=Math.max((0,c.twipsToPx)(tt(a,s)),g)}else{if(!(d>h+l.width))return;var v=tt(a,s)+a.totalWidth;f=Math.min((0,c.twipsToPx)(v)-this.props.rectSize.width,u-5)}o(this.props.cbKey,f,t.current.scrollTop),this.handleAutoHorizonScroll(f),this.props.context.fire(new r.Vy7)}return null},t.prototype.renderTableHeader=function(){var e;if(this.props.shares.isEditable()&&this.state.showTableHeader&&this.isEnableTableShortCuts){var t=null===(e=this.refTable.current)||void 0===e?void 0:e.getBoundingClientRect(),o=t?t.top:0;return l().createElement(r.xDH,(0,a.__assign)({},{cbKey:this.props.cbKey,rectSize:this.props.rectSize,contentSize:this.props.contentSize,layoutBox:this.props.layoutBox,context:this.props.context,shares:this.props.shares,zoom:this.zoom,scrollLeft:-(0,c.twipsToPx)(this.props.scrollLeft),selectedRange:this.state.selectedRange,selectedCellRanges:this.state.selectedCellRanges,draggerInfo:this.state.draggerInfo,showColAddIcon:this.state.showColAddIcon,showRowAddIcon:this.state.showRowAddIcon,tableScrollLeft:this.tableScrollLeft,tableScrollWidth:this.tableScrollWidth,tableRelativePos:this.props.tableRelativePos,tableRectTop:o},{nestingLevel:this.props.layoutBox.nestingLevel,onEnterAddColIcon:this.handleEnterAddColIcon.bind(this),onLeaveAddColIcon:this.handleLeaveAddColIcon.bind(this),onEnterAddRowIcon:this.handleEnterAddRowIcon.bind(this),onLeaveAddRowIcon:this.handleLeaveAddRowIcon.bind(this),showColsOrRowsMoveInstruction:this.showColsOrRowsMoveInstruction.bind(this),hideColsOrRowsMoveInstruction:this.hideColsOrRowsMoveInstruction.bind(this),selTable:this.selTable.bind(this)}))}return null},t.prototype.getCellBoxFromLeafBox=function(e){for(var t=e;t;){if((0,n.$5)(t)&&t.isRootNesting)return t;if((0,n.t$)(t))return null;t=t.parentBox}return null},t.prototype.shouldTableElementUpdate=function(e){return e.showTableHeader!==this.state.showTableHeader||e.isTableActivited!==this.state.isTableActivited||e.colGuiderShow!==this.state.colGuiderShow||e.rowGuiderShow!==this.state.rowGuiderShow},t.prototype.isLastTableBox=function(){return i.s9.getLastTableBox(this.props.layoutBox)===this.props.layoutBox},t.prototype.onScrollerDidMount=function(e){var t,o;this.tableScrollLeft=(null===(t=null==e?void 0:e.current)||void 0===t?void 0:t.scrollLeft)||0,this.tableScrollWidth=(null===(o=null==e?void 0:e.current)||void 0===o?void 0:o.clientWidth)||Number.MAX_SAFE_INTEGER},t.prototype.handleEnterAddColIcon=function(e){this.setState({colGuiderShow:!0,showColAddIcon:!0,colGuiderLeftPos:(e+this.tableScrollLeft+r.LV0/2)*this.zoom})},t.prototype.showColsOrRowsMoveInstruction=function(e,t){e!==r.n0j.Row?this.setState({colGuiderShow:!0,colGuiderLeftPos:t*this.zoom}):this.setState({rowGuiderShow:!0,rowGuiderTopPos:t*this.zoom})},t.prototype.hideColsOrRowsMoveInstruction=function(){this.setState({colGuiderShow:!1,rowGuiderShow:!1})},t.prototype.handleLeaveAddColIcon=function(){this.setState({colGuiderShow:!1,showColAddIcon:!1})},t.prototype.handleEnterAddRowIcon=function(e,t){this.setState({rowGuiderShow:!0,showRowAddIcon:!0,rowGuiderTopPos:(t+r.LV0/2)*this.zoom})},t.prototype.handleLeaveAddRowIcon=function(){this.setState({rowGuiderShow:!1,showRowAddIcon:!1})},t.prototype.isSelectionInCurrentTable=function(e){return this.props.shares.selectionOverlay.checkIfTable(this.props.layoutBox,e)},t.prototype.handleAutoHorizonScroll=function(e){0!==e&&this.onScroll&&this.onScroll()},t.prototype.initHeaderState=function(){if(this.isSelectionInCurrentTable()){var e=this.props.shares.state.selection.tableSelectionArea;if(e){var t=e.cellRanges,o=e.selectedRange;this.setState({selectedRange:o,isTableActivited:!0,showTableHeader:this.isEnableTableShortCuts,selectedCellRanges:t})}}},t.prototype.resetHeader=function(){this.setState({isTableActivited:!1,showTableHeader:!1,showColAddIcon:!1,showRowAddIcon:!1,colGuiderShow:!1,rowGuiderShow:!1,selectedRange:null,selectedCellRanges:[]})},t.prototype.getRelativeBoxesOnSelectionEnd=function(e){var t=this.getCellBoxFromLeafBox(e.leafBox);if(!t)return null;var o=t.parentBox;return o&&o.parentBox===this.props.layoutBox?{cellBox:t,rowBox:o}:null},t.prototype.showIcon=function(e,t){this.props.context.fire(new r.fyQ(e.getRangeBegin(),!0,t))},t.prototype.hideIcon=function(e){this.props.context.fire(new r.fyQ(e.getRangeBegin(),!1))},t.prototype.selTable=function(){var e=this.props,t=e.layoutBox;e.context.fire(new r.p1Y(t.getRangeBegin()))},t.prototype.modifyRowHeight=function(e,t,o,n){var i=t+o;this.props.context.fire(new r.LNB(e,i,n,this.nestingLevel))},t.prototype.modifyColWidth=function(e,t,o,n,i,a){var s,l,p;if(p="left"===n&&0===i?t-o:t+o,null===(l=null===(s=this.refTable.current)||void 0===s?void 0:s.parentElement)||void 0===l?void 0:l.parentElement){var h=this.refTable.current.parentElement.parentElement.getBoundingClientRect(),d=(0,c.pxToTwips)(a-h.left/this.zoom),u=(0,c.pxToTwips)(a-h.right/this.zoom+4);return this.props.context.fire(new r.LNB(e,p,n,this.nestingLevel,d,u)),void("left"===n&&o<0&&this.setState({draggerInfo:{edge:"none"}}))}this.props.context.fire(new r.LNB(e,p,n,this.nestingLevel))},t.prototype.advanceToBreakingTailBox=function(e){for(var t=0,o=e;o.prevPartial;)o=o.prevPartial;for(var n=o;n;){var r=n.parentBox;t+=r?r.rect.height:0,o=n,n=n.nextPartial}return{box:o,sumRowHeight:t}},t.prototype.getRenderRowHeightOfBox=function(e,t){var o=e;if("top"===t){var n=e.parentBox,r=e.logicIndex,i=n.prevSibling;i&&(o=i.children[r]||e)}var a=this.advanceToBreakingTailBox(o),s=a.box;if(void 0!==(null==s?void 0:s.mergedType)){var l=this.lastMergedBox(s);if(l&&l.parentBox)return l.parentBox.rect.height}return a.sumRowHeight},t.prototype.lastMergedBox=function(e){var t,o;if(!e.isMergeBegin)return null;var n=e;do{n=null===(o=null===(t=n.parentBox)||void 0===t?void 0:t.nextSibling)||void 0===o?void 0:o.children.find((function(t){return t.colBegin===e.colBegin}))}while(n&&void 0!==n.mergedType&&!n.isLastMerged);return n||null},t.prototype.getRenderColWidthOfBox=function(e){return e.paddingBoxSize.width},t.prototype.moveDraggerToBox=function(e,t,o){var n=this.props.layoutBox.edge.border.width,r=n.left,i=n.top,a=t.x+("right"===o?e.totalWidth:0);a-="right"===o?e.edge.border.width.right:r;var s=t.y+e.totalHeight-i,l=this.getValueRange(e,o),p=this.getRenderRowHeightOfBox(e,o),h=this.getRenderColWidthOfBox(e);this.setState({draggerInfo:{box:e,edge:o,valueRange:l,rowHeight:p,colWidth:h,left:(0,c.twipsToPx)(a)*this.zoom,top:(0,c.twipsToPx)(s)*this.zoom},isTableActivited:!0})},t.prototype.findCellBoxForPos=function(e,t){for(var o=r.d_x.createAllTableCellPointIterator(e,{x:0,y:0}),n=o.next();!n.done;){var i=n.value,a=i.layoutBox,s=i.offset;if(this.isPosInCellBox(t,s,a)){var l=this.findPosIfInCellBox(t,s,a);if(l)return l}n=o.next()}return{box:null,edge:"none",offset:{x:0,y:0}}},t.prototype.isPosInCellBox=function(e,t,o){var n=o.borderBoxSize,r=o.totalHeight;return e.x>t.x&&e.x<t.x+n.width&&e.y>t.y&&e.y<t.y+r},t.prototype.findPosIfInCellBox=function(e,t,o){var n=o.borderBoxSize,r=o.totalHeight;return 0===o.getSiblingIndex()&&Math.abs(e.x-t.x)<=rt?{box:o,edge:"left",offset:t}:Math.abs(n.width+t.x-e.x)<=rt?{box:o,edge:"right",offset:t}:void 0===o.mergedType&&Math.abs(r+t.y-e.y)<=rt?{box:o,edge:"bottom",offset:t}:null},t.prototype.getValueRange=function(e,t){var o=0;if("top"===t||"bottom"===t)o=e.totalHeight;else if("left"===t||"right"===t){var a=this.getRenderColWidthOfBox(e);if("left"===t&&0===e.getSiblingIndex()){var s=i.MM.getOffsetPoint(e,n.uO.Page).x;return[(0,c.twipsToPx)(s)+r.MYZ,(0,c.twipsToPx)(s+a)]}o=a}return[(0,c.twipsToPx)(o)]},t.prototype.getDistanceToTableLeft=function(e){var t;if(this.refTable.current){var o=e.clientX,n=null===(t=this.refTable.current)||void 0===t?void 0:t.getBoundingClientRect();return(0,c.pxToTwips)(o-n.left)/this.zoom+this.props.scrollLeft}},Object.defineProperty(t.prototype,"zoom",{get:function(){return this.props.shares.scrollHandler.zoom()},enumerable:!1,configurable:!0}),t}(l().Component),at=function(){function e(){this.renderers=[]}return e.prototype.addExtendRenderer=function(e){this.renderers.push(e)},e.prototype.removeAll=function(){this.renderers=[]},e.prototype.draw=function(e,t){this.renderers.map((function(o){return o.draw(e,t)}))},e.prototype.rendererCount=function(){return this.renderers.length},e}(),st=function(){function e(){this.map=new Map,this.map.set(r.Rli.Text,new at),this.map.set(r.Rli.Paragraph,new at),this.map.set(r.Rli.Page,new at),this.map.set(r.Rli.Textframe,new at),this.map.set(r.Rli.LeafContainer,new at),this.map.set(r.Rli.TextLineFragment,new at),this.map.set(r.Rli.TextLine,new at),this.map.set(r.Rli.OverlayParagraph,new at),this.map.set(r.Rli.OverlayTaskCheckbox,new at),this.map.set(r.Rli.OverlayTable,new at),this.map.set(r.Rli.Image,new at)}return e.prototype.getExtendRenderer=function(e){return this.map.get(e)},e.prototype.addExtendRenderer=function(e,t){var o=this.map.get(e);o&&o.addExtendRenderer(t)},e.prototype.removeAll=function(){this.map.forEach((function(e){e.removeAll()}))},e}(),lt=new Map,ct=function(e){function t(t,o,n,r,i,a){var s=e.call(this)||this;return s.shares=t,s.collectEngine=o,s.offset=n,s.viewRegion=r,s.contextState=i,s.isInHeaderFooter=a,s.offset=n,s}return(0,a.__extends)(t,e),t.prototype.getCurrentState=function(){return{offset:this.offset,viewRegion:this.viewRegion,zIndex:this.collectEngine.zIndex,contextState:this.contextState,docViewType:this.shares.docEnv.docViewType,isFocusHeaderFooter:this.shares.isFocusHeaderFooter,isInHeaderFooter:this.isInHeaderFooter}},t.prototype.isInFoucs=function(){return this.isInHeaderFooter&&this.shares.isFocusHeaderFooter||!this.isInHeaderFooter&&!this.shares.isFocusHeaderFooter},t.prototype.addView=function(e,t,o){void 0===t&&(t=r._AL.extend),void 0===o&&(o={clipOffsetX:0,clipOffsetWidth:0}),e instanceof Ae?this.addComponentView(e,t,o):this.addOtherView(e,t,o)},t.prototype.addComponentView=function(e,t,o){var n=e,i=this.getCustomViewData(o),a=i.clipOffsetX,s=i.clipOffsetWidth,l=i.offset,c=i.viewRegion,p=i.contextState,h=i.zIndex,d=(0,r.SsA)(e.frame.x+l.x,e.frame.y+l.y,e.frame.width,e.frame.height),u=d;if(null==p?void 0:p.clipInfo){var f=(0,r.SsA)((null==p?void 0:p.clipInfo.x)+a,(null==p?void 0:p.clipInfo.y)+c.y,(null==p?void 0:p.clipInfo.width)+s,null==p?void 0:p.clipInfo.height);u=(0,r.Aa5)(d,f)}u.width<0||u.height<0||(n.frame=d,n.contextState=(0,r.jVi)((null==p?void 0:p.clipInfo)?u:void 0),this.collectEngine.zIndex=h,this.collectEngine.collect(n,t))},t.prototype.addOtherView=function(e,t,o){var n=e,i=this.getCustomViewData(o),a=i.clipOffsetX,s=i.clipOffsetWidth,l=i.offset,c=i.viewRegion,p=i.contextState,h=i.zIndex;n.frame=(0,r.SsA)(e.frame.x+l.x,e.frame.y+l.y-c.y,e.frame.width,e.frame.height),(null==p?void 0:p.clipInfo)?n.contextState=(0,r.jVi)((0,r.SsA)((null==p?void 0:p.clipInfo.x)+a,null==p?void 0:p.clipInfo.y,(null==p?void 0:p.clipInfo.width)+s,null==p?void 0:p.clipInfo.height)):n.contextState=p,this.collectEngine.zIndex=h,this.collectEngine.collect(n,t)},t.prototype.createScrollElement=function(e){var t=this.shares.renderState.getScrollerInfo(e.props.cbKey)||{left:0,top:0},o=lt.get(e.componentClass);return o||(o=u(e.componentClass),lt.set(e.componentClass,o)),l().createElement(o,(0,a.__assign)({},e.props,{contentSize:{width:(0,c.twipsToPx)(e.contentSize.width),height:(0,c.twipsToPx)(e.contentSize.height)},rectSize:{width:(0,c.twipsToPx)(e.frame.width),height:(0,c.twipsToPx)(e.frame.height)},shares:this.shares,scrollLeft:(0,c.pxToTwips)(t.left),scrollTop:(0,c.pxToTwips)(t.top)}))},t.prototype.freezeWithClips=function(e){var t,o=null===(t=this.contextState)||void 0===t?void 0:t.clipInfo;if(o)return e?(0,c.twipsToPx)((null==o?void 0:o.x)-this.offset.x):(0,c.twipsToPx)((null==o?void 0:o.y)-this.offset.y)},t.obtain=function(e,o,n,r,i){var a=t.sPool.obtain();return a?(a.shares=e,a.collectEngine=o,a.offset=n,a.viewRegion=r,a.contextState=null==i?void 0:i.contextState,a.isInHeaderFooter=null==i?void 0:i.isInHeaderFooter):a=new t(e,o,n,r,null==i?void 0:i.contextState,null==i?void 0:i.isInHeaderFooter),a},Object.defineProperty(t.prototype,"containerFocus",{get:function(){return this.shares.containerFocus},enumerable:!1,configurable:!0}),t.prototype.recycle=function(){t.sPool.recycle(this)},t.prototype.getCustomViewData=function(e){var t,o,n,r,i,a;return{clipOffsetX:null!==(t=null==e?void 0:e.clipOffsetX)&&void 0!==t?t:0,clipOffsetWidth:null!==(o=null==e?void 0:e.clipOffsetWidth)&&void 0!==o?o:0,offset:null!==(n=null==e?void 0:e.offset)&&void 0!==n?n:this.offset,viewRegion:null!==(r=null==e?void 0:e.viewRegion)&&void 0!==r?r:this.viewRegion,contextState:null!==(i=null==e?void 0:e.contextState)&&void 0!==i?i:this.contextState,zIndex:null!==(a=null==e?void 0:e.zIndex)&&void 0!==a?a:this.collectEngine.zIndex}},t.sPool=new c.ObjectPool(100),t}(c.PoolNode),pt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.getScrollLeft=function(e){var t=e.layoutBox,o=e.shares,n=t.contentSize,i=t.rectSize;if(n.width>i.width){var a=o.renderState.getScrollerInfo((0,r.NQT)(t.tableId))||{left:0};return Math.min(Math.ceil(n.width-i.width)+(0,c.pxToTwips)(h),(0,c.pxToTwips)(a.left))}return o.renderState.setScrollerInfo((0,r.NQT)(t.tableId),{left:0,top:0}),0},t.prototype.getClipInfo=function(e){var t,o=e.layoutBox,n=e.offset,i=e.flags,a=e.checker,s=null===(t=null==i?void 0:i.contextState)||void 0===t?void 0:t.clipInfo;if(!o.isRootNesting)return s;var l=o.contentSize,c=o.rectSize;if(l.width>c.width){var p=Math.ceil(c.width+15),h=Math.ceil(c.height+15),d=(0,r.SsA)(n.x,n.y-a.incRegion.y,p,h);return s?(0,r.Aa5)(d,s):d}return s},t.prototype.render=function(e){var t,o=e.layoutBox,n=e.offset,i=e.appendBox,s=e.traversalRange,l=e.flags;if(!this.skipRender(e)){this.renderWrapper(e);var c=this.getScrollLeft(e),p=this.getClipInfo(e),h=(0,r.jVi)(p,null===(t=null==l?void 0:l.contextState)||void 0===t?void 0:t.textTransform);i({layoutBox:o,offset:{x:n.x-c,y:n.y},traversalRange:s,flags:(0,a.__assign)((0,a.__assign)({},l),{contextState:h})}),this.invokeExtendRenderer(r.Rli.OverlayTable,e)}},t.prototype.renderWrapper=function(e){var t=e.offset,o=e.collector,n=e.shares,i=e.layoutBox,a=e.context,s=i.contentSize,p=this.getScrollLeft(e),h=this.createTableFrame(e);if((0,r.UHV)(h)){var d=Ae.obtain("table-".concat(i.uuid),h,l().createElement(it,{scrollLeft:i.isRootNesting?p:h.x-t.x,scrollTop:0,cbKey:(0,r.NQT)(i.tableId),context:a,shares:n,layoutBox:i,tableRelativePos:{left:(0,c.twipsToPx)(h.x),top:(0,c.twipsToPx)(h.y)},contentSize:{width:(0,c.twipsToPx)(s.width),height:(0,c.twipsToPx)(s.height)},rectSize:{width:(0,c.twipsToPx)(h.width),height:(0,c.twipsToPx)(h.height)}}));o.collect(d,r._AL.tableWrapper)}},t.prototype.createTableFrame=function(e){var t,o,n,i=e.layoutBox,s=e.offset,l=e.checker,c=i.contentSize,p=i.edge,h=i.rectSize;if(i.isRootNesting||!(null===(o=null===(t=e.flags)||void 0===t?void 0:t.contextState)||void 0===o?void 0:o.clipInfo))return(0,r.SsA)(s.x+p.border.width.left/2,s.y+p.border.width.top/2,h.width+p.border.width.left,h.height+p.border.width.top);var d=null===(n=e.flags.contextState)||void 0===n?void 0:n.clipInfo;return(0,r.Aa5)((0,a.__assign)((0,a.__assign)({},d),{y:d.y+l.incRegion.y}),(0,r.SsA)(s.x,s.y,c.width,c.height))},t.prototype.invokeExtendRenderer=function(e,t){var o=t.layoutBox,n=t.shares,r=t.offset,i=t.collector,a=t.flags,s=t.checker,l=this.shares.extRendererManager.getExtendRenderer(e);if(null==l?void 0:l.rendererCount()){var c=ct.obtain(n,i,r,s.incRegion,a);l.draw(c,o),c.recycle()}},t}(Ke),ht=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.calClipRect=function(e,t,o,n){if(n){var i=(0,r.SsA)(t.x,t.y-o.incRegion.y,e.totalWidth,e.totalHeight),a=(0,r.Aa5)(i,n);return a.width<=0&&a.height<=0?{needCollect:!1,needClip:!1}:(0,r.bqj)(i,a)?{needCollect:!0,needClip:!1}:{needCollect:!0,needClip:!0}}return{needCollect:!0,needClip:!1}},t.prototype.render=function(e){var t,o,i,s=e.layoutBox,l=e.offset,c=e.traversalRange,p=e.appendBox,h=e.flags,d=e.checker;if(s.display!==n.gy.None){var u=this.calClipRect(s,l,d,null===(t=null==h?void 0:h.contextState)||void 0===t?void 0:t.clipInfo);if(u.needCollect){var f=u.needClip?null===(o=null==h?void 0:h.contextState)||void 0===o?void 0:o.clipInfo:void 0,g=this.renderOverlay(e,f);this.renderCellBackgroundColor(e,f);var v=this.createContentClip(e),y=(0,r.jVi)(v,null===(i=null==h?void 0:h.contextState)||void 0===i?void 0:i.textTransform);p({layoutBox:s,offset:l,traversalRange:c,flags:(0,a.__assign)((0,a.__assign)({},h),{contextState:y,disableSelection:g})}),this.renderTableBorder(e,f)}}},t.prototype.collectBorderRenderStyle=function(e){var t=n.vW.none,o=e.property.tcBorders,r=o.left,i=o.right,a=o.top,s=o.bottom;return t.color.left=r.color,t.color.right=i.color,t.color.top=a.color,t.color.bottom=s.color,t.style.left=r.val,t.style.right=i.val,t.style.top=a.val,t.style.bottom=s.val,t},t.prototype.renderTableBorder=function(e,t){var o=e.collector,r=e.layoutBox,i=e.flags;if(r.display){var a=this.ensureSharp(e),s=r.edge.border,l=this.collectBorderRenderStyle(r),c=r.parentBox,p=null==c?void 0:c.parentBox;if(s&&(0,n.$5)(r)&&c&&p){var h=p.firstVisibleChild===c;c.firstVisibleChild===r&&this.drawLeftBorder(s,l,o,a,i,t,p.edge.border.width.left),h&&this.drawTopBorder(s,l,o,a,i,t,p.edge.border.width.top||f.keb.tableBorderWidth),this.drawRightBorder(s,l,o,a,i,t),this.drawBottomBorder(s,l,o,a,i,t),this.drawLoseTopBorder(r,s,l,o,a,i,t)}}},t.prototype.renderCellBackgroundColor=function(e,t){var o=e.layoutBox,n=e.collector,i=e.offset,a=e.checker,s=e.flags,l=o.property.shd.fill;if(l&&l!==f.oPf.auto&&l!==f.oPf.undefined){var c=(0,r.SsA)(i.x,i.y-a.incRegion.y,o.totalWidth,o.totalHeight),p=r.vW8.computeHeaderFooterFocusStyles(this.shares.docEnv.docViewType,this.shares.isFocusHeaderFooter,null==s?void 0:s.isInHeaderFooter),h=Le.obtain(c,{fillColor:f.QBv.parseHexColor(l,f.keb.bgColor),radius:0,opacity:p.opacity},(0,r.jVi)(t));n.collect(h,r._AL.tableCellBackground)}},t.prototype.renderOverlay=function(e,t){var o=e.collector,i=e.layoutBox,a=e.offset,s=e.shares,l=e.checker;if(i.mergedType===n.Wl.Hidden)return!1;var c=s.selectionOverlay.checkCellOverlay(i);if(!c)return!1;var p=c.meta(),h=(0,r.SsA)(a.x,a.y-l.incRegion.y,i.totalWidth,i.totalHeight),d=Le.obtain(h,p.backgroundColor,(0,r.jVi)(t));return o.collect(d,p.priority),i.edge.recycle(),!0},t.prototype.getBorderColor=function(e,t){return(0,r.vQ7)(f.QBv.parseHexColor(e.color[t]))},t.prototype.drawTopBorder=function(e,t,o,i,a,s,l){if(!this.isInvisibleBorder(t.style.top)){var c=i.leftLineX,p=i.topLineY,h=i.rightLineX,d=r.vW8.computeHeaderFooterFocusStyles(this.shares.docEnv.docViewType,this.shares.isFocusHeaderFooter,null==a?void 0:a.isInHeaderFooter),u=l||e.width.top,f=Me.obtain((0,r.L9X)(c-u/2,p,h-u/2,p),{color:this.getBorderColor(t,"top"),width:u,style:n.TD.single,opacity:d.opacity},(0,r.jVi)(s));o.collect(f)}},t.prototype.drawLeftBorder=function(e,t,o,i,a,s,l){if(!this.isInvisibleBorder(t.style.left)){var c=i.leftLineX,p=i.topLineY,h=i.bottomLineY,d=r.vW8.computeHeaderFooterFocusStyles(this.shares.docEnv.docViewType,this.shares.isFocusHeaderFooter,null==a?void 0:a.isInHeaderFooter),u=l||e.width.left,f=Me.obtain((0,r.L9X)(c,p+u/2,c,h+u/2),{color:this.getBorderColor(t,"left"),width:u,style:n.TD.single,opacity:d.opacity},(0,r.jVi)(s));o.collect(f)}},t.prototype.drawRightBorder=function(e,t,o,i,a,s){if(!this.isInvisibleBorder(t.style.right)){var l=i.rightLineX,c=i.topLineY,p=i.bottomLineY,h=r.vW8.computeHeaderFooterFocusStyles(this.shares.docEnv.docViewType,this.shares.isFocusHeaderFooter,null==a?void 0:a.isInHeaderFooter),d=e.width.right,u=Me.obtain((0,r.L9X)(l,c-d/2,l,p-d/2),{color:this.getBorderColor(t,"right"),width:d,style:n.TD.single,opacity:h.opacity},(0,r.jVi)(s));o.collect(u)}},t.prototype.drawBottomBorder=function(e,t,o,i,a,s){if(!this.isInvisibleBorder(t.style.bottom)){var l=i.rightLineX,c=i.leftLineX,p=i.bottomLineY,h=r.vW8.computeHeaderFooterFocusStyles(this.shares.docEnv.docViewType,this.shares.isFocusHeaderFooter,null==a?void 0:a.isInHeaderFooter),d=e.width.bottom,u=Me.obtain((0,r.L9X)(c+d/2,p,l+d/2,p),{color:this.getBorderColor(t,"bottom"),width:d,style:n.TD.single,opacity:h.opacity},(0,r.jVi)(s));o.collect(u)}},t.prototype.drawLoseTopBorder=function(e,t,o,n,r,i,s){var l,c=null===(l=e.parentBox)||void 0===l?void 0:l.prevSibling;if(c&&c.firstChild&&c.lastChild){var p=c.lastChild.colBegin+c.lastChild.totalWidth,h=c.firstChild.colBegin,d=e.colBegin+e.totalWidth;(d>p||e.colBegin<h)&&(e.colBegin>p||d<h||e.colBegin<h&&d>p?this.drawTopBorder(t,o,n,r,i,s):this.drawTopBorder(t,o,n,(0,a.__assign)((0,a.__assign)({},r),{leftLineX:p<d?r.leftLineX+(p-e.colBegin):r.leftLineX-f.keb.tableBorderWidth/2,rightLineX:e.colBegin<h?r.rightLineX-(d-h):r.rightLineX}),i,s))}},t.prototype.isInvisibleBorder=function(e){return e===f.EJ9.none||e===f.EJ9.nil||e===f.EJ9.undefined},t.prototype.getSharpTwips=function(e){var t=(0,c.twipsToPx)(e);return(0,c.pxToTwips)(Math.round(t)+.5)},t.prototype.ensureSharp=function(e){var t=e.layoutBox,o=e.offset,n=e.checker,r=t.totalWidth,i=t.totalHeight;return{leftLineX:this.getSharpTwips(o.x),topLineY:this.getSharpTwips(o.y-n.incRegion.y),rightLineX:this.getSharpTwips(o.x+r),bottomLineY:this.getSharpTwips(o.y+i-n.incRegion.y)}},t.prototype.createContentClip=function(e){var t,o=e.layoutBox,n=e.offset,i=e.flags,a=e.checker,s=(0,r.SsA)(n.x,n.y-a.incRegion.y,o.paddingBoxSize.width,o.paddingBoxSize.height);return(null===(t=null==i?void 0:i.contextState)||void 0===t?void 0:t.clipInfo)?(0,r.Aa5)(i.contextState.clipInfo,s):s},t}(Ke),dt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.render=function(e){var t,o=e.offset,i=e.layoutBox,a=e.collector,s=e.flags,l=e.checker,c=this.generateViewFrame(e),p=c.frame,h=c.clipFrame;if((0,r.UHV)(p)||(0,n.qM)(i)){this.collectContainerView(e,p,h);var d=this.shares.extRendererManager.getExtendRenderer(r.Rli.LeafContainer);if(null==d?void 0:d.rendererCount()){(null==s?void 0:s.contextState)&&(0,n.eJ)(i)&&i.independentRender&&(s.contextState=(0,r.jVi)((null===(t=null==s?void 0:s.contextState)||void 0===t?void 0:t.clipInfo)?h:void 0));var u=ct.obtain(this.shares,a,{x:p.x,y:p.y},l.incRegion,s);d.draw(u,i),u.recycle()}if(!this.skipRender(e)&&(0,n.qM)(i)&&f.Cf9.shouldUseCanvasRender(i.property)){var g=this.shares.extRendererManager.getExtendRenderer(r.Rli.Image);(null==g?void 0:g.rendererCount())&&(u=ct.obtain(this.shares,a,o,l.incRegion,s),g.draw(u,i),u.recycle())}}},t.prototype.generateViewFrame=function(e){var t=e.offset,o=e.layoutBox,a=e.flags,s=e.checker,l=((0,n.vv)(o)?o.getOriginSizeBox():o).positionBoxSize,c=t.x,p=t.y,h=(0,r.SsA)(c,p,l.width,l.height),d=this.checkClipInfoAndModifyFrame(h,a,s);if((0,n.eJ)(o)&&o.independentRender){var u=o.getAncestorOf(n.uO.Page);if(u){var f=i.MM.getOffsetPoint(u,n.uO.Document),g=f.x,v=f.y;h.x+=g,h.y+=v,d.x+=g,d.y+=v}}return{frame:h,clipFrame:d}},t.prototype.collectContainerView=function(e,t,o){if(!this.skipRender(e)){var n=e.shares,i=e.layoutBox,a=e.collector,s=n.containerRenderManager.renderContainerBox(i,n.containerFocus);if(s){var l=this.generateContainerOrAnchorView(e,t,o,s);if(null===l)return;a.collect(l,r._AL.componentElement)}}},t.prototype.generateContainerOrAnchorView=function(e,t,o,i){var a=e.layoutBox,s=e.flags,l=e.renderRootBox,c=e.pageIndex,p=e.shares;if(!l)return null;var h,d=s||{},u=d.isInHeaderFooter,g=d.contextState,v=p.isFocusHeaderFooter,y=p.docEnv;if((0,n.vv)(a)){var x=l.children[c||0],w=this.getRenderPageSize(x),m=x.getOuterPoint().y;h=ke.computeContainerStyles(a,o,y.docViewType,v,u);var S=!1;return a.property instanceof f.kkf.getPropertyClass(f.uSS.DrawingProperty)&&(S=a.property.anchor.behindDoc),ke.obtain(a.key,t,i,h,(0,r.jVi)((null==g?void 0:g.clipInfo)?o:void 0),S,{pageSize:w,pageOffsetY:m,pageIndex:c||0})}return h=Ae.computeContainerStyles(a,o,y.docViewType,v,u),Ae.obtain(a.key,t,i,h,(0,r.jVi)((null==g?void 0:g.clipInfo)?o:void 0))},t.prototype.getRenderPageSize=function(e){if(!e)return{width:0,height:0,marginBottom:0};var t=(0,c.twipsToPx)(e.edge.margin.bottom);return{width:(0,c.twipsToPx)(e.rect.width),height:(0,c.twipsToPx)(e.rect.height),marginBottom:t}},t.prototype.checkClipInfoAndModifyFrame=function(e,t,o){var n,i=(0,r.VI0)(e),a=null===(n=null==t?void 0:t.contextState)||void 0===n?void 0:n.clipInfo;if(a){var s=(0,r.SsA)(a.x,a.y+o.incRegion.y,a.width,a.height);i=(0,r.Aa5)(e,s)}return i},t}(Ke),ut=function(){function e(){}return e.getComputeStyles=function(e){if(this.cssCache.has(e.uuid))return this.cssCache.get(e.uuid);var t=r.vW8.computeStyles(e);return this.cssCache.set(e.uuid,t),t},e.clear=function(){this.cssCache.clear()},e.cssCache=new r.cUw(1e4),e}(),ft=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.render=function(e){var t=e.layoutBox;t.parentBox&&(0,n.tq)(t.parentBox)||this.renderText(e)},t.prototype.renderText=function(e){var t=e.collector,o=e.layoutBox,n=e.offset,s=e.flags,l=e.checker,c=(0,f.GDL)(o.getRenderString());if(c){var p=ut.getComputeStyles(o).cssProperties,h=r.vW8.computeHeaderFooterFocusStyles(this.shares.docEnv.docViewType,this.shares.isFocusHeaderFooter,null==s?void 0:s.isInHeaderFooter);p=(0,a.__assign)((0,a.__assign)({},p),h);var d=n.x,u=n.y+o.ascent-l.incRegion.y,g=p.color,v=!1;o instanceof i.w8||o.textStyle.diff!==f.UuS.Minus&&o.textStyle.diff!==f.UuS.Plus||(o.textStyle.diff===f.UuS.Minus&&(v=!0),g=r.vW8.getDiffColorStyle(o.textStyle.author).color),g=this.colorAdapter(s,g),p=(0,a.__assign)((0,a.__assign)({},p),{color:g}),u=r.d_x.textBoxVerticalAlignAdapter(o,u);var y=(0,r.SsA)(d,u,o.totalWidth,o.totalHeight),x=U.obtain(y,c,{uuid:o.uuid,diffThrough:v,isTaskDone:null==s?void 0:s.isTaskDone},p,null==s?void 0:s.contextState);t.collect(x),this.extendRenderDraw(e)}},t.prototype.colorAdapter=function(e,t){if(!e||!t||!e.isQuote&&!e.isTaskDone)return t;var o=g.u$.rgb2hex(t);return e.isTaskDone?g.u$.hex2rgbaStr("".concat(o||t,"4C")):g.u$.hex2rgbaStr("".concat(o||t,"C0"))},t.prototype.extendRenderDraw=function(e){var t=e.collector,o=e.layoutBox,n=e.offset,i=e.flags,a=e.checker,s=this.shares.extRendererManager.getExtendRenderer(r.Rli.Text);if(null==s?void 0:s.rendererCount()){var l=ct.obtain(this.shares,t,n,a.incRegion,i);s.draw(l,o),l.recycle()}},t}(Ke),gt=function(e,t){this.width=e,this.height=t},vt=function(e){function t(t,o,n){void 0===n&&(n={points:[]});var r=e.call(this,t,o)||this;return r.path=n,r}return(0,a.__extends)(t,e),t.prototype.getGraphicType=function(){return r.ddz.WaveLine},t.prototype.getPath=function(){for(var e=[],t=(0,c.pxToTwips)(2),o=this.height-t,n=0;n<this.width/t;n++)e.push({x:n*t,y:(n%2==0?t:0)+o});return{points:e}},t}(gt),yt=function(e){function t(t,o,n){void 0===n&&(n={points:[]});var r=e.call(this,t,o)||this;return r.path=n,r}return(0,a.__extends)(t,e),t.prototype.getPath=function(){return this.path},t.prototype.getGraphicType=function(){return r.ddz.Customize},t}(gt),xt=function(){function e(){}return e.getGraphicComponent=function(e,t,o,n){return e===r.ddz.WaveLine?new vt(t,o):new yt(t,o,n)},e.getPath=function(t,o,n){return e.getGraphicComponent(t,o,n).getPath()},e}(),wt=function(e){function t(t,o,n){var r=e.call(this,t,o)||this;return r.textBoxRender=n,r}return(0,a.__extends)(t,e),t.prototype.render=function(e){var t,o=e.layoutBox,s=e.offset,l=e.appendBox,c=e.traversalRange,p=e.flags;o.children.length&&(0,n.Jt)(o.children[0])||this.renderOverlay(e);var h=this.getClipInfo(e),d=(0,r.jVi)(h,null===(t=null==p?void 0:p.contextState)||void 0===t?void 0:t.textTransform);l({layoutBox:o,offset:s,traversalRange:c,flags:(0,a.__assign)((0,a.__assign)({},p),{contextState:d})}),o instanceof i.vm&&o.listMark&&this.renderListMark((0,a.__assign)((0,a.__assign)({},e),{layoutBox:o.listMark})),this.shouldShowPlaceholder(o)&&this.renderPlaceholder(e)},t.prototype.renderListMark=function(e){var t=e.layoutBox,o=t.lineBox,n=t.getOuterPoint(),s={x:e.offset.x+n.x,y:e.offset.y+n.y},l=e.flags;if(l&&(l=(0,a.__assign)({isTaskDone:!1},e.flags)),this.textBoxRender.renderText((0,a.__assign)((0,a.__assign)({},e),{offset:s,flags:l})),o&&o instanceof i.vm){var p=(0,c.pxToTwips)(1);this.invokeExtendRenderer(r.Rli.OverlayTaskCheckbox,(0,a.__assign)((0,a.__assign)({},e),{offset:s,flags:l}),{x:p,y:p})}},t.prototype.renderPlaceholder=function(e,t){this.invokeExtendRenderer(r.Rli.TextLine,e,t)},t.prototype.invokeExtendRenderer=function(e,t,o){var n=t.layoutBox,r=t.shares,i=t.offset,a=t.collector,s=t.flags,l=t.checker,p=o?{x:(0,c.pxToTwips)(Math.ceil((0,c.twipsToPx)(i.x)))+o.x,y:(0,c.pxToTwips)(Math.ceil((0,c.twipsToPx)(i.y)))+o.y}:i,h=this.shares.extRendererManager.getExtendRenderer(e);if(null==h?void 0:h.rendererCount()){var d=ct.obtain(r,a,p,l.incRegion,s);h.draw(d,n),d.recycle()}},t.prototype.renderOverlay=function(e){var t=this,o=e.layoutBox,n=e.collector,i=e.offset,a=e.shares,s=e.flags,l=e.checker,p=o.edge,h=o.totalHeight,d=o.rect.height;a.overlays.buildCanvasOverlay(o).forEach((function(e){var o=e.meta();if(!(null==s?void 0:s.disableSelection)||!o.isTextSelection){var a=h,u=0;switch(o.heightType){case r.YQK.Source:a=d,u=p.padding.top;break;case r.YQK.Total:a=h;break;case r.YQK.StrokeUnderLine:a=(null==o?void 0:o.height)||(0,c.pxToTwips)(1),u=p.padding.top+d+(0,c.pxToTwips)(2)-a}var f=(0,r.SsA)(o.left+i.x,i.y+u-l.incRegion.y,o.width,a),g=r.vW8.computeHeaderFooterFocusStyles(t.shares.docEnv.docViewType,t.shares.isFocusHeaderFooter,null==s?void 0:s.isInHeaderFooter);if(o.overlayType===r.iz9.OverlayView){var v=Le.obtain(f,{fillColor:o.backgroundColor,radius:0,opacity:g.opacity},null==s?void 0:s.contextState);n.collect(v,o.priority)}else if(o.overlayType===r.iz9.GraphicView){var y=xt.getPath(o.graphicType,o.width,a),x=Ee.obtain(f,o.backgroundColor,y,null==s?void 0:s.contextState,!1);n.collect(x,o.priority)}}})),p.recycle()},t.prototype.getClipInfo=function(e){var t,o,i,a,s=e.layoutBox,l=e.offset,c=e.flags,p=e.checker;if(null===(t=null==c?void 0:c.contextState)||void 0===t?void 0:t.textTransform)return c.contextState.clipInfo;var h=this.calcAllowOverflowEdge(e),d=s.getAncestorOf(n.uO.Page),u=(0,r.SsA)(0,-p.incRegion.y+l.y-h.top,null!==(o=null==d?void 0:d.totalWidth)&&void 0!==o?o:99999,s.totalHeight+h.bottom+h.top);return(null===(i=null==c?void 0:c.contextState)||void 0===i?void 0:i.clipInfo)?(0,r.Aa5)(null===(a=null==c?void 0:c.contextState)||void 0===a?void 0:a.clipInfo,u):u},t.prototype.calcAllowOverflowEdge=function(e){var t=e.layoutBox,o=t.getAncestorOf(n.uO.Paragraph);if(!o)return n.Wh.getNone(0);var r=o.children[0]===t,i=o.children[o.children.length-1]===t;return new n.Wh({top:r?o.edge.margin.top:0,bottom:i?o.edge.margin.bottom:0,left:o.edge.margin.left,right:o.edge.margin.right})},t.prototype.renderAuxiliaryLine=function(e){var t=e.layoutBox,o=e.collector,n=e.offset,r=e.flags,i=e.checker,a=t.edge,s=new c.MeloRect({x:n.x-a.margin.left,y:n.y-a.margin.top,width:t.totalWidth,height:t.totalHeight});this.renderRectBorder(s,o,i,r),s=new c.MeloRect({x:n.x+a.padding.left,y:n.y+a.padding.top,width:t.rect.width,height:t.rect.height}),this.renderRectBorder(s,o,i,r),s=new c.MeloRect({x:n.x+a.padding.left,y:n.y+a.padding.top,width:t.rect.width,height:t.rect.height}),this.renderRectBorder(s,o,i,r),a.recycle()},t.prototype.shouldShowPlaceholder=function(e){var t=e.parentBox;if(!(0,n.o7)(e)||!t)return!1;if((0,n.wS)(t)&&e.isFirst&&r.d_x.isFirstParaOfDoc(t)&&r.d_x.isEmpytPara(t))return!0;var o=t.prevSibling;return!!((0,n.wS)(o)&&e.isFirst&&r.d_x.isFirstParaOfDoc(o)&&r.d_x.isEmpytPara(t))},t}(Ke),mt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.render=function(e){var t=e.layoutBox,o=e.offset,r=e.appendBox,i=e.traversalRange,a=e.flags;(0,n.Eb)(t)&&r({layoutBox:t,offset:o,traversalRange:i,flags:a})},t}(Ke),St=function(e){function t(t,o){return e.call(this,t,o)||this}return(0,a.__extends)(t,e),t.prototype.render=function(e){var t=e.layoutBox,o=e.offset,n=e.traversalRange,i=e.appendBox,s=e.flags,l=this.isTaskDone(t),c=t.property.blockQuote;i({layoutBox:t,offset:o,traversalRange:n,flags:(0,a.__assign)((0,a.__assign)({},s),{isTaskDone:l,isQuote:c})}),this.invokeExtendRenderer(r.Rli.OverlayParagraph,e),this.renderBorder(e),this.isHintPara(t)&&this.invokeExtendRenderer(r.Rli.Paragraph,e),s&&s.storyType===f.AHI.textboxContent&&this.invokeExtendRenderer(r.Rli.Paragraph,e)},t.prototype.isHintPara=function(e){return e.property.hintType},t.prototype.isTaskDone=function(e){var t=e.property;return t instanceof f.Jhz&&t.isTask&&t.taskPr.taskState===f.RWe.done},t.prototype.collectBorderRenderStyle=function(e){var t=n.vW.none,o=e.property.pBdr;if(o.has(f.kkf.getPropertyClass(f.uSS.CTPBdr).tKeys.left)){var r=o.left;t.color.left=r.color,t.style.left=r.val,t.lineSz.left=this.getBorderLineSz(r)}if(o.has(f.kkf.getPropertyClass(f.uSS.CTPBdr).tKeys.right)){var i=o.right;t.color.right=i.color,t.style.right=i.val,t.lineSz.right=this.getBorderLineSz(i)}if(o.has(f.kkf.getPropertyClass(f.uSS.CTPBdr).tKeys.top)){var a=o.top;t.color.top=a.color,t.style.top=a.val,t.lineSz.top=this.getBorderLineSz(a)}if(o.has(f.kkf.getPropertyClass(f.uSS.CTPBdr).tKeys.bottom)){var s=o.bottom;t.color.bottom=s.color,t.style.bottom=s.val,t.lineSz.bottom=this.getBorderLineSz(s)}return t},t.prototype.getBorderLineSz=function(e){return[f.EJ9.undefined,f.EJ9.nil,f.EJ9.none].includes(e.val)?0:(0,c.ptToTwips)(e.sz/8)},t.prototype.renderBorder=function(e){var t=e.layoutBox,o=e.offset,n=e.checker,i=t.edge,a=i.border,s=this.collectBorderRenderStyle(t);if(a.width.left>0&&s.lineSz.left>0){var l=o.x+a.width.left/2,c=o.y+a.width.top,p=l,h=o.y+t.borderBoxSize.height-a.width.bottom,d=(0,r.L9X)(l,c-n.incRegion.y,p,h-n.incRegion.y);this.collectBorderLine(e,s.lineSz.left,s.color.left,s.style.left,d)}a.width.right>0&&s.lineSz.right>0&&(l=o.x+t.borderBoxSize.width-a.width.right/2,c=o.y+a.width.top,p=l,h=o.y+t.borderBoxSize.height-a.width.bottom,d=(0,r.L9X)(l,c-n.incRegion.y,p,h-n.incRegion.y),this.collectBorderLine(e,s.lineSz.right,s.color.right,s.style.right,d)),a.width.top>0&&s.lineSz.top>0&&(l=o.x,c=o.y+a.width.top/2,p=o.x+t.borderBoxSize.width,h=c,d=(0,r.L9X)(l,c-n.incRegion.y,p,h-n.incRegion.y),this.collectBorderLine(e,s.lineSz.top,s.color.top,s.style.top,d)),a.width.bottom>0&&s.lineSz.bottom>0&&(l=o.x,c=o.y+t.borderBoxSize.height-a.width.bottom/2,p=o.x+t.borderBoxSize.width,h=c,d=(0,r.L9X)(l,c-n.incRegion.y,p,h-n.incRegion.y),this.collectBorderLine(e,s.lineSz.bottom,s.color.bottom,s.style.bottom,d)),i.recycle()},t.prototype.collectBorderLine=function(e,t,o,i,a){var s,l,c=n.TD.none;Object.keys(n.TD).map((function(e){return"STBorder_".concat(e)})).includes(i)?c=i.slice("STBorder_".length):[f.EJ9.undefined,f.EJ9.nil,f.EJ9.none].includes(i)||(c=n.TD.single);var p=e.collector,h=e.flags,d=e.layoutBox,u=e.offset,g=e.checker,v=null===(s=null==h?void 0:h.contextState)||void 0===s?void 0:s.clipInfo;if(i===f.EJ9.wave||i===f.EJ9.doubleWave){var y=(0,r.SsA)(u.x,u.y-g.incRegion.y,d.borderBoxSize.width,d.borderBoxSize.height);v=v?(0,r.Aa5)(v,y):y}var x=r.vW8.computeHeaderFooterFocusStyles(this.shares.docEnv.docViewType,this.shares.isFocusHeaderFooter,null==h?void 0:h.isInHeaderFooter),w=Me.obtain(a,{color:(0,r.vQ7)(f.QBv.parseHexColor(o)),width:t,style:c,opacity:x.opacity},(0,r.jVi)(v,null===(l=null==h?void 0:h.contextState)||void 0===l?void 0:l.textTransform));p.collect(w)},t.prototype.invokeExtendRenderer=function(e,t){var o=t.layoutBox,n=t.shares,r=t.offset,i=t.collector,a=t.flags,s=t.checker,l=this.shares.extRendererManager.getExtendRenderer(e);if(null==l?void 0:l.rendererCount()){var c=ct.obtain(n,i,r,s.incRegion,a);l.draw(c,o),c.recycle()}},t.prototype.renderTextframeParagraph=function(e){this.invokeExtendRenderer(r.Rli.Paragraph,e)},t}(Ke),bt=o(60126),Ct=function(){function e(){}return e.collectDrawingView=function(e){var t=e.layoutBox,o=e.collector,n=e.offset,i=e.checker,a=e.shares,s=t.getOriginSizeBox(),l=s.property,c=s.positionBoxSize,p=s.positionOutset,h=s.textboxProperty,d=s.uuid,u=s.contentSize;if(l&&[f.HgR.WordprocessingShape,f.HgR.WordprocessingGroupShape].includes(l.drawingType)&&(!h||![f.Xbc.CodeBlock,f.Xbc.LightBlock].includes(h.textBoxType))){var g=(0,r.SsA)(n.x+p.left,n.y+p.top-i.incRegion.y,c.width,c.height);if((0,r.UHV)(g)){var v=a.state.dataEngine.getDataManager().getThemeManager(),y=l.clone(),x=y.drawing.graphic.graphicData,w=y.drawing,m=w.extent,S=w.effectExtent;if(x.isEmpty(x.tKeys.wgp)){var b=this.generateSingleGraphicView(x.wsp,g,S,v);o.collect(b,r._AL.codeblockBackground)}else{var C=x.wgp,T=this.calcGroupResizeRate(x.wgp.grpSpPr.xfrm,m),_=new Be(d,g,u);this.collectGraphicGroup(_,C,S,g,o,T,v)}}}},e.calcGroupResizeRate=function(e,t){var o=t||e.ext,n=o.cx,r=o.cy,i=e.chExt;return{widthRate:n/i.cx,heightRate:r/i.cy}},e.collectGraphicGroup=function(e,t,o,n,i,a,s){var l=this;t.egWordprocessingGroupMsWpg.forEach((function(c){if(c.Choice.propertyType===f.uSS.CTWordprocessingShapeMsWps){var p=l.generateSingleGraphicView(c.Choice,n,o,s,t.grpSpPr.xfrm,a);e.addSubview(p),i.collect(p,r._AL.mainText)}c.Choice.propertyType===f.uSS.CTWordprocessingGroupMsWpg&&l.collectGraphicGroup(e,c.Choice,o,n,i,a,s)})),i.collect(e,r._AL.mainText)},e.generateSingleGraphicView=function(e,t,o,n,r,i){var a=e.spPr,s=this.generateSubFrame(a,t,r,i),l=this.getPath(a),c=this.getShapeFillStyle(e,n),p=this.getStrokeStyle(e,n),h=this.getFilter(e,n);return Ve.obtain({frame:s,path:l,effectExtent:o,fillStyle:c,strokeStyle:p,filter:h})},e.generateSubFrame=function(e,t,o,n){var r=e.xfrm,i=r.off,a=r.ext,s=r.rot,l=i.x,p=i.y,h=a.cx,d=a.cy,u=f.Su2.angleToDegree(s),g=t.x,v=t.y,y=t.width,x=t.height;if(o&&n){var w=n.widthRate,m=n.heightRate;g+=(0,c.emuToTwips)((l+o.off.x)*w),v+=(0,c.emuToTwips)((p+o.off.y)*m),y=(0,c.emuToTwips)(h*w),x=(0,c.emuToTwips)(d*m)}return{left:g,top:v,width:y,height:x,rotate:u}},e.getPath=function(e){return{type:this.getGraphicType(e),controlValues:this.getControlValues(e.prstGeom.avLst),pathList:this.getPathList(e)}},e.getStrokeStyle=function(e,t){var o=e.spPr,n=this.getLineFillStyle(e,t),r=(0,c.ptToPx)(f.Su2.emuToPt(o.ln.w)||1),i=this.getPrstType(o.ln.egLineDashProperties.prstDash),a=this.getLineCap(this.getPrstType(o.ln.cap)),s=this.getLineJoin(o.ln.egLineJoinProperties),l={lineEndType:this.getPrstType(o.ln.headEnd.type)},p={lineEndType:this.getPrstType(o.ln.tailEnd.type)};return{fillStyle:n,type:i||se.nZ.SOLID,lineWidth:r,lineCap:a,lineJoin:s,headEnd:l,tailEnd:p}},e.getGraphicType=function(e){return this.getPrstType(e.prstGeom.prst)||se.wf.CUSTOM},e.getPathList=function(e){var t=this,o=[];return e.custGeom.pathLst.path.forEach((function(e){o.push({pathString:t.parsePathString(e.egPath2D),width:f.Su2.emuToPt(e.w),height:f.Su2.emuToPt(e.h)})})),o},e.parsePathString=function(e){var t=this,o="";return e.forEach((function(e){if(e.Choice)switch(e.Choice.propertyType){case f.uSS.CTPath2DMoveTo:o="".concat(o," ").concat(t.moveTo(e));break;case f.uSS.CTPath2DLineTo:o="".concat(o," ").concat(t.lineTo(e));break;case f.uSS.CTPath2DArcTo:o="".concat(o," ").concat(t.arcTo(e));break;case f.uSS.CTPath2DQuadBezierTo:o="".concat(o," ").concat(t.quadBezierTo(e));break;case f.uSS.CTPath2DCubicBezierTo:o="".concat(o," ").concat(t.cubicBezierTo(e))}else o="".concat(o," Z")})),o},e.moveTo=function(e){var t=e.moveTo.pt;return v("M {x} {y}",{x:f.Su2.emuToPt(t.x.coordinate),y:f.Su2.emuToPt(t.y.coordinate)})},e.lineTo=function(e){var t=e.lnTo.pt;return v("L {x} {y}",{x:f.Su2.emuToPt(t.x.coordinate),y:f.Su2.emuToPt(t.y.coordinate)})},e.arcTo=function(e){var t=e.arcTo,o=t.wR,n=t.hR,r=t.stAng,i=t.swAng,a=f.Su2.emuToPt(o.coordinate),s=f.Su2.emuToPt(n.coordinate),l=r.angle%(2*Math.PI),c=i.angle%(2*Math.PI);return v("A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}",{rx:a,ry:s,xAxisRotation:l,largeArcFlag:0,sweepFlag:1,endX:a*Math.cos(c),endY:s*Math.sin(c)})},e.quadBezierTo=function(e){var t,o,n,r,i=e.quadBezTo.pt;return v("Q {cpx} {cpy} {x} {y}",{cpx:f.Su2.emuToPt((null===(t=i.getProperty(0))||void 0===t?void 0:t.x.coordinate)||0),cpy:f.Su2.emuToPt((null===(o=i.getProperty(0))||void 0===o?void 0:o.y.coordinate)||0),x:f.Su2.emuToPt((null===(n=i.getProperty(1))||void 0===n?void 0:n.x.coordinate)||0),y:f.Su2.emuToPt((null===(r=i.getProperty(1))||void 0===r?void 0:r.y.coordinate)||0)})},e.cubicBezierTo=function(e){var t,o,n,r,i,a,s=e.cubicBezTo.pt;return v("C {cp1x} {cp1y} {cp2x} {cp2y} {x} {y}",{cp1x:f.Su2.emuToPt((null===(t=s.getProperty(0))||void 0===t?void 0:t.x.coordinate)||0),cp1y:f.Su2.emuToPt((null===(o=s.getProperty(0))||void 0===o?void 0:o.y.coordinate)||0),cp2x:f.Su2.emuToPt((null===(n=s.getProperty(1))||void 0===n?void 0:n.x.coordinate)||0),cp2y:f.Su2.emuToPt((null===(r=s.getProperty(1))||void 0===r?void 0:r.y.coordinate)||0),x:f.Su2.emuToPt((null===(i=s.getProperty(2))||void 0===i?void 0:i.x.coordinate)||0),y:f.Su2.emuToPt((null===(a=s.getProperty(2))||void 0===a?void 0:a.y.coordinate)||0)})},e.getControlValues=function(e){var t=[];return e.gd.forEach((function(e){var o=Number(e.fmla.split(" ")[1])/1e5;t.push(o)})),t},e.getLineCap=function(e){return{flat:bt.uq.Butt,rnd:bt.uq.Round,sq:bt.uq.Square}[e]||bt.uq.Butt},e.getLineJoin=function(e){var t={round:bt.Y3.Round,bevel:bt.Y3.Bevel};return t[Object.keys(t).find((function(t){return e[t]}))||""]||bt.Y3.Miter},e.getShapeFillStyle=function(e,t){var o=this.calcFillStyle(e.spPr,t.themeColorManager);if(!o){var n=t.themeFormatManager.getFillProperties(e.style.fillRef);n&&(o=this.calcFillStyle(n,t.themeColorManager,e.style.fillRef.egColorChoice))}return o},e.calcFillStyle=function(e,t,o){var n;if(this.isShapeSolidFill(e))return{solidFill:{color:t.parseColorObjToHexColor(e.solidFill.egColorChoice,o)}};if(this.isShapeGradFill(e)){var r=[];e.gradFill.gsLst.gs.forEach((function(e){r.push({pos:f.Su2.percentageDecimalToPercentage(e.pos),color:t.parseColorObjToHexColor(e.egColorChoice,o)})}));var i=this.getGradientType(e.gradFill.egShadeProperties),a=void 0;return(null==i?void 0:i.path)===se.GL.Linear&&(a={ang:f.Su2.angleToDegree(e.gradFill.egShadeProperties.lin.ang),scaled:e.gradFill.egShadeProperties.lin.scaled}),{gradFill:{gsList:r,lin:a,pathGradient:i,rotateWithShape:e.gradFill.rotWithShape}}}if(this.isShapeBlipFill(e)){var s=e.blipFill,l=void 0;if(!s.egFillModeProperties.isEmpty(s.egFillModeProperties.tKeys.tile)){var c={undefined:bt.A4.None,none:bt.A4.None,x:bt.A4.Horizontal,y:bt.A4.Vertical,xy:bt.A4.Both},p=s.egFillModeProperties.tile,h=p.tx,d=p.ty,u=p.sx,g=p.sy,v=p.flip,y=p.algn,x=c[this.getPrstType(v)]||bt.A4.None;x!==bt.A4.None&&(l={tx:f.Su2.emuToPt(h),ty:f.Su2.emuToPt(d),sx:f.Su2.percentageDecimalToPercentage(u),sy:f.Su2.percentageDecimalToPercentage(g),flip:x,algn:this.getPrstType(y)})}var w=void 0;if(!s.egFillModeProperties.isEmpty(s.egFillModeProperties.tKeys.stretch)){var m=s.egFillModeProperties.stretch;if(!m.isEmpty(m.tKeys.fillRect)){var S=m.fillRect,b=S.b,C=S.t,T=S.l,_=S.r;w={fillRect:{b:-f.Su2.percentageDecimalToPercentage(b)/100,t:-f.Su2.percentageDecimalToPercentage(C)/100,l:-f.Su2.percentageDecimalToPercentage(T)/100,r:-f.Su2.percentageDecimalToPercentage(_)/100}}}}var P=((null===(n=s.blip.alphaModFix.getProperty(0))||void 0===n?void 0:n.amt)||0)/1e5||1,R=document.createElement("canvas");return R.width=1,R.height=1,{imageFill:{src:R.toDataURL(),alpha:P,rotateWithShape:s.rotWithShape,tile:l,stretch:w}}}if(this.isShapePatternFill(e)){var I=e.pattFill,B=window.devicePixelRatio;return{patternFill:{preset:this.getPrstType(I.prst),fgColor:t.parseColorObjToHexColor(I.fgClr,o),bgColor:t.parseColorObjToHexColor(I.bgClr,o),pageScale:Math.max(B,2)/B*Math.ceil(B)}}}return e.isEmpty(e.tKeys.noFill)?void 0:{noFill:!0}},e.isShapeSolidFill=function(e){return!e.isEmpty(e.tKeys.solidFill)},e.isShapeGradFill=function(e){return!e.isEmpty(e.tKeys.gradFill)},e.isShapeBlipFill=function(e){return!(e instanceof f.kkf.getPropertyClass(f.uSS.EGLineFillProperties)||e.isEmpty(e.tKeys.blipFill))},e.isShapePatternFill=function(e){return!e.isEmpty(e.tKeys.pattFill)},e.getLineFillStyle=function(e,t){var o=this.calcFillStyle(e.spPr.ln.egLineFillProperties,t.themeColorManager);if(!o){var n=t.themeFormatManager.getLineProperties(e.style.lnRef);n&&(o=this.calcFillStyle(n.egLineFillProperties,t.themeColorManager,e.style.lnRef.egColorChoice))}return null!=o?o:{noFill:!0}},e.getGradientType=function(e){return e.isEmpty(e.tKeys.path)?{path:se.GL.Linear}:{path:se.GL.Radial,fillToRect:{b:f.Su2.percentageDecimalToPercentage(e.path.fillToRect.b),l:f.Su2.percentageDecimalToPercentage(e.path.fillToRect.l),r:f.Su2.percentageDecimalToPercentage(e.path.fillToRect.r),t:f.Su2.percentageDecimalToPercentage(e.path.fillToRect.t)}}},e.getFilter=function(e,t){var o=this.getEffectLst(e,t),n=e.style.effectRef.egColorChoice;return{effect:{shadow:this.getShadow(o,t.themeColorManager,n),reflection:this.getReflection(o),glow:this.getGlow(o,t.themeColorManager,n),softEdge:this.getSoftEdge(o)},forbidWebgl:this.checkFilterSupport()}},e.getEffectLst=function(e,t){if(!e.spPr.isEmpty(e.spPr.tKeys.effectLst))return e.spPr.effectLst;var o=t.themeFormatManager.getEffectProperties(e.style.effectRef);return o?o.effectLst:new(f.kkf.getPropertyClass(f.uSS.CTEffectList))},e.getShadow=function(e,t,o){var n,r=!1;return e.isEmpty(e.tKeys.outerShdw)?e.isEmpty(e.tKeys.prstShdw)?e.isEmpty(e.tKeys.innerShdw)||(n=this.getShadowInfo(e.innerShdw,t,o)):(r=!0,n=this.getShadowInfo(e.prstShdw,t,o)):(r=!0,n=this.getShadowInfo(e.outerShdw,t,o)),(0,a.__assign)({isOuter:r},n)},e.getShadowInfo=function(e,t,o){var n,r,i,a,s;if(e.propertyType===f.uSS.CTOuterShadowEffect){var l=e,c=l.sx,p=l.sy,h=l.kx,d=l.ky,u=l.algn;e.isEmpty(e.tKeys.sx)||(n=f.Su2.percentageDecimalToPercentage(c)),e.isEmpty(e.tKeys.sy)||(r=f.Su2.percentageDecimalToPercentage(p)),i=f.Su2.angleToDegree(h),a=f.Su2.angleToDegree(d),s=this.getPrstType(u)}var v=t.parseColorObjToRGBAColor(e.egColorChoice,o),y=f.kkf.getPropertyClass(f.uSS.CTPresetShadowEffect);return{blur:f.Su2.emuToPt(e instanceof y?0:e.blurRad),angle:f.Su2.angleToDegree(e.dir),distance:f.Su2.emuToPt(e.dist),color:v?g.u$.rgbColor2hex(v,!0):"",opacity:this.rgbaAlphaToOpacity(null==v?void 0:v.alpha),size:100,scaleX:n,scaleY:r,skewX:i,skewY:a,algn:s}},e.getReflection=function(e){if(!e.isEmpty(e.tKeys.reflection)){var t=e.reflection;return{blur:f.Su2.emuToPt(t.blurRad),angle:f.Su2.angleToDegree(t.dir),distance:f.Su2.emuToPt(t.dist),startOpacity:f.Su2.alphaToOpacity(t.stA),endOpacity:f.Su2.alphaToOpacity(t.endA),rotateWithShape:t.rotWithShape,size:f.Su2.percentageDecimalToPercentage(t.endPos)}}},e.getGlow=function(e,t,o){var n=e.glow,r=t.parseColorObjToRGBAColor(n.egColorChoice,o);return{color:r?g.u$.rgbColor2hex(r,!0):"",opacity:void 0!==(null==r?void 0:r.alpha)?100*(1-r.alpha):0,size:f.Su2.emuToPt(n.rad)}},e.getSoftEdge=function(e){var t=e.softEdge;return{size:f.Su2.emuToPt(t.rad)}},e.rgbaAlphaToOpacity=function(e){return void 0!==e?100*(1-e):0},e.getPrstType=function(e){var t=e.split("_")[1];return"undefined"!==t?t:""},e.checkFilterSupport=function(){var e,t=document.createElement("canvas").getContext("2d");return!!t&&(null===(e=t.filter)||void 0===e?void 0:e.length)>0},e}(),Tt=function(e){function t(t,o){return e.call(this,t,o)||this}return(0,a.__extends)(t,e),t.prototype.render=function(e){if(!this.skipRender(e)){var t=e.layoutBox,o=e.offset,n=e.traversalRange,i=e.flags,s=e.appendBox,l=e.checker,c=this.calcTextTransform(e),p=this.getClipInfo(o,t,l),h=(0,r.jVi)(p,c),d=this.getScrollInfo(e),u=d.scrollLeft,g=d.scrollTop;s({layoutBox:t,offset:{x:o.x-u,y:o.y-g},traversalRange:n,flags:(0,a.__assign)((0,a.__assign)({},i),{contextState:h,storyType:f.AHI.textboxContent})}),this.renderTextFrame(e)}},t.prototype.getClipInfo=function(e,t,o){var n=t.getOriginSizeBox(),i=n.contentSize,a=n.rect,s=n.edge,l=s.padding,c=s.border,p=e.x+c.width.left+l.left,h=a.width,d=e.y+c.width.top+l.top,u=a.height;if(i.width!==a.width||i.height!==a.height){var f=(0,r.SsA)(p,d,h,u);if(f.width>0&&f.height>0)return(0,r.SsA)(f.x,f.y-o.incRegion.y,f.width,f.height)}},t.prototype.getScrollInfo=function(e){var t=e.layoutBox,o=e.shares;if(!t.textboxProperty||t.textboxProperty.textBoxType===f.Xbc.TextFrame)return{scrollLeft:0,scrollTop:0};var n="textframe-".concat(t.textboxProperty.id),r=t.getOriginSizeBox(),i=r.contentSize,a=r.positionBoxSize,s=o.renderState.getScrollerInfo(n)||{left:0,top:0};return{scrollLeft:Math.min(i.width-a.width,(0,c.pxToTwips)(s.left)),scrollTop:Math.min(i.height-a.height,(0,c.pxToTwips)(s.top))}},t.prototype.renderTextFrame=function(e){var t,o=e.collector,n=e.layoutBox,i=e.offset,a=e.flags,s=e.shares,l=e.checker;(null===(t=n.property)||void 0===t?void 0:t.propertyType)===f.uSS.DrawingProperty&&Ct.collectDrawingView(e);var c=this.shares.extRendererManager.getExtendRenderer(r.Rli.Textframe);if(null==c?void 0:c.rendererCount()){var p=ct.obtain(s,o,i,l.incRegion,a);c.draw(p,n),p.recycle()}},t.prototype.calcTextTransform=function(e){var t,o,n,r,i=e.layoutBox,a=e.offset,s=e.checker,l=e.shares,c=null===(t=i.property)||void 0===t?void 0:t.drawing.graphic.graphicData.wsp.bodyPr.prstTxWarp.prst;if(c&&c!==f.H6e.undefined&&c!==f.H6e.textNoShape){var p=l.renderState.getTextFrameActiveInfo();if(!(null===(o=null==p?void 0:p.box.property)||void 0===o?void 0:o.anchorId)||(null===(n=null==p?void 0:p.box.property)||void 0===n?void 0:n.anchorId)!==(null===(r=i.property)||void 0===r?void 0:r.anchorId)||!(null==p?void 0:p.contentActive)){var h=this.getClipInfo(a,i,s);if(h){var d=this.calcTextOriginRect(e,h),u=h.width/d.width,g=h.height/d.height;return{scaleX:u,rotateX:0,rotateY:0,scaleY:g,translateX:h.x-d.x*u,translateY:h.y-d.y*g}}}}},t.prototype.calcTextOriginRect=function(e,t){var o=this,i=t.x+t.width,a=t.x,s=t.y+t.height,l=t.y;return r.d_x.layoutBoxTraversal({layoutBox:e.layoutBox,offset:e.offset},(function(e){var c,p=e.childBoxItem,h=e.appendBox,d=p.layoutBox,u=p.offset,f=p.traversalRange;if(u.y>=t.y+t.height)return r.xt0.Break;if((0,n.o7)(d)&&u.y>=t.y&&u.y<t.y+t.height&&(s=Math.min(s,u.y),l=Math.max(l,u.y+d.borderBoxSize.height)),((0,n.o7)(d)||(0,n.tq)(d)||(0,n.Jt)(d))&&(0,n.Dy)(d.firstChild)){var g=o.findFirstOrLastVisibleLeafChild(d,!0);if(g){var v=o.calcChildOffset(u,g),y=o.findFirstOrLastVisibleLeafChild(d,!1),x=o.calcChildOffset(u,y);i=Math.min(i,v.x),a=Math.max(a,x.x+(null!==(c=null==y?void 0:y.borderBoxSize.width)&&void 0!==c?c:0))}return r.xt0.Continue}return h({layoutBox:d,offset:u,traversalRange:f}),r.xt0.Continue})),(0,r.SsA)(i,s,a-i,l-s)},t.prototype.calcChildOffset=function(e,t){if(!t)return e;var o=t.edge.margin,n=t.getOuterPoint();return{x:e.x+n.x+o.left,y:e.y+n.y+o.top}},t.prototype.findFirstOrLastVisibleLeafChild=function(e,t){var o,r;if((0,n.Dy)(e.firstChild)){var i=t?e.children:e.children.slice().reverse();try{for(var s=(0,a.__values)(i),l=s.next();!l.done;l=s.next()){var c=l.value;if((0,n.Dy)(c)&&this.isVisibleLeaf(c))return c}}catch(e){o={error:e}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(o)throw o.error}}}},t.prototype.isVisibleLeaf=function(e){return!(e.totalWidth<=0||(0,n.NF)(e)&&0===e.text.trim().length)},t}(Ke),_t=function(e){function t(t,o,n){var r=e.call(this,t,o)||this;return r.textBoxRender=n,r}return(0,a.__extends)(t,e),t.prototype.render=function(e){var t=e.layoutBox,o=e.offset,n=e.appendBox,r=e.traversalRange,i=e.flags,s=(0,a.__assign)({},o);f.Lpg.MENTION_QQ===t.subType&&(s.x+=(0,c.pxToTwips)(5)),f.Lpg.MENTION_WXWORK===t.subType&&(s.x+=(0,c.pxToTwips)(5)),n({layoutBox:t,offset:s,traversalRange:r,flags:i}),this.renderTextLineFragment(e)},t.prototype.renderTextLineFragment=function(e){var t=e.collector,o=e.layoutBox,n=e.offset,i=e.flags,a=e.checker,s=this.shares.extRendererManager.getExtendRenderer(r.Rli.TextLineFragment);if(null==s?void 0:s.rendererCount()){var l=ct.obtain(this.shares,t,n,a.incRegion,i);s.draw(l,o),l.recycle()}},t.prototype.renderAuxiliaryLine=function(e){var t=e.layoutBox,o=e.collector,n=e.offset,r=e.flags,i=e.checker,a=t.edge,s=new c.MeloRect({x:n.x-a.margin.left,y:n.y-a.margin.top,width:t.totalWidth,height:t.totalHeight});this.renderRectBorder(s,o,i,r),s=new c.MeloRect({x:n.x+a.padding.left,y:n.y+a.padding.top,width:t.rect.width,height:t.rect.height}),this.renderRectBorder(s,o,i,r),s=new c.MeloRect({x:n.x+a.padding.left,y:n.y+a.padding.top,width:t.rect.width,height:t.rect.width}),this.renderRectBorder(s,o,i,r),a.recycle()},t}(Ke),Pt=function(){function e(e,t){var o=this;this.context=e,this.shares=t,this.onDoubleClick=function(e,t,n,i,a){var s=t===f.AHI.headerContent,l=t===f.AHI.footerContent;if(o.shares.isEditable()){var c=o.shares.selectionOverlay.mouseSelector,p=e.clientX,h=e.clientY,d=e.target,u=o.context.root,g=(0,r.FZR)(u,h)-1;o.shares.selectionOverlay.updatePageIndexByCount(g);var v=o.calMouseEventHitPoint(e),y=v.totalHitPtX,x=v.totalHitPtY;s||l?o.actionToHeaderFooter(a,y,x,t,n):(o.updateFocusHeaderFooter(!1),o.context.fire(new r.kv7),o.context.fire(new r.x7H),c.updateBoth({clientX:p,clientY:h,element:d},{x:y,y:x}),c.selectionCallback&&c.selectionCallback(c,r.bL4.DEFAULT)),e.stopPropagation()}}}return e.prototype.actionToHeaderFooter=function(e,t,o,n,i){var a=this.shares.selectionOverlay.mouseSelector,s=n===f.AHI.headerContent,l=null;e||(l=this.getRangeFromHitPoint(t,o)),a.getSelection()&&this.context.fire(new r.EuV(s,i,e,a.getSelection().viewRange.getGCPRange(),l))},e.prototype.getRangeFromHitPoint=function(e,t){var o=null,n=this.shares.selectionOverlay.mouseSelector.findHitViewPoint(!0,!1,!1,{x:e,y:t});return n&&(o=new r.rOq(n,n.clone())),o},e.prototype.updateFocusHeaderFooter=function(e){this.shares.renderState.setFocusOnInfo({isFocusHeaderFooter:e})},e.prototype.calMouseEventHitPoint=function(e){var t=this.getEditorZoom(),o=this.context.root.getBoundingClientRect(),n=g.$w.getElementZoomValue(document.body);return{totalHitPtX:((0,c.pxToTwips)(e.clientX/n)-(0,c.pxToTwips)(o.left))/t,totalHitPtY:((0,c.pxToTwips)(e.clientY/n)-(0,c.pxToTwips)(o.top))/t}},e.prototype.getEditorZoom=function(){return(this.shares.renderState.getEditorInfo()||{zoom:1}).zoom},e.prototype.isFocusOn=function(e){var t=this.shares.isFocusHeaderFooter;return t&&this.isHeaderOrFooter(e)||!t&&!this.isHeaderOrFooter(e)},e.prototype.isHeaderOrFooter=function(e){return e===f.AHI.headerContent||e===f.AHI.footerContent},e.prototype.renderMask=function(e){var t=this,o=e.layoutBox,i=e.offset,a=e.collector,s=e.shares,p=this.isFocusOn(o.storyType),h=(0,r.SsA)(i.x,i.y,o.totalWidth,o.totalHeight);if((0,r.UHV)(h))if(p){if(this.isHeaderOrFooter(o.storyType)){var d=s.decoratorManager.getDecorator(r.cip.HeaderFooter).decorate(o),u=d.components,g=d.overrideStyle,v=Ae.obtain(o.uuid,h,l().createElement("div",{style:{width:"".concat((0,c.twipsToPx)(o.totalWidth),"px"),height:"".concat((0,c.twipsToPx)(o.totalHeight),"px")}},u),g);a.collect(v,r._AL.headerFooter)}}else v=Ae.obtain(o.uuid,h,l().createElement("div",{style:{width:"".concat((0,c.twipsToPx)(o.totalWidth),"px"),height:"".concat((0,c.twipsToPx)(o.totalHeight),"px")},onMouseDown:function(e){p||e.stopPropagation()},onMouseMove:function(e){p||e.stopPropagation()},onMouseUp:function(e){p||e.stopPropagation()},onContextMenu:function(e){p||e.stopPropagation()},onDoubleClick:function(e){var r=!o.isValid(),i=(0,n.De)(o)?o.parity:f.SoA.undefined;t.onDoubleClick(e,o.storyType,i,p,r)}}),{backgroundColor:"#FFFFFF",opacity:0}),a.collect(v,r._AL.containerPage)},e}();!function(e){e.MarginColor="#d18f52",e.BorderColor="#ff616e",e.PaddingColor="#8cc265",e.ContentColor="#4cd1e0"}(ot||(ot={}));var Rt,It=function(){function e(){}return e.renderInspect=function(e){globalThis.docDevToolSelectBoxId&&Number(globalThis.docDevToolSelectBoxId)===Number(e.layoutBox.uuid)&&((0,n.$o)(e.layoutBox),this.renderInspectCommon(e))},e.renderRectInspect=function(e,t,o,n,i){var a=Oe.obtain((0,r.SsA)(e.x,e.y-o.incRegion.y,e.width,e.height),"preview-diff",{radius:0,fillColor:n},null==i?void 0:i.contextState);t.collect(a,r.Ypk.UnderLowest)},e.renderInspectText=function(e){var t=e.layoutBox,o=e.collector,n=e.checker,r=e.offset,i=e.flags,a=t.edge,s=new c.MeloRect({x:r.x,y:r.y,width:t.totalWidth,height:t.totalHeight});this.renderRectInspect(s,o,n,ot.ContentColor,i),a.recycle()},e.renderInspectContainer=function(e){var t=e.layoutBox,o=e.collector,n=e.checker,r=e.offset,i=e.flags,a=t.edge,s=t.parentBox?t.parentBox.ascent-t.ascent:0,l=new c.MeloRect({x:r.x,y:r.y+s,width:t.totalBoxSize.width,height:t.totalBoxSize.height});this.renderRectInspect(l,o,n,ot.ContentColor,i),a.recycle()},e.renderInspectCommon=function(e){var t=e.layoutBox,o=e.collector,r=e.checker,i=e.offset,a=e.flags,s=t.edge,l=(0,n.tJ)(t)&&t.floatingSpace?t.floatingSpace.size.measure:t.totalWidth,p=(0,n.tJ)(t)&&t.floatingSpace?t.floatingSpace.size.extent:t.totalHeight,h=new c.MeloRect({x:i.x-s.margin.left,y:i.y-s.margin.top,width:l,height:p});this.renderRectInspect(h,o,r,ot.MarginColor,a),h=new c.MeloRect({x:i.x,y:i.y,width:t.borderBoxSize.width,height:t.borderBoxSize.height}),this.renderRectInspect(h,o,r,ot.BorderColor,a),h=new c.MeloRect({x:i.x+s.border.width.left,y:i.y+s.border.width.top,width:t.paddingBoxSize.width,height:t.paddingBoxSize.height}),this.renderRectInspect(h,o,r,ot.PaddingColor,a),h=new c.MeloRect({x:i.x+s.border.width.left+s.padding.left,y:i.y+s.border.width.top+s.padding.top,width:t.rect.width,height:t.rect.height}),this.renderRectInspect(h,o,r,ot.ContentColor,a),s.recycle()},e}(),Bt=function(e){function t(t,o,n){var r=e.call(this,t,o)||this;return r.renderPageMask=n,r}return(0,a.__extends)(t,e),t.prototype.render=function(e){var t,o=e.layoutBox,n=e.offset,i=e.traversalRange,s=e.appendBox,l=e.flags,c=e.shares,p=e.checker;c.docEnv.docViewType!==f.$BT.SnapPreview&&(o.children.length>0&&o.totalHeight<o.children[0].totalHeight+o.edge.top&&(t=(0,r.SsA)(n.x,n.y-p.incRegion.y,o.totalWidth,o.totalHeight)),s({layoutBox:o,offset:n,traversalRange:i,flags:(0,a.__assign)((0,a.__assign)({},l),{isInHeaderFooter:!0,contextState:(0,r.jVi)(t)})}),this.renderPageMask.renderMask(e))},t}(Ke),Et=function(e){function t(t,o,n){var r=e.call(this,t,o)||this;return r.renderPageMask=n,r}return(0,a.__extends)(t,e),t.prototype.render=function(e){var t=e.layoutBox,o=e.offset,n=e.traversalRange,i=e.appendBox,s=e.flags,l=e.checker,c=this.getClipInfo(o,t,l),p=(0,r.jVi)(c);i({layoutBox:t,offset:o,traversalRange:n,flags:(0,a.__assign)((0,a.__assign)({},s),{contextState:p})}),this.renderPageMask.renderMask(e)},t.prototype.getClipInfo=function(e,t,o){var n,i,a=null===(n=t.parentBox)||void 0===n?void 0:n.borderBoxSize.width,s=null===(i=t.parentBox)||void 0===i?void 0:i.borderBoxSize.height;if(a&&s){var l=(0,r.SsA)(0,0,a,s);return l.width>0&&l.height>0?(0,r.SsA)(0,-o.incRegion.y,l.width,l.height):void 0}},t}(Ke),Mt=function(){function e(e,t){this._pluginsMap=new Map,this._defaultPlugin=new mt(e,t);var o=new Pt(e,t);this._pluginsMap.set(n.uO.Body,new Et(e,t,o)),this._pluginsMap.set(n.uO.HeaderFooter,new Bt(e,t,o)),this._pluginsMap.set(n.uO.Table,new pt(e,t)),this._pluginsMap.set(n.uO.TableCell,new ht(e,t)),this._pluginsMap.set(n.uO.LeafContainer,new dt(e,t)),this._pluginsMap.set(n.uO.Image,new dt(e,t)),this._pluginsMap.set(n.uO.FieldContainer,new dt(e,t)),this._pluginsMap.set(n.uO.EmbeddedObject,new dt(e,t)),this._pluginsMap.set(n.uO.Text,new ft(e,t)),this._pluginsMap.set(n.uO.Line,new wt(e,t,this._pluginsMap.get(n.uO.Text))),this._pluginsMap.set(n.uO.Paragraph,new St(e,t)),this._pluginsMap.set(n.uO.TextFrame,new Tt(e,t)),this._pluginsMap.set(n.uO.Field,new _t(e,t,this._pluginsMap.get(n.uO.Text))),this._pluginsMap.set(n.uO.SubLine,new wt(e,t,this._pluginsMap.get(n.uO.Text)))}return e.prototype.render=function(e){this._pluginsMap.has((0,n.$o)(e.layoutBox))?this._pluginsMap.get((0,n.$o)(e.layoutBox)).render(e):this._defaultPlugin.render(e),It.renderInspect(e)},e}(),Lt=function(){function e(e,t,o){this.context=e,this.layoutController=t,this.shares=o,this.checker=new qe,this.plugins=new Mt(e,o)}return e.prototype.findTableTraversalRange=function(e,t,o,n){var i=n.renderState.getScrollerInfo("table-".concat(e.tableId)),a=(0,c.pxToTwips)(i?i.left:0),s=e.borderBoxSize,l=(0,r.SsA)(t.x+a,t.y,s.width,s.height),p=(0,r.Aa5)(o,l),h=r.d_x.findBoxTraversalIndex(e.rowHeights,t.y,p.y,p.y+p.height),d=r.d_x.findBoxTraversalIndex(e.colWidths,t.x,p.x,p.x+p.width);return{start:{hIndex:d.start,vIndex:h.start},end:{hIndex:d.end,vIndex:h.end}}},e.prototype.findBlockTraversalRange=function(e,t,o,n){if(e.children.length>0){var i=r.d_x.getBlockViewPortIndexRange(e.children,{firstPos:o.y,lastPos:o.y+o.height},t);return{start:{vIndex:i.first,hIndex:0},end:{vIndex:i.last,hIndex:0}}}},e.prototype.collectForRenderer=function(e,t,o,n){var r=e.pageIndex,i=e.subPageIndex,a=e.limitSubCanvasHeight,s=e.collectEngine,l=0,c=t.totalHeight;void 0!==i&&void 0!==a&&(l=i*a,c=Math.min(a,t.totalHeight-i*a)),this.checker.incRegion={x:0,y:l,width:t.totalWidth,height:c},this.collectSubtreeForRender({layoutBox:t,offset:{x:0,y:0}},s,o,r,!1,n);var p=this.shares.docEnv.layoutType===f.msV.Paged?t:t.parentBox;p&&this.collectFloatingBoxes(s,o,p,r)},e.prototype.getCollectIncRegion=function(){return this.checker.incRegion},e.prototype.collectSubtreeForRender=function(e,t,o,i,s,l){var c=this,p=this.layoutController.getLayoutBox(),h=e.layoutBox;t.zIndex=(0,n.vv)(h)&&(0,n.Eb)(h)?h.floatingSpace.zIndex:g.aP,r.d_x.layoutBoxTraversal(e,(function(e){var h=e.parentBoxItem,d=e.childBoxItem,u=e.appendBox,f=null==h?void 0:h.flags,g=d.layoutBox,v=d.offset,y=d.traversalRange,x=d.flags;if(g.display===n.gy.Block){var w=(0,n.vv)(g)?g.floatingSpace.size.extent:g.totalHeight,m=c.checker.shouldRender({start:v.y,end:v.y+w});if((0,n.sJ)(g)&&m!==He.Break&&(m=He.Render),m===He.Break)return r.xt0.Break;if(m===He.Ignore)return r.xt0.Continue}return null==l||l(g),c.plugins.render({checker:c.checker,shares:o,collector:t,context:c.context,layoutController:c.layoutController,offset:v,layoutBox:g,appendBox:u,traversalRange:y,onlyAnchors:!h&&s,flags:(0,a.__assign)((0,a.__assign)({},f),x),renderRootBox:p,pageIndex:i}),r.xt0.Continue})),t.zIndex=g.aP},e.prototype.collectFloatingBoxes=function(e,t,o,n){var r=this,i=o.constraintSpace;i&&i.getAllFloatingInfo().forEach((function(o){var i=o.isAdditional;r.collectSubtreeForRender({layoutBox:o.box,offset:o.offset,flags:{isInHeaderFooter:i}},e,t,n,!0)}))},e}(),Ot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.shouldComponentUpdate=function(e){return this.props.layoutBox.uuid!==e.layoutBox.uuid||this.props.overlayNode!==e.overlayNode||this.props.subStoryInfo.subStoryProp.id!==e.subStoryInfo.subStoryProp.id||this.props.zoom!==e.zoom||this.props.renderRect!==e.renderRect||this.props.force!==e.force},t.prototype.render=function(){var e=this.props,t=e.layoutBox,o=e.children,n=e.shares,i=t.edge,s=t.getSiblingIndex()+1,p=this.zoom(),h=t.getOuterPoint(),d=(0,a.__assign)((0,a.__assign)({},r.vW8.boxSize(t,p)),{left:"".concat((0,c.twipsToPx)(h.x)*p,"px"),top:"".concat((0,c.twipsToPx)(h.y)*p,"px"),marginTop:"".concat((0,c.twipsToPx)(i.margin.top)*p,"px"),marginLeft:"".concat((0,c.twipsToPx)(i.margin.left)*p,"px"),marginRight:"".concat((0,c.twipsToPx)(i.margin.right)*p,"px"),marginBottom:"".concat((0,c.twipsToPx)(i.margin.bottom)*p,"px"),boxShadow:r.vW8.getPageBoxShawdow(n.docEnv.layoutType),zIndex:Rt.MainView});return i.recycle(),l().createElement("div",{className:r.F51.meloPageView,"data-page-index":s,style:(0,a.__assign)({},r.vW8.cssPropsToStyle(d)),ref:this.rootRef},o)},t.prototype.zoom=function(){return this.props.zoom||1},t}(Xe),At=n.Lg.Canvas;!function(e){e[e.BehindView=1]="BehindView",e[e.GapView=10]="GapView",e[e.LowerAnchorView=11]="LowerAnchorView",e[e.MainView=21]="MainView",e[e.ContainerView=31]="ContainerView",e[e.UpperAnchorView=41]="UpperAnchorView",e[e.FrontView=51]="FrontView",e[e.PrintCover=61]="PrintCover"}(Rt||(Rt={}));var kt=function(e){function t(t){var o=e.call(this,t)||this;o.renderViewRefs=[],o.addonViewRootElements=[],o.containerRootElements=[],o.upperAnchorRootElements=[],o.lowerAnchorRootElements=[],o.prevSortedRenderPages=[],o.pagesReused=[],o.pagesNewRender=[],o.pagesInRenderRect=[],o.pagesOutside=[],o.pageGapTopCache=new Map,o.isZooming=!1,o.zoom=t.context.zoom,o.layoutBoxRenderer=new Lt(o.props.context,o.props.layoutController,o.props.shares);var r=At;return o.props.shares.docEnv.docViewType===f.$BT.PrintPreview&&(r=n.Lg.Svg),r===n.Lg.Canvas?o.renderController=new Ye(o.props.layoutController):r===n.Lg.Svg&&(o.renderController=new Ue),o.state={zoom:o.zoom},o}return(0,a.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.renderController.initRenderViews(this.addonViewRootElements,this.containerRootElements,this.upperAnchorRootElements,this.lowerAnchorRootElements),this.props.context.on(n.Rr.LayoutChanged,(function(){e.pageGapTopCache.clear()}),this)},t.prototype.renderCanvas=function(e,t){var o=this,n={pagesInRenderRect:this.pagesInRenderRect,pagesOutside:this.pagesOutside,pagesNewRender:this.pagesNewRender};this.renderController.render({layoutBox:e,options:t,renderPages:n,zoom:this.zoom,context:this.props.context,doCollect:function(t){var n=t.pageIndex;return e.children[n]&&o.layoutBoxRenderer.collectForRenderer(t,e.children[n],o.props.shares),o.layoutBoxRenderer.getCollectIncRegion()}})},t.prototype.render=function(){var e=this,t=this.getRenderPages();if(0===t.length)return null;var o=this.props.context.docEnv,n=o.docViewType,i=o.layoutType;return this.docBoxSize=r.vW8.calcDocBoxSize(t[0].parentBox,this.state.zoom),this.updateRenderPages(),l().createElement("div",{className:r.F51.meloDocView,style:(0,a.__assign)((0,a.__assign)({cursor:"text",marginBottom:"".concat((0,c.twipsToPx)(n!==f.$BT.PresentationPreview?f.keb.paperMarginBottom:0),"px")},this.docBoxSize),{boxShadow:r.vW8.getPageViewShawdow(i)}),"aria-hidden":!0,ref:this.rootRef,onMouseDown:function(t){e.onMouseDown(t)},onMouseMove:function(t){e.onMouseMove(t)},onMouseUp:function(t){e.onMouseUp(t)},onContextMenu:function(t){e.onContextMenu(t)},onTouchStart:function(t){e.onTouchStart(t)},onTouchMove:function(t){e.onTouchMove(t)},onTouchEnd:function(t){e.onTouchEnd(t)},onDoubleClick:function(t){e.onDoubleClick(t)}},(0,f.KZv)(i)?"":this.webLayoutFrontViewComponent(),this.addonViewComponent(),this.pagesComponent())},t.prototype.setZoom=function(e){if(this.zoom!==e){this.setState({zoom:e});var t=this.props.shares.renderState,o=t.getEditorInfo()||{zoom:1};o.zoom=e,t.setEditorInfo(o)}this.zoom=e},t.prototype.setZooming=function(e){this.isZooming=e},t.prototype.calMouseEventHitPoint=function(e){return this.calcHitPointWithBodyZoom({x:(0,c.pxToTwips)(e.clientX),y:(0,c.pxToTwips)(e.clientY)})},t.prototype.calTouchEventHitPoint=function(e){var t=e.nativeEvent.changedTouches.item(0);if(t)return this.calcHitPointWithBodyZoom({x:(0,c.pxToTwips)(t.clientX),y:(0,c.pxToTwips)(t.clientY)})},t.prototype.calcHitPointWithBodyZoom=function(e){var t;if(null===(t=this.rootRef)||void 0===t?void 0:t.current){var o=this.rootRef.current.getBoundingClientRect(),n=g.$w.getElementZoomValue(document.body);return{x:(e.x/n-(0,c.pxToTwips)(o.left))/this.zoom,y:(e.y/n-(0,c.pxToTwips)(o.top))/this.zoom}}},t.prototype.dispatchCustomEvent=function(e,t){e.target.dispatchEvent(new CustomEvent(t,{bubbles:!0,detail:{originalEvent:e.nativeEvent}}))},t.prototype.onMouseDown=function(e){var t=this.calMouseEventHitPoint(e);this.props.context.fire(new r.VDf(e,t),!1),e.nativeEvent.stopImmediatePropagation()},t.prototype.onMouseMove=function(e){var t=this.calMouseEventHitPoint(e);this.props.context.fire(new r.VDf(e,t),!1)},t.prototype.onMouseUp=function(e){var t=this.calMouseEventHitPoint(e);this.props.context.fire(new r.VDf(e,t),!1),e.nativeEvent.stopImmediatePropagation(),this.dispatchCustomEvent(e,"mouseup_for_addon")},t.prototype.onContextMenu=function(e){var t=this.calMouseEventHitPoint(e);this.props.context.fire(new r.VDf(e,t),!1),e.nativeEvent.stopImmediatePropagation()},t.prototype.onDoubleClick=function(e){var t=this.calMouseEventHitPoint(e);this.props.context.fire(new r.VDf(e,t),!1),e.nativeEvent.stopImmediatePropagation()},t.prototype.onTouchStart=function(e){if(!this.isMobileZooming()){var t=this.calTouchEventHitPoint(e);this.props.context.fire(new r.NkY(e,t),!1),e.nativeEvent.stopImmediatePropagation()}},t.prototype.onTouchMove=function(e){if(!this.isMobileZooming()){var t=this.calTouchEventHitPoint(e);this.props.context.fire(new r.NkY(e,t),!1),e.nativeEvent.stopImmediatePropagation()}},t.prototype.onTouchEnd=function(e){if(!this.isMobileZooming()){var t=this.calTouchEventHitPoint(e);this.props.context.fire(new r.NkY(e,t),!1),e.nativeEvent.stopImmediatePropagation()}},t.prototype.isMobileZooming=function(){return!1},t.prototype.addonViewComponent=function(){var e,t=this,o=this.props.layoutBox;if(!o)return null;var n=(0,c.twipsToPx)(o.edge.padding.top),i={top:-n,bottom:0,left:0,right:0},s=r.vW8.calcDocBoxSize(o,void 0,i),p=o.lastChild,h={x:0,y:(null==p?void 0:p.edge.margin.bottom)||0},d=this.getLayoutBoxZoomTransform(o,h);return l().createElement("div",{className:r.F51.meloAddonView,style:(0,a.__assign)({position:"absolute",zIndex:Rt.ContainerView,whiteSpace:"pre",transform:d,pointerEvents:"none",top:"".concat(n,"px")},s)},l().createElement(I,{ref:function(e){t.addonViewRootElements[0]=e},zoom:this.state.zoom,disabled:null===(e=this.props.shares.renderState.getFocusOnInfo())||void 0===e?void 0:e.isFocusHeaderFooter}))},t.prototype.pagesComponent=function(){var e=this.getSortedPagesToRender();return this.prevSortedRenderPages=e,this.generateSortedPagesComponents(e)},t.prototype.updateRenderPages=function(){this.updatePagesInRenderRect(),this.updatePagesReused(),this.updatePagesNewRender()},t.prototype.updatePagesInRenderRect=function(){var e=this.props.renderRect,t=[];this.getRenderPages().forEach((function(o,n){var r=o.getOuterPoint(),i=new c.MeloRect({x:0,y:r.y,width:o.totalWidth,height:o.totalHeight});(null==e?void 0:e.intersect(i))&&t.push(n)})),this.pagesInRenderRect=t},t.prototype.updatePagesReused=function(){var e=this;this.pagesReused=this.pagesInRenderRect.filter((function(t){return e.prevSortedRenderPages.includes(t)}))},t.prototype.updatePagesNewRender=function(){var e=this;this.pagesNewRender=this.pagesInRenderRect.filter((function(t){return!e.prevSortedRenderPages.includes(t)}))},t.prototype.getSortedPagesToRender=function(){var e=[];0===this.pagesReused.length?(e=(0,a.__spreadArray)([],(0,a.__read)(this.pagesInRenderRect),!1),this.pagesOutside=[]):e=this.adjustPagesOrder();var t=this.getRenderPages();return e.filter((function(e){return t[e]}))},t.prototype.adjustPagesOrder=function(){var e=this,t=(0,a.__spreadArray)([],(0,a.__read)(this.pagesNewRender),!1),o=[],n=[];return this.prevSortedRenderPages.forEach((function(r){!e.pagesReused.includes(r)&&t.length>0?o.push(t.pop()):(o.push(r),e.pagesReused.includes(r)||n.push(r))})),this.pagesOutside=n,(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(o),!1),(0,a.__read)(t),!1)},t.prototype.generateSortedPagesComponents=function(e){var t=this,o=this.props,n=o.overlayNode,i=o.renderRect,s=(o.layoutBox,(0,a.__rest)(o,["overlayNode","renderRect","layoutBox"])),c=this.props.context.docEnv.layoutType,p=this.props.shares.decoratorManager.getDecorator(r.cip.Page),h=this.getRenderPages();return e.map((function(e,o){var r=h[e],d=e===h.length-1;if(!r)return null;var u=t.calcPageLayoutStyle(r,e),g=t.getFrontBehindContent(p,t.props.layoutBox),v=g.behindContent,y=g.frontContent;return[l().createElement(Ot,(0,a.__assign)({key:"logic-page-".concat(o),layoutBox:r,overlayNode:n.childAt(e),zoom:t.state.zoom,renderRect:i},s),t.printCoverComponent(),(0,f.KZv)(c)?t.frontViewComponent(y,u):"",t.upperAnchorViewComponent(e,u),t.containerViewComponent(e,u),t.renderCanvasViewComponent(e),t.lowerAnchorViewComponent(e,u),t.behindViewComponent(v,u)),t.renderPageGapComponent(r,e,d)]}))},t.prototype.getPageOverflowStyle=function(){return this.props.shares.docEnv.layoutType===f.msV.Paged?"hidden":"visible"},t.prototype.getFrontBehindContent=function(e,t){var o=e.decorate(t);return{frontContent:this.getDecoratedContent(o,r.hjr.Front),behindContent:this.getDecoratedContent(o,r.hjr.Back)}},t.prototype.getDecoratedContent=function(e,t){var o=[];return e.forEach((function(e){var n=(0,a.__read)(e,2),r=n[0];n[1].order===t&&o.push(r)})),o},t.prototype.calcPageLayoutStyle=function(e,t){var o,n,i=r.vW8.boxSize(e),s={x:0,y:(null===(n=null===(o=e.parentBox)||void 0===o?void 0:o.lastChild)||void 0===n?void 0:n.edge.margin.bottom)||0},l=this.getLayoutBoxZoomTransform(e,s),c=this.pagesOutside.includes(t)?"none":"";return(0,a.__assign)({display:c,transform:l},i)},t.prototype.renderPageGapComponent=function(e,t,o){var n=e.edge,r=n.margin.bottom;n.recycle();var i=this.pageGapTopCache.get(t);return i||(i=this.calcPageGapTop(e,r),this.pageGapTopCache.set(t,i)),o?null:this.pageGapComponent(i,t,r)},t.prototype.calcPageGapTop=function(e,t){var o=e.getOuterPoint(),n=new c.MeloRect({x:0,y:o.y,width:e.totalWidth,height:e.totalHeight});return n.y+n.height-t},t.prototype.pageGapComponent=function(e,t,o){var n=this;return l().createElement("div",{key:"gap-".concat(t),className:r.F51.meloPageGap,style:{backgroundColor:"transparent",opacity:.3,width:"100%",height:"".concat((0,c.twipsToPx)(o)*this.state.zoom,"px"),pointerEvents:"auto",top:"".concat((0,c.twipsToPx)(e)*this.state.zoom,"px"),zIndex:Rt.GapView},onMouseDown:function(e){e.stopPropagation()},onMouseMove:function(e){e.stopPropagation()},onMouseUp:function(e){e.stopPropagation()},onDoubleClick:function(){n.props.context.fire(new r.YDw)}})},t.prototype.printCoverComponent=function(){return l().createElement("div",{id:"print-disable-cover",style:{display:"none",position:"absolute",width:"100%",height:"1000px",zIndex:Rt.PrintCover,pointerEvents:"none",backgroundColor:"#fff",overflow:this.getPageOverflowStyle()}})},t.prototype.webLayoutFrontViewComponent=function(){var e=this.props.layoutBox,t=r.vW8.calcDocBoxSize(e),o=this.props.shares.decoratorManager.getDecorator(r.cip.Page),n=this.getFrontBehindContent(o,e).frontContent,i=this.getLayoutBoxZoomTransform(e);return this.frontViewComponent(n,(0,a.__assign)((0,a.__assign)({},t),{transform:i}))},t.prototype.frontViewComponent=function(e,t){return l().createElement("div",{className:r.F51.meloPageFrontView,style:(0,a.__assign)((0,a.__assign)({position:"absolute",zIndex:Rt.FrontView,pointerEvents:"none"},t),{overflow:this.getPageOverflowStyle()})},e)},t.prototype.upperAnchorViewComponent=function(e,t){var o=this;return l().createElement("div",{className:r.F51.meloPageUpperAnchorView,style:(0,a.__assign)((0,a.__assign)({position:"absolute",zIndex:Rt.UpperAnchorView,pointerEvents:"none"},t),{overflow:this.getPageOverflowStyle()})},l().createElement(F,{ref:function(t){o.upperAnchorRootElements[e]=t}}))},t.prototype.lowerAnchorViewComponent=function(e,t){var o=this;return l().createElement("div",{className:r.F51.meloPageLowerAnchorView,style:(0,a.__assign)((0,a.__assign)({position:"absolute",zIndex:Rt.LowerAnchorView},t),{overflow:this.getPageOverflowStyle()})},l().createElement(F,{ref:function(t){o.lowerAnchorRootElements[e]=t}}))},t.prototype.containerViewComponent=function(e,t){var o=this,n="".concat(r.F51.meloPageContainerView);return l().createElement("div",{className:"".concat(n," page-").concat(e),style:(0,a.__assign)({zIndex:Rt.ContainerView},t)},l().createElement(R,{ref:function(t){o.containerRootElements[e]=t},zoom:this.state.zoom}))},t.prototype.behindViewComponent=function(e,t){return l().createElement("div",{className:r.F51.meloPageBehindView,style:(0,a.__assign)((0,a.__assign)({position:"absolute",zIndex:Rt.BehindView,pointerEvents:"none",background:"rgba(255, 255, 255, var(--melo-page-opacity, 1))"},t),{overflow:this.getPageOverflowStyle()})},e)},t.prototype.renderCanvasViewComponent=function(e){var t=this;this.renderViewRefs[e]||(this.renderViewRefs[e]=l().createRef());var o=this.props.renderRect,n=this.state.zoom,i=[];return this.getRenderPages().forEach((function(a,s){e===s&&i.push(l().createElement("div",{className:r.F51.meloPageCanvasView,style:{zIndex:Rt.MainView},ref:t.renderViewRefs[e]},t.renderController.getRenderViewComponent(e,o,a,n)))})),i},t.prototype.getLayoutBoxZoomTransform=function(e,t){void 0===t&&(t={x:0,y:0});var o=this.state.zoom,n=(0,c.twipsToPx)(e.totalWidth-t.x)*(o-1)/2,r=(0,c.twipsToPx)(e.totalHeight-t.y)*(o-1)/2;return"matrix(".concat(o,", 0, 0, ").concat(o,", ").concat(n,", ").concat(r,")")},t.prototype.getRenderPages=function(){var e,t;return null!==(t=null===(e=this.props.layoutBox)||void 0===e?void 0:e.children)&&void 0!==t?t:[]},t}(Xe);function Vt(){var e;return(e={})[n.rl]=i.hy,e[n.yb]=kt,e[r.h9f]=st,e}Je.rX.syncLoad(f.y2q.Canvas,Vt)}}]),"object"==typeof globalThis&&(globalThis.jsExecEndTimeStamp=Date.now(),globalThis.cachedPerformanceEntries||(globalThis.cachedPerformanceEntries=[]),globalThis.cachedPerformanceEntries.push({name:"jsExec: js/public-5367-a6cd8d87.js",entryType:"jsExec",startTime:globalThis.jsExecStartTimeStamp,endTime:globalThis.jsExecEndTimeStamp}));
//# sourceMappingURL=public-5367-a6cd8d87.js.map