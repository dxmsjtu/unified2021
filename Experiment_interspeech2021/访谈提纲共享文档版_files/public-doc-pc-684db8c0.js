"object"==typeof globalThis&&(globalThis.jsExecStartTimeStamp=Date.now()),(self.webpackChunkuni=self.webpackChunkuni||[]).push([[6453,5100],{60783:function(e,t){t.Z={"fieldcode-draggable":"tdocs-fieldcode-draggable",fieldcodeDraggable:"tdocs-fieldcode-draggable"}},18285:function(e,t){t.Z={"doc-link-container":"tdocs-doc-link-container",docLinkContainer:"tdocs-doc-link-container","doc-link-container-active":"tdocs-doc-link-container-active",docLinkContainerActive:"tdocs-doc-link-container-active","doc-link-container-none":"tdocs-doc-link-container-none",docLinkContainerNone:"tdocs-doc-link-container-none","doc-link-container-lite":"tdocs-doc-link-container-lite",docLinkContainerLite:"tdocs-doc-link-container-lite","doc-link-container-canvas":"tdocs-doc-link-container-canvas",docLinkContainerCanvas:"tdocs-doc-link-container-canvas","doc-link-icon-wrapper":"tdocs-doc-link-icon-wrapper",docLinkIconWrapper:"tdocs-doc-link-icon-wrapper","doc-link-default":"tdocs-doc-link-default",docLinkDefault:"tdocs-doc-link-default","doc-link-doc":"tdocs-doc-link-doc",docLinkDoc:"tdocs-doc-link-doc","doc-link-sheet":"tdocs-doc-link-sheet",docLinkSheet:"tdocs-doc-link-sheet","doc-link-folder":"tdocs-doc-link-folder",docLinkFolder:"tdocs-doc-link-folder","doc-link-slide":"tdocs-doc-link-slide",docLinkSlide:"tdocs-doc-link-slide","doc-link-pdf":"tdocs-doc-link-pdf",docLinkPdf:"tdocs-doc-link-pdf","doc-link-form":"tdocs-doc-link-form",docLinkForm:"tdocs-doc-link-form","doc-link-card-wrapper":"tdocs-doc-link-card-wrapper",docLinkCardWrapper:"tdocs-doc-link-card-wrapper","doc-link-card-wrapper-mobile":"tdocs-doc-link-card-wrapper-mobile",docLinkCardWrapperMobile:"tdocs-doc-link-card-wrapper-mobile","doc-link-card-link-wrapper":"tdocs-doc-link-card-link-wrapper",docLinkCardLinkWrapper:"tdocs-doc-link-card-link-wrapper","doc-link-card-link-wrapper-missing-desc":"tdocs-doc-link-card-link-wrapper-missing-desc",docLinkCardLinkWrapperMissingDesc:"tdocs-doc-link-card-link-wrapper-missing-desc",left:"tdocs-left",placeholder:"tdocs-placeholder",right:"tdocs-right",title:"tdocs-title",desc:"tdocs-desc",url:"tdocs-url","button-wrapper":"tdocs-button-wrapper",buttonWrapper:"tdocs-button-wrapper","doc-link-card-link-app-wrapper":"tdocs-doc-link-card-link-app-wrapper",docLinkCardLinkAppWrapper:"tdocs-doc-link-card-link-app-wrapper","doc-link-card-link-app-overbtn":"tdocs-doc-link-card-link-app-overbtn",docLinkCardLinkAppOverbtn:"tdocs-doc-link-card-link-app-overbtn","doc-link-card-wedoc-wrapper":"tdocs-doc-link-card-wedoc-wrapper",docLinkCardWedocWrapper:"tdocs-doc-link-card-wedoc-wrapper","doc-link-card-wedoc-wrapper-preview":"tdocs-doc-link-card-wedoc-wrapper-preview",docLinkCardWedocWrapperPreview:"tdocs-doc-link-card-wedoc-wrapper-preview","doc-link-card-wedoc-wrapper-mobile":"tdocs-doc-link-card-wedoc-wrapper-mobile",docLinkCardWedocWrapperMobile:"tdocs-doc-link-card-wedoc-wrapper-mobile","melo-wedrive-file-card-wedoc-wrapper-preview":"tdocs-melo-wedrive-file-card-wedoc-wrapper-preview",meloWedriveFileCardWedocWrapperPreview:"tdocs-melo-wedrive-file-card-wedoc-wrapper-preview",success:"tdocs-success",loading:"tdocs-loading",error:"tdocs-error",deleted:"tdocs-deleted","file-icon":"tdocs-file-icon",fileIcon:"tdocs-file-icon",auth:"tdocs-auth",icon:"tdocs-icon","preview-text":"tdocs-preview-text",previewText:"tdocs-preview-text",action:"tdocs-action","inner-wrapper":"tdocs-inner-wrapper",innerWrapper:"tdocs-inner-wrapper","text-wrapper":"tdocs-text-wrapper",textWrapper:"tdocs-text-wrapper",text:"tdocs-text",wedrive:"tdocs-wedrive",creator:"tdocs-creator",actions:"tdocs-actions"}},74246:function(){},16751:function(e,t,n){n.r(t)},10804:function(e,t,n){n.d(t,{l:function(){return r},v:function(){return a}});var r,o=n(85556),i=n(30479);!function(e){e.ON_BACKGROUND_CHANGE="on_background_change"}(r||(r={}));var a=function(e){function t(t,n){var o=e.call(this,r.ON_BACKGROUND_CHANGE)||this;return o.backgroundId=t,o.transparency=n,o}return(0,o.__extends)(t,e),t}(i.Notification)},36094:function(e,t,n){n.d(t,{S9:function(){return r},fW:function(){return o},w0:function(){return s}});var r,o,i=n(85556),a=n(30479);!function(e){e.CREATEDOCCOPY="CREATEDOCCOPY",e.REFRESHANDFIX="refreshandfix",e.REFRESH="refresh",e.BEGINEDIT="beginedit",e.RELOGIN="relogin",e.CONTACT="contact",e.HOW2DEAL="how2deal",e.LEARNMORE="learnmore"}(r||(r={})),function(e){e.ON_CHANGESET_COMMIT_REJECTED="onChangesetCommitRejected",e.ON_CHANGESET_CHECK_INVALID="onChangesetCheckInvalid",e.ON_DISMISS_BLOCK_USER_EDIT="onDismissBlockUserEdit",e.ON_DISMISS_BLOCK_OFFLINE_EDIT="onDismissBlockOfflineEdit"}(o||(o={}));var s=function(e){function t(t){var n=e.call(this,o.ON_CHANGESET_COMMIT_REJECTED)||this;return n.blockInfo=t,n}return(0,i.__extends)(t,e),t}(a.Notification);(function(e){function t(t){var n=e.call(this,o.ON_CHANGESET_CHECK_INVALID)||this;return n.blockInfo=t,n}(0,i.__extends)(t,e)})(a.Notification),function(e){function t(t){var n=e.call(this,o.ON_DISMISS_BLOCK_USER_EDIT)||this;return n.target=t,n}(0,i.__extends)(t,e)}(a.Notification),function(e){function t(t){var n=e.call(this,o.ON_DISMISS_BLOCK_OFFLINE_EDIT)||this;return n.target=t,n}(0,i.__extends)(t,e)}(a.Notification)},3534:function(e,t,n){n.d(t,{N:function(){return r},l:function(){return a}});var r,o=n(85556),i=n(30479);!function(e){e.CONFIRM_CREATE_DOC_COPY="CONFIRM_CREATE_DOC_COPY"}(r||(r={}));var a=function(e){function t(){return e.call(this,r.CONFIRM_CREATE_DOC_COPY)||this}return(0,o.__extends)(t,e),t}(i.Notification)},30322:function(e,t,n){n.d(t,{J:function(){return r}});var r=function(){function e(){this._measure=document.createElement("div"),this.setInvisible(),document.body.appendChild(this._measure)}return e.prototype.setInvisible=function(){this._measure.style.display="none"},e.prototype.clear=function(){this._measure.innerHTML="",this._measure.removeAttribute("style"),this._measure.removeAttribute("class")},e.prototype.reset=function(){this.setInvisible()},e.prototype.attachStyle=function(e){var t=this;e.classname&&this._measure.classList.add(e.classname),e.style&&Object.keys(e.style).forEach((function(n){t._measure.style[n]=e.style[n]}))},e.prototype.getText=function(e,t){return t?t.replace(/%0/g,e):e},e.prototype.wrapWidth=function(e,t,n,r,o){void 0===r&&(r="..."),this.attachStyle(n),this.setInvisible(),this._measure.style.whiteSpace="nowrap";var i=this.getText(e,o);if(this._measure.innerText=i,this._measure.clientWidth>t)for(var a=e.substr(0,e.length-1);a.length>0&&(a=a.substr(0,a.length-1),i=this.getText("".concat(a).concat(r),o),this._measure.innerText=i,!(this._measure.clientWidth<t)););var s=this._measure.innerText;return this.reset(),s},e.prototype.wrapLine=function(e,t,n,r,o,i){void 0===o&&(o="..."),void 0===i&&(i=!0),this.attachStyle(r),this.setInvisible(),this._measure.style.width="".concat(t,"px"),this._measure.style.wordBreak="break-all",this._measure.style.whiteSpace="pre-wrap";var a=e.split("");this._measure.innerHTML="<span>".concat(o,"</span>\n").concat(a.map((function(e){return"<span>".concat(e,"</span>")})).join(""));for(var s=this._measure.firstElementChild,c=s.offsetWidth,l=s.offsetTop,u=-1,d=-1;s;){if(s.offsetTop>l&&(d+=1,l=s.offsetTop),d>=n){u-=1;break}if(d===n-1&&("\n"===s.innerHTML||s.offsetLeft+s.offsetWidth+c>t))break;u+=1,s=s.nextElementSibling}if(this.reset(),u===e.length)return e;var p=e.substr(0,u);return i?"".concat(p).concat(o):p},e}()},25709:function(e,t,n){n.d(t,{Sw:function(){return o},bW:function(){return i}});var r=function(e,t){return"".concat(encodeURIComponent(e),"=").concat(encodeURIComponent("object"==typeof t?JSON.stringify(t):t))};function o(e){var t=[];return Object.keys(e).forEach((function(n){e[n]instanceof Array?e[n].forEach((function(e){t.push(r(n,e))})):t.push(r(n,e[n]))})),t.join("&")}function i(){var e=navigator.userAgent.toLowerCase().match(/wxwork\/([0-9.]*)/);return e?e[1]:""}},63022:function(e,t,n){n.d(t,{Mu:function(){return a},Nc:function(){return l},ZN:function(){return s},hr:function(){return c},xs:function(){return u}});var r=n(2613),o=n(33931),i=function(e,t){if(e===r.MutationType.insert){var n=t;return{gcp:i=n.beginIndex,delta:n.text.length}}if(e===r.MutationType.delete){var o=t,i=o.beginIndex,a=o.endIndex;return{gcp:a,delta:i-a}}return null},a=function(e){var t=[];return e.forEach((function(e){var n=e.type,o=i(n,e);o&&t.push(o),n===r.MutationType.mlti&&e.content.forEach((function(e){var n=i(e.type,e);n&&t.push(n)}))})),t},s=function(e,t){var n=e;return t.forEach((function(e){n=function(e,t){var n=e,r=t.gcp,o=t.delta;return o>0&&n>=r?n+=o:o<0&&(n>=r?n+=o:n>=r+o&&(n=r+o)),n}(n,e)})),n},c=function(e,t){var n=e;return t.reverse().forEach((function(e){n=function(e,t){var n=e,r=t.gcp,o=t.delta;return(o>0&&n-o>=r||o<0&&n>=r+o)&&(n-=o),n}(n,e)})),n};function l(e){var t=[];return e.forEach((function(e){var n=e.changeset;null==n||n.forEach((function(e){e.mutations.forEach((function(e){t.push(e.getMutation())}))}))})),t}var u=function(e){return(0,o.By)((0,o.Uq)(e)).map((function(e){return e.getMutation()}))}},29068:function(e,t,n){n.d(t,{z:function(){return g}});var r=n(85556),o=n(23336),i=n.n(o),a=n(2613),s=n(76343),c=n(30479),l=n(49098),u=n.n(l),d=n(14366);function p(e){var t=[];return Object.keys(e).map((function(n){var r=e[n];Array.isArray(r)?r.forEach((function(e){t.push("".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(e)))})):void 0!==r&&t.push("".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(r)))})),t.join("&")}function f(e,t){var n,o;return(0,r.__awaiter)(this,void 0,void 0,(function(){var i,a,s,l;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:if(i=t.rsp.filter((function(e){return e.wedriveUin})),!(a=i.map((function(e){return e.wedriveUin}))).length)return[2,t];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,d.Z.post("/wedoc/doc_member_mgr",p({docid:e.padId,scode:(0,c.getUrlParameter)("scode")||"",func:8,wx_uin:a}))];case 2:return s=r.sent().data,0===(null===(n=s.head)||void 0===n?void 0:n.ret)&&(null===(o=s.body)||void 0===o?void 0:o.uin2xid)&&s.body.uin2xid.forEach((function(e){var t=i.findIndex((function(t){return t.wedriveUin===e.uin}));t>=0&&(i[t].xid=e.xid.toString())})),[3,4];case 3:return l=r.sent(),console.error(l),[3,4];case 4:return[2,t]}}))}))}function _(e,t){var n="[".concat(t.join(","),"]");return"[]"===n||!e.isLogin||e.userId.startsWith("g")?Promise.resolve({rsp:[]}):new Promise((function(t,r){i().ajax({url:"/sdc/getusermarkname",xhrFields:{withCredentials:!0},data:u().stringify({bkn:s.v.getBkn(),domainId:e.domainId,localPadId:e.localPadId,uids:n,xsrf:(0,a.getXsrf)()}),success:function(e){e&&0===e.retcode?t(e.result):r()},error:function(){r()}})}))}function h(e,t){return(0,r.__awaiter)(this,void 0,Promise,(function(){var e,n;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return t.filter((function(e){return e.startsWith("14")})).length,[2,{tinyIdToWedriveUin:{},wedriveUinToTinyId:{}}];case 1:return r.sent().rsp.forEach((function(t){t.wedriveUin&&(e[t.uid]=t.wedriveUin,n[t.wedriveUin]=t.uid)})),[2,{tinyIdToWedriveUin:e,wedriveUinToTinyId:n}]}}))}))}function m(e,t){var n,o;return(0,r.__awaiter)(this,void 0,void 0,(function(){var i,a,s,c,l,u;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return"[]"==="[".concat(t.join(","),"]")||!e.isLogin||e.userId.startsWith("g")?[2,{rsp:[]}]:[4,h(0,t)];case 1:i=r.sent(),a=i.tinyIdToWedriveUin,s=i.wedriveUinToTinyId,c=p({func:1,f:"json",auth_list:JSON.stringify({info:t.map((function(e){return{id:a[e]||e}}))})}),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,d.Z.post("/webdisk/member_info",c,{withCredentials:!0})];case 3:return l=r.sent(),[3,5];case 4:return u=r.sent(),console.error(u),[3,5];case 5:return 0===(null===(n=null==l?void 0:l.data.head)||void 0===n?void 0:n.ret)&&(null===(o=null==l?void 0:l.data.body)||void 0===o?void 0:o.member)?[4,f(e,{rsp:l.data.body.member.map((function(e){return{markName:e.english_name&&e.real_name?"".concat(e.english_name,"(").concat(e.real_name,")"):e.name,userId:s[e.id]||e.id||e.vid.toString(),uid:s[e.id]||e.id||e.vid.toString(),userPic:e.avatar,corpName:e.corp_name||"",wedriveUin:s[e.id]?a[s[e.id]]:void 0}}))})]:[3,7];case 6:return[2,r.sent()];case 7:return[2,Promise.resolve({rsp:[]})]}}))}))}var g=function(){function e(){}return e.getRemark=function(e,t,n){return void 0===n&&(n=!1),(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(r){return[2,n?m(e,t):_(e,t)]}))}))},e}()},99623:function(e,t,n){n.d(t,{Ep:function(){return i},HJ:function(){return o},R0:function(){return r}});var r="commit-changes-contain-revert",o="changeset-error-alert",i="how-to-deal-copy-all-data"},78356:function(e,t,n){n.r(t),n.d(t,{IAddMobileFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(54541),a=n(22595),s=Symbol.for("feature:".concat(a.C.AdMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(8794).then(n.bind(n,14482))];case 1:return[2,e.sent().AdMobileHandler]}}))}))},on:i.iz.On({key:s,stages:[i.YV.Level2],platforms:[i.Ev.Pad,i.Ev.Mobile],load:!1})})},88430:function(e,t,n){n.r(t),n.d(t,{IAddCooperator:function(){return a}});var r=n(85556),o=n(3139),i=n(22595),a=Symbol.for("feature:".concat(i.C.AddCooperator));o.Ln.merge(a,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(5797).then(n.bind(n,57757))];case 1:return[2,e.sent().AddCollabStatusEntHandler]}}))}))}})},13888:function(e,t,n){n.r(t),n.d(t,{IAddFastAccessFeature:function(){return a}});var r=n(85556),o=n(3139),i=n(22595),a=Symbol.for("feature:".concat(i.C.AddFastAccess));o.Ln.merge(a,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(1474).then(n.bind(n,2313))];case 1:return[2,e.sent().AddFastAccessHandler]}}))}))}})},47478:function(e,t,n){n.r(t),n.d(t,{IAddToWedriveFeature:function(){return s},WeDriveStatus:function(){return r}});var r,o=n(85556),i=n(3139),a=n(22595);!function(e){e.External="external",e.Internal="internal"}(r||(r={}));var s=Symbol.for("feature:".concat(a.C.AddToWedrive));i.Ln.merge(s,{useFactory:function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(5173).then(n.bind(n,68096))];case 1:return[2,e.sent().AddToWedriveHandler]}}))}))}})},53103:function(e,t,n){n.r(t),n.d(t,{IAddonMobileIframeFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.AddonMobileIframe)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(866),n.e(1800),n.e(5660)]).then(n.bind(n,93918))];case 1:return[2,e.sent().AddonMobileIframeHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2,a.YV.Publish],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!0})})},3951:function(e,t,n){n.r(t),n.d(t,{IAddonPasteHandler:function(){return s}});var r=n(85556),o=n(3139),i=n(54541),a=n(22595),s=Symbol.for("feature:".concat(a.C.AddonPaste));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(9714),n.e(7411),n.e(5218),n.e(6952),n.e(7131)]).then(n.bind(n,13394))];case 1:return[2,e.sent().AddonPasteHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level3],key:s,platforms:[i.Ev.Pc]})})},4787:function(e,t,n){n.r(t),n.d(t,{IAirPrintFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.AirPrint));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8487),n.e(33),n.e(8937),n.e(1168),n.e(866),n.e(2644),n.e(7411),n.e(4396),n.e(3298),n.e(6580),n.e(5218),n.e(9702),n.e(3152),n.e(9039),n.e(7180),n.e(6952),n.e(6022),n.e(5480),n.e(4333),n.e(520)]).then(n.bind(n,35564))];case 1:return[2,e.sent().AirPrintHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2,a.YV.Publish],key:s})})},47743:function(e,t,n){n.r(t),n.d(t,{IAppGuideFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.AppGuide)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(4573).then(n.bind(n,91461))];case 1:return[2,e.sent().AppGuideHandler]}}))}))},on:a.iz.On({stages:[a.YV.Publish,a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!0})})},25298:function(e,t,n){n.r(t),n.d(t,{IAppGuidePcFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.AppGuidePc));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(848).then(n.bind(n,22156))];case 1:return[2,e.sent().AppGuidePcHandler]}}))}))},on:a.iz.On({stages:[a.YV.Publish],key:s,platforms:[a.Ev.Pc]})})},36582:function(e,t,n){n.r(t),n.d(t,{IAttachmentFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.Attachment)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(9714),n.e(7411),n.e(5218),n.e(6952),n.e(7131)]).then(n.bind(n,97848))];case 1:return[2,e.sent().AttachmentHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3,a.YV.Publish],key:s,load:!0})})},2491:function(e,t,n){n.r(t),n.d(t,{IAutoNewlineFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.AutoNewline));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8487),n.e(33),n.e(8937),n.e(1168),n.e(866),n.e(2644),n.e(7411),n.e(4396),n.e(3298),n.e(6580),n.e(5218),n.e(9702),n.e(3152),n.e(9039),n.e(7180),n.e(6952),n.e(6022),n.e(5480),n.e(4333),n.e(520)]).then(n.bind(n,73846))];case 1:return[2,e.sent().AutoNewlineHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Pc]})})},54108:function(e,t,n){n.r(t),n.d(t,{BackgroundType:function(){return r},IBackgroundFeature:function(){return c}});var r,o=n(85556),i=(n(30479),n(3139)),a=n(54541),s=n(22595);!function(e){e[e.IMAGE=1]="IMAGE",e[e.GROUP_IMAGES=2]="GROUP_IMAGES",e[e.VIDEO=3]="VIDEO"}(r||(r={}));var c=Symbol.for("feature:".concat(s.C.Background));i.Ln.merge(c,{useFactory:function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8487),n.e(8937),n.e(866),n.e(2644),n.e(5218),n.e(3152),n.e(9445)]).then(n.bind(n,3624))];case 1:return[2,e.sent().BackgroundHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level4],key:c,platforms:[a.Ev.Pc,a.Ev.Mobile,a.Ev.Pad],load:!0})})},56457:function(e,t,n){n.r(t),n.d(t,{IBasicFormatFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.BasicFormat));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(9714),n.e(7411),n.e(5218),n.e(6952),n.e(7131)]).then(n.bind(n,30761))];case 1:return[2,e.sent().BasicFormatHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s})})},77241:function(e,t,n){n.r(t),n.d(t,{IBottomBarMobileFeature:function(){return l}});var r=n(85556),o=(n(30479),n(3139)),i=n(54541),a=n(15857),s=n(22595),c=n(38429),l=Symbol.for("feature:".concat(s.C.BottomBar));o.Ln.merge(l,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(3692).then(n.bind(n,41916))];case 1:return[2,e.sent().BottomBarHandler]}}))}))},on:i.iz.On({key:l,stages:[i.YV.Level2,i.YV.Publish],platforms:[i.Ev.Mobile,i.Ev.Pad],load:!a.qO.getInstance().isDrivePreview&&!c.cm})})},66275:function(e,t,n){n.r(t),n.d(t,{ICertificationFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.Certification)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8487),n.e(8937),n.e(866),n.e(2644),n.e(5218),n.e(3152),n.e(9445)]).then(n.bind(n,32057))];case 1:return[2,e.sent().CertificationHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level4],key:s,platforms:[a.Ev.Pc],load:!0})})},4688:function(e,t,n){n.r(t),n.d(t,{ICertificationMobileFeature:function(){return s}});var r=n(85556),o=(n(30479),n(3139)),i=n(54541),a=n(22595),s=Symbol.for("feature:".concat(a.C.CertificationMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(3886).then(n.bind(n,61925))];case 1:return[2,e.sent().CertificationMobileHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level4],key:s,platforms:[i.Ev.Mobile,i.Ev.Pad],load:!0})})},96837:function(e,t,n){n.r(t),n.d(t,{ICollabCaretFeature:function(){return l}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=n(50263),c=n(85464),l=Symbol.for("feature:".concat(i.C.CollabCaret));o.Ln.merge(l,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(1337).then(n.bind(n,37179))];case 1:return[2,e.sent().CollabCaretHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:l,load:!s.A.isTencentMeetingInWework()&&!c.W.isApiDoc})})},25862:function(e,t,n){n.r(t),n.d(t,{ICollabStatusMobileFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.CollabStatusMobile)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(5697).then(n.bind(n,39693))];case 1:return[2,e.sent().CollabStatusMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Pad,a.Ev.Mobile],load:!0})})},45768:function(e,t,n){n.r(t),n.d(t,{ICollaboratorDetailMobileFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.CollaboratorDetailMobile)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(8728).then(n.bind(n,62804))];case 1:return[2,e.sent().CollaboratorDetailMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!1})})},16024:function(e,t,n){n.r(t),n.d(t,{ICollectMobileFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(54541),a=n(22595),s=(n(30479),Symbol.for("feature:".concat(a.C.CollectMobile)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(4732).then(n.bind(n,6999))];case 1:return[2,e.sent().CollectMobileHandler]}}))}))},on:i.iz.On({key:s,stages:[i.YV.Level2],platforms:[i.Ev.Pad,i.Ev.Mobile],load:!1})})},67348:function(e,t,n){n.r(t),n.d(t,{ICollectPcFeature:function(){return a}});var r=n(85556),o=n(3139),i=n(22595),a=Symbol.for("feature:".concat(i.C.CollectPc));o.Ln.merge(a,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(7458).then(n.bind(n,74068))];case 1:return[2,e.sent().CollectPcHandler]}}))}))}})},14550:function(e,t,n){n.r(t),n.d(t,{IColorFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.Color));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(9714),n.e(7411),n.e(5218),n.e(6952),n.e(7131)]).then(n.bind(n,7178))];case 1:return[2,e.sent().ColorHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s})})},35312:function(e,t,n){n.r(t),n.d(t,{IColumnFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(54541),a=n(22595),s=Symbol.for("feature:".concat(a.C.Column));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(9714),n.e(7411),n.e(5218),n.e(6952),n.e(7131)]).then(n.bind(n,439))];case 1:return[2,e.sent().ColumnHandler]}}))}))},on:i.iz.On({key:s,stages:[i.YV.Level3],platforms:[i.Ev.Pc]})})},33109:function(e,t,n){n.r(t),n.d(t,{ICommentMobileFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.CommentMobile)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8487),n.e(9039),n.e(6022),n.e(9290)]).then(n.bind(n,91804))];case 1:return[2,e.sent().CommentMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!0})})},87809:function(e,t,n){n.r(t),n.d(t,{ICopyPasteProcessorFeature:function(){return s}});var r=n(85556),o=(n(30479),n(3139)),i=n(54541),a=n(22595),s=Symbol.for("feature:".concat(a.C.CopyPasteProcessor));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(9714),n.e(7411),n.e(5218),n.e(6952),n.e(7131)]).then(n.bind(n,79263))];case 1:return[2,e.sent().CopyPasteProcessorHandler]}}))}))},on:i.iz.On({key:s,stages:[i.YV.Level3,i.YV.Publish],platforms:[i.Ev.Pc,i.Ev.Mobile,i.Ev.Pad],load:!0})})},141:function(e,t,n){n.r(t),n.d(t,{ICoreEditHandler:function(){return a}});var r=n(85556),o=n(3139),i=n(22595),a=Symbol.for("feature:".concat(i.C.CoreEdit));o.Ln.merge(a,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.resolve().then(n.bind(n,55996))];case 1:return[2,e.sent().CoreEditHandler]}}))}))}})},55996:function(e,t,n){n.r(t),n.d(t,{CoreEditHandler:function(){return re}});var r,o=n(85556),i=n(87363),a=n.n(i),s=n(61533),c=n.n(s),l=n(2613),u=n(15857),d=n(14740),p=n(39553),f=n(46829),_=n(52739),h=n(75906),m=n(36094),g=n(3534),v=n(44166),b=n(87404),y=n(48687),w=n(3139),E=n(81346),C=n(42035),T=n(27613),x=n(30479),S=n(38298),I=n(13980),k=n(99623),R=n(35205),A=function(e){function t(t){var n=e.call(this,t)||this;return n._permissionCode=["60007","60015"],n._docNoexistCode=["40001"],n.onClickRefresh=function(){window.location&&window.multiAccountUtil.reload()},n.onClickRefreshAndFix=function(){var e=n.state.blockInfo?n.state.blockInfo.errCode:"",t=document.createEvent("CustomEvent");t.initCustomEvent("Melo_ClearOfflineData",!0,!0,{isBackup:!0,code:e,callback:function(){var e,t;null===(t=null===(e=window.multiAccountUtil)||void 0===e?void 0:e.reload)||void 0===t||t.call(e)}}),document.dispatchEvent(t)},n.onClick2Fix=function(){n.hideModal(),n.showConfirmModal()},n.onClickStartFix=function(){x.Logger.warn("clear offline data!!");var e=n.state.blockInfo?n.state.blockInfo.errCode:"",t=document.createEvent("CustomEvent");t.initCustomEvent("Melo_ClearOfflineData",!0,!0,{isBackup:!0,code:e,callback:function(){var e,t;null===(t=null===(e=window.multiAccountUtil)||void 0===e?void 0:e.reload)||void 0===t||t.call(e)}}),document.dispatchEvent(t)},n.onClickContact=function(){var e=n.state.blockInfo?n.state.blockInfo.errCode:"";n.eventEmitter.emit("$requestFeedback",e)},n.onClickHow2Deal=function(){var e=document.createEvent("CustomEvent");e.initCustomEvent(k.Ep,!0,!0,{}),document.dispatchEvent(e),n.showModal()},n.onClickLearnMore=function(){window.open(window.multiAccountUtil.getMultiUrl("https://".concat(window.location.hostname,"/doc/DWE9lbGhWTU9OV2VF?localnum=1&wxsdk=2.7.7")))},n.onClickCreateDocCopy=function(){n._editor.fire(new g.l)},n.onClickDetail=function(){var e;h.default.confirm({title:(0,d.$t)("提示"),content:a().createElement("div",{style:{overflow:"auto",maxHeight:"500px"}},null===(e=n.state.blockInfo)||void 0===e?void 0:e.errDetail),footer:null})},n.doExport=function(){var e=n.contextService.context.editor;if(e&&e instanceof l.MeloEditor){var t=n.contextService.context.clientVars;n.eventEmitter.emit("$requestExport",{editor:e,clientVars:t})}},n.showModal=function(){var e=n.state.blockInfo?n.state.blockInfo.errCode:"";e&&(-1!==n._docNoexistCode.indexOf(e)||n._permissionCode.indexOf(e)),n._modal=h.default.confirm({title:(0,d.$t)("如何处理"),content:n.renderContent(),footer:null})},n.hideModal=function(){n._modal&&n._modal.close()},n.showConfirmModal=function(){n._confirmModal=h.default.confirm({title:(0,d.$t)("提示"),content:n.renderConfirmContent(),footer:null})},n.hideConfirmModal=function(){n._confirmModal&&n._confirmModal.close()},n._editor=n.props.editor,n.state={visible:!1},l.GlobalContext.once(y.f8.BEFORE_REPLACE_URL,n.destory.bind(n),n),n}var n,r,i,s;return(0,o.__extends)(t,e),t.prototype.destory=function(){this.removeListener(),this.hideModal(),this.hideConfirmModal(),this.setState({visible:!1,blockInfo:void 0})},t.prototype.componentDidMount=function(){var e=this;this._editor&&(this._editor.on(m.fW.ON_CHANGESET_COMMIT_REJECTED,(function(t){x.Logger.info("BlockUserEditModal, commit rejected: ".concat(JSON.stringify(t.blockInfo))),e.setState({visible:!0,blockInfo:t.blockInfo}),u.qO.getInstance().setPrivilege({isBlocked:!0,isShutdown:!0}),t.blockInfo&&t.blockInfo.duration&&setTimeout((function(){e.setState({visible:!1})}),t.blockInfo.duration>1e3?t.blockInfo.duration:1e3),e.errorCodeReport({errorCode:t.blockInfo.errCode||"",message:m.fW.ON_CHANGESET_COMMIT_REJECTED,snackbarMsg:t.blockInfo.errMsg||""}),l.ReportHelper.weiMonitorCube({module:l.ICubeModule.Websocket,name:t.blockInfo.errCode,action:t.blockInfo.errMsg,msg:t.blockInfo.errDetail,ver1:JSON.stringify(t.blockInfo.action)})}),this),this._editor.on(m.fW.ON_CHANGESET_CHECK_INVALID,(function(t){x.Logger.info("BlockUserEditModal, check invalid: ".concat(JSON.stringify(t.blockInfo))),e.setState({visible:!0,blockInfo:t.blockInfo}),u.qO.getInstance().setPrivilege({isBlocked:!0}),t.blockInfo&&t.blockInfo.duration&&setTimeout((function(){e.setState({visible:!1})}),t.blockInfo.duration>1e3?t.blockInfo.duration:1e3),e.errorCodeReport({errorCode:t.blockInfo.errCode||"",message:m.fW.ON_CHANGESET_CHECK_INVALID,snackbarMsg:t.blockInfo.errMsg||""})}),this),this._editor.on(m.fW.ON_DISMISS_BLOCK_USER_EDIT,(function(t){e.state.blockInfo&&e.state.blockInfo.errCode===t.target&&(e.setState({visible:!1}),(0,v.Yi)().isOverConNum=!1,u.qO.getInstance().setPrivilege({isBlocked:!1}))}),this),this._editor.on(m.fW.ON_DISMISS_BLOCK_OFFLINE_EDIT,(function(){e.setState({visible:!1}),u.qO.getInstance().setPrivilege({isBlocked:!1})}),this))},t.prototype.componentWillUnmount=function(){this.removeListener()},t.prototype.removeListener=function(){l.GlobalContext.removeListener(y.f8.BEFORE_REPLACE_URL,this),this._editor&&(this._editor.removeListener(m.fW.ON_CHANGESET_COMMIT_REJECTED,this),this._editor.removeListener(m.fW.ON_CHANGESET_CHECK_INVALID,this),this._editor.removeListener(m.fW.ON_DISMISS_BLOCK_USER_EDIT,this),this._editor.removeListener(m.fW.ON_DISMISS_BLOCK_OFFLINE_EDIT,this))},t.prototype.getNowFormatDate=function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate();return n>=1&&n<=9&&(n="0".concat(n)),r>=0&&r<=9&&(r="0".concat(r)),t+"-"+n+"-"+r},t.prototype.renderContent=function(){var e=this.state.blockInfo?this.state.blockInfo.errCode:"",t=((0,d.$t)("为防止内容丢失，已复制全文到剪贴板，请粘贴到本地备份，再点击修复。"),(0,d.$t)("为防止内容丢失，已复制全文到剪贴板，请粘贴到本地或导出文件进行备份，再点击修复。")),n=((0,d.$t)("编辑权限已被收回，内容无法上传。为防止内容丢失，已复制全文到剪贴板，请粘贴到本地备份，再点击修复。"),(0,d.$t)("编辑权限已被收回，内容无法上传。为防止内容丢失，已复制全文到剪贴板，请粘贴到本地或导出文件进行备份，再点击修复。")),r=((0,d.$t)("文件已被创建者删除，内容无法上传。为防止内容丢失，已复制全文到剪贴板，请粘贴到本地备份，再点击修复。"),(0,d.$t)("文件已被创建者删除，内容无法上传。为防止内容丢失，已复制全文到剪贴板，请粘贴到本地或导出文件进行备份，再点击修复。"));return e&&-1!==this._permissionCode.indexOf(e)?t=n:e&&-1!==this._docNoexistCode.indexOf(e)&&(t=r),!e||-1===this._docNoexistCode.indexOf(e)&&this._permissionCode.indexOf(e),a().createElement("div",{style:{width:"100%"}},a().createElement("div",{style:{lineHeight:"15pt",marginTop:"15px"}},a().createElement("span",null,t)),a().createElement("div",{style:{marginTop:"5px"}},a().createElement("span",{style:{color:"darkgrey"}},e?(0,d.$t)("core-edit:error-code-with-date",{errCode:e,date:this.getNowFormatDate()}):"")),a().createElement("div",{style:{display:"flex",justifyContent:"space-between",marginTop:30}},a().createElement("div",{style:{paddingTop:"7px",cursor:"pointer"},onClick:this.onClickContact},(0,d.$t)("联系我们")),a().createElement("div",{style:{display:"flex"}},a().createElement(b.default,{style:{marginRight:16},onClick:this.onClick2Fix},(0,d.$t)("修复")),a().createElement(b.default,{type:"primary",onClick:this.doExport},(0,d.$t)("导出文档")))))},t.prototype.renderConfirmContent=function(){return a().createElement("div",{style:{width:"100%"}},a().createElement("div",{style:{lineHeight:"15pt",marginTop:"15px"}},a().createElement("span",null,(0,d.$t)("修复过程将会清除本地缓存，可能造成部分内容丢失。请确认内容已备份到本地，再开始修复。"))),a().createElement("div",{style:{display:"flex",justifyContent:"space-between",marginTop:30}},a().createElement("div",{style:{paddingTop:"7px",cursor:"pointer"},onClick:this.onClickContact},(0,d.$t)("联系我们")),a().createElement("div",{style:{display:"flex"}},a().createElement(b.default,{type:"primary",style:{marginRight:16},onClick:this.onClickStartFix},(0,d.$t)("开始修复")))))},t.prototype.render=function(){var e=this.state.blockInfo?this.state.blockInfo.errMsg:"",t="";this.state.blockInfo&&this.state.blockInfo.action&&(t=this.state.blockInfo.action.join(","));var n={},r="info";-1!==t.indexOf("".concat(m.S9.HOW2DEAL.toString()))&&(n={background:"rgb(255, 125, 111)",color:"white",zIndex:9997},r="error");var i=[];if(-1!==t.indexOf("".concat(m.S9.REFRESHANDFIX.toString())))i.push({text:(0,d.$t)("刷新"),onClick:this.onClickRefreshAndFix});else if(-1!==t.indexOf("".concat(m.S9.REFRESH.toString()))||-1!==t.indexOf("".concat(m.S9.BEGINEDIT.toString()))){var s=-1!==t.indexOf("".concat(m.S9.REFRESH.toString()))?(0,d.$t)("刷新"):(0,d.$t)("开始编辑");i.push({text:s,onClick:this.onClickRefresh})}else-1!==t.indexOf("".concat(m.S9.RELOGIN.toString()))&&i.push({text:(0,d.$t)("刷新"),onClick:this.loginService.login});-1!==t.indexOf("".concat(m.S9.CONTACT.toString()))&&i.push({text:(0,d.$t)("联系我们"),onClick:this.onClickContact}),-1!==t.indexOf("".concat(m.S9.LEARNMORE.toString()))&&i.push({text:(0,d.$t)("了解详情"),onClick:this.onClickLearnMore}),-1!==t.indexOf("".concat(m.S9.CREATEDOCCOPY.toString()))&&i.push({text:(0,d.$t)("生成副本"),onClick:this.onClickCreateDocCopy}),-1!==t.indexOf("".concat(m.S9.HOW2DEAL.toString()))&&i.push({text:(0,d.$t)("如何处理"),onClick:this.onClickHow2Deal});var c=[a().createElement(_.default,{key:"block-user-edit-tips",style:n,action:i,type:r,visible:this.state.visible,closable:!1},e)];return a().createElement.apply(a(),(0,o.__spreadArray)(["div",null],(0,o.__read)(c),!1))},t.prototype.errorCodeReport=function(e){var t=e.errorCode,n=e.message,r=e.snackbarMsg,o=void 0===r?"":r,i=e.type,a=void 0===i?"error":i,s=e.tipsCustom,c=void 0===s?"":s,l=window.location.href,u={errorCode:t,message:n,padType:"doc",uid:(0,I.getUid)(),url:l,snackbarMsg:o,tipsCustom:c,type:a,isLogin:(0,v.Yi)().isLogin};(0,S.webLogAndEsReport)(u)},(0,o.__decorate)([(0,w.tB)(),(0,o.__metadata)("design:type","function"==typeof(n=void 0!==E.U&&E.U)?n:Object)],t.prototype,"featureService",void 0),(0,o.__decorate)([(0,w.tB)(),(0,o.__metadata)("design:type","function"==typeof(r=void 0!==C.v&&C.v)?r:Object)],t.prototype,"eventEmitter",void 0),(0,o.__decorate)([(0,w.tB)(),(0,o.__metadata)("design:type","function"==typeof(i=void 0!==T.O&&T.O)?i:Object)],t.prototype,"contextService",void 0),(0,o.__decorate)([(0,w.tB)(),(0,o.__metadata)("design:type","function"==typeof(s=void 0!==R.r&&R.r)?s:Object)],t.prototype,"loginService",void 0),t}(a().Component),O=n(67480),L=n(4211),M=n(68656),N=n(77947);function D(){return D=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},D.apply(this,arguments)}function P(e){return i.createElement("svg",D({width:16,height:16,viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=i.createElement("path",{d:"M8 1a7 7 0 110 14A7 7 0 018 1zm0 1a6 6 0 100 12A6 6 0 008 2zm-.005 8.1c.22 0 .411.065.562.195.14.13.22.296.22.5 0 .204-.08.38-.23.51a.81.81 0 01-.552.195.817.817 0 01-.552-.204.627.627 0 01-.22-.5c0-.205.07-.371.22-.501a.81.81 0 01.552-.195zm.117-5.6c.662 0 1.202.158 1.61.492.408.325.611.77.611 1.336 0 .464-.132.845-.377 1.142-.091.093-.387.343-.876.733a1.47 1.47 0 00-.408.464c-.101.185-.152.38-.152.603v.13H7.348v-.13c0-.353.061-.659.204-.91.132-.25.53-.64 1.192-1.178l.122-.13c.183-.204.275-.427.275-.659 0-.306-.102-.547-.285-.724-.194-.176-.469-.26-.815-.26-.449 0-.764.121-.958.381-.173.213-.255.52-.255.91H5.667c0-.687.214-1.226.662-1.615.438-.39 1.03-.585 1.783-.585z",fill:"#CBCDD1",fillRule:"nonzero"})))}var F=n(22595),B=n(141),U=n(31218),H=n(31087),j=n(32230),W=n.n(j),V=n(99779),z="undo--ujaZd",G="redo--EdsVl",Y="disabled--M32o2",q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.disableMobileTitleBarUndo,r=t.onClick;return a().createElement("div",{className:W()(z,(e={},e[Y]=n,e)),onClick:function(){n||r()}})},t}(a().Component),Z=(0,V.x)(["disableMobileTitleBarUndo"])(q),J=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.disableMobileTitleBarRedo,r=t.onClick;return a().createElement("div",{className:W()(G,(e={},e[Y]=n,e)),onClick:function(){n||r()}})},t}(a().Component),K=(0,V.x)(["disableMobileTitleBarRedo"])(J),Q=n(47114),X=n(21856),$=n(1982),ee=n(67486),te="help-center-link--ddq+-",ne="help-center-icon--84ELR",re=function(){function e(e,t,n,r,o,i){var a=this;this.store=t,this.eventEmitter=n,this.mobileTitlebar=r,this.wxService=o,this.paragraphSHortcutMenuLoader=i,this.editor=null,this.isNotFullySupportTipsOn=!1,this.handleFixScroll=function(e){if(e.fromServer&&a.editor.docEnv.docViewType!==l.DocViewType.PresentationPreview){var t=a.editor.scrollHandler,n=a.editor.selection.gcpRange;if(!(n.length()>0)){var r=a.editor.getViewRangeFromGcpRange(n);if(r){var o=r.end.getDocumentOffset().y,i=t.getScrollTop();a.fixScrollHandler&&a.editor.removeCallBack(l.StateNotification.ModelChange,a.fixScrollHandler);try{var s=a.editor.createSelector(),c=a.editor.getDocumentBox().__node__.getBoundingClientRect(),u=c.left+c.width/2,d=i+t.getClientHeight()/2,p=a.getParaBoxByPos(s,u,d,r),f=a.getParaBoxOffsetY(p);a.fixScrollHandler=function(){var e=a.editor.getViewRangeFromGcpRange(a.editor.selection.gcpRange);if(e){var r,s=t.zoom();if(p.isValid()){var c=a.getParaBoxOffsetY(p,f);r=(0,x.twipsToPx)(c-f)}else r=e.end.getDocumentOffset().y-o;if(r){var l=i+r*s;document.body.classList.add("no-animation"),a.eventEmitter.emit("$requestRecalculatePosition",n),t.scrollTo(0,l,!1),document.body.classList.remove("no-animation")}}},a.editor.once(l.StateNotification.ModelChange,a.fixScrollHandler)}catch(e){x.Logger.error(e)}}}}},this.onEditorStateChange=function(e){[U.EditorState.STATE_EDIT,U.EditorState.STATE_INPUT,U.EditorState.STATE_MOBILE_BLOCK].includes(e)?a.showTitlebar():a.hideTitlebar()},this.onEfficientModelChange=function(){a.store.update("disableMobileTitleBarUndo",a.cannotUndo()),a.store.update("disableMobileTitleBarRedo",a.cannotRedo())},this.onClickUndo=function(){a.editor.run("undo"),a.updatePanel(),x.RAFJankUtil.log({key:"mTB_undo"})},this.onClickRedo=function(){a.editor.run("redo"),a.updatePanel()},this.context=e.context}var t,n,r,i,s,m;return Object.defineProperty(e.prototype,"paragraphShortcutMenuHandler",{get:function(){return this.paragraphSHortcutMenuLoader.instance},enumerable:!1,configurable:!0}),e.prototype.$onEditorOpen=function(e){this.editor=e,this.registerNotification(),this.mountToTitlebar();var t=document.createElement("div");t.id="block-user-edit-modal-container",document.body.appendChild(t),c().render(a().createElement(A,{editor:this.editor,context:this.context}),t),this.editor.clipboardManager.addPasteDstProcessor(l.PasteDstType.SubStory,f.F);var n=this.editor.view.getDom();n&&(n.addEventListener("copy",this.showCopyPermission),n.addEventListener("cut",this.showCopyPermission)),this.editor.on(l.StateNotification.BeforeApplyDelta,this.handleFixScroll),this.wxService.setup()},e.prototype.$onEditorClose=function(){var e;null===(e=this.$sub)||void 0===e||e.unsubscribe(),this.unregisterNotification(),this.unmountFromTitlebar(),this.isNotFullySupportTipsOn=!1,u.qO.getInstance().setPrivilege({isBlocked:!1});var t=document.getElementById("block-user-edit-modal-container");t&&(c().unmountComponentAtNode(t),document.body.removeChild(t));var n=this.editor.view.getDom();n&&(n.removeEventListener("copy",this.showCopyPermission),n.removeEventListener("cut",this.showCopyPermission)),this.editor.removeCallBack(l.StateNotification.BeforeApplyDelta,this.handleFixScroll),this.store.clear("disableMobileTitleBarUndo"),this.store.clear("disableMobileTitleBarRedo")},e.prototype.showPasteModal=function(e){void 0===e&&(e=!1);var t=x.PlatformUtil.isMac()?"⌘":"Ctrl";e&&(t+="+Shift"),h.Modal.confirm({title:(0,d.$t)("core-edit:right-click-paste-instructions"),content:(0,d.$t)("core-edit:use-shortcut-key-without-permission",{ctrl:t}),action:a().createElement("div",{className:te},a().createElement("div",{style:{marginRight:"4px"}},(0,d.$t)("帮助中心")),a().createElement(P,{className:ne})),onClickAction:function(){var e=X.X.getInstance().getConfig("custom.links.pasteInstructions");(0,p.l)({url:(0,ee.O1)(e)})},okText:(0,d.$t)("我知道了"),cancelText:null,maskClosable:!0})},e.prototype.getParaBoxByPos=function(e,t,n,r){var o;if(this.editor.docEnv.renderType===l.RenderType.Canvas){var i=e.findHitViewPoint(!1,!1,!1,{x:(0,x.pxToTwips)(t),y:(0,x.pxToTwips)(n)});o=this.getViewPortParaBox(i,r)}else o=e.getParaBoxLiteByClientY(n,this.editor.getDocumentBox().firstChild.children);return o},e.prototype.getViewPortParaBox=function(e,t){var n=e;return e||(n=t.end),n.lineBox.parentBox},e.prototype.getParaBoxOffsetY=function(e,t){var n;if((0,l.isParagraphBox)(e))n=l.LayoutUtil.getOffsetPoint(e,l.BoxKind.Document).y;else{if(!e.__node__)return t||0;n=(0,x.pxToTwips)(e.__node__.getBoundingClientRect().top)}return n},e.prototype.notEditable=function(){return this.context.permission&&!this.context.permission.isEditable},e.prototype.cannotUndo=function(){return!this.editor||this.notEditable()||!this.editor.run("isUndoAvailable")},e.prototype.cannotRedo=function(){return!this.editor||this.notEditable()||!this.editor.run("isRedoAvailable")},e.prototype.showTitlebar=function(){this.mobileTitlebar.show("mobile-titlebar-undo"),this.mobileTitlebar.show("mobile-titlebar-redo")},e.prototype.hideTitlebar=function(){this.mobileTitlebar.hide("mobile-titlebar-undo"),this.mobileTitlebar.hide("mobile-titlebar-redo")},e.prototype.mountToTitlebar=function(){this.mobileTitlebar.hydrate("mobile-titlebar-undo",a().createElement(Z,{onClick:this.onClickUndo})),this.mobileTitlebar.hydrate("mobile-titlebar-redo",a().createElement(K,{onClick:this.onClickRedo})),this.hideTitlebar()},e.prototype.unmountFromTitlebar=function(){this.mobileTitlebar.deHydrate("mobile-titlebar-undo"),this.mobileTitlebar.deHydrate("mobile-titlebar-redo")},e.prototype.registerNotification=function(){var e=this;this.editor.on(l.StateNotification.DeleteContainer,(function(t){if(!t.fromServer){var n=t.drawingList,r=[];if(n){var o=e.editor.getDrawingStream();o?n.forEach((function(e){var t=e.drawing.graphic.graphicData.wsp.txbx.contentId,n=o.getDrawingInfoFromContentId(t);n&&n.range.isValid()?x.Logger.warn("delete story waring: unexpected story to be deleted! content id = ".concat(t)):r.push(t)})):x.Logger.warn("delete story waring: ContainerManager invalid!"),r.length>0&&e.editor.service.getDocument().removeContainerStories(r,l.CommandType.DocDeleteCodeBlock)}}}),this),this.editor.on(l.ClipboardNotificationType.ON_COPY,(function(t){t&&(x.PlatformUtil.isIE()||x.PlatformUtil.isEdge())&&e.showNotFullySupportTips()}),this),this.editor.on(l.ClipboardNotificationType.ON_CUT,(function(t){t&&(x.PlatformUtil.isIE()||x.PlatformUtil.isEdge())&&e.showNotFullySupportTips()}),this),this.editor.on(l.ClipboardNotificationType.ON_PASTE,(function(t){t&&(x.PlatformUtil.isIE()||x.PlatformUtil.isEdge())&&e.showNotFullySupportTips()}),this),this.editor&&this.editor.on(l.StateNotification.ApplyDeltaCheck,(function(){e.showApplyDeltaCheckFailTips()}),this)},e.prototype.unregisterNotification=function(){this.editor.removeListener(l.StateNotification.DeleteContainer,this),this.editor.removeListener(l.ClipboardNotificationType.ON_COPY,this),this.editor.removeListener(l.ClipboardNotificationType.ON_CUT,this),this.editor.removeListener(l.ClipboardNotificationType.ON_PASTE,this),this.editor.removeListener(l.StateNotification.DeleteContainer,this),this.editor.removeListener(l.StateNotification.ApplyDeltaCheck,this),this.editor.removeCallBack(l.StateNotification.EfficientModelChange,this.onEfficientModelChange),this.editor.removeCallBack(l.StateNotification.BeforeApplyDelta,this.handleFixScroll)},e.prototype.showNotFullySupportTips=function(){var e=this;this.isNotFullySupportTipsOn||(_.Snackbar.show({message:(0,d.$t)("复制粘贴可能会有格式丢失，推荐使用Chrome浏览器或下载腾讯文档客户端。"),type:"info",autoClose:!1,closable:!0,action:(0,d.$t)("立即下载"),onClickAction:function(){window.open(X.X.getInstance().getConfig("custom.links.downloadApp"))},onClose:function(){e.isNotFullySupportTipsOn=!1}}),this.isNotFullySupportTipsOn=!0)},e.prototype.showSafariOnlyTextTips=function(){var e=!1;x.PlatformUtil.isSafari()&&x.PlatformUtil.isMac()&&(e=navigator.userAgent.toLocaleLowerCase().indexOf("version/13.1")>-1),e&&_.Snackbar.show({message:(0,d.$t)("已复制文本"),autoClose:!0,closable:!1,action:(0,d.$t)("了解更多"),onClickAction:function(){h.Modal.confirm({title:(0,d.$t)("提示"),content:(0,d.$t)("当前Safari版本不支持富文本复制粘贴，请升级Safari版本或者下载腾讯文档客户端。"),cancelText:(0,d.$t)("取消"),okText:(0,d.$t)("下载"),onOk:function(){window.open(X.X.getInstance().getConfig("custom.links.download"))}})}})},e.prototype.showCopyPermission=function(){u.qO.getInstance().isCopyable||_.Snackbar.show({message:(0,d.$t)("文档管理员限制了查看者的操作权限，无法复制内容。"),autoClose:!0,duration:3e3})},e.prototype.updatePanel=function(){var e=this.store.get(L.j.MobilePanels);e.next(e.getValue())},e.prototype.shouldDisableRedoUndo=function(){var e;return!!(null===(e=this.editor)||void 0===e?void 0:e.isInBlockState())},e.prototype.showApplyDeltaCheckFailTips=function(){_.Snackbar.show({message:(0,d.$t)("本次操作内容过多，无法应用。建议删减后重试。"),type:"info",autoClose:!0,closable:!1,duration:3e3}),l.ReportHelper.tdwReport&&l.ReportHelper.tdwReport({opername:"doc_core",module:"data",action:"verify"})},e.prototype.deleteParagraph=function(){var e,t,n=null===(e=this.paragraphShortcutMenuHandler)||void 0===e?void 0:e.getParagraphGCPRange($.CURSOR_TYPE.NULL,!0);null===(t=this.editor)||void 0===t||t.onSelection().delete(n)},e.prototype.cutParagraph=function(){var e,t,n=null===(e=this.paragraphShortcutMenuHandler)||void 0===e?void 0:e.getParagraphGCPRange($.CURSOR_TYPE.NULL,!0);null===(t=this.editor)||void 0===t||t.clipboardManager.cut(n)},e.prototype.copyParagraph=function(){var e,t,n=null===(e=this.paragraphShortcutMenuHandler)||void 0===e?void 0:e.getParagraphGCPRange($.CURSOR_TYPE.NULL,!0);null===(t=this.editor)||void 0===t||t.clipboardManager.copy(n)},e=(0,o.__decorate)([(0,M.L)({name:F.C.CoreEdit,adapters:["melo"],provide:B.ICoreEditHandler}),(0,o.__param)(5,(0,w.aN)($.IParagraphShortcutMenuFeature)),(0,o.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==T.O&&T.O)?t:Object,"function"==typeof(n=void 0!==N.O&&N.O)?n:Object,"function"==typeof(r=void 0!==C.v&&C.v)?r:Object,"function"==typeof(i=void 0!==H.E&&H.E)?i:Object,"function"==typeof(s=void 0!==Q.Do&&Q.Do)?s:Object,"function"==typeof(m=void 0!==O.IDynamicLoader&&O.IDynamicLoader)?m:Object])],e)}()},3033:function(e,t,n){n.r(t),n.d(t,{IDiffViewFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.DiffView));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5218),n.e(1087),n.e(5497)]).then(n.bind(n,18925))];case 1:return[2,e.sent().DiffViewHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s,platforms:[a.Ev.Pc],load:!1})})},20071:function(e,t,n){n.r(t),n.d(t,{IDiffViewMobileFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.DiffViewMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5218),n.e(1087),n.e(5497)]).then(n.bind(n,31539))];case 1:return[2,e.sent().DiffViewMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s,platforms:[a.Ev.Pad,a.Ev.Mobile],load:!1})})},51457:function(e,t,n){n.r(t),n.d(t,{IDocViewMobileFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.DocViewMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(548).then(n.bind(n,34208))];case 1:return[2,e.sent().DocViewMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},58301:function(e,t,n){n.r(t),n.d(t,{IDoclinkPasteHandler:function(){return s}});var r=n(85556),o=n(3139),i=n(54541),a=n(22595),s=Symbol.for("feature:".concat(a.C.DoclinkPaste));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(9714),n.e(7411),n.e(5218),n.e(6952),n.e(7131)]).then(n.bind(n,34314))];case 1:return[2,e.sent().DoclinkPasteHandler]}}))}))},on:i.iz.On({key:s,platforms:[i.Ev.Pc],stages:[i.YV.Level3]})})},17570:function(e,t,n){n.r(t),n.d(t,{IEditFollowFeature:function(){return l}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=n(30479),c=n(50263),l=Symbol.for("feature:".concat(i.C.EditFollow));o.Ln.merge(l,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(3417).then(n.bind(n,82951))];case 1:return[2,e.sent().EditFollowHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level1],key:l,load:c.A.isMeetingEnv()&&"meeting"!==(0,s.getUrlParameter)("mode")&&"player"!==(0,s.getUrlParameter)("show"),platforms:[a.Ev.Pc,a.Ev.Mobile,a.Ev.Pad]})})},86878:function(e,t,n){n.r(t),n.d(t,{IEditTipsMobileFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.EditTipsMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(764).then(n.bind(n,19290))];case 1:return[2,e.sent().EditTipsMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},93969:function(e,t,n){n.r(t),n.d(t,{IExternalTagFeature:function(){return s}});var r=n(85556),o=(n(30479),n(3139)),i=n(54541),a=n(22595),s=Symbol.for("feature:".concat(a.C.ExternalTag));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(7515).then(n.bind(n,60432))];case 1:return[2,e.sent().ExternalTagHandler]}}))}))},on:i.iz.On({key:s,platforms:[i.Ev.Pc],stages:[i.YV.Level2],load:!1})})},36206:function(e,t,n){n.r(t),n.d(t,{IFanbookFeature:function(){return c}});var r=n(85556),o=(n(30479),n(3139)),i=n(54541),a=n(21856),s=n(22595),c=Symbol.for("feature:".concat(s.C.Fanbook)),l="fanbook"===a.X.getInstance().getConfig("client");o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9192).then(n.bind(n,28923))];case 1:return[2,e.sent().FanbookHandler]}}))}))},on:i.iz.On({key:c,platforms:[i.Ev.Mobile],stages:[i.YV.Level2],load:l})})},37794:function(e,t,n){n.r(t),n.d(t,{IFastEditFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.FastEdit));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(8887).then(n.bind(n,77935))];case 1:return[2,e.sent().FastEditHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},49511:function(e,t,n){n.d(t,{Hz:function(){return l},U5:function(){return r},cJ:function(){return c}});var r,o=n(87363),i=n.n(o),a=n(14740),s=n(818);!function(e){e.Insert="fieldDemoInsert",e.Update="fieldDemoUpdate",e.Delete="fieldDemoDelete"}(r||(r={}));var c=[{name:r.Insert,content:(0,a.$t)("field:demo-insert"),respectOffline:!0}],l=[{name:r.Update,type:"icon",tooltip:(0,a.$t)("field:update"),icon:i().createElement("div",{className:s.jG.Edit})},{name:r.Delete,type:"icon",tooltip:(0,a.$t)("field:delete"),icon:i().createElement("div",{className:s.jG.Delete})}]},91782:function(e,t,n){n.r(t),n.d(t,{IFieldDemoFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.FieldDate));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(9714),n.e(7411),n.e(5218),n.e(6952),n.e(7131)]).then(n.bind(n,62956))];case 1:return[2,e.sent().FieldDemoHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3,a.YV.Publish],key:s})})},7283:function(e,t,n){n.r(t),n.d(t,{IFieldFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.Field));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9454).then(n.bind(n,4729))];case 1:return[2,e.sent().FieldHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level1,a.YV.Publish],key:s})})},18037:function(e,t,n){n.d(t,{Io:function(){return d},_W:function(){return c},hC:function(){return u},kz:function(){return l}});var r=n(85556),o=n(2613),i=n(14532),a=n.n(i),s=n(14740);function c(e){var t=JSON.stringify({id:e.id,timestamp:e.timestamp,status:e.status,fullDay:e.fullDay,repeat:e.repeat,notify:e.notify,utimestamp:e.utimestamp});return"".concat(o.FieldName.DATE_REMINDER," ").concat(t)}function l(e,t){void 0===t&&(t=!1);try{var n=e;if(!t){var i=new RegExp("".concat(o.FieldName.DATE_REMINDER," (.*)")).exec(e);n=(0,r.__read)(i,2)[1]}var a=JSON.parse(n);return{timestamp:a.timestamp,id:a.id,status:a.status,fullDay:a.fullDay,repeat:a.repeat,notify:a.notify,utimestamp:a.utimestamp}}catch(e){return}}function u(e){var t=new Date(e.timestamp),n=new Date,r=t.getFullYear()===n.getFullYear(),o=!!e.fullDay,i=r?[(0,s.$t)("MM月DD日")]:[(0,s.$t)("YYYY年MM月DD日")];return o||i.push("HH:mm"),i.map((function(e){return a()(t).format(e)})).join(" ")}function d(e,t){var n=e.service.getSelection().getParaRange(t.begin());if(n){var r=new o.GCPRange(n.begin(),t.begin()-n.begin());return e.getRefText(r).slice(0,512)}}},17760:function(e,t,n){n.r(t),n.d(t,{IFieldcodeDateHandler:function(){return a}});var r=n(85556),o=n(22595),i=n(3139),a=(n(30479),Symbol.for("feature:".concat(o.C.FieldcodeDate)));i.Ln.merge(a,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(33),n.e(5781)]).then(n.bind(n,74682))];case 1:return[2,e.sent().FieldcodeDateHandler]}}))}))}})},30867:function(e,t,n){n.r(t),n.d(t,{IFileInfoPanelMobileFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.FileInfoPanelMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(3763).then(n.bind(n,12460))];case 1:return[2,e.sent().FileInfoPanelMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},31947:function(e,t,n){n.r(t),n.d(t,{IFileMobileFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.FileMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8487),n.e(451)]).then(n.bind(n,30655))];case 1:return[2,e.sent().FileMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},25373:function(e,t,n){n.r(t),n.d(t,{IFileWechatFeature:function(){return c}});var r=n(85556),o=n(30479),i=n(3139),a=n(54541),s=n(22595),c=Symbol.for("feature:".concat(s.C.FileWechat)),l="file"===(0,o.getUrlParameter)("qq_doc_source");i.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(7836).then(n.bind(n,77089))];case 1:return[2,e.sent().FileWechatHandler]}}))}))},on:a.iz.On({key:c,stages:[a.YV.Level1],platforms:[a.Ev.Mobile,a.Ev.Pad,a.Ev.Pc],load:o.PlatformUtil.isWXMiniProgram()||o.PlatformUtil.isQQ()||l})})},76819:function(e,t,n){n.r(t),n.d(t,{IFormatPainterFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.FormatPainter));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(9714),n.e(7411),n.e(5218),n.e(6952),n.e(7131)]).then(n.bind(n,90999))];case 1:return[2,e.sent().FormatPainterHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s})})},72588:function(e,t,n){n.r(t),n.d(t,{IGuideToWeworkFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),n(86667),Symbol.for("feature:".concat(i.C.GuideToWework)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(3038).then(n.bind(n,98966))];case 1:return[2,e.sent().GuideToWeworkHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level1],key:s,load:!1})})},90376:function(e,t,n){n.r(t),n.d(t,{IHeadingFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.Heading));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(9714),n.e(7411),n.e(5218),n.e(6952),n.e(7131)]).then(n.bind(n,25898))];case 1:return[2,e.sent().HeadingHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s})})},55747:function(e,t,n){n.r(t),n.d(t,{IHelpCenterFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.HelpCenter)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8487),n.e(8937),n.e(866),n.e(2644),n.e(5218),n.e(3152),n.e(9445)]).then(n.bind(n,73573))];case 1:return[2,e.sent().HelpCenterHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level4],key:s,platforms:[a.Ev.Pc],load:!0})})},77683:function(e,t,n){n.r(t),n.d(t,{IHelpAndFeedBackCenterHandler:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.HelpAndFeedBack)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9477).then(n.bind(n,37290))];case 1:return[2,e.sent().HelpAndFeedBackCenterHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level4],key:s,platforms:[a.Ev.Pc],load:!1})})},23544:function(e,t,n){n.r(t),n.d(t,{IHintFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.Hint));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(9714),n.e(7411),n.e(5218),n.e(6952),n.e(7131)]).then(n.bind(n,63252))];case 1:return[2,e.sent().HintHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s})})},56128:function(e,t,n){n.r(t),n.d(t,{IMobileHomeFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(54541),a=n(22595),s=Symbol.for("feature:".concat(a.C.HomeMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(4212).then(n.bind(n,64987))];case 1:return[2,e.sent().MobileHomeHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level2],key:s,platforms:[i.Ev.Mobile,i.Ev.Pad]})})},66422:function(e,t,n){n.r(t),n.d(t,{IImageFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.Image));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(9714),n.e(7411),n.e(5218),n.e(6952),n.e(7131)]).then(n.bind(n,60184))];case 1:return[2,e.sent().ImageHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s})})},84371:function(e,t,n){n.r(t),n.d(t,{IImageMobileFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.ImageMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(9714),n.e(6359)]).then(n.bind(n,56588))];case 1:return[2,e.sent().ImageMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},83181:function(e,t,n){n.r(t),n.d(t,{IImagePcFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(54541),a=n(22595),s=Symbol.for("feature:".concat(a.C.ImagePc));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(9714),n.e(7411),n.e(5218),n.e(6952),n.e(7131)]).then(n.bind(n,49543))];case 1:return[2,e.sent().ImagePcHandler]}}))}))},on:i.iz.On({key:s,stages:[i.YV.Level3],platforms:[i.Ev.Pc]})})},72941:function(e,t,n){n.r(t),n.d(t,{IIpadAppKeyboardFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.IpadAppKeyboard));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(4709).then(n.bind(n,51237))];case 1:return[2,e.sent().IpadAppKeyboardHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s,platforms:[a.Ev.Pad]})})},21116:function(e,t,n){n.r(t),n.d(t,{ILandspaceStateFeature:function(){return c},IS_LANDSPACE:function(){return s}});var r=n(85556),o=(n(30479),n(3139)),i=n(54541),a=n(22595),s="IS_LANDSPACE",c=Symbol.for("feature:".concat(a.C.LandspaceState));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(1278).then(n.bind(n,31278))];case 1:return[2,e.sent().LandspaceStateFeature]}}))}))},on:i.iz.On({stages:[i.YV.Level3],key:c,load:!1,platforms:[i.Ev.Mobile]})})},42861:function(e,t,n){n.r(t),n.d(t,{ILikeMobileFeature:function(){return c}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),n(15857)),c=Symbol.for("feature:".concat(i.C.LikeMobile));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(899).then(n.bind(n,16438))];case 1:return[2,e.sent().LikeMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:c,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!s.qO.getInstance().isOcrPreview})})},91412:function(e,t,n){n.r(t),n.d(t,{IListFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.List));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(9714),n.e(7411),n.e(5218),n.e(6952),n.e(7131)]).then(n.bind(n,80517))];case 1:return[2,e.sent().ListHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s})})},4999:function(e,t,n){n.r(t),n.d(t,{IMobileLocalEditFeature:function(){return c}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),n(38429)),c=Symbol.for("feature:".concat(i.C.LocalEditMobile));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(1168),n.e(9399)]).then(n.bind(n,35121))];case 1:return[2,e.sent().MobileLocalEditFeature]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:c,platforms:[a.Ev.Pad,a.Ev.Mobile],load:s.cm&&!0})})},76511:function(e,t,n){n.d(t,{a:function(){return d}});var r=n(85556),o=n(82959),i=n(3139),a=n(77947),s=n(42035),c=n(37769),l=n(29382),u=n(30479),d=function(){function e(){var e=this;this.showRenameDocumentDialog=function(){window.mqq.invoke("docx","renameLocalFile",{},(function(t){"succeed"===t.result&&(o.v.getInstance().updateLocalEditInfo(t.data.path,t.data.title),e.onTitleConfirm((0,l.HV)()))}))},this.initEvent=function(){e.$subRequestRename=e.eventEmitter.listen("$requestRename",e.showRenameDocumentDialog)},this.onTitleConfirm=function(t){document.title=t,window.clientVars&&(window.clientVars.title=t,window.clientVars.padTitle=t),e.updateLocalTitle(t)},this.updateLocalTitle=function(t){e.store.update("docTitle",t)},this.initEvent()}var t,n;return e.prototype.setTitleForDoc=function(e){this.updateLocalTitle(e)},e.prototype.autoUpdateTitle=function(e){this.updateLocalTitle(e)},e.prototype.updateDocInitTitle=function(){this.updateLocalTitle((0,l.HV)())},e.prototype.setTitleToNativeTitlebar=function(){u.Logger.info("LocalEditTitleManager setTitleToNativeTitlebar")},e.prototype.destroy=function(){u.Logger.info("LocalEditTitleManager destroy")},(0,r.__decorate)([(0,i.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==a.O&&a.O)?t:Object)],e.prototype,"store",void 0),(0,r.__decorate)([(0,i.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==s.v&&s.v)?n:Object)],e.prototype,"eventEmitter",void 0),e=(0,r.__decorate)([(0,c.t)(),(0,r.__metadata)("design:paramtypes",[])],e)}()},90805:function(e,t,n){n.r(t),n.d(t,{ILocalEditTitlebarConfigService:function(){return c}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=n(38429),c=Symbol.for("feature:".concat(i.C.MobileLocalEditHeader));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(1168),n.e(9399)]).then(n.bind(n,85380))];case 1:return[2,e.sent().LocalEditTitlebarConfigService]}}))}))},on:a.iz.On({stages:[a.YV.Level1],key:c,platforms:[a.Ev.Pad,a.Ev.Mobile],load:s.kE})})},15360:function(e,t,n){n.r(t),n.d(t,{ILocalFileSaveFeature:function(){return c}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),n(38429)),c=Symbol.for("feature:".concat(i.C.LocalFileSave));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(3909).then(n.bind(n,22331))];case 1:return[2,e.sent().LocalFileSaveFeature]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:c,platforms:[a.Ev.Pc],load:s.cm&&!0})})},83996:function(e,t,n){n.r(t),n.d(t,{IManualOfflineFeature:function(){return a}});var r=n(85556),o=n(3139),i=n(54541),a=Symbol.for("feature:manualOffline");o.Ln.merge(a,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(1168),n.e(313)]).then(n.bind(n,72010))];case 1:return[2,e.sent().ManualOfflineHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level2],key:a,platforms:[i.Ev.Mobile,i.Ev.Pad]})})},68643:function(e,t,n){n.r(t),n.d(t,{IMarkdownFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.Markdown));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(9714),n.e(7411),n.e(5218),n.e(6952),n.e(7131)]).then(n.bind(n,29416))];case 1:return[2,e.sent().MarkdownHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s,platforms:[a.Ev.Pc]})})},12494:function(e,t,n){n.r(t),n.d(t,{IMiniListFeature:function(){return c}});var r=n(85556),o=n(3139),i=n(54541),a=n(22595),s=n(85464),c=(n(30479),Symbol.for("feature:".concat(a.C.MiniList)));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(6978).then(n.bind(n,43208))];case 1:return[2,e.sent().MiniListHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level1],key:c,platforms:[i.Ev.Pc],load:!s.W.isWeWortkEmbeddedDiscussionDoc})})},87942:function(e,t,n){n.r(t),n.d(t,{IMobileAutoScrollFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.MobileAutoScroll));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(5362).then(n.bind(n,26656))];case 1:return[2,e.sent().MobileAutoScrollHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!1})})},76092:function(e,t,n){n.r(t),n.d(t,{IMobileBlockInterface:function(){return s}});var r=n(85556),o=n(22595),i=n(3139),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(o.C.MobileBlock)));i.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(1180).then(n.bind(n,51180))];case 1:return[2,e.sent().MobileBlockHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!0})})},89236:function(e,t,n){n.r(t),n.d(t,{IMobileBlockBottomBarFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(54541),a=n(22595),s=(n(30479),Symbol.for("feature:".concat(a.C.MobileBlockBottomBar)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(1144).then(n.bind(n,71144))];case 1:return[2,e.sent().MobileBlockBottomBarHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level2],key:s,platforms:[i.Ev.Mobile,i.Ev.Pad],load:!0})})},4814:function(e,t,n){n.r(t),n.d(t,{IMobileGestureFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.MobileGesture)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(8761).then(n.bind(n,48761))];case 1:return[2,e.sent().MobileBlockGestureHandler]}}))}))},on:a.iz.On({key:s,stages:[a.YV.Level2,a.YV.Publish],platforms:[a.Ev.Mobile,a.Ev.Pad],load:!0})})},71018:function(e,t,n){n.r(t),n.d(t,{IMobileHeaderFeature:function(){return c}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=n(30479),c=Symbol.for("feature:".concat(i.C.MobileHeader));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(1198).then(n.bind(n,54278))];case 1:return[2,e.sent().MobileHeaderHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level1,a.YV.Publish],key:c,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!(0,s.supportNativeTitleBar)("doc")})})},91:function(e,t,n){n.r(t),n.d(t,{IMobileMoreMenuFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.MobileMoreMenu));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(1168),n.e(3392)]).then(n.bind(n,34378))];case 1:return[2,e.sent().MobileMoreMenuHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2,a.YV.Publish],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},43087:function(e,t,n){n.r(t),n.d(t,{IMobilePagedViewFeature:function(){return a}});var r=n(85556),o=n(3139),i=n(22595),a=Symbol.for("feature:".concat(i.C.MobilePagedView));o.Ln.merge(a,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(3945).then(n.bind(n,3945))];case 1:return[2,e.sent().MobilePagedViewHandler]}}))}))}})},96713:function(e,t,n){n.r(t),n.d(t,{IMobileViewFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.MobileView));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(7060).then(n.bind(n,45368))];case 1:return[2,e.sent().MobileViewHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},14330:function(e,t,n){n.r(t),n.d(t,{IMoveToMobileFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.MoveToMobile)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(1e3).then(n.bind(n,83847))];case 1:return[2,e.sent().MoveToMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!0})})},38577:function(e,t,n){n.r(t),n.d(t,{INativeMobileHeaderFeature:function(){return l}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=n(30479),c=n(38429),l=Symbol.for("feature:".concat(i.C.MobileNativeHeader));o.Ln.merge(l,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(1168),n.e(5038)]).then(n.bind(n,73359))];case 1:return[2,e.sent().NativeHeaderHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level1,a.YV.Publish],key:l,platforms:[a.Ev.Mobile,a.Ev.Pad],load:(0,s.supportNativeTitleBar)("doc")&&!c.cm})})},60362:function(e,t,n){n.r(t),n.d(t,{IOcrFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.Ocr));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8487),n.e(8937),n.e(1863)]).then(n.bind(n,44937))];case 1:return[2,e.sent().OcrHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},34205:function(e,t,n){n.r(t),n.d(t,{IOcrPreviewFeature:function(){return c}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=n(30479),c=Symbol.for("feature:".concat(i.C.OcrPreview));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(900)]).then(n.bind(n,85142))];case 1:return[2,e.sent().OcrPreviewHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:c,load:!!(0,s.getUrlParameter)("inToastPreview")||!!(0,s.getUrlParameter)("ocr")})})},29969:function(e,t,n){n.r(t),n.d(t,{IOfflineStatusFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.OfflineStatus));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(4354).then(n.bind(n,55049))];case 1:return[2,e.sent().OfflineStatusHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},15170:function(e,t,n){n.r(t),n.d(t,{IOpenAPIFeature:function(){return c}});var r=n(85556),o=n(30479),i=n(3139),a=n(54541),s=n(22595),c=Symbol.for("feature:".concat(s.C.OpenAPI));i.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(3052).then(n.bind(n,83900))];case 1:return[2,e.sent().OpenAPIHandler]}}))}))},on:a.iz.On({key:c,stages:[a.YV.Level2],load:"drive"===(0,o.getUrlParameter)("from")})})},78658:function(e,t,n){n.r(t),n.d(t,{IOutlineMobileFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.OutlineMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(1728).then(n.bind(n,49699))];case 1:return[2,e.sent().OutlineMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2,a.YV.Publish],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},80312:function(e,t,n){n.r(t),n.d(t,{IPageWebFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.PageWeb)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9635).then(n.bind(n,92645))];case 1:return[2,e.sent().PageWebHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Pc],load:!1})})},35562:function(e,t,n){n.r(t),n.d(t,{IParagraphFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.Paragraph));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(9714),n.e(7411),n.e(5218),n.e(6952),n.e(7131)]).then(n.bind(n,25057))];case 1:return[2,e.sent().ParagraphHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s})})},35333:function(e,t,n){n.r(t),n.d(t,{IParagraphDragMobileFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(54541),a=n(22595),s=Symbol.for("feature:".concat(a.C.ParagraphDragMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9591).then(n.bind(n,19591))];case 1:return[2,e.sent().ParagraphDragMobileHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level2],key:s,platforms:[i.Ev.Mobile,i.Ev.Pad]})})},66689:function(e,t,n){n.r(t),n.d(t,{IPdfTransformFeature:function(){return a}});var r=n(85556),o=n(3139),i=n(22595),a=Symbol.for("feature:".concat(i.C.PdfTransform));o.Ln.merge(a,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(2019).then(n.bind(n,58884))];case 1:return[2,e.sent().PdfTransformHandler]}}))}))}})},14364:function(e,t,n){var r;n.d(t,{$G:function(){return m},$i:function(){return R},At:function(){return b},CE:function(){return I},Cx:function(){return g},DN:function(){return y},E0:function(){return E},E6:function(){return P},EE:function(){return L},Gf:function(){return M},JX:function(){return F},Jy:function(){return a},Mc:function(){return B},Mi:function(){return u},WN:function(){return W},Xr:function(){return H},Zp:function(){return A},_x:function(){return c},aI:function(){return T},aT:function(){return f},an:function(){return _},bB:function(){return O},bd:function(){return h},bv:function(){return p},fK:function(){return d},fb:function(){return l},gA:function(){return x},gK:function(){return i},gv:function(){return w},iB:function(){return s},kk:function(){return v},oj:function(){return D},vB:function(){return S},xS:function(){return C},xg:function(){return k},z9:function(){return N}});var o,i="TimeToFirstByte",a="TimeToLasterByte",s="FirstPaint",c="FirstContentPaint",l="workbenchInitBegin",u="workbenchInitEnd",d="workbenchInit",p="padEditorInitBegin",f="padEditorInitEnd",_="padEditorInit",h="featuresInitEnd",m="featuresRenderInitEnd",g="featuresPublishInitEnd",v="featuresReadonlyInitEnd",b="featuresEditInitEnd",y="featuresInitBegin",w="featuresInit",E="loadComplete",C="scriptLoading",T="scriptEntries",x="firstLayoutStart",S="firstLayoutCost",I="FIRST_RENDER",k="FIRST_EDIT",R="FIRST_INTERACTION",A="USERAGENT",O="totalRender",L="visibility",M="version",N="layoutCost",D="hiddenInputInited",P="lastLayoutFinish",F="totalLayoutCost",B="hideFirstScreen";!function(e){e.MK_HTML_START="MK_HTML_START",e.MK_QUICKLOOK="MK_QUICKLOOK",e.MK_IMMEJS_START="MK_IMMEJS_START",e.MK_PRELOAD="MK_PRELOAD",e.MK_WBINIT="MK_WBINIT",e.MK_DATAINIT_START="MK_DATAINIT_START",e.MK_DATAINIT_RESOLVE="MK_DATAINIT_RESOLVE",e.MK_DATAENGINE_START="MK_DATAENGINE_START",e.MK_DATAENGINE_END="MK_DATAENGINE_END",e.MK_LAYOUT_START="MK_LAYOUT_START",e.MK_LAYOUT_RENDER="MK_LAYOUT_RENDER",e.MK_LAYOUT_END="MK_LAYOUT_END",e.MK_DATAINIT_END="MK_DATAINIT_END"}(o||(o={}));var U,H,j=((r={FirstPaint:"首次渲染时间",FirstContentPaint:"首次内容渲染时间",TimeToFirstByte:"TTFB",TimeToLasterByte:"TTLB",WorkbenchInit:"初始化workbench的耗时",PadEditorInit:"初始化padEditor耗时",FeaturesInitEnd:"所有feature加载完结束时间",FeaturesRenderInitEnd:"渲染feature加载完结束时间",FeaturesPublishInitEnd:"发布态feature加载完结束时间",FeaturesReadonlyInitEnd:"只读feature加载完结束时间",FeaturesEditInitEnd:"可编辑feature加载完结束时间",FirstLayoutStart:"首页排版&渲染开始",FirstLayoutCost:"首页排版&渲染耗时",FirstRender:"首屏渲染可见时间",FirstEdit:"首屏可编辑时间",FirstInteraction:"首次可交互时间",TotalRender:"所有内容渲染完成",TotalLayoutCost:"第一次排版开始到最后一次排版结束的耗时",LoadComplete:"所有内容加载完成",Visibility:"是否处于可见状态",UserAgent:"浏览器UA",Version:"RAVEN版本",ScriptLoading:"script下载总时长",ScriptEntries:"script下载项",LayoutCost:"排版整体耗时",HiddenInputInited:"隐藏输入区初始化"}).watermarkRender="水印渲染时间",r.keyPath_clickToResponse="客户端点击到文档响应时间",r.keyPath_HTMLFetchCost="HTML请求耗时",r.keyPath_jsReady="JS准备时间",r.keyPath_waitForClientVars="等待clientVars的耗时",r.keyPath_IfWaitClientVars="是否等待clientVars",r.keyPath_editableCost="从客户端点击到可编辑的耗时",r.webviewOpenMode="Webview启动模式",r);function W(e){return j[e]}!function(e){e.PERFORMANCE_KEY_FROM_OFFLINE="PERFORMANCE_KEY_FROM_OFFLINE"}(U||(U={})),function(e){e.AllPerformanceDataReady="all_performance_data_ready"}(H||(H={}))},99542:function(e,t,n){n.r(t),n.d(t,{IPresentationPlayerFeature:function(){return c}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=n(30479),c=Symbol.for("feature:".concat(i.C.PresentationPlayer));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5218),n.e(9702),n.e(902)]).then(n.bind(n,68591))];case 1:return[2,e.sent().PresentationPlayerHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:c,load:"player"===(0,s.getUrlParameter)("show")})})},78039:function(e,t,n){n.r(t),n.d(t,{IPrintFeature:function(){return c},TriggerType:function(){return r}});var r,o=n(85556),i=n(3139),a=n(22595),s=n(54541),c=Symbol.for("feature:".concat(a.C.Print));!function(e){e[e.SHCORTCUT_TRIGGER=1]="SHCORTCUT_TRIGGER",e[e.BUTTON_TRIGGER=2]="BUTTON_TRIGGER"}(r||(r={})),i.Ln.merge(c,{useFactory:function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8487),n.e(8937),n.e(866),n.e(2644),n.e(5218),n.e(3152),n.e(9445)]).then(n.bind(n,60305))];case 1:return[2,e.sent().PrintHandler]}}))}))},on:s.iz.On({stages:[s.YV.Level4],key:c,platforms:[s.Ev.Pc]})})},60728:function(e,t,n){n.r(t),n.d(t,{IQuicklyVisitMobileFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.QuicklyVisitMobile)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(6101).then(n.bind(n,11232))];case 1:return[2,e.sent().QuicklyVisitMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!1})})},79560:function(e,t,n){n.r(t),n.d(t,{IReadonlyTipsFeature:function(){return c}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),n(50263)),c=Symbol.for("feature:".concat(i.C.ReadonlyTips));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9553).then(n.bind(n,26795))];case 1:return[2,e.sent().ReadonlyTipsHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:c,platforms:[a.Ev.Pc],load:!s.A.isTencentMeetingInWework()})})},905:function(e,t,n){n.r(t),n.d(t,{IRepeatLastFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.RepeatLast));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(9714),n.e(7411),n.e(5218),n.e(6952),n.e(7131)]).then(n.bind(n,39986))];case 1:return[2,e.sent().RepeatLastHandler]}}))}))},on:a.iz.On({key:s,platforms:[a.Ev.Pc],stages:[a.YV.Level3]})})},89565:function(e,t,n){n.r(t),n.d(t,{IResumeGuideFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.ResumeGuide));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8487),n.e(8937),n.e(866),n.e(2644),n.e(5218),n.e(3152),n.e(9445)]).then(n.bind(n,6329))];case 1:return[2,e.sent().ResumeGuideHandler]}}))}))},on:a.iz.On({key:s,stages:[a.YV.Level4],platforms:[a.Ev.Pc]})})},9710:function(e,t,n){n.r(t),n.d(t,{IResumeGuideMobileFeature:function(){return u},ImportScene:function(){return o},ImportType:function(){return r}});var r,o,i=n(85556),a=n(3139),s=n(22595),c=n(54541),l=n(38429);!function(e){e.LOCAL="local",e.ONLINE="online"}(r||(r={})),function(e){e.CREATE="create",e.REPLACE="replace"}(o||(o={}));var u=Symbol.for("feature:".concat(s.C.ResumeGuideMobile));a.Ln.merge(u,{useFactory:function(){return(0,i.__awaiter)(void 0,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(7588).then(n.bind(n,67112))];case 1:return[2,e.sent().ResumeGuideMobileHandler]}}))}))},on:c.iz.On({key:u,stages:[c.YV.Level4],platforms:[c.Ev.Mobile,c.Ev.Pad],load:!l.kE})})},18415:function(e,t,n){n.r(t),n.d(t,{IScrollbarHiddenMobileFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.ScrollbarHiddenMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9186).then(n.bind(n,40323))];case 1:return[2,e.sent().ScrollbarHiddenMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile]})})},41105:function(e,t,n){n.r(t),n.d(t,{BTN_HEIGHT:function(){return c},BTN_PANEL_DISTANCE:function(){return d},ISelectivePasteHandler:function(){return p},PANEL_HEIGHT_2_ITEM:function(){return u},PANEL_HEIGHT_3_ITEM:function(){return l},PasteBtnType:function(){return r}});var r,o=n(85556),i=n(3139),a=n(22595),s=n(54541),c=32,l=114,u=82,d=4;!function(e){e[e.NORMAL=0]="NORMAL",e[e.LINK=1]="LINK"}(r||(r={}));var p=Symbol.for("feature:".concat(a.C.SelectivePaste));i.Ln.merge(p,{useFactory:function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(9714),n.e(7411),n.e(5218),n.e(6952),n.e(7131)]).then(n.bind(n,38020))];case 1:return[2,e.sent().SelectivePasteHandler]}}))}))},on:s.iz.On({stages:[s.YV.Level3],key:p,platforms:[s.Ev.Pc]})})},6e3:function(e,t,n){n.r(t),n.d(t,{IShareMobileFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.ShareMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(4565).then(n.bind(n,30610))];case 1:return[2,e.sent().ShareMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},1694:function(e,t,n){n.r(t),n.d(t,{IShareMobileWebFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.ShareMobileWeb)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(4686).then(n.bind(n,53293))];case 1:return[2,e.sent().ShareMobileWebHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile],load:!1})})},81910:function(e,t,n){n.r(t),n.d(t,{IShowMoreFeature:function(){return i}});var r=n(85556),o=n(3139),i=Symbol.for("feature:show-more");o.Ln.merge(i,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(3314).then(n.bind(n,49434))];case 1:return[2,e.sent().ShowMoreFeature]}}))}))}})},44395:function(e,t,n){n.r(t),n.d(t,{ISnapScreenMobileFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.SnapScreenMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(866),n.e(2644),n.e(3298),n.e(5218),n.e(3152),n.e(1822)]).then(n.bind(n,76278))];case 1:return[2,e.sent().SnapScreenMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},14508:function(e,t,n){n.r(t),n.d(t,{ISnippetFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.Snippet));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.resolve().then(n.bind(n,42656))];case 1:return[2,e.sent().SnippetHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},42656:function(e,t,n){n.r(t),n.d(t,{SnippetHandler:function(){return y}});var r=n(85556),o=n(67480),i=n(3139),a=n(68656),s=n(27613),c=n(2613),l=n(22595),u=n(30479),d=n(97429),p=n(96729),f=n(14508),_=n(14740),h=JSON.parse('[{"ty":"is","bi":0,"s":"\\r任务一\\r\\r\\r\\r\\r任务二\\r\\r\\r\\r\\r"},{"ty":"ms","mt":"numbering","pr":{"numbering":{"num":{"tdhnwo":{"numId":"tdhnwo","abstractNumId":{"val":"o3komj"}},"tbzdvb":{"numId":"tbzdvb","abstractNumId":{"val":"q3ivbu"}}},"num_dict_op":{"opType":"Update"},"abstractNum":{"o3komj":{"abstractNumId":"o3komj","lvl":{"0":{"pPr":{"ind":{"left":336,"hanging":336}},"ilvl":0,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%1."}},"1":{"ilvl":1,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%2."},"pPr":{"ind":{"left":776,"hanging":336}}},"2":{"ilvl":2,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerRoman"},"lvlText":{"val":"%3."},"pPr":{"ind":{"left":1216,"hanging":336}}},"3":{"ilvl":3,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%4."},"pPr":{"ind":{"left":1656,"hanging":336}}},"4":{"ilvl":4,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%5."},"pPr":{"ind":{"left":2096,"hanging":336}}},"5":{"ilvl":5,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerRoman"},"lvlText":{"val":"%6."},"pPr":{"ind":{"left":2536,"hanging":336}}},"6":{"ilvl":6,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%7."},"pPr":{"ind":{"left":2976,"hanging":336}}},"7":{"ilvl":7,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%8."},"pPr":{"ind":{"left":3416,"hanging":336}}}},"lvl_dict_op":{"opType":"Update"}},"q3ivbu":{"abstractNumId":"q3ivbu","lvl":{"0":{"pPr":{"ind":{"left":336,"hanging":336}},"ilvl":0,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_task"}}},"lvl_dict_op":{"opType":"Update"}}},"abstractNum_dict_op":{"opType":"Update"}}}},{"ty":"mp","bi":0,"ei":1,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":1,"ei":4,"mt":"run","pr":{"run":{"author":"","color":{"val":"1E6FFF"}}}},{"ty":"mp","bi":4,"ei":5,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":"","color":{"val":"1E6FFF"}}}},{"ty":"mp","bi":5,"ei":6,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":6,"ei":7,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":7,"ei":8,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":8,"ei":9,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":9,"ei":12,"mt":"run","pr":{"run":{"author":"","color":{"val":"1E6FFF"}}}},{"ty":"mp","bi":12,"ei":13,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":"","color":{"val":"1E6FFF"}}}},{"ty":"mp","bi":13,"ei":14,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":14,"ei":15,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":15,"ei":16,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":16,"ei":17,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":0,"ei":1,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"Normal"}}}},{"ty":"mp","bi":4,"ei":5,"mt":"paragraph","pr":{"paragraph":{"numPr":{"ilvl":{"val":0},"numId":{"val":"tdhnwo"}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"heading 3"}}}},{"ty":"mp","bi":5,"ei":6,"mt":"paragraph","pr":{"paragraph":{"numPr":{"numId":{"val":"tbzdvb"},"ilvl":{"val":0}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"Normal"},"hintType":"输入\\u0013mention\\u0014@\\u0015，邀请相关人员一起完成任务。"}}},{"ty":"mp","bi":6,"ei":7,"mt":"paragraph","pr":{"paragraph":{"numPr":{"numId":{"val":"tbzdvb"},"ilvl":{"val":0}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"Normal"},"hintType":"插入\\u0013doc\\u0014腾讯文档\\u0015，快速插入相关文档。"}}},{"ty":"mp","bi":7,"ei":8,"mt":"paragraph","pr":{"paragraph":{"numPr":{"numId":{"val":"tbzdvb"},"ilvl":{"val":0}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"Normal"},"hintType":"..."}}},{"ty":"mp","bi":8,"ei":9,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"Normal"}}}},{"ty":"mp","bi":12,"ei":13,"mt":"paragraph","pr":{"paragraph":{"numPr":{"ilvl":{"val":0},"numId":{"val":"tdhnwo"}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"heading 3"}}}},{"ty":"mp","bi":13,"ei":14,"mt":"paragraph","pr":{"paragraph":{"numPr":{"numId":{"val":"tbzdvb"},"ilvl":{"val":0}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"Normal"},"hintType":"输入\\u0013mention\\u0014@\\u0015，邀请相关人员一起完成任务。"}}},{"ty":"mp","bi":14,"ei":15,"mt":"paragraph","pr":{"paragraph":{"numPr":{"numId":{"val":"tbzdvb"},"ilvl":{"val":0}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"Normal"},"hintType":"插入\\u0013doc\\u0014腾讯文档\\u0015，快速插入相关文档。"}}},{"ty":"mp","bi":15,"ei":16,"mt":"paragraph","pr":{"paragraph":{"numPr":{"numId":{"val":"tbzdvb"},"ilvl":{"val":0}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"Normal"},"hintType":"..."}}},{"ty":"mp","bi":16,"ei":17,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"Normal"},"ind":{"left":0}}}}]'),m=JSON.parse('[{"ty":"is","bi":0,"s":"\\r\\u001a今日工作\\r\\u0007明日计划\\r\\u0007\\u0006\\r\\r\\u0007\\r\\r\\u0007\\u0006工作小结\\r\\u0007\\u0006\\r\\u0007\\u0006\\u001b\\r"},{"ty":"ms","mt":"numbering","pr":{"numbering":{"num":{"hwawmf":{"numId":"hwawmf","abstractNumId":{"val":"gsduof"}},"exb73x":{"numId":"exb73x","abstractNumId":{"val":"60it8z"}}},"num_dict_op":{"opType":"Update"},"abstractNum":{"gsduof":{"abstractNumId":"gsduof","lvl":{"0":{"pPr":{"ind":{"left":336,"hanging":336}},"ilvl":0,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%1."}},"1":{"ilvl":1,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%2."},"pPr":{"ind":{"left":776,"hanging":336}}},"2":{"ilvl":2,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerRoman"},"lvlText":{"val":"%3."},"pPr":{"ind":{"left":1216,"hanging":336}}},"3":{"ilvl":3,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%4."},"pPr":{"ind":{"left":1656,"hanging":336}}},"4":{"ilvl":4,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%5."},"pPr":{"ind":{"left":2096,"hanging":336}}},"5":{"ilvl":5,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerRoman"},"lvlText":{"val":"%6."},"pPr":{"ind":{"left":2536,"hanging":336}}},"6":{"ilvl":6,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%7."},"pPr":{"ind":{"left":2976,"hanging":336}}},"7":{"ilvl":7,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%8."},"pPr":{"ind":{"left":3416,"hanging":336}}}},"lvl_dict_op":{"opType":"Update"}},"60it8z":{"abstractNumId":"60it8z","lvl":{"0":{"pPr":{"ind":{"left":336,"hanging":336}},"ilvl":0,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%1."}},"1":{"ilvl":1,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%2."},"pPr":{"ind":{"left":776,"hanging":336}}},"2":{"ilvl":2,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerRoman"},"lvlText":{"val":"%3."},"pPr":{"ind":{"left":1216,"hanging":336}}},"3":{"ilvl":3,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%4."},"pPr":{"ind":{"left":1656,"hanging":336}}},"4":{"ilvl":4,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%5."},"pPr":{"ind":{"left":2096,"hanging":336}}},"5":{"ilvl":5,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerRoman"},"lvlText":{"val":"%6."},"pPr":{"ind":{"left":2536,"hanging":336}}},"6":{"ilvl":6,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%7."},"pPr":{"ind":{"left":2976,"hanging":336}}},"7":{"ilvl":7,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%8."},"pPr":{"ind":{"left":3416,"hanging":336}}}},"lvl_dict_op":{"opType":"Update"}}},"abstractNum_dict_op":{"opType":"Update"}}}},{"ty":"mp","bi":0,"ei":1,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":1,"ei":2,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":2,"ei":6,"mt":"run","pr":{"run":{"b":{"val":true},"color":{"val":"1E6FFF"},"author":""}}},{"ty":"mp","bi":6,"ei":7,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":7,"ei":8,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":8,"ei":12,"mt":"run","pr":{"run":{"color":{"val":"1E6FFF"},"b":{"val":true},"author":""}}},{"ty":"mp","bi":12,"ei":13,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":"","b":{"val":true}}}},{"ty":"mp","bi":13,"ei":14,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":14,"ei":15,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":15,"ei":16,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":16,"ei":17,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":17,"ei":18,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":18,"ei":19,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":19,"ei":20,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":20,"ei":21,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":21,"ei":22,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":22,"ei":26,"mt":"run","pr":{"run":{"author":"","b":{"val":true},"color":{"val":"005A5B"}}}},{"ty":"mp","bi":26,"ei":27,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":"","color":{"val":"005A5B"}}}},{"ty":"mp","bi":27,"ei":28,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":28,"ei":29,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":29,"ei":30,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":30,"ei":31,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":31,"ei":32,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":32,"ei":33,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":33,"ei":34,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":0,"ei":1,"mt":"paragraph","pr":{"paragraph":{"pBdr_i":true}}},{"ty":"mp","bi":1,"ei":2,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":6,"ei":7,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"pBdr_i":true,"ind_i":true,"jc":{"val":"STJcWml_center"},"outlineLvl_i":true}}},{"ty":"mp","bi":7,"ei":8,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":12,"ei":13,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"pBdr_i":true,"ind_i":true,"jc":{"val":"STJcWml_center"},"outlineLvl_i":true}}},{"ty":"mp","bi":13,"ei":14,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":14,"ei":15,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":15,"ei":16,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"numPr":{"numId":{"val":"hwawmf"},"ilvl":{"val":0}},"pBdr_i":true,"outlineLvl_i":true,"taskPr":{"taskState":"STTaskState_todo"},"hintType":"输入今日工作，并\\u0013mention\\u0014@相关人员\\u0015"}}},{"ty":"mp","bi":16,"ei":17,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"numPr":{"numId":{"val":"hwawmf"},"ilvl":{"val":0}},"pBdr_i":true,"outlineLvl_i":true,"taskPr":{"taskState":"STTaskState_todo"},"hintType":"也可以插入\\u0013doc\\u0014腾讯文档\\u0015"}}},{"ty":"mp","bi":17,"ei":18,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":18,"ei":19,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"numPr":{"numId":{"val":"exb73x"},"ilvl":{"val":0}},"pBdr_i":true,"outlineLvl_i":true,"taskPr":{"taskState":"STTaskState_todo"},"hintType":"输入今日工作，并\\u0013mention\\u0014@相关人员\\u0015"}}},{"ty":"mp","bi":19,"ei":20,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"numPr":{"numId":{"val":"exb73x"},"ilvl":{"val":0}},"pBdr_i":true,"outlineLvl_i":true,"taskPr":{"taskState":"STTaskState_todo"},"hintType":"也可以插入\\u0013doc\\u0014腾讯文档\\u0015"}}},{"ty":"mp","bi":20,"ei":21,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":21,"ei":22,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":26,"ei":27,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"pBdr_i":true,"ind_i":true,"outlineLvl_i":true,"jc":{"val":"STJcWml_center"}}}},{"ty":"mp","bi":27,"ei":28,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":28,"ei":29,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":29,"ei":30,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"pBdr_i":true,"ind_i":true,"outlineLvl_i":true,"spacing":{"line":240,"lineRule":"STLineSpacingRule_auto"},"hintType":"今日完成了..."}}},{"ty":"mp","bi":30,"ei":31,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":31,"ei":32,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":32,"ei":33,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":33,"ei":34,"mt":"paragraph","pr":{"paragraph":{}}},{"ty":"mp","bi":1,"ei":2,"mt":"table","pr":{"table":{"tblPr":{"isBegin":true}}}},{"ty":"mp","bi":32,"ei":33,"mt":"table","pr":{"table":{"tblPr":{"tblStyle":{"val":"Table Grid"},"nestingLevel":1}}}},{"ty":"mp","bi":32,"ei":33,"mt":"tableRow","pr":{"tableRow":{"isPlaceholder":true}},"mm":"merge"},{"ty":"mp","bi":32,"ei":33,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true}},"mm":"merge"},{"ty":"mp","bi":14,"ei":15,"mt":"tableRow","pr":{"tableRow":{"trHeight":{"val":661},"nestingLevel":1}}},{"ty":"mp","bi":21,"ei":22,"mt":"tableRow","pr":{"tableRow":{"trHeight":{"val":1696},"nestingLevel":1}}},{"ty":"mp","bi":28,"ei":29,"mt":"tableRow","pr":{"tableRow":{"trHeight":{"val":301},"nestingLevel":1}}},{"ty":"mp","bi":31,"ei":32,"mt":"tableRow","pr":{"tableRow":{"trHeight":{"val":2011},"nestingLevel":1}}},{"ty":"mp","bi":14,"ei":15,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true}},"mm":"merge"},{"ty":"mp","bi":21,"ei":22,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true}},"mm":"merge"},{"ty":"mp","bi":28,"ei":29,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true}},"mm":"merge"},{"ty":"mp","bi":31,"ei":32,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true}},"mm":"merge"},{"ty":"mp","bi":7,"ei":8,"mt":"tableCell","pr":{"tableCell":{"tcW":{"w":4140,"type":"STTblWidth_dxa"},"shd":{"fill":"E6F5FF"},"nestingLevel":1,"tcBorders":{"top":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"left":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"right":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"bottom":{"val":"STBorder_single","color":"999999","sz":4,"space":0}}}}},{"ty":"mp","bi":13,"ei":14,"mt":"tableCell","pr":{"tableCell":{"tcW":{"w":4140,"type":"STTblWidth_dxa"},"shd":{"fill":"E6F5FF"},"nestingLevel":1,"tcBorders":{"top":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"left":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"right":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"bottom":{"val":"STBorder_single","color":"999999","sz":4,"space":0}}}}},{"ty":"mp","bi":17,"ei":18,"mt":"tableCell","pr":{"tableCell":{"tcW":{"w":4140,"type":"STTblWidth_dxa"},"nestingLevel":1,"tcBorders":{"top":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"left":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"right":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"bottom":{"val":"STBorder_single","color":"999999","sz":4,"space":0}}}}},{"ty":"mp","bi":20,"ei":21,"mt":"tableCell","pr":{"tableCell":{"tcW":{"w":4140,"type":"STTblWidth_dxa"},"nestingLevel":1,"tcBorders":{"top":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"left":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"right":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"bottom":{"val":"STBorder_single","color":"999999","sz":4,"space":0}}}}},{"ty":"mp","bi":27,"ei":28,"mt":"tableCell","pr":{"tableCell":{"tcW":{"w":8280,"type":"STTblWidth_dxa"},"tcBorders":{"top":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"left":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"bottom":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"right":{"val":"STBorder_single","color":"999999","sz":4,"space":0}},"shd":{"fill":"E0FBFA"},"nestingLevel":1}}},{"ty":"mp","bi":30,"ei":31,"mt":"tableCell","pr":{"tableCell":{"tcW":{"w":8280,"type":"STTblWidth_dxa"},"tcBorders":{"top":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"left":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"bottom":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"right":{"val":"STBorder_single","color":"999999","sz":4,"space":0}},"nestingLevel":1,"vAlign":{"val":"STVerticalJc_top"}}}},{"ty":"mp","bi":1,"ei":2,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":1,"ei":2,"mt":"tableRow","pr":{"tableRow":{"isPlaceholder":true,"nestingLevel":1}}}]'),g=JSON.parse('[{"ty":"is","bi":0,"s":"\\r本周工作内容\\r\\r\\r核心项目一\\r\\r\\r\\r\\r核心项目二\\r\\r\\r\\r\\r\\r\\r\\r下周工作计划\\r\\r\\r"},{"ty":"ms","mt":"numbering","pr":{"numbering":{"num":{"hozqep":{"numId":"hozqep","abstractNumId":{"val":"wrej51"}},"4unfpg":{"numId":"4unfpg","abstractNumId":{"val":"5hywrf"}},"3vcifm":{"numId":"3vcifm","abstractNumId":{"val":"3lc2wl"}}},"num_dict_op":{"opType":"Update"},"abstractNum":{"wrej51":{"abstractNumId":"wrej51","lvl":{"0":{"pPr":{"ind":{"left":336,"hanging":336}},"ilvl":0,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_bullet"},"rPr":{"rFonts":{"ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"},"color":{"val":"1E6FFF"},"kern":{"val":20},"sz":{"val":280},"szCs":{"val":280},"b":{"val":false},"bCs":{"val":true},"isPlaceholder":true,"author":"","i":{"val":false}},"lvlText":{"val":""}},"1":{"ilvl":1,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":"¡"},"pPr":{"ind":{"left":776,"hanging":336}},"rPr":{"rFonts":{"ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}}},"2":{"ilvl":2,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"pPr":{"ind":{"left":1216,"hanging":336}},"rPr":{"rFonts":{"ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}}},"3":{"ilvl":3,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"lvlText":{"val":""},"numFmt":{"val":"STNumberFormat_bullet"},"pPr":{"ind":{"left":1656,"hanging":336}},"rPr":{"rFonts":{"ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}}},"4":{"ilvl":4,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"lvlText":{"val":"¡"},"numFmt":{"val":"STNumberFormat_bullet"},"pPr":{"ind":{"left":2096,"hanging":336}},"rPr":{"rFonts":{"ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}}},"5":{"ilvl":5,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"lvlText":{"val":""},"numFmt":{"val":"STNumberFormat_bullet"},"pPr":{"ind":{"left":2536,"hanging":336}},"rPr":{"rFonts":{"ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}}},"6":{"ilvl":6,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"lvlText":{"val":""},"numFmt":{"val":"STNumberFormat_bullet"},"pPr":{"ind":{"left":2976,"hanging":336}},"rPr":{"rFonts":{"ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}}},"7":{"ilvl":7,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"lvlText":{"val":"¡"},"numFmt":{"val":"STNumberFormat_bullet"},"pPr":{"ind":{"left":3416,"hanging":336}},"rPr":{"rFonts":{"ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}}}},"lvl_dict_op":{"opType":"Update"}},"5hywrf":{"abstractNumId":"5hywrf","lvl":{"0":{"pPr":{"ind":{"left":336,"hanging":336}},"ilvl":0,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%1."}},"1":{"ilvl":1,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%2."},"pPr":{"ind":{"left":776,"hanging":336}}},"2":{"ilvl":2,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerRoman"},"lvlText":{"val":"%3."},"pPr":{"ind":{"left":1216,"hanging":336}}},"3":{"ilvl":3,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%4."},"pPr":{"ind":{"left":1656,"hanging":336}}},"4":{"ilvl":4,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%5."},"pPr":{"ind":{"left":2096,"hanging":336}}},"5":{"ilvl":5,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerRoman"},"lvlText":{"val":"%6."},"pPr":{"ind":{"left":2536,"hanging":336}}},"6":{"ilvl":6,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%7."},"pPr":{"ind":{"left":2976,"hanging":336}}},"7":{"ilvl":7,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%8."},"pPr":{"ind":{"left":3416,"hanging":336}}}},"lvl_dict_op":{"opType":"Update"}},"3lc2wl":{"abstractNumId":"3lc2wl","lvl":{"0":{"pPr":{"ind":{"left":336,"hanging":336}},"ilvl":0,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%1."}},"1":{"ilvl":1,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%2."},"pPr":{"ind":{"left":776,"hanging":336}}},"2":{"ilvl":2,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerRoman"},"lvlText":{"val":"%3."},"pPr":{"ind":{"left":1216,"hanging":336}}},"3":{"ilvl":3,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%4."},"pPr":{"ind":{"left":1656,"hanging":336}}},"4":{"ilvl":4,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%5."},"pPr":{"ind":{"left":2096,"hanging":336}}},"5":{"ilvl":5,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerRoman"},"lvlText":{"val":"%6."},"pPr":{"ind":{"left":2536,"hanging":336}}},"6":{"ilvl":6,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%7."},"pPr":{"ind":{"left":2976,"hanging":336}}},"7":{"ilvl":7,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%8."},"pPr":{"ind":{"left":3416,"hanging":336}}}},"lvl_dict_op":{"opType":"Update"}}},"abstractNum_dict_op":{"opType":"Update"}}}},{"ty":"mp","bi":0,"ei":1,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":1,"ei":7,"mt":"run","pr":{"run":{"author":""}}},{"ty":"mp","bi":7,"ei":8,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":8,"ei":9,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":9,"ei":10,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":10,"ei":15,"mt":"run","pr":{"run":{"author":"","color":{"val":"1E6FFF"}}}},{"ty":"mp","bi":15,"ei":16,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":"","color":{"val":"1E6FFF"}}}},{"ty":"mp","bi":16,"ei":17,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":17,"ei":18,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":18,"ei":19,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":19,"ei":20,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":20,"ei":25,"mt":"run","pr":{"run":{"author":"","color":{"val":"1E6FFF"}}}},{"ty":"mp","bi":25,"ei":26,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":"","color":{"val":"1E6FFF"}}}},{"ty":"mp","bi":26,"ei":27,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":27,"ei":28,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":28,"ei":29,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":29,"ei":30,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":30,"ei":31,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":31,"ei":32,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":32,"ei":33,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":33,"ei":39,"mt":"run","pr":{"run":{"author":""}}},{"ty":"mp","bi":39,"ei":40,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":40,"ei":41,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":41,"ei":42,"mt":"run","pr":{"run":{"isPlaceholder":true}}},{"ty":"mp","bi":0,"ei":1,"mt":"paragraph","pr":{"paragraph":{}}},{"ty":"mp","bi":7,"ei":8,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"heading 1"}}}},{"ty":"mp","bi":8,"ei":9,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"Normal"},"hintType":"添加工作总结描述"}}},{"ty":"mp","bi":9,"ei":10,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"Normal"}}}},{"ty":"mp","bi":15,"ei":16,"mt":"paragraph","pr":{"paragraph":{"numPr":{"ilvl":{"val":0},"numId":{"val":"hozqep"}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"heading 3"}}}},{"ty":"mp","bi":16,"ei":17,"mt":"paragraph","pr":{"paragraph":{"numPr":{"numId":{"val":"4unfpg"},"ilvl":{"val":0}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"Normal"},"hintType":"某某人：完成了XX工作，进度XX。输入\\u0013mention\\u0014@\\u0015，邀请他一起确认。"}}},{"ty":"mp","bi":17,"ei":18,"mt":"paragraph","pr":{"paragraph":{"numPr":{"numId":{"val":"4unfpg"},"ilvl":{"val":0}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"Normal"},"hintType":"插入\\u0013doc\\u0014腾讯文档\\u0015，快速插入相关文档。"}}},{"ty":"mp","bi":18,"ei":19,"mt":"paragraph","pr":{"paragraph":{"numPr":{"numId":{"val":"4unfpg"},"ilvl":{"val":0}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"Normal"},"hintType":"..."}}},{"ty":"mp","bi":19,"ei":20,"mt":"paragraph","pr":{"paragraph":{"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"Normal"},"ind":{"leftChars":0,"left":0}}}},{"ty":"mp","bi":25,"ei":26,"mt":"paragraph","pr":{"paragraph":{"numPr":{"ilvl":{"val":0},"numId":{"val":"hozqep"}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"heading 3"}}}},{"ty":"mp","bi":26,"ei":27,"mt":"paragraph","pr":{"paragraph":{"numPr":{"numId":{"val":"3vcifm"},"ilvl":{"val":0}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"Normal"},"hintType":"某某人：完成了XX工作，进度XX。"}}},{"ty":"mp","bi":27,"ei":28,"mt":"paragraph","pr":{"paragraph":{"numPr":{"numId":{"val":"3vcifm"},"ilvl":{"val":0}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"Normal"},"hintType":"某某人：完成了XX工作，进度XX。"}}},{"ty":"mp","bi":28,"ei":29,"mt":"paragraph","pr":{"paragraph":{"numPr":{"numId":{"val":"3vcifm"},"ilvl":{"val":0}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"Normal"},"hintType":"..."}}},{"ty":"mp","bi":29,"ei":30,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"Normal"}}}},{"ty":"mp","bi":30,"ei":31,"mt":"paragraph","pr":{"paragraph":{"numPr":{"ilvl":{"val":0},"numId":{"val":"hozqep"}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"heading 3"},"hintType":"..."}}},{"ty":"mp","bi":31,"ei":32,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"Normal"}}}},{"ty":"mp","bi":32,"ei":33,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"Normal"}}}},{"ty":"mp","bi":39,"ei":40,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"heading 1"}}}},{"ty":"mp","bi":40,"ei":41,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"Normal"},"hintType":"描述下周工作内容或者项目"}}},{"ty":"mp","bi":41,"ei":42,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"Normal"}}}}]'),v=JSON.parse('[{"ty":"is","bi":0,"s":"\\r参会人员：张三 ｜ 李四 ｜ 王五\\r会议时间：XXXX年XX月XX日\\r\\r会议讨论\\r\\u001a会议讨论主题一\\r\\u0007\\u0006\\r\\u0007\\u0006\\r\\u0007\\u0006\\r\\u0007\\u0006会议讨论主题二\\r\\u0007\\u0006\\r\\u0007\\u0006\\r\\u0007\\u0006\\r\\u0007\\u0006\\u001b\\r会议结论\\r\\u001a\\r\\u0007\\u0006\\r\\u0007\\u0006\\r\\u0007\\u0006\\u001b\\r"},{"ty":"mp","bi":0,"ei":1,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":1,"ei":18,"mt":"run","pr":{"run":{"author":""}}},{"ty":"mp","bi":18,"ei":19,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":19,"ei":35,"mt":"run","pr":{"run":{"author":""}}},{"ty":"mp","bi":35,"ei":36,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":36,"ei":37,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":37,"ei":41,"mt":"run","pr":{"run":{"author":"","sz":{"val":360}}}},{"ty":"mp","bi":41,"ei":42,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":"","sz":{"val":360}}}},{"ty":"mp","bi":42,"ei":43,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":43,"ei":50,"mt":"run","pr":{"run":{"author":"","color":{"val":"1E6FFF"},"sz":{"val":240},"b":{"val":true}}}},{"ty":"mp","bi":50,"ei":51,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":"","color":{"val":"1E6FFF"},"sz":{"val":240},"b":{"val":true}}}},{"ty":"mp","bi":51,"ei":52,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":52,"ei":53,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":53,"ei":54,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":54,"ei":55,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":55,"ei":56,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":56,"ei":57,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":57,"ei":58,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":58,"ei":59,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":59,"ei":60,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":60,"ei":61,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":61,"ei":62,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":62,"ei":69,"mt":"run","pr":{"run":{"author":"","b":{"val":true},"color":{"val":"1E6FFF"},"sz":{"val":240}}}},{"ty":"mp","bi":69,"ei":70,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":"","b":{"val":true},"color":{"val":"1E6FFF"},"sz":{"val":240}}}},{"ty":"mp","bi":70,"ei":71,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":71,"ei":72,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":72,"ei":73,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":73,"ei":74,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":74,"ei":75,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":75,"ei":76,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":76,"ei":77,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":77,"ei":78,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":78,"ei":79,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":79,"ei":80,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":80,"ei":81,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":81,"ei":82,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":82,"ei":83,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":83,"ei":87,"mt":"run","pr":{"run":{"author":"","sz":{"val":360},"b":{"val":true}}}},{"ty":"mp","bi":87,"ei":88,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":"","sz":{"val":360},"b":{"val":true}}}},{"ty":"mp","bi":88,"ei":89,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":89,"ei":90,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":"","sz":{"val":220},"b":{"val":false}}}},{"ty":"mp","bi":90,"ei":91,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":91,"ei":92,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":92,"ei":93,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":"","sz":{"val":220},"b":{"val":false}}}},{"ty":"mp","bi":93,"ei":94,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":94,"ei":95,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":95,"ei":96,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":"","sz":{"val":220},"b":{"val":false}}}},{"ty":"mp","bi":96,"ei":97,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":97,"ei":98,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":98,"ei":99,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":99,"ei":100,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":0,"ei":1,"mt":"paragraph","pr":{"paragraph":{}}},{"ty":"mp","bi":18,"ei":19,"mt":"paragraph","pr":{"paragraph":{}}},{"ty":"mp","bi":35,"ei":36,"mt":"paragraph","pr":{"paragraph":{}}},{"ty":"mp","bi":36,"ei":37,"mt":"paragraph","pr":{"paragraph":{}}},{"ty":"mp","bi":41,"ei":42,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"heading 1"}}}},{"ty":"mp","bi":42,"ei":43,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":50,"ei":51,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"outlineLvl_i":true,"ind_i":true,"pBdr_i":true}}},{"ty":"mp","bi":51,"ei":52,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":52,"ei":53,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":53,"ei":54,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"outlineLvl_i":true,"ind_i":true,"pBdr_i":true,"hintType":"\\u0013mention\\u0014@相关人员：\\u0015描述讨论观点和关键内容"}}},{"ty":"mp","bi":54,"ei":55,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":55,"ei":56,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":56,"ei":57,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"outlineLvl_i":true,"ind_i":true,"pBdr_i":true,"hintType":"\\u0013mention\\u0014@相关人员：\\u0015描述讨论观点和关键内容"}}},{"ty":"mp","bi":57,"ei":58,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":58,"ei":59,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":59,"ei":60,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"outlineLvl_i":true,"ind_i":true,"pBdr_i":true,"hintType":"..."}}},{"ty":"mp","bi":60,"ei":61,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":61,"ei":62,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":69,"ei":70,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"outlineLvl_i":true,"ind_i":true,"pBdr_i":true}}},{"ty":"mp","bi":70,"ei":71,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":71,"ei":72,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":72,"ei":73,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"outlineLvl_i":true,"ind_i":true,"pBdr_i":true,"hintType":"\\u0013mention\\u0014@相关人员：\\u0015描述讨论观点和关键内容"}}},{"ty":"mp","bi":73,"ei":74,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":74,"ei":75,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":75,"ei":76,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"outlineLvl_i":true,"ind_i":true,"pBdr_i":true,"hintType":"\\u0013mention\\u0014@相关人员：\\u0015描述讨论观点和关键内容"}}},{"ty":"mp","bi":76,"ei":77,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":77,"ei":78,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":78,"ei":79,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"outlineLvl_i":true,"ind_i":true,"pBdr_i":true,"hintType":"..."}}},{"ty":"mp","bi":79,"ei":80,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":80,"ei":81,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":81,"ei":82,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":82,"ei":83,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"Normal"}}}},{"ty":"mp","bi":87,"ei":88,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"Normal"}}}},{"ty":"mp","bi":88,"ei":89,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":89,"ei":90,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"outlineLvl_i":true,"ind_i":true,"pBdr_i":true,"hintType":"结论一..., 输入\\u0013mention\\u0014@\\u0015，邀请相关人员。"}}},{"ty":"mp","bi":90,"ei":91,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":91,"ei":92,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":92,"ei":93,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"outlineLvl_i":true,"ind_i":true,"pBdr_i":true,"hintType":"结论二..., 输入\\u0013mention\\u0014@\\u0015，邀请相关人员。"}}},{"ty":"mp","bi":93,"ei":94,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":94,"ei":95,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":95,"ei":96,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"outlineLvl_i":true,"ind_i":true,"pBdr_i":true,"hintType":"..."}}},{"ty":"mp","bi":96,"ei":97,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":97,"ei":98,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":98,"ei":99,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":99,"ei":100,"mt":"paragraph","pr":{"paragraph":{}}},{"ty":"mp","bi":42,"ei":43,"mt":"table","pr":{"table":{"tblPr":{"isBegin":true}}}},{"ty":"mp","bi":81,"ei":82,"mt":"table","pr":{"table":{"tblPr":{"nestingLevel":1,"tblStyle":{"val":"Table Grid"}}}}},{"ty":"mp","bi":88,"ei":89,"mt":"table","pr":{"table":{"tblPr":{"isBegin":true}}}},{"ty":"mp","bi":98,"ei":99,"mt":"table","pr":{"table":{"tblPr":{"nestingLevel":1,"tblStyle":{"val":"Table Grid"}}}}},{"ty":"mp","bi":52,"ei":53,"mt":"tableRow","pr":{"tableRow":{"nestingLevel":1}}},{"ty":"mp","bi":55,"ei":56,"mt":"tableRow","pr":{"tableRow":{"nestingLevel":1}}},{"ty":"mp","bi":58,"ei":59,"mt":"tableRow","pr":{"tableRow":{"nestingLevel":1}}},{"ty":"mp","bi":61,"ei":62,"mt":"tableRow","pr":{"tableRow":{"nestingLevel":1}}},{"ty":"mp","bi":71,"ei":72,"mt":"tableRow","pr":{"tableRow":{"nestingLevel":1}}},{"ty":"mp","bi":74,"ei":75,"mt":"tableRow","pr":{"tableRow":{"nestingLevel":1}}},{"ty":"mp","bi":77,"ei":78,"mt":"tableRow","pr":{"tableRow":{"nestingLevel":1}}},{"ty":"mp","bi":80,"ei":81,"mt":"tableRow","pr":{"tableRow":{"nestingLevel":1}}},{"ty":"mp","bi":91,"ei":92,"mt":"tableRow","pr":{"tableRow":{"nestingLevel":1}}},{"ty":"mp","bi":94,"ei":95,"mt":"tableRow","pr":{"tableRow":{"nestingLevel":1}}},{"ty":"mp","bi":97,"ei":98,"mt":"tableRow","pr":{"tableRow":{"nestingLevel":1}}},{"ty":"mp","bi":51,"ei":52,"mt":"tableCell","pr":{"tableCell":{"nestingLevel":1,"tcW":{"w":8280,"type":"STTblWidth_dxa"},"tcBorders":{"top":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"left":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"right":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"bottom":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"}},"shd":{"fill":"E6F5FF"}}}},{"ty":"mp","bi":54,"ei":55,"mt":"tableCell","pr":{"tableCell":{"nestingLevel":1,"tcW":{"w":8280,"type":"STTblWidth_dxa"},"tcBorders":{"top":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"left":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"right":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"bottom":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"}}}}},{"ty":"mp","bi":57,"ei":58,"mt":"tableCell","pr":{"tableCell":{"nestingLevel":1,"tcW":{"w":8280,"type":"STTblWidth_dxa"},"tcBorders":{"top":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"left":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"right":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"bottom":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"}}}}},{"ty":"mp","bi":60,"ei":61,"mt":"tableCell","pr":{"tableCell":{"nestingLevel":1,"tcW":{"w":8280,"type":"STTblWidth_dxa"},"tcBorders":{"top":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"left":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"right":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"bottom":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"}}}}},{"ty":"mp","bi":70,"ei":71,"mt":"tableCell","pr":{"tableCell":{"nestingLevel":1,"tcW":{"w":8280,"type":"STTblWidth_dxa"},"tcBorders":{"top":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"left":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"right":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"bottom":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"}},"shd":{"fill":"E6F5FF"}}}},{"ty":"mp","bi":73,"ei":74,"mt":"tableCell","pr":{"tableCell":{"nestingLevel":1,"tcW":{"w":8280,"type":"STTblWidth_dxa"},"tcBorders":{"top":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"left":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"right":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"bottom":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"}}}}},{"ty":"mp","bi":76,"ei":77,"mt":"tableCell","pr":{"tableCell":{"nestingLevel":1,"tcW":{"w":8280,"type":"STTblWidth_dxa"},"tcBorders":{"top":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"left":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"right":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"bottom":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"}}}}},{"ty":"mp","bi":79,"ei":80,"mt":"tableCell","pr":{"tableCell":{"nestingLevel":1,"tcW":{"w":8280,"type":"STTblWidth_dxa"},"tcBorders":{"top":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"left":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"right":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"bottom":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"}}}}},{"ty":"mp","bi":90,"ei":91,"mt":"tableCell","pr":{"tableCell":{"nestingLevel":1,"tcW":{"w":8280,"type":"STTblWidth_dxa"},"tcBorders":{"top":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"left":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"right":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"bottom":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"}}}}},{"ty":"mp","bi":93,"ei":94,"mt":"tableCell","pr":{"tableCell":{"nestingLevel":1,"tcW":{"w":8280,"type":"STTblWidth_dxa"},"tcBorders":{"top":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"left":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"right":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"bottom":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"}}}}},{"ty":"mp","bi":96,"ei":97,"mt":"tableCell","pr":{"tableCell":{"nestingLevel":1,"tcW":{"w":8280,"type":"STTblWidth_dxa"},"tcBorders":{"top":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"left":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"right":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"bottom":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"}}}}},{"ty":"mp","bi":42,"ei":43,"mt":"tableRow","pr":{"tableRow":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":42,"ei":43,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":52,"ei":53,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":55,"ei":56,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":58,"ei":59,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":61,"ei":62,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":71,"ei":72,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":74,"ei":75,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":77,"ei":78,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":80,"ei":81,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":88,"ei":89,"mt":"tableRow","pr":{"tableRow":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":88,"ei":89,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":91,"ei":92,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":94,"ei":95,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":97,"ei":98,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":81,"ei":82,"mt":"tableRow","pr":{"tableRow":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":81,"ei":82,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":98,"ei":99,"mt":"tableRow","pr":{"tableRow":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":98,"ei":99,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}}]'),b=n(98772),y=function(){function e(e){var t=this;this.contextService=e,this.updateNumbering=function(e){var t=new Map;return e.forEachOp((function(e){if(e instanceof c.ModifyParagraphOperation&&e.param.property instanceof c.PropertyFactory.getPropertyClass(c.PropertyType.ParagraphProperty)){var n=e.param.property.numPr.numId;if(!n)return;if(t.has(n)&&t.get(n))e.param.property.numPr.numId=t.get(n);else{var r=u.StringUtil.generateRandomId();t.set(n,r),e.param.property.numPr.numId=r}}})),e.forEachOp((function(e){if(e instanceof c.CommonSettingOperation&&e.param.property instanceof c.PropertyFactory.getPropertyClass(c.PropertyType.NumberingProperty))for(var n=t.entries(),o=n.next();!o.done;){var i=(0,r.__read)(o.value,2),a=i[0],s=i[1],l=e.param.property.num.getProperty(a);if(!l)return;var d=l.abstractNumId,p=u.StringUtil.generateRandomId();l.numId=s,l.abstractNumId=p,e.param.property.num.appendProperty(l,"numId"),e.param.property.num.removeProperty(a,!0);var f=e.param.property.abstractNum.getProperty(d);if(!f)return;f.abstractNumId=p,e.param.property.abstractNum.appendProperty(f,"abstractNumId"),e.param.property.abstractNum.removeProperty(d,!0),o=n.next()}})),e},this.updateAuthorId=function(e){return e.forEachOp((function(e){e instanceof c.ModifyRunOperation&&e.param.property&&(e.param.property.author=t.context.clientVars.userId)})),e},this.updateTime=function(e){return e.forEachOp((function(e){var t=(0,_.$t)("XXXX年XX月XX日");if(e instanceof c.InsertOperation&&e.param.text.indexOf(t)>=0){var n=e.param,r=(0,p.p)(new Date,(0,_.$t)("yyyy年MM月dd日")),o=n.text,i=o.replace(t,r);o.length===i.length&&(n.text=i)}})),e},this.context=e.context}var t,n,y;return Object.defineProperty(e.prototype,"tableHandler",{get:function(){return this[d.ITableFeature].instance},enumerable:!1,configurable:!0}),e.prototype.$onEditorOpen=function(e){this.editor=e},e.prototype.processDelta=function(e){var t=this.editor.service,n=e;return this.processNeeded().map((function(e){n&&(n=e(n,t))})),n},e.prototype.processNeeded=function(){return[this.updatePosition,this.updateStyleId,this.updateAuthorId,this.updateTime,this.updateNumbering]},e.prototype.updateStyleId=function(e,t){return e.forEachOp((function(n){if(n instanceof c.ModifyParagraphOperation){var r=n.param.property.pStyle,o=t.getDocument().generateStyleProperty(e,r);o&&(n.param.property.pStyle=o.styleId)}if(n instanceof c.ModifyTableOperation){var i=n.param.property.tblPr.tblStyle,a=t.getDocument().generateStyleProperty(e,i);a&&(n.param.property.tblPr.tblStyle=a.styleId)}})),e},e.prototype.updatePosition=function(e,t){var n=t.getSelection(),r=n.getEnd();return e.forEachOp((function(e){c.OperationUtil.moveOffset(e,r)})),e.moveTo(n.range()),c.Commands.deleteText(n.range(),e),e},e.prototype.canAddTable=function(){return this[d.ITableFeature].instance.canAddTable()},e.prototype.insertTaskList=function(){this.apply(JSON.stringify(h))},e.prototype.insertWorkDaily=function(){this.apply(JSON.stringify(m))},e.prototype.insertWorkReport=function(){this.apply(JSON.stringify(g))},e.prototype.insertConferenceReport=function(){this.apply(JSON.stringify(v))},e.prototype.apply=function(e){var t=c.DeltaOption.createLocalDeltaOption(new c.GCPRange).buildDelta();this.editor.run("transMutationToDelta",t,e);var n=this.processDelta(t);if(n){var r=c.OperationUtil.getFixedGcpRange(n.operations,n.currentRange());t.moveTo(r),this.editor.applyDelta(n)}},y=d.ITableFeature,(0,r.__decorate)([(0,i.aN)(d.ITableFeature),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==o.IDynamicLoader&&o.IDynamicLoader)?n:Object)],e.prototype,y,void 0),(0,r.__decorate)([(0,b.z)(!0,[d.ITableFeature]),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Boolean)],e.prototype,"canAddTable",null),e=(0,r.__decorate)([(0,a.L)({name:l.C.Snippet,adapters:["melo"],provide:f.ISnippetFeature}),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==s.O&&s.O)?t:Object])],e)}()},73855:function(e,t,n){n.r(t),n.d(t,{ISpellcheckFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.Spellcheck));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(9714),n.e(7411),n.e(5218),n.e(6952),n.e(7131)]).then(n.bind(n,27596))];case 1:return[2,e.sent().SpellcheckHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s,platforms:[a.Ev.Pc]})})},26067:function(e,t,n){n.r(t),n.d(t,{ISplitlineFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.Splitline));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(9714),n.e(7411),n.e(5218),n.e(6952),n.e(7131)]).then(n.bind(n,82981))];case 1:return[2,e.sent().SplitlineHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s})})},20372:function(e,t,n){n.r(t),n.d(t,{IStarMobileFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.StarMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(7462).then(n.bind(n,30776))];case 1:return[2,e.sent().StarMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},63438:function(e,t,n){n.r(t),n.d(t,{ISubscribeFeature:function(){return c},MELO_DATA_CHANGED_EVENT:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),"Melo_setPadRev"),c=Symbol.for("feature:".concat(i.C.Subscribe));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Promise.all([n.e(8487),n.e(8937),n.e(866),n.e(2644),n.e(5218),n.e(3152),n.e(9445)]).then(n.bind(n,17047))];case 1:return e=t.sent().SubscribeHandler,o.Am.get(c),[2,e]}}))}))},on:a.iz.On({stages:[a.YV.Level4],key:c,platforms:[a.Ev.Pc,a.Ev.Mobile,a.Ev.Pad],load:!0})})},87420:function(e,t,n){n.r(t),n.d(t,{ISubscribeNoticeMobileFeature:function(){return c}});var r,o=n(85556),i=n(3139),a=n(22595),s=n(54541),c=(n(30479),Symbol.for("feature:".concat(a.C.SubscribeNoticeMobile)));i.Ln.merge(c,{useFactory:function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(8317).then(n.bind(n,82938))];case 1:return[2,e.sent().SubscribeNoticeMobileHandler]}}))}))},on:s.iz.On({stages:[s.YV.Level4],key:c,platforms:[s.Ev.Mobile,s.Ev.Pad],load:(null===(r=window.tdocs)||void 0===r||r.setActionButtons,!1)})})},46498:function(e,t,n){n.r(t),n.d(t,{ISubscriptionNotificationFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.SubscriptionNotification)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(33),n.e(159)]).then(n.bind(n,37779))];case 1:return[2,e.sent().SubscriptionNotificationHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level4],key:s,platforms:[a.Ev.Pc],load:!1})})},73132:function(e,t,n){n.r(t),n.d(t,{ISubscriptionNotificationMenuFeature:function(){return s}});var r=n(85556),o=(n(30479),n(3139)),i=n(54541),a=n(22595),s=Symbol.for("feature:".concat(a.C.SubscriptionNotificationMenu));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9243).then(n.bind(n,49220))];case 1:return[2,e.sent().SubscriptionNotificationMenuHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level4],key:s,platforms:[i.Ev.Pc],load:!1})})},21414:function(e,t,n){n.r(t),n.d(t,{ISwitchCertificationMobileFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.SwitchCertificationMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(1585).then(n.bind(n,44470))];case 1:return[2,e.sent().SwitchCertificationMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level4],key:s,platforms:[a.Ev.Pad,a.Ev.Mobile]})})},18982:function(e,t,n){n.r(t),n.d(t,{ISyncTencentListMobileFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.SyncTencentListMobile)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(8709).then(n.bind(n,61931))];case 1:return[2,e.sent().SyncTencentListlMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!1})})},22638:function(e,t,n){n.r(t),n.d(t,{ISyncTencentListHandler:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.SyncTencentList)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(8969).then(n.bind(n,52323))];case 1:return[2,e.sent().SyncTencentListHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level4],key:s,platforms:[a.Ev.Pc],load:!1})})},36013:function(e,t,n){n.r(t),n.d(t,{TemplateRecommendationHandler:function(){return q}});var r=n(85556),o=n(87363),i=n.n(o),a=n(3139),s=n(42035),c=n(68656),l=n(27613),u=n(23403),d=n(2613),p=(n(915),n(61533)),f=n.n(p),_=n(14366),h=n(33634).Buffer;const m="function"==typeof atob,g="function"==typeof h,v="function"==typeof TextDecoder?new TextDecoder:void 0,b=("function"==typeof TextEncoder&&new TextEncoder,Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=")),y=(e=>{let t={};return e.forEach(((e,n)=>t[e]=n)),t})(b),w=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,E=String.fromCharCode.bind(String),C="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),T=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),x=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,S=e=>{switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return E(55296+(t>>>10))+E(56320+(1023&t));case 3:return E((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return E((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},I=e=>e.replace(x,S),k=e=>{if(e=e.replace(/\s+/g,""),!w.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(3&e.length));let t,n,r,o="";for(let i=0;i<e.length;)t=y[e.charAt(i++)]<<18|y[e.charAt(i++)]<<12|(n=y[e.charAt(i++)])<<6|(r=y[e.charAt(i++)]),o+=64===n?E(t>>16&255):64===r?E(t>>16&255,t>>8&255):E(t>>16&255,t>>8&255,255&t);return o},R=m?e=>atob(T(e)):g?e=>h.from(e,"base64").toString("binary"):k,A=g?e=>C(h.from(e,"base64")):e=>C(R(e).split("").map((e=>e.charCodeAt(0)))),O=g?e=>h.from(e,"base64").toString("utf8"):v?e=>v.decode(A(e)):e=>I(R(e)),L=e=>T(e.replace(/[-_]/g,(e=>"-"==e?"+":"/"))),M=e=>O(L(e)),N=M;var D=n(30479),P=n(63184),F=n(22595),B=i().lazy((function(){return Promise.all([n.e(8487),n.e(6781)]).then(n.t.bind(n,26781,23)).then((function(e){return{default:e.TMallRecommendation}}))})),U=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.containerId="template-recommendation-container",t.onClickButton=function(e){var n,r,o,i;D.Logger.info("点击模板卡片回调触发",e);var a=!!e.marketingId,s=null===(r=null===(n=null===window||void 0===window?void 0:window.discussionExt)||void 0===n?void 0:n.getTemplateSourceKey)||void 0===r?void 0:r.call(n);s&&localStorage.setItem(s,a?"2":"1"),null===(i=null===(o=null===window||void 0===window?void 0:window.discussionExt)||void 0===o?void 0:o.setTemplateId)||void 0===i||i.call(o,e.id),t.props.close(),t.applyTemplate(e,2===e.source)},t}return(0,r.__extends)(t,e),t.prototype.render=function(){return i().createElement("div",{id:this.containerId})},t.prototype.componentDidMount=function(){this.renderTMallRecommendation()},t.prototype.componentDidUpdate=function(){this.renderTMallRecommendation()},t.prototype.renderTMallRecommendation=function(){var e,t=this.props.close,n=document.getElementById(this.containerId),r=null===(e=this.state)||void 0===e?void 0:e.keyword;f().render(i().createElement(i().Suspense,{fallback:null},i().createElement(B,{type:"doc",className:"template-recommendation",fromPage:"doc_word_buttom_reco",id:"wordReco",onClickTemplate:this.onClickButton,onClose:t,container:n||void 0,keyword:r})),document.getElementById(this.containerId))},t.prototype.applyTemplate=function(e,t){var n=this;void 0===t&&(t=!1),this.getTemplateInfos(e.id,t).then((function(e){e&&(D.Logger.info("模板数据解析完毕，准备插入模板"),n.insertTemplate(e))})).catch((function(e){n.reportError("插入模板失败",e.message)}))},t.prototype.getTemplateInfos=function(e,t){var n;return void 0===t&&(t=!1),(0,r.__awaiter)(this,void 0,void 0,(function(){var o,i,a,s;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,(0,_.Z)({method:"POST",url:"/v2/mall/doc/content",data:{id:e,is_custom:t}})];case 1:return o=r.sent(),0!==(null==(i=o.data)?void 0:i.cgicode)||0!==(null==i?void 0:i.retcode)?(this.reportError("getTemplateInfos 获取模板数据失败",null==i?void 0:i.msg),[2]):(a=null===(n=null==i?void 0:i.result)||void 0===n?void 0:n.atext[0],[2,d.Changeset.deserialize(JSON.parse(N(a.bytesText)).commands[0].mutations,d.MutationWrapperDeserialize)]);case 2:return s=r.sent(),this.reportError("getTemplateInfos 获取并解析模板数据失败",s.message),[2];case 3:return[2]}}))}))},t.prototype.insertTemplate=function(e){var t=new P.QD({mutations:e}).dataEngine;if(t){var n=this.copyTemplate(t);n?this.props.editor.clipboardManager.pasteTemplate(n):this.reportError("插入模板失败：未找到模板 mainStory")}else this.reportError("插入模板失败：模板内容转换 delta 失败")},t.prototype.copyTemplate=function(e){var t=this,n=d.DeltaOption.createLocalDeltaOption(d.GCPRange.emptyRange()).buildDelta(),r=e.getDataStream().getStoryStream().getSubStoryInfoFromId(d.StoryID.MainDocId);if(r){var o=new d.GCPRange(r.range.begin(),r.range.length()-1),i=d.DataCollector.collectDataToDelta(e,n,o),a=[];this.props.editor.run("transDeltaToOperationData",n,a,e);var s=[];return i.forEach((function(n){var r=[];t.props.editor.run("transDeltaToOperationData",n.delta,r,e),s.push({storyId:n.storyId,storyOps:r,storyType:n.storyType})})),JSON.stringify({mainStory:a,subStory:s,srcGlobalPadId:""})}},t.prototype.reportError=function(e,t){void 0===t&&(t=""),d.ReportHelper.weiMonitorCube({module:d.ICubeModule.Feature,name:F.C.TemplateRecommendation,action:e,msg:t}),D.Logger.error(e,t)},t}(i().Component),H=U,j=n(98859),W=n(95419),V=n(14740),z=n(94778),G=(0,V.$t)("无标题文档"),Y="9j7hoktz63r68xy6q6oer9jwta",q=function(){function e(e,t,n){var r=this;this.contextService=e,this.widgetService=t,this.configService=n,this.themeId=Y,this.onTitleChanged=function(e){var t;null===(t=r.templateRecommendation)||void 0===t||t.setState({keyword:e===G?"":e})},this.onKeyDown=function(e){var t=e||window.event,n=t.code||t.key,o=t.keyCode||t.which||t.charCode;"enter"!==n&&o!==d.KeyCode.ENTER||r.close()},this.onModelChange=function(){var e,t=r.editor.getDocumentBox().getFirstDescendantOf(d.BoxKind.RichTextArea,(function(e){return e.firstVisibleChild}));if(t&&Array.isArray(t.children)&&(null===(e=t.children)||void 0===e?void 0:e.length)<=2){var n=t.lastChild;if(n&&(0,d.isParagraphBox)(n)&&r.titleBase.isParaEmpty(n)&&r.titleBase.isParaNormalHolderStyle(n.property))return}r.close()},this.themeId=Y}var t,n,o,p;return e.prototype.showTemplate=function(){var e=this;this.isNewDoc()&&this.isOwner()&&this.isEmptyDoc()&&setTimeout((function(){e.show()}),0)},e.prototype.$onEditorOpen=function(e){var t=this;this.editor=e,this.titleBase=new W.H(e),this.editor.getRenderFinishAllPromise().then((function(){t.configService.get("custom.feature.template_recommend")&&t.showTemplate()}))},e.prototype.show=function(){var e=this;this.subscription=this.eventEmitter.listen("titleChanged",this.onTitleChanged),this.editor.on(d.StateNotification.ModelChange,this.onModelChange),this.widgetService.float({name:F.C.TemplateRecommendation,component:i().createElement(H,{ref:function(t){t&&(e.templateRecommendation=t)},templateThemeId:this.themeId,close:function(){e.close()},container:document.body,editor:this.editor||this.contextService.context.editor}),styles:{zIndex:1,position:"relative"}}),document.addEventListener("keydown",this.onKeyDown)},e.prototype.close=function(){this.widgetService.remove(F.C.TemplateRecommendation,"float"),document.removeEventListener("keydown",this.onKeyDown),this.subscription&&(this.subscription.unsubscribe(),this.subscription=void 0),this.editor.removeCallBack(d.StateNotification.ModelChange,this.onModelChange)},e.prototype.isNewDoc=function(){var e,t;return(null===(e=window.clientVars)||void 0===e?void 0:e.metaCreateTime)&&(null===(t=window.clientVars)||void 0===t?void 0:t.lastModifyTime)&&window.clientVars.lastModifyTime-window.clientVars.metaCreateTime<1e3},e.prototype.isEmptyDoc=function(){return 10===this.editor.state.dataEngine.getDataStream().getTextStream().readText(0,Number.MAX_SAFE_INTEGER).length},e.prototype.isOwner=function(){var e,t,n;return window.clientVars&&(null===(e=window.clientVars)||void 0===e?void 0:e.ownerId)===(null===(n=null===(t=window.clientVars)||void 0===t?void 0:t.userInfo)||void 0===n?void 0:n.tinyId)},(0,r.__decorate)([(0,a.tB)(),(0,r.__metadata)("design:type","function"==typeof(p=void 0!==s.v&&s.v)?p:Object)],e.prototype,"eventEmitter",void 0),e=(0,r.__decorate)([(0,c.L)({name:F.C.TemplateRecommendation,adapters:["melo"],provide:z.ITemplateRecommendation}),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==l.O&&l.O)?t:Object,"function"==typeof(n=void 0!==u.i&&u.i)?n:Object,"function"==typeof(o=void 0!==j.ax&&j.ax)?o:Object])],e)}()},94778:function(e,t,n){n.r(t),n.d(t,{ITemplateRecommendation:function(){return c},canShowRecommendation:function(){return l}});var r=n(85556),o=n(3139),i=n(54541),a=n(22595),s=n(50263),c=(n(30479),Symbol.for("feature:".concat(a.C.TemplateRecommendation))),l=function(){return window.clientVars&&(null===(e=window.clientVars)||void 0===e?void 0:e.metaCreateTime)===(null===(t=window.clientVars)||void 0===t?void 0:t.lastModifyTime)&&function(){var e,t,n;return 10===(null===(n=null===(t=null===(e=null===window||void 0===window?void 0:window.__editor)||void 0===e?void 0:e.state)||void 0===t?void 0:t.dataEngine)||void 0===n?void 0:n.getDataStream().getTextStream().readText(0,Number.MAX_SAFE_INTEGER).length)}()&&function(){var e;return window.clientVars&&(null===(e=window.clientVars)||void 0===e?void 0:e.isOwner)}()&&!s.A.isTencentMeetingInWework();var e,t};o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.resolve().then(n.bind(n,36013))];case 1:return[2,e.sent().TemplateRecommendationHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level1],key:c,platforms:[i.Ev.Pc],load:!1})})},69412:function(e,t,n){n.r(t),n.d(t,{ITextDragPcFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.TextDragPc));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(9714),n.e(7411),n.e(5218),n.e(6952),n.e(7131)]).then(n.bind(n,19201))];case 1:return[2,e.sent().TextDragPcHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s,platforms:[a.Ev.Pc]})})},73964:function(e,t,n){n.r(t),n.d(t,{ITextFlowFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.TextFlow));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(9714),n.e(7411),n.e(5218),n.e(6952),n.e(7131)]).then(n.bind(n,44867))];case 1:return[2,e.sent().TextFlowHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s})})},44867:function(e,t,n){n.r(t),n.d(t,{DOC_ID:function(){return U},TextFlowHandler:function(){return W}});var r=n(85556),o=n(87363),i=n.n(o),a=n(30479),s=n(63184),c=n(68656),l=n(82010),u=n(23403),d=n(42035),p=n(52747),f=n(77947),_=n(2613),h=n(14740),m=n(44166),g=n(3139),v="text-flow-wrapper--SFgoh",b="text-flow-seperator--qjZIb",y="text-flow-item-container--jYFp+",w="text-flow-title--Leo2g",E="text-flow-str--omwJE",C="text-flow-expand--YeSSn",T="text-flow-time--r2wTp",x="text-flow-empty--JiweH",S=n(22828),I=n(37769),k=n(30322),R=function(){function e(){this.textEllipsisFormatter=new k.J}return e.prototype.$onReset=function(){},e.prototype.setInvisible=function(){this.textEllipsisFormatter.setInvisible()},e.prototype.clear=function(){this.textEllipsisFormatter.clear()},e.prototype.reset=function(){this.textEllipsisFormatter.reset()},e.prototype.attachStyle=function(e){this.textEllipsisFormatter.attachStyle(e)},e.prototype.getText=function(e,t){return this.textEllipsisFormatter.getText(e,t)},e.prototype.wrapWidth=function(e,t,n,r,o){return void 0===r&&(r="..."),this.textEllipsisFormatter.wrapWidth(e,t,n,r,o)},e.prototype.wrapLine=function(e,t,n,r,o,i){return void 0===o&&(o="..."),void 0===i&&(i=!0),this.textEllipsisFormatter.wrapLine(e,t,n,r,o,i)},e=(0,r.__decorate)([(0,I.t)(),(0,r.__metadata)("design:paramtypes",[])],e)}();function A(e){function t(t){var n=new Date(e),r=t,o={"M+":n.getMonth()+1,"d+":n.getDate(),"h+":n.getHours(),"m+":n.getMinutes(),"s+":n.getSeconds()};return/(y+)/.test(r)&&(r=r.replace(RegExp.$1,"".concat(n.getFullYear()).substr(4-RegExp.$1.length))),Object.keys(o).forEach((function(e){new RegExp("(".concat(e,")")).test(r)&&(r=r.replace(RegExp.$1,1===RegExp.$1.length?o[e]:"00".concat(o[e]).substr("".concat(o[e]).length)))})),r}var n=new Date(e),r=e-(new Date).setHours(0,0,0,0);return r>=0&&r<864e5?(0,h.$t)("今天 {{time}}",{time:t("hh:mm:ss")}):n.getFullYear()===(new Date).getFullYear()?"".concat(t("MM-dd hh:mm:ss")):"".concat(t("yyyy-MM-dd hh:mm:ss"))}var O=function(e){function t(t){var n=e.call(this,t)||this;return n.textRef=i().createRef(),n.showAll=function(e){n.setState({clamp:void 0,expand:!0}),e.stopPropagation()},n.onClickItem=function(){var e,t,r=n.props.item.texts.join("\n");null===(t=(e=n.props).onClickItem)||void 0===t||t.call(e,r)},n.state={expand:!1},n}var n;return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.noCollapse||this.state.expand||setTimeout((function(){if(e.textRef.current){var t=e.props.item.texts.join("\n"),n=e.ellipseService.wrapLine(t,e.textRef.current.offsetWidth,4,{classname:E},"... ".concat((0,h.$t)("显示全部")),!1);n!==t&&e.setState({clamp:n})}}),0)},t.prototype.render=function(){var e=this.state.clamp,t=null;return e&&(t=S.t.isIPad()?i().createElement("span",null,"... ",i().createElement("span",{className:C,onTouchEnd:this.showAll},(0,h.$t)("查看全部"))):i().createElement("span",null,"... ",i().createElement("span",{className:C,onClick:this.showAll},(0,h.$t)("查看全部")))),i().createElement("div",{style:(0,r.__assign)({padding:"16px",borderBottom:"1px solid rgba(0, 0, 0, 0.06)"},this.props.style)},i().createElement("div",{onClick:this.onClickItem,className:E,ref:this.textRef},e||this.props.item.texts.join("\n"),t),i().createElement("div",{className:T},A(this.props.item.time)))},(0,r.__decorate)([(0,g.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==R&&R)?n:Object)],t.prototype,"ellipseService",void 0),t}(i().Component),L=function(e){function t(t){var n=e.call(this,t)||this;return n.textRef=i().createRef(),n.onCopy=function(){n.props.handler.onCopy(n.props.item)},n.state={textContent:""},n}var n;return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;setTimeout((function(){var t=document.createElement("div"),n=e.props.item.content;t.innerHTML=n.plain;var r=e._ellipseService.wrapLine(t.textContent||"",e.textRef.current.offsetWidth,4,{classname:E},"... ".concat((0,h.$t)("复制")),!1);e.setState({textContent:r})}))},t.prototype.render=function(){return i().createElement("div",{style:{padding:"16px 0px",borderBottom:"1px solid rgba(0, 0, 0, 0.06)"}},i().createElement("div",{className:w},(0,h.$t)("最近未保存的文档内容")),i().createElement("div",{className:E,ref:this.textRef},i().createElement("span",null,this.state.textContent,"...",i().createElement("span",{className:C,onClick:this.onCopy},(0,h.$t)("复制")))),i().createElement("div",{className:T},A(this.props.item.time)))},(0,r.__decorate)([(0,g.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==R&&R)?n:Object)],t.prototype,"_ellipseService",void 0),t}(i().Component),M=function(e){function t(t){var n=e.call(this,t)||this,r=n.props.handler.getTextFlow(),o=n.props.handler.getTextKeyframe();return n.state={current:r.current,textFlow:r.past,textKeyframe:o},n.props.handler.onTextFlowChanged=function(){var e=n.props.handler.getTextFlow();n.setState({current:e.current,textFlow:e.past})},n}return(0,r.__extends)(t,e),t.prototype.componentWillUnmount=function(){this.props.handler.onTextFlowChanged=void 0},t.prototype.render=function(){var e=this;return i().createElement("div",{className:v},i().createElement("div",{className:b}),0!==this.state.textFlow.length||this.state.current?i().createElement("div",{className:y},this.state.current?i().createElement(O,{key:"current",item:this.state.current,noCollapse:!0,style:{padding:"16px 0px"}}):null,this.state.textKeyframe?i().createElement(L,{item:this.state.textKeyframe,handler:this.props.handler}):null,this.state.textFlow.map((function(t,n){return i().createElement(O,{key:e.state.textFlow.length-n,item:t,style:{padding:"16px 0px"}})}))):i().createElement("div",{className:x,style:{paddingTop:"222px"}},(0,h.$t)("无文本")))},t}(i().Component),N=n(22595),D=n(73964),P=function(){function e(){this.singleMax=1e4,this.totalMax=1e5,this.INDEX_KEY="text_flow_index",this.SAVE_TIME=2592e6,this.cache=[],this.index=[],this.readCache()}return e.prototype.getCache=function(){return this.cache},e.prototype.append=function(e,t){e.length>0&&(this.cache.unshift({texts:e,time:t}),this.saveCache(this.cache,t))},e.prototype.saveTemp=function(e,t){e.length>0&&this.saveCache([{texts:e,time:t}].concat(this.cache),t)},e.prototype.readCache=function(){var e,t;try{var n=a.LocalStorageUtil.getItem(this.getCacheKey());n&&(e=this.cache).push.apply(e,(0,r.__spreadArray)([],(0,r.__read)(JSON.parse(n)),!1));var o=a.LocalStorageUtil.getItem(this.INDEX_KEY);o&&(t=this.index).push.apply(t,(0,r.__spreadArray)([],(0,r.__read)(JSON.parse(o)),!1))}catch(e){a.Logger.error("text flow read cache error",e)}},e.prototype.saveCache=function(e,t){var n=this,r=[],o=0;e.some((function(e){var t=0;return e.texts.forEach((function(e){return t+=e.length})),o+t>n.singleMax||(o+=t,r.push(e),!1)})),a.LocalStorageUtil.setItem(this.getCacheKey(),JSON.stringify(r)),this.insertIndex(this.getCacheKey(),o,t)},e.prototype.insertIndex=function(e,t,n){var r=this.index.find((function(t){return t.key===e}));r?(r.count=t,r.time=n):this.index.unshift({key:e,count:t,time:n}),this.shrinkIndex(),a.LocalStorageUtil.setItem(this.INDEX_KEY,JSON.stringify(this.index))},e.prototype.shrinkIndex=function(){var e=this;this.index.sort((function(e,t){return t.time-e.time}));var t=0,n=!1,r=Date.now();this.index=this.index.filter((function(o){var i=!1;return r-o.time>e.SAVE_TIME?i=!0:!n&&t+o.count>e.totalMax&&(n=!0),n||i?(a.LocalStorageUtil.removeItem(o.key),!1):(t+=o.count,!0)}))},e.prototype.getCacheKey=function(){var e=(0,m.Yi)();return"".concat(e.globalPadId,"_").concat(e.userDomain,"_text_flow")},e}(),F=n(52739),B=n(48069),U="BB08J2",H=[_.PlaceholderChar.SubStoryBegin,_.PlaceholderChar.SubStoryEnd,_.PlaceholderChar.DrawingAnchor,_.PlaceholderChar.TableStart,_.PlaceholderChar.TableEnd,_.PlaceholderChar.TableRowBreak,_.PlaceholderChar.TableCellBreak,_.PlaceholderChar.CommentReference,_.PlaceholderChar.PageBreak],j=new RegExp(H.join("|"),"g"),W=function(){function e(e,t,n,r,o){var s=this;this.drawerService=e,this.widgetService=t,this.eventEmitter=n,this.context=r,this.store=o,this.textFlowCache=new P,this.currentRecord=[],this.currentBeginTime=0,this.currentUpdateTime=0,this.throttleMobile=(0,a.throttle)((function(){s.textFlowCache.saveTemp(s.extractCurrentRecord(),s.currentUpdateTime)}),5e3),this.beforeunload=function(){var e;s.textFlowCache.append(s.extractCurrentRecord(),s.currentUpdateTime);var t=window.App,n=t.changesetManager,r=t.offlineEditAdapter;if(n.hasUncommittedChanges()&&(!r.canRead()||!r.isLocked())){var o=s.editor.service.getDocument().getMainStoryRange(),i=s.editor.getCopyContent(o);i&&s.setTextKeyframe({content:i,time:+new Date}),null===(e=_.ReportHelper.aegisHandler)||void 0===e||e.aegisReport("beforeunload_has_uncommitted_and_no_db")}},this.showTextHistory=function(){var e;null===(e=s.drawerService)||void 0===e||e.showRightDrawer({name:"textHistory",content:i().createElement(M,{handler:s}),style:{paddingTop:0},title:(0,h.$t)("最近输入文本"),titleStyle:{opacity:.64,fontSize:15,fontWeight:500,lineHeight:1.07,letterSpacing:.38,padding:"17px 16px"}})},this.hideTextHistory=function(){var e;null===(e=s.drawerService)||void 0===e||e.closeRightDrawer()},this.hideTextHistoryWhenOpen=function(){s.hideTextHistory(),(0,B.vr)(B.GB.show)},this.$sub=this.eventEmitter.listen("$triggerTextFlow",this.showTextHistory)}var t,n,o,g,v;return e.prototype.$onEditorOpen=function(e){var t=this;this.editor=e,this.textFlowCache=new P,this.editor=e,e.on(s.zW.LocalChange,(function(e){t.updateCurrentRecord(e.changeset),t.onTextFlowChanged&&t.onTextFlowChanged(),a.PlatformUtil.isWXFamily()&&t.throttleMobile()}),this),e.on(_.RenderNotificationTypes.PAGE_TOUCH_EVENT,this.hideTextHistory),window.addEventListener("beforeunload",this.beforeunload)},e.prototype.$onEditorClose=function(e){var t;this.hideTextHistory(),e.removeListener(s.zW.LocalChange,this),e.removeCallBack(_.RenderNotificationTypes.PAGE_TOUCH_EVENT,this.hideTextHistory),window.removeEventListener("beforeunload",this.beforeunload),this.currentRecord=[],this.currentBeginTime=0,this.currentUpdateTime=0,null===(t=this.$sub)||void 0===t||t.unsubscribe()},e.prototype.getTextFlow=function(){var e=this.extractCurrentRecord();return{current:e.length>0?{texts:e,time:this.currentUpdateTime}:void 0,past:this.textFlowCache.getCache()}},e.prototype.getTextKeyframe=function(){var e,t,n=a.LocalStorageUtil.getItem(this.getCacheKey());if(n){var r=JSON.parse(n);return{content:{html:null===(e=null==r?void 0:r.content)||void 0===e?void 0:e.html,plain:null===(t=null==r?void 0:r.content)||void 0===t?void 0:t.plain},time:null==r?void 0:r.time}}},e.prototype.setTextKeyframe=function(e){a.LocalStorageUtil.setItem(this.getCacheKey(),JSON.stringify({content:{html:e.content.html,plain:e.content.plain},time:e.time}))},e.prototype.onCopy=function(e){this.editor.writeHtmlToClipboard({html:e.content.html,plain:e.content.plain}),F.Snackbar.show({message:(0,h.$t)("已复制到剪贴板，建议新建文档粘贴内容")})},e.prototype.getCacheKey=function(){var e=(0,m.Yi)();return"".concat(e.globalPadId,"_").concat(e.userDomain,"_text_flow_keyframe")},e.prototype.dissectChangeset=function(e){var t=[];return e.forEach((function(e){if(e.type===_.MutationType.insert){var n=e.getMutation().text;t.push.apply(t,(0,r.__spreadArray)([],(0,r.__read)(n.split(_.PlaceholderChar.ParagraphReturn)),!1))}})),t=t.map((function(e){return _.FieldUtil.getFilterFieldCodeText(e.replace(j," "))})).filter((function(e){return!!e}))},e.prototype.compose=function(e,t){var n=e.concat(t).filter((function(e){return e.type===_.MutationType.insert||e.type===_.MutationType.delete}));return _.Changeset.compose(n)},e.prototype.extractCurrentRecord=function(){return this.dissectChangeset(this.currentRecord)},e.prototype.updateOrCache=function(e){try{var t=Date.now();0===this.currentBeginTime&&(this.currentBeginTime=t);var n=t-this.currentBeginTime>6e5,r=this.currentRecord,o=r.length>0?this.compose(r,e):e;!n||r&&this.dissectChangeset(r).length>=this.dissectChangeset(o).length?this.currentRecord=o:(this.textFlowCache.append(this.extractCurrentRecord(),this.currentUpdateTime),this.currentRecord=e,this.currentBeginTime=t),this.currentUpdateTime=t}catch(t){a.Logger.info("text_flow update error: ".concat(t.message)),this.textFlowCache.append(this.extractCurrentRecord(),this.currentUpdateTime),this.currentRecord=e,this.currentBeginTime=Date.now(),this.currentUpdateTime=this.currentBeginTime}},e.prototype.updateCurrentRecord=function(e){e&&e.length>0&&this.updateOrCache(e)},e=(0,r.__decorate)([(0,c.L)({name:N.C.TextFlow,adapters:["melo"],provide:D.ITextFlowFeature}),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==l.zv&&l.zv)?t:Object,"function"==typeof(n=void 0!==u.i&&u.i)?n:Object,"function"==typeof(o=void 0!==d.v&&d.v)?o:Object,"function"==typeof(g=void 0!==p.x9&&p.x9)?g:Object,"function"==typeof(v=void 0!==f.O&&f.O)?v:Object])],e)}()},64102:function(e,t,n){n.r(t),n.d(t,{ITitleFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.Title));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9454).then(n.bind(n,31905))];case 1:return[2,e.sent().TitleHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level1,a.YV.Publish],key:s})})},31905:function(e,t,n){n.r(t),n.d(t,{TitleHandler:function(){return g}});var r=n(85556),o=n(8962),i=n(2613),a=n(98502),s=n(19543),c=n(4211),l=n(68656),u=n(77947),d=n(42035),p=n(27613),f=n(55142),_=n(81387),h=(n(30479),n(22595)),m=n(64102),g=function(){function e(e,t,n,r){var l=this;this.store=e,this.eventEmitter=t,this.autoNamedId=0,this.userEdit=!1,this.hasStoreUserChange=!1,this.transferringDocstatus=!1,this.saveToList=function(e){l.hasStoreUserChange=!0;var t=l.context.clientVars;if(!l.userEdit||12!==t.docStatus||e!==a.f.UserChangeset)return!1;l.transferringDocstatus||(l.transferringDocstatus=!0,s.y.docHumtrans(t).then((function(){var e;l.transferringDocstatus=!1,i.GlobalContext.unRegisterPlugin(((e={})[a.K.SetData2Store]=l.setDataToStorePlugin,e))})))},this.userEditDoc=function(){if(l.userEdit){var e=l.context.editor;e instanceof i.MeloEditor&&setTimeout((function(){e.removeCallBack(i.StateNotification.EfficientModelChange,l.userEditDoc)}),0)}else l.userEdit=!0,l.hasStoreUserChange&&l.saveToList(a.f.UserChangeset)},this.setTitle=function(e){o.q.getInstance().setTitleForDoc(e,(function(t){t&&0===t.retcode&&l.store.get(c.j.ModelState).next(e)}))},this.updateInitDocTitle=function(){o.q.getInstance().updateDocInitTitle()},this.getCurTitleReversion=function(){return s.y.getTitleReversionFromStore()},this.setTitleToNativeTitlebar=function(e){o.q.getInstance().setTitleToNativeTitlebar(e)},this.setDataToStorePlugin=function(e,t,n){l.saveToList(n),t()},this.context=r.context,this.$sub=this.eventEmitter.listen("setTitle",this.setTitle)}var t,n,g,v;return e.prototype.$onEditorOpen=function(e){var t,n=this;e.on(i.StateNotification.CollabToServer,(function(t){n.updateFirstParaContentInfo(e);var r=t.delta.operations;n.isTextChange(r)&&n.updateTitle(e,t.delta)}),this),e.on(i.StateNotification.EfficientModelChange,this.userEditDoc),e.on(_.ZK.ON_TITLE_CHANGE,(function(t){n.updateFirstParaContentInfo(e);var r=t.newTitle;n.context.clientVars.padTitle=r,n.context.clientVars.title=r,n.store.update("docTitle",r)}),this),i.GlobalContext.registerPlugin(((t={})[a.K.SetData2Store]=this.setDataToStorePlugin,t))},e.prototype.updateTitle=function(e,t){var n=this,r=t.globalOpts.originRange;this.checkIsInFirstPara(r)&&(this.updateFirstParaContentInfo(e),this.autoNamedId&&clearTimeout(this.autoNamedId),this.autoNamedId=setTimeout((function(){e.isCompositing()||e.isUpdating?n.updateTitle(e,t):n.autoUpdateTitle()}),500))},e.prototype.checkIsInFirstPara=function(e){var t,n=null===(t=this.firstParaContentInfo)||void 0===t?void 0:t.range;return!(!this.firstParaContentInfo||!e.intersect(this.firstParaContentInfo.range)&&(null==n?void 0:n.end())!==e.begin())},e.prototype.updateFirstParaContentInfo=function(e){if(i.Defaults.curDocDataVersion>=i.Defaults.newDefaultStyleVersion){var t=e.service.getDocument().getFirstParaRange(),n=new i.GCPRange(t.begin(),t.length()-1);this.firstParaContentInfo={range:n,content:e.getRefText(n)}}else this.firstParaContentInfo=e.service.getDocument().getFirstParamText()},e.prototype.isTextChange=function(e){var t,n,o=!1;try{for(var a=(0,r.__values)(e),s=a.next();!s.done;s=a.next()){var c=s.value;if((c instanceof i.InsertOperation||c instanceof i.DeleteOperation)&&this.checkIsInFirstPara(c.param.range)&&(c instanceof i.DeleteOperation||c instanceof i.InsertOperation&&![i.PlaceholderChar.ParagraphReturn,i.PlaceholderChar.PageBreak,i.PlaceholderChar.SectionBreak].includes(c.param.text))){o=!0;break}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return o},e.prototype.autoUpdateTitle=function(){var e;this.firstParaContentInfo&&o.q.getInstance().autoUpdateTitle(null===(e=this.firstParaContentInfo)||void 0===e?void 0:e.content)},e.prototype.$onEditorClose=function(e){var t;o.q.getInstance().destroy(),e.removeListener(i.StateNotification.CollabToServer,this),e.removeCallBack(i.StateNotification.EfficientModelChange,this.userEditDoc),e.removeListener(_.ZK.ON_TITLE_CHANGE,this),this.autoNamedId=0,this.userEdit=!1,null===(t=this.$sub)||void 0===t||t.unsubscribe()},e=(0,r.__decorate)([(0,l.L)({name:h.C.Title,adapters:["melo"],provide:m.ITitleFeature}),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==u.O&&u.O)?t:Object,"function"==typeof(n=void 0!==d.v&&d.v)?n:Object,"function"==typeof(g=void 0!==f.TitlebarHandler&&f.TitlebarHandler)?g:Object,"function"==typeof(v=void 0!==p.O&&p.O)?v:Object])],e)}()},8962:function(e,t,n){n.d(t,{q:function(){return A}});var r=n(85556),o=n(2613),i=n(48295),a=n(14740),s=n(44166),c=n(19543),l=n(52739),u=n(4211),d=n(3139),p=n(77947),f=n(27613),_=n(42035),h=n(30479),m=n(22462),g=(n(23336),n(15857)),v=n(47433);n(87363);var b=n(94258),y=n(71888),w=n(21856),E=n(83292);function C(e){var t=e.title,n=e.desc,r=e.share_url,i=e.image_url;window.wx&&(window.wx.onMenuShareAppMessage({title:t,desc:n,link:r,imgUrl:i,type:"",dataUrl:"",success:function(){o.ReportHelper.tdwReport({opername:"doc_share",module:"wecha_h5",action:"wechat_suc"})},cancel:function(){},trigger:function(){o.ReportHelper.tdwReport({opername:"doc_share",module:"wecha_h5",action:"share_wechat"})}}),window.wx.onMenuShareTimeline({title:t,link:r,imgUrl:i,success:function(){o.ReportHelper.tdwReport({opername:"doc_share",module:"wecha_h5",action:"moment_suc"})},cancel:function(){},trigger:function(){o.ReportHelper.tdwReport({opername:"doc_share",module:"wecha_h5",action:"share_moment"})}}),window.wx.onMenuShareQQ({title:t,desc:n,link:r,imgUrl:i,success:function(){},cancel:function(){}}))}var T=new(function(){function e(){}var t,n;return e.prototype.init=function(){this.slr=this.scriptLoaderService.getScriptLoader()},e.prototype.setShareInfo=function(e,t){if(!g.qO.getInstance().isDrivePreview&&this.isShareMobile){var n=t.shortLink,r=t.padTitle,o=t.newPad,i=t.isCreator,s=t.rightFlag,c=t.policy,l=t.domainId,u=t.padId,d=window.location,p=d.origin,f=d.pathname,_=d.href,m="".concat(p).concat(f),v=(0,y.pm)(_).dver||"",E=(b.Z["file_doc_150@2x"],b.Z["file_doc_transparent_150@2x"]),T=b.Z["file_doc_500@2x"],x={source_name:window.productName,desc:(0,a.$t)("".concat(window.productName,"-在线文档")),image_url:E,miniprogram_image_url:this.shareImageData?this.shareImageData:T,contentEdited:window.isContentEditedToNativeSend||!1,editable:g.qO.getInstance().isEditable,type:"docx",singleLineTitle:"",share_url:n||v?"".concat(m,"?dver=").concat(v):"".concat(m),localPadId:u,title:r,isCreator:i,rightFlag:s,policy:c,isNewCreate:o,domainId:l};x.singleLineTitle=x.title||"";var S=(0,h.getUrlParameter)("group_code");S&&(x.groupCode=S);var I=(0,h.getUrlParameter)("scode");S&&(x.scode=I),function(e){var t=window.navigator.userAgent,n=h.PlatformUtil.isWXMiniProgram()||h.PlatformUtil.isQQMiniProgram(),r=!(!t.match(/MicroMessenger/i)||n),o=h.PlatformUtil.isWeWork()&&!1;if((r&&!o||n)&&null!=e)if(document.getElementById("jweixinScript"))e();else{var i=document.createElement("script");i.id="jweixinScript";var a=h.PlatformUtil.isQQMiniProgram();i.src=a?w.X.getInstance().getConfig("runtime.library.TENCENT_DOCS_LIBRARY__qqjssdk_1_0_0"):w.X.getInstance().getConfig("runtime.library.TENCENT_DOCS_LIBRARY__jweixin_1_6_0"),i.onload=e,a&&(i.crossOrigin="anonymous"),null!==document.head&&document.head.appendChild(i)}}((function(){C(x),setTimeout((function(){C(x)}),2e3)}));var k=this.isNewMobileApp();if(h.PlatformUtil.isTimQQ()){var R=window.mqq;x.showShareBtn=!k,R&&R.invoke("data","setShareInfo",x,(function(){}))}this.shareInfo=x}},e.prototype.isNewMobileApp=function(){return!1},(0,r.__decorate)([(0,d.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==p.O&&p.O)?t:Object)],e.prototype,"store",void 0),(0,r.__decorate)([(0,d.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==v.$&&v.$)?n:Object)],e.prototype,"scriptLoaderService",void 0),(0,r.__decorate)([(0,E.D)("feature.shareInfo.isNeedSetShareInfo",!0),(0,r.__metadata)("design:type",Object)],e.prototype,"isShareMobile",void 0),e}()),x=n(38429),S=n(76511),I=/[\\/:*?"<>|]/,k=(0,a.$t)("title:forbidden-chars-pc"),R=((0,a.$t)("title:forbidden-chars-mobile"),function(){function e(){var e=this;this.autoNamedId=0;var t=this.store.get(u.j.IsOnline);t.getValue()&&this.checkAndUploadTitle(),this.$sub=t.subscribe((function(t){t&&e.checkAndUploadTitle()}))}var t,n,g;return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.$onReset=function(){var e;null===(e=this.$sub)||void 0===e||e.unsubscribe()},e.prototype.checkAndUploadTitle=function(){var e=this.readTitleFromStorage();if(e){if(e.isAuto&&1===(0,s.Yi)().isUserChangeTitle)return void this.persistTitleToStorage("",e.isAuto);this.setTitle(e.title,e.isAuto,null)}},e.prototype.setTitleForDoc=function(e,t){var n=e;0===n.length&&(n=this.getDefaultTitle()),(0,s.Yi)().padTitle!==n?this.setTitle(n,!1,(function(e){e&&0===e.retcode&&(null==t||t(e))})):this.setTitleToStore(n)},e.prototype.verifyTitle=function(e){var t=!new RegExp(I,"g").exec(e);return t||l.default.show({message:k,duration:2e3,autoClose:!0}),t},e.prototype.autoUpdateTitle=function(e){var t=this,n=(0,s.Yi)();if(1!==n.isUserChangeTitle)if(this.verifyTitle(e)){var r=this.readTitleFromStorage();if(!r||r.isAuto){var i=n.padTitle||this.getDefaultTitle();if(this.contextService.context.editor instanceof o.MeloEditor){var a=e.replace(/(:|\*|\\|\/|<|>|"|\?|\|)/gi,"");a.length>c.y.MAX_TITLE_LENGTH&&(a=a.substr(0,c.y.MAX_TITLE_LENGTH)),0===a.length&&(a=this.getDefaultTitle()),n.padTitle!==a?this.setTitle(a,!0,(function(e){e&&0===e.retcode||12e3===e.retcode&&(h.Logger.error("TitleService.setTitle Set title failed: ".concat(e)),t.restoreOriginalTitle(i))})):h.Logger.info("autoUpdateTitle condition [padTitle equal]")}else h.Logger.info("autoUpdateTitle condition [MeloEditor]")}else h.Logger.info("autoUpdateTitle condition [readTitleFromStorage]")}else h.Logger.info("autoUpdateTitle condition [title has illegal chars]");else h.Logger.info("autoUpdateTitle condition [IS_CAN_NOT_AUTO_CHANGE]")},e.prototype.needShowRenameTip=function(){var e=(0,s.Yi)();return(Number(h.LocalStorageUtil.getItem("auto_title_tips_".concat(e.padId)))||0)<1},e.prototype.getDefaultTitle=function(){return(0,a.$t)("无标题文档")},e.prototype.getDataHelper=function(){return window.App&&window.App.GlobalConfig.IsSupportStore?window.offlineDataHelperInstance:null},e.prototype._offlineSyncTitle=function(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,n;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return e&&(t=this.getDataHelper())?(n=(0,s.Yi)(),[4,t.handleOfflineTitleChange(e,n)]):[2];case 1:return r.sent(),[2]}}))}))},e.prototype.updateLocalClientVarsTitle=function(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,o;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return(n=this.getDataHelper())?(o=(0,s.Yi)(),t||(o.isUserChangeTitle=1),o.padTitle=e,o.title=e,[4,n.updateClientVars(o)]):[2];case 1:return r.sent(),[2]}}))}))},e.prototype.setTitle=function(e,t,n){var r=this,o=(0,s.Yi)(),a=o.padTitle||this.getDefaultTitle();if(this.persistTitleToStorage(e,t),this.autoNamedId&&clearTimeout(this.autoNamedId),this.setTitleToStore(e),this._offlineSyncTitle(e),o.padStatus===s.DL.NORMAL){(0,m.GI)("MODIFY",{domainId:o.domainId,localPadId:o.localPadId,title:e,actiontoserver:1}),this.eventEmitter.emit(i.zW.TITLE_CHANGE,e);var u=t?200:0;this.autoNamedId=setTimeout((function(){h.Logger.info("TitleService.setTitle Set title to: ".concat(e,", isAuto: ").concat(t)),c.y.setTitle(e,t,o,(function(o){var i={originalTitle:a,title:e,isAuto:t};o&&0===o.retcode?r.setTitleSuccess(o,i):(10020===o.retcode&&t?r.persistTitleToStorage("",t):12e3===o.retcode&&l.default.show({message:"标题不合规，请重新命名。",duration:2e3,autoClose:!0}),h.Logger.error("TitleService.setTitle Set title failed: ".concat(o)),r.restoreOriginalTitle(a)),n&&n(o)})).catch((function(e){h.Logger.error(e)}))}),u)}else h.Logger.info("Cant set title for doc that not yet created.")},e.prototype.setTitleSuccess=function(e,t){var n,r,o,i=e.doc_info,a=i.title_sort_priority,c=i.title_sort_value,l=(0,s.Yi)(),u="modify",d="automatic_fill",p="fill",f="modify_title";this.eventEmitter.emit("titleChanged",t.title),o=t.originalTitle?u:t.isAuto?d:p,this.dataReport({opername:"doc_word_editor",module:"doc_title",action:o,obj2:l.padTitle}),null===(r=null===(n=window.tdocs)||void 0===n?void 0:n.setTitle)||void 0===r||r.call(n,{title:t.title});try{this.updateLocalClientVarsTitle(t.title,t.isAuto),(0,m.GI)("MODIFY",{domainId:l.domainId,localPadId:l.padId,title:t.title,actiontoserver:0,title_sort_priority:a,title_sort_value:c});var _=h.LocalStorageUtil.getItem("tdsourcetag")||"";this.dataReport({opername:"doc_core",module:"edit",action:f,source3:_}),this.persistTitleToStorage("",t.isAuto)}catch(e){h.Logger.error("TitleService failed: ".concat(e))}},e.prototype.dataReport=function(e){var t,n=1===(null===(t=(0,s.Yi)().collab_client_vars)||void 0===t?void 0:t.dirty)?"limited":"normal",i=(0,r.__assign)({obj3:h.PlatformUtil.getBrowser(),ver5:n},e);o.ReportHelper.tdwReport(i)},e.prototype.persistTitleToStorage=function(e,t){var n=this.generateOfflineTitleKey();if(h.Logger.info("Set title to: ".concat(e,", isAuto: ").concat(t,", key: ").concat(n)),e){var r={title:e,isAuto:t};h.LocalStorageUtil.setItem(n,JSON.stringify(r))}else h.LocalStorageUtil.removeItem(n)},e.prototype.readTitleFromStorage=function(){var e=h.LocalStorageUtil.getItem(this.generateOfflineTitleKey());return e?JSON.parse(e):null},e.prototype.generateOfflineTitleKey=function(){var e=(0,s.Yi)().collab_client_vars.client.upid;return"offline_title_".concat(e)},e.prototype.setTitleToStore=function(e){this.store.upsert("docTitle",e)},e.prototype.getTitleFromStore=function(){var e=this.store.getValue("docTitle");return e||""},e.prototype.setTitleToNativeTitlebar=function(t){try{h.Logger.info("Set title to native: ".concat(t)),document.title=t;var n=(0,s.Yi)();n.padTitle=t,n.title=t,T.setShareInfo({},n),e.shareTitle(t)}catch(e){h.Logger.log("failed set title to mobile titlebar")}},e.shareTitle=function(e){var t,n,r;x.kE||(h.PlatformUtil.isWXMiniProgram()?null===(n=null===(t=window.wx)||void 0===t?void 0:t.miniProgram)||void 0===n||n.postMessage({data:{title:e}}):null===(r=window.mqq)||void 0===r||r.invoke("ui","setWebviewNaviTitle",{title:e,refreshDocList:!0,url:window.location.href}))},e.isIpadTencentDocsApp=function(){return!1},e.prototype.restoreOriginalTitle=function(e){(0,s.Yi)().padTitle=e,this.setTitleToStore(e),this.setTitleToNativeTitlebar(e),this.persistTitleToStorage(e,!0)},e.prototype.updateDocInitTitle=function(){var e=(0,s.Yi)().padTitle||(0,a.$t)("无标题文档"),t=this.readTitleFromStorage();h.Logger.info("Get title: ".concat(e,", local title: ").concat(t?t.title:"")),e=t&&t.title?t.title:e,this.setTitleToStore(e);var n=this.store.get("docTitle");this.pcNativeSubscription=n.subscribe((function(e){document.title=e||(0,a.$t)("无标题文档")})),this.setListPageTitle()},e.prototype.setListPageTitle=function(){var e=h.LocalStorageUtil.getItem(this.generateOfflineTitleKey());if(e){var t;try{t=JSON.parse(e)}catch(e){h.Logger.error("title parse error, titleInfo: ".concat(t))}this.autoUpdateTitle(t.title)}},e.prototype.destroy=function(){this.autoNamedId&&clearTimeout(this.autoNamedId),this.pcNativeSubscription&&this.pcNativeSubscription.unsubscribe()},(0,r.__decorate)([(0,d.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==p.O&&p.O)?t:Object)],e.prototype,"store",void 0),(0,r.__decorate)([(0,d.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==f.O&&f.O)?n:Object)],e.prototype,"contextService",void 0),(0,r.__decorate)([(0,d.tB)(),(0,r.__metadata)("design:type","function"==typeof(g=void 0!==_.v&&_.v)?g:Object)],e.prototype,"eventEmitter",void 0),e}()),A=function(){function e(){}return e.getInstance=function(){return e.instance||(e.instance=x.kE?d.Am.get(S.a):new R),e.instance},e}()},41696:function(e,t,n){n.r(t),n.d(t,{ITitleMobileFeature:function(){return c}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=n(38429),c=Symbol.for("feature:".concat(i.C.TitleMobile));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(1727).then(n.bind(n,4748))];case 1:return[2,e.sent().TitleMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:c,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!s.kE})})},57280:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(85556),o=n(87363),i=n(61052),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props.type||"default",n=this.props.align||"left";return o.createElement("div",{className:"guide-tip-container"},o.createElement(i.Z,{in:this.props.show,timeout:800,classNames:"guide-ripple",unmountOnExit:!0},o.createElement("div",{className:"guide-tip-ripple"})),this.props.children,o.createElement(i.Z,{in:this.props.show,timeout:800,classNames:"guide-tip-fade",unmountOnExit:!0},o.createElement("div",{className:"guide-tip-animation-container ".concat(t)},o.createElement("div",{className:"guide-tip-triangle"}),o.createElement("div",{className:"guide-tip-wrapper ".concat(this.props.className||""," ").concat(n)},o.createElement("div",{className:"guide-tip-content ".concat(this.props.contentClassName||"")},this.props.content),o.createElement("div",{className:"guide-tip-button ".concat(this.props.buttonClassName||""),onClick:function(t){e.props.buttonClk&&e.props.buttonClk(t)}},this.props.button||"")))))},t}(o.Component),s=a},31087:function(e,t,n){n.d(t,{E:function(){return V}});var r=n(85556),o=n(61533),i=n.n(o),a=n(68656),s=n(77947),c=n(22595),l=n(87363),u=n.n(l),d="header-container--Pv-Zi",p="mobile-titlebar-title--VJw40",f="mobile-titlebar-collab--fhQp3",_="mobile-titlebar-tob-collab--Wmcf8",h="header-container-show--gVWtm",m="header-container-hide--TVYyQ",g="header-container-up--6FJ0q",v="left--RRPuF",b="left-pad-app--jwKsV",y="right--tKPXG",w=n(99779),E=n(2613),C=n(52747),T=n(3139),x=n(42035),S=n(57280),I=n(58433),k=n(63357),R=n(86667),A=n.n(R),O=n(47433),L=n(27379),M=n(67921),N=n(14740),D=n(35205),P=function(e){function t(t){var n=e.call(this,t)||this;return n.unsubscribe$=new k.xQ,n.state={tipsProps:{}},A().isWeChat&&n.initJumpAppBox(),n}var n,o,i,a;return(0,r.__extends)(t,e),t.prototype.initJumpAppBox=function(){var e;return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return null===(e=this.scriptLoader.getScriptLoader())||void 0===e||e.load("JumpAppMobile",(function(e){var t,n;e.show({url:window.location.href,corpId:null===(n=null===(t=window.clientVars)||void 0===t?void 0:t.userInfo)||void 0===n?void 0:n.corpId})})),[2]}))}))},t.prototype.componentDidMount=function(){var e=this;this.store.get("tipsProps").pipe((0,I.R)(this.unsubscribe$)).subscribe((function(t){e.setState({tipsProps:t})}));var t=this.eventEmitter.listen("$featureLoaded",(function(){e.forceUpdate(),t.unsubscribe()}))},t.prototype.render=function(){if(window.isPublishedURL)return null;var e=this.state.tipsProps,t=this.context.isFeatureLoaded;return u().createElement("div",null,!(0,L.isLogin)()&&t&&u().createElement(S.Z,(0,r.__assign)({show:e.showRightTips},e.rightTipProps),u().createElement(M.Button,{style:{fontSize:"16px",marginRight:"-8px"},onClick:this.loginService.login},(0,N.$t)("登录腾讯文档"))))},t.contextType=C.FN,(0,r.__decorate)([(0,T.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==s.O&&s.O)?n:Object)],t.prototype,"store",void 0),(0,r.__decorate)([(0,T.tB)(),(0,r.__metadata)("design:type","function"==typeof(o=void 0!==x.v&&x.v)?o:Object)],t.prototype,"eventEmitter",void 0),(0,r.__decorate)([(0,T.tB)(),(0,r.__metadata)("design:type","function"==typeof(i=void 0!==O.$&&O.$)?i:Object)],t.prototype,"scriptLoader",void 0),(0,r.__decorate)([(0,T.tB)(),(0,r.__metadata)("design:type","function"==typeof(a=void 0!==D.r&&D.r)?a:Object)],t.prototype,"loginService",void 0),t}(l.PureComponent),F=n(30479),B=n(83292),U=n(47605),H=n(50263),j=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isFirstRender=!0,t.rootRef=u().createRef(),t.onTouchEnd=function(e){var t;e.preventDefault(),null===(t=e.target)||void 0===t||t.click()},t}return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){var e;this.isFirstRender=!1,H.A.closeLoadingInEdit(),null===(e=this.rootRef.current)||void 0===e||e.addEventListener("touchend",this.onTouchEnd,!1)},t.prototype.componentWillUnmount=function(){var e;null===(e=this.rootRef.current)||void 0===e||e.removeEventListener("touchend",this.onTouchEnd,!1)},t.prototype.matchClassName=function(){var e=[d],t=[v],n=m;return!1!==this.props.showMobileTitlebar&&(n=h),e.push(n),this.props.mobileTitlebarUp&&e.push(g),F.PlatformUtil.isTencentDocsIPadApp()&&t.push(b),{wrapperClass:e,left:t}},t.prototype.render=function(){var e=this.matchClassName().wrapperClass.join(" ");return!(0,F.supportNativeTitleBar)("doc")&&this.shouldShowTitlebar&&(0,U.NJ)()?(this.isFirstRender&&F.PlatformUtil.isWXorQQMiniProgram()&&(e=d),E.ReportHelper.tdwReport({opername:"doc_editor_topbar_pc",module:"more_menu",action:"view"}),u().createElement("div",{className:e,ref:this.rootRef,style:{display:this.isFirstRender&&!this.shouldFirstShowTitlebar?"none":"flex"}},u().createElement("div",{className:this.matchClassName().left.join(" ")},u().createElement("div",{id:"mobile-titlebar-home"}),u().createElement("div",{id:"mobile-titlebar-done"}),u().createElement("div",{id:"mobile-titlebar-title",className:p}),u().createElement("div",{id:"mobile-titlebar-collab",className:f}),u().createElement("div",{id:"mobile-titlebar-offline"})),u().createElement("div",{className:y},u().createElement("div",{id:"mobile-titlebar-certification-tips"}),u().createElement("div",{id:"mobile-titlebar-star"}),u().createElement("div",{id:"mobile-titlebar-ent-collab"}),u().createElement("div",{id:"mobile-titlebar-tob-collab",className:_}),u().createElement("div",{id:"mobile-titlebar-web-share"}),u().createElement("div",{id:"mobile-titlebar-share"}),u().createElement("div",{id:"mobile-titlebar-undo"}),u().createElement("div",{id:"mobile-titlebar-redo"}),u().createElement("div",{id:"mobile-titlebar-more-menu"}),u().createElement(P,null)))):null},t.flagMap={"mobile-titlebar-home":"home","mobile-titlebar-done":"done","mobile-titlebar-title":"title","mobile-titlebar-collab":"collaborators","mobile-titlebar-offline":"manual_offline","mobile-titlebar-star":"collect","mobile-titlebar-web-share":"share_web","mobile-titlebar-share":"share","mobile-titlebar-undo":"undo","mobile-titlebar-redo":"redo","mobile-titlebar-more-menu":"moreMenu","mobile-titlebar-certification-tips":"certification"},(0,r.__decorate)([(0,B.D)("common.titlebar",!0),(0,r.__metadata)("design:type",Boolean)],t.prototype,"shouldShowTitlebar",void 0),(0,r.__decorate)([(0,B.D)("feature.titlebar_mobile.read_titlebar",!0),(0,r.__metadata)("design:type",Boolean)],t.prototype,"shouldFirstShowTitlebar",void 0),t}(u().PureComponent),W=((0,w.x)(["showMobileTitlebar","mobileTitlebarUp"])(j),n(98859)),V=function(){function e(e,t){this.store=e,this.configService=t,this.store.register("tipsProps",{}),(0,F.supportNativeTitleBar)("doc")?(this.store.register("showMobileTitlebar",!1),this.store.register("showMobileNativeTitlebar",!0)):(this.store.register("showMobileTitlebar",!0),this.store.register("showMobileNativeTitlebar",!1)),this.store.register("mobileTitlebarUp",!1)}var t,n;return e.prototype.hydrate=function(e,t){var n=document.getElementById(e),r=j.flagMap[e],o=!0;r&&!this.configService.get("common.titlebar_mobile.".concat(r))&&(o=!1),n&&o?i().render(t,n):n&&!o&&n.remove()},e.prototype.deHydrate=function(e){var t=document.getElementById(e);t&&i().unmountComponentAtNode(t)},e.prototype.show=function(e){var t=document.getElementById(e),n=j.flagMap[e],r=!0;n&&!this.configService.get("common.titlebar_mobile.".concat(n))&&(r=!1),t&&r&&(t.style.display="block")},e.prototype.hide=function(e){var t=document.getElementById(e);t&&(t.style.display="none")},e=(0,r.__decorate)([(0,a.L)({name:c.C.TitlebarMobile,adapters:["melo"]}),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==s.O&&s.O)?t:Object,"function"==typeof(n=void 0!==W.ax&&W.ax)?n:Object])],e)}()},85827:function(e,t,n){n.r(t),n.d(t,{IToolbarFeature:function(){return a}});var r=n(85556),o=n(3139),i=n(22595),a=Symbol.for("feature:".concat(i.C.Toolbar));o.Ln.merge(a,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9499).then(n.bind(n,49499))];case 1:return[2,e.sent().ToolbarHandler]}}))}))}})},80178:function(e,t,n){n.r(t),n.d(t,{ITranslateFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.Translate));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8487),n.e(8937),n.e(866),n.e(2644),n.e(5218),n.e(3152),n.e(9445)]).then(n.bind(n,46064))];case 1:return[2,e.sent().TranslateHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level4],key:s,platforms:[a.Ev.Pc]})})},96432:function(e,t,n){n.r(t),n.d(t,{IUnreadNotifyHandler:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.UnreadNotify));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8487),n.e(8937),n.e(866),n.e(2644),n.e(5218),n.e(3152),n.e(9445)]).then(n.bind(n,34174))];case 1:return[2,e.sent().UnreadNotifyHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level4],key:s,platforms:[a.Ev.Pc]})})},22971:function(e,t,n){n.r(t),n.d(t,{IUpdateNoticeFeature:function(){return c},getUpdateNoticeUrl:function(){return l}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=n(76343),c=Symbol.for("feature:".concat(i.C.UpdateNotice));function l(){return s.v.getQuery("u_n_source")}o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(40).then(n.bind(n,94748))];case 1:return[2,e.sent().UpdateNoticeHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level4],key:c,platforms:[a.Ev.Pc],load:!!l()})})},3205:function(e,t,n){n.r(t),n.d(t,{IVipFeature:function(){return s}});var r=n(85556),o=(n(30479),n(3139)),i=n(54541),a=n(22595),s=Symbol.for("feature:".concat(a.C.Vip));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8487),n.e(8937),n.e(866),n.e(2644),n.e(5218),n.e(3152),n.e(9445)]).then(n.bind(n,48743))];case 1:return[2,e.sent().VipHandler]}}))}))},on:i.iz.On({key:s,stages:[i.YV.Level4],load:!0})})},83023:function(e,t,n){n.r(t),n.d(t,{IVisibilityChangeMobileFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.VisibilityChangeMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(5434).then(n.bind(n,49002))];case 1:return[2,e.sent().VisibilityChangeMobileHandler]}}))}))},on:a.iz.On({key:s,stages:[a.YV.Level3],platforms:[a.Ev.Mobile]})})},34566:function(e,t,n){n.r(t),n.d(t,{IVoiceInputFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.VoiceInput));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(2826).then(n.bind(n,41401))];case 1:return[2,e.sent().VoiceInputHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},33497:function(e,t,n){n.r(t),n.d(t,{IZoomMobileFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.ZoomMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(5511).then(n.bind(n,30676))];case 1:return[2,e.sent().ZoomMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},31501:function(e,t,n){n.r(t),n.d(t,{ZoomPcHandler:function(){return w}});var r=n(85556),o=n(17270),i=n(4211),a=n(68656),s=n(42035),c=n(77947),l=n(22595),u=n(87302),d=n(57641),p=n(50554),f=n(65419),_=n(83292),h=n(96925),m=n(30479),g=m.PlatformUtil.isWeWork()?220:216,v=m.PlatformUtil.isWeWork()?220:260,b=m.PlatformUtil.isWeWork()?220:280,y=30,w=function(){function e(e,t,n){var r=this;this.zoomBaseHandler=e,this.eventEmitter=t,this.store=n,this.enable=!0,this.customWheelZoom=!0,this.customShortCutZoom=!0,this.isPresentationShow=!1,this.ticking=!1,this.$subs=[],this.handleDrawer=function(){var e=document.getElementsByClassName(u.Z["zoomable-content"]);e&&!r.ticking&&(window.requestAnimationFrame((function(){r.ticking=!1;var t=0,n=0;Array.from(e).forEach((function(e){var r=e.getBoundingClientRect().width,o=e.getBoundingClientRect().height;r&&o&&(t+=r,n+=1)}));var o=r.store.getValue(i.j.EditorZoneMarginRight)||0,a=r.zoomBaseHandler.paddings.get(r.getCurrentSurfaceId())||0,s=(document.body.clientWidth-t-o-a)/2;if(s<g+y){r.updateLeftDrawerStyles(g,g);var c=Math.max(s,g+y);r.updateZommablePosition(c,"Left",n)}else s<b+y?(r.updateLeftDrawerStyles(s-y,s-y),r.updateZommablePosition(s,"Center",n)):(r.updateLeftDrawerStyles(v,s),r.updateZommablePosition(s+y,"Center",n))})),r.ticking=!0)},this.getCurrentSurfaceId=function(){return r.store.getValue("rootEditor")},this.$subs.push(this.store.get(i.j.LeftDrawerOpened).subscribe(this.handleDrawer)),this.$subs.push(this.store.get(i.j.RightDrawerOpened).subscribe(this.handleDrawer)),this.store.register("translateOpened",!1);var o=this.store.get("translateOpened");this.$subs.push(null==o?void 0:o.subscribe((function(){setTimeout((function(){return r.handleDrawer()}),0)}))),this.$subs.push(this.eventEmitter.listen("$editorSizeChanged",(function(){setTimeout((function(){return r.handleDrawer()}),0)}))),this.$subs.push(this.eventEmitter.listen("$presentationShow",(function(e){r.isPresentationShow=e}))),this.$subs.push(this.store.get("zoomLevel").subscribe((function(){setTimeout((function(){return r.handleDrawer()}),0)}))),this.$subs.push((0,d.R)(window,"resize").pipe((0,f.p)(0,p.Z)).subscribe((function(){r.isPresentationShow||r.handleDrawer()})))}var t,n,m;return e.prototype.$onEditorClose=function(){this.$subs.forEach((function(e){return null==e?void 0:e.unsubscribe()}))},e.prototype.setZoomLevel=function(e,t){void 0===t&&(t=!1),this.enable&&this.zoomBaseHandler.setZoomLevel(e,t)},e.prototype.setAlign=function(e,t){this.zoomBaseHandler.setAlign(e,t)},e.prototype.setLeftMargin=function(e,t){this.zoomBaseHandler.setLeftMargin(e,t)},e.prototype.updateLeftDrawerStyles=function(e,t){var n=this.store.getValue(i.j.LeftDrawerInfo),o=null==n?void 0:n.style,a=(0,r.__assign)((0,r.__assign)({},o),{minWidth:"".concat(Math.max(Math.min(e,b),g),"px"),maxWidth:"".concat(Math.min(Math.max(t,g),b),"px")});this.store.update(i.j.LeftDrawerInfo,(0,r.__assign)((0,r.__assign)({},n),{style:a}))},e.prototype.updateZommablePosition=function(e,t,n){var r=this.store.getValue(i.j.LeftDrawerOpened);if(n&&n>1)return this.setLeftMargin(this.getCurrentSurfaceId(),r?e:0),void this.setAlign(this.getCurrentSurfaceId(),r?"Left":"Right");r?(this.setLeftMargin(this.getCurrentSurfaceId(),e),this.setAlign(this.getCurrentSurfaceId(),t)):this.setAlign(this.getCurrentSurfaceId(),"Center")},Object.defineProperty(e.prototype,"enableWheelZoom",{get:function(){return this.enable&&this._enableWheelZoom&&this.customWheelZoom},set:function(e){this.customWheelZoom=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableShortCutZoom",{get:function(){return this.enable&&this.customShortCutZoom},set:function(e){this.customShortCutZoom=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableZoom",{get:function(){return this.enable},enumerable:!1,configurable:!0}),e.prototype.turnOn=function(){this.enable=!0},e.prototype.turnOff=function(){this.enable=!1},(0,r.__decorate)([(0,_.D)("feature.zoom_pc.wheel",!0),(0,r.__metadata)("design:type",Boolean)],e.prototype,"_enableWheelZoom",void 0),e=(0,r.__decorate)([(0,a.L)({name:l.C.ZoomPc,provide:h.IZoomPcFeature}),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==o.ZoomBaseHandler&&o.ZoomBaseHandler)?t:Object,"function"==typeof(n=void 0!==s.v&&s.v)?n:Object,"function"==typeof(m=void 0!==c.O&&c.O)?m:Object])],e)}()},14809:function(e,t,n){n.r(t),n.d(t,{IAutoFocusFeature:function(){return l}});var r,o,i=n(85556),a=n(3139),s=n(54541),c=n(22595),l=Symbol.for("feature:".concat(c.C.TdocsAutoFocus));a.Ln.merge(l,{useFactory:function(){return(0,i.__awaiter)(void 0,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(7556).then(n.bind(n,97388))];case 1:return[2,e.sent().AutoFocusHandler]}}))}))},on:s.iz.On({key:l,stages:[s.YV.Level1],platforms:[s.Ev.Mobile,s.Ev.Pad],load:null!==(o=null===(r=window.editableWhenCreateState)||void 0===r?void 0:r.editableWhenCreate)&&void 0!==o&&o})})},34584:function(e,t,n){n.r(t),n.d(t,{IFollowLineButtonsFeature:function(){return s}});var r=n(85556),o=(n(30479),n(3139)),i=n(54541),a=n(22595),s=Symbol.for("feature:".concat(a.C.TdocsFollowLineButtons));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8937),n.e(9714),n.e(7411),n.e(5218),n.e(6952),n.e(7131)]).then(n.bind(n,96371))];case 1:return[2,e.sent().FollowLineButtonsHandler]}}))}))},on:i.iz.On({key:s,stages:[i.YV.Level3],platforms:[i.Ev.Pc],load:!0})})},37404:function(e,t,n){n.r(t),n.d(t,{IApiDocEntFeature:function(){return s}});var r=n(85556),o=(n(30479),n(3139)),i=n(54541),a=n(22595),s=Symbol.for("feature:".concat(a.C.ApiDocEnt));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(7379).then(n.bind(n,48478))];case 1:return[2,e.sent().ApiDocEntHandler]}}))}))},on:i.iz.On({key:s,stages:[i.YV.Level2],platforms:[i.Ev.Pc],load:!1})})},54273:function(e,t,n){n.r(t),n.d(t,{IApiDocEntMobileFeature:function(){return s}});var r=n(85556),o=(n(30479),n(3139)),i=n(54541),a=n(22595),s=Symbol.for("feature:".concat(a.C.ApiDocEntMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(5627).then(n.bind(n,72642))];case 1:return[2,e.sent().ApiDocEntMobileHandler]}}))}))},on:i.iz.On({key:s,stages:[i.YV.Level2],platforms:[i.Ev.Mobile,i.Ev.Pad],load:!1})})},14634:function(e,t,n){n.r(t),n.d(t,{IAtRecordScrollFeature:function(){return s}});var r=n(85556),o=n(3139),i=(n(30479),n(22595)),a=n(54541),s=Symbol.for("feature:".concat(i.C.AtRecordScroll));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(8491).then(n.bind(n,79493))];case 1:return[2,e.sent().AtRecordScrollHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,load:!1})})},5438:function(e,t,n){n.r(t),n.d(t,{ICollabStatusEntMobileFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.CollabStatusEntMobile)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(33),n.e(5530)]).then(n.bind(n,27604))];case 1:return[2,e.sent().CollabStatusEntMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!1})})},69739:function(e,t,n){n.r(t),n.d(t,{ICommentEntFeature:function(){return s}});var r=n(85556),o=(n(30479),n(3139)),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.CommentEnt));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8487),n.e(9039),n.e(5480),n.e(2272)]).then(n.bind(n,70386))];case 1:return[2,e.sent().CommentEntHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,load:!1})})},8020:function(e,t,n){n.r(t),n.d(t,{ICommentEntMobileFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.CommentEntMobile)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(33),n.e(5446)]).then(n.bind(n,86457))];case 1:return[2,e.sent().CommentEntMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!1})})},30620:function(e,t,n){n.r(t),n.d(t,{ICommentEntPcFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.CommentEntPc)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(5121).then(n.bind(n,99425))];case 1:return[2,e.sent().CommentEntPcHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Pc],load:!1})})},7576:function(e,t,n){n.r(t),n.d(t,{IWedocsDiscussFeature:function(){return s}});var r=n(85556),o=n(3139),i=(n(30479),n(22595)),a=n(54541),s=Symbol.for("feature:".concat(i.C.WedocsDiscuss));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(2961).then(n.bind(n,64195))];case 1:return[2,e.sent().WedocsDiscussHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Pc],load:!1})})},56684:function(e,t,n){n.r(t),n.d(t,{IDiscussionEntFeature:function(){return s}});var r=n(85556),o=n(3139),i=(n(30479),n(22595)),a=n(54541),s=Symbol.for("feature:".concat(i.C.DiscussionEnt));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(5622).then(n.bind(n,62302))];case 1:return[2,e.sent().DiscussionEntHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Pc],load:!1})})},65972:function(e,t,n){n.r(t),n.d(t,{IDiscussionEntMobileFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.DiscussionEntMobile)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(33),n.e(8021)]).then(n.bind(n,91327))];case 1:return[2,e.sent().DiscussionEntMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!1})})},5070:function(e,t,n){n.r(t),n.d(t,{IFieldcodeWeixinMentionFeature:function(){return s}});var r=n(85556),o=n(22595),i=n(3139),a=(n(30479),n(54541)),s=Symbol.for("feature:".concat(o.C.FieldcodeWeixinMention));i.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(33),n.e(8176)]).then(n.bind(n,43372))];case 1:return[2,e.sent().FieldcodeWeixinMentionHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,load:!1})})},36506:function(e,t,n){n.r(t),n.d(t,{IFieldcodeWxworkAppFeature:function(){return a}});var r=n(85556),o=n(3139),i=n(22595),a=Symbol.for("feature:".concat(i.C.WxworkApp));o.Ln.merge(a,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(7547).then(n.bind(n,84936))];case 1:return[2,e.sent().FieldcodeWxworkAppHandler]}}))}))}})},12325:function(e,t,n){n.r(t),n.d(t,{IFieldcodeWxworkCalenderFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.WxworkCalender)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9587).then(n.bind(n,24476))];case 1:return[2,e.sent().FieldcodeWxworkCalenderHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2,a.YV.Publish],key:s,load:!1})})},85956:function(e,t,n){n.r(t),n.d(t,{IFieldcodeWxworkColdStartButtonFeature:function(){return a}});var r=n(85556),o=n(3139),i=n(22595),a=Symbol.for("feature:".concat(i.C.WxworkColdStartButton));o.Ln.merge(a,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(8117).then(n.bind(n,62730))];case 1:return[2,e.sent().FieldcodeWxworkColdStartButtonHandler]}}))}))}})},56936:function(e,t,n){n.r(t),n.d(t,{IFieldcodeWxworkGroupChatFeature:function(){return s}});var r=n(85556),o=(n(30479),n(22595)),i=n(3139),a=n(54541),s=Symbol.for("feature:".concat(o.C.WxworkGroupChat));i.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(8292).then(n.bind(n,34084))];case 1:return[2,e.sent().FieldcodeWxworkGroupChatHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,load:!1})})},15091:function(e,t,n){n.r(t),n.d(t,{IFieldcodeWxworkGroupContactCardFeature:function(){return a}});var r=n(85556),o=n(3139),i=n(22595),a=Symbol.for("feature:".concat(i.C.WxworkGroupContactCard));o.Ln.merge(a,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9746).then(n.bind(n,80437))];case 1:return[2,e.sent().FieldcodeWxworkGroupContactCardHandler]}}))}))}})},15375:function(e,t,n){n.r(t),n.d(t,{IFieldcodeWxworkMeetingFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.WxworkMeeting)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(8718).then(n.bind(n,17375))];case 1:return[2,e.sent().FieldcodeWxworkMeetingHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2,a.YV.Publish],key:s,load:!1})})},57861:function(e,t,n){n.r(t),n.d(t,{IFieldcodeWxworkMemberContactCardFeature:function(){return a}});var r=n(85556),o=n(3139),i=n(22595),a=Symbol.for("feature:".concat(i.C.WxworkMemberContactCard));o.Ln.merge(a,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(4323).then(n.bind(n,30305))];case 1:return[2,e.sent().FieldcodeWxworkMemberContactCardHandler]}}))}))}})},9277:function(e,t,n){n.r(t),n.d(t,{IListQwxTodoFeature:function(){return s}});var r=n(85556),o=n(3139),i=(n(30479),n(22595)),a=n(54541),s=Symbol.for("feature:".concat(i.C.ListQwxTodo));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9182).then(n.bind(n,11767))];case 1:return[2,e.sent().ListQwxTodoHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,load:!1})})},70723:function(e,t,n){var r,o,i;n.d(t,{hw:function(){return r},wL:function(){return i}}),function(e){e[e.kToDoList=0]="kToDoList",e[e.kToDoUpdate=1]="kToDoUpdate",e[e.kToDoCreateOrModify=2]="kToDoCreateOrModify",e[e.kToDoUpdateTodoStatus=3]="kToDoUpdateTodoStatus"}(r||(r={})),function(e){e[e.kToDoUserUnFinished=0]="kToDoUserUnFinished",e[e.kToDoUserFinished=1]="kToDoUserFinished",e[e.kToDoUserREJECT=2]="kToDoUserREJECT"}(o||(o={})),function(e){e[e.UNDONE=0]="UNDONE",e[e.DONE=1]="DONE",e[e.DELETE=2]="DELETE"}(i||(i={}))},14517:function(e,t,n){n.d(t,{U:function(){return a},o:function(){return r}});var r,o=n(85556),i=n(30479);!function(e){e.ON_UPDATE="api_list_todo_update"}(r||(r={}));var a=function(e){function t(t){var n=e.call(this,r.ON_UPDATE)||this;return n.todoItem=t,n}return(0,o.__extends)(t,e),t}(i.Notification)},17798:function(e,t,n){n.r(t),n.d(t,{IMiniListEntFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(54541),a=n(22595),s=(n(30479),Symbol.for("feature:".concat(a.C.MiniListEnt)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(4785).then(n.bind(n,86716))];case 1:return[2,e.sent().MiniListHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level2],key:s,platforms:[i.Ev.Pc],load:!1})})},46590:function(e,t,n){n.r(t),n.d(t,{IMobileTipsFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=Symbol.for("feature:".concat(i.C.MobileTips));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(1168),n.e(2026)]).then(n.bind(n,65843))];case 1:return[2,e.sent().MobileTipsHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},79620:function(e,t,n){n.r(t),n.d(t,{IMoveFileFeature:function(){return s}});var r=n(85556),o=(n(30479),n(3139)),i=n(54541),a=n(22595),s=Symbol.for("feature:".concat(a.C.TitlebarMoveFile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(7538).then(n.bind(n,53010))];case 1:return[2,e.sent().MoveFileHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level2],key:s,platforms:[i.Ev.Pc],load:!1})})},25159:function(e,t,n){n.r(t),n.d(t,{IPreloadPreviewImageFeature:function(){return c},PreloadPreviewImagePriority:function(){return r}});var r,o=n(85556),i=n(3139),a=n(22595),s=n(54541),c=(n(30479),Symbol.for("feature:".concat(a.C.PreloadPreviewImage)));!function(e){e.high="high",e.medium="medium",e.default="default"}(r||(r={})),i.Ln.merge(c,{useFactory:function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(8546).then(n.bind(n,22386))];case 1:return[2,e.sent().PreloadPreviewImageHandler]}}))}))},on:s.iz.On({stages:[s.YV.Level2],platforms:[s.Ev.Mobile],key:c,load:!1})})},15578:function(e,t,n){n.r(t),n.d(t,{IQuoteBaseFeature:function(){return s}});var r=n(85556),o=(n(30479),n(3139)),i=n(54541),a=n(22595),s=Symbol.for("feature:".concat(a.C.QuoteBase));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(317).then(n.bind(n,44885))];case 1:return[2,e.sent().QuoteBaseHandler]}}))}))},on:i.iz.On({key:s,load:!1,stages:[i.YV.Level2]})})},30490:function(e,t,n){n.r(t),n.d(t,{ITitlebarCollectFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.TitlebarCollect)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(4571).then(n.bind(n,36642))];case 1:return[2,e.sent().TitlebarCollectHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Pc],load:!1})})},49626:function(e,t,n){n.r(t),n.d(t,{ITobReadonlyTipsFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.TobReadonlyTips)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9553).then(n.bind(n,33721))];case 1:return[2,e.sent().TobReadonlyTipsHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,load:!1})})},3846:function(e,t,n){n.r(t),n.d(t,{ITobRecentInputTextHandler:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.TobRecentInputText)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(4563).then(n.bind(n,16691))];case 1:return[2,e.sent().TobRecentInputTextHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Pc],load:!1})})},63613:function(e,t,n){n.r(t),n.d(t,{IUserAvatarFeature:function(){return c}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=n(85464),c=Symbol.for("feature:".concat(i.C.UserAvatar));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9725).then(n.bind(n,66534))];case 1:return[2,e.sent().UserAvatarHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:c,platforms:[a.Ev.Pc],load:!s.W.isWeWortkDiscussionDoc})})},86576:function(e,t,n){n.r(t),n.d(t,{IWedocsProcessonFeature:function(){return s}});var r=n(85556),o=n(3139),i=(n(30479),n(54541)),a=n(22595),s=Symbol.for("feature:".concat(a.C.WedocsProcesson));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(243).then(n.bind(n,93068))];case 1:return[2,e.sent().WedocsProcessonHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level2],key:s,load:!1})})},60364:function(e,t,n){n.r(t),n.d(t,{IWxworkFollowLineButtonsFeature:function(){return s}});var r=n(85556),o=n(3139),i=(n(30479),n(22595)),a=n(54541),s=Symbol.for("feature:".concat(i.C.WxworkFollowLineButtons));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9543).then(n.bind(n,99607))];case 1:return[2,e.sent().WxworkFollowLineButtonsHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],platforms:[a.Ev.Pc],key:s,load:!1})})},77907:function(e,t,n){n.r(t),n.d(t,{IWxworkHelpAndFeedbackFeature:function(){return s}});var r=n(85556),o=n(3139),i=(n(30479),n(54541)),a=n(22595),s=Symbol.for("feature:".concat(a.C.WxworkHelpAndFeedback));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(2488).then(n.bind(n,45270))];case 1:return[2,e.sent().WxworkHelpAndFeedbackHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level2],key:s,platforms:[i.Ev.Pad,i.Ev.Mobile],load:!1})})},89340:function(e,t,n){n.r(t),n.d(t,{IWxworkHintFeature:function(){return c},WXWORK_HINT_GUIDE_STORE_KEY:function(){return l},shouldShowWxworkHintGuide:function(){return u}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=n(85464),c=Symbol.for("feature:".concat(i.C.WxworkHint)),l="WXWORK_HINT_GUIDE_STORE_KEY",u=function(){return window.isWxworkReportTemplate&&!localStorage.getItem(l)};o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9212).then(n.bind(n,88496))];case 1:return[2,e.sent().WxworkQuoteHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2,a.YV.Publish],key:c,load:s.v.isTencentFreegoEnv})})},98799:function(e,t,n){n.r(t),n.d(t,{IMobileNativeEnterpriseHeaderFeature:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),Symbol.for("feature:".concat(i.C.MobileEnterpriseHeader)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(33),n.e(5303)]).then(n.bind(n,63814))];case 1:return[2,e.sent().NativeWeixinHeaderHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level1,a.YV.Publish],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!1})})},38041:function(e,t,n){n.r(t),n.d(t,{IWxworkQuoteFeature:function(){return c},QuoteClickFrom:function(){return r}});var r,o=n(85556),i=n(3139),a=(n(30479),n(22595)),s=n(54541);!function(e){e.ParagraphShortCut="shortcut",e.PCToolbar="toolbar",e.MobileContextMenu="mobile_context_menu",e.PCContextMenu="context_menu"}(r||(r={}));var c=Symbol.for("feature:".concat(a.C.WxworkQuote));i.Ln.merge(c,{useFactory:function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(7747).then(n.bind(n,3820))];case 1:return[2,e.sent().WxworkQuoteHandler]}}))}))},on:s.iz.On({stages:[s.YV.Level2],key:c,load:!1})})},36387:function(e,t,n){n.r(t),n.d(t,{IWxworkRevisionRecordFeature:function(){return s}});var r=n(85556),o=(n(30479),n(3139)),i=n(54541),a=n(22595),s=Symbol.for("feature:".concat(a.C.WxworkRevisionRecord));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5218),n.e(2738)]).then(n.bind(n,16654))];case 1:return[2,e.sent().WxworkRevisionRecordHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level2],key:s,load:!1})})},76312:function(e,t,n){n.r(t),n.d(t,{IZoomWxworkFeature:function(){return c},NEED_LOAD_ZOOM_WXWORK:function(){return s}});var r=n(85556),o=n(3139),i=n(22595),a=n(54541),s=(n(30479),!1),c=Symbol.for("feature:".concat(i.C.ZoomWxwork));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(5199).then(n.bind(n,91113))];case 1:return[2,e.sent().ZoomWxworkHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:c,platforms:[a.Ev.Pc],load:s})})},55059:function(e,t,n){n.r(t),n.d(t,{AbtestExpId:function(){return br.AbtestExpId},BTN_HEIGHT:function(){return Ft.BTN_HEIGHT},BTN_PANEL_DISTANCE:function(){return Ft.BTN_PANEL_DISTANCE},BackgroundType:function(){return w.BackgroundType},CURSOR_TYPE:function(){return mt.CURSOR_TYPE},ControlGroupId:function(){return br.ControlGroupId},EditorState:function(){return K.EditorState},ExperimentalGroupId:function(){return br.ExperimentalGroupId},IAccessibilityFeature:function(){return r.IAccessibilityFeature},IAddCooperator:function(){return i.IAddCooperator},IAddFastAccessFeature:function(){return a.IAddFastAccessFeature},IAddMobileFeature:function(){return o.IAddMobileFeature},IAddToWedriveFeature:function(){return s.IAddToWedriveFeature},IAddonHinaFeature:function(){return c.IAddonHinaFeature},IAddonIframeFeature:function(){return l.IAddonIframeFeature},IAddonMobileIframeFeature:function(){return u.IAddonMobileIframeFeature},IAddonNewFeature:function(){return d.IAddonNewFeature},IAddonPasteHandler:function(){return p.IAddonPasteHandler},IAddonSceneFeature:function(){return f.IAddonSceneFeature},IAirPrintFeature:function(){return _.IAirPrintFeature},IApiDocEntFeature:function(){return Dn.IApiDocEntFeature},IApiDocEntMobileFeature:function(){return Pn.IApiDocEntMobileFeature},IAppGuideFeature:function(){return h.IAppGuideFeature},IAppGuidePcFeature:function(){return m.IAppGuidePcFeature},IAtRecordScrollFeature:function(){return Fn.IAtRecordScrollFeature},IAttachmentFeature:function(){return g.IAttachmentFeature},IAttachmentReadonlyFeature:function(){return v.IAttachmentReadonlyFeature},IAudioFeature:function(){return b.IAudioFeature},IAutoFocusFeature:function(){return Ln.IAutoFocusFeature},IAutoNewlineFeature:function(){return y.IAutoNewlineFeature},IBackgroundFeature:function(){return w.IBackgroundFeature},IBasicFormatFeature:function(){return E.IBasicFormatFeature},IBookmarkFeature:function(){return C.IBookmarkFeature},IBottomBarMobileFeature:function(){return T.IBottomBarMobileFeature},ICertificationFeature:function(){return x.ICertificationFeature},ICertificationMobileFeature:function(){return S.ICertificationMobileFeature},ICodeblockFeature:function(){return I.ICodeblockFeature},ICollabCaretFeature:function(){return k.ICollabCaretFeature},ICollabStatusEntHandler:function(){return Bn.ICollabStatusEntHandler},ICollabStatusEntMobileFeature:function(){return Un.ICollabStatusEntMobileFeature},ICollabStatusFeature:function(){return R.ICollabStatusFeature},ICollabStatusMobileFeature:function(){return A.ICollabStatusMobileFeature},ICollaboratorDetailMobileFeature:function(){return O.ICollaboratorDetailMobileFeature},ICollectMobileFeature:function(){return L.ICollectMobileFeature},ICollectPcFeature:function(){return M.ICollectPcFeature},IColorFeature:function(){return N.IColorFeature},IColumnFeature:function(){return D.IColumnFeature},ICommentEntFeature:function(){return Hn.ICommentEntFeature},ICommentEntMobileFeature:function(){return jn.ICommentEntMobileFeature},ICommentEntPcFeature:function(){return Wn.ICommentEntPcFeature},ICommentFeature:function(){return P.ICommentFeature},ICommentMobileFeature:function(){return F.ICommentMobileFeature},ICommentPcFeature:function(){return B.ICommentPcFeature},IContextmenuMobileFeature:function(){return U.IContextmenuMobileFeature},ICopyPasteProcessorFeature:function(){return H.ICopyPasteProcessorFeature},ICopySharelinkFeature:function(){return j.ICopySharelinkFeature},ICoreEditHandler:function(){return W.ICoreEditHandler},IDiffViewFeature:function(){return V.IDiffViewFeature},IDiffViewMobileFeature:function(){return z.IDiffViewMobileFeature},IDiscussionEntFeature:function(){return zn.IDiscussionEntFeature},IDiscussionEntMobileFeature:function(){return Gn.IDiscussionEntMobileFeature},IDocPreviewFeature:function(){return G.IDocPreviewFeature},IDocViewMobileFeature:function(){return Y.IDocViewMobileFeature},IDoclinkPasteHandler:function(){return q.IDoclinkPasteHandler},IEditFollowFeature:function(){return Z.IEditFollowFeature},IEditTipsMobileFeature:function(){return J.IEditTipsMobileFeature},IEditorStateFeature:function(){return K.IEditorStateFeature},IEmbeddedObjectFeature:function(){return Q.IEmbeddedObjectFeature},IExternalTagFeature:function(){return X.IExternalTagFeature},IFanbookFeature:function(){return $.IFanbookFeature},IFastEditFeature:function(){return ee.IFastEditFeature},IFieldDemoFeature:function(){return te.IFieldDemoFeature},IFieldFeature:function(){return ne.IFieldFeature},IFieldPageRefFeature:function(){return oe.IFieldPageRefFeature},IFieldcodeDateHandler:function(){return ae.IFieldcodeDateHandler},IFieldcodeDocLinkHandler:function(){return se.IFieldcodeDocLinkHandler},IFieldcodeMentionFeature:function(){return ce.IFieldcodeMentionFeature},IFieldcodePageFeature:function(){return le.IFieldcodePageFeature},IFieldcodeWeixinMentionFeature:function(){return Yn.IFieldcodeWeixinMentionFeature},IFieldcodeWxworkAppFeature:function(){return qn.IFieldcodeWxworkAppFeature},IFieldcodeWxworkCalenderFeature:function(){return Zn.IFieldcodeWxworkCalenderFeature},IFieldcodeWxworkColdStartButtonFeature:function(){return Jn.IFieldcodeWxworkColdStartButtonFeature},IFieldcodeWxworkGroupChatFeature:function(){return Kn.IFieldcodeWxworkGroupChatFeature},IFieldcodeWxworkGroupContactCardFeature:function(){return Qn.IFieldcodeWxworkGroupContactCardFeature},IFieldcodeWxworkMeetingFeature:function(){return Xn.IFieldcodeWxworkMeetingFeature},IFieldcodeWxworkMemberContactCardFeature:function(){return $n.IFieldcodeWxworkMemberContactCardFeature},IFileBaseFeature:function(){return ue.IFileBaseFeature},IFileExportHandler:function(){return de.IFileExportHandler},IFileInfoPanelMobileFeature:function(){return pe.IFileInfoPanelMobileFeature},IFileInfoPanelPcFeature:function(){return fe.IFileInfoPanelPcFeature},IFileMobileFeature:function(){return _e.IFileMobileFeature},IFilePcFeature:function(){return he.IFilePcFeature},IFileWechatFeature:function(){return me.IFileWechatFeature},IFloatToolbarFeature:function(){return ge.IFloatToolbarFeature},IFollowLineButtonsFeature:function(){return Mn.IFollowLineButtonsFeature},IFontFeature:function(){return ve.IFontFeature},IFormatPainterFeature:function(){return be.IFormatPainterFeature},IFullscreenFeature:function(){return ye.IFullscreenFeature},IGuideToWeworkFeature:function(){return we.IGuideToWeworkFeature},IHeadingFeature:function(){return Ee.IHeadingFeature},IHelpAndFeedBackCenterHandler:function(){return Te.IHelpAndFeedBackCenterHandler},IHelpCenterFeature:function(){return Ce.IHelpCenterFeature},IHintFeature:function(){return xe.IHintFeature},IHyperlinkFeature:function(){return re.IHyperlinkFeature},IImageFeature:function(){return Ie.IImageFeature},IImageMobileFeature:function(){return ke.IImageMobileFeature},IImagePcFeature:function(){return Re.IImagePcFeature},IImageReadonlyFeature:function(){return Ae.IImageReadonlyFeature},IIpadAppKeyboardFeature:function(){return Oe.IIpadAppKeyboardFeature},IKeymapListFeature:function(){return Le.IKeymapListFeature},ILandspaceStateFeature:function(){return Me.ILandspaceStateFeature},ILatexFeature:function(){return Ne.ILatexFeature},ILightBlockFeature:function(){return De.ILightBlockFeature},ILikeMobileFeature:function(){return Pe.ILikeMobileFeature},IListFeature:function(){return Fe.IListFeature},IListQwxTodoFeature:function(){return er.IListQwxTodoFeature},IListReadonlyFeature:function(){return Be.IListReadonlyFeature},ILocalEditTitlebarConfigService:function(){return He.ILocalEditTitlebarConfigService},ILocalFileSaveFeature:function(){return je.ILocalFileSaveFeature},ILocationFeature:function(){return We.ILocationFeature},IManualOfflineFeature:function(){return Ve.IManualOfflineFeature},IMarkdownFeature:function(){return ze.IMarkdownFeature},IMiniListEntFeature:function(){return tr.IMiniListEntFeature},IMiniListFeature:function(){return Ge.IMiniListFeature},IMobileAutoScrollFeature:function(){return Ye.IMobileAutoScrollFeature},IMobileBlockBottomBarFeature:function(){return Ze.IMobileBlockBottomBarFeature},IMobileBlockInterface:function(){return qe.IMobileBlockInterface},IMobileGestureFeature:function(){return Je.IMobileGestureFeature},IMobileHeaderFeature:function(){return Ke.IMobileHeaderFeature},IMobileHomeFeature:function(){return Se.IMobileHomeFeature},IMobileLocalEditFeature:function(){return Ue.IMobileLocalEditFeature},IMobileMoreMenuFeature:function(){return Qe.IMobileMoreMenuFeature},IMobileNativeEnterpriseHeaderFeature:function(){return hr.IMobileNativeEnterpriseHeaderFeature},IMobilePagedViewFeature:function(){return Xe.IMobilePagedViewFeature},IMobileTipsFeature:function(){return nr.IMobileTipsFeature},IMobileViewFeature:function(){return $e.IMobileViewFeature},IMoveFileFeature:function(){return rr.IMoveFileFeature},IMoveToFeature:function(){return et.IMoveToFeature},IMoveToMobileFeature:function(){return tt.IMoveToMobileFeature},INativeMobileHeaderFeature:function(){return nt.INativeMobileHeaderFeature},IOcrFeature:function(){return rt.IOcrFeature},IOcrPcFeature:function(){return ot.IOcrPcFeature},IOcrPreviewFeature:function(){return it.IOcrPreviewFeature},IOfflineEditFeature:function(){return at.IOfflineEditFeature},IOfflineStatusFeature:function(){return st.IOfflineStatusFeature},IOpenAPIFeature:function(){return ct.IOpenAPIFeature},IOutlineFeature:function(){return lt.IOutlineFeature},IOutlineMobileFeature:function(){return ut.IOutlineMobileFeature},IPageFeature:function(){return dt.IPageFeature},IPageShadeFeature:function(){return pt.IPageShadeFeature},IPageWebFeature:function(){return ft.IPageWebFeature},IParagraphDragMobileFeature:function(){return ht.IParagraphDragMobileFeature},IParagraphFeature:function(){return _t.IParagraphFeature},IParagraphShortcutMenuFeature:function(){return mt.IParagraphShortcutMenuFeature},IPdfTransformFeature:function(){return gt.IPdfTransformFeature},IPermissionRangeFeature:function(){return vt.IPermissionRangeFeature},IPreloadPreviewImageFeature:function(){return or.IPreloadPreviewImageFeature},IPresentationFeature:function(){return bt.IPresentationFeature},IPresentationPlayerFeature:function(){return yt.IPresentationPlayerFeature},IPrintFeature:function(){return wt.IPrintFeature},IPublishFeature:function(){return Et.IPublishFeature},IQuicklyVisitMobileFeature:function(){return Ct.IQuicklyVisitMobileFeature},IQuoteBaseFeature:function(){return ir.IQuoteBaseFeature},IQuoteFeature:function(){return Tt.IQuoteFeature},IReadRecordFeature:function(){return xt.IReadRecordFeature},IReadonlyTipsFeature:function(){return St.IReadonlyTipsFeature},IRecoverDocFeature:function(){return It.IRecoverDocFeature},IRepeatLastFeature:function(){return kt.IRepeatLastFeature},IResizeAdaptFeature:function(){return Rt.IResizeAdaptFeature},IResumeGuideFeature:function(){return At.IResumeGuideFeature},IResumeGuideMobileFeature:function(){return Ot.IResumeGuideMobileFeature},IRevisionRecordFeature:function(){return Lt.IRevisionRecordFeature},IS_LANDSPACE:function(){return Me.IS_LANDSPACE},IScrollPositionFeature:function(){return Mt.IScrollPositionFeature},IScrollbarHiddenMobileFeature:function(){return Nt.IScrollbarHiddenMobileFeature},ISearchFeature:function(){return Dt.ISearchFeature},ISectionFeature:function(){return Pt.ISectionFeature},ISelectivePasteHandler:function(){return Ft.ISelectivePasteHandler},IShareFeature:function(){return Bt.IShareFeature},IShareMobileFeature:function(){return Ut.IShareMobileFeature},IShareMobileWebFeature:function(){return Ht.IShareMobileWebFeature},IShowMoreFeature:function(){return jt.IShowMoreFeature},ISignatureFeature:function(){return Wt.ISignatureFeature},ISnapScreenMobileFeature:function(){return Vt.ISnapScreenMobileFeature},ISnapScreenPcFeature:function(){return zt.ISnapScreenPcFeature},ISnippetFeature:function(){return Gt.ISnippetFeature},ISpellcheckFeature:function(){return Yt.ISpellcheckFeature},ISplitlineFeature:function(){return qt.ISplitlineFeature},IStarMobileFeature:function(){return Zt.IStarMobileFeature},IStatusTipsFeature:function(){return Jt.IStatusTipsFeature},ISubscribeFeature:function(){return Kt.ISubscribeFeature},ISubscribeNoticeMobileFeature:function(){return Qt.ISubscribeNoticeMobileFeature},ISubscriptionNotificationFeature:function(){return Xt.ISubscriptionNotificationFeature},ISubscriptionNotificationMenuFeature:function(){return $t.ISubscriptionNotificationMenuFeature},ISwitchCertificationFeature:function(){return en.ISwitchCertificationFeature},ISwitchCertificationMobileFeature:function(){return tn.ISwitchCertificationMobileFeature},ISyncTencentListHandler:function(){return nn.ISyncTencentListHandler},ISyncTencentListMobileFeature:function(){return rn.ISyncTencentListMobileFeature},ITabService:function(){return br.ITabService},ITableFeature:function(){return an.ITableFeature},ITableShortcutMenuFeature:function(){return on.ITableShortcutMenuFeature},ITdocsDeferredRenderFeature:function(){return Nn.ITdocsDeferredRenderFeature},ITemplateInfoFeature:function(){return sn.ITemplateInfoFeature},ITemplateRecommendation:function(){return cn.ITemplateRecommendation},ITextDragPcFeature:function(){return ln.ITextDragPcFeature},ITextFlowFeature:function(){return un.ITextFlowFeature},ITextFrameFeature:function(){return dn.ITextFrameFeature},ITitleColorFeature:function(){return fn.ITitleColorFeature},ITitleDefaultAddFeature:function(){return _n.ITitleDefaultAddFeature},ITitleFeature:function(){return pn.ITitleFeature},ITitleMobileFeature:function(){return hn.ITitleMobileFeature},ITitlebarCollectFeature:function(){return ar.ITitlebarCollectFeature},ITitlebarFeature:function(){return mn.ITitlebarFeature},ITitlebarFoldHandler:function(){return gn.ITitlebarFoldHandler},ITobReadonlyTipsFeature:function(){return sr.ITobReadonlyTipsFeature},ITobRecentInputTextHandler:function(){return cr.ITobRecentInputTextHandler},ITocFeature:function(){return ie.ITocFeature},IToolbarFeature:function(){return bn.IToolbarFeature},IToolbarToggleFeature:function(){return vn.IToolbarToggleFeature},ITranslateFeature:function(){return yn.ITranslateFeature},IUnreadNotifyHandler:function(){return wn.IUnreadNotifyHandler},IUpdateNoticeFeature:function(){return En.IUpdateNoticeFeature},IUserAvatarFeature:function(){return lr.IUserAvatarFeature},IVipFeature:function(){return Cn.IVipFeature},IVisibilityChangeMobileFeature:function(){return Tn.IVisibilityChangeMobileFeature},IVoiceInputFeature:function(){return xn.IVoiceInputFeature},IWatermarkFeature:function(){return Sn.IWatermarkFeature},IWedocsDiscussFeature:function(){return Vn.IWedocsDiscussFeature},IWedocsProcessonFeature:function(){return ur.IWedocsProcessonFeature},IWedriveAttachmentFeature:function(){return dr.IWedriveAttachmentFeature},IWordCountFeature:function(){return In.IWordCountFeature},IWxworkFollowLineButtonsFeature:function(){return pr.IWxworkFollowLineButtonsFeature},IWxworkHelpAndFeedbackFeature:function(){return fr.IWxworkHelpAndFeedbackFeature},IWxworkHintFeature:function(){return _r.IWxworkHintFeature},IWxworkQuoteFeature:function(){return mr.IWxworkQuoteFeature},IWxworkRevisionRecordFeature:function(){return gr.IWxworkRevisionRecordFeature},IZoomBaseFeature:function(){return kn.IZoomBaseFeature},IZoomMeloFeature:function(){return Rn.IZoomMeloFeature},IZoomMobileFeature:function(){return An.IZoomMobileFeature},IZoomPcFeature:function(){return On.IZoomPcFeature},IZoomWxworkFeature:function(){return vr.IZoomWxworkFeature},ImportScene:function(){return Ot.ImportScene},ImportType:function(){return Ot.ImportType},MELO_DATA_CHANGED_EVENT:function(){return Kt.MELO_DATA_CHANGED_EVENT},NEED_LOAD_ZOOM_WXWORK:function(){return vr.NEED_LOAD_ZOOM_WXWORK},PANEL_HEIGHT_2_ITEM:function(){return Ft.PANEL_HEIGHT_2_ITEM},PANEL_HEIGHT_3_ITEM:function(){return Ft.PANEL_HEIGHT_3_ITEM},PasteBtnType:function(){return Ft.PasteBtnType},PreloadPreviewImagePriority:function(){return or.PreloadPreviewImagePriority},QuoteClickFrom:function(){return mr.QuoteClickFrom},ShadeEntrance:function(){return pt.ShadeEntrance},TriggerType:function(){return wt.TriggerType},WXWORK_HINT_GUIDE_STORE_KEY:function(){return _r.WXWORK_HINT_GUIDE_STORE_KEY},WeDriveStatus:function(){return s.WeDriveStatus},canShowRecommendation:function(){return cn.canShowRecommendation},getUpdateNoticeUrl:function(){return En.getUpdateNoticeUrl},isAudioAvalible:function(){return b.isAudioAvalible},shouldAutoLoad:function(){return bt.shouldAutoLoad},shouldShowWxworkHintGuide:function(){return _r.shouldShowWxworkHintGuide}});var r=n(53105),o=n(78356),i=n(88430),a=n(13888),s=n(47478),c=n(19527),l=n(39614),u=n(53103),d=n(52272),p=n(3951),f=n(800),_=n(4787),h=n(47743),m=n(25298),g=n(36582),v=n(48642),b=n(20978),y=n(2491),w=n(54108),E=n(56457),C=n(7678),T=n(77241),x=n(66275),S=n(4688),I=n(55896),k=n(96837),R=n(56037),A=n(25862),O=n(45768),L=n(16024),M=n(67348),N=n(14550),D=n(35312),P=n(70907),F=n(33109),B=n(53828),U=n(55814),H=n(87809),j=n(54060),W=n(141),V=n(3033),z=n(20071),G=n(82873),Y=n(51457),q=n(58301),Z=n(17570),J=n(86878),K=n(31218),Q=n(87098),X=n(93969),$=n(36206),ee=n(37794),te=n(91782),ne=n(7283),re=n(22127),oe=n(49409),ie=n(69179),ae=n(17760),se=n(202),ce=n(86129),le=n(84566),ue=n(98077),de=n(90593),pe=n(30867),fe=n(69945),_e=n(31947),he=n(39249),me=n(25373),ge=n(61843),ve=n(47037),be=n(76819),ye=n(14092),we=n(72588),Ee=n(90376),Ce=n(55747),Te=n(77683),xe=n(23544),Se=n(56128),Ie=n(66422),ke=n(84371),Re=n(83181),Ae=n(78526),Oe=n(72941),Le=n(72110),Me=n(21116),Ne=n(54295),De=n(90094),Pe=n(42861),Fe=n(91412),Be=n(10495),Ue=n(4999),He=n(90805),je=n(15360),We=n(1502),Ve=n(83996),ze=n(68643),Ge=n(12494),Ye=n(87942),qe=n(76092),Ze=n(89236),Je=n(4814),Ke=n(71018),Qe=n(91),Xe=n(43087),$e=n(96713),et=n(88588),tt=n(14330),nt=n(38577),rt=n(60362),ot=n(35554),it=n(34205),at=n(16461),st=n(29969),ct=n(15170),lt=n(46355),ut=n(78658),dt=n(76176),pt=n(40805),ft=n(80312),_t=n(35562),ht=n(35333),mt=n(1982),gt=n(66689),vt=n(97539),bt=n(34955),yt=n(99542),wt=n(78039),Et=n(76405),Ct=n(60728),Tt=n(25350),xt=n(16524),St=n(79560),It=n(73794),kt=n(905),Rt=n(28950),At=n(89565),Ot=n(9710),Lt=n(28266),Mt=n(51144),Nt=n(18415),Dt=n(27224),Pt=n(7993),Ft=n(41105),Bt=n(81701),Ut=n(6e3),Ht=n(1694),jt=n(81910),Wt=n(15135),Vt=n(44395),zt=n(61705),Gt=n(14508),Yt=n(73855),qt=n(26067),Zt=n(20372),Jt=n(52772),Kt=n(63438),Qt=n(87420),Xt=n(46498),$t=n(73132),en=n(89815),tn=n(21414),nn=n(22638),rn=n(18982),on=n(24111),an=n(97429),sn=n(94521),cn=n(94778),ln=n(69412),un=n(73964),dn=n(34370),pn=n(64102),fn=n(33189),_n=n(41736),hn=n(41696),mn=n(35241),gn=n(14103),vn=n(53198),bn=n(85827),yn=n(80178),wn=n(96432),En=n(22971),Cn=n(3205),Tn=n(83023),xn=n(34566),Sn=n(98720),In=n(95878),kn=n(46023),Rn=n(50094),An=n(33497),On=n(96925),Ln=n(14809),Mn=n(34584),Nn=n(44494),Dn=n(37404),Pn=n(54273),Fn=n(14634),Bn=n(70318),Un=n(5438),Hn=n(69739),jn=n(8020),Wn=n(30620),Vn=n(7576),zn=n(56684),Gn=n(65972),Yn=n(5070),qn=n(36506),Zn=n(12325),Jn=n(85956),Kn=n(56936),Qn=n(15091),Xn=n(15375),$n=n(57861),er=n(9277),tr=n(17798),nr=n(46590),rr=n(79620),or=n(25159),ir=n(15578),ar=n(30490),sr=n(49626),cr=n(3846),lr=n(63613),ur=n(86576),dr=n(41039),pr=n(60364),fr=n(77907),_r=n(89340),hr=n(98799),mr=n(38041),gr=n(36387),vr=n(76312),br=n(93117);n(53105),n(78356),n(88430),n(13888),n(47478),n(19527),n(39614),n(53103),n(52272),n(3951),n(800),n(4787),n(47743),n(25298),n(36582),n(48642),n(20978),n(2491),n(54108),n(56457),n(7678),n(77241),n(66275),n(4688),n(55896),n(96837),n(56037),n(25862),n(45768),n(16024),n(67348),n(14550),n(35312),n(70907),n(33109),n(53828),n(55814),n(87809),n(54060),n(141),n(3033),n(20071),n(82873),n(51457),n(58301),n(17570),n(86878),n(31218),n(87098),n(93969),n(36206),n(37794),n(91782),n(7283),n(22127),n(49409),n(69179),n(17760),n(202),n(86129),n(84566),n(98077),n(90593),n(30867),n(69945),n(31947),n(39249),n(25373),n(61843),n(47037),n(76819),n(14092),n(72588),n(90376),n(55747),n(77683),n(23544),n(56128),n(66422),n(84371),n(83181),n(78526),n(72941),n(72110),n(21116),n(54295),n(90094),n(42861),n(91412),n(10495),n(4999),n(90805),n(15360),n(1502),n(83996),n(68643),n(12494),n(87942),n(76092),n(89236),n(4814),n(71018),n(91),n(43087),n(96713),n(88588),n(14330),n(38577),n(60362),n(35554),n(34205),n(16461),n(29969),n(15170),n(46355),n(78658),n(76176),n(40805),n(80312),n(35562),n(35333),n(1982),n(66689),n(97539),n(34955),n(99542),n(78039),n(76405),n(60728),n(25350),n(16524),n(79560),n(73794),n(905),n(28950),n(89565),n(9710),n(28266),n(51144),n(18415),n(27224),n(7993),n(41105),n(81701),n(6e3),n(1694),n(81910),n(15135),n(44395),n(61705),n(14508),n(73855),n(26067),n(20372),n(52772),n(63438),n(87420),n(46498),n(73132),n(89815),n(21414),n(22638),n(18982),n(24111),n(97429),n(94521),n(94778),n(69412),n(73964),n(34370),n(64102),n(33189),n(41736),n(41696),n(35241),n(14103),n(53198),n(85827),n(80178),n(96432),n(22971),n(3205),n(83023),n(34566),n(98720),n(95878),n(46023),n(50094),n(33497),n(96925),n(14809),n(34584),n(44494),n(37404),n(54273),n(14634),n(70318),n(5438),n(69739),n(8020),n(30620),n(7576),n(56684),n(65972),n(5070),n(36506),n(12325),n(85956),n(56936),n(15091),n(15375),n(57861),n(9277),n(17798),n(46590),n(79620),n(25159),n(15578),n(30490),n(49626),n(3846),n(63613),n(86576),n(41039),n(60364),n(77907),n(89340),n(98799),n(38041),n(36387),n(76312),n(93117)},57724:function(e,t,n){n.d(t,{G:function(){return o}}),n(30479);var r=n(2613),o=(n(47605),function(e,t){return function(t){var n=t.clone();return e.docEnv.layoutType,r.LayoutType.EnterpriseWeb,{data:n}}})},34654:function(e,t,n){var r;n.d(t,{k:function(){return r}}),function(e){e.DATA_CALLBACK="DATA_CALLBACK"}(r||(r={}))},24858:function(e,t,n){n.d(t,{EG:function(){return i},JM:function(){return h},Ov:function(){return o},QM:function(){return r},_E:function(){return _},cm:function(){return d},lv:function(){return f},p3:function(){return m}});var r,o,i,a=n(85556),s=n(30479),c=n(14532),l=n.n(c),u=n(14740);!function(e){e[e.Active=1]="Active",e[e.Expire=2]="Expire",e[e.Disabled=3]="Disabled"}(r||(r={})),function(e){e.BEGIN="begin",e.FIVE_MINUTES_BEFORE="five_minutes_before",e.FIFTEEN_MINUTES_BEFORE="fifteen_minutes_before",e.ONE_HOUR_BEFORE="one_hour_before",e.ONE_DAY_BEFORE="one_day_before"}(o||(o={})),function(e){e.THAT_DAY="that-day",e.ONE_DAY="one-day",e.TWO_DAYS="two-days",e.ONE_WEEK="one-week"}(i||(i={}));var d,p="9:00";new Map([[i.THAT_DAY,(0,u.$t)("当天 {{- clock}}",{clock:p})],[i.ONE_DAY,(0,u.$t)("1 天前 {{- clock}}",{clock:p})],[i.TWO_DAYS,(0,u.$t)("2 天前 {{- clock}}",{clock:p})],[i.ONE_WEEK,(0,u.$t)("1 周前 {{- clock}}",{clock:p})]]),new Map([[o.BEGIN,(0,u.$t)("事件开始时")],[o.FIVE_MINUTES_BEFORE,(0,u.$t)("提前 5 分钟")],[o.FIFTEEN_MINUTES_BEFORE,(0,u.$t)("提前 15 分钟")],[o.ONE_HOUR_BEFORE,(0,u.$t)("提前 1 小时")],[o.ONE_DAY_BEFORE,(0,u.$t)("提前 1 天")]]),function(e){e.NEVER="never",e.EVERY_DAY="every-day",e.WORK_DAY="work-day",e.EVERY_WEEK="every-week",e.EVERY_TWO_WEEKS="every-two-weeks",e.EVERY_MONTH="every-month"}(d||(d={}));var f=new Map([[d.NEVER,(0,u.$t)("不重复")],[d.EVERY_DAY,(0,u.$t)("每天")],[d.WORK_DAY,(0,u.$t)("工作日")],[d.EVERY_WEEK,(0,u.$t)("每周")],[d.EVERY_TWO_WEEKS,(0,u.$t)("每两周")],[d.EVERY_MONTH,(0,u.$t)("每月")]]),_="REFRESH_DATE_REMINDER",h=function(e){function t(t){var n=e.call(this,_)||this;return n.reminderId=t,n}return(0,a.__extends)(t,e),t}(s.Notification),m=function(e,t){var n=l()();return n=(n=(n=n.add(1,"hour")).set("minute",0)).set("second",0),(0,a.__assign)({id:e,timestamp:+n.toDate(),repeat:d.NEVER,reminderUsers:[],remindAll:!0,fullDay:!1,notify:o.BEGIN,status:r.Active},t)}},80343:function(e,t,n){n.d(t,{Di:function(){return i},ox:function(){return r},uO:function(){return o}});var r=2,o=2,i=1.3},70401:function(e,t,n){n.d(t,{m:function(){return g}});var r,o=n(85556),i=n(87363),a=n.n(i),s=n(32230),c=n.n(s),l=n(30479),u=n(2613),d=n(62074),p=n(80343),f=n(38671),_=n(18285),h=n(52792),m=n(17657);!function(e){e.None="doc-link-container-none",e.Hover="doc-link-container-hover",e.Active="doc-link-container-active"}(r||(r={}));var g=function(e){function t(t){var n=e.call(this,t)||this;n.defaultStyle={padding:p.uO,margin:p.ox},n.respondEventTimer=null,n.docLinkRef=a().createRef(),n.onWheel=function(e){if(!(Math.abs(e.deltaY)>Math.abs(e.deltaX))||e.shiftKey){if(!n.respondEventTimer){if(n.docLinkRef.current){var t=(0,h.s)(n.docLinkRef.current,2);t&&(t.style.pointerEvents="none")}n.respondEventTimer=(0,l.debounce)((function(){if(n.docLinkRef.current){var e=(0,h.s)(n.docLinkRef.current,2);e&&(e.style.pointerEvents="all")}n.respondEventTimer=null}),300)}n.respondEventTimer()}},n.setBackgroundToActive=function(){n.setState({backgroundStats:r.Active})},n.setBackgroundToNone=function(){n.setState({backgroundStats:r.None})},n.state={backgroundStats:r.None};var o=t.layoutBox,i=t.docLink,s=t.editor;return n.interactive=(0,f.e)({isDirectOpenLink:function(){var e,t;return!!i.internalJump||!!(null===(t=null===(e=n.client)||void 0===e?void 0:e.isDirectOpenLink)||void 0===t?void 0:t.call(e,s))},showPCToolbar:function(){var e,t;return null===(t=null===(e=n.client)||void 0===e?void 0:e.showPCHyperlinkToolbar)||void 0===t?void 0:t.call(e,o,{onMouseEnterToolbar:n.interactive.onMouseEnterToolbar,onMouseLeaveToolbar:n.interactive.onMouseLeaveToolbar})},hidePCToolbar:function(){var e,t;return null===(t=null===(e=n.client)||void 0===e?void 0:e.hidePCHyperlinkToolbar)||void 0===t?void 0:t.call(e)},showMobileToolbar:function(){var e,t;return null===(t=null===(e=n.client)||void 0===e?void 0:e.showMobileHyperlinkToolbar)||void 0===t?void 0:t.call(e,o)},openLink:function(){var e,t,r,o;return null===(t=null===(e=n.client)||void 0===e?void 0:e.openLink)||void 0===t?void 0:t.call(e,i.fileUrl,i.fileExt,i.fileName,null===(o=null===(r=n.props.fieldInfo)||void 0===r?void 0:r.fieldResult)||void 0===o?void 0:o.range)},canEnterEdit:function(){var e,t;return null===(t=null===(e=n.client)||void 0===e?void 0:e.canEnterEdit)||void 0===t?void 0:t.call(e)},isEditable:function(){var e,t;return null===(t=null===(e=n.client)||void 0===e?void 0:e.isEditable)||void 0===t?void 0:t.call(e)},isWedriveImage:function(){return i.fileExt===m.Au.WEDRIVE_IMAGE||i.fileExt===m.Au.WEDRIVE_VIDEO}}),n}return(0,o.__extends)(t,e),t.prototype.componentWillUnmount=function(){var e,t;null===(t=null===(e=this.client)||void 0===e?void 0:e.hidePCHyperlinkToolbar)||void 0===t||t.call(e)},t.prototype.renderIcon=function(e,t){return"string"==typeof e?a().createElement("img",{src:e,style:t}):a().cloneElement(e,{style:t})},t.prototype.renderInner=function(e,t,n){var r=this.defaultStyle.padding;return a().createElement(i.Fragment,null,a().createElement("span",{className:"".concat(_.Z["doc-link-icon-wrapper"]),style:{left:r}},this.renderIcon(e,t)),a().createElement("span",{className:"text-wrapper",style:{paddingLeft:"".concat(this.iconWidth,"px"),height:"100%",display:"flex",alignItems:"center"}},n))},Object.defineProperty(t.prototype,"fontSizePx",{get:function(){var e,t,n,r=this.props.layoutBox;return(0,u.isLeafContainer)(r)||(0,u.isContainerBoxLite)(r)?0:(0,u.isFieldBox)(r)?(0,l.twipsToPx)((null===(e=r.content)||void 0===e?void 0:e.textStyle.renderFontSize)||0):(0,l.twipsToPx)((null===(n=null===(t=r.content)||void 0===t?void 0:t.property)||void 0===n?void 0:n.renderFontSize)||0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"iconWidth",{get:function(){return this.fontSizePx*p.Di},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"client",{get:function(){if(this.props.bridge){var e=this.props.bridge,t=e.instance,n=e.bridgeKey;return t.get(n)}},enumerable:!1,configurable:!0}),t.prototype.getContainerStyleFromOtherRenderType=function(e){var t={};return e.renderType===u.RenderType.Canvas&&(0,u.isFieldBox)(this.props.layoutBox)?t=this.getCanvasStyle(this.props.layoutBox):e.renderType===u.RenderType.Lite&&(0,u.isFieldBoxLite)(this.props.layoutBox)&&(t=this.getLiteStyle(this.props.layoutBox)),t},t.prototype.getLiteStyle=function(e){var t,n=null===(t=e.content)||void 0===t?void 0:t.property;return n?(0,o.__assign)((0,o.__assign)({},{maxWidth:"100%"}),n?{color:n.color.val}:{}):{}},t.prototype.getCanvasStyle=function(e){return{maxWidth:(0,l.twipsToPx)(e.totalWidth)-this.defaultStyle.margin}},t.prototype.render=function(){var e,t=this.props,n=t.children,r=t.docLink,i=t.editor,s=t.overrideStyle,l=i.docEnv,p=this.defaultStyle,f="".concat(this.fontSizePx,"px"),h={minWidth:f,maxWidth:f,width:f,height:f},m=(0,d.kb)(r),g=this.getContainerStyleFromOtherRenderType(l),v=c()(((e={})["field-code-draggable"]=!0,e["".concat(_.Z["doc-link-container"])]=!0,e["".concat(_.Z[this.state.backgroundStats])]=!0,e["".concat(_.Z["doc-link-container-lite"])]=l.renderType===u.RenderType.Lite,e["".concat(_.Z["doc-link-container-canvas"])]=l.renderType===u.RenderType.Canvas,e));return a().createElement("span",{className:v,style:(0,o.__assign)((0,o.__assign)((0,o.__assign)((0,o.__assign)({padding:"0px ".concat(p.padding,"px"),margin:"0px ".concat(p.margin,"px"),fontSize:"".concat(this.fontSizePx,"px")},g),{height:"100%"}),u.CssUtil.cssPropsToStyle(s)),{display:"flex",alignItems:"center"}),onTouchStart:this.interactive.onTouchStart,onTouchMove:this.interactive.onTouchMove,onTouchEnd:this.interactive.onTouchEnd,onMouseEnter:this.interactive.onMouseEnter,onMouseLeave:this.interactive.onMouseLeave,onClick:this.interactive.onClick,onWheel:this.onWheel,ref:this.docLinkRef},this.renderInner(m,h,n))},t}(i.Component)},46712:function(e,t,n){n.d(t,{AQ:function(){return l},Wo:function(){return a},bB:function(){return u},di:function(){return c}});var r=n(85556),o=n(2613),i=n(14740),a={APP_TEXT:(0,i.$t)("card:app"),WEAPP_TEXT:(0,i.$t)("card:weapp")};function s(e){return{icon_url:e.icon_url,thumb_url:e.thumb_url,name:e.name,title:e.title,app_key:e.app_key,username:e.username,layout:e.layout}}function c(e){return"1"===e.type}function l(e){var t=s(e),n=JSON.stringify(t);return"".concat(o.FieldName.WXWORK_APP," ").concat(n)}function u(e,t){void 0===t&&(t=!1);try{var n=e;if(!t){var i=new RegExp("".concat(o.FieldName.WXWORK_APP," (.*)")).exec(e);n=(0,r.__read)(i,2)[1]}return s(JSON.parse(n))}catch(e){return}}},53398:function(e,t,n){n.d(t,{BW:function(){return l},J2:function(){return u},uF:function(){return c}});var r,o=n(85556),i=n(2613),a=n(30479);function s(e){return{schedule_id:e.schedule_id,sharekey:e.sharekey,subject:e.subject,content:e.content,place:e.place,meetting_room:e.meetting_room,create_name:e.create_name,create_id:e.create_id,create_from:e.create_from,create_user_avatar:e.create_user_avatar,is_joined:e.is_joined,start_time:e.start_time,end_time:e.end_time,flag:e.flag,attend_list:e.attend_list||[],attach:e.attach||[],repeat:e.repeat,id:e.id||a.StringUtil.generateRandomId(),layout:e.layout,height:e.height}}function c(e,t){var n=JSON.stringify((0,o.__assign)((0,o.__assign)({},e),{id:t}));return"".concat(i.FieldName.WXWORK_CALENDER," ").concat(n)}function l(e){var t=s(e),n=JSON.stringify(t);return"".concat(i.FieldName.WXWORK_CALENDER," ").concat(n)}function u(e,t){void 0===t&&(t=!1);try{var n=e;if(!t){var r=new RegExp("".concat(i.FieldName.WXWORK_CALENDER," (.*)")).exec(e);n=(0,o.__read)(r,2)[1]}return s(JSON.parse(n))}catch(e){return}}!function(e){e.LOADED_CALLBACK="LOADED_CALLBACK"}(r||(r={}))},72832:function(e,t,n){n.d(t,{Bf:function(){return a},TU:function(){return i}});var r=n(85556),o=n(2613);function i(e){var t=JSON.stringify({id:e.id,chatMessageId:e.chatMessageId,jsonData:{groupName:e.jsonData.groupName,chatList:e.jsonData.chatList.map((function(e){return{username:e.username,iconurl:e.iconurl,timestamp:e.timestamp,textContent:e.textContent}}))},layout:e.layout});return"".concat(o.FieldName.WXWORK_GROUP_CHAT," ").concat(t)}function a(e,t){void 0===t&&(t=!1);try{var n=e;if(!t){var i=new RegExp("".concat(o.FieldName.WXWORK_GROUP_CHAT," (.*)")).exec(e);n=(0,r.__read)(i,2)[1]}var a=JSON.parse(n);return{id:a.id,chatMessageId:a.chatMessageId,jsonData:{groupName:a.jsonData.groupName,chatList:a.jsonData.chatList.map((function(e){return{username:e.username,iconurl:e.iconurl,timestamp:e.timestamp,textContent:e.textContent}}))},layout:a.layout}}catch(e){return}}},47329:function(e,t,n){n.d(t,{$F:function(){return a},yD:function(){return s}});var r,o=n(85556),i=n(2613);function a(e){var t=JSON.stringify({vcode:e.vcode,iconurl:e.iconurl,name:e.name,expire:e.expire,qrcodeurl:e.qrcodeurl,qrshortcodeurl:e.qrshortcodeurl,create_time:e.create_time,joinUrl:e.joinUrl,external:e.external,layout:e.layout});return"".concat(i.FieldName.GROUP_CONTACT_CARD," ").concat(t)}function s(e,t){void 0===t&&(t=!1);try{var n=e;if(!t){var r=new RegExp("".concat(i.FieldName.GROUP_CONTACT_CARD," (.*)")).exec(e);n=(0,o.__read)(r,2)[1]}var a=JSON.parse(n);return{vcode:a.vcode,iconurl:a.iconurl,name:a.name,expire:a.expire,qrcodeurl:a.qrcodeurl,qrshortcodeurl:a.qrshortcodeurl,create_time:a.create_time,joinUrl:a.joinUrl,external:a.external,layout:a.layout}}catch(e){return}}!function(e){e.LOADED_CALLBACK="LOADED_CALLBACK"}(r||(r={}))},16823:function(e,t,n){n.d(t,{Yz:function(){return c},ZW:function(){return l},ph:function(){return u}});var r,o=n(85556),i=n(2613),a=n(30479);function s(e){return{meeting_id:e.meeting_id,submeeting_id:e.submeeting_id,meeting_code:e.meeting_code,access_url:e.access_url,sharekey:e.sharekey,subject:e.subject,content:e.content,is_api_create:e.is_api_create,place:e.place,meeting_room:e.meeting_room,creator_vid:e.creator_vid,creator_name:e.creator_name,creator_source:e.creator_source,start_time:e.start_time,end_time:e.end_time,attend_list:e.attend_list||[],repeat:e.repeat,id:e.id||a.StringUtil.generateRandomId(),layout:e.layout,height:e.height}}function c(e,t){var n=JSON.stringify((0,o.__assign)((0,o.__assign)({},e),{id:t}));return"".concat(i.FieldName.WXWORK_MEETING," ").concat(n)}function l(e){var t=s(e),n=JSON.stringify(t);return"".concat(i.FieldName.WXWORK_MEETING," ").concat(n)}function u(e,t){void 0===t&&(t=!1);try{var n=e;if(!t){var r=new RegExp("".concat(i.FieldName.WXWORK_MEETING," (.*)")).exec(e);n=(0,o.__read)(r,2)[1]}return s(JSON.parse(n))}catch(e){return}}!function(e){e.LOADED_CALLBACK="LOADED_CALLBACK"}(r||(r={}))},88622:function(e,t,n){n.d(t,{TK:function(){return a},bi:function(){return i}});var r=n(85556),o=n(2613);function i(e){var t=JSON.stringify({iconurl:e.iconurl,name:e.name,position:e.position,gender:e.gender,profile_code:e.profile_code,qrcodeurl:e.qrcodeurl,type:e.type,corp_name:e.corp_name,layout:e.layout});return"".concat(o.FieldName.MEMBER_CONTACT_CARD," ").concat(t)}function a(e,t){void 0===t&&(t=!1);try{var n=e;if(!t){var i=new RegExp("".concat(o.FieldName.MEMBER_CONTACT_CARD," (.*)")).exec(e);n=(0,r.__read)(i,2)[1]}var a=JSON.parse(n);return{iconurl:a.iconurl,name:a.name,position:a.position,gender:a.gender,profile_code:a.profile_code,qrcodeurl:a.qrcodeurl,type:a.type,corp_name:a.corp_name,layout:a.layout}}catch(e){return}}},73758:function(e,t,n){n.d(t,{Z:function(){return S}});var r,o,i,a,s=n(85556),c=n(87363),l=n.n(c),u=n(37769),d=n(27613),p=n(23403),f=n(2613),_=n(32747),h=n(20001),m={Inline:"tdocs-Inline",inline:"tdocs-Inline",Card:"tdocs-Card",card:"tdocs-Card",align_left:"tdocs-align_left",alignLeft:"tdocs-align_left",align_center:"tdocs-align_center",alignCenter:"tdocs-align_center",align_right:"tdocs-align_right",alignRight:"tdocs-align_right"},g=n(14740),v="layout",b="alignment",y=((r={})[f.FieldDisplayLayoutType.Inline]=(0,g.$t)("文字链"),r[f.FieldDisplayLayoutType.Card]=(0,g.$t)("card:card"),r),w=((o={})[f.STJcWml.left]=(0,g.$t)("左对齐"),o[f.STJcWml.center]=(0,g.$t)("居中对齐"),o[f.STJcWml.right]=(0,g.$t)("右对齐"),o),E=((i={})[f.STJcWml.right]="align_right",i[f.STJcWml.center]="align_center",i[f.STJcWml.left]="align_left",i),C=function(e){function t(t){var n=e.call(this,t)||this;return n.closeTimer=0,n.hide=function(){n.setState({show:!1})},n.scheduleHide=function(){n.cancelScheduleHide(),n.closeTimer=window.setTimeout(n.hide,300)},n.cancelScheduleHide=function(){n.closeTimer&&(window.clearTimeout(n.closeTimer),n.closeTimer=0)},n.handleClickItem=function(e,t,r,o){var i=n.props,a=i.onChangeLayout,s=i.onChangeAlignment,c=n.state,l=c.selectedLayout,u=c.selectedAlignment,d=o.id;t===v&&d!==l?(n.setState({selectedLayout:d,buttons:n.buildButtonConfig(d,n.state.selectedAlignment)}),n.handleMouseLeave(),a(d)):t===b&&d!==u&&(n.setState({selectedAlignment:d,buttons:n.buildButtonConfig(n.state.selectedLayout,d)}),n.handleMouseLeave(),s(d))},n.handleMouseLeave=function(){var e;null===(e=n.ref.current)||void 0===e||e.hideDropdown(),n.hide()},n.handleMouseEnter=function(){n.cancelScheduleHide()},n.state={show:!1,posX:0,posY:0,selectedLayout:f.FieldDisplayLayoutType.Card,selectedAlignment:f.STJcWml.left,buttons:n.buildButtonConfig(f.FieldDisplayLayoutType.Card,f.STJcWml.left)},n.ref=(0,c.createRef)(),n}return(0,s.__extends)(t,e),t.prototype.show=function(e){var t=e.posX,n=void 0===t?0:t,r=e.posY,o=void 0===r?0:r,i=e.layout,a=void 0===i?f.FieldDisplayLayoutType.Card:i,s=e.align,c=void 0===s?f.STJcWml.left:s;this.cancelScheduleHide();var l=c;[f.STJcWml.left,f.STJcWml.center,f.STJcWml.right].includes(c)||(l=f.STJcWml.left),this.setState({posX:n,posY:o,show:!0,selectedLayout:a,selectedAlignment:l,buttons:this.buildButtonConfig(a,l)})},t.prototype.buildButtonConfig=function(e,t){return[{id:v,type:_.F.DropdownButton,config:{icon:m[e],items:[f.FieldDisplayLayoutType.Inline,f.FieldDisplayLayoutType.Card].map((function(t){return{id:t,icon:m[t],name:y[t],isSelected:t===e}}))}},{id:b,type:_.F.DropdownButton,config:{icon:m[E[t]||E[f.STJcWml.left]],items:[f.STJcWml.left,f.STJcWml.center,f.STJcWml.right].map((function(e){return{id:e,name:w[e],icon:m["align_".concat(e)],isSelected:t===e}}))}}]},t.prototype.componentWillUnmount=function(){this.cancelScheduleHide()},t.prototype.render=function(){var e=this.state,t=e.show,n=e.posX,r=e.posY,o=e.buttons;return l().createElement(h.n,{ref:this.ref,visible:t,buttons:o,posX:n,posY:r,onClickCallback:function(){},onSeletedItemCallback:this.handleClickItem,onMouseLeave:this.handleMouseLeave,onMouseEnter:this.handleMouseEnter})},t}(l().Component),T=C;!function(e){e[e.Calendar=0]="Calendar",e[e.Meeting=1]="Meeting",e[e.GroupChat=2]="GroupChat",e[e.GroupContact=3]="GroupContact",e[e.MemberContact=4]="MemberContact",e[e.MiniProgram=5]="MiniProgram"}(a||(a={}));var x=function(){function e(e,t){var n=this;this.contextService=e,this.widgetService=t,this.toggleToolbar=function(e){return(0,s.__awaiter)(n,void 0,void 0,(function(){var t;return(0,s.__generator)(this,(function(n){return e.show?this.scheduleShow(e):(this.cancelShow(),null===(t=this.toolbar)||void 0===t||t.scheduleHide()),[2]}))}))},this.quitOnMobileConetxtMenuHide=function(){var e=n.getEditor();e&&e.on(f.RenderNotificationTypes.SELECTION_CHANGE,(function(e){null!=e.option&&null!=e.option.mobileContextMenu&&e.option.mobileContextMenu!==f.MobileContextMenuType.Hide||n.mobileContextMenuShow&&(n.mobileContextMenuShow=!1)}),n)},this.handleChangeLayout=function(e,t){t&&n.onChangeLayout&&n.onChangeLayout(e,t)},this.handleChangeAlignment=function(e,t){n.onChangeAlignment&&n.onChangeAlignment(e,t)},this.defaultChangeAlignment=function(e){var t=n.getEditor();if(t&&n.editingFieldIndex){var r=t.getRangeFromIndex(n.editingFieldIndex.first,n.editingFieldIndex.last);r.isValid()&&(t.setRangeTo(new f.GCPRange(r.begin())),t.service.getSelection().getParagraphFormat().setParagraphAlignment(e))}},this.mobileContextMenuShow=!1,this.mobileContextMenuHideBinded=!1}var t,n;return e.prototype.$onReset=function(){var e;this.toolbar=void 0,this.editingFieldIndex=void 0,this.displayTimer&&clearTimeout(this.displayTimer),this.onChangeLayout=void 0,this.onChangeAlignment=void 0,this.layout=void 0,this.type=void 0,this.mobileContextMenuShow=!1,this.mobileContextMenuHideBinded=!1,null===(e=this.getEditor())||void 0===e||e.removeListener(f.RenderNotificationTypes.SELECTION_CHANGE,this)},e.prototype.shouldHideMobileContextMenu=function(){return!this.mobileContextMenuShow},e.prototype.getCardType=function(){return this.type},e.prototype.setCardType=function(e){this.type=e},e.prototype.getFieldIndex=function(){return this.editingFieldIndex},e.prototype.setFieldIndex=function(e){this.editingFieldIndex=e},e.prototype.getLayout=function(){return this.layout||f.FieldDisplayLayoutType.Card},e.prototype.showMobileContextMenu=function(e){var t=this,n=e.type,r=e.fieldIndex,o=e.layout;this.type=n,this.editingFieldIndex=r,this.layout=o,this.mobileContextMenuShow=!0;var i=this.getEditor();if(i){var a=i.getRangeFromIndex(this.editingFieldIndex.first,this.editingFieldIndex.last),s=i.getViewRangeFromGcpRange(a);i.service.getSelection().setRange(a.begin(),a.end()),setTimeout((function(){s&&(i.fire(new f.ContextMenuMobileNotification(s)),t.mobileContextMenuHideBinded||(t.quitOnMobileConetxtMenuHide(),t.mobileContextMenuHideBinded=!0))}),50)}},e.prototype.scheduleShow=function(e){var t=this;this.cancelShow(),this.displayTimer=window.setTimeout((function(){t.show(e)}),500)},e.prototype.cancelShow=function(){this.displayTimer&&(window.clearTimeout(this.displayTimer),this.displayTimer=0)},e.prototype.show=function(e){var t=this,n=e.onChangeLayout,r=e.onChangeAlignment,o=void 0===r?this.defaultChangeAlignment:r,i=e.fieldIndex,a=(0,s.__rest)(e,["onChangeLayout","onChangeAlignment","fieldIndex"]);a.show&&(this.editingFieldIndex=i,this.onChangeLayout=n,this.onChangeAlignment=o),null==this.toolbar?(this.widgetService.embed({name:"wxwork-card-toolbar",component:l().createElement(T,{ref:function(e){e&&(t.toolbar=e)},onChangeLayout:function(e){return t.handleChangeLayout(e,t.editingFieldIndex)},onChangeAlignment:function(e){return t.handleChangeAlignment(e,t.editingFieldIndex)}})}),window.setTimeout((function(){var e;null===(e=t.toolbar)||void 0===e||e.show(a)}),10)):this.toolbar.show(a)},e.prototype.getEditor=function(){if(this.contextService.context.editor instanceof f.MeloEditor)return this.contextService.context.editor},e=(0,s.__decorate)([(0,u.t)(),(0,s.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==d.O&&d.O)?t:Object,"function"==typeof(n=void 0!==p.i&&p.i)?n:Object])],e)}(),S=x},35205:function(e,t,n){n.d(t,{r:function(){return p}});var r=n(85556),o=n(37769),i=n(42035),a=n(52739),s=n(93988),c=n.n(s),l=n(14740),u=n(24506),d=n(27379),p=function(){function e(e,t){var n=this;this.eventEmitter=e,this.extensionService=t,this.authExpTipsShowed=!1,this.login=function(){return(0,d.loginOnce)({extensionService:n.extensionService.extensionService})}}var t,n;return e.prototype.init=function(){var e=this;this.$sub=this.eventEmitter.listen("$requestLogin",this.login),c().setCallback((function(t){1e4===t.code?e.accountSwitched():10001===t.code&&e.onLoginExpire()}))},e.prototype.$onEditorClose=function(){var e;null===(e=this.$sub)||void 0===e||e.unsubscribe()},e.prototype.onLoginExpire=function(){this.authExpTipsShowed||(a.default.show({message:(0,l.$t)("登录过期"),action:(0,l.$t)("重新登录"),autoClose:!1,onClickAction:this.login}),this.authExpTipsShowed=!0)},e.prototype.accountSwitched=function(){a.default.show({message:(0,l.$t)("帐号信息变化"),action:(0,l.$t)("刷新"),type:"info",autoClose:!1,id:"checkIfAccountSwitched-1",closable:!0,onClickAction:function(){window.multiAccountUtil.reload()}})},e=(0,r.__decorate)([(0,o.t)(),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==i.v&&i.v)?t:Object,"function"==typeof(n=void 0!==u.$&&u.$)?n:Object])],e)}()},93117:function(e,t,n){n.r(t),n.d(t,{AbtestExpId:function(){return r},ControlGroupId:function(){return o},ExperimentalGroupId:function(){return i},ITabService:function(){return c}});var r,o,i,a=n(85556),s=n(3139);!function(e){e.innerImageOCR="EXP_20211117_Word_ocr"}(r||(r={})),function(e){e[e.innerImageOCR=3138342]="innerImageOCR"}(o||(o={})),function(e){e[e.innerImageOCR=3138343]="innerImageOCR"}(i||(i={}));var c=Symbol.for("service:tab");s.Ln.merge(c,{useFactory:function(){return(0,a.__awaiter)(void 0,void 0,void 0,(function(){return(0,a.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(2013).then(n.bind(n,92013))];case 1:return[2,e.sent().TabService]}}))}))}})},19543:function(e,t,n){n.d(t,{y:function(){return p}});var r=n(85556),o=n(2613),i=n(23336),a=n.n(i),s=n(44166),c=n(3139),l=n(27613),u=n(42035),d=n(30479),p=function(){function e(){}var t,n;return e.setTitle=function(e,t,n,i){return(0,r.__awaiter)(this,void 0,void 0,(function(){var s;return(0,r.__generator)(this,(function(r){return s=n.domainId,e=e.replace(/[\r\n]/gi,""),[2,new Promise((function(r,c){a().ajax({url:"/cgi-bin/online_docs/doc_changetitle",data:{domain_id:s,pad_id:n.padId,title:e,xsrf:(0,o.getXsrf)(),version:2,auto_change:t?1:0},success:function(o){o&&0===o.retcode?(t||(n.isUserChangeTitle=1),n.padTitle=e,n.title=e,r(o)):o&&10020===o.retcode?(n.isUserChangeTitle=1,c("changeTitle error: ERROR_AUTO_CHANGE_TITLE_DENIED")):o&&12e3===o.retcode?c("changeTitle error: ERROR_TITLE_BEAT_BY_SEC"):c("changeTitle error: ".concat(o.retcode)),i&&i(o)},error:function(){c()}})}))]}))}))},e.updateTitleReversion=function(e){var t=(0,s.Yi)();d.LocalStorageUtil.setItem("offline_title_reversion".concat(t.padId),e.toString())},e.getTitleReversionFromStore=function(){var e=(0,s.Yi)(),t=d.LocalStorageUtil.getItem("offline_title_reversion".concat(e.padId));return t?parseInt(t,10):0},e.docHumtrans=function(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t=this;return(0,r.__generator)(this,(function(n){return[2,new Promise((function(n,r){a().ajax({url:"/cgi-bin/online_docs/doc_humtrans",type:"POST",data:{domain_id:e.domainId,pad_id:e.padId,xsrf:(0,o.getXsrf)()},xhrFields:{withCredentials:!0},success:function(e){var r;0===e.cgicode&&0===e.retcode&&((0,s.Yi)().docStatus=0),null===(r=window.SLR)||void 0===r||r.dispatch("DOC_HUMTRANS_DONE"),t.eventEmitter.emit("$humtransDone"),n(e)},error:function(e){r(e)}})}))]}))}))},e.MAX_TITLE_LENGTH=128,(0,r.__decorate)([(0,c.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==l.O&&l.O)?t:Object)],e,"contextService",void 0),(0,r.__decorate)([(0,c.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==u.v&&u.v)?n:Object)],e,"eventEmitter",void 0),e}()},47114:function(e,t,n){n.d(t,{Do:function(){return l}});var r=n(85556),o=n(30479),i=n(14366),a=n(37769),s=n(21856),c="wx9612c6e5a5e43176",l=function(){function e(){var e=this;this.jssdk=s.X.getInstance().getConfig("custom.library.TENCENT_DOCS_LIBRARY__jweixin_1_6_0"),this.isEnt=!1,this.apiList=["chooseImage","getLocalImgData","getClipboardData","setClipboardData"],this.setupClient=function(){return e.loadJSSDK().then((function(){return e.getSignature()})).then((function(t){var n=t.noncestr,r=t.signature,o=t.timestamp;return new Promise((function(t,i){window.wx.config({appId:"wx46dfe750eef96da7",nonceStr:n,timestamp:o,signature:r,jsApiList:e.apiList}),window.wx.ready((function(){t()})),window.wx.error((function(e){i("wx set jsApiList fail, error msg: ".concat(e))}))}))}))},this.setupEnv=function(){return e.loadJSSDK().then((function(){return e.xhrGetWxConfig()})).then((function(t){var n=t.noncestr,r=t.signature,o=t.timestamp;return new Promise((function(t,i){window.wx.config({appId:c,nonceStr:n,timestamp:o,signature:r,jsApiList:e.apiList}),window.wx.ready((function(){t()})),window.wx.error((function(e){i("wx set jsApiList fail, error msg: ".concat(e))}))}))}))},this.loadJSSDK=function(){return new Promise((function(t,n){if(e.hasLoadedSDK())return t();document.head.appendChild(Object.assign(document.createElement("script"),{src:e.jssdk,crossOrigin:"anonymous",onload:function(){o.Logger.log("加载微信 sdk 接口 sucess"),t()},onerror:function(e){o.Logger.log("加载微信 sdk 接口 error",e),n()}}))}))},this.hasLoadedSDK=function(){if(void 0!==window.wx)return!0},this.getSignature=function(){return new Promise((function(t,n){(0,i.Z)({method:"get",url:"/v2/util/wechat/signature",params:{withCredentials:!0,url:e.getPageOriginHref()}}).then((function(e){var r=e.data,o=r.cgicode,i=r.retcode,a=r.msg;0===o&&0===i||n("wx get signature error, retcode: ".concat(i,", error msg: ").concat(a)),t(r)}))}))}}return e.prototype.setup=function(){(o.PlatformUtil.isWXFamily()||o.PlatformUtil.isWeWork())&&(this.isEnt?this.setupEnv():this.setupClient())},e.prototype.xhrGetWxConfig=function(){var e=new FormData;return e.append("url",window.location.href.split("#")[0]),e.append("appid",c),i.Z.post("/webdisk/jsapi",e)},e.prototype.getPageOriginHref=function(){try{return localStorage.getItem("tdocs-page-origin-href")||window.location.href}catch(e){return window.location.href}},e=(0,r.__decorate)([(0,a.t)()],e)}()},75571:function(e,t,n){n.d(t,{l3:function(){return r},r2:function(){return f}});var r,o=n(85556),i=n(30479),a=n(37769),s=n(2613),c=n(52739),l=n(50263),u=n(14740),d=n(25709),p=n(22595);!function(e){e[e.WholeDay=1]="WholeDay",e[e.Deleted=4096]="Deleted",e[e.CanJoin=524288]="CanJoin",e[e.Repeat=8]="Repeat"}(r||(r={}));var f=Symbol.for("service:IWxworkGroupchatService"),_=function(e){c.default.show({message:e,type:"info",autoClose:!0,duration:5e3})},h=function(e,t,n,r){if(0!==e){var o=r.isCalender,a=void 0!==o&&o,s=r.isMeeting;void 0!==s&&s&&function(e,t,n){switch(e){case 2:break;case 1:case 4:case 14007:_((0,u.$t)("操作失败"));break;case 6:_((0,u.$t)("无法使用，管理员已停用会议功能"));break;case 9:_((0,u.$t)("会议已被发起人取消"));break;case-66000036:_((0,u.$t)("帐号异常，会议功能暂时无法使用"));break;case-66000017:_((0,u.$t)("当前日程参与人数已达上限"));break;case-66000021:_((0,u.$t)("该日程已过期"));break;case-66000019:_((0,u.$t)("该日程已被组织人删除"));break;case-66000018:_((0,u.$t)("日程组织者已设置不允许加入"));break;case-66000022:case 139491e3:_((0,u.$t)("无法加入，会议参与人数已达上限"));break;case 10100005:_((0,u.$t)("会议进行中，无法修改会议"));break;case-66000024:_((0,u.$t)("操作失败，请稍后再试"));break;case-66000027:_((0,u.$t)("保存失败"));break;case 139491002:_((0,u.$t)("加入该会议需输入密码，请升级客户端版本"));break;case 139491001:_((0,u.$t)("密码错误"));break;case 139491003:_((0,u.$t)("该会议为网络研讨会，暂不支持添加成员"));break;case-66000039:_((0,u.$t)("会议进行中，请进入会议后邀请"));break;default:_(t)}}(e,t),a&&function(e,t,n){if(i.PlatformUtil.compareVersion((0,d.bW)(),"4.1.2")<0&&0!==e)_(t);else switch(e){case 2:break;case 6:_((0,u.$t)("无法使用，管理员已停用日程功能"));break;case 14007:_((0,u.$t)("操作失败"));break;default:_(t)}}(e,t)}},m=function(e,t,n,r){if(void 0===n&&(n=!0),void 0===r&&(r={}),window.tdocs[e])return window.tdocs[e](t).then((function(e){var t;if(0!==(null!==(t=e.retcode)&&void 0!==t?t:e.err_code))throw e;return e})).catch((function(e){var t,o=null!==(t=e.retcode)&&void 0!==t?t:e.err_code,i=e.errMsg||"操作失败，请重试[".concat(o,"]");throw n&&_(i),h(o,i,0,r),e}));if(n){if(l.A.isTencentMeetingInWework())return void _((0,u.$t)("演示中暂不支持此功能"));i.PlatformUtil.isWeWork()?_("请升级企业微信版本以使用此功能"):_("请在企业微信中使用此功能")}return Promise.reject()};function g(e){return function(t,n,r){var i=r.value;r.value=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(0,o.__awaiter)(this,void 0,void 0,(function(){var r;return(0,o.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,i.call.apply(i,(0,o.__spreadArray)([this],(0,o.__read)(t),!1))];case 1:return[2,a.sent()];case 2:return r=a.sent(),s.ReportHelper.weiMonitorCube((0,o.__assign)((0,o.__assign)({},e),{module:s.ICubeModule.Feature,msg:null==r?void 0:r.message,code:null==r?void 0:r.retcode,action:"[jsapi]".concat(n),ver1:null==r?void 0:r.stack})),[3,3];case 3:return[2]}}))}))}}}!function(){function e(){}var t,n,r,s,c,l,u,d,h,v,b,y,w,E,C,T,x,S,I,k,R,A;e.prototype.$onReset=function(){},e.prototype.isEnabled=function(){var e;return i.PlatformUtil.isWeWork()&&(null===(e=window.tdocs)||void 0===e?void 0:e.insertWxworkGroupChat)},e.prototype.insertWxworkGroupChat=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,m("insertWxworkGroupChat",e)]}))}))},e.prototype.isInWxworkGroupChat=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,m("isInWxworkGroupChat",e,!1)]}))}))},e.prototype.joinWxworkGroupChat=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,m("joinWxworkGroupChat",e)]}))}))},e.prototype.enterWxworkGroupChat=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,m("enterWxworkGroupChat",e)]}))}))},e.prototype.createWxworkNameCardSelf=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,m("createWxworkNameCardSelf",e)]}))}))},e.prototype.enterWxworkNameCard=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,m("enterWxworkNameCard",e)]}))}))},e.prototype.canChatWithWxworkNameCard=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,m("canChatWithWxworkNameCard",e)]}))}))},e.prototype.createWxworkCalender=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,m("createWxworkCalender",(0,o.__assign)((0,o.__assign)({},e),{type:"0"}),!1,{isCalender:!0})]}))}))},e.prototype.selectWxworkCalenderList=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,m("selectWxworkCalenderList",(0,o.__assign)({},e),!1,{isCalender:!0})]}))}))},e.prototype.viewDetailWxworkCalender=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,m("viewDetailWxworkCalender",e,!1,{isCalender:!0})]}))}))},e.prototype.queryWxworkCalenderInfo=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,m("queryWxworkCalenderInfo",e,!1)]}))}))},e.prototype.joinWxworkCalender=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,m("joinWxworkCalender",e,!1,{isCalender:!0})]}))}))},e.prototype.createWxworkMeeting=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,m("createWxworkCalender",(0,o.__assign)((0,o.__assign)({},e),{type:"1"}),!1,{isMeeting:!0})]}))}))},e.prototype.selectWxworkMeetingList=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,m("selectWxworkMeetingList",(0,o.__assign)({},e),!1,{isMeeting:!0})]}))}))},e.prototype.viewDetailWxworkMeeting=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,m("viewDetailWxworkMeeting",{docid:e.docid,meeting_id:e.meeting_id,submeeting_id:e.submeeting_id,meeting_code:e.meeting_code,sharekey:e.sharekey,access_url:e.access_url,creator_source:e.creator_source,x:e.x,y:e.y},!1,{isMeeting:!0})]}))}))},e.prototype.enterWxworkMeeting=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,m("enterWxworkMeeting",{docid:e.docid,meeting_id:e.meeting_id,submeeting_id:e.submeeting_id,meeting_code:e.meeting_code,sharekey:e.sharekey,access_url:e.access_url,creator_source:e.creator_source,x:e.x,y:e.y},!1,{isMeeting:!0})]}))}))},e.prototype.joinWxworkMeeting=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,m("joinWxworkMeeting",{docid:e.docid,meeting_id:e.meeting_id,submeeting_id:e.submeeting_id,meeting_code:e.meeting_code,sharekey:e.sharekey,access_url:e.access_url,creator_source:e.creator_source,x:e.x,y:e.y},!1,{isMeeting:!0})]}))}))},e.prototype.openMeetingRecord=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,m("openMeetingRecord",{url:e.url},!1,{isMeeting:!0})]}))}))},e.prototype.createTransferedChatMessageInfo=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,m("createTransferedChatMessageInfo",e,!1)]}))}))},e.prototype.openChatMessageDetail=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,m("openChatMessageDetail",e)]}))}))},e.prototype.insertApp=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,m("insertApp",e)]}))}))},e.prototype.openMiniProgram=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return i.PlatformUtil.isMac()?(_("Mac暂不支持打开小程序"),[2,{retcode:0,errMsg:""}]):[2,m("openMiniProgram",e,!1)]}))}))},(0,o.__decorate)([g({name:p.C.WxworkGroupContactCard}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(t="undefined"!=typeof Promise&&Promise)?t:Object)],e.prototype,"insertWxworkGroupChat",null),(0,o.__decorate)([g({name:p.C.WxworkGroupContactCard}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(n="undefined"!=typeof Promise&&Promise)?n:Object)],e.prototype,"isInWxworkGroupChat",null),(0,o.__decorate)([g({name:p.C.WxworkGroupContactCard}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(r="undefined"!=typeof Promise&&Promise)?r:Object)],e.prototype,"joinWxworkGroupChat",null),(0,o.__decorate)([g({name:p.C.WxworkGroupContactCard}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(s="undefined"!=typeof Promise&&Promise)?s:Object)],e.prototype,"enterWxworkGroupChat",null),(0,o.__decorate)([g({name:p.C.WxworkMemberContactCard}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(c="undefined"!=typeof Promise&&Promise)?c:Object)],e.prototype,"createWxworkNameCardSelf",null),(0,o.__decorate)([g({name:p.C.WxworkMemberContactCard}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(l="undefined"!=typeof Promise&&Promise)?l:Object)],e.prototype,"enterWxworkNameCard",null),(0,o.__decorate)([g({name:p.C.WxworkMemberContactCard}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(u="undefined"!=typeof Promise&&Promise)?u:Object)],e.prototype,"canChatWithWxworkNameCard",null),(0,o.__decorate)([g({name:p.C.WxworkCalender}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(d="undefined"!=typeof Promise&&Promise)?d:Object)],e.prototype,"createWxworkCalender",null),(0,o.__decorate)([g({name:p.C.WxworkCalender}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(h="undefined"!=typeof Promise&&Promise)?h:Object)],e.prototype,"selectWxworkCalenderList",null),(0,o.__decorate)([g({name:p.C.WxworkCalender}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(v="undefined"!=typeof Promise&&Promise)?v:Object)],e.prototype,"viewDetailWxworkCalender",null),(0,o.__decorate)([g({name:p.C.WxworkCalender}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(b="undefined"!=typeof Promise&&Promise)?b:Object)],e.prototype,"queryWxworkCalenderInfo",null),(0,o.__decorate)([g({name:p.C.WxworkCalender}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(y="undefined"!=typeof Promise&&Promise)?y:Object)],e.prototype,"joinWxworkCalender",null),(0,o.__decorate)([g({name:p.C.WxworkMeeting}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(w="undefined"!=typeof Promise&&Promise)?w:Object)],e.prototype,"createWxworkMeeting",null),(0,o.__decorate)([g({name:p.C.WxworkMeeting}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(E="undefined"!=typeof Promise&&Promise)?E:Object)],e.prototype,"selectWxworkMeetingList",null),(0,o.__decorate)([g({name:p.C.WxworkMeeting}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(C="undefined"!=typeof Promise&&Promise)?C:Object)],e.prototype,"viewDetailWxworkMeeting",null),(0,o.__decorate)([g({name:p.C.WxworkMeeting}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(T="undefined"!=typeof Promise&&Promise)?T:Object)],e.prototype,"enterWxworkMeeting",null),(0,o.__decorate)([g({name:p.C.WxworkMeeting}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(x="undefined"!=typeof Promise&&Promise)?x:Object)],e.prototype,"joinWxworkMeeting",null),(0,o.__decorate)([g({name:p.C.WxworkMeeting}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(S="undefined"!=typeof Promise&&Promise)?S:Object)],e.prototype,"openMeetingRecord",null),(0,o.__decorate)([g({name:p.C.WxworkGroupChat}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(I="undefined"!=typeof Promise&&Promise)?I:Object)],e.prototype,"createTransferedChatMessageInfo",null),(0,o.__decorate)([g({name:p.C.WxworkGroupChat}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(k="undefined"!=typeof Promise&&Promise)?k:Object)],e.prototype,"openChatMessageDetail",null),(0,o.__decorate)([g({name:p.C.WxworkApp}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(R="undefined"!=typeof Promise&&Promise)?R:Object)],e.prototype,"insertApp",null),(0,o.__decorate)([g({name:p.C.WxworkApp}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(A="undefined"!=typeof Promise&&Promise)?A:Object)],e.prototype,"openMiniProgram",null),e=(0,o.__decorate)([(0,a.t)({provide:f})],e)}()},88619:function(e,t,n){n(9517);var r=n(28301);window.multiAccountUtil={getMultiUrl:r.getMultUrl,reload:function(e){var t=(0,r.getMultUrl)(window.location.href);e?window.location.assign(t):window.location.href=t}}},4788:function(e,t,n){var r=n(85556),o=(n(88619),n(12036)),i=n(38298),a=function(){function e(){}return e.prototype.tdwReport=function(e,t){(0,i.tdw)(e,t)},e.prototype.tdwReportSingle=function(e){(0,i.tdwSingle)(e)},e.prototype.setPadType=function(e){window.clientVars&&(window.clientVars.padType=e,(0,i.resetDefaultTdwData)())},e}();window.ClientVarsPromise&&window.ClientVarsPromise.then((function(){(0,i.resetDefaultTdwData)()}));var s,c=n(44166),l=function(){function e(){}return e.prototype.zzsStatus=function(e){var t,n;(0,i.zzsStatus)({attrid:e.attributeId,status:e.status,errmsg:e.errorMessage,dimensions:(0,r.__spreadArray)([this.getDocVersion(),String(null!==(t=e.errorCode)&&void 0!==t?t:0)],(0,r.__read)(null!==(n=e.otherDimensions)&&void 0!==n?n:[]),!1)})},e.prototype.zzsValue=function(e,t){var n=window.location,r=n.origin,o=n.pathname;(0,i.zzsValue)({attrid:e,value:t,dimensions:[this.getDocVersion(),(0,c.Yi)().padId,"".concat(r).concat(o)]})},e.prototype.getDocVersion=function(){var e,t;return null===(t=null===(e=(0,c.Yi)().collab_client_vars)||void 0===e?void 0:e.dver)||void 0===t?void 0:t.substr(0,3)},e}(),u=function(){function e(){}return e.prototype.idkeyReport=function(e,t,n){(0,i.idkey)(t,e,n)},e}(),d=n(2613),p=n(30479),f=((s={})[d.OSSPlatformType.Default]=function(){return p.PlatformUtil.isMac()?"mac":"win"},s[d.OSSPlatformType.Wedoc]=function(){return p.PlatformUtil.isWeWork()?/isConversationEmbedded=1/.test(window.location.search)?"timeline":"client":p.PlatformUtil.isWXFamily()?"wechat":"browser"},s),_=function(){function e(){}return e.prototype.ossReport=function(e){i.KVR.oss(e)},e.prototype.getPlatform=function(e){var t;return void 0===e&&(e=d.OSSPlatformType.Default),null===(t=f[e])||void 0===t?void 0:t.call(f)},e}(),h=function(){function e(){}return e.prototype.aegisReport=function(e){var t;null===(t=window.aegis)||void 0===t||t.reportEvent(e)},e.prototype.reportError=function(e){var t;null===(t=window.aegis)||void 0===t||t.error(e)},e}(),m=new Map([["playBackgroundMusic",d.MonitorName.IGNORE_JS_ERROR_PLAY_BACKGROUND_MUSIC],["setKeyboardHeight is not defined",d.MonitorName.IGNORE_JS_ERROR_SET_KEYBOARD_HEIGHT],["Cannot read property 'test' of undefined",d.MonitorName.IGNORE_JS_ERROR_TEST],["WeixinJSBridge",d.MonitorName.IGNORE_JS_ERROR_WEIXIN_JSBRIDGE],["__wx._ready is not a function",d.MonitorName.IGNORE_JS_ERROR_WEIXIN_JSBRIDGE],["captured exception, need break and refresh",d.MonitorName.IGNORE_JS_ERROR_CAPTURED_EXCEPTION],["reLocateForNative is not defined",d.MonitorName.IGNORE_JS_ERROR_RELOCATEFORNATIVE],["null is not an object (evaluating 'document.getElementById('common-banner-mo').style')",d.MonitorName.IGNORE_JS_ERROR_COMMON_BANNER],["vivoNewsDetailPage",d.MonitorName.IGNORE_JS_ERROR_VIVO],["x5onSkinSwitch is not defined",d.MonitorName.IGNORE_JS_ERROR_X5],["cefQuery is not defined",d.MonitorName.IGNORE_JS_ERROR_CEFQUERY],["ExecuteJsInterface",d.MonitorName.IGNORE_JS_ERROR_EXECUTE_JS_INTERFACE],["qtconfig is not defined",d.MonitorName.IGNORE_JS_ERROR_QTCONFIG],["null is not an object (evaluating 'document.getElementById('np_id').innerText')",d.MonitorName.IGNORE_JS_ERROR_QTCONFIG],["null is not an object (evaluating 'document.getElementById('p_is_not_community').innerText')",d.MonitorName.IGNORE_JS_ERROR_QTCONFIG],["$skyuc_src",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["MacPlayer",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["Player is not defined",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["Can't find variable: Player",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["theurl is not defined",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["Can't find variable: theurl",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["null is not an object (evaluating 'document.getElementById('Xfplay').innerHTML')",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["window.parent.param",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["window.mttLongPressVar.tagName",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["ToutiaoJSBridge",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["OnReceiveTransparentMsg",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["processRandomSelector",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["ucbrowser",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["updateBookMallStatus",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["Umeditor",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["ZhihuiOS",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["document.getElementsByTagName('video')[0].setAttribute",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["Cannot read property 'content' of undefined",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["extractNovelContent",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["zhShareHandler",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["window.bannerNight is not a function",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["ResizeObserver loop limit exceeded",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["Cannot read property 'Webview' of undefined",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["ResizeObserver loop limit exceeded",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION]]),g=Array.from(m.keys()),v=new Map([[d.MonitorName.JQUERY_REWRITE_ERROR,33871763],[d.MonitorName.FRAME_DROP_NORMAL,33670974],[d.MonitorName.FRAME_DROP_SERIOUS,33711514],[d.MonitorName.FRAME_DROP_REPORT,35340879]]),b=new Map([]),y=new Map([[d.MonitorName.JQUERY_REWRITE_ERROR,"72001"],[d.MonitorName.CHANGESET_ERROR_DELTA2CS,"72101"],[d.MonitorName.CHANGESET_ERROR_VERIFY,"72102"],[d.MonitorName.CHANGESET_ERROR_VERIFY_MODELEN,"72103"],[d.MonitorName.CHANGESET_ERROR_APPLY_ONLINE,"72104"],[d.MonitorName.CHANGESET_ERROR_APPLY_DELTA,"72108"],[d.MonitorName.CHANGESET_ERROR_APPLY_MUTATION,"72109"]]),w="log",E="4",C=n(23336),T=n.n(C),x=n(3139),S=n(27613),I="BaseMonitorHandler",k=function(){function e(){this.lastJquery=T(),this.hasJqueryErrorReport=!1,this.didLogError=!1,this.logErrorCount=0,this.isAutoTest=!1,this.mutLenDimensionsStr=""}var t;return e.prototype.initMonitorErrorReport=function(){var e=this;try{window.addEventListener("error",(function(t){e.handleJsError(t)}))}catch(e){console.error(e)}var t=o.M.getUrlParameter("currentEnv");t&&"autotest"===t&&(this.isAutoTest=!0)},e.prototype.monitor=function(e){this.monitor007Status(e);var t=this.getMonitorId(e);t&&t>0?this.doMonitor(t):p.Logger.error(I,"monitor(".concat(e,") with monitorId:").concat(t," is not allowed"))},e.prototype.monitorWtihPlatform=function(e){this.monitor007Status(e);var t=this.getMonitorInfo(e);if(t){var n=void 0;(n=p.PlatformUtil.isMac()?t.MAC:t.PC)>0?this.doMonitor(n):p.Logger.error(I,"monitorWtihPlatform(".concat(e,") with monitorId:").concat(n," is not allowed")),t.TOTAL>0?this.doMonitor(t.TOTAL):p.Logger.error(I,"monitorWtihPlatform(".concat(e,") with monitorId:").concat(t.TOTAL," is not allowed"))}else p.Logger.error(I,"monitorWtihPlatform(".concat(e,") with monitorInfo:").concat(t," is not allowed"))},e.prototype.monitor007Status=function(e,t,n,r){var o,a,s;void 0===t&&(t=d.Status007.SUCCESS);var l=null!==(o=null==r?void 0:r.errorCode)&&void 0!==o?o:0,u=null!==(a=null==r?void 0:r.isOffline)&&void 0!==a&&a;(0,i.zzsStatus)({attrid:e,status:t,errmsg:n,dimensions:[null===(s=(0,c.Yi)().collab_client_vars.dver)||void 0===s?void 0:s.substr(0,3),String(l),String(u),this.getChunk(),this.getMutLenDimensionsStr()]})},e.prototype.monitor007Value=function(e,t){var n,r=window.location,o=r.origin,a=r.pathname;(0,i.zzsValue)({attrid:e,value:t,dimensions:[null===(n=(0,c.Yi)().collab_client_vars.dver)||void 0===n?void 0:n.substr(0,3),(0,c.Yi)().padId,"".concat(o).concat(a),this.getChunk(),this.getMutLenDimensionsStr()]})},e.prototype.getChunk=function(){var e;return(null===(e=(0,c.Yi)().collab_client_vars)||void 0===e?void 0:e.isChunked)?"chunk":""},e.prototype.getMutLenDimensionsStr=function(){if(this.mutLenDimensionsStr)return this.mutLenDimensionsStr;if(!window.pad)return"";var e=window.pad.editor.state.dataEngine.getMutNum()||0;return e?(this.mutLenDimensionsStr=0<=e&&e<500?"MUT_0_500":e<1e3?"MUT_500_1K":e<2e3?"MUT_1K_2K":e<5e3?"MUT_2K_5K":e<1e4?"MUT_5K_10K":e<2e4?"MUT_10K_20K":e<5e4?"MUT_20K_50K":e<1e5?"MUT_50K_100K":"MUT_100K_INF",this.mutLenDimensionsStr):""},e.prototype.doMonitor=function(e){(0,i.monitor)(e)},e.prototype.getMonitorId=function(e){return v.get(e)},e.prototype.getMonitorInfo=function(e){return b.get(e)},e.prototype.validateErrorEvent=function(e){return!(o.M.isDevEvn()||(this.isAutoTest?(d.ReportHelper.captureException(d.MonitorName.AUTO_TEST_ERROR,{},e.error),1):this.checkNonEditError(e)||this.checkInjectError(e)))},e.prototype.handleJsError=function(e){var t=e||{},n=t.lineno,r=t.message,i=t.colno,a=t.filename,s=t.error,c="".concat(r," ").concat(a,":").concat(n,":").concat(i);if(p.Logger.error(I,c,null==s?void 0:s.message,null==s?void 0:s.stack),this.validateErrorEvent(e)&&(this.checkJqueryRewriteError(),!this.reportIgnoreError(e))){this.monitorWtihPlatform(d.MonitorName.JS_ERROR_RELEASE),o.M.isGrayEvn()&&this.monitorWtihPlatform(d.MonitorName.JS_ERROR_GRAY);var l=this.contextService.context.appid;l&&this.monitor(d.MonitorName.JS_ERROR_TOB),this.didLogError||(this.didLogError=!0,this.monitor007Status(d.MonitorName.JS_ERROR_RELEASE_ONCE_3_0),this.monitorWtihPlatform(d.MonitorName.JS_ERROR_RELEASE_ONCE),l&&this.monitorWtihPlatform(d.MonitorName.JS_ERROR_TOB_ONCE),d.ReportHelper.tdwReport({opername:"tech_melo_quality",module:"page_detail",action:"js_error",ver5:c,ver6:null==s?void 0:s.stack,ver7:window.__globalReleaseVersion})),this.logErrorCount+=1,10!==this.logErrorCount&&100!==this.logErrorCount||d.ReportHelper.captureException(10===this.logErrorCount?d.MonitorName.JS_ERROR_FREQUENT:d.MonitorName.JS_ERROR_FREQUENT_HUNDRED,{},e.error)}},e.prototype.checkNonEditError=function(e){var t=e&&e.error&&e.error.stack;if(t){var n=t.split("\n    at ");if(n&&n[1]){if(n[1].indexOf("tim/docs/components")>=0)return d.ReportHelper.captureException(d.MonitorName.NON_EDIT_ERROR,{logger:d.RavenLogger.NON_EDIT_ERROR},e.error),!0;if(n[1].indexOf("chrome-extension")>=0)return!0}}return!1},e.prototype.checkJqueryRewriteError=function(){this.hasJqueryErrorReport||this.lastJquery===T()||(d.ReportHelper.captureException(d.MonitorName.JQUERY_REWRITE_ERROR,{option:{needBreakAndRefresh:!0}}),this.hasJqueryErrorReport=!0)},e.prototype.reportIgnoreError=function(e){var t=this,n=e&&e.message||"",r=!1;return m.forEach((function(e,o){n.match(o)&&(t.monitor(e),r=!0)})),r},e.prototype.checkInjectError=function(e){if(e&&!e.error&&"Script error."===e.message&&["lofter","tieba","MiuiBrowser","zhihu","HuaweiBrowser","VivoBrowser","UCBrowser"].some((function(e){return navigator.userAgent.match(e)})))return!0;var t=e&&e.error&&e.error.stack;return!(!t||t.split("\n    at ").slice(1).some((function(e){return e.indexOf("<anonymous>:")<0})))},(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==S.O&&S.O)?t:Object)],e.prototype,"contextService",void 0),e}(),R=n(21856),A=R.X.getInstance().getConfig("custom.links.defaultDsn"),O=[{test:function(e){return e&&e.logger&&e.logger===d.RavenLogger.CHANGESET_COMMIT},dsn:R.X.getInstance().getConfig("custom.links.changesetCommitDsn"),project:"1117"},{test:function(e){return e&&e.logger&&e.logger===d.RavenLogger.ACTIVE_REPORT},dsn:R.X.getInstance().getConfig("custom.links.activeReportDsn"),project:"1136"},{test:function(e){return e&&e.logger&&e.logger===d.RavenLogger.NON_EDIT_ERROR},dsn:R.X.getInstance().getConfig("custom.links.nonEditErrorDsn"),project:"1794"},{test:function(){return!0},dsn:A,project:"1232"}],L=new Map([[d.MonitorName.WHITESCREEN,0],[d.MonitorName.CHANGESET_ERROR_RELEASE,34602383],[d.MonitorName.CHANGESET_ERROR_GRAY,34602384],[d.MonitorName.CHANGESET_ERROR_TOB,35130144],[d.MonitorName.CHANGESET_ERROR_ONCE,34725847],[d.MonitorName.CHANGESET_ERROR_CONTINUE,34793477],[d.MonitorName.CHANGESET_ERROR_INIT,34643531],[d.MonitorName.CHANGESET_ERROR_APPLY_DELTA,34643532],[d.MonitorName.CHANGESET_ERROR_DELTA2CS,34643533],[d.MonitorName.CHANGESET_ERROR_APPLY_OFFLINE,34643534],[d.MonitorName.CHANGESET_ERROR_APPLY_ONLINE,34643535],[d.MonitorName.CHANGESET_ERROR_EASYSYNC,34643536],[d.MonitorName.CHANGESET_ERROR_VERIFY,34643537],[d.MonitorName.CHANGESET_ERROR_VERIFY_MODELEN,34866646],[d.MonitorName.CHANGESET_ERROR_MAIN_RANGE,34644993],[d.MonitorName.JS_ERROR_TOB,35130141],[d.MonitorName.HTML_PARSE_ERROR,34622047],[d.MonitorName.NON_EDIT_ERROR,34760843],[d.MonitorName.AUTO_TEST_ERROR,34884338],[d.MonitorName.DATA_PRODUCE,34784731],[d.MonitorName.DATA_PRODUCE_TABLE_HEADER,34784732],[d.MonitorName.DATA_PRODUCE_TABLE,34784733],[d.MonitorName.DATA_TRANSFORM,34784734],[d.MonitorName.DATA_TRANSFORM_TABLE,34784735],[d.MonitorName.DATA_VERIFY,34784736],[d.MonitorName.DATA_COMPOSE,34784737],[d.MonitorName.DATA_COMPOSE_TABLE_HEADER,34784738],[d.MonitorName.DATA_COMPOSE_TABLE,34784739],[d.MonitorName.DATA_ACCEPT,34784740],[d.MonitorName.DATA_ACCEPT_TABLE_HEADER,34784741],[d.MonitorName.DATA_ACCEPT_TABLE,34784742],[d.MonitorName.DATA_PRODUCE_ERROR_FRONT,34784743],[d.MonitorName.DATA_PRODUCE_ERROR_BACK,34784744],[d.MonitorName.DATA_PRODUCE_ERROR_TIMEOUT,34868728],[d.MonitorName.DATA_PRODUCE_ERROR_TIPS,34868729],[d.MonitorName.DATA_PRODUCE_LITTLE_UNCOMMIT,34868730],[d.MonitorName.HOT_UPGRADE,34793469],[d.MonitorName.HOT_UPGRADE_STOCK,34795331],[d.MonitorName.TABLE_MERGE,34972282],[d.MonitorName.HAS_TABLE,35097880],[d.MonitorName.PV_PUBLISH,35023644],[d.MonitorName.PV_TOB,35118503],[d.MonitorName.TABLE_DATA_CHECK_FAILED,35081471],[d.MonitorName.TABLE_DATA_FIX_FAILED,35089798],[d.MonitorName.COMMENT_INVALID_PLACEHOLDER,35118873],[d.MonitorName.COMMENT_REPEAT_FIX,35130600],[d.MonitorName.COMMENT_UPGRADE,35129282],[d.MonitorName.LAYOUT_MISSING_CONTENT,35567498],[d.MonitorName.LAYOUT_TABLE_FAILED,35666218],[d.MonitorName.REFLOWLAYOUT_TABLE_FAILED,35677667]]),M=new Map([[d.MonitorName.WHITESCREEN,0],[d.MonitorName.CHANGESET_ERROR_RELEASE,1],[d.MonitorName.CHANGESET_ERROR_GRAY,2],[d.MonitorName.CHANGESET_ERROR_TOB,3],[d.MonitorName.CHANGESET_ERROR_ONCE,4],[d.MonitorName.CHANGESET_ERROR_CONTINUE,5],[d.MonitorName.CHANGESET_ERROR_INIT,6],[d.MonitorName.CHANGESET_ERROR_APPLY_DELTA,7],[d.MonitorName.CHANGESET_ERROR_DELTA2CS,8],[d.MonitorName.CHANGESET_ERROR_APPLY_OFFLINE,9],[d.MonitorName.CHANGESET_ERROR_APPLY_ONLINE,10],[d.MonitorName.CHANGESET_ERROR_EASYSYNC,11],[d.MonitorName.CHANGESET_ERROR_VERIFY,12],[d.MonitorName.CHANGESET_ERROR_VERIFY_MODELEN,13],[d.MonitorName.CHANGESET_ERROR_MAIN_RANGE,14],[d.MonitorName.JS_ERROR_TOB,15],[d.MonitorName.HTML_PARSE_ERROR,16],[d.MonitorName.NON_EDIT_ERROR,17],[d.MonitorName.AUTO_TEST_ERROR,18],[d.MonitorName.DATA_PRODUCE,19],[d.MonitorName.DATA_PRODUCE_TABLE_HEADER,20],[d.MonitorName.DATA_PRODUCE_TABLE,21],[d.MonitorName.DATA_TRANSFORM,22],[d.MonitorName.DATA_TRANSFORM_TABLE,23],[d.MonitorName.DATA_VERIFY,24],[d.MonitorName.DATA_COMPOSE,25],[d.MonitorName.DATA_COMPOSE_TABLE_HEADER,26],[d.MonitorName.DATA_COMPOSE_TABLE,27],[d.MonitorName.DATA_ACCEPT,28],[d.MonitorName.DATA_ACCEPT_TABLE_HEADER,29],[d.MonitorName.DATA_ACCEPT_TABLE,30],[d.MonitorName.DATA_PRODUCE_ERROR_FRONT,31],[d.MonitorName.DATA_PRODUCE_ERROR_BACK,32],[d.MonitorName.DATA_PRODUCE_ERROR_TIMEOUT,33],[d.MonitorName.DATA_PRODUCE_ERROR_TIPS,34],[d.MonitorName.DATA_PRODUCE_LITTLE_UNCOMMIT,35],[d.MonitorName.HOT_UPGRADE,36],[d.MonitorName.HOT_UPGRADE_STOCK,37],[d.MonitorName.TABLE_MERGE,38],[d.MonitorName.HAS_TABLE,39],[d.MonitorName.PV_PUBLISH,40],[d.MonitorName.PV_TOB,41],[d.MonitorName.TABLE_DATA_CHECK_FAILED,42],[d.MonitorName.TABLE_DATA_FIX_FAILED,43],[d.MonitorName.COMMENT_INVALID_PLACEHOLDER,44],[d.MonitorName.COMMENT_REPEAT_FIX,45],[d.MonitorName.COMMENT_UPGRADE,46],[d.MonitorName.LAYOUT_MISSING_CONTENT,47],[d.MonitorName.LAYOUT_TABLE_FAILED,48],[d.MonitorName.REFLOWLAYOUT_TABLE_FAILED,49],[d.MonitorName.REACT_ERROR_BOUNDARY,50],[d.MonitorName.OPENDOC30_WITH_21DATA,51],[d.MonitorName.LAYOUT_ERROR,52],[d.MonitorName.SYNC_IMPORT_FAILED,53]]);M.forEach((function(e,t){M.set(t,e+60)}));var N=new Map([[d.MonitorName.JS_ERROR_RELEASE,{ANDROID:34278275,IOS:34278276,MAC:34278277,PC:34278278,TOTAL:34278279}],[d.MonitorName.JS_ERROR_RELEASE_ONCE,{ANDROID:34278280,IOS:34278281,MAC:34278282,PC:34278283,TOTAL:34278284}],[d.MonitorName.JS_ERROR_GRAY,{ANDROID:34278285,IOS:34278286,MAC:34278287,PC:34278288,TOTAL:34278289}],[d.MonitorName.JS_ERROR_TOB_ONCE,{ANDROID:35148829,IOS:35148830,MAC:35148831,PC:35148832,TOTAL:35137422}],[d.MonitorName.PV,{ANDROID:34446817,IOS:34446818,MAC:34446819,PC:34446820,TOTAL:34446821}]]),D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.getMonitorId=function(t){return L.has(t)?L.get(t):e.prototype.getMonitorId.call(this,t)},t.prototype.getMonitorInfo=function(t){return N.has(t)?N.get(t):e.prototype.getMonitorInfo.call(this,t)},t.prototype.monitor=function(t){e.prototype.monitor.call(this,t)},t.prototype.monitorWtihPlatform=function(t){e.prototype.monitorWtihPlatform.call(this,t)},t.prototype.reportIdKey=function(e){var t=M.get(e);void 0!==t&&d.ReportHelper.idkeyReport(t,d.IdkeyType.MONITOR)},t}(k),P=n(63184),F=n(13980),B=function(e){function t(){var n=e.call(this,"captured exception, need break and refresh")||this;return Object.setPrototypeOf(n,t.prototype),n}return(0,r.__extends)(t,e),t}(Error),U=function(){function e(){this.didLogError=!1,this.needBreakAndRefresh=!1}var t;return e.prototype.captureException=function(e,t,n){var r,i=t.option||{};if(delete t.option,n instanceof B&&i.needBreakAndRefresh)throw n;var a=n||new Error,s=o.M.isDevEvn()?"_DEV":"",c=a.name?"_".concat(a.name):"";if(a.name="".concat(e).concat(c).concat(s),t.logger===d.RavenLogger.CHANGESET_COMMIT&&(this.didLogError&&(a.name+="_CONTINUE"),a.message+="\ntype: ".concat(a.name,",changesetLog: ").concat(JSON.stringify(d.GlobalContext.run(P.Rh.get))),null===(r=window.aegis)||void 0===r||r.error(a)),this.buildAdditionalData(e,t),window.Raven&&window.Raven.captureException(a,t),o.M.isDevEvn()||(d.ReportHelper.monitor(e),t.logger===d.RavenLogger.CHANGESET_COMMIT&&(d.ReportHelper.monitor(d.MonitorName.CHANGESET_ERROR_RELEASE),o.M.isGrayEvn()&&d.ReportHelper.monitor(d.MonitorName.CHANGESET_ERROR_GRAY),this.contextService.context.appid&&d.ReportHelper.monitor(d.MonitorName.CHANGESET_ERROR_TOB),this.didLogError?d.ReportHelper.monitor(d.MonitorName.CHANGESET_ERROR_CONTINUE):(this.didLogError=!0,d.ReportHelper.monitor(d.MonitorName.CHANGESET_ERROR_ONCE)))),i.needBreakAndRefresh){this.needBreakAndRefresh=!0;var l=function(e){return y.get(e)||"72999"}(e);throw p.Logger.info("captureException","errorCode:".concat(l)),this.contextService.context.collabCenterAdapter.disconnect(a.toString(),Number(l)),new B}},e.prototype.buildAdditionalData=function(e,t){t.extra||(t.extra={}),t.tags||(t.tags={});var n=(0,c.Yi)();return n&&(t.extra.padId=n.padId,t.tags.padId=n.padId),t},e.prototype.initSentryErrorReport=function(){var e,t,n=this,r=0;if(window.addEventListener("error",(function(){r+=1})),this.setTagsContext(),window.Raven&&window.Raven.config(this.getDefaultDsn(),{release:window.__globalReleaseVersion,ignoreErrors:g,dataCallback:function(e){n.dataCallback(e)},autoBreadcrumbs:{xhr:!1},sampleRate:.1,shouldSendCallback:function(){var e;return!(!(null===(e=window.__globalReleaseVersion)||void 0===e?void 0:e.match("(release_|hotfix_)"))||r>9)}}).install(),window.aegis){var o=null!==(e=window.__globalReleaseVersion)&&void 0!==e?e:"",i=null===(t=(0,c.Yi)().collab_client_vars.dver)||void 0===t?void 0:t.substr(0,3);window.aegis.setConfig({version:"".concat(i,"_").concat(o),beforeRequest:function(e){var t,n;if(e.logType===w&&(null===(t=null==e?void 0:e.logs)||void 0===t?void 0:t.level)===E&&(null===(n=null==e?void 0:e.logs)||void 0===n?void 0:n.msg)){var r=g.some((function(t){var n;return null===(n=null==e?void 0:e.logs)||void 0===n?void 0:n.msg.match(t)}));if(r)return!1;var i=o.split("-").pop();return e.log.msg="[".concat(i,"]").concat(e.log.msg),e}return e}}),window.aegis.reportEvent("page_view")}},e.prototype.dataCallback=function(e){var t=this.getSentryConfigList();if(t&&t.length>0)for(var n=0;n<t.length;n++){var r=t[n];if(r.test&&r.test(e)){e.project!==r.project&&(window.Raven&&window.Raven.setDSN(r.dsn),e.project=r.project);break}}return p.Logger.raven(e)},e.prototype.setTagsContext=function(){var e;try{var t={platform:"pc",uid:(0,F.getUid)(),environment:o.M.isDevEvn()?"development":"production",codeVer:null===(e=(0,c.Yi)().collab_client_vars.dver)||void 0===e?void 0:e.substr(0,3),currentEnv:o.M.getUrlParameter("currentEnv")||""};window.Raven&&window.Raven.setTagsContext(t)}catch(e){p.Logger.error(e)}},(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==S.O&&S.O)?t:Object)],e.prototype,"contextService",void 0),e}(),H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.getDefaultDsn=function(){return A},t.prototype.getSentryConfigList=function(){return O},t}(U);window.ReportHelper=d.ReportHelper;var j=n(67480),W=n(83835),V=n(36402);function z(){return V.d.decorate(W.MO)}n(85585).A.set(W.MO,(function(e){var t,n=e.runner.point,r=n.from,o=n.name;return null!==(t=x.Am.get(r).getUIConfig(o))&&void 0!==t?t:{name:o}}));var G=n(26454),Y=n(42098),q=n(15857),Z=function(){function e(){}var t;return e.prototype.use=function(e,t){return!1!==e.respectPermission&&!q.qO.getInstance().isEditableCompute&&(t(),!0)},(0,r.__decorate)([(0,r.__param)(0,z()),(0,r.__param)(1,(0,G.o)()),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==j.ToolbarConfig&&j.ToolbarConfig)?t:Object,Object]),(0,r.__metadata)("design:returntype",void 0)],e.prototype,"use",null),e=(0,r.__decorate)([(0,Y.d)()],e)}(),J=n(30121),K=n(97772),Q=function(){function e(){}var t;return e.prototype.use=function(e,t){return!(!e||!(0,K.B)(e)||!e.state.dataEngine.getIsChunkLoadReadonly()||(t(),0))},(0,r.__decorate)([(0,r.__param)(0,(0,J.M)()),(0,r.__param)(1,(0,G.o)()),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==d.MeloEditor&&d.MeloEditor)?t:Object,Object]),(0,r.__metadata)("design:returntype",void 0)],e.prototype,"use",null),e=(0,r.__decorate)([(0,Y.d)()],e)}(),X=n(19082),ee=n(47),te=n(81866),ne=n(58905),re=n(81758),oe=Symbol("service:start-up"),ie=n(2275),ae=n(52571),se=n(34221),ce=n(81346),le=n(87039),ue=n(85814),de=n(77947),pe=n(91301),fe=n(47408),_e=n(37769),he=function(){function e(e){this.store=e,this.serviceSettingsChange=new pe.t,this.store.register(fe.e.Services,[]).subscribe(this.serviceSettingsChange)}return e.prototype.subscribeToSettingServicesChange=function(){this.serviceSettingsChange.subscribe((function(e){null==e||e.forEach((function(e){return x.Am.get(e)}))}))},e}();he=(0,r.__decorate)([(0,_e.t)(),(0,r.__metadata)("design:paramtypes",[de.O])],he);var me=function(){function e(){this.version="1.70.0";var e=re.I.getMetadata(this);e&&this.settings.set(e)}return e.prototype.callHook=function(e){for(var t,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var i=(null!==(t=this.settings.mount)&&void 0!==t?t:{}).extensions,a=void 0===i?[]:i;return a.forEach((function(t){var o=x.Am.get(t);o[e]&&o[e].apply(o,(0,r.__spreadArray)([],(0,r.__read)(n),!1))})),e in this?this[e].apply(this,(0,r.__spreadArray)([],(0,r.__read)(n),!1)):"not implemented"},e.prototype.start=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,7,,8]),[4,this.callHook("$onInit")];case 1:return t.sent(),this.initServices(),this.initMiddlewares(),[4,this.callHook("$onMount")];case 2:return t.sent(),[4,this.mount()];case 3:return t.sent(),[4,this.callHook("$afterControllersInit")];case 4:return t.sent(),[4,this.attach()];case 5:return t.sent(),[4,this.callHook("$onReady")];case 6:return t.sent(),[3,8];case 7:if(e=t.sent(),"not implemented"===this.callHook("$onWorkbenchInitError",e))throw e;return[3,8];case 8:return[2]}}))}))},e.prototype.getComponent=function(){return this.startUpServive.getComponent()},e.prototype.initServices=function(){var e;x.Am.get(ie.A),x.Am.get(se.M),this.startUpServive.initServices(this.settings),x.Am.get(te.H),x.Am.get(le.E),x.Am.get(ue._),this.settings.useLogger&&this.settings.useLogger!==ae.r&&(ae.r.use=this.settings.useLogger),this.settings.useLogger?ae.r.info("workbenchVersion:".concat(this.version)):console.info("workbenchVersion:".concat(this.version)),null===(e=this.settings.mount.services)||void 0===e||e.forEach((function(e){return x.Am.get(e)}))},e.prototype.initMiddlewares=function(){var e=x.Am.get(ne.K);this.startUpServive.initMiddlewares(e,this.settings),e.$onInit()},e.prototype.attach=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.startUpServive.attach(this.settings.container)];case 1:return e.sent(),[2]}}))}))},e.prototype.mount=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e=this;return(0,r.__generator)(this,(function(t){return[2,new Promise((function(t){setTimeout((function(){x.Am.get(te.H).subscribeToControllerChange(),x.Am.get(ce.U).subscribeToFeatureChange(),x.Am.get(he).subscribeToSettingServicesChange(),e.settings.addMountSettings(e.settings.mount),t()}),0)}))]}))}))},e}();(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type",re.I)],me.prototype,"settings",void 0),(0,r.__decorate)([(0,x.tB)(oe),(0,r.__metadata)("design:type",Object)],me.prototype,"startUpServive",void 0);var ge=n(87363),ve=n.n(ge),be=n(61533),ye=n.n(be),we=n(52747),Ee=n(15012),Ce="editor-zone_editor-zone__1Mk-B",Te="editor-zone_grid___TyIk",xe="editor-zone_float-widgets__1ZThR";(0,Ee.Z)(".editor-zone_editor-zone__1Mk-B {\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  transition: margin 0.3s ease;\n  z-index: 1200;\n}\n.editor-zone_grid___TyIk {\n  display: flex;\n  width: 100%;\n  height: 100%;\n}\n.editor-zone_grid___TyIk.editor-zone_editor-zone__1Mk-B {\n  width: auto;\n  height: auto;\n}\n.editor-zone_float-widgets__1ZThR {\n  position: absolute;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  transition: margin 0.3s ease;\n  pointer-events: none;\n  z-index: 1500;\n}\n#workbench-float-widgets-lower.editor-zone_float-widgets__1ZThR {\n  z-index: 1250;\n}\n#workbench-float-widgets-middle.editor-zone_float-widgets__1ZThR {\n  z-index: 1325;\n}\n");var Se=n(99779),Ie=n(4211),ke=n(65397),Re=n(50442),Ae="widget_widget__2xcrt";(0,Ee.Z)(".widget_widget__2xcrt {\n  pointer-events: all;\n}\n");var Oe=n(43813),Le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.children,n=e.style,r=void 0===n?{}:n,o=e.visibilityTransition,i=e.visible,a=Object.assign({},r);o||(a.display=void 0===i||i?"block":"none");var s=ve().createElement("div",{className:Ae,style:a},ve().createElement(Re.S,null,ve().cloneElement(t,t.props)));return o?function(e,t){var n=t.visibilityTransition;return ve().createElement(Oe.ZP,{in:!!t.visible,timeout:n.duration},(function(t){var r=e.props.style||{},o=Object.assign(Object.assign({},r),n[t]);return ve().cloneElement(e,Object.assign(Object.assign({},e.props),{style:o}))}))}(s,this.props):s},t}(ve().PureComponent),Me="surface_editor-wrapper__39Ndg",Ne="surface_stack-view__3UVPj",De="surface_hide__36RO-";(0,Ee.Z)(".surface_editor-wrapper__39Ndg {\n  width: 100%;\n  height: 100%;\n  position: relative;\n}\n.surface_stack-view__3UVPj {\n  width: 100%;\n  height: 100%;\n  -webkit-user-select: text;\n     -moz-user-select: text;\n          user-select: text;\n  display: flex;\n}\n.surface_stack-view__3UVPj.surface_hide__36RO- {\n  display: none;\n}\n");var Pe,Fe=n(42035),Be=n(34549),Ue=n(27535),He=[],je="ResizeObserver loop completed with undelivered notifications.";!function(e){e.BORDER_BOX="border-box",e.CONTENT_BOX="content-box",e.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"}(Pe||(Pe={}));var We,Ve=function(e){return Object.freeze(e)},ze=function(e,t){this.inlineSize=e,this.blockSize=t,Ve(this)},Ge=function(){function e(e,t,n,r){return this.x=e,this.y=t,this.width=n,this.height=r,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,Ve(this)}return e.prototype.toJSON=function(){var e=this;return{x:e.x,y:e.y,top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}},e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e}(),Ye=function(e){return e instanceof SVGElement&&"getBBox"in e},qe=function(e){if(Ye(e)){var t=e.getBBox(),n=t.width,r=t.height;return!n&&!r}var o=e,i=o.offsetWidth,a=o.offsetHeight;return!(i||a||e.getClientRects().length)},Ze=function(e){var t,n;if(e instanceof Element)return!0;var r=null===(n=null===(t=e)||void 0===t?void 0:t.ownerDocument)||void 0===n?void 0:n.defaultView;return!!(r&&e instanceof r.Element)},Je="undefined"!=typeof window?window:{},Ke=new WeakMap,Qe=/auto|scroll/,Xe=/^tb|vertical/,$e=/msie|trident/i.test(Je.navigator&&Je.navigator.userAgent),et=function(e){return parseFloat(e||"0")},tt=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=!1),new ze((n?t:e)||0,(n?e:t)||0)},nt=Ve({devicePixelContentBoxSize:tt(),borderBoxSize:tt(),contentBoxSize:tt(),contentRect:new Ge(0,0,0,0)}),rt=function(e,t){if(void 0===t&&(t=!1),Ke.has(e)&&!t)return Ke.get(e);if(qe(e))return Ke.set(e,nt),nt;var n=getComputedStyle(e),r=Ye(e)&&e.ownerSVGElement&&e.getBBox(),o=!$e&&"border-box"===n.boxSizing,i=Xe.test(n.writingMode||""),a=!r&&Qe.test(n.overflowY||""),s=!r&&Qe.test(n.overflowX||""),c=r?0:et(n.paddingTop),l=r?0:et(n.paddingRight),u=r?0:et(n.paddingBottom),d=r?0:et(n.paddingLeft),p=r?0:et(n.borderTopWidth),f=r?0:et(n.borderRightWidth),_=r?0:et(n.borderBottomWidth),h=d+l,m=c+u,g=(r?0:et(n.borderLeftWidth))+f,v=p+_,b=s?e.offsetHeight-v-e.clientHeight:0,y=a?e.offsetWidth-g-e.clientWidth:0,w=o?h+g:0,E=o?m+v:0,C=r?r.width:et(n.width)-w-y,T=r?r.height:et(n.height)-E-b,x=C+h+y+g,S=T+m+b+v,I=Ve({devicePixelContentBoxSize:tt(Math.round(C*devicePixelRatio),Math.round(T*devicePixelRatio),i),borderBoxSize:tt(x,S,i),contentBoxSize:tt(C,T,i),contentRect:new Ge(d,c,C,T)});return Ke.set(e,I),I},ot=function(e,t,n){var r=rt(e,n),o=r.borderBoxSize,i=r.contentBoxSize,a=r.devicePixelContentBoxSize;switch(t){case Pe.DEVICE_PIXEL_CONTENT_BOX:return a;case Pe.BORDER_BOX:return o;default:return i}},it=function(e){var t=rt(e);this.target=e,this.contentRect=t.contentRect,this.borderBoxSize=Ve([t.borderBoxSize]),this.contentBoxSize=Ve([t.contentBoxSize]),this.devicePixelContentBoxSize=Ve([t.devicePixelContentBoxSize])},at=function(e){if(qe(e))return 1/0;for(var t=0,n=e.parentNode;n;)t+=1,n=n.parentNode;return t},st=function(){var e=1/0,t=[];He.forEach((function(n){if(0!==n.activeTargets.length){var r=[];n.activeTargets.forEach((function(t){var n=new it(t.target),o=at(t.target);r.push(n),t.lastReportedSize=ot(t.target,t.observedBox),o<e&&(e=o)})),t.push((function(){n.callback.call(n.observer,r,n.observer)})),n.activeTargets.splice(0,n.activeTargets.length)}}));for(var n=0,r=t;n<r.length;n++)(0,r[n])();return e},ct=function(e){He.forEach((function(t){t.activeTargets.splice(0,t.activeTargets.length),t.skippedTargets.splice(0,t.skippedTargets.length),t.observationTargets.forEach((function(n){n.isActive()&&(at(n.target)>e?t.activeTargets.push(n):t.skippedTargets.push(n))}))}))},lt=function(){var e,t=0;for(ct(t);He.some((function(e){return e.activeTargets.length>0}));)t=st(),ct(t);return He.some((function(e){return e.skippedTargets.length>0}))&&("function"==typeof ErrorEvent?e=new ErrorEvent("error",{message:je}):((e=document.createEvent("Event")).initEvent("error",!1,!1),e.message=je),window.dispatchEvent(e)),t>0},ut=[],dt=function(e){if(!We){var t=0,n=document.createTextNode("");new MutationObserver((function(){return ut.splice(0).forEach((function(e){return e()}))})).observe(n,{characterData:!0}),We=function(){n.textContent=""+(t?t--:t++)}}ut.push(e),We()},pt=0,ft={attributes:!0,characterData:!0,childList:!0,subtree:!0},_t=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],ht=function(e){return void 0===e&&(e=0),Date.now()+e},mt=!1,gt=new(function(){function e(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return e.prototype.run=function(e){var t=this;if(void 0===e&&(e=250),!mt){mt=!0;var n,r=ht(e);n=function(){var n=!1;try{n=lt()}finally{if(mt=!1,e=r-ht(),!pt)return;n?t.run(1e3):e>0?t.run(e):t.start()}},dt((function(){requestAnimationFrame(n)}))}},e.prototype.schedule=function(){this.stop(),this.run()},e.prototype.observe=function(){var e=this,t=function(){return e.observer&&e.observer.observe(document.body,ft)};document.body?t():Je.addEventListener("DOMContentLoaded",t)},e.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),_t.forEach((function(t){return Je.addEventListener(t,e.listener,!0)})))},e.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),_t.forEach((function(t){return Je.removeEventListener(t,e.listener,!0)})),this.stopped=!0)},e}()),vt=function(e){!pt&&e>0&&gt.start(),!(pt+=e)&&gt.stop()},bt=function(){function e(e,t){this.target=e,this.observedBox=t||Pe.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return e.prototype.isActive=function(){var e,t=ot(this.target,this.observedBox,!0);return e=this.target,Ye(e)||function(e){switch(e.tagName){case"INPUT":if("image"!==e.type)break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1}(e)||"inline"!==getComputedStyle(e).display||(this.lastReportedSize=t),this.lastReportedSize.inlineSize!==t.inlineSize||this.lastReportedSize.blockSize!==t.blockSize},e}(),yt=function(e,t){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=t},wt=new WeakMap,Et=function(e,t){for(var n=0;n<e.length;n+=1)if(e[n].target===t)return n;return-1},Ct=function(){function e(){}return e.connect=function(e,t){var n=new yt(e,t);wt.set(e,n)},e.observe=function(e,t,n){var r=wt.get(e),o=0===r.observationTargets.length;Et(r.observationTargets,t)<0&&(o&&He.push(r),r.observationTargets.push(new bt(t,n&&n.box)),vt(1),gt.schedule())},e.unobserve=function(e,t){var n=wt.get(e),r=Et(n.observationTargets,t),o=1===n.observationTargets.length;r>=0&&(o&&He.splice(He.indexOf(n),1),n.observationTargets.splice(r,1),vt(-1))},e.disconnect=function(e){var t=this,n=wt.get(e);n.observationTargets.slice().forEach((function(n){return t.unobserve(e,n.target)})),n.activeTargets.splice(0,n.activeTargets.length)},e}(),Tt=function(){function e(e){if(0===arguments.length)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if("function"!=typeof e)throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");Ct.connect(this,e)}return e.prototype.observe=function(e,t){if(0===arguments.length)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!Ze(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");Ct.observe(this,e,t)},e.prototype.unobserve=function(e){if(0===arguments.length)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!Ze(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");Ct.unobserve(this,e)},e.prototype.disconnect=function(){Ct.disconnect(this)},e.toString=function(){return"function ResizeObserver () { [polyfill code] }"},e}(),xt=Ue.U.ResizeObserver||Tt,St=n(42413),It=n(75611),kt=n(47184),Rt=(0,Se.x)([fe.R.DisableToolbar,fe.R.ToolbarAlignment,fe.R.SupportNativeDomScrolling,Ie.j.EmbedWidget,Ie.j.EmbedWidgetContainer],!0)((function(e){var t=e.children,n=e.embedWidget,r=e.id,o=e.forwardRef,i=e.embedWidgetContainer,a=e[fe.R.SupportNativeDomScrolling],s=n.filter((function(e){return e.surface===r||null===e.surface})).map((function(e){return ve().createElement(Le,{key:"embed-".concat(e.name),style:e.styles,visible:!0},e.component)})),c=a?{overflow:"auto",scrollbarGutter:"stable"}:{};return ve().createElement("div",{className:Me,ref:o,style:c},t,i[r]?(0,be.createPortal)(s,i[r]):s)})),At=function(e){function t(t){var n=e.call(this,t)||this;return n.node=ve().createRef(),n.wrapperNode=ve().createRef(),n}return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.sensor=new xt((function(){e.bindResizeCallback()})),this.fireDomChangedNotification()},t.prototype.componentDidUpdate=function(){this.fireDomChangedNotification()},t.prototype.getSnapshotBeforeUpdate=function(){var e,t;return document.activeElement&&this.node.current&&(e=this.node.current,t=document.activeElement,e.contains(t)||e===t)?this.props.focusStream.next(!0):this.props.focusStream.next(!1),null},t.prototype.fireDomChangedNotification=function(){this.wrapperNode.current&&(this.sensor.disconnect(),this.sensor.observe(this.wrapperNode.current)),this.node.current?this.props.stream.next(this.node.current):this.props.stream.error(null)},t.prototype.componentWillUnmount=function(){this.props.stream.complete(),this.sensor.disconnect(),this.props.focusStream.complete()},t.prototype.bindResizeCallback=function(){var e,t=this,n=!1,r=function(){var o,i=null===(o=t.wrapperNode.current)||void 0===o?void 0:o.getBoundingClientRect();if(i){var a=i.width,s=i.height;n&&!t.isWrapperSizeChanged(a,s)?(t.eventEmitter.emit(Be.c.SurfaceSizeChanged),n=!1,e&&(window.cancelAnimationFrame(e),e=void 0)):t.isWrapperSizeChanged(a,s)&&(n=!0,e=window.requestAnimationFrame(r)),t.lastTimeRect=i}};window.requestAnimationFrame(r)},t.prototype.isWrapperSizeChanged=function(e,t){return!this.lastTimeRect||this.lastTimeRect.width!==e||this.lastTimeRect.height!==t},t.prototype.getWrapper=function(e){var t,n,o=(0,r.__read)(e),i=o[0],a=o.slice(1);if(!i)return null;var s=i.requestInfo?{$grid:this.props.grid,$surface:this.props.id}:{};return(null!==(t=i.surface)&&void 0!==t?t:this.props.id)!==this.props.id?this.getWrapper(a):ve().createElement(Re.S,null,ve().cloneElement(i.component,Object.assign(Object.assign(Object.assign({},i.component.props),{key:"wrapper-".concat(i.name),children:null!==(n=this.getWrapper(a))&&void 0!==n?n:i.component.props.children}),s)))},t.prototype.render=function(){var e=this,t={name:"surface-wrapper",priority:0,component:ve().createElement(Rt,{id:this.props.id,forwardRef:this.wrapperNode})},n=Ue.s&&this.props.ssrChildren?{__html:this.props.ssrChildren}:void 0,o={name:"surface-child",priority:-1/0,component:ve().createElement("div",{id:this.props.id,ref:this.node,style:{minHeight:"100%",height:"100%",width:"100%"},onContextMenu:function(t){t.currentTarget.contains(t.target)&&e.eventEmitter.emit(Be.c.BeforeContextMenu,t)}})};n&&(o.component=ve().cloneElement(o.component,{dangerouslySetInnerHTML:n}));var i=[Ne];this.props.show||i.push(De);var a=ve().createElement("div",{className:i.join(" ")},ve().createElement(St.Kk.Provider,{value:{$grid:this.props.grid,$surface:this.props.id,evaluateWithContext:function(t,n){for(var o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];if(t instanceof kt.r){var a=e.surfaceService.getEditor(e.props.id);t.setContext({editor:a})}return It.k.apply(void 0,(0,r.__spreadArray)([t,n],(0,r.__read)(o),!1))}}},this.getWrapper(this.props.wrapWidget.concat(t,o))));return this.props.targetDom?ye().createPortal(a,this.props.targetDom):a},t}(ve().PureComponent);(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type",Fe.v)],At.prototype,"eventEmitter",void 0),(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type",ke.W)],At.prototype,"surfaceService",void 0);var Ot=(0,Se.x)([Ie.j.WrapWidget],!0)(At),Lt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.render=function(){var e,n,r,o,i,a=this,s=(null!==(n=null===(e=this.props.grids)||void 0===e?void 0:e.length)&&void 0!==n?n:0)>0,c={id:"grid-".concat(this.props.id),className:"".concat(Te," ").concat(this.props.className," grid-").concat(this.props.type),style:this.props.style},l=s?null===(r=this.props.grids)||void 0===r?void 0:r.map((function(e,n,r){return ve().createElement(t,Object.assign({mode:a.props.mode,key:e.id,style:{width:"".concat(100/r.length,"%")},isHidden:"stack"===a.props.type&&a.props.stackCurrent!==e.id},e))})):null===(o=this.props.surfaces)||void 0===o?void 0:o.map((function(e){return ve().createElement(Ot,Object.assign({mode:a.props.mode,show:e.visible,key:e.id},e))})),u=null!==(i=this.props.style)&&void 0!==i?i:{};return this.props.isHidden&&(u.display="none"),l?ve().createElement("div",Object.assign({},c,{style:u}),l):null},t}(ge.Component);Lt.contextType=we.FN,Lt.defaultProps={className:""};var Mt=n(27309),Nt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.render=function(){var e,t,n,r,o=this,i=(0,Mt.vM)(this.props.floatWidget,"layer","upper");return ve().createElement(ve().Fragment,null,ve().createElement(Lt,Object.assign({},this.props.surface,{mode:this.props.mode,className:Ce,style:{paddingLeft:this.props["editorZone.paddingLeft"],paddingRight:this.props["editorZone.paddingRight"],paddingTop:this.props["editorZone.paddingTop"],paddingBottom:this.props["editorZone.paddingBottom"],marginLeft:this.props.editorZoneMarginLeft,marginRight:this.props.editorZoneMarginRight}})),ve().createElement(Lt,Object.assign({},this.props.floatSurface,{mode:this.props.mode,style:Object.assign({display:(null!==(t=null===(e=this.props.floatSurface.surfaces)||void 0===e?void 0:e.length)&&void 0!==t?t:0)>0||(null!==(r=null===(n=this.props.floatSurface.grids)||void 0===n?void 0:n.length)&&void 0!==r?r:0)>0?"block":"none",zIndex:1300},this.props.floatSurfaceStyle)})),Object.keys(i).map((function(e){var t=i[e];return ve().createElement("div",{key:e,id:"upper"!==e?"workbench-float-widgets-".concat(e):"workbench-float-widgets",className:xe,style:{marginLeft:o.props.editorZoneMarginLeft,marginRight:o.props.editorZoneMarginRight}},t.map((function(e){return ve().createElement(Le,Object.assign({key:"float-".concat(e.name),style:e.styles,visibilityTransition:e.visibilityTransition},e.props,{visible:void 0===e.visible||e.visible}),e.component)})))})))},t}(ge.Component),Dt=(0,Se.x)([Ie.j.Surface,Ie.j.FloatSurface,Ie.j.FloatSurfaceStyle,Ie.j.FloatWidget,Ie.j.EditorZoneMarginLeft,Ie.j.EditorZoneMarginRight,fe.R.PaddingLeft,fe.R.PaddingRight,fe.R.PaddingTop,fe.R.PaddingBottom],!0)(Nt),Pt="statusbar_statusbar-wrapper__3jAPj",Ft="statusbar_statusbar-pusher__AmxFt",Bt="statusbar_status-bar-component-wrapper__NwnZ7",Ut="statusbar_static__2Ro1E",Ht="statusbar_active__2HYrG";(0,Ee.Z)(".statusbar_statusbar-wrapper__3jAPj {\n  padding: 0 16px;\n  display: flex;\n  height: 100%;\n  background-color: var(--workbench-theme-statusbar-background, #f0f0f0);\n  border-top: 1px solid var(--workbench-theme-statusbar-border, rgba(0, 0, 0, 0.04));\n  align-items: center;\n  transition: background-color 0.3s ease;\n  will-change: transform;\n}\n.statusbar_statusbar-wrapper__3jAPj > .statusbar_statusbar-pusher__AmxFt {\n  margin: 0 auto;\n}\n.statusbar_statusbar-wrapper__3jAPj > .statusbar_status-bar-component-wrapper__NwnZ7 {\n  margin: 0 6px;\n  color: var(--workbench-theme-statusbar-text-color, var(--workbench-theme-statusbar-foreground, #000000));\n  border-radius: 2px;\n  min-width: 24px;\n  min-height: 24px;\n  position: relative;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n}\n.statusbar_statusbar-wrapper__3jAPj > .statusbar_status-bar-component-wrapper__NwnZ7:first-child {\n  margin-left: 0;\n}\n.statusbar_statusbar-wrapper__3jAPj > .statusbar_status-bar-component-wrapper__NwnZ7:last-child {\n  margin-right: 0;\n}\n.statusbar_statusbar-wrapper__3jAPj > .statusbar_status-bar-component-wrapper__NwnZ7:not(.statusbar_static__2Ro1E):hover {\n  background-color: var(--workbench-theme-statusbar-hover-background, var(--workbench-theme-global-button-hover, rgba(0, 0, 0, 0.04)));\n}\n.statusbar_statusbar-wrapper__3jAPj > .statusbar_status-bar-component-wrapper__NwnZ7.statusbar_active__2HYrG,\n.statusbar_statusbar-wrapper__3jAPj > .statusbar_status-bar-component-wrapper__NwnZ7:not(.statusbar_static__2Ro1E):active {\n  background-color: var(--workbench-theme-statusbar-active-background, var(--workbench-theme-global-button-active, rgba(0, 0, 0, 0.08)));\n}\n.statusbar_statusbar-wrapper__3jAPj > .statusbar_status-bar-component-wrapper__NwnZ7 svg path.secondary {\n  fill: var(--workbench-theme-statusbar-icon-secondary-color, var(--workbench-theme-global-icon-secondary-color, currentColor));\n  opacity: var(--workbench-theme-statusbar-icon-secondary-color-opacity, var(--workbench-theme-global-icon-secondary-color-opacity, 0.4));\n}\n.statusbar_statusbar-wrapper__3jAPj > .statusbar_status-bar-component-wrapper__NwnZ7 svg path,\n.statusbar_statusbar-wrapper__3jAPj > .statusbar_status-bar-component-wrapper__NwnZ7 path.primary {\n  fill: var(--workbench-theme-statusbar-icon-primary-color, var(--workbench-theme-global-icon-primary-color, currentColor));\n  opacity: var(--workbench-theme-statusbar-icon-primary-color-opacity, var(--workbench-theme-global-icon-primary-color-opacity, 1));\n}\n.statusbar_edge-right-tooltip__1JWl8.statusbar_dui-tooltip-content__2Ln9N {\n  transform: translate(-35%) !important;\n}\n");var jt=n(37700),Wt=n(83939),Vt=n(9771),zt=function(e){function t(){var t=e.apply(this,(0,r.__spreadArray)([],(0,r.__read)(arguments),!1))||this;return t.handleClick=function(e){var n,r;t.props.preventOriginalClick&&e.stopPropagation(),t.props.disabled||(t.props.badge&&t.badgeService.removeBadgeOn("statusbar",t.props.name),null===(r=(n=t.props).onClick)||void 0===r||r.call(n))},t}return(0,r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.content,n=e.style,r=null!=n?n:{},o=this.props,i=o.disabled,a=o.tooltip,s=o.badge,c=t;ve().isValidElement(c)&&(c=ve().cloneElement(c,{disabled:i}));var l=[Bt];return this.props.active&&l.push(Ht),this.props.preventHighlight&&l.push(Ut),ve().createElement("div",{onClickCapture:this.handleClick,className:l.join(" "),style:Object.assign(Object.assign({},r),{opacity:i?.3:1,pointerEvents:i?"none":"auto"})},ve().createElement(jt.Tooltip,{placement:"top",title:a,disabled:!a},ve().createElement(Wt.ZP,{dot:s,style:{transform:"scale(0.6)",top:-1,right:-3,border:"none",transformOrigin:"top right"}},t)))},t}(ge.PureComponent);function Gt(e){return Object.assign(Object.assign({},e),{tooltip:(0,It.k)(e.tooltip,""),disabled:(0,It.k)(e.shouldDisabled,!1),style:(0,It.k)(e.style,void 0),active:(0,It.k)(e.shouldCheck,!1),content:(0,It.k)(e.content,void 0)})}(0,r.__decorate)([(0,x.tB)(Vt.c),(0,r.__metadata)("design:type",Object)],zt.prototype,"badgeService",void 0);var Yt=n(26061),qt=function(e){function t(){var t=e.apply(this,(0,r.__spreadArray)([],(0,r.__read)(arguments),!1))||this;return t.shouldHide=function(e){return(0,It.k)(e.shouldHide,!1)},t.haveBadge=function(e){return t.props.badge.some((function(t){return t.key===e.name&&"statusbar"===t.position}))},t.getComponent=function(e,n){var r=e.content,o=e.name,i=t.shouldHide(e);return r&&!i?ve().createElement(Re.S,{key:e.name},ve().createElement(zt,Object.assign({},Gt(e),{badge:t.haveBadge(e)}))):"divider"===o?ve().createElement(zt,{key:"".concat(e.name,"-").concat(n),name:"".concat(e.name,"-").concat(n),style:{margin:"0 8px",minWidth:1},preventHighlight:!0,content:ve().createElement(Yt.default,{style:{borderRight:"1px solid var(--workbench-theme-statusbar-border)",margin:0},orientation:"vertical"})}):null},t}return(0,r.__extends)(t,e),t.prototype.render=function(){return ve().createElement("div",{className:Pt},this.props.statusbar.left.map(this.getComponent),ve().createElement("div",{className:Ft}),this.props.statusbar.right.map(this.getComponent))},t}(ge.PureComponent);qt.contextType=we.FN;var Zt=(0,Se.x)([Ie.j.Statusbar,Ie.j.Badge])(qt),Jt="pc_workbench-pc__2qtjl",Kt="pc_header__3i0cL",Qt="pc_hidden__sN0uV",Xt="pc_container__3evvF",$t="pc_float__3qJL6",en="pc_footer__33sHn";(0,Ee.Z)(".pc_workbench-pc__2qtjl {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  box-sizing: border-box;\n}\n.pc_workbench-pc__2qtjl .pc_header__3i0cL {\n  flex-shrink: 0;\n  border-bottom: 1px solid var(--workbench-theme-toolbar-border-without-drawer, transparent);\n  background-color: var(--workbench-theme-toolbar-background, #f9fafb);\n}\n.pc_workbench-pc__2qtjl .pc_header__3i0cL .pc_hidden__sN0uV {\n  position: absolute;\n  top: -1000px;\n  width: 100%;\n  display: flex;\n  flex-direction: row;\n  flex-wrap: nowrap;\n}\n.pc_workbench-pc__2qtjl .pc_container__3evvF {\n  position: relative;\n  height: 100%;\n  transition: all 0.3s ease;\n  transform-origin: 0 0;\n  -webkit-overflow-scrolling: touch;\n  display: flex;\n  justify-content: center;\n  background: var(--workbench-theme-editor-zone-background, #f9fafb);\n}\n.pc_workbench-pc__2qtjl .pc_container__3evvF .pc_float__3qJL6 {\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n}\n.pc_workbench-pc__2qtjl .pc_footer__33sHn {\n  height: auto;\n  width: 100%;\n  box-sizing: border-box;\n}\n");var tn=n(61052),nn={"drawer-container":"drawer_drawer-container__3f319","drawer-left":"drawer_drawer-left__1b2sS","drawer-right":"drawer_drawer-right__2gb6H",drawer:"drawer_drawer__2yRyg","animation-transform":"drawer_animation-transform__2KY05","animation-fade":"drawer_animation-fade__BhwlB",transparent:"drawer_transparent__13y6s","before-open":"drawer_before-open__3jmHf","after-close":"drawer_after-close__2KKbu",closing:"drawer_closing__14zYI",fade:"drawer_fade__2KWMg","after-open":"drawer_after-open__2rUxp","before-close":"drawer_before-close__1okJ8",opening:"drawer_opening__ir3ot","drawer-title":"drawer_drawer-title__29ZP4","drawer-close-button":"drawer_drawer-close-button__W_Uf6","drawer-back-button":"drawer_drawer-back-button__3FUCn","draggable-edge":"drawer_draggable-edge__2oMAa"};(0,Ee.Z)('.drawer_drawer-container__3f319 {\n  position: absolute;\n  z-index: 1300;\n  top: 0;\n  bottom: 0;\n}\n.drawer_drawer-container__3f319.drawer_drawer-left__1b2sS {\n  left: 0;\n}\n.drawer_drawer-container__3f319.drawer_drawer-right__2gb6H {\n  right: 0;\n}\n.drawer_drawer__2yRyg {\n  position: absolute;\n  width: 280px;\n  height: 100%;\n  background: var(--workbench-theme-drawer-background, #f9fafb);\n  color: var(--workbench-theme-drawer-foreground, #000000);\n  box-sizing: border-box;\n  overflow: hidden;\n  display: none;\n}\n.drawer_drawer__2yRyg.drawer_animation-transform__2KY05 {\n  transition: transform 0.3s cubic-bezier(0.25, 0.1, 0.25, 1);\n}\n.drawer_drawer__2yRyg.drawer_animation-fade__BhwlB {\n  transition: transform 0.3s cubic-bezier(0.25, 0.1, 0.25, 1), opacity 0.3s cubic-bezier(0.25, 0.1, 0.25, 1);\n}\n.drawer_drawer__2yRyg.drawer_drawer-left__1b2sS {\n  left: 0;\n  transform: translateX(-100%);\n  border-right: 1px solid var(--workbench-theme-drawer-border, rgba(0, 0, 0, 0.06));\n}\n.drawer_drawer__2yRyg.drawer_drawer-right__2gb6H {\n  right: 0;\n  transform: translateX(100%);\n  border-left: 1px solid var(--workbench-theme-drawer-border, rgba(0, 0, 0, 0.06));\n}\n.drawer_drawer__2yRyg.drawer_transparent__13y6s {\n  background: transparent;\n  border-left: none;\n  border-right: none;\n}\n.drawer_drawer__2yRyg.drawer_before-open__3jmHf.drawer_drawer-left__1b2sS,\n.drawer_drawer__2yRyg.drawer_after-close__2KKbu.drawer_drawer-left__1b2sS,\n.drawer_drawer__2yRyg.drawer_closing__14zYI.drawer_drawer-left__1b2sS {\n  transform: translateX(-100%);\n}\n.drawer_drawer__2yRyg.drawer_before-open__3jmHf.drawer_drawer-right__2gb6H,\n.drawer_drawer__2yRyg.drawer_after-close__2KKbu.drawer_drawer-right__2gb6H,\n.drawer_drawer__2yRyg.drawer_closing__14zYI.drawer_drawer-right__2gb6H {\n  transform: translateX(100%);\n}\n.drawer_drawer__2yRyg.drawer_before-open__3jmHf,\n.drawer_drawer__2yRyg.drawer_closing__14zYI {\n  display: block;\n}\n.drawer_drawer__2yRyg.drawer_before-open__3jmHf.drawer_fade__2KWMg,\n.drawer_drawer__2yRyg.drawer_closing__14zYI.drawer_fade__2KWMg {\n  opacity: 0;\n}\n.drawer_drawer__2yRyg.drawer_before-open__3jmHf.drawer_fade__2KWMg.drawer_drawer-left__1b2sS,\n.drawer_drawer__2yRyg.drawer_closing__14zYI.drawer_fade__2KWMg.drawer_drawer-left__1b2sS {\n  transform: translateX(-40%);\n}\n.drawer_drawer__2yRyg.drawer_before-open__3jmHf.drawer_fade__2KWMg.drawer_drawer-right__2gb6H,\n.drawer_drawer__2yRyg.drawer_closing__14zYI.drawer_fade__2KWMg.drawer_drawer-right__2gb6H {\n  transform: translateX(40%);\n}\n.drawer_drawer__2yRyg.drawer_after-close__2KKbu {\n  display: none;\n}\n.drawer_drawer__2yRyg.drawer_after-close__2KKbu.drawer_fade__2KWMg {\n  opacity: 0;\n}\n.drawer_drawer__2yRyg.drawer_after-open__2rUxp,\n.drawer_drawer__2yRyg.drawer_before-close__1okJ8 {\n  display: block;\n  transform: none;\n}\n.drawer_drawer__2yRyg.drawer_after-open__2rUxp.drawer_fade__2KWMg,\n.drawer_drawer__2yRyg.drawer_before-close__1okJ8.drawer_fade__2KWMg {\n  opacity: 1;\n}\n.drawer_drawer__2yRyg.drawer_opening__ir3ot {\n  display: block;\n  transform: none !important;\n}\n.drawer_drawer__2yRyg.drawer_opening__ir3ot.drawer_fade__2KWMg {\n  opacity: 1;\n}\n.drawer_drawer__2yRyg.drawer_closing__14zYI.drawer_fade__2KWMg {\n  opacity: 0;\n}\n.drawer_drawer__2yRyg .drawer_drawer-title__29ZP4 {\n  padding: 17px 16px;\n  font-size: 16px;\n  font-weight: 600;\n  line-height: 22px;\n  display: flex;\n  color: var(--workbench-theme-drawer-foreground, rgba(0, 0, 0, 0.88));\n  font-weight: 500;\n}\n.drawer_drawer__2yRyg .drawer_drawer-close-button__W_Uf6 {\n  background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+RjNENTZBMjAtMzZDRC00RTM3LUI5OEYtMTAzQUNDRjlBQUQ4PC90aXRsZT4KICAgIDxnIGlkPSIyLjAiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSLnm67lvZUt5bGV5byAIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMjY0LjAwMDAwMCwgLTEyOC4wMDAwMDApIj4KICAgICAgICAgICAgPGcgaWQ9IkJhci/moIfpopjmoI8v5L6n6L655qCP5aSH5Lu9IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgMTEyLjAwMDAwMCkiPgogICAgICAgICAgICAgICAgPGcgaWQ9IklDT04v6L6F5Yqp5bCP5Zu+5qCHL+a4hemZpOi0puWPtyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjY0LjAwMDAwMCwgMTYuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgc3Ryb2tlPSIjOTc5Nzk3IiBmaWxsPSIjRDhEOEQ4IiBvcGFjaXR5PSIwIiB4PSIwIiB5PSIwIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjwvcmVjdD4KICAgICAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0i6Lev5b6EIiBmaWxsPSIjODE4NjhGIiBwb2ludHM9IjguNjMxIDggMTMgMTIuMzY4MjI1MyAxMi4zNjgyMjUzIDEzIDcuOTk5IDguNjMxIDMuNjMxNzc0NzEgMTMgMyAxMi4zNjgyMjUzIDcuMzY4IDggMyAzLjYzMTc3NDcxIDMuNjMxNzc0NzEgMyA4IDcuMzY4IDEyLjM2ODIyNTMgMyAxMyAzLjYzMTc3NDcxIj48L3BvbHlnb24+CiAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==);\n  background-position: center;\n  background-size: 16px 16px;\n  background-repeat: no-repeat;\n  width: 24px;\n  height: 24px;\n  display: inline-block;\n  cursor: pointer;\n  position: absolute;\n  right: 16px;\n  top: 16px;\n  z-index: 999;\n}\n.drawer_drawer__2yRyg .drawer_drawer-close-button__W_Uf6:hover {\n  background-color: var(--workbench-theme-global-button-hover, rgba(0, 0, 0, 0.08));\n}\n.drawer_drawer__2yRyg .drawer_drawer-close-button__W_Uf6:active {\n  background-color: var(--workbench-theme-global-button-active, rgba(0, 0, 0, 0.08));\n}\n.drawer_drawer__2yRyg .drawer_drawer-back-button__3FUCn {\n  background-image: url("data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0ibTE0LjExNCA2IC44ODYuODdMOS43NzIgMTIgMTUgMTcuMTNsLS44ODYuODdMOCAxMmw2LjExNC02WiIgZmlsbD0iIzQ1NEQ1QSIvPjwvc3ZnPg==");\n  background-position: center;\n  background-size: 16px 16px;\n  background-repeat: no-repeat;\n  width: 22px;\n  height: 22px;\n  display: inline-block;\n  cursor: pointer;\n  margin-right: 17px;\n}\n.drawer_drawer__2yRyg .drawer_draggable-edge__2oMAa {\n  position: absolute;\n  top: 0;\n  width: 8px;\n  height: 100%;\n  cursor: col-resize;\n  background-color: transparent;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n          user-select: none;\n  z-index: 1;\n}\n.drawer_drawer__2yRyg .drawer_draggable-edge__2oMAa:hover {\n  transition: background-color 0.5s steps(1, end);\n  background-color: var(--workbench-theme-global-button-hover, rgba(0, 0, 0, 0.08));\n}\n.drawer_drawer__2yRyg .drawer_draggable-edge__2oMAa:active {\n  background-color: var(--workbench-theme-global-button-active, rgba(0, 0, 0, 0.16));\n}\n');var rn=n(58624),on={TRANSPARENT:(0,rn.w)("transparent"),PANEL:(0,rn.w)("panel")},an={SLIDE_IN:(0,rn.w)("slideIn"),FADE_IN:(0,rn.w)("fadeIn")};function sn(e){return"object"==typeof e}var cn=n(82010),ln=n(57641),un=n(50554),dn=n(60349),pn=n(52068),fn=n(97396);function _n(e,t){return"function"==typeof t?function(n){return n.pipe(_n((function(n,r){return(0,pn.D)(e(n,r)).pipe((0,dn.U)((function(e,o){return t(n,e,r,o)})))})))}:function(t){return t.lift(new hn(e))}}var hn=function(){function e(e){this.project=e}return e.prototype.call=function(e,t){return t.subscribe(new mn(e,this.project))},e}(),mn=function(e){function t(t,n){var r=e.call(this,t)||this;return r.project=n,r.index=0,r}return r.__extends(t,e),t.prototype._next=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this._innerSub(t)},t.prototype._innerSub=function(e){var t=this.innerSubscription;t&&t.unsubscribe();var n=new fn.IY(this),r=this.destination;r.add(n),this.innerSubscription=(0,fn.ft)(e,n),this.innerSubscription!==n&&r.add(this.innerSubscription)},t.prototype._complete=function(){var t=this.innerSubscription;t&&!t.closed||e.prototype._complete.call(this),this.unsubscribe()},t.prototype._unsubscribe=function(){this.innerSubscription=void 0},t.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&e.prototype._complete.call(this)},t.prototype.notifyNext=function(e){this.destination.next(e)},t}(fn.Ds),gn=n(56157),vn=n(58433),bn=n(77452),yn=1,wn=function(){return Promise.resolve()}(),En={};function Cn(e){return e in En&&(delete En[e],!0)}var Tn=function(e){var t=yn++;return En[t]=!0,wn.then((function(){return Cn(t)&&e()})),t},xn=function(e){Cn(e)},Sn=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return r.__extends(t,e),t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t.scheduled||(t.scheduled=Tn(t.flush.bind(t,null))))},t.prototype.recycleAsyncId=function(t,n,r){if(void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,r);0===t.actions.length&&(xn(n),t.scheduled=void 0)},t}(n(93765).o),In=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.flush=function(e){this.active=!0,this.scheduled=void 0;var t,n=this.actions,r=-1,o=n.length;e=e||n.shift();do{if(t=e.execute(e.state,e.delay))break}while(++r<o&&(e=n.shift()));if(this.active=!1,t){for(;++r<o&&(e=n.shift());)e.unsubscribe();throw t}},t}(n(83081).v),kn=new In(Sn),Rn=n(45568);function An(e){return!(0,Rn.k)(e)&&e-parseFloat(e)+1>=0}var On=function(e){function t(t,n,r){void 0===n&&(n=0),void 0===r&&(r=kn);var o=e.call(this)||this;return o.source=t,o.delayTime=n,o.scheduler=r,(!An(n)||n<0)&&(o.delayTime=0),r&&"function"==typeof r.schedule||(o.scheduler=kn),o}return r.__extends(t,e),t.create=function(e,n,r){return void 0===n&&(n=0),void 0===r&&(r=kn),new t(e,n,r)},t.dispatch=function(e){var t=e.source,n=e.subscriber;return this.add(t.subscribe(n))},t.prototype._subscribe=function(e){var n=this.delayTime,r=this.source;return this.scheduler.schedule(t.dispatch,n,{source:r,subscriber:e})},t}(bn.y),Ln=function(){function e(e,t){this.scheduler=e,this.delay=t}return e.prototype.call=function(e,t){return new On(t,this.delay,this.scheduler).subscribe(e)},e}(),Mn=function(e){function t(){var t=e.apply(this,(0,r.__spreadArray)([],(0,r.__read)(arguments),!1))||this;return t.ref=ve().createRef(),t.state={cssValue:""},t}return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;if(this.ref.current){var t=(0,ln.R)(this.ref.current,"mousedown"),n=(0,ln.R)(document,"mousemove"),r=(0,ln.R)(document,"mouseup"),o=t.pipe(_n((function(t){var o,i;return null===(i=(o=e.props).onDragStart)||void 0===i||i.call(o),e.setState({cssValue:"* { cursor: col-resize !important; } .".concat(Ce," { transition: none !important; }")}),r.pipe((0,gn.P)()).subscribe((function(){var t,n;e.setState({cssValue:""}),null===(n=(t=e.props).onDragEnd)||void 0===n||n.call(t)})),n.pipe((0,dn.U)((function(e){return e.preventDefault(),e.clientX-t.clientX})),(0,vn.R)(r))}))),i=o.pipe(function(e,t){return void 0===t&&(t=0),function(n){return n.lift(new Ln(e,t))}}(un.Z));i.subscribe((function(t){var n,r,o,i;"left"===e.props.align?null===(r=(n=e.props).onDrag)||void 0===r||r.call(n,t):null===(i=(o=e.props).onDrag)||void 0===i||i.call(o,-1*t)}))}},t.prototype.render=function(){var e,t="leftright".replace(this.props.align,"");return ve().createElement("div",{className:nn["draggable-edge"],style:(e={},e[t]=-4,e),ref:this.ref},ve().createElement("style",{type:"text/css",media:"screen"},this.state.cssValue))},t}(ge.Component);function Nn(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=100),Math.max(t,Math.min(e,n))}var Dn=function(e){function t(){var t=e.apply(this,(0,r.__spreadArray)([],(0,r.__read)(arguments),!1))||this;return t.transitionRef=ve().createRef(),t.startWidth=0,t.setDrawerRef=function(e){t.drawerDom=e,t.props.forwardRef(e)},t.onDrawerEdgeDragStart=function(){var e,n;t.startWidth=null!==(n=null===(e=t.drawerDom)||void 0===e?void 0:e.clientWidth)&&void 0!==n?n:280},t.onDrawerEdgeDrag=function(e){var n=sn(t.props.edgeDraggable)?t.props.edgeDraggable:{},r=n.minWidth,o=void 0===r?280:r,i=n.maxWidth,a=void 0===i?480:i,s=Nn(t.startWidth+e,o,a);t.drawerService.updateCurrentDrawer(t.props.align,{style:Object.assign(Object.assign({},t.props.style),{width:s})},t.props.name),t.width=s},t.onDrawerEdgeDragEnd=function(){var e,n;t.width&&sn(t.props.edgeDraggable)&&(null===(n=(e=t.props.edgeDraggable).onDragEnd)||void 0===n||n.call(e,t.width))},t}return(0,r.__extends)(t,e),t.prototype.getWrapperClasses=function(){var e,t,n,o,i=[nn.drawer,nn["drawer-".concat(this.props.align)]];if(this.transitionRef.current){var a=this.transitionRef.current.appliedClasses;try{for(var s=(0,r.__values)(Object.values(a)),c=s.next();!c.done;c=s.next()){var l=c.value;try{for(var u=(n=void 0,(0,r.__values)(Object.values(l))),d=u.next();!d.done;d=u.next()){var p=d.value;i.push(p)}}catch(e){n={error:e}}finally{try{d&&!d.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}}return this.props.animationDisabled||i.push(nn["animation-transform"]),(this.props.type===on.TRANSPARENT||!this.props.opened&&this.type===on.TRANSPARENT)&&i.push(nn.transparent),(this.props.animation===an.FADE_IN||!this.props.opened&&this.animation===an.FADE_IN)&&(i.push(nn.fade),this.props.animationDisabled||i.push(nn["animation-fade"])),i},t.prototype.getDrawerWidget=function(e,t,n){return t?ve().createElement(Le,{style:{maxHeight:"100%",overflow:"auto",height:"100%"},key:"drawer-".concat(this.props.align,"-").concat(n),visible:e},t):null},t.prototype.getContents=function(){var e,t,n=this,o=null===(t=(0,r.__spreadArray)([],(0,r.__read)((null===(e=this.props.hiddenContents)||void 0===e?void 0:e.values())||[]),!1))||void 0===t?void 0:t.map((function(e){return n.getDrawerWidget(!1,e.content,e.name)})),i=this.getDrawerWidget(!0,this.props.content,this.props.name);return(0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(o),!1),[i],!1)},t.prototype.render=function(){var e,t,n,r,o=this,i=this.getWrapperClasses();this.type=null!==(e=this.props.type)&&void 0!==e?e:on.PANEL,this.animation=null!==(t=this.props.animation)&&void 0!==t?t:an.SLIDE_IN;var a=null!==(n=this.props.showCloseButton)&&void 0!==n?n:this.props.title;return ve().createElement(tn.Z,{in:this.props.opened,timeout:this.props.animationDisabled?0:300,appear:!0,classNames:{appear:nn["before-open"],appearActive:nn.opening,appearDone:nn["after-open"],enter:nn["before-open"],enterActive:nn.opening,enterDone:nn["after-open"],exit:nn["before-close"],exitActive:nn.closing,exitDone:nn["after-close"]},onEnter:this.props.onEnter,onEntered:this.props.onEntered,onExit:this.props.onExit,onExited:this.props.onExited,ref:this.transitionRef},ve().createElement("div",{ref:function(e){return o.setDrawerRef(e)},id:"workbench-drawer-".concat(this.props.align),className:i.join(" "),style:this.props.style,role:"complementary","aria-roledescription":"sidebar","aria-labelledby":"drawer-title-".concat(this.props.align)},this.props.edgeDraggable&&ve().createElement(Mn,{align:this.props.align,onDrag:this.onDrawerEdgeDrag,onDragStart:this.onDrawerEdgeDragStart,onDragEnd:this.onDrawerEdgeDragEnd}),this.props.title&&ve().createElement("div",{id:"drawer-title-".concat(this.props.align),className:nn["drawer-title"],style:this.props.titleStyle},this.props.onBack?ve().createElement("div",{className:nn["drawer-back-button"],onClick:this.props.onBack}):null,this.props.title),a&&ve().createElement("div",{className:nn["drawer-close-button"],role:"button","aria-label":"Close sidebar",style:this.props.closeButtonStyle,onClick:function(){o.props.onDrawerClose()}}),ve().createElement("div",{id:"drawer-".concat(this.props.align,"-persist"),style:{height:"100%",display:this.props.usePersistContent?"block":"none"}},(null!==(r=this.props.persistContents)&&void 0!==r?r:[]).map((function(e){return ve().createElement(Le,{style:{maxHeight:"100%",overflow:"auto",height:"100%"},key:"drawer-".concat(o.props.align,"-persist-").concat(e.name),visible:e.name===o.props.usePersistContent},e.content)}))),this.props.usePersistContent?null:this.getContents()||null))},t}(ge.Component);(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type",cn.zv)],Dn.prototype,"drawerService",void 0);var Pn=n(70230),Fn=n(63357),Bn=n(95904),Un=n(16377),Hn=n(27020),jn=function(e){function t(t){var n=e.call(this,t)||this;return n.domSubject=new Fn.xQ,n.closingSubDrawers=[],n.setDrawerRef=function(e){n.drawerDom=e,n.domSubject.next(e)},n.closeDrawer=function(){n.drawerService.closeLeftDrawer()},n.closeSubDrawer=function(e){var t;n.drawerService.removeLeftSubDrawer(e.name),null===(t=e.onClose)||void 0===t||t.call(e);var r=n.closingSubDrawers.indexOf(e.name);r>=0&&n.closingSubDrawers.splice(r,1)},n.exitSubDrawer=function(e){n.closingSubDrawers.indexOf(e)<0&&n.closingSubDrawers.push(e),n.forceUpdate()},n.handleClick=function(e){var t,r,o=(null!==(t=n.props.leftDrawerInfo)&&void 0!==t?t:{}).onClickOutside;if(o&&n.drawerDom){var i=e.clientX,a=e.clientY,s=null===(r=n.drawerDom)||void 0===r?void 0:r.getBoundingClientRect(),c=s.top,l=s.left,u=s.right,d=s.bottom;(i<l||u<i||a<c||d<a)&&o()}},n.drawerService=x.Am.get(cn.zv),n.handleVisibilityCallbackAfterRendered(),n}return(0,r.__extends)(t,e),t.prototype.handleVisibilityCallbackAfterRendered=function(){var e=this,t=this.domSubject.pipe((0,Bn.x)()),n=new Fn.xQ;this.removeListenerWhenDrawerClose(n),t.pipe((0,Un.h)((function(e){return!!e})),(0,dn.U)((function(){var t,n,r;return{visible:e.props.leftDrawerOpened,name:null===(t=e.props.leftDrawerInfo)||void 0===t?void 0:t.name,onOpen:null===(n=e.props.leftDrawerInfo)||void 0===n?void 0:n.onOpen,onClose:null===(r=e.props.leftDrawerInfo)||void 0===r?void 0:r.onClose}})),(0,Bn.x)((function(e,t){return e.name===t.name&&e.visible===t.visible})),(0,Hn.G)()).subscribe((function(t){var o,i,a,s=(0,r.__read)(t,2),c=s[0],l=s[1];if(l.visible){if(c.name!==l.name)try{var u=e.context.store.getValue(Ie.j.LeftDrawerStyle);e.drawerService.updateLeftDrawerStyle(null!=u?u:{}),null===(o=c.onClose)||void 0===o||o.call(c)}catch(e){ae.r.error("Drawer ".concat(c.name," onClose has errors:\n").concat(e))}document.addEventListener("click",e.handleClick,!0);try{null===(i=l.onOpen)||void 0===i||i.call(l)}catch(e){ae.r.error("Drawer ".concat(l.name," onOpen has errors:\n").concat(e))}}else{try{null===(a=l.onClose)||void 0===a||a.call(l)}catch(e){ae.r.error("Drawer ".concat(l.name," onClose has errors:\n").concat(e))}n.next(!0)}}))},t.prototype.removeListenerWhenDrawerClose=function(e){var t=this;e.pipe((0,Un.h)((function(e){return e}))).subscribe((function(){document.removeEventListener("click",t.handleClick,!0),e.next(!1)}))},t.prototype.render=function(){var e,t,n=this,r=this.drawerService,o=r.onBeforeShowLeftDrawer,i=r.onBeforeCloseLeftDrawer,a=r.onAfterCloseLeftDrawer;return ve().createElement("div",{className:[nn["drawer-container"],nn["drawer-left"]].join(" "),style:Object.assign(Object.assign({},this.props.leftDrawerStyle),{marginTop:this.props[Ie.j.TitlebarDOMVisible]&&Pn.w.isMobile()?44:"0"})},ve().createElement(Dn,Object.assign({forwardRef:this.setDrawerRef,service:this.drawerService,align:"left",onDrawerClose:this.closeDrawer,onEnter:o,onExit:i,onExited:a,opened:this.props.leftDrawerOpened,persistContents:this.props.leftDrawerPersistContent,hiddenContents:this.props.leftDrawerHiddenContent,animationDisabled:this.props.disableDrawerAnimation},this.props.leftDrawerInfo,{style:Object.assign(Object.assign({},null===(e=this.props.leftDrawerInfo)||void 0===e?void 0:e.style),{zIndex:0})})),(null!==(t=this.props.leftSubDrawerInfo)&&void 0!==t?t:[]).map((function(e,t){return ve().createElement(Dn,Object.assign({forwardRef:function(){},key:e.name,service:n.drawerService,align:"right",onDrawerClose:function(){return n.exitSubDrawer(e.name)},onBack:function(){return n.exitSubDrawer(e.name)},opened:n.closingSubDrawers.indexOf(e.name)<0,animationDisabled:n.props.disableDrawerAnimation,onEntered:function(){var t;return null===(t=e.onOpen)||void 0===t?void 0:t.call(e)},onExited:function(){return n.closeSubDrawer(e)}},e,{style:Object.assign(Object.assign({},e.style),{zIndex:t+1})}))})))},t}(ge.PureComponent);jn.contextType=we.FN;var Wn=(0,Se.x)([Ie.j.LeftDrawerInfo,Ie.j.LeftDrawerOpened,Ie.j.LeftDrawerStyle,Ie.j.LeftDrawerPersistContent,Ie.j.LeftDrawerHiddenContent,Ie.j.TitlebarDOMVisible,Ie.j.DisableDrawerAnimation,Ie.j.LeftSubDrawerInfo],!0)(jn),Vn=function(e){function t(t){var n=e.call(this,t)||this;return n.domSubject=new Fn.xQ,n.closingSubDrawers=[],n.setDrawerRef=function(e){n.drawerDom=e,n.domSubject.next(e)},n.closeDrawer=function(){n.drawerService.closeRightDrawer()},n.closeSubDrawer=function(e){var t;n.drawerService.removeRightSubDrawer(e.name),null===(t=e.onClose)||void 0===t||t.call(e);var r=n.closingSubDrawers.indexOf(e.name);r>=0&&n.closingSubDrawers.splice(r,1)},n.exitSubDrawer=function(e){n.closingSubDrawers.indexOf(e)<0&&n.closingSubDrawers.push(e),n.forceUpdate()},n.handleClick=function(e){var t,r,o=(null!==(t=n.props.rightDrawerInfo)&&void 0!==t?t:{}).onClickOutside;if(o&&n.drawerDom){var i=e.clientX,a=e.clientY,s=null===(r=n.drawerDom)||void 0===r?void 0:r.getBoundingClientRect(),c=s.top,l=s.left,u=s.right,d=s.bottom;(i<l||u<i||a<c||d<a)&&o()}},n.drawerService=x.Am.get(cn.zv),n.handleVisibilityCallbackAfterRendered(),n}return(0,r.__extends)(t,e),t.prototype.handleVisibilityCallbackAfterRendered=function(){var e=this,t=this.domSubject.pipe((0,Bn.x)()),n=new Fn.xQ;this.removeListenerWhenDrawerClose(n),t.pipe((0,Un.h)((function(e){return!!e})),(0,dn.U)((function(){var t,n,r;return{visible:e.props.rightDrawerOpened,name:null===(t=e.props.rightDrawerInfo)||void 0===t?void 0:t.name,onOpen:null===(n=e.props.rightDrawerInfo)||void 0===n?void 0:n.onOpen,onClose:null===(r=e.props.rightDrawerInfo)||void 0===r?void 0:r.onClose}})),(0,Bn.x)((function(e,t){return e.name===t.name&&e.visible===t.visible})),(0,Hn.G)()).subscribe((function(t){var o,i,a,s=(0,r.__read)(t,2),c=s[0],l=s[1];if(l.visible){if(c.name!==l.name)try{var u=e.context.store.getValue(Ie.j.RightDrawerStyle);e.drawerService.updateRightDrawerStyle(null!=u?u:{}),null===(o=c.onClose)||void 0===o||o.call(c)}catch(e){ae.r.error("Drawer ".concat(c.name," onClose has errors:\n").concat(e))}document.addEventListener("click",e.handleClick,!0);try{null===(i=l.onOpen)||void 0===i||i.call(l)}catch(e){ae.r.error("Drawer ".concat(l.name," onOpen has errors:\n").concat(e))}}else{try{null===(a=l.onClose)||void 0===a||a.call(l)}catch(e){ae.r.error("Drawer ".concat(l.name," onClose has errors:\n").concat(e))}n.next(!0)}}))},t.prototype.removeListenerWhenDrawerClose=function(e){var t=this;e.pipe((0,Un.h)((function(e){return e}))).subscribe((function(){document.removeEventListener("click",t.handleClick,!0),e.next(!1)}))},t.prototype.render=function(){var e,t,n=this,r=this.drawerService,o=r.onBeforeShowRightDrawer,i=r.onBeforeCloseRightDrawer,a=r.onAfterCloseRightDrawer;return ve().createElement("div",{className:[nn["drawer-container"],nn["drawer-right"]].join(" "),style:Object.assign(Object.assign({},this.props.rightDrawerStyle),{marginTop:this.props[Ie.j.TitlebarDOMVisible]&&Pn.w.isMobile()?44:"0"})},ve().createElement(Dn,Object.assign({forwardRef:this.setDrawerRef,service:this.drawerService,align:"right",onDrawerClose:this.closeDrawer,opened:this.props.rightDrawerOpened,onEnter:o,onExit:i,onExited:a,persistContents:this.props.rightDrawerPersistContent,hiddenContents:this.props.rightDrawerHiddenContent,animationDisabled:this.props.disableDrawerAnimation},this.props.rightDrawerInfo,{style:Object.assign(Object.assign({},null===(e=this.props.rightDrawerInfo)||void 0===e?void 0:e.style),{zIndex:0})})),(null!==(t=this.props.rightSubDrawerInfo)&&void 0!==t?t:[]).map((function(e,t){return ve().createElement(Dn,Object.assign({forwardRef:function(){},key:e.name,service:n.drawerService,align:"right",onDrawerClose:function(){return n.exitSubDrawer(e.name)},onBack:function(){return n.exitSubDrawer(e.name)},opened:n.closingSubDrawers.indexOf(e.name)<0,animationDisabled:n.props.disableDrawerAnimation,onEntered:function(){var t;return null===(t=e.onOpen)||void 0===t?void 0:t.call(e)},onExited:function(){return n.closeSubDrawer(e)}},e,{style:Object.assign(Object.assign({},e.style),{zIndex:t+1})}))})))},t}(ge.PureComponent);Vn.contextType=we.FN;var zn=(0,Se.x)([Ie.j.RightDrawerInfo,Ie.j.RightDrawerOpened,Ie.j.RightDrawerStyle,Ie.j.RightDrawerPersistContent,Ie.j.RightDrawerHiddenContent,Ie.j.TitlebarDOMVisible,Ie.j.DisableDrawerAnimation,Ie.j.RightSubDrawerInfo],!1,30)(Vn),Gn=n(29492),Yn=n(71545),qn={contextmenu:"context-menu_contextmenu__2Aa6v","dui-divider-compact":"context-menu_dui-divider-compact__3Te8M","dui-divider-horizontal":"context-menu_dui-divider-horizontal__2PCv2","contextmenu-overlay":"context-menu_contextmenu-overlay__aBGJU","contextmenu-icon":"context-menu_contextmenu-icon__LViQv"};(0,Ee.Z)(".context-menu_contextmenu__2Aa6v {\n  min-width: 180px;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n          user-select: none;\n  position: fixed;\n  z-index: 4001;\n  box-shadow: 0 2px 8px 2px rgba(68, 73, 77, 0.16);\n  border: 0 solid rgba(0, 0, 0, 0.12);\n  border-radius: 4px;\n  height: auto !important;\n}\n.context-menu_contextmenu__2Aa6v .context-menu_dui-divider-compact__3Te8M.context-menu_dui-divider-horizontal__2PCv2 {\n  margin: 6px 0 !important;\n}\n.context-menu_contextmenu-overlay__aBGJU {\n  position: fixed;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  z-index: 4000;\n}\n.context-menu_contextmenu-icon__LViQv {\n  position: absolute;\n  left: 10px;\n  height: 20px;\n  width: 20px;\n}\n");var Zn=function(e){var t,n=e.item,r=e.badge,o=n.content;return t="function"==typeof o?o():o,ve().isValidElement(t)&&"string"==typeof t.type&&(t=ve().cloneElement(t,{onMouseDown:function(e){e.preventDefault()}})),r?ve().createElement(Re.S,null,ve().createElement("div",null,null!=t?t:null,ve().createElement(Wt.ZP,{status:"error",style:{transform:"scale(0.6)",marginLeft:4}}))):ve().createElement(Re.S,null,null!=t?t:null)},Jn=n(1205),Kn=1/0,Qn=function(e){function t(t){var n=e.call(this,t)||this;return n.edges={left:!1,right:!1,top:!1,bottom:!1},n.levelInfo={current:0},n.ref=(0,ge.createRef)(),n.getBadgeTree=function(){return n.props.badge.filter((function(e){return"contextMenu"===e.position})).map((function(e){return e.key}))},n.handleClick=function(e){n.props.contextMenuInfo.show&&(e.ctrlKey||n.hoveringMenu||n.contextMenuService.hideContextMenu())},n.enter=function(){n.hoveringMenu=!0},n.leave=function(){n.hoveringMenu=!1},n.shouldShow=function(e){var t=!0;if(e.shouldHide&&(t=!(0,It.k)(e.shouldHide,!1)),t&&!e.ignoreChildrenHideStatus&&e.children.length>0){var r=!1;return r=e.children.reduce((function(e,t){return e||n.shouldShow(t)}),r),t&&r}return t},n.getShortcut=function(e){if(void 0!==e)return Pn.w.isMac()?e.mac:e.win},n.shouldDisabled=function(e){return!!e.shouldDisabled&&(0,It.k)(e.shouldDisabled,!1)},n.removeUnnecessaryDivider=function(e,t,n){if("divider"===e.name){if(t<Kn)return!1;var r=n[t+1];if(!r)return!1;if("divider"===r.name)return!1}else Kn>t&&(Kn=t);return!0},n.generateMenuTree=function(e,t){if(0===t&&n.enterMenuTree(),"divider"===e.name)return ve().createElement(Yt.default,{key:"divider-".concat(t)});Kn=1/0;var r=e.children.filter((function(e){return!(0,It.k)(e.shouldHide,!1)})).filter(n.removeUnnecessaryDivider);if(0===e.children.length||0===r.length&&e.onClick){var o=n.checkBadge(e.name);return n.generateMenuItem({item:e,badge:o})}var i=r.map(n.generateMenuTree),a=Object.assign({},n.getCurrentLevelInfo());return n.leaveMenuTree(),e.children.length>0&&0===r.length&&!e.onClick?null:n.genarateSubMenu(e,t,i,a)},n.handleVisibleChange=function(e,t){e&&n.badgeTree.indexOf(t)>=0&&n.badgeService.removeBadgeOn("contextMenu",t)},n.handleMenuClick=function(e){var t;n.contextMenuService.restoreFocus();var r=n.contextMenuService.get(e);if(null===(t=r.onClick)||void 0===t||t.call(r),n.props.badge.some((function(e){return e.key===(null==r?void 0:r.name)&&"contextMenu"===e.position}))&&n.badgeService.removeBadgeOn("contextMenu",r.name),r.preventDismiss)return n.selectionChangePrevent=!0,void setTimeout((function(){n.selectionChangePrevent=!1}),100);n.contextMenuService.hideContextMenu()},n.calculateEdges=function(e){n.edges={left:!1,right:!1,top:!1,bottom:!1};var t=e.filter((function(e){return"".concat(e.key).startsWith("divider")})).length,r=28*(e.length-t)+13*t+12,o=document.body.offsetHeight;return n.props.contextMenuInfo.left+180>document.body.offsetWidth&&(n.edges.right=!0),n.props.contextMenuInfo.top+r>document.body.offsetHeight&&(n.edges.bottom=!0,n.props.contextMenuInfo.top-r<0&&(n.edges.top=!0,o=document.body.offsetHeight-48)),n.props.contextMenuInfo.left<50&&(n.edges.left=!0),[180,r,o]},n.state={},n}return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){document.addEventListener("click",this.handleClick,!0)},t.prototype.componentWillUnmount=function(){document.removeEventListener("click",this.handleClick,!0)},t.prototype.componentDidUpdate=function(e){this.props.contextMenuInfo.show?e.contextMenuInfo.show||this.eventEmitter.emit(Be.c.ContextMenuShowed):(this.contextMenuService.restoreFocus(),e.contextMenuInfo.show&&this.eventEmitter.emit(Be.c.AfterContextMenuDismissed)),this.updateContextmenuRealHeight()},t.prototype.updateContextmenuRealHeight=function(){var e=this;window.requestAnimationFrame((function(){var t,n,r,o=null===(r=null===(n=null===(t=e.ref.current)||void 0===t?void 0:t.listRef)||void 0===n?void 0:n.current)||void 0===r?void 0:r.getBoundingClientRect().height;o&&o!==e.state.contextMenuHeight&&e.setState({contextMenuHeight:o})}))},t.prototype.checkBadge=function(e){return this.badgeTree.includes(e)},t.prototype.render=function(){var e;if(this.props["contextMenu.disabled"]||!this.props.contextMenuInfo.show)return this.hoveringMenu&&this.leave(),null;this.badgeTree=this.getBadgeTree(),Kn=1/0;var t=this.props.contextMenu.children.filter(this.shouldShow).filter(this.removeUnnecessaryDivider).map(this.generateMenuTree).filter((function(e){return null!==e})),n=this.getCurrentLevelInfo(),o=n.needCheckPadding,i=n.hasIcon;if(this.leaveMenuTree(),0===t.length)return null;var a=(0,r.__read)(this.calculateEdges(t),3),s=a[0],c=a[1],l=a[2],u=null!==(e=this.state.contextMenuHeight)&&void 0!==e?e:c,d=Math.min(u,l),p=this.edges.top?24:this.props.contextMenuInfo.top-d,f=this.edges.bottom?p:this.props.contextMenuInfo.top+10,_=document.body.clientHeight-d-36;f>_&&(f=_);var h=(this.edges.right?this.props.contextMenuInfo.left-s:this.props.contextMenuInfo.left)+10;return ve().createElement(ve().Fragment,null,this.settings.contextMenu.hasOverlay&&ve().createElement("div",{className:qn["contextmenu-overlay"],style:{display:this.props.contextMenuInfo.show?"block":"none"},onContextMenu:function(e){e.preventDefault()}}),ve().createElement(Gn.default,{type:i?"with-icon":"normal",onClick:this.handleMenuClick,className:qn.contextmenu,selectable:o,onMouseEnter:this.enter,onMouseLeave:this.leave,ref:this.ref,style:Object.assign({display:this.props.contextMenuInfo.show?"block":"none",top:f,left:h},l<Number.MAX_SAFE_INTEGER?{overflowY:"auto",maxHeight:l}:{})},t))},t.prototype.getDescription=function(e){return"function"==typeof e.description?e.description():e.description},t.prototype.enterMenuTree=function(){this.levelInfo.current+=1},t.prototype.leaveMenuTree=function(){delete this.levelInfo[this.levelInfo.current],this.levelInfo.current-=1},t.prototype.recordLevelInfo=function(e,t,n){var r=this.levelInfo.current;this.levelInfo[r]?(this.levelInfo[r].needCheckPadding=this.levelInfo[r].needCheckPadding||e,this.levelInfo[r].hasIcon=this.levelInfo[r].hasIcon||t,this.levelInfo[r].childBeenChecked=this.levelInfo[r].childBeenChecked||n):this.levelInfo[r]={needCheckPadding:e,hasIcon:t,childBeenChecked:n}},t.prototype.getCurrentLevelInfo=function(){var e,t=this.levelInfo.current;return null!==(e=this.levelInfo[t])&&void 0!==e?e:{hasIcon:!1,hasCheck:!1}},t.prototype.shouldCheck=function(e){return!!e.shouldCheck&&(0,It.k)(e.shouldCheck,!1)},t.prototype.generateMenuItem=function(e){var t=e.item,n=e.badge,r=void 0!==t.shouldCheck,o=void 0!==t.icon,i=this.shouldCheck(t);this.recordLevelInfo(r,o,i);var a=this.shouldDisabled(t),s=t.preventHighlight?{background:"transparent"}:{},c="function"==typeof t.style?t.style():t.style,l=ve().createElement(Gn.default.Item,{id:t.name,disabled:a,style:Object.assign(Object.assign({},c),s),key:t.name,icon:o?ve().createElement("div",{className:qn["workbench-menu-item-icon"]},t.icon):void 0,selected:this.shouldCheck(t),className:"contextmenu-item-".concat(t.name),description:this.getDescription(t)||this.getShortcut(t.shortcut),onMouseEnter:a?void 0:t.onMouseEnter,onMouseLeave:a?void 0:t.onMouseLeave},ve().createElement(Zn,{item:t,badge:n}));return t.tooltip&&(l=ve().createElement(ve().Fragment,{key:t.name},(0,Jn.t)(l,t.tooltip,{style:{display:"block"}}))),l},t.prototype.genarateSubMenu=function(e,t,n,r){var o=this,i="function"==typeof e.style?e.style():e.style,a="function"==typeof e.popUpStyle?e.popUpStyle():e.popUpStyle,s="function"==typeof e.popupClassName?e.popupClassName():e.popupClassName,c=this.checkBadge(e.name),l=void 0!==e.icon,u=this.shouldCheck(e),d=r.needCheckPadding||!!e.syncCheckStatus,p=r.childBeenChecked,f=u||p&&!!e.syncCheckStatus;return this.recordLevelInfo(!!e.syncCheckStatus,l,f),ve().createElement(Gn.default.SubMenu,{id:e.name,title:ve().createElement(Zn,{item:e,badge:c}),key:"sub-".concat(e.name,"-").concat(t),style:i,icon:l?ve().createElement("div",{className:qn["workbench-menu-item-icon"]},e.icon):void 0,selectable:d,selected:f,popupStyle:a,popupClassName:s,type:l?"with-icon":"normal",onVisibleChange:function(t){var n;null===(n=e.onVisibleChange)||void 0===n||n.call(e,t),o.handleVisibleChange(t,e.name)},disabled:this.shouldDisabled(e)},n)},t}(ge.Component);Qn.contextType=we.FN,(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type",Fe.v)],Qn.prototype,"eventEmitter",void 0),(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type",Yn.L)],Qn.prototype,"contextMenuService",void 0),(0,r.__decorate)([(0,x.tB)(Vt.c),(0,r.__metadata)("design:type",Object)],Qn.prototype,"badgeService",void 0),(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type",re.I)],Qn.prototype,"settings",void 0);var Xn=(0,Se.x)([Ie.j.ContextMenu,Ie.j.ContextMenuInfo,fe.R.DisableContextMenu,Ie.j.Badge])(Qn),$n=n(65419),er=n(15315),tr={titlebar:"titlebar_titlebar__2RoCq","titlebar-pusher":"titlebar_titlebar-pusher__2dcNp","titlebar-content":"titlebar_titlebar-content__1q_Y-",group:"titlebar_group__1FF5g",row:"titlebar_row__1f8v1","titlebar-hover-hot-zone":"titlebar_titlebar-hover-hot-zone__1isc5"};(0,Ee.Z)(".titlebar_titlebar__2RoCq {\n  position: absolute;\n  width: 100%;\n  text-align: left;\n  z-index: 1350;\n  border-bottom-style: solid;\n  border-bottom-width: 1px;\n  border-bottom-color: var(--workbench-theme-titlebar-border, rgba(0, 0, 0, 0.04));\n  display: flex;\n  align-items: center;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n          user-select: none;\n  padding: 0;\n  box-sizing: border-box;\n  flex-shrink: 0;\n  background: var(--workbench-theme-titlebar-background, #f9fafb);\n  transition: background 0.3s ease;\n}\n.titlebar_titlebar__2RoCq .titlebar_titlebar-pusher__2dcNp {\n  margin: 0 auto;\n}\n.titlebar_titlebar__2RoCq .titlebar_titlebar-content__1q_Y- {\n  flex-shrink: 0;\n  margin: 0 8px;\n  color: var(--workbench-theme-titlebar-foreground, #000000);\n}\n.titlebar_titlebar__2RoCq > .titlebar_group__1FF5g {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  height: 100%;\n  white-space: nowrap;\n}\n.titlebar_titlebar__2RoCq > .titlebar_group__1FF5g .titlebar_row__1f8v1 {\n  display: flex;\n  align-items: center;\n}\n.titlebar_titlebar-hover-hot-zone__1isc5 {\n  width: 100%;\n  background: var(--workbench-theme-titlebar-background, #f9fafb);\n}\n");var nr=function(e){function t(){var t=e.apply(this,(0,r.__spreadArray)([],(0,r.__read)(arguments),!1))||this;return t.ref=ve().createRef(),t.handleClick=function(e){var n,r;t.props.preventOriginalClick&&e.stopPropagation(),t.props.disabled||(null===(r=(n=t.props).onClick)||void 0===r||r.call(n),t.titlebarService.setHoverActive(!1))},t}return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.sensor=new xt((function(){var t,n;if(!1!==e.props.visible){var r=getComputedStyle(e.ref.current),o=e.ref.current.clientWidth,i=parseInt(r.marginLeft,10)+parseInt(r.marginRight,10);e.titlebarService.updateWidth(e.props,o,i),null===(n=(t=e.props).onWidthChange)||void 0===n||n.call(t,o)}})),this.ref.current&&this.sensor.observe(this.ref.current)},t.prototype.componentDidUpdate=function(e){var t,n,r;e.visible!==this.props.visible&&(null===(n=(t=this.props).onVisibleChange)||void 0===n||n.call(t,null===(r=this.props.visible)||void 0===r||r))},t.prototype.componentWillUnmount=function(){this.titlebarService.updateWidth(this.props,0,0),this.sensor.disconnect()},t.prototype.getAriaAttributes=function(){var e={},t=this.props,n=t.ariaLabel,r=t.tooltip,o=t.content;t.onClick&&(e.role="button"),this.props.disabled&&(e["aria-disabled"]=this.props.disabled);var i=n||("string"==typeof o?o:void 0)||("string"==typeof r?r:void 0);return i&&(e["aria-label"]=i),e},t.prototype.render=function(){var e=this.props,t=e.content,n=e.style,r=null!=n?n:{},o=t;ve().isValidElement(o)&&(o=ve().cloneElement(o,{disabled:this.props.disabled}));var i=!1===this.props.visible?{maxWidth:0,minWidth:0,margin:0,overflow:"hidden"}:{};return ve().createElement("div",Object.assign({onClickCapture:this.handleClick,ref:this.ref},this.getAriaAttributes(),{style:Object.assign(Object.assign(Object.assign(Object.assign({},this.props["titlebar.contentDefaultStyle"]),r),{flexBasis:"continuous"!==this.props.shrinkable?this.props.width:void 0,flexShrink:"continuous"===this.props.shrinkable?1:0,maxWidth:this.props.width}),i),className:tr["titlebar-content"]}),o)},t}(ge.PureComponent);(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type",er.M)],nr.prototype,"titlebarService",void 0);var rr=(0,Se.x)([fe.R.TitlebarContentDefaultStyle])(nr);function or(e){return Object.assign(Object.assign({},e),{tooltip:(0,It.k)(e.tooltip,""),disabled:(0,It.k)(e.shouldDisabled,!1),style:(0,It.k)(e.style,void 0),content:(0,It.k)(e.content,void 0)})}var ir=n(16033),ar=n(78963),sr=function(e){function t(){var t=e.apply(this,(0,r.__spreadArray)([],(0,r.__read)(arguments),!1))||this;return t.ref=ve().createRef(),t}return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.sensor=new xt((function(){if(!1!==e.props.visible){var t=getComputedStyle(e.ref.current),n=e.ref.current.clientWidth,r=parseInt(t.marginLeft,10)+parseInt(t.marginRight,10);e.titlebarService.updateWidth(e.props,n,r)}})),this.ref.current&&this.sensor.observe(this.ref.current)},t.prototype.componentWillUnmount=function(){this.titlebarService.updateWidth(this.props,0,0),this.sensor.disconnect()},t.prototype.render=function(){var e=this.props,t=e.name,n=e.ariaLabel,r=e.items,o=e.getComponent,i=!1===this.props.visible?{maxWidth:0,minWidth:0,margin:0,overflow:"hidden"}:{},a=r.some((function(e){return e.some((function(e){return"pusher"===e.name}))}))?{flex:1}:{};return ve().createElement("div",{ref:this.ref,style:Object.assign(Object.assign({},i),a),role:"group","aria-label":n,className:tr.group},r.map((function(e,n){return ve().createElement("div",{className:tr.row,key:"".concat(t,"-").concat(n)},e.map((function(e,t){return o(e,"".concat(n,"-").concat(t))})))})))},t}(ge.PureComponent);(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type",er.M)],sr.prototype,"titlebarService",void 0);var cr=function(e){function t(){var t=e.apply(this,(0,r.__spreadArray)([],(0,r.__read)(arguments),!1))||this;return t.ref=ve().createRef(),t.mousemove=null,t.click=null,t.hovering=!1,t.groupItemsMap=new Map,t.shouldHide=function(e){return(0,It.k)(e.shouldHide,!1)},t.getComponent=function(e,n){if((0,ar.g)(e))return ve().createElement(sr,Object.assign({key:"".concat(e.name,"-").concat(n),getComponent:t.getComponent,items:t.groupItemsMap.get(e.name)},e,t.props.titlebarCalculatedWidth[e.name]));var r=e.content,o=e.name;return r?ve().createElement(Re.S,{key:o},ve().createElement(rr,Object.assign({},or(e),t.props.titlebarCalculatedWidth[o]))):"pusher"===o?ve().createElement("div",{className:tr["titlebar-pusher"],key:"".concat(e.name,"-").concat(n)}):"divider"===o?ve().createElement(rr,{key:"".concat(e.name,"-").concat(n),name:e.name,style:{margin:"0 4px"},content:ve().createElement(Yt.default,{style:{display:"block",height:"".concat(Math.floor(t.props["titlebar.height"]/9*4),"px"),borderRight:"1px solid rgba(0,0,0)",opacity:.06,margin:0},orientation:"vertical"})}):null},t.clickOutsideTitlebar=function(e){var n;(null===(n=t.ref.current)||void 0===n?void 0:n.contains(e.target))||(t.titlebarService.setHoverActive(!0),t.store.update(Ie.j.TitlebarShow,!1))},t.handleMouseMove=function(e){var n,r,o=e.clientY,i=e.clientX,a=null===(r=null===(n=t.ref)||void 0===n?void 0:n.current)||void 0===r?void 0:r.getBoundingClientRect(),s=a.top,c=a.left,l=a.right,u=t.getTakeUpSpaceHeight();t.props[Ie.j.TitlebarListenMouseMove]&&i<=l&&i>=c&&o<=s+t.titlebarHeight+u&&o>=s+t.titlebarHeight?(t.hovering=!0,t.store.update(Ie.j.TitlebarShow,!0)):t.props[Ie.j.TitlebarListenMouseMove]&&o>s+t.props["titlebar.height"]&&t.props[Ie.j.TitlebarShow]&&t.store.update(Ie.j.TitlebarShow,!1)},t}return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.sensor=new xt((function(){var t=getComputedStyle(e.ref.current),n=[t.paddingLeft,t.paddingRight].reduce((function(e,t){return e+parseInt(t,10)}),0);e.titlebarService.updateContainerWidth(e.ref.current.clientWidth-n)})),this.ref.current&&this.sensor.observe(this.ref.current),this.props[fe.R.TitlebarHoverable]&&this.store.get(Ie.j.TitlebarHover).subscribe((function(t){var n,r;t?(e.mousemove=(0,ln.R)(document,"mousemove").pipe((0,$n.p)(30)).subscribe(e.handleMouseMove),e.click=(0,ln.R)(document,"click").subscribe(e.clickOutsideTitlebar)):(null===(n=e.mousemove)||void 0===n||n.unsubscribe(),null===(r=e.click)||void 0===r||r.unsubscribe(),e.hovering=!1)})),this.eventEmitter.emit(Be.c.TitlebarMounted,this.ref.current)},t.prototype.componentWillUnmount=function(){this.sensor.disconnect()},t.prototype.filterGroupConfig=function(e){var t=this;e.rows=e.rows.map((function(e){return e.map((function(e){return e.filter((function(e){return!t.shouldHide(e)}))})).filter((function(e){return!!e.length}))})).filter((function(e){return!!e.length}))},t.prototype.convertTitlebar=function(e){var t=this;this.groupItemsMap.clear();var n=function(e){return e.reduce((function(e,t){var n,r;return 0===t.length?e:0===e.length||"pusher"===(null===(n=e[e.length-1])||void 0===n?void 0:n.name)||"pusher"===(null===(r=t[0])||void 0===r?void 0:r.name)?e.concat(t):e.concat({name:"divider"},t)}),[])},r=e.map((function(e){return e.filter((function(e){return(0,ar.g)(e)?(t.filterGroupConfig(e),!(t.shouldHide(e)||!e.rows.length||(t.groupItemsMap.set(e.name,e.rows.map((function(e){return n(e)}))),0))):!t.shouldHide(e)}))}));return n(r)},t.prototype.getTakeUpSpaceHeight=function(){var e=this.props[fe.R.TitlebarHoverable];return"boolean"!=typeof e&&(null==e?void 0:e.takeUpSpaceHeight)?e.takeUpSpaceHeight:this.props["titlebar.height"]/3},Object.defineProperty(t.prototype,"titlebarHeight",{get:function(){var e;return null!==(e=this.props["titlebar.height"])&&void 0!==e?e:48},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this,t=this.convertTitlebar(this.props.titlebar),n=[tr.titlebar,this.props.titlebarFocus?tr.active:""];return ve().createElement(ve().Fragment,null,ve().createElement(ir.K,{name:"titlebar",onExited:function(){e.hovering=!1},simulateSpaceChange:!this.hovering},ve().createElement("div",{id:"workbench-titlebar",ref:this.ref,className:n.join(" "),style:{height:this.titlebarHeight},role:"toolbar","aria-label":"titlebar"},t.map(this.getComponent))))},t}(ge.PureComponent);(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type",er.M)],cr.prototype,"titlebarService",void 0),(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type",de.O)],cr.prototype,"store",void 0),(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type",Fe.v)],cr.prototype,"eventEmitter",void 0);var lr=(0,Se.x)([Ie.j.Titlebar,Ie.j.TitlebarShow,Ie.j.TitlebarFocus,fe.R.TitlebarHeight,fe.R.TitlebarHoverable,Ie.j.TitlebarCalculatedWidth,Ie.j.TitlebarHover,Ie.j.TitlebarListenMouseMove])(cr),ur=n(12607),dr=n(51850),pr=n(56610),fr=n(75151),_r=n(37579),hr=n(68963),mr=n(8487),gr=n(580),vr=n(96748),br=(0,Se.x)([Ie.j.LeftDrawerOpened,Ie.j.RightDrawerOpened],!1,0,pr.Zt)(ve().memo((function(e){var t,n,r,o,i,a=(0,ge.useContext)(we.FN),s=e.alignment,c=e.dataType,l=e.minorDataType,u="".concat(Ie.j.MultiLineToolbarContainer,"-").concat(c,"-height"),d="".concat(Ie.j.MultiLineToolbarContainer,"-").concat(l,"-height"),p=Math.max((0,dr.p)(u,0),(0,dr.p)(d,0)),f=void 0;if(Ue.s||!hr.aL.includes(c)){var _=(0,dr.p)(c,{data:[]}).data,h=(0,dr.p)(l,{data:[]}).data,m=_r.O.getGroupProps(_,[]),g=m.buttonGroup,v=m.toolbarRows,b=_r.O.getGroupProps(h,[]).buttonGroup;o={buttonGroup:g,toolbarType:"fixed",toolbarRows:v,alignment:s},i={buttonGroup:b,toolbarType:"fixed",alignment:s}}else{o=(0,dr.p)("".concat(Ie.j.MultiLineToolbarContainer,"-").concat(c),{toolbarType:"fixed",alignment:s});var y=null===(t=(i=(0,dr.p)("".concat(Ie.j.MultiLineToolbarContainer,"-").concat(l),{toolbarType:"fixed",alignment:"right"})).shrinkParam)||void 0===t?void 0:t.buttonsWidth;b=i.buttonGroup,y&&b&&(f=b.reduce((function(e,t,n){var r;return n>0&&(e+=null!==(r=y.get(hr.cE))&&void 0!==r?r:0),e+t.items.reduce((function(e,t){var n;return e+(null!==(n=y.get(t.key))&&void 0!==n?n:0)}),0)}),0)+hr.te-2*hr.Lh)}(0,ge.useEffect)((function(){var e=new Event("fixed-toolbar-re-render");window.dispatchEvent(e),x.Am.get(Fe.v).emit(Be.c.ToolbarUpdated)}),[o]);var w=(0,ge.useRef)(null===(n=i.shrinkParam)||void 0===n?void 0:n.buttonsWidth);return(0,ge.useEffect)((function(){var e,t;(function(e,t){if(!e&&!t)return!0;if(e&&!t||!e&&t)return!1;if((null==e?void 0:e.size)!==(null==t?void 0:t.size))return!1;var n=!0;return null==e||e.forEach((function(e,r){(null==t?void 0:t.get(r))!==e&&(n=!1)})),n})(w.current,null===(e=i.shrinkParam)||void 0===e?void 0:e.buttonsWidth)||(w.current=null===(t=i.shrinkParam)||void 0===t?void 0:t.buttonsWidth,x.Am.get(ue._).emit(mr.G.MinorButtonsChanged))}),[null===(r=i.shrinkParam)||void 0===r?void 0:r.buttonsWidth]),function(){if(!(o.buttonGroup&&o.buttonGroup.length>0||i.buttonGroup&&i.buttonGroup.length>0))return null;var t=[ur.Z["container-wrapper"]];(function(){var t=!1;if(e.leftDrawerOpened){var n=a.store.getValue(Ie.j.LeftDrawerInfo);t=t||(null==n?void 0:n.type)!==on.TRANSPARENT}return e.rightDrawerOpened&&(n=a.store.getValue(Ie.j.RightDrawerInfo),t=t||(null==n?void 0:n.type)!==on.TRANSPARENT),t})()&&t.push(ur.Z["container-with-drawer"]);var n=f?-(f-hr.te):void 0;return ve().createElement(ir.K,{name:"fixed-toolbar",simulateSpaceChange:!0},ve().createElement("div",{className:t.join(" "),id:"fixed-toolbar",style:Ue.s?void 0:{height:"".concat(p,"px")}},ve().createElement("div",{className:"".concat(ur.Z.container," ").concat(ur.Z["container-fixed"]," ").concat(ur.Z["alignment-".concat(s)]),style:{marginRight:f}},ve().createElement(fr.c,Object.assign({},o,{key:"major-fix-toolbar",toolbarType:"fixed",alignment:s,changeParentElementStyle:!0,multiLineClassName:ur.Z["major-toolbar"]})),ve().createElement("div",{className:ur.Z.pusher}),i&&ve().createElement(fr.c,Object.assign({},i,{key:"minor-fix-toolbar",toolbarType:"fixed",alignment:"right",shrinkParam:void 0,multiLineClassName:ur.Z["minor-toolbar"],multiLineStyle:{right:n}})))))}()})));x.Am.service(br,{overridable:!0});var yr=n(2042),wr=n(47082),Er=(0,Se.x)([Ie.j.Badge,Ie.j.ModelState,Ie.j.SelectionState],!1,0,un.Z)(ve().memo((function(e){var t=e.dataType,n=e.hiddenToolbarId,o=e[Ie.j.Badge],i=(0,ge.useRef)(null),a=(0,dr.p)(t,{data:[]}),s=a.data,c=a.moreText,l=a.moreTooltip,u=_r.O.filterHiddenGroupConfig(s),d=u.toolbarData,p=u.toolbarRow,f=(0,r.__spreadArray)([],(0,r.__read)(d),!1);p>0&&f.push(function(e,t){var n,r=t.moreText,o=void 0===r?"更多":r,i=t.moreTooltip;return n=1!==e?{type:"text",name:hr.Sq,tooltip:i,style:{width:42,margin:"auto"},text:o,icon:yr.sy,dropdownContent:function(){return ve().createElement("div",null)},shouldHide:function(){return!1},shouldVerticallyArrange:!0}:{type:"icon",name:hr.Sq,tooltip:i,shouldHide:function(){return!1},hasArrow:!1,icon:yr.sy,dropdownContent:function(){return ve().createElement("div",null)}},{key:hr.Sq,shrinkType:gr.fh.OVERALL_TAIL,priority:[-1],shrinkSteps:[[hr.Sq]],shelter:null,shouldMerge:!1,items:[{key:hr.Sq,shelter:null,buttons:[[n]]}]}}(p,{moreText:c,moreTooltip:l}));var _=_r.O.flatToolbarGroup(f,o),h=_.initializeRenderingData,m=_.toolbarRow,g=_.shrinkToolbarGroupItemConfig,v=new Map,b=x.Am.get(de.O),y=function(){var e,n,o,s,c,l,u,d,p,_,y;try{var w=null===(o=null===(n=null===(e=i.current)||void 0===e?void 0:e.firstElementChild)||void 0===n?void 0:n.firstElementChild)||void 0===o?void 0:o.children,E=null===(s=i.current)||void 0===s?void 0:s.offsetHeight;if(E&&b.upsert("".concat(Ie.j.MultiLineToolbarContainer,"-").concat(t,"-height"),E),w){var C=h.reduce((function(e,t){var n=t.items;return e.concat(n.reduce((function(e,t){var n=t.key;return e.concat(n)}),[]))}),[]).reverse();Array.from(w).forEach((function(e,t){var n=0===t?1:0,r=t===w.length-1?1:0,o=(0,wr.H)(e)+(r+n)*hr.Lh;if(-1!==e.className.indexOf("toolbar-divider")){var i="".concat(hr.cE);v.set(i,o)}else{var a=C.pop();a&&v.set(a,o)}}));var T=v.get(hr.Sq),S=v.get(hr.cE);void 0!==T&&void 0!==S&&v.set(hr.Sq,T-S),b.upsert(hr.Si,v);var I=Object.assign(Object.assign({},(c=f,l=x.Am.get(de.O).getValue(hr.Si)||new Map,u=new Map,d=new Map,p=new Map,_=new Map,y=new Map,c.map((function(e){var t,n,o=e.key,i=e.shrinkType,a=e.priority,s=e.shrinkSteps,c=e.shouldMerge,l=[],f=[];e.items.map((function(e){if(l.push(e.key),e.shelter){var t=e.shelter.name;d.set(e.key,vr.f.REPLACE),l.push(t),f.push(t),u.set(e.key,t)}})),i!==gr.fh.OVERALL_DIVIDER&&i!==gr.fh.PARTIAL_DIVIDER||(s&&s.map((function(e){e.map((function(e){d.get(e)||d.set(e,vr.f.DIVIDER)}))})),y.set(0,[[o]].concat(null!==(t=y.get(0))&&void 0!==t?t:[])),d.set(o,vr.f.TAIL)),l.filter((function(e){return!d.get(e)})).map((function(e){d.set(e,vr.f.TAIL)}));var _=new Map;a.map((function(e,t){var n,r,o=null!==(n=_.get(e))&&void 0!==n?n:[];_.set(e,o.concat([null!==(r=s[t])&&void 0!==r?r:[]])),l=l.filter((function(e){return!s[t].includes(e)})),f=f.filter((function(e){return!s[t].includes(e)}))})),Array.from(_).map((function(e){var t,n,o=(0,r.__read)(e,1)[0],i=null!==(t=_.get(o))&&void 0!==t?t:[];y.set(o,i.concat(null!==(n=y.get(o))&&void 0!==n?n:[]))}));var h=null!==(n=y.get(0))&&void 0!==n?n:[];l.map((function(e,t){var n=u.get(e);n&&f.includes(n)&&l.indexOf(n)>t&&(h=[[n]].concat(h),f=f.filter((function(e){return e!==n}))),h=[[e]].concat(h)})),y.set(0,h),c&&p.set(o,hr.Sq)})),d.delete(hr.Sq),{replaceButtons:u,buttonsWidth:l,shouldMergeButtons:p,shrinkType:d,shrinkSteps:_r.O.getShrinkSteps(y),shelterContainer:_,shrinkToolbarButton:[]})),{shrinkToolbarButton:g});!function(e){var n={toolbarType:"fixed",buttonGroup:h.map((function(e){return{key:e.key,items:e.items.filter((function(t){return t.key!==e.key}))}})).filter((function(e){return e.items.length>0})),toolbarRows:m,shrinkParam:e,ariaLabel:a.ariaLabel,moreButtonText:a.moreText,moreButtonTooltip:a.moreTooltip,alignment:gr.J1.LEFT};b.upsert("".concat(Ie.j.MultiLineToolbarContainer,"-").concat(t),n)}(I)}}catch(e){console.error("[workbench] calculate toolbar button width error",e)}};return(0,ge.useEffect)((function(){i.current&&y()}),[h]),ve().createElement("div",{id:n,ref:i,style:{display:Ue.s?"none":"flex"},tabIndex:-1,"aria-hidden":!0,className:"".concat(ur.Z["hidden-toolbar"]," ").concat(ur.Z["container-wrapper"])},ve().createElement(fr.c,{toolbarType:"fixed",key:"initialize-rendering-toolbar",alignment:"center",buttonGroup:h,toolbarRows:m,shrinkParam:void 0,tabIndex:-1}))})));x.Am.service(Er,{overridable:!0});var Cr=function(e){function t(t){var n=e.call(this,t)||this;return n.statusBarRef=null,n.statusBarRef=ve().createRef(),n}return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){var e,t;null===(t=null===(e=this.statusBarRef)||void 0===e?void 0:e.current)||void 0===t||t.addEventListener("animationend",this.removeFixed)},t.prototype.componentWillUnmount=function(){var e,t;null===(t=null===(e=this.statusBarRef)||void 0===e?void 0:e.current)||void 0===t||t.removeEventListener("animationend",this.removeFixed)},t.prototype.removeFixed=function(e){e.currentTarget.style.position="static"},t.prototype.render=function(){var e=x.Am.getClass(br),t=x.Am.getClass(Er),n=!this.props["toolbar.disabled"],r=this.props["toolbar.schemaAnimation"];return ve().createElement("div",{className:Jt,id:"workbench",style:this.props.style},!this.props["titlebar.disabled"]&&ve().createElement(lr,null),n&&ve().createElement("div",{className:Kt,id:"workbench-toolbar"},!Ue.s&&ve().createElement(ve().Fragment,null,ve().createElement("div",{id:"hidden-toolbar",className:Qt},hr.aL.map((function(e){return ve().createElement(t,{key:"".concat(e,"-hidden"),dataType:e,hiddenToolbarId:"".concat(e,"-hidden")})}))),r&&ve().createElement("div",{id:"fixed-toolbar-animation"})),ve().createElement(e,{dataType:"toolbar-normal",minorDataType:"toolbar-pinned",alignment:this.props["toolbar.alignment"]})),ve().createElement("div",{className:Xt,id:"workbench-content-container"},ve().createElement("div",{className:$t,id:"workbench-drawer"},ve().createElement(Wn,null),ve().createElement(zn,null)),ve().createElement(Dt,{mode:"pc"}),ve().createElement(Xn,null)),ve().createElement("div",{className:en,id:"workbench-statusbar",ref:this.statusBarRef},this.props["statusbar.disabled"]?null:ve().createElement(Zt,null)))},t}(ge.Component),Tr=(0,Se.x)([fe.R.DisableToolbar,fe.R.ToolbarAlignment,fe.R.DisableStatusbar,fe.R.ToolbarSchemaAnimation,fe.R.DisableTitlebar])(Cr),xr=n(92873),Sr=n(22703),Ir=n(61399),kr=n(44773),Rr=n(74380),Ar=n(95431),Or=n(4912),Lr=n(51838),Mr=n(60238),Nr=function(){function e(e,t){this.trackControllerService=e,this.adapterMatchService=t}return e.prototype.use=function(e,t,n){var r=this.trackControllerService.getConfigController(e.from+e.name),o=r?Ar.p.get(r):void 0;return!this.adapterMatchService.isAvailable(o,t)&&(n(),!0)},e}();(0,r.__decorate)([(0,r.__param)(0,(0,Or.g)()),(0,r.__param)(1,(0,J.M)()),(0,r.__param)(2,(0,G.o)()),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object,Object,Function]),(0,r.__metadata)("design:returntype",void 0)],Nr.prototype,"use",null),Nr=(0,r.__decorate)([(0,Y.d)(),(0,r.__metadata)("design:paramtypes",[Lr.r,Mr.X])],Nr),n(48249);var Dr=n(2002),Pr=n(84916),Fr=function(){function e(e){var t=this;e.register(Ie.j.IsOnline,this.isOnline()),Pr.u.getInstance().changeEnd((function(){e.update(Ie.j.IsOnline,t.isOnline())}))}return e.prototype.use=function(e,t){return!(this.isOnline()||!t.respectOffline||(e(),0))},e.prototype.isOnline=function(){return Pr.u.getInstance().isOnline},e}();function Br(e){return"disabled"===e.adapterMismatchBehavior?"shouldDisabled":"shouldHide"}(0,r.__decorate)([(0,r.__param)(0,(0,G.o)()),(0,r.__param)(1,z()),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Function,Object]),(0,r.__metadata)("design:returntype",void 0)],Fr.prototype,"use",null),Fr=(0,r.__decorate)([(0,Y.d)({overridable:!0}),(0,r.__metadata)("design:paramtypes",[de.O])],Fr);var Ur=function(){function e(){}return e.prototype.initServices=function(e){x.Am.alias(Dr.v.MENU,xr.h),x.Am.alias(Dr.v.TOOLBAR,Sr.O),x.Am.alias(Dr.v.CONTEXT_MENU,Yn.L),x.Am.alias(Dr.v.STATUSBAR,Ir.t),x.Am.alias(Dr.v.TITLEBAR,er.M),x.Am.alias(Dr.v.KEYMAP,kr.$),this.initServiceCollection(),this.initSchema(e)},e.prototype.updateServices=function(){this.collection.getControllerRelatedUIServices().forEach((function(e){e.updateState()}))},e.prototype.initMiddlewares=function(e,t){e.use(Nr,{on:xr.h,callbackNames:[Br(t.menu)]}),e.use(Nr,{on:Yn.L,callbackNames:[Br(t.contextMenu)]}),e.use(Nr,{on:Sr.O,callbackNames:[Br(t.toolbar)]}),e.use(Nr,{on:Ir.t,callbackNames:[Br(t.statusbar)]}),Ue.s||(e.use(Fr,{on:Yn.L,callbackNames:["shouldDisabled"]}),e.use(Fr,{on:xr.h,callbackNames:["shouldDisabled"]}),e.use(Fr,{on:Sr.O,callbackNames:["shouldDisabled"]}),e.use(Fr,{on:Ir.t,callbackNames:["shouldDisabled"]}))},e.prototype.getComponent=function(){var e=new we.x9;return x.Am.factory(we.x9,e),ve().createElement(we.FN.Provider,{value:e},ve().createElement(Tr,null))},e.prototype.attach=function(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t=this;return(0,r.__generator)(this,(function(n){return[2,new Promise((function(n){t.collection.services.forEach((function(e){e.$forceUpdate()})),Ue.s?n():ye().hydrate(t.getComponent(),e,(function(){n()}))}))]}))}))},e.prototype.initServiceCollection=function(){var e=[xr.h,Yn.L,Sr.O,Ir.t,er.M,kr.$];this.collection=x.Am.invoke(Rr.y,void 0,e),x.Am.factory(Rr.y,this.collection)},e.prototype.initSchema=function(e){this.collection.has(xr.h)&&e.menu.schema&&x.Am.get(xr.h).setSchema(e.menu.schema),this.collection.has(Yn.L)&&e.contextMenu.schema&&x.Am.get(Yn.L).setSchema(e.contextMenu.schema),this.collection.has(Sr.O)&&e.toolbar.schema&&x.Am.get(Sr.O).setSchema(e.toolbar.schema),this.collection.has(Ir.t)&&e.statusbar.schema&&x.Am.get(Ir.t).setSchema(e.statusbar.schema),this.collection.has(er.M)&&e.titlebar.schema&&x.Am.get(er.M).setSchema(e.titlebar.schema)},e}();Ur=(0,r.__decorate)([(0,_e.t)()],Ur);var Hr=function(){function e(){}return e.load=function(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,o;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return n=x.Am.invoke(re.I,new Map([["container",t],["platform","pc"]])),x.Am.factory(re.I,n),x.Am.factory(oe,new Ur),o=x.Am.invoke(e),Ue.s?[4,o.start()]:[3,2];case 1:return r.sent(),[3,3];case 2:o.start(),r.label=3;case 3:return[2,o]}}))}))},e}(),jr=n(6599),Wr=n(25251),Vr=n(48687),zr=n(82751),Gr=n(17270),Yr=n(17570),qr=n(94202),Zr=n(47433),Jr=n(98859),Kr=n(7340),Qr=n(818),Xr=[Kr.jz.CONTEXT_TOOLBAR,"spell-item0","spell-item1","spell-item2","spell-item3","spell-item4","divider","spell-replace-one","spell-replace-all","divider","cut","copy","paste","paste-text","paste-merge","paragraph-format","delete","image-cropper","image-reset","image-download","image-ocr",{key:"image-wrap-style",items:["image-convert-inline","image-convert-square","image-convert-ownline","image-convert-behind","image-convert-infront","divider","image-not-fixed","image-fixed"]},{key:"textframe-wrap-style",items:["textframe-convert-inline","textframe-convert-square","textframe-convert-top-and-bottom","textframe-convert-behind","textframe-convert-infront","divider","textframe-not-fixed","textframe-fixed"]},{key:"splitline-color",items:["splitline-color-component"]},{key:"splitline-style",items:["splitline-style-".concat(d.STBorder.none),"splitline-style-".concat(d.STBorder.thick),"splitline-style-".concat(d.STBorder.dotted),"splitline-style-".concat(d.STBorder.dashSmallGap),"splitline-style-".concat(d.STBorder.dashed),"splitline-style-".concat(d.STBorder.dotDash),"splitline-style-".concat(d.STBorder.dotDotDash),"splitline-style-".concat(d.STBorder.double),"splitline-style-".concat(d.STBorder.triple),"splitline-style-".concat(d.STBorder.thinThickSmallGap),"splitline-style-".concat(d.STBorder.thickThinSmallGap),"splitline-style-".concat(d.STBorder.thinThickThinSmallGap),"splitline-style-".concat(d.STBorder.wave),"splitline-style-".concat(d.STBorder.doubleWave),"splitline-style-".concat(d.STBorder.threeDEmboss),"splitline-style-".concat(d.STBorder.threeDEngrave)]},{key:"addon-list",items:[]},"divider",{key:"insertRowCol",items:["insertRowAbove","insertRowBelow","insertColLeft","insertColRight"]},{key:"removeRowCol",items:["removeRow","removeCol","deleteTable"]},"divider","mergeCells","splitCells",{key:"averageCells",items:["averageRowHeight","averageColWidth"]},{key:"tableHorizonAlign",items:["tableHorizonLeftAlign","tableHorizonCenterAlign","tableHorizonRightAlign"]},{key:"table-wrap-text",items:["table-convert-inline","table-convert-square","divider","table-not-fixed","table-fixed"]},"divider","comment","insert-comment-ent","divider","insert_link","divider",Qr.ym.EditUrl,Qr.ym.OpenOriginUrl,"divider","clear-format","restartNumbering","continueNumbering","divider","insert-hint-placeholder","trans-to-hint","delete-hint","wxwork-quote"],$r=(Kr.yW.PREVIEW_FILE,Kr.yW.DOWNLOAD_FILE,Kr.yW.SWITCH_MODE,Kr.yW.DELETE_FILE,Qr.ym.OpenOriginUrl,Qr.ym.CopyUrl,Qr.ym.EditUrl,Qr.ym.Cancel,Qr.ym.SwitchMode,n(49511)),eo=n(48295),to=function(){return p.PlatformUtil.isWeWork(),!0},no=function(){return!!window.PRIVATE},ro=(0,r.__spreadArray)((0,r.__spreadArray)(["insert-image",{key:"insert-table",items:[Kr.Fv.PARAGRAPH_TABLE_PANEL]},"insert-link",{key:"insert-snippet",items:["snippet-task-list","snippet-work-daily","snippet-work-report","snippet-conference-record"]},"insert-codeblock","addon-countdown",Kr.Fv.PARAGRAPH_LATEX,Kr.Fv.PARAGRAPH_SIGNATURE,"divider",{key:"insert-splitline",items:["splitline-style-".concat(d.STBorder.none),"splitline-style-".concat(d.STBorder.thick),"splitline-style-".concat(d.STBorder.dotted),"splitline-style-".concat(d.STBorder.dashSmallGap),"splitline-style-".concat(d.STBorder.dashed),"splitline-style-".concat(d.STBorder.dotDash),"splitline-style-".concat(d.STBorder.dotDotDash),"splitline-style-".concat(d.STBorder.double),"splitline-style-".concat(d.STBorder.triple),"splitline-style-".concat(d.STBorder.thinThickSmallGap),"splitline-style-".concat(d.STBorder.thickThinSmallGap),"splitline-style-".concat(d.STBorder.thinThickThinSmallGap),"splitline-style-".concat(d.STBorder.wave),"splitline-style-".concat(d.STBorder.doubleWave),"splitline-style-".concat(d.STBorder.threeDEmboss),"splitline-style-".concat(d.STBorder.threeDEngrave),{key:"insert-splitline-color",items:["insert-splitline-color-component"]},{key:"insert-splitline-size",items:["linesize-quarter_width","linesize-half_width","linesize-half_and_quarter_width","linesize-one_width","linesize-one_and_half_width","linesize-two_and_quarter_width","linesize-three_width","linesize-four_and_half_width","linesize-six_width"]}]},"divider"],(0,r.__read)(no()?[]:["add-member-contact-card","add-group-contact-card"]),!1),["divider","insert-doc-link",Kr.Fv.INSERT_ATTACHMENT,"addon-insert_addons"],!1),oo=[{key:eo.z_.FILE,items:["file-info-panel-pc","divider","copy-link","divider","local-file-save-as","local-file-save","local-file-show-item-in-folder","local-file-view-origin-file",{key:"export-as",items:["export-as-docx","export-as-pdf","snap-screen","shortcut"]},"clone","save-as-template","publish","divider","edit-history","view-history",{key:"permission-submenu",items:["permission-simple","permission-pro","divider","change-owner"]},"divider","title-color","toggle-like","divider","print","divider","accessibility","switch_certification",{key:"help-center",items:["faq","feedback","report",{key:"privacy",items:["privacy-policy","third-information-checklist","third-authorization-management","personal-information-checklist"]},"infringement-guide","appeal","about","community-convention","doc-version"]},"report-publish","copy-sharelink","collect-pc",{key:"subscription-notification",items:["subscribe-all","subscribe-myself"]}]},{key:eo.z_.TOOLBAR_MODE,items:["single-line-toolbar","double-line-toolbar","divider","immersive-toolbar"]},{key:"page-settings-menu",items:["page-settings",{key:"page-background",items:["watermark","shading"]},"view-background","view-toc","view-comment"]},{key:"delete-header-footer",items:["delete-header","delete-footer","delete-page-num"]},{key:"header-setting",items:["toggle_title_page","toggle_even_and_odd_headers","toggle_header_separator"]},{key:"footer-setting",items:["toggle_title_page","toggle_even_and_odd_headers"]},{key:"insert",items:["insert-image",{key:"insert-table",items:["table-panel"]},"insert-link",{key:"insert-snippet",items:["snippet-task-list","snippet-work-daily","snippet-work-report","snippet-conference-record"]},"insert-codeblock","addon-countdown","addon-latex","doc-addon-mind_map","doc-addon-flow_chart","insert-comment","signature","divider",{key:"insert-splitline",items:["splitline-style-".concat(d.STBorder.none),"splitline-style-".concat(d.STBorder.thick),"splitline-style-".concat(d.STBorder.dotted),"splitline-style-".concat(d.STBorder.dashSmallGap),"splitline-style-".concat(d.STBorder.dashed),"splitline-style-".concat(d.STBorder.dotDash),"splitline-style-".concat(d.STBorder.dotDotDash),"splitline-style-".concat(d.STBorder.double),"splitline-style-".concat(d.STBorder.triple),"splitline-style-".concat(d.STBorder.thinThickSmallGap),"splitline-style-".concat(d.STBorder.thickThinSmallGap),"splitline-style-".concat(d.STBorder.thinThickThinSmallGap),"splitline-style-".concat(d.STBorder.wave),"splitline-style-".concat(d.STBorder.doubleWave),"splitline-style-".concat(d.STBorder.threeDEmboss),"splitline-style-".concat(d.STBorder.threeDEngrave),"divider",{key:"insert-splitline-color",items:["insert-splitline-color-component"]},{key:"insert-splitline-size",items:["linesize-quarter_width","linesize-half_width","linesize-half_and_quarter_width","linesize-one_width","linesize-one_and_half_width","linesize-two_and_quarter_width","linesize-three_width","linesize-four_and_half_width","linesize-six_width"]}]},{key:"insert-page-info",items:["insert-page-header","insert-page-footer",{key:"insert-page-number",items:["insert-page-number-at-cursor","insert-page-number-at-header","insert-page-number-at-footer"]}]},{key:"insert-breaks",items:["insert-page-break","divider","insert-next-page-section-break","insert-continuous-section-break","insert-even-page-section-break","insert-odd-page-section-break"]},"divider","addon-tencent_meeting_test","addon-tencent_meeting_release","insert-doc-link",Kr.Fv.INSERT_ATTACHMENT,"addon-insert_addons",$r.U5.Insert]},{key:eo.z_.EDIT,items:[{key:"format-common",items:[{key:"heading",items:["normal","divider","title","subtitle","divider","heading1","heading2","heading3","heading4","heading5","heading6","heading7","heading8","heading9"]},{key:"font-emphasis",items:["bold","italic","underline","strike-through","sup","sub",{key:"font-scaling",items:["font-scaling-component"]},{key:"letter-spacing",items:["letter-spacing-component"]},{key:"font-color",items:["font-color-component"]},{key:"font-background",items:["font-background-component"]}]},{key:"paragraph",items:[{key:"align",items:["align-left","align-center","align-right","align-justify","align-distribute"]},{key:"line-height",items:["line-height-1","line-height-1.15","line-height-1.3","line-height-1.5","line-height-2","line-height-3","divider","more-line-height-setting"]},{key:"indent",items:["increase-indent","decrease-indent"]},"more-paragraph-settings"]},"divider","clear-format"]},{key:"format-table",items:[{key:"table-border",items:["table-border-component","divider",{key:"table-border-color",items:["table-border-color-component"]}]},{key:"table-fill-color",items:["table-fill-color-component"]},"merge-cell",{key:"table-horizental-align",items:["table-horizental-align-left","table-horizental-align-center","table-horizental-align-right","table-horizental-align-justify","table-horizental-align-distribute"]},{key:"table-vertical-align",items:["table-vertical-align-top","table-vertical-align-center","table-vertical-align-bottom"]}]},{key:"format-splitline",items:["format-splitline-".concat(d.STBorder.none),"format-splitline-".concat(d.STBorder.thick),"format-splitline-".concat(d.STBorder.dotted),"format-splitline-".concat(d.STBorder.dashSmallGap),"format-splitline-".concat(d.STBorder.dashed),"format-splitline-".concat(d.STBorder.dotDash),"format-splitline-".concat(d.STBorder.dotDotDash),"format-splitline-".concat(d.STBorder.double),"format-splitline-".concat(d.STBorder.triple),"format-splitline-".concat(d.STBorder.thinThickSmallGap),"format-splitline-".concat(d.STBorder.thickThinSmallGap),"format-splitline-".concat(d.STBorder.thinThickThinSmallGap),"format-splitline-".concat(d.STBorder.wave),"format-splitline-".concat(d.STBorder.doubleWave),"format-splitline-".concat(d.STBorder.threeDEmboss),"format-splitline-".concat(d.STBorder.threeDEngrave),"divider",{key:"format-splitline-color",items:["format-splitline-color-component"]}]},{key:"page-header-footer",items:["insert-page-header","insert-page-footer",{key:"insert-page-number",items:["insert-page-number-at-cursor","insert-page-number-at-header","insert-page-number-at-footer"]}]},"divider","view-background","view-toc","view-comment","view-page","view-fullscreen","divider","page-settings",{key:"page-background",items:["watermark","shading"]},"divider","find-replace"]},{key:"unofficial-addons",items:["unofficial-addons-panel-title","system-addons-panel-title","spellcheck","translate","markdown","resume-assistant"]},{key:Kr.Ak.PARAGRAPH_SHORTCUT_MENU,items:[Kr.Fv.PARAGRAPH_STYLE_GREY,Kr.Fv.PARAGRAPH_MENU_TOOLBAR,"divider",{key:Kr.Fv.PARAGRAPH_INERT,items:(0,r.__spreadArray)([],(0,r.__read)(ro),!1)},Kr.Fv.PARAGRAPH_COPY,Kr.Fv.PARAGRAPH_CUT,Kr.Fv.PARAGRAPH_DELETE]},{key:Kr.Ak.PARAGRAPH_SHORTCUT_MENU_NULL,items:(0,r.__spreadArray)([Kr.Fv.PARAGRAPH_STYLE_GREY,Kr.Fv.PARAGRAPH_MENU_TOOLBAR,"divider",Kr.Fv.PARAGRAPH_INERT_GREY],(0,r.__read)(ro),!1)},{key:Kr.Ak.WORD_COUNT_MENU,items:[Kr.Fv.COUNT_INFO,Kr.Fv.COUNT,Kr.Fv.COUNT_NO_PUNCTUATION,Kr.Fv.COUNT_CHARACTERS,Kr.Fv.COUNT_CHARACTERS_NO_SPACES,Kr.Fv.COUNT_LOADING]},{key:Kr.Ak.TABLE_SHORTCUT_MENU,items:[{key:Kr.Fv.TABLE_ADJUST,items:[Kr.Fv.TABLE_ADJUST_AUTO,Kr.Fv.TABLE_ADJUST_ROW,Kr.Fv.TABLE_ADJUST_COL]},{key:Kr.Fv.TABLE_HORIZON_ALIGN,items:[Kr.Fv.TABLE_HORIZON_ALIGN_LEFT,Kr.Fv.TABLE_HORIZON_ALIGN_CENTER,Kr.Fv.TABLE_HORIZON_ALIGN_RIGHT]},{key:Kr.Fv.TABLE_STYLE_THEME,items:[Kr.Fv.TABLE_STYLE_THEME_PREVIEW]},"divider",{key:Kr.Fv.TABLE_INSERT,items:(0,r.__spreadArray)([],(0,r.__read)(ro),!1)},Kr.Fv.TABLE_COPY,Kr.Fv.TABLE_CUT,Kr.Fv.TABLE_DELETE]},{key:Qr.ym.SwitchMode,items:[d.FieldDisplayLayoutType.Text,d.FieldDisplayLayoutType.Inline,d.FieldDisplayLayoutType.Card,d.FieldDisplayLayoutType.Preview]},{key:Kr.Fv.PDF_TRANSFORM,items:[Kr.Fv.PDF_TRANSFORM_DOC_TO_PDF,"divider",Kr.Fv.PDF_TRANSFORM_PDF_TO_WORD,Kr.Fv.PDF_TRANSFORM_PDF_TO_EXCEL,Kr.Fv.PDF_TRANSFORM_PDF_TO_PPT]}],io=new Set,ao={key:"insert-splitline",items:["splitline-clear","splitline-style-".concat(d.STBorder.thick),"splitline-style-".concat(d.STBorder.dotted),"splitline-style-".concat(d.STBorder.dashSmallGap),"splitline-style-".concat(d.STBorder.dashed),"splitline-style-".concat(d.STBorder.dotDash),"splitline-style-".concat(d.STBorder.dotDotDash),"splitline-style-".concat(d.STBorder.double),"splitline-style-".concat(d.STBorder.triple),"splitline-style-".concat(d.STBorder.thinThickSmallGap),"splitline-style-".concat(d.STBorder.thickThinSmallGap),"splitline-style-".concat(d.STBorder.thinThickThinSmallGap),"splitline-style-".concat(d.STBorder.wave),"splitline-style-".concat(d.STBorder.doubleWave),"splitline-style-".concat(d.STBorder.threeDEmboss),"splitline-style-".concat(d.STBorder.threeDEngrave),{key:"insert-splitline-color",items:["insert-splitline-color-component"]},{key:"insert-splitline-size",items:["linesize-quarter_width","linesize-half_width","linesize-half_and_quarter_width","linesize-one_width","linesize-one_and_half_width","linesize-two_and_quarter_width","linesize-three_width","linesize-four_and_half_width","linesize-six_width"]}]},so=(0,r.__spreadArray)((0,r.__spreadArray)(["insert-image",{key:"insert-table",items:["table-panel"]},"insert-link","insert-sheet-iframe",{key:"insert-snippet",items:no()?["snippet-work-daily","snippet-work-report","snippet-conference-record"]:["snippet-task-list","snippet-work-daily","snippet-work-report","snippet-conference-record"]},"insert-codeblock","addon-latex","doc-addon-mind_map","doc-addon-flow_chart","signature","divider","insert-comment-ent","divider",ao,{key:"insert-page-info",items:["insert-page-header","insert-page-footer",{key:"insert-page-number",items:["insert-page-number-at-cursor","insert-page-number-at-header","insert-page-number-at-footer"]}]},"insert-page-break","divider"],(0,r.__read)(no()?[]:["add-member-contact-card","add-group-contact-card"]),!1),["add-cold-start-button","divider","insert-doc-link-ent",{key:"insert-file",items:no()?["insert-file-wedrive"]:["insert-file-wedrive","insert-file-local"]},"insert-app",!no()&&{key:"wxwork-calender",items:["create-wxwork-calender","insert-wxwork-calender"]},!no()&&{key:"wxwork-meeting",items:["create-wxwork-meeting","insert-wxwork-meeting"]},!no()&&"task-list","insert-date-reminder","addon-insert_addons"],!1),co=((0,r.__spreadArray)([{key:"file",items:["file-info-panel-ent-pc","divider","add-cooperator","share-pc",!no()&&"share-to-wechat","copy-sharelink","permission-pro","divider","publish","divider","collect-pc","add-fast-access","add-wedrive-shortcut","move-to-wedrive",{key:"watch-in-wedrive",items:["open-in-wedrive"]},"divider","edit-history","view-history",{key:"help-edit-function",items:[{key:"format-common",items:[{key:"heading",items:["normal","divider","title","subtitle","divider","heading1","heading2","heading3","heading4","heading5","heading6","heading7","heading8","heading9"]},{key:"font-emphasis",items:["bold","italic","underline","strike","sup","sub",{key:"letter-spacing",items:["letter-spacing-component"]},{key:"font-color",items:["font-color-component"]},{key:"font-background",items:["font-background-component"]}]},{key:"paragraph",items:[{key:"align",items:["align-left","align-center","align-right","align-justify","align-distribute"]},{key:"line-height",items:["line-height-1","line-height-1.15","line-height-1.3","line-height-1.5","line-height-2","line-height-3","divider","more-line-height-setting"]},{key:"indent",items:["increase-indent","decrease-indent"]},"more-paragraph-settings"]},"divider","clear-format"]},{key:"format-table",items:[{key:"table-border",items:["table-border-component","divider",{key:"table-border-color",items:["table-border-color-component"]}]},{key:"table-fill-color",items:["table-fill-color-component"]},"merge-cell",{key:"table-horizental-align",items:["table-horizental-align-left","table-horizental-align-center","table-horizental-align-right","table-horizental-align-justify","table-horizental-align-distribute"]},{key:"table-vertical-align",items:["table-vertical-align-top","table-vertical-align-center","table-vertical-align-bottom"]}]},ao,{key:"page-header-footer",items:["insert-page-header","insert-page-footer",{key:"insert-page-number",items:["insert-page-number-at-cursor","insert-page-number-at-header","insert-page-number-at-footer"]}]},"divider","view-toc","view-comment","view-page","view-fullscreen","divider","page-settings",{key:"page-background",items:["watermark","shading"]},"divider","find-replace"]},"divider","save-as-template","clone",{key:"export-as",items:no()?["export-as-docx","snap-screen","shortcut"]:["export-as-docx","export-as-pdf","snap-screen","shortcut"]},"add-to-mail","print","divider",{key:"show-more",items:["open-in-browser","accessibility",{key:"tob-help-and-feedback",items:no()?["tob-help-quickly-key"]:["tob-help-feedback","tob-help-quickly-key","divider","tob_recent_input_text","divider","complaint","wxwork-help-and-feedback-log-report"]}]},"divider",{key:"sync-to-tencent-document-list",items:["synchronize-tencent-file-list","asynchronize-tencent-single-file","asynchronize-tencent-all-file"]},"divider","collab-exit","delete-doc"]},{key:"insert",items:(0,r.__spreadArray)((0,r.__spreadArray)(["insert-image",{key:"insert-table",items:["table-panel"]},"insert-link","insert-sheet-iframe",{key:"insert-snippet",items:no()?["snippet-work-daily","snippet-work-report","snippet-conference-record"]:["snippet-task-list","snippet-work-daily","snippet-work-report","snippet-conference-record"]},"insert-codeblock","addon-latex","doc-addon-mind_map","doc-addon-flow_chart","signature","divider","insert-comment-ent","divider",ao,{key:"insert-page-info",items:["insert-page-header","insert-page-footer",{key:"insert-page-number",items:["insert-page-number-at-cursor","insert-page-number-at-header","insert-page-number-at-footer"]}]},{key:"insert-breaks",items:["insert-page-break","divider","insert-next-page-section-break","insert-continuous-section-break","insert-even-page-section-break","insert-odd-page-section-break"]},"divider"],(0,r.__read)(no()?[]:["add-member-contact-card","add-group-contact-card"]),!1),["divider","insert-doc-link-ent",{key:"insert-file",items:no()?["insert-file-wedrive"]:["insert-file-wedrive","insert-file-local"]},"insert-app",!no()&&{key:"wxwork-calender",items:["create-wxwork-calender","insert-wxwork-calender"]},!no()&&"task-list","insert-date-reminder","addon-insert_addons"],!1),items:so},{key:"more",items:[{key:"format-common",items:[{key:"heading",items:["normal","divider","title","subtitle","divider","heading1","heading2","heading3","heading4","heading5","heading6","heading7","heading8","heading9"]},{key:"font-emphasis",items:["bold","italic","underline","strike","sup","sub",{key:"letter-spacing",items:["letter-spacing-component"]},{key:"font-color",items:["font-color-component"]},{key:"font-background",items:["font-background-component"]}]},{key:"paragraph",items:[{key:"align",items:["align-left","align-center","align-right","align-justify","align-distribute"]},{key:"line-height",items:["line-height-1","line-height-1.15","line-height-1.3","line-height-1.5","line-height-2","line-height-3","divider","more-line-height-setting"]},{key:"indent",items:["increase-indent","decrease-indent"]},"more-paragraph-settings"]},"divider","clear-format"]},{key:"format-table",items:[{key:"table-border",items:["table-border-component","divider",{key:"table-border-color",items:["table-border-color-component"]}]},{key:"table-fill-color",items:["table-fill-color-component"]},"merge-cell",{key:"table-horizental-align",items:["table-horizental-align-left","table-horizental-align-center","table-horizental-align-right","table-horizental-align-justify","table-horizental-align-distribute"]},{key:"table-vertical-align",items:["table-vertical-align-top","table-vertical-align-center","table-vertical-align-bottom"]}]},ao,{key:"page-header-footer",items:["insert-page-header","insert-page-footer",{key:"insert-page-number",items:["insert-page-number-at-cursor","insert-page-number-at-header","insert-page-number-at-footer"]}]},"divider","view-toc","view-comment","view-page","view-fullscreen","divider","page-settings",{key:"page-background",items:["watermark","shading"]},"divider","find-replace"]},{key:"unofficial-addons",items:["unofficial-addons-panel-title","spellcheck","translate","markdown"]},{key:Kr.Ak.PARAGRAPH_SHORTCUT_MENU,items:[Kr.Fv.PARAGRAPH_MENU_TOOLBAR,"divider",Kr.Fv.WXWORK_QUOTE,Kr.Fv.PARAGRAPH_COPY,Kr.Fv.PARAGRAPH_CUT,Kr.Fv.PARAGRAPH_DELETE,"divider",{key:Kr.Fv.PARAGRAPH_INERT,items:(0,r.__spreadArray)([],(0,r.__read)(so),!1)}]},{key:Kr.Ak.PARAGRAPH_SHORTCUT_MENU_NULL,items:(0,r.__spreadArray)([Kr.Fv.PARAGRAPH_MENU_TOOLBAR,"divider"],(0,r.__read)(so),!1)}],(0,r.__read)(oo),!1).filter((function(e){var t="string"==typeof e?e:e.key;return!io.has(t)&&(io.add(t),!0)})),{left:["toc","page_web","page-icon","page-status","word-count"],right:["play","tencent-meeting-play","divider","full-screen","zoom"]}),lo=n(915),uo=(no()?(lo.ZP.t("插入"),lo.ZP.t("内容块")):(lo.ZP.t("插入"),Kr.tV.INSERT_ATTACHMENT,lo.ZP.t("内容块"),lo.ZP.t("addon:addons")),lo.ZP.t("ui:toolbar.style"),lo.ZP.t("段落"),lo.ZP.t("行间距"),to(),to(),n(22595));uo.C.SwitchCertificationMobile,no()||(0,r.__spreadArray)((0,r.__spreadArray)([{key:"help-and-feedback",items:["help-and-feedback-sub","text-history","help-and-feedback-sub-about","help-and-feedback-sub-subscribe","help-and-feedback-sub-help","help-and-feedback-sub-tucao","help-and-feedback-sub-report","help-and-feedback-sub-appeal","help-and-feedback-sub-about-template","help-and-feedback-sub-version"]}],(0,r.__read)(["help-and-feedback-tob-tencentapp"]),!1),["complaint"],!1);var po,fo,_o=n(17657),ho=((po={"toolbar-normal":{data:[[Wr.o4.UNDO,Wr.o4.REDO,Wr.o4.FORMAT_PAINT,Wr.o4.CLEAR_FORMAT],[Wr.o4.INSERT],{shrinkType:gr.fh.PARTIAL_DIVIDER,shelter:Wr.o4.SINGLE_FONT_SHELTER,priority:[1,2,3,4],shrinkSteps:[[Wr.o4.LETTER_SPACING],[Wr.o4.SUP],[Wr.o4.SUB],[Wr.o4.STRIKE]],shouldMerge:!0,items:[Wr.o4.HEADING,Wr.o4.FONT,Wr.o4.FONT_SIZE,Wr.o4.FONT_SIZE_INCREASE,Wr.o4.FONT_SIZE_DECREASE,Wr.o4.BOLD,Wr.o4.ITALIC,Wr.o4.UNDERLINE,Wr.o4.STRIKE,Wr.o4.SUB,Wr.o4.SUP,Wr.o4.LETTER_SPACING,Wr.o4.FONT_BACKGROUND_COLOR,Wr.o4.FONT_COLOR]},[Wr.o4.BULLET_LIST,Wr.o4.NUMBERED_LIST,Wr.o4.TASK_LIST,Wr.o4.DESC_INDENT,Wr.o4.INC_INDENT,Wr.o4.ALIGNMENT,Wr.o4.LINE_HEIGHT],[Wr.o4.IMAGE_CROPPER,Wr.o4.ROTATE_IMAGE,Wr.o4.IMAGE_RESET],[Wr.o4.CELL_COLOR,Wr.o4.CELL_BORDER,Wr.o4.ALIGN_VERTICAL,Wr.o4.CELL_MERGE],[Wr.o4.MENU_QUOTE,Wr.o4.PARAGRAPH_LIGHTBLOCK],[Wr.o4.PAGE_SETTINGS],[Kr.aE.PDF_TRANSFORM,Kr.aE.GENERATE_IMAGE],[Wr.o4.UNOFFICIAL_ADDONS],[Wr.o4.INSERT_MENTION_ENT]],moreText:lo.ZP.t("ui:more-text"),moreTooltip:lo.ZP.t("ui:more-tooltip")},"toolbar-pinned":{data:[[Wr.o4.FIND_REPLACE,Wr.o4.TOGGLE]]},"toolbar-paragraph-menu":{data:[[Kr.aE.PARAGRAPH_TEXT,Kr.aE.PARAGRAPH_HEADING1,Kr.aE.PARAGRAPH_HEADING2,Kr.aE.PARAGRAPH_HEADING3,Kr.aE.PARAGRAPH_HEADING4],[Kr.aE.PARAGRAPH_HEADING5,Kr.aE.PARAGRAPH_HEADING6,Kr.aE.PARAGRAPH_BULLET_LIST,Kr.aE.PARAGRAPH_NUMBERED_LIST,Kr.aE.PARAGRAPH_TASK_LIST],[Kr.aE.PARAGRAPH_ALIGN_LEFT,Kr.aE.PARAGRAPH_ALIGN_CENTER,Kr.aE.PARAGRAPH_ALIGN_RIGHT,Kr.aE.PARAGRAPH_ALIGN_JUSTIFY,Kr.aE.PARAGRAPH_ALIGN_DISTRIBUTE,Kr.aE.PARAGRAPH_QUOTE],[Kr.aE.PARAGRAPH_LIGHTBLOCK]]},"toolbar-selection":{data:[["cell-merge","cell-color"],[Kr.aE.BLOCK_INCREASE_FONT_SIZE,Kr.aE.BLOCK_DECREASE_FONT_SIZE],["bold","italic","underline","strike-through","font-color","font-background-color"]]},"header-footer-float-toolbar":{data:[[Kr.aE.INSERT_PAGE_NUM,Kr.aE.PAGE_NUM_SETTING],[Kr.aE.HEADER_SETTING,Kr.aE.FOOTER_SETTING],[Kr.aE.LINK_TO_PREV_SECTION],[Kr.aE.DELETE_HEADER_FOOTER]]}})[_o.Dm]={data:[[Qr.ym.OpenOriginUrl],[Qr.ym.CopyUrl,Qr.ym.EditUrl],[Qr.ym.SwitchMode],[Qr.ym.Cancel]]},po),mo=((fo={"toolbar-normal":{data:[{items:[[[Wr.o4.UNDO,Wr.o4.REDO],[Wr.o4.FORMAT_PAINT,Wr.o4.CLEAR_FORMAT]]]},[Wr.o4.INSERT],{priority:[4],shrinkType:gr.fh.OVERALL_DIVIDER,shelter:Wr.o4.FONT_SHELTER,items:[[[Wr.o4.HEADING,Wr.o4.FONT,Wr.o4.FONT_SIZE,Wr.o4.FONT_SIZE_INCREASE,Wr.o4.FONT_SIZE_DECREASE],[Wr.o4.BOLD,Wr.o4.ITALIC,Wr.o4.UNDERLINE,Wr.o4.STRIKE,Wr.o4.SUB,Wr.o4.SUP,Wr.o4.LETTER_SPACING,Wr.o4.FONT_BACKGROUND_COLOR,Wr.o4.FONT_COLOR]]]},{priority:[3],shrinkType:gr.fh.OVERALL_DIVIDER,shelter:Wr.o4.PARAGRAPH_SHELTER,items:[[[Wr.o4.BULLET_LIST,Wr.o4.NUMBERED_LIST,Wr.o4.TASK_LIST,Wr.o4.DESC_INDENT,Wr.o4.INC_INDENT,Wr.o4.LINE_HEIGHT],[Wr.o4.ALIGNMENT_LEFT,Wr.o4.ALIGNMENT_CENTER,Wr.o4.ALIGNMENT_RIGHT,Wr.o4.ALIGNMENT_JUSTIFY,Wr.o4.ALIGNMENT_DISTRIBUTE,Wr.o4.MENU_QUOTE,Wr.o4.PARAGRAPH_LIGHTBLOCK]]]},{priority:[2],shrinkType:gr.fh.OVERALL_DIVIDER,shelter:Wr.o4.IMAGE_SHELTER,items:[[[Wr.o4.IMAGE_CROPPER],[Wr.o4.ROTATE_IMAGE]],Wr.o4.IMAGE_RESET]},{priority:[1],shrinkType:gr.fh.OVERALL_DIVIDER,shelter:Wr.o4.TABLE_SHELTER,items:[[[Wr.o4.CELL_BORDER],[Wr.o4.CELL_COLOR]],Wr.o4.ALIGN_VERTICAL,Wr.o4.CELL_MERGE]},[Wr.o4.PAGE_SETTINGS],{priority:[1],shrinkType:gr.fh.OVERALL_DIVIDER,shelter:Kr.aE.FORMAT_CONVERSION_SHELTER,items:[[[Kr.aE.PDF_TRANSFORM,Kr.aE.GENERATE_IMAGE]]]},[Wr.o4.UNOFFICIAL_ADDONS],[Wr.o4.INSERT_MENTION_ENT]],moreText:lo.ZP.t("ui:more-text"),moreTooltip:lo.ZP.t("ui:more-tooltip")},"toolbar-pinned":{data:[[Wr.o4.FIND_REPLACE,Wr.o4.TOGGLE]]},"toolbar-paragraph-menu":{data:[[Kr.aE.PARAGRAPH_TEXT,Kr.aE.PARAGRAPH_HEADING1,Kr.aE.PARAGRAPH_HEADING2,Kr.aE.PARAGRAPH_HEADING3,Kr.aE.PARAGRAPH_HEADING4],[Kr.aE.PARAGRAPH_HEADING5,Kr.aE.PARAGRAPH_HEADING6,Kr.aE.PARAGRAPH_BULLET_LIST,Kr.aE.PARAGRAPH_NUMBERED_LIST,Kr.aE.PARAGRAPH_TASK_LIST],[Kr.aE.PARAGRAPH_ALIGN_LEFT,Kr.aE.PARAGRAPH_ALIGN_CENTER,Kr.aE.PARAGRAPH_ALIGN_RIGHT,Kr.aE.PARAGRAPH_ALIGN_JUSTIFY,Kr.aE.PARAGRAPH_ALIGN_DISTRIBUTE,Kr.aE.PARAGRAPH_QUOTE],[Kr.aE.PARAGRAPH_LIGHTBLOCK]]},"toolbar-selection":{data:[["cell-merge","cell-color"],[Kr.aE.BLOCK_INCREASE_FONT_SIZE,Kr.aE.BLOCK_DECREASE_FONT_SIZE],["bold","italic","underline","strike-through","font-background-color","font-color"]]},"header-footer-float-toolbar":{data:[[Kr.aE.INSERT_PAGE_NUM,Kr.aE.PAGE_NUM_SETTING],[Kr.aE.HEADER_SETTING,Kr.aE.FOOTER_SETTING],[Kr.aE.LINK_TO_PREV_SECTION],[Kr.aE.DELETE_HEADER_FOOTER]]}})[_o.Dm]={data:[[Qr.ym.OpenOriginUrl],[Qr.ym.CopyUrl,Qr.ym.EditUrl],[Qr.ym.SwitchMode],[Qr.ym.Cancel]]},fo),go=(window.isPublishedURL,n(23403)),vo=n(93272),bo=n(60952),yo={app:"doc",version:"v_20200902173919_release",common:{titlebar:!1,toolbar:!1,statusbar:!1,menu:{},blankpage:{applyEditPermission:!1,applyViewPermission:!1,back:!1,comment:!1,errImg:!1,footer:!1,login:!1,refresh:!1,switchAccount:!1,watchOfficeAccount:!1}},custom:{widget:{"help-center":!1},contextmenu:!1,feature:{ad_mobile:!1,app_guide:!1,app_guide_pc:!1,audio:!0,bottom_bar:!1,codeblock:!1,collab_caret:!1,collab_status:!1,collab_status_mobile:!1,comment:!1,comment_mobile:!1,comment_pc:!1,contextmenu_mobile:!1,core_edit:!1,doc_preview:!1,doc_view_mobile:!0,docx_database_proxy:!1,docx_deferred_render:!1,docx_docx_render:!1,docx_pages:!1,docx_right_bar:!1,docx_tools:!1,fake_toolbar:!1,field_processor:!0,fieldcode:!0,fieldcode_date:!0,fieldcode_doc_link:!0,fieldcode_doclink_render:!0,fieldcode_mention:!1,fieldcode_mention_render:!0,fieldcode_page:!0,file_base:!0,file_export:!0,file_mobile:!0,file_pc:!0,font:!1,fullscreen:!0,help_center:!0,help_center_mobile:!0,home_mobile:!0,image:!1,image_mobile:!1,image_pc:!1,image_readonly:!0,hyperlink:!0,list:!0,list_readonly:!0,location:!1,login:!0,manual_offline:!0,markdown:!1,mobile_header:!0,mobile_tips:!0,mobile_view:!0,move_to:!0,move_to_mobile:!0,collect_mobile:!0,newpad_input_tips:!0,ocr:!1,ocr_preview:!1,offline_edit:!0,outline:!1,outline_mobile:!0,page:!0,page_shade:!0,paragraph:!1,performance_report:!0,presentation:!1,presentation_player:!0,print:!0,publish:!0,read_record:!1,readonly_mobile_toolbar:!0,readonly_tips:!0,readonly_toolbar:!0,recover_doc:!0,revision_record:!1,scroll_position:!0,search:!0,section:!0,selective_paste:!1,share:!0,share_mobile:!0,snap_screen_mobile:!1,snap_screen_pc:!1,spellcheck:!1,splitline:!1,splitline_readonly:!0,star_mobile:!0,table:!0,tdocs_deferred_render:!0,tdocs_render:!0,template_info:!1,text_flow:!0,title:!0,title_default_add:!0,title_mobile:!0,titlebar:!0,titlebar_mobile:!0,translate:!0,unread_notify:!0,update_notice:!0,user_avatar:!0,vip:!1,voice_input:!0,watermark:!0,word_count:!0,zoom_base:!0,zoom_melo:!0,zoom_mobile:!1,zoom_pc:{wheel:!0}}}},wo={app:"doc",version:"v_20210812182727_release",common:{titlebar:{account:!1,auth:!1,back:!1,collaborators:!1,collect:!1,fileMenu:!1,login:!1,logo:!0,moreMenu:!1,move:!1,new_logo:!1,presentation:!1,readonly:!1,saveState:!1,share:!1,title:!0},titlebar_mobile:{account:!0,auth:!0,collaborators:!0,collect:!0,home:!0,login:!0,logo:!0,moreMenu:!0,share:!0,title:!0},toolbar:!1,statusbar:!1,menu:{"more-type":!0,"new-folder":!1},blankpage:{applyEditPermission:!0,applyViewPermission:!0,back:!0,comment:!0,errImg:!0,feedbackQuestion:!0,footer:!0,login:!0,refresh:!0,switchAccount:!0,watchOfficeAccount:!0}},custom:{widget:{"help-center":!0},contextmenu:{},feature:{ad_mobile:!0,"addon.support_new_sdk":!0,app_guide:!0,app_guide_pc:!0,attachment:!1,audio:!0,codeblock:!0,collab_caret:!0,collab_status:!0,collab_status_mobile:!0,comment:!0,comment_mobile:!0,comment_pc:!0,contextmenu_mobile:!0,core_edit:!0,doc_preview:!0,doc_view_mobile:!0,docx_database_proxy:!0,docx_deferred_render:!0,docx_docx_render:!0,docx_pages:!0,docx_right_bar:!0,docx_tools:!0,fake_toolbar:!0,field_processor:!0,fieldcode:!0,fieldcode_date:!0,fieldcode_doc_link:!0,fieldcode_doclink_render:!0,fieldcode_mention:!0,fieldcode_mention_render:!0,fieldcode_page:!0,file_base:!0,file_export:!0,file_mobile:!0,file_pc:!0,font:!0,fullscreen:!0,help_center:!0,help_center_mobile:!0,home_mobile:!0,image:!0,image_mobile:!0,image_pc:!0,image_readonly:!0,link:!0,list:!0,list_readonly:!0,location:!0,login:!0,manual_offline:!0,markdown:!0,mobile_header:!0,mobile_precise_preview:!1,mobile_tips:!0,mobile_view:!0,move_to:!0,move_to_mobile:!0,newpad_input_tips:!0,ocr:!0,ocr_preview:!0,offline_edit:!0,outline:!0,outline_mobile:!0,page:!0,page_shade:!0,paragraph:!0,performance_report:!0,presentation:!0,presentation_player:!1,print:!0,publish:!0,read_record:!0,readonly_mobile_toolbar:!0,readonly_tips:!0,readonly_toolbar:!0,recover_doc:!0,revision_record:!0,scroll_position:!0,search:!0,section:!0,selective_paste:!0,share:!0,share_mobile:!0,snap_screen_mobile:!0,snap_screen_pc:!0,spellcheck:!0,splitline:!0,splitline_readonly:!0,star_mobile:!0,table:!0,tdocs_deferred_render:!0,tdocs_render:!0,template_info:!0,text_flow:!0,title:!0,title_default_add:!0,title_mobile:!0,titlebar:!0,titlebar_mobile:!0,translate:!0,unread_notify:!0,update_notice:!0,user_avatar:!0,vip:!0,voice_input:!0,watermark:!0,word_count:!0,zoom_base:!0,zoom_melo:!0,zoom_mobile:!0,zoom_pc:{wheel:!0}}}},Eo={app:"doc",version:"v_20210824230003_release",common:{titlebar:!1,titlebar_mobile:{account:!0,auth:!0,collaborators:!0,collect:!0,home:!0,login:!0,logo:!1,moreMenu:!0,share:!0,share_web:!1,title:!0},toolbar:!1,statusbar:!1,menu:{},blankpage:{applyEditPermission:!0,applyViewPermission:!0,back:!0,comment:!0,errImg:!0,feedbackQuestion:!0,footer:!0,login:!0,refresh:!0,switchAccount:!0,watchOfficeAccount:!0}},custom:{widget:{"help-center":!1},contextmenu:!1,feature:{ad_mobile:!0,"addon.support_new_sdk":!0,app_guide:!1,app_guide_pc:!1,attachment:!1,audio:!0,codeblock:!0,collab_caret:!1,collab_status:!0,collab_status_mobile:!0,comment:!0,comment_mobile:!1,comment_pc:!1,contextmenu_mobile:!0,core_edit:!0,doc_preview:!0,doc_view_mobile:!0,docx_database_proxy:!0,docx_deferred_render:!0,docx_docx_render:!0,docx_pages:!0,docx_right_bar:!0,docx_tools:!0,fake_toolbar:!0,field_processor:!0,fieldcode:!0,fieldcode_date:!0,fieldcode_doc_link:!0,fieldcode_doclink_render:!0,fieldcode_mention:!0,fieldcode_mention_render:!0,fieldcode_page:!0,file_base:!0,file_export:!0,file_mobile:!0,file_pc:!0,font:!0,fullscreen:!0,help_center:!0,help_center_mobile:!0,home_mobile:!0,image:!0,image_mobile:!0,image_pc:!0,image_readonly:!0,link:!0,list:!0,list_readonly:!0,location:!0,login:!0,manual_offline:!0,markdown:!0,mobile_header:!0,mobile_precise_preview:!1,mobile_tips:!0,mobile_view:!0,move_to:!0,move_to_mobile:!0,newpad_input_tips:!0,ocr:!0,ocr_preview:!0,offline_edit:!0,outline:!0,outline_mobile:!0,page:!0,page_shade:!0,paragraph:!0,performance_report:!0,presentation:!0,presentation_player:!1,print:!0,publish:!0,read_record:!0,readonly_mobile_toolbar:!0,readonly_tips:!0,readonly_toolbar:!0,recover_doc:!0,revision_record:!0,scroll_position:!0,search:!0,section:!0,selective_paste:!0,share:!0,share_mobile:!0,snap_screen_mobile:!0,snap_screen_pc:!0,spellcheck:!1,splitline:!0,splitline_readonly:!0,star_mobile:!0,table:!0,tdocs_deferred_render:!0,tdocs_render:!0,template_info:!1,text_flow:!0,title:!0,title_default_add:!0,title_mobile:!0,titlebar:!0,titlebar_mobile:!0,translate:!0,unread_notify:!0,update_notice:!0,user_avatar:!0,vip:!1,voice_input:!0,watermark:!0,word_count:!0,zoom_base:!0,zoom_melo:!0,zoom_mobile:!0,zoom_pc:{wheel:!0}}}},Co={app:"doc",version:"v_20210926150923_release",common:{titlebar:{account:!0,auth:!0,back:!0,collaborators:!0,collect:!0,fileMenu:!0,login:!0,logo:!0,moreMenu:!0,move:!0,new_logo:!1,presentation:!0,readonly:!0,saveState:!0,share:!0,title:!0},titlebar_mobile:{account:!0,auth:!0,collaborators:!0,collect:!0,home:!0,login:!0,logo:!1,moreMenu:!0,share:!0,share_web:!1,title:!0},toolbar:{"titlebar-toggle":!0},statusbar:{},menu:{"file-info-panel-mobile":!0,"more-type":!0,"new-folder":!1},blankpage:{applyEditPermission:!0,applyViewPermission:!0,back:!0,comment:!0,errImg:!0,feedbackQuestion:!0,footer:!0,login:!0,refresh:!0,switchAccount:!0,watchOfficeAccount:!0}},custom:{widget:{"help-center":!0},contextmenu:{},feature:{accessibility:!0,ad_mobile:!0,"addon.support_new_sdk":!0,app_guide:!0,app_guide_pc:!0,attachment:!1,audio:!0,closeWemeetBtn:!1,codeblock:!0,collab_caret:!0,collab_status:!0,collab_status_mobile:!0,comment:!0,comment_mobile:!0,comment_pc:!0,contextmenu_mobile:!0,core_edit:!0,doc_preview:!0,doc_view_mobile:!0,docx_database_proxy:!0,docx_deferred_render:!0,docx_docx_render:!0,docx_pages:!0,docx_right_bar:!0,docx_tools:!0,fake_toolbar:!0,field_processor:!0,fieldcode:!0,fieldcode_date:!0,fieldcode_doc_link:!0,fieldcode_doclink_render:!0,fieldcode_mention:!0,fieldcode_mention_render:!0,fieldcode_page:!0,file_base:!0,"file_base.support_processon":!0,file_export:!0,file_mobile:!0,file_pc:!0,font:!0,fullscreen:!0,help_center:!0,help_center_mobile:!0,home_mobile:!0,image:!0,image_mobile:!0,image_pc:!0,image_readonly:!0,keymap_list:!0,link:!0,list:!0,list_readonly:!0,location:!0,login:!0,manual_offline:!0,markdown:!0,mobile_header:!0,mobile_precise_preview:!1,mobile_tips:!0,mobile_view:!0,move_to:!0,move_to_mobile:!0,newpad_input_tips:!0,ocr:!0,ocr_preview:!0,offline_edit:!0,outline:!0,outline_mobile:!0,page:!0,page_shade:!0,paragraph:!0,performance_report:!0,presentation:!0,presentation_player:!1,print:!0,publish:!0,read_record:!0,readonly_mobile_toolbar:!0,readonly_tips:!0,readonly_toolbar:!0,recover_doc:!0,revision_record:!0,scroll_position:!0,search:!0,section:!0,selective_paste:!0,share:!0,share_mobile:!0,snap_screen_mobile:!0,snap_screen_pc:!0,spellcheck:!0,splitline:!0,splitline_readonly:!0,star_mobile:!0,table:!0,tdocs_deferred_render:!0,tdocs_render:!0,template_info:!0,text_flow:!0,title:!0,title_default_add:!0,title_mobile:!0,titlebar:!0,titlebar_mobile:!0,translate:!0,unread_notify:!0,update_notice:!0,user_avatar:!0,vip:!0,voice_input:!0,watermark:!0,word_count:!0,zoom_base:!0,zoom_melo:!0,zoom_mobile:!0,zoom_pc:{wheel:!0}}}},To={app:"doc",version:"v_20201207192816_release",common:{titlebar:!1,titlebar_mobile:{account:!0,auth:!0,collaborators:!0,collect:!0,home:!0,login:!0,logo:!0,moreMenu:!0,share:!0,title:!0},toolbar:!1,statusbar:{},menu:{},blankpage:{applyEditPermission:!0,applyViewPermission:!0,back:!0,comment:!0,errImg:!0,feedbackQuestion:!0,footer:!0,login:!0,refresh:!0,switchAccount:!0,watchOfficeAccount:!0}},custom:{widget:{"help-center":!0},contextmenu:{},feature:{ad_mobile:!0,app_guide:!0,app_guide_pc:!0,audio:!0,codeblock:!0,collab_caret:!0,collab_status:!0,collab_status_mobile:!0,comment:!1,comment_mobile:!1,comment_pc:!1,contextmenu_mobile:!0,core_edit:!0,doc_preview:!0,doc_view_mobile:!0,docx_database_proxy:!0,docx_deferred_render:!0,docx_docx_render:!0,docx_pages:!0,docx_right_bar:!0,docx_tools:!0,fake_toolbar:!0,field_processor:!0,fieldcode:!0,fieldcode_date:!0,fieldcode_doc_link:!0,fieldcode_doclink_render:!0,fieldcode_mention:!0,fieldcode_mention_render:!0,fieldcode_page:!0,file_base:!0,file_export:!0,file_mobile:!0,file_pc:!0,font:!0,fullscreen:!0,help_center:!0,help_center_mobile:!0,home_mobile:!0,image:!0,image_mobile:!0,image_pc:!0,image_readonly:!0,link:!0,list:!0,list_readonly:!0,location:!0,login:!0,manual_offline:!0,markdown:!0,mobile_header:!0,mobile_tips:!0,mobile_view:!0,move_to:!0,move_to_mobile:!0,newpad_input_tips:!0,ocr:!0,ocr_preview:!0,offline_edit:!0,outline:!0,outline_mobile:!0,page:!0,page_shade:!0,paragraph:!0,performance_report:!0,presentation:!0,print:!0,publish:!0,read_record:!0,readonly_mobile_toolbar:!0,readonly_tips:!0,readonly_toast:!0,readonly_toolbar:!0,recover_doc:!0,revision_record:!0,scroll_position:!0,search:!0,section:!0,selective_paste:!0,share:!0,share_mobile:!0,snap_screen_mobile:!0,snap_screen_pc:!0,spellcheck:!0,splitline:!0,splitline_readonly:!0,star_mobile:!0,table:!0,tdocs_deferred_render:!0,tdocs_render:!0,template_info:!0,text_flow:!0,title:!0,title_default_add:!0,title_mobile:!0,titlebar:!0,titlebar_mobile:!0,translate:!0,unread_notify:!0,update_notice:!0,user_avatar:!0,vip:!0,voice_input:!0,watermark:!0,word_count:!0,zoom_base:!0,zoom_melo:!0,zoom_mobile:!0,zoom_pc:{wheel:!0}}}},xo=function(){function e(e,t,n,r,o){var i=this;this.configService=e,this.eventEmitter=t,this.titlebarService=n,this.settings=r,this.contextService=o,this.setConfig=function(){var e,t=x.Am.get(go.i),n=window.basicClientVars||{},r=n.authInfo,o=n.docInfo,a=q.qO.createInstance({privilegeAttribute:(null==r?void 0:r.attribute)||{},isCreator:null==o?void 0:o.isCreator});i.contextService.inject("permission",a),i.configService.setConfig(vo.J.NORMAL,window.App.UIConfigs.NORMAL_CONFIG||Co),i.configService.setConfig(vo.J.PUBLISH,window.App.UIConfigs.PUBLISH_CONFIG||wo),i.configService.setConfig(vo.J.PREVIEW,window.App.UIConfigs.PREVIEW_CONFIG||To),i.configService.setConfig(vo.J.MINIMAL,window.App.UIConfigs.MINIMAL_CONFIG||Eo),i.configService.setConfig(vo.J.PLAYER,window.App.UIConfigs.PLAYER_CONFIG||yo),i.syncConfig(),bo.ud.get(bo.wA.DocsConfigLib).then((function(e){var t=e.default;t.getInstance().bind(i.configService.get("common")),t.getInstance().saveToSessionStorage()}));var s=null!==(e=i.configService.get("custom.widget"))&&void 0!==e?e:{};t.exclude(Object.keys(s).filter((function(e){return!s[e]})),"float"),i.eventEmitter.emit("TDOCS_CONFIG_SETED")}}return e.prototype.initConfig=function(){this.configService.setMode(vo.J.PUBLISH,(function(){return window.isPublishedURL})),this.configService.setMode(vo.J.PREVIEW,(function(){return!!(0,p.getUrlParameter)("inToastPreview")||!!(0,p.getUrlParameter)("ocr")})),this.configService.setMode(vo.J.MINIMAL,(function(){return!!(0,p.getUrlParameter)("minimal")||"reading"===(0,p.getUrlParameter)("mode")})),this.configService.setMode(vo.J.PLAYER,(function(){return"player"===(0,p.getUrlParameter)("show")})),this.configService.setMode(vo.J.DIFFVIEW,(function(){return!(!(0,p.getUrlParameter)("begin_rev")||!(0,p.getUrlParameter)("end_rev"))})),this.setConfig()},e.prototype.syncConfig=function(){var e=!this.configService.get("common.toolbar"),t=!this.configService.get("common.titlebar")||this.configService.get("common.toolbar")&&!this.configService.get("common.toolbar.titlebar-toggle-show");this.settings.set("toolbar.disabled",e),this.settings.set("titlebar.disabled",t),this.settings.set("statusbar.disabled",!this.configService.get("common.statusbar")),this.settings.set("contextMenu.disabled",!this.configService.get("custom.contextmenu")),this.titlebarService.$forceUpdate(),t&&e?zr.p.hide(zr.j.ALL):(t&&zr.p.hide(zr.j.Titlebar),e&&zr.p.hide(zr.j.Toolbar))},e.prototype.serviceSetSchema=function(e,t){var n=Object.entries(e).reduce((function(e,t){var n=(0,r.__read)(t,2),o=n[0];return n[1]||e.push(o),e}),[]),o=JSON.parse(n.reduce((function(e,t){return e.replace(new RegExp('"'.concat(t,'"'),"g"),'"'.concat(t,'__removed"'))}),JSON.stringify(this[t].getSchema())));this[t].setSchema(o)},e}(),So=function(e){function t(t,n,r,o,i,a,s){var c=e.call(this,t,o,i,a,s)||this;return c.menuService=n,c.toolbarService=r,c}var n,o,i,a,s,c,l;return(0,r.__extends)(t,e),t=(0,r.__decorate)([(0,_e.t)(),(0,r.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==Jr.ax&&Jr.ax)?n:Object,"function"==typeof(o=void 0!==xr.h&&xr.h)?o:Object,"function"==typeof(i=void 0!==Sr.O&&Sr.O)?i:Object,"function"==typeof(a=void 0!==Fe.v&&Fe.v)?a:Object,"function"==typeof(s=void 0!==er.M&&er.M)?s:Object,"function"==typeof(c=void 0!==re.I&&re.I)?c:Object,"function"==typeof(l=void 0!==S.O&&S.O)?l:Object])],t)}(xo),Io=n(39445),ko=n(57724),Ro=n(32101),Ao=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.getOriginalRectSize=function(){return{measure:0,extent:this.node.isHidden?0:this.node.getProperty().embedCommentHeight}},t}(d.ShapeBoxEnv),Oo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),Object.defineProperty(t.prototype,"property",{get:function(){return this.modelProperty},set:function(e){this.modelProperty=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){var e,t;return null!==(t=null===(e=this.property)||void 0===e?void 0:e.id)&&void 0!==t?t:this.uuid},enumerable:!1,configurable:!0}),t}(d.LeafContainerBox),Lo=n(98151),Mo=function(e,t,n,r,o){if((0,d.isCommentRefChar)(o.charCodeAt(0))){var i=e.dataStream.getStoryStream().getStoryInfoFromGcp(n.begin());if((null==i?void 0:i.storyProp.storyType)!==d.STStoryType.textboxContent){var a=e.dataStream.getAnnotationStream().createCommentIterator(n);if(a.getRange().contains(n.begin())&&a.getProperty())return new Lo.s(e,n,d.LayoutInputNodeType.LeafContainer,void 0,r)}}return null},No={uniqueTypeId:Lo.f,nodeCreator:Mo,BoxEnv:Ao,Box:Oo},Do={uniqueTypeId:Lo.f,nodeCreator:Mo,propertyGetter:function(e){var t=e.getProperty(),n=new(d.PropertyFactory.getPropertyClass(d.PropertyType.DrawingProperty));return t?(n.inlineKeyword.extent.cy=t.embedCommentHeight,n.inlineKeyword.graphic.graphicData.wsp.txbx.id=t.id,n.anchorId=t.id,n.isCommentRef=!0,n):n}},Po=function(){function e(){}return e.prototype.applyExtension=function(e){e.isRenderLiteType()?e.addLayoutExtension(d.ExtensionNodeType.LeafContainer,Do):e.addLayoutExtension(d.ExtensionNodeType.LeafContainer,No)},e=(0,r.__decorate)([(0,_e.t)()],e)}(),Fo=n(41290),Bo=n(98337),Uo=n(22828),Ho=n(28379),jo=n(26676),Wo=n(24689),Vo="JankDetector",zo=1e4,Go=function(){function e(){}return e.createRAFJank=function(t,n){return void 0===n&&(n=e.config),q.qO.getInstance().isEditable&&e.supportJankDetect?(e.rAFJank||e.init(n),e.context=t,e.rAFJank):null},e.init=function(t){e.detectFocus(),e.detectClick(),e.rAFJank=p.RAFJankUtil.createInstance(t),e.rAFJank.addEventListener("jank",e.handleJank),e.rAFJank.addEventListener("heart",e.handleHeart)},e.handleHeart=function(){window.JankGlobalKeyCode="",e.clickEventPath=""},e.handleJank=function(t){var n=t.jankTime,r=t.stack,o=t.position;e.reportJank(n,r,o||0),e.context.perfManager.resetEditTimes()},e.reportJank=function(t,n,r){var i=t>zo;p.Logger.warn(Vo,"reportJank isSlowerRender: ".concat(i," ").concat(t)),o.M.isDevEvn()||(e.reportOnes(t,n,r),e.reportMulti(t,n,r))},e.reportOnes=function(t,n,r){var o=t>zo;e.hasReportJank||(e.hasReportJank=!0,e.stack||(e.stack=[]),e.stack.push({jankTime:t,stack:n,position:r,hidden:document.hidden,isFocus:e.isFocus,kc:window.JankGlobalKeyCode,path:e.clickEventPath}),e.reportToTdw(t,"edit_slow"),e.reportToSentry(),d.ReportHelper.monitor(o?d.MonitorName.FRAME_DROP_SERIOUS:d.MonitorName.FRAME_DROP_NORMAL),e.stack=[])},e.reportMulti=function(t,n,r){var o;if(Date.now()-e.lastReportTime<1e4)e.stack.push({jankTime:t,stack:n,position:r,hidden:document.hidden,isFocus:e.isFocus,kc:window.JankGlobalKeyCode,path:e.clickEventPath});else{e.reportToTdw(t,"edit_jank");var i=e.getEditStatisticInfo();if(d.ReportHelper.zzsHandler.zzsStatus({attributeId:d.MonitorName.FRAME_DROP_OCCUR,status:d.Status007.FAIL,otherDimensions:[i.mutLenLevel,String(i.pasteInRecent),String(i.editAfterOpen),String(i.editInFiveMin),String(i.lastEditFromCollab),e.isFocus,document.hidden]}),d.ReportHelper.zzsHandler.zzsValue(d.MonitorName.FRAME_DROP_OCCUR,t),!e.hasReportWeblog&&t>=3e3){var a=3;t>=5e3&&(a=5),t>=zo&&(a=10),null===(o=window.log)||void 0===o||o.report(d.MonitorName.FRAME_DROP_REPORT+"_".concat(a,"s")),e.hasReportWeblog=!0}e.lastReportTime=Date.now(),e.stack=[]}},e.detectFocus=function(){window.addEventListener("focus",(function(){e.isFocus=!0})),window.addEventListener("blur",(function(){e.isFocus=!1}))},e.detectClick=function(){window.addEventListener("click",(function(t){e.clickEventPath=(0,jo.tD)(t.target,5)}))},e.reportToSentry=function(){var e=d.GlobalContext.run(P.Rh.getActionType),t=new Error("JankError_".concat(e));t.name="JankError_".concat(e),t.message+="\n,changesetLog: ".concat(JSON.stringify(d.GlobalContext.run(P.Rh.get))),d.ReportHelper.captureException(d.MonitorName.FRAME_DROP_REPORT,{logger:d.RavenLogger.ACTIVE_REPORT},t)},e.reportToTdw=function(t,n){var r=e.getJankReportData(t,n);Wo.u.getInstance((0,Io.pb)()).containerEnv;return window.__isOfflinePkg,Wo.u.replaceCount,d.ReportHelper.tdwReport(r),void e.reportToAegis(n)},e.getEditStatisticInfo=function(){var t,n=e.context.perfManager.getPerfInfo().recentEditInfoList,r=n[n.length-1];return{pasteInRecent:!!n.find((function(e){return e.commandType===d.CommandType.DocPaste})),editInFiveMin:!!r&&p.PerfUtil.now()-r.editTime>3e5,editAfterOpen:!!n.length,lastEditFromCollab:!!r&&r.fromServer,mutLenLevel:null===(t=d.ReportHelper.monitorHandler)||void 0===t?void 0:t.getMutLenDimensionsStr(),recentEditInfoList:n}},e.getJankReportData=function(t,n){var o=e.context,i=o.perfManager,a=o.statisticInfo,s=i.getPerfInfo(),c=(s.recentEditInfoList,(0,r.__rest)(s,["recentEditInfoList"])),l=e.getEditStatisticInfo(),u={module:"page_detail",opername:"tech_doc_performance_melo",action:n,source2:t>zo?2:1,ver5:JSON.stringify(l),ver6:JSON.stringify(c),ver7:JSON.stringify(a),ver8:JSON.stringify(e.stack)};return p.Logger.warn(Vo,"getJankReportData:",u),u},e.reportToAegis=function(e){window.aegis&&window.aegis.reportEvent(e)},e.config={HeartbeatConfig:{jankLimit:1e3,TriggerLimit:1e6,StopOnPageHidden:!0},PageActiveConfig:{Limit:18e4}},e.isFocus=!0,e.supportJankDetect=!!window.requestAnimationFrame&&!!window.cancelAnimationFrame,e.hasReportJank=!1,e.hasReportWeblog=!1,e.lastReportTime=(new Date).getTime(),e.clickEventPath="",e}(),Yo=function(){function e(){var e=this;this._visiable=!1,this._left=30,this._top=30,this._width=50,this._height=50,this._dragCacheOffset={x:0,y:0},this._down=function(t){var n=Zo(t),r=n.clientX,o=n.clientY;e._dragCacheOffset.x=r-e._canvas.offsetLeft,e._dragCacheOffset.y=o-e._canvas.offsetTop,document.body.addEventListener("mousemove",e._move),document.body.addEventListener("touchmove",e._move),document.body.addEventListener("mouseup",e._up),document.body.addEventListener("touchend",e._up)},this._move=function(t){var n=Zo(t),r=n.clientX,o=n.clientY;e._left=r-e._dragCacheOffset.x,e._top=o-e._dragCacheOffset.y,e._canvas.style.left=e._left+"px",e._canvas.style.top=e._top+"px"},this._up=function(){e._dragCacheOffset.x=0,e._dragCacheOffset.y=0,document.body.removeEventListener("mousemove",e._move),document.body.removeEventListener("touchmove",e._move),document.body.removeEventListener("mouseup",e._up),document.body.removeEventListener("touchend",e._up)}}return Object.defineProperty(e.prototype,"visiable",{get:function(){return this._visiable},enumerable:!1,configurable:!0}),e.prototype.show=function(){this._visiable||(this._init(),this._visiable=!0)},e.prototype.hide=function(){this._visiable&&(this._visiable=!1,this._dispose())},e.prototype.draw=function(e){var t=1e3/e;this._draw(t)},e.prototype._draw=function(e){this._ctx.clearRect(0,0,this._width,this._height),this._ctx.drawImage(this._backCanvas,0,0,this._width*devicePixelRatio,this._height*devicePixelRatio,1,0,this._width,this._height),this._ctx.clearRect(0,0,1,this._height),this._ctx.save(),this._ctx.strokeStyle="#2ec3f7",this._ctx.translate(.5,0),this._ctx.beginPath(),this._ctx.moveTo(0,this._height),this._ctx.lineTo(0,(1-Math.min(120,e)/120)*this._height),this._ctx.closePath(),this._ctx.stroke(),this._ctx.restore(),this._backCtx.clearRect(0,0,this._width,this._height),this._backCtx.drawImage(this._canvas,0,0,this._width*devicePixelRatio,this._height*devicePixelRatio,0,0,this._width,this._height),this._ctx.save(),this._ctx.strokeStyle="#ff0000",this._ctx.beginPath(),this._ctx.moveTo(0,this._height/2),this._ctx.lineTo(this._width,this._height/2),this._ctx.closePath(),this._ctx.stroke(),this._ctx.restore()},e.prototype._init=function(){var e,t,n;this._canvas=document.createElement("canvas"),this._ctx=this._canvas.getContext("2d"),this._backCanvas=document.createElement("canvas"),this._backCtx=this._backCanvas.getContext("2d"),e=this._canvas,t=this._left,n=this._top,Object.assign(e.style,{position:"absolute",backgroundColor:"#d8f5ff",left:t+"px",top:n+"px",zIndex:1e6}),qo(this._canvas,this._ctx,this._width,this._height),qo(this._backCanvas,this._backCtx,this._width,this._height),this._canvas.addEventListener("mousedown",this._down),this._canvas.addEventListener("touchstart",this._down),document.body.appendChild(this._canvas)},e.prototype._dispose=function(){this._canvas=null,this._ctx=null,this._canvas.removeEventListener("mousedown",this._down),this._canvas.removeEventListener("touchstart",this._down),document.body.removeChild(this._canvas)},e}();function qo(e,t,n,r){var o=window.devicePixelRatio||1,i=Math.round(n*o),a=Math.round(r*o);e.setAttribute("width",String(i)),e.setAttribute("height",String(a)),e.style.width=i/o+"px",e.style.height=a/o+"px",t.scale(o,o)}function Zo(e){return e.clientX?{clientX:e.clientX,clientY:e.clientY}:{clientX:e.touches[0].clientX,clientY:e.touches[0].clientY}}var Jo,Ko=Yo,Qo=function(){function e(e){var t=this;void 0===e&&(e={}),this._running=!1,this._last=0,this._timer=0,this._record=[],this._threshold=Number.MAX_SAFE_INTEGER,this._maxInterval=0,this._box=new Ko,this._listeners=[],this._run=function(){var e=Date.now()-t._last;t._record.push(e),t._shouldDispatch(),t._box.visiable&&t._box.draw(e),t._last=Date.now(),t._timer=requestAnimationFrame(t._run)},void 0!==e.cycle&&(this._threshold=e.cycle/16>>0),void 0!==e.maxInterval&&(this._maxInterval=e.maxInterval)}return e.prototype.start=function(){this._running?console.warn("已经启动 fps 监听"):(this._running=!0,this._lastDispatch=Date.now(),this._last=Date.now(),this._timer=requestAnimationFrame(this._run))},e.prototype.end=function(){window.cancelAnimationFrame(this._timer),this._running=!1,this._record.length>0&&(this._dispatch(),this._record.length=0)},e.prototype.visiable=function(){this._box.show()},e.prototype.invisible=function(){this._box.hide()},e.prototype.addListener=function(e){this._hasListener(e)||this._listeners.push(e)},e.prototype.removeListener=function(e){this._hasListener(e)&&(this._listeners=this._listeners.filter((function(t){return t!==e})))},e.prototype._shouldDispatch=function(){(0!==this._maxInterval&&Date.now()-this._lastDispatch>this._maxInterval||this._record.length>=this._threshold)&&this._dispatch()},e.prototype._hasListener=function(e){return!this._listeners.every((function(t){return t!==e}))},e.prototype._dispatch=function(){var e=this;this._record.shift(),this._listeners.forEach((function(t){t(e._record)})),this._record.length=0,this._lastDispatch=Date.now()},e}(),Xo=function(){function e(e){var t=this;this.fps=new Qo,this.isScrolling=!1,this.SAMPLE_RATE=1,this.PARTITION=[[0,30,"0-30"],[30,40,"30-40"],[40,50,"40-50"],[50,56,"50-55"],[56,57,"56"],[57,58,"57"],[58,59,"58"],[59,60,"59"],[60,Number.POSITIVE_INFINITY,"60+"]],this.onScroll=(0,p.throttle)((function(){clearTimeout(t.scrollTimer),t.scrollTimer=setTimeout((function(){t.isScrolling=!1,t.end()}),300),t.isScrolling||(t.isScrolling=!0,t.start((function(e){var n;switch(t.editor.docEnv.renderType){case d.RenderType.Canvas:n=1;break;case d.RenderType.Lite:n=2}for(var r=0,o=e.length-1;o>=0&&!((r+=e[o])>=300);o--);var i=t.calFPS(e.slice(0,o));p.Logger.log("perf|fps_scroll:".concat(JSON.stringify(i))),void 0!==i&&d.ReportHelper.tdwReport({opername:"quality_doc",module:"detail",action:"fps_scroll",ver7:i.average,ver8:i.partition,ver9:n,ver10:i.variance})})))}),100),this.editor=e}return e.prototype.shouldMonitor=function(){return 100*Math.random()<this.SAMPLE_RATE},e.prototype.start=function(e){var t=this;this.shouldMonitor()&&(this.currentListener=e,this.fps.addListener(this.currentListener),this.fps.start(),this.timeoutTimer=setTimeout((function(){t.end()}),1e4))},e.prototype.end=function(){this.fps.end(),this.fps.removeListener(this.currentListener),clearTimeout(this.timeoutTimer)},e.prototype.visible=function(){this.fps.visiable()},e.prototype.invisible=function(){this.fps.invisible()},e.prototype.reset=function(){this.editor.scrollHandler.removeScrollListener(this.onScroll),this.fps.removeListener(this.currentListener),this.fps.end()},e.prototype.calFPS=function(e){var t=this;if(e.length>4){var n=e.slice(2,e.length-2),r=1e3/(n.reduce((function(e,t){return e+t}),0)/n.length),o=0,i={};return n.forEach((function(e){var n=1e3/e;t.PARTITION.some((function(e){return n>=e[0]&&n<e[1]&&(i[e[2]]=(i[e[2]]||0)+1,!0)})),o+=Math.pow(n-r,2)})),{average:r,variance:Math.sqrt(o/n.length),partition:JSON.stringify(i)}}},e.prototype.startInitMonitor=function(){var e=this;this.start((function(t){var n,r=e.calFPS(t);switch(e.editor.docEnv.renderType){case d.RenderType.Canvas:n=1;break;case d.RenderType.Lite:n=2}p.Logger.log("perf|fps_init:".concat(JSON.stringify(r))),void 0!==r&&d.ReportHelper.tdwReport({opername:"quality_doc",module:"detail",action:"fps_init",ver7:r.average,ver8:r.partition,ver9:n,ver10:r.variance})}))},e.prototype.startScrollMonitor=function(){this.editor.scrollHandler.addScrollListener(this.onScroll)},e}(),$o=n(99181),ei=n(99925),ti=function(){function e(e){this.editor=e}return e.prototype.monitorLayoutError=function(){var e=this;this.editor.on(d.LayoutNotification.LayoutFinished,(function(){e.checkAndReportFatalError()}),this)},e.prototype.reportFatalLayout=function(){ei.j.report("doc-fatal-layout-caused-by-dirty-data"),d.ReportHelper.tdwReport({opername:"doc_fatal_layout",module:"layout_finished",action:"dirty_data_check"})},e.prototype.checkAndReportFatalError=function(){var e=this.editor.getLayoutError();if(!e)return!1;var t=e.context.gcpPairs;return t&&(ei.j.error("[脏数据]排版错误，当前数据版本为：",window.App.collabCenterAdapter.getVersion()),ei.j.error("[脏数据]排版错误，bp 换 cp 的错误结果为：",t),this.reportFatalLayout()),!0},e.prototype.dispose=function(){this.editor.removeListener(d.LayoutNotification.LayoutFinished,this)},(0,r.__decorate)([(0,$o.u)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],e.prototype,"reportFatalLayout",null),e}(),ni=n(92111),ri=n(24506),oi=n(19150),ii=n(14740),ai={logo:[eo.j9.HOME],title:[eo.j9.TITLE],certification:[eo.j9.CERTIFICATION],readonly:[eo.j9.READONLY_TIPS],saveState:[eo.j9.SUBSCRIBE,eo.j9.SAVE_TIPS],collaborators:[eo.j9.COLLABORATION],"qq-group":[eo.j9.QQ_GROUP_AIO],fileMenu:[eo.j9.FILE_MENU],moreMenu:[eo.j9.EDIT_MENU],presentation:[eo.j9.PRESENTATION],auth:[eo.j9.AUTH],share:[eo.j9.SHARE],account:[eo.j9.ACCOUNT_AVATAR],login:[eo.j9.LOGIN],collect:[eo.j9.COLLECT],toggle:[eo.j9.TOOLBAR_MODE],move:[eo.j9.MOVE]},si={name:eo.j9.BRAND,content:ve().createElement(oi.pp,null),preventHide:!0},ci=function(){function e(){}var t,n,o,i,a;return e.init=function(){var e,t,n;return(0,r.__awaiter)(this,void 0,Promise,(function(){var o,i,a,s,c,l,u,d,p,f,_,h=this;return(0,r.__generator)(this,(function(m){return o=x.Am.get(ri.$),null===(e=null===eo.rX||void 0===eo.rX?void 0:eo.rX.updateExtensionService)||void 0===e||e.call(eo.rX,o.extensionService),i=o.dependentServiceCombinder,a=i.docMetaDomain,s=i.userInfoDomain,c=i.authDomain,l=i.accountDomain,u=i.fileInfoDomain,d=i.accountApplication,p=i.collaborateDomain,null===(t=null===eo.rX||void 0===eo.rX?void 0:eo.rX.updateDomainService)||void 0===t||t.call(eo.rX,{docMetaDomain:a,accountDomain:l,authDomain:c,userInfoDomain:s,fileInfoDomain:u,collaborateDomain:p}),null===(n=null===eo.rX||void 0===eo.rX?void 0:eo.rX.updateApplicationService)||void 0===n||n.call(eo.rX,{accountApplication:d}),this.initTitleBarProperty(),f=Object.entries(this.configService.get("common.titlebar")).reduce((function(e,t){var n,o=(0,r.__read)(t,2),i=o[0];return o[1]||e.push.apply(e,(0,r.__spreadArray)([],(0,r.__read)(null!==(n=ai[i])&&void 0!==n?n:[]),!1)),e}),[]),_=JSON.parse(f.reduce((function(e,t){return e.replace(new RegExp('"'.concat(t,'"'),"g"),'"'.concat(t,'__removed"'))}),JSON.stringify(eo.QW.TITLEBAR_SCHEMA))),this.titlebarService.setSchema(_),this.titlebarService.register(si),this.controllerService.buildController(eo.QW.TitlebarController),[].push(this.store.get("docTitle").subscribe((function(e){window.isPublishedURL&&h.eventEmitter.emit(eo.zW.TITLE_CHANGE,e)}))),[2]}))}))},e.initTitleBarProperty=function(){var e=(0,c.Yi)().official_auth_info;this.store.register("isTitlebarShowed",!!this.configService.get("common.toolbar.titlebar-toggle-show")&&!0),this.store.register("docTitle",(0,ii.$t)(window.productName)),this.store.register("isLogin",!0),this.store.register("isEditable",!0),this.store.register("canEditTitle",!1),this.store.register("canShowCertification",!!e),this.store.register("menuActive",!1),this.store.register("menuHover","none"),this.store.register("menuLastHover","none"),this.store.register("menuHoverTooltip","none")},(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==Fe.v&&Fe.v)?t:Object)],e,"eventEmitter",void 0),(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==te.H&&te.H)?n:Object)],e,"controllerService",void 0),(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(o=void 0!==de.O&&de.O)?o:Object)],e,"store",void 0),(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(i=void 0!==er.M&&er.M)?i:Object)],e,"titlebarService",void 0),(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(a=void 0!==Jr.ax&&Jr.ax)?a:Object)],e,"configService",void 0),e}(),li=n(18366),ui=n(49790),di=function(){function e(){this._changeSet=[],this._changeSetCount=0,this._wordCount=0,this._taskId=(0,li.generateMessageTaskId)()}return Object.defineProperty(e.prototype,"changeSet",{get:function(){return this._changeSet},set:function(e){this._changeSet=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"changeSetCount",{get:function(){return this._changeSetCount},set:function(e){this._changeSetCount=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wordCount",{get:function(){return this._wordCount},set:function(e){this._wordCount=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"createTimestamp",{get:function(){return this._createTimestamp},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"taskId",{get:function(){return this._taskId},enumerable:!1,configurable:!0}),e.prototype.compose=function(e){this.updateCreateTimestamp(),this.changeSet.push(e),this.changeSetCount+=1},e.prototype.toJSON=function(){return this._changeSet.map((function(e){return d.Changeset.serialize(e.mutations)}))},e.prototype.reset=function(){this._taskId=(0,li.generateMessageTaskId)(),this._changeSet=[],this._changeSetCount=0,this._createTimestamp=0},e.prototype.makeIdentity=function(){this._changeSet=[],this._changeSetCount=0},e.prototype.isIdentity=function(){return 0===this._changeSet.length},e.prototype.updateCreateTimestamp=function(){this._createTimestamp||(this._createTimestamp=+new Date)},e}(),pi=n(33931),fi=[ui.DOCUMENT_DATA_TYPE.committing,ui.DOCUMENT_DATA_TYPE.queue,ui.DOCUMENT_DATA_TYPE.waiting];!function(e){e.spreadStructure="1.0"}(Jo||(Jo={}));var _i,hi=function(e){try{var t=JSON.parse(e.data);return{modelVersion:Jo.spreadStructure,dver:e.dataVersion,subId:e.subId,head:t.data.head,keydata:t.data.keyData,offlineMsg:t.isOfflineMessage,type:e.type,taskId:e.taskId,version:e.version,createTimestamp:e.createTimestamp,changeset:t.data.changeset,changesetString:t.data.changeset,apool:t.data.apool}}catch(e){null===ei.j||void 0===ei.j||ei.j.error("twoDotZeroToThreeDotZeroDocChangeTransform error: ".concat(null==e?void 0:e.message))}},mi=n(98502),gi=function(){function e(e){this.subId=e,this._submittedChangeset=null,this._queueChanges=[],this._toSummitChangeset=new di,this._hasReportEdit=!1}return Object.defineProperty(e.prototype,"submittedChangeset",{get:function(){return this._submittedChangeset},set:function(e){e&&(e.type=ui.DOCUMENT_DATA_TYPE.committing),this._submittedChangeset=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"toSummitChangeset",{get:function(){return this._toSummitChangeset},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"queueChanges",{get:function(){return this._queueChanges},enumerable:!1,configurable:!0}),e.prototype.pushDocChangesToQueue=function(e){var t,n;try{for(var o=(0,r.__values)(e),i=o.next();!i.done;i=o.next()){var a=i.value;a.changeset&&(a.type=ui.DOCUMENT_DATA_TYPE.queue,this.queueChanges.push(a),this.toSummitChangeset.makeIdentity())}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},e.prototype.hasUncommittedChanges=function(){return!(!(this.submittedChangeset||this.queueChanges.length>0)&&this.toSummitChangeset.isIdentity())},e.prototype.init=function(){this.toSummitChangeset.reset(),this.queueChanges.splice(0,this.queueChanges.length),this._submittedChangeset=null},e.prototype.getChanges=function(){var e=[];if(this.submittedChangeset&&e.push(this.submittedChangeset),this.queueChanges.forEach((function(t){e.push(t)})),!this.toSummitChangeset.isIdentity()){var t={type:ui.DOCUMENT_DATA_TYPE.waiting,changeset:this.toSummitChangeset.changeSet,taskId:this.toSummitChangeset.taskId,subId:this.subId,changeSetCount:this.toSummitChangeset.changeSetCount,createTimestamp:this.toSummitChangeset.createTimestamp};e.push(t)}return e},e.prototype.applyPreparedChangesetToBase=function(e){if(!this.submittedChangeset)throw new Error("applySubmittedChangesToBase: no submitted changes to apply");d.GlobalContext.run(P.Rh.push,{acceptCs:this.submittedChangeset.changeset,rev:e}),this._submittedChangeset=null,this.setAllChangesToDatabase()},e.prototype.applyWireChange=function(e,t,n){var r=this,o=this.getChanges(),i="before follow, curRev: ".concat(t,",newRev: ").concat(n," push:").concat(e,", current changes: ").concat(JSON.stringify(o.map((function(e){return e.changeset}))));p.Logger.info("ChangsetStore | ".concat(i));var a=(0,pi.Uq)(e),s=(0,pi.By)(a);return o.forEach((function(e){s=(0,pi.ny)(s,e,!(e===r.submittedChangeset))})),p.Logger.info("after follow, current changes: ".concat(JSON.stringify(o.map((function(e){return e.changeset}))))),this.setAllChangesToDatabase(n),s},e.prototype.composeUserChangeset=function(e,t){this.toSummitChangeset.compose(e),t&&(this.toSummitChangeset.wordCount=t),this.setAllChangesToDatabase()},e.prototype.checkBeyondMaxLength=function(){return JSON.stringify(this.toSummitChangeset.toJSON()).length>1e3&&!this.toSummitChangeset.isIdentity()&&(this.moveToSummitChangeset2Queue(),this.setAllChangesToDatabase(),!0)},e.prototype.getUncommitedInfo=function(){var e=0,t=0;try{this.submittedChangeset&&this.submittedChangeset.changeset&&(e+=(0,pi.Re)(this.submittedChangeset.changeset),t+=this.submittedChangeset.changeSetCount||1),this.queueChanges.forEach((function(n){n.changeset&&(e+=(0,pi.Re)(n.changeset),t+=n.changeSetCount||1)})),this.toSummitChangeset.isIdentity()||(e+=(0,pi.Re)(this.toSummitChangeset.changeSet),t+=this.toSummitChangeset.changeSetCount||1)}catch(e){p.Logger.error("getUncommitedCharBank error",e)}return{charCount:e,csCount:t}},e.prototype.prepareUserChangeset=function(){var e={};return this.submittedChangeset?(p.Logger.info("[MOUDULE_CHANGESET]|prepareUserChangeset:from submit"),e=this.submittedChangeset):this.queueChanges.length>0?(p.Logger.info("[MOUDULE_CHANGESET]|prepareUserChangeset:from queue"),e=this.queueChanges.shift()):this.toSummitChangeset.isIdentity()||(p.Logger.info("[MOUDULE_CHANGESET]|prepareUserChangeset:from user"),e={changeset:this.toSummitChangeset.changeSet,taskId:this.toSummitChangeset.taskId,subId:this.subId,changeSetCount:this.toSummitChangeset.changeSetCount,wordCount:this.toSummitChangeset.wordCount,version:this.getVersion(),type:ui.DOCUMENT_DATA_TYPE.committing,createTimestamp:this.toSummitChangeset.createTimestamp},this.toSummitChangeset.reset()),e.changeset&&(this.submittedChangeset=(0,r.__assign)({},e)),this.setAllChangesToDatabase(),p.Logger.info("[MOUDULE_CHANGESET]|prepareUserChangeset:".concat(JSON.stringify(e.changeset))),e},e.prototype.prepareOfflineData=function(e){var t=(0,r.__assign)({},e);return t&&!t.taskId&&(t.taskId=(0,li.generateMessageTaskId)()),t},e.prototype.setAllChangesToDatabase=function(e){return void 0===e&&(e=this.getVersion()),(0,r.__awaiter)(this,void 0,void 0,(function(){var t,n,o,i,a;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return this.reportEdit(),t=this.getUserChangeset(),d.GlobalContext.run(mi.K.SetData2Store,mi.f.UserChangeset,t),n=this.getQueueChangesets(),o=this.getSubmittedChangeset(),i=[],t&&i.push(t),n.forEach((function(e){i.push(e)})),o&&i.push(o),a=window.App.GlobalConfig.globalCodeVersion,i.forEach((function(t){t.changesetString=(0,pi.eT)(t.changeset),t.changeset=[],t.dver=a,t.modelVersion=Jo.spreadStructure,t.version=e})),[4,window.App.offlineEditAdapter.deleteAndUpsertChanges(i)];case 1:return r.sent(),[2]}}))}))},e.prototype.getUserChangeset=function(){var e=null;return this.toSummitChangeset.isIdentity()||(e=this.prepareOfflineData({changeset:this.toSummitChangeset.changeSet,changeSetCount:this.toSummitChangeset.changeSetCount,taskId:this.toSummitChangeset.taskId,keydata:!1,subId:this.subId,head:!1,oSubId:!1,createTimestamp:this.toSummitChangeset.createTimestamp,type:ui.DOCUMENT_DATA_TYPE.waiting,version:this.getVersion()})),e},e.prototype.getSubmittedChangeset=function(e){var t=this.submittedChangeset;return e&&"object"==typeof e?t=e:t&&"object"==typeof t&&(t=this.prepareOfflineData(t)),t},e.prototype.getQueueChangesets=function(){var e=this,t=[];return this.queueChanges.forEach((function(n){var r=e.prepareOfflineData(n);r&&t.push(r)})),t},e.prototype.pushOfflineChanges=function(e){this.toSummitChangeset.isIdentity()||this.moveToSummitChangeset2Queue(),this.pushDocChangesToQueue(e),this.setAllChangesToDatabase()},e.prototype.moveToSummitChangeset2Queue=function(){this.queueChanges.push({changeset:this.toSummitChangeset.changeSet,taskId:this.toSummitChangeset.taskId,subId:this.subId,changeSetCount:this.toSummitChangeset.changeSetCount,createTimestamp:this.toSummitChangeset.createTimestamp,version:this.getVersion(),type:ui.DOCUMENT_DATA_TYPE.queue}),this.toSummitChangeset.reset()},e.prototype.getVersion=function(){return window.App.collabCenterAdapter.getVersion()},e.prototype.reportEdit=function(){this._hasReportEdit||(d.GlobalContext.run(P.Rh.reportEdit),this._hasReportEdit=!0)},e}(),vi=n(63022),bi=n(99623),yi=n(79329),wi=function(){function e(e,t){void 0===t&&(t="BB08J2"),this._collab=e,this._subId=t,this.tag="ChangesetManager",this.hasEdited=!1,this._changeCallbackTimeout=null,this.store=new gi(this._subId),window.App.changesetManager=this}return e.prototype.initPadRev=function(e){this.getPadRev=e},e.prototype.setChangeCallbackTimeout=function(){var e=this;null===this._changeCallbackTimeout&&(this._changeCallbackTimeout=window.setTimeout((function(){e._changeCallback&&e._changeCallback(),e.onUserChange(),e._changeCallbackTimeout=null}),0))},e.prototype.setInitialData=function(e){try{this.store.init(),this._collab.applyInitialData(e),this.store.pushDocChangesToQueue(yi.Wo.getMergedBaseDocChange())}catch(e){p.Logger.error("".concat(this.tag," | ").concat(e)),d.ReportHelper.captureChangesetException(d.MonitorName.CHANGESET_ERROR_INIT,{option:{changesetDataType:d.ChangesetDataType.INIT_DATA}},e)}},e.prototype.applyLocalChangesToBase=function(e){var t,n,o,i,a=this;try{var s=this.store.getChanges().map((function(e){return(0,r.__assign)((0,r.__assign)({},e),{changeset:(0,pi.Or)(e.changeset)})}));p.Logger.info("".concat(this.tag," | applyLocalChangesToBase localChanges.length:").concat(e.length,", memoryChanges.length: ").concat(s.length));var c=e.filter((function(e){return e.subId&&!yi.Wo.isMergedToBase(e.taskId)})),l=+new Date;try{for(var u=(0,r.__values)(c),f=u.next();!f.done;f=u.next()){var _=f.value,h=function(e){var t=(0,pi.By)([e]);s.forEach((function(e){t=(0,pi.ny)(t,e,!(e===a.store.submittedChangeset))})),_.offlineMsg=!0,e.mutations=t,m._collab.applyChangesToBase(t)},m=this;try{for(var g=(o=void 0,(0,r.__values)(_.changeset)),v=g.next();!v.done;v=g.next())h(v.value)}catch(e){o={error:e}}finally{try{v&&!v.done&&(i=g.return)&&i.call(g)}finally{if(o)throw o.error}}s.length&&(_.createTimestamp=l,l+=1)}}catch(e){t={error:e}}finally{try{f&&!f.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}this.store.pushOfflineChanges(c),this.store.queueChanges.length>0&&this.setChangeCallbackTimeout()}catch(e){d.ReportHelper.monitor007Status(d.MonitorName.APPLY_DATA_FAIL,d.Status007.FAIL,JSON.stringify(null==e?void 0:e.message),{isOffline:!0});var b=new CustomEvent(bi.HJ,{detail:{code:72010}});document.dispatchEvent(b);var y=new Error;y.name=d.MonitorName.CHANGESET_ERROR_APPLY_OFFLINE;var w=" browser info : ".concat(p.PlatformUtil.getBrowser(),"\n                ,this._userChangeset: ").concat(JSON.stringify(this.store.toSummitChangeset.changeSet),"\n                ,ex: ").concat(JSON.stringify(e));y.message="{\n".concat(w,"\n}"),p.Logger.error("report error, applyOffline_error: ".concat(w)),d.ReportHelper.captureChangesetException(d.MonitorName.CHANGESET_ERROR_APPLY_OFFLINE,{option:{changesetDataType:d.ChangesetDataType.INIT_DATA}},y)}},e.prototype.applyChangesToBase=function(e,t,n,r,o,i){try{var a=this.store.applyWireChange(e,o,i);this._collab.applyChangesToBase(a,t)}catch(e){p.Logger.error("".concat(this.tag," | applyOnline_error error: ").concat(e)),d.ReportHelper.monitor007Status(d.MonitorName.SERVER_MUTATION_APPLY_ERROR,d.Status007.FAIL),d.ReportHelper.monitor007Status(d.MonitorName.APPLY_DATA_FAIL,d.Status007.FAIL,JSON.stringify(null==e?void 0:e.message)),d.ReportHelper.tdwReport({opername:"doc_word_melo",module:"data_lost",action:"exp_tip",ver5:"1",ver6:d.EditorDocumentType.DOCUMENT,ver7:d.ChangesetDataType.APPLY_SERVER_DATA}),d.ReportHelper.captureChangesetException(d.MonitorName.CHANGESET_ERROR_APPLY_ONLINE,{option:{changesetDataType:d.ChangesetDataType.APPLY_SERVER_DATA}},e)}},e.prototype.prepareUserChangeset=function(){return this.store.prepareUserChangeset()},e.prototype.applyPreparedChangesetToBase=function(){this.store.applyPreparedChangesetToBase(this.getPadRev()),p.Logger.log("[MOUDULE_CHANGESET]|applyPreparedChangesetToBase"),(this.store.queueChanges.length>0||!this.store.toSummitChangeset.isIdentity())&&this.setChangeCallbackTimeout()},e.prototype.setUserChangeNotificationCallback=function(e){this._changeCallback=e},e.prototype.hasUncommittedChanges=function(){return this.store.hasUncommittedChanges()},e.prototype.composeUserChangeset=function(e){if(0!==e.mutations.length){this.store.checkBeyondMaxLength();var t=this._collab.getWordCountCache();this.store.composeUserChangeset(e,t);var n=JSON.stringify(this.store.toSummitChangeset.changeSet);p.Logger.info("[MOUDULE_CHANGESET]|composeUserChangeset, toSummitChangeset:".concat(n)),d.GlobalContext.run(P.Rh.push,{composeCs:n,rev:this.getPadRev(),actionType:e.type||"unknownActionType"}),this.setChangeCallbackTimeout()}},e.prototype.getUncommitedInfo=function(){return this.store.getUncommitedInfo()},e.prototype.onUserChange=function(){var e=this.prepareUserChangeset();if(e&&e.changeset){var t=window.App.collabCenterAdapter.getVersion(),n={taskId:e.taskId,subId:e.subId,commands:(0,pi.eT)(e.changeset),baseRev:t,changeSetCount:e.changeSetCount,offlineMsg:!!e.offlineMsg,wordCount:e.wordCount,changeset:""};window.App.collabCenterAdapter.sendUserChange([n]),this.hasEdited=!0}},e.prototype.beforeApplyCursorMsg=function(e){var t=this.store.getChanges();p.Logger.debug("[collab-caret]本地队列",t.map((function(e){return e.changeset[0]}))),p.Logger.debug("[collab-caret]本地队列处理前",e[0]);var n=(0,vi.Nc)(t),o=(0,vi.Mu)(n),i=e.map((function(e){var t=(0,r.__assign)({},e);return t.gcp=(0,vi.ZN)(e.gcp,o),t}));return p.Logger.debug("[collab-caret]本地队列处理后",i[0]),i},e.prototype.getChanges=function(){return this.store.getChanges()},e}(),Ei=n(44867),Ci=n(95507),Ti=n(81814),xi=n(70794),Si=n(73557),Ii=n(75906),ki=n(57026),Ri="LONG_CONNECTION_NOTIFICATION_TYPE",Ai=function(e){function t(t){var n=e.call(this,Ri)||this;return n.status=ki.IOfflineEditStatus.OFFLINE_EDIT_UNKNOWN,n.status=t,n}return(0,r.__extends)(t,e),t}(p.Notification),Oi=function(){function e(e){this.getSaveDocPromise=e,this.addNotificationListener()}return e.prototype.dispose=function(){return Si.network.remove(this.onlineCreatDocCallBack),d.GlobalContext.removeListener(Ri,this),!0},Object.defineProperty(e.prototype,"getCreateDocPromise",{get:function(){return this.createDocPromise},enumerable:!1,configurable:!0}),e.prototype.addNotificationListener=function(){var e=this;d.GlobalContext.once(Ri,(function(t){p.Logger.info("addNotificationListener:".concat(t.type));var n=(0,c.Yi)();e.toCreateDoc(n.globalPadId,n.padStatus===Ti.DL.LOCAL)}),this)},e.prototype.CreateDocWithoutData=function(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return[4,yi.Wo.getHelper().createFile(e,Ti.Gk.WORD,!1)];case 1:return t=n.sent(),[2,new Promise((function(e,n){t.error?n(t):e(t)}))]}}))}))},e.prototype.prePareCreateDocWithoutData=function(e){var t=this;return new Promise((function(n,r){var o=!1;t.onlineCreatDocCallBack=function(){if(Si.network.isOnline){if(window.clientVars&&window.clientVars.padStatus===Ti.DL.NORMAL&&t.onlineCreatDocCallBack)return void Si.network.remove(t.onlineCreatDocCallBack);o||(o=!0,t.CreateDocWithoutData(e).then((function(e){n(e)})).catch((function(e){var t;o=!1,10033===(null===(t=e.error)||void 0===t?void 0:t.errorCode)&&r(e)})))}},Si.network.changeEnd(t.onlineCreatDocCallBack),t.onlineCreatDocCallBack()}))},e.prototype.updateMemoryClientVars=function(e){var t,n,r,o,i,a,s,l,u,d,p,f,_,h,m,g,v,b;if((0,c.Yi)()){var y=(0,c.Yi)().collab_client_vars,w=(0,c.Yi)().collab_client_vars.client.upid;(0,c.Yi)().padStatus=(null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.data)||void 0===n?void 0:n.padStatus)||Ti.DL.NORMAL,y.client=Object.assign(null===(o=null===(r=null==e?void 0:e.data)||void 0===r?void 0:r.data)||void 0===o?void 0:o.collab_client_vars.client,{upid:w}),y.pver=null===(a=null===(i=null==e?void 0:e.data)||void 0===i?void 0:i.data)||void 0===a?void 0:a.collab_client_vars.pver,y.apid=null===(l=null===(s=null==e?void 0:e.data)||void 0===s?void 0:s.data)||void 0===l?void 0:l.collab_client_vars.apid,y.wmode=null===(d=null===(u=null==e?void 0:e.data)||void 0===u?void 0:u.data)||void 0===d?void 0:d.collab_client_vars.wmode,y.websocketReopenCount=null===(f=null===(p=null==e?void 0:e.data)||void 0===p?void 0:p.data)||void 0===f?void 0:f.collab_client_vars.websocketReopenCount,y.pollingAttemptNumber=null===(h=null===(_=null==e?void 0:e.data)||void 0===_?void 0:_.data)||void 0===h?void 0:h.collab_client_vars.pollingAttemptNumber,y.rev=null===(g=null===(m=null==e?void 0:e.data)||void 0===m?void 0:m.data)||void 0===g?void 0:g.collab_client_vars.rev,(0,c.Yi)().userInfo=null===(b=null===(v=null==e?void 0:e.data)||void 0===v?void 0:v.data)||void 0===b?void 0:b.userInfo}},e.prototype.duplicateDoc=function(e){if(10033===e.error.errorCode){var t=e.data.url;Ii.Modal.confirm({title:(0,ii.$t)("系统消息"),content:(0,ii.$t)("与服务器同步完成，请刷新。"),cancelText:null,okText:(0,ii.$t)("重新加载"),onOk:function(){location.href=window.multiAccountUtil.getMultiUrl(t)}})}},e.prototype.toCreateDoc=function(e,t){var n=this;this.createDocPromise=new Promise((function(r,o){if((0,xi.re)("prerender"))o("prerender doc ,globalPadId:".concat(e));else if(t&&e&&e!==Ho.Ev){if(!window.App.offlineEditAdapter.isLocked())return void o("get lock fail ,globalPadId:".concat(e));n.getSaveDocPromise().then((function(){n.prePareCreateDocWithoutData(e).then((function(t){t&&t.data&&0===t.data.retcode?(ei.j.info(ei.w.Offline,"updateSocketPromise:".concat(e)),n.updateMemoryClientVars(t),document.dispatchEvent(new Event("CreateDocSuccess")),r(t.data)):o("prePareCreateDocWithoutData ,reason:".concat(t&&t.data&&t.data.retcode))})).catch((function(t){t.error&&(n.duplicateDoc(t),o("prePareCreateDocWithoutData ,globalPadId:".concat(e," 创建失败: ").concat(t.error)))}))})).catch((function(){o("save doc fail")}))}else r(!0)}))},e}(),Li=n(17008),Mi=n.n(Li),Ni=function(){function e(){this.init()}return Object.defineProperty(e.prototype,"getSaveDocPromise",{get:function(){return this.saveDocPromise},enumerable:!1,configurable:!0}),e.prototype.init=function(){var e=this;this.saveDocPromise=new Promise((function(t,n){(0,xi.re)("new")?e.saveNewDoc2DB((0,c.Yi)()).then((function(e){e?t():n()})).catch((function(){n()})):t()}))},e.prototype.saveFailTips=function(e){ei.j.info(ei.w.Offline,"saveFailTips reason:".concat(e)),Mi().show({message:(0,ii.$t)("新建失败，请稍后重试。"),type:"info",autoClose:!1,action:(0,ii.$t)("退出"),onClickAction:function(){window.multiAccountUtil.reload()}})},e.prototype.saveNewDoc2DB=function(e){var t;return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,o,i,a,s,c,l;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return n=e.globalPadId,o=(0,xi.re)("folder")?decodeURIComponent((0,xi.re)("folder")):"/",i=(0,xi.re)("isShareme")||!1,a=(0,Io.pb)(),[4,yi.Wo.DBStatusPromise];case 1:return r.sent()!==yi.q7.InitFinish?[3,3]:[4,yi.Wo.getHelper().storeNewDocData(Ti.Gk.WORD,o,n,a,e,i)];case 2:return(s=r.sent()).error?(this.saveFailTips(null===(t=s.error)||void 0===t?void 0:t.message),[2,!1]):(window.App.GlobalConfig.IsSupportStore&&(c="true"===(0,xi.re)("isOnlineBorrowed"),window.mqq&&window.mqq.invoke&&window.mqq.invoke("docx","docDBOperation",{isOnlineBorrowed:c,folder:o,globalId:e.globalPadId,listTypes:[Ti.l6.listTypeOffline,Ti.l6.listTypeCreated,Ti.l6.listTypeMyDoc,Ti.l6.listTypeRecent],operation:"addDocToList"})),l=(l=location.href).replace(location.search,""),(0,jo.qA)(l,!0),[2,!0]);case 3:return this.saveFailTips("init DB fail."),[2,!1]}}))}))},e}();!function(e){e.STORE_SERVER_USER_CHANGE="storeServerUserChange"}(_i||(_i={}));var Di=function(e){function t(t){var n=e.call(this,_i.STORE_SERVER_USER_CHANGE)||this;return n.serverUserChange=t,n}return(0,r.__extends)(t,e),t}(p.Notification);function Pi(){return window.App.GlobalConfig.IsSupportStore}var Fi,Bi=function(){function e(){var e=this;this.getSaveDocPromise=function(){return e.saveDoc?e.saveDoc.getSaveDocPromise:Promise.resolve()},this.getCreateDocPromise=function(){return e.createDoc?e.createDoc.getCreateDocPromise:Promise.resolve(!0)},this.storeOfflineData=function(e){if(Pi()){var t={changeset:e.changeset,commitId:e.commitId,head:e.head,newVersion:e.newRev,revert:e.revert,subId:e.subId,data:(0,r.__assign)((0,r.__assign)({},e),{author:(0,c.Yi)().userId})},n=new Ti.TU({data:t,uid:(0,F.getUid)(),globalPadId:(0,c.Yi)().globalPadId,secretId:(0,Io.pb)(),subSheetId:e.subId,type:Ti.Nt.NEW_CHANGE,docType:Ti.Gk.WORD,taskId:e.commitId,version:e.newRev,createTime:Date.now(),dver:window.App.GlobalConfig.globalCodeVersion});yi.Wo.handleDataFromIndexDB({data:n,type:yi.nN.update,tableName:Ti.me.DOCUMENT_DATA})}}}return e.prototype.onReset=function(e){return this.init(e),!0},e.prototype.init=function(e){var t=this;this.editor=e.editor,this.saveDocReset(),this.createDocReset(),this.notifyDocumentVersionUpdated(),this.editor.removeListener(_i.STORE_SERVER_USER_CHANGE,this),this.editor.on(_i.STORE_SERVER_USER_CHANGE,(function(e){t.storeOfflineData(e.serverUserChange)}))},e.prototype.saveDocReset=function(){var e=(0,xi.re)("new"),t=(0,c.Yi)();e&&t.padStatus!==c.DL.NORMAL?this.saveDoc=new Ni:this.saveDoc=void 0},e.prototype.notifyDocumentVersionUpdated=function(){var e,t,n=(0,c.Yi)();null===(t=null===(e=window.tdocs)||void 0===e?void 0:e.mapDocumentVersion)||void 0===t||t.call(e,{dver:n.collab_client_vars.dver,url:window.location.href})},e.prototype.createDocReset=function(){var e;null===(e=this.createDoc)||void 0===e||e.dispose(),(0,c.Yi)().padStatus===c.DL.NORMAL?this.createDoc=void 0:this.createDoc=new Oi(this.getSaveDocPromise)},e}(),Ui=function(){return window.App.offlineOpenManager||(window.App.offlineOpenManager=new Bi),window.App.offlineOpenManager},Hi=n(61978);function ji(){return p.PlatformUtil.isWindowStore()?Fi.windows:p.PlatformUtil.isMac()?Fi.mac:Fi.other}function Wi(){var e;return null!==(e=window.__globalReleaseVersion)&&void 0!==e?e:""}function Vi(e){return{platform:ji(),rel_rev:Wi(),right_tag:e?1:0}}!function(e){e[e.windows=1]="windows",e[e.android=2]="android",e[e.iOS=3]="iOS",e[e.other=4]="other",e[e.mac=5]="mac"}(Fi||(Fi={}));var zi,Gi=n(81387),Yi=n(29068),qi=n(70092),Zi=n(64261),Ji="connected",Ki=function(){function e(e,t){var n=this;this.notificationCenter=e,this.clientVars=t,this.userInfoInRoomMap=new Map,this.userJoinQueue=[],this.userJoinFetchingQueue=[],this.initUserNewInfoNotices=[],this.isGuest=function(e){return!1},this.updateMemberCount=function(e,t){var r;void 0===t&&(t=0),n.memberCount=t||(null===(r=e[0])||void 0===r?void 0:r.mem_count)},this.onUserJoin=(0,p.throttle)((function(){return(0,r.__awaiter)(n,void 0,void 0,(function(){var e,t,n,o,i,a;return(0,r.__generator)(this,(function(s){switch(s.label){case 0:return this.userJoinFetchingQueue=(0,r.__spreadArray)([],(0,r.__read)(this.userJoinQueue),!1),this.userJoinQueue=[],e=this.filterFetchedUserInfos(this.userJoinFetchingQueue),[4,Yi.z.getRemark(this.clientVars,e.newUidList,!1)];case 1:return t=s.sent(),n=this.parseGetUserMarkNameResult(t),o=this.findUpdateUserInfos(n,this.userJoinFetchingQueue),i=this.filterFetchedUserInfos(this.userJoinFetchingQueue).newUserInfoMap,a=this.findJoinUserInfos(n,i),this.collabUserInfoService.updateUserInfo(a),o.length>0&&(this.updateUserInfoInRoom(o,Gi.ZK.ON_USER_INFO_UPDATE),this.notificationCenter.fire(new Gi.Bu(o))),a.length>0&&(this.updateUserInfoInRoom(a,Gi.ZK.ON_USER_JOIN),this.notificationCenter.fire(new Gi.c(a))),o.length||a.length||this.notificationCenter.fire(new Gi.c([])),this.userJoinFetchingQueue=[],[2]}}))}))}),5e3)}var t,n;return e.prototype.getInitMemberCount=function(){return this.memberCount},e.prototype.getInitUserNewInfoNotices=function(){return this.initUserNewInfoNotices},e.prototype.getUserInfo=function(e){return this.userInfoInRoomMap.get(e)},e.prototype.getUserInfos=function(){return Array.from(this.userInfoInRoomMap.values())},e.prototype.handleTobVidToUid=function(e){return(0,r.__awaiter)(this,void 0,Promise,(function(){var t;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return[2,e];case 1:return t=n.sent(),[2,e.map((function(e){var n,o,i=null===(o=null===(n=e.userId)||void 0===n?void 0:n.split("."))||void 0===o?void 0:o[1];if(i){var a=t.get(i);if(a){var s=function(e){return"0"!==e},c=s(a.uid)?a.uid:s(a.vid)?a.vid:"";if(c){var l="p.".concat(c);return(0,r.__assign)((0,r.__assign)({},e),{userId:l})}}}return e}))]}}))}))},e.prototype.handleUserNewInfo=function(e,t){return(0,r.__awaiter)(this,void 0,Promise,(function(){var n,o=this;return(0,r.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.handleTobVidToUid(e)];case 1:return e=(e=i.sent()).filter((function(e){return!o.isGuest(e.userId)})),this.initUserNewInfoNotices=e,(n=this.userJoinQueue).push.apply(n,(0,r.__spreadArray)([],(0,r.__read)(e),!1)),this.updateMemberCount(e,t),this.onUserJoin(),[2]}}))}))},e.prototype.handleUserLeave=function(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,n,o;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.handleTobVidToUid([e])];case 1:return e=r.sent()[0],t=e.userId,n=this.clientVars.userId,this.clientVars.collab_client_vars.websocket&&t===n||(this.collabUserInfoService.getLeaveUserInfos().next(e),this.updateUserInfoInRoom([e],Gi.ZK.ON_USER_LEAVE),this.notificationCenter.fire(new Gi.UD(e))),o=function(e){return e.userId!==t},this.userJoinQueue=this.userJoinQueue.filter(o),this.userJoinFetchingQueue=this.userJoinFetchingQueue.filter(o),[2]}}))}))},e.prototype.handleUserLeaves=function(e){var t=this;void 0===e&&(e=[]),e.forEach((function(e){t.handleUserLeave(e)}))},e.prototype.filterFetchedUserInfos=function(e){var t=this,n={},o=[];return e.forEach((function(e){var i=e.userId;if(!t.userInfoInRoomMap.has(i)){var a=(0,r.__read)(i.split("."),2)[1];n[a]=e,o.push(a)}})),{newUserInfoMap:n,newUidList:o}},e.prototype.parseGetUserMarkNameResult=function(e){var t=e.rsp,n={};return(void 0===t?[]:t).forEach((function(e){var t=e.reqUid,r=e.uid;n[null!=t?t:r]=e})),n},e.prototype.findUpdateUserInfos=function(e,t){var n=this,o=[],i=this.clientVars.userId,a=!!this.clientVars.collab_client_vars.websocket;return t.filter((function(e){var t=(0,r.__read)(e.userId.split("."),2)[1];return a||e.userId!==i&&t})).forEach((function(t){var i,a=t.userId,s=(0,r.__read)(t.userId.split("."),2)[1],c=e[a];if(n.isUserInfoExist(a)&&c){var l=n.userInfoInRoomMap.get(a),u={uin:s,corpName:c.corpName,name:c.markName,xid:t.xid,uuId:t.uuId,userId:t.userId,colorId:t.colorId,session_type:t.session_type,englishName:t.englishName,userPic:null!==(i=null==l?void 0:l.userPic)&&void 0!==i?i:"",status:Ji,userLink:"",vipInfo:t.vip_info};o.push(u)}})),o},e.prototype.findJoinUserInfos=function(e,t){return Object.keys(e).map((function(n){var r=e[n],o=r.corpName,i=r.markName,a=r.userPic,s=r.englishName,c=r.xid,l=t[n];return{uin:n,name:i,xid:c,corpName:o,userPic:a,englishName:s,uuId:l.uuId,userId:l.userId,colorId:l.colorId,session_type:l.session_type,status:Ji,userLink:"",vipInfo:l.vip_info}}))},e.prototype.updateUserInfoInRoom=function(e,t){var n=this;e&&e.forEach((function(e){switch(t){case Gi.ZK.ON_USER_JOIN:n.userInfoInRoomMap.has(e.userId)||e.status!==Ji||n.userInfoInRoomMap.set(e.userId,e);break;case Gi.ZK.ON_USER_INFO_UPDATE:e.status===Ji&&n.userInfoInRoomMap.set(e.userId,e);break;case Gi.ZK.ON_USER_LEAVE:n.userInfoInRoomMap.has(e.userId)&&n.userInfoInRoomMap.delete(e.userId)}}))},e.prototype.isUserInfoExist=function(e){var t=this.userInfoInRoomMap.get(e);return!!(null==t?void 0:t.name)&&!!(null==t?void 0:t.userPic)},(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==qi.E&&qi.E)?t:Object)],e.prototype,"collabUserInfoService",void 0),(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==Fe.v&&Fe.v)?n:Object)],e.prototype,"eventEmitter",void 0),e}(),Qi=n(9517),Xi=function(){function e(){}return e.prototype.zzsReport=function(e){var t;(0,i.zzsStatus)({attrid:e,status:d.Status007.FAIL,dimensions:[null===(t=(0,c.Yi)().collab_client_vars.dver)||void 0===t?void 0:t.substr(0,3)]})},e.prototype.reportToWebLog=function(e,t){["40001","60007","60015","70001","60006"].includes(e)||t&&["INACTIVE"].includes(t)||setTimeout((function(){var t,n,r=Date.now(),o=r-36e5,i="".concat("WORD_COLLAB_CENTER_DISCONNECT").concat(e.length>0?"_".concat(e):"UNKNOWN");null===(n=null===(t=window.log)||void 0===t?void 0:t.report)||void 0===n||n.call(t,i,{query:{startTs:o,endTs:r}})}),1e3)},e}(),$i=new Xi,ea=n(36094),ta=n(82173),na=function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return(e=window.App.changesetManager.getChanges().filter((function(e){return 0!==e.changeset.length}))).length?[2,e]:[4,window.App.offlineEditAdapter.getChanges()];case 1:return(t=n.sent()).length?(t.forEach((function(e){e.changeset=(0,pi.Uq)(e.changesetString)})),[2,t]):(p.Logger.error("getChanges length is zero."),[2,[]])}}))}))},ra=function(e){var t,n=0,r=0;return null===(t=e.forEach)||void 0===t||t.call(e,(function(e){var t;e.changeset&&(n+=(0,pi.Re)(e.changeset),r+=null!==(t=e.changeSetCount)&&void 0!==t?t:1)})),{charCount:n,csCount:r}};!function(e){e.GRAY_TIPS="GRAY_TIPS",e.RED_TIPS="RED_TIPS"}(zi||(zi={}));var oa=new Map([[[Fo.RoomWebsocketErrorCode.SOCKET_DATA_SAVE_FAIL,Fo.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_TIMEOUT,Fo.RoomWebsocketErrorCode.SOCKET_COLLAB_SERVER_TIMEOUT,Fo.RoomWebsocketErrorCode.SOCKET_SERVER_STORAGE_TIMEOUT,Fo.RoomWebsocketErrorCode.SOCKET_SERVER_CGI_TIMEOUT,Fo.RoomWebsocketErrorCode.SOCKET_HACKPAD_TIMEOUT,Fo.RoomWebsocketErrorCode.SOCKET_SERVER_WAITTING_TOO_LONG,Fo.RoomWebsocketErrorCode.SOCKET_SERVER_WAITTING_TIMEOUT,Fo.RoomWebsocketErrorCode.SOCKET_AUTH_TIMEOUT,Fo.RoomWebsocketErrorCode.SOCKET_GET_PRIVILEGE_TIMEOUT],{PC:(0,ii.$t)("服务器处理超时，请刷新重试。"),Mobile:(0,ii.$t)("服务器超时，请刷新重试。"),Action1:ea.S9.REFRESH,Action2:ea.S9.CONTACT,Idkey:[d.IdkeyName.SERVER_ERROR,d.IdkeyName.WEBSOCKET_ERROR]}],[[Fo.RoomWebsocketErrorCode.SOCKET_CLIENT_NOT_READY_ERROR],{PC:(0,ii.$t)("服务器连接超时，请刷新重试。"),Mobile:(0,ii.$t)("服务器超时，请刷新重试。"),Action1:ea.S9.REFRESH,Action2:ea.S9.CONTACT,Idkey:[d.IdkeyName.SERVER_ERROR,d.IdkeyName.WEBSOCKET_ERROR]}],[[ta.p.CollabRoomGetMisschangFail,ta.p.CollabRoomCommittingTimeOut,ta.p.CollabRoomCommitCSFailByCGI,ta.p.CollabRoomGetChunkFail],{PC:(0,ii.$t)("网络异常，请刷新重试。"),Action1:ea.S9.REFRESH,Idkey:[d.IdkeyName.COLLAB_ROOM_ERR]}],[[Fo.RoomWebsocketErrorCode.SOCKET_FREQUENCY_LIMIT],{PC:(0,ii.$t)("你的操作太频繁，请稍后再试。"),Action1:ea.S9.REFRESH,Duration:3e3}],[[Fo.RoomWebsocketErrorCode.SOCKET_SERVER_ERROR,Fo.RoomWebsocketErrorCode.SOCKET_LAYER_ERROR,ta.p.CollabRoomCommitCheckTimeOut],{PC:(0,ii.$t)("服务器异常，请刷新重试。"),Action1:ea.S9.REFRESH,Action2:ea.S9.CONTACT,Idkey:[d.IdkeyName.SERVER_ERROR,d.IdkeyName.WEBSOCKET_ERROR]}],[[Fo.RoomWebsocketErrorCode.SOCKET_USER_AUTH_FAILED],{PC:(0,ii.$t)("登录过期，点击刷新。"),Action1:ea.S9.RELOGIN,Idkey:[d.IdkeyName.AUTH_FAILED]}],[[Fo.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_MEMBER_FULL,Fo.RoomWebsocketErrorCode.SOCKET_COLLABROOM_NOT_VIP_FULL],{PC:(0,ii.$t)("编辑或查看人数较多，转为只能查看。"),Action1:ea.S9.BEGINEDIT}],[[40024,Fo.RoomWebsocketErrorCode.SOCKET_CLIENT_VERSION_TOO_OLD,ta.p.CollabRoomDataBaseChange],{PC:(0,ii.$t)("文档状态有更新。"),Action1:ea.S9.REFRESH}],[[40025],{PC:(0,ii.$t)("此内容因违规无法编辑。"),Action1:ea.S9.LEARNMORE}],[[ta.p.CollabRoomSwitchAccout],{PC:(0,ii.$t)("帐号信息变化，点击刷新。"),Action1:ea.S9.REFRESH}]]),ia=new Map([[[ta.p.CollabRoomDefaultErrCode,ta.p.CollabRoomCHANGESETERRORAPPLYOFFLINE,ta.p.CollabRoomChangsetErrorEasysync,ta.p.CollabRoomJQUERYREWRITEERROR,ta.p.CollabRoomGetMisschangAndFollowError,ta.p.CollabRoomDelta2CS,ta.p.CollabRoomVerify,ta.p.CollabRoomVerifyModel,ta.p.CollabRoomApplyOnline,Fo.RoomWebsocketErrorCode.SOCKET_CLIENT_DATA_ERROR,Fo.RoomWebsocketErrorCode.SOCKET_USER_CHANGE_PARAM_ERROR,Fo.RoomWebsocketErrorCode.SOCKET_COMMAND_NOT_SUPPORTED,Fo.RoomWebsocketErrorCode.SOCKET_DATA_DOC_NOT_EXIST,Fo.RoomWebsocketErrorCode.SOCKET_DATA_SUBID_ERROR,Fo.RoomWebsocketErrorCode.SOCKET_DATA_ACTION_LENGTH,40030],{LittleContent:{PC:(0,ii.$t)("文档编辑状态发生变化，点击刷新。"),Mobile:(0,ii.$t)("文档编辑状态变化，点击刷新。"),Action:[ea.S9.REFRESHANDFIX,ea.S9.CONTACT]},MuchContent:{PC:(0,ii.$t)("编辑内容暂无法保存。"),Action:[ea.S9.HOW2DEAL]},Idkey:[d.IdkeyName.COLLAB_ROOM_ERR,d.IdkeyName.WEBSOCKET_ERROR]}],[[Fo.RoomWebsocketErrorCode.SOCKET_DATA_SERVER_ERROR],{LittleContent:{PC:(0,ii.$t)("服务器异常，编辑内容暂无法保存。"),Mobile:(0,ii.$t)("编辑内容无法保存。"),Action:[ea.S9.REFRESHANDFIX,ea.S9.CONTACT]},MuchContent:{PC:(0,ii.$t)("服务器异常，编辑内容暂无法保存。"),Mobile:(0,ii.$t)("编辑内容无法保存。"),Action:[ea.S9.HOW2DEAL]},Idkey:[d.IdkeyName.SERVER_ERROR,d.IdkeyName.WEBSOCKET_ERROR]}],[[Fo.RoomWebsocketErrorCode.SOCKET_DATA_CHANGESET_EASYSYNC,Fo.RoomWebsocketErrorCode.SOCKET_DATA_READ_FAIL,Fo.RoomWebsocketErrorCode.SOCKET_DATA_BASEREV_ERROR,Fo.RoomWebsocketErrorCode.SOCKET_DATA_NOT_SUPPORTED_TYPE,Fo.RoomWebsocketErrorCode.SOCKET_DATA_NOT_SUPPORTED_PROTO,Fo.RoomWebsocketErrorCode.SOCKET_DATA_DOCID_ERROR,Fo.RoomWebsocketErrorCode.SOCKET_DATA_PROTOCOL_TYPE_ERROR,Fo.RoomWebsocketErrorCode.SOCKET_DATA_SERVER_UNKNOWN_ERROR,Fo.RoomWebsocketErrorCode.SOCKET_DATA_PROTOCOL_FIELD_LACK,ki.OFFLINE_EDIT_CODE.RESUBMIT_FAIL],{LittleContent:{PC:(0,ii.$t)("服务器异常，编辑内容暂无法保存。"),Mobile:(0,ii.$t)("服务器异常，编辑内容无法保存。"),Action:[ea.S9.REFRESHANDFIX,ea.S9.CONTACT]},MuchContent:{PC:(0,ii.$t)("服务器异常，编辑内容暂无法保存。"),Mobile:(0,ii.$t)("服务器异常，编辑内容无法保存。"),Action:[ea.S9.HOW2DEAL]},Idkey:[d.IdkeyName.SERVER_ERROR,d.IdkeyName.WEBSOCKET_ERROR]}],[[Fo.RoomWebsocketErrorCode.SOCKET_DOC_PRIVILEGE_FAILED,Fo.RoomWebsocketErrorCode.SOCKET_USER_DOC_NOPRIVILEGE],{LittleContent:{PC:(0,ii.$t)("权限发生变更无法继续编辑。"),Mobile:(0,ii.$t)("权限发生变更无法继续编辑。。"),Action:[ea.S9.REFRESHANDFIX,ea.S9.CONTACT]},MuchContent:{PC:(0,ii.$t)("权限发生变更无法继续编辑。"),Mobile:(0,ii.$t)("权限发生变更无法继续编辑。"),Action:[ea.S9.HOW2DEAL]}}],[[Fo.RoomWebsocketErrorCode.SOCKET_PACKAGE_SIZE_TOO_LARGE,Fo.RoomWebsocketErrorCode.SOCKET_DATA_CONTENT_LIMIT,Fo.RoomWebsocketErrorCode.SOCKET_DATA_EASYSYNC_TIMEOUT,ta.p.PAYLOADTOOLARGE],{LittleContent:{PC:(0,ii.$t)("本次操作内容过多，暂无法保存。"),Action:[ea.S9.REFRESHANDFIX,ea.S9.CONTACT]},MuchContent:{PC:(0,ii.$t)("本次操作内容过多，暂无法保存。"),Action:[ea.S9.HOW2DEAL]}}],[[Fo.RoomWebsocketErrorCode.COMMIT_CHANGES_CONTAIN_REVERT],{LittleContent:{PC:(0,ii.$t)("文档存在数据更新，请点击刷新。"),Action:[ea.S9.REFRESHANDFIX]},MuchContent:{PC:(0,ii.$t)("编辑内容暂无法保存。"),Action:[ea.S9.CREATEDOCCOPY,ea.S9.HOW2DEAL]}}],[[ki.OFFLINE_EDIT_CODE.RESUBMIT_FAIL],{LittleContent:{PC:(0,ii.$t)("服务器异常，编辑内容暂无法保存。"),Mobile:(0,ii.$t)("服务器异常，编辑内容无法保存。"),Action:[ea.S9.HOW2DEAL]},MuchContent:{PC:(0,ii.$t)("服务器异常，编辑内容暂无法保存。"),Mobile:(0,ii.$t)("服务器异常，编辑内容无法保存。"),Action:[ea.S9.HOW2DEAL]},Idkey:[d.IdkeyName.SERVER_ERROR,d.IdkeyName.WEBSOCKET_ERROR]}]]),aa=function(){function e(e){this.notificationCenter=e,this.maxCharLength=5,this.maxChangesetCount=2}return e.prototype.showWarnTipsNotClear=function(t,n,r){var o=!1;if(t||n){var i="",a=0,s=[];if(t&&oa.forEach((function(e,n){if(n&&n instanceof Array&&n.indexOf(t)>-1){e&&e.Mobile;var r=e&&e.PC||"";i=r,e.Action1&&s.push(e.Action1),e.Action2&&s.push(e.Action2),e.Duration&&(a=e.Duration),o=!0,i=i.replace(/.$/,"(".concat(t,")。")),e.Idkey&&d.ReportHelper.idkeyReport(e.Idkey)}})),n&&n.indexOf("INACTIVE")>-1){if(e.isINACTIVE||!r)return!0;e.isINACTIVE=!0,i=(0,ii.$t)("编辑或查看人数较多，转为只能查看。"),s.push(ea.S9.BEGINEDIT),o=!0}i&&(ei.j.info("showWarnTipsNotClear, context, ".concat(i)),this.notificationCenter.fire(new ea.w0({errDetail:n,errMsg:"".concat(i),errCode:"".concat(t),action:s,duration:a||void 0})))}var c=window.App.changesetManager.getUncommitedInfo();return d.ReportHelper.tdwReport({opername:"doc_core",module:"data_lost",action:"show_tips",ver5:n&&n.indexOf("INACTIVE")>-1?72100:t||72005,ver6:c.charCount,ver7:c.csCount,ver8:"warntips"}),o&&$i.zzsReport(zi.GRAY_TIPS),o},e.prototype.getErrorMsg=function(e,t,n){var o="",i=[],a=[];return e&&ia.forEach((function(s,c){if(c&&c instanceof Array&&c.indexOf(e)>-1){var l=t?s.MuchContent:s.LittleContent,u=(l&&l.Mobile,l&&l.PC||"");o=(o=u).replace(/.$/,"(".concat(null!=n?n:e,")。")),l&&l.Action&&(i=i.concat(l.Action)),s.Idkey&&a.push.apply(a,(0,r.__spreadArray)([],(0,r.__read)(s.Idkey),!1))}})),{msg:o,action:i,idkeys:a}},e.prototype.showErrorTips=function(e,t,n){return void 0===n&&(n=!1),(0,r.__awaiter)(this,void 0,void 0,(function(){var o,i,a,s,c,l,u,p,f,_;return(0,r.__generator)(this,(function(h){switch(h.label){case 0:return o=[ta.p.CollabRoomShutDownNotOpen],e&&o.includes(e)?[2]:(i=e||ta.p.CollabRoomDefaultErrCode,a="",s=0,c=[],l=[],[4,(m=n,void 0===m&&(m=!1),(0,r.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return(e=window.App.changesetManager.getUncommitedInfo()).charCount>0||e.csCount?[2,e]:m?[4,na()]:[3,2];case 1:return t=n.sent(),[2,ra(t)];case 2:return[2,e]}}))})))]);case 1:return u=h.sent(),p=!(u.charCount<=this.maxCharLength&&u.csCount<=this.maxChangesetCount),f=this.getErrorMsg(i,p),a=f.msg,c=f.action,l=f.idkeys,a||(_=this.getErrorMsg(ta.p.CollabRoomDefaultErrCode,p,i),a=_.msg,c=_.action,l=_.idkeys),a&&(this.notificationCenter.fire(new ea.w0({errDetail:t,errMsg:"".concat(a),errCode:"".concat(i),action:c,duration:s||void 0})),u.charCount<=10&&d.ReportHelper.monitor(d.MonitorName.DATA_PRODUCE_LITTLE_UNCOMMIT),d.ReportHelper.monitor(d.MonitorName.DATA_PRODUCE_ERROR_TIPS),d.ReportHelper.tdwReport({opername:"doc_core",module:"data_lost",action:"show_tips",ver5:t&&t.indexOf("INACTIVE")>-1?72100:e||72005,ver6:u.charCount,ver7:u.csCount}),d.ReportHelper.idkeyReport(l),$i.zzsReport(zi.RED_TIPS)),[2]}var m}))}))},e.prototype.showTips=function(e,t,n){ei.j.info("showTips, code:".concat(e,", reason:").concat(t,", canEdit:").concat(n)),this.showWarnTipsNotClear(e,t,n)||this.showErrorTips(e,t),$i.reportToWebLog("".concat(e),"".concat(t))},e.isINACTIVE=!1,e}(),sa=n(31602),ca=n(97293);function la(e){var t=e.index,n=e.period,r=e.subscriber;if(r.next(t),!r.closed){if(-1===n)return r.complete();e.index=t+1,this.schedule(e,n)}}var ua,da=n(22290),pa=function(){function e(e){var t=this;this.options=e,this.tag="ConnectionRecoverHelper",this.visibleObservable=new bn.y((function(e){var n=function(){return"visible"===document.visibilityState};t.nextVisible=function(){return e.next(n())},window.addEventListener("visibilitychange",(function(){e.next(n())})),document.addEventListener("click",(function(){e.next(!0)})),window.addEventListener("pagehide",(function(){e.next(!1)})),window.addEventListener("pageshow",(function(){e.next(!0)}))}))}return e.prototype.tryRecover=function(e,t){var n,o,i=this,a=function(n){var o;if(n.codes.indexOf(e)>=0)return s.observable?(p.Logger.info(s.tag,"retry conflict code: ".concat(e)),s.clean(),t(),{value:void 0}):(s.observable=s.visibleObservable.pipe((0,Bn.x)()).subscribe((function(a){var s,c,l=void 0===o;if(o=a,a){var u=!l||n.retryImmeOnFirstVisible;p.Logger.info(i.tag,"document visible, startRetry"),null===(s=i.cleanupRetry)||void 0===s||s.call(i),i.cleanupRetry=i.startRetry(e,(0,r.__assign)((0,r.__assign)({},n),{retryImme:u}),t)}else p.Logger.info(i.tag,"document invisible, cleanupRetry"),null===(c=i.cleanupRetry)||void 0===c||c.call(i)})),s.nextVisible(),{value:void 0})},s=this;try{for(var c=(0,r.__values)(this.options),l=c.next();!l.done;l=c.next()){var u=a(l.value);if("object"==typeof u)return u.value}}catch(e){n={error:e}}finally{try{l&&!l.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}t()},e.prototype.startRetry=function(e,t,n){var r=this,o=t.retry,i=t.retryLimit,a=t.retryInterval,s=function(e,t,n){void 0===e&&(e=0);var r=-1;return An(t)?r=Number(t)<1?1:Number(t):(0,ca.K)(t)&&(n=t),(0,ca.K)(n)||(n=sa.P),new bn.y((function(t){var o=An(e)?e:+e-n.now();return n.schedule(la,o,{index:0,period:r,subscriber:t})}))}(t.retryImme?0:a,a).pipe((0,da.q)(i)).subscribe((function(t){p.Logger.info(r.tag,"startRetry, count".concat(t,", retryLimit: ").concat(i)),o(e).then((function(){p.Logger.info(r.tag,"retry success, count: ".concat(t)),r.clean()})).catch((function(){p.Logger.info(r.tag,"retry failed, count: ".concat(t)),t===i-1&&(p.Logger.info(r.tag,"retry failed and fallback"),r.clean(),n())}))}));return function(){s.unsubscribe()}},e.prototype.clean=function(){var e,t;p.Logger.info(this.tag,"clean recovery"),null===(e=this.observable)||void 0===e||e.unsubscribe(),this.observable=void 0,null===(t=this.cleanupRetry)||void 0===t||t.call(this)},e}(),fa=[li.RoomWebsocketErrorCode.SOCKET_USER_AUTH_FAILED,li.RoomWebsocketErrorCode.SOCKET_AUTH_TIMEOUT],_a=[li.RoomWebsocketErrorCode.SOCKET_SERVER_ERROR,li.RoomWebsocketErrorCode.SOCKET_LAYER_ERROR,li.RoomWebsocketErrorCode.SOCKET_COLLAB_SERVER_TIMEOUT,li.RoomWebsocketErrorCode.SOCKET_DOC_PRIVILEGE_FAILED,li.RoomWebsocketErrorCode.SOCKET_SERVER_STORAGE_TIMEOUT,li.RoomWebsocketErrorCode.SOCKET_SERVER_CGI_TIMEOUT,li.RoomWebsocketErrorCode.SOCKET_FREQUENCY_LIMIT],ha=function(){function e(e){var t,n=this;this.context=e,this.isConnectOnce=!1;var o=e.notificationCenter;this.showTipsManager=new aa(o),this.recoverHelper=new pa((0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)((null===(t=window.tdocs)||void 0===t?void 0:t.docLogin)?[{codes:fa,retry:function(e){return n.weworkRenewTicket(e)},retryLimit:1,retryInterval:Fo.DEFAULT_SEND_MESSAGE_TIMEOUT,retryImmeOnFirstVisible:!0}]:[]),!1),[{codes:[li.RoomWebsocketErrorCode.SOCKET_SERVER_ERROR,li.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_TIMEOUT,li.RoomWebsocketErrorCode.SOCKET_CLIENT_NOT_READY_ERROR,li.RoomWebsocketErrorCode.SOCKET_DOC_PRIVILEGE_FAILED,li.RoomErrorCode.ROOM_CLOSE],retry:function(){return(0,r.__awaiter)(n,void 0,void 0,(function(){var e=this;return(0,r.__generator)(this,(function(t){return[2,new Promise((function(t,n){e.reconnect(),e.context.collabCenterAdapter.isConnected?t(!0):setTimeout((function(){e.context.collabCenterAdapter.isConnected?t(!0):n()}),5e3)}))]}))}))},retryLimit:1,retryInterval:Fo.DEFAULT_SEND_MESSAGE_TIMEOUT,retryImmeOnFirstVisible:!1}],!1))}return e.prototype.handleConnect=function(){ei.j.info(ei.w.Collab,"network connect success."),this.isConnectOnce||(this.isConnectOnce=!0,d.ReportHelper.monitor007Status(d.MonitorName.SOCKET_FAILED_IN_90S,d.Status007.SUCCESS)),this.isTicketRenewed&&(Qi.VF.renewSuccess(location.href),this.isTicketRenewed=!1)},e.prototype.handleClose=function(e){var t=e.reason,n=t.reason,r=void 0===n?"":n,o=t.errCode,i=void 0===o?0:o;ei.j.info(ei.w.Collab,"connection closed, errorCode = ".concat(i,", reason = ").concat(r)),_a.includes(i)&&this.showTipsManager.showErrorTips(i,r)},e.prototype.handleShutdown=function(e){var t=this,n=e.reason,r=n.errCode,o=void 0===r?0:r,i=n.reason;ei.j.info(ei.w.Collab,"connection shutdown, errorCode = ".concat(o,", reason = ").concat(i)),d.ReportHelper.monitor007Status(d.MonitorName.SOCKET_SHUTDOWN,d.Status007.FAIL,i,{errorCode:o}),[ta.p.CollabRoomShutDownNotOpen,li.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_MEMBER_FULL,li.RoomWebsocketErrorCode.SOCKET_COLLABROOM_NOT_VIP_FULL,li.RoomWebsocketErrorCode.COMMIT_CHANGES_CONTAIN_REVERT].includes(o)||this.recoverHelper.tryRecover(o,(function(){t.context.canEdit()&&t.showTipsManager.showTips(o,i,t.context.canEdit()),t.notifyClearOfflineData(o),t.reportWebsocketError(o)}))},e.prototype.handleReconnectFail=function(){ei.j.info(ei.w.Collab,"connection reconnect fail!")},e.prototype.handleStateChange=function(e){var t=e.status,n=e.moreInfo;ei.j.info(ei.w.Collab,"connection state change:".concat(t," description:").concat(JSON.stringify(n)))},e.prototype.weworkRenewTicket=function(e){return(0,r.__awaiter)(this,void 0,Promise,(function(){var t;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:if(!Qi.VF.renewTicket(location.href))return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,Qi.VF.awaitLoginTicket(location.href)];case 2:return n.sent(),this.reconnect(),this.isTicketRenewed=!0,[3,4];case 3:throw t=n.sent(),ei.j.error(ei.w.Collab,"renew ticket error, detail: ".concat(t)),t;case 4:return[3,6];case 5:throw ei.j.error(ei.w.Collab,"renew ticket error reach max try"),new Error("".concat(e));case 6:return[2]}}))}))},e.prototype.reconnect=function(){ei.j.error(ei.w.Collab,"reconnect after renew ticker."),this.context.collabCenterAdapter.reconnect()},e.prototype.notifyClearOfflineData=function(e){if(li.RoomWebsocketErrorCode.SOCKET_DATA_DOC_NOT_EXIST===e){var t=new CustomEvent("CustomEvent");t.initCustomEvent("Melo_ClearOfflineData",!0,!0,{code:e}),document.dispatchEvent(t)}},e.prototype.reportWebsocketError=function(e){if(li.RoomWebsocketErrorCode.SOCKET_USER_AUTH_FAILED===e){var t=new Error("login error! cookie:".concat(document.cookie));d.ReportHelper.captureException(d.MonitorName.ACTIVE_REPORT_ERROR,{},t)}d.ReportHelper.idkeyReport(d.IdkeyName.WEBSOCKET_ERROR)},e}();!function(e){e.ON_DELTA_GCP_CHANGE="onDeltaGcpChange"}(ua||(ua={}));var ma,ga,va=function(e){function t(t){var n=e.call(this,ua.ON_DELTA_GCP_CHANGE)||this;return n.rev=t,n}return(0,r.__extends)(t,e),t}(p.Notification),ba=1e3,ya=function(){function e(){this.revStart=0,this.revEnd=0,this.store=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.save=function(e,t){if(!this.store.has(e))if(this.getRevs().length){if(e!==this.revStart-1&&e!==this.revEnd+1)return void console.error("Δgcp区间跳跃,不允许存入",e,t,this.store);e>this.revEnd?this.revEnd=e:this.revStart=e,this.store.set(e,[])}else this.revStart=e,this.revEnd=e,this.store.set(e,[]);var n=this.store.get(e),r=(0,vi.Mu)(t);p.Logger.debug("[collab-caret]Δgcp save",e,r),r.forEach((function(e){return n.push(e)})),this.store.set(e,n),d.GlobalContext.fire(new va(e)),this.slide()},e.prototype.deleteBeforeSave=function(e){this.store.has(e)&&this.store.set(e,[])},e.prototype.getDeltaGcpStore=function(){return this.store},e.prototype.hasRev=function(e){var t;return!!(null===(t=this.store.get(e))||void 0===t?void 0:t.length)},e.prototype.getRevs=function(){return(0,r.__spreadArray)([],(0,r.__read)(this.store.keys()),!1)},e.prototype.slide=function(){var e=this;if(this.revEnd-this.revStart>ba){var t=this.revEnd-ba,n=this.getRevs().filter((function(e){return e<t}));n.length&&(n.forEach((function(t){e.store.delete(t)})),this.revStart=t)}},e}(),wa=function(){function e(){this.cache=new Map}return e.prototype.clear=function(){this.cache.clear()},e.prototype.save=function(e){var t=e.baseRev,n=e.userId,r=e.gcp;this.cache.has(t)||this.cache.set(t,{});var o=this.cache.get(t);o[n]?o[n].gcp=r:o[n]={gcp:r}},e.prototype.deleteRev=function(e){this.cache.has(e)&&this.cache.delete(e)},e.prototype.createCursorMsgsInRev=function(e){var t,n;if(!this.cache.has(e))return[];var o=[],i=this.cache.get(e);try{for(var a=(0,r.__values)(Object.entries(i)),s=a.next();!s.done;s=a.next()){var c=(0,r.__read)(s.value,2),l=c[0],u=c[1].gcp;o.push({baseRev:e,userId:l,gcp:u})}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return o},e}(),Ea=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.consume=function(e,t,n){var o=e-1;if(this.cache.has(o)){var i=this.createCursorMsgsInRev(o),a=t.get(e);if(!a)return;i.forEach((function(e){var t=(0,r.__assign)({},e),o=(0,vi.ZN)(e.gcp,a);t.gcp=o,t.baseRev+=1,n(t)})),this.deleteRev(o)}},t}(wa),Ca=n(82274),Ta=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.getRevs=function(){return(0,r.__spreadArray)([],(0,r.__read)(this.cache.keys()),!1).map(Number)},t.prototype.consume=function(e,t,n){var o=this;if(this.getRevs().sort((function(e,t){return e-t})).forEach((function(i){var a=i+1,s=t.get(a);(null==s?void 0:s.length)&&(o.createCursorMsgsInRev(i).forEach((function(t){p.Logger.debug("[collab-caret]deltaGcp冲突前",t);var i=(0,r.__assign)({},t),a=(0,vi.ZN)(t.gcp,s);i.gcp=a,i.baseRev+=1,p.Logger.debug("[collab-caret]deltaGcp冲突后",i),o.canDeliverNow(i.baseRev,e)?n(i):o.combine(i)})),o.deleteRev(i))})),this.cache.size){if((0,Ca.Z)(this.preCache,this.cache))return;p.Logger.debug("[collab-caret]连续合并",this.cache),this.preCache=new Map(this.cache),this.consume(e,t,n)}},t.prototype.combine=function(e){var t,n=e.baseRev,r=e.userId;this.cache.has(n)&&(null===(t=this.cache.get(n))||void 0===t?void 0:t[r])||this.save(e)},t.prototype.canDeliverNow=function(e,t){return e===t},t}(wa),xa=function(){function e(){var e=this;this.lowVersionCache=Ta.getInstance(),this.highVersionCache=Ea.getInstance(),this.deltaGCP=ya.getInstance(),d.GlobalContext.on(ua.ON_DELTA_GCP_CHANGE,(function(t){var n=t.rev;e.consume({curRev:window.App.collabCenterAdapter.getVersion(),rev:n})}))}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addConsumeCursorMsgCallBack=function(e){this.consumeCallback=e},e.prototype.onVersionChange=function(e){p.Logger.debug("[collab-caret]onVersionChange",e,this.deltaGCP.getDeltaGcpStore());var t=this.deltaGCP.getDeltaGcpStore();this.highVersionCache.consume(e,t,this.consumeCallback)},e.prototype.pullLowerVersionMissChangeAndSave=function(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,o,i,a=this;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return t>e?[2]:(n=Math.max(0,e-50),o=e,p.Logger.debug("[collab-caret]低版本触发补拉",n,o),d.ReportHelper.tdwReport({opername:"doc_word_editor",module:"collab-caret",action:"pull_low_version_misschanges",ver5:"[".concat(n,"-").concat(o,"]")}),[4,window.App.collabCenterAdapter.getMissChanges(n,o).catch((function(e){return console.error("pullLowerVersionMissChangeAndSave error, error=",e),Promise.reject(e)}))]);case 1:return i=r.sent(),p.Logger.debug("[collab-caret]changeList",i),i.map((function(e){return e.data})).sort((function(e,t){return t.newRev-e.newRev})).forEach((function(e){var t=e.newRev,n=e.changeset||e.commands;a.deltaGCP.deleteBeforeSave(t);var r=(0,vi.xs)(n);r&&a.deltaGCP.save(t,r)})),this.isNeedPull(t)&&this.pullLowerVersionMissChangeAndSave(n,t),[2]}}))}))},e.prototype.isNeedPull=function(e){return!this.deltaGCP.getRevs().length||e<this.deltaGCP.revStart},e.prototype.consume=function(e){var t=this.deltaGCP.getDeltaGcpStore(),n=e.curRev,r=e.rev;this.lowVersionCache.consume(n,t,this.consumeCallback),this.highVersionCache.consume(r,t,this.consumeCallback)},e}();!function(e){e.NOT_NEED_TO_CREATE="NOT_NEED_TO_CREATE",e.CREATE_NEW_DOC_ERROR="CREATE_NEW_DOC_ERROR",e.COMMIT_CHANGE_ERROR="COMMIT_CHANGE_ERROR",e.DATABASE_ERROR="DATABASE_ERROR"}(ma||(ma={})),function(e){e.RECEIVE_REVRET_MESSAGE="RECEIVE_REVRET_MESSAGE",e.SERVER_CHANGES_CONTAIN_REVERT="SERVER_CHANGES_CONTAIN_REVERT",e.COMMIT_CHANGES_CONTAIN_REVERT_WS="COMMIT_CHANGES_CONTAIN_REVERT_WS",e.COMMIT_CHANGES_CONTAIN_REVERT_CGI="COMMIT_CHANGES_CONTAIN_REVERT_CGI"}(ga||(ga={}));var Sa,Ia=function(){function e(e){this.context=e,this.collabCursorDeltaGcpManager=xa.getInstance(),this.showTipsManager=new aa(e.notificationCenter)}return e.prototype.handleCommitFail=function(e){var t,n=Number(e.errorCode);if([li.RoomWebsocketErrorCode.SOCKET_DOC_PRIVILEGE_FAILED,li.RoomWebsocketErrorCode.SOCKET_USER_DOC_NOPRIVILEGE].includes(n)&&this.showTipsManager.showTips(n),n===li.RoomWebsocketErrorCode.COMMIT_CHANGES_CONTAIN_REVERT){var r=new CustomEvent(bi.R0,{detail:{version:this.context.collabCenterAdapter.getVersion()}});document.dispatchEvent(r),$i.zzsReport(ga.COMMIT_CHANGES_CONTAIN_REVERT_WS)}this.reportCommitError(e),p.Logger.info(ei.w.Collab,"handle commit fail, cmd: ".concat(e.cmd,", errorCode: ").concat(n,", taskId: ").concat(null===(t=e.result)||void 0===t?void 0:t.taskId))},e.prototype.handleCommitSuccess=function(e){var t,n=e.data.changeset||e.data.commands,o=(0,vi.xs)(n);if(o&&this.collabCursorDeltaGcpManager.deltaGCP.save(e.newVersion,o),window.App.changesetManager.applyPreparedChangesetToBase(e.data),Pi()){var i=e.newVersion,a=e.data,s={newVersion:i,revert:!1,head:a.head,subId:a.subId,commitId:a.taskId,changeset:a.changeset,data:(0,r.__assign)((0,r.__assign)({},a),{author:this.context.clientVars.userId})},c=new Ti.TU({data:s,uid:(0,F.getUid)(),version:i,secretId:(0,Io.pb)(),docType:Ti.Gk.WORD,taskId:a.taskId,subSheetId:a.subId,type:Ti.Nt.ACCEPTED,globalPadId:this.context.clientVars.globalPadId,createTime:null!==(t=a.time)&&void 0!==t?t:Date.now(),dver:window.App.GlobalConfig.globalCodeVersion});yi.Wo.handleDataFromIndexDB({data:c,type:yi.nN.update,tableName:Ti.me.DOCUMENT_DATA})}},e.prototype.reportCommitError=function(e){for(var t=Number(e.errorCode),n=e.commitingQueue.length,r=0;r<n;r++)d.ReportHelper.monitor(d.MonitorName.DATA_PRODUCE_ERROR_BACK),d.ReportHelper.monitor007Status(d.MonitorName.DATA_PRODUCE_ERROR_BACK_3_0);d.ReportHelper.tdwReport({opername:"doc_word_melo",module:"data_lost",action:"exp_tip",ver5:"1",ver6:"1",ver7:0,obj3:n}),d.ReportHelper.captureChangesetException(n<10?d.MonitorName.CHANGESET_ERROR_COMMIT:d.MonitorName.CHANGESET_ERROR_COMMIT_SPIKE,{option:{}},new Error("code:".concat(t,",count:").concat(n)))},e}(),ka=n(81222),Ra=n(51014);!function(e){e.DELETE_OFFLINE_DATA="deleteOfflineData"}(Sa||(Sa={}));var Aa,Oa=function(e){function t(){return e.call(this,Sa.DELETE_OFFLINE_DATA)||this}return(0,r.__extends)(t,e),t}(p.Notification),La=n(45155),Ma=n(10804),Na=n(4849);!function(e){e[e.privilegeAttribute=1]="privilegeAttribute",e[e.title=2]="title"}(Aa||(Aa={}));var Da,Pa="//".concat(window.location.hostname,"/cgi-go/padinfo/getpadinfo");!function(e){e.wx="wx",e.qq="qq"}(Da||(Da={}));var Fa,Ba=function(){function e(e){this.context=e,this.showTipsManager=new aa(e.notificationCenter),this.cursorNoticeBeforeLoadCache=new Map,this.isEditFeatureLoaded=!1,this.addCollabCursorLoadedListener(),this.initCollabCursorConflictHandler()}var t,n;return e.prototype.addCollabCursorLoadedListener=function(){var e,t=this,n=null===(e=window.pad)||void 0===e?void 0:e.editor;n&&(this.gcpManager=n.state.dataEngine.createGCPClass(!0,!1,d.PosPolicy.Inner),n.once(Gi.JI.FEATURE_LOAD_FINISH,(function(){t.isEditFeatureLoaded=!0,t.cursorNoticeBeforeLoadCache.size&&((0,r.__spreadArray)([],(0,r.__read)(t.cursorNoticeBeforeLoadCache.values()),!1).forEach((function(e){var n=e.userId,r=e.baseRev;t.context.notificationCenter.fire(new Gi.pm([{userId:n,gcp:t.gcpManager.getGCP(n),baseRev:r}]))})),t.cursorNoticeBeforeLoadCache.clear())})))},e.prototype.initCollabCursorConflictHandler=function(){var e=this;this.collabCursorDeltaGcpManager=xa.getInstance(),this.consumeCursorMsgCallback=function(t){var n=window.App.changesetManager.beforeApplyCursorMsg([t]);p.Logger.debug("[collab-caret]应用光标消息",n[0]),e.context.notificationCenter.fire(new Gi.pm(n))},this.collabCursorDeltaGcpManager.addConsumeCursorMsgCallBack(this.consumeCursorMsgCallback)},e.prototype.handleReceiveMessage=function(e){var t,n=this,o=e.type,i=e.data,a=this.context.collabCenterAdapter.userInfoManager,s=(0,r.__read)(i,1)[0],c={USER_LEAVE:function(e){return a.handleUserLeave(e.body.notice)},USER_LEAVES:function(e){return a.handleUserLeaves(e.body.notices)},USER_NEWINFO:function(e){return a.handleUserNewInfo([e.body.notice],e.body.mem_count)},USER_NEWINFOS:function(e){return a.handleUserNewInfo(e.body.notices,e.body.mem_count)},RIGHT_MESSAGE:function(){return n.handleRightChange()},REVERT_MESSAGE:function(){return n.handleRevertMessage()},CURSOR_MESSAGE:function(e){var t;return n.handleCursorMessage([null===(t=e.body)||void 0===t?void 0:t.notice])},CURSOR_MESSAGES:function(e){var t;return n.handleCursorMessage(null===(t=e.body)||void 0===t?void 0:t.notices)},COMM_NOTICE:function(e){return n.handleCommonMessage(e)},CODEREV_NEW:function(e){return n.handleCodeVersionChange(e)},HANDLE_DELETE:function(e){return n.handleDeleteDocument(e)},LIVE_MESSAGE:function(e){return n.handleLiveMessage(e)},MARK_MESSAGE:function(e){return n.handleMarkMessage(o,e)},PRESENT_INFO:function(e){return n.handlePresentationInfo(e)},TITLE_MESSAGE:function(e){return n.handleTitleMessage(e)},COMMERCIALIZE_MESSAGE:function(e){return n.handleCommercializeMessage(e)}};null===(t=c[o])||void 0===t||t.call(c,s)},e.prototype.handleRightChange=function(){p.Logger.info(ei.w.Collab,"通道接到权限变更的推送。"),4&this.context.clientVars.rightFlag||this.updatePrivilege(),this.context.notificationCenter.fire(new ka.w),this.context.notificationCenter.fire(new Oa)},e.prototype.getDiffPrivilege=function(e){var t=this.context.clientVars.privilegeAttribute,n=e,r=function(e,t){return p.Logger.info("computeDiffPrivilege, old: ".concat(JSON.stringify(e),", new: ").concat(JSON.stringify(t))),Object.keys(t).reduce((function(n,r){return void 0!==e[r]&&void 0!==t[r]&&("object"==typeof e[r]||"object"==typeof t[r]?(0,d.deepEqual)(e[r],t[r])||n.push(r):e[r]!==t[r]&&n.push(r)),n}),[])}(t,n);return p.Logger.info("权限比对结果: oldPrivilege = ",t,"newPrivilege = ",n,"diffPrivilege = ",r),r},e.prototype.handleHasPrivilegeChange=function(e){var t={},n=e.docx_attribute;Object.keys(n).forEach((function(e){t["".concat(e)]=Number(n["".concat(e)])}));var o=(0,r.__assign)((0,r.__assign)({},e),t),i=this.getDiffPrivilege(o);i.length&&(this.context.clientVars.privilegeAttribute=o,window.clientVars&&(window.clientVars.privilegeAttribute=(0,r.__assign)((0,r.__assign)({},window.clientVars.privilegeAttribute),o)),d.GlobalContext.fire(new Ra.Tf(o,i)))},e.prototype.handleNoPrivilegeChange=function(e){var t,n,r,o;this.context.collabCenterAdapter.disconnect(null!==(n=null===(t=e.result)||void 0===t?void 0:t.errMsg)&&void 0!==n?n:"privilege change",null===(r=e.result)||void 0===r?void 0:r.errCode),this.showTipsManager.showTips(null===(o=e.result)||void 0===o?void 0:o.errCode)},e.prototype.updatePrivilege=function(){var e=this;this.context.collabCenterAdapter.sendMessage(Fo.Command.GET_PRIVILEGE).then((function(t){var n,r,o,i=t.result;0===i.errCode&&0===(null===(r=null===(n=i.response)||void 0===n?void 0:n.onpost)||void 0===r?void 0:r.result)&&(null===(o=i.response.onpost)||void 0===o?void 0:o.privilege_attribute)&&e.handleHasPrivilegeChange(i.response.onpost.privilege_attribute)})).catch((function(t){var n,o;ei.j.warn(ei.w.Collab,"".concat(Fo.Command.GET_PRIVILEGE,", errCode:").concat(null===(n=t.result)||void 0===n?void 0:n.errCode)),(o=(0,Io.pb)(),(0,r.__awaiter)(void 0,void 0,Promise,(function(){return(0,r.__generator)(this,(function(e){return[2,new Promise((function(e,t){o!==Ho.Lf&&o||t(new Error("PrivilegeAttributeService secretId:".concat(o," is invalid.")));var n="&infoKeys=[".concat([Aa.privilegeAttribute,Aa.title],"]"),r="".concat(Pa,"?encodePadId=").concat(o).concat(n,"&xsrf=").concat((0,d.getXsrf)());p.Logger.info("请求 /cgi-go/padinfo/getpadinfo 接口"),$.get(r).done((function(n){p.Logger.info("/cgi-go/padinfo/getpadinfo 接口返回：",n);try{if(0===n.retcode){var r=n.data.privilegeAttribute;e(r)}t(new Error("PrivilegeAttributeService response.retcode:".concat(null==n?void 0:n.retcode," is invalid.")))}catch(e){t(e)}})).fail((function(e){return t(e)}))}))]}))}))).then((function(t){e.handleHasPrivilegeChange(t)})).catch((function(){e.handleNoPrivilegeChange(t)}))}))},e.prototype.handleRevertMessage=function(){return(0,r.__awaiter)(this,void 0,Promise,(function(){var e;return(0,r.__generator)(this,(function(t){return this.stateManager.get(Na.SN)||(e=new CustomEvent(bi.R0,{detail:{version:this.context.collabCenterAdapter.getVersion()}}),document.dispatchEvent(e),this.context.collabCenterAdapter.disconnect("revert message",Fo.RoomWebsocketErrorCode.COMMIT_CHANGES_CONTAIN_REVERT),$i.zzsReport(ga.RECEIVE_REVRET_MESSAGE)),[2]}))}))},e.prototype.handleCursorMessage=function(e){var t=this;e.length&&(this.isEditFeatureLoaded?this.handleCursorMsgWithVersion(e):e.forEach((function(e){var n=e.userId,r=e.gcp;t.cursorNoticeBeforeLoadCache.set(n,e),t.gcpManager&&(t.gcpManager.containGCP(n)&&t.gcpManager.deleteGCP(n),t.gcpManager.insertGCP(n,r))})))},e.prototype.handleCursorMsgWithVersion=function(e){var t=this;p.Logger.debug("[collab-caret]收到光标消息",e[0]);var n=this.context.collabCenterAdapter.getVersion();e.forEach((function(e){var r=e.baseRev,o=r+1;if(r)if(r<n&&n-r<=950){if(t.collabCursorDeltaGcpManager.lowVersionCache.save(e),t.collabCursorDeltaGcpManager.deltaGCP.hasRev(o))return void t.collabCursorDeltaGcpManager.lowVersionCache.consume(n,t.collabCursorDeltaGcpManager.deltaGCP.getDeltaGcpStore(),t.consumeCursorMsgCallback);t.collabCursorDeltaGcpManager.isNeedPull(o)&&t.collabCursorDeltaGcpManager.pullLowerVersionMissChangeAndSave(n,o)}else r>n?t.collabCursorDeltaGcpManager.highVersionCache.save(e):t.consumeCursorMsgCallback(e);else t.context.notificationCenter.fire(new Gi.pm([e]))}))},e.prototype.handleCodeVersionChange=function(e){var t,n=null!==(t=window.App.GlobalConfig.globalCodeVersion)&&void 0!==t?t:"";ei.j.error(ei.w.Collab,"handle code version change event, current dver: ".concat(n));var r=!1,o=e.body.notice,i=o.dver,a=o.gray,s=o.code_ver;i&&i!==n?(this.notifyOfflineCodeVersion(i),r=!0):a===window._grayVersion&&s===this.context.clientVars.collab_client_vars.pver&&a===this.context.clientVars.collab_client_vars.gray||(r=!0),r&&(this.context.collabCenterAdapter.disconnect("CodeVerChange"),this.context.notificationCenter.fire(new ea.w0({errMsg:(0,ii.$t)("文档状态有更新，请刷新重试。"),errCode:"",action:[ea.S9.REFRESH,ea.S9.CONTACT]})))},e.prototype.notifyOfflineCodeVersion=function(e){var t,n,r;if(Pi()){var o=(0,Io.pb)();null===(r=null===(n=window.mqq)||void 0===n?void 0:n.invoke)||void 0===r||r.call(n,"docx","notifyOfflineCodeVersion",{ver_map:(t={},t[o]=e,t)})}},e.prototype.handleTitleMessage=function(e){this.context.notificationCenter.fire(new Gi.V_(e.body.notice.title,e.body.notice.client_cookie))},e.prototype.handleDeleteDocument=function(e){var t=this.context.collabCenterAdapter,n=t.isRecovering,r=t.isDeleting;ei.j.warn(ei.w.Collab,"handle delete document, data:".concat(JSON.stringify(e)," isRecovering:").concat(n," isDeleting: ").concat(r)),n||r||window.multiAccountUtil.reload()},e.prototype.handleCommonMessage=function(e){var t,n,r=e.body.notice;if("push_message"===r.type){try{var o=JSON.parse(r.message);if(!o)return;if("unbind"!==o.type)return;var i=(0,F.getLoginType)();i||ei.j.warn(ei.w.Collab,"handleMessageFromServer unbind utype is null!");var a=o.unbind;if(a===Da.wx){if(ei.j.warn(ei.w.Collab,"handleMessageFromServer unbind wx"),i===Da.wx)return void this.context.collabCenterAdapter.disconnect("TX-LOGIN-PSKEY-EXPIRED");ei.j.warn(ei.w.Collab,"handleMessageFromServer unbind wx push not for wx")}else if(a===Da.qq){if(ei.j.warn(ei.w.Collab,"handleMessageFromServer unbind qq"),i===Da.qq)return;ei.j.warn(ei.w.Collab,"handleMessageFromServer unbind qq push not for qq")}}catch(e){ei.j.error(ei.w.Collab,"error: ".concat(null==e?void 0:e.message," notice:").concat(r.message)),ei.j.report("Word_Melo_COMM_NOTICE_Error")}this.context.notificationCenter.fire(new Ra.ac(null===(n=e.body)||void 0===n?void 0:n.notice))}else this.context.notificationCenter.fire(new Ra.ac(null===(t=e.body)||void 0===t?void 0:t.notice))},e.prototype.handleMarkMessage=function(e,t){this.context.notificationCenter.fire(new Gi.T9({type:e,watermark:t.body.notice.watermark}))},e.prototype.handleLiveMessage=function(e){this.context.notificationCenter.fire(new Gi.tR(e))},e.prototype.handlePresentationInfo=function(e){var t=this,n=e.body.notice,o=n.syncDataList,i=n.bizid,a=n.hostInfo;o&&a&&o.forEach((function(e){(0,La.ym)(e)?t.context.notificationCenter.fire(new Gi.ir((0,r.__assign)((0,r.__assign)({},e),{bizid:i,hostInfo:a}))):(0,La.lF)(e)?t.context.notificationCenter.fire(new Gi.z$((0,r.__assign)((0,r.__assign)({},e),{bizid:i,hostInfo:a}))):(0,La.F4)(e)?t.context.notificationCenter.fire(new Gi.JL((0,r.__assign)((0,r.__assign)({},e),{bizid:i,hostInfo:a}))):(0,La.p_)(e)&&t.context.notificationCenter.fire(new Gi.OP((0,r.__assign)((0,r.__assign)({},e),{bizid:i,hostInfo:a})))}))},e.prototype.handleCommercializeMessage=function(e){var t=e.body.notice,n=t.type,r=t.payload;"docBackground"===n&&this.context.notificationCenter.fire(new Ma.v(r.background_id,r.transparency))},(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==qi.E&&qi.E)?t:Object)],e.prototype,"collabUserInfoService",void 0),(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==de.O&&de.O)?n:Object)],e.prototype,"stateManager",void 0),e}();!function(e){e.LocalChangeContent="localChangeContent",e.ServerChangeContent="serverChangeContent"}(Fa||(Fa={})),function(e){function t(t){var n=e.call(this,Fa.LocalChangeContent)||this;return n.msg=t,n}(0,r.__extends)(t,e)}(p.Notification);var Ua,Ha,ja=function(e){function t(){return e.call(this,Fa.ServerChangeContent)||this}return(0,r.__extends)(t,e),t}(p.Notification),Wa=n(54472),Va=[Fo.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_MEMBER_FULL,Fo.RoomWebsocketErrorCode.SOCKET_COLLABROOM_NOT_VIP_FULL,Fo.RoomWebsocketErrorCode.SOCKET_COLLABROOM_DOC_DELETED,Fo.RoomWebsocketErrorCode.SOCKET_DOC_PRIVILEGE_FAILED,Fo.RoomWebsocketErrorCode.SOCKET_USER_AUTH_FAILED,ta.p.CollabRoomDataBaseChange],za=function(){function e(e){this.context=e,this.disconnectErrorCode=0;var t=e.clientVars,n=e.notificationCenter,o=(0,r.__assign)((0,r.__assign)({},this.context),{collabCenterAdapter:this});this.userInfoManager=new Ki(n,t),this.sendMessageAdapter=new Ia(o),this.receiveMessageAdapter=new Ba(o),this.connectionAdapter=new ha(o),this.initCollabCenter(),this.initCollabEvent(),this.initConnectionControllerService(),this.connectionController=this.collabCenter.connectionController,window.App.collabCenterAdapter=this,t.isPublish||q.qO.getInstance().isDrivePreview||!Wa.x.getIsNeedInitCollabCenter()||(this.connectAfterCreateDocument(),this.collabCursorDeltaGcpManager=xa.getInstance())}var t;return Object.defineProperty(e.prototype,"isConnected",{get:function(){return this.collabCenter.isConnected},enumerable:!1,configurable:!0}),e.prototype.getVersion=function(){return this.collabCenter.version},e.prototype.connect=function(){this.collabCenter.connect()},e.prototype.disconnect=function(e,t){this.collabCenter.disconnect(e,t)},e.prototype.reconnect=function(){this.collabCenter.reconnect(),this.collabCenter.forceResume(Fo.PauseOrResumeType.ALL)},e.prototype.pause=function(e){this.collabCenter.pause(e)},e.prototype.forceResume=function(e){this.collabCenter.forceResume(e)},e.prototype.resume=function(e){this.collabCenter.resume(e)},e.prototype.sendUserChange=function(e){this.collabCenter.sendUserChange(e)},e.prototype.sendMessage=function(e,t,n){return void 0===t&&(t=null),(0,r.__awaiter)(this,void 0,Promise,(function(){var o=this;return(0,r.__generator)(this,(function(r){return[2,new Promise((function(r,i){try{var a=JSON.stringify(t),s={cmd:e,data:a,onError:function(e,t,n,r){ei.j.error(ei.w.Collab,"send message exception taskId: ".concat(e," command:").concat(t," result:").concat(null==r?void 0:r.errCode)),i({taskId:e,command:t,type:n,result:r})},onsend:function(e,t,n,o){r({taskId:e,command:t,type:n,result:o})},taskId:null!=n?n:(0,Fo.generateMessageTaskId)(),customParam:{timeout:Fo.DEFAULT_SEND_MESSAGE_TIMEOUT,maxRetryCount:3}};o.collabCenter.sendMessage([s])}catch(r){var c={errorCode:-1,errorMsg:r.message};i({taskId:n,command:e,type:t,result:c})}}))]}))}))},e.prototype.startGetMissChanges=function(e,t){this.collabCenter.startGetMissChanges(e,t)},e.prototype.getMissChanges=function(e,t){return(0,r.__awaiter)(this,void 0,Promise,(function(){return(0,r.__generator)(this,(function(n){return[2,this.collabCenter.getMissChanges(e,t)]}))}))},e.prototype.handleServerUserChanges=function(e){this.collabCenter.handleServerUserChanges(e)},e.prototype.connectAfterCreateDocument=function(){var e=this;d.GlobalContext.once(Ri,(function(t){ei.j.info(ei.w.Collab,"LONG_CONNECTION_NOTIFICATION_TYPE, status:".concat(t.status)),Ui().getCreateDocPromise().then((function(t){e.handleAfterCreateDocument(t)})).catch((function(e){ei.j.error(ei.w.Collab,"connectAfterCreateDocument can't connect, reason: ".concat(null==e?void 0:e.message))}))}),this),this.context.clientVars.isOverConNum||(this.connectionTimeoutId=setTimeout((function(){!1===window.hiddenOnDocumentOpening&&"hidden"!==document.visibilityState&&(ei.j.info(ei.w.Collab,"socket connect timeout in 90s !!!"),Va.includes(e.disconnectErrorCode)||$i.reportToWebLog("".concat(9e4)),d.ReportHelper.monitor007Status(d.MonitorName.SOCKET_FAILED_IN_90S,d.Status007.FAIL,void 0,{errorCode:e.disconnectErrorCode,isOffline:!1})),clearTimeout(e.connectionTimeoutId)}),9e4))},e.prototype.handleAfterCreateDocument=function(e){if(ei.j.info(ei.w.Collab,"handle after create document, result = ",e),!0===e)this.connect();else{var t=e.data.collab_client_vars,n=this.context.clientVars.userId,r=this.context.canEdit();t.gray=Math.max(t.gray,0);var o={serverVars:t,uid:(0,F.getUid)(),uuId:n,userid:n,module:"doc",config:{headerGeneralPacket:Vi(r),messagePriority:new Map([[Fo.Command.CURSOR_MESSAGE,Fo.MessagePriority.LOW]])}};this.collabCenter.reconnect(o)}},e.prototype.getConnectionOptions=function(e){var t=e.collab_client_vars,n=e.userId,o=(0,r.__assign)((0,r.__assign)({},t),{dver:window.App.GlobalConfig.globalCodeVersion}),i=t.client,a=this.context.canEdit();return{serverVars:o,uid:(0,F.getUid)(),uuId:(0,jo.Gb)(n,null==i?void 0:i.sid),userid:n,module:"doc",config:{headerGeneralPacket:Vi(a),messagePriority:new Map([[Fo.Command.CURSOR_MESSAGE,Fo.MessagePriority.LOW]])}}},e.prototype.getCollabCenterConfig=function(e){return{documentInfo:{isEditable:0!=(2&e.rightFlag),isCreator:e.isCreator},fullMemberInfo:{enable:!0,isFullMember:!!e.isOverConNum},hotDocsInfo:{enable:!0,isHotDocs:!!e.hotDocs,isQueryData:!!e.querydata}}},e.prototype.initCollabCenter=function(){var e=this.context.clientVars.collab_client_vars.rev,t=this.getConnectionOptions(this.context.clientVars);this.collabCenter=new Fo.CollabCenter({baseVersion:e,connectionOptions:t,collabCenterDelegate:{multiTypeFollow:this.multiTypeFollow.bind(this),onEditableChange:this.onEditableChange.bind(this),getMissChangesUrl:this.getMissChangesUrl.bind(this),getQueryDataUrl:this.getQueryDataUrl.bind(this),onReceiveQueryData:this.onReceiveQueryData.bind(this),applyServerUserChanges:this.applyServerUserChanges.bind(this)},config:this.getCollabCenterConfig(this.context.clientVars)})},e.prototype.initCollabEvent=function(){var e=this,t=this.collabCenter.connectionController;t&&(Hi.ZP.getInstance().sendMessage=t.sendMessage.bind(t),t.onConnectionEvent((function(e){var t,n,r,o,i;Hi.ZP.getInstance().receiveMessage((null===(n=null===(t=e.data)||void 0===t?void 0:t.serverMsg)||void 0===n?void 0:n.type)||"",null!==(i=null===(o=null===(r=e.data)||void 0===r?void 0:r.serverMsg)||void 0===o?void 0:o.data)&&void 0!==i?i:[])}))),this.collabCenter.on(Fo.SEND_MESSAGE_EVENT.ON_COMMIT_SUCCESS,(function(t){return e.sendMessageAdapter.handleCommitSuccess(t)})),this.collabCenter.on(Fo.SEND_MESSAGE_EVENT.ON_COMMIT_FAIL,(function(t){return e.sendMessageAdapter.handleCommitFail(t)})),this.collabCenter.on(Fo.RECEIVE_MESSAGE_EVENT.ON_RECEIVE_MESSAGE,(function(t){return e.receiveMessageAdapter.handleReceiveMessage(t)})),this.collabCenter.on(Fo.CONNECTION_STATE_EVENT.ON_ROOM_OPEN,(function(){clearTimeout(e.connectionTimeoutId),e.connectionAdapter.handleConnect()})),this.collabCenter.on(Fo.CONNECTION_STATE_EVENT.ON_ROOM_CLOSE,(function(t){return e.connectionAdapter.handleClose(t)})),this.collabCenter.on(Fo.CONNECTION_STATE_EVENT.ON_ROOM_SHUTDOWN,(function(t){e.connectionAdapter.handleShutdown(t),e.clearConnectionTimeoutId(t)})),this.collabCenter.on(Fo.CONNECTION_STATE_EVENT.ON_RECONNECT_FAIL,(function(){return e.connectionAdapter.handleReconnectFail()})),this.collabCenter.on(Fo.CONNECTION_STATE_EVENT.ON_ROOM_STATE_CHANGE,(function(t){return e.connectionAdapter.handleStateChange(t)})),this.collabCenter.on(Fo.VERSION_EVENT.ON_VERSION_CHANGE,(function(t){var n=new CustomEvent("Melo_setPadRev",{detail:{padRev:t.newVersion}});document.dispatchEvent(n),e.collabCursorDeltaGcpManager.onVersionChange(t.newVersion)})),this.collabCenter.on(Fo.REPORT_EVENT.ON_LOG,(function(e){var t=e.type,n=e.data;t===Fo.LOG_TYPE.INFO?ei.j.info.apply(ei.j,(0,r.__spreadArray)([ei.w.Collab],(0,r.__read)(n),!1)):t===Fo.LOG_TYPE.WARN?ei.j.warn.apply(ei.j,(0,r.__spreadArray)([ei.w.Collab],(0,r.__read)(n),!1)):t===Fo.LOG_TYPE.ERROR?ei.j.error.apply(ei.j,(0,r.__spreadArray)([ei.w.Collab],(0,r.__read)(n),!1)):Fo.LOG_TYPE.DEBUG})),this.collabCenter.on(Fo.REPORT_EVENT.ON_REPORT,(function(e){var t=e.type,n=e.data;t===Fo.REPORT_MONITOR_TYPE.COMMIT_REQUEST_SUCCESS?d.ReportHelper.monitor007Status(d.MonitorName.KEY_COMMIT_REQUEST_FAIL,d.Status007.SUCCESS):t===Fo.REPORT_MONITOR_TYPE.COMMIT_REQUEST_FAIL&&d.ReportHelper.monitor007Status(d.MonitorName.KEY_COMMIT_REQUEST_FAIL,d.Status007.FAIL,n.errorMessage,{errorCode:n.errorCode})}))},e.prototype.initConnectionControllerService=function(){this.collabCenter.connectionController&&this.extensionService.dependentServiceCombinder.connectionControllerService.setConnectionController(this.collabCenter.connectionController)},e.prototype.applyServerUserChanges=function(e){if(e.revert){var t=new CustomEvent(bi.R0,{detail:{version:this.getVersion()}});return document.dispatchEvent(t),void $i.zzsReport(ga.SERVER_CHANGES_CONTAIN_REVERT)}var n=e.changeset,r=e.newRev,o=e.taskId;this.saveDeltaGcp(r,n),d.GlobalContext.run(P.Rh.push,{newCs:n,rev:r}),ei.j.info(ei.w.Collab,"collab center adapter receive server user change.",r,o);var i=this.getVersion();window.App.changesetManager.applyChangesToBase(e.changeset,e.author,e.subId,e.revert,i,e.newRev),this.context.notificationCenter.fire(new ja),this.context.notificationCenter.fire(new Di(e))},e.prototype.saveDeltaGcp=function(e,t){var n=(0,vi.xs)(t);n&&this.collabCursorDeltaGcpManager.deltaGCP.save(e,n)},e.prototype.multiTypeFollow=function(e,t,n){if(n)return t;var r=(0,pi.Uq)(e.changeset),o=(0,pi.By)(r),i=(0,pi.Uq)(t.changeset),a=(0,pi.By)(i),s=d.Changeset.followSingle(a,o,!0),c={type:i[0].type,mutations:s};return{changesetType:t.changesetType,changeset:(0,pi.eT)([c])}},e.prototype.getMissChangesUrl=function(e){return(0,r.__awaiter)(this,void 0,Promise,(function(){var t;return(0,r.__generator)(this,(function(n){return t=void 0!==e.to?"&to=".concat(e.to):"",[2,"/dop-api/get/changes?padId=".concat(e.globalPadId,"&from=").concat(e.from).concat(t)]}))}))},e.prototype.getQueryDataUrl=function(){return"/dop-api/querydata?padid=".concat(this.context.clientVars.globalPadId,"&noEscape=1&type=doc&room=1")},e.prototype.onEditableChange=function(e){var t="collab_center_lock";e?q.qO.getInstance().enableEditForKey(t):q.qO.getInstance().disableEditForKey(t),ei.j.info(ei.w.Collab,"full member status change, editable: ".concat(e,", editKey: ").concat(t))},e.prototype.onReceiveQueryData=function(e){try{return this.getVersion()!==e.rev?(ei.j.info(ei.w.Collab,"on receive query data， rev:",e.rev),this.collabCenter.startGetMissChanges(this.getVersion()+1,e.rev)):ei.j.info(ei.w.Collab,"on receive query data, newRev === curVersion, need not refresh"),!0}catch(e){return ei.j.info(ei.w.Collab,"on receive query data， apply data error:",e.message),!1}},e.prototype.clearConnectionTimeoutId=function(e){var t=e.reason.errCode,n=void 0===t?0:t;this.disconnectErrorCode=n},(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==ri.$&&ri.$)?t:Object)],e.prototype,"extensionService",void 0),e}(),Ga=n(52739),Ya=n(3534),qa=n(90304),Za=n(19762);!function(e){e.POST="POST",e.GET="GET"}(Ua||(Ua={})),function(e){e.None="None",e.Network="Network",e.ServerVerity="ServerVerity"}(Ha||(Ha={}));var Ja=function(){function e(e){this.rev=e}return e.prototype.composeOfflineData=function(e,t){if(!t||0===t.length)return{};var n=(0,F.getUid)(),r=t[0];return{common:{type:"USER_CHANGES",offlineMsg:!0,curRev:this.rev,docid:e,uid:n,dver:window.App.GlobalConfig.globalCodeVersion,base_rev:r.version,code_ver:0,session_type:0,gray:window._grayVersion?window._grayVersion:0,generalpacket:{rel_rev:window.__globalReleaseVersion},pver:2,uuId:n},respective:t.map((function(e){return{task_id:e.taskId,subId:e.subId,changeSetCount:e.changeSetCount||1,commands:(0,pi.eT)(e.changeset)}}))}},e.prototype.commitOfflineData=function(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,o;return(0,r.__generator)(this,(function(r){return n="/dop-api/commitchanges?padId=".concat(e,"&xsrf=").concat((0,d.getXsrf)()),o=JSON.stringify(t),o=encodeURIComponent(o),[2,Ti.hS.sendCommonRequest(n,Ua.POST,"data=".concat(o))]}))}))},e.prototype.batchCommitOfflineData=function(e,t){return(0,r.__awaiter)(this,void 0,Promise,(function(){var n,o,i,a,s=this;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return n={success:!1,type:Ha.None,data:[]},o=this.composeOfflineData(e,t),[4,this.commitOfflineData(e,o)];case 1:return(i=r.sent()).error?[4,this.commitOfflineData(e,o)]:[3,3];case 2:i=r.sent(),r.label=3;case 3:return i.error?(n.type=Ha.Network,p.Logger.error(i.error),n.errorCode=i.error.statusCode,[2,n]):((a=i.data)&&0===a.retcode?(a.Data.respective.forEach((function(e){p.Logger.info("commitOfflineData:".concat(s.rev,", ").concat(e.newRev,", ").concat(e.commands,", ").concat(e.commitId)),e.newRev>s.rev&&n.data.push(e)})),n.success=!0):(n.type=Ha.ServerVerity,n.errorCode=a.retcode,p.Logger.error("batchCommitOfflineData retcode:".concat(a&&a.retcode))),[2,n])}}))}))},e}(),Ka=function(){function e(){}return e.prototype.createDoc=function(e,t){return(0,r.__awaiter)(this,void 0,Promise,(function(){var n,o,i,a,s,c,l,u;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return n={success:!1},[4,this.createNewDoc(e)];case 1:return 0!==(o=r.sent()).retcode?(n.reason=ma.CREATE_NEW_DOC_ERROR,p.Logger.info("createNewDoc Error, retcode:".concat(o.retcode,",  message: ").concat(o.msg)),[2,n]):(i=o.doc_url,a=o.doc_id,s=a.domain_id,c=a.pad_id,p.Logger.info("createNewDoc version: ".concat(e.version,",  Result: ").concat(JSON.stringify(o))),l="".concat(s,"$").concat(c),[4,this.commitChanges(l,e.version,t)]);case 2:return(u=r.sent()).success?[4,window.App.offlineEditAdapter.clearOfflineData("commitchanges success.")]:(n.reason=ma.COMMIT_CHANGE_ERROR,p.Logger.info("commitChanges error, error type: ".concat(u.type)),[2,n]);case 3:return r.sent(),n.success=!0,n.newUrl=i,[2,n]}}))}))},e.prototype.createNewDoc=function(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,n,o;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return t=e.version,n=this.generateCreateFileBody(t),[4,qa.networkRequest.post("/cgi-bin/online_docs/createdoc_new?create_source=8001",n)];case 1:if(200!==(o=r.sent()).status)throw Error((0,ii.$t)("创建副本请求失败"));return[2,o.data]}}))}))},e.prototype.generateCreateFileBody=function(e){var t=Math.floor(+new Date/1e3),n="".concat((0,ii.$t)("副本"),"-").concat((0,c.Yi)().title,"-").concat((new Date).toLocaleDateString()),r=(0,c.Yi)().domainId,o=(0,c.Yi)().padId;return"create_type=".concat(4,"&create_source=").concat(8001,"&pad_id=").concat(o,"&domain_id=").concat(r,"&doc_type=").concat(0,"&templateId=").concat(0,"&xsrf=").concat((0,Za.f)(),"&version=").concat("2.0.0","&folder_id=").concat("/","&title=").concat(n,"&last_browse_ts=").concat(t,"&data_rev=").concat(e)},e.prototype.commitChanges=function(e,t,n){return(0,r.__awaiter)(this,void 0,Promise,(function(){return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,new Ja(t).batchCommitOfflineData(e,n)];case 1:return[2,r.sent()]}}))}))},e}(),Qa=function(e){var t=this;this.context=e,this.newDocUrl="",this.handleRevert=function(){return(0,r.__awaiter)(t,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return p.Logger.info("RevertChangesetHandler handleRevert"),this.tipsManager.showErrorTips(li.RoomWebsocketErrorCode.COMMIT_CHANGES_CONTAIN_REVERT,void 0,!0),[2]}))}))},this.confirmToCreateDocCopy=function(){return(0,r.__awaiter)(t,void 0,void 0,(function(){var e,t,n,o,i;return(0,r.__generator)(this,(function(a){switch(a.label){case 0:return[4,na()];case 1:return e=a.sent(),p.Logger.info("RevertChangesetHandler confirmToCreateDocCopy localChanges.length:".concat(e.length)),e.length?(t=new Ka,n=(0,r.__read)(e,1),o=n[0],[4,t.createDoc({globalPadId:(0,c.Yi)().globalPadId,version:o.version},e)]):[2];case 2:return(i=a.sent()).success?(this.newDocUrl="https:".concat(i.newUrl),this.createDocSucessModal(),[2]):(p.Logger.warn("RevertChangesetHandler handleRevert fail. reason:".concat(i.reason)),this.handleCommitError(),[2])}}))}))},this.showModal=function(e){Ga.Snackbar.show({type:e.type,message:e.message,action:e.action,autoClose:e.autoClose,onClickAction:e.onClickAction})},this.createDocSucessModal=function(){var e={type:"success",message:(0,ii.$t)("文档已被还原无法进行数据同步，已为你保存副本。"),action:(0,ii.$t)("去查看"),autoClose:!1,onClickAction:function(){return t.openNewDoc()}};t.showModal(e)},this.reload=function(){window.location&&window.multiAccountUtil.reload()},this.openNewDoc=function(){p.Logger.info("打开新文档： 文档URL：".concat(t.newDocUrl)),window.open(t.newDocUrl),t.reload()},this.handleCommitError=function(){t.tipsManager.showErrorTips(ki.OFFLINE_EDIT_CODE.RESUBMIT_FAIL)},this.tipsManager=new aa(this.context.notificationCenter),this.context.notificationCenter.on(Ya.N.CONFIRM_CREATE_DOC_COPY,this.confirmToCreateDocCopy)},Xa=n(36424),$a=n(47307),es=function(e,t){var n;p.Logger.info("follow newRev:".concat(t.newRev,", taskId:").concat(t.commitId));var o=(0,pi.Uq)(t.commands),i=[];return null===(n=e.forEach)||void 0===n||n.call(e,(function(e){var n,a;e.changesetString&&(e.changeset=(0,pi.Uq)(e.changesetString));var s=(0,r.__assign)({},e);null===(a=(n=e.changeset).forEach)||void 0===a||a.call(n,(function(t){var n;if("BB08J2"!==e.subId)return e;null===(n=o.forEach)||void 0===n||n.call(o,(function(e){var n;n=(0,r.__read)(d.Changeset.followDouble(t.mutations,e.mutations),2),t.mutations=n[0],e.mutations=n[1]}))})),s.version=t.newRev,s.changesetString=(0,pi.eT)(e.changeset),i.push(s)})),i},ts=function(){function e(e,t){var n={version:e,documentInfo:{dataVersion:t,docType:ui.DOCUMENT_TYPE.doc,secretId:(0,Io.pb)(),globalPadId:(0,c.Yi)().globalPadId,uid:(0,F.getUid)()}};this.offlineEditBackUp=new ki.OfflineEditBackUp(n)}return e.prototype.init=function(){return(0,r.__awaiter)(this,void 0,Promise,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.offlineEditBackUp.init()];case 1:return[2,e.sent()]}}))}))},e}(),ns=n(97891),rs=function(){function e(e){var t=this;this.adapterOption=e,this.tag="OfflineEditAdapter",this.handleClearOfflineData=function(e){return(0,r.__awaiter)(t,void 0,void 0,(function(){var t,n,o,i,a;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return t=Number(null!==(o=null===(n=null==e?void 0:e.detail)||void 0===n?void 0:n.code)&&void 0!==o?o:0),(null===(i=null==e?void 0:e.detail)||void 0===i?void 0:i.isBackup)?[4,this.backupChanges()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.clearOfflineData("handleClearOfflineData reason:".concat(t),null===(a=null==e?void 0:e.detail)||void 0===a?void 0:a.callback),[2]}}))}))};var n={version:(0,c.Yi)().collab_client_vars.rev,documentInfo:{secretId:(0,Io.pb)(),globalPadId:(0,c.Yi)().globalPadId,dataVersion:window.App.GlobalConfig.globalCodeVersion,documentType:ui.DOCUMENT_TYPE_DESC.doc,docType:ui.DOCUMENT_TYPE.doc,uid:(0,F.getUid)()},config:{isUseResubmit:!0,isUseBatchCommit:(0,c.Yi)().padStatus!==Ti.DL.LOCAL}},o={eventEmitter:this.adapterOption.eventEmitter,canEdit:this.adapterOption.canEdit,resubmit:{connectionController:window.App.collabCenterAdapter.connectionController,getNewChanges:this.getNewChanges.bind(this),applyNewChanges:this.applyNewChanges.bind(this),applyLocalChanges:this.applyLocalChanges.bind(this),follow:es,setEditAble:function(){return q.qO.getInstance().setPrivilege({isBlocked:!1})},setDisableEdit:function(){return q.qO.getInstance().setPrivilege({isBlocked:!0})},offlineDataSyncing:Xa.l1},networkStatusSwitch:{config:{available:Xa.YX,unusable:Xa.Xx,otherTab:Xa.Ps,offlineDataSyncing:Xa.l1},setEditAble:function(){return q.qO.getInstance().setPrivilege({isBlocked:!1})},setDisableEdit:function(){return q.qO.getInstance().setPrivilege({isBlocked:!0})}},oldChangesTransForm:hi};this.offlineEdit=new ki.OfflineEdit(n,o),this.offlineEditWritable=!0}return e.prototype.init=function(){var e,t,n;return(0,r.__awaiter)(this,void 0,Promise,(function(){var o,i,a;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return this.initEvent(),o=Wa.x.getIsNeedInitOffline(),[4,this.offlineEdit.init(!o)];case 1:return(i=r.sent()).error&&p.Logger.warn(this.tag,"init error:".concat(null===(e=i.error)||void 0===e?void 0:e.stack)),i.retCode===li.RoomWebsocketErrorCode.COMMIT_CHANGES_CONTAIN_REVERT&&void 0!==i.baseVersion?(a=new CustomEvent(bi.R0,{detail:{version:i.baseVersion}}),document.dispatchEvent(a),$i.zzsReport(ga.COMMIT_CHANGES_CONTAIN_REVERT_CGI),[2]):(this.offlineEdit.mutexLockHelper.isLocked()||"list"!==(null===(n=null===(t=this.offlineEdit.mutexLockHelper.lastLockItem)||void 0===t?void 0:t.optional)||void 0===n?void 0:n.source)||this.detectLock(),i.isSuccess?(d.GlobalContext.fire(new Ai(i.status)),[2]):(new aa(this.adapterOption.notificationCenter).showTips(ki.OFFLINE_EDIT_CODE.RESUBMIT_FAIL),[2]))}}))}))},e.prototype.setOfflineEditWritable=function(e){p.Logger.info(this.tag,"set offlineEditWritable :".concat(e)),this.offlineEditWritable=e},e.prototype.enterOnline=function(e){this.offlineEdit.enterOnline(e)},e.prototype.enterOffline=function(e){this.offlineEdit.enterOffline(e)},e.prototype.canRead=function(){return this.offlineEdit.canRead()},e.prototype.canWrite=function(){return(0,r.__awaiter)(this,void 0,Promise,(function(){var e;return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return(e=this.offlineEditWritable)?[4,this.offlineEdit.canWrite()]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return[2,e]}}))}))},e.prototype.isLocked=function(){var e,t;return!0===(null===(t=null===(e=this.offlineEdit.mutexLockHelper)||void 0===e?void 0:e.isLocked)||void 0===t?void 0:t.call(e))},e.prototype.isLockedByOtherDocPage=function(){var e,t,n;return!this.isLocked()&&"edit"===(null===(n=null===(t=null===(e=this.offlineEdit.mutexLockHelper)||void 0===e?void 0:e.lastLockItem)||void 0===t?void 0:t.optional)||void 0===n?void 0:n.source)},e.prototype.isLockedByDataSyncPage=function(){var e,t,n;return"list"===(null===(n=null===(t=null===(e=this.offlineEdit.mutexLockHelper)||void 0===e?void 0:e.lastLockItem)||void 0===t?void 0:t.optional)||void 0===n?void 0:n.source)},e.prototype.release=function(){return(0,r.__awaiter)(this,void 0,Promise,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.offlineEdit.release()];case 1:return e.sent(),[2]}}))}))},e.prototype.destroy=function(){this.destroyEvent()},e.prototype.getChanges=function(){var e,t,n;return(0,r.__awaiter)(this,void 0,Promise,(function(){var o;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.offlineEdit.getChanges({types:fi})];case 1:return(o=r.sent()).error?(p.Logger.warn(this.tag,"getChanges error:".concat(null===(e=o.error)||void 0===e?void 0:e.message," stack:").concat(null===(t=o.error)||void 0===t?void 0:t.stack)),[2,[]]):[2,null!==(n=o.data)&&void 0!==n?n:[]]}}))}))},e.prototype.deleteAndUpsertChanges=function(e){return(0,r.__awaiter)(this,void 0,Promise,(function(){return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return this.offlineEditWritable?[4,this.offlineEdit.deleteAndUpsertChanges({types:fi},e)]:(p.Logger.info(this.tag,"deleteAndUpsertChanges offlineEditWritable:".concat(this.offlineEditWritable)),[2,{data:!1}]);case 1:return[2,t.sent()]}}))}))},e.prototype.clearOfflineData=function(e,t){var n,o;return(0,r.__awaiter)(this,void 0,Promise,(function(){var i;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return p.Logger.info(this.tag,"clearOfflineData reason: ".concat(e)),[4,this.offlineEdit.deleteChanges({types:fi})];case 1:return(i=r.sent()).error&&p.Logger.error(this.tag,"clearOfflineData error:".concat(null===(n=i.error)||void 0===n?void 0:n.message," stack:").concat(null===(o=i.error)||void 0===o?void 0:o.stack)),null==t||t(),[2]}}))}))},e.prototype.initEvent=function(){document.addEventListener("Melo_ClearOfflineData",this.handleClearOfflineData)},e.prototype.destroyEvent=function(){document.removeEventListener("Melo_ClearOfflineData",this.handleClearOfflineData)},e.prototype.backupChanges=function(){return(0,r.__awaiter)(this,void 0,Promise,(function(){var e,t,n=this;return(0,r.__generator)(this,(function(r){return e=new Promise((function(e){try{n.getChanges().then((function(t){(null==t?void 0:t.length)?n.getOfflineEditBackupAdapter().init().then((function(){n.getOfflineEditBackupAdapter().offlineEditBackUp.deleteAndUpsertChanges({types:fi},t).then((function(t){t||p.Logger.warn(n.tag,"getOfflineEditBackupAdapter deleteAndUpsertChanges fail."),e()})).catch((function(){e()}))})):e()}))}catch(t){p.Logger.warn(n.tag,"handleClearOfflineData error:".concat(null==t?void 0:t.message," stack:").concat(null==t?void 0:t.stack)),e()}})),t=new Promise((function(e){return setTimeout((function(){e()}),2e4)})),[2,Promise.race([t,e])]}))}))},e.prototype.detectLock=function(){var e=this;this.offlineEdit.mutexLockHelper.detect((function(){var t,n;p.Logger.info(e.tag,"detectLock reload"),null===(n=null===(t=window.multiAccountUtil)||void 0===t?void 0:t.reload)||void 0===n||n.call(t)}),500)},e.prototype.applyLocalChanges=function(e){return(0,r.__awaiter)(this,void 0,Promise,(function(){return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return e.length?[4,this.shouldApplyContinue()]:[2];case 1:return t.sent(),e.forEach((function(e){(0,$a.U)(e.dver)||(e.changeset=(0,pi.Uq)(e.changesetString))})),window.App.changesetManager.applyLocalChangesToBase(e),[2]}}))}))},e.prototype.getNewChanges=function(e,t){var n;return(0,r.__awaiter)(this,void 0,Promise,(function(){var o,i,a;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,window.App.collabCenterAdapter.getMissChanges(e,t)];case 1:return o=r.sent(),i=[],o.forEach((function(e){e.data&&i.push(e.data)})),[2,i];case 2:throw a=r.sent(),p.Logger.warn("getNewChanges error"),null!==(n=null==a?void 0:a.error)&&void 0!==n?n:new Error("getNewChanges error");case 3:return[2]}}))}))},e.prototype.applyNewChanges=function(e){return(0,r.__awaiter)(this,void 0,Promise,(function(){var t,n=this;return(0,r.__generator)(this,(function(o){switch(o.label){case 0:return e.length?[4,this.shouldApplyContinue()]:[2];case 1:return o.sent(),t=[],e.forEach((function(e){p.Logger.info(n.tag,"applyNewChanges: ".concat(e.newRev,", ").concat(e.commitId)),t.push(new Fo.ServerUserChange((0,r.__assign)((0,r.__assign)({},e),{changeset:e.changeset})))})),window.App.collabCenterAdapter.handleServerUserChanges(t),[2]}}))}))},e.prototype.getOfflineEditBackupAdapter=function(){return this.offlineEditBackUpAdapter||(this.offlineEditBackUpAdapter=new ts((0,c.Yi)().collab_client_vars.rev,window.App.GlobalConfig.globalCodeVersion)),this.offlineEditBackUpAdapter},e.prototype.shouldApplyContinue=function(){return(0,r.__awaiter)(this,void 0,Promise,(function(){var e=this;return(0,r.__generator)(this,(function(t){return[2,new Promise((function(t){if(!(0,c.Yi)().collab_client_vars.isChunked||!e.adapterOption.editor.state.dataEngine.getIsChunkLoading())return t(!0);e.adapterOption.notificationCenter.on(ns.J.CHUNK_CENTER_FINISH,(function(){p.Logger.info(e.tag,"shouldApplyContinue: true"),t(!0)}))}))]}))}))},e}(),os=function(){function e(t){var n=this;this.context=t,this.handleCommitMissChangesContainRevert=function(){q.qO.getInstance().setPrivilege({isBlocked:!0}),new Qa(n.context).handleRevert()},this.handleApplyChangesetError=function(e){var t;p.Logger.warn("handleApplyChangesetError: ".concat(null==e?void 0:e.detail),null===(t=null==e?void 0:e.detail)||void 0===t?void 0:t.code),new aa(n.context.notificationCenter).showTips(ta.p.CollabRoomCHANGESETERRORAPPLYOFFLINE)},this.onBeforeUnload=function(){if(p.Logger.info(e.tag,"onBeforeUnload"),window.App.changesetManager.hasUncommittedChanges())return(0,ii.$t)("文档存在未保存修改，如果关闭，修改将不会被保存。您是否确定关闭？")};var r=t.clientVars,o=new rs({canEdit:t.canEdit,eventEmitter:t.eventEmitter,editor:t.editor,notificationCenter:t.notificationCenter});window.App.offlineEditAdapter=o,o.init(),r.isPublish||this.init(),window.App.offline=this}return e.prototype.initEvent=function(){Wa.x.getIsNeedInitOffline()&&Si.network.changeEnd(this.handleNetWorkChangeCallback.bind(this)),window.onbeforeunload=this.onBeforeUnload,document.addEventListener(bi.HJ,this.handleApplyChangesetError),document.addEventListener(bi.Ep,this.context.copyAllDataToMemory),document.addEventListener(bi.R0,this.handleCommitMissChangesContainRevert,{once:!0}),this.context.notificationCenter.on(Sa.DELETE_OFFLINE_DATA,(function(){window.App.offlineEditAdapter.clearOfflineData(Sa.DELETE_OFFLINE_DATA)}),this)},e.prototype.destroyEvent=function(){Si.network.remove(this.handleNetWorkChangeCallback.bind(this)),document.removeEventListener(bi.HJ,this.handleApplyChangesetError),document.removeEventListener(bi.Ep,this.context.copyAllDataToMemory),document.removeEventListener(bi.R0,this.handleCommitMissChangesContainRevert),this.context.notificationCenter.removeListener(Sa.DELETE_OFFLINE_DATA,this)},e.prototype.handleNetWorkChangeCallback=function(e){var t=window.App.changesetManager.hasUncommittedChanges();"online"===e?window.App.offlineEditAdapter.enterOnline(t):window.App.offlineEditAdapter.enterOffline(t)},e.prototype.init=function(){this.initEvent()},e.prototype.destroy=function(){this.destroyEvent()},e.tag="Offline",e}(),is=n(90815),as=n(37084),ss=n(8962),cs=n(61574),ls=function(){function e(e){this.mobilePagedViewService=e}var t;return e.prototype.isFirstScreenEditor=function(e){return!0},e=(0,r.__decorate)([(0,_e.t)(),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==cs.t&&cs.t)?t:Object])],e)}(),us=n(35205),ds="DocumentManager",ps=function(){function e(){this.isContainerReady=!1}return e.getInstance=function(){return this.instance||(this.instance=new e,window.documentManager=this.instance),this.instance},e.prototype.onReady=function(e){p.Logger.info(ds,"onReady dver:".concat(e)),this.isContainerReady=!0,d.GlobalContext.fire(new Vr.Gr)},e.prototype.showhideEditorMask=function(e){p.Logger.info(ds,"showhideEditorMask: ".concat(window.location.href!==e),(new Date).toString()),(window.requestAnimationFrame||window.webkitRequestAnimationFrame)((function(){var e,t;null===(t=null===(e=window.tdocs)||void 0===e?void 0:e.firstLoadFinished)||void 0===t||t.call(e)}))},e.prototype.onPrerenderFinish=function(e,t){p.Logger.info(ds,"onPrerenderFinish return",e,t),window.mqq&&window.mqq.invoke("docx","sendToParent",{func:"window&&window.preloadManager&&window.preloadManager.onPrerenderFinish",args:[e,"0.0.0",t]})},e.prototype.reportOpenSameUrl=function(e,t,n){n&&window.mqq&&window.mqq.invoke("docx","getMetric",{csid:n},(function(o){if(o&&o.data){var i=o.data,a=i.doc_item_click_timestamp,s=i.doc_loadurl_timestamp,c=(0,r.__rest)(i,["doc_item_click_timestamp","doc_loadurl_timestamp"]),l=Math.round(s-a),u=Math.round(e-s),f=Math.round(t-a),_=f,h=JSON.stringify({clickToEditCost:_,clickToShowCost:f,clickToLoadCost:l,loadToStartCost:u}),m=JSON.stringify(c);p.Logger.debug("report container_open_same_doc"),d.ReportHelper.tdwReport({opername:"doc_core",module:"open",action:"container_open_same_doc",file_type:"1",obj3:h,ver9:m})}else p.Logger.error("getMetric for ".concat(n," failed ").concat(o))}))},e}(),fs=n(50841),_s=n(50263),hs=n(38429),ms=n(22462),gs=function(){function e(){}var t;return e.prototype.getInitDocEnv=function(){return{layoutType:_s.A.isTencentMeetingInWework()?d.LayoutType.EnterpriseWeb:d.LayoutType.Scroll,renderType:this.getInitRenderType(),editable:!1,copyable:!1,uniqueId:""}},e.prototype.getInitRenderType=function(){return d.RenderType.Canvas},e.prototype.getDataBasedDocEnv=function(e,t,n){var r,o=d.LayoutType.Scroll;if(hs.ZM){var i=e.uin,a=e.globalPadId;o="2"===(0,ms.cF)("local_layout_type","".concat(i,"$").concat(a))?d.LayoutType.Paged:o}else"2"===e.pagingFlag&&(o=d.LayoutType.Paged),(null===(r=null===window||void 0===window?void 0:window.isDefaultWeblayout)||void 0===r?void 0:r.call(window))&&(o=d.LayoutType.EnterpriseWeb),_s.A.isTencentMeetingInWework()?o=d.LayoutType.EnterpriseWeb:void 0===e.pagingFlag&&this.isNeedPaged(t.dataEngine)&&(o=d.LayoutType.Paged);return{layoutType:o,renderType:this.getInitRenderType(),editable:n.isEditable,copyable:n.isCopyable,uniqueId:e.globalPadId}},e.prototype.isNeedColumn=function(e){for(var t,n,r,o,i=null===(t=e.getDataStream().getStoryStream().getMainStoryInfo())||void 0===t?void 0:t.contentRange,a=e.getDataStream().getSectionStream().createSectionIterator(i),s=0,c=!1;a.hasNext();){var l=null!==(o=null===(r=null===(n=a.getProperty())||void 0===n?void 0:n.cols)||void 0===r?void 0:r.num)&&void 0!==o?o:1;c=!c&&l>1,s+=1,a.next()}return c&&!(s>1)},e.prototype.hasHeaderOrFooter=function(e){for(var t=e.getDataStream().getSectionStream().createSectionIterator(),n=function(){var e=t.getProperty();if([d.HeaderRefType.default,d.HeaderRefType.first,d.HeaderRefType.even,d.FooterRefType.default,d.FooterRefType.first,d.FooterRefType.even].some((function(t){return!!(null==e?void 0:e[t])})))return{value:!0};t.next()};t.hasNext();){var r=n();if("object"==typeof r)return r.value}return!1},e.prototype.hasFloatingDrawing=function(e){for(var t,n=e.getDataStream().getDrawingStream().createDrawingIterator();n.hasNext();){if(null===(t=n.getProperty())||void 0===t?void 0:t.isFloating)return!0;n.next()}return!1},e.prototype.isNeedPaged=function(e){return this.isNeedColumn(e)?(this.store.register("isNeedColumn",!0),!0):!!this.hasFloatingDrawing(e)||!!this.hasHeaderOrFooter(e)},(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==de.O&&de.O)?t:Object)],e.prototype,"store",void 0),e}(),vs=function(){function e(e){this.editor=e}return e.prototype.insertParagraph=function(e){var t=this.editor.state.delta(),n=this.editor.state.getTextStream().createParagraphIterator(),r=this.editor.state.getTextStream().createRunIterator(),o=n.getRange().clone();o.gcpBegin=e,o.len=1;var i=n.getCloneProperty().constructor,a=r.getCloneProperty().constructor;t.insertText(e,"\r"),t.setRunProperty(o,a.createPlaceholderRun(new a),d.PropUpdateMode.Insert),t.setParagraphProperty(o,new i,d.PropUpdateMode.Insert),this.editor.state.applyDelta(t)},e.prototype.deleteTextFromGcp=function(e,t){var n=this.editor.selection.gcpRange.clone();n.gcpBegin=e,n.len=t;var r=this.editor.state.delta();this.editor.state.deleteText(n,r),this.editor.state.applyDelta(r)},e.prototype.insertTableStart=function(e){var t=this.editor.selection.gcpRange.clone();t.gcpBegin=e,t.len=1;var n=this.editor.state.delta();d.Commands.insertTableStart(e,n),this.editor.state.applyDelta(n)},e.prototype.transformHistoryToVersionFile=function(e){var t="";return t+="0, ".concat(e.initialAttributedText.text,"\n"),e.actionlist.forEach((function(e,n){t+="".concat(n+1,", ").concat(e.action,"\n")})),t},e}(),bs=vs,ys=function(e){this.dirtyDataTools=new bs(e)},ws=ys;n(55059);var Es=function(){function e(e){this._hideFirstScreen=!1,this.notificationTimes=0,this.secretId=e.secretId,this.container=e.container,this.contextService=e.contextService,this.eventEmitter=e.eventEmitter,this.docEnvManager=new gs,this.init()}var t,o,i;return e.createInstance=function(t){return this.instance?this.instance.onReset(t):this.instance=new e(t),this.instance},e.getInstance=function(){return this.instance},e.prototype.handleEditorFirstRender=function(){var e,t;p.Logger.info("padeditor handleEditorFirstRender");var n=document.createEvent("CustomEvent");if(n.initCustomEvent("first_render_clearwhitescreen",!0,!0,{}),document.dispatchEvent(n),null===(e=window.App)||void 0===e||e.reportDrive(!0),(null===(t=window.editableWhenCreateState)||void 0===t?void 0:t.editableWhenCreate)&&Bo.Q.instance.disabled||this.hideFirstScreen(),this.showNoSupportBrowserTips(),Uo.t.isMiniProgram()){var r=document.getElementById("header");r instanceof HTMLElement&&(r.style.display="block")}ps.getInstance().onReady(this.clientVars.collab_client_vars.dver),this.fpsMonitor.startInitMonitor()},e.prototype.reportPV=function(){var e,t;if(!(0,Ho.g6)()){if(!this.contextService.context.isPublish){d.ReportHelper.zzsStatus({attributeId:d.MonitorName.PV,status:d.Status007.SUCCESS,otherDimensions:["injectDomain: ".concat(null!==(e=n.g.injectDomain)&&void 0!==e&&e)]});var r=p.LocalStorageUtil.getItem("tdsourcetag");return d.ReportHelper.tdwReport({opername:"doc_core",module:"visit",action:"detail_page",source3:r||"",obj3:p.PlatformUtil.getBrowser(),ver5:1===this.clientVars.collab_client_vars.dirty?"limited":"normal",ver7:null===(t=this.clientVars.collab_client_vars.dver)||void 0===t?void 0:t.substr(0,3),ver10:this.permissionCtrl.isPreview?"qqpreview":""},{immediate:!0}),d.ReportHelper.tdwReport({opername:"doc_core",module:"abtest",action:"report"}),d.ReportHelper.oss({itemname:"wwdoc_view_doc"}),d.ReportHelper.idkeyReport(d.IdkeyName.PV),void d.ReportHelper.idkeyReport(d.IdkeyName.PV_PC)}d.ReportHelper.monitor(d.MonitorName.PV_PUBLISH),d.ReportHelper.tdwReport({opername:"doc_word_file",module:"to_web",action:"web_visit"})}},e.prototype.reportToB=function(){this.contextService.context.appid&&(d.ReportHelper.monitor(d.MonitorName.PV_TOB),d.ReportHelper.tdwReport({opername:"doc_core",module:"visit",action:"detail_page_tob",obj3:p.PlatformUtil.getBrowser(),ver5:1===this.clientVars.collab_client_vars.dirty?"limited":"normal",ver8:this.contextService.context.appid}),d.ReportHelper.tdwReport({opername:"doc_core",module:"abtest",action:"report"}))},e.prototype.startRAFMonitor=function(){if(p.Logger.info("padeditor startRAFMonitor"),1===this.notificationTimes){var e=Go.createRAFJank(this.editor);if(!e)return;e.startMonitor()}this.notificationTimes+=1},e.prototype.handleEditorRenderFinished=function(){var e,t,n=this.clientVars.collab_client_vars;p.Logger.info("padeditor render finish"),this.startRAFMonitor(),this.reportPV(),(null===(e=n.dver)||void 0===e?void 0:e.startsWith("3.0"))&&d.ReportHelper.monitor007Status(d.MonitorName.PV_3_0),this.reportToB(),(null===(t=window.editableWhenCreateState)||void 0===t?void 0:t.editableWhenCreate)||this.hideFirstScreen(),window.loadLazyScriptStartHandler&&window.loadLazyScriptStartHandler(),this.fpsMonitor.end(),this.fpsMonitor.startScrollMonitor()},e.prototype.init=function(){var e,t,n=this;null===(t=null===(e=window.log)||void 0===e?void 0:e.showConsole)||void 0===t||t.call(e);var r=this.docEnvManager.getInitDocEnv();this.editor=new d.MeloEditor(r),this.eventEmitter.emit("$beforeMeloAttach",{editor:this.editor,element:this.container}),this.fpsMonitor=new Xo(this.editor),this.layoutMonitor=new ti(this.editor),this.layoutMonitor.monitorLayoutError(),this.multiEditorService.isFirstScreenEditor(this.editor)?(p.Logger.info("padeditor init for first screen editor"),this.editor.once(d.RenderNotificationTypes.FIRST_RENDER,this.handleEditorFirstRender.bind(this)),this.editor.once(d.RenderNotificationTypes.RENDER_FINISH,this.handleEditorRenderFinished.bind(this)),this.editor.once(d.RenderNotificationTypes.HIDE_SNAPSHOT,this.hideFirstScreen.bind(this))):(p.Logger.info("padeditor init for non-first screen editor"),this.initDataCallback=function(){n.handleEditorFirstRender(),n.handleEditorRenderFinished(),n.hideFirstScreen()}),d.GlobalContext.once(d.FeatureNotificationType.FEATURE_LOADED,this.startRAFMonitor.bind(this)),this.editor.attachEditor(this.container),this.eventEmitter.listen("$editableChanged",(function(e){n.editor.setEditable(e)})),this.eventEmitter.listen("$copyableChanged",(function(e){n.editor.setCopyable(e)})),this.devTools=new ws(this.editor)},e.prototype.initClientData=function(){var e,t,n=this;return p.PerfUtil.mark("start_init_clientvars"),null===(t=null===(e=window.performance)||void 0===e?void 0:e.mark)||void 0===t||t.call(e,"MK_DATAINIT_START"),window.ClientVarsPromise&&window.ClientVarsPromise.then((function(){return(0,r.__awaiter)(n,void 0,void 0,(function(){var e,t,n,o,i,a,s,c,l,u,f,_,h,m,g,v,b=this;return(0,r.__generator)(this,(function(y){switch(y.label){case 0:return p.PerfUtil.mark("clientvars_promise_resolved"),null===(_=null===(f=window.performance)||void 0===f?void 0:f.mark)||void 0===_||_.call(f,"MK_DATAINIT_RESOLVE"),this.needWaitVipInfo?(this.initOwnerVipStatus(),[4,ni.f.initAccountApplication()]):[3,2];case 1:return y.sent(),[3,3];case 2:ni.f.initAccountApplication(),y.label=3;case 3:return this.loginService.init(),[4,ci.init()];case 4:return y.sent(),this.clientVars=Wo.u.getInstance(this.secretId).getClientVars(),this.handleReport(this.clientVars),e=p.PerfUtil.now(),t=this.clientVars.collab_client_vars,o=void 0,this.collab=new P.Xm(this.editor,t.ignoreLineRev),i=new wi(this.collab,Ei.DOC_ID),this.collab.setChangesetManager(i),this.isChunkDataEnabled()?[4,(o=new Ci.E({editor:this.editor,clientVars:t,csManager:i})).loadDocumentData()]:[3,6];case 5:return n=y.sent(),[3,7];case 6:n=null!==(h=window.dataInput)&&void 0!==h?h:fs._.createDataInput(t),y.label=7;case 7:return d.ReportHelper.monitor007Status(d.MonitorName.IS_CHUNK_RATE,t.isChunked?d.Status007.SUCCESS:d.Status007.FAIL),window.dataInput=void 0,this.permissionCtrl=q.qO.createInstance(this.clientVars),this.contextService.inject("permission",this.permissionCtrl),this.updateDocInitTitle(),a=this.docEnvManager.getDataBasedDocEnv(this.clientVars,n,this.permissionCtrl),p.Logger.info("RenderType",a.renderType),d.ReportHelper.tdwReport({opername:"doc_word_editor",module:"page",action:a.layoutType===d.LayoutType.Paged?"pageview_page":"pageview_web"}),this.editor.updateDocEnv(a),i.setInitialData(n),window.__editor=this.editor,s=p.PerfUtil.now()-e,p.Logger.info("perf|initialDataTotalTime=".concat(s,"ms")),this.eventEmitter.emit("$modelInited",this.editor),Ui().onReset({secretId:(0,Io.pb)(),editor:this.editor}),c=function(){return b.permissionCtrl.canEdit},l={notificationCenter:this.editor,changesetManager:i,clientVars:this.clientVars,canEdit:c,editor:this.editor,eventEmitter:this.eventEmitter},this.collabCenterAdapter=new za(l),this.contextService.inject("collabCenterAdapter",this.collabCenterAdapter),t.isChunked&&o&&(this.collabCenterAdapter.pause(Fo.PauseOrResumeType.ALL),o.setFinishCb(this.collabCenterAdapter)),this.offline=new os((0,r.__assign)((0,r.__assign)({},l),{copyAllDataToMemory:function(){p.Logger.warn("copyAllDataToMemory."),b.editor.service.getSelection().wholeStory(),b.editor.clipboardManager.copy()},clearUndoRedoStack:function(){b.editor.run("clearUndoRedoStack")}})),u=function(){return b.collabCenterAdapter.getVersion()},i.initPadRev(u),new P.Ce((function(){return b.clientVars.collab_client_vars.dirty})).registerPlugin(d.GlobalContext),null===(m=this.initDataCallback)||void 0===m||m.call(this),null===(v=null===(g=window.performance)||void 0===g?void 0:g.mark)||void 0===v||v.call(g,"MK_DATAINIT_END"),[2]}}))}))}))},e.prototype.onReset=function(e){return this.secretId=e.secretId,this.container=e.container,this.contextService=e.contextService,this.eventEmitter=e.eventEmitter,this._hideFirstScreen=!1,this.notificationTimes=0,this.fpsMonitor.reset(),this.init(),!0},e.prototype.load=function(){this.contextService.inject("permission",this.permissionCtrl),this.contextService.inject("collabCenterAdapter",this.collabCenterAdapter)},e.prototype.showNoSupportBrowserTips=function(){(p.PlatformUtil.isIE11()||p.PlatformUtil.isChrome()&&p.PlatformUtil.getChromeVersion()<53)&&Ga.default.show({message:lo.ZP.t("为了有更好的体验，推荐使用最新版Chrome浏览器。"),duration:5e3,autoClose:!0})},Object.defineProperty(e.prototype,"needWaitVipInfo",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.initOwnerVipStatus=function(){var e;return(0,r.__awaiter)(this,void 0,Promise,(function(){var t,n,o,i,a,s;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:t=null===(e=window.clientVars)||void 0===e?void 0:e.globalPadId,n="300000000$",o=t,"string"==typeof t&&t.startsWith(n)&&(o=t.substring(n.length)),i={file_id:o},r.label=1;case 1:return r.trys.push([1,4,,5]),[4,fetch("/api/personalize/owner/viplevel",{method:"POST",body:JSON.stringify(i),headers:{"Content-Type":"application/json"}})];case 2:return[4,r.sent().json()];case 3:return 0===(a=r.sent()).retcode&&(window.clientVars.ownerVipInfo={vip_level:a.result.vip_level}),[3,5];case 4:return s=r.sent(),p.Logger.error(s),[3,5];case 5:return[2]}}))}))},e.prototype.hideFirstScreen=function(){var e;Wo.u.getInstance(this.secretId).docRendered=!0,this._hideFirstScreen||(this._hideFirstScreen=!0,is.K.hideFirsScreenLoading(),p.Logger.info("PadEditor","hideFirstScreen"),p.PerfUtil.mark("hideFirstScreen"),as.L.getInstance().hide(),(e=document.createEvent("CustomEvent")).initCustomEvent("first_render_hided_quick_look",!0,!0,{}),document.dispatchEvent(e))},Object.defineProperty(e.prototype,"meloEditor",{get:function(){return this.editor},enumerable:!1,configurable:!0}),e.prototype.handleReport=function(e){var t;"2.1.0"===(null===(t=null==e?void 0:e.collab_client_vars)||void 0===t?void 0:t.dver)&&d.ReportHelper.monitor(d.MonitorName.OPENDOC30_WITH_21DATA)},e.prototype.updateDocInitTitle=function(){var e;ss.q.getInstance().updateDocInitTitle(),(null===(e=this.contextService.context.permission)||void 0===e?void 0:e.canEditTitle)&&this.store.update("canEditTitle",!0)},e.prototype.isChunkDataEnabled=function(){return this.clientVars.sourceOfClientVars!==c.dw.FROM_LOCAL&&this.clientVars.collab_client_vars.isChunked},(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==ls&&ls)?t:Object)],e.prototype,"multiEditorService",void 0),(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(o=void 0!==us.r&&us.r)?o:Object)],e.prototype,"loginService",void 0),(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(i=void 0!==de.O&&de.O)?i:Object)],e.prototype,"store",void 0),e}(),Cs=n(54541),Ts=n(65161),xs=function(){function e(e){this.platform=e}return e.loadMeloExt=function(e){Ts.A8.load(e)},e.prototype.loadLifecycleFeature=function(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t=this;return(0,r.__generator)(this,(function(n){return[2,new Promise((function(n){Cs.iz.loadLifecycleFeature(e,t.platform,n)}))]}))}))},e.prototype.mountLifecycleFeature=function(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Cs.iz.mountLifecycleFeature(e)];case 1:return t.sent(),[2]}}))}))},e}(),Ss=n(28223),Is=n(87782),ks=function(){function e(e,t,n){this.contextService=e,this.featureService=t,this.eventEmitter=n,this.isMeloExtLoaded=!1,this.isPublishLoaded=!1,this.isLevel1Loaded=!1,this.isLevel2Loaded=!1,this.isLevel3Loaded=!1,this.isLevel4Loaded=!1,this.isAllLoaded=!1,this.platform=Cs.Ev.Pc}var t,n,o;return e.prototype.$onReset=function(){},e.prototype.loadService=function(e){e&&!(0,K.B)(e)&&(xs.loadMeloExt(e),this.isMeloExtLoaded=!0)},e.prototype.init=function(e,t,n){var o;return(0,r.__awaiter)(this,void 0,void 0,(function(){var i,a=this;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return i=new xs(e),this.platform=e,null===(o=n.beforeInit)||void 0===o||o.call(n),[4,this.initFirstScreen(i,t,n)];case 1:return r.sent(),[4,(0,d.createIdleAsyncTask)((function(){return a.initAfterFirstScreen(i,t,n)}),{priority:Is.Priority.hight})];case 2:return r.sent(),[2]}}))}))},e.prototype.initFirstScreen=function(e,t,n){var o;return(0,r.__awaiter)(this,void 0,void 0,(function(){var i=this;return(0,r.__generator)(this,(function(a){switch(a.label){case 0:return p.Logger.info("初始化clientVars数据：".concat(d.PerfUtilLogger.now()-this.startTime)),[4,Es.getInstance().initClientData()];case 1:return a.sent(),null===(o=n.initClientDataCallback)||void 0===o||o.call(n),p.Logger.info("初始化clientVars数据完成：".concat(d.PerfUtilLogger.now()-performance.timing.navigationStart)),this.loadService(t),p.Logger.info("melo-ext加载完成：".concat(d.PerfUtilLogger.now()-performance.timing.navigationStart)),p.Logger.info("level1加载开始：".concat(d.PerfUtilLogger.now()-performance.timing.navigationStart)),e.loadLifecycleFeature(Cs.YV.Level1).then((function(){return(0,r.__awaiter)(i,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,e.mountLifecycleFeature(Cs.YV.Level1)];case 1:return r.sent(),null===(t=n.level1LoadedCallback)||void 0===t||t.call(n),p.Logger.info("level1加载完成：".concat(d.PerfUtilLogger.now()-performance.timing.navigationStart)),[2]}}))}))})),[2]}}))}))},e.prototype.initAfterFirstScreen=function(e,t,n){var o,i;return(0,r.__awaiter)(this,void 0,void 0,(function(){var a,s,l,u,f=this;return(0,r.__generator)(this,(function(_){switch(_.label){case 0:return a=(0,c.Yi)(),s=null===(o=a.privilegeAttribute)||void 0===o?void 0:o.can_edit,l=this.contextService.context.isPublish,p.Logger.info("level2加载开始：".concat(d.PerfUtilLogger.now()-this.startTime)),l?[4,e.loadLifecycleFeature(Cs.YV.Publish)]:[3,2];case 1:return _.sent(),this.isPublishLoaded=!0,d.PerfUtilLogger.mark("featuresPublishInitEnd"),[3,4];case 2:return[4,e.loadLifecycleFeature(Cs.YV.Level2)];case 3:_.sent(),this.isLevel2Loaded=!0,d.PerfUtilLogger.mark("featuresReadonlyInitEnd"),_.label=4;case 4:return s&&p.Logger.info("level3预加载开始：".concat(d.PerfUtilLogger.now()-this.startTime)),u=s?e.loadLifecycleFeature(Cs.YV.Level3):Promise.resolve(),[4,e.mountLifecycleFeature(l?Cs.YV.Publish:Cs.YV.Level2)];case 5:return _.sent(),p.Logger.info("level2加载完成：".concat(d.PerfUtilLogger.now()-performance.timing.navigationStart)),null===(i=n.level2LoadedCallback)||void 0===i||i.call(n),s?[4,u]:[3,8];case 6:return _.sent(),[4,e.mountLifecycleFeature(Cs.YV.Level3)];case 7:return _.sent(),p.Logger.info("level3加载完成：".concat(d.PerfUtilLogger.now()-this.startTime)),this.isLevel3Loaded=!0,this.eventEmitter.emit("$featureEditLoaded"),d.PerfUtilLogger.mark("featuresEditInitEnd"),[3,9];case 8:d.GlobalContext.on(q.ap.ON_PERMISSION_CHANGE,(function(t){return(0,r.__awaiter)(f,void 0,void 0,(function(){return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return t.permissionCtrl.canEdit?(p.Logger.info("level3加载开始(权限变更)：".concat(d.PerfUtilLogger.now()-this.startTime)),[4,e.loadLifecycleFeature(Cs.YV.Level3)]):[3,3];case 1:return n.sent(),[4,e.mountLifecycleFeature(Cs.YV.Level3)];case 2:n.sent(),p.Logger.info("level3加载完成(权限变更)：".concat(d.PerfUtilLogger.now()-this.startTime)),this.isLevel3Loaded=!0,this.eventEmitter.emit("$featureEditLoaded"),n.label=3;case 3:return[2]}}))}))}),this),_.label=9;case 9:return t.view.forceRerender(),t.isRenderLiteType()||d.TaskScheduler.getInstance().enableAggressiveMode(),d.GlobalContext.fire(new d.FeatureLoadFinishedNotification),this.contextService.inject("isFeatureLoaded",!0),this.eventEmitter.emit("$featureLoaded"),Bo.Q.instance.onFeatureLoaded(),d.PerfUtilLogger.mark("featuresInitEnd"),Is.scheduler.scheduleTask((function(){p.Logger.info("level4加载开始：".concat(d.PerfUtilLogger.now()-f.startTime)),e.loadLifecycleFeature(Cs.YV.Level4).then((function(){return(0,r.__awaiter)(f,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return[4,e.mountLifecycleFeature(Cs.YV.Level4)];case 1:return t.sent(),p.Logger.info("level4加载完成：".concat(d.PerfUtilLogger.now()-this.startTime)),[2]}}))}))})),f.isLevel4Loaded=!0,f.isAllLoaded=!0})),[2]}}))}))},e.prototype.destory=function(){d.GlobalContext.removeListener(q.ap.ON_PERMISSION_CHANGE,this),this.isMeloExtLoaded=!1,this.isPublishLoaded=!1,this.isLevel1Loaded=!1,this.isLevel2Loaded=!1,this.isLevel3Loaded=!1,this.isLevel4Loaded=!1,this.isAllLoaded=!1},Object.defineProperty(e.prototype,"startTime",{get:function(){var e=Ss._.getInstance().clickStart;return e?Number(e):performance.timing.navigationStart},enumerable:!1,configurable:!0}),e=(0,r.__decorate)([(0,_e.t)(),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==S.O&&S.O)?t:Object,"function"==typeof(n=void 0!==ce.U&&ce.U)?n:Object,"function"==typeof(o=void 0!==Fe.v&&Fe.v)?o:Object])],e)}(),Rs=function(){function e(){}return e.prototype.destroy=function(){var e,t,n,r,o;p.Logger.info("WordOnlineDocument","destroy document, time: ".concat((new Date).toString())),null===(e=window.__softKeyboardDisposeAllInstances)||void 0===e||e.call(window),null===(n=(t=window).onbeforeclosetab)||void 0===n||n.call(t),null===(o=null===(r=window.App.offlineEditAdapter)||void 0===r?void 0:r.release)||void 0===o||o.call(r),document.dispatchEvent(new CustomEvent("DestroyDocumentNotification"))},e}(),As=function(){var e=this;this.ssrFlowLayerWithDocument=function(){$.get(window.location.href,{},(function(t){e.generateSSRLayer(t,"ssr-layer-html")}),"html")},this.ssrFlowLayerWithDevServer=function(){var t=window.clientVars.collab_client_vars,n=t.initialAttributedText,r=t.apool,o={text:n.text,attribs:n.attribs},i={atext:JSON.stringify(o),apool:JSON.stringify(r)};$.post("http://127.0.0.1:8090/doc-ssr/generate",i,(function(t){e.generateSSRLayer(t,"ssr-layer-dev")}))},this.generateSSRLayer=function(t,n){void 0===n&&(n="ssr-layer");var r=e.createSSRLayer(n);document.body.appendChild(r);var o=r.contentWindow;e.renderSSRLayerWithString(o,t),e.executeSSRInlineJS(o,t)},this.createSSRLayer=function(e){var t=document.getElementById(e);return t&&t.remove(),(t=document.createElement("iframe")).setAttribute("id","ssr-layer"),t.setAttribute("style",""),Object.assign(t.style,{position:"absolute",zIndex:"99999",opacity:"0.7",top:"0px",left:"0px",border:"none",width:"100%",height:"100%"}),t},this.renderSSRLayerWithString=function(e,t){e.document.body.parentElement.innerHTML=t},this.executeSSRInlineJS=function(e,t){var n="/*dev-server-start*/",r=t.indexOf(n)+n.length,o=t.indexOf("/*dev-server-end*/");o>-1&&e.eval(t.slice(r,o))},window.ssrUtils={ssrFlowLayerWithDevServer:this.ssrFlowLayerWithDevServer,ssrFlowLayerWithDocument:this.ssrFlowLayerWithDocument}},Os=function(){function e(e,t,n){this.contextService=e,this.eventEmitter=t,this.layoutExtensionService=n}var t,n,o,i,a;return e.prototype.attachEditor=function(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n;return(0,r.__generator)(this,(function(r){return n=Es.createInstance({secretId:(0,Io.pb)(),container:e,contextService:this.contextService,eventEmitter:this.eventEmitter}),this.startupService.isMeloExtLoaded&&xs.loadMeloExt(n.editor),n.editor.modelWrapperMgr.add(d.LayoutInputNodeType.Section,(0,ko.G)(n.editor,this.drawerService)),n.editor.on(d.RenderNotificationTypes.SELECTION_END,(function(){return t.onSelectionChange()}),this),n.editor.on(d.StateNotification.CusorPropChange,t.onDataChange,this),n.editor.on(d.FocusBlurNotificationType.ON_FOCUS,t.onFocus,this),n.editor.on(d.FocusBlurNotificationType.ON_BLUR,t.onBlur,this),window.pad=n,window.onlineDocument=new Rs,new As,this.layoutExtensionService.applyExtension(n.editor),[2,n.editor]}))}))},e.prototype.requestBlur=function(e){e.fire(new d.FocusBlurNotification(d.FocusBlurNotificationType.ON_REQUEST_BLUR)),e.fire(new d.FocusBlurNotification(d.FocusBlurNotificationType.ON_BLUR))},e.prototype.requestFocus=function(e){e.fire(new d.FocusBlurNotification(d.FocusBlurNotificationType.ON_REQUEST_FOCUS)),e.fire(new d.FocusBlurNotification(d.FocusBlurNotificationType.ON_FOCUS))},e.prototype.setValue=function(){},e.prototype.isCaret=function(e){return e.isCaret()},e.prototype.destroy=function(e){e.detach()},(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(i=void 0!==ks&&ks)?i:Object)],e.prototype,"startupService",void 0),(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(a=void 0!==cn.zv&&cn.zv)?a:Object)],e.prototype,"drawerService",void 0),e=(0,r.__decorate)([(0,Ro.L)("melo"),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==S.O&&S.O)?t:Object,"function"==typeof(n=void 0!==Fe.v&&Fe.v)?n:Object,"function"==typeof(o=void 0!==Po&&Po)?o:Object])],e)}(),Ls=n(68656),Ms=n(75779),Ns=function(e){return function(t,n){var r=t.clone();return function(t){return 0===e.getRangeFromIndex(t.getBPFirstIndex(),t.getBPLastIndex()).begin()}(n)&&(r.spacing.after=r.spacing.after+(0,p.pxToTwips)(Ms.ds+Ms.rY)),{data:r}}},Ds=n(85464),Ps=(function(){function e(){}e.prototype.$onEditorOpen=function(e){e.modelWrapperMgr.add(d.LayoutInputNodeType.Paragraph,(function(e,t){var n,r=e.clone();if(e instanceof d.ListInfo&&e.isTask){var o=t.parent,i=(0,p.pxToTwips)(135);if(o instanceof d.SectionNode){var a=null===(n=o.getProperty())||void 0===n?void 0:n.pgMar.right;i="number"==typeof a?a:i}var s=(0,p.pxToTwips)(135)-i;r.ind.right=r.ind.right+s}return{data:r}})),Ds.W.isApiDoc&&e.modelWrapperMgr.add(d.LayoutInputNodeType.Paragraph,Ns(e))},e=(0,r.__decorate)([(0,Ls.L)({name:uo.C.ListQwxtodoRender,adapters:["melo"]})],e)}(),n(36013)),Fs=n(465),Bs=n(50982),Us=n(595),Hs=n(9234),js=n(27440),Ws=ve().lazy((function(){return n.e(7066).then(n.bind(n,7066)).then((function(e){return{default:e.RenderAddonLink}}))})),Vs=ve().lazy((function(){return n.e(7066).then(n.bind(n,7066)).then((function(e){return{default:e.RenderAddonLinkCard}}))})),zs=(0,js.Z)(Ws),Gs=((0,js.Z)(Vs),n(70401)),Ys=ve().lazy((function(){return n.e(7735).then(n.bind(n,97735)).then((function(e){return{default:e.RenderDocLinkCard}}))})),qs=(0,js.Z)(Ys),Zs=ve().lazy((function(){return n.e(1375).then(n.bind(n,11375)).then((function(e){return{default:e.RenderDocLinkPlaceholder}}))})),Js=(0,js.Z)(Zs),Ks=ve().lazy((function(){return n.e(6220).then(n.bind(n,6220)).then((function(e){return{default:e.RenderDocLinkProgress}}))})),Qs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.render=function(){return ve().createElement(ve().Suspense,{fallback:null},ve().createElement(Ks,(0,r.__assign)({},this.props)))},t}(ve().Component),Xs=ve().lazy((function(){return n.e(4205).then(n.bind(n,60917)).then((function(e){return{default:e.RenderLinkCard}}))})),$s=(0,js.Z)(Xs),ec=ve().lazy((function(){return n.e(7209).then(n.bind(n,7209)).then((function(e){return{default:e.RenderNormalLink}}))})),tc=(0,js.Z)(ec),nc=n(62074),rc=n(32854),oc=n(99766),ic=n(80343),ac=function(e){return function(e){var t,n=e.fieldResultProp.clone();switch(null===(t=e.fieldCode.switches)||void 0===t?void 0:t[d.FieldCommonSwitchesName.displayLayoutType]){case d.FieldDisplayLayoutType.Card:return{};case d.FieldDisplayLayoutType.Inline:var r=(0,p.pxToTwips)(ic.ox+ic.uO);return{metric:{padding:{before:0,start:(0,p.pxToTwips)(ic.ox+ic.uO)+((null==n?void 0:n.renderFontSize)||0)*ic.Di,after:0,end:r}},fieldResultProp:n};default:return{fieldResultProp:n}}}},sc=n(88239),cc=n(32230),lc=n.n(cc),uc=n(21329),dc={"link-inline":"link-inline--VZc3T",linkInline:"link-inline--VZc3T","link-inline-active":"link-inline-active--8EmC6",linkInlineActive:"link-inline-active--8EmC6","doc-link-card-wrapper":"doc-link-card-wrapper--DDTuc",docLinkCardWrapper:"doc-link-card-wrapper--DDTuc","link-inline-none":"link-inline-none--MIyfc",linkInlineNone:"link-inline-none--MIyfc","link-inline-lite":"link-inline-lite--YVdIu",linkInlineLite:"link-inline-lite--YVdIu","link-inline-canvas":"link-inline-canvas--PE64Y",linkInlineCanvas:"link-inline-canvas--PE64Y","text-wrapper":"text-wrapper--+sm8p",textWrapper:"text-wrapper--+sm8p","link-icon-wrapper":"link-icon-wrapper--6CVi-",linkIconWrapper:"link-icon-wrapper--6CVi-","link-button-wrapper":"link-button-wrapper--Fc60A",linkButtonWrapper:"link-button-wrapper--Fc60A","link-card-wrapper":"link-card-wrapper--xK1lB",linkCardWrapper:"link-card-wrapper--xK1lB","link-card-wrapper-mobile":"link-card-wrapper-mobile--7WJan",linkCardWrapperMobile:"link-card-wrapper-mobile--7WJan","link-card-link-wrapper":"link-card-link-wrapper--wBBxL",linkCardLinkWrapper:"link-card-link-wrapper--wBBxL","link-card-link-wrapper-desc":"link-card-link-wrapper-desc--xTpBo",linkCardLinkWrapperDesc:"link-card-link-wrapper-desc--xTpBo",left:"left--1uXHn",placeholder:"placeholder--NN6LQ",center:"center--GdYoF",title:"title--khJt-",desc:"desc--k2vMg",url:"url--WEZSP",right:"right---Qzh9",action:"action--lPeoK","link-card-overbtn":"link-card-overbtn--y0JSk",linkCardOverbtn:"link-card-overbtn--y0JSk","link-card-wedoc-wrapper":"link-card-wedoc-wrapper--RF3XB",linkCardWedocWrapper:"link-card-wedoc-wrapper--RF3XB","link-card-wedoc-wrapper-preview":"link-card-wedoc-wrapper-preview--HTbcu",linkCardWedocWrapperPreview:"link-card-wedoc-wrapper-preview--HTbcu","link-card-wedoc-wrapper-mobile":"link-card-wedoc-wrapper-mobile--TJxuV",linkCardWedocWrapperMobile:"link-card-wedoc-wrapper-mobile--TJxuV","melo-wedrive-file-card-wedoc-wrapper-preview":"melo-wedrive-file-card-wedoc-wrapper-preview--LVVWK",meloWedriveFileCardWedocWrapperPreview:"melo-wedrive-file-card-wedoc-wrapper-preview--LVVWK",success:"success--OU-CP",loading:"loading--u0Daj",error:"error--NKvGJ",deleted:"deleted--ObLpY",auth:"auth--gjkEi",icon:"icon--jPQH3","preview-text":"preview-text--vcQH5",previewText:"preview-text--vcQH5","inner-wrapper":"inner-wrapper--7AkrG",innerWrapper:"inner-wrapper--7AkrG",text:"text--hOJCQ",actions:"actions--DL3C+"},pc=n(94231),fc=n(56872),_c=n(89747),hc=n(12576),mc=n(1049),gc=n(81800),vc=n(13616),bc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),Object.defineProperty(t.prototype,"subtype",{get:function(){return this.props.fieldInfo.fieldCode.switches[d.FieldCommonSwitchesName.subtype]},enumerable:!1,configurable:!0}),t.prototype.fontSizePx=function(e){var t,n,r;return(0,d.isLeafContainer)(e)||(0,d.isContainerBoxLite)(e)?0:(0,d.isFieldBox)(e)?(0,p.twipsToPx)((null===(t=e.content)||void 0===t?void 0:t.textStyle.renderFontSize)||0):(0,p.twipsToPx)((null===(r=null===(n=e.content)||void 0===n?void 0:n.property)||void 0===r?void 0:r.renderFontSize)||0)},Object.defineProperty(t.prototype,"defaultIcon",{get:function(){return function(e){var t,n=e.fieldCode.switches,o=n[Us.h_.fileFavicon];if(o)return o;var i=(0,sc.lm)(e);if(!Object.prototype.hasOwnProperty.call(nc.x7,i))return pc.Z;if(i===_o.Au.DRIVE){var a={doc:function(){return hc.Z},xlsx:function(){return mc.Z},txt:function(){return fc.Z},ppt:function(){return _c.Z}},s=(null===(t=e.fieldResult)||void 0===t?void 0:t.result)||n[Us.h_.fileName];if(!s)return pc.Z;var c,l=s.split("."),u=l[l.length-1];return u?(Object.entries(nc.Fs).forEach((function(e){var t=(0,r.__read)(e,2),n=t[0];-1!==t[1].indexOf(u)&&(c=n)})),c&&Object.prototype.hasOwnProperty.call(a,c)?a[c]():pc.Z):pc.Z}return nc.x7[i]||pc.Z}(this.props.fieldInfo)},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this.updateAddonLinkIcon()},t.prototype.renderIcon=function(e,t){return"string"==typeof e?ve().createElement("img",{src:e,style:t}):ve().cloneElement(e,{style:t})},t.prototype.updateAddonLinkIcon=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,t,n,o,i,a;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:if(this.subtype!==_o.m7.AddonLink)return[2];gc.DocAddonBridge.updateMetaInfo(function(){var e=(0,c.Yi)(),t=e.creatorId,n=e.userInfo,r=e.globalPadId,o=(null==n?void 0:n.tinyId)||(null==n?void 0:n.userId)||"";return{fileId:r,fileType:gc.FileType.DOC,creatorId:t,uid:o}}()),e=this.props.fieldInfo.fieldCode.switches,r.label=1;case 1:return r.trys.push([1,3,,4]),t=e[vc.fC.originUrl],n=e[vc.fC.iframeId],[4,gc.DocAddonBridge.getIconOfAddonLink(t,n)];case 2:return o=r.sent(),i=this.renderIcon(o,this.state.iconStyle),[2,this.setState({icon:i})];case 3:return a=r.sent(),p.Logger.error("[HYPERLINK ".concat(e[d.FieldCommonSwitchesName.displayLayoutType],"]获取icon失败：").concat(a)),[3,4];case 4:return[2]}}))}))},t}(ge.PureComponent),yc=function(e){function t(t){var n=e.call(this,t)||this,r=n.fontSizePx(t.layoutBox),o="".concat(r,"px"),i=r?{minWidth:o,maxWidth:o,width:o,height:o}:{};return n.state={icon:n.renderIcon(n.defaultIcon,i),iconStyle:i,disableBorder:!1},n}return(0,r.__extends)(t,e),t.prototype.renderLeftComponent=function(){return ve().createElement("div",{className:"".concat(dc.left)},this.state.icon)},t.prototype.renderCenterComponent=function(){var e,t=this.props.fieldInfo,n=(0,Hs.P5)(t.fieldCode),r=t.fieldCode.switches,o=(null===(e=t.fieldResult)||void 0===e?void 0:e.result)||r[Us.h_.fileName]||"";if(this.subtype===_o.m7.DocLink){var i=(0,sc.lm)(t),a=[_o.Au.WEDRIVE_IMAGE,_o.Au.WEDRIVE_VIDEO].includes(i),s=r[Us.h_.fileCreatorNick];return ve().createElement("div",{className:dc.center},ve().createElement("span",{className:dc.title},o),a&&ve().createElement("span",{className:dc.wedrive},"$",(0,ii.$t)("来自微盘")),s&&ve().createElement("span",{className:dc.creator},"".concat(s," ").concat((0,ii.$t)("创建"))))}var c=r[Us.h_.fileDesc];return ve().createElement("div",{className:"".concat(dc.center)},ve().createElement("div",{className:"".concat(dc.title)},(0,d.getPrintableText)(null!=o?o:n)),c&&ve().createElement("div",{className:"".concat(dc.desc)},c),ve().createElement("div",{className:"".concat(dc.url)},n))},t.prototype.renderRightComponent=function(){var e=this;if(this.subtype!==_o.m7.DocLink)return ve().createElement(ve().Fragment,null);var t=this.props.fieldInfo.fieldCode,n=t.name,o=t.switches[d.FieldCommonSwitchesName.subtype],i=x.Am.get(Bs.D),a=ve().createElement(jt.Tooltip,{title:(0,ii.$t)("doc-link:open-in-new-window"),placement:"top"},ve().createElement("span",{style:{display:"flex"}},ve().createElement(uc.Z,null)));return ve().createElement("div",{className:dc.right},ve().createElement("div",{className:dc.action,onClick:function(t){var a,s;t.stopPropagation(),t.preventDefault(),null===(s=(a=i.getFieldHookConfig(n,o)).onClick)||void 0===s||s.call(a,(0,r.__assign)((0,r.__assign)({},e.props),{event:t,customObject:{isForceOpen:!0}}))}},!this.props.editor.docEnv.isSSR&&a))},t.prototype.render=function(){var e,t=lc()(((e={})["field-code-draggable"]=!0,e["".concat(dc["link-card-wrapper"])]=!0,e["".concat(dc["link-card-wrapper-mobile"])]=!1,e["".concat(dc["link-card-link-wrapper"])]=!0,e["".concat(dc["link-card-link-wrapper-desc"])]=!!this.props.fieldInfo.fieldCode.switches[Us.h_.fileDesc],e["".concat(dc["link-card-link-wrapper-mobile"])]=!1,e)),n={borderColor:this.state.disableBorder?"transparent":void 0};return ve().createElement("div",{className:t,style:n},this.renderLeftComponent(),this.renderCenterComponent(),this.renderRightComponent())},t}(bc),wc=n(52792),Ec=function(e){function t(t){var n=e.call(this,t)||this;n.defaultStyle={padding:ic.uO,margin:ic.ox},n.respondEventTimer=null,n.docLinkRef=ve().createRef(),n.onWheel=function(e){if(!(Math.abs(e.deltaY)>Math.abs(e.deltaX))||e.shiftKey){if(!n.respondEventTimer){if(n.docLinkRef.current){var t=(0,wc.s)(n.docLinkRef.current,2);t&&(t.style.pointerEvents="none")}n.respondEventTimer=(0,p.debounce)((function(){if(n.docLinkRef.current){var e=(0,wc.s)(n.docLinkRef.current,2);e&&(e.style.pointerEvents="all")}n.respondEventTimer=null}),300)}n.respondEventTimer()}};var r=n.fontSizePx(t.layoutBox),o="".concat(r,"px"),i=r?{minWidth:o,maxWidth:o,width:o,height:o}:{};return n.state={icon:n.renderIcon(n.defaultIcon,i),iconStyle:i},n}return(0,r.__extends)(t,e),Object.defineProperty(t.prototype,"edgeWidth",{get:function(){return this.defaultStyle.padding+this.defaultStyle.margin+this.fontSizePx(this.props.layoutBox)*ic.Di},enumerable:!1,configurable:!0}),t.prototype.getContainerStyleFromOtherRenderType=function(e){var t={};return e.renderType===d.RenderType.Canvas&&(0,d.isFieldBox)(this.props.layoutBox)?t=this.getCanvasStyle(this.props.layoutBox):e.renderType===d.RenderType.Lite&&(0,d.isFieldBoxLite)(this.props.layoutBox)&&(t=this.getLiteStyle(this.props.layoutBox)),t},t.prototype.getLiteStyle=function(e){var t,n=null===(t=e.content)||void 0===t?void 0:t.property;return n?(0,r.__assign)((0,r.__assign)({},{maxWidth:"100%"}),n?{color:n.color.val}:{}):{}},t.prototype.getCanvasStyle=function(e){return{maxWidth:(0,p.twipsToPx)(e.totalWidth)-this.defaultStyle.margin}},t.prototype.render=function(){var e,t=this.props,n=t.children,o=t.editor,i=t.overrideStyle,a=o.docEnv,s=this.defaultStyle,c=this.getContainerStyleFromOtherRenderType(a),l=lc()(((e={})["field-code-draggable"]=!0,e["".concat(dc["link-inline"])]=!0,e["".concat(dc["link-inline-none"])]=!0,e["".concat(dc["link-inline-lite"])]=a.renderType===d.RenderType.Lite,e["".concat(dc["link-inline-canvas"])]=a.renderType===d.RenderType.Canvas,e)),u=this.defaultStyle.padding;return ve().createElement("span",{className:l,style:(0,r.__assign)((0,r.__assign)((0,r.__assign)((0,r.__assign)({padding:"0px ".concat(s.padding,"px"),margin:"0px ".concat(s.margin,"px"),fontSize:"".concat(this.fontSizePx,"px")},c),{height:"100%"}),d.CssUtil.cssPropsToStyle(i)),{display:"flex",alignItems:"center"}),onWheel:this.onWheel,ref:this.docLinkRef},ve().createElement("span",{className:"".concat(dc["link-icon-wrapper"]),style:{left:u}},this.state.icon),ve().createElement("span",{className:"".concat(dc["text-wrapper"]),style:{paddingLeft:"".concat(this.edgeWidth-u,"px")}},n))},t}(bc),Cc=function(){function e(){}return e.prototype.createAddonLinkComponent=function(e){var t=e.children,n=e.fieldInfo,o=(0,sc.w0)(n);if(!o)return null;var i=(0,r.__assign)((0,r.__assign)({},e),{iframeInfo:o});return o.mode===d.FieldDisplayLayoutType.Text?ve().createElement(tc,(0,r.__assign)({subType:_o.m7.AddonLink},i),t):ve().createElement(zs,(0,r.__assign)({},i),t)},e.prototype.createDocLinkComponent=function(e){var t,n=e.children,o=e.fieldInfo,i=(0,sc.sQ)(o);if(!i)return null;var a=(0,r.__assign)((0,r.__assign)({},e),{docLink:i});switch(i.fileType){case Us.m_.ProgressLoading:return ve().createElement(Qs,(0,r.__assign)({},a),n);case Us.m_.Placeholder:return ve().createElement(Js,(0,r.__assign)({},a),n);default:return i.displayLayoutType===d.FieldDisplayLayoutType.Text?ve().createElement(tc,(0,r.__assign)({subType:_o.m7.DocLink},a),n):[d.FieldDisplayLayoutType.Card,d.FieldDisplayLayoutType.Preview].includes(null!==(t=i.displayLayoutType)&&void 0!==t?t:"")?(0,nc.KC)(i)?ve().createElement($s,(0,r.__assign)({},a),n):ve().createElement(qs,(0,r.__assign)({},a),n):ve().createElement(Gs.m,(0,r.__assign)({},a),n)}},e.prototype.createNormalLinkComponent=function(e){return this.createDocLinkComponent(e)},e.prototype.getSubtype=function(e){var t,n=e.fieldCode,r=n.switches,o=n.instructions;return null!==(t=r[d.FieldCommonSwitchesName.subtype])&&void 0!==t?t:null==o?void 0:o[0]},e.prototype.getOverrideWidthStyle=function(e){var t,n,r,o=null!==(t=this.getSubtype(e))&&void 0!==t?t:"";if([_o.m7.DocLink,_o.m7.NormalLink].includes(o)){var i=null!==(r=null===(n=e.fieldCode.switches)||void 0===n?void 0:n[d.FieldCommonSwitchesName.displayLayoutType])&&void 0!==r?r:"";return[d.FieldDisplayLayoutType.Card,d.FieldDisplayLayoutType.Preview].includes(i)?"100%":"auto"}},e}(),Tc=function(e){return function(t){var n=t.children,o=t.box,i=t.fieldInfo,a="field-trigger-".concat(o.uuid),s=new Cc,c=i&&s.getSubtype(i);if(i&&c){var l=x.Am.get(Bs.D),u={editor:e,layoutBox:o,fieldInfo:i},p=function(e,t){var n,o=l.getFieldHookConfig(i.fieldCode.name,c);null===(n=o[e])||void 0===n||n.call(o,(0,r.__assign)((0,r.__assign)({},u),{event:t}))},f={editor:e,layoutBox:o,fieldInfo:i,children:n},_=i.displayLayoutType===d.FieldDisplayLayoutType.Text;return{component:ve().createElement("div",{key:a,style:{whiteSpace:"nowrap"},onTouchStart:function(e){return p("onTouchStart",e)},onTouchMove:function(e){return p("onTouchMove",e)},onTouchEnd:function(e){return p("onTouchEnd",e)},onMouseEnter:function(e){return p("onMouseEnter",e)}},_?n:ve().createElement(Ec,(0,r.__assign)({},f))),overrideStyle:{maxWidth:"calc(100% - 5px)",width:s.getOverrideWidthStyle(i)}}}return{component:ve().createElement(rc.x,{editor:e,layoutBox:o,fieldInfo:i,key:a},n),overrideStyle:{}}}},xc=function(e){return(0,d.isTextBox)(e)?e.textString():""};function Sc(e){return e.children.map((function(e){return e.hidden?null:ve().createElement("span",{className:"melo-leaf",style:(0,r.__assign)((0,r.__assign)({},d.CssUtil.cssPropsToStyle(d.CssUtil.computeStyles(e).cssProperties)),{verticalAlign:"baseline"}),key:e.uuid},xc(e))}))}var Ic=[_o.m7.AddonLink,_o.m7.TDSheetIFrame];function kc(e){var t,n,o=e.editor,i=e.ctx,a=e.box,s=e.fieldInfo,c=e.cssStyle,l=e.bridge,u=null===(t=s.fieldCode.instructions)||void 0===t?void 0:t[0],f=s.fieldCode.switches,_=null==f?void 0:f[d.FieldCommonSwitchesName.subtype];if((u||!f||f[Us.a.internalJump])&&_){var h=(0,d.makeFrame)(0,0,a.totalWidth,a.totalHeight),m=(0,Hs.Vo)(i,a),g=null===(n=a.fieldInfo)||void 0===n?void 0:n.layoutType,v=null,b={editor:o,layoutBox:a,fieldInfo:s,overrideStyle:c,bridge:l,renderCanvas:!0};if(d.FieldLayoutType.Text===g)v=function(e,t){var n=e.editor,o=e.layoutBox,i=e.fieldInfo,a=e.overrideStyle,s=e.bridge,c=e.renderCanvas,l=o.children.map((function(e){return e.hidden?null:ve().createElement("span",{className:"melo-leaf",style:(0,r.__assign)((0,r.__assign)({paddingBottom:"".concat(Math.round((0,p.twipsToPx)(e.totalHeight)/8),"px")},d.CssUtil.cssPropsToStyle(d.CssUtil.computeStyles(e).cssProperties)),{verticalAlign:"baseline"}),key:Math.random()},xc(e))})).filter((function(e){return!e}));return ve().createElement(tc,{editor:n,layoutBox:o,fieldInfo:i,subType:t,key:"field-trigger-".concat(o.uuid),renderCanvas:c,overrideStyle:a,bridge:s},l)}(b,_);else{var y=(new Cc)[Ic.includes(_)?"createAddonLinkComponent":"createDocLinkComponent"];v=s&&y((0,r.__assign)((0,r.__assign)({},b),{key:"field-trigger-".concat(a.uuid),fieldInfo:s,children:Sc(a)}))}if(v){var w=d.PoolNodeFactory.obtain(d.IComponentView,a.uuid,h,v,m);i.addView(w)}}}var Rc={textRenderConfig:{decorator:{decoratorCallback:Tc,bridgeKey:oc.zE.DocLink},modelWrapper:ac,draw:kc},containerRenderConfig:{children:function(e){return ve().createElement(yc,(0,r.__assign)({},e))}}},Ac={textRenderConfig:{decorator:{decoratorCallback:Tc,bridgeKey:oc.zE.NormalLink},modelWrapper:ac,draw:kc},containerRenderConfig:{children:function(e){return ve().createElement(yc,(0,r.__assign)({},e))}}},Oc={textRenderConfig:{decorator:{decoratorCallback:Tc,bridgeKey:oc.zE.AddonLink},modelWrapper:ac,draw:kc},containerRenderConfig:{children:function(e){return ve().createElement(yc,(0,r.__assign)({},e))}}},Lc=[d.FieldDisplayLayoutType.Text,d.FieldDisplayLayoutType.Inline,d.FieldDisplayLayoutType.Card,d.FieldDisplayLayoutType.Preview],Mc={oneLineContent:56,twoLinesContent:66,threeLinesContent:110},Nc=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isAutoUpdate=!1,t.isShowDropdowns=!1,t.isShowHover=!1,t}return(0,r.__extends)(t,e),t.prototype.canFocusInField=function(e){var t=e.switches;return!((null==t?void 0:t[d.FieldCommonSwitchesName.displayLayoutType])!==d.FieldDisplayLayoutType.Text||(0,Hs.wV)(e))},t.prototype.getFieldLayoutType=function(e){var t=e.switches,n=void 0===t?{}:t;if(0===Object.keys(n).length)return d.FieldDisplayLayoutType.Inline;var r=n[d.FieldCommonSwitchesName.displayLayoutType];return Lc.includes(r)?r:d.FieldDisplayLayoutType.Text},t.prototype.getFieldWidth=function(e){var t,n=null===(t=e.instructions)||void 0===t?void 0:t[0],r=e.switches;return n&&(null==r?void 0:r[d.FieldCommonSwitchesName.displayLayoutType])===d.FieldDisplayLayoutType.Card?(0,p.pxToTwips)(420):0},t.prototype.getPluginContainerFitRule=function(t){var n=e.prototype.getPluginContainerFitRule.call(this,t);if(!t||!t.instructions)return n;var r=(0,nc.re)(t);return r&&nc.zj.isWeDrivePreview(r)?{fitToParentWidth:!1,fitToParentHeight:!1}:n},t.prototype.getFieldHeight=function(e){var t,n=e.switches,r=null==n?void 0:n[d.FieldCommonSwitchesName.subtype];if(r){var o=null==n?void 0:n[d.FieldCommonSwitchesName.displayLayoutType],i=null==n?void 0:n[Us.hq.fileDesc||""];return o===d.FieldDisplayLayoutType.Card?this.getCardHeight(r,!!i):o===d.FieldDisplayLayoutType.Preview?this.getPreviewHeight():r&&(null===(t=this["handle".concat(o,"Height")])||void 0===t?void 0:t.call(this,r))}},t.prototype.getCardHeight=function(e,t){return e===_o.m7.DocLink?(0,p.pxToTwips)(Mc.oneLineContent):t?(0,p.pxToTwips)(Mc.threeLinesContent):(0,p.pxToTwips)(Mc.twoLinesContent)},t.prototype.getPreviewHeight=function(){return(0,p.pxToTwips)(360)},t}(d.FieldCodeProcessor),Dc=n(80699),Pc=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isAutoUpdate=!0,t}return(0,r.__extends)(t,e),t.prototype.canFocusInField=function(e){return!1},t.prototype.requiredContext=function(){return[d.FieldCodeLayoutContextKey.PAGE_COUNT]},t.prototype.getFieldLayoutText=function(e,n){return t.parse(e,n)},t.parse=function(e,t){return"".concat(t.pageCount)},t}(d.FieldCodeProcessor),Fc=ve().lazy((function(){return n.e(3707).then(n.bind(n,53707)).then((function(e){return{default:e.RenderAttachment}}))})),Bc=(0,js.Z)(Fc),Uc=n(5624);function Hc(e,t){return(0,d.isFieldBox)(e)?(0,p.twipsToPx)(e.edge.left)+(0,p.twipsToPx)(e.rect.width):t.displayLayoutType===d.FieldDisplayLayoutType.Preview||t.displayLayoutType===d.FieldDisplayLayoutType.Card?"100%":"auto"}var jc=n(17217),Wc={textRenderConfig:{decorator:{decoratorCallback:function(e){return function(t){var n=t.children,r=t.box,o=t.fieldInfo,i=t.bridge;if(!o)return{component:n,overrideStyle:{}};var a=(0,Uc.yS)(o.fieldCode);return{component:ve().createElement(Bc,{editor:e,layoutBox:r,fieldInfo:o,bridge:i,info:a,key:"field-trigger-".concat(r.uuid)},n),overrideStyle:{paddingLeft:0,width:Hc(r,a),textAlign:"start",height:"auto",lineHeight:"normal"}}}},bridgeKey:oc.zE.Attachment},modelWrapper:function(){return function(e){var t,n=(0,Uc.yS)(e.fieldCode).displayLayoutType;t=n===d.FieldDisplayLayoutType.Preview?new(d.PropertyFactory.getPropertyClass(d.PropertyType.RunProperty)):e.fieldResultProp.clone();var r=(0,p.pxToTwips)(20)+(t?(0,jc._y)(t.sz):0);return{metric:{padding:{before:0,start:n===d.FieldDisplayLayoutType.Inline?r:0,after:0,end:0}},fieldResultProp:t}}},draw:function(e){var t=e.fieldInfo,n=e.ctx,o=e.box,i=e.cssStyle,a=e.bridge,s=e.editor,c=(0,d.makeFrame)(0,0,o.totalWidth,o.totalHeight),l=(0,Uc.yS)(t.fieldCode);if(l){var u=(0,Hs.Vo)(n,o),p=o.children.map((function(e){return e.hidden?null:ve().createElement("span",{className:"melo-leaf",style:(0,r.__assign)((0,r.__assign)({},d.CssUtil.cssPropsToStyle(d.CssUtil.computeStyles(e).cssProperties)),{verticalAlign:"baseline"}),key:Math.random()},(0,d.isTextBox)(e)?e.textString():"")})),f=d.PoolNodeFactory.obtain(d.IComponentView,o.uuid,c,ve().createElement(Bc,{editor:s,layoutBox:o,fieldInfo:t,key:"field-trigger-".concat(o.uuid),renderCanvas:!0,overrideStyle:i,info:l,bridge:a},p),u);n.addView(f)}}},containerRenderConfig:{children:function(e){var t=e.fieldInfo,n=e.editor,r=e.layoutBox,o=e.key,i=(0,Uc.yS)(t.fieldCode);return ve().createElement(Bc,{editor:n,layoutBox:r,fieldInfo:t,key:o,info:i})}}},Vc=n(46712),zc=n(36506),Gc=n(406),Yc="tdocs-card_text_link",qc="tdocs-card_selected",Zc="tdocs-card_text_icon",Jc="tdocs-card_text",Kc=n(60783),Qc=n(73758),Xc=function(e){function t(t){var n=e.call(this,t)||this;return n.isTouching=!1,n.touchStartTime=0,n.touchStartX=0,n.touchStartY=0,n.loading=!1,n.isMobile=!1,n.loadingTimer=0,n.deselectCard=function(){var e=n.state.selected,t=n.props.onSelect;e&&(n.setState({selected:!1}),t&&t(!1))},n.deleteCard=function(e){var t=n.props,r=t.field,o=t.editor,i=t.onSelect,a=(null!=r?r:{}).fieldRange;a&&e.fieldInfo&&a.contains(e.fieldInfo.fieldCode.range)&&(n.state.selected?o.service.getDocument().getRange(a.begin(),a.end()).delete():(n.setState({selected:!0}),i&&i(!0)))},n.handleClick=function(e){n.isMobile||(e.stopPropagation(),n.clickCard(e))},n.clickCard=function(e){var t=n.props.onClick;!n.loading&&t&&(n.loading=!0,n.loadingTimer&&window.clearTimeout(n.loadingTimer),n.loadingTimer=window.setTimeout((function(){n.loadingTimer=0,n.loading&&(n.loading=!1)}),500),t(e))},n.handleTouchStart=function(e){e.stopPropagation(),n.touchStartX=e.touches[0].clientX,n.touchStartY=e.touches[0].clientY,n.isTouching=!0,n.touchStartTime=Date.now()},n.handleTouchMove=function(e){var t=e.touches[0].clientX,r=e.touches[0].clientY;Math.abs(t-n.touchStartX)+Math.abs(r-n.touchStartY)>30&&(n.isTouching=!1)},n.handleTouchEnd=function(e){var t;e.preventDefault(),e.stopPropagation(),n.isTouching&&(n.isTouching=!1,Date.now()-n.touchStartTime>=500?n.showToolbar():(null===(t=n.props.editor.surface)||void 0===t||t.requestBlur(),n.clickCard()))},n.handleMouseEnter=function(){n.isMobile||n.showToolbar()},n.showToolbar=function(){var e,t=n.props,r=t.editor,o=t.data,i=t.layoutBox,a=t.onShowToolbar,s=(null!==(e=n.props.field)&&void 0!==e?e:{}).fieldRange;if(s&&a){var c=r.getViewRangeFromGcpRange(s),l=null==c?void 0:c.start.getSurfaceOffset(r.zoom);if(l){var u=n.getTextAlignment();a({show:!0,posX:l.x,posY:l.y-50,fieldIndex:n.props.editor.getIndexFromRange(i.getRange()),layout:o.layout,align:u})}}},n.getTextAlignment=function(){var e,t,r,o,i=n.props.layoutBox,a=d.STJcWml.left;return(0,d.isFieldBox)(i)||(0,d.isFieldContainerBox)(i)?(o=(null===(e=i.parentBox)||void 0===e?void 0:e.parentBox).property.jc)&&(a=o):(o=null===(r=null===(t=i.parentBox)||void 0===t?void 0:t.property)||void 0===r?void 0:r.jc)&&(a=o),a},n.handleMouseLeave=function(){n.isMobile||n.toolbarService.toggleToolbar({show:!1})},n.handleContextMenu=function(){var e,t=n.props.editor,r=(null!==(e=n.props.field)&&void 0!==e?e:{}).fieldRange;r&&t.service.getSelection().setRange(r.begin(),r.end())},n.state={selected:!1},n}var n;return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this.props.editor;e.on(d.RenderNotificationTypes.SELECTION_CHANGE,this.deselectCard),e.on(d.FieldCodeNotificationType.Delete,this.deleteCard)},t.prototype.componentWillUnmount=function(){var e=this.props.editor;e.removeCallBack(d.RenderNotificationTypes.SELECTION_CHANGE,this.deselectCard),e.removeCallBack(d.FieldCodeNotificationType.Delete,this.deleteCard),window.clearTimeout(this.loadingTimer)},t.prototype.render=function(){var e=this.props,t=e.domRef,n=e.children,r=e.data,o=this.state.selected,i="".concat(o?qc:"","\n            ").concat(this.isMobile||r.layout===d.FieldDisplayLayoutType.Inline?"":Kc.Z["fieldcode-draggable"]);return ve().createElement("div",{className:i,ref:t,onClick:this.handleClick,onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,onTouchEnd:this.handleTouchEnd,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onContextMenu:this.handleContextMenu},n)},t.defaultProps={domRef:(0,ge.createRef)()},(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==Qc.Z&&Qc.Z)?n:Object)],t.prototype,"toolbarService",void 0),t}(ge.Component),$c=420,el=function(e){var t=e.className,n=e.fontSize,r=e.children,o=e.onClick,i=e.onMouseEnter,a=e.onMouseLeave,s=e.onTouchStart,c=e.onTouchMove,l=e.onTouchEnd,u=e.onContextMenu,d=e.icon,p=d?{paddingLeft:1.3*n+2}:{};return ve().createElement("span",{className:t?"".concat(Yc," ").concat(t):Yc,style:{fontSize:"".concat(n,"px")},onTouchStart:s,onTouchMove:c,onTouchEnd:l,onClick:o,onMouseEnter:i,onMouseLeave:a,onContextMenu:u},d&&ve().createElement("span",{className:Zc},ve().createElement("span",{style:{width:"".concat(n,"px"),height:"".concat(n,"px")}},d)),ve().createElement("span",{className:Jc,style:p},r))},tl=function(e){var t=e.layoutBox,n=(0,ge.useMemo)((function(){var e,n,r,o;return(0,d.isFieldBox)(t)?(0,p.twipsToPx)((null===(n=null===(e=t.content)||void 0===e?void 0:e.textStyle)||void 0===n?void 0:n.renderFontSize)||14):(0,p.twipsToPx)((null===(o=null===(r=t.content)||void 0===r?void 0:r.property)||void 0===o?void 0:o.renderFontSize)||14)}),[t]);return{fontSize:n}},nl=function(e){var t=e.className,n=e.layoutBox,r=e.children,o=tl({layoutBox:n}).fontSize;return ve().createElement(el,{className:t,fontSize:o,icon:ve().createElement("svg",{viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ve().createElement("path",{d:"M10.0333 0.5C9.2617 0.5 8.5432 0.708883 7.93334 1.0643C6.81442 1.71631 6.06666 2.869 6.06666 4.18366V9.64968C6.06666 10.6341 5.12643 11.4321 3.96667 11.4321C2.80685 11.4321 1.86667 10.6341 1.86667 9.64968C1.86667 8.9491 2.34404 8.34468 3.03673 8.05336C3.08673 8.03234 3.13738 8.01248 3.18954 7.99486C3.62552 7.81677 3.99959 7.48204 4.13845 7.09342C4.34343 6.51984 3.96176 6.05487 3.286 6.05487C3.11761 6.05487 2.94679 6.08385 2.78207 6.13616C2.78126 6.13637 2.7805 6.13659 2.7797 6.13681C1.80282 6.42253 0.987275 7.04902 0.497787 7.86731C0.181484 8.39594 0 9.00322 0 9.64968C0 11.6809 1.77943 13.3333 3.96667 13.3333C4.73824 13.3333 5.45674 13.1244 6.06666 12.769C7.18552 12.117 7.93334 10.9643 7.93334 9.64968V4.18366C7.93334 3.19923 8.87352 2.40124 10.0333 2.40124C11.1931 2.40124 12.1333 3.19923 12.1333 4.18366C12.1333 4.9142 11.6155 5.54205 10.8744 5.81734C10.3962 5.98045 10.0043 6.33296 9.85513 6.75051C9.65107 7.32151 10.031 7.78433 10.7037 7.78433C10.8562 7.78433 11.01 7.75777 11.1601 7.71436C11.1846 7.70755 11.2088 7.69987 11.2332 7.69262C12.2043 7.4052 13.0149 6.78064 13.5022 5.96607C13.8185 5.43739 14 4.83012 14 4.18366C14 2.15246 12.2206 0.5 10.0333 0.5Z",fill:"#7586DB"}))},r)},rl=n(86667),ol=n.n(rl),il=function(e){function t(t){var n=e.call(this,t)||this;return n.refThumb=ve().createRef(),n.updateSelection=function(e){n.setState({selected:e})},n.state={selected:!1},n.onClick=n.onClick.bind(n),n.showToolbar=n.showToolbar.bind(n),n}var n;return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){var e,t=this;if(ol().isWeChat){var n=this.props.appData.username;null===(e=this.loader.instance)||void 0===e||e.getAppInfo(this.props.appData).then((function(e){t.refThumb.current&&e&&(console.error("wx-open-launch-weapp: username: ".concat(n,", app_path: ").concat(e.app_path)),t.refThumb.current.innerHTML='\n                    <wx-open-launch-weapp\n                        id="launch-btn"\n                        username="'.concat(n.split("@")[0],'"\n                        path="').concat(e.app_path,'"\n                        class="mini-app-thumbnail-launch-weapp"\n                    >\n                        <script type="text/wxtag-template">\n                            <style>\n                            .btn {\n                                width: 232px;\n                                height: 186px;\n                                display: block;\n                                border: none;\n                                border-radius: 0;\n                                background-color: transparent;\n                                color: transparent;\n                            }\n                            </style>\n                            <button class="btn">open</button>\n                        <\/script>\n                    </wx-open-launch-weapp>\n                    '))}))}},t.prototype.componentWillUnmount=function(){var e;null===(e=this.loader.instance)||void 0===e||e.toggleToolbar({show:!1})},t.prototype.showToolbar=function(e){var t;null===(t=this.loader.instance)||void 0===t||t.toggleToolbar(e)},t.prototype.render=function(){var e,t=this.props,n=t.editor,r=t.fieldInfo,o=t.layoutBox,i=t.children,a=t.appData,s=this.state.selected,c=a.icon_url,l=a.thumb_url,u=a.name,p=a.title,f=a.layout;return e=(void 0===f?d.FieldDisplayLayoutType.Card:f)===d.FieldDisplayLayoutType.Inline?ve().createElement(nl,{layoutBox:o},i):ve().createElement("div",{className:"mini-app-card ".concat(s?"mini-app-card-active":"")},ve().createElement("div",{className:"mini-app-header"},ve().createElement("div",{className:"mini-app-icon",style:{backgroundImage:"url(".concat(c||"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjRjBGMEYwIiBkPSJNMCAwaDIwdjIwSDB6Ii8+PHBhdGggZD0iTTE1LjUgMTVoLTExYS4yNS4yNSAwIDAgMS0uMjUtLjI1di0uMjE5YzAtLjI2NC4xNC0uNTEuMzY3LS42NDVsMy44MzItMi4yNzRhLjg2My44NjMgMCAwIDAgLjE4OS0xLjMzMiAzLjA4MiAzLjA4MiAwIDAgMS0uODMzLTIuMTA4di0uOTc3YTIuMTk1IDIuMTk1IDAgMSAxIDQuMzkgMHYuOTc3YzAgLjc4My0uMjk3IDEuNTM3LS44MzMgMi4xMDhhLjg2My44NjMgMCAwIDAgLjE5IDEuMzMybDMuODMgMi4yNzRhLjc1Ljc1IDAgMCAxIC4zNjguNjQ1di4yMTlhLjI1LjI1IDAgMCAxLS4yNS4yNXoiIGZpbGw9IiNEMUQxRDEiLz48L3N2Zz4=",")")}}),ve().createElement("div",{className:"mini-app-name mini-app-text"},u)),ve().createElement("div",{className:"mini-app-title mini-app-text"},p),ve().createElement("div",{ref:this.refThumb,className:"mini-app-thumbnail",style:{backgroundImage:"url(".concat(l||"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjMyIiBoZWlnaHQ9IjE4NiIgdmlld0JveD0iMCAwIDIzMiAxODYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzExMjdfMTM4NDg1KSI+PHBhdGggZmlsbD0iI0YwRjBGMCIgZD0iTTAtMThoMjMydjIzMEgweiIvPjxnIGNsaXAtcGF0aD0idXJsKCNjbGlwMV8xMTI3XzEzODQ4NSkiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTI4Ljk0NCA2Ny40MDZjLTMuMDM5IDAtNS44NjguODIzLTguMjY5IDIuMjIyLTQuNDA2IDIuNTY3LTcuMzUgNy4xMDYtNy4zNSAxMi4yODN2MjEuNTIyYzAgMy44NzYtMy43MDIgNy4wMTgtOC4yNjkgNy4wMThzLTguMjY5LTMuMTQyLTguMjY5LTcuMDE4YzAtMi43NTggMS44OC01LjEzOCA0LjYwOC02LjI4NS4xOTctLjA4My4zOTYtLjE2MS42MDEtLjIzIDEuNzE3LS43MDIgMy4xOS0yLjAyIDMuNzM3LTMuNTUuODA3LTIuMjU5LS42OTYtNC4wOS0zLjM1Ny00LjA5LS42NjMgMC0xLjMzNi4xMTUtMS45ODQuMzJsLS4wMDkuMDAzYy0zLjg0NyAxLjEyNS03LjA1OCAzLjU5Mi04Ljk4NiA2LjgxNC0xLjI0NSAyLjA4MS0xLjk2IDQuNDczLTEuOTYgNy4wMTggMCA3Ljk5OCA3LjAwNyAxNC41MDUgMTUuNjE5IDE0LjUwNSAzLjAzOCAwIDUuODY3LS44MjMgOC4yNjktMi4yMjIgNC40MDYtMi41NjggNy4zNS03LjEwNyA3LjM1LTEyLjI4M1Y4MS45MTFjMC0zLjg3NyAzLjcwMi03LjAxOSA4LjI2OS03LjAxOSA0LjU2NiAwIDguMjY4IDMuMTQyIDguMjY4IDcuMDE5IDAgMi44NzYtMi4wMzggNS4zNDgtNC45NTcgNi40MzItMS44ODIuNjQyLTMuNDI1IDIuMDMtNC4wMTMgMy42NzUtLjgwMyAyLjI0OC42OTMgNC4wNyAzLjM0MSA0LjA3LjYwMSAwIDEuMjA2LS4xMDQgMS43OTctLjI3NS4wOTctLjAyNy4xOTItLjA1Ny4yODgtLjA4NiAzLjgyNC0xLjEzMiA3LjAxNi0zLjU5IDguOTM0LTYuNzk4YTEzLjYwNiAxMy42MDYgMCAwIDAgMS45Ni03LjAxOGMwLTcuOTk4LTcuMDA2LTE0LjUwNS0xNS42MTgtMTQuNTA1eiIgZmlsbD0iI0QxRDFEMSIvPjwvZz48L2c+PGRlZnM+PGNsaXBQYXRoIGlkPSJjbGlwMF8xMTI3XzEzODQ4NSI+PHJlY3Qgd2lkdGg9IjIzMiIgaGVpZ2h0PSIxODYiIHJ4PSIzIiBmaWxsPSIjZmZmIi8+PC9jbGlwUGF0aD48Y2xpcFBhdGggaWQ9ImNsaXAxXzExMjdfMTM4NDg1Ij48cGF0aCBmaWxsPSIjZmZmIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4NSA2MSkiIGQ9Ik0wIDBoNjN2NjNIMHoiLz48L2NsaXBQYXRoPjwvZGVmcz48L3N2Zz4=",")")}}),ve().createElement("div",{className:"mini-app-footer"},ve().createElement("div",{className:"mini-app-default-icon"}),ve().createElement("div",{className:"mini-app-default-name"},Vc.Wo.WEAPP_TEXT))),ve().createElement(Xc,{data:a,editor:n,layoutBox:o,field:r,onClick:this.onClick,onShowToolbar:this.showToolbar,onSelect:this.updateSelection},e)},t.prototype.onClick=function(){var e;return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return null===(e=this.loader.instance)||void 0===e||e.openMiniProgram(this.props.appData),[2]}))}))},(0,r.__decorate)([(0,x.aN)(zc.IFieldcodeWxworkAppFeature),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==j.IDynamicLoader&&j.IDynamicLoader)?n:Object)],t.prototype,"loader",void 0),(0,r.__decorate)([(0,Gc.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"componentDidMount",null),(0,r.__decorate)([(0,Gc.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"componentWillUnmount",null),(0,r.__decorate)([(0,Gc.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"showToolbar",null),(0,r.__decorate)([(0,Gc.nB)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"onClick",null),t}(ve().Component);function al(e){if(!e.children)return[];var t=e.children.map((function(e){return e.hidden?null:ve().createElement("span",{className:"melo-leaf",style:(0,r.__assign)((0,r.__assign)({},d.CssUtil.cssPropsToStyle(d.CssUtil.computeStyles(e).cssProperties)),{verticalAlign:"baseline"}),key:e.uuid},function(e){return(0,d.isTextBox)(e)?e.textString():""}(e))})).filter((function(e){return!!e}));return t}function sl(e){return function(t){var n,r=t.ctx,o=t.editor,i=t.box,a=t.fieldInfo,s=t.bridge,c=(0,d.makeFrame)(0,0,i.totalWidth,i.totalHeight),l=null!==(n=e(o,a,i,s,r))&&void 0!==n?n:{},u=l.element,p=l.overrideStyle;if(u){var f=d.PoolNodeFactory.obtain(d.IComponentView,i.uuid,c,u,p);r.addView(f)}}}function cl(e,t){var n=e.getCurrentState(),r=n.contextState,o=n.docViewType,i=n.isFocusHeaderFooter,a=n.isInHeaderFooter;return d.CssUtil.computeContainerStyles(t,null==r?void 0:r.clipInfo,o,i,a)}var ll=function(e,t,n,r,o){var i,a=null===(i=t.fieldCode.instructions)||void 0===i?void 0:i[0],s=a&&(0,Vc.bB)(a,!0);return s?ve().createElement(il,{key:"field-trigger-".concat(n.uuid),editor:e,layoutBox:n,fieldInfo:t,appData:s,overrideStyle:r,bridge:o},al(n)):null},ul=(oc.zE.WxworkApp,sl((function(e,t,n,r){var o=d.CssUtil.computeContainerStyles(n),i=ll(e,t,n,o,r);return i?{element:i,overrideStyle:o}:null})),n(16823)),dl=n(74880),pl=(n(28301),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isAutoUpdate=!1,t.isShowDropdowns=!1,t.isShowHover=!1,t.fieldHeightMap=new Map,t}return(0,r.__extends)(t,e),t.prototype.updateFieldHeight=function(e,t){this.fieldHeightMap.set(e.fieldCode,t)},t.prototype.getFieldLayoutType=function(e){return d.FieldDisplayLayoutType.Card},t.prototype.getFieldHeight=function(e){return this.fieldHeightMap.get(e.fieldCode)||1},t.prototype.getFieldWidth=function(){return(0,p.pxToTwips)($c)},t}(d.FieldCodeProcessor));function fl(e,t){if(e.current&&t.editor.docEnv.docViewType!==d.DocViewType.SnapPreview){var n=t.layoutBox,r=t.editor,o=(0,p.pxToTwips)(e.current.getBoundingClientRect().height),i=d.FieldCodeManager.getInstance(),a=x.Am.get(Bs.D),s=t.fieldInfo&&a.convertToFieldCodeInfo(t.fieldInfo);if(s){var c=i.getFieldProcessorByFieldCodeInfo(s);c instanceof pl&&c.getFieldHeight(s)!==o&&(c.updateFieldHeight(s,o),r instanceof d.MeloEditor&&r.forceReflow(n.getRange()))}}}var _l,hl=function(e){var t=e.refreshError,n=e.unknownError,r=e.memberError;t&&d.ReportHelper.weiMonitorCube({module:d.ICubeModule.Feature,name:uo.C.WxworkMeeting,action:"[cgi]refresh_doc_meeting_card",code:void 0===t.errorCode?void 0:Number(t.errorCode),msg:t.content}),r&&d.ReportHelper.weiMonitorCube({module:d.ICubeModule.Feature,name:uo.C.WxworkMeeting,action:"[cgi]member_info",msg:r.content}),n&&d.ReportHelper.weiMonitorCube({module:d.ICubeModule.Feature,name:uo.C.WxworkMeeting,action:"[component]unknown_error",msg:n})},ml=function(e){var t=e.data,n=e.className,o=e.selected,i=void 0!==o&&o,a=e.onViewDetail,s=e.onEnterMeeting,l=e.onJoinMeeting,u=e.onUpdate,d=e.openMeetingRecord,f=(0,ge.useRef)(null),_=(0,ge.useMemo)((function(){return{subject:t.subject,content:t.content,meeting_room:t.meeting_room,creator_name:t.creator_name,creator_vid:t.creator_vid,start_time:t.start_time,end_time:t.end_time,repeat:t.repeat,attend_list:t.attend_list,place:t.place,is_api_create:t.is_api_create}}),[t]),h=(0,ge.useMemo)((function(){var e=t.meeting_id,n=t.submeeting_id;return{meeting_id:e,submeeting_id:void 0===n?"":n,access_url:t.access_url,creator_source:t.creator_source,sharekey:t.sharekey,docid:(0,c.Yi)().padId}}),[t]),m=(0,ge.useCallback)((function(){fl(f,e)}),[e]),g=(0,ge.useCallback)((function(e){void 0===e&&(e={}),f.current&&u((0,r.__assign)((0,r.__assign)({},e),{height:Math.floor((0,p.pxToTwips)(f.current.getBoundingClientRect().height))}))}),[u]),v=(0,ge.useCallback)((function(e){d(e)}),[d]);return ve().createElement("div",{className:n,style:{width:"".concat($c,"px"),maxWidth:"100%"},ref:f},ve().createElement(dl.wq,{active:i,info:h,data:_,onEnterMeeting:s,onViewMeeting:a,onJoinMeeting:l,updateHeight:m,onViewRecord:v,readyCallback:g,onError:hl}))},gl=function(e){var t=e.className,n=e.layoutBox,r=e.children,o=e.onViewDetail,i=tl({layoutBox:n}).fontSize;return ve().createElement(el,{className:t,fontSize:i,onClick:o,icon:ve().createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ve().createElement("rect",{width:"24",height:"24",rx:"3",fill:"#539CF8"}),ve().createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.06702 9.10046C5.06702 8.29044 5.72367 7.63379 6.53368 7.63379H13.867C14.677 7.63379 15.3337 8.29044 15.3337 9.10046V15.7005C15.3337 16.5105 14.677 17.1671 13.867 17.1671H6.53368C5.72367 17.1671 5.06702 16.5105 5.06702 15.7005V9.10046ZM16.0669 10.9338L18.5797 9.17487C19.0658 8.83465 19.7336 9.18236 19.7336 9.77564V15.0253C19.7336 15.6186 19.0658 15.9663 18.5797 15.6261L16.0669 13.8672V10.9338ZM12.2535 14.8019L12.4271 14.6268C12.5118 14.5413 12.5891 14.4218 12.6496 14.3137C12.7333 14.1638 12.675 13.9804 12.5305 13.8876L11.6168 13.3007C11.5398 13.2512 11.4413 13.2505 11.3636 13.2987L11.025 13.5089C10.9006 13.5862 10.7664 13.6535 10.6537 13.5612C10.6537 13.5612 10.0438 13.1238 9.78447 12.8621C9.523 12.5983 9.11196 12.0218 9.11196 12.0218C9.01943 11.9083 9.08735 11.7723 9.16378 11.6469L9.37434 11.3018C9.42277 11.2223 9.42031 11.122 9.36805 11.045L8.68365 10.0375C8.59697 9.90989 8.43698 9.85156 8.29715 9.91672C8.18701 9.96806 8.06129 10.04 7.97097 10.1311L7.79736 10.3063C7.31794 10.79 7.92682 12.1884 9.15734 13.4299C10.3879 14.6713 11.774 15.2856 12.2535 14.8019Z",fill:"white"}))},r)},vl=function(){function e(e){this.contextService=e}var t;return e.prototype.$onReset=function(){},e.prototype.handleContextClick=function(e){this.contextService.context.editor.service.getSelection().setRange(e.begin(),e.end())},e.prototype.getCardPosition=function(e){var t=this.contextService.context.editor,n=e.getRange(),r=t.getViewRangeFromGcpRange(n),o=t.zoom;if(r){var i=r.start.getWindowOffset(o);return{x:i.x,y:i.y+r.start.caretHeight(o)}}return{x:0,y:0}},e=(0,r.__decorate)([(0,_e.t)(),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==S.O&&S.O)?t:Object])],e)}(),bl=n(15375),yl=function(e){function t(t){var n=e.call(this,t)||this;return n.isMobile=!1,n.updateSelection=function(e){n.setState({selected:e})},n.onViewDetail=function(e){return null==e||e.stopPropagation(),n.openDetail({x:null==e?void 0:e.clientX,y:null==e?void 0:e.clientY})},n.state={selected:!1},n.openDetail=n.openDetail.bind(n),n.showToolbar=n.showToolbar.bind(n),n.onEnterMeeting=n.onEnterMeeting.bind(n),n.onJoinMeeting=n.onJoinMeeting.bind(n),n.onUpdate=n.onUpdate.bind(n),n.openMeetingRecord=n.openMeetingRecord.bind(n),n}var n,o;return(0,r.__extends)(t,e),t.prototype.calcEmbeddedIframePosition=function(){var e,t,n={x:0,y:0};if(p.PlatformUtil.isWeWork()&&Ds.W.isWeWortkEmbeddedDiscussionDoc){var r=null===(t=null===(e=window.parent)||void 0===e?void 0:e.document)||void 0===t?void 0:t.querySelector(".doc-detail_wrapper");if(!r)return n;var o=null==r?void 0:r.getBoundingClientRect();return{x:(null==o?void 0:o.left)||0,y:(null==o?void 0:o.top)||0}}return n},t.prototype.openDetail=function(e){var t;return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,o,i,a,s,c,l;return(0,r.__generator)(this,(function(u){switch(u.label){case 0:return n=this.props,o=n.data,i=n.layoutBox,a=this.calcEmbeddedIframePosition(),s=e||this.cardService.getCardPosition(i),c=s.x,l=s.y,[4,null===(t=this.loader.instance)||void 0===t?void 0:t.onViewDetail((0,r.__assign)((0,r.__assign)({},o),{x:a.x+(c||0),y:a.y+(l||0)}))];case 1:return u.sent(),[2]}}))}))},t.prototype.showToolbar=function(e){var t;null===(t=this.loader.instance)||void 0===t||t.toggleToolbar(e)},t.prototype.onEnterMeeting=function(){var e;return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,n,o,i,a,s;return(0,r.__generator)(this,(function(c){switch(c.label){case 0:return t=this.props,n=t.data,o=t.layoutBox,i=this.cardService.getCardPosition(o),a=i.x,s=i.y,[4,null===(e=this.loader.instance)||void 0===e?void 0:e.onEnterMeeting((0,r.__assign)((0,r.__assign)({},n),{x:a,y:s}))];case 1:return c.sent(),[2]}}))}))},t.prototype.onJoinMeeting=function(){var e;return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return t=this.props.data,[4,null===(e=this.loader.instance)||void 0===e?void 0:e.onJoinMeeting(t)];case 1:return[2,n.sent()||!1]}}))}))},t.prototype.onUpdate=function(e){var t,n=this.props,r=n.data,o=n.layoutBox;null===(t=this.loader.instance)||void 0===t||t.onUpdate(r,e,this.props.editor.getIndexFromRange(o.getRange()))},t.prototype.openMeetingRecord=function(e){var t;return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return[4,null===(t=this.loader.instance)||void 0===t?void 0:t.openMeetingRecord(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.render=function(){var e,t=this.state.selected,n=this.props,r=n.data,o=n.editor,i=n.layoutBox,a=n.fieldInfo,s=n.children,c=r.layout;return e=(void 0===c?d.FieldDisplayLayoutType.Card:c)===d.FieldDisplayLayoutType.Inline?ve().createElement(gl,{onViewDetail:this.onViewDetail,layoutBox:i},s):ve().createElement(ml,{data:r,editor:o,layoutBox:i,fieldInfo:a,selected:t,onViewDetail:this.openDetail,onEnterMeeting:this.onEnterMeeting,onJoinMeeting:this.onJoinMeeting,onUpdate:this.onUpdate,openMeetingRecord:this.openMeetingRecord},s),ve().createElement(Xc,{data:r,editor:o,layoutBox:i,field:a,onClick:this.onViewDetail,onShowToolbar:this.showToolbar,onSelect:this.updateSelection},e)},(0,r.__decorate)([(0,x.aN)(bl.IFieldcodeWxworkMeetingFeature),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==j.IDynamicLoader&&j.IDynamicLoader)?n:Object)],t.prototype,"loader",void 0),(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(o=void 0!==vl&&vl)?o:Object)],t.prototype,"cardService",void 0),(0,r.__decorate)([(0,Gc.nB)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"openDetail",null),(0,r.__decorate)([(0,Gc.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"showToolbar",null),(0,r.__decorate)([(0,Gc.nB)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"onEnterMeeting",null),(0,r.__decorate)([(0,Gc.nB)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"onJoinMeeting",null),(0,r.__decorate)([(0,Gc.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"onUpdate",null),(0,r.__decorate)([(0,Gc.nB)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"openMeetingRecord",null),t}(ge.Component),wl=function(e,t,n,r,o){var i,a=null===(i=t.fieldCode.instructions)||void 0===i?void 0:i[0],s=a&&(0,ul.ph)(a,!0);return s?ve().createElement(yl,{key:"field-trigger-".concat(n.uuid),editor:e,layoutBox:n,fieldInfo:t,data:s,overrideStyle:r,bridge:o},al(n)):null},El=(oc.zE.WxworkMeeting,sl((function(e,t,n,r){var o=d.CssUtil.computeContainerStyles(n),i=wl(e,t,n,o,r);return i?{element:i,overrideStyle:o}:null})),n(89311)),Cl=n(64479),Tl=n.n(Cl),xl=n(12325),Sl=n(82416),Il=n(27505),kl=n(87675),Rl=n(5450),Al=n.n(Rl),Ol=n(696),Ll=n(66802),Ml=n(69130),Nl=n(25303),Dl=n(814),Pl=n(77435),Fl=n(95747),Bl=(n(74246),n(79707)),Ul=n(90476),Hl=n(59834),jl=null!==(_l="undefined"==typeof window?null:window.i18n)&&void 0!==_l?_l:lo.ZP;function Wl(e,t){var n=null==jl?void 0:jl.t(e,t);return n||"".concat(e)}!function(e,t){var n=function(n){jl&&jl.getResource&&jl.addResource&&Object.entries(e).forEach((function(e){var r=(0,Sl.Z)(e,2),o=r[0],i=r[1];Object.entries(i).forEach((function(e){var r=(0,Sl.Z)(e,2),i=r[0],a=r[1],s=null!=t?t:n.defaultNS||"legacy";jl.getResource(o,s,i)||jl.addResource(o,s,i,a)}))}))};if(jl&&"undefined"!=typeof window){if(window.noSharedI18next&&!window.i18n){window.i18n=lo.ZP;var r="zh-CN";try{var o=localStorage.getItem("shared-language");o&&(r=o)}catch(e){}lo.ZP.init({lng:r,resources:{},debug:!0,ns:"legacy",defaultNS:"legacy"})}jl.isInitialized?n(jl.options):jl.on("initialized",n)}}({"en-US":{organizer:"Organizer: ",creator:"Creator: ",check:"Check","参与人：":"Participants: ","地点：{{place}}":"Place: {{place}}","等{{num}}人":"etc. {{num}} people","不重复":"Never","全天":"All day","加入日程":"Add Schedule","会议室：":"Room: ","请在企业微信中使用此功能":"Please use this function in Enterprise WeChat","已加入日程":"Added to the schedule","年":" ","查看详情":"Check detail"},"zh-CN":{organizer:"组织人：",creator:"创建者：",check:"查看","参与人：":"参与人：","地点：{{place}}":"地点：{{place}}","等{{num}}人":"等{{num}}人","不重复":"不重复","全天":"全天","加入日程":"加入日程","会议室：":"会议室：","请在企业微信中使用此功能":"请在企业微信中使用此功能","已加入日程":"已加入日程","查看详情":"查看详情"},"zh-HK":{organizer:"組織人：",creator:"創建者：",check:"查看","参与人：":"參與人：","地点：{{place}}":"地點：{{place}}","等{{num}}人":"等{{num}}人","不重复":"不重復","全天":"全天","加入日程":"加入日程","会议室：":"會議室：","请在企业微信中使用此功能":"請在企業微信中使用此功能","已加入日程":"已加入日程","查看详情":"查看詳情"}});var Vl,zl,Gl=lo.ZP.language,Yl="CalendarEventPlain-module_event__NeCpO",ql="CalendarEventPlain-module_active__61-RH",Zl="CalendarEventPlain-module_hover_btn__VP9YK",Jl="CalendarEventPlain-module_content__aVvVY",Kl="CalendarEventPlain-module_title__nHwnK",Ql="CalendarEventPlain-module_sub-max-width__2B392",Xl="CalendarEventPlain-module_time__-s6jI",$l="CalendarEventPlain-module_repeat__lyJQg",eu="CalendarEventPlain-module_info__amm8W",tu="CalendarEventPlain-module_margin-top-2__gLPAa",nu="CalendarEventPlain-module_participants-wrapper__4K9K6",ru="CalendarEventPlain-module_participants__Fb2zM",ou="CalendarEventPlain-module_no-shrink__guTi6",iu="CalendarEventPlain-module_mobile-event__Wj0LX",au="CalendarEventPlain-module_icon-left__Ce9A3",su="CalendarEventPlain-module_btn-container__mo8mt";function cu(e){return"微信"===e?{color:"#1EBD43"}:{color:"#FC8F28"}}function lu(e,t){return e!==t}!function(e){e[e.Unknown=0]="Unknown",e[e.TBD=1]="TBD",e[e.AcceptedAll=2]="AcceptedAll",e[e.Accepted=3]="Accepted",e[e.Rejected=4]="Rejected"}(Vl||(Vl={})),function(e){e[e.WholeDay=1]="WholeDay",e[e.Deleted=4096]="Deleted",e[e.CanJoin=524288]="CanJoin",e[e.Repeat=8]="Repeat",e[e.ReadOnly=8192]="ReadOnly",e[e.APIAppSchedule=4194304]="APIAppSchedule"}(zl||(zl={}));var uu,du,pu,fu,_u=function(e,t){ol().isMobile?Mi().show({message:e,type:t||"info",autoClose:!0,duration:5e3}):Ga.default.show({message:e,type:t||"info",autoClose:!0,duration:5e3})},hu=function(){return!ol().isWxWork&&(_u(Wl("请在企业微信中使用此功能")),!0)},mu=ol().isWxWork&&(uu="wxwork",du="4.1.2",function(e,t,n){var r=null==n?void 0:n.lexicographical,o=null==n?void 0:n.zeroExtend,i=e.split("."),a=t.split(".");if(o){for(;i.length<a.length;)i.push("0");for(;a.length<i.length;)a.push("0")}if(!r){for(var s=0;s<i.length;s++)i[s]=parseInt(i[s],10);for(var c=0;c<a.length;c++)a[c]=parseInt(a[c],10)}for(var l=0;l<i.length;++l){if(a.length===l)return 1;if(i[l]!==a[l])return i[l]>a[l]?1:-1}return i.length!==a.length?-1:0}((null==(pu=navigator.userAgent.match(new RegExp("".concat(uu,"/([\\d\\.]+)"),"i")))?void 0:pu[1])||"0",du,{zeroExtend:!0})>=0),gu=function(e){return"0"===e.vid||void 0===e.vid||"undefined"===e.vid||null===e.vid||"null"===e.vid||""===e.vid},vu=new((0,Ul.Z)((function e(){var t=this;(0,Hl.Z)(this,e),(0,kl.Z)(this,"queue",[]),(0,kl.Z)(this,"num",0),(0,kl.Z)(this,"add",(function(e){t.queue.push((function(){e(t.endFn)})),t.startFn()})),(0,kl.Z)(this,"startFn",(function(){if(t.num<1){var e=t.queue.shift();null==e||e(),t.num=t.num+1}})),(0,kl.Z)(this,"endFn",(function(){t.num=t.num-1,t.queue.length>0&&t.startFn()}))}))),bu=function(e){var t,n=e.active,r=void 0!==n&&n,o=e.data,i=e.className,a=void 0===i?"":i,s=e.style,c=e.onViewDetail,l=e.onAccept,u=e.onQuery,d=e.updateHeight,p=e.readyCallback,f=e.onError,_=(0,ge.useMemo)((function(){switch(Gl){case"en":case"en-US":return Dl.Z;case"zh-CN":default:return Nl.Z;case"zh-HK":return Pl.Z}}),[Gl]),h=o.start_time,m=o.end_time,g=o.subject,v=o.create_name,b=o.create_from,y=o.place,w=o.attend_list,E=o.create_id,C=o.repeat,T=o.meetting_room,x=o.flag,S=(0,ge.useState)(w),I=(0,Sl.Z)(S,2),k=I[0],R=I[1],A=(0,ge.useState)(v),O=(0,Sl.Z)(A,2),L=O[0],M=O[1],N=(0,ge.useState)(),D=(0,Sl.Z)(N,2),P=D[0],F=D[1],B=(0,ge.useState)(),U=(0,Sl.Z)(B,2),H=U[0],j=U[1],W=(0,ge.useState)(!1),V=(0,Sl.Z)(W,2),z=V[0],G=V[1],Y=(0,ge.useState)(),q=(0,Sl.Z)(Y,2),Z=q[0],J=q[1],K=(0,ge.useState)(!1),Q=(0,Sl.Z)(K,2),X=Q[0],$=Q[1],ee=(0,ge.useState)(),te=(0,Sl.Z)(ee,2),ne=te[0],re=te[1],oe=(0,ge.useState)(x),ie=(0,Sl.Z)(oe,2),ae=ie[0],se=ie[1],ce=(0,ge.useState)(g),le=(0,Sl.Z)(ce,2),ue=le[0],de=le[1],pe=(0,ge.useState)(h),fe=(0,Sl.Z)(pe,2),_e=fe[0],he=fe[1],me=(0,ge.useState)(m),be=(0,Sl.Z)(me,2),ye=be[0],we=be[1],Ee=(0,ge.useState)(C),Ce=(0,Sl.Z)(Ee,2),Te=Ce[0],xe=Ce[1],Se=(0,ge.useState)(T),Ie=(0,Sl.Z)(Se,2),ke=Ie[0],Re=Ie[1],Ae=(0,ge.useState)(y),Oe=(0,Sl.Z)(Ae,2),Le=Oe[0],Me=Oe[1],Ne=(0,ge.useState)(""),De=(0,Sl.Z)(Ne,2),Pe=De[0],Fe=De[1],Be=(0,ge.useState)(),Ue=(0,Sl.Z)(Be,2),He=Ue[0],je=Ue[1],We="api"===b?"creator":"organizer",Ve=lc()(Yl,(t={},(0,kl.Z)(t,Zl,X),(0,kl.Z)(t,ql,r),(0,kl.Z)(t,iu,ol().isMobile),t),a),ze=(0,ge.useMemo)((function(){var e=new Date(1e3*_e),t=new Date(1e3*ye),n=new Date,r="MMMdo E HH:mm",o="MMMdo E HH:mm";if((ae&zl.WholeDay)===zl.WholeDay){if((0,Ol.Z)(e,t)){var i="MMMdo E ".concat(Wl("全天"));return(0,Ll.Z)(n,e)||(i="yyyy".concat(Wl("年")).concat(i)),(0,Ml.Z)(e,i,{locale:_})}r="MMMdo E",o="MMMdo E ".concat(Wl("全天"))}else(0,Ol.Z)(e,t)&&(o="HH:mm");return(0,Ll.Z)(n,e)&&!(0,Ll.Z)(e,t)&&(o="yyyy".concat(Wl("年")).concat(o)),(0,Ll.Z)(n,e)||(r="yyyy".concat(Wl("年")).concat(r),(0,Ol.Z)(e,t)||(o="yyyy".concat(Wl("年")," MMMdo E HH:mm"))),"".concat((0,Ml.Z)(e,r,{locale:_})," - ").concat((0,Ml.Z)(t,o,{locale:_}))}),[_e,ye,ae]),Ge=(0,ge.useCallback)((function(e){z||(G(!0),setTimeout((function(){return null==d?void 0:d()})),p(e))}),[z,d,p]),Ye=function(){(function(e){return new Promise((function(t,n){vu.add((function(r){e().then((function(e){t(e)})).catch((function(e){n(e)})).finally((function(){r()}))}))}))})(u).then((function(e){if(e){e.can_join=void 0===e.can_join?void 0:Boolean(e.can_join);var t=e.subject,n=e.is_joined,r=e.create_id,o=e.attend_list,i=e.flag,a=e.start_time,s=e.end_time,c=e.repeat,l=e.meetting_room,u=e.place,p=e.can_join;J(n),de(t),se(i),he(a),we(s),xe(c),Re(l),Me(u),je(p),function(e,t,n,r){var o=e.attend_list,i=e.create_id,a=o,s=(a||[]).filter((function(e){return gu(e)})),c=(a||[]).filter((function(e){return!gu(e)})).map((function(e){return e.vid})),l=c.includes(i);l||gu({vid:i})||(c=[i].concat((0,Bl.Z)(c)));var u=Array.from(c),d=function(e){var t={},r=e.map((function(e){var r=e.vid,a=e.corp_name,s=e.corp_id,c=e.avatar,u=e.name,d=o.find((function(e){return e.vid===r}));if(d){if("unknown"===u)return n({memberError:{vid:r,content:"查询失败vid unknown: ".concat(r)}}),{vid:r,username:d.username,avatar:d.avatar,status:d.status};var p=Zi.wdocsUserCenter.getDisplayNameWithoutCorp(e);if(r!==i||gu({vid:i})||(t.createName=p,t.createCorpId=s,t.createCorpName=a,l))return{avatar:c,vid:r,status:d.status,username:p,corpname:a,corpid:s}}}));if(a.length>0){var c=[].concat((0,Bl.Z)(r.filter((function(e){return void 0!==e}))),(0,Bl.Z)(s));t.attendList=c}return t},p=u.map((function(e){return Zi.wdocsUserCenter.get(e)})).filter((function(e){return!!e}));p.length===u.length?t(d(p)):Zi.wdocsUserCenter.queryUserInfo(u).then((function(e){return t(d(e))})).catch((function(){r()}))}({create_id:r,attend_list:o},(function(t){var n=t.createCorpName,r=t.createCorpId,o=t.createName,i=t.attendList;F(n),j(r),o&&M(o),i&&R(i),Ge(e),setTimeout((function(){return null==d?void 0:d()}))}),f,(function(){Ge(e)}))}else Ge()})).catch((function(e){Ge(),console.log(e)}))};(0,ge.useEffect)((function(){Zi.wdocsUserCenter.getUserInfo().then((function(e){re(E===e.vid),Fe(e.corp_id),ol().isWxWork&&!z?Ye():Ge()})).catch((function(e){Ge(),console.log(e)}))}),[]);var qe=(0,ge.useMemo)((function(){var e=k.length;if(0!==e){var t=k;e>2&&(t=k.slice(0,2));var n=t.length;return ve().createElement(ve().Fragment,null,ve().createElement("span",{className:ou},Wl("参与人：")),ve().createElement("span",{className:ru},t.map((function(e,t){var r=e.username,o=e.corpid,i=e.corpname,a=e.name;return ve().createElement("span",null,r||a,Pe&&lu(Pe,o)&&i&&ve().createElement("span",{style:cu(i)},"@",i),t+1<n&&ve().createElement("span",null,"、"))}))),ve().createElement("span",{className:ou},Wl(e>2?"等共{{num}}人":"共{{num}}人",{num:e})))}}),[k]),Ze=(0,ge.useCallback)((function(e){e.stopPropagation(),hu()||c()}),[c]),Je=(0,ge.useCallback)((0,Il.Z)(Al().mark((function e(){var t;return Al().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!hu()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,l();case 4:return(t=e.sent)&&(_u(Wl("已加入日程"),"success"),J(!0)),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)}))),[l]),Ke=(0,ge.useMemo)((function(){return!mu||!1===He||void 0===Z||Z||ne||ae&zl.APIAppSchedule||!(ae&zl.CanJoin)?{text:Wl("查看详情"),onCallback:Ze}:{text:Wl("加入日程"),onCallback:Je}}),[Z,ne,ae,He,Ze,Je]),Qe=Ke.text,Xe=Ke.onCallback;return ve().createElement("div",{className:Ve,style:s,onClick:Ze},ve().createElement("div",{className:au},ve().createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ve().createElement("path",{d:"M0 3C0 1.34315 1.34315 0 3 0H21C22.6569 0 24 1.34315 24 3V21C24 22.6569 22.6569 24 21 24H3C1.34315 24 0 22.6569 0 21V3Z",fill:"#4B95F3"}),ve().createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 5.5C5.89543 5.5 5 6.39543 5 7.5V16.5C5 17.6046 5.89543 18.5 7 18.5H17C18.1046 18.5 19 17.6046 19 16.5V7.5C19 6.39543 18.1046 5.5 17 5.5H7ZM7 8.5C7 8.22386 7.22386 8 7.5 8H16.5C16.7761 8 17 8.22386 17 8.5C17 8.77614 16.7761 9 16.5 9H7.5C7.22386 9 7 8.77614 7 8.5ZM8.5 12.5C8.91421 12.5 9.25 12.1642 9.25 11.75C9.25 11.3358 8.91421 11 8.5 11C8.08579 11 7.75 11.3358 7.75 11.75C7.75 12.1642 8.08579 12.5 8.5 12.5ZM12 12.5C12.4142 12.5 12.75 12.1642 12.75 11.75C12.75 11.3358 12.4142 11 12 11C11.5858 11 11.25 11.3358 11.25 11.75C11.25 12.1642 11.5858 12.5 12 12.5ZM16.25 11.75C16.25 12.1642 15.9142 12.5 15.5 12.5C15.0858 12.5 14.75 12.1642 14.75 11.75C14.75 11.3358 15.0858 11 15.5 11C15.9142 11 16.25 11.3358 16.25 11.75ZM8.5 15.5C8.91421 15.5 9.25 15.1642 9.25 14.75C9.25 14.3358 8.91421 14 8.5 14C8.08579 14 7.75 14.3358 7.75 14.75C7.75 15.1642 8.08579 15.5 8.5 15.5ZM12 15.5C12.4142 15.5 12.75 15.1642 12.75 14.75C12.75 14.3358 12.4142 14 12 14C11.5858 14 11.25 14.3358 11.25 14.75C11.25 15.1642 11.5858 15.5 12 15.5ZM16.25 14.75C16.25 15.1642 15.9142 15.5 15.5 15.5C15.0858 15.5 14.75 15.1642 14.75 14.75C14.75 14.3358 15.0858 14 15.5 14C15.9142 14 16.25 14.3358 16.25 14.75Z",fill:"white"}))),ve().createElement("div",{className:Jl},ve().createElement("div",{className:"".concat(Kl," ").concat(Ql)},ue),ve().createElement("div",{className:"".concat(Xl," ").concat(Ql," ").concat(tu)},ze),Te&&Te!==Wl("不重复")&&ve().createElement("div",{className:"".concat(Xl," ").concat(tu," ").concat($l)},Te),ve().createElement("div",{className:eu,style:{marginTop:"8px"}},ve().createElement(ve().Fragment,null,ve().createElement("span",null,Wl(We),L),Pe&&lu(Pe,H)&&P&&ve().createElement("span",{style:cu(P)},"@",P))),qe&&ve().createElement("div",{className:"".concat(nu," ").concat(tu)},qe),ke&&ve().createElement("div",{className:eu},Wl("会议室："),ke),Le&&ve().createElement("div",{className:eu},Wl("地点：{{place}}",{place:Le}))),ve().createElement("div",{className:su},!z||void 0===He&&void 0===Z&&void 0===ne?null:ve().createElement(Fl.x,{onClick:function(e){return e.stopPropagation(),Xe(e)},onTouchEnd:function(e){e.stopPropagation()},onMouseOver:function(){return $(!0)},onMouseLeave:function(){return $(!1)},style:{padding:0}},Qe)))},yu=function(e){var t=e.unknownError,n=e.memberError;n&&d.ReportHelper.weiMonitorCube({module:d.ICubeModule.Feature,name:uo.C.WxworkCalender,action:"[cgi]member_info",msg:n.content}),t&&d.ReportHelper.weiMonitorCube({module:d.ICubeModule.Feature,name:uo.C.WxworkCalender,action:"[component]unknown_error",msg:t})},wu=function(e){var t=e.data,n=e.selected,o=e.onViewDetail,i=e.onAccept,a=e.onQuery,s=e.onUpdate,c=e.layoutBox,l=(0,ge.useRef)(null),u=(0,ge.useCallback)((function(){fl(l,e)}),[e]),f=(0,ge.useCallback)((function(e){void 0===e&&(e={}),l.current&&s((0,r.__assign)((0,r.__assign)({},e),{height:Math.floor((0,p.pxToTwips)(Math.round(l.current.getBoundingClientRect().height)))}))}),[s]),_=(0,d.isFieldBox)(c)?c.totalHeight:0,h={height:"".concat((0,p.twipsToPx)(_||t.height||0),"px")};return ve().createElement("div",{className:t.id,style:{width:"".concat($c,"px"),maxWidth:"100%"},ref:l},ve().createElement(bu,{active:n,data:t,onViewDetail:o,onAccept:i,onQuery:a,readyCallback:f,updateHeight:u,onError:yu,placeholderStyle:h}))},Eu=function(e){var t=e.className,n=e.layoutBox,r=e.children,o=e.onViewDetail,i=tl({layoutBox:n}).fontSize;return ve().createElement(el,{className:t,fontSize:i,onClick:o,icon:ve().createElement("svg",{viewBox:"0 0 20 21",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ve().createElement("path",{d:"M0.408726 2.04754C0 2.8497 0 3.8998 0 6V14C0 16.1002 0 17.1503 0.408726 17.9525C0.768251 18.6581 1.34193 19.2317 2.04754 19.5913C2.8497 20 3.8998 20 6 20H14C16.1002 20 17.1503 20 17.9525 19.5913C18.6581 19.2317 19.2318 18.6581 19.5913 17.9525C20 17.1503 20 16.1002 20 14V6C20 3.8998 20 2.8497 19.5913 2.04754C19.2318 1.34193 18.6581 0.768251 17.9525 0.408726C17.1503 0 16.1002 0 14 0H6C3.8998 0 2.8497 0 2.04754 0.408726C1.34193 0.768251 0.768251 1.34193 0.408726 2.04754ZM3 4.75C3 4.33579 3.33579 4 3.75 4H16.25C16.6642 4 17 4.33579 17 4.75C17 5.16421 16.6642 5.5 16.25 5.5H3.75C3.33579 5.5 3 5.16421 3 4.75ZM9.99974 11C9.30938 11 8.74974 10.4404 8.74974 9.75C8.74974 9.05964 9.30938 8.5 9.99974 8.5C10.6901 8.5 11.2497 9.05964 11.2497 9.75C11.2497 10.4404 10.6901 11 9.99974 11ZM5.24974 11.0013C4.55938 11.0013 3.99974 10.4417 3.99974 9.7513C3.99974 9.06095 4.55938 8.5013 5.24974 8.5013C5.9401 8.5013 6.49974 9.06095 6.49974 9.7513C6.49974 10.4417 5.9401 11.0013 5.24974 11.0013ZM15.9997 9.75C15.9997 10.4404 15.4401 11 14.7497 11C14.0594 11 13.4997 10.4404 13.4997 9.75C13.4997 9.05964 14.0594 8.5 14.7497 8.5C15.4401 8.5 15.9997 9.05964 15.9997 9.75ZM5.24967 15.5C4.55932 15.5 3.99967 14.9404 3.99967 14.25C3.99967 13.5596 4.55932 13 5.24967 13C5.94003 13 6.49967 13.5596 6.49967 14.25C6.49967 14.9404 5.94003 15.5 5.24967 15.5ZM9.99967 15.5C9.30932 15.5 8.74967 14.9404 8.74967 14.25C8.74967 13.5596 9.30932 13 9.99967 13C10.69 13 11.2497 13.5596 11.2497 14.25C11.2497 14.9404 10.69 15.5 9.99967 15.5ZM15.9997 14.25C15.9997 14.9404 15.44 15.5 14.7497 15.5C14.0593 15.5 13.4997 14.9404 13.4997 14.25C13.4997 13.5596 14.0593 13 14.7497 13C15.44 13 15.9997 13.5596 15.9997 14.25Z",fill:"#4B95F3"}))},r)},Cu=n(75571),Tu=function(e){function t(t){var n=e.call(this,t)||this;return n.isMobile=!1,n.updateSelection=function(e){n.setState({selected:e})},n.onViewDetail=function(e){return null==e||e.stopPropagation(),n.openDetail()},n.state={selected:!1,isJoined:void 0},n.openDetail=n.openDetail.bind(n),n.showToolbar=n.showToolbar.bind(n),n.onAccept=n.onAccept.bind(n),n.onQuery=n.onQuery.bind(n),n.onUpdate=n.onUpdate.bind(n),n}var n,o;return(0,r.__extends)(t,e),t.prototype.openDetail=function(){var e;return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,n,o,i,a,s;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return t=this.props,n=t.data,o=t.layoutBox,0==(n.flag&Cu.l3.Deleted)?[3,1]:(this.isMobile?Tl().show({content:(0,ii.$t)("card:event-deleted")}):El.ZP.show({content:(0,ii.$t)("card:event-deleted")}),[3,3]);case 1:return i=this.cardService.getCardPosition(o),a=i.x,s=i.y,[4,null===(e=this.loader.instance)||void 0===e?void 0:e.onViewDetail({scheduleId:n.schedule_id,shareKey:n.sharekey,x:a,y:s})];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},t.prototype.showToolbar=function(e){var t;null===(t=this.loader.instance)||void 0===t||t.toggleToolbar(e)},t.prototype.componentWillUnmount=function(){var e;null===(e=this.loader.instance)||void 0===e||e.toggleToolbar({show:!1})},t.prototype.onAccept=function(){var e;return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return t=this.props.data,[4,null===(e=this.loader.instance)||void 0===e?void 0:e.onAccept(t.schedule_id,t.sharekey)];case 1:return[2,n.sent()||!1]}}))}))},t.prototype.onQuery=function(){var e;return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return t=this.props.data,[4,null===(e=this.loader.instance)||void 0===e?void 0:e.onQuery({schedule_id:t.schedule_id,sharekey:t.sharekey})];case 1:return[2,n.sent()]}}))}))},t.prototype.onUpdate=function(e){var t,n=this.props,r=n.data,o=n.layoutBox;null===(t=this.loader.instance)||void 0===t||t.onUpdate(r,e,this.props.editor.getIndexFromRange(o.getRange()))},t.prototype.render=function(){var e,t=this.state.selected,n=this.props,r=n.data,o=n.editor,i=n.layoutBox,a=n.fieldInfo,s=n.children,c=r.layout;return e=(void 0===c?d.FieldDisplayLayoutType.Card:c)===d.FieldDisplayLayoutType.Inline?ve().createElement(Eu,{onViewDetail:this.onViewDetail,layoutBox:i},s):ve().createElement(wu,{className:r.id,data:r,editor:o,layoutBox:i,fieldInfo:a,selected:t,onViewDetail:this.onViewDetail,onAccept:this.onAccept,onQuery:this.onQuery,onUpdate:this.onUpdate},s),ve().createElement(Xc,{data:r,editor:o,layoutBox:i,field:a,onClick:this.onViewDetail,onShowToolbar:this.showToolbar,onSelect:this.updateSelection},e)},(0,r.__decorate)([(0,x.aN)(xl.IFieldcodeWxworkCalenderFeature),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==j.IDynamicLoader&&j.IDynamicLoader)?n:Object)],t.prototype,"loader",void 0),(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(o=void 0!==vl&&vl)?o:Object)],t.prototype,"cardService",void 0),(0,r.__decorate)([(0,Gc.nB)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"openDetail",null),(0,r.__decorate)([(0,Gc.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"showToolbar",null),(0,r.__decorate)([(0,Gc.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"componentWillUnmount",null),(0,r.__decorate)([(0,Gc.nB)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"onAccept",null),(0,r.__decorate)([(0,Gc.nB)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"onQuery",null),(0,r.__decorate)([(0,Gc.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"onUpdate",null),t}(ge.Component),xu=n(53398),Su=function(e,t,n,r,o){var i,a=null===(i=t.fieldCode.instructions)||void 0===i?void 0:i[0],s=a&&(0,xu.J2)(a,!0);return s?ve().createElement(Tu,{key:"field-trigger-".concat(n.uuid),editor:e,layoutBox:n,fieldInfo:t,data:s,overrideStyle:r,bridge:o},al(n)):null},Iu=(oc.zE.WxworkCalender,sl((function(e,t,n,r,o){var i=cl(o,n),a=Su(e,t,n,i,r);return a?{element:a,overrideStyle:i}:null})),n(56936)),ku=null!==(fu="undefined"==typeof window?null:window.i18n)&&void 0!==fu?fu:lo.ZP;!function(e,t){var n=function(n){ku&&ku.getResource&&ku.addResource&&Object.entries(e).forEach((function(e){var r=(0,Sl.Z)(e,2),o=r[0],i=r[1];Object.entries(i).forEach((function(e){var r=(0,Sl.Z)(e,2),i=r[0],a=r[1],s=null!=t?t:n.defaultNS||"legacy";ku.getResource(o,s,i)||ku.addResource(o,s,i,a)}))}))};if(ku&&"undefined"!=typeof window){if(window.noSharedI18next&&!window.i18n){window.i18n=lo.ZP;var r="zh-CN";try{var o=localStorage.getItem("shared-language");o&&(r=o)}catch(e){}lo.ZP.init({lng:r,resources:{},debug:!0,ns:"legacy",defaultNS:"legacy"})}ku.isInitialized?n(ku.options):ku.on("initialized",n)}}({"en-US":{"chat-history":"Chat History of {{group}}"},"zh-CN":{"chat-history":"{{group}}的聊天记录"}});var Ru,Au,Ou="ChatHistory_history__CyzbR",Lu="ChatHistory_active__iUmn1",Mu="ChatHistory_title__DZEYH",Nu="ChatHistory_content__L1vN7",Du="Message_message__RJVYk",Pu=function(e){var t=e.username,n=e.textContent;return ve().createElement("div",{className:Du},t,": ",n)},Fu=function(e){var t,n,r=e.groupName,o=e.chatList,i=e.onClick,a=e.className,s=void 0===a?"":a,c=e.style,l=e.active,u=void 0!==l&&l,d=function(e){var t=(0,ge.useState)(!1),n=(0,Sl.Z)(t,2),r=n[0],o=n[1],i=(0,ge.useCallback)((0,Il.Z)(Al().mark((function t(){var n,i,a,s=arguments;return Al().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r){t.next=4;break}for(o(!0),n=s.length,i=new Array(n),a=0;a<n;a++)i[a]=s[a];return t.abrupt("return",e.apply(null,i).finally((function(){o(!1)})));case 4:case"end":return t.stop()}}),t)}))),[r,e]);return{awaiting:r,asyncAction:i}}((0,Il.Z)(Al().mark((function e(){return Al().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i());case 1:case"end":return e.stop()}}),e)})))),p=d.asyncAction;return ve().createElement("div",{className:"".concat(Ou," ").concat(u?Lu:""," ").concat(s),style:c,onClick:p},ve().createElement("div",{className:Mu},(t="chat-history",n={group:r},(null==ku?void 0:ku.t(t,n))||"".concat(t))),ve().createElement("div",{className:Nu},o.map((function(e,t){var n=e.iconurl,r=e.username,o=e.timestamp,i=e.textContent,a=e.company;return ve().createElement(Pu,{key:t,iconurl:n,username:r,timestamp:o,textContent:i,company:a})}))))},Bu=function(e){var t=e.data.jsonData,n=t.groupName,r=t.chatList,o=e.className,i=e.selected,a=(0,ge.useRef)(null);return function(e,t){(0,ge.useEffect)((function(){fl(t,e)}),[t])}(e,a),ve().createElement("div",{className:o,style:{width:"".concat($c,"px"),maxWidth:"100%"},ref:a},ve().createElement(Fu,{active:i,groupName:n,chatList:r,onClick:function(){}}))},Uu=function(e){var t=e.className,n=e.layoutBox,r=e.children,o=tl({layoutBox:n}).fontSize;return ve().createElement(el,{className:t,fontSize:o,icon:ve().createElement("svg",{viewBox:"0 0 20 21",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ve().createElement("path",{d:"M0 6.5C0 4.3998 0 3.3497 0.408726 2.54754C0.768251 1.84193 1.34193 1.26825 2.04754 0.908726C2.8497 0.5 3.8998 0.5 6 0.5H14C16.1002 0.5 17.1503 0.5 17.9525 0.908726C18.6581 1.26825 19.2317 1.84193 19.5913 2.54754C20 3.3497 20 4.3998 20 6.5V14.5C20 16.6002 20 17.6503 19.5913 18.4525C19.2317 19.1581 18.6581 19.7317 17.9525 20.0913C17.1503 20.5 16.1002 20.5 14 20.5H6C3.8998 20.5 2.8497 20.5 2.04754 20.0913C1.34193 19.7317 0.768251 19.1581 0.408726 18.4525C0 17.6503 0 16.6002 0 14.5V6.5Z",fill:"#4B95F3"}),ve().createElement("path",{d:"M4.25 10.4636C4.25 7.72002 6.82456 5.5 10 5.5C13.1756 5.5 15.75 7.72002 15.75 10.4636C15.75 13.1974 13.1756 15.4174 10 15.4273C9.34397 15.4174 8.71042 15.3204 8.114 15.1409C8.06982 15.1286 8.07344 15.1292 7.95772 15.1056C7.842 15.0821 7.74133 15.1409 7.654 15.1886L6.412 15.9523C6.35482 15.984 6.321 16 6.274 16C6.17329 16 6.08777 15.9112 6.09 15.8091C6.08777 15.7527 6.10514 15.7079 6.11862 15.6606C6.13209 15.6133 6.28621 15.0311 6.366 14.6636C6.3773 14.6116 6.38347 14.5817 6.38347 14.4831C6.38347 14.3846 6.3343 14.2788 6.228 14.1864C5.0247 13.2978 4.25 11.9527 4.25 10.4636Z",fill:"white"}))},r)},Hu=function(e){function t(t){var n=e.call(this,t)||this;return n.updateSelection=function(e){n.setState({selected:e})},n.state={selected:!1},n.openDetail=n.openDetail.bind(n),n.showToolbar=n.showToolbar.bind(n),n}var n;return(0,r.__extends)(t,e),t.prototype.openDetail=function(){var e;return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(n){return t=this.props.data,[2,null===(e=this.loader.instance)||void 0===e?void 0:e.onOpen(t.chatMessageId)]}))}))},t.prototype.showToolbar=function(e){var t;null===(t=this.loader.instance)||void 0===t||t.toggleToolbar(e)},t.prototype.componentWillUnmount=function(){var e;null===(e=this.loader.instance)||void 0===e||e.toggleToolbar({show:!1})},t.prototype.render=function(){var e,t=this.state.selected,n=this.props,r=n.data,o=n.editor,i=n.layoutBox,a=n.fieldInfo,s=n.children,c=r.layout;return e=(void 0===c?d.FieldDisplayLayoutType.Card:c)===d.FieldDisplayLayoutType.Inline?ve().createElement(Uu,{layoutBox:i},s):ve().createElement(Bu,{data:r,editor:o,layoutBox:i,fieldInfo:a,selected:t},s),ve().createElement(Xc,{data:r,editor:o,layoutBox:i,field:a,onClick:this.openDetail,onShowToolbar:this.showToolbar,onSelect:this.updateSelection},e)},(0,r.__decorate)([(0,x.aN)(Iu.IFieldcodeWxworkGroupChatFeature),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==j.IDynamicLoader&&j.IDynamicLoader)?n:Object)],t.prototype,"loader",void 0),(0,r.__decorate)([(0,Gc.nB)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"openDetail",null),(0,r.__decorate)([(0,Gc.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"showToolbar",null),(0,r.__decorate)([(0,Gc.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"componentWillUnmount",null),t}(ge.Component),ju=n(72832),Wu=function(e,t,n,r,o){var i,a=null===(i=t.fieldCode.instructions)||void 0===i?void 0:i[0],s=a&&(0,ju.Bf)(a,!0);return s?ve().createElement(Hu,{key:"field-trigger-".concat(n.uuid),editor:e,layoutBox:n,fieldInfo:t,data:s,overrideStyle:r,bridge:o},al(n)):null},Vu=(oc.zE.WxworkGroupChat,sl((function(e,t,n,r,o){var i=cl(o,n),a=Wu(e,t,n,i,r);return a?{element:a,overrideStyle:i}:null})),n(85956)),zu="tdocs-wxwork-cold-start-button",Gu="tdocs-wxwork-cold-start-button-mobile",Yu="tdocs-mask",qu=n(39553),Zu=n(14366),Ju=n(5151),Ku=Ga.default,Qu=["doc","docx","xls","xlsx","txt","csv","ppt","pptx","xmind","pos","vsd","vsdx"],Xu=Qu.reduce((function(e,t){return"".concat(e,".").concat(t,",")}),""),$u=function(e){function t(t){var n=e.call(this,t)||this;return n.loading=!1,n.loadingTimer=0,n.inputEle=null,n.state={isTouched:!1},n.importFiles=n.importFiles.bind(n),n.stopPropagationImportFiles=n.stopPropagationImportFiles.bind(n),n.stopPropagation=n.stopPropagation.bind(n),n.visibilitychangeHandle=n.visibilitychangeHandle.bind(n),n.touchStart=n.touchStart.bind(n),n.touchEnd=n.touchEnd.bind(n),n.addContainer(),n}var n,o,i;return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){},t.prototype.componentWillUnmount=function(){var e;window.clearTimeout(this.loadingTimer),null===(e=this.inputEle)||void 0===e||e.remove()},t.prototype.visibilitychangeHandle=function(){var e;(null===(e=this.loader.instance)||void 0===e?void 0:e.isOpenNewDoc)&&"visible"===document.visibilityState&&Zu.Z.post("/wedoc/query_import_doc").then((function(e){var t,n,r=null===(n=null===(t=e.data)||void 0===t?void 0:t.body)||void 0===n?void 0:n.doc_ids;if(r){var o=r[r.length-1];(0,qu.l)({url:o,replace:!1})}}))},t.prototype.importFiles=function(e,t){var n,o;return(0,r.__awaiter)(this,void 0,void 0,(function(){var i,a=this;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.capacityService.checkCapacityAsync({interceptType:Ju.D.ImportFile,channel:"doc_default_pc"})];case 1:return r.sent()||this.loading||(this.loading=!0,i=this.props.editor,null===(n=i.surface)||void 0===n||n.requestBlur(),this.loadingTimer&&window.clearTimeout(this.loadingTimer),this.loadingTimer=window.setTimeout((function(){a.loadingTimer=0,a.loading&&(a.loading=!1)}),500),null===(o=this.loader.instance)||void 0===o||o.importFiles(e,t)),[2]}}))}))},t.prototype.stopPropagationImportFiles=function(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return this.stopPropagation(e),[4,this.capacityService.checkCapacityAsync({interceptType:Ju.D.ImportFile,channel:"doc_default_pc"})];case 1:return t.sent()?[2]:this.inputEle?(this.inputEle.click(),[2]):[4,this.importFiles()];case 2:return t.sent(),[2]}}))}))},t.prototype.stopPropagation=function(e){e.preventDefault(),e.stopPropagation()},t.prototype.touchStart=function(e){this.setState({isTouched:!0}),this.stopPropagation(e)},t.prototype.touchEnd=function(e){this.setState({isTouched:!1}),this.stopPropagationImportFiles(e)},t.prototype.isValidFile=function(e){if(!e)return!1;var t=e.split(".");if(t.length<2)return!1;var n=t.pop();return!!n&&Qu.includes(n)},t.prototype.addContainer=function(){var e=this,t=document.createElement("input");t.type="file",t.id="COLD_START_BUTTON_INPUT_CONTAINER",t.style.display="none",t.multiple=!0,p.PlatformUtil.isWeWork()||(t.accept=Xu),t.addEventListener("change",(function(){if(t.files){for(var n=t.files,r=0;r<n.length;r++){var o=n.item(r);if(!e.isValidFile(null==o?void 0:o.name))return void Ku.show({message:(0,ii.$t)("仅支持 ".concat(Qu.join("/")," 格式的文件")),autoClose:!0,duration:3e3})}e.importFiles(t.files,(function(){t.value=""}))}})),document.body.appendChild(t),this.inputEle=t},t.prototype.render=function(){var e,t=lc()(((e={})[zu]=!0,e[Gu]=!1,e));return ve().createElement("div",{className:t,onClick:this.stopPropagation,onTouchStart:this.touchStart,onFocus:this.stopPropagation,onTouchEnd:this.touchEnd,onMouseDown:this.stopPropagation,onMouseUp:this.stopPropagationImportFiles},(0,ii.$t)("导入本地文档"),this.state.isTouched&&ve().createElement("div",{className:Yu}))},(0,r.__decorate)([(0,x.aN)(Vu.IFieldcodeWxworkColdStartButtonFeature),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==j.IDynamicLoader&&j.IDynamicLoader)?n:Object)],t.prototype,"loader",void 0),(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type",Object)],t.prototype,"loading",void 0),(0,r.__decorate)([(0,x.tB)(Ju.i),(0,r.__metadata)("design:type","function"==typeof(o=void 0!==Ju.i&&Ju.i)?o:Object)],t.prototype,"capacityService",void 0),(0,r.__decorate)([(0,Gc.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"componentWillUnmount",null),(0,r.__decorate)([(0,Gc.nB)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["function"==typeof(i="undefined"!=typeof FileList&&FileList)?i:Object,Function]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"importFiles",null),t}(ge.Component),ed=function(e,t,n,r,o){return ve().createElement($u,{data:{},editor:e,layoutBox:n,fieldInfo:t,overrideStyle:r,bridge:o},al(n))},td=(oc.zE.WxworkColdStartButton,sl((function(e,t,n,r){var o=d.CssUtil.computeContainerStyles(n),i=ed(e,t,n,o,r);return i?{element:i,overrideStyle:o}:null})),n(22418)),nd=n(81030),rd={button:"base_button__5viNq",primary:"base_primary__CtbVy",disabled:"base_disabled__lwQvX",divider:"base_divider__qNZrk",avatar:"base_avatar__WgdLV",loading:"base_loading__hZ7SX"},od=["type","disabled","loading","children","className"],id=function(e){var t=e.type,n=void 0===t?"primary":t,r=e.disabled,o=void 0!==r&&r,i=e.loading,a=void 0!==i&&i,s=e.children,c=e.className,l=(0,nd.Z)(e,od),u=[rd.button,c];return o?u.push(rd.disabled):"primary"===n?u.push(rd.primary):"text-primary"===n&&u.push(rd["text-primary"]),a&&u.push(rd.loading),ve().createElement("span",(0,td.Z)({},l,{className:u.join(" ")}),s)};function ad(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function sd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ad(Object(n),!0).forEach((function(t){(0,kl.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ad(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function cd(e){var t=e.radius,n=e.src,r=e.size,o=e.className,i=e.style;return ve().createElement("span",{style:sd({borderRadius:t,width:"".concat(r,"px"),height:"".concat(r,"px")},i),className:"".concat(rd.avatar," ").concat(o)},ve().createElement("img",{src:n}))}!function(e){e[e.Unjoined=0]="Unjoined",e[e.Joined=1]="Joined",e[e.Expired=2]="Expired"}(Ru||(Ru={})),function(e){e[e.Male=1]="Male",e[e.Female=2]="Female"}(Au||(Au={}));var ld,ud={card:"styles_card__3n8fz",active:"styles_active__Aes8x",hover_btn:"styles_hover_btn__Ar77P",disabled:"styles_disabled__K06Pq",content:"styles_content__rt1Ng",avatar:"styles_avatar__fYTgs",tag:"styles_tag__i0gaX",max_lines_2:"styles_max_lines_2__rP6Ck",footer:"styles_footer__ra1J9",info:"styles_info__pqjWQ",title:"styles_title__sU8ps",type:"styles_type__l8iTU",sub_title:"styles_sub_title__qCAwj",group_title:"styles_group_title__MdloU",group_name:"styles_group_name__EE23d",action:"styles_action__rajJh"},dd=null!==(ld="undefined"==typeof window?null:window.i18n)&&void 0!==ld?ld:lo.ZP;function pd(e,t){var n=null==dd?void 0:dd.t(e,t);return n||"".concat(e)}var fd=["status"],_d=function(e){var t=e.className,n=void 0===t?"":t,r=e.style,o=e.active,i=e.avatar,a=e.name,s=e.expiredTime,c=e.external,l=e.status,u=(0,ge.useMemo)((function(){return l===Ru.Expired||s<Date.now()}),[s]),d=i||"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjNEI5NUYzIiBkPSJNMCAwaDQwdjQwSDB6Ii8+PHBhdGggZD0iTTI2LjkyIDI5Ljk5aC03LjQzNGEuNDYyLjQ2MiAwIDAgMS0uNDcyLS40MyAzLjQ2MyAzLjQ2MyAwIDAgMSAuMDQxLS44NDZjLjEtLjQ4NS4zNDctLjYyNC4zOTMtLjY1bC4wMDgtLjAwNGMuMDMtLjEwMyAxLjMzNy0xLjIyNiAzLjQxMS0yLjMxNyAxLjU0Mi0uNzA0IDEuODUxLTEuMjEyIDIuMDk2LTEuODM4LjM3My0uOTU1LS4wNDctMS44MDEtLjA0Ny0xLjgwMS0xLjI2NC0yLjAxLTEuNDU2LTMuMzEyLTEuMDM0LTUuODIzLjI3LTEuNjE0IDEuNzA4LTIuMTIyIDIuNjczLTIuMjcuMi0uMDIyLjQxIDAgLjQxIDB2LjAwOGMuMDk2LS4wMDUuMzI1LS4wMTQuNDguMDAyLjk2NS4xNDkgMi40Mi42NDYgMi42OSAyLjI2LjQyMSAyLjUxLjIxMyAzLjgyNS0xLjA1MiA1LjgzMyAwIDAtLjQyLjg0Ni0uMDQ2IDEuODAyLjI0NS42MjUuNTU0IDEuMTM0IDIuMDk2IDEuODM4IDIuMDc0IDEuMDkgMy4zODIgMi4yMTQgMy40MTEgMi4zMTdsLjAwOC4wMDRjLjA0NS4wMjYuMjkyLjE2NS4zOTMuNjUuMDU2LjI3LjA1NS41OTMuMDQuODQ2YS40NjIuNDYyIDAgMCAxLS40NzEuNDI5SDI2Ljkydi0uMDF6IiBmaWxsPSIjZmZmIiBmaWxsLW9wYWNpdHk9Ii45Ii8+PHBhdGggZD0iTTI3LjA0OCAyNy40N2ExLjMxIDEuMzEgMCAwIDAtLjI3LS4yNTQgMS42MTggMS42MTggMCAwIDAtLjA4MS0uMDg3IDQuNzc3IDQuNzc3IDAgMCAwLS4yNTgtLjIzNWMtLjIxLS4xODEtLjUxLS40Mi0uODg4LS42OTVhMjUuOTI0IDI1LjkyNCAwIDAgMC0zLjE3Ny0xLjk2MmMtLjk0LS40MjktMS40Ni0uNzc5LTEuNzc2LTEuMDg4LS4zMDUtLjI5Ny0uNDQ2LS41NzgtLjU4Ni0uOTM2YTIuNDE5IDIuNDE5IDAgMCAxLS4xMTktMS4zMDUgMi41OCAyLjU4IDAgMCAxIC4xNS0uNTJsLjAwMi0uMDA3Yy44LTEuMjc1IDEuMjg5LTIuMzY4IDEuNS0zLjU2Mi4yMS0xLjE5OC4xMzQtMi40NTgtLjEzMy00LjA1LS4zOTctMi4zNjUtMi41MzYtMy4wNDUtMy43OC0zLjIzN2EuNTEyLjUxMiAwIDAgMC0uNjI2LS4wMTd2LjAwNWwuMDAxLS4wMDRIMTdsLS4wMTItLjAwMmEyLjc4IDIuNzggMCAwIDAtLjE3OC0uMDEgMy4wOTEgMy4wOTEgMCAwIDAtLjQ0NC4wMTVjLTEuMjUuMTkzLTMuMzYyLjg5LTMuNzU4IDMuMjUtLjI2NyAxLjU5LS4zNDggMi44NDctLjE0MyA0LjA0Mi4yMDUgMS4xOTEuNjkgMi4yODEgMS40OSAzLjU1N2wuMDAyLjAwN2EyLjU3MSAyLjU3MSAwIDAgMSAuMTUuNTJjLjA2LjM1LjA3LjgxNS0uMTIgMS4zMDQtLjE0LjM1OS0uMjgxLjY0LS41ODUuOTM3LS4zMTguMzA5LS44MzcuNjYtMS43NzcgMS4wODhhMjUuOTE0IDI1LjkxNCAwIDAgMC0zLjE3NyAxLjk2MmMtLjM3Ny4yNzUtLjY3Ny41MTQtLjg4OC42OTVhNC43OCA0Ljc4IDAgMCAwLS4yNTcuMjM1IDEuNTk3IDEuNTk3IDAgMCAwLS4wODIuMDg3Yy0uMDcyLjA1LS4xNy4xMy0uMjcuMjUzYTEuOTE3IDEuOTE3IDAgMCAwLS4zNzIuODM0Yy0uMDkzLjQ0OC0uMDc4Ljk2NS0uMDU0IDEuMzA1YS45NjguOTY4IDAgMCAwIC45NzQuODkyaDkuMjg2YS40OTkuNDk5IDAgMCAwIC4xMTUuMDEzSDI2LjVjLjQ5IDAgLjkzNi0uMzY0Ljk3NC0uODkyLjAyNC0uMzQuMDQtLjg1Ny0uMDUzLTEuMzA0YTEuOTE5IDEuOTE5IDAgMCAwLS4zNzMtLjgzNXoiIGZpbGw9IiNmZmYiIHN0cm9rZT0iIzRCOTVGMyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+PC9zdmc+",p=(0,ge.useState)(!1),f=(0,Sl.Z)(p,2),_=f[0],h=f[1],m=void 0!==l?function(e){var t=e.status,n=(0,nd.Z)(e,fd);switch(t){case Ru.Unjoined:return ve().createElement(id,n,pd("join-group"));case Ru.Joined:return ve().createElement(id,(0,td.Z)({},n,{type:"primary"}),pd("open-group"));case Ru.Expired:return ve().createElement(id,(0,td.Z)({},n,{disabled:!0}),pd("expired"))}}({status:l,onMouseOver:function(){return h(!0)},onMouseLeave:function(){return h(!1)}}):null,g="\n        ".concat(ud.card,"\n        ").concat(u?ud.disabled:ud.clickable,"\n        ").concat(_?ud.hover_btn:"","\n        ").concat(o?ud.active:"","\n        ").concat(n,"\n    ");return ve().createElement("div",{className:g,style:r},ve().createElement("div",{className:ud.content},ve().createElement(cd,{style:{alignSelf:"flex-start",background:"none"},className:ud.avatar,size:40,radius:"5px",src:d}),ve().createElement("div",{className:ud.info},ve().createElement("div",{className:ud.group_name},ve().createElement("div",{className:"".concat(ud.group_title," ").concat(ud.max_lines_2)},a),c&&ve().createElement("span",{className:ud.tag},pd("external")))),ve().createElement("div",{className:ud.action},m)))},hd=function(e){var t=e.active,n=void 0!==t&&t,r=e.avatar,o=e.name,i=e.jobTitle,a=e.type,s=e.corp_name,c=e.onOpen,l=e.className,u=void 0===l?"":l,d=e.style,p=e.gender,f=(0,ge.useState)(!1),_=(0,Sl.Z)(f,2),h=_[0],m=_[1],g="".concat(h?ud.hover_btn:""," ").concat(ud.card,"\n        ").concat(n?ud.active:""," ").concat(u),v=r||"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbD0iIzRCOTVGMyIgZD0iTTAgMGg0MHY0MEgweiIvPjxwYXRoIGQ9Ik0zMS45ODkgMjkuMDQyYTEuNDY3IDEuNDY3IDAgMCAwLS4zMTUtLjI5MiAxLjc1OSAxLjc1OSAwIDAgMC0uMS0uMTA4IDUuNjQ4IDUuNjQ4IDAgMCAwLS4zMDQtLjI3N2MtLjI1LS4yMTYtLjYwOS0uNS0xLjA2LS44M2EzMS4wMTkgMzEuMDE5IDAgMCAwLTMuNzk4LTIuMzQ2Yy0xLjEzMy0uNTE3LTEuNzctLjk0NC0yLjE2Mi0xLjMyNy0uMzgtLjM3LS41NTUtLjcyMi0uNzI2LTEuMTZhMy4wMDUgMy4wMDUgMCAwIDEtLjE0OS0xLjYyIDMuMTkxIDMuMTkxIDAgMCAxIC4xODYtLjY0N2wuMDA3LS4wMTVjLjk1OC0xLjUyOCAxLjU0LTIuODMgMS43OS00LjI0OC4yNTEtMS40MjMuMTYyLTIuOTIzLS4xNTktNC44My0uNDY0LTIuNzcxLTIuOTctMy41NzUtNC40NTUtMy44MDVhLjUwNC41MDQgMCAwIDAtLjc0Ni0uMDJ2LjAwOC0uMDA3aC0uMDA3bC0uMDEzLS4wMDJhMy4xOTYgMy4xOTYgMCAwIDAtLjIwOC0uMDEyIDMuNjE0IDMuNjE0IDAgMCAwLS41MTQuMDE3Yy0xLjQ5My4yMy0zLjk2NiAxLjA1NC00LjQzIDMuODItLjMyIDEuOTA3LS40MTYgMy40MDItLjE3MiA0LjgyLjI0NCAxLjQxNi44MiAyLjcxNSAxLjc3OCA0LjI0M2wuMDA3LjAxNWEzLjE5MSAzLjE5MSAwIDAgMSAuMTg2LjY0NiAzLjAxMSAzLjAxMSAwIDAgMS0uMTQ5IDEuNjIyYy0uMTcuNDM3LS4zNDYuNzg5LS43MjYgMS4xNi0uMzkzLjM4My0xLjAyOS44MDktMi4xNjIgMS4zMjZhMzEuMDE0IDMxLjAxNCAwIDAgMC0zLjc5OCAyLjM0NmMtLjQ1MS4zMy0uODEuNjE0LTEuMDYuODNhNS42NTMgNS42NTMgMCAwIDAtLjMwNC4yNzdjLS4wMzUuMDM2LS4wNy4wNzItLjEuMTA4YTEuNDcxIDEuNDcxIDAgMCAwLS4zMTUuMjkyYy0uMTczLjIxNC0uMzM2LjUyMy0uNDI3Ljk2LS4xMDguNTIzLS4wOTEgMS4xMzItLjA2MiAxLjUzOC4wNDIuNTc4LjUzLjk3OCAxLjA3Ljk3OGgxMS4xNjNhLjUuNSAwIDAgMCAuMTI2LjAxNmgxMS41MjdjLjU0IDAgMS4wMjgtLjQgMS4wNy0uOTc4LjAzLS40MDYuMDQ2LTEuMDE1LS4wNjItMS41MzktLjA5LS40MzctLjI1NC0uNzQ1LS40MjctLjk1OXptLTguNDEyLTguNjQxem0tNy4xNTQtLjAxNnptLTcuNzYgOC43MjgtLjAwNi0uMDEyLjAwNy4wMTJ6IiBmaWxsPSIjZmZmIiBzdHJva2U9IiM0Qjk1RjMiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPjwvc3ZnPg==";return ve().createElement("div",{className:g,onClick:function(e){return e.stopPropagation(),c(!1)},onTouchEnd:function(e){e.stopPropagation()},style:d},ve().createElement("div",{className:ud.content},ve().createElement(cd,{className:ud.avatar,size:40,radius:"5px",src:v}),ve().createElement("div",{className:ud.info},ve().createElement("div",{className:ud.title},o,1===a&&ve().createElement("span",{className:ud.type,style:{color:"#ffb54d"}},"@",s),2===a&&ve().createElement("span",{className:ud.type,style:{color:"#369746"}},"@",pd("wechat"))),ve().createElement("div",{className:ud.sub_title},i)),ve().createElement("div",{className:ud.action},ve().createElement(id,{onClick:function(e){return e.stopPropagation(),c(!0)},onTouchEnd:function(e){e.stopPropagation()},type:"text-primary",onMouseOver:function(){return m(!0)},onMouseLeave:function(){return m(!1)}},pd("contact",{context:p===Au.Male?"male":"female"})))))};!function(e,t){var n=function(n){dd&&dd.getResource&&dd.addResource&&Object.entries(e).forEach((function(e){var r=(0,Sl.Z)(e,2),o=r[0],i=r[1];Object.entries(i).forEach((function(e){var r=(0,Sl.Z)(e,2),i=r[0],a=r[1],s=null!=t?t:n.defaultNS||"legacy";dd.getResource(o,s,i)||dd.addResource(o,s,i,a)}))}))};if(dd&&"undefined"!=typeof window){if(window.noSharedI18next&&!window.i18n){window.i18n=lo.ZP;var r="zh-CN";try{var o=localStorage.getItem("shared-language");o&&(r=o)}catch(e){}lo.ZP.init({lng:r,resources:{},debug:!0,ns:"legacy",defaultNS:"legacy"})}dd.isInitialized?n(dd.options):dd.on("initialized",n)}}({"en-US":{"join-group":"Join","open-group":"Open Group",expired:"Expired",external:"External",contact:"Contact {{gender}}",contact_male:"Contact Him",contact_female:"Contact Her",wechat:"Wechat","view-caret":"View Caret"},"zh-CN":{"join-group":"加入群聊","open-group":"进入群聊",expired:"已过期",external:"外部",contact:"联系{{gender}}",contact_male:"联系他",contact_female:"联系她",wechat:"微信","view-caret":"查看名片"}});var md=n(87404),gd=n(15091),vd=(n(16751),function(e){var t=e.data,n=e.className,r=e.selected,o=e.status,i=t.iconurl,a=t.name,s=t.expire,c=t.external;return ve().createElement("div",{className:n,style:{width:"".concat($c,"px"),maxWidth:"100%"}},ve().createElement(_d,{active:r,avatar:i,name:a,expiredTime:1e3*s,external:Boolean(c),status:o}))}),bd=function(e){var t=e.className,n=e.layoutBox,r=e.children,o=tl({layoutBox:n}).fontSize;return ve().createElement(el,{className:t,fontSize:o,icon:ve().createElement("svg",{viewBox:"0 0 20 21",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ve().createElement("path",{d:"M0 6.27783C0 4.17764 0 3.12754 0.408726 2.32537C0.768251 1.61976 1.34193 1.04608 2.04754 0.686558C2.8497 0.277832 3.8998 0.277832 6 0.277832H14C16.1002 0.277832 17.1503 0.277832 17.9525 0.686558C18.6581 1.04608 19.2317 1.61976 19.5913 2.32537C20 3.12754 20 4.17764 20 6.27783V14.2778C20 16.378 20 17.4281 19.5913 18.2303C19.2317 18.9359 18.6581 19.5096 17.9525 19.8691C17.1503 20.2778 16.1002 20.2778 14 20.2778H6C3.8998 20.2778 2.8497 20.2778 2.04754 19.8691C1.34193 19.5096 0.768251 18.9359 0.408726 18.2303C0 17.4281 0 16.378 0 14.2778V6.27783Z",fill:"#4B95F3"}),ve().createElement("path",{opacity:"0.6",d:"M13.9011 14.7778H16.809C16.9144 14.7778 16.9999 14.6924 16.9999 14.5869V14.298C16.9999 14.0893 16.8863 13.8971 16.7035 13.7964L14.1022 12.363C13.7646 12.1769 13.6926 11.7225 13.9563 11.4413C14.3231 11.0501 14.5271 10.534 14.5271 9.99777V9.30511C14.5271 8.46162 13.8434 7.77783 12.9999 7.77783C12.1564 7.77783 11.4726 8.46161 11.4726 9.3051V9.99777C11.4726 10.534 11.6767 11.0501 12.0434 11.4413C12.2819 11.6956 12.2459 12.0916 11.987 12.3027L13.226 12.9854C13.6648 13.2272 13.9374 13.6886 13.9374 14.1896V14.5278C13.9374 14.6147 13.9247 14.6986 13.9011 14.7778ZM9.01855 14.1528C9.05781 14.003 9.15689 13.8731 9.2962 13.7964L10.7019 13.0218L12.6227 14.0802C12.6515 14.096 12.6724 14.1223 12.6818 14.1528H9.01855Z",fill:"white"}),ve().createElement("path",{d:"M13.0625 14.7778H3.25C3.11193 14.7778 3 14.6659 3 14.5278V14.1896C3 13.9163 3.14867 13.6647 3.38805 13.5328L6.73522 11.6884C7.17052 11.4485 7.26325 10.8628 6.92332 10.5002C6.45058 9.99596 6.1875 9.33067 6.1875 8.63948V7.74658C6.1875 6.65927 7.06894 5.77783 8.15625 5.77783C9.24356 5.77783 10.125 6.65927 10.125 7.74658V8.63948C10.125 9.33067 9.86192 9.99596 9.38918 10.5002C9.04925 10.8628 9.14198 11.4485 9.57728 11.6884L12.9245 13.5328C13.1638 13.6647 13.3125 13.9163 13.3125 14.1896V14.5278C13.3125 14.6659 13.2006 14.7778 13.0625 14.7778Z",fill:"white"}))},r)},yd=function(e){function t(n){var r=e.call(this,n)||this;r.isMobile=!1,r.mounted=!1,r.updateSelection=function(e){r.setState({selected:e})};var o=t.joinedCache.get(n.data.vcode);return r.state={selected:!1,status:o?Ru.Joined:Ru.Unjoined},r.hasJoin=r.hasJoin.bind(r),r.onConfirm=r.onConfirm.bind(r),r.handleClick=r.handleClick.bind(r),r.showToolbar=r.showToolbar.bind(r),r}var n;return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.mounted=!0;var n=this.props.data;this.hasJoin().then((function(r){t.joinedCache.set(n.vcode,r),e.mounted&&e.setState({status:r?Ru.Joined:1e3*n.expire<Date.now()?Ru.Expired:Ru.Unjoined})}))},t.prototype.componentWillUnmount=function(){var e;this.mounted=!1,null===(e=this.loader.instance)||void 0===e||e.toggleToolbar({show:!1})},t.prototype.showToolbar=function(e){var t;null===(t=this.loader.instance)||void 0===t||t.toggleToolbar(e)},t.prototype.hasJoin=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return(0,r.__generator)(this,(function(r){return e=this.props,t=e.data,n=e.layoutBox,this.loader.instance?[2,this.loader.instance.checkIsJoined(t,this.props.editor.getIndexFromRange(n.getRange()))]:[2,!1]}))}))},t.prototype.onConfirm=function(){var e=this;return new Promise((function(t){if(!p.PlatformUtil.isWeWork()||e.isMobile)t(!0);else var n=e.props.data,r=Ii.default.confirm({type:"basic",title:null,content:ve().createElement("div",null,ve().createElement("span",{style:{display:"block",margin:"10px auto 20px"}},ve().createElement(cd,{size:60,radius:"5px",src:n.iconurl})),ve().createElement("div",{style:{fontWeight:500,fontSize:"18px",textAlign:"center"}},"".concat(n.name))),footer:ve().createElement(md.default,{type:"primary",style:{display:"block",margin:"48px auto 0",borderRadius:"4px",width:"200px",height:"32px",fontSize:"14px"},onClick:function(){return t(!0)}},(0,ii.$t)("card:join-group")),onOk:function(){r.close(),t(!0)},onCancel:function(){return t(!1)}})}))},t.prototype.handleClick=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,t;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return e=this.props.data,this.loader.instance?[4,this.hasJoin()]:[3,7];case 1:return n.sent()?[4,this.loader.instance.onOpen(e)]:[3,3];case 2:return n.sent(),[3,7];case 3:return[4,this.onConfirm()];case 4:return n.sent()?[4,this.loader.instance.onJoin(e)]:[3,7];case 5:return n.sent(),[4,this.hasJoin()];case 6:t=n.sent(),this.setState({status:t?Ru.Joined:Ru.Unjoined}),n.label=7;case 7:return[2]}}))}))},t.prototype.render=function(){var e,t=this.state,n=t.selected,r=t.status,o=this.props,i=o.data,a=o.editor,s=o.layoutBox,c=o.fieldInfo,l=o.children,u=i.layout;return e=(void 0===u?d.FieldDisplayLayoutType.Card:u)===d.FieldDisplayLayoutType.Inline?ve().createElement(bd,{layoutBox:s},l):ve().createElement(vd,{data:i,editor:a,layoutBox:s,fieldInfo:c,selected:n,status:r}),ve().createElement(Xc,{data:i,editor:a,layoutBox:s,field:c,onClick:this.handleClick,onShowToolbar:this.showToolbar,onSelect:this.updateSelection},e)},t.joinedCache=new Map,(0,r.__decorate)([(0,x.aN)(gd.IFieldcodeWxworkGroupContactCardFeature),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==j.IDynamicLoader&&j.IDynamicLoader)?n:Object)],t.prototype,"loader",void 0),(0,r.__decorate)([(0,Gc.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"componentWillUnmount",null),(0,r.__decorate)([(0,Gc.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"showToolbar",null),(0,r.__decorate)([(0,Gc.nB)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"hasJoin",null),(0,r.__decorate)([(0,Gc.nB)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"handleClick",null),t}(ge.Component),wd=n(47329),Ed=function(e,t,n,r,o){var i,a=null===(i=t.fieldCode.instructions)||void 0===i?void 0:i[0],s=a&&(0,wd.yD)(a,!0);return s?ve().createElement(yd,{key:"field-trigger-".concat(n.uuid),editor:e,layoutBox:n,fieldInfo:t,data:s,overrideStyle:r,bridge:o},al(n)):null},Cd=(oc.zE.WxworkGroupContactCard,sl((function(e,t,n,r){var o=d.CssUtil.computeContainerStyles(n),i=Ed(e,t,n,o,r);return i?{element:i,overrideStyle:o}:null})),n(57861));n(16751);var Td=function(e){var t=e.data,n=e.className,r=e.selected,o=e.onOpen,i=t.iconurl,a=t.name,s=t.position,c=t.gender,l=t.type,u=t.corp_name;return ve().createElement("div",{className:n,style:{width:"".concat($c,"px"),maxWidth:"100%"}},ve().createElement(hd,{active:r,avatar:i,name:a,gender:c,jobTitle:s,type:l,corp_name:u,onOpen:o}))},xd=function(e){var t=e.className,n=e.layoutBox,r=e.children,o=tl({layoutBox:n}).fontSize;return ve().createElement(el,{className:t,fontSize:o,icon:ve().createElement("svg",{viewBox:"0 0 20 21",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ve().createElement("path",{d:"M0 6.5C0 4.3998 0 3.3497 0.408726 2.54754C0.768251 1.84193 1.34193 1.26825 2.04754 0.908726C2.8497 0.5 3.8998 0.5 6 0.5H14C16.1002 0.5 17.1503 0.5 17.9525 0.908726C18.6581 1.26825 19.2317 1.84193 19.5913 2.54754C20 3.3497 20 4.3998 20 6.5V14.5C20 16.6002 20 17.6503 19.5913 18.4525C19.2317 19.1581 18.6581 19.7317 17.9525 20.0913C17.1503 20.5 16.1002 20.5 14 20.5H6C3.8998 20.5 2.8497 20.5 2.04754 20.0913C1.34193 19.7317 0.768251 19.1581 0.408726 18.4525C0 17.6503 0 16.6002 0 14.5V6.5Z",fill:"#4B95F3"}),ve().createElement("path",{d:"M15.5 15.5H4.5C4.36193 15.5 4.25 15.3881 4.25 15.25V15.0312C4.25 14.7665 4.38955 14.5213 4.6172 14.3862L8.4489 12.112C8.92321 11.8304 9.01521 11.1823 8.63797 10.7799C8.10253 10.2088 7.80455 9.45523 7.80455 8.67235V7.69545C7.80455 6.48294 8.78748 5.5 10 5.5C11.2125 5.5 12.1955 6.48294 12.1955 7.69545V8.67235C12.1955 9.45523 11.8975 10.2088 11.362 10.7799C10.9848 11.1823 11.0768 11.8304 11.5511 12.112L15.3828 14.3862C15.6104 14.5213 15.75 14.7665 15.75 15.0312V15.25C15.75 15.3881 15.6381 15.5 15.5 15.5Z",fill:"white"}))},r)},Sd=function(e){function t(t){var n=e.call(this,t)||this;return n.loading=!1,n.loadingTimer=0,n.handleClick=function(){n.props.data.layout===d.FieldDisplayLayoutType.Inline&&n.openDetail(!1)},n.updateSelection=function(e){n.setState({selected:e})},n.state={selected:!1},n.openDetail=n.openDetail.bind(n),n.showToolbar=n.showToolbar.bind(n),n}var n,o;return(0,r.__extends)(t,e),t.prototype.componentWillUnmount=function(){var e;window.clearTimeout(this.loadingTimer),null===(e=this.loader.instance)||void 0===e||e.toggleToolbar({show:!1})},t.prototype.openDetail=function(e){var t,n;return(0,r.__awaiter)(this,void 0,void 0,(function(){var o,i,a,s,c,l,u,d=this;return(0,r.__generator)(this,(function(r){return this.loading||(this.loading=!0,o=this.props,i=o.editor,a=o.data,s=o.layoutBox,null===(t=i.surface)||void 0===t||t.requestBlur(),c=this.cardService.getCardPosition(s),l=c.x,u=c.y,this.loadingTimer&&window.clearTimeout(this.loadingTimer),this.loadingTimer=window.setTimeout((function(){d.loadingTimer=0,d.loading&&(d.loading=!1)}),500),null===(n=this.loader.instance)||void 0===n||n.onOpen(a,e,l,u)),[2]}))}))},t.prototype.showToolbar=function(e){var t;null===(t=this.loader.instance)||void 0===t||t.toggleToolbar(e)},t.prototype.render=function(){var e,t=this.state.selected,n=this.props,r=n.data,o=n.editor,i=n.layoutBox,a=n.fieldInfo,s=n.children,c=r.layout;return e=(void 0===c?d.FieldDisplayLayoutType.Card:c)===d.FieldDisplayLayoutType.Inline?ve().createElement(xd,{layoutBox:i},s):ve().createElement(Td,{data:r,editor:o,layoutBox:i,fieldInfo:a,selected:t,onOpen:this.openDetail},s),ve().createElement(Xc,{data:r,editor:o,layoutBox:i,field:a,onClick:this.handleClick,onShowToolbar:this.showToolbar,onSelect:this.updateSelection},e)},(0,r.__decorate)([(0,x.aN)(Cd.IFieldcodeWxworkMemberContactCardFeature),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==j.IDynamicLoader&&j.IDynamicLoader)?n:Object)],t.prototype,"loader",void 0),(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(o=void 0!==vl&&vl)?o:Object)],t.prototype,"cardService",void 0),(0,r.__decorate)([(0,Gc.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"componentWillUnmount",null),(0,r.__decorate)([(0,Gc.nB)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Boolean]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"openDetail",null),(0,r.__decorate)([(0,Gc.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"showToolbar",null),t}(ge.Component),Id=n(88622),kd=function(e,t,n,r,o){var i,a=null===(i=t.fieldCode.instructions)||void 0===i?void 0:i[0],s=a&&(0,Id.TK)(a,!0);return s?ve().createElement(Sd,{editor:e,layoutBox:n,fieldInfo:t,data:s,overrideStyle:r,bridge:o},al(n)):null},Rd=(oc.zE.WxworkMemberContactCard,sl((function(e,t,n,r,o){var i=cl(o,n),a=kd(e,t,n,i,r);return a?{element:a,overrideStyle:i}:null})),n(10438)),Ad=(0,p.pxToTwips)(62),Od=(0,p.pxToTwips)(446),Ld=(0,p.pxToTwips)(62),Md=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isAutoUpdate=!1,t.isShowDropdowns=!1,t.isShowHover=!1,t}return(0,r.__extends)(t,e),t.prototype.canFocusInField=function(e){return!1},t.prototype.getFieldLayoutType=function(e){var t=(0,Uc.yS)(e);return(null==t?void 0:t.displayLayoutType)===d.FieldDisplayLayoutType.Text?d.FieldDisplayLayoutType.Inline:(null==t?void 0:t.displayLayoutType)||d.FieldDisplayLayoutType.Inline},t.prototype.getFieldHeight=function(e){var t=this.getFieldLayoutType(e),n=e&&(0,Uc.yS)(e);return t===d.FieldDisplayLayoutType.Card?Ad:t===d.FieldDisplayLayoutType.Preview?(null==n?void 0:n.classify)===Rd.FY.AUDIO?Ld:Od:void 0},t.prototype.getPluginContainerFitRule=function(t){return this.getFieldLayoutType(t)===d.FieldDisplayLayoutType.Inline?e.prototype.getPluginContainerFitRule.call(this,t):{fitToParentWidth:!0,fitToParentHeight:!1}},t}(d.FieldCodeProcessor),Nd=n(77504),Dd=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,r.__extends)(t,e),t.prototype.getFieldLayoutType=function(e){var t,n=null===(t=e.instructions)||void 0===t?void 0:t[0];if(n){var r=(0,Vc.bB)(n,!0);if(null==r?void 0:r.layout)return r.layout}return d.FieldDisplayLayoutType.Card},t.prototype.getFieldHeight=function(){return(0,p.pxToTwips)(292)},t.prototype.getFieldWidth=function(){return(0,p.pxToTwips)(252)}}(Nd.A),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,r.__extends)(t,e),t.prototype.parse=function(){return""},t.prototype.getFieldLayoutType=function(e){var t,n=null===(t=e.instructions)||void 0===t?void 0:t[0];if(n){var r=(0,ul.ph)(n,!0);if(null==r?void 0:r.layout)return r.layout}return d.FieldDisplayLayoutType.Card},t.prototype.getFieldHeight=function(t){var n,r,o,i=null!==(r=null===(n=t.instructions)||void 0===n?void 0:n[0])&&void 0!==r?r:"";return e.prototype.getFieldHeight.call(this,t)||(null===(o=(0,ul.ph)(i,!0))||void 0===o?void 0:o.height)||(0,p.pxToTwips)(106)},t.prototype.getFieldWidth=function(){return(0,p.pxToTwips)(422)}}(pl),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,r.__extends)(t,e),t.prototype.parse=function(){return""},t.prototype.getFieldLayoutType=function(e){var t,n=null===(t=e.instructions)||void 0===t?void 0:t[0];if(n){var r=(0,xu.J2)(n,!0);if(null==r?void 0:r.layout)return r.layout}return d.FieldDisplayLayoutType.Card},t.prototype.getFieldHeight=function(t){var n,r,o,i=null!==(r=null===(n=t.instructions)||void 0===n?void 0:n[0])&&void 0!==r?r:"";return e.prototype.getFieldHeight.call(this,t)||(null===(o=(0,xu.J2)(i))||void 0===o?void 0:o.height)||(0,p.pxToTwips)(106)}}(pl),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isAutoUpdate=!1,t.isShowDropdowns=!1,t.isShowHover=!1,t}(0,r.__extends)(t,e),t.prototype.getFieldLayoutType=function(e){var t,n=null===(t=e.instructions)||void 0===t?void 0:t[0];if(n){var r=(0,ju.Bf)(n,!0);if(null==r?void 0:r.layout)return r.layout}return d.FieldDisplayLayoutType.Card}}(pl),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,r.__extends)(t,e),t.prototype.getFieldLayoutType=function(){return d.FieldDisplayLayoutType.Card},t.prototype.getFieldHeight=function(){return(0,p.pxToTwips)(40)},t.prototype.getFieldWidth=function(){return(0,p.pxToTwips)(200)}}(Nd.A),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,r.__extends)(t,e),t.prototype.getFieldLayoutType=function(e){var t,n=null===(t=e.instructions)||void 0===t?void 0:t[0];if(n){var r=(0,wd.yD)(n,!0);if(null==r?void 0:r.layout)return r.layout}return d.FieldDisplayLayoutType.Card},t.prototype.getFieldHeight=function(){return(0,p.pxToTwips)(62)},t.prototype.getFieldWidth=function(){return(0,p.pxToTwips)($c)}}(Nd.A),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,r.__extends)(t,e),t.prototype.getFieldLayoutType=function(e){var t,n=null===(t=e.instructions)||void 0===t?void 0:t[0];if(n){var r=(0,Id.TK)(n,!0);if(null==r?void 0:r.layout)return r.layout}return d.FieldDisplayLayoutType.Card},t.prototype.getFieldHeight=function(){return(0,p.pxToTwips)(62)},t.prototype.getFieldWidth=function(){return(0,p.pxToTwips)($c)}}(Nd.A),n(56757)),Pd={tag:"svg",attrs:{viewBox:"0 0 11 11",width:"1em",height:"1em"},children:[{tag:"g",attrs:{id:"Icon/1-Common/checkmark-11",fill:"none",stroke:"none",fillRule:"evenodd",strokeWidth:1},children:[{tag:"path",attrs:{id:"path备份",fill:"currentColor",d:"M9.46 1.28a.75.75 0 011.24.85l-.06.09-6 7.5a.75.75 0 01-1.04.13l-.08-.07-3-3a.75.75 0 01.98-1.13l.08.07 2.4 2.4 5.48-6.84z"}}]}]},Fd=(0,ge.forwardRef)((function(e,t){return(0,ge.createElement)(Dd.A,Object.assign({},e,{id:"checkmark-11",ref:t,icon:Pd}))}));Fd.displayName="Checkmark11";var Bd=Fd,Ud="tdocs-mention-weixin-component",Hd="tdocs-mention-weixin-component-disable",jd=n(55734),Wd=n(70723),Vd=n(14517),zd=function(e){function t(t){var n=e.call(this,t)||this;return n.isTouching=!1,n.handleFieldClick=function(e){var t,r=n.props,o=r.editor,i=r.layoutBox;if(o.isEditable()&&3!==e.nativeEvent.which){var a=n.props.fieldInfo,s=(null!=a?a:{}).fieldCode;if(s&&a){var l=null===(t=s.instructions)||void 0===t?void 0:t[3],u=(0,c.Yi)().globalPadId;if(!l||l===u){var p=n.fieldService.convertToFieldCodeInfo(a),f=d.FieldCodeManager.getInstance().getFieldProcessorByFieldCodeInfo(p);f&&f.handleFieldClick(p,i)}}}},n.handleTouchEnd=function(e){n.isTouching&&n.handleFieldClick(e)},n.onListTodoUpdate=function(e){var t,r,o,i,a=e.todoItem,s=n.props.layoutBox,c=n.findTaskInfo(s);if(c&&c.taskId===a.id){var l=(null!==(r=null===(t=n.props)||void 0===t?void 0:t.fieldInfo)&&void 0!==r?r:{}).fieldCode,u=null===(o=null==l?void 0:l.instructions)||void 0===o?void 0:o[1],d=u&&(null===(i=a.followList)||void 0===i?void 0:i.get(u));if(d){var p=d.flag===Wd.wL.DONE;p!==n.state.isDone&&n.setState({isDone:p})}}},n.onTouchStart=function(e){e.stopPropagation(),n.isTouching=!0},n.onTouchMove=function(e){e.stopPropagation(),n.isTouching=!1},n.onMouseDown=function(e){p.PlatformUtil.isTencentDocsIPadApp()&&(e.stopPropagation(),e.cancelable&&e.preventDefault())},n.onDoubleClick=function(e){return function(){n.workbenchEventEmitter.emit(jd.yr.UnDoSendNotice,e)}},n.decorateTextWrapper=function(e){return n.props.editor.docEnv.renderType!==d.RenderType.Canvas?n.decorateLiteText(e[0]):n.decorateText(e)},n.decorateText=function(e){return e.map((function(e){if(!e||!n.state.isDone)return e;var t=e.props,r={position:"relative",top:"2px",fontSize:"".concat(t.style.fontSize.replace("pt","")/1.2,"pt"),marginRight:"2px"},o=t.children.substr(1);return ve().cloneElement(e,{},ve().createElement(ve().Fragment,null,ve().createElement(Bd,{style:r}),o))}))},n.decorateLiteText=function(e){return e.map((function(e){if(!e)return e;var t=e.props,r=t.layoutBox.property.fontSize,o=e.props.layoutBox.text;if(!n.state.isDone)return ve().createElement("span",{key:t.layoutBox.uuid,style:{lineHeight:"".concat((0,p.twipsToPt)(r)+1,"pt")}},e);var i=[],a={position:"relative",top:"2px",color:"#175CEB",fontSize:"".concat((0,p.twipsToPt)(r)-1,"pt"),marginRight:"2px"};return e.props.layoutBox.text=o.replace("@",""),i.push(ve().createElement(Bd,{style:a})),i.push(e),ve().createElement("span",{key:o,style:{lineHeight:"".concat((0,p.twipsToPt)(r)+1,"pt")}},i)}))},n.rootRef=ve().createRef(),n.state={showBackground:!1,isAutoUpdate:!1,isDone:!1},n}var n,o;return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this.props.editor;null==e||e.on(Vd.o.ON_UPDATE,this.onListTodoUpdate)},t.prototype.componentWillUnmount=function(){var e=this.props.editor;null==e||e.removeCallBack(Vd.o.ON_UPDATE,this.onListTodoUpdate)},t.prototype.findTaskInfo=function(e){for(var t,n=e;n;){if((0,d.isParagraphBox)(n)||(0,d.isParagraphBoxLite)(n)){var r=(0,d.isParagraphBox)(n)?n.property.taskPr:null===(t=n.property)||void 0===t?void 0:t.taskPr;return r?{taskState:r.taskState,taskId:r.taskId}:null}n=n.parentBox}return null},t.prototype.render=function(){var e,t,n,o=this,i=this.props,a=i.children,s=i.overrideStyle,l=i.fieldInfo,u=(null!=l?l:{}).fieldCode,f="",_=!1;if(u){f=null!==(t=null===(e=u.instructions)||void 0===e?void 0:e[0])&&void 0!==t?t:"";var h=null===(n=u.instructions)||void 0===n?void 0:n[3],m=(0,c.Yi)().globalPadId;h&&h!==m&&(_=!0)}var g=this.decorateTextWrapper(a);return ve().createElement("span",{id:f,style:(0,r.__assign)({cursor:p.PlatformUtil.isWeWork()?"pointer":void 0,background:this.state.showBackground?"#d1e6fc":void 0},d.CssUtil.cssPropsToStyle(s)),onMouseUp:function(e){return o.handleFieldClick(e)},onTouchEnd:function(e){return o.handleTouchEnd(e)},onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,onTouchMove:this.onTouchMove,className:"".concat(_?Hd:Ud),onDoubleClick:this.onDoubleClick(f),ref:this.rootRef},g)},(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==Fe.v&&Fe.v)?n:Object)],t.prototype,"workbenchEventEmitter",void 0),(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(o=void 0!==Bs.D&&Bs.D)?o:Object)],t.prototype,"fieldService",void 0),t}(ge.Component),Gd={"mention-qq-component":"tdocs-mention-qq-component",mentionQqComponent:"tdocs-mention-qq-component","mention-qq-component-disable":"tdocs-mention-qq-component-disable",mentionQqComponentDisable:"tdocs-mention-qq-component-disable"},Yd=n(30322),qd=n(42686),Zd=function(e){function t(t){var n=e.call(this,t)||this;return n.defaultStyle={paddingLeft:5,marginLeft:1,paddingRight:8,marginRight:2},n.handleFieldClick=function(e){var t,r=n.props,o=r.layoutBox,i=r.editor,a=n.props.fieldInfo,s=(null!=a?a:{}).fieldCode;if(s&&a){var l=(0,c.Yi)().globalPadId,u=null===(t=s.instructions)||void 0===t?void 0:t[3];if((!u||u===l)&&i.docEnv.docViewType!==d.DocViewType.RecordPreview){var p=n.fieldService.convertToFieldCodeInfo(a),f=d.FieldCodeManager.getInstance().getFieldProcessorByFieldCodeInfo(p);f&&f.handleFieldClick(p,o,e)}}},n.onTouchStart=function(e){e.stopPropagation()},n.onMouseDown=function(e){p.PlatformUtil.isTencentDocsIPadApp()&&(e.stopPropagation(),e.cancelable&&e.preventDefault())},n.rootRef=ve().createRef(),n.ellipsisFormatter=new Yd.J,n.state={showBackground:!1,isAutoUpdate:!1},n}var n,o;return(0,r.__extends)(t,e),t.prototype.calcMentionMaxWidthInTable=function(e,t){var n=-1,r=this.defaultStyle,o=r.paddingLeft+r.paddingRight+r.marginLeft+r.marginRight;if(e.renderType===d.RenderType.Canvas&&(0,d.isFieldBox)(t)){var i=t.getAncestorOf(d.BoxKind.TableCell);i&&(n=(0,p.twipsToPx)(i.totalWidth)-o)}else e.renderType===d.RenderType.Lite&&(0,d.isFieldBoxLite)(t)&&qd.S.isInLiteTableCell(t)&&(n=qd.S.calcLiteBoxMaxWidth(t,this.defaultStyle));return n},t.prototype.tableOverrideStyle=function(e,t){if(!t||!e)return{};var n=this.defaultStyle.paddingRight,r=this.calcMentionMaxWidthInTable(e,t);return r>0?{maxWidth:r,paddingRight:r<n?r-1:n}:{}},t.prototype.tableOverrideChildrenContent=function(e,t,n){var r;if(!(e&&t&&n&&Array.isArray(t)))return t;var o=null===(r=t.filter((function(e){var t,n;return"string"==typeof(null===(t=null==e?void 0:e.props)||void 0===t?void 0:t.children)&&0===(null===(n=null==e?void 0:e.props)||void 0===n?void 0:n.children.indexOf("@"))}))[0])||void 0===r?void 0:r.props.children;if(!o)return t;var i=this.calcMentionMaxWidthInTable(e,n);return i>0?this.ellipsisFormatter.wrapLine(o,i,1,{classname:Gd["mention-qq-component-font"]},"..."):t},t.prototype.render=function(){var e,t,n,o=this,i=this.props,a=i.children,s=i.overrideStyle,l=i.layoutBox,u=i.editor,p=i.fieldInfo,f=u.docEnv,_="",h=this.tableOverrideStyle(f,l),m=!1,g=(null!=p?p:{}).fieldCode;if(g){_=null!==(t=null===(e=g.instructions)||void 0===e?void 0:e[0])&&void 0!==t?t:"";var v=null===(n=g.instructions)||void 0===n?void 0:n[3],b=(0,c.Yi)().globalPadId;v&&v!==b&&(m=!0)}return ve().createElement("span",{id:_,style:(0,r.__assign)((0,r.__assign)({background:this.state.showBackground?"#d1e6fc":void 0},d.CssUtil.cssPropsToStyle(s)),h),onMouseUp:function(e){return o.handleFieldClick(e)},onTouchEnd:function(e){return o.handleFieldClick(e)},onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,className:"".concat(m?Gd["mention-qq-component-disable"]:Gd["mention-qq-component"]),ref:this.rootRef},this.tableOverrideChildrenContent(f,a,l))},(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==Fe.v&&Fe.v)?n:Object)],t.prototype,"workbenchEventEmitter",void 0),(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(o=void 0!==Bs.D&&Bs.D)?o:Object)],t.prototype,"fieldService",void 0),t}(ge.Component),Jd=function(e,t){return function(n){var o=n.fieldInfo,i=n.ctx,a=n.box,s=n.cssStyle,c=n.editor,l=(0,d.makeFrame)(0,0,a.totalWidth,a.totalHeight);if((0,d.isValidRegion)(l)){var u=(0,Hs.Vo)(i,a),p=a.children.map((function(e){return e.hidden?null:ve().createElement("span",{key:e.uuid,className:"melo-leaf",style:(0,r.__assign)((0,r.__assign)((0,r.__assign)({},null==t?void 0:t(e)),d.CssUtil.cssPropsToStyle(d.CssUtil.computeStyles(e).cssProperties)),{verticalAlign:"baseline"})},(0,d.isTextBox)(e)?e.textString():"")})),f=d.PoolNodeFactory.obtain(d.IComponentView,a.uuid,l,ve().createElement(e,{editor:c,layoutBox:a,fieldInfo:o,renderCanvas:!0,overrideStyle:s},p),u);i.addView(f)}}},Kd={decorator:{decoratorCallback:function(e){return function(t){var n=t.children,r=t.box,o=t.fieldInfo;return{component:ve().createElement(Zd,{editor:e,layoutBox:r,fieldInfo:o},n),overrideStyle:{lineHeight:"20px"}}}}},modelWrapper:function(e){return function(t){var n=6,r=e.docEnv,o=(null==r?void 0:r.uniqueId)||"",i=t.fieldCode;i.instructions[3]&&i.instructions[3]!==o&&(n=2);var a=function(e){var t=e.fieldResultProp,n=new(d.PropertyFactory.getPropertyClass(d.PropertyType.RunProperty));return t&&(n.diff=t.diff),n.color.val=d.Defaults.mentionColor,n}(t);return{metric:{padding:{before:0,start:(0,p.pxToTwips)(4),after:0,end:(0,p.pxToTwips)(n)}},fieldResultProp:a}}},draw:Jd(Zd,(function(e){return{lineHeight:"20px"}}))},Qd={decorator:{decoratorCallback:function(e){return function(t){var n=t.children,r=t.box,o=t.fieldInfo;return{component:ve().createElement(zd,{editor:e,layoutBox:r,fieldInfo:o},n),overrideStyle:{}}}}},modelWrapper:function(e){return function(e){var t=function(e){var t=e.fieldResultProp,n=new(d.PropertyFactory.getPropertyClass(d.PropertyType.RunProperty));return t&&(n.diff=t.diff),n.color.val=d.Defaults.mentionColor,n.sz=t.sz,n}(e);return{metric:{padding:{before:0,start:(0,p.pxToTwips)(2),after:0,end:(0,p.pxToTwips)(2)}},fieldResultProp:t}}},draw:Jd(zd,(function(e){return{paddingBottom:"".concat(Math.round((0,p.twipsToPx)(e.totalHeight)/8),"px")}}))},Xd={draw:function(e){var t,n,o=e.fieldInfo,i=e.ctx,a=e.box,s=e.cssStyle,c=1,l=1,u=d.STNumberFormat.undefined,p=a.getAncestorOf(d.BoxKind.Page);if((0,d.isPageBox)(p)){c=p.pageNumber,l=null!==(n=null===(t=p.parentBox)||void 0===t?void 0:t.children.length)&&void 0!==n?n:1;var f=p.getFirstDescendantOf(d.BoxKind.Section,(function(e){return e.firstVisibleChild}));f&&(u=f.property.pgNumType.fmt)}var _={pageNum:c,pageCount:l,pageNumFormat:u},h=a.subType===d.FieldName.NUM_PAGES?"".concat(l):Dc.Y.parseFieldCodeSwitches(o.fieldCode.switches,_),m=-1,g=a.children.find((function(e,t){return!(e instanceof d.TextFieldCharBox)&&e instanceof d.TextBox&&(m=t,!0)}));if(g instanceof d.TextBox&&m>=0){g.text=h;var v=(0,d.makeFrame)(0,a.ascent,a.totalWidth,a.totalHeight),b=(0,Hs.Vo)(i,a),y=d.CssUtil.computeStyles(g).cssProperties,w={uuid:a.uuid},E=(0,r.__assign)((0,r.__assign)((0,r.__assign)({},s),b),y),C=d.PoolNodeFactory.obtain(d.ITextView,v,g.text,w,E);i.addView(C)}}},$d=n(18037),ep=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isAutoUpdate=!0,t.isShowDropdowns=!1,t.isShowHover=!1,t}(0,r.__extends)(t,e),t.prototype.getFieldLayoutText=function(e,t){var n,r,o=null!==(r=null===(n=e.instructions)||void 0===n?void 0:n[0])&&void 0!==r?r:"",i=(0,$d.kz)(o,!0);return i?(0,$d.hC)(i):"parseDateReminderFailed"}}(d.FieldCodeProcessor),n(61251),n(46016),n(46708),n(17760)),tp=n(24858),np=n(34654),rp=n(14532),op=n.n(rp);function ip(e){var t=op()(+new Date),n=e.timestamp,r=e.notify,o=e.fullDay;return e.repeat===tp.cm.NEVER&&function(e,t){var n=op()(e);return t===tp.Ov.FIVE_MINUTES_BEFORE?n=n.subtract(5,"minute"):t===tp.Ov.FIFTEEN_MINUTES_BEFORE?n=n.subtract(15,"minute"):t===tp.Ov.ONE_HOUR_BEFORE?n=n.subtract(60,"minute"):t===tp.Ov.ONE_DAY_BEFORE||t===tp.EG.ONE_DAY?n=n.subtract(1,"day"):t===tp.EG.TWO_DAYS?n=n.subtract(2,"day"):t===tp.EG.ONE_WEEK&&(n=n.subtract(1,"week")),n}(n,r).isBefore(t,o?"day":"minute")}function ap(e){if(e){if(e.status===tp.QM.Disabled)return"rgba(0,0,0, 0.5)";if(ip(e))return"#F27F4E"}return"#3376D8"}function sp(){return ve().createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.3em",height:"1.3em",viewBox:"0 0 24 24"},ve().createElement("g",{fill:"none",fillRule:"evenodd"},ve().createElement("g",{fill:"currentColor"},ve().createElement("g",null,ve().createElement("path",{d:"M11.5 5c4.143 0 7.5 3.36 7.5 7.5 0 4.14-3.357 7.5-7.5 7.5S4 16.64 4 12.5C4 8.36 7.357 5 11.5 5zm.8 4H11v4h4v-1.3h-2.7V9zm4.699-5L20 7.013 19.001 8 16 4.987 16.999 4zM6 4L7 4.987 3.999 8 3 7.013 6.001 4z",transform:"translate(-88.000000, -439.000000) translate(88.000000, 439.000000)"})))))}function cp(e){var t=function(){var t,n,r,o,i,a,s,c,l,u,f=e.layoutBox;return(0,d.isFieldBox)(f)?{fontSize:(0,p.twipsToPx)((null===(n=null===(t=f.content)||void 0===t?void 0:t.textStyle)||void 0===n?void 0:n.renderFontSize)||0),fontFamily:(null===(o=null===(r=f.content)||void 0===r?void 0:r.textStyle)||void 0===o?void 0:o.fontFamily)||d.Defaults.fontFamily,text:null===(i=f.content)||void 0===i?void 0:i.text}:{fontSize:(0,p.twipsToPx)(null===(s=null===(a=f.content)||void 0===a?void 0:a.property)||void 0===s?void 0:s.renderFontSize),fontFamily:(null===(l=null===(c=f.content)||void 0===c?void 0:c.property)||void 0===l?void 0:l.fontFamily)||d.Defaults.fontFamily,text:null===(u=f.content)||void 0===u?void 0:u.text}}(),n=t.fontSize,o=t.fontFamily,i=t.text,a=e.layoutBox,s=e.dateReminder,c=e.overrideStyle,l=function(e){return e.stopPropagation()},u=(0,r.__read)((0,ge.useState)(void 0),2),f=u[0],_=u[1],h=(0,r.__assign)({padding:"0px ".concat(2,"px"),margin:"0px ".concat(2,"px"),fontSize:"".concat(n,"px"),color:ap(f),fontFamily:o},d.CssUtil.cssPropsToStyle(c)),m=function(t){var n=function(){if(e.bridge){var t=e.bridge,n=t.instance,r=t.bridgeKey;return n.get(r)}}();null==n||n.onTap(s,a.content)};(0,ge.useEffect)((function(){var t=function(){var t;null===(t=e.bridge)||void 0===t||t.instance.sendAction(e.bridge.bridgeKey,{type:np.k.DATA_CALLBACK,data:{dataCallback:function(e){var t=e.getDraftItem(s);t?_(t):setTimeout((function(){e.itemLoader(s,!1,!1).then((function(e){e&&_(e)}))}),500)}}},!0,!0)},n=function(e){e.reminderId===s.id&&t()};return e.editor.on(tp._E,n),t(),function(){e.editor.removeCallBack(tp._E,n)}}),[]);var g=ve().createElement("span",{className:"melo-date-reminder ".concat("pc"),onMouseDown:l,onMouseUp:function(e){3!==e.nativeEvent.which&&m()},onTouchStart:l,onTouchEnd:function(){return m()},style:h},ve().createElement("span",{className:"date-reminder-icon-wrapper"},ve().createElement(sp,null)),ve().createElement("span",{className:"date-reminder-text-wrapper",style:{paddingLeft:"".concat(1.3*n,"px")}},i)),v="";if(f){if(ip(f))v="提醒已过期";else if(f.remindAll||f.reminderUsers&&f.reminderUsers.length>0){var b="";b=f.remindAll?"所有人":"[".concat(f.reminderUsers.map((function(e){return e.name})).slice(0,2).join("、")).concat(f.reminderUsers.length>2?" 等人":"","]"),v="提醒".concat(b),f.repeat!==tp.cm.NEVER&&(v+=", ".concat(tp.lv.get(f.repeat),"重复"))}}else v="尚未设置提醒";return v&&!e.editor.docEnv.isSSR?ve().createElement(jt.Tooltip,{placement:"top",title:v,style:{maxWidth:"100%",overflow:"hidden"}},g):ve().createElement("div",{style:{maxWidth:"100%",overflow:"hidden",display:"flex"}},g)}!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n,o;(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;t.processed||(t.processed=!0,q.qO.getInstance().isEditable?this.loadFeature():this.eventEmitter.listenOnce("$editableChanged",(function(t){t&&e.loadFeature()})))},t.prototype.loadFeature=function(){},t.prototype.render=function(){return ve().createElement(cp,(0,r.__assign)({},this.props))},t.processed=!1,(0,r.__decorate)([(0,x.aN)(ep.IFieldcodeDateHandler),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==j.IDynamicLoader&&j.IDynamicLoader)?n:Object)],t.prototype,"fieldCodeDateLoader",void 0),(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(o=void 0!==Fe.v&&Fe.v)?o:Object)],t.prototype,"eventEmitter",void 0),(0,r.__decorate)([(0,Gc.kR)("fieldCodeDateLoader"),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"loadFeature",null)}(ge.Component);var lp,up,dp=(oc.zE.DateReminder,function(){function e(){}var t,n;return e.prototype.$onEditorOpen=function(e){this.initFirstRenderConfig(),this.editorCloseCallback=this.fieldRenderService.initializeField(e,!0),this.editor=e},e.prototype.initFirstRenderConfig=function(){this.initAttachment(),this.initHyperlinkConfig(),this.initMention(),this.initPageName(),this.initEnterpriseFeature()},e.prototype.initHyperlinkConfig=function(){this.fieldService.addFieldRenderConfig({name:d.FieldName.HYPERLINK,processor:new Nc,render:Ac}),this.fieldService.addFieldRenderConfig({name:d.FieldName.HYPERLINK,subtype:_o.m7.DocLink,processor:new Nc,render:Rc}),this.fieldService.addFieldRenderConfig({name:d.FieldName.HYPERLINK,subtype:_o.m7.NormalLink,processor:new Nc,render:Ac}),this.fieldService.addFieldRenderConfig({name:d.FieldName.HYPERLINK,subtype:_o.m7.AddonLink,processor:new Nc,render:Oc})},e.prototype.initPageName=function(){this.fieldService.addFieldRenderConfig({name:d.FieldName.PAGE,processor:new Dc.Y(this.editor),render:Xd}),this.fieldService.addFieldRenderConfig({name:d.FieldName.NUM_PAGES,processor:new Pc,render:Xd})},e.prototype.initAttachment=function(){this.fieldService.addFieldRenderConfig({name:d.FieldName.ATTACHMENT,processor:new Md,render:Wc})},e.prototype.initEnterpriseFeature=function(){},e.prototype.initMention=function(){this.fieldService.addFieldRenderConfig({name:d.FieldName.MENTION_QQ,render:Kd}),this.fieldService.addFieldRenderConfig({name:d.FieldName.MENTION_WXWORK,render:Qd})},e.prototype.$onEditorClose=function(){var e;null===(e=this.editorCloseCallback)||void 0===e||e.call(this)},(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==Fs.o&&Fs.o)?t:Object)],e.prototype,"fieldRenderService",void 0),(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==Bs.D&&Bs.D)?n:Object)],e.prototype,"fieldService",void 0),e=(0,r.__decorate)([(0,Ls.L)({name:uo.C.FieldRender,adapters:["melo","mobilePagedView"]})],e)}()),pp=n(14364),fp=n(48273);!function(e){e.MARK="mark",e.LIFE_CYCLE="lifeCycle",e.RESOURCE="resource",e.CGI="cgi",e.IMG="img",e.MEASURE="measure"}(lp||(lp={})),function(e){e.LCP="LCP",e.TTI="TTI",e.TTE="TTE",e.HTML="html",e.HTML_TTFB="html-ttfb",e.OPEN_DOC="opendoc",e.PAGE_LOAD_FINISHED="PAGE_LOAD_FINISHED",e.ENTRY_START="entryStart",e.CLICK_START="clickStart",e.NAVIGATION_START="navigationStart",e.CLIENT_SIDE_RENDER_END="clientSideRenderEnd",e.SERVER_SIDE_RENDER_END="serverSideRenderEnd",e.FIRST_REAL_RENDER_END="firstRealRenderEnd",e.DOCUMENT_EDITABLE="documentEditable"}(up||(up={}));var _p,hp={xmlhttprequest:lp.CGI,img:lp.IMG,script:lp.RESOURCE,link:lp.RESOURCE},mp=[window.location.host];!function(e){e[e.low=0]="low",e[e.high=1]="high"}(_p||(_p={}));var gp=[{name:"https://".concat(window.location.host,"/dop-api/opendoc"),alias:"opendoc",weight:_p.high}],vp=function(){function e(e,t,n,r,o){var i,a;this.name=e,this.entryType=t,this.startTime=n,this.duration=r,this.alias=null!==(i=null==o?void 0:o.alias)&&void 0!==i?i:this.autoGenerateAlias(e),this.weight=null!==(a=null==o?void 0:o.weight)&&void 0!==a?a:_p.low,this.decodedBodySize=null==o?void 0:o.decodedBodySize,this.encodedBodySize=null==o?void 0:o.encodedBodySize,this.transferSize=null==o?void 0:o.transferSize}return Object.defineProperty(e.prototype,"endTime",{get:function(){return this.startTime+this.duration},enumerable:!1,configurable:!0}),e.prototype.setEndTime=function(e){this.duration=e-this.startTime},e.prototype.toJSON=function(){var e,t,n,r,o;return{name:null!==(e=this.name)&&void 0!==e?e:this.alias,alias:null!==(t=this.alias)&&void 0!==t?t:this.name,entryType:this.entryType,startTime:this.startTime,endTime:this.startTime+this.duration,duration:this.duration,weight:this.weight,decodedBodySize:null!==(n=this.decodedBodySize)&&void 0!==n?n:0,encodedBodySize:null!==(r=this.encodedBodySize)&&void 0!==r?r:0,transferSize:null!==(o=this.transferSize)&&void 0!==o?o:0}},e.prototype.autoGenerateAlias=function(e){var t=e;switch(this.entryType){case lp.RESOURCE:(n=e.lastIndexOf("/"))>0&&(t=e.substring(n+1)),t=this.generateMaxLengthAlias(t);break;case lp.CGI:case lp.IMG:var n;(n=e.lastIndexOf("?"))>0&&(t=e.substring(0,n))}return t},e.prototype.generateMaxLengthAlias=function(e){var t=e.split("~");if(e.length>50&&t.length>0){for(var n=t[t.length-1],r=t.length-2;r>=0&&!(n.length+t[r].length>50);r--)n="".concat(t[r],"~").concat(n);return n}return e},e}(),bp=function(){function e(){this.customEntries=[],this.performanceTimingKeys=Object.keys(Object.getPrototypeOf(this.getPerformanceTiming())).filter((function(e){return"toJSON"!==e})),this.initPerformanceSettings()}return Object.defineProperty(e.prototype,"timing",{get:function(){var e=this,t=[lp.MARK,lp.LIFE_CYCLE],n=this.getEntries().filter((function(e){return t.includes(e.entryType)})).reduce((function(e,t){var n;return(0,r.__assign)((0,r.__assign)({},e),((n={})[t.name]=t.startTime,n))}),{}),o=this.performanceTimingKeys.reduce((function(t,n){var o,i=e.getPerformanceTiming()[n];return(0,r.__assign)((0,r.__assign)({},t),((o={})[n]=i,o))}),{});return(0,r.__assign)((0,r.__assign)({},o),n)},enumerable:!1,configurable:!0}),e.prototype.getEntries=function(){return this.customEntries.sort((function(e,t){return e.startTime-t.startTime}))},e.prototype.getEntriesByName=function(e,t){return this.getEntries().filter((function(n){return!(n.name!==e&&n.alias!==e||t&&n.entryType!==t)}))},e.prototype.getEntryByName=function(e,t){var n;return null===(n=this.getEntriesByName(e,t))||void 0===n?void 0:n[0]},e.prototype.getEntriesByType=function(e,t){return void 0===t&&(t=_p.low),this.getEntries().filter((function(n){return n.entryType===e&&n.weight>=t}))},e.prototype.getEntryByType=function(e){var t;return null===(t=this.getEntriesByType(e))||void 0===t?void 0:t[0]},e.prototype.mark=function(e,t){var n,r;if(!t||void 0!==t.startTime){var o=new vp(e,null!==(n=null==t?void 0:t.entryType)&&void 0!==n?n:lp.MARK,null!==(r=null==t?void 0:t.startTime)&&void 0!==r?r:this.now(),0);return this.customEntries.push(o),o}},e.prototype.markLifeCycle=function(e,t){var n;return this.mark(e,{startTime:null!==(n=null==t?void 0:t.startTime)&&void 0!==n?n:this.now(),entryType:lp.LIFE_CYCLE})},e.prototype.clearMarks=function(){this.clearEntriesByType(lp.MARK)},e.prototype.measure=function(e,t){if(!t||void 0!==t.startTime||void 0!==t.endTime){var n=this.getPerformanceTiming().navigationStart,o=this.now(),i=null!=t?t:{},a=i.startTime,s=i.endTime,c=i.entryType,l=(0,r.__rest)(i,["startTime","endTime","entryType"]),u=new vp(e,null!=c?c:lp.MEASURE,null!=a?a:n,(null!=s?s:o)-(null!=a?a:n),l);return this.customEntries.push(u),u}},e.prototype.measureStart=function(e,t){var n=new vp(e,lp.MEASURE,t,0);return this.customEntries.push(n),n},e.prototype.measureEnd=function(e,t){var n=this.getEntriesByName(e,lp.MEASURE);if(0===n.length)throw new Error("不存在 name 为".concat(e,"的 entry，请确认是否有先调用 measureStart。"));if(n.length>1)throw new Error("存在多个 name 为".concat(e,"的 entry，请确认是否对同个 name 多次调用 measureStart。"));return n[0].setEndTime(t),n},e.prototype.measureResource=function(e){var t=this;e.forEach((function(e){var n=hp[e.initiatorType];if(n&&!t.filterByWhiteList(e)){var r=t.getPerformanceTiming().navigationStart+e.fetchStart,o=t.getPerformanceTiming().navigationStart+e.responseEnd,i=t.getResourceExternalInfo(e),a=i.alias,s=i.weight,c=e.decodedBodySize,l=e.encodedBodySize,u=e.transferSize;t.measure(e.name,{startTime:r,endTime:o,entryType:n,alias:a,weight:s,decodedBodySize:c,encodedBodySize:l,transferSize:u})}}))},e.prototype.clearMeasures=function(e){this.clearEntriesByType(lp.MEASURE,e)},e.prototype.now=function(){return Date.now()},e.prototype.toJSON=function(){return(0,r.__assign)((0,r.__assign)({},this.timing),{customEntries:this.customEntries})},e.prototype.getBeginTimestamp=function(){var e;return null!==(e=this.timing.clickStart)&&void 0!==e?e:this.timing.navigationStart},e.prototype.getElapsedTimes=function(){var e=this.getBeginTimestamp(),t=this.getEntryStartTimeByName(up.LCP,e),n=this.getEntryStartTimeByName(up.TTI,e),o=this.getEntryStartTimeByName(up.TTE,e),i=(0,r.__read)(this.getEntriesByName(up.HTML),1)[0],a=(0,r.__read)(this.getEntriesByName(up.OPEN_DOC),1)[0],s=this.getEntryStartTimeByName(up.PAGE_LOAD_FINISHED,e),c=this.getEntryStartTimeByName(up.ENTRY_START,e);return{LCP:t-e,TTI:n-e,TTE:o-e,HTML:(null==i?void 0:i.endTime)-(null==i?void 0:i.startTime),OPENDOC:(null==a?void 0:a.endTime)-(null==a?void 0:a.startTime),PAGE_LOAD_FINISHED:s-e,ENTRY_START:c-e}},e.prototype.getAllLogicEntries=function(){var e=this.timing,t=e.entryStart,n=e.PAGE_LOAD_FINISHED;return this.getEntries().filter((function(e){return e.startTime>=t&&e.startTime<=n})).map((function(e){return e.toJSON()}))},e.prototype.getAllLogicEntriesBeforeTTE=function(){var e=this.timing,t=e.entryStart,n=e.TTE;return this.getEntries().filter((function(e){return e.startTime>=t&&e.startTime<=n})).map((function(e){return e.toJSON()}))},e.prototype.getAllLogicEntriesBeforeEditable=function(){var e=this.timing,t=e.entryStart,n=e.SPREAD_SHEET_EDITABLE;return this.getEntries().filter((function(e){return e.startTime>=t&&e.startTime<=n})).map((function(e){return e.toJSON()}))},e.prototype.getAllEntriesByMark=function(e,t){var n,r,o=null!==(n=e&&this.timing[e])&&void 0!==n?n:this.getBeginTimestamp(),i=null!==(r=t&&this.timing[t])&&void 0!==r?r:this.now();return this.getEntries().filter((function(e){return e.startTime>=o&&e.startTime<=i})).map((function(e){return e.toJSON()}))},e.prototype.getAllEntriesBeforeTTE=function(){var e=this.timing.TTE;return this.getEntries().filter((function(t){return t.startTime<=e})).map((function(e){return e.toJSON()}))},e.prototype.getAllEntriesValue=function(){return this.getEntries().map((function(e){return e.toJSON()}))},e.prototype.getAllEntriesWithoutLowWeightResource=function(){var e=this;return this.getEntries().filter((function(t){return!e.isLowWeightResourceEntry(t)})).map((function(e){return e.toJSON()}))},e.prototype.clearEntriesByType=function(e,t){this.customEntries=this.customEntries.filter((function(n){return n.entryType!==e||!(!t||n.name===t)}))},e.prototype.filterByWhiteList=function(e){var t=[lp.CGI,lp.IMG],n=hp[e.initiatorType];if(-1===t.indexOf(n))return!1;var r=new URL(e.name);return-1===mp.indexOf(r.host)},e.prototype.getResourceExternalInfo=function(e){var t,n,o;try{for(var i=(0,r.__values)(gp),a=i.next();!a.done;a=i.next()){var s=a.value;if(0===e.name.indexOf(s.name))return{alias:null!==(o=s.alias)&&void 0!==o?o:s.name,weight:s.weight}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return{weight:_p.low}},e.prototype.isLowWeightResourceEntry=function(e){return e.weight!==_p.low&&e.entryType===lp.RESOURCE},e.prototype.getPerformanceTiming=function(){var e;return(null===(e=window.performance)||void 0===e?void 0:e.timing)?window.performance.timing:{navigationStart:this.now()}},e.prototype.getEntryStartTimeByName=function(e,t){var n,r;return null!==(r=null===(n=this.getEntryByName(e))||void 0===n?void 0:n.startTime)&&void 0!==r?r:t},e.prototype.initPerformanceSettings=function(){var e,t;window.performance&&(null===(t=(e=window.performance).setResourceTimingBufferSize)||void 0===t||t.call(e,2e3),window.performance.onresourcetimingbufferfull=this.onResourceTimingBufferFull.bind(this))},e.prototype.onResourceTimingBufferFull=function(){if(window.performance){var e=window.performance.getEntriesByType("resource");this.measureResource(e)}},e}();function yp(){var e={};try{var t=performance.timing;if(t.loadEventEnd-t.loadEventStart<0)return void setTimeout((function(){yp()}),200);e["重定向时间"]=t.redirectEnd-t.redirectStart,e["DNS解析时间"]=t.domainLookupEnd-t.domainLookupStart,e["TCP完成握手时间"]=t.connectEnd-t.connectStart,e["HTTP请求响应完成时间"]=t.responseEnd-t.requestStart,e["DOM开始加载前所花费时间"]=t.responseEnd-t.navigationStart,e["DOM加载完成时间"]=t.domComplete-t.domLoading,e["DOM结构解析完成时间"]=t.domInteractive-t.domLoading,e["脚本加载时间"]=t.domContentLoadedEventEnd-t.domContentLoadedEventStart,e["onload事件时间"]=t.loadEventEnd-t.loadEventStart,e.domContentLoaded=t.domContentLoadedEventEnd-t.navigationStart,e.load=t.loadEventEnd-t.navigationStart,window.showSnapshotEnd&&(e.snapshotShow=window.showSnapshotEnd-t.navigationStart),e["页面完全加载时间"]=e["重定向时间"]+e["DNS解析时间"]+e["TCP完成握手时间"]+e["HTTP请求响应完成时间"]+e["DOM结构解析完成时间"]+e["DOM加载完成时间"],Object.keys(e).forEach((function(t){console.log("".concat(t,":").concat(e[t],"毫秒(ms)"))})),console.log(t)}catch(e){console.error(e)}}window.tDocsPerformance||(window.tDocsPerformance=new bp);var wp=n(20700),Ep=n(87418),Cp=n(72473),Tp=function(){function e(){}return e.isLargeDoc=function(e){return!!e&&e.dom_num>2e4},e.getDomNums=function(e){if(e&&e.collab_client_vars&&e.collab_client_vars.initialAttributedText){var t=e.collab_client_vars.initialAttributedText.attribs;return t?t.length:0}return 0},e.getOfflinceContainer=function(){var e=Wo.u.getInstance((0,Io.pb)()).containerEnv;return JSON.stringify({container:e,offline_package:window.__isOfflinePkg?1:0})},e.getSnapshotMessage=function(e){var t;switch(e){case Ep.Ag.EDIT:t=(0,ii.$t)("编辑快照");break;case Ep.Ag.SSR:t=(0,ii.$t)("SSR快照");break;case Ep.Ag.CSR:t=(0,ii.$t)("CSR快照");break;case Ep.Ag.CSR_NATIVE:t=(0,ii.$t)("CSR Native快照");break;default:t=(0,ii.$t)("不使用快照")}return t},e}(),xp=(n(147),n(78232)),Sp=n(22494),Ip=function(){function e(e){this.performance=window.performance,this.totalPromises=[],this.isReportedLargeDoc=!1,this.replaceUrlTime=0,this.meloUpCost=0,this.quickLookShowTime=0,this.quickLookType=Ep.Ag.DEFAULT,this.isDestroyed=!1,this.clickToShowCost=0,this.renderFinishTimeStamp=0,this.startedEdit=!1,this.started=!1,this.makeFPSCaculator=function(){var e,t=+new Date,n=0,r=function(){n+=1,e=requestAnimationFrame(r)};return e=requestAnimationFrame(r),function(){cancelAnimationFrame(e);var r=+new Date-t;return Math.round(n/(r/1e3))}},this.editor=e,this.secretId=(0,Io.pb)(),this.init()}var t,n;return e.prototype.init=function(){if(this.performance&&this.performance.timing){this.timing=this.performance.timing,this.reportData=this.createDefaultData();var e=Wo.u.getInstance(this.secretId).replaceUrlTime;this.replaceUrlTime=e,this.registPromises(),this.handleReport(),this.startEditFpsCaculate(),this.startScrollFPSDetector()}this.monitorLongTask()},e.prototype.destroy=function(){this.isDestroyed=!0,this.editor.removeListener(d.RenderNotificationTypes.FIRST_RENDER,this),d.GlobalContext.removeListener(d.FeatureNotificationType.FEATURE_LOADED,this),this.editor.removeListener(d.RenderNotificationTypes.RENDER_FINISH,this),this.editor.removeListener(d.RenderNotificationTypes.RENDER_LAYOUT_CHANGE,this),this.stopObserveLargeDoc(),this.isReportedLargeDoc=!1,this.meloUpCost=0,this.replaceUrlTime=0},e.prototype.splitReportDataForTdw=function(){var e=this,t={},n={};Object.keys(this.reportData).forEach((function(r){r===pp.aI||r===pp.Zp?t[r]=e.reportData[r]:n[r]=e.reportData[r]}));var r=(0,fp.fp)(),o=r.openMode,i=r.preloadWebviewCount;return{ver8:JSON.stringify(n),ver10:JSON.stringify(t),ver11:o,ver12:i}},e.prototype.getMutNum=function(){var e;try{var t=this.editor.state.generateDocumentKeyFrame(),n=(JSON.parse(t)||{}).commands||[],r=n.length&&(null===(e=n[0])||void 0===e?void 0:e.mutations)||[];return Array.isArray(r)&&r.length||0}catch(e){return console.error(e),0}},e.prototype.setMutNums=function(){var e=this.getMutNum();this.editor.state.dataEngine.setMutNum(e),this.statisticInfo&&(this.statisticInfo.mut_num=e)},e.prototype.isRenderTimeError=function(e,t){return e>Math.max(2*t,2e4)||e<=0||0===t},e.prototype.handleReport=function(){var e=this;this.totalPromises.forEach((function(t){t.then((function(t){Object.keys(t).forEach((function(n){var r=t[n],o=(0,pp.WN)(n);e.reportData[n]=r,o&&p.Logger.info("Timing|".concat(o,": ").concat(JSON.stringify(r)))}))}))})),Promise.all(this.totalPromises).then((function(){var t,n;e.setMutNums(),yp(),p.Logger.info("Timing|snapshot:",wp.f.getAllPerformanceCost()),e.markPerformance(),e.updateReportDataTdocs(),p.Logger.info("report data");var r=JSON.stringify(e.reportData);window.loadPerfInfo=r;var o=e.isRenderTimeError(e.reportData[pp.CE],(null===(t=e.statisticInfo)||void 0===t?void 0:t.mut_num)||0);if(!((0,p.getUrlParameter)("prerender")||e.isDestroyed||o||(0,Ho.g6)())){if(d.ReportHelper.monitor007Value(d.MonitorName.DOC_WORD_NUM,(null===(n=e.statisticInfo)||void 0===n?void 0:n.wordNum)||0),d.ReportHelper.monitor007Value(d.MonitorName.FIRST_RENDER_TIME,e.reportData[pp.CE]),d.ReportHelper.monitor007Value(d.MonitorName.FIRST_EDIT_TIME,e.reportData[pp.$i]),d.ReportHelper.monitor007Status(d.MonitorName.FIRST_EDIT_IN_5S,e.reportData[pp.$i]<=5e3?d.Status007.SUCCESS:d.Status007.FAIL),r[pp.CE]<=0||r[pp.$i]<=0){p.Logger.info("PerformanceHandler handleReport NegativeError reportInfo = ".concat(r));var i=r[pp.CE]<=0?"Word_FirstRenderNegativeError":"Word_FirstInteractionNegativeError";e.reportToWeblog(i),d.ReportHelper.captureException(d.MonitorName.PERFORMANCE_REPORT_NEGATIVE_ERROR,{},new Error(i))}e.start<=0?p.Logger.info("PerformanceHandler handleReport start invalid!!!"):(e.reportOpenDocCost(),e.reportLargeDoc(),e.isReportedLargeDoc||e.startObserveLargeDoc(),e.startEditPerfReport(),document.dispatchEvent(new CustomEvent(pp.Xr.AllPerformanceDataReady)))}}))},e.prototype.markPerformance=function(){var e,t,n,r,o=Ss._.getInstance(),i=o.clickStart,a=o.clientSideRenderEnd,s=performance.timing,c=s.navigationStart,l=s.requestStart,u=s.responseStart,f=s.responseEnd,_=window.tDocsPerformance,h=window.cachedPerformanceEntries,m=up.CLICK_START,g=up.NAVIGATION_START,v=up.CLIENT_SIDE_RENDER_END,b=up.HTML_TTFB,y=up.HTML,w=up.SERVER_SIDE_RENDER_END,E=up.FIRST_REAL_RENDER_END,C=up.DOCUMENT_EDITABLE,T=this.reportData,x=T.firstLayoutStart,S=T.firstLayoutCost,I=i?Number(i):void 0;_.mark(m,{startTime:I}),_.mark(g,{startTime:c});var k=a?Number(a):void 0;_.mark(v,{startTime:k}),_.mark(w,{startTime:null===(e=window.meloPerformanceCache)||void 0===e?void 0:e.ssrShowTime});var R=_.getBeginTimestamp()+x+S;_.mark(E,{startTime:R});var A=_.getBeginTimestamp()+this.reportData[pp.xg];_.mark(C,{startTime:A}),_.mark(pp.$G,{startTime:p.PerfUtil.getMark(pp.$G)}),_.mark(pp.Cx,{startTime:p.PerfUtil.getMark(pp.Cx)}),_.mark(pp.kk,{startTime:p.PerfUtil.getMark(pp.kk)}),_.mark(pp.At,{startTime:p.PerfUtil.getMark(pp.At)}),_.mark(pp.Mc,{startTime:p.PerfUtil.getMark(pp.Mc)}),_.measure(pp.fK,this.getMeasureFromPerfUtil(pp.fb,pp.Mi)),_.measure(pp.an,this.getMeasureFromPerfUtil(pp.bv,pp.aT)),_.measure(pp.gv,this.getMeasureFromPerfUtil(pp.DN,pp.bd)),_.measure(pp.JX,this.getMeasureFromPerfUtil(pp.gA,pp.E6)),_.measure(b,{startTime:l,endTime:u}),_.measure(y,{startTime:l,endTime:f});var O=_.timing,L=null!==(n=null!==(t=O.clientSideRenderEnd)&&void 0!==t?t:O.serverSideRenderEnd)&&void 0!==n?n:O.firstRealRenderEnd;_.markLifeCycle(up.LCP,{startTime:L}),_.markLifeCycle(up.TTI,{startTime:O.firstRealRenderEnd}),_.markLifeCycle(up.TTE,{startTime:O.documentEditable});var M=/js\/(.*)/,N=new Set(null===(r=window.immeJs)||void 0===r?void 0:r.map((function(e){var t;return null===(t=M.exec(e))||void 0===t?void 0:t[1]}))),D=0;null==h||h.forEach((function(e){var t,n=e,r=n.name,o=n.entryType,i=n.startTime,a=n.endTime;_.measure(r,{entryType:o,startTime:i,endTime:a});var s=null===(t=M.exec(r))||void 0===t?void 0:t[1];s&&N.has(s)&&(D+=a-i)})),d.ReportHelper.tdwReport({opername:"quality_doc_melo",module:"detail",action:"js_exec_cost",ver8:D}),p.Logger.info("Timing",JSON.stringify(_.getElapsedTimes()))},e.prototype.getMeasureFromPerfUtil=function(e,t){return{startTime:p.PerfUtil.getMark(e),endTime:p.PerfUtil.getMark(t)}},e.prototype.updateReportDataTdocs=function(){if(window.tDocsPerformance&&!this.replaceUrlTime){var e=window.tDocsPerformance.getElapsedTimes(),t=e.LCP,n=e.TTI;this.reportData[pp._x]=Math.round(t),this.reportData[pp.$i]=Math.round(n)}},e.prototype.reportOpenDocCost=function(){var e,t,n,r=this.splitReportDataForTdw(),o=r.ver8,i=r.ver10,a=r.ver11,s=r.ver12;if((0,Ho.g6)())p.Logger.debug("report init_container_time_cost"),d.ReportHelper.tdwReport({opername:"quality_doc_melo",module:"detail",action:"init_container_time_cost",file_type:"1",ver7:JSON.stringify(this.statisticInfo||{}),ver8:o,ver9:this.prepareVer9Data(),ver10:i});else if(this.quickLookType!==Ep.Ag.CSR_NATIVE){p.Logger.debug("report open_time_cost"),d.ReportHelper.tdwReport({opername:"quality_doc_melo",module:"detail",action:"open_time_cost",file_type:"1",ver5:null===(t=(0,c.Yi)().collab_client_vars.dver)||void 0===t?void 0:t.substr(0,3),ver7:JSON.stringify(this.statisticInfo||{}),ver8:o,ver9:this.prepareVer9Data(),ver10:i,ver11:a,ver12:s}),d.ReportHelper.monitor007Value(d.MonitorName.FIRST_RENDER_TIME_3_0,this.reportData[pp.CE]),d.ReportHelper.monitor007Value(d.MonitorName.FIRST_EDIT_TIME_3_0,this.reportData[pp.$i]);var l=((null===(n=this.statisticInfo)||void 0===n?void 0:n.wordNum)||0)>1e4;l&&(d.ReportHelper.monitor007Value(d.MonitorName.FIRST_RENDER_TIME_LARGE_DOC_3_0,this.reportData[pp.CE]),d.ReportHelper.monitor007Value(d.MonitorName.FIRST_EDIT_TIME_LARGE_DOC_3_0,this.reportData[pp.$i])),window.getClientVarsCost&&(d.ReportHelper.monitor007Value(d.MonitorName.OPEN_DOC_COST_3_0,window.getClientVarsCost.getClientVarsCost),l&&d.ReportHelper.monitor007Value(d.MonitorName.OPEN_DOC_COST_LARGE_DOC_3_0,window.getClientVarsCost.getClientVarsCost),d.ReportHelper.monitor007Value(d.MonitorName.OPEN_DOC_RETRY_COUNT,window.getClientVarsCost.getClientVarsOnlineCount)),d.ReportHelper.tdwReport({opername:"quality_doc_melo",module:"detail",action:"open_time_cost_minify",file_type:"1",ver7:JSON.stringify(this.statisticInfo||{}),ver8:JSON.stringify((e={},e[pp.iB]=this.reportData[pp.iB],e[pp.$i]=this.reportData[pp.$i],e[pp.bB]=this.reportData[pp.bB],e[pp.E0]=this.reportData[pp.E0],e)),ver9:this.prepareVer9Data(),ver10:i,ver11:a,ver12:s})}},e.prototype.reportOpenWebEvent=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,t,n,o,i,a,s,c,l,u,d;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:switch(e=Ss._.getInstance(),t=e.createTS,n=e.templateId,o=e.csid,i=Ss._.getInstance().getOpenWebType()){case Ss.w.CREATE_ONLINE_NATIVE:return[3,1];case Ss.w.OPEN_NATIVE:case Ss.w.CREATE_LOCAL_NATIVE:return[3,2]}return[3,5];case 1:return t&&(c=parseInt(t,10),this.reportOpenWebCost(Ss.w.CREATE_ONLINE_NATIVE,c,n)),[3,5];case 2:return o?[4,xp.M.getMetric({csid:o})]:[3,4];case 3:(a=r.sent())?(s=a.data,c=s.doc_item_click_timestamp,l=s.doc_loadurl_timestamp,u=Math.round(l-c),d=Math.round(this.start-l),this.reportOpenWebCost(i,c,void 0,{clickToLoadCost:u,loadToStartCost:d},a.data)):p.Logger.error("getMetric for ".concat(o," failed ").concat(a)),r.label=4;case 4:return[3,5];case 5:return[2]}}))}))},e.prototype.buildAppPerformanceData=function(e){var t=Math.round(this.renderFinishTimeStamp-e),n=t;return this.clickToShowCost?n=this.clickToShowCost:this.quickLookShowTime>e&&(n=Math.round(this.quickLookShowTime-e)),{clickToShowCost:n,clickToEditCost:t}},e.prototype.reportOpenWebCost=function(e,t,n,o,i){var a=this.buildAppPerformanceData(t),s=a.clickToShowCost,c=a.clickToEditCost;if(c<=0||s<=0)return p.Logger.error("clickToEditCost or clickToShowCost is not legal: clickToEditCost:".concat(c,", clickToShowCost:").concat(s)),!1;var l=JSON.stringify((0,r.__assign)({clickToEditCost:c,clickToShowCost:s},o)),u=this.prepareVer9Data(i);return p.Logger.info("report open_web openWebType:".concat(e," clickToEditCost:").concat(c,", clickToShowCost:").concat(s)),d.ReportHelper.tdwReport({opername:"doc_core",module:"open",action:"open_web",file_type:"1",obj3:l,ver5:e,ver6:n,ver7:JSON.stringify(this.statisticInfo||{}),ver9:u,ver10:JSON.stringify({version:this.reportData[pp.Gf]})}),!0},e.prototype.prepareVer9Data=function(e){var t,n,o,i=Wo.u.getInstance((0,Io.pb)()).containerEnv,a=(0,r.__assign)({offline_package:window.__isOfflinePkg?1:0,container:i,replaceCount:Wo.u.replaceCount,usingPreCreate:Ss._.getInstance().createMode,usingPreloadWebview:"preload"===window.openUrlFrom?1:0,usingPreloadDB:Sp.Y.preGetDBDataSuccess&&"database"===window.clientvarsDataFrom?1:0,usingQuickLook:this.quickLookShowTime?1:0,quickLookType:this.quickLookType,isDebugEnv:(0,d.isDebugEnviroment)()?1:0,renderType:this.editor.docEnv.renderType,releaseHash:null!==(o=null===(n=null===(t=null===window||void 0===window?void 0:window.App)||void 0===t?void 0:t.GlobalConfig)||void 0===n?void 0:n.hash)&&void 0!==o?o:""},e);return window.immeJsSize&&(a.immeJsSize=window.immeJsSize),(0,fp.Z$)("".concat(window.__globalReleaseVersion,"\n").concat([a.offline_package?"离线":"非离线",a.usingQuickLook?"秒看":"非秒看",a.usingPreloadDB?"预DB":"非预DB",a.usingPreloadWebview?"预热":a.container===Wo.K.iframe?"容器":"非容器",a.usingPreCreate].filter(Boolean).join("+"),"\n").concat(this.reportData[pp.$i],"ms")),JSON.stringify(a)},e.prototype.reportToWeblog=function(e,t){void 0===t&&(t=18e4);var n=Date.now(),r=n-t;window.log&&window.log.report(e,{query:{startTs:r,endTs:n}})},e.prototype.getQuickLookInfo=function(){var e;if(null===(e=window.meloPerformanceCache)||void 0===e?void 0:e.ssrShowTime)return{quickLookShowTime:window.meloPerformanceCache.ssrShowTime,quickLookType:Ep.Ag.SSR};var t=Wo.u.getInstance(this.secretId).quickLookShowTime;return t?{quickLookShowTime:t,quickLookType:Wo.u.getInstance(this.secretId).quickLookType}:void 0},e.prototype.showSnapshotResult=function(e){var t=Tp.getSnapshotMessage(e);Ga.default.show({message:(0,ii.$t)("快照类型为{{snapshotMessage}}",{snapshotMessage:t}),type:"info",duration:1e3})},e.prototype.registPromises=function(){var e=this,t=new Promise((function(t){var n,r=e.timing;if(r){var o=r.responseEnd-r.requestStart,i=r.responseStart-r.requestStart;return t(((n={})[pp.gK]=i,n[pp.Jy]=o,n))}return t({})})),n=new Promise((function(t){var n,r=e.timing;if(r){var o=r.responseEnd-e.start,i=e.firstPaint||o,a=e.firstContentPaint||o;e.replaceUrlTime>0&&(i=0,a=0),t(((n={})[pp.iB]=Math.round(i),n[pp._x]=Math.round(a),n))}return t({})})),o=new Promise((function(t){e.editor.once(d.RenderNotificationTypes.FIRST_RENDER,(function(){return(0,r.__awaiter)(e,void 0,void 0,(function(){var e,n,o,i,a,s,c,l,u,d;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return e=this.start,n=p.PerfUtil.now(),this.renderFinishTimeStamp=n,o={},(i=p.PerfUtil.getMark("firstLayoutStart"))&&(o[pp.gA]=Math.round(i-e),o[pp.vB]=Math.round(n-i)),s=a=n-e,(c=this.getQuickLookInfo())&&(this.quickLookShowTime=c.quickLookShowTime,this.quickLookType=c.quickLookType,a=this.quickLookShowTime-this.start),[3,2];case 1:(l=r.sent())>0&&(this.quickLookType=Ep.Ag.CSR_NATIVE,this.clickToShowCost=l),r.label=2;case 2:return(a<=0||s<=0)&&p.Logger.info("PerformanceHandler firstRenderPromise","start:".concat(e," curTime:").concat(n," quickLookShowTime:").concat(this.quickLookShowTime," replaceUrlTime:").concat(this.replaceUrlTime," navigationStart:").concat(this.timing.navigationStart," meloUpCost:").concat(this.meloUpCost)),(u=wp.f.getStepCostFromStart(Ep.Fu.SnapshotShowEnd))&&(o[Ep.Fu.SnapshotShowEnd]=u),(d=wp.f.getStepCostFromStart(Ep.Fu.SnapshotShowRenderEnd))&&(o[Ep.Fu.SnapshotShowRenderEnd]=d),window.timeFirstShown=a,window.timeFirstInteraction=s,o[pp.CE]=Math.round(a),p.Logger.info("Timing|".concat((0,pp.WN)("FirstRender"),":").concat(o[pp.CE])),o[pp.$i]=Math.round(s),t(o),[2]}}))}))}),e,{priority:p.NotificationPriority.high})})),i=new Promise((function(t){e.editor.docEnv.preview&&t({});var n=function(){return(0,r.__awaiter)(e,void 0,void 0,(function(){var e,o;return(0,r.__generator)(this,(function(r){return document.removeEventListener("first_render_hided_quick_look",n),e={},o=p.PerfUtil.now()-this.start,e[pp.$i]=Math.round(o),p.Logger.info("Timing|".concat((0,pp.WN)("FirstInteraction"),":").concat(e[pp.$i])),t(e),[2]}))}))};document.addEventListener("first_render_hided_quick_look",n)})),a=new Promise((function(t){e.editor.docEnv.preview&&t({});var n=function(){return(0,r.__awaiter)(e,void 0,void 0,(function(){var e,o,i=this;return(0,r.__generator)(this,(function(r){return document.removeEventListener("performance_edit_hidden_input_inited",n),e={},o=p.PerfUtil.now()-this.start,e[pp.oj]=Math.round(o),p.Logger.info("Timing|".concat((0,pp.WN)("HiddenInputInited"),":").concat(e[pp.oj])),this.editor.isEditable()||!this.contextService.context.permission.canEdit?(e[pp.xg]=e[pp.oj],p.Logger.info("Timing|".concat((0,pp.WN)("FirstEdit"),":").concat(e[pp.xg])),t(e)):this.contextService.context.permission.canEdit&&this.eventEmitter.listenOnce("$editableChanged",(function(){var n=p.PerfUtil.now()-i.start;e[pp.xg]=Math.round(n),p.Logger.info("Timing|".concat((0,pp.WN)("FirstEdit"),":").concat(e[pp.xg])),t(e)})),[2]}))}))};document.addEventListener("performance_edit_hidden_input_inited",n)})),s=o.then((function(){return new Promise((function(t){d.GlobalContext.once(d.FeatureNotificationType.FEATURE_LOADED,(function(){var n;t(((n={})[pp.fb]=Math.round(p.PerfUtil.getMark("workbenchInitBegin")-e.start),n[pp.bv]=Math.round(p.PerfUtil.getMark("padEditorInitBegin")-e.start),n[pp.DN]=Math.round(p.PerfUtil.getMark("featuresInitBegin")-e.start),n[pp.fK]=Math.round(p.PerfUtil.measure("workbenchInitBegin","workbenchInitEnd")),n[pp.an]=Math.round(p.PerfUtil.measure("padEditorInitBegin","padEditorInitEnd")),n[pp.gv]=Math.round(p.PerfUtil.measure("featuresInitBegin","featuresInitEnd")),n[pp.bd]=Math.round(p.PerfUtil.getMark("featuresInitEnd")-e.start),n[pp.$G]=Math.round(p.PerfUtil.getMark("featuresRenderInitEnd")-e.start),n[pp.Cx]=Math.round(p.PerfUtil.getMark("featuresPublishInitEnd")-e.start),n[pp.kk]=Math.round(p.PerfUtil.getMark("featuresReadonlyInitEnd")-e.start),n[pp.At]=Math.round(p.PerfUtil.getMark("featuresEditInitEnd")-e.start),n[pp.Mc]=Math.round(p.PerfUtil.getMark("hideFirstScreen")-e.start),n))}),e,{priority:p.NotificationPriority.high})}))})),c=o.then((function(){return new Promise((function(t){e.editor.once(d.LayoutNotification.LayoutFinished,(function(){var n=p.PerfUtil.now()-e.start,r={};r[pp.E6]=p.PerfUtil.getMark(pp.E6),r[pp.JX]=Math.round(p.PerfUtil.measure(pp.gA,pp.E6)),window.timeTotalRendered=n,r[pp.bB]=Math.round(n),window.visibilitychangeStrForReport&&(r[pp.EE]=window.visibilitychangeStrForReport);var o=e.editor.perfManager.getPerfInfo();r[pp.z9]=o.layout,e.statisticInfo=e.editor.statisticInfo,t(r)}),e,{priority:p.NotificationPriority.high})}))})),l=s.then((function(){return e.createPrepareScriptLoadDataPromise()})),u=new Promise((function(t){e.reportData[pp.E0]=Math.round(p.PerfUtil.now()-e.start),window.addEventListener("load",t)}));this.totalPromises=(0,r.__spreadArray)((0,r.__spreadArray)([t,n,o,s,c,l,i],(0,r.__read)([]),!1),(0,r.__read)(this.replaceUrlTime?[]:[u,a]),!1)},e.prototype.createPrepareScriptLoadDataPromise=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e=this;return(0,r.__generator)(this,(function(t){return[2,new Promise((function(t){var n,o={},i=e.performance&&e.performance.getEntriesByType&&e.performance.getEntriesByType("resource"),a=window.immeJs||[];if(window.tDocsPerformance.measureResource(i),i){var s=i.filter((function(e){if("resource"===e.entryType&&"script"===e.initiatorType){var t=e.name;return a.reduce((function(e,n){return e||t.indexOf(n)>=0}),!1)}return!1})),c=Math.max.apply(Math,(0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(s.map((function(e){return e.startTime+e.duration}))),!1),[0],!1))-Math.min.apply(Math,(0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(s.map((function(e){return e.startTime}))),!1),[0],!1));o[pp.xS]=Math.round(c),o[pp.aI]=s.map((function(e){var t=e.name.split("/");return{name:t[t.length-1],duration:Math.round(e.duration)}}))}null===(n=window.cachedPerformanceEntries)||void 0===n||n.forEach((function(e){var t=e,n=t.name,r=t.startTime,o=t.endTime;window.tDocsPerformance.measure(n,{startTime:r,endTime:o})})),t(o)}))]}))}))},e.prototype.createDefaultBaseData=function(){return(0,r.__assign)({TimeToFirstByte:0,TimeToLasterByte:0,FirstPaint:0,FirstContentPaint:0,workbenchInitBegin:0,workbenchInit:0,padEditorInitBegin:0,padEditorInit:0,featuresInitBegin:0,featuresInit:0,featuresInitEnd:0,featuresRenderInitEnd:0,featuresReadonlyInitEnd:0,featuresPublishInitEnd:0,featuresEditInitEnd:0,hideFirstScreen:0,firstLayoutStart:0,firstLayoutCost:0,lastLayoutFinish:0,totalLayoutCost:0,FIRST_RENDER:0,FIRST_EDIT:0,FIRST_INTERACTION:0,totalRender:0,totalRenderTable:0,loadComplete:0,scriptLoading:0,layoutCost:0,hiddenInputInited:0},{})},e.prototype.createDefaultData=function(){return(0,r.__assign)((0,r.__assign)({},this.createDefaultBaseData()),{scriptEntries:"",visibility:document.visibilityState,USERAGENT:navigator.userAgent,version:window.__globalReleaseVersion||"",isOfflinePkg:window.__isOfflinePkg||!1})},e.prototype.getPerformancePaintTiming=function(e){var t=this.performance&&this.performance.getEntriesByName&&this.performance.getEntriesByName(e);if(t&&t.length>0){var n=(0,r.__read)(t,1)[0];return n.startTime+n.duration}},Object.defineProperty(e.prototype,"firstPaint",{get:function(){return this.getPerformancePaintTiming("first-paint")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstContentPaint",{get:function(){return this.getPerformancePaintTiming("first-contentful-paint")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"start",{get:function(){var e=this.timing?this.timing.navigationStart:0;return 1===(0,c.Yi)().collab_client_vars.isMeloUp&&"number"==typeof(0,c.Yi)().collab_client_vars.meloUpCost&&(this.meloUpCost=(0,c.Yi)().collab_client_vars.meloUpCost||0,e+=(0,c.Yi)().collab_client_vars.meloUpCost||0),this.replaceUrlTime>0&&(e=this.replaceUrlTime),0===e&&(e=window.htmlLoadStart),e},enumerable:!1,configurable:!0}),e.prototype.reportLargeDoc=function(){var e;if(!this.isReportedLargeDoc&&Tp.isLargeDoc(this.statisticInfo)){var t=localStorage&&localStorage.getItem("tdsourcetag");d.ReportHelper.tdwReport({opername:"doc_core",module:"visit",action:"detail_page_large",source3:t||"",obj3:p.PlatformUtil.getBrowser(),ver5:1===(0,c.Yi)().collab_client_vars.dirty?"limited":"normal",ver7:null===(e=(0,c.Yi)().collab_client_vars.dver)||void 0===e?void 0:e.substr(0,3)},{immediate:!0}),this.isReportedLargeDoc=!0}},e.prototype.startObserveLargeDoc=function(){var e=this;this.largeDocObserver=new MutationObserver((0,p.throttle)((function(){e.statisticInfo=e.editor.statisticInfo,e.reportLargeDoc(),e.isReportedLargeDoc&&e.stopObserveLargeDoc()}),5e3));var t=this.editor.getRoot(),n=t&&t.querySelector(".".concat(d.renderStyles.meloDocView));n&&this.largeDocObserver.observe(n,{childList:!0,subtree:!0})},e.prototype.stopObserveLargeDoc=function(){this.largeDocObserver&&this.largeDocObserver.disconnect()},e.prototype.onEditChange=function(e){var t=this;return this.editor.on(d.StateNotification.ModelChange,(function(t){t.fullReflow||e()})),function(){t.editor.removeCallBack(d.StateNotification.ModelChange,e)}},e.prototype.startEditPerfReport=function(){var e=this;this.onEditChange((function(){e.editor.once(d.RenderNotificationTypes.RENDER_LAYOUT_CHANGE,(function(){var t,n=e.editor.perfManager,r=p.PerfUtil.now();if(!(n.editTimes>10)){n.lastTime=r;var i=JSON.stringify(e.statisticInfo||{}),a=n.getPerfInfo(),s=JSON.stringify(a);d.ReportHelper.tdwReport({opername:"quality_doc_melo",module:"detail",action:"edit_time_cost",file_type:"1",ver5:null===(t=(0,c.Yi)().collab_client_vars.dver)||void 0===t?void 0:t.substr(0,3),ver7:i,ver8:s,ver9:e.editor.docEnv.renderType}),o.M.isDevEvn()&&p.Logger.info("Timing|".concat(s))}}),e)}))},e.prototype.monitorLongTask=function(){var e=this;if(o.M.isDevEvn()&&p.PlatformUtil.isChrome())try{new PerformanceObserver((function(t){t.getEntries().forEach((function(t){if(t.duration>=500){var n=e.editor.perfManager.getPerfInfo();p.Logger.warn("longTask|duration:".concat(t.duration,",perf:").concat(JSON.stringify(n)))}}))})).observe({entryTypes:["longtask"]})}catch(e){}},e.prototype.setDomNums=function(){this.statisticInfo&&(this.statisticInfo.dom_num=Tp.getDomNums((0,c.Yi)()))},e.prototype.startEditFpsCaculate=function(){var e=this;if(!this.startedEdit){var t;this.startedEdit=!0;var n,r=!1,o=0,i=void 0;i=this.onEditChange((function(){o>10?null==i||i():(!1===r&&(n=e.makeFPSCaculator(),r=!0),clearTimeout(t),t=setTimeout((function(){var t,i;r=!1;var a=n();a&&(console.log("编辑的平均帧率: ".concat(a,"pfs")),o+=1,d.ReportHelper.tdwReport({opername:"quality_doc_melo",module:"detail",action:"edit_fps",file_type:"1",source3:navigator.userAgent,ver5:null===(t=(0,c.Yi)().collab_client_vars.dver)||void 0===t?void 0:t.substr(0,3),ver7:JSON.stringify(e.statisticInfo||{}),ver8:Math.min(a,60),ver10:null===(i=(0,c.Yi)().collab_client_vars.dver)||void 0===i?void 0:i.substr(0,3)}))}),1e3))}))}},e.prototype.startScrollFPSDetector=function(){var e=this;if(!this.started){var t;this.started=!0;var n,r=!1,o=0,i=!1,a=0,s=this.editor.scrollHandler.getClientHeight(),l=function(){if(o>10)e.editor.scrollHandler.removeScrollListener(l);else{!1===r&&(n=e.makeFPSCaculator(),r=!0);var u=e.editor.scrollHandler.getScrollTop();a&&u&&Math.abs(a-u)>s&&(i=!0),a=u,clearTimeout(t),t=setTimeout((function(){var t,s,l=n();l&&(r=!1,console.log("滚动的平均帧率: ".concat(l,"pfs")),i&&console.log("触发快速滚动，平均帧率: ".concat(l,"pfs")),o+=1,d.ReportHelper.tdwReport({opername:"quality_doc_melo",module:"detail",action:i?"fast_scroll_fps":"scroll_fps",source3:navigator.userAgent,file_type:"1",ver5:null===(t=(0,c.Yi)().collab_client_vars.dver)||void 0===t?void 0:t.substr(0,3),ver7:JSON.stringify(e.statisticInfo||{}),ver8:Math.min(l,60),ver10:null===(s=(0,c.Yi)().collab_client_vars.dver)||void 0===s?void 0:s.substr(0,3)})),i=!1,a=0}),1e3)}};this.editor.scrollHandler.addScrollListener(l)}},(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==S.O&&S.O)?t:Object)],e.prototype,"contextService",void 0),(0,r.__decorate)([(0,x.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==Fe.v&&Fe.v)?n:Object)],e.prototype,"eventEmitter",void 0),e}(),kp=function(){function e(e){this.multiEditorService=e}var t;return e.prototype.$onEditorOpen=function(e){this.multiEditorService.isFirstScreenEditor(e)&&(this.performanceManager=new Ip(e),d.GlobalContext.on(Vr.f8.BEFORE_REPLACE_URL,(function(){p.PerfUtil.clearMarks(),Cp.t.clearMarks()}),this))},e.prototype.$onEditorClose=function(){this.performanceManager&&(this.performanceManager.destroy(),this.performanceManager=void 0),d.GlobalContext.removeListener(Vr.f8.BEFORE_REPLACE_URL,this)},e=(0,r.__decorate)([(0,Ls.L)({name:uo.C.PerformanceReport,adapters:["melo","mobilePagedView"]}),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==ls&&ls)?t:Object])],e)}(),Rp=n(55996),Ap=n(55142),Op=n(69690),Lp=n(11935),Mp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.initContainerRender=function(t){e.prototype.initContainerRender.call(this,t)},t.prototype.initDecoratorRender=function(t){e.prototype.initDecoratorRender.call(this,t)},t.prototype.initExtendRenderer=function(t){e.prototype.initExtendRenderer.call(this,t),this.paragraphQuoteRenderer=new Lp.W(t),this.paragraphQuoteRenderer&&t.addExtendRenderer(d.ExtendRendererTypes.OverlayParagraph,this.paragraphQuoteRenderer)},t=(0,r.__decorate)([(0,Ls.L)({name:uo.C.TdocsTdocsRender,adapters:["melo","mobilePagedView"]})],t)}(Op.J),Np=n(31501),Dp=n(42656),Pp=n(31905),Fp=function(){function e(){}return e.load=function(e){e.mount((0,r.__spreadArray)([Ps.TemplateRecommendationHandler,dp,kp,Rp.CoreEditHandler,Gr.ZoomBaseHandler,Ap.TitlebarHandler,Mp,Np.ZoomPcHandler,Dp.SnippetHandler,Pp.TitleHandler],(0,r.__read)([]),!1))},e}(),Bp=(n(95367),(0,jr.gz)()===Wr.SA.DOUBLE?mo:ho),Up=(0,jr.gz)()===Wr.SA.DOUBLE?"left":"center",Hp=function(e){function t(t,n,r,i,s,c,f,m,g){var v=e.call(this)||this;return v.toolbarService=t,v.startupService=n,v.contextService=r,v.configLoader=i,v.featureService=s,v.store=c,v.workbench=f,v.configService=m,v.middlewareService=g,p.PerfUtil.mark("workbenchInitBegin"),function(){var e=new H;if(e.initSentryErrorReport(),d.ReportHelper.errorHandler=e,!o.M.isDevEvn()||(0,p.getUrlParameter)("force_prod_env")){var t=new D;t.initMonitorErrorReport(),d.ReportHelper.monitorHandler=t;var n=new a;d.ReportHelper.tdwHandler=n;var r=new l;d.ReportHelper.zzsHandler=r}d.ReportHelper.idkeyHandler=new u,d.ReportHelper.KVRHandler=new _,d.ReportHelper.aegisHandler=new h}(),i.initConfig(),v.store.register("rootEditor",""),d.GlobalContext.on(Vr.f8.ON_DATA_READY,(function(){v.onDataReady()})),window.workbench=v,v}var i,s,f,m,g,v,b,y,w,E;return(0,r.__extends)(t,e),t.prototype.getHandler=function(e){return x.Am.get(Symbol.for("feature:".concat(e)))},t.prototype.onDataReady=function(){x.Am.emit("$onReset"),this.id&&this.workbench.close(this.id),this.configLoader.syncConfig(),this.init()},t.prototype.init=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,t,o,i=this;return(0,r.__generator)(this,(function(a){switch(a.label){case 0:return Fp.load(this.featureService),this.startupService.isLevel1Loaded=!0,p.Logger.info("leve1加载完成：".concat(p.PerfUtil.now()-performance.timing.navigationStart)),p.PerfUtil.mark("featuresRenderInitEnd"),[4,this.workbench.open(Os,{content:""})];case 1:return e=a.sent(),t=e.editor,o=e.id,this.settings.namespace=(0,c.Yi)().userId,this.settings.set("namespace",(0,c.Yi)().userId),this.id=o,this.store.update("rootEditor",o),p.PerfUtil.mark("padEditorInitEnd"),this.startupService.init(Cs.Ev.Pc,t,{beforeInit:function(){zr.p.setupToolbarStyle()},initClientDataCallback:function(){return(0,r.__awaiter)(i,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Promise.all([n.e(33),n.e(9714),n.e(4333),n.e(8376)]).then(n.bind(n,44499))];case 1:return e=t.sent().CONTROLLERS_PC,this.settings.addMountSettings({controllers:e}),[2]}}))}))},level2LoadedCallback:function(){i.store.update(fe.R.ToolbarSchemaAnimation,!0),i.hidePreloadHeaderDelay(),i.subscribeToolbarModeChange()}}),[2]}}))}))},t.prototype.subscribeToolbarModeChange=function(){var e=this;this.store.get(Wr.pR).pipe((0,Bn.x)()).subscribe((function(t){var n,o=null!==(n=e.store.getValue(Wr.qy))&&void 0!==n?n:{};t===Wr.SA.SINGLE?e.toolbarService.setSchema((0,r.__assign)((0,r.__assign)((0,r.__assign)({},ho),o),{"toolbar-normal":ho["toolbar-normal"],"toolbar-pinned":ho["toolbar-pinned"]}),"center"):t===Wr.SA.DOUBLE&&e.toolbarService.setSchema((0,r.__assign)((0,r.__assign)((0,r.__assign)({},mo),o),{"toolbar-normal":mo["toolbar-normal"],"toolbar-pinned":mo["toolbar-pinned"]}),"left"),e.toolbarService.update()}))},t.prototype.hidePreloadHeaderDelay=function(){zr.p.hide(zr.j.ALL),zr.p.hideStatusbar()},t.prototype.$onReady=function(){p.PerfUtil.mark("workbenchInitEnd"),this.contextService.inject("clientVars",(function(){return(0,c.Yi)()})),this.contextService.inject("appid",""),this.configService.get("common.titlebar"),this.middlewareService.use(Z,{on:Sr.O,callbackNames:["shouldDisabled"]}),this.middlewareService.use(Q,{on:Sr.O,callbackNames:["onClick"]}),this.middlewareService.use(Q,{on:"menu",callbackNames:["onClick"]}),this.init(),this.configLoader.syncConfig(),this.setSchema()},t.prototype.$onWorkbenchInitError=function(e){console.error(e)},t.prototype.setSchema=function(){var e=this.configService.get("common.menu"),t=this.configService.get("common.toolbar");e&&this.configLoader.serviceSetSchema(e,"menuService"),t&&this.configLoader.serviceSetSchema(t,"toolbarService")},t=(0,r.__decorate)([(E={platform:"pc",menu:{schema:oo},toolbar:{schema:Bp,alignment:Up,schemaAnimation:!1},statusbar:{schema:co},contextMenu:{schema:Xr},titlebar:{schema:[],height:56,hoverable:!0},mount:{controllers:[],features:[Gr.ZoomBaseHandler,Yr.IEditFollowFeature],services:[qr.J,Zr.$],overrides:[Jr.ax]}},function(e){X.SF.set(ee.C,E,e),x.Am.set(e)}),(0,r.__metadata)("design:paramtypes",["function"==typeof(i=void 0!==Sr.O&&Sr.O)?i:Object,"function"==typeof(s=void 0!==ks&&ks)?s:Object,"function"==typeof(f=void 0!==S.O&&S.O)?f:Object,"function"==typeof(m=void 0!==So&&So)?m:Object,"function"==typeof(g=void 0!==ce.U&&ce.U)?g:Object,"function"==typeof(v=void 0!==de.O&&de.O)?v:Object,"function"==typeof(b=void 0!==se.M&&se.M)?b:Object,"function"==typeof(y=void 0!==Jr.ax&&Jr.ax)?y:Object,"function"==typeof(w=void 0!==ne.K&&ne.K)?w:Object])],t)}(me);Hr.load(Hp,document.getElementById("workbench"))},95721:function(e,t,n){n.r(t),n.d(t,{ClientResourceLock:function(){return d},LockMode:function(){return m},LockStrategy:function(){return h},WebResourceLock:function(){return v}});var r=n(90304),o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},o(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var a=function(){return a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)};function s(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function c(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var l=function(e,t){void 0!==e&&(this.error=e),void 0!==t&&(this.data=t)},u=function(){function e(e,t){void 0===t&&(t="exclusive"),this.id=this.getId();var n=a(a({},this.getDefaultConfig()),e);this.mode=t,this.strategy=n.strategy,this.period=n.period,this.autoRenewal=n.autoRenewal}return e.prototype.getId=function(){var e=new Date,t="".concat(e.toLocaleDateString(),"-").concat(e.getHours(),":").concat(e.getMinutes(),":").concat(e.getSeconds(),":").concat(e.getMilliseconds());return"".concat(t,"-").concat(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER))},e}(),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.lock=function(e,t){return s(this,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return"exclusive"!==this.mode?[3,2]:[4,this.lockExclusive(e,t)];case 1:case 3:return[2,n.sent()];case 2:return[4,this.lockShared(e,t)]}}))}))},t.prototype.detectKey=function(e){return s(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return"exclusive"!==this.mode?[3,2]:[4,this.detectExclusiveKey(e)];case 1:case 3:return[2,t.sent()];case 2:return[4,this.detectSharedKey(e)]}}))}))},t.prototype.release=function(e){return s(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return"exclusive"!==this.mode?[3,2]:[4,this.releaseExclusiveKey(e)];case 1:case 3:return[2,t.sent()];case 2:return[4,this.releaseSharedKey(e)]}}))}))},t.prototype.getDefaultConfig=function(){return{strategy:0,period:-1,autoRenewal:!0}},t.prototype.lockExclusive=function(e,t){return s(this,void 0,void 0,(function(){var n,r,o,i=this;return c(this,(function(a){switch(a.label){case 0:return n={tabId:this.id,expire:-1===this.period?-1:Date.now()+this.period,optional:t},r={command:"lock",key:e,item:n},[4,new Promise((function(e){i.invokeNative(r,e)}))];case 1:return(o=a.sent()).error?[2,{isSuccess:!1,data:o.data}]:o.data.id===this.id?[2,{isSuccess:!0,data:o.data}]:[2,{isSuccess:!1,data:o.data}]}}))}))},t.prototype.lockShared=function(e,t){return s(this,void 0,void 0,(function(){return c(this,(function(n){throw new Error("method not implemented with ".concat(e," ").concat(t))}))}))},t.prototype.detectExclusiveKey=function(e){return s(this,void 0,void 0,(function(){var t,n,r,o=this;return c(this,(function(i){switch(i.label){case 0:return t={command:"detectKey",key:e},[4,new Promise((function(e){o.invokeNative(t,e)}))];case 1:return n=i.sent(),r=new l(void 0,n.result),n.err_code?(r.error=new Error("".concat(n.err_code)),[2,r]):[2,r]}}))}))},t.prototype.detectSharedKey=function(e){return s(this,void 0,void 0,(function(){return c(this,(function(t){throw new Error("method not implemented with ".concat(e))}))}))},t.prototype.releaseExclusiveKey=function(e){return s(this,void 0,void 0,(function(){var t,n=this;return c(this,(function(r){switch(r.label){case 0:return t={command:"release",key:e},[4,new Promise((function(e){n.invokeNative(t,e)}))];case 1:return r.sent().error?[2,!1]:[2,!0]}}))}))},t.prototype.releaseSharedKey=function(e){return s(this,void 0,void 0,(function(){return c(this,(function(t){throw new Error("method not implemented with ".concat(e))}))}))},t.prototype.wrapResult=function(e){var t;if((null===(t=e.result)||void 0===t?void 0:t.tabId)&&(e.result.id=e.result.tabId,delete e.result.tabId),e.err_msg||e.err_code){var n=new Error(e.err_msg||e.err_code);return new l(n,e.result)}return new l(void 0,e.result||{})},t.prototype.invokeNative=function(e,t){var n,o=this;(null===(n=null===window||void 0===window?void 0:window.tdocs)||void 0===n?void 0:n.getClientMutexLock)?window.tdocs.getClientMutexLock(e).then((function(e){var n=e;e.result||(n={result:e}),t(o.wrapResult(n))})):r.nativeRequest.invoke({schema:"jsapi",namespace:"docx",method:"clientMutexLock",params:e,callback:function(e){t(o.wrapResult(e))}})},t}(u),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renewalHandler=new Map,t}return i(t,e),t.prototype.getDefaultConfig=function(){return{strategy:0,period:3e5,autoRenewal:!0}},t.prototype.lock=function(e,t){return s(this,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return"exclusive"!==this.mode?[3,2]:[4,this.lockExclusive(e,t)];case 1:case 3:return[2,n.sent()];case 2:return[4,this.lockShared(e,t)]}}))}))},t.prototype.detectKey=function(e){return s(this,void 0,void 0,(function(){var t,n,r,o;return c(this,(function(i){return t=this.getYKey(e),n=new l(void 0,void 0),(r=localStorage.getItem(t))&&(o=JSON.parse(r)).expire>Date.now()&&(n.data=o),[2,n]}))}))},t.prototype.release=function(e){return s(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return"exclusive"!==this.mode?[3,2]:[4,this.releaseExclusiveLock(e)];case 1:case 3:return[2,t.sent()];case 2:return[4,this.releaseSharedLock(e)]}}))}))},t.prototype.lockExclusive=function(e,t){return s(this,void 0,void 0,(function(){var n=this;return c(this,(function(r){switch(r.label){case 0:return[4,new Promise((function(r,o){n.tryToLockKey(e,t,r,o)})).then((function(t){return n.autoRenewal&&n.renewal(e,n.period),{isSuccess:!0,data:t}}),(function(t){var r=n.getXKey(e);return localStorage.getItem(r)===n.id&&localStorage.removeItem(r),{isSuccess:!1,data:t}}))];case 1:return[2,r.sent()]}}))}))},t.prototype.lockShared=function(e,t){return s(this,void 0,void 0,(function(){return c(this,(function(n){throw new Error("method not implemented with ".concat(e," ").concat(t," "))}))}))},t.prototype.releaseExclusiveLock=function(e){return s(this,void 0,void 0,(function(){var t,n,r,o;return c(this,(function(i){return t=this.getXKey(e),n=this.getYKey(e),(r=localStorage.getItem(n))&&JSON.parse(r).id===this.id?(localStorage.removeItem(n),localStorage.getItem(t)===this.id&&localStorage.removeItem(t),(o=this.renewalHandler.get(e))&&(clearTimeout(o),this.renewalHandler.delete(e)),[2,!0]):[2,!1]}))}))},t.prototype.releaseSharedLock=function(e){return s(this,void 0,void 0,(function(){return c(this,(function(t){throw new Error("method not implemented with ".concat(e))}))}))},t.prototype.renewal=function(e,t){var n=this,r=this.renewalHandler.get(e);r&&clearTimeout(r);var o=setTimeout((function(){var r=n.getYKey(e),o=localStorage.getItem(r);if(o){var i=JSON.parse(o);if(i.id===n.id){var s=a(a({},i),{expire:Date.now()+n.period});localStorage.setItem(n.getYKey(e),JSON.stringify(s)),n.renewal(e,t)}}}),.85*t);return this.renewalHandler.set(e,o),o},t.prototype.getXKey=function(e){return"".concat(t.PREFIX_LOCK_X,"_").concat(e)},t.prototype.getYKey=function(e){return"".concat(t.PREFIX_LOCK_Y,"_").concat(e)},t.prototype.tryToLockKey=function(e,t,n,r){var o=this.getXKey(e),i=this.getYKey(e);localStorage.setItem(o,this.id);var a=localStorage.getItem(i);if(a&&JSON.parse(a).expire>Date.now())this.handleDetectLockFail(e,t,n,r);else{var s={id:this.id,expire:Date.now()+this.period,optional:t};localStorage.setItem(i,JSON.stringify(s)),localStorage.getItem(o)===this.id?n(s):this.delayDetect(e,t,n,r)}},t.prototype.delayDetect=function(e,t,n,r){var o=this,i=this.getYKey(e),a=localStorage.getItem(i),s=JSON.parse(a||"{}");setTimeout((function(){a&&s.id===o.id&&s.expire>Date.now()?n(s):o.handleDetectLockFail(e,t,n,r)}))},t.prototype.handleDetectLockFail=function(e,t,n,r){var o=this,i=this.getYKey(e),a=localStorage.getItem(i),s=JSON.parse(a||"{}");0!==this.strategy?setTimeout((function(){return o.tryToLockKey(e,t,n,r)}),200):r(s)},t.PREFIX_LOCK_X="prefix_lock_x",t.PREFIX_LOCK_Y="prefix_lock_y",t}(u);function f(){return!!window.localStorage}function _(){return!!navigator.locks}var h,m,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.releaseLockHandlerMap=new Map,t.lockManager=navigator.locks,t}return i(t,e),t.prototype.lock=function(e,t){var n=this;return new Promise((function(r){var o={isSuccess:!1,data:{id:n.id,expire:-1,optional:t}};n.lockManager.request(e,{ifAvailable:!0,mode:n.mode},(function(t){if(!t)return r(o),Promise.resolve();if(f())try{localStorage.setItem(e,JSON.stringify(o))}catch(e){}return o.isSuccess=!0,r(o),n.keepLock(e)}))}))},t.prototype.release=function(e){if(!this.releaseLockHandlerMap.has(e))return Promise.resolve(!1);this.releaseLockHandlerMap.get(e)(),this.releaseLockHandlerMap.delete(e);try{localStorage.removeItem(e)}catch(e){}return Promise.resolve(!0)},t.prototype.detectKey=function(e){return s(this,void 0,void 0,(function(){var t,n,r,o,i,a;return c(this,(function(s){switch(s.label){case 0:return[4,this.lockManager.query()];case 1:if(t=s.sent(),n=t.held.some((function(t){return t.name===e})),r=!!this.releaseLockHandlerMap.has(e),o=new l(void 0,void 0),!n||r)return[2,o];if(i={id:"",expire:-1,optional:{}},f())try{a=localStorage.getItem(e),i=JSON.parse(a)}catch(e){}return o.data=i,[2,o]}}))}))},t.prototype.getDefaultConfig=function(){return{strategy:0,period:-1,autoRenewal:!1}},t.prototype.keepLock=function(e){var t=this;return new Promise((function(n){var r;null===(r=t.releaseLockHandlerMap.get(e))||void 0===r||r(),t.releaseLockHandlerMap.set(e,n)}))},t}(u),v=function(){function e(e,t){if(void 0===t&&(t="exclusive"),!f()&&!_())throw new Error("当前环境不支持使用锁机制");this.resourceLock=_()?new g(e,t):new p(e,t)}return e.prototype.lock=function(e,t){return s(this,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return[4,this.resourceLock.lock(e,t)];case 1:return[2,n.sent()]}}))}))},e.prototype.release=function(e){return s(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return[4,this.resourceLock.release(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.detectKey=function(e){return s(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return[4,this.resourceLock.detectKey(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.getDefaultConfig=function(){return this.resourceLock.getDefaultConfig()},e}();!function(e){e[e.ONCE=0]="ONCE",e[e.RETRY=1]="RETRY"}(h||(h={})),function(e){e.EXCLUSIVE="exclusive",e.SHARED="shared"}(m||(m={}))},59475:function(e,t,n){n.r(t),n.d(t,{Result:function(){return r}});var r=function(e,t){void 0!==e&&(this.error=e),void 0!==t&&(this.data=t)}},44773:function(e,t,n){n.d(t,{$:function(){return l}});var r=n(85556),o=n(37769),i=n(76450),a=n(6097),s=n(2002),c=n(75611),l=function(e){function t(){var t=e.call(this)||this;t.instanceMap=new Map;var n=new i.Vj;return t.instanceMap.set("default",n),t}return(0,r.__extends)(t,e),t.prototype.$forceUpdate=function(){},t.prototype.onUpdate=function(){var e=this;this.configs.getAllKeys().forEach((function(t){e.syncToKeybindingService(t)}))},t.prototype.syncToKeybindingService=function(e){var t=this.getMergedConfig(e),n=this.instanceMap.get("default");if((null==t?void 0:t.node)&&(this.instanceMap.get(t.node)?n=this.instanceMap.get(t.node):(n=new i.Vj(t.node),this.instanceMap.set(t.node,n))),t){var r=Object.assign(Object.assign({},t),{weight:t.priority,when:function(){return!(0,c.k)(t.shouldDisabled,!1)},handler:function(){t.onPress()}}),o=n.get(t.keyBindings).find((function(e){return e.name===t.name}));o?Object.assign(o,r):n.register(r)}},t}(a.V);l=(0,r.__decorate)([(0,o.t)({overridable:!0,scope:"ui:service",name:s.v.KEYMAP}),(0,r.__metadata)("design:paramtypes",[])],l)},94258:function(e,t,n){var r,o,i=((r=n(5593))&&r.__esModule?r:{default:r}).default.getInstance().getConfig('npm["@tencent/docs-design-resources"]');t.Z=(o=(null==i?void 0:i.CDN_ORIGIN)||"https://docs.gtimg.com/docs-design-resources",{"Direct purchase_tag@2x":(o+="/mobile/png@2x/")+"Direct purchase_tag@2x-8bd341f5db.png","Logo__36@2x":o+"Logo__36@2x-eec1bc539e.png","Openpage_text@2x":o+"Openpage_text@2x-f612cc11f8.png","Qpan_appicon@2x":o+"Qpan_appicon@2x-2a423b8d08.png","Qpan_chatbackup@2x":o+"Qpan_chatbackup@2x-3c3297cc20.png","Qpan_chatbackup_bg@2x":o+"Qpan_chatbackup_bg@2x-f0ea42588e.png","Qpan_freeusers@2x":o+"Qpan_freeusers@2x-caf389d78c.png","Qpan_loadingscreen@2x":o+"Qpan_loadingscreen@2x-1d8d564061.png","Qpan_loadingscreen_tengxunyun@2x":o+"Qpan_loadingscreen_tengxunyun@2x-3ddf645c2f.png","Qpan_logo@2x":o+"Qpan_logo@2x-4288752645.png","Qpan_logo_about@2x":o+"Qpan_logo_about@2x-944ca771c5.png","Qpan_logo_crosswise@2x":o+"Qpan_logo_crosswise@2x-d85b88a51f.png","Qpan_nochatbackup@2x":o+"Qpan_nochatbackup@2x-de2119bd09.png","Qpan_nochatbackup_bg@2x":o+"Qpan_nochatbackup_bg@2x-21818bb0da.png","Qpan_payingusers@2x":o+"Qpan_payingusers@2x-473f77dddc.png","Qpan_storage@2x":o+"Qpan_storage@2x-53490237cc.png","Qpan_tabbar_me_nor@2x":o+"Qpan_tabbar_me_nor@2x-fa6f9f98e8.png","Qpan_tabbar_me_sel@2x":o+"Qpan_tabbar_me_sel@2x-f31491b2f6.png","SOS@2x":o+"SOS@2x-54f4fb1e88.png","TencentDoc_Open_bg@2x":o+"TencentDoc_Open_bg@2x-76a59841dd.png","account_list_outside_new@2x":o+"account_list_outside_new@2x-c88fd31d51.png","account_list_outside_new_en@2x":o+"account_list_outside_new_en@2x-278f5496be.png","account_list_outside_new_tc@2x":o+"account_list_outside_new_tc@2x-a124654553.png","account_list_qiyewechat_new@2x":o+"account_list_qiyewechat_new@2x-6b48bf1513.png","account_list_qiyewechat_new_en@2x":o+"account_list_qiyewechat_new_en@2x-e3ad4bc93e.png","account_list_qiyewechat_new_tc@2x":o+"account_list_qiyewechat_new_tc@2x-29d4cf3262.png","account_list_vip@2x":o+"account_list_vip@2x-115af8e6c0.png","account_outside@2x":o+"account_outside@2x-eb85cabb68.png","account_qiyewechat@2x":o+"account_qiyewechat@2x-603b6a7943.png","ad_btn_skip@2x":o+"ad_btn_skip@2x-42cb1fcc33.png","ad_logo@2x":o+"ad_logo@2x-ab3df314ed.png","ad_text@2x":o+"ad_text@2x-1e1aaae81f.png","add_36@2x":o+"add_36@2x-d5512b9190.png","add_options@2x":o+"add_options@2x-f0ccf59b7a.png","add_question_blue@2x":o+"add_question_blue@2x-f7a0b822f8.png","add_question_btn@2x":o+"add_question_btn@2x-ee96e4b8b5.png","add_question_btn_disable@2x":o+"add_question_btn_disable@2x-3c8fa0fa57.png","album_32@2x":o+"album_32@2x-de6e017d6f.png","android_b:u@2x":o+"android_b:u@2x-68509064bb.png",app_1024:o+"app_1024-7a37b6e3d1.png",app_120:o+"app_120-92cedb34ba.png","app_144@2x":o+"app_144@2x-232060b139.png",app_180:o+"app_180-8283a96ebc.png",app_29:o+"app_29-9cd141a1d2.png",app_40:o+"app_40-e34092e083.png",app_512:o+"app_512-64cb0db67c.png",app_58:o+"app_58-b3127a2d12.png",app_60:o+"app_60-c467a3c00d.png",app_80:o+"app_80-f1b3efc4f8.png",app_87:o+"app_87-f1b3efc4f8.png",app_96:o+"app_96-ed5d6b5c8f.png","app_loading_logo_static@2x":o+"app_loading_logo_static@2x-e8b121d22c.png","app_loading_logo_static_B@2x":o+"app_loading_logo_static_B@2x-c387f996cb.png","app_loading_logo_static_en@2x":o+"app_loading_logo_static_en@2x-cfa665f504.png","app_loading_logo_static_tc@2x":o+"app_loading_logo_static_tc@2x-168391705a.png","app_official_account@2x":o+"app_official_account@2x-a8752c65c9.png","appeal@2x":o+"appeal@2x-ed189b0c53.png","appentry_OCR@2x":o+"appentry_OCR@2x-2758cb015a.png","appentry_import@2x":o+"appentry_import@2x-a7046781ef.png","appentry_qq@2x":o+"appentry_qq@2x-7b2c9cd91a.png","appentry_transform@2x":o+"appentry_transform@2x-c73afde5c4.png","appentry_voicenotes@2x":o+"appentry_voicenotes@2x-617ceb4d26.png","appentry_wechat@2x":o+"appentry_wechat@2x-0b7a4794b9.png","attachment_music@2x":o+"attachment_music@2x-afdce052dd.png","authority_appoint@2x":o+"authority_appoint@2x-6d1e6fc97e.png","authority_appoint_48@2x":o+"authority_appoint_48@2x-3235444787.png","authority_edit@2x":o+"authority_edit@2x-7cd2ccc012.png","authority_inside@2x":o+"authority_inside@2x-efe817eb79.png","authority_outside@2x":o+"authority_outside@2x-3f3cdf89b8.png","authority_private_48@2x":o+"authority_private_48@2x-7479b0d8a8.png","authority_private_72@2x":o+"authority_private_72@2x-d98384b2ff.png","authority_visible@2x":o+"authority_visible@2x-f2d19dfd79.png","avatar_default_80@2x":o+"avatar_default_80@2x-2a69dd1dda.png","avatar_tencentdocslogo@2x":o+"avatar_tencentdocslogo@2x-97e2f83ffd.png","avatar_wechatwork@2x":o+"avatar_wechatwork@2x-fa3ee910cd.png","avatar_wechatwork_file@2x":o+"avatar_wechatwork_file@2x-adcd8bf63b.png","bg_account_wechatwork@2x":o+"bg_account_wechatwork@2x-c8afb30869.jpg","bg_me@2x":o+"bg_me@2x-e427439f75.png","btn_add_graybackground@2x":o+"btn_add_graybackground@2x-fc741481be.png","buy_tag@2x":o+"buy_tag@2x-3ba330ee4f.png","card_littletime@2x":o+"card_littletime@2x-16231bb52b.png","cell_sendmessege@2x":o+"cell_sendmessege@2x-fc08d2c723.png","checkbox-selected@2x":o+"checkbox-selected@2x-87c2eeebc1.png","checkbox-unselected@2x":o+"checkbox-unselected@2x-7c7e67a5ac.png","classlist_outline_regular_24@2x":o+"classlist_outline_regular_24@2x-7dcc66d747.png","cloud@2x":o+"cloud@2x-fa45e5d694.png","commonlist_outline_regular_24@2x":o+"commonlist_outline_regular_24@2x-6323dd57f7.png","cube&logo618-2@2x":o+"cube&logo618-2@2x-6ad26a082b.png","cube&logo618@2x":o+"cube&logo618@2x-66190a3dc9.png","cube&logo@2x":o+"cube&logo@2x-1a9a2f5af4.png","cube&logo_en@2x":o+"cube&logo_en@2x-0cdbf972eb.png","cube&logo_tc":o+"cube&logo_tc-b8b1e51ce9.png","cube&logo_tc@2x":o+"cube&logo_tc@2x-7a4e606faa.png","cube&logowithwording-2@2x":o+"cube&logowithwording-2@2x-5dd33e55b6.png","cube&logowithwording@2x":o+"cube&logowithwording@2x-61a93e4871.png","data_date31_dark@2x":o+"data_date31_dark@2x-a0fa4a1df6.png","delete_options@2x":o+"delete_options@2x-2aa01b968e.png","dialog_bind@2x":o+"dialog_bind@2x-bee404b87a.png","download_ arrow@2x":o+"download_ arrow@2x-bf95732bbd.png","fast_add@2x":o+"fast_add@2x-8053d8d112.png","file_aio_150@2x":o+"file_aio_150@2x-126f4cfa43.png","file_aio_32@2x":o+"file_aio_32@2x-91728c80db.png","file_aio_36@2x":o+"file_aio_36@2x-2b8dd6ba12.png","file_aio_40@2x":o+"file_aio_40@2x-044720ec38.png","file_aio_500@2x":o+"file_aio_500@2x-92a6a2c8cc.png","file_aio_500@3x":o+"file_aio_500@3x-44f04b133e.png","file_aio_64@2x":o+"file_aio_64@2x-f4fea7d35a.png","file_aio_64_white@2x":o+"file_aio_64_white@2x-5952adf838.png","file_aio_924@2x":o+"file_aio_924@2x-892bd23ffb.png","file_aio_96@2x":o+"file_aio_96@2x-b56d73913f.png","file_aio_quick_36@2x":o+"file_aio_quick_36@2x-7ce090ccfe.png","file_aio_quick_64@2x":o+"file_aio_quick_64@2x-9afb436646.png","file_aio_transparent_150@2x":o+"file_aio_transparent_150@2x-f480bd91a9.png","file_change_excel@2x":o+"file_change_excel@2x-ebadff4a07.png","file_change_pdf@2x":o+"file_change_pdf@2x-682fc4576d.png","file_change_pdf_@2x":o+"file_change_pdf_@2x-45e697b461.png","file_change_ppt@2x":o+"file_change_ppt@2x-146ae9e138.png","file_change_word@2x":o+"file_change_word@2x-5bde6b65c9.png","file_changelist_excel@2x":o+"file_changelist_excel@2x-2448834bfc.png","file_changelist_ppt@2x":o+"file_changelist_ppt@2x-c14ea9a934.png","file_changelist_word@2x":o+"file_changelist_word@2x-eff27ae6cc.png","file_doc_150@2x":o+"file_doc_150@2x-4071023e84.png","file_doc_32@2x":o+"file_doc_32@2x-55082cad58.png","file_doc_40@2x":o+"file_doc_40@2x-70b04bffbe.png","file_doc_500@2x":o+"file_doc_500@2x-23c68b245d.png","file_doc_500@3x":o+"file_doc_500@3x-df09a73ae5.png","file_doc_64@2x":o+"file_doc_64@2x-e4ab449c8e.png",file_doc_64_white:o+"file_doc_64_white-68cf78ce1a.png","file_doc_64_white@2x":o+"file_doc_64_white@2x-9cd26ab805.png","file_doc_924@2x":o+"file_doc_924@2x-9da6265f04.png","file_doc_96@2x":o+"file_doc_96@2x-f2fead3825.png","file_doc_quick_64@2x":o+"file_doc_quick_64@2x-ca8b956b82.png","file_doc_transparent_150@2x":o+"file_doc_transparent_150@2x-4ca08078e1.png","file_drive_pdf_64@2x":o+"file_drive_pdf_64@2x-9e027094f7.png","file_drive_ppt_150@2x":o+"file_drive_ppt_150@2x-4cfcea6a15.png","file_drive_ppt_500@2x":o+"file_drive_ppt_500@2x-be7967ef15.png","file_drive_ppt_924@2x":o+"file_drive_ppt_924@2x-5f77a18867.png","file_drive_txt@2x":o+"file_drive_txt@2x-a07d28fbe4.png","file_drive_txt_150@2x":o+"file_drive_txt_150@2x-192a34d2de.png","file_drive_txt_500@2x":o+"file_drive_txt_500@2x-3f21a4dd42.png","file_drive_txt_924@2x":o+"file_drive_txt_924@2x-85e6ecf425.png","file_drive_unknown_150@2x":o+"file_drive_unknown_150@2x-1884c90460.png","file_drive_unknown_36@2x":o+"file_drive_unknown_36@2x-551d0a4441.png","file_drive_unknown_56@2x":o+"file_drive_unknown_56@2x-0ee7684b05.png","file_drive_unknown_64_white@2x":o+"file_drive_unknown_64_white@2x-9e15def12c.png","file_drive_visio_64@2x":o+"file_drive_visio_64@2x-5a48338466.png","file_drive_word_150@2x":o+"file_drive_word_150@2x-396f181b2c.png","file_drive_word_500@2x":o+"file_drive_word_500@2x-94d786665f.png","file_drive_word_924@2x":o+"file_drive_word_924@2x-7d65d24b2c.png","file_drive_xls_150@2x":o+"file_drive_xls_150@2x-e2eed434ed.png","file_drive_xls_500@2x":o+"file_drive_xls_500@2x-82bde767f2.png","file_drive_xls_924@2x":o+"file_drive_xls_924@2x-433707e0e3.png","file_drive_xmind_64@2x":o+"file_drive_xmind_64@2x-5b9d461e11.png","file_education_96@2x":o+"file_education_96@2x-7fb4d6b469.png","file_empty_924@2x":o+"file_empty_924@2x-ecbed4950f.png",file_excel_64_white:o+"file_excel_64_white-751d4962dd.png","file_floder_64@2x":o+"file_floder_64@2x-f8665782dd.png","file_floder_64_white@2x":o+"file_floder_64_white@2x-4a6974ad47.png","file_floder_96@2x":o+"file_floder_96@2x-a795920a1b.png","file_flowdiagram_150@2x":o+"file_flowdiagram_150@2x-b6fab7eb5b.png","file_flowdiagram_32@2x":o+"file_flowdiagram_32@2x-855562daef.png","file_flowdiagram_36@2x":o+"file_flowdiagram_36@2x-55526d13a6.png","file_flowdiagram_40@2x":o+"file_flowdiagram_40@2x-98198cbee5.png","file_flowdiagram_500@2x":o+"file_flowdiagram_500@2x-422cb37cc4.png","file_flowdiagram_500@3x":o+"file_flowdiagram_500@3x-65d6607b29.png","file_flowdiagram_64@2x":o+"file_flowdiagram_64@2x-39d1451bc7.png",file_flowdiagram_64_white:o+"file_flowdiagram_64_white-84a9bde7ee.png","file_flowdiagram_64_white@2x":o+"file_flowdiagram_64_white@2x-5dc4f37d0f.png","file_flowdiagram_924@2x":o+"file_flowdiagram_924@2x-f96053db48.png","file_flowdiagram_96@2x":o+"file_flowdiagram_96@2x-90ed6fd865.png","file_flowdiagram_quick_64@2x":o+"file_flowdiagram_quick_64@2x-598975ac4c.png","file_flowdiagram_transparent_150@2x":o+"file_flowdiagram_transparent_150@2x-5a376eaac6.png","file_folder_150@2x":o+"file_folder_150@2x-4e82ff84f3.png","file_folder_32@2x":o+"file_folder_32@2x-05172f1c9d.png","file_folder_40@2x":o+"file_folder_40@2x-6fb48d4e95.png","file_folder_420@2x":o+"file_folder_420@2x-69b296ff18.png","file_folder_500@2x":o+"file_folder_500@2x-c4fecdc584.png","file_folder_500@3x":o+"file_folder_500@3x-4b95880c3e.png","file_folder_64@2x":o+"file_folder_64@2x-8277ab31a4.png","file_folder_96@2x":o+"file_folder_96@2x-b4ef35fcc1.png","file_folder_quick_64@2x":o+"file_folder_quick_64@2x-17554e5066.png","file_folder_transparent_150@2x":o+"file_folder_transparent_150@2x-37e173fed6.png","file_form_150@2x":o+"file_form_150@2x-a2d395a8be.png","file_form_32@2x":o+"file_form_32@2x-9c18e0b0ab.png","file_form_40@2x":o+"file_form_40@2x-12aeedfa3d.png","file_form_500@2x":o+"file_form_500@2x-3f948a4a06.png","file_form_500@3x":o+"file_form_500@3x-e43fc350b1.png","file_form_64@2x":o+"file_form_64@2x-bbb262f6e7.png",file_form_64_white:o+"file_form_64_white-bea7c0f38e.png","file_form_64_white@2x":o+"file_form_64_white@2x-d814d6fa04.png","file_form_924@2x":o+"file_form_924@2x-2879ad5584.png","file_form_96@2x":o+"file_form_96@2x-34ecbfed07.png","file_form_quick_64@2x":o+"file_form_quick_64@2x-7bc7ea754e.png","file_form_transparent_150@2x":o+"file_form_transparent_150@2x-140167cfcf.png","file_import_96@2x":o+"file_import_96@2x-5c08a89ce3.png","file_import_new_96@2x":o+"file_import_new_96@2x-5c08a89ce3.png","file_infocollect_96@2x":o+"file_infocollect_96@2x-ab385586b0.png","file_mindmap_150@2x":o+"file_mindmap_150@2x-015f9b673e.png","file_mindmap_32@2x":o+"file_mindmap_32@2x-f1872edb04.png","file_mindmap_40@2x":o+"file_mindmap_40@2x-f94683c895.png","file_mindmap_500@2x":o+"file_mindmap_500@2x-2482206366.png","file_mindmap_500@3x":o+"file_mindmap_500@3x-e76f34a3e7.png","file_mindmap_64@2x":o+"file_mindmap_64@2x-5cd1a78527.png",file_mindmap_64_white:o+"file_mindmap_64_white-9b6505aa0f.png","file_mindmap_64_white@2x":o+"file_mindmap_64_white@2x-6d37d18032.png","file_mindmap_924@2x":o+"file_mindmap_924@2x-fe93967ba6.png","file_mindmap_96@2x":o+"file_mindmap_96@2x-4be61cc9fd.png","file_mindmap_quick_64@2x":o+"file_mindmap_quick_64@2x-141e0f9120.png","file_mindmap_transparent_150@2x":o+"file_mindmap_transparent_150@2x-9b7a25c1ad.png","file_ocr_96@2x":o+"file_ocr_96@2x-d24b7f7446.png","file_pdf_150@2x":o+"file_pdf_150@2x-ff0f446e61.png","file_pdf_32@2x":o+"file_pdf_32@2x-3612984ed6.png","file_pdf_36@2x":o+"file_pdf_36@2x-f9791f7a6c.png","file_pdf_40@2x":o+"file_pdf_40@2x-af66369935.png","file_pdf_432@2x":o+"file_pdf_432@2x-ae700fd2c4.png","file_pdf_500@2x":o+"file_pdf_500@2x-6bccb72f22.png","file_pdf_500@3x":o+"file_pdf_500@3x-dfe1ea6840.png","file_pdf_56@2x":o+"file_pdf_56@2x-c8a8e44cb0.png","file_pdf_64@2x":o+"file_pdf_64@2x-5788417a4c.png",file_pdf_64_white:o+"file_pdf_64_white-cef8614773.png","file_pdf_64_white@2x":o+"file_pdf_64_white@2x-8942f60b89.png","file_pdf_924@2x":o+"file_pdf_924@2x-5278115bdc.png","file_pdf_96@2x":o+"file_pdf_96@2x-2da5bdee7a.png","file_pdf_quick_64@2x":o+"file_pdf_quick_64@2x-6b9b314109.png","file_pdf_transparent_150@2x":o+"file_pdf_transparent_150@2x-c3bd68ca17.png","file_plugin_boardmix_64@2x":o+"file_plugin_boardmix_64@2x-526d5265a5.png","file_plugin_pixso_64@2x":o+"file_plugin_pixso_64@2x-06ade6c179.png","file_plugin_zhiying_64@2x":o+"file_plugin_zhiying_64@2x-09b9ee7037.png","file_qqjizhang_500@2x":o+"file_qqjizhang_500@2x-e6abc4581a.png","file_quick_drive_excel_64@2x":o+"file_quick_drive_excel_64@2x-2c604a5669.png","file_quick_drive_ppt_64@2x":o+"file_quick_drive_ppt_64@2x-792dbb91ca.png","file_quick_drive_txt_64@2x":o+"file_quick_drive_txt_64@2x-9105108c44.png","file_quick_drive_unknown_64@2x":o+"file_quick_drive_unknown_64@2x-ea92d84f06.png","file_quick_drive_word_64@2x":o+"file_quick_drive_word_64@2x-120315ca92.png","file_quick_workspace@2x":o+"file_quick_workspace@2x-161d913854.png","file_sharefloder_64@2x":o+"file_sharefloder_64@2x-1b31745173.png","file_sharefloder_64_white@2x":o+"file_sharefloder_64_white@2x-bea3a4fa38.png","file_sharefloder_96@2x":o+"file_sharefloder_96@2x-155058bc30.png","file_sharefolder_150@2x":o+"file_sharefolder_150@2x-109e3a74e0.png","file_sharefolder_32@2x":o+"file_sharefolder_32@2x-7fe8759ba5.png","file_sharefolder_40@2x":o+"file_sharefolder_40@2x-c0caf5513f.png","file_sharefolder_500@2x":o+"file_sharefolder_500@2x-848e83bff4.png","file_sharefolder_500@3x":o+"file_sharefolder_500@3x-e71d46ffde.png","file_sharefolder_64@2x":o+"file_sharefolder_64@2x-392b8ce218.png",file_sharefolder_64_white:o+"file_sharefolder_64_white-f8946c79ef.png","file_sharefolder_quick_64@2x":o+"file_sharefolder_quick_64@2x-1f13dcf8c3.png","file_sharefolder_transparent_150@2x":o+"file_sharefolder_transparent_150@2x-ba35272a40.png","file_sheet_150@2x":o+"file_sheet_150@2x-ac5c642019.png","file_sheet_32@2x":o+"file_sheet_32@2x-3f7e721ddb.png","file_sheet_40@2x":o+"file_sheet_40@2x-48bef4d75f.png","file_sheet_500@2x":o+"file_sheet_500@2x-bd3b45525b.png","file_sheet_500@3x":o+"file_sheet_500@3x-bfa8dd3e8e.png","file_sheet_64@2x":o+"file_sheet_64@2x-ea0885dc0d.png","file_sheet_64_white@2x":o+"file_sheet_64_white@2x-df5dab90fe.png","file_sheet_924@2x":o+"file_sheet_924@2x-541550f2b6.png","file_sheet_96@2x":o+"file_sheet_96@2x-2a38b66691.png","file_sheet_quick_64@2x":o+"file_sheet_quick_64@2x-1809ad9f6d.png","file_sheet_transparent_150@2x":o+"file_sheet_transparent_150@2x-b9abfe8b37.png","file_slide_150@2x":o+"file_slide_150@2x-0ab29c8bc3.png","file_slide_32@2x":o+"file_slide_32@2x-1db5359d4f.png","file_slide_40@2x":o+"file_slide_40@2x-d43e94aa84.png","file_slide_500@2x":o+"file_slide_500@2x-963e727f0e.png","file_slide_500@3x":o+"file_slide_500@3x-f5a5f0f9a5.png","file_slide_64@2x":o+"file_slide_64@2x-4d8870062a.png",file_slide_64_white:o+"file_slide_64_white-6497e5d536.png","file_slide_64_white@2x":o+"file_slide_64_white@2x-eaf8aee18a.png","file_slide_924@2x":o+"file_slide_924@2x-895e2831e0.png","file_slide_96@2x":o+"file_slide_96@2x-069e5ad2eb.png","file_slide_quick_64@2x":o+"file_slide_quick_64@2x-19614bb704.png","file_slide_transparent_150@2x":o+"file_slide_transparent_150@2x-834ae7eccc.png","file_smartcanvas_64@2x":o+"file_smartcanvas_64@2x-0c0743b99b.png","file_templates_96@2x":o+"file_templates_96@2x-2acd334a28.png","file_voicenotes_150@2x":o+"file_voicenotes_150@2x-21ea095db2.png","file_voicenotes_32@2x":o+"file_voicenotes_32@2x-8f32fa865b.png","file_voicenotes_40@2x":o+"file_voicenotes_40@2x-f4d6fbaa50.png","file_voicenotes_500@2x":o+"file_voicenotes_500@2x-f6cffe1536.png","file_voicenotes_64@2x":o+"file_voicenotes_64@2x-83aa786eb1.png","file_voicenotes_64_white@2x":o+"file_voicenotes_64_white@2x-8cc3cba415.png","file_voicenotes_924@2x":o+"file_voicenotes_924@2x-05ee532a9b.png","file_voicenotes_96@2x":o+"file_voicenotes_96@2x-328f2eeb88.png","file_voicenotes_quick_64@2x":o+"file_voicenotes_quick_64@2x-ca821a8db6.png","file_voicenotes_transparent_150@2x":o+"file_voicenotes_transparent_150@2x-250e74d6e2.png","file_work_96@2x":o+"file_work_96@2x-0153e5a067.png","file_workspace_150@2x":o+"file_workspace_150@2x-07e4891f0b.png","file_workspace_40@2x":o+"file_workspace_40@2x-49aed5dd0d.png","file_workspace_500@2x":o+"file_workspace_500@2x-775b3889a8.png","file_workspace_64@2x":o+"file_workspace_64@2x-f908e38166.png",file_workspace_64_white:o+"file_workspace_64_white-0e096495c0.png","file_workspace_924@2x":o+"file_workspace_924@2x-566dd5aa1b.png","file_workspace_96@2x":o+"file_workspace_96@2x-2a56fb5f12.png",file_x_64_white:o+"file_x_64_white-f331b3c691.png","file_zip@2x":o+"file_zip@2x-4cba91e82e.png","file_zip_500@2x":o+"file_zip_500@2x-d7e32c3b3b.png","file_zip_64@2x":o+"file_zip_64@2x-e1b67cd0b5.png","file_zip_64_white@2x":o+"file_zip_64_white@2x-e08b95a81e.png","form_delete_white@2x":o+"form_delete_white@2x-67a350d324.png","form_edit@2x":o+"form_edit@2x-db2bab64ca.png","form_id_list@2x":o+"form_id_list@2x-26af73321f.png","form_link_36@2x":o+"form_link_36@2x-10965ebacc.png","form_link_48@2x":o+"form_link_48@2x-a7e6dbbffb.png","form_photo@2x":o+"form_photo@2x-3adfef5941.png","form_photo_48@2x":o+"form_photo_48@2x-f9c86e8ac9.png","form_photo_white@2x":o+"form_photo_white@2x-87ab27e2d8.png","form_qrcode@2x":o+"form_qrcode@2x-8e3c2c1a6b.png","form_secondary_arrow_right_18@2x":o+"form_secondary_arrow_right_18@2x-200dd900c0.png","form_secondary_arrow_right_36@2x":o+"form_secondary_arrow_right_36@2x-964ab1f280.png","form_submitted@2x":o+"form_submitted@2x-7a10143820.png","help_line@2x":o+"help_line@2x-54da3ea7b9.png","icon_authority@2x":o+"icon_authority@2x-fbda934f42.png","icon_category_white-file_smartcanvas_64_white":o+"icon_category_white-file_smartcanvas_64_white-35d734ce06.png","icon_choosefrom_group@2x":o+"icon_choosefrom_group@2x-15b4dbbc7b.png","icon_choosefrom_partner@2x":o+"icon_choosefrom_partner@2x-4b6af4ba52.png","icon_choosefrom_qq@2x":o+"icon_choosefrom_qq@2x-a0dfa00806.png","icon_choosefrom_tencentdocs@2x":o+"icon_choosefrom_tencentdocs@2x-5ef58f68c9.png","icon_choosefrom_wechat@2x":o+"icon_choosefrom_wechat@2x-8051913004.png","icon_choosefrom_wechatwork@2x":o+"icon_choosefrom_wechatwork@2x-d6835972ee.png","icon_choosefrom_wechatwork_group@2x":o+"icon_choosefrom_wechatwork_group@2x-31d1903733.png","icon_dialog_close@2x":o+"icon_dialog_close@2x-b135f81c41.png","icon_file_drive_ppt@2x":o+"icon_file_drive_ppt@2x-77c7bc4ca2.png","icon_file_drive_word@2x":o+"icon_file_drive_word@2x-bc19a7585d.png","icon_file_drive_xls@2x":o+"icon_file_drive_xls@2x-cf8b0b364b.png","icon_filter-file_smartcanvas_32":o+"icon_filter-file_smartcanvas_32-3210f739d7.png","icon_input_protected@2x":o+"icon_input_protected@2x-8fc413b459.png","icon_list_invite@2x":o+"icon_list_invite@2x-13e7d6d215.png","icon_login_loading@2x":o+"icon_login_loading@2x-7313eaba2c.png","icon_login_phone@2x":o+"icon_login_phone@2x-75dd376c5a.png","icon_login_qq@2x":o+"icon_login_qq@2x-1011591f57.png","icon_login_wechat@2x":o+"icon_login_wechat@2x-d3751824c3.png","icon_modal_close@2x":o+"icon_modal_close@2x-94835f666b.png","icon_navigation_back_grey@2x":o+"icon_navigation_back_grey@2x-efa7c3c16f.png","icon_navigation_filter@2x":o+"icon_navigation_filter@2x-5bc4cf0cf6.png","icon_navigation_filter_blue@2x":o+"icon_navigation_filter_blue@2x-f98e738609.png","icon_notice_72@2x":o+"icon_notice_72@2x-09f661f6a7.png","icon_notice_84@2x":o+"icon_notice_84@2x-dfdb0dea27.png","icon_notification-file_smartcanvas_40":o+"icon_notification-file_smartcanvas_40-9f7d32e2c5.png","icon_plugin_ID photo24x24":o+"icon_plugin_ID photo24x24-fb83818acc.png","icon_plugin_qqmusic@2x":o+"icon_plugin_qqmusic@2x-1add6d918c.png","icon_radiobutton_normal@2x":o+"icon_radiobutton_normal@2x-65debc5496.png","icon_radiobutton_normal_disable@2x":o+"icon_radiobutton_normal_disable@2x-f1e21fe9ff.png","icon_radiobutton_selected@2x":o+"icon_radiobutton_selected@2x-6c58497827.png","icon_radiobutton_selected_disable@2x":o+"icon_radiobutton_selected_disable@2x-d648de1d45.png","icon_rename_gray@2x":o+"icon_rename_gray@2x-c5d6ecf34c.png","icon_ridiobutton_normal_white@2x":o+"icon_ridiobutton_normal_white@2x-e90c02e0d4.png","icon_ridiobutton_small_nor@2x":o+"icon_ridiobutton_small_nor@2x-4b3b6779df.png","icon_ridiobutton_small_sel@2x":o+"icon_ridiobutton_small_sel@2x-826a0e13cd.png","icon_scanning@2x":o+"icon_scanning@2x-9abe6a59a7.png","icon_search@2x":o+"icon_search@2x-5d8709a1f3.png","icon_secondary_addfriends@2x":o+"icon_secondary_addfriends@2x-2a240c8d34.png","icon_secondary_arrow_left@2x":o+"icon_secondary_arrow_left@2x-944cfebd1b.png","icon_secondary_arrow_right@2x":o+"icon_secondary_arrow_right@2x-1ba96ce0ae.png","icon_secondary_arrow_right_24@2x":o+"icon_secondary_arrow_right_24@2x-a6c61bf065.png","icon_secondary_arrow_right_white@2x":o+"icon_secondary_arrow_right_white@2x-5ab1908cc2.png","icon_secondary_close@2x":o+"icon_secondary_close@2x-9d86c1b057.png","icon_secondary_legalize@2x":o+"icon_secondary_legalize@2x-6c53ec69f6.png","icon_secondary_loading@2x":o+"icon_secondary_loading@2x-f91547e56c.png","icon_secondary_star_fill@2x":o+"icon_secondary_star_fill@2x-f207a71910.png","icon_secondary_star_line@2x":o+"icon_secondary_star_line@2x-acf410ef05.png","icon_secondary_sync_fail@2x":o+"icon_secondary_sync_fail@2x-3119a9ade4.png","icon_secondary_sync_ing@2x":o+"icon_secondary_sync_ing@2x-5ac2901de1.png","icon_secondary_sync_success@2x":o+"icon_secondary_sync_success@2x-6477d17555.png","icon_secondary_sync_waiting@2x":o+"icon_secondary_sync_waiting@2x-616a2265b3.png","icon_secondary_synchronizing@2x":o+"icon_secondary_synchronizing@2x-061dc382dc.png","icon_secondary_tick@2x":o+"icon_secondary_tick@2x-55ad445fb1.png","icon_secondary_vip@2x":o+"icon_secondary_vip@2x-ae9e331c15.png","icon_secondary_wifi@2x":o+"icon_secondary_wifi@2x-f75280a0f1.png","icon_shareto_computer@2x":o+"icon_shareto_computer@2x-a60b95d1e8.png","icon_shareto_friendscircle@2x":o+"icon_shareto_friendscircle@2x-17fa8d4055.png","icon_shareto_kandian@2x":o+"icon_shareto_kandian@2x-029983bb5c.png","icon_shareto_link@2x":o+"icon_shareto_link@2x-755f5be5d0.png","icon_shareto_miniprograms@2x":o+"icon_shareto_miniprograms@2x-8bf00b37b5.png","icon_shareto_pdf@2x":o+"icon_shareto_pdf@2x-6d2605624e.png","icon_shareto_qq@2x":o+"icon_shareto_qq@2x-3066d59a01.png","icon_shareto_qrcode@2x":o+"icon_shareto_qrcode@2x-2a7b85ea40.png","icon_shareto_qzone@2x":o+"icon_shareto_qzone@2x-5c6d5f23dc.png","icon_shareto_tim@2x":o+"icon_shareto_tim@2x-30bad9898d.png","icon_shareto_wechat@2x":o+"icon_shareto_wechat@2x-a425ac5548.png","icon_shareto_wechatwork@2x":o+"icon_shareto_wechatwork@2x-6dd51831c8.png","icon_shareto_weibo@2x":o+"icon_shareto_weibo@2x-9d58bb0b99.png","icon_shortcut-file_smartcanvas_quick_64":o+"icon_shortcut-file_smartcanvas_quick_64-1eb0aa7023.png","icon_sort@2x":o+"icon_sort@2x-1de5b164b3.png",icon_storage_24x24:o+"icon_storage_24x24-15d8e9128a.png","icon_stub-ist_share_smartcanvas":o+"icon_stub-ist_share_smartcanvas-734b510076.png",icon_svip_diamond_24x24:o+"icon_svip_diamond_24x24-44e8cdb411.png","icon_tag_list_nopermission_cn@2x":o+"icon_tag_list_nopermission_cn@2x-9722a8b84b.png","icon_tag_list_nopermission_en@2x":o+"icon_tag_list_nopermission_en@2x-7e8a0b3afa.png","icon_tasklist@2x":o+"icon_tasklist@2x-bf75c56053.png",icon_template_24x24:o+"icon_template_24x24-9309d6133f.png","icon_thirdary_arrow_fill_down_blue@2x":o+"icon_thirdary_arrow_fill_down_blue@2x-02c65b4eed.png","icon_thirdary_arrow_fill_down_grey@2x":o+"icon_thirdary_arrow_fill_down_grey@2x-ec8daa0d4a.png","icon_thirdary_arrow_fill_right_grey@2x":o+"icon_thirdary_arrow_fill_right_grey@2x-c92f52816d.png","icon_thirdary_arrow_fill_up_blue@2x":o+"icon_thirdary_arrow_fill_up_blue@2x-46c5f3baf5.png","icon_thirdary_arrow_fill_up_grey@2x":o+"icon_thirdary_arrow_fill_up_grey@2x-370a669e52.png","icon_thirdary_arrow_right@2x":o+"icon_thirdary_arrow_right@2x-9491ce2af9.png","icon_thirdary_arrow_right_black@2x":o+"icon_thirdary_arrow_right_black@2x-f0b235d898.png","icon_thirdary_close@2x":o+"icon_thirdary_close@2x-acec4bada9.png","icon_thirdary_close_36@2x":o+"icon_thirdary_close_36@2x-c6f37cc9eb.png","icon_thirdary_comment_grey@2x":o+"icon_thirdary_comment_grey@2x-a98a4e9b4a.png","icon_thirdary_filter@2x":o+"icon_thirdary_filter@2x-443247142e.png","icon_thirdary_filter_blue@2x":o+"icon_thirdary_filter_blue@2x-660cbe2238.png","icon_thirdary_loading@2x":o+"icon_thirdary_loading@2x-753e130103.png","icon_thirdary_online@2x":o+"icon_thirdary_online@2x-efc028cf05.png","icon_thirdary_safety@2x":o+"icon_thirdary_safety@2x-70f0840835.png","icon_thirdary_share@2x":o+"icon_thirdary_share@2x-dfb10508be.png","icon_thirdary_star@2x":o+"icon_thirdary_star@2x-73cb92c27c.png","icon_thirdary_tag_enterprisewechat@2x":o+"icon_thirdary_tag_enterprisewechat@2x-7faab55cc4.png","icon_thirdary_tag_group@2x":o+"icon_thirdary_tag_group@2x-8474a2267e.png","icon_thirdary_tag_new_enterprisewechat@2x":o+"icon_thirdary_tag_new_enterprisewechat@2x-08674bbf4a.png","icon_thirdary_tag_new_qq@2x":o+"icon_thirdary_tag_new_qq@2x-70bf64eff7.png","icon_thirdary_tag_new_wechat@2x":o+"icon_thirdary_tag_new_wechat@2x-ee2ca8352c.png","icon_thirdary_tag_qq@2x":o+"icon_thirdary_tag_qq@2x-0ddf10558b.png","icon_thirdary_tag_tick@2x":o+"icon_thirdary_tag_tick@2x-601a6b0fcc.png","icon_thirdary_tag_wechat@2x":o+"icon_thirdary_tag_wechat@2x-13b1f91501.png","icon_thirdary_transferarrow@2x":o+"icon_thirdary_transferarrow@2x-59bf1f3b18.png","icon_thirdary_transferarrow_stop@2x":o+"icon_thirdary_transferarrow_stop@2x-f1a5077a0d.png","icon_thirdary_wechatwork@2x":o+"icon_thirdary_wechatwork@2x-ccdcf56b52.png","icon_thirdary_zan_normal@2x":o+"icon_thirdary_zan_normal@2x-05e7e1d535.png","icon_thirdary_zan_selected@2x":o+"icon_thirdary_zan_selected@2x-8d36f5af91.png","icon_tips_close@2x":o+"icon_tips_close@2x-56b4806e0d.png","icon_tips_loading_reload_1@2x":o+"icon_tips_loading_reload_1@2x-7d02fa114c.png","icon_tips_loading_reload_2@2x":o+"icon_tips_loading_reload_2@2x-0d93909682.png","icon_toast_info@2x":o+"icon_toast_info@2x-8d4c5cb2cc.png","icon_toast_success@2x":o+"icon_toast_success@2x-fc1cbdbfa7.png","icon_toast_warn@2x":o+"icon_toast_warn@2x-af934c1f55.png","icon_toast_warn_white@2x":o+"icon_toast_warn_white@2x-8cd90cf423.png","icon_vip_close@2x":o+"icon_vip_close@2x-ac0af9eb57.png",icon_vip_diamond_24x24:o+"icon_vip_diamond_24x24-246173583b.png",im_invite_cn:o+"im_invite_cn-74d6a36705.png",im_invite_en:o+"im_invite_en-ec581dd6b3.png",im_invite_tc:o+"im_invite_tc-c388c465b9.png","ios_b:u@2x":o+"ios_b:u@2x-fa8fe63463.png","ios_bluecursor@2x":o+"ios_bluecursor@2x-17ff569a14.png","ist_blankpage_Passwordprotect@2x":o+"ist_blankpage_Passwordprotect@2x-8546bf9b66.png","ist_blankpage_Phone@2x":o+"ist_blankpage_Phone@2x-5bc80ca80f.png",ist_blankpage_Sharelink2x:o+"ist_blankpage_Sharelink2x-180ca60cb2.png","ist_blankpage_Sharelink@2x":o+"ist_blankpage_Sharelink@2x-12c997df68.png",ist_blankpage_TranslateFailed2x:o+"ist_blankpage_TranslateFailed2x-72097d77d8.png","ist_blankpage_TranslateFailed@2x":o+"ist_blankpage_TranslateFailed@2x-be9bb106a7.png",ist_blankpage_alarm2x:o+"ist_blankpage_alarm2x-238d475853.png","ist_blankpage_alarm@2x":o+"ist_blankpage_alarm@2x-812846ad6a.png","ist_blankpage_authority@2x":o+"ist_blankpage_authority@2x-56ea93c3bf.png",ist_blankpage_delete2x:o+"ist_blankpage_delete2x-db819b637f.png","ist_blankpage_delete@2x":o+"ist_blankpage_delete@2x-98f3c8193a.png","ist_blankpage_edit@2x":o+"ist_blankpage_edit@2x-df0505033a.png","ist_blankpage_group@2x":o+"ist_blankpage_group@2x-b607c1df32.png",ist_blankpage_help2x:o+"ist_blankpage_help2x-84aaeb9c9d.png","ist_blankpage_help@2x":o+"ist_blankpage_help@2x-c33bde26dc.png",ist_blankpage_importfailed2x:o+"ist_blankpage_importfailed2x-b163052694.png","ist_blankpage_importfailed@2x":o+"ist_blankpage_importfailed@2x-68b6a319c2.png",ist_blankpage_importsucessed2x:o+"ist_blankpage_importsucessed2x-5c99edb66d.png","ist_blankpage_importsucessed@2x":o+"ist_blankpage_importsucessed@2x-1ba470d70f.png","ist_blankpage_login@2x":o+"ist_blankpage_login@2x-60024c278f.png","ist_blankpage_nofiles2@2x":o+"ist_blankpage_nofiles2@2x-150e87aa04.png","ist_blankpage_nonotifications@2x":o+"ist_blankpage_nonotifications@2x-c772ecff48.png",ist_blankpage_norecorss2x:o+"ist_blankpage_norecorss2x-708ebe52cc.png",ist_blankpage_nothingfound2x:o+"ist_blankpage_nothingfound2x-e543bb25c7.png","ist_blankpage_nothingfound@2x":o+"ist_blankpage_nothingfound@2x-46a1009955.png","ist_blankpage_offline@2x":o+"ist_blankpage_offline@2x-3891c2a895.png",ist_blankpage_scanbyQQ2x:o+"ist_blankpage_scanbyQQ2x-3a566c64cf.png","ist_blankpage_secondpassword@2x":o+"ist_blankpage_secondpassword@2x-313c9e8461.png",ist_blankpage_sharelinkbroken2x:o+"ist_blankpage_sharelinkbroken2x-3d55c42ec9.png","ist_blankpage_sharelinkbroken@2x":o+"ist_blankpage_sharelinkbroken@2x-8e9542d26f.png","ist_blankpage_starred@2x":o+"ist_blankpage_starred@2x-853167257f.png",ist_blankpage_systemissue2x:o+"ist_blankpage_systemissue2x-d876f3e28d.png","ist_blankpage_systemissue@2x":o+"ist_blankpage_systemissue@2x-e0f19fceed.png","ist_blankpage_wifi@2x":o+"ist_blankpage_wifi@2x-9b0b6df7d5.png","ist_guide_android@2x":o+"ist_guide_android@2x-88c994f676.png","ist_guide_android_h5@2x":o+"ist_guide_android_h5@2x-453e8e3914.png","ist_guide_bg@2x":o+"ist_guide_bg@2x-90ba0cfa2f.png","ist_guide_copylink@2x":o+"ist_guide_copylink@2x-7201d49d98.png","ist_guide_h5@2x":o+"ist_guide_h5@2x-478292c3f3.png","ist_guide_ios@2x":o+"ist_guide_ios@2x-f93baff9d3.png","ist_guide_ios_h5@2x":o+"ist_guide_ios_h5@2x-c2be14129b.png","ist_me_bg@2x":o+"ist_me_bg@2x-0782872974.png","ist_placeholder_formbanner@2x":o+"ist_placeholder_formbanner@2x-2e5d071790.png","ist_placeholder_unpreview@2x":o+"ist_placeholder_unpreview@2x-b654ec3846.png","ist_share_aio@2x":o+"ist_share_aio@2x-1428578738.png","ist_share_doc@2x":o+"ist_share_doc@2x-ea10dab3bc.png","ist_share_doc_local@2x":o+"ist_share_doc_local@2x-bebdc7ba8e.png","ist_share_flowdiagram@2x":o+"ist_share_flowdiagram@2x-4e6408faaf.png","ist_share_flowdiagram_local@2x":o+"ist_share_flowdiagram_local@2x-72155b67d1.png","ist_share_form@2x":o+"ist_share_form@2x-a94f80abf1.png","ist_share_form_local@2x":o+"ist_share_form_local@2x-eb569739ef.png","ist_share_image@2x":o+"ist_share_image@2x-4530c7234d.png","ist_share_mindmap@2x":o+"ist_share_mindmap@2x-7a18f7c035.png","ist_share_mindmap_local@2x":o+"ist_share_mindmap_local@2x-93751d789f.png","ist_share_mp3@2x":o+"ist_share_mp3@2x-2e25fa42cb.png","ist_share_mp4@2x":o+"ist_share_mp4@2x-c8c494cf3e.png","ist_share_pdf@2x":o+"ist_share_pdf@2x-46bef0c140.png","ist_share_pdf_local@2x":o+"ist_share_pdf_local@2x-b1a7ef3908.png","ist_share_sheet@2x":o+"ist_share_sheet@2x-097fd371a6.png","ist_share_sheet_local@2x":o+"ist_share_sheet_local@2x-0f0a7b50e0.png","ist_share_slide@2x":o+"ist_share_slide@2x-8a1670d990.png","ist_share_slide_local@2x":o+"ist_share_slide_local@2x-5667b12a84.png",ist_splash_cn:o+"ist_splash_cn-5be8a35a89.png",ist_splash_en:o+"ist_splash_en-657c935c8b.png","ist_splash_zh-tc":o+"ist_splash_zh-tc-7c1fc40210.png","ist_to_miniprogram@2x":o+"ist_to_miniprogram@2x-dfe1c2f846.png","ist_to_sharefolder@2x":o+"ist_to_sharefolder@2x-c281b66642.png","list_template_nor@2x":o+"list_template_nor@2x-7ce842aca9.png","list_template_sel@2x":o+"list_template_sel@2x-5427859570.png","location_fill_24@2x":o+"location_fill_24@2x-18c3548baf.png","logo_80@2x":o+"logo_80@2x-a42dcd0613.png","longpress_add_list_copy@2x":o+"longpress_add_list_copy@2x-997e1a93e9.png","longpress_add_list_cut@2x":o+"longpress_add_list_cut@2x-554801ddf4.png","longpress_add_row_copy@2x":o+"longpress_add_row_copy@2x-bc09f634b5.png","longpress_add_row_cut@2x":o+"longpress_add_row_cut@2x-26cadd9581.png","longpress_add_row_list@2x":o+"longpress_add_row_list@2x-517bb19622.png","longpress_call@2x":o+"longpress_call@2x-2a3ff73f2e.png","longpress_card@2x":o+"longpress_card@2x-23265299bd.png","longpress_cellphoto@2x":o+"longpress_cellphoto@2x-43535d161b.png","longpress_crop_image@2x":o+"longpress_crop_image@2x-0ad5990dba.png","longpress_dele@2x":o+"longpress_dele@2x-14031cb1bc.png","longpress_delelink@2x":o+"longpress_delelink@2x-480abe0276.png","longpress_email@2x":o+"longpress_email@2x-15a8da6357.png","longpress_fill@2x":o+"longpress_fill@2x-fca8be70f2.png","longpress_floatingphoto_24@2x":o+"longpress_floatingphoto_24@2x-e263e8f236.png","longpress_freezecell@2x":o+"longpress_freezecell@2x-4870c2bec2.png","longpress_freezecell_cancel@2x":o+"longpress_freezecell_cancel@2x-dab5809e7d.png","longpress_fullscreen@2x":o+"longpress_fullscreen@2x-645997602c.png","longpress_icon_@@2x":o+"longpress_icon_@@2x-283acc3c2f.png","longpress_icon_biu@2x":o+"longpress_icon_biu@2x-29a1f56a4a.png","longpress_icon_clearformat@2x":o+"longpress_icon_clearformat@2x-6486b4fd09.png","longpress_icon_comment@2x":o+"longpress_icon_comment@2x-b57e3edfbc.png","longpress_icon_copy@2x":o+"longpress_icon_copy@2x-856d00ccdb.png","longpress_icon_copylink@2x":o+"longpress_icon_copylink@2x-4955771e27.png","longpress_icon_cut@2x":o+"longpress_icon_cut@2x-98701e8e68.png","longpress_icon_edit@2x":o+"longpress_icon_edit@2x-111a8ceb85.png","longpress_icon_fold@2x":o+"longpress_icon_fold@2x-7e72f6e979.png","longpress_icon_forward@2x":o+"longpress_icon_forward@2x-dd857b39ad.png","longpress_icon_link@2x":o+"longpress_icon_link@2x-c806f8253c.png","longpress_icon_link_card@2x":o+"longpress_icon_link_card@2x-477b791fb2.png","longpress_icon_link_icon@2x":o+"longpress_icon_link_icon@2x-eda1a93dcf.png","longpress_icon_link_preview@2x":o+"longpress_icon_link_preview@2x-dcd49a521e.png","longpress_icon_moveback@2x":o+"longpress_icon_moveback@2x-179bcc726e.png","longpress_icon_moveforward@2x":o+"longpress_icon_moveforward@2x-dff604834e.png","longpress_icon_multiselect@2x":o+"longpress_icon_multiselect@2x-a39ebefe6e.png","longpress_icon_paste@2x":o+"longpress_icon_paste@2x-49d1c44b47.png","longpress_icon_remind@2x":o+"longpress_icon_remind@2x-862b1106fc.png","longpress_icon_scan@2x":o+"longpress_icon_scan@2x-395a2fb3f1.png","longpress_icon_selecttext@2x":o+"longpress_icon_selecttext@2x-fcf41d6418.png","longpress_icon_signature_redo@2x":o+"longpress_icon_signature_redo@2x-b14a5c0820.png","longpress_icon_unfold@2x":o+"longpress_icon_unfold@2x-c864401c6b.png","longpress_image_view@2x":o+"longpress_image_view@2x-8b78e6ce9c.png","longpress_insert_link@2x":o+"longpress_insert_link@2x-ef1b991e73.png","longpress_list_copy@2x":o+"longpress_list_copy@2x-997e1a93e9.png","longpress_list_cut@2x":o+"longpress_list_cut@2x-554801ddf4.png","longpress_list_delete@2x":o+"longpress_list_delete@2x-0d9bf49064.png","longpress_mergecells@2x":o+"longpress_mergecells@2x-a0e0c782ba.png","longpress_mergecells_cancel@2x":o+"longpress_mergecells_cancel@2x-2e6fda236a.png","longpress_photo@2x":o+"longpress_photo@2x-c613ba7f85.png","longpress_quicktools_24@2x":o+"longpress_quicktools_24@2x-dc1630968e.png","longpress_replacephoto@2x":o+"longpress_replacephoto@2x-2db6d2de06.png","longpress_rotate_customize@2x":o+"longpress_rotate_customize@2x-d24f2a541c.png","longpress_rotate_image@2x":o+"longpress_rotate_image@2x-771aa7297f.png","longpress_row+line_adddown@2x":o+"longpress_row+line_adddown@2x-b1dbd4aad4.png","longpress_row+line_addleft@2x":o+"longpress_row+line_addleft@2x-4e3418b703.png","longpress_row+line_addright@2x":o+"longpress_row+line_addright@2x-ca4c687a9b.png","longpress_row+line_addup@2x":o+"longpress_row+line_addup@2x-4c351875f6.png","longpress_row_delete@2x":o+"longpress_row_delete@2x-9cb1ac92d8.png","longpress_selectpart@2x":o+"longpress_selectpart@2x-06620b2540.png","longpress_text_highlight@2x":o+"longpress_text_highlight@2x-9229952f59.png","longpress_text_highlight_cancel@2x":o+"longpress_text_highlight_cancel@2x-e8a0fb2aa5.png","longpress_todo@2x":o+"longpress_todo@2x-0e1fda8bdd.png","longpress_view@2x":o+"longpress_view@2x-fb9d8b185b.png","menu__officalcertification@2x":o+"menu__officalcertification@2x-8922866127.png","menu_add@2x":o+"menu_add@2x-b983e9c5b8.png","menu_addto@2x":o+"menu_addto@2x-d964c49c35.png","menu_authority@2x":o+"menu_authority@2x-8b8d9006b6.png","menu_bwechat@2x":o+"menu_bwechat@2x-2c2ad75f5c.png","menu_cache@2x":o+"menu_cache@2x-262ae3f54e.png","menu_cache__succeed@2x":o+"menu_cache__succeed@2x-4aec7c378e.png","menu_cache_cancel@2x":o+"menu_cache_cancel@2x-88d14d650a.png","menu_cache_download @2x":o+"menu_cache_download @2x-c822336490.png","menu_cache_upload@2x":o+"menu_cache_upload@2x-eebf6ddff9.png","menu_camera@2x":o+"menu_camera@2x-bfc19c2f25.png","menu_catalog@2x":o+"menu_catalog@2x-23ef2d5225.png","menu_checkform@2x":o+"menu_checkform@2x-e9e6c0a06c.png","menu_copy@2x":o+"menu_copy@2x-edfc024252.png","menu_creatform@2x":o+"menu_creatform@2x-0af04a4522.png","menu_data_appendix@2x":o+"menu_data_appendix@2x-5e1cd1120d.png","menu_data_checkbox@2x":o+"menu_data_checkbox@2x-148cc79448.png","menu_data_contact@2x":o+"menu_data_contact@2x-21893eb2a6.png","menu_data_date31@2x":o+"menu_data_date31@2x-d31eb9f127.png","menu_data_dropdown@2x":o+"menu_data_dropdown@2x-2e0db38911.png","menu_data_email@2x":o+"menu_data_email@2x-28120f3483.png","menu_data_idcard@2x":o+"menu_data_idcard@2x-e5dc80f8c1.png","menu_data_none@2x":o+"menu_data_none@2x-14497158f9.png","menu_data_number@2x":o+"menu_data_number@2x-fefbb68796.png","menu_data_phonenumber@2x":o+"menu_data_phonenumber@2x-8c5dd2740f.png","menu_data_progress@2x":o+"menu_data_progress@2x-bf9bd3bd80.png","menu_data_star@2x":o+"menu_data_star@2x-ff49a0b899.png","menu_data_telephonenumber@2x":o+"menu_data_telephonenumber@2x-8517b5e616.png","menu_data_temperature@2x":o+"menu_data_temperature@2x-f3cba4f10b.png","menu_data_text@2x":o+"menu_data_text@2x-dad369a850.png","menu_find+replace@2x":o+"menu_find+replace@2x-7931f77551.png","menu_history@2x":o+"menu_history@2x-60623dad0d.png","menu_icon_link@2x":o+"menu_icon_link@2x-d9dba70675.png","menu_icon_tencentdoc@2x":o+"menu_icon_tencentdoc@2x-4ae559d054.png","menu_image@2x":o+"menu_image@2x-18e05063bc.png","menu_link_card@2x 2":o+"menu_link_card@2x 2-cfe2ce3316.png","menu_link_card@2x":o+"menu_link_card@2x-cfe2ce3316.png","menu_link_fontlink@2x 2":o+"menu_link_fontlink@2x 2-908632a739.png","menu_link_fontlink@2x":o+"menu_link_fontlink@2x-45c101ce1f.png","menu_link_iconlink@2x 2":o+"menu_link_iconlink@2x 2-01518df336.png","menu_link_iconlink@2x":o+"menu_link_iconlink@2x-01518df336.png","menu_link_preview@2x 2":o+"menu_link_preview@2x 2-7f42f51454.png","menu_link_preview@2x":o+"menu_link_preview@2x-7f42f51454.png","menu_linkexcel@2x":o+"menu_linkexcel@2x-52d27fac0b.png","menu_linkform@2x":o+"menu_linkform@2x-bb7420f626.png","menu_moveto@2x":o+"menu_moveto@2x-f4fd7d2baf.png","menu_notice_mine@2x":o+"menu_notice_mine@2x-93f161f433.png","menu_quickway@2x":o+"menu_quickway@2x-1e9cbcf3e2.png","menu_quickway_cancel@2x":o+"menu_quickway_cancel@2x-c9f6e214eb.png","menu_reback@2x":o+"menu_reback@2x-9d5759817b.png","menu_rename@2x":o+"menu_rename@2x-28f622ad04.png","menu_revisionhistory@2x":o+"menu_revisionhistory@2x-38be780585.png","menu_scan@2x":o+"menu_scan@2x-c99b60e7cc.png","menu_search@2x":o+"menu_search@2x-730b2acf14.png","menu_to_computer@2x":o+"menu_to_computer@2x-50a1f04fc8.png","menu_to_excel@2x":o+"menu_to_excel@2x-0a83b5fb72.png","menu_to_pdf@2x":o+"menu_to_pdf@2x-6acd33ee91.png","menu_to_photo@2x":o+"menu_to_photo@2x-8671b28b45.png","menu_to_ppt@2x":o+"menu_to_ppt@2x-cda8e2f6e9.png","menu_to_word@2x":o+"menu_to_word@2x-11fbd452cd.png","menu_transfer@2x":o+"menu_transfer@2x-4ed8097068.png","menu_unlinkform@2x":o+"menu_unlinkform@2x-0a890f3388.png","menu_uploadfile@2x":o+"menu_uploadfile@2x-7271935245.png","menu_viewswitch@2x":o+"menu_viewswitch@2x-fe636be9e4.png","menu_waitinginvitation@2x":o+"menu_waitinginvitation@2x-b46645b46d.png","menu_weipan@2x":o+"menu_weipan@2x-e57dc5e263.png","mini_programs_01@2x":o+"mini_programs_01@2x-707662a82d.png","mini_programs_02@2x":o+"mini_programs_02@2x-a02f5435dc.png","mobile_buy_tag@2x":o+"mobile_buy_tag@2x-7dcf0308a2.png","mobile_free_tag@2x":o+"mobile_free_tag@2x-cbbe0ac78b.png","more_jielong@2x":o+"more_jielong@2x-030a02d03a.png","more_settings_disable@2x":o+"more_settings_disable@2x-f032680425.png","more_settings_normal@2x":o+"more_settings_normal@2x-f0337c0207.png","navigation_OCR@2x":o+"navigation_OCR@2x-7977f22193.png","navigation_back@2x":o+"navigation_back@2x-df44415163.png","navigation_back_white@2x":o+"navigation_back_white@2x-bc20cf97dd.png","navigation_backup@2x":o+"navigation_backup@2x-d10cb372c3.png","navigation_download@2x":o+"navigation_download@2x-c3b61e5aa7.png","navigation_edit@2x":o+"navigation_edit@2x-6038512127.png","navigation_emoji@2x":o+"navigation_emoji@2x-27ca837fd2.png","navigation_error@2x":o+"navigation_error@2x-ccc649a063.png","navigation_expand@2x":o+"navigation_expand@2x-eda64fee06.png","navigation_fit_paper@2x":o+"navigation_fit_paper@2x-769695ff43.png","navigation_fit_screen@2x":o+"navigation_fit_screen@2x-4dfb7fd291.png","navigation_fraction@2x":o+"navigation_fraction@2x-a70d70f11a.png","navigation_headline1@2x":o+"navigation_headline1@2x-9ca71ccf1e.png","navigation_headline2@2x":o+"navigation_headline2@2x-0f165c85a5.png","navigation_headline3@2x":o+"navigation_headline3@2x-79b2fd6ea4.png","navigation_headline4@2x":o+"navigation_headline4@2x-7a6448317b.png","navigation_headline5@2x":o+"navigation_headline5@2x-1a2079214b.png","navigation_headline6@2x":o+"navigation_headline6@2x-c08ac75a27.png","navigation_headline@2x":o+"navigation_headline@2x-037719c006.png","navigation_home@2x":o+"navigation_home@2x-a039316cb3.png","navigation_more@2x":o+"navigation_more@2x-d1c67dbe1d.png","navigation_notice@2x":o+"navigation_notice@2x-6f149fc426.png","navigation_officalcertification@2x":o+"navigation_officalcertification@2x-5cff76ffea.png","navigation_pdf@2x":o+"navigation_pdf@2x-cc690c53d6.png","navigation_play@2x":o+"navigation_play@2x-c013e2b293.png","navigation_search@2x":o+"navigation_search@2x-398658c752.png","navigation_share@2x":o+"navigation_share@2x-1ae8279f51.png","navigation_share_white@2x":o+"navigation_share_white@2x-f77d701d2b.png","navigation_star@2x":o+"navigation_star@2x-cfb6133b4b.png","navigation_star_fill@2x":o+"navigation_star_fill@2x-6076df2622.png","navigation_test@2x":o+"navigation_test@2x-e2fc0aa875.png","navigation_threecolumns@2x":o+"navigation_threecolumns@2x-fa6940bca0.png","navigation_topic@2x":o+"navigation_topic@2x-1d173b5b58.png","navigation_twocolumns@2x":o+"navigation_twocolumns@2x-83a50256fa.png","navigation_upload_regular_24@2x":o+"navigation_upload_regular_24@2x-1115dce544.png","navigation_voicenotes@2x":o+"navigation_voicenotes@2x-cc0343e0d1.png","navigation_wifi@2x":o+"navigation_wifi@2x-c170a0821e.png","pc_introduction@2x":o+"pc_introduction@2x-34f3ca1f2b.png","plugin_outline_regular_24@2x":o+"plugin_outline_regular_24@2x-21389c9cc2.png","qr_logo@2x":o+"qr_logo@2x-b34609cea2.png","qr_logo_bg@2x":o+"qr_logo_bg@2x-566399967e.png","qr_logo_sticker@2x":o+"qr_logo_sticker@2x-02e2c124bb.png","question_ deadline@2x":o+"question_ deadline@2x-d33c0d8d9d.png","question_ roster@2x":o+"question_ roster@2x-519aa8a0c8.png","question_add_blue@2x":o+"question_add_blue@2x-f7a0b822f8.png","question_add_disable@2x":o+"question_add_disable@2x-e61f520e66.png","question_add_grey@2x":o+"question_add_grey@2x-3c8fa0fa57.png","question_checkbox_nor@2x":o+"question_checkbox_nor@2x-7c7e67a5ac.png","question_checkbox_nor_dis@2x":o+"question_checkbox_nor_dis@2x-dcad9e230b.png","question_checkbox_sel@2x":o+"question_checkbox_sel@2x-dc4a1c2eaa.png","question_checkbox_sel_dis@2x":o+"question_checkbox_sel_dis@2x-f26ca6bcdc.png","question_correct@2x":o+"question_correct@2x-bfa9727db5.png","question_date@2x":o+"question_date@2x-f055bc3ab6.png","question_date_disable@2x":o+"question_date_disable@2x-2cbb0ef3d3.png","question_delete_normal@2x":o+"question_delete_normal@2x-6f6d374974.png","question_drag_button@2x":o+"question_drag_button@2x-c692136140.png","question_error@2x":o+"question_error@2x-1f3ee63957.png","question_fraction@2x":o+"question_fraction@2x-1bef652588.png","question_location@2x":o+"question_location@2x-77c8266aea.png","question_location_dis@2x":o+"question_location_dis@2x-4c68838301.png","question_location_disable@2x":o+"question_location_disable@2x-f1608aee88.png","question_position@2x":o+"question_position@2x-33b4bea80e.png","question_radio_nor@2x":o+"question_radio_nor@2x-083d6d94fa.png","question_radio_nor_dis@2x":o+"question_radio_nor_dis@2x-c60e21e579.png","question_radio_sel@2x":o+"question_radio_sel@2x-3b29b1524c.png","question_radio_sel_dis@2x":o+"question_radio_sel_dis@2x-b957ad2fd4.png","question_remove_dis@2x":o+"question_remove_dis@2x-f07da1149f.png","question_remove_nor@2x":o+"question_remove_nor@2x-22b58db637.png","question_roster@2x":o+"question_roster@2x-db3b39182e.png","question_set_drag@2x":o+"question_set_drag@2x-26668fe70a.png","question_set_end@2x":o+"question_set_end@2x-98bab047c8.png","question_set_pause@2x":o+"question_set_pause@2x-1230864ede.png","question_set_play@2x":o+"question_set_play@2x-249ca28c03.png","question_set_required@2x":o+"question_set_required@2x-e2fabd8ea2.png","question_set_roster@2x":o+"question_set_roster@2x-7711d354df.png","question_set_score@2x":o+"question_set_score@2x-20ba2c8718.png","question_set_smalladd@2x":o+"question_set_smalladd@2x-08e1e90b26.png","question_set_smallcheckbox_nor@2x":o+"question_set_smallcheckbox_nor@2x-645cd1f992.png","question_set_smallcheckbox_sel@2x":o+"question_set_smallcheckbox_sel@2x-1fa8ed93aa.png","question_set_statustag@2x":o+"question_set_statustag@2x-4be311d797.png","question_set_time@2x":o+"question_set_time@2x-402aca0bd2.png","question_set_unstart@2x":o+"question_set_unstart@2x-b8788bdf6b.png","question_submitted@2x":o+"question_submitted@2x-21612d24ff.png","question_temperature_c@2x":o+"question_temperature_c@2x-cfbf5d6934.png","question_temperature_c_dis@2x":o+"question_temperature_c_dis@2x-60d3771c8d.png","question_temperature_f@2x":o+"question_temperature_f@2x-ea5bbf4dcc.png","question_temperature_f_dis@2x":o+"question_temperature_f_dis@2x-476b8f494a.png","question_time@2x":o+"question_time@2x-0179f87249.png","question_time_dis@2x":o+"question_time_dis@2x-32b539c117.png","question_time_disable@2x":o+"question_time_disable@2x-3bc9119450.png","questiontype_checkbox@2x":o+"questiontype_checkbox@2x-536d07809d.png","questiontype_checkbox_b@2x":o+"questiontype_checkbox_b@2x-16d78cbdff.png","questiontype_copy_normal@2x":o+"questiontype_copy_normal@2x-604f01d13e.png","questiontype_date@2x":o+"questiontype_date@2x-3e2c87c629.png","questiontype_file@2x":o+"questiontype_file@2x-a9e2b1cc87.png","questiontype_file_b@2x":o+"questiontype_file_b@2x-ffb3fc8adb.png","questiontype_image@2x":o+"questiontype_image@2x-df4ebcfbbe.png","questiontype_image_b@2x":o+"questiontype_image_b@2x-8a7cb55cc2.png","questiontype_location@2x":o+"questiontype_location@2x-64e3e30c45.png","questiontype_location_b@2x":o+"questiontype_location_b@2x-415dcfbeac.png","questiontype_matrix_28@2x":o+"questiontype_matrix_28@2x-53f0f58db7.png","questiontype_multileveloptions_28@2x":o+"questiontype_multileveloptions_28@2x-95c7514ba4.png","questiontype_radio@2x":o+"questiontype_radio@2x-6e405c95c9.png","questiontype_radio_b@2x":o+"questiontype_radio_b@2x-f1a090c3fc.png","questiontype_rate_28@2x":o+"questiontype_rate_28@2x-9592b85d95.png","questiontype_select@2x":o+"questiontype_select@2x-2038a67b53.png","questiontype_select_b@2x":o+"questiontype_select_b@2x-1afa079e44.png","questiontype_signature@2x":o+"questiontype_signature@2x-384fc93d6c.png","questiontype_signature_b@2x":o+"questiontype_signature_b@2x-8b33130443.png","questiontype_simple@2x":o+"questiontype_simple@2x-641b8878e8.png","questiontype_simple_b@2x":o+"questiontype_simple_b@2x-10381ceaeb.png","questiontype_star_28@2x":o+"questiontype_star_28@2x-cb231cb1d4.png","questiontype_temperature@2x":o+"questiontype_temperature@2x-014c68a4da.png","questiontype_temperature_b@2x":o+"questiontype_temperature_b@2x-6be74a1e75.png","questiontype_time@2x":o+"questiontype_time@2x-ea863fd663.png","questiontype_time_b@2x":o+"questiontype_time_b@2x-8b60c99c4d.png","radiobutton-disable-210114@2x":o+"radiobutton-disable-210114@2x-8ac4f5b409.png","radiobutton-selected-210114@2x":o+"radiobutton-selected-210114@2x-3b29b1524c.png","radiobutton-unselected-210114@2x":o+"radiobutton-unselected-210114@2x-083d6d94fa.png","scanning_album@2x":o+"scanning_album@2x-9bf66db823.png","scanning_cut@2x":o+"scanning_cut@2x-dd6f73f775.png","scanning_filter@2x":o+"scanning_filter@2x-9acd9d7618.png","scanning_filter_active@2x":o+"scanning_filter_active@2x-6d53919856.png",scanning_loading2x:o+"scanning_loading2x-a072a6ee48.png","scanning_motion@2x":o+"scanning_motion@2x-02ca1375fe.png","scanning_ocr@2x":o+"scanning_ocr@2x-9ef567b6c4.png","scanning_reback_black@2x":o+"scanning_reback_black@2x-662f336fe7.png","scanning_reback_white@2x":o+"scanning_reback_white@2x-735993352d.png","scanning_rotate@2x":o+"scanning_rotate@2x-9dfd9a5627.png","scanning_shooting@2x":o+"scanning_shooting@2x-53f0f3365e.png","secondary_comment_blue@2x":o+"secondary_comment_blue@2x-07e7f1cf5f.png","secondary_comment_grey@2x":o+"secondary_comment_grey@2x-d7f7e682a7.png","segmented_view_grid@2x":o+"segmented_view_grid@2x-682a62bb60.png","segmented_view_list@2x":o+"segmented_view_list@2x-effab033ae.png","select_avatar@2x":o+"select_avatar@2x-5bb841b6ac.png","set-score-add@2x":o+"set-score-add@2x-5db96c5fd6.png","set-score-sub@2x":o+"set-score-sub@2x-01169a0938.png","set_notify_me@2x":o+"set_notify_me@2x-76b00c2461.png","set_score@2x":o+"set_score@2x-a3228c0858.png","shape_fill_regular_28@2x":o+"shape_fill_regular_28@2x-4465fe29c8.png","square-checkbox-disable-210114@2x":o+"square-checkbox-disable-210114@2x-77526a3095.png","square-checkbox-selected-210114@2x":o+"square-checkbox-selected-210114@2x-87c2eeebc1.png","square-checkbox-unselected-210114@2x":o+"square-checkbox-unselected-210114@2x-7c7e67a5ac.png","stafflist_outline_regular_24@2x":o+"stafflist_outline_regular_24@2x-d5cda4325e.png","star-fill-48@2x":o+"star-fill-48@2x-51b7807cfb.png","star-unfill-48@2x":o+"star-unfill-48@2x-044a3d44cd.png","star-unfill@2x":o+"star-unfill@2x-9036eea396.png","super_vip_diamond_normal@2x":o+"super_vip_diamond_normal@2x-4303712363.png","svip+vip_card_disable_en@2x":o+"svip+vip_card_disable_en@2x-7d00fb929b.png","svip+vip_card_disable_tc@2x":o+"svip+vip_card_disable_tc@2x-8a83690a32.png","svip+vip_card_expired_en@2x":o+"svip+vip_card_expired_en@2x-9743ce2f8c.png","svip+vip_card_expired_tc@2x":o+"svip+vip_card_expired_tc@2x-5aeccdb61d.png","svip+vip_smalldiamond_disable@2x":o+"svip+vip_smalldiamond_disable@2x-d455c6e15d.png","svip_smalldiamond_normal@2x":o+"svip_smalldiamond_normal@2x-26ef0fe6f1.png","svip_tag@2x":o+"svip_tag@2x-bb68e39f57.png","switch_off@2x":o+"switch_off@2x-3e72813dfb.png","switch_on@2x":o+"switch_on@2x-760dd8b581.png","tabbar_creat@2x":o+"tabbar_creat@2x-9bbf2038c1.png","tabbar_doc_nor@2x":o+"tabbar_doc_nor@2x-4d77150f23.png","tabbar_doc_sel@2x":o+"tabbar_doc_sel@2x-d2054c229b.png","tabbar_home_nor@2x":o+"tabbar_home_nor@2x-81a65b8f84.png","tabbar_home_sel@2x":o+"tabbar_home_sel@2x-54260e3f52.png","tabbar_me_nor@2x":o+"tabbar_me_nor@2x-9cf6216fd1.png","tabbar_me_sel@2x":o+"tabbar_me_sel@2x-6d185258e4.png","tabbar_tool_nor_24@2x":o+"tabbar_tool_nor_24@2x-eab89f43db.png","tabbar_tool_sel_24@2x":o+"tabbar_tool_sel_24@2x-8e117ade4a.png","templates_background_620@2x":o+"templates_background_620@2x-f18a8deff6.png","text@2x":o+"text@2x-1b850bcba3.png","textbox_fill_regular_28@2x":o+"textbox_fill_regular_28@2x-b1a6782ce3.png","tick_sel@2x":o+"tick_sel@2x-eb49934999.png","tick_unsel@2x":o+"tick_unsel@2x-a88ccaa345.png","tips_banner_officialaccountsA@2x":o+"tips_banner_officialaccountsA@2x-3ad9cde9b0.png","tips_banner_officialaccountsB@2x":o+"tips_banner_officialaccountsB@2x-0f923dc2a8.png","tips_banner_qq@2x":o+"tips_banner_qq@2x-73047e4355.png","tips_banner_starred@2x":o+"tips_banner_starred@2x-9a1eee8c0c.png","tips_banner_vip@2x":o+"tips_banner_vip@2x-23e10bb8c8.png","tips_banner_wechat@2x":o+"tips_banner_wechat@2x-96647bf996.png","titlebar_form@2x":o+"titlebar_form@2x-62077755f1.png","titlebar_preview@2x":o+"titlebar_preview@2x-7050286e98.png","titlebar_qrcode@2x":o+"titlebar_qrcode@2x-ec60643a06.png","titlebar_xiezuoren@2x":o+"titlebar_xiezuoren@2x-c5efdec138.png","toolbar_@@2x":o+"toolbar_@@2x-7ce413155e.png","toolbar_add@2x":o+"toolbar_add@2x-a1661deb20.png","toolbar_add_@@2x":o+"toolbar_add_@@2x-42881d0409.png","toolbar_add_camera@2x":o+"toolbar_add_camera@2x-ad8576d83f.png","toolbar_add_cellphoto@2x":o+"toolbar_add_cellphoto@2x-6b08db9bc6.png","toolbar_add_clock@2x":o+"toolbar_add_clock@2x-ae60b840d8.png","toolbar_add_comment@2x":o+"toolbar_add_comment@2x-609e2e7f0a.png","toolbar_add_divide@2x":o+"toolbar_add_divide@2x-3a30a21bfe.png","toolbar_add_docs@2x":o+"toolbar_add_docs@2x-b49a36217c.png","toolbar_add_folder@2x":o+"toolbar_add_folder@2x-7247638881.png","toolbar_add_function@2x":o+"toolbar_add_function@2x-552094c9fc.png","toolbar_add_link@2x":o+"toolbar_add_link@2x-f091604e7f.png","toolbar_add_list@2x":o+"toolbar_add_list@2x-04ec188e82.png","toolbar_add_location@2x":o+"toolbar_add_location@2x-d7167ac86f.png","toolbar_add_ocr@2x":o+"toolbar_add_ocr@2x-66f0a34450.png","toolbar_add_photo@2x":o+"toolbar_add_photo@2x-2009a430af.png","toolbar_add_recording@2x":o+"toolbar_add_recording@2x-4013d0514a.png","toolbar_add_signature@2x":o+"toolbar_add_signature@2x-b520e401b9.png","toolbar_add_table@2x":o+"toolbar_add_table@2x-2e50aad585.png","toolbar_add_template_daily@2x":o+"toolbar_add_template_daily@2x-1cd06c905c.png","toolbar_add_template_report@2x":o+"toolbar_add_template_report@2x-598834801f.png","toolbar_add_template_todo@2x":o+"toolbar_add_template_todo@2x-d8680ebc25.png","toolbar_add_weipan@2x":o+"toolbar_add_weipan@2x-f195f59561.png","toolbar_camera@2x":o+"toolbar_camera@2x-4567d94f99.png","toolbar_cancelremarks@2x":o+"toolbar_cancelremarks@2x-220aaf6d42.png","toolbar_card@2x":o+"toolbar_card@2x-0417b9df99.png","toolbar_cell@2x":o+"toolbar_cell@2x-4e941c282b.png","toolbar_cell_allborder@2x":o+"toolbar_cell_allborder@2x-36ea2f9a0e.png","toolbar_cell_decreasedecimal@2x":o+"toolbar_cell_decreasedecimal@2x-652272a69b.png","toolbar_cell_horizontalborder@2x":o+"toolbar_cell_horizontalborder@2x-d1f9a9f4e5.png","toolbar_cell_increasedecimal@2x":o+"toolbar_cell_increasedecimal@2x-7828680f79.png","toolbar_cell_innerborder@2x":o+"toolbar_cell_innerborder@2x-8f5d442328.png","toolbar_cell_noborder@2x":o+"toolbar_cell_noborder@2x-6d02063e23.png","toolbar_cell_outborder@2x":o+"toolbar_cell_outborder@2x-e3ecfb2b2f.png","toolbar_cell_rightcell@2x":o+"toolbar_cell_rightcell@2x-576bde4713.png","toolbar_cell_select@2x":o+"toolbar_cell_select@2x-066417ba1d.png","toolbar_cell_upcell@2x":o+"toolbar_cell_upcell@2x-7b3fcd5a4b.png","toolbar_cell_verticalborder@2x":o+"toolbar_cell_verticalborder@2x-5035cb2b91.png","toolbar_clock@2x":o+"toolbar_clock@2x-2bc46bc4ab.png","toolbar_close@2x":o+"toolbar_close@2x-74326d3b7a.png","toolbar_collapse_24@2x":o+"toolbar_collapse_24@2x-ffc52a86b0.png","toolbar_docs@2x":o+"toolbar_docs@2x-7648d8714f.png","toolbar_fil_by_line@2x":o+"toolbar_fil_by_line@2x-d07067406e.png","toolbar_file@2x":o+"toolbar_file@2x-3ffe5ebc66.png","toolbar_fileconversion@2x":o+"toolbar_fileconversion@2x-71c6592b59.png","toolbar_filter@2x":o+"toolbar_filter@2x-cf74f7fb97.png","toolbar_filter_selected@2x":o+"toolbar_filter_selected@2x-1aaff7e626.png","toolbar_forward@2x":o+"toolbar_forward@2x-b5bb9e0903.png","toolbar_function@2x":o+"toolbar_function@2x-713b6d8998.png","toolbar_highlight@2x":o+"toolbar_highlight@2x-eb6ecf88c7.png","toolbar_information@2x":o+"toolbar_information@2x-88687ff3f5.png","toolbar_keyboard_off@2x":o+"toolbar_keyboard_off@2x-b59d62f7ff.png","toolbar_keyboard_on@2x":o+"toolbar_keyboard_on@2x-4c6e9483ea.png","toolbar_link@2x":o+"toolbar_link@2x-ddaa3826ea.png","toolbar_mergecells@2x":o+"toolbar_mergecells@2x-76356e91c4.png","toolbar_openlocalfile_24@2x":o+"toolbar_openlocalfile_24@2x-6f2ec1b46c.png","toolbar_paragraph@2x":o+"toolbar_paragraph@2x-91a57ab5cd.png","toolbar_paragraph_1.3@2x":o+"toolbar_paragraph_1-fa31ee026c.3@2x.png","toolbar_paragraph_1.5@2x":o+"toolbar_paragraph_1-72b8443991.5@2x.png","toolbar_paragraph_1@2x":o+"toolbar_paragraph_1@2x-8d1ca8ea7e.png","toolbar_paragraph_2@2x":o+"toolbar_paragraph_2@2x-22e956c6d4.png","toolbar_paragraph_3@2x":o+"toolbar_paragraph_3@2x-09ed968ad9.png","toolbar_paragraph_addindent@2x":o+"toolbar_paragraph_addindent@2x-c651f82af0.png","toolbar_paragraph_aligncenter@2x":o+"toolbar_paragraph_aligncenter@2x-8c227b3567.png","toolbar_paragraph_alignleft@2x":o+"toolbar_paragraph_alignleft@2x-5023f53cad.png","toolbar_paragraph_alignright@2x":o+"toolbar_paragraph_alignright@2x-97aebcf3d3.png","toolbar_paragraph_end@2x":o+"toolbar_paragraph_end@2x-8138d55c7a.png","toolbar_paragraph_itemdot@2x":o+"toolbar_paragraph_itemdot@2x-3c9a325853.png","toolbar_paragraph_itemnumber@2x":o+"toolbar_paragraph_itemnumber@2x-450b6b44fd.png","toolbar_paragraph_middle@2x":o+"toolbar_paragraph_middle@2x-c60d2b36a1.png","toolbar_paragraph_reduceindent@2x":o+"toolbar_paragraph_reduceindent@2x-dcce1d080a.png","toolbar_paragraph_top@2x":o+"toolbar_paragraph_top@2x-92ccbcefa6.png","toolbar_photp@2x":o+"toolbar_photp@2x-1ef9636f6a.png","toolbar_qrcode@2x":o+"toolbar_qrcode@2x-0ca7b94545.png","toolbar_quote@2x":o+"toolbar_quote@2x-2aee22c125.png","toolbar_redo@2x":o+"toolbar_redo@2x-e2ce3fdcf5.png","toolbar_remarks@2x":o+"toolbar_remarks@2x-b86d2be674.png","toolbar_row+line@2x":o+"toolbar_row+line@2x-8aeca9fde9.png","toolbar_row+line_adddown@2x":o+"toolbar_row+line_adddown@2x-7595b153eb.png","toolbar_row+line_addleft@2x":o+"toolbar_row+line_addleft@2x-901336067d.png","toolbar_row+line_addright@2x":o+"toolbar_row+line_addright@2x-e215cc8113.png","toolbar_row+line_addup@2x":o+"toolbar_row+line_addup@2x-0fc928b01c.png","toolbar_shape@2x":o+"toolbar_shape@2x-33ed799665.png","toolbar_sheet_protect@2x":o+"toolbar_sheet_protect@2x-cd985c4584.png","toolbar_sheet_protect_open@2x":o+"toolbar_sheet_protect_open@2x-2575596191.png","toolbar_text@2x":o+"toolbar_text@2x-2aa914bedb.png","toolbar_text_10@2x":o+"toolbar_text_10@2x-a66c84a735.png","toolbar_text_11@2x":o+"toolbar_text_11@2x-fe91a9bf5c.png","toolbar_text_12@2x":o+"toolbar_text_12@2x-9ffff2bbb2.png","toolbar_text_14@2x":o+"toolbar_text_14@2x-ce7c0e5c4b.png","toolbar_text_16@2x":o+"toolbar_text_16@2x-74f7fc5cdf.png","toolbar_text_18@2x":o+"toolbar_text_18@2x-06e25284d2.png","toolbar_text_Italic@2x":o+"toolbar_text_Italic@2x-72474923fb.png","toolbar_text_annotation@2x":o+"toolbar_text_annotation@2x-1fba07df5e.png","toolbar_text_bold@2x":o+"toolbar_text_bold@2x-d995f3c013.png","toolbar_text_color@2x":o+"toolbar_text_color@2x-f390dcd4d6.png","toolbar_text_decrease@2x":o+"toolbar_text_decrease@2x-6a0a5f61fc.png","toolbar_text_deleteline@2x":o+"toolbar_text_deleteline@2x-7e11c197b4.png","toolbar_text_highlight@2x":o+"toolbar_text_highlight@2x-7e66fdcdb1.png","toolbar_text_increase@2x":o+"toolbar_text_increase@2x-1e70cf0af4.png","toolbar_text_maintext@2x":o+"toolbar_text_maintext@2x-bd5aa9fe8b.png","toolbar_text_maintext_en@2x":o+"toolbar_text_maintext_en@2x-e1e22cce0c.png","toolbar_text_smalltitle@2x":o+"toolbar_text_smalltitle@2x-cdb798946a.png","toolbar_text_title1@2x":o+"toolbar_text_title1@2x-707074501c.png","toolbar_text_title1_en@2x":o+"toolbar_text_title1_en@2x-2c6eb8202f.png","toolbar_text_title2@2x":o+"toolbar_text_title2@2x-64842e0e96.png","toolbar_text_title2_en@2x":o+"toolbar_text_title2_en@2x-8ec8fc15ed.png","toolbar_text_title3@2x":o+"toolbar_text_title3@2x-2bbf7494cc.png","toolbar_text_title3_en@2x":o+"toolbar_text_title3_en@2x-08ae08c409.png","toolbar_text_title4@2x":o+"toolbar_text_title4@2x-650ac28bcd.png","toolbar_text_title4_en@2x":o+"toolbar_text_title4_en@2x-a8f0dba3bc.png","toolbar_text_title@2x":o+"toolbar_text_title@2x-4149f7b0c3.png","toolbar_text_underline@2x":o+"toolbar_text_underline@2x-9e2cb8450c.png","toolbar_textbox@2x":o+"toolbar_textbox@2x-e1a1138c3c.png","toolbar_todo@2x":o+"toolbar_todo@2x-76821d2166.png","toolbar_transform@2x":o+"toolbar_transform@2x-4409fb136a.png","toolbar_undo@2x":o+"toolbar_undo@2x-41b3fa5497.png","toolbar_view@2x":o+"toolbar_view@2x-f1ab0b4815.png","toolbar_view_filter@2x":o+"toolbar_view_filter@2x-71d840bbc6.png","toolbar_voice@2x":o+"toolbar_voice@2x-742faa3e5f.png","toolbar_wordwrap@2x":o+"toolbar_wordwrap@2x-cff8211c6e.png","upload_arrow@2x":o+"upload_arrow@2x-429fb3c219.png","view_results@2x":o+"view_results@2x-c3b014a149.png","vip_cdk_logo@2x":o+"vip_cdk_logo@2x-2df9533f47.png","vip_cdk_pattern@2x":o+"vip_cdk_pattern@2x-ab39d62958.png","vip_diamond_bg_line_mobile@2x":o+"vip_diamond_bg_line_mobile@2x-63df19e883.png","vip_diamond_disable@2x":o+"vip_diamond_disable@2x-6b9a566bc8.png","vip_diamond_normal@2x":o+"vip_diamond_normal@2x-22b07148c0.png","vip_login_qq @2x":o+"vip_login_qq @2x-57820a9b7e.png","vip_login_wechat@2x":o+"vip_login_wechat@2x-ee06ee31f5.png","vip_login_wechatwork @2x":o+"vip_login_wechatwork @2x-bd4899eb02.png","vip_smalldiamond_normal@2x":o+"vip_smalldiamond_normal@2x-d84a209699.png","vip_tag@2x":o+"vip_tag@2x-d95aa7cb97.png","voiceinput_pause@2x":o+"voiceinput_pause@2x-c8b760a55e.png","voiceinput_tab@2x":o+"voiceinput_tab@2x-4d07a5baaa.png","watermark_intensive@2x":o+"watermark_intensive@2x-c1f22638af.png","watermark_loose@2x":o+"watermark_loose@2x-c898528da5.png","watermark_no@2x":o+"watermark_no@2x-14ce938c20.png","wechat_channels@2x":o+"wechat_channels@2x-1db1c6895d.png","wechat_miniprograms@2x":o+"wechat_miniprograms@2x-2a2b919083.png","wedrive_file_or_doc_menu_addmember@2x":o+"wedrive_file_or_doc_menu_addmember@2x-d9cd5b5c3c.png","wedrive_file_or_doc_menu_authority@2x":o+"wedrive_file_or_doc_menu_authority@2x-9d68ad3e73.png","wedrive_link@2x":o+"wedrive_link@2x-1975e53e29.png","wedrive_share@2x":o+"wedrive_share@2x-19fd1e916d.png"})},53382:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(19625),t),o(n(10595),t),o(n(9265),t)},10595:function(e,t,n){var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.OfflineEditBase=void 0;var a=n(7386),s=n(49790),c=n(59475),l=n(9265),u=n(38098),d=n(96196),p=n(48306),f=n(58637),_=n(80985),h=n(24557),m="OnTencentDocsDBVersionChanged",g="beforeunload",v=function(){function e(e,t){var n=this;this.option=e,this.delegate=t,this.tag="OfflineEditBase",this.isStorageAvailable=!1,this.isResubmitFinish=!1,this.databaseVersionUpgrade=function(){f.logger.info(n.tag,m),n.storageManager.storage.close(),n.isStorageAvailable=!1},this.beforeunload=function(){f.logger.info(n.tag,"beforeunload"),o(n,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return this.mutexLockHelper.isLocked()?[4,this.hasLocalChanges()]:[3,3];case 1:return e.sent()?[3,3]:(f.StoredFlagUtil.setItem(this.option.documentInfo,!1),[4,this.mutexLockHelper.release()]);case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},p.Reporter.init(this.option.documentInfo),this.mutexLockHelper=new d.MutexLockHelper(this.option.documentInfo)}return e.prototype.init=function(e){return void 0===e&&(e=!1),o(this,void 0,void 0,(function(){var t,n,r,o,c,l,d,h;return i(this,(function(i){switch(i.label){case 0:return this.isDisableOfflineEdit(e)?(o=new _.ResubmitResult("OFFLINE_EDIT_DATABASE_UNAVAILABLE"),_.OfflineEditDatabaseInitFinishEventEmitter.fire(o),[2,o]):(t=+new Date,n={databaseName:"1"===f.getUrlParameter("usebackupdb")?a.DB_NAME_BACKUP:s.DB_NAME,disabled:!0,type:f.isSupportClientDB()?a.DBEngineType.nativeDB:a.DBEngineType.indexDB,timeout:2e4},this.storageManager=new a.StorageManager(n),this.localChangesHelper=new u.LocalChangesHelper(this.storageManager.storage,this.option.documentInfo),this.delegate.oldChangesTransForm&&this.localChangesHelper.setUpOldChangesTransForm(this.delegate.oldChangesTransForm),[4,this.storageManager.init()]);case 1:return r=i.sent(),this.isStorageAvailable=r,r?(c=+new Date,l=c-t,p.Reporter.reportValue({attrName:"OFFLINE_EDIT_DATABASE_INIT",status:0,value:l}),f.logger.info(this.tag,"name:"+this.storageManager.storage.name+" init finish. databaseInitCost:"+l+"ms."),[4,this.mutexLockHelper.lock()]):(p.Reporter.reportStatus({attrName:"OFFLINE_EDIT_DATABASE_INIT",status:1}),f.logger.warn(this.tag,"StorageManager init fail."),o=new _.ResubmitResult("OFFLINE_EDIT_DATABASE_UNAVAILABLE"),_.OfflineEditDatabaseInitFinishEventEmitter.fire(o),[2,o]);case 2:return d=i.sent(),f.logger.info(this.tag,"init finish. lockInitCost:"+(+new Date-c)+"ms isStorageAvailable:"+this.isStorageAvailable+", islockSuccess:"+d+"."),_.AfterContentChangeEventEmitter.fire({}),this.initDatabaseVersionUpgrade(),window.addEventListener(g,this.beforeunload),h=new _.ResubmitResult("OFFLINE_EDIT_DATABASE_INIT"),_.OfflineEditDatabaseInitFinishEventEmitter.fire(h),[2,h]}}))}))},e.prototype.dispose=function(){var e;return o(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return window.removeEventListener(m,this.databaseVersionUpgrade),window.removeEventListener(g,this.beforeunload),[4,null===(e=this.mutexLockHelper)||void 0===e?void 0:e.dispose()];case 1:return t.sent(),this.storageManager.dispose(),[2,!0]}}))}))},e.prototype.canWrite=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return this.isStorageAvailable?this.mutexLockHelper.isLocked()?[2,!0]:f.StoredFlagUtil.hasChanges(this.option.documentInfo)===String(!0)?[2,!1]:[4,this.hasLocalChanges()]:[2,!1];case 1:return e.sent()?[2,!1]:[4,this.mutexLockHelper.lock()];case 2:return[2,e.sent()]}}))}))},e.prototype.canRead=function(){return this.isStorageAvailable},e.prototype.getChanges=function(e){return o(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:if(!this.canRead())return[2,f.canNotRead()];r.label=1;case 1:return r.trys.push([1,3,,4]),t=null!=e?e:{types:l.DEFAULT_DATA_TYPES},[4,this.localChangesHelper.getChanges(t)];case 2:return[2,r.sent()];case 3:return n=r.sent(),this.isStorageAvailable=!1,[2,new c.Result(n)];case 4:return[2]}}))}))},e.prototype.upsertChanges=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return f.logger.info(this.tag,"upsertChanges length:"+e.length,e.map((function(e){return{version:e.version,taskId:e.taskId,type:e.type,createTimestamp:e.createTimestamp}}))),[4,this.canUpdateChanges()];case 1:if(!n.sent())return f.logger.warn(this.tag,"upsertChanges fail, isStorageAvailable:"+this.isStorageAvailable+", locked:"+this.mutexLockHelper.isLocked()),[2,f.canNotWrite("isStorageAvailable:"+this.isStorageAvailable)];n.label=2;case 2:return n.trys.push([2,4,,5]),[4,this.localChangesHelper.upsertChanges(e)];case 3:return[2,n.sent()];case 4:return t=n.sent(),f.logger.error(this.tag,"upsertChanges error: "+t.message+", , "+t.stack+"."),this.isStorageAvailable=!1,[2,new c.Result(t)];case 5:return[2]}}))}))},e.prototype.deleteChanges=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return[4,this.canUpdateChanges()];case 1:if(!n.sent())return f.logger.warn(this.tag,"deleteChanges fail, isStorageAvailable:"+this.isStorageAvailable+", locked:"+this.mutexLockHelper.isLocked()),[2,f.canNotWrite("isStorageAvailable:"+this.isStorageAvailable)];n.label=2;case 2:return n.trys.push([2,4,,5]),[4,this.localChangesHelper.deleteChanges(e)];case 3:return[2,n.sent()];case 4:return t=n.sent(),this.isStorageAvailable=!1,[2,new c.Result(t)];case 5:return[2]}}))}))},e.prototype.deleteAndUpsertChanges=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return f.logger.info(this.tag,"deleteAndUpsertChanges length:"+t.length,t.map((function(e){return{version:e.version,taskId:e.taskId,type:e.type,createTimestamp:e.createTimestamp}}))),[4,this.canUpdateChanges()];case 1:if(!r.sent())return f.logger.warn(this.tag,"deleteAndUpsertChanges fail, isStorageAvailable:"+this.isStorageAvailable+", locked:"+this.mutexLockHelper.isLocked()),[2,f.canNotWrite("isStorageAvailable:"+this.isStorageAvailable)];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,this.localChangesHelper.deleteAndUpsertChanges(e,t)];case 3:return[2,r.sent()];case 4:return n=r.sent(),this.isStorageAvailable=!1,[2,new c.Result(n)];case 5:return[2]}}))}))},e.prototype.hasLocalChanges=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:if(!this.canRead())return f.logger.info(this.tag,"hasChanges can not read."),[2,!0];n.label=1;case 1:return n.trys.push([1,3,,4]),t=null!=e?e:{types:l.DEFAULT_DATA_TYPES},[4,this.localChangesHelper.hasChanges(t)];case 2:return[2,n.sent()];case 3:return n.sent(),this.isStorageAvailable=!1,[2,!0];case 4:return[2]}}))}))},e.prototype.canUpdateChanges=function(){var e;return o(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return(null===(e=this.option.config)||void 0===e?void 0:e.isUseResubmit)&&!this.isResubmitFinish?[2,!1]:[4,this.canWrite()];case 1:return[2,t.sent()]}}))}))},e.prototype.isDisableOfflineEdit=function(e){return!(!e&&f.isDatabaseAvailable())},e.prototype.initDatabaseVersionUpgrade=function(){window.addEventListener(m,this.databaseVersionUpgrade),this.storageManager.storage.events.onVersionChange(this.databaseVersionUpgrade)},r([h.BeforeRunDecorate((function(){return _.BeforeContentChangeEventEmitter.fire({})}))],e.prototype,"upsertChanges",null),r([h.BeforeRunDecorate((function(){return _.BeforeContentChangeEventEmitter.fire({})}))],e.prototype,"deleteChanges",null),r([h.BeforeRunDecorate((function(){return _.BeforeContentChangeEventEmitter.fire({})}))],e.prototype,"deleteAndUpsertChanges",null),e}();t.OfflineEditBase=v},19625:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},9265:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_DATA_TYPES=void 0;var r=n(49790);t.DEFAULT_DATA_TYPES=[r.DOCUMENT_DATA_TYPE.committing,r.DOCUMENT_DATA_TYPE.queue,r.DOCUMENT_DATA_TYPE.waiting]},24557:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.ResubmitDecorate=t.OutputResultDecorate=t.BeforeRunDecorate=void 0;var r=n(58637),o=function(e,t){void 0===t&&(t="DEFAULT"),["OFFLINE_EDIT_UNKNOWN","OFFLINE_EDIT_GET_LOCAL_CHANGES_FAIL","OFFLINE_EDIT_MULTI_VERSION","OFFLINE_EDIT_LOCAL_CHANGES_APPLY_FAIL","OFFLINE_EDIT_GET_CHANGES_FAIL","OFFLINE_EDIT_BATCH_FAIL_BY_SERVER","OFFLINE_EDIT_FOLLOW_ERROR"].includes(e)&&r.webLogReport(t+"_"+e)};t.BeforeRunDecorate=function(e){return function(t,n,r){var o=r.value;r.value=function(){null==e||e();var t=o.apply(this,arguments);return t}}},t.OutputResultDecorate=function(){return function(e,t,n){var o=n.value;n.value=function(){var e,t=this,n=o.apply(this,arguments);return null===(e=n.then)||void 0===e||e.call(n,(function(e){var n,o;r.logger.info(t.tag,"result isSuccess:"+e.isSuccess+", "+e.status+", retCode:"+e.retCode),e.error&&r.logger.warn(t.tag,"result error:$ "+(null===(n=e.error)||void 0===n?void 0:n.message)+", "+(null===(o=e.error)||void 0===o?void 0:o.stack))})),n}}},t.ResubmitDecorate=function(){return function(e,t,n){var i=n.value;n.value=function(){var e,t=this,n=i.apply(this,arguments);return null===(e=n.then)||void 0===e||e.call(n,(function(e){var n,i;t.isResubmitFinish=!0,r.Reporter.reportStatus({attrName:e.status,status:0}),o(e.status,null===(i=null===(n=t.option)||void 0===n?void 0:n.documentInfo)||void 0===i?void 0:i.documentType)})).catch((function(){var e,n;t.isResubmitFinish=!0,o("OFFLINE_EDIT_UNKNOWN",null===(n=null===(e=t.option)||void 0===e?void 0:e.documentInfo)||void 0===n?void 0:n.documentType)})),n}}}},38098:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.LocalChangesHelper=void 0;var s=n(49790),c=n(7386),l=n(59475),u=n(53581),d=n(24557),p=n(80985),f=n(58637),_=function(){function e(e,t){this.storage=e,this.documentInfo=t,this.tag="OfflineLocalChangesHelper",this.changeStorage=new c.OfflineDataStorage(this.storage.collection(s.OfflineData))}return e.prototype.setUpOldChangesTransForm=function(e){this.transform=e},e.prototype.getChanges=function(e){return i(this,void 0,void 0,(function(){var t,n,o;return a(this,(function(i){switch(i.label){case 0:return t=r({uid:this.documentInfo.uid,secretId:this.documentInfo.secretId},e),[4,f.applyFunctionTimeout(this.changeStorage.getChanges(t),[])];case 1:return n=i.sent(),(o=this.offlineDataTransFormToBaseChanges(n)).sort((function(e,t){return e.createTimestamp-t.createTimestamp})),[2,new l.Result(void 0,o)]}}))}))},e.prototype.hasChanges=function(e){return i(this,void 0,void 0,(function(){var t,n,o;return a(this,(function(i){switch(i.label){case 0:return t=r({uid:this.documentInfo.uid,secretId:this.documentInfo.secretId},e),n={limit:1},[4,f.applyFunctionTimeout(this.changeStorage.getChanges(t,n),[])];case 1:return[2,(null==(o=i.sent())?void 0:o.length)>0]}}))}))},e.prototype.upsertChanges=function(e){return i(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return(null==e?void 0:e.length)?[4,this.changeStorage.upsertChanges(this.storageChanges(e))]:[2,new l.Result({name:this.tag,message:"upsertChanges changes is null"})];case 1:return t.sent(),[2,new l.Result(void 0,!0)]}}))}))},e.prototype.deleteChanges=function(e){return i(this,void 0,void 0,(function(){var t;return a(this,(function(n){switch(n.label){case 0:return t=r({uid:this.documentInfo.uid,secretId:this.documentInfo.secretId},e),[4,this.changeStorage.deleteChanges(t)];case 1:return n.sent(),[2,new l.Result(void 0,!0)]}}))}))},e.prototype.deleteAndUpsertChanges=function(e,t){return i(this,void 0,void 0,(function(){var n,o=this;return a(this,(function(c){switch(c.label){case 0:return n=r({uid:this.documentInfo.uid,secretId:this.documentInfo.secretId},e),[4,this.storage.transaction([s.OfflineData],u.TransactionMode.READ_WRITE,(function(e){return i(o,void 0,void 0,(function(){var r;return a(this,(function(o){switch(o.label){case 0:return[4,(r=e.collection(s.OfflineData)).where({uid:n.uid,secretId:n.secretId,subGlobalPadId:n.subGlobalPadId,type:{in:n.types},subDocType:{in:n.subDocType}}).clear()];case 1:return o.sent(),(null==t?void 0:t.length)?[4,r.bulkUpsert(this.storageChanges(t))]:[3,3];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))}))];case 1:return c.sent(),[2,new l.Result(void 0,!0)]}}))}))},e.prototype.storageChanges=function(e){var t=this,n=[];return e.forEach((function(e){var o=e.version,i=e.taskId,a=e.subId,c=e.type,l=e.createTimestamp,u=e.chunkId,d=e.subGlobalPadId,p=e.subDocType,f=r(r({},t.documentInfo),{version:o,taskId:i,subId:a,type:c,createTimestamp:l,chunkId:u,isDefaultChunk:e.default,subGlobalPadId:null!=d?d:t.documentInfo.globalPadId,subDocType:null!=p?p:t.documentInfo.docType,data:JSON.stringify(e)}),_=new s.OfflineData(f);n.push(_)})),n},e.prototype.offlineDataTransFormToBaseChanges=function(e){var t=this;return e.filter((function(e){return e.data})).map((function(e){var n,r,o=e.data;try{var i=JSON.parse(o);return!i.modelVersion&&t.transform&&(i=t.transform(e)),i.subGlobalPadId=null!==(n=i.subGlobalPadId)&&void 0!==n?n:t.documentInfo.globalPadId,i.subDocType=null!==(r=i.subDocType)&&void 0!==r?r:t.documentInfo.docType,i.dataVersion=e.dataVersion,i}catch(n){f.logger.warn(t.tag,"offlineDataTransFormToBaseChanges fail."+e.key)}return o}))},o([d.BeforeRunDecorate((function(){return p.AfterContentChangeEventEmitter.fire({})}))],e.prototype,"upsertChanges",null),o([d.BeforeRunDecorate((function(){return p.AfterContentChangeEventEmitter.fire({})}))],e.prototype,"deleteChanges",null),o([d.BeforeRunDecorate((function(){return p.AfterContentChangeEventEmitter.fire({})}))],e.prototype,"deleteAndUpsertChanges",null),e}();t.LocalChangesHelper=_},71412:function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.MutexLockState=void 0,function(e){e.INIT="INIT",e.FAILED="FAILED",e.SUCCESS="SUCCESS",e.RELEASE="RELEASE"}(n||(n={})),t.MutexLockState=n},96196:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.MutexLockHelper=void 0;var i=n(95721),a=n(58637),s=n(80985),c=n(71412),l={strategy:0,period:1e3,autoRenewal:!0},u=function(){function e(e){var t;this.info=e,this.tag="OfflineMutexLockHelper",this.lockState=c.MutexLockState.INIT,this.mutexLock=(t=l,a.isSupportClientDB()&&!a.isOfflineDebug()?new i.ClientResourceLock(t):new i.WebResourceLock(t)),this.lockKey="offline_edit_"+this.info.secretId}return e.prototype.dispose=function(){return r(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return clearInterval(this.detectTimer),[4,this.release()];case 1:return e.sent(),[2,!0]}}))}))},e.prototype.isLockedByOtherPage=function(){var e,t;return!this.isLocked()&&(null===(t=null===(e=this.lastLockItem)||void 0===e?void 0:e.optional)||void 0===t?void 0:t.source)===s.MutexLockSource.EDIT},e.prototype.lock=function(){return r(this,void 0,void 0,(function(){var e=this;return o(this,(function(t){return this.lockPromise||(this.lockPromise=new Promise((function(t){e.mutexLock.lock(e.lockKey,{source:s.MutexLockSource.EDIT}).then((function(n){var r;if(e.lastLockItem=void 0,null==n?void 0:n.isSuccess)e.setLockState(c.MutexLockState.SUCCESS);else{e.lastLockItem=n.data,e.setLockState(c.MutexLockState.FAILED);var o=setTimeout((function(){e.reset(),clearTimeout(o)}),3e4)}a.logger.info(e.tag,"竞争锁结果："+(null==n?void 0:n.isSuccess)+" "+(null===(r=null==n?void 0:n.data)||void 0===r?void 0:r.id)),t(e.isLocked())}))}))),[2,this.lockPromise]}))}))},e.prototype.isLocked=function(){return this.lockState===c.MutexLockState.SUCCESS},e.prototype.detect=function(e,t){var n=this;void 0===t&&(t=200),a.logger.info("deteck lock, interval="+t),this.detectTimer=setInterval((function(){return r(n,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return[4,this.mutexLock.detectKey(this.lockKey)];case 1:return(t=n.sent()).error||void 0!==t.data?(t.data&&(this.lastLockItem=t.data),[2]):(e(),clearInterval(this.detectTimer),[2])}}))}))}),t)},e.prototype.release=function(){return r(this,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:return[4,this.mutexLock.release(this.lockKey)];case 1:return e=t.sent(),a.logger.info(this.tag,"释放锁结果："+e),this.setLockState(c.MutexLockState.RELEASE),this.reset(),[2,!0]}}))}))},e.prototype.setLockState=function(e){e!==this.lockState&&(this.lockState=e)},e.prototype.reset=function(){this.lockPromise=void 0},e}();t.MutexLockHelper=u},61952:function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.OfflineTipsType=void 0,function(e){e.NONE="NONE",e.OFFLINE_EDIT="OFFLINE_EDIT",e.OFFLINE_NOT_AVAILABLE="OFFLINE_NOT_AVAILABLE",e.OFFLINE_DATA_SYNC_PAGE_LOCK="OFFLINE_DATA_SYNC_PAGE_LOCK",e.OFFLINE_DATA_SYNCING="OFFLINE_DATA_SYNCING"}(n||(n={})),t.OfflineTipsType=n},68169:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.OfflineTipsHelper=void 0;var a=i(n(52739)),s=i(n(17008)),c=n(61952),l=n(58637),u=function(){function e(e,t){this.delegate=e,this.dependency=t,this.tag="OfflineTipsHelper",this.isOffline=!1,this.tipsType=c.OfflineTipsType.NONE,this.messageMap=new Map([[c.OfflineTipsType.OFFLINE_EDIT,this.delegate.networkStatusSwitch.config.available],[c.OfflineTipsType.OFFLINE_NOT_AVAILABLE,this.delegate.networkStatusSwitch.config.unusable],[c.OfflineTipsType.OFFLINE_DATA_SYNC_PAGE_LOCK,this.delegate.networkStatusSwitch.config.otherTab],[c.OfflineTipsType.OFFLINE_DATA_SYNCING,this.delegate.networkStatusSwitch.config.offlineDataSyncing]])}return e.prototype.contentChange=function(){this.isOffline&&this.delegate.networkStatusSwitch&&this.showTips()},e.prototype.enterOffline=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return this.isOffline?[2]:(l.logger.info(this.tag,"enterOffline "+e),this.isOffline=!0,[4,this.needShowTips(e)]);case 1:return t.sent()&&this.showTips(),[2]}}))}))},e.prototype.enterOnline=function(e){var t;return r(this,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return this.isOffline?(l.logger.info(this.tag,"enterOnline"),this.isOffline=!1,this.hideTips(),this.delegate.canEdit()&&(null===(t=this.delegate.networkStatusSwitch)||void 0===t||t.setEditAble()),[4,this.hasLocalChanges(e)]):[2];case 1:return n.sent()&&(l.isMobile()?s.default.show({message:this.messageMap.get(c.OfflineTipsType.OFFLINE_DATA_SYNCING),type:"info",autoClose:!0,duration:2e3}):a.default.show({message:this.messageMap.get(c.OfflineTipsType.OFFLINE_DATA_SYNCING),type:"info",autoClose:!0,duration:2e3,closable:!0})),[2]}}))}))},e.prototype.hasLocalChanges=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return null==e?[3,1]:(t=e,[3,3]);case 1:return[4,this.dependency.hasLocalChanges()];case 2:t=n.sent(),n.label=3;case 3:return[2,t]}}))}))},e.prototype.getTipsType=function(){return r(this,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:return[4,this.dependency.canWrite()];case 1:return e=t.sent(),this.dependency.mutexLockHelper.isLockedByOtherPage()?[2,c.OfflineTipsType.OFFLINE_DATA_SYNC_PAGE_LOCK]:e?[2,c.OfflineTipsType.OFFLINE_EDIT]:[2,c.OfflineTipsType.OFFLINE_NOT_AVAILABLE]}}))}))},e.prototype.getMessage=function(e){var t,n=this.messageMap.get(e)||this.delegate.networkStatusSwitch.config.available;return null===(t=this.delegate.eventEmitter)||void 0===t||t.emit("UPDATE_SAVE_TIPS_OFFLINE_TEXT",n),n},e.prototype.showTips=function(){var e;return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return[4,this.getTipsType()];case 1:return(t=n.sent())!==this.tipsType&&(this.tipsType=t,l.isMobile()?this.showMobileTips():this.showPCTips(),this.tipsType!==c.OfflineTipsType.OFFLINE_NOT_AVAILABLE&&this.tipsType!==c.OfflineTipsType.OFFLINE_DATA_SYNC_PAGE_LOCK||null===(e=this.delegate.networkStatusSwitch)||void 0===e||e.setDisableEdit()),[2]}}))}))},e.prototype.showMobileTips=function(){this.snackbarInstance=s.default.show({message:this.getMessage(this.tipsType),type:"info",autoClose:!0,duration:3e3})},e.prototype.showPCTips=function(){this.snackbarInstance=a.default.show({message:this.getMessage(this.tipsType),type:"info",autoClose:!1,closable:!1,style:{zIndex:3998},id:l.OFFLINE_TIPS_CONTAINER_ID})},e.prototype.hideTips=function(){var e,t;this.tipsType=c.OfflineTipsType.NONE,null===(t=null===(e=this.snackbarInstance)||void 0===e?void 0:e.close)||void 0===t||t.call(e)},e.prototype.needShowTips=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return(t=this.delegate.canEdit())?[4,this.hasLocalChanges(e)]:[3,2];case 1:t=n.sent()||this.dependency.mutexLockHelper.isLockedByOtherPage()||!this.dependency.canRead(),n.label=2;case 2:return[2,t]}}))}))},e}();t.OfflineTipsHelper=u},24212:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=c(n(52739)),u=c(n(17008)),d=n(49790),p=n(18366),f=n(53382),_=n(80985),h=n(58637),m=n(49015),g=n(10638),v=function(){function e(e,t,n){this.option=e,this.delegate=t,this.localChangesHelper=n,this.tag="OfflineResubmitHelper"}return e.prototype.resubmit=function(){var e,t;return o(this,void 0,void 0,(function(){var n,r,o,a;return i(this,(function(i){switch(i.label){case 0:if(!h.precheck(this.option.documentInfo))return[2,new _.ResubmitResult("OFFLINE_EDIT_NO_DATA")];i.label=1;case 1:return i.trys.push([1,5,,6]),[4,this.localChangesHelper.getChanges({types:f.DEFAULT_DATA_TYPES})];case 2:return n=i.sent().data,[4,null===(t=null===(e=this.delegate.resubmit)||void 0===e?void 0:e.beforeResubmit)||void 0===t?void 0:t.call(e,n)];case 3:return r=i.sent(),[4,this.prepareHandleLocalChanges(null!=r?r:n)];case 4:return(o=i.sent()).isSuccess||this.printLocalChanges(n),[2,o];case 5:return a=i.sent(),h.logger.warn(this.tag,"resubmit fail, error: "+a.message+", "+a.stack),[2,new _.ResubmitResult("OFFLINE_EDIT_GET_LOCAL_CHANGES_FAIL",a)];case 6:return[2]}}))}))},e.prototype.prepareHandleLocalChanges=function(e){return o(this,void 0,void 0,(function(){var t,n,r,o,a;return i(this,(function(i){switch(i.label){case 0:return 0===e.length?(h.logger.info(this.tag,"no data need handle."),[2,new _.ResubmitResult("OFFLINE_EDIT_NO_DATA")]):(h.logger.info(this.tag,"getChanges length:"+e.length,e.map((function(e){return{version:e.version,taskId:e.taskId,type:e.type,createTimestamp:e.createTimestamp}}))),this.beginSyncing(),-1!==(t=this.getBaseVersion(e))?[3,2]:[4,this.handleLocalChangesToBackUp(e)]);case 1:return i.sent(),this.hideSyncingTips(),[2,new _.ResubmitResult("OFFLINE_EDIT_MULTI_VERSION",new Error("INVALID_BASE_REV."))];case 2:return i.trys.push([2,5,,6]),[4,this.checkNeedBackup(e)];case 3:return n=i.sent(),0===(r=this.fliterAndSort(n)).length?(h.logger.info(this.tag,"no data need handle after filtered."),this.hideSyncingTips(),[2,new _.ResubmitResult("OFFLINE_EDIT_NO_DATA")]):[4,this.handleLocalChanges(r,t)];case 4:return o=i.sent(),this.hideSyncingTips(),[2,o];case 5:return a=i.sent(),h.logger.warn(this.tag,"prepareHandleLocalChanges error: "+a.message+", "+a.stack),this.hideSyncingTips(),[2,new _.ResubmitResult("OFFLINE_EDIT_UNKNOWN",a)];case 6:return[2]}}))}))},e.prototype.handleLocalChanges=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return h.logger.info(this.tag,"handleLocalChanges localVersion:"+t+", version:"+this.option.version),n=new _.ResubmitResult("OFFLINE_EDIT_BATCH_COMMIT_NO_USE"),this.isUseBatchCommit(t)?[4,this.batchCommitLocalChanges(e,t)]:[3,2];case 1:n=r.sent(),r.label=2;case 2:return h.logger.info(this.tag,"handleLocalChanges status:"+n.status+" retCode:"+n.retCode),function(e){return["OFFLINE_EDIT_BATCH_FAIL_BY_NETWORK","OFFLINE_EDIT_BATCH_COMMIT_NO_USE","OFFLINE_EDIT_BATCH_PAYLOAD_TOO_LARGE"].includes(e.status)||e.retCode&&[p.RoomWebsocketErrorCode.SOCKET_DATA_BASEREV_ERROR,10001,p.DocEditorError.BodyTooLargeError].includes(e.retCode)}(n)?[4,this.handleLocalChangesByVersion(e,t)]:[3,4];case 3:return[2,r.sent()];case 4:return[2,n]}}))}))},e.prototype.handleLocalChangesByVersion=function(e,t){return o(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return t!==this.option.version?[3,2]:[4,this.handleLocalVersionEqualVersion(e)];case 1:case 3:return[2,n.sent()];case 2:return t<this.option.version?[4,this.handleLocalVersionLessThanVersion(e)]:[3,4];case 4:return[2,this.handleLocalVersionGreaterThanVersion(t,e)]}}))}))},e.prototype.applyLocalChanges=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.delegate.resubmit.applyLocalChanges(e)];case 1:return n.sent(),[3,3];case 2:return t=n.sent(),this.handleLocalChangesToBackUp(e),[2,new _.ResubmitResult("OFFLINE_EDIT_LOCAL_CHANGES_APPLY_FAIL",t)];case 3:return[2,new _.ResubmitResult("OFFLINE_EDIT_LOCAL_CHANGES_APPLY_SUCCESS")]}}))}))},e.prototype.handleLocalVersionEqualVersion=function(e){return o(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.applyLocalChanges(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.handleLocalVersionLessThanVersion=function(e){return o(this,void 0,void 0,(function(){var t,n,r;return i(this,(function(o){switch(o.label){case 0:return[4,new m.UpdateChangesHelper(this.option.version,this.delegate).updateChanges(e)];case 1:return t=o.sent(),n=t.error,r=t.data,n?(this.handleLocalChangesToBackUp(e),[2,new _.ResubmitResult("OFFLINE_EDIT_FOLLOW_ERROR",n)]):[4,this.applyLocalChanges(r)];case 2:return[2,o.sent()]}}))}))},e.prototype.fliterAndSort=function(e){var t,n,r;return(null!==(r=null===(n=(t=this.delegate.resubmit).filterLocalChange)||void 0===n?void 0:n.call(t,e))&&void 0!==r?r:e).sort((function(e,t){return e.createTimestamp-t.createTimestamp}))},e.prototype.handleLocalVersionGreaterThanVersion=function(e,t){return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),[4,this.delegate.resubmit.getNewChanges(this.option.version+1,e)];case 1:return n=i.sent(),(r=n[n.length-1].newRev)<e?(h.logger.info(this.tag,"真实后台最大版本比本地离线版本还要小，maxMissChangeVersion="+r),this.localChangesHelper.deleteChanges({types:f.DEFAULT_DATA_TYPES}),[2,new _.ResubmitResult("OFFLINE_EDIT_LOCAL_VERSION_GREATER_THAN_NEW_VERSION",new Error("local version than server"))]):[4,this.delegate.resubmit.applyNewChanges(n)];case 2:return i.sent(),[4,this.applyLocalChanges(t)];case 3:return i.sent(),[3,5];case 4:return o=i.sent(),[2,new _.ResubmitResult("OFFLINE_EDIT_LOCAL_CHANGES_APPLY_FAIL",o)];case 5:return[2,new _.ResubmitResult("OFFLINE_EDIT_LOCAL_VERSION_GREATER_THAN_LAST_VERSION")]}}))}))},e.prototype.getBaseVersion=function(e){var t,n,r,o,i=new Set,s=-1;try{for(var c=a(e),l=c.next();!l.done;l=c.next())s=l.value.version,i.add(s)}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}if(i.size>1){var u="";try{for(var d=a(i),p=d.next();!p.done;p=d.next())u=""+u+p.value+", "}catch(e){r={error:e}}finally{try{p&&!p.done&&(o=d.return)&&o.call(d)}finally{if(r)throw r.error}}return h.logger.error(this.tag,"getBaseRev:"+u+" "),-1}return s},e.prototype.batchCommitLocalChanges=function(e,t){var n,r;return o(this,void 0,void 0,(function(){var o,a,c,l,u,d;return i(this,(function(i){switch(i.label){case 0:return o=s(e,1),a=o[0],[4,this.delegate.resubmit.connectionController.batchCommitMessages(this.baseChange2Userchange(e),this.option.version,this.isBase64Commands(a)?{additionalFieldsToCommon:{commandsFormat:h.COMMANDS_FORMAT.PROTOBUF}}:void 0)];case 1:if(!(c=i.sent()).success)return[3,8];i.label=2;case 2:return i.trys.push([2,4,,5]),l=e.map((function(e){return e.taskId})),[4,this.localChangesHelper.deleteChanges({taskIds:l})];case 3:return i.sent(),[3,5];case 4:return u=i.sent(),h.logger.warn(this.tag,"batchCommitLocalChanges deleteChanges error:"+u.message+", "+u.stack),[3,5];case 5:return i.trys.push([5,7,,8]),[4,null===(n=this.delegate.resubmit)||void 0===n?void 0:n.applyNewChanges(null!==(r=c.data)&&void 0!==r?r:[])];case 6:return i.sent(),[2,new _.ResubmitResult("OFFLINE_EDIT_BATCH_SUCCESS")];case 7:return d=i.sent(),[2,new _.ResubmitResult("OFFLINE_EDIT_LOCAL_CHANGES_APPLY_FAIL",d)];case 8:return[4,this.batchCommitFail(c,e,t)];case 9:return[2,i.sent()]}}))}))},e.prototype.isBase64Commands=function(e){return e.modelVersion===h.OFFLINE_EDIT_MODEL_VERSION.DOC_PROTOBUF&&this.option.documentInfo.docType===d.DOCUMENT_TYPE.doc},e.prototype.isUseBatchCommit=function(e){var t;return!!(null===(t=this.option.config)||void 0===t?void 0:t.isUseBatchCommit)&&this.option.version>=e&&"0"!==h.getUrlParameter("commitchanges")},e.prototype.batchCommitFail=function(e,t,n){return o(this,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:return(r=new _.ResubmitResult("OFFLINE_EDIT_BATCH_FAIL_BY_NETWORK",void 0,e.retCode)).baseVersion=n,"ServerVerityException"!==e.type?[3,3]:(r.status="OFFLINE_EDIT_BATCH_FAIL_BY_SERVER",e.retCode===p.RoomWebsocketErrorCode.COMMIT_CHANGES_CONTAIN_REVERT?[3,2]:[4,this.handleLocalChangesToBackUp(t)]);case 1:o.sent(),o.label=2;case 2:return[3,4];case 3:"NetworkException"===e.type&&(413!==e.retCode&&52003!==e.retCode||(r.status="OFFLINE_EDIT_BATCH_PAYLOAD_TOO_LARGE")),o.label=4;case 4:return[2,r]}}))}))},e.prototype.baseChange2Userchange=function(e){var t=this,n=[];return null==e||e.forEach((function(e){var o,i=e.modelVersion===h.OFFLINE_EDIT_MODEL_VERSION.DOC_PROTOBUF&&t.option.documentInfo.docType===d.DOCUMENT_TYPE.doc,a=r(r({},e),{baseRev:e.version,changeset:i?"":null!==(o=e.changesetString)&&void 0!==o?o:"",base64Commands:i?e.changesetString:""});n.push(a)})),n},e.prototype.checkNeedBackup=function(e){return o(this,void 0,void 0,(function(){var t,n,r,o,a;return i(this,(function(i){switch(i.label){case 0:return t=s(e,1),n=t[0],r=n.dataVersion,o=void 0===r?"":r,a=n.version,h.isBigVersionUpgrade(o,this.option.documentInfo.dataVersion)?[4,this.localChangesBackupToDatabase(e,a,!0,o)]:[3,2];case 1:return i.sent(),[2,[]];case 2:return[2,e]}}))}))},e.prototype.handleLocalChangesToBackUp=function(e){return o(this,void 0,void 0,(function(){var t,n,r;return i(this,(function(o){switch(o.label){case 0:return t=s(e,1),n=t[0],r=n.version,[4,this.localChangesBackupToDatabase(e,r)];case 1:return o.sent(),[2]}}))}))},e.prototype.localChangesBackupToDatabase=function(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=this.option.documentInfo.dataVersion),o(this,void 0,void 0,(function(){var o,a,s,c,l,u;return i(this,(function(i){switch(i.label){case 0:return o={dataVersion:r,docType:this.option.documentInfo.docType,secretId:this.option.documentInfo.secretId,globalPadId:this.option.documentInfo.globalPadId,uid:this.option.documentInfo.uid},a={version:t,documentInfo:o},[4,(s=new g.OfflineEditBackUp(a)).init()];case 1:return(c=i.sent()).error?(h.logger.warn(this.tag,"offlineEditBackUp init error: "+c.error.message+", "+c.error.stack),[2,!1]):(h.logger.info(this.tag,"offlineEditBackUp localChanges, dver:"+r+", localChanges.length:"+e.length),[4,s.deleteAndUpsertChanges({types:f.DEFAULT_DATA_TYPES},e)]);case 2:if(l=i.sent(),!n||!l.data)return[3,6];i.label=3;case 3:return i.trys.push([3,5,,6]),[4,this.localChangesHelper.deleteChanges({types:f.DEFAULT_DATA_TYPES})];case 4:return i.sent(),[3,6];case 5:return u=i.sent(),h.logger.warn(this.tag,"localChangesBackupToDatabase deleteChanges error:"+(null==u?void 0:u.message)+", "+(null==u?void 0:u.stack)),[3,6];case 6:return[4,s.dispose()];case 7:return i.sent(),[2,l.data]}}))}))},e.prototype.beginSyncing=function(){var e,t,n;null===(e=this.delegate.resubmit)||void 0===e||e.setDisableEdit(),h.isMobile()?this.snackbarInstance=u.default.show({message:null===(t=this.delegate.resubmit)||void 0===t?void 0:t.offlineDataSyncing,type:"info",autoClose:!1,closable:!1}):this.snackbarInstance=l.default.show({message:null===(n=this.delegate.resubmit)||void 0===n?void 0:n.offlineDataSyncing,type:"info",autoClose:!1,closable:!1,style:{zIndex:3998},id:h.OFFLINE_TIPS_CONTAINER_ID})},e.prototype.hideSyncingTips=function(){var e,t=this;null===(e=this.delegate.resubmit)||void 0===e||e.setEditAble();var n=setTimeout((function(){var e,r;null===(r=null===(e=t.snackbarInstance)||void 0===e?void 0:e.close)||void 0===r||r.call(e),clearTimeout(n)}),1e3)},e.prototype.printLocalChanges=function(e){var t,n=this;try{null===(t=e.forEach)||void 0===t||t.call(e,(function(e){h.logger.info(n.tag,"taskId:"+e.taskId+", changesetString:"+e.changesetString)}))}catch(e){h.logger.warn(this.tag,"printLocalChanges error:"+(null==e?void 0:e.message))}},e}();t.default=v},49015:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateChangesHelper=void 0;var i=n(59475),a=n(4666),s=function(){function e(e,t){this.version=e,this.delegate=t,this.tag="OfflineUpdateChangesHelper"}return e.prototype.updateChanges=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return a.logger.info(this.tag,"updateChanges changes.length:"+e.length),(null==e?void 0:e.length)?(t=e[0].version+1,[4,this.getMissToFollow(e,t,this.version)]):[2,new i.Result(void 0,[])];case 1:return[2,n.sent()]}}))}))},e.prototype.getMissToFollow=function(e,t,n){return r(this,void 0,void 0,(function(){var r,s,c,l=this;return o(this,(function(o){switch(o.label){case 0:a.logger.info(this.tag,"getMissToFollow fromVersion:"+t+", toVersion"+n+" "),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.delegate.resubmit.getNewChanges(t,n)];case 2:return r=o.sent(),s=e,null==r||r.forEach((function(e){(null==s?void 0:s.length)&&s[0].taskId===Number(e.commitId)?(s.forEach((function(t){t.version=e.newRev})),s.shift()):s=l.delegate.resubmit.follow(s,e)})),a.logger.info(this.tag,"getMissToFollow end, toFollowChanges.length:"+s.length),[2,new i.Result(void 0,s)];case 3:return c=o.sent(),a.logger.warn(this.tag,"getMissToFollow getNewChanges error:"+c.message),[2,new i.Result(c,void 0)];case 4:return[2]}}))}))},e}();t.UpdateChangesHelper=s},57026:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(59475);Object.defineProperty(t,"Result",{enumerable:!0,get:function(){return i.Result}}),o(n(80985),t),o(n(10638),t);var a=n(53382);Object.defineProperty(t,"DEFAULT_DATA_TYPES",{enumerable:!0,get:function(){return a.DEFAULT_DATA_TYPES}}),o(n(22923),t),o(n(15746),t);var s=n(74705);Object.defineProperty(t,"OFFLINE_EDIT_CODE",{enumerable:!0,get:function(){return s.OFFLINE_EDIT_CODE}}),Object.defineProperty(t,"OFFLINE_TIPS_CONTAINER_ID",{enumerable:!0,get:function(){return s.OFFLINE_TIPS_CONTAINER_ID}})},95085:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},40956:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CommitFailReason=void 0,function(e){e.None="None",e.Network="Network",e.ServerVerity="ServerVerity"}(t.CommitFailReason||(t.CommitFailReason={}))},5777:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},71111:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(5777),t),o(n(49721),t)},49721:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},96262:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.onOfflineEditDatabaseInitFinishEvent=t.onAfterContentChangeEvent=t.onBeforeContentChangeEvent=t.OfflineEditDatabaseInitFinishEventEmitter=t.AfterContentChangeEventEmitter=t.BeforeContentChangeEventEmitter=void 0;var r=n(36023),o=new r.Emitter;t.BeforeContentChangeEventEmitter=o;var i=new r.Emitter;t.AfterContentChangeEventEmitter=i;var a=new r.Emitter;t.OfflineEditDatabaseInitFinishEventEmitter=a;var s=o.event;t.onBeforeContentChangeEvent=s;var c=i.event;t.onAfterContentChangeEvent=c;var l=a.event;t.onOfflineEditDatabaseInitFinishEvent=l},5503:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},80985:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(95085),t),o(n(40956),t),o(n(5503),t),o(n(26145),t),o(n(56617),t),o(n(71111),t),o(n(92537),t),o(n(69780),t),o(n(90218),t),o(n(96262),t)},92537:function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.MutexLockSource=void 0,function(e){e.EDIT="edit",e.LIST="list"}(n||(n={})),t.MutexLockSource=n},26145:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},90218:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.IOfflineEditStatus=void 0,function(e){e.OFFLINE_EDIT_UNKNOWN="OFFLINE_EDIT_UNKNOWN",e.OFFLINE_EDIT_READONLY_DOCUMENT="OFFLINE_EDIT_READONLY_DOCUMENT",e.OFFLINE_EDIT_DELEGATE_NO_IMPLEMENTS="OFFLINE_EDIT_DELEGATE_NO_IMPLEMENTS",e.OFFLINE_EDIT_DATABASE_UNAVAILABLE="OFFLINE_EDIT_DATABASE_UNAVAILABLE",e.OFFLINE_EDIT_DATABASE_INIT="OFFLINE_EDIT_DATABASE_INIT",e.OFFLINE_EDIT_GET_LOCAL_CHANGES_FAIL="OFFLINE_EDIT_GET_LOCAL_CHANGES_FAIL",e.OFFLINE_EDIT_PRECHECK="OFFLINE_EDIT_PRECHECK",e.OFFLINE_EDIT_NO_DATA="OFFLINE_EDIT_NO_DATA",e.OFFLINE_EDIT_MULTI_VERSION="OFFLINE_EDIT_MULTI_VERSION",e.OFFLINE_EDIT_SUCCESS="OFFLINE_EDIT_SUCCESS",e.OFFLINE_EDIT_LOCAL_CHANGES_APPLY_SUCCESS="OFFLINE_EDIT_LOCAL_CHANGES_APPLY_SUCCESS",e.OFFLINE_EDIT_LOCAL_CHANGES_APPLY_FAIL="OFFLINE_EDIT_LOCAL_CHANGES_APPLY_FAIL",e.OFFLINE_EDIT_LOCAL_VERSION_EQUAL_NEW_VERSION="OFFLINE_EDIT_LOCAL_VERSION_EQUAL_NEW_VERSION",e.OFFLINE_EDIT_LOCAL_VERSION_GREATER_THAN_LAST_VERSION="OFFLINE_EDIT_LOCAL_VERSION_GREATER_THAN_LAST_VERSION",e.OFFLINE_EDIT_LOCAL_VERSION_GREATER_THAN_NEW_VERSION="OFFLINE_EDIT_LOCAL_VERSION_GREATER_THAN_NEW_VERSION",e.OFFLINE_EDIT_LOCAL_CHANGES_LESS_THAN_NEW_VERSION="OFFLINE_EDIT_LOCAL_CHANGES_LESS_THAN_NEW_VERSION",e.OFFLINE_EDIT_GET_CHANGES_FAIL="OFFLINE_EDIT_GET_CHANGES_FAIL",e.OFFLINE_EDIT_FOLLOW_ERROR="OFFLINE_EDIT_FOLLOW_ERROR",e.OFFLINE_EDIT_BATCH_COMMIT_NO_USE="OFFLINE_EDIT_BATCH_COMMIT_NO_USE",e.OFFLINE_EDIT_BATCH_SUCCESS="OFFLINE_EDIT_BATCH_SUCCESS",e.OFFLINE_EDIT_BATCH_PAYLOAD_TOO_LARGE="OFFLINE_EDIT_BATCH_PAYLOAD_TOO_LARGE",e.OFFLINE_EDIT_BATCH_FAIL_BY_NETWORK="OFFLINE_EDIT_BATCH_FAIL_BY_NETWORK",e.OFFLINE_EDIT_BATCH_FAIL_BY_SERVER="OFFLINE_EDIT_BATCH_FAIL_BY_SERVER"}(t.IOfflineEditStatus||(t.IOfflineEditStatus={}))},69780:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},56617:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.ResubmitResult=void 0;var r=n(58637),o=["OFFLINE_EDIT_UNKNOWN","OFFLINE_EDIT_MULTI_VERSION","OFFLINE_EDIT_BATCH_FAIL_BY_SERVER","OFFLINE_EDIT_GET_CHANGES_FAIL","OFFLINE_EDIT_FOLLOW_ERROR","OFFLINE_EDIT_LOCAL_CHANGES_APPLY_FAIL","OFFLINE_EDIT_LOCAL_VERSION_GREATER_THAN_NEW_VERSION"],i=function(){function e(e,t,n){void 0===n&&(n=r.OFFLINE_EDIT_CODE.SUCCESS),this.status=e,this.error=t,this.retCode=n,this.isSuccess||n||(this.retCode=r.OFFLINE_EDIT_CODE.RESUBMIT_FAIL)}return Object.defineProperty(e.prototype,"isSuccess",{get:function(){return!o.includes(this.status)},enumerable:!1,configurable:!0}),e}();t.ResubmitResult=i},10638:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.OfflineEditBackUp=void 0;var i=n(7386),a=n(59475),s=n(58637),c=n(38098),l=n(53382),u=n(80985),d=function(){function e(e){this.option=e,this.tag="OfflineEditBackUp"}return e.prototype.init=function(){return r(this,void 0,void 0,(function(){var e,t;return o(this,(function(n){switch(n.label){case 0:return e={databaseName:i.DB_NAME_BACKUP,disabled:!0,type:s.isSupportClientDB()?i.DBEngineType.nativeDB:i.DBEngineType.indexDB},this.storageManager=new i.StorageManager(e),this.localChangesHelper=new c.LocalChangesHelper(this.storageManager.storage,this.option.documentInfo),[4,this.storageManager.init()];case 1:return t=n.sent(),this.isStorageAvailable=t,t?(s.logger.info(this.tag,"init finish. isStorageAvailable:"+this.isStorageAvailable),[2,new u.ResubmitResult("OFFLINE_EDIT_DATABASE_INIT")]):[2,new u.ResubmitResult("OFFLINE_EDIT_DATABASE_UNAVAILABLE")]}}))}))},e.prototype.dispose=function(){return r(this,void 0,void 0,(function(){return o(this,(function(e){return this.storageManager.dispose(),[2,!0]}))}))},e.prototype.canWrite=function(){return this.isStorageAvailable},e.prototype.getChanges=function(e){return void 0===e&&(e={types:l.DEFAULT_DATA_TYPES}),r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:if(!this.canWrite())return[2,s.canNotRead()];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.localChangesHelper.getChanges(e)];case 2:return[2,n.sent()];case 3:return t=n.sent(),this.isStorageAvailable=!1,[2,new a.Result(t)];case 4:return[2]}}))}))},e.prototype.upsertChanges=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:if(!this.canWrite())return s.logger.warn(this.tag,"upsertChanges can not write."),[2,s.canNotWrite()];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.localChangesHelper.upsertChanges(e)];case 2:return[2,n.sent()];case 3:return t=n.sent(),s.logger.error(this.tag,"upsertChanges error: "+t.message+", , "+t.stack+"."),this.isStorageAvailable=!1,[2,new a.Result(t)];case 4:return[2]}}))}))},e.prototype.deleteChanges=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:if(!this.canWrite())return s.logger.warn(this.tag,"deleteChanges can not write."),[2,s.canNotWrite("isStorageAvailable:"+this.isStorageAvailable)];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.localChangesHelper.deleteChanges(e)];case 2:return[2,n.sent()];case 3:return t=n.sent(),this.isStorageAvailable=!1,[2,new a.Result(t)];case 4:return[2]}}))}))},e.prototype.deleteAndUpsertChanges=function(e,t){return r(this,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:if(!this.canWrite())return s.logger.warn(this.tag,"deleteAndUpsertChanges can not write."),[2,s.canNotWrite()];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.localChangesHelper.deleteAndUpsertChanges(e,t)];case 2:return[2,r.sent()];case 3:return n=r.sent(),this.isStorageAvailable=!1,[2,new a.Result(n)];case 4:return[2]}}))}))},e}();t.OfflineEditBackUp=d},15746:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.OfflineEdit=void 0;var l=n(53382),u=n(58637),d=n(80985),p=c(n(24212)),f=n(68169),_=n(24557),h=function(e){function t(t,n){var r,o=e.call(this,t,n)||this;return o.tag="OfflineEdit",o.beforeContentChange=function(){var e;null===(e=o.offlineTipsHelper)||void 0===e||e.contentChange()},o.afterContentChange=function(){u.StoredFlagUtil.setItem(o.option.documentInfo,!0),o.delayReleaseLock()},((null===(r=o.option.config)||void 0===r?void 0:r.isUserTips)||o.delegate.networkStatusSwitch)&&(o.offlineTipsHelper=new f.OfflineTipsHelper(n,o)),d.onBeforeContentChangeEvent(o.beforeContentChange),d.onAfterContentChangeEvent(o.afterContentChange),o}return o(t,e),t.prototype.enterOffline=function(e){var t;this.delegate.networkStatusSwitch?null===(t=this.offlineTipsHelper)||void 0===t||t.enterOffline(e):u.logger.warn(this.tag,"tipsDelegate is undefined, please implements")},t.prototype.enterOnline=function(){var e;this.delegate.networkStatusSwitch?null===(e=this.offlineTipsHelper)||void 0===e||e.enterOnline():u.logger.warn(this.tag,"tipsDelegate is undefined, please implements")},t.prototype.init=function(t){var n;return void 0===t&&(t=!1),a(this,void 0,void 0,(function(){var r,o;return s(this,(function(i){switch(i.label){case 0:return!1===this.delegate.canEdit()?(e.prototype.init.call(this,t),this.isResubmitFinish=!0,u.Reporter.reportStatus({attrName:"OFFLINE_EDIT_READONLY_DOCUMENT",status:0}),[2,new d.ResubmitResult("OFFLINE_EDIT_READONLY_DOCUMENT")]):(r=this.precheck(),u.Reporter.reportStatus({attrName:"OFFLINE_EDIT_PRECHECK",status:r?0:1}),!1===r?(e.prototype.init.call(this,t),this.isResubmitFinish=!0,[2,new d.ResubmitResult("OFFLINE_EDIT_NO_DATA")]):[4,e.prototype.init.call(this,t)]);case 1:return o=i.sent(),(null===(n=this.option.config)||void 0===n?void 0:n.isUseResubmit)?[4,this.resubmit()]:[3,3];case 2:return[2,i.sent()];case 3:return[2,o]}}))}))},t.prototype.disenable=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return u.logger.warn(this.tag,"disenable, reason:"+e),[4,this.release()];case 1:return t.sent(),this.isStorageAvailable=!1,this.storageManager.storage.close(),[2]}}))}))},t.prototype.precheck=function(){var e=u.precheck(this.option.documentInfo);return u.logger.info(this.tag,"precheck: "+e),e},t.prototype.release=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return this.mutexLockHelper.isLocked()?[4,this.mutexLockHelper.release()]:[3,3];case 1:return e.sent(),[4,this.hasLocalChanges()];case 2:e.sent()||u.StoredFlagUtil.setItem(this.option.documentInfo,!1),e.label=3;case 3:return[2]}}))}))},t.prototype.resubmit=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return this.delegate.canEdit()?this.delegate.resubmit?this.canRead()?[4,new p.default(this.option,this.delegate,this.localChangesHelper).resubmit()]:[2,new d.ResubmitResult("OFFLINE_EDIT_DATABASE_UNAVAILABLE",new Error("database is unavailable, can not resubmit."))]:[2,new d.ResubmitResult("OFFLINE_EDIT_DELEGATE_NO_IMPLEMENTS",new Error("delegate.restore is undefined, please implements"))]:[2,new d.ResubmitResult("OFFLINE_EDIT_READONLY_DOCUMENT")];case 1:return[2,e.sent()]}}))}))},t.prototype.resetReleaseLockTimer=function(){this.releaseLockTimer&&clearInterval(this.releaseLockTimer)},t.prototype.delayReleaseLock=function(){var e=this;this.resetReleaseLockTimer(),this.mutexLockHelper.isLocked()&&(this.releaseLockTimer=setInterval((function(){return a(e,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.hasLocalChanges()];case 1:return e.sent()?[2]:[4,this.mutexLockHelper.release()];case 2:return e.sent(),this.resetReleaseLockTimer(),u.StoredFlagUtil.setItem(this.option.documentInfo,!1),[2]}}))}))}),6e4))},i([_.OutputResultDecorate()],t.prototype,"init",null),i([_.ResubmitDecorate(),_.OutputResultDecorate()],t.prototype,"resubmit",null),t}(l.OfflineEditBase);t.OfflineEdit=h},22923:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},74705:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.OFFLINE_TIPS_CONTAINER_ID=t.canNotRead=t.canNotWrite=t.COMMANDS_FORMAT=t.OFFLINE_EDIT_MODEL_VERSION=t.OFFLINE_EDIT_CODE=void 0;var r,o,i,a=n(59475);!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.RESUBMIT_FAIL=73001]="RESUBMIT_FAIL"}(r||(r={})),t.OFFLINE_EDIT_CODE=r,function(e){e.DOC_JSON="1.0",e.DOC_PROTOBUF="2.0"}(o||(o={})),t.OFFLINE_EDIT_MODEL_VERSION=o,function(e){e[e.JSON=0]="JSON",e[e.PROTOBUF=1]="PROTOBUF"}(i||(i={})),t.COMMANDS_FORMAT=i,t.canNotWrite=function(e){return new a.Result(new Error("can’t write by "+e))},t.canNotRead=function(){return new a.Result(new Error("read fail，database can’t use."))},t.OFFLINE_TIPS_CONTAINER_ID="OFFLINE_TIPS_CONTAINER_ID"},67212:function(e,t,n){var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a};Object.defineProperty(t,"__esModule",{value:!0}),t.getBatchCommitUrlParameter=t.isMobile=t.getUrlParameter=t.isBigVersionUpgrade=t.isDatabaseAvailable=t.isOfflineDebug=t.isSupportClientDB=void 0;var o=n(31072),i=n(86667),a=n(49790),s=n(74705);t.isSupportClientDB=function(){var e;try{e=localStorage.getItem("OFFLINE_DB_SWITCH")}catch(t){e="0"}if("0"===e)return!1;var t=navigator.userAgent.match(/_tdocFlag\/(\d+)/);return!!(null==t?void 0:t[1])&&2&parseInt(t[1],10)},t.isOfflineDebug=function(){return"1"===o.getQuery("offline-debug")},t.isDatabaseAvailable=function(){var e=new i.UserAgent;return!(e.isElectronTencentDocsClient&&!e.isElectronTencentDocsClientVersionAboveOrEqual("2.2.29"))},t.isBigVersionUpgrade=function(e,t){try{if(e&&t&&r(e.split("."),1)[0]!==r(t.split("."),1)[0])return!0}catch(e){return!1}return!1},t.getUrlParameter=function(e){var t,n,r,o=window.location.search.substring(1);if(o)for(t=o.split("&"),n=0;n<t.length;n++)if((r=t[n].split("="))[0]===e)return r[1];return null},t.isMobile=function(){return/(mobile)/i.test(navigator.userAgent)||/(android)/i.test(navigator.userAgent)},t.getBatchCommitUrlParameter=function(e,t){return t.docType===a.DOCUMENT_TYPE.doc&&e.modelVersion===s.OFFLINE_EDIT_MODEL_VERSION.DOC_PROTOBUF?"commandsFormat="+s.COMMANDS_FORMAT.PROTOBUF:""}},58637:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(67212),t),o(n(4666),t),o(n(48306),t),o(n(95906),t),o(n(74705),t),o(n(19209),t),o(n(58046),t)},4666:function(e,t,n){var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.logger=t.webLogReport=void 0;var i=function(){function e(){}return e.prototype.debug=function(){for(var e,t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];null===(t=null===(e=this.log())||void 0===e?void 0:e.debug)||void 0===t||t.call.apply(t,o([e],n))},e.prototype.info=function(){for(var e,t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];null===(t=null===(e=this.log())||void 0===e?void 0:e.info)||void 0===t||t.call.apply(t,o([e],n))},e.prototype.warn=function(){for(var e,t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];null===(t=null===(e=this.log())||void 0===e?void 0:e.warn)||void 0===t||t.call.apply(t,o([e],n))},e.prototype.error=function(){for(var e,t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];null===(t=null===(e=this.log())||void 0===e?void 0:e.error)||void 0===t||t.call.apply(t,o([e],n))},e.prototype.log=function(){var e;return null!==(e=n.g.log)&&void 0!==e?e:console},e}();t.webLogReport=function(e){var t,n,r=Date.now(),o=r-18e5;null===(n=null===(t=window.log)||void 0===t?void 0:t.report)||void 0===n||n.call(t,e,{query:{startTs:o,endTs:r}})};var a=new i;t.logger=a},95906:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.IReportStatus=void 0,function(e){e[e.SUCCESS=0]="SUCCESS",e[e.FAILED=1]="FAILED",e[e.TIMEOUT=2]="TIMEOUT"}(t.IReportStatus||(t.IReportStatus={}))},48306:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.Reporter=void 0;var r=n(38298),o="offline",i=function(){function e(){}return e.init=function(e){var t;this.documentType=null!==(t=e.documentType)&&void 0!==t?t:"unkown"},e.reportStatus=function(e){r.zzsStatus({attrid:e.attrName,status:e.status,errmsg:e.errorMessage,dimensions:[this.documentType],project:o})},e.reportValue=function(e){e.value&&r.zzsValue({attrid:e.attrName,value:e.value,dimensions:[this.documentType],project:o})},e}();t.Reporter=i},19209:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.precheck=t.StoredFlagUtil=void 0;var r=n(4666),o=function(){function e(){}return e.setItem=function(t,n){try{localStorage.setItem(e.key(t),String(n))}catch(e){r.logger.warn("StoredFlagUtil setItem error:"+(null==e?void 0:e.message)+", "+(null==e?void 0:e.stack))}},e.hasChanges=function(t){try{return localStorage.getItem(e.key(t))}catch(e){return String(!0)}},e.key=function(e){return e.secretId+"_"+e.uid+"_offline_has_local_changes_flag"},e}();t.StoredFlagUtil=o,t.precheck=function(e){return o.hasChanges(e)!==String(!1)}},58046:function(e,t){var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.applyFunctionTimeout=void 0,t.applyFunctionTimeout=function(e,t){return n(this,void 0,void 0,(function(){return r(this,(function(n){return[2,Promise.race([e,new Promise((function(e){setTimeout((function(){e(t)}),3e4)}))])]}))}))}},61535:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.TOAST_TRANSITION_DURATION=void 0;var r=n(85556),o=n(56630).h,i=r.__importStar(n(87363)),a=r.__importDefault(n(61533)),s=r.__importDefault(n(32230)),c=n(89805);t.TOAST_TRANSITION_DURATION=200;var l=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(n,e),n.prototype.componentDidMount=function(){console.warn("PC端Toast组件不符合交互规则，为避免破坏性更新，当前版本仍将提供。未来会移除此组件，请尽量使用Snackbar组件。")},n.prototype.render=function(){var e,n,r=this.props,i=r.prefixCls,l=r.className,u=r.style,d=r.children,p=r.content,f=r.visible,_=r.mask,h=r.position,m=s.default(i,l,i+"-"+h,((e={})[i+"-hidden"]=!f,e)),g=s.default(i+"-mask",((n={})[i+"-mask-display"]=_,n[i+"-mask-hidden"]=!f,n));return c.decideKeepDom.call(this,t.TOAST_TRANSITION_DURATION,f)?a.default.createPortal(o("div",{className:g},o("div",{className:m,style:u},d||p)),document.body):null},n}(i.Component);t.default=l,l.defaultProps={prefixCls:"dui-toast",visible:!1,content:"",mask:!1,position:"top"}},89311:function(e,t,n){var r=n(85556),o=r.__importDefault(n(61535));o.default,n(36226).D("components/Toast/style/index.css",'@-webkit-keyframes dui-toast-slide-in-top{0%{opacity:0;-webkit-transform:scaleX(1) translateY(-50px);transform:scaleX(1) translateY(-50px)}to{opacity:1;-webkit-transform:scaleX(1) translate(0);transform:scaleX(1) translate(0)}}@keyframes dui-toast-slide-in-top{0%{opacity:0;-webkit-transform:scaleX(1) translateY(-50px);transform:scaleX(1) translateY(-50px)}to{opacity:1;-webkit-transform:scaleX(1) translate(0);transform:scaleX(1) translate(0)}}@-webkit-keyframes dui-toast-slide-in-bottom{0%{opacity:0;-webkit-transform:scaleX(1) translateY(50px);transform:scaleX(1) translateY(50px)}to{opacity:1;-webkit-transform:scaleX(1) translate(0);transform:scaleX(1) translate(0)}}@keyframes dui-toast-slide-in-bottom{0%{opacity:0;-webkit-transform:scaleX(1) translateY(50px);transform:scaleX(1) translateY(50px)}to{opacity:1;-webkit-transform:scaleX(1) translate(0);transform:scaleX(1) translate(0)}}@-webkit-keyframes dui-toast-fade-in{0%{opacity:0}to{opacity:1}}@keyframes dui-toast-fade-in{0%{opacity:0}to{opacity:1}}[data-dui-0-134-2~="dui-toast"]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;padding:10px 20px;background:rgba(0,0,0,.8);border-radius:2px;font-size:14px;color:#fff;-webkit-transition:all .2s ease-out;transition:all .2s ease-out}[data-dui-0-134-2~="dui-toast-top"][data-dui-0-134-2~="dui-toast-hidden"]{opacity:0;-webkit-transform:scaleX(1) translateY(-50px);transform:scaleX(1) translateY(-50px)}[data-dui-0-134-2~="dui-toast-top"]{margin-top:100px;-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;-webkit-animation:dui-toast-slide-in-top .2s ease-out;animation:dui-toast-slide-in-top .2s ease-out}[data-dui-0-134-2~="dui-toast-bottom"][data-dui-0-134-2~="dui-toast-hidden"]{opacity:0;-webkit-transform:scaleX(1) translateY(50px);transform:scaleX(1) translateY(50px)}[data-dui-0-134-2~="dui-toast-bottom"]{margin-bottom:100px;-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;-webkit-animation:dui-toast-slide-in-bottom .2s ease-out;animation:dui-toast-slide-in-bottom .2s ease-out}[data-dui-0-134-2~="dui-toast-mask"]{position:fixed;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;z-index:10000;top:0;left:0;right:0;bottom:0;pointer-events:none;-webkit-transition:all .2s linear;transition:all .2s linear}[data-dui-0-134-2~="dui-toast-mask-display"]{background:rgba(0,0,0,.15);pointer-events:auto;-webkit-animation:dui-toast-fade-in .2s linear;animation:dui-toast-fade-in .2s linear}[data-dui-0-134-2~="dui-toast-mask-hidden"]{opacity:0;visibility:hidden}');var i=r.__importDefault(n(34469));o.default.show=i.default,t.ZP=o.default},34469:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(85556).__importStar(n(61535)),o=n(92437);t.default=function(e){return o.showWithTransition({Component:r.default,transitionDuration:r.TOAST_TRANSITION_DURATION,autoClose:!0,props:e,contexts:e.contexts})}},9517:function(e,t,n){n.d(t,{VF:function(){return re}});var r=n(79707),o=n(86667),i=n.n(o),a=n(5593),s=n(11466),c=n(93988),l=n.n(c),u=n(27505),d=n(5450),p=n.n(d),f=n(81568),_=n(38298),h=n(59834),m=n(90476),g=n(87675),v=(a.default.default||a.default).getInstance().getConfig('npm["@tencent/tencent_doc_net"]'),b=window.location.host,y=(null==v?void 0:v.TOB_HOST)||"doc.weixin.qq.com",w=new RegExp((null==v?void 0:v.TOB_HOST_REGEXP)||"^doc\\.weixin\\.qq\\.com","i");null==v||v.esLogUrl;var E,C,T=Object.values((null==v?void 0:v.REPORT_URLS)||["report.idqqimg.com","aegis.qq.com","report.url.cn","access.toggle.qq.com","event.toggle.qq.com"]),x=Object.values((null==v?void 0:v.WEBSOCKET_URLS)||["docs.qq.com/websocket"]),S=Object.values((null==v?void 0:v.OTHER_URLS)||["gz.apigw.tencentcs.com","otheve.beacon.qq.com","casestudy.html5.qq.com","docrp.weixin.qq.com"]),I=Object.values((null==v?void 0:v.PRIVATE_REPORT_URLS)||["report.idqqimg.com","aegis.qq.com","report.url.cn","access.toggle.qq.com","event.toggle.qq.com","docrp.weixin.qq.com/report/","at.idqqimg.com/node/weblog"]),k=["data_report_collection"].concat((0,r.Z)(T)),R=(0,r.Z)(x),A=[].concat((0,r.Z)(S),[".json"]),O=["data_report_collection"].concat((0,r.Z)(I)),L=[].concat(["fcg_get_multiple_strategy","cgi-bin/online_docs/wxqrcode","cgi-bin/online_docs/polling","docs/components/assets.v4.json","myqcloud.com"],(0,r.Z)(k),(0,r.Z)(R),(0,r.Z)(A)),M=[11e3,11005,1e5,12105,12100,60006,-20002,-1001];function N(){return"undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0}function D(e,t){var n=e.split("?");if(n.length>=2){var r=encodeURIComponent(t)+"=",o=n[1].split(/[&;]/g);console.warn(o,n[1],n[1].split(/[&;]/g));for(var i=o.length;i-- >0;)-1!==o[i].lastIndexOf(r,0)&&o.splice(i,1);return e=n[0]+(o.length>0?"?"+o.join("&"):"")}return e}function P(e,t){var n,r,o=function(e){return"string"==typeof e?e:e.search}(t||(null===(n=N())||void 0===n||null===(r=n.location)||void 0===r?void 0:r.href)||"").match(new RegExp("(\\?|&)"+e+"=([^&]*)(#|&|$)"));return o?decodeURIComponent(o[2]):""}var F,B=null!==(E=null===(C=window.global_multi_user)||void 0===C?void 0:C.queryUserIndex)&&void 0!==E?E:P("u");function U(){var e;return(null===(e=window.global_multi_user)||void 0===e?void 0:e.nowUserIndex)||B||window.nowUserIndex}!function(e){e.UPDATE_USER_INDEX="account:update-user-index",e.DELETE_USER_INDEX="account:delete-user-index"}(F||(F={}));var H=!1;function j(){navigator.serviceWorker&&setTimeout((function(){var e;U()&&(W(),void 0!==document.hidden?e="visibilitychange":void 0!==document.msHidden?e="msvisibilitychange":void 0!==document.webkitHidden&&(e="webkitvisibilitychange"),document.addEventListener(e,(function(){"visible"===document.visibilityState&&W()})))}),1e3)}function W(){var e,t,n,r;H||null===(e=navigator.serviceWorker)||void 0===e||null===(t=e.controller)||void 0===t||t.postMessage({type:F.UPDATE_USER_INDEX,data:{url:"https://".concat(b).concat(location.pathname),userIndex:U(),userType:(null===(r=window.global_multi_user)||void 0===r?void 0:r.utype)||"",uid:(null===(n=window.global_multi_user)||void 0===n?void 0:n.uid)||""}})}function V(e){var t=!1;return L.forEach((function(n){e.indexOf(n)>-1&&(t=!0)})),t}function z(e){return!["blob","document","arraybuffer"].includes(e)}function G(e){var t=function(e){return e.indexOf("user_info?")>0&&e.indexOf("u=login")>0}(e),n=P("u",e);if(t||e&&n||V(e))return e;var r=window.nowUserIndex,o=e,i=e.split(/(\?|#)/),a=i[0],s=i[2]?"&"+i[2]:"";return J()&&(o="".concat(a,"?u=").concat(r).concat(s)),o}function Y(){var e,t=location.href,n="",r=P("debug");B&&"1"!==r&&(e=location.pathname,!/^\/(desktop|mall)/i.test(e))&&(n=D(t,"u"),window.history.replaceState(null,"",n))}function q(e){if(e){var t,n,r,o,i,a,s,c,l,u,d=(t="u",n=e,o=null===(r=N())||void 0===r?void 0:r.location,i=o.host,a=o.search,s=o.pathname,c=o.hash,l="".concat(a,"&").concat(t,"=").concat(n),u=a.indexOf("?")>=0?l:"?".concat(l),"https://".concat(i).concat(s).concat(u).concat(c));window.history.replaceState(null,"",d)}}function Z(){window.global_multi_user||(window.global_multi_user={}),function(){var e;(null===(e=window.global_multi_user)||void 0===e?void 0:e.nowUserIndex)&&(window.global_multi_user.changeByServer=!0)}();var e=U();return window.nowUserIndex=e,!(!e&&J()&&(console.error("没有u，需要重新登录"),1))}function J(){return e=new RegExp("(?:^|;+|\\s+)SID=([^;]*)"),t=null,null!=(n=N())&&n.document&&(t=n.document.cookie.match(e)),!(!t||!t[1]);var e,t,n}function K(){console.info("----- re add user index");var e=location.href;setTimeout((function(){var t,n;P("u",e)||null!==(t=navigator.serviceWorker)&&void 0!==t&&null!==(n=t.controller)&&void 0!==n&&n.scriptURL.includes("service-worker.js")||q(U())}),1e3)}function Q(e){var t,n,r;if(null!==(t=window)&&void 0!==t&&t.log){var o=e.type,i=e.options;null===(n=window)||void 0===n||null===(r=n.log)||void 0===r||r[o](i)}}l().setCallback((function(e){e&&10001===e.code&&(H=!0)}));var X,$=b===y;function ee(e){try{return function(e){var t,n,r,o,i;return void 0!==(null==e?void 0:e.retcode)?e.retcode:void 0!==(null==e?void 0:e.code)?e.code:void 0!==(null==e?void 0:e.retCode)?e.retCode:void 0!==(null==e||null===(t=e.head)||void 0===t?void 0:t.ret)?e.head.ret:void 0!==(null==e||null===(n=e.header)||void 0===n?void 0:n.code)?e.header.code:void 0!==(null==e||null===(r=e.result)||void 0===r||null===(o=r.etype)||void 0===o?void 0:o.retcode)?e.result.etype.retcode:void 0!==(null==e||null===(i=e.param)||void 0===i?void 0:i.retcode)?e.param.retcode:0}("string"==typeof e?JSON.parse(e):e)}catch(e){return 0}}function te(e,t){var n,r;if(!$){var o=e&&e.responseURL?e.responseUrl:t,i=(null==e||null===(n=e.target)||void 0===n||null===(r=n.getResponseHeader)||void 0===r?void 0:r.call(n,"content-type"))||"";if(!V(o)&&o&&["application/json; charset=UTF-8","text/plain; charset=utf-8","application/json","application/x-javascript; charset=utf-8"].includes(i)){var a,c;if(200!==e.status)return(0,_.monitor)(35469267),null===(a=window)||void 0===a||null===(c=a.log)||void 0===c||c.log("网络拦截：status:".concat(e.status," ,url:").concat(o)),void(0,_.tdw)({opername:"multi",module:"multi-net",action:"multi-cgi-result",ver1:Date.now(),ver2:e.status,ver3:o,ver4:navigator.userAgent,ver5:JSON.stringify(e.response)});(0,_.monitor)(35469266);try{var l,u;if(0!=ee(e))!function(e){if("string"==typeof e)try{var t;return null!==(t=JSON.parse(e).retcode)&&void 0!==t?t:"000002"}catch(e){return"000001"}var n;"object"===(0,s.Z)(e)&&(null!==(n=e.retcode)&&void 0!==n||e.ret)}(e.response),(0,_.monitor)(35469268),null===(l=window)||void 0===l||null===(u=l.log)||void 0===u||u.log("网络拦截: url:".concat(o," ,response:").concat(JSON.stringify(e.response))),(0,_.tdw)({opername:"multi",module:"multi-net",action:"multi-cgi-result",ver1:Date.now(),ver2:e.status,ver3:o,ver4:navigator.userAgent,ver5:JSON.stringify(e.response)})}catch(e){}}}}!function(e){e[e.PENDING=0]="PENDING",e[e.SUCCESS=1]="SUCCESS",e[e.FAIL=2]="FAIL",e[e.EMPTY=3]="EMPTY"}(X||(X={}));var ne=function(){function e(){(0,h.Z)(this,e),(0,g.Z)(this,"retryNum",0),(0,g.Z)(this,"MAX_RETRY_NUM",3),(0,g.Z)(this,"renewPromise",void 0),(0,g.Z)(this,"defaultPromise",void 0),(0,g.Z)(this,"renewState",X.EMPTY),(0,g.Z)(this,"needRenewUrl",[]),this.defaultPromise=new Promise((function(e){return e()})),this.renewPromise=this.defaultPromise}return(0,m.Z)(e,[{key:"awaitLoginTicket",value:function(e){return this.needRenewUrl.includes(e)?this.renewPromise:this.defaultPromise}},{key:"renewTicket",value:function(e){var t=this.canRenewLoginticket();return t&&this.insertRenewUrl(e),this.renewState!==X.PENDING&&t?(this.renewPromise=this.createRenewPromise(),!0):t}},{key:"renewSuccess",value:function(e){this.needRenewUrl.includes(e)&&(this.retryNum=0,this.renewPromise=this.defaultPromise,this.clearRenewUrl())}},{key:"insertRenewUrl",value:function(e){this.needRenewUrl.includes(e)||this.needRenewUrl.push(e)}},{key:"clearRenewUrl",value:function(){this.needRenewUrl=[]}},{key:"renewFail",value:function(){console.warn("续票失败,重置promise"),Q({type:"warn",options:{msg:"续票失败,重置promise"}}),this.renewPromise=this.defaultPromise,this.clearRenewUrl()}},{key:"createRenewPromise",value:function(){var e=this;return new Promise((function(t,n){e.renewState=X.PENDING;var r=t,o=n;t=function(){e.renewState=X.SUCCESS,r.apply(void 0,arguments)},n=function(){e.renewState=X.FAIL,o.apply(void 0,arguments)};var i=window.tdocs;if(!e.canRenewLoginticket())return console.warn("且连续请求次数达到最大次，就直接rj"),Q({type:"warn",options:{msg:"且连续请求次数达到最大次，就直接rj"}}),void n();e.retryNum++,null==i||i.docLogin().then((function(r){if(!r||r.retcode)return console.warn("续票失败!:",e.retryNum,r.retcode),Q({type:"warn",options:{msg:"续票失败"}}),void e.createRenewPromise().then(t).catch(n);console.warn("single 续票成功, 准备重发请求"),Q({type:"warn",options:{msg:"single 续票成功, 准备重发请求"}}),t()})).catch((function(){e.renewState=X.FAIL,e.renewFail();for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];n(r)}))}))}},{key:"canRenewLoginticket",value:function(){var e;return(null===(e=window.tdocs)||void 0===e?void 0:e.docLogin)&&this.retryNum<this.MAX_RETRY_NUM}}]),e}(),re=new ne,oe=i().isWxWork,ie=window&&window.XMLHttpRequest&&window.XMLHttpRequest.prototype,ae=ie&&ie.open,se=ie&&ie.send,ce=ie&&ie.setRequestHeader,le=window&&window.fetch;function ue(e,t){var n,r=t.args,o=t.shouldSetCurrentUserIndex;t.requestStart;var i=t.readyStateChange;i&&(i.call(e),null!==(n=window)&&void 0!==n&&n.PRIVATE||o&&te(e.response,r[1]))}function de(e){if(window&&"XMLHttpRequest"in window){ie.hijackXmlOpen=ie.open=function(){var t,n=this;n.requestStart=Date.now();for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];n.requestOpenParams=o,n.headerMap=n.headerMap||new Map;var a=null===(t=n.requestOpenParams)||void 0===t?void 0:t[1];if(!pe(a)){n.retryTimes=n.retryTimes||0,n.isLoaded=!1;var s=1,c=o,l=z(this.responseType);e&&l&&(c=o.map((function(e,t){return t===s&&e?G(e):e})));var u=(0,f.Q6)({url:o[1],method:o[0]}),d=u.url;return d!==o[1]&&(c[1]=d),ae.apply(n,c)}console.log("[私有化上报]拦截 XML",a)},ie.hijackXmlSend=ie.send=(0,u.Z)(p().mark((function e(){var r,o,i,a,s,c,l=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!pe(i=null===(r=(o=this).requestOpenParams)||void 0===r?void 0:r[1])){e.next=5;break}return n(o),e.abrupt("return");case 5:for(t(o),a=l.length,s=new Array(a),c=0;c<a;c++)s[c]=l[c];return o.requestSendParams=s,e.prev=8,e.next=11,re.awaitLoginTicket(i);case 11:e.next=18;break;case 13:return e.prev=13,e.t0=e.catch(8),console.warn(e.t0,"续票失败!~~~~~"),Q({type:"warn",options:{msg:"续票失败!~~~~~"}}),e.abrupt("return");case 18:return e.abrupt("return",se.apply(o,s));case 19:case"end":return e.stop()}}),e,this,[[8,13]])}))),ie.setRequestHeader=function(e,t){var n,r,o=this;pe(null===(n=o.requestOpenParams)||void 0===n?void 0:n[1])||(null===(r=o.headerMap)||void 0===r||r.set(e,t),ce.call(o,e,t))};var t=function(t){var n,o=t;o.originOnload=o.originOnload?o.originOnload:o.onload||function(){},o.originOnreadystatechange=o.originOnreadystatechange?o.originOnreadystatechange:o.onreadystatechange||function(){};var i=new Promise((function(e,t){n=e})),a=function(){var e=(0,u.Z)(p().mark((function e(){var t,n,r,a,s,c,l=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=l.length,r=new Array(n),a=0;a<n;a++)r[a]=l[a];return null===(t=o.originOnreadystatechange)||void 0===t||t.call(o,r),e.next=4,i;case 4:s=e.sent,o.isLoaded||200!==o.status||4!==o.readyState||(null===(c=o.originOnload)||void 0===c||c.call(o,s),o.isLoaded=!0);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();o.onload=function(e){var t;null===(t=n)||void 0===t||t(e)},o.onreadystatechange=function(){if(200===o.status&&4===o.readyState){var t;if(u=o.response,fe(null!==(d=ee(u))&&void 0!==d?d:0)){var n=o.requestOpenParams[1];return re.renewTicket(n)&&o.retryTimes<3?(o.retryTimes+=1,console.warn("需要续票,重发请求"),Q({type:"warn",options:{msg:"需要续票,重发请求"}}),o.hijackXmlOpen.apply(o,(0,r.Z)(o.requestOpenParams)),s=o,c=o.headerMap,pe(null===(l=s.requestOpenParams)||void 0===l?void 0:l[1])||null==c||c.forEach((function(e,t){s.setRequestHeader(t,e)})),void o.hijackXmlSend.apply(o,(0,r.Z)(o.requestSendParams))):(Q({type:"warn",options:{msg:"需要续票, 但是已经到重试上限"}}),console.warn("需要续票, 但是已经到重试上限"),void ue(o,{args:o.requestOpenParams,shouldSetCurrentUserIndex:e,requestStart:o.requestStart,readyStateChange:a}))}var i=null===(t=o.requestOpenParams)||void 0===t?void 0:t[1];o.retryTimes=0,re.renewSuccess(i),ue(o,{args:o.requestOpenParams,shouldSetCurrentUserIndex:e,requestStart:o.requestStart,readyStateChange:a})}else ue(o,{args:o.requestOpenParams,shouldSetCurrentUserIndex:e,requestStart:o.requestStart,readyStateChange:a});var s,c,l,u,d}},n=function(e){var t=e;t.send=function(){},t.originOnload=function(){},t.originOnreadystatechange=function(){},t.onload=function(){},t.onreadystatechange=function(){},t.setRequestHeader=function(){}}}}function pe(e){var t;if(null===(t=window)||void 0===t||!t.PRIVATE||!e)return!1;var n="string"==typeof e?e:e.href;return O.findIndex((function(e){return n.includes(e)}))>-1}function fe(e){var t,n;return(null===(t=window.tdocs)||void 0===t?void 0:t.docLogin)&&oe&&(n=location.host,w.test(n))&&M.includes(e)}function _e(e){return he.apply(this,arguments)}function he(){return(he=(0,u.Z)(p().mark((function e(t){var n,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=-1,e.prev=1,e.next=4,t.json();case 4:r=e.sent,n=ee(r),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),n=0;case 11:return e.abrupt("return",fe(n));case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}var me=!1;!function(e){console.error("初始化拦截器-1.15");var t,n,o,a=i().isMiniProgram;e&&L.splice.apply(L,[0,0].concat((0,r.Z)(e.urlWhiteList))),window.hadIntercepted?console.log("[doc-net]:已经初始化过网络拦截器了"):(me=Z(),!a&&j(),de(me),window&&"fetch"in window&&(window.fetch=function(e,t){if(pe(e))return new Promise(function(){var t=(0,u.Z)(p().mark((function t(n,r){return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("[私有化上报]拦截 fetch",e),n("fetch 请求': ".concat(e));case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());var n=e;return Z()&&(n=G(e)),new Promise(function(){var r=(0,u.Z)(p().mark((function r(o,i){return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,re.awaitLoginTicket(e);case 2:console.warn(" wait :",e),le(n,t).then(function(){var r=(0,u.Z)(p().mark((function r(i){var a;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=i.clone(),r.next=3,_e(a);case 3:if(!r.sent){r.next=6;break}if(!re.renewTicket(n)){r.next=6;break}return r.abrupt("return",window.fetch(e,t).then((function(e){return o(e)})));case 6:re.renewSuccess(e),o(i);case 8:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()).catch((function(e){console.log(e),i(e)}));case 4:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}())}),!a&&Y(),!a&&K(),t=["otel_traceparent","otel_tracestate","otel_baggage"],n=location.href,o="",t.forEach((function(e){P(e)&&(o=D(n,e))})),o&&window.history.replaceState(null,"",o),function(){var e=location.href,t="",n="wwapp_cst";(P("cst")||P("st")||P(n))&&(t=D(e,n),t=D(t,"wwapp_vid"),t=D(t,"wwapp_deviceid"),t=D(t,"cst"),t=D(t,"vid"),t=D(t,"st"),window.history.replaceState(null,"",t))}(),window.hadIntercepted=!0)}()},95747:function(e,t,n){n.d(t,{x:function(){return _}});var r=n(22418),o=n(81030),i=n(87363),a=n.n(i),s=n(86667),c=n.n(s),l="base-module_button__8benR",u="base-module_mobile-button__gGTIT",d="base-module_button-plain__MdPCj",p="base-module_button-primary__4OraC",f=["type","children","className"],_=function(e){var t=e.type,n=void 0===t?"plain":t,i=e.children,s=e.className,_=(0,o.Z)(e,f),h=[l,s];return"primary"===n?h.push(p):"plain"===n&&h.push(d),c().isMobile&&h.push(u),a().createElement("span",(0,r.Z)({},_,{className:h.join(" ")}),i)}},74880:function(e,t,n){n.d(t,{wq:function(){return Lt},vM:function(){return tt}});var r=n(82416),o=n(915),i=n(27505),a=n(59834),s=n(90476),c=n(87675),l=n(5450),u=n.n(l),d=n(87363),p=n.n(d),f=n(66802),_=n(69130),h=n(696),m=n(95747),g=(n(74246),n(86667)),v=n.n(g),b=n(32230),y=n.n(b),w=n(28301),E=n(3382),C=n(80812),T=n(1039),x=n(41713),S=n(25303),I=n(814),k=n(77435),R=n(79707),A=n(14366),O=n(64261),L=n(52739),M=n(17008),N=n.n(M),D=n(22418),P=n(61052),F=n(5820),B=n(70275),U=n(91679),H=n(18805),j=n(41063),W=n(91683),V=n(95034),z=n(45933),G=n(56757),Y={tag:"svg",attrs:{viewBox:"0 0 8 8",width:"1em",height:"1em"},children:[{tag:"g",attrs:{id:"Icon/1-Common/cross-8",fill:"none",stroke:"none",fillRule:"evenodd",strokeWidth:1},children:[{tag:"g",attrs:{id:"Path",stroke:"#979797",transform:"translate(.47 .47)",strokeLinecap:"round"},children:[{tag:"path",attrs:{id:"直线",d:"M.07.07L7 7"}},{tag:"path",attrs:{id:"直线备份",d:"M.07.07L7 7",transform:"matrix(-1 0 0 1 7.07 0)"}}]},{tag:"path",attrs:{id:"cross",fill:"currentColor",d:"M.82.12l.07.06 3.1 3.11L7.12.18l.07-.06a.5.5 0 01.64.77l-3.11 3.1 3.11 3.12a.5.5 0 01-.64.77l-.07-.06L4 4.71.89 7.82l-.07.06a.5.5 0 01-.64-.77L3.29 4 .18.89A.5.5 0 01.82.12z"}}]}]},q=(0,d.forwardRef)((function(e,t){return(0,d.createElement)(G.A,Object.assign({},e,{id:"cross-8",ref:t,icon:Y}))}));q.displayName="Cross8";var Z=q;function J(e){var t,n=e.arrow,r=void 0===n||n,o=e.children,i=e.showEvenOverlayEmpty,a=void 0!==i&&i,s=e.mouseEnterDelay,l=void 0===s?200:s,u=e.mouseLeaveDelay,f=void 0===u?l:u,_=e.transitionSpeed,h=void 0===_?200:_,m=e.title,g=e.placements,v=void 0===g?"bottom":g,b=e.isMaintainPlacement,w=void 0!==b&&b,E=e.trigger,C=e.visible,T=e.backgroundColor,x=e.overlayStyle,S=e.overlayClassName,I=void 0===S?"":S,k=e.contentStyle,R=e.contentClassName,A=void 0===R?"":R,O=e.arrowStyle,L=e.arrowClassName,M=void 0===L?"":L,N=e.zIndex,G=void 0===N?"auto":N,Y=e.showCloseBtn,q=void 0!==Y&&Y,J=e.tip,K=e.content,Q=e.isUnMount,X=void 0===Q||Q,$=e.minimumEdge,ee=void 0===$?3:$,te=e.onVisibleChange,ne=e.disabled,re=void 0!==ne&&ne,oe=e.scrollListener,ie=e.viewport,ae=e.isHiddenOutsideViewport,se=void 0!==ae&&ae,ce=e.isObserverOverlayReSize,le=void 0!==ce&&ce,ue=function(e){var t=d.Children.only(e);if("number"==typeof t||"string"==typeof t)throw new TypeError("[wec] expect child to be a ReactElement");return t}(o),de=(0,d.useRef)(null),pe=(0,d.useRef)(null),fe=(0,d.useRef)(null),_e=(0,F._)({visible:C&&!!m,transitionSpeed:h,changeVisibleCallback:te,disabled:re}),he=_e.visible,me=_e.show,ge=_e.hide,ve=(0,d.useMemo)((function(){return!m&&!K}),[m,K]),be=(0,B.I)({triggers:E?(0,z.VL)(E):void 0,show:function(){a?me():ve||me()},hide:ge,child:ue,visible:he,delay:l,leaveDelay:f,disabled:re}),ye=be.callbacks,we=be.overlayCallbacks,Ee=(0,U.Sl)({origin:function(){return pe.current},overlay:function(){return de.current},arrow:function(){return fe.current},flexible:!0,placements:(0,z.VL)(v),visible:he,arrowGap:12,overlayRadius:3,minimumEdge:ee,disabled:re,scrollListener:oe,viewport:ie,isMaintainPlacement:w,isHiddenOutsideViewport:se,isObserverOverlayReSize:le}),Ce=Ee.placement,Te=Ee.overlayPoint,xe=Ee.arrowMoveTransform,Se=Ee.isShowOverlay,Ie=y()((t={popover:!0},(0,c.Z)(t,"popover-show-arrow",r&&(0,U.iU)(Ce)),(0,c.Z)(t,"popover-placement-".concat(Ce),!0),(0,c.Z)(t,"popover-show",C||he),t)),ke=Te?{top:"".concat(Te.y,"px"),left:"".concat(Te.x,"px"),display:Se?"block":"none"}:null;return p().createElement(d.Fragment,null,p().createElement(H.h,{prefix:"popover",position:"fixed",zIndex:G},p().createElement(j.L,{detectTarget:function(){return de.current},disabled:C||"click"!==E&&"contextMenu"!==E,onClickOutside:function(){return ge()}},p().createElement(P.Z,{in:!(!Te||!he),timeout:h,classNames:"popover",unmountOnExit:X},p().createElement("div",(0,D.Z)({style:(0,D.Z)((0,D.Z)((0,D.Z)({},ke),x),{transitionDuration:"".concat(h,"ms")}),className:"".concat(Ie," ").concat(I),ref:de},we),(0,W.Y)(r&&(0,U.iU)(Ce),p().createElement("div",{className:"popover-arrow ".concat(M),ref:fe,style:(0,D.Z)((0,D.Z)({borderColor:T},O),{transform:xe})})),p().createElement("div",{className:"popover-content ".concat(A),style:(0,D.Z)({backgroundColor:T},k)},K||p().createElement("div",{className:"popover-content-main"},m,p().createElement("div",{className:"popover-content-main-tip"},(0,W.Y)(J,J))),(0,W.Y)(q,p().createElement(Z,{className:"popover-content-cross",onClick:function(){return ge()}}))))))),(0,d.cloneElement)(ue,(0,D.Z)((0,D.Z)((0,D.Z)({},ue.props),ye),{ref:(0,V.s)(pe)})))}var K=n(24360),Q=n.n(K),X={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"url(#progress-ring-white-16_paint0_linear_1_26)",d:"M8 15A7 7 0 108 1v3a4 4 0 010 8v3z"}},{tag:"path",attrs:{fill:"url(#progress-ring-white-16_paint1_linear_1_26)",d:"M8 1a7 7 0 000 14v-3a4 4 0 010-8V1z"}},{tag:"path",attrs:{fill:"#fff",d:"M8 15a1.5 1.5 0 010-3v3z"}},{tag:"defs",attrs:{},children:[{tag:"linearGradient",attrs:{id:"progress-ring-white-16_paint0_linear_1_26",x1:11.5,x2:11.5,y1:3.23,y2:15,gradientUnits:"userSpaceOnUse"},children:[{tag:"stop",attrs:{stopColor:"#fff",stopOpacity:.38}},{tag:"stop",attrs:{offset:.61,stopColor:"#fff"}}]},{tag:"linearGradient",attrs:{id:"progress-ring-white-16_paint1_linear_1_26",x1:4.5,x2:4.5,y1:3.23,y2:15,gradientUnits:"userSpaceOnUse"},children:[{tag:"stop",attrs:{stopColor:"#fff",stopOpacity:.38}},{tag:"stop",attrs:{offset:1,stopColor:"#fff",stopOpacity:0}}]}]}],defIds:["progress-ring-white-16_paint0_linear_1_26","progress-ring-white-16_paint1_linear_1_26"]},$=(0,d.forwardRef)((function(e,t){return(0,d.createElement)(G.A,Object.assign({},e,{id:"progress-ring-white-16",ref:t,icon:X}))}));$.displayName="ProgressRingWhite16";var ee=$,te={tag:"svg",attrs:{fill:"none",viewBox:"0 0 20 20",width:"1em",height:"1em"},children:[{tag:"g",attrs:{clipPath:"url(#play-circle-fill-20_clip0_886_28780)"},children:[{tag:"circle",attrs:{cx:10,cy:10,r:10,fill:"currentColor",fillOpacity:.5}},{tag:"circle",attrs:{cx:10,cy:10,r:9.5,stroke:"#fff",strokeOpacity:.5}},{tag:"path",attrs:{fill:"#fff",d:"M8 6.93c0-.4.45-.63.78-.41l4.6 3.06c.3.2.3.64 0 .84l-4.6 3.06a.5.5 0 01-.78-.41V6.93z"}}]},{tag:"defs",attrs:{},children:[{tag:"clipPath",attrs:{id:"play-circle-fill-20_clip0_886_28780"},children:[{tag:"rect",attrs:{width:20,height:20,fill:"#fff",rx:10}}]}]}],defIds:["play-circle-fill-20_clip0_886_28780"]},ne=(0,d.forwardRef)((function(e,t){return(0,d.createElement)(G.A,Object.assign({},e,{id:"play-circle-fill-20",ref:t,icon:te}))}));ne.displayName="PlayCircleFill20";var re,oe=ne,ie=n(69460),ae=n(84075),se=n(38298),ce=null!==(re="undefined"==typeof window?null:window.i18n)&&void 0!==re?re:o.ZP;function le(e,t){var n=null==ce?void 0:ce.t(e,t);return n||"".concat(e)}!function(e,t){var n=function(n){ce&&ce.getResource&&ce.addResource&&Object.entries(e).forEach((function(e){var o=(0,r.Z)(e,2),i=o[0],a=o[1];Object.entries(a).forEach((function(e){var o=(0,r.Z)(e,2),a=o[0],s=o[1],c=null!=t?t:n.defaultNS||"legacy";ce.getResource(i,c,a)||ce.addResource(i,c,a,s)}))}))};if(ce&&"undefined"!=typeof window){if(window.noSharedI18next&&!window.i18n){window.i18n=o.ZP;var i="zh-CN";try{var a=localStorage.getItem("shared-language");a&&(i=a)}catch(e){}o.ZP.init({lng:i,resources:{},debug:!0,ns:"legacy",defaultNS:"legacy"})}ce.isInitialized?n(ce.options):ce.on("initialized",n)}}({"en-US":{"发起人：":"Initiator: ","参与人：":"Participants: ","地点：":"Location: ","添加会议":"Add meeting","等共{{num}}人":"etc. {{num}} people","共{{num}}人":"all {{num}} people","开始录制":"start recording","每天":"Every day","每周工作日":"Monday to Friday","每周":"Every week","每两周":"Every two weeks","每月":"Every month","{{ repeat }}重复，{{ until }}结束":"{{ repeat }} until {{ until }}","第 {{num}} 场":"Math {{num}}","会议室：":"Room: ","已结束":"Ended","进行中":"Doing","进入会议":"Join Meeting","录制生成中":"Load Video","查看录制":"View Video","会议记录":"Record",check:"Check","暂不支持此功能，请升级企业微信后使用":"This function is not supported at the moment, please use it after upgrading WeChat Enterprise","请在企业微信中使用此功能":"Please use this function in Enterprise WeChat","会议已被发起人删除":"The meeting has been deleted by the initiator","已加入会议":"Joined the meeting","年":" ","已取消":"Cancelled","查看详情":"Check detail","添加到我的会议":"Add to my meeting"},"zh-CN":{"发起人：":"发起人：","参与人：":"参与人：","地点：":"地点：","添加会议":"添加会议","等共{{num}}人":"等共{{num}}人","共{{num}}人":"共{{num}}人","开始录制":"开始录制","{{ repeat }}重复，{{ until }}结束":"{{ repeat }}重复，{{ until }}结束","第 {{num}} 场":"第 {{num}} 场","MM-dd":"M月d日","yyyy-":"yyyy年","会议室：":"会议室：","已结束":"已结束","进行中":"进行中","进入会议":"进入会议","录制生成中":"录制生成中","查看录制":"查看录制","会议记录":"会议记录",check:"查看","暂不支持此功能，请升级企业微信后使用":"暂不支持此功能，请升级企业微信后使用","请在企业微信中使用此功能":"请在企业微信中使用此功能","会议已被发起人删除":"会议已被发起人删除","已加入会议":"已加入会议","已取消":"已取消","查看详情":"查看详情","添加到我的会议":"添加到我的会议"},"zh-HK":{"发起人：":"發起人：","参与人：":"參與人：","地点：":"地點：","添加会议":"添加會議","等共{{num}}人":"等共{{num}}人","共{{num}}人":"共{{num}}人","开始录制":"開始錄製","{{ repeat }}重复，{{ until }}结束":"{{ repeat }}重復，{{ until }}結束","第 {{num}} 场":"第 {{num}} 場","会议室：":"會議室：","已结束":"已結束","进行中":"進行中","进入会议":"進入會議","录制生成中":"錄製生成中","查看录制":"查看錄製","会议记录":"會議記錄",check:"查看","暂不支持此功能，请升级企业微信后使用":"暫不支持此功能，請升級企業微信後使用","请在企业微信中使用此功能":"請在企業微信中使用此功能","会议已被发起人取消":"會議已被發起人取消","已加入会议":"已加入會議","已取消":"已取消","查看详情":"查看詳情","添加到我的会议":"添加到我的會議"}});var ue="MeetingCard-module_meeting-card-wrapper__ZIXgK",de="MeetingCard-module_icon-left__S6apF",pe="MeetingCard-module_content__toj8d",fe="MeetingCard-module_c-top__MH9dW",_e="MeetingCard-module_top-left__M8KiP",he="MeetingCard-module_subject__-5Ziq",me="MeetingCard-module_top-info__yy6Mk",ge="MeetingCard-module_btn-container__t9rab",ve="MeetingCard-module_repeat__cyddZ",be="MeetingCard-module_sub-divide__ci0Rx",ye="MeetingCard-module_sub__qwr20",we="MeetingCard-module_margin-top-2__s0m9c",Ee="MeetingCard-module_participants-wrapper__P5IZq",Ce="MeetingCard-module_participants__qUl-d",Te="MeetingCard-module_no-shrink__EMxLg",xe="MeetingCard-module_mobile-meeting-card-wrapper__NQncv",Se="MeetingCard-module_active__Pe0y-";function Ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,T.Z)(e);if(t){var o=(0,T.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,C.Z)(this,n)}}var ke,Re,Ae,Oe,Le=function(e){(0,E.Z)(n,e);var t=Ie(n);function n(e){var r;return(0,a.Z)(this,n),(r=t.call(this)).data=e,r}return(0,s.Z)(n)}((0,x.Z)(Error));!function(e){e[e.Unknown=0]="Unknown",e[e.Doing=1]="Doing",e[e.Done=2]="Done"}(ke||(ke={})),function(e){e[e.EveryDay=0]="EveryDay",e[e.MondayToFriday=1]="MondayToFriday",e[e.EveryWeek=2]="EveryWeek",e[e.EveryTwoWeek=3]="EveryTwoWeek",e[e.EveryMonth=4]="EveryMonth"}(Re||(Re={})),function(e){e.Success="0",e.Disabled="-65000046"}(Ae||(Ae={})),function(e){e[e.Wait=1]="Wait",e[e.Doing=2]="Doing",e[e.Ended=3]="Ended"}(Oe||(Oe={}));var Me,Ne=o.ZP.language,De=function(){switch(Ne){case"en":case"en-US":return I.Z;case"zh-CN":default:return S.Z;case"zh-HK":return k.Z}},Pe=function(){return{locale:(0,d.useMemo)(De,[Ne])}},Fe="status-module_status__V69zJ",Be="status-module_dot__OX7hk",Ue="status-module_text__UAhvB",He="status-module_doing__r6nIR",je="status-module_done__DJCIm";function We(){return p().createElement("div",{className:"".concat(Fe," ").concat(je)},p().createElement("span",{className:Be}),p().createElement("span",{className:Ue},le("已结束")))}function Ve(){return p().createElement("div",{className:"".concat(Fe," ").concat(He)},p().createElement("img",{src:"data:image/gif;base64,R0lGODlhDAAMAMQWAHvWkFLLbiG+RSO+R+z177XmwcTqzTTDVT7GXqDgsHfVjvT39SC9RETHY6/kvHrWkNTv243boCjATEzJaa7kux69Q/f4+AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMC1jMDAwIDc5LjE3MWMyN2ZhYiwgMjAyMi8wOC8xNi0yMjozNTo0MSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoyZDgwNWU0Ny0xM2NjLTQxZDktYTk2YS1hMGZiZmE1ZDRiZjYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTg1MEE1RTZCNUI1MTFFREE5QkE4MDc0Q0IzMTA4N0IiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTg1MEE1RTVCNUI1MTFFREE5QkE4MDc0Q0IzMTA4N0IiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIzLjMgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowNGY2Njc2ZS02MGZjLTQzYmYtODQyNi00YTVlOTBmZTVhODgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MmQ4MDVlNDctMTNjYy00MWQ5LWE5NmEtYTBmYmZhNWQ0YmY2Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEBQQAFgAsAAAAAAwADAAABSegJY5kaQaBaBgqa1WVOAwy/ca3COv4nv++YG/Iqxl/q1bRNEIxTSEAIfkECQQAFgAsAQABAAoACgAABRygJY4iYALispBVJSIIKc90bcvtG4/Ak643iykEACH5BAUEABYALAAAAAAMAAwAAAUqoCWO5EgQpVUU4nGkgiBWlagoc23Reb/rvJ8vSAQafTefCyaznFKrlDQEACH5BAkEABYALAEAAQAKAAoAAAUZYFFYZEkQglCWx7EmySrPdG3b8JrOrTifIQAh+QQFBAAWACwAAAAADAAMAAAFKaAljuQIAGVZVekprqLjvKwFWwxD73Z9/76gKMe7OSjFGgnwELlSUGgIACH5BAUEABYALAEAAQAKAAoAAAUaYBBYZGmelmGYSUIOg1lVaG3Xs92+ca2KthAAIfkECQQAFgAsAQABAAoACgAABRhg01hkaZ7WspiKQiIIKs90zboWPKviHAIAIfkEBQQAFgAsAAAAAAwADAAABSigJY7kGARlWVXisqSriCCiooixle+s3vO4nzBI9MloFlvRlTqlntAQACH5BAUEABYALAEAAQAKAAoAAAUYIABYZGmShnGWw0AmySrPdG22b1ympjiHACH5BAUEABYALAEAAQAKAAoAAAUfYFFYZEkKAgkApllVpOO0JcPQeI7bLmw5FJTqYRLlQgAh+QQJBAAWACwBAAEACgAKAAAFHCBBWJZIkseBqmfbJol7VpVs3zZ9w+namqXRKQQAIfkEBQQAFgAsAAAAAAwADAAABSqgJY5kKRaFCQCiIJhVJcaiosyyRev57vdAnJA3/NVuFsCj9TKNUM6oKAQAIfkEBQQAFgAsAQABAAoACgAABR+gJVoAMFqGIVaVuCzDcIoIMt94rs/xXaerluV1Kp1CACH5BAkEABYALAEAAQAKAAoAAAUboCVaQTBay3KKhoEgqzUMcW3f+BvPadyepVMIACH5BAUEABYALAAAAAAMAAwAAAUnoCWOZCk2jUlWlQgAoqKILN1aNX7n/O7bQF0wJxveVjfAw4RSOUUhACH5BAUEABYALAEAAQAKAAoAAAUYoCVaQSASxKhax5EkayzPdD2+9tqq5UmEACH5BAUEABYALAEAAQAKAAoAAAUcoCVaACAWxahaguA468gwcW3Xs+1Qd92qpVMhBAAh+QQFBAAWACwBAAEACgAKAAAFHqAlWkUhAsBoCYJYVVGkqu9s37hb4XE+sjpV6QQIAQAh+QQJBAAWACwBAAEACgAKAAAFGKAlWgQhBsFoHYc6TWosz3Rdv7bI0uUZhAAh+QQFBAAWACwAAAAADAAMAAAFKKAljmRpNo0IQSIAiFUlShIsW7Gt43fO775gb7ijAW+r1mNnEqGaphAAOw=="}),p().createElement("span",{className:Ue},le("进行中")))}var ze=(Me={},(0,c.Z)(Me,Re.EveryDay,le("每天")),(0,c.Z)(Me,Re.MondayToFriday,le("工作日")),(0,c.Z)(Me,Re.EveryWeek,le("每周")),(0,c.Z)(Me,Re.EveryTwoWeek,le("每两周")),(0,c.Z)(Me,Re.EveryMonth,le("每月")),Me);function Ge(e){return"微信"===e?{color:"#1EBD43"}:{color:"#FC8F28"}}function Ye(e,t){return e!==t}function qe(e,t){if(void 0!==e.recurring_type){var n=ze[e.recurring_type];if(!n)return"";var r=e.until_date?function(e,t){var n=new Date(1e3*e),r=Date.now(),o=le("MM-dd");return(0,f.Z)(r,n)||(o=le("yyyy-")+o),"".concat((0,_.Z)(n,o,{locale:t}))}(e.until_date,t):"";return le("{{ repeat }}重复，{{ until }}结束",{repeat:n,until:r})}return""}function Ze(e){if(e){var t=e.roomname,n=e.floorname,r=e.buildingname,o="";if(r)return o=r,n&&(o="".concat(r,"-").concat(n)),"".concat(t,"(").concat(o,")")}return""}var Je,Ke,Qe,Xe=v().isWxWork&&(Je="wxwork",Ke="4.1.2",function(e,t,n){var r=null==n?void 0:n.lexicographical,o=null==n?void 0:n.zeroExtend,i=e.split("."),a=t.split(".");if(o){for(;i.length<a.length;)i.push("0");for(;a.length<i.length;)a.push("0")}if(!r){for(var s=0;s<i.length;s++)i[s]=parseInt(i[s],10);for(var c=0;c<a.length;c++)a[c]=parseInt(a[c],10)}for(var l=0;l<i.length;++l){if(a.length===l)return 1;if(i[l]!==a[l])return i[l]>a[l]?1:-1}return i.length!==a.length?-1:0}((null==(Qe=navigator.userAgent.match(new RegExp("".concat(Je,"/([\\d\\.]+)"),"i")))?void 0:Qe[1])||"0",Ke,{zeroExtend:!0})>=0),$e=function(e,t){v().isMobile?N().show({message:e,type:t||"info",autoClose:!0,duration:5e3}):L.default.show({message:e,type:t||"info",autoClose:!0,duration:5e3})},et=function(){return v().isWxWork?!Xe&&($e(le("暂不支持此功能，请升级企业微信后使用")),!0):($e(le("请在企业微信中使用此功能")),!0)};function tt(e){return nt.apply(this,arguments)}function nt(){return(nt=(0,i.Z)(u().mark((function e(t){var n,r,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,dt(t);case 3:n=e.sent,e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),new Le({refreshError:{content:"refresh_doc_meeting_card, ".concat(e.t0.message)}});case 9:if(!n.data.recurring_rule){e.next=13;break}return r=De(),o=qe(n.data.recurring_rule,r),e.abrupt("return",o);case 13:return e.abrupt("return",void 0);case 14:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}var rt=new((0,s.Z)((function e(){var t=this;(0,a.Z)(this,e),(0,c.Z)(this,"queue",[]),(0,c.Z)(this,"num",0),(0,c.Z)(this,"add",(function(e){t.queue.push((function(){e(t.endFn)})),t.startFn()})),(0,c.Z)(this,"startFn",(function(){if(t.num<4){var e=t.queue.shift();null==e||e(),t.num=t.num+1}})),(0,c.Z)(this,"endFn",(function(){t.num=t.num-1,t.queue.length>0&&t.startFn()}))})));function ot(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return it(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?it(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function it(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function at(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function st(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?at(Object(n),!0).forEach((function(t){(0,c.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):at(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ct=function(e){return"0"===e.vid||void 0===e.vid||"undefined"===e.vid||null===e.vid||"null"===e.vid||""===e.vid};function lt(e,t,n){return ut.apply(this,arguments)}function ut(){return(ut=(0,i.Z)(u().mark((function e(t,n,r){var o,i,a,s,c,l,d,p,f,_,h,m,g,v,b,y,w,E;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,dt(t);case 3:o=e.sent,e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),new Le({refreshError:{content:"refresh_doc_meeting_card, ".concat(e.t0.message)}});case 9:if(a=(i=o).data,s=i.status,c=i.errorCode,l=i.errorMsg,void 0!==c&&c!==Ae.Success){e.next=39;break}a.meeting_room=Ze(a.meeting_room_param)||a.meeting_room,d=ot(a.meeting_records||[]);try{for(d.s();!(p=d.n()).done;)(f=p.value).name=f.name||n.subject}catch(e){d.e(e)}finally{d.f()}if(n.is_api_create&&ct({vid:n.creator_vid})){e.next=25;break}return e.prev=15,e.next=18,O.wdocsUserCenter.queryUserInfo([n.creator_vid]);case 18:_=e.sent,e.next=24;break;case 21:e.prev=21,e.t1=e.catch(15),r({unknownError:"unknownError, 处理组织人: ".concat(e.t1.message)});case 24:_&&_.length>0&&(h=_[0],m=h.corp_id,g=h.corp_name,"unknown"!==h.name?(v=O.wdocsUserCenter.getDisplayNameWithoutCorp(h),a.creator_name=v,a.creator_corp_id=m,a.creator_corp_name=g):r({memberError:{vid:n.creator_vid,content:"查询失败vid unknown: ".concat(n.creator_vid)}}));case 25:return a.attend_len=a.attend_list.length,b=(a.attend_list||[]).filter((function(e){return ct(e)})),y=(a.attend_list||[]).filter((function(e){return!ct(e)})).map((function(e){return e.vid})),e.prev=28,e.next=31,O.wdocsUserCenter.queryUserInfo(y.slice(0,10));case 31:w=e.sent,e.next=37;break;case 34:e.prev=34,e.t2=e.catch(28),r({unknownError:"unknownError, 处理参与人: ".concat(e.t2.message)});case 37:return w&&(E=w.map((function(e){var t=e.vid,o=e.corp_name,i=e.corp_id;if("unknown"===e.name){r({memberError:{vid:t,content:"查询失败vid unknown: ".concat(t)}});var s=a.attend_list.find((function(e){return e.vid===t}));if(null!=s&&s.username)return{vid:t,username:s.username};var c=n.attend_list.find((function(e){return e.vid===t}));if(c)return{vid:t,username:c.username}}var l=O.wdocsUserCenter.getDisplayNameWithoutCorp(e);return{vid:t,username:l,corpname:o,corpid:i}})),a.attend_list.length>0&&(a.attend_list=[].concat((0,R.Z)(E),(0,R.Z)(b)))),e.abrupt("return",a);case 39:throw new Le({refreshError:{errorCode:c,errorMsg:l,status:s,content:"refresh_doc_meeting_card, errorCode: ".concat(c,", errorMsg: ").concat(l,", status: ").concat(s)}});case 40:case"end":return e.stop()}}),e,null,[[0,6],[15,21],[28,34]])})))).apply(this,arguments)}function dt(e){return new Promise((function(t,n){rt.add((function(r){A.Z.post("/wework/wwdocweb/refresh_doc_meeting_card",st(st({},e),{},{share_key:e.sharekey,doc_id:e.docid,creator_source:Number(e.creator_source)}),{timeout:5e3}).then((function(e){var n=e.data,r=e.headers,o=e.status,i=r["error-code"],a=r["error-msg"];t({status:o,data:n,errorCode:i,errorMsg:a})})).catch((function(e){n(e)})).finally((function(){r()}))}))}))}var pt="MeetingRecords-module_meeting-records__36Ges",ft="MeetingRecords-module_meeting-records-item__qcJvG",_t="MeetingRecords-module_meeting-records-item-left__vFKix",ht="MeetingRecords-module_loading__l2EeZ",mt="MeetingRecords-module_time__V7n2P",gt="MeetingRecords-module_meeting-records-item-play__Fc5GE",vt="MeetingRecords-module_meeting-records-item-loading__s5Tpu",bt="MeetingRecords-module_meeting-records-item-right__zsqgi",yt="MeetingRecords-module_meeting-records-item-timestamp__2Gn0c",wt="MeetingRecords-module_mobile-meeting-records__0ZkR-",Et={background:"#fff",boxShadow:"0 2px 8px 2px rgb(68 73 77 / 16%)",padding:"5px",lineHeight:"12px",color:"rgba(0, 0, 0, .88)",position:"relative",wordBreak:"break-word",borderRadius:"8px"},Ct={width:"0px",height:"0px",border:"4.5px solid #fff",borderRadius:"0px",zIndex:1};function Tt(e){var t=e.children,n=e.records,r=e.recordsPStyle,o=e.recordsPClassName,i=e.onViewRecord,a=Pe().locale,s=y()(pt,(0,c.Z)({},wt,v().isMobile)),l=(0,d.useMemo)((function(){return p().createElement("div",{className:s},n.map((function(e,t){return p().createElement("div",{onClick:function(){2===e.status&&e.media_url&&i(e.media_url)},className:ft,id:e.id},p().createElement("div",{className:_t},1===e.status?p().createElement(p().Fragment,null,p().createElement("div",{className:ht}),p().createElement(ee,{className:vt})):p().createElement(p().Fragment,null,p().createElement("img",{src:e.thumb,alt:""}),p().createElement(oe,{className:gt}),p().createElement("span",{className:mt},function(e){for(var t=e,n=[];t>=60;){var r=t%60;n.unshift(r<10?"0".concat(r):String(r)),t=Math.floor(t/60)}return 0===n.length?n.unshift(t<10?"0".concat(t):String(t)):n.unshift(String(t)),1===n.length&&n.unshift("0"),n.join(":")}(e.duration)))),p().createElement("div",{className:bt},p().createElement("span",null,le("第 {{num}} 场",{num:t+1})),p().createElement("span",{className:yt},1===e.status?"生成中...":"".concat((0,_.Z)(new Date(1e3*e.timestamp),"HH:mm",{locale:a})," ").concat(le("开始录制")))))})))}),[n]),u=(0,d.useCallback)((function(){Q().show({title:null,okText:null,content:l})}),[l]);return v().isMobile?p().createElement("span",{onClick:u},t):p().createElement(J,{overlayStyle:r,overlayClassName:o,contentStyle:Et,arrowStyle:Ct,placements:["right","bottom","right"],content:l,mouseEnterDelay:0,mouseLeaveDelay:0,trigger:"click",zIndex:1e3},t)}function xt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function St(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xt(Object(n),!0).forEach((function(t){(0,c.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function It(e){se.KVR.oss(St(St({},e),{},{biz:"wecomDocs"}))}function kt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kt(Object(n),!0).forEach((function(t){(0,c.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var At=function(e){e.stopPropagation(),et()||$e(le("会议已被发起人取消"))},Ot=function(){function e(t){(0,a.Z)(this,e),(0,c.Z)(this,"timerId",0),this.meetingJob=t}return(0,s.Z)(e,[{key:"clear",value:function(){clearTimeout(this.timerId)}},{key:"start",value:function(e,t){var n=this;t?this.shouldFilter(t)||this.start(t.refresh_interval):this.timerId=window.setTimeout((function(){n.meetingJob().then((function(e){n.start(e.refresh_interval,e)})).catch((function(e){e instanceof Le&&e.message===Ae.Disabled||n.start(30)}))}),1e3*e)}},{key:"shouldFilter",value:function(e){var t=e.status,n=e.recurring_rule;return!!e.refresh_finish||!(t!==Oe.Ended||null!=n&&n.recurring_type)}}]),e}(),Lt=function(e){var t,n=e.data,o=e.info,a=e.active,s=e.style,l=e.className,g=e.recordsPStyle,b=e.recordsPClassName,E=e.onEnterMeeting,C=e.onViewMeeting,T=e.onJoinMeeting,x=e.onViewRecord,S=e.updateHeight,I=e.readyCallback,k=e.onError,R=n.subject,A=n.start_time,L=n.end_time,M=n.repeat,N=n.creator_name,D=n.meeting_room,P=n.attend_list,F=void 0===P?[]:P,B=n.place,U=n.is_api_create,H=o.meeting_id,j=(0,d.useState)(M),W=(0,r.Z)(j,2),V=W[0],z=W[1],G=(0,d.useState)(R),Y=(0,r.Z)(G,2),q=Y[0],Z=Y[1],J=(0,d.useState)(0),K=(0,r.Z)(J,2),Q=K[0],X=K[1],$=(0,d.useState)(A),ee=(0,r.Z)($,2),te=ee[0],ne=ee[1],re=(0,d.useState)(L),oe=(0,r.Z)(re,2),se=oe[0],ce=oe[1],Ie=(0,d.useState)(),Re=(0,r.Z)(Ie,2),Ae=Re[0],Me=Re[1],Ne=(0,d.useState)([]),De=(0,r.Z)(Ne,2),Fe=De[0],Be=De[1],Ue=(0,d.useState)(""),He=(0,r.Z)(Ue,2),je=He[0],ze=He[1],Ze=(0,d.useState)(D),Je=(0,r.Z)(Ze,2),Ke=Je[0],Qe=Je[1],Xe=(0,d.useState)(B),tt=(0,r.Z)(Xe,2),nt=tt[0],rt=tt[1],ot=(0,d.useState)(F),it=(0,r.Z)(ot,2),at=it[0],st=it[1],ct=(0,d.useState)(N),ut=(0,r.Z)(ct,2),dt=ut[0],pt=ut[1],ft=(0,d.useState)(),_t=(0,r.Z)(ft,2),ht=_t[0],mt=_t[1],gt=(0,d.useState)(),vt=(0,r.Z)(gt,2),bt=vt[0],yt=vt[1],wt=(0,d.useState)(!1),Et=(0,r.Z)(wt,2),Ct=Et[0],xt=Et[1],St=(0,d.useState)(""),kt=(0,r.Z)(St,2),Lt=kt[0],Mt=kt[1],Nt=(0,d.useState)(),Dt=(0,r.Z)(Nt,2),Pt=Dt[0],Ft=Dt[1],Bt=(0,d.useState)(F.length),Ut=(0,r.Z)(Bt,2),Ht=Ut[0],jt=Ut[1],Wt=(0,d.useState)(!1),Vt=(0,r.Z)(Wt,2),zt=Vt[0],Gt=Vt[1],Yt=(0,d.useRef)(null),qt=(0,d.useRef)(null),Zt=(0,d.useRef)(0),Jt=Pe().locale,Kt=(0,d.useCallback)((function(){et()||(0,w.tencentDocOpenUrlForAll)({url:je})}),[je]),Qt=(0,d.useCallback)((function(e){et()||x(e)}),[x]),Xt=function(){var e=(0,i.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",lt(o,n,k).then((function(e){var t;return Z(e.subject),X(e.status),ne(e.start_time),ce(e.end_time),Me(e.is_joined),Be(e.meeting_records),ze(e.meeting_minutes),st(e.attend_list),Qe(e.meeting_room),rt(e.place),e.creator_corp_id&&yt(e.creator_corp_id),e.creator_corp_name&&mt(e.creator_corp_name),e.creator_name&&pt(e.creator_name),Ft(e.is_meeting_cancled),jt(e.attend_len),e.recurring_rule&&(t=qe(e.recurring_rule,Jt),z(t)),Rt(Rt({},e),{},{repeat:t})})).catch((function(e){throw e instanceof Le&&k(e.data),e})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$t=(0,d.useRef)(new Ot(Xt));(0,d.useEffect)((function(){return O.wdocsUserCenter.getUserInfo().then((function(e){Mt(e.corp_id),void 0!==e.corp_id?Xt().then((function(e){var t=new Map;n.attend_list.forEach((function(e){t.set(e.vid,e)})),xt(!0),null==I||I(Rt(Rt({},n),{},{subject:e.subject,repeat:e.repeat,creator_name:e.creator_name||n.creator_name,meeting_room:e.meeting_room,place:e.place,start_time:e.start_time,end_time:e.end_time,attend_list:e.attend_list.map((function(e){return Rt(Rt({},t.get(e.vid)),{},{username:e.username||e.name||"",vid:e.vid})}))})),$t.current.start(e.refresh_interval,e)})).catch((function(e){$t.current.start(30),xt(!0),null==I||I()})):(xt(!0),null==I||I())})).catch((function(e){xt(!0),null==I||I(),console.log(e)})),function(){$t.current.clear()}}),[]),(0,ie.gj)({element:qt.current,onResize:(0,ae.P2)((function(){var e,t=null===(e=qt.current)||void 0===e?void 0:e.getBoundingClientRect().height;Zt.current!==t&&(setTimeout((function(){return null==S?void 0:S()})),Zt.current=t||0)}))});var en=(0,d.useMemo)((function(){var e=new Date(1e3*te),t=new Date(1e3*se),n=Date.now(),r="MMMdo E HH:mm",o="MMMdo E HH:mm";return(0,h.Z)(e,t)&&(o="HH:mm"),(0,f.Z)(n,e)&&!(0,f.Z)(e,t)&&(o="yyyy".concat(le("年")).concat(o)),(0,f.Z)(n,e)||(r="yyyy".concat(le("年")).concat(r),(0,h.Z)(e,t)||(o="yyyy".concat(le("年")," MMMdo E HH:mm"))),"".concat((0,_.Z)(e,r,{locale:Jt})," - ").concat((0,_.Z)(t,o,{locale:Jt}))}),[te,se]),tn=(0,d.useMemo)((function(){if(0!==Ht&&void 0!==Ht){var e=at;Ht>2&&(e=at.slice(0,2));var t=e.length;return p().createElement("span",{className:"".concat(Ee," ").concat(we)},p().createElement("span",{className:Te},le("参与人：")),p().createElement("span",{className:Ce},e.map((function(e,n){var r=e.username,o=e.corpid,i=e.corpname,a=e.name;return p().createElement("span",{key:r||a},r||a,Lt&&Ye(Lt,o)&&i&&p().createElement("span",{style:Ge(i)},"@",i),n+1<t&&p().createElement("span",null,"、"))}))),p().createElement("span",{className:Te},le(Ht>2?"等共{{num}}人":"共{{num}}人",{num:Ht})))}}),[at,Lt,Ht]),nn=(0,d.useCallback)((function(e){null==e||e.stopPropagation(),et()||(Pt?$e(le("会议已被发起人取消")):C({x:null==e?void 0:e.clientX,y:null==e?void 0:e.clientY}))}),[C,Pt]),rn=(0,d.useMemo)((function(){if(Q===Oe.Doing)return{text:le("进入会议"),onCallBack:function(){It({itemname:"nmeeting_enter_fromdoc",Extra1:H}),et()||E()},iconStatus:ke.Doing};if(Q===Oe.Ended){if(Pt)return{text:le("已取消"),onCallBack:At,iconStatus:ke.Unknown};if(1===Fe.length){var e=Fe[0],t=e.status,n=e.media_url;return 1===t?{text:le("录制生成中"),onCallBack:function(){},iconStatus:ke.Done,style:{opacity:.4}}:{text:le("查看录制"),onCallBack:function(){It({itemname:"nmeeting_record_click_fromdoc",Extra1:H}),Qt(n)},iconStatus:ke.Done}}return Fe.length>1?{text:p().createElement(Tt,{records:Fe,recordsPStyle:g,recordsPClassName:b,onViewRecord:function(e){It({itemname:"nmeeting_record_click_fromdoc",Extra1:H}),Qt(e)}},p().createElement("span",{style:{display:"inline-block",width:"100%",textAlign:"center"}},le("查看录制"))),onCallBack:function(){},iconStatus:ke.Done}:je?{text:le("会议记录"),onCallBack:function(){It({itemname:"nmeeting_history_click_fromdoc",Extra1:H}),Kt()},iconStatus:ke.Done}:{text:le("会议记录"),onCallBack:function(e){It({itemname:"nmeeting_history_click_fromdoc",Extra1:H}),nn(e)},iconStatus:ke.Done}}return U||Ae||void 0===Ae?{text:le("查看详情"),onCallBack:function(e){It({itemname:"nmeeting_detail_fromdoc",Extra1:H}),nn(e)},iconStatus:ke.Unknown}:{text:le("添加到我的会议"),onCallBack:function(){It({itemname:"nmeeting_add_fromdoc",Extra1:H}),et()||T().then((function(e){e&&$e(le("已加入会议"),"success")}))},iconStatus:Q===Oe.Ended?ke.Done:ke.Unknown}}),[E,T,Kt,nn,Qt,Ae,Fe,Q,U,Pt,H]),on=rn.text,an=rn.onCallBack,sn=rn.iconStatus,cn=rn.style;(0,d.useEffect)((function(){Yt.current&&Gt(function(e,t){if(t===ke.Unknown)return!1;var n=e.getBoundingClientRect(),r=e.firstChild,o=r.length,i=document.createRange();if(i.setStart(r,0),i.setEnd(r,o),i.getBoundingClientRect().height<40)return!1;i.setStart(r,o);var a=i.getBoundingClientRect();if(n.bottom<a.bottom)return!0;var s=e.lastChild.getBoundingClientRect().width;return a.right+s>n.right}(Yt.current,sn))}),[q,sn]);var ln=(0,d.useMemo)((function(){return sn===ke.Doing?p().createElement(Ve,null):sn===ke.Done?p().createElement(We,null):""}),[sn]),un=y()(ue,(t={},(0,c.Z)(t,xe,v().isMobile),(0,c.Z)(t,Se,a),t),l);return p().createElement("div",{style:s,ref:qt,className:un,onClick:function(e){It({itemname:"nmeeting_detail_fromdoc",Extra1:H}),nn(e)}},p().createElement("svg",{className:de,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},p().createElement("rect",{width:"24",height:"24",rx:"3",fill:"#539CF8"}),p().createElement("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5.06702 9.10046C5.06702 8.29044 5.72367 7.63379 6.53368 7.63379H13.867C14.677 7.63379 15.3337 8.29044 15.3337 9.10046V15.7005C15.3337 16.5105 14.677 17.1671 13.867 17.1671H6.53368C5.72367 17.1671 5.06702 16.5105 5.06702 15.7005V9.10046ZM16.0669 10.9338L18.5797 9.17487C19.0658 8.83465 19.7336 9.18236 19.7336 9.77564V15.0253C19.7336 15.6186 19.0658 15.9663 18.5797 15.6261L16.0669 13.8672V10.9338ZM12.2535 14.8019L12.4271 14.6268C12.5118 14.5413 12.5891 14.4218 12.6496 14.3137C12.7333 14.1638 12.675 13.9804 12.5305 13.8876L11.6168 13.3007C11.5398 13.2512 11.4413 13.2505 11.3636 13.2987L11.025 13.5089C10.9006 13.5862 10.7664 13.6535 10.6537 13.5612C10.6537 13.5612 10.0438 13.1238 9.78447 12.8621C9.523 12.5983 9.11196 12.0218 9.11196 12.0218C9.01943 11.9083 9.08735 11.7723 9.16378 11.6469L9.37434 11.3018C9.42277 11.2223 9.42031 11.122 9.36805 11.045L8.68365 10.0375C8.59697 9.90989 8.43698 9.85156 8.29715 9.91672C8.18701 9.96806 8.06129 10.04 7.97097 10.1311L7.79736 10.3063C7.31794 10.79 7.92682 12.1884 9.15734 13.4299C10.3879 14.6713 11.774 15.2856 12.2535 14.8019Z",fill:"white"})),p().createElement("div",{className:pe},p().createElement("div",{className:fe},p().createElement("div",{className:_e},p().createElement("div",{ref:Yt,className:"".concat(he," ").concat(me)},q,ln),zt&&ln,p().createElement("div",{className:"".concat(me," ").concat(we)},en)),p().createElement("div",{className:ge},Ct&&p().createElement(m.x,{style:Rt(Rt({},cn),{},{width:"auto"}),onClick:function(e){return e.stopPropagation(),an(e)},onTouchEnd:function(e){e.stopPropagation()},type:sn===ke.Doing?"primary":"plain"},on))),V&&p().createElement("div",{className:"".concat(we," ").concat(ve)},V),p().createElement("div",{className:be}),p().createElement("div",{className:"".concat(ye)},p().createElement(p().Fragment,null,p().createElement("span",null,le("发起人："),dt),Lt&&Ye(Lt,bt)&&ht&&p().createElement("span",{style:Ge(ht)},"@",ht))),tn&&p().createElement(p().Fragment,null,tn),Ke&&p().createElement("div",{className:ye},le("会议室："),Ke),nt&&p().createElement("div",{className:ye},le("地点："),nt)))}},70275:function(e,t,n){n.d(t,{I:function(){return i}});var r=n(87363),o=n(45933);function i(e){var t=e.triggers,n=void 0===t?["hover"]:t,i=e.delay,a=void 0===i?200:i,s=e.leaveDelay,c=void 0===s?a:s,l=e.show,u=e.hide,d=e.child,p=e.visible,f=e.disabled,_=void 0!==f&&f,h=(0,o.e$)(n,"hover"),m=(0,o.e$)(n,"click"),g=(0,o.e$)(n,"contextMenu"),v=(0,o.e$)(n,"focus"),b=(0,r.useRef)(null),y=(0,r.useCallback)((function(){b.current&&(clearTimeout(b.current),b.current=null)}),[]),w=(0,r.useCallback)((function(){y(),b.current=setTimeout((function(){u(),y()}),c)}),[y,c,u]),E=(0,r.useCallback)((function(){y(),b.current=setTimeout((function(){l(),y()}),a)}),[y,a,l]),C=(0,r.useCallback)((function(){return l()}),[l]),T=(0,r.useCallback)((function(){return p?u():C()}),[p,u,C]),x=(0,r.useMemo)((function(){var e={},t=d.props;return h&&(e.onMouseEnter=function(e){var n;E(),null===(n=t.onMouseEnter)||void 0===n||n.call(t,e)},e.onMouseLeave=function(e){var n;w(),null===(n=t.onMouseLeave)||void 0===n||n.call(t,e)}),m&&(e.onClick=function(){var e;T(),null===(e=t.onClick)||void 0===e||e.call(t)}),g&&(e.onContextMenu=function(){var e;l(),null===(e=t.onContextMenu)||void 0===e||e.call(t)}),v&&(e.onFocus=function(){var e;l(),null===(e=t.onFocus)||void 0===e||e.call(t)},e.onBlur=function(){var e;u(),null===(e=t.onBlur)||void 0===e||e.call(t)}),e}),[d.props,h,m,g,v,E,w,T]),S=(0,r.useMemo)((function(){var e={};return h&&(e.onMouseEnter=function(){b.current&&E()},e.onMouseLeave=function(){return w()}),e}),[w,E,h]);return _?{callbacks:function(){},overlayCallbacks:function(){}}:{callbacks:x,overlayCallbacks:S}}},5820:function(e,t,n){n.d(t,{_:function(){return a},b:function(){return r}});var r,o=n(82416),i=n(87363);function a(e){var t=e.duration,n=void 0===t?0:t,a=e.visible,s=e.transitionSpeed,c=void 0===s?200:s,l=e.unmountCallback,u=e.changeVisibleCallback,d=e.disabled,p=void 0!==d&&d,f=void 0!==a,_=(0,i.useState)((function(){return!1})),h=(0,o.Z)(_,2),m=h[0],g=h[1],v=(0,i.useState)((function(){return r.NONE})),b=(0,o.Z)(v,2),y=b[0],w=b[1],E=(0,i.useCallback)((function(e){w(r.LEAVE),setTimeout((function(){g(!1),w(r.NONE),null==u||u(!1),e&&(null==l||l())}),c)}),[u,c,l]),C=(0,i.useCallback)((function(){g(!0),w(r.ENTER),setTimeout((function(){null==u||u(!0),w(r.NONE)}),c)}),[u,c]),T=f?a:m,x=(0,i.useRef)(void 0),S=(0,i.useCallback)((function(){x.current&&(clearTimeout(x.current),x.current=void 0)}),[]);return(0,i.useEffect)((function(){return 0!==n&&(S(),x.current=setTimeout((function(){E(!0)}),n)),function(){S()}}),[n,S,E]),p?{visible:T,hide:function(){},show:function(){},transitionState:r.NONE}:{visible:T,hide:E,show:C,transitionState:y}}!function(e){e[e.NONE=0]="NONE",e[e.APPEAR=1]="APPEAR",e[e.ENTER=2]="ENTER",e[e.LEAVE=3]="LEAVE"}(r||(r={}))},18805:function(e,t,n){n.d(t,{h:function(){return a}});var r=n(87363),o=n(61533),i=0;function a(e){var t=e.prefix,n=void 0===t?"":t,a=e.getContainerElement,s=e.children,c=e.position,l=void 0===c?"absolute":c,u=e.zIndex,d=void 0===u?"auto":u,p=(0,r.useRef)(null);if(!p.current){var f=(null==a?void 0:a())||function(e,t,n){var r=document.createElement("div");return r.id="portal-element-".concat(i++),r.style.position=t,r.style.left="0",r.style.top="0",e&&r.classList.add("".concat(e,"-portal")),n&&(r.style.zIndex=n.toString()),document.body.appendChild(r),r}(n,l,d);p.current=f}return(0,r.useEffect)((function(){return function(){var e;if(!a){var t=p.current;null===(e=t.parentElement)||void 0===e||e.removeChild(t)}}}),[a]),(0,o.createPortal)(s,p.current)}},91683:function(e,t,n){function r(e,t){return e?t:null}function o(e){var t=e.condition,n=e.children;return t?n:null}n.d(t,{If:function(){return o},Y:function(){return r}})},21329:function(e,t,n){var r=n(87363),o=n(56757),i={tag:"svg",attrs:{fill:"none",viewBox:"0 0 20 20",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"#10141A",d:"M1.98 10.14C2.95 6.93 5.35 3.5 10 3.5c4.65 0 7.05 3.43 8.02 6.64a.5.5 0 10.96-.28C17.95 6.44 15.29 2.5 10 2.5c-5.29 0-7.95 3.94-8.98 7.36a.5.5 0 00.96.28zm11.77 1.11a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zm1 0a4.75 4.75 0 11-9.5 0 4.75 4.75 0 019.5 0z",fillRule:"evenodd",clipRule:"evenodd"}}]},a=(0,r.forwardRef)((function(e,t){return(0,r.createElement)(o.A,Object.assign({},e,{id:"eye-20",ref:t,icon:i}))}));a.displayName="Eye20",t.Z=a},44219:function(e,t,n){n.d(t,{j:function(){return o}});var r={};function o(){return r}},32645:function(e,t,n){function r(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}n.d(t,{Z:function(){return r}})},69070:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(82754),o=n(32645),i=n(76344),a=n(44219);function s(e,t){var n,s,c,l,u,d,p,f;(0,o.Z)(1,arguments);var _=(0,a.j)(),h=(0,i.Z)(null!==(n=null!==(s=null!==(c=null!==(l=null==t?void 0:t.weekStartsOn)&&void 0!==l?l:null==t||null===(u=t.locale)||void 0===u||null===(d=u.options)||void 0===d?void 0:d.weekStartsOn)&&void 0!==c?c:_.weekStartsOn)&&void 0!==s?s:null===(p=_.locale)||void 0===p||null===(f=p.options)||void 0===f?void 0:f.weekStartsOn)&&void 0!==n?n:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var m=(0,r.Z)(e),g=m.getUTCDay(),v=(g<h?7:0)+g-h;return m.setUTCDate(m.getUTCDate()-v),m.setUTCHours(0,0,0,0),m}},76344:function(e,t,n){function r(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}n.d(t,{Z:function(){return r}})},69130:function(e,t,n){n.d(t,{Z:function(){return J}});var r=n(11466),o=n(32645);function i(e){return(0,o.Z)(1,arguments),e instanceof Date||"object"===(0,r.Z)(e)&&"[object Date]"===Object.prototype.toString.call(e)}var a=n(82754);function s(e){if((0,o.Z)(1,arguments),!i(e)&&"number"!=typeof e)return!1;var t=(0,a.Z)(e);return!isNaN(Number(t))}var c=n(76344);function l(e,t){(0,o.Z)(2,arguments);var n=(0,a.Z)(e).getTime(),r=(0,c.Z)(t);return new Date(n+r)}function u(e,t){(0,o.Z)(2,arguments);var n=(0,c.Z)(t);return l(e,-n)}var d=864e5;function p(e){(0,o.Z)(1,arguments);var t=1,n=(0,a.Z)(e),r=n.getUTCDay(),i=(r<t?7:0)+r-t;return n.setUTCDate(n.getUTCDate()-i),n.setUTCHours(0,0,0,0),n}function f(e){(0,o.Z)(1,arguments);var t=(0,a.Z)(e),n=t.getUTCFullYear(),r=new Date(0);r.setUTCFullYear(n+1,0,4),r.setUTCHours(0,0,0,0);var i=p(r),s=new Date(0);s.setUTCFullYear(n,0,4),s.setUTCHours(0,0,0,0);var c=p(s);return t.getTime()>=i.getTime()?n+1:t.getTime()>=c.getTime()?n:n-1}function _(e){(0,o.Z)(1,arguments);var t=f(e),n=new Date(0);n.setUTCFullYear(t,0,4),n.setUTCHours(0,0,0,0);var r=p(n);return r}var h=6048e5,m=n(69070),g=n(44219);function v(e,t){var n,r,i,s,l,u,d,p;(0,o.Z)(1,arguments);var f=(0,a.Z)(e),_=f.getUTCFullYear(),h=(0,g.j)(),v=(0,c.Z)(null!==(n=null!==(r=null!==(i=null!==(s=null==t?void 0:t.firstWeekContainsDate)&&void 0!==s?s:null==t||null===(l=t.locale)||void 0===l||null===(u=l.options)||void 0===u?void 0:u.firstWeekContainsDate)&&void 0!==i?i:h.firstWeekContainsDate)&&void 0!==r?r:null===(d=h.locale)||void 0===d||null===(p=d.options)||void 0===p?void 0:p.firstWeekContainsDate)&&void 0!==n?n:1);if(!(v>=1&&v<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var b=new Date(0);b.setUTCFullYear(_+1,0,v),b.setUTCHours(0,0,0,0);var y=(0,m.Z)(b,t),w=new Date(0);w.setUTCFullYear(_,0,v),w.setUTCHours(0,0,0,0);var E=(0,m.Z)(w,t);return f.getTime()>=y.getTime()?_+1:f.getTime()>=E.getTime()?_:_-1}function b(e,t){var n,r,i,a,s,l,u,d;(0,o.Z)(1,arguments);var p=(0,g.j)(),f=(0,c.Z)(null!==(n=null!==(r=null!==(i=null!==(a=null==t?void 0:t.firstWeekContainsDate)&&void 0!==a?a:null==t||null===(s=t.locale)||void 0===s||null===(l=s.options)||void 0===l?void 0:l.firstWeekContainsDate)&&void 0!==i?i:p.firstWeekContainsDate)&&void 0!==r?r:null===(u=p.locale)||void 0===u||null===(d=u.options)||void 0===d?void 0:d.firstWeekContainsDate)&&void 0!==n?n:1),_=v(e,t),h=new Date(0);h.setUTCFullYear(_,0,f),h.setUTCHours(0,0,0,0);var b=(0,m.Z)(h,t);return b}var y=6048e5;function w(e,t){for(var n=e<0?"-":"",r=Math.abs(e).toString();r.length<t;)r="0"+r;return n+r}var E={y:function(e,t){var n=e.getUTCFullYear(),r=n>0?n:1-n;return w("yy"===t?r%100:r,t.length)},M:function(e,t){var n=e.getUTCMonth();return"M"===t?String(n+1):w(n+1,2)},d:function(e,t){return w(e.getUTCDate(),t.length)},a:function(e,t){var n=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];default:return"am"===n?"a.m.":"p.m."}},h:function(e,t){return w(e.getUTCHours()%12||12,t.length)},H:function(e,t){return w(e.getUTCHours(),t.length)},m:function(e,t){return w(e.getUTCMinutes(),t.length)},s:function(e,t){return w(e.getUTCSeconds(),t.length)},S:function(e,t){var n=t.length,r=e.getUTCMilliseconds();return w(Math.floor(r*Math.pow(10,n-3)),t.length)}},C="midnight",T="noon",x="morning",S="afternoon",I="evening",k="night",R={G:function(e,t,n){var r=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if("yo"===t){var r=e.getUTCFullYear(),o=r>0?r:1-r;return n.ordinalNumber(o,{unit:"year"})}return E.y(e,t)},Y:function(e,t,n,r){var o=v(e,r),i=o>0?o:1-o;return"YY"===t?w(i%100,2):"Yo"===t?n.ordinalNumber(i,{unit:"year"}):w(i,t.length)},R:function(e,t){return w(f(e),t.length)},u:function(e,t){return w(e.getUTCFullYear(),t.length)},Q:function(e,t,n){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return w(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return w(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){var r=e.getUTCMonth();switch(t){case"M":case"MM":return E.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){var r=e.getUTCMonth();switch(t){case"L":return String(r+1);case"LL":return w(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){var i=function(e,t){(0,o.Z)(1,arguments);var n=(0,a.Z)(e),r=(0,m.Z)(n,t).getTime()-b(n,t).getTime();return Math.round(r/y)+1}(e,r);return"wo"===t?n.ordinalNumber(i,{unit:"week"}):w(i,t.length)},I:function(e,t,n){var r=function(e){(0,o.Z)(1,arguments);var t=(0,a.Z)(e),n=p(t).getTime()-_(t).getTime();return Math.round(n/h)+1}(e);return"Io"===t?n.ordinalNumber(r,{unit:"week"}):w(r,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getUTCDate(),{unit:"date"}):E.d(e,t)},D:function(e,t,n){var r=function(e){(0,o.Z)(1,arguments);var t=(0,a.Z)(e),n=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var r=t.getTime(),i=n-r;return Math.floor(i/d)+1}(e);return"Do"===t?n.ordinalNumber(r,{unit:"dayOfYear"}):w(r,t.length)},E:function(e,t,n){var r=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){var o=e.getUTCDay(),i=(o-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return w(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(o,{width:"short",context:"formatting"});default:return n.day(o,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){var o=e.getUTCDay(),i=(o-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return w(i,t.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(o,{width:"narrow",context:"standalone"});case"cccccc":return n.day(o,{width:"short",context:"standalone"});default:return n.day(o,{width:"wide",context:"standalone"})}},i:function(e,t,n){var r=e.getUTCDay(),o=0===r?7:r;switch(t){case"i":return String(o);case"ii":return w(o,t.length);case"io":return n.ordinalNumber(o,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){var r=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,n){var r,o=e.getUTCHours();switch(r=12===o?T:0===o?C:o/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,n){var r,o=e.getUTCHours();switch(r=o>=17?I:o>=12?S:o>=4?x:k,t){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){var r=e.getUTCHours()%12;return 0===r&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return E.h(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getUTCHours(),{unit:"hour"}):E.H(e,t)},K:function(e,t,n){var r=e.getUTCHours()%12;return"Ko"===t?n.ordinalNumber(r,{unit:"hour"}):w(r,t.length)},k:function(e,t,n){var r=e.getUTCHours();return 0===r&&(r=24),"ko"===t?n.ordinalNumber(r,{unit:"hour"}):w(r,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):E.m(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):E.s(e,t)},S:function(e,t){return E.S(e,t)},X:function(e,t,n,r){var o=(r._originalDate||e).getTimezoneOffset();if(0===o)return"Z";switch(t){case"X":return O(o);case"XXXX":case"XX":return L(o);default:return L(o,":")}},x:function(e,t,n,r){var o=(r._originalDate||e).getTimezoneOffset();switch(t){case"x":return O(o);case"xxxx":case"xx":return L(o);default:return L(o,":")}},O:function(e,t,n,r){var o=(r._originalDate||e).getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+A(o,":");default:return"GMT"+L(o,":")}},z:function(e,t,n,r){var o=(r._originalDate||e).getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+A(o,":");default:return"GMT"+L(o,":")}},t:function(e,t,n,r){var o=r._originalDate||e;return w(Math.floor(o.getTime()/1e3),t.length)},T:function(e,t,n,r){return w((r._originalDate||e).getTime(),t.length)}};function A(e,t){var n=e>0?"-":"+",r=Math.abs(e),o=Math.floor(r/60),i=r%60;if(0===i)return n+String(o);var a=t||"";return n+String(o)+a+w(i,2)}function O(e,t){return e%60==0?(e>0?"-":"+")+w(Math.abs(e)/60,2):L(e,t)}function L(e,t){var n=t||"",r=e>0?"-":"+",o=Math.abs(e);return r+w(Math.floor(o/60),2)+n+w(o%60,2)}var M=R,N=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},D=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},P={p:D,P:function(e,t){var n,r=e.match(/(P+)(p+)?/)||[],o=r[1],i=r[2];if(!i)return N(e,t);switch(o){case"P":n=t.dateTime({width:"short"});break;case"PP":n=t.dateTime({width:"medium"});break;case"PPP":n=t.dateTime({width:"long"});break;default:n=t.dateTime({width:"full"})}return n.replace("{{date}}",N(o,t)).replace("{{time}}",D(i,t))}};function F(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}var B=["D","DD"],U=["YY","YYYY"];function H(e){return-1!==B.indexOf(e)}function j(e){return-1!==U.indexOf(e)}function W(e,t,n){if("YYYY"===e)throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("YY"===e)throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("D"===e)throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("DD"===e)throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var V=n(814).Z,z=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,G=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Y=/^'([^]*?)'?$/,q=/''/g,Z=/[a-zA-Z]/;function J(e,t,n){var r,i,l,d,p,f,_,h,m,v,b,y,w,E,C,T,x,S;(0,o.Z)(2,arguments);var I=String(t),k=(0,g.j)(),R=null!==(r=null!==(i=null==n?void 0:n.locale)&&void 0!==i?i:k.locale)&&void 0!==r?r:V,A=(0,c.Z)(null!==(l=null!==(d=null!==(p=null!==(f=null==n?void 0:n.firstWeekContainsDate)&&void 0!==f?f:null==n||null===(_=n.locale)||void 0===_||null===(h=_.options)||void 0===h?void 0:h.firstWeekContainsDate)&&void 0!==p?p:k.firstWeekContainsDate)&&void 0!==d?d:null===(m=k.locale)||void 0===m||null===(v=m.options)||void 0===v?void 0:v.firstWeekContainsDate)&&void 0!==l?l:1);if(!(A>=1&&A<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var O=(0,c.Z)(null!==(b=null!==(y=null!==(w=null!==(E=null==n?void 0:n.weekStartsOn)&&void 0!==E?E:null==n||null===(C=n.locale)||void 0===C||null===(T=C.options)||void 0===T?void 0:T.weekStartsOn)&&void 0!==w?w:k.weekStartsOn)&&void 0!==y?y:null===(x=k.locale)||void 0===x||null===(S=x.options)||void 0===S?void 0:S.weekStartsOn)&&void 0!==b?b:0);if(!(O>=0&&O<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!R.localize)throw new RangeError("locale must contain localize property");if(!R.formatLong)throw new RangeError("locale must contain formatLong property");var L=(0,a.Z)(e);if(!s(L))throw new RangeError("Invalid time value");var N=F(L),D=u(L,N),B={firstWeekContainsDate:A,weekStartsOn:O,locale:R,_originalDate:L},U=I.match(G).map((function(e){var t=e[0];return"p"===t||"P"===t?(0,P[t])(e,R.formatLong):e})).join("").match(z).map((function(r){if("''"===r)return"'";var o=r[0];if("'"===o)return K(r);var i=M[o];if(i)return null!=n&&n.useAdditionalWeekYearTokens||!j(r)||W(r,t,String(e)),null!=n&&n.useAdditionalDayOfYearTokens||!H(r)||W(r,t,String(e)),i(D,r,R.localize,B);if(o.match(Z))throw new RangeError("Format string contains an unescaped latin alphabet character `"+o+"`");return r})).join("");return U}function K(e){var t=e.match(Y);return t?t[1].replace(q,"'"):e}},696:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(82754),o=n(32645);function i(e){(0,o.Z)(1,arguments);var t=(0,r.Z)(e);return t.setHours(0,0,0,0),t}function a(e,t){(0,o.Z)(2,arguments);var n=i(e),r=i(t);return n.getTime()===r.getTime()}},66802:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(82754),o=n(32645);function i(e,t){(0,o.Z)(2,arguments);var n=(0,r.Z)(e),i=(0,r.Z)(t);return n.getFullYear()===i.getFullYear()}},28397:function(e,t,n){function r(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.width?String(t.width):e.defaultWidth,r=e.formats[n]||e.formats[e.defaultWidth];return r}}n.d(t,{Z:function(){return r}})},82297:function(e,t,n){function r(e){return function(t,n){var r;if("formatting"===(null!=n&&n.context?String(n.context):"standalone")&&e.formattingValues){var o=e.defaultFormattingWidth||e.defaultWidth,i=null!=n&&n.width?String(n.width):o;r=e.formattingValues[i]||e.formattingValues[o]}else{var a=e.defaultWidth,s=null!=n&&n.width?String(n.width):e.defaultWidth;r=e.values[s]||e.values[a]}return r[e.argumentCallback?e.argumentCallback(t):t]}}n.d(t,{Z:function(){return r}})},36819:function(e,t,n){function r(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],s=t.match(a);if(!s)return null;var c,l=s[0],u=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],d=Array.isArray(u)?i(u,(function(e){return e.test(l)})):o(u,(function(e){return e.test(l)}));c=e.valueCallback?e.valueCallback(d):d,c=n.valueCallback?n.valueCallback(c):c;var p=t.slice(l.length);return{value:c,rest:p}}}function o(e,t){for(var n in e)if(e.hasOwnProperty(n)&&t(e[n]))return n}function i(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return n}n.d(t,{Z:function(){return r}})},8792:function(e,t,n){function r(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.match(e.matchPattern);if(!r)return null;var o=r[0],i=t.match(e.parsePattern);if(!i)return null;var a=e.valueCallback?e.valueCallback(i[0]):i[0];a=n.valueCallback?n.valueCallback(a):a;var s=t.slice(o.length);return{value:a,rest:s}}}n.d(t,{Z:function(){return r}})},814:function(e,t,n){n.d(t,{Z:function(){return p}});var r={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},o=function(e,t,n){var o,i=r[e];return o="string"==typeof i?i:1===t?i.one:i.other.replace("{{count}}",t.toString()),null!=n&&n.addSuffix?n.comparison&&n.comparison>0?"in "+o:o+" ago":o},i=n(28397),a={date:(0,i.Z)({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:(0,i.Z)({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:(0,i.Z)({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},s={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},c=function(e,t,n,r){return s[e]},l=n(82297),u={ordinalNumber:function(e,t){var n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:(0,l.Z)({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:(0,l.Z)({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:(0,l.Z)({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:(0,l.Z)({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:(0,l.Z)({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},d=n(36819),p={code:"en-US",formatDistance:o,formatLong:a,formatRelative:c,localize:u,match:{ordinalNumber:(0,n(8792).Z)({matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}}),era:(0,d.Z)({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:(0,d.Z)({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:(0,d.Z)({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:(0,d.Z)({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:(0,d.Z)({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}}},25303:function(e,t,n){n.d(t,{Z:function(){return h}});var r={lessThanXSeconds:{one:"不到 1 秒",other:"不到 {{count}} 秒"},xSeconds:{one:"1 秒",other:"{{count}} 秒"},halfAMinute:"半分钟",lessThanXMinutes:{one:"不到 1 分钟",other:"不到 {{count}} 分钟"},xMinutes:{one:"1 分钟",other:"{{count}} 分钟"},xHours:{one:"1 小时",other:"{{count}} 小时"},aboutXHours:{one:"大约 1 小时",other:"大约 {{count}} 小时"},xDays:{one:"1 天",other:"{{count}} 天"},aboutXWeeks:{one:"大约 1 个星期",other:"大约 {{count}} 个星期"},xWeeks:{one:"1 个星期",other:"{{count}} 个星期"},aboutXMonths:{one:"大约 1 个月",other:"大约 {{count}} 个月"},xMonths:{one:"1 个月",other:"{{count}} 个月"},aboutXYears:{one:"大约 1 年",other:"大约 {{count}} 年"},xYears:{one:"1 年",other:"{{count}} 年"},overXYears:{one:"超过 1 年",other:"超过 {{count}} 年"},almostXYears:{one:"将近 1 年",other:"将近 {{count}} 年"}},o=function(e,t,n){var o,i=r[e];return o="string"==typeof i?i:1===t?i.one:i.other.replace("{{count}}",String(t)),null!=n&&n.addSuffix?n.comparison&&n.comparison>0?o+"内":o+"前":o},i=n(28397),a={date:(0,i.Z)({formats:{full:"y'年'M'月'd'日' EEEE",long:"y'年'M'月'd'日'",medium:"yyyy-MM-dd",short:"yy-MM-dd"},defaultWidth:"full"}),time:(0,i.Z)({formats:{full:"zzzz a h:mm:ss",long:"z a h:mm:ss",medium:"a h:mm:ss",short:"a h:mm"},defaultWidth:"full"}),dateTime:(0,i.Z)({formats:{full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},defaultWidth:"full"})},s=n(32645),c=n(69070);function l(e,t,n){var r="eeee p";return function(e,t,n){(0,s.Z)(2,arguments);var r=(0,c.Z)(e,n),o=(0,c.Z)(t,n);return r.getTime()===o.getTime()}(e,t,n)?r:e.getTime()>t.getTime()?"'下个'eeee p":"'上个'eeee p"}var u={lastWeek:l,yesterday:"'昨天' p",today:"'今天' p",tomorrow:"'明天' p",nextWeek:l,other:"PP p"},d=function(e,t,n,r){var o=u[e];return"function"==typeof o?o(t,n,r):o},p=n(82297),f={ordinalNumber:function(e,t){var n=Number(e);switch(null==t?void 0:t.unit){case"date":return n.toString()+"日";case"hour":return n.toString()+"时";case"minute":return n.toString()+"分";case"second":return n.toString()+"秒";default:return"第 "+n.toString()}},era:(0,p.Z)({values:{narrow:["前","公元"],abbreviated:["前","公元"],wide:["公元前","公元"]},defaultWidth:"wide"}),quarter:(0,p.Z)({values:{narrow:["1","2","3","4"],abbreviated:["第一季","第二季","第三季","第四季"],wide:["第一季度","第二季度","第三季度","第四季度"]},defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:(0,p.Z)({values:{narrow:["一","二","三","四","五","六","七","八","九","十","十一","十二"],abbreviated:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],wide:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},defaultWidth:"wide"}),day:(0,p.Z)({values:{narrow:["日","一","二","三","四","五","六"],short:["日","一","二","三","四","五","六"],abbreviated:["周日","周一","周二","周三","周四","周五","周六"],wide:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"]},defaultWidth:"wide"}),dayPeriod:(0,p.Z)({values:{narrow:{am:"上",pm:"下",midnight:"凌晨",noon:"午",morning:"早",afternoon:"下午",evening:"晚",night:"夜"},abbreviated:{am:"上午",pm:"下午",midnight:"凌晨",noon:"中午",morning:"早晨",afternoon:"中午",evening:"晚上",night:"夜间"},wide:{am:"上午",pm:"下午",midnight:"凌晨",noon:"中午",morning:"早晨",afternoon:"中午",evening:"晚上",night:"夜间"}},defaultWidth:"wide",formattingValues:{narrow:{am:"上",pm:"下",midnight:"凌晨",noon:"午",morning:"早",afternoon:"下午",evening:"晚",night:"夜"},abbreviated:{am:"上午",pm:"下午",midnight:"凌晨",noon:"中午",morning:"早晨",afternoon:"中午",evening:"晚上",night:"夜间"},wide:{am:"上午",pm:"下午",midnight:"凌晨",noon:"中午",morning:"早晨",afternoon:"中午",evening:"晚上",night:"夜间"}},defaultFormattingWidth:"wide"})},_=n(36819),h={code:"zh-CN",formatDistance:o,formatLong:a,formatRelative:d,localize:f,match:{ordinalNumber:(0,n(8792).Z)({matchPattern:/^(第\s*)?\d+(日|时|分|秒)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}}),era:(0,_.Z)({matchPatterns:{narrow:/^(前)/i,abbreviated:/^(前)/i,wide:/^(公元前|公元)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^(前)/i,/^(公元)/i]},defaultParseWidth:"any"}),quarter:(0,_.Z)({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^第[一二三四]刻/i,wide:/^第[一二三四]刻钟/i},defaultMatchWidth:"wide",parsePatterns:{any:[/(1|一)/i,/(2|二)/i,/(3|三)/i,/(4|四)/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:(0,_.Z)({matchPatterns:{narrow:/^(一|二|三|四|五|六|七|八|九|十[二一])/i,abbreviated:/^(一|二|三|四|五|六|七|八|九|十[二一]|\d|1[12])月/i,wide:/^(一|二|三|四|五|六|七|八|九|十[二一])月/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^一/i,/^二/i,/^三/i,/^四/i,/^五/i,/^六/i,/^七/i,/^八/i,/^九/i,/^十(?!(一|二))/i,/^十一/i,/^十二/i],any:[/^一|1/i,/^二|2/i,/^三|3/i,/^四|4/i,/^五|5/i,/^六|6/i,/^七|7/i,/^八|8/i,/^九|9/i,/^十(?!(一|二))|10/i,/^十一|11/i,/^十二|12/i]},defaultParseWidth:"any"}),day:(0,_.Z)({matchPatterns:{narrow:/^[一二三四五六日]/i,short:/^[一二三四五六日]/i,abbreviated:/^周[一二三四五六日]/i,wide:/^星期[一二三四五六日]/i},defaultMatchWidth:"wide",parsePatterns:{any:[/日/i,/一/i,/二/i,/三/i,/四/i,/五/i,/六/i]},defaultParseWidth:"any"}),dayPeriod:(0,_.Z)({matchPatterns:{any:/^(上午?|下午?|午夜|[中正]午|早上?|下午|晚上?|凌晨|)/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^上午?/i,pm:/^下午?/i,midnight:/^午夜/i,noon:/^[中正]午/i,morning:/^早上/i,afternoon:/^下午/i,evening:/^晚上?/i,night:/^凌晨/i}},defaultParseWidth:"any"})},options:{weekStartsOn:1,firstWeekContainsDate:4}}},77435:function(e,t,n){n.d(t,{Z:function(){return p}});var r={lessThanXSeconds:{one:"少於 1 秒",other:"少於 {{count}} 秒"},xSeconds:{one:"1 秒",other:"{{count}} 秒"},halfAMinute:"半分鐘",lessThanXMinutes:{one:"少於 1 分鐘",other:"少於 {{count}} 分鐘"},xMinutes:{one:"1 分鐘",other:"{{count}} 分鐘"},xHours:{one:"1 小時",other:"{{count}} 小時"},aboutXHours:{one:"大約 1 小時",other:"大約 {{count}} 小時"},xDays:{one:"1 天",other:"{{count}} 天"},aboutXWeeks:{one:"大約 1 個星期",other:"大約 {{count}} 個星期"},xWeeks:{one:"1 個星期",other:"{{count}} 個星期"},aboutXMonths:{one:"大約 1 個月",other:"大約 {{count}} 個月"},xMonths:{one:"1 個月",other:"{{count}} 個月"},aboutXYears:{one:"大約 1 年",other:"大約 {{count}} 年"},xYears:{one:"1 年",other:"{{count}} 年"},overXYears:{one:"超過 1 年",other:"超過 {{count}} 年"},almostXYears:{one:"將近 1 年",other:"將近 {{count}} 年"}},o=function(e,t,n){var o,i=r[e];return o="string"==typeof i?i:1===t?i.one:i.other.replace("{{count}}",String(t)),null!=n&&n.addSuffix?n.comparison&&n.comparison>0?o+"內":o+"前":o},i=n(28397),a={date:(0,i.Z)({formats:{full:"y'年'M'月'd'日' EEEE",long:"y'年'M'月'd'日'",medium:"yyyy-MM-dd",short:"yy-MM-dd"},defaultWidth:"full"}),time:(0,i.Z)({formats:{full:"zzzz a h:mm:ss",long:"z a h:mm:ss",medium:"a h:mm:ss",short:"a h:mm"},defaultWidth:"full"}),dateTime:(0,i.Z)({formats:{full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},defaultWidth:"full"})},s={lastWeek:"'上個'eeee p",yesterday:"'昨天' p",today:"'今天' p",tomorrow:"'明天' p",nextWeek:"'下個'eeee p",other:"P"},c=function(e,t,n,r){return s[e]},l=n(82297),u={ordinalNumber:function(e,t){var n=Number(e);switch(null==t?void 0:t.unit){case"date":return n+"日";case"hour":return n+"時";case"minute":return n+"分";case"second":return n+"秒";default:return"第 "+n}},era:(0,l.Z)({values:{narrow:["前","公元"],abbreviated:["前","公元"],wide:["公元前","公元"]},defaultWidth:"wide"}),quarter:(0,l.Z)({values:{narrow:["1","2","3","4"],abbreviated:["第一季","第二季","第三季","第四季"],wide:["第一季度","第二季度","第三季度","第四季度"]},defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:(0,l.Z)({values:{narrow:["一","二","三","四","五","六","七","八","九","十","十一","十二"],abbreviated:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],wide:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},defaultWidth:"wide"}),day:(0,l.Z)({values:{narrow:["日","一","二","三","四","五","六"],short:["日","一","二","三","四","五","六"],abbreviated:["週日","週一","週二","週三","週四","週五","週六"],wide:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"]},defaultWidth:"wide"}),dayPeriod:(0,l.Z)({values:{narrow:{am:"上",pm:"下",midnight:"午夜",noon:"晌",morning:"早",afternoon:"午",evening:"晚",night:"夜"},abbreviated:{am:"上午",pm:"下午",midnight:"午夜",noon:"中午",morning:"上午",afternoon:"下午",evening:"晚上",night:"夜晚"},wide:{am:"上午",pm:"下午",midnight:"午夜",noon:"中午",morning:"上午",afternoon:"下午",evening:"晚上",night:"夜晚"}},defaultWidth:"wide",formattingValues:{narrow:{am:"上",pm:"下",midnight:"午夜",noon:"晌",morning:"早",afternoon:"午",evening:"晚",night:"夜"},abbreviated:{am:"上午",pm:"下午",midnight:"午夜",noon:"中午",morning:"上午",afternoon:"下午",evening:"晚上",night:"夜晚"},wide:{am:"上午",pm:"下午",midnight:"午夜",noon:"中午",morning:"上午",afternoon:"下午",evening:"晚上",night:"夜晚"}},defaultFormattingWidth:"wide"})},d=n(36819),p={code:"zh-HK",formatDistance:o,formatLong:a,formatRelative:c,localize:u,match:{ordinalNumber:(0,n(8792).Z)({matchPattern:/^(第\s*)?\d+(日|時|分|秒)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}}),era:(0,d.Z)({matchPatterns:{narrow:/^(前)/i,abbreviated:/^(前)/i,wide:/^(公元前|公元)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^(前)/i,/^(公元)/i]},defaultParseWidth:"any"}),quarter:(0,d.Z)({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^第[一二三四]季/i,wide:/^第[一二三四]季度/i},defaultMatchWidth:"wide",parsePatterns:{any:[/(1|一)/i,/(2|二)/i,/(3|三)/i,/(4|四)/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:(0,d.Z)({matchPatterns:{narrow:/^(一|二|三|四|五|六|七|八|九|十[二一])/i,abbreviated:/^(一|二|三|四|五|六|七|八|九|十[二一]|\d|1[12])月/i,wide:/^(一|二|三|四|五|六|七|八|九|十[二一])月/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^一/i,/^二/i,/^三/i,/^四/i,/^五/i,/^六/i,/^七/i,/^八/i,/^九/i,/^十(?!(一|二))/i,/^十一/i,/^十二/i],any:[/^一|1/i,/^二|2/i,/^三|3/i,/^四|4/i,/^五|5/i,/^六|6/i,/^七|7/i,/^八|8/i,/^九|9/i,/^十(?!(一|二))|10/i,/^十一|11/i,/^十二|12/i]},defaultParseWidth:"any"}),day:(0,d.Z)({matchPatterns:{narrow:/^[一二三四五六日]/i,short:/^[一二三四五六日]/i,abbreviated:/^週[一二三四五六日]/i,wide:/^星期[一二三四五六日]/i},defaultMatchWidth:"wide",parsePatterns:{any:[/日/i,/一/i,/二/i,/三/i,/四/i,/五/i,/六/i]},defaultParseWidth:"any"}),dayPeriod:(0,d.Z)({matchPatterns:{any:/^(上午?|下午?|午夜|[中正]午|早上?|下午|晚上?|凌晨)/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^上午?/i,pm:/^下午?/i,midnight:/^午夜/i,noon:/^[中正]午/i,morning:/^早上/i,afternoon:/^下午/i,evening:/^晚上?/i,night:/^凌晨/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}}},82754:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(11466),o=n(32645);function i(e){(0,o.Z)(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===(0,r.Z)(e)&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}},61052:function(e,t,n){n.d(t,{Z:function(){return f}});var r=n(22418),o=n(26150),i=n(74687);function a(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}var s=n(87363),c=n.n(s),l=n(43813),u=n(98219),d=function(e,t){return e&&t&&t.split(" ").forEach((function(t){return r=t,void((n=e).classList?n.classList.remove(r):"string"==typeof n.className?n.className=a(n.className,r):n.setAttribute("class",a(n.className&&n.className.baseVal||"",r)));var n,r}))},p=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).appliedClasses={appear:{},enter:{},exit:{}},t.onEnter=function(e,n){var r=t.resolveArguments(e,n),o=r[0],i=r[1];t.removeClasses(o,"exit"),t.addClass(o,i?"appear":"enter","base"),t.props.onEnter&&t.props.onEnter(e,n)},t.onEntering=function(e,n){var r=t.resolveArguments(e,n),o=r[0],i=r[1]?"appear":"enter";t.addClass(o,i,"active"),t.props.onEntering&&t.props.onEntering(e,n)},t.onEntered=function(e,n){var r=t.resolveArguments(e,n),o=r[0],i=r[1]?"appear":"enter";t.removeClasses(o,i),t.addClass(o,i,"done"),t.props.onEntered&&t.props.onEntered(e,n)},t.onExit=function(e){var n=t.resolveArguments(e)[0];t.removeClasses(n,"appear"),t.removeClasses(n,"enter"),t.addClass(n,"exit","base"),t.props.onExit&&t.props.onExit(e)},t.onExiting=function(e){var n=t.resolveArguments(e)[0];t.addClass(n,"exit","active"),t.props.onExiting&&t.props.onExiting(e)},t.onExited=function(e){var n=t.resolveArguments(e)[0];t.removeClasses(n,"exit"),t.addClass(n,"exit","done"),t.props.onExited&&t.props.onExited(e)},t.resolveArguments=function(e,n){return t.props.nodeRef?[t.props.nodeRef.current,e]:[e,n]},t.getClassNames=function(e){var n=t.props.classNames,r="string"==typeof n,o=r?(r&&n?n+"-":"")+e:n[e];return{baseClassName:o,activeClassName:r?o+"-active":n[e+"Active"],doneClassName:r?o+"-done":n[e+"Done"]}},t}(0,i.Z)(t,e);var n=t.prototype;return n.addClass=function(e,t,n){var r=this.getClassNames(t)[n+"ClassName"],o=this.getClassNames("enter").doneClassName;"appear"===t&&"done"===n&&o&&(r+=" "+o),"active"===n&&e&&(0,u.Q)(e),r&&(this.appliedClasses[t][n]=r,function(e,t){e&&t&&t.split(" ").forEach((function(t){return r=t,void((n=e).classList?n.classList.add(r):function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")}(n,r)||("string"==typeof n.className?n.className=n.className+" "+r:n.setAttribute("class",(n.className&&n.className.baseVal||"")+" "+r)));var n,r}))}(e,r))},n.removeClasses=function(e,t){var n=this.appliedClasses[t],r=n.base,o=n.active,i=n.done;this.appliedClasses[t]={},r&&d(e,r),o&&d(e,o),i&&d(e,i)},n.render=function(){var e=this.props,t=(e.classNames,(0,o.Z)(e,["classNames"]));return c().createElement(l.ZP,(0,r.Z)({},t,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(c().Component);p.defaultProps={classNames:""},p.propTypes={};var f=p},50554:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(85556),o=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return r.__extends(t,e),t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t.scheduled||(t.scheduled=requestAnimationFrame((function(){return t.flush(null)}))))},t.prototype.recycleAsyncId=function(t,n,r){if(void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,r);0===t.actions.length&&(cancelAnimationFrame(n),t.scheduled=void 0)},t}(n(93765).o),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.flush=function(e){this.active=!0,this.scheduled=void 0;var t,n=this.actions,r=-1,o=n.length;e=e||n.shift();do{if(t=e.execute(e.state,e.delay))break}while(++r<o&&(e=n.shift()));if(this.active=!1,t){for(;++r<o&&(e=n.shift());)e.unsubscribe();throw t}},t}(n(83081).v),a=new i(o)},37454:function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(t,n){void 0===n&&(n=e.now),this.SchedulerAction=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(n,t)},e.now=function(){return Date.now()},e}();t.Scheduler=n},4062:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(22542),o=n(22514),i=n(4603),a=n(15841),s=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}var t;return e.prototype.unsubscribe=function(){var t;if(!this.closed){var n=this,s=n._parentOrParents,l=n._ctorUnsubscribe,u=n._unsubscribe,d=n._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,s instanceof e)s.remove(this);else if(null!==s)for(var p=0;p<s.length;++p)s[p].remove(this);if(i.isFunction(u)){l&&(this._unsubscribe=void 0);try{u.call(this)}catch(e){t=e instanceof a.UnsubscriptionError?c(e.errors):[e]}}if(r.isArray(d)){p=-1;for(var f=d.length;++p<f;){var _=d[p];if(o.isObject(_))try{_.unsubscribe()}catch(e){t=t||[],e instanceof a.UnsubscriptionError?t=t.concat(c(e.errors)):t.push(e)}}}if(t)throw new a.UnsubscriptionError(t)}},e.prototype.add=function(t){var n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var r=n;(n=new e)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var o=n._parentOrParents;if(null===o)n._parentOrParents=this;else if(o instanceof e){if(o===this)return n;n._parentOrParents=[o,this]}else{if(-1!==o.indexOf(this))return n;o.push(this)}var i=this._subscriptions;return null===i?this._subscriptions=[n]:i.push(n),n},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},e.EMPTY=((t=new e).closed=!0,t),e}();function c(e){return e.reduce((function(e,t){return e.concat(t instanceof a.UnsubscriptionError?t.errors:t)}),[])}t.Subscription=s},86450:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t,n){return e.call(this)||this}return o(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(n(4062).Subscription);t.Action=i},20451:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return o(t,e),t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t.scheduled||(t.scheduled=requestAnimationFrame((function(){return t.flush(null)}))))},t.prototype.recycleAsyncId=function(t,n,r){if(void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,r);0===t.actions.length&&(cancelAnimationFrame(n),t.scheduled=void 0)},t}(n(35584).AsyncAction);t.AnimationFrameAction=i},60829:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.flush=function(e){this.active=!0,this.scheduled=void 0;var t,n=this.actions,r=-1,o=n.length;e=e||n.shift();do{if(t=e.execute(e.state,e.delay))break}while(++r<o&&(e=n.shift()));if(this.active=!1,t){for(;++r<o&&(e=n.shift());)e.unsubscribe();throw t}},t}(n(32656).AsyncScheduler);t.AnimationFrameScheduler=i},35584:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return o(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n=!1,r=void 0;try{this.work(e)}catch(e){n=!0,r=!!e&&e||new Error(e)}if(n)return this.unsubscribe(),r},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(n(86450).Action);t.AsyncAction=i},32656:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(37454),a=function(e){function t(n,r){void 0===r&&(r=i.Scheduler.now);var o=e.call(this,n,(function(){return t.delegate&&t.delegate!==o?t.delegate.now():r()}))||this;return o.actions=[],o.active=!1,o.scheduled=void 0,o}return o(t,e),t.prototype.schedule=function(n,r,o){return void 0===r&&(r=0),t.delegate&&t.delegate!==this?t.delegate.schedule(n,r,o):e.prototype.schedule.call(this,n,r,o)},t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(i.Scheduler);t.AsyncScheduler=a},56610:function(e,t,n){var r=n(20451),o=n(60829);t.Zt=new o.AnimationFrameScheduler(r.AnimationFrameAction),t.Zt},15841:function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}();t.UnsubscriptionError=n},22542:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isArray=Array.isArray||function(e){return e&&"number"==typeof e.length}},4603:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isFunction=function(e){return"function"==typeof e}},22514:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isObject=function(e){return null!==e&&"object"==typeof e}},2394:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(10482),o=n(10065);function i(e,t,n){return i=(0,o.Z)()?Reflect.construct.bind():function(e,t,n){var o=[null];o.push.apply(o,t);var i=new(Function.bind.apply(e,o));return n&&(0,r.Z)(i,n.prototype),i},i.apply(null,arguments)}},41713:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(1039),o=n(10482),i=n(2394);function a(e){var t="function"==typeof Map?new Map:void 0;return a=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,a)}function a(){return(0,i.Z)(e,arguments,(0,r.Z)(this).constructor)}return a.prototype=Object.create(e.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),(0,o.Z)(a,e)},a(e)}}},function(e){e.O(0,[8382,1800,98,4396,8624,5367,7180,9539,8487,1146,8681,5949,8040,7354,7568,6521],(function(){return t=4788,e(e.s=t);var t})),e.O()}]),"object"==typeof globalThis&&(globalThis.jsExecEndTimeStamp=Date.now(),globalThis.cachedPerformanceEntries||(globalThis.cachedPerformanceEntries=[]),globalThis.cachedPerformanceEntries.push({name:"jsExec: js/public-doc-pc-684db8c0.js",entryType:"jsExec",startTime:globalThis.jsExecStartTimeStamp,endTime:globalThis.jsExecEndTimeStamp}));
//# sourceMappingURL=public-doc-pc-684db8c0.js.map